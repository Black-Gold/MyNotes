{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MyWebSite \u00b6 DevSecOps Wiki \u00b6","title":"Home"},{"location":"#welcome-to-mywebsite","text":"","title":"Welcome to MyWebSite"},{"location":"#devsecops-wiki","text":"","title":"DevSecOps Wiki"},{"location":"ActiveMQ/","text":"","title":"ActiveMQ"},{"location":"Ansible/","text":"Ansible \u00b6 sage : ansible < host - pattern > [ options ] Define and run a single task ' playbook ' against a set of hosts Options : - a MODULE_ARGS , -- args = MODULE_ARGS module arguments -- ask - vault - pass ask for vault password - B SECONDS , -- background = SECONDS run asynchronously , failing after X seconds ( default = N / A ) - C , -- check don ' t make any changes; instead, try to predict some of the changes that may occur - D , -- diff when changing ( small ) files and templates , show the differences in those files ; works great with --check - e EXTRA_VARS , -- extra - vars = EXTRA_VARS set additional variables as key = value or YAML / JSON , if filename prepend with @ - f FORKS , -- forks = FORKS specify number of parallel processes to use ( default = 5 ) - h , -- help show this help message and exit - i INVENTORY , -- inventory = INVENTORY , -- inventory - file = INVENTORY specify inventory host path or comma separated host list . -- inventory - file is deprecated - l SUBSET , -- limit = SUBSET further limit selected hosts to an additional pattern -- list - hosts outputs a list of matching hosts ; does not execute anything else - m MODULE_NAME , -- module - name = MODULE_NAME module name to execute ( default = command ) - M MODULE_PATH , -- module - path = MODULE_PATH prepend colon - separated path ( s ) to module library ( default = [ u ' /root/.ansible/plugins/modules ' , u ' /usr/share/ansible/plugins/modules ' ] ) - o , -- one - line condense output -- playbook - dir = BASEDIR Since this tool does not use playbooks , use this as a subsitute playbook directory . This sets the relative path for many features including roles / group_vars / etc . - P POLL_INTERVAL , -- poll = POLL_INTERVAL set the poll interval if using - B ( default = 15 ) -- syntax - check perform a syntax check on the playbook , but do not execute it - t TREE , -- tree = TREE log output to this directory -- vault - id = VAULT_IDS the vault identity to use -- vault - password - file = VAULT_PASSWORD_FILES vault password file - v , -- verbose verbose mode ( - vvv for more , - vvvv to enable connection debugging ) -- version show program ' s version number and exit Connection Options : control as whom and how to connect to hosts - k , -- ask - pass ask for connection password -- private - key = PRIVATE_KEY_FILE , -- key - file = PRIVATE_KEY_FILE use this file to authenticate the connection - u REMOTE_USER , -- user = REMOTE_USER connect as this user ( default = None ) - c CONNECTION , -- connection = CONNECTION connection type to use ( default = smart ) - T TIMEOUT , -- timeout = TIMEOUT override the connection timeout in seconds ( default = 10 ) -- ssh - common - args = SSH_COMMON_ARGS specify common arguments to pass to sftp / scp / ssh ( e . g . ProxyCommand ) -- sftp - extra - args = SFTP_EXTRA_ARGS specify extra arguments to pass to sftp only ( e . g . - f , - l ) -- scp - extra - args = SCP_EXTRA_ARGS specify extra arguments to pass to scp only ( e . g . - l ) -- ssh - extra - args = SSH_EXTRA_ARGS specify extra arguments to pass to ssh only ( e . g . - R ) Privilege Escalation Options : control how and which user you become as on target hosts - s , -- sudo run operations with sudo ( nopasswd ) ( deprecated , use become ) - U SUDO_USER , -- sudo - user = SUDO_USER desired sudo user ( default = root ) ( deprecated , use become ) - S , -- su run operations with su ( deprecated , use become ) - R SU_USER , -- su - user = SU_USER run operations with su as this user ( default = None ) ( deprecated , use become ) - b , -- become run operations with become ( does not imply password prompting ) -- become - method = BECOME_METHOD privilege escalation method to use ( default = sudo ) , valid choices : [ sudo | su | pbrun | pfexec | doas | dzdo | ksu | runas | pmrun | enable | machinectl ] -- become - user = BECOME_USER run operations as this user ( default = root ) -- ask - sudo - pass ask for sudo password ( deprecated , use become ) -- ask - su - pass ask for su password ( deprecated , use become ) - K , -- ask - become - pass ask for privilege escalation password Centos\u4e0b\u5b89\u88c5\u90e8\u7f72 \u00b6 Ansible\u662f\u4e00\u79cd\u6279\u91cf\u90e8\u7f72\u5de5\u5177\uff0c\u73b0\u5728\u8fd0\u7ef4\u4eba\u5458\u7528\u7684\u6700\u591a\u7684\u4e09\u79cd\u5f00\u6e90\u96c6\u4e2d\u5316\u7ba1\u7406\u5de5\u5177\u6709\uff1apuppet,saltstack,ansible\uff0c\u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9\uff0c\u5176\u4e2dsaltstack\u548cansible\u90fd\u662f\u7528python\u5f00\u53d1\u7684\u3002ansible\u5176\u5b9e\u51c6\u786e\u7684\u8bf4\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6846\u67b6\uff0c\u5b83\u8981\u57fa\u4e8e\u5f88\u591a\u5176\u4ed6\u7684python\u6a21\u5757\u624d\u80fd\u5de5\u4f5c\u7684\uff0c\u6240\u4ee5\u5728\u5b89\u88c5ansible\u7684\u65f6\u5019\u4f60\u8981\u518d\u88c5\u5f88\u591a\u5176\u4ed6\u7684\u4f9d\u8d56\u5305\u7684\u3002 \u597d\u5904\u4e4b\u4e00\u662f\u4f7f\u7528\u8005\u53ef\u4ee5\u5f00\u53d1\u81ea\u5df1\u7684\u6a21\u5757\uff0c\u653e\u5728\u91cc\u9762\u4f7f\u7528\u3002\u7b2c\u4e8c\u4e2a\u597d\u5904\u662f\u65e0\u9700\u5728\u5ba2\u6237\u7aef\u5b89\u88c5agent\uff0c\u66f4\u65b0\u65f6\uff0c\u53ea\u9700\u5728\u64cd\u4f5c\u673a\u4e0a\u8fdb\u884c\u4e00\u6b21\u66f4\u65b0\u5373\u53ef\u3002\u7b2c\u4e09\u4e2a\u597d\u5904\u662f\u6279\u91cf\u4efb\u52a1\u6267\u884c\u53ef\u4ee5\u5199\u6210\u811a\u672c\uff0c\u800c\u4e14\u4e0d\u7528\u5206\u53d1\u5230\u8fdc\u7a0b\u5c31\u53ef\u4ee5\u6267\u884c\u3002 ( 1 ) \u3001 python2 . 7 \u5b89\u88c5,\u5347\u7ea7\u5230 2 . 7 . 9 https : // www . python . org / ftp / python / 2 . 7 . 9 / Python - 2 . 7 . 9 . tgz # tar xvzf Python - 2 . 7 . 9 . tgz # cd Python - 2 . 7 . 9 # . / configure -- prefix =/ usr / local # make && make install ## \u5c06 python \u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u6807\u51c6\u76ee\u5f55\uff0c\u4ee5\u907f\u514d\u7f16\u8bd1 ansible \u65f6\uff0c\u627e\u4e0d\u5230\u6240\u9700\u7684\u5934\u6587\u4ef6 # cd / usr / local / include / python2 . 7 # cp - a . /* /usr/local/include/ ## \u5907\u4efd\u65e7\u7248\u672c\u7684python\uff0c\u5e76\u7b26\u53f7\u94fe\u63a5\u65b0\u7248\u672c\u7684python # cd /usr/bin #\u65e7\u7248\u672cPython\u8def\u5f84 # mv python python.old #\u5907\u4efd\u65e7\u7248\u672c # ln -s /usr/local/bin/python2 /usr/local/bin/python # rm -f /usr/bin/python && cp /usr/local/bin/python2 /usr/bin/python ## \u4fee\u6539yum\u811a\u672c\uff0c\u4f7f\u5176\u6307\u5411\u65e7\u7248\u672c\u7684python\uff0c\u5df2\u907f\u514d\u5176\u65e0\u6cd5\u8fd0\u884c # vim /usr/bin/yum #!/usr/bin/python --> #!/usr/bin/python2.7 No module named urlgrabber.grabber\u62a5\u9519\u5904\u7406 vim /usr/libexec/urlgrabber-ext-down #! /usr/bin/python --> #! /usr/bin/python2.7 python --version\u9a8c\u8bc1\u7248\u672c Tips :\u82e5python\u7248\u672c\u5df2\u7ecf\u4e3a2.6\u6216\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u518d\u91cd\u88c5python\uff0c\u53ea\u662f\u8fd8\u9700\u8981\u5b89\u88c5python\u5f00\u53d1\u5305\uff1apython-dev(\u6709\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4e3apython-devel) (2)\u3001setuptools pip wheel\u6a21\u5757\u5b89\u88c5 wget https://bootstrap.pypa.io/get-pip.py python get-pip.py python -m pip install --upgrade pip setuptools wheel #\u5347\u7ea7pip setuptools wheel \u5b89\u88c5\u597dsetuptools\u540e\u5c31\u53ef\u4ee5\u5229\u7528easy_install\u6216pip\u8fd9\u4e2a\u5de5\u5177\u5b89\u88c5\u4e0b\u9762\u7684python\u6a21\u5757\u4e86 easy_install pycrypto pyyaml jinja2 paramiko simplejson pip install pycrypto pyyaml jinja2 paramiko simplejson (3)\u3001ansible\u5b89\u88c5 https://github.com/ansible/ansible/archive/v1.7.2.tar.gz # tar xvzf ansible-1.7.2.tar.gz # cd ansible-1.7.2 # python setup.py install (4)\u3001SSH\u514d\u5bc6\u94a5\u767b\u5f55\u8bbe\u7f6e ## \u751f\u6210\u516c\u94a5/\u79c1\u94a5 # ssh-keygen -t rsa -P '' ## \u5199\u5165\u4fe1\u4efb\u6587\u4ef6\uff08\u5c06/root/.ssh/id_rsa_storm1.pub\u5206\u53d1\u5230\u5176\u4ed6\u670d\u52a1\u5668\uff0c\u5e76\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u5982\u4e0b\u6307\u4ee4\uff09\uff1a # cat /root/.ssh/id_rsa_storm1.pub >> /root/.ssh/authorized_keys # chmod 600 /root/.ssh/authorized_keys (5)\u3001\u62f7\u8d1d\uff0c\u751f\u6210ansible\u914d\u7f6e\u6587\u4ef6 a \u914d\u7f6e\u6587\u4ef6/etc/ansible/ansible.cfg # mkdir -p /etc/ansible #cp ansible-1.7.2/examples/ansible.cfg /etc/ansible/ b \u914d\u7f6e\u6587\u4ef6/etc/ansible/hosts # vim /etc/ansible/hosts [test] 192.168.110.20 192.168.110.30 \u6d4b\u8bd5 # ansible test -m command -a 'uptime' ## \u7528\u6765\u6d4b\u8bd5\u8fdc\u7a0b\u4e3b\u673a\u7684\u8fd0\u884c\u72b6\u6001 # ansible test -m ping \u53c2\u770b\u6240\u6709\u7684\u53c2\u6570 ansible-doc -l ansible\u7684\u79bb\u7ebf\u5b89\u88c5 \u00b6 \u9700\u8981\u63d0\u524d\u51c6\u5907\u7684\u5b89\u88c5\u5305\u811a\u672c,install_ansible.sh # !/ bin / sh # 1 .\u521b\u5efa\u6587\u4ef6\u5939 mkdir / opt / ansible # 2 . \u79fb\u52a8\u8d44\u6e90\u5230\u76ee\u6807\u6587\u4ef6\u5939 cp - rf . / res /* /opt/ansible/ # 3. \u5b89\u88c5python cd /opt/ansible tar xvzf Python-2.7.tgz rm -f Python-2.7.tgz cd Python-2.7 ./configure --prefix=/usr/local make make install cd /usr/local/include/python2.7 cp -a ./* /usr/local/include/ cd /usr/bin mv python python.old ln -s -f /usr/local/bin/python2.7 /usr/local/bin/python rm -f /usr/bin/python && cp /usr/local/bin/python2.7 /usr/bin/python # 4. \u5b89\u88c5setuptools cd /opt/ansible tar xvzf setuptools-7.0.tar.gz rm -f setuptools-7.0.tar.gz cd setuptools-7.0 python setup.py install # 5. \u5b89\u88c5pycrypto cd /opt/ansible tar xvzf pycrypto-2.6.tar.gz rm -f pycrypto-2.6.tar.gz cd pycrypto-2.6 python setup.py install # 6. \u5b89\u88c5PyYAML cd /opt/ansible tar xvzf yaml-0.1.5.tar.gz rm -f yaml-0.1.5.tar.gz cd yaml-0.1.5 ./configure --prefix=/usr/local make --jobs=`grep processor /proc/cpuinfo | wc -l` make install #\u51fa\u95ee\u9898\u4e86 cd /opt/ansible tar xvzf PyYAML-3.11.tar.gz rm -f PyYAML-3.11.tar.gz cd PyYAML-3.11 python setup.py install # 7. \u5b89\u88c5MarkupSafe cd /opt/ansible tar xvzf MarkupSafe-0.9.3.tar.gz rm -f MarkupSafe-0.9.3.tar.gz cd MarkupSafe-0.9.3 python setup.py install cd /opt/ansible tar xvzf Jinja2-2.7.3.tar.gz rm -f Jinja2-2.7.3.tar.gz cd Jinja2-2.7.3 python setup.py install # 8. \u5b89\u88c5ecdsa cd /opt/ansible tar xvzf ecdsa-0.13.tar.gz rm -f ecdsa-0.13.tar.gz cd ecdsa-0.13 python setup.py install cd /opt/ansible tar xvzf paramiko-1.15.1.tar.gz rm -f paramiko-1.15.1.tar.gz cd paramiko-1.15.1 python setup.py install # 9. \u5b89\u88c5simplejson cd /opt/ansible tar xvzf simplejson-3.8.2.tar.gz rm -f simplejson-3.8.2.tar.gz cd simplejson-3.8.2 python setup.py install cd /opt/ansible tar xvzf ansible-latest.tar.gz rm -f ansible-latest.tar.gz cd ansible-2.1.0.0 python setup.py install Apollo--\u643a\u7a0b\u6846\u67b6\u90e8\u95e8\u7814\u53d1\u7684\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0 \u00b6","title":"Ansible"},{"location":"Ansible/#ansible","text":"sage : ansible < host - pattern > [ options ] Define and run a single task ' playbook ' against a set of hosts Options : - a MODULE_ARGS , -- args = MODULE_ARGS module arguments -- ask - vault - pass ask for vault password - B SECONDS , -- background = SECONDS run asynchronously , failing after X seconds ( default = N / A ) - C , -- check don ' t make any changes; instead, try to predict some of the changes that may occur - D , -- diff when changing ( small ) files and templates , show the differences in those files ; works great with --check - e EXTRA_VARS , -- extra - vars = EXTRA_VARS set additional variables as key = value or YAML / JSON , if filename prepend with @ - f FORKS , -- forks = FORKS specify number of parallel processes to use ( default = 5 ) - h , -- help show this help message and exit - i INVENTORY , -- inventory = INVENTORY , -- inventory - file = INVENTORY specify inventory host path or comma separated host list . -- inventory - file is deprecated - l SUBSET , -- limit = SUBSET further limit selected hosts to an additional pattern -- list - hosts outputs a list of matching hosts ; does not execute anything else - m MODULE_NAME , -- module - name = MODULE_NAME module name to execute ( default = command ) - M MODULE_PATH , -- module - path = MODULE_PATH prepend colon - separated path ( s ) to module library ( default = [ u ' /root/.ansible/plugins/modules ' , u ' /usr/share/ansible/plugins/modules ' ] ) - o , -- one - line condense output -- playbook - dir = BASEDIR Since this tool does not use playbooks , use this as a subsitute playbook directory . This sets the relative path for many features including roles / group_vars / etc . - P POLL_INTERVAL , -- poll = POLL_INTERVAL set the poll interval if using - B ( default = 15 ) -- syntax - check perform a syntax check on the playbook , but do not execute it - t TREE , -- tree = TREE log output to this directory -- vault - id = VAULT_IDS the vault identity to use -- vault - password - file = VAULT_PASSWORD_FILES vault password file - v , -- verbose verbose mode ( - vvv for more , - vvvv to enable connection debugging ) -- version show program ' s version number and exit Connection Options : control as whom and how to connect to hosts - k , -- ask - pass ask for connection password -- private - key = PRIVATE_KEY_FILE , -- key - file = PRIVATE_KEY_FILE use this file to authenticate the connection - u REMOTE_USER , -- user = REMOTE_USER connect as this user ( default = None ) - c CONNECTION , -- connection = CONNECTION connection type to use ( default = smart ) - T TIMEOUT , -- timeout = TIMEOUT override the connection timeout in seconds ( default = 10 ) -- ssh - common - args = SSH_COMMON_ARGS specify common arguments to pass to sftp / scp / ssh ( e . g . ProxyCommand ) -- sftp - extra - args = SFTP_EXTRA_ARGS specify extra arguments to pass to sftp only ( e . g . - f , - l ) -- scp - extra - args = SCP_EXTRA_ARGS specify extra arguments to pass to scp only ( e . g . - l ) -- ssh - extra - args = SSH_EXTRA_ARGS specify extra arguments to pass to ssh only ( e . g . - R ) Privilege Escalation Options : control how and which user you become as on target hosts - s , -- sudo run operations with sudo ( nopasswd ) ( deprecated , use become ) - U SUDO_USER , -- sudo - user = SUDO_USER desired sudo user ( default = root ) ( deprecated , use become ) - S , -- su run operations with su ( deprecated , use become ) - R SU_USER , -- su - user = SU_USER run operations with su as this user ( default = None ) ( deprecated , use become ) - b , -- become run operations with become ( does not imply password prompting ) -- become - method = BECOME_METHOD privilege escalation method to use ( default = sudo ) , valid choices : [ sudo | su | pbrun | pfexec | doas | dzdo | ksu | runas | pmrun | enable | machinectl ] -- become - user = BECOME_USER run operations as this user ( default = root ) -- ask - sudo - pass ask for sudo password ( deprecated , use become ) -- ask - su - pass ask for su password ( deprecated , use become ) - K , -- ask - become - pass ask for privilege escalation password","title":"Ansible"},{"location":"Ansible/#centos","text":"Ansible\u662f\u4e00\u79cd\u6279\u91cf\u90e8\u7f72\u5de5\u5177\uff0c\u73b0\u5728\u8fd0\u7ef4\u4eba\u5458\u7528\u7684\u6700\u591a\u7684\u4e09\u79cd\u5f00\u6e90\u96c6\u4e2d\u5316\u7ba1\u7406\u5de5\u5177\u6709\uff1apuppet,saltstack,ansible\uff0c\u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9\uff0c\u5176\u4e2dsaltstack\u548cansible\u90fd\u662f\u7528python\u5f00\u53d1\u7684\u3002ansible\u5176\u5b9e\u51c6\u786e\u7684\u8bf4\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6846\u67b6\uff0c\u5b83\u8981\u57fa\u4e8e\u5f88\u591a\u5176\u4ed6\u7684python\u6a21\u5757\u624d\u80fd\u5de5\u4f5c\u7684\uff0c\u6240\u4ee5\u5728\u5b89\u88c5ansible\u7684\u65f6\u5019\u4f60\u8981\u518d\u88c5\u5f88\u591a\u5176\u4ed6\u7684\u4f9d\u8d56\u5305\u7684\u3002 \u597d\u5904\u4e4b\u4e00\u662f\u4f7f\u7528\u8005\u53ef\u4ee5\u5f00\u53d1\u81ea\u5df1\u7684\u6a21\u5757\uff0c\u653e\u5728\u91cc\u9762\u4f7f\u7528\u3002\u7b2c\u4e8c\u4e2a\u597d\u5904\u662f\u65e0\u9700\u5728\u5ba2\u6237\u7aef\u5b89\u88c5agent\uff0c\u66f4\u65b0\u65f6\uff0c\u53ea\u9700\u5728\u64cd\u4f5c\u673a\u4e0a\u8fdb\u884c\u4e00\u6b21\u66f4\u65b0\u5373\u53ef\u3002\u7b2c\u4e09\u4e2a\u597d\u5904\u662f\u6279\u91cf\u4efb\u52a1\u6267\u884c\u53ef\u4ee5\u5199\u6210\u811a\u672c\uff0c\u800c\u4e14\u4e0d\u7528\u5206\u53d1\u5230\u8fdc\u7a0b\u5c31\u53ef\u4ee5\u6267\u884c\u3002 ( 1 ) \u3001 python2 . 7 \u5b89\u88c5,\u5347\u7ea7\u5230 2 . 7 . 9 https : // www . python . org / ftp / python / 2 . 7 . 9 / Python - 2 . 7 . 9 . tgz # tar xvzf Python - 2 . 7 . 9 . tgz # cd Python - 2 . 7 . 9 # . / configure -- prefix =/ usr / local # make && make install ## \u5c06 python \u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u6807\u51c6\u76ee\u5f55\uff0c\u4ee5\u907f\u514d\u7f16\u8bd1 ansible \u65f6\uff0c\u627e\u4e0d\u5230\u6240\u9700\u7684\u5934\u6587\u4ef6 # cd / usr / local / include / python2 . 7 # cp - a . /* /usr/local/include/ ## \u5907\u4efd\u65e7\u7248\u672c\u7684python\uff0c\u5e76\u7b26\u53f7\u94fe\u63a5\u65b0\u7248\u672c\u7684python # cd /usr/bin #\u65e7\u7248\u672cPython\u8def\u5f84 # mv python python.old #\u5907\u4efd\u65e7\u7248\u672c # ln -s /usr/local/bin/python2 /usr/local/bin/python # rm -f /usr/bin/python && cp /usr/local/bin/python2 /usr/bin/python ## \u4fee\u6539yum\u811a\u672c\uff0c\u4f7f\u5176\u6307\u5411\u65e7\u7248\u672c\u7684python\uff0c\u5df2\u907f\u514d\u5176\u65e0\u6cd5\u8fd0\u884c # vim /usr/bin/yum #!/usr/bin/python --> #!/usr/bin/python2.7 No module named urlgrabber.grabber\u62a5\u9519\u5904\u7406 vim /usr/libexec/urlgrabber-ext-down #! /usr/bin/python --> #! /usr/bin/python2.7 python --version\u9a8c\u8bc1\u7248\u672c Tips :\u82e5python\u7248\u672c\u5df2\u7ecf\u4e3a2.6\u6216\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u518d\u91cd\u88c5python\uff0c\u53ea\u662f\u8fd8\u9700\u8981\u5b89\u88c5python\u5f00\u53d1\u5305\uff1apython-dev(\u6709\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4e3apython-devel) (2)\u3001setuptools pip wheel\u6a21\u5757\u5b89\u88c5 wget https://bootstrap.pypa.io/get-pip.py python get-pip.py python -m pip install --upgrade pip setuptools wheel #\u5347\u7ea7pip setuptools wheel \u5b89\u88c5\u597dsetuptools\u540e\u5c31\u53ef\u4ee5\u5229\u7528easy_install\u6216pip\u8fd9\u4e2a\u5de5\u5177\u5b89\u88c5\u4e0b\u9762\u7684python\u6a21\u5757\u4e86 easy_install pycrypto pyyaml jinja2 paramiko simplejson pip install pycrypto pyyaml jinja2 paramiko simplejson (3)\u3001ansible\u5b89\u88c5 https://github.com/ansible/ansible/archive/v1.7.2.tar.gz # tar xvzf ansible-1.7.2.tar.gz # cd ansible-1.7.2 # python setup.py install (4)\u3001SSH\u514d\u5bc6\u94a5\u767b\u5f55\u8bbe\u7f6e ## \u751f\u6210\u516c\u94a5/\u79c1\u94a5 # ssh-keygen -t rsa -P '' ## \u5199\u5165\u4fe1\u4efb\u6587\u4ef6\uff08\u5c06/root/.ssh/id_rsa_storm1.pub\u5206\u53d1\u5230\u5176\u4ed6\u670d\u52a1\u5668\uff0c\u5e76\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u5982\u4e0b\u6307\u4ee4\uff09\uff1a # cat /root/.ssh/id_rsa_storm1.pub >> /root/.ssh/authorized_keys # chmod 600 /root/.ssh/authorized_keys (5)\u3001\u62f7\u8d1d\uff0c\u751f\u6210ansible\u914d\u7f6e\u6587\u4ef6 a \u914d\u7f6e\u6587\u4ef6/etc/ansible/ansible.cfg # mkdir -p /etc/ansible #cp ansible-1.7.2/examples/ansible.cfg /etc/ansible/ b \u914d\u7f6e\u6587\u4ef6/etc/ansible/hosts # vim /etc/ansible/hosts [test] 192.168.110.20 192.168.110.30 \u6d4b\u8bd5 # ansible test -m command -a 'uptime' ## \u7528\u6765\u6d4b\u8bd5\u8fdc\u7a0b\u4e3b\u673a\u7684\u8fd0\u884c\u72b6\u6001 # ansible test -m ping \u53c2\u770b\u6240\u6709\u7684\u53c2\u6570 ansible-doc -l","title":"Centos\u4e0b\u5b89\u88c5\u90e8\u7f72"},{"location":"Ansible/#ansible_1","text":"\u9700\u8981\u63d0\u524d\u51c6\u5907\u7684\u5b89\u88c5\u5305\u811a\u672c,install_ansible.sh # !/ bin / sh # 1 .\u521b\u5efa\u6587\u4ef6\u5939 mkdir / opt / ansible # 2 . \u79fb\u52a8\u8d44\u6e90\u5230\u76ee\u6807\u6587\u4ef6\u5939 cp - rf . / res /* /opt/ansible/ # 3. \u5b89\u88c5python cd /opt/ansible tar xvzf Python-2.7.tgz rm -f Python-2.7.tgz cd Python-2.7 ./configure --prefix=/usr/local make make install cd /usr/local/include/python2.7 cp -a ./* /usr/local/include/ cd /usr/bin mv python python.old ln -s -f /usr/local/bin/python2.7 /usr/local/bin/python rm -f /usr/bin/python && cp /usr/local/bin/python2.7 /usr/bin/python # 4. \u5b89\u88c5setuptools cd /opt/ansible tar xvzf setuptools-7.0.tar.gz rm -f setuptools-7.0.tar.gz cd setuptools-7.0 python setup.py install # 5. \u5b89\u88c5pycrypto cd /opt/ansible tar xvzf pycrypto-2.6.tar.gz rm -f pycrypto-2.6.tar.gz cd pycrypto-2.6 python setup.py install # 6. \u5b89\u88c5PyYAML cd /opt/ansible tar xvzf yaml-0.1.5.tar.gz rm -f yaml-0.1.5.tar.gz cd yaml-0.1.5 ./configure --prefix=/usr/local make --jobs=`grep processor /proc/cpuinfo | wc -l` make install #\u51fa\u95ee\u9898\u4e86 cd /opt/ansible tar xvzf PyYAML-3.11.tar.gz rm -f PyYAML-3.11.tar.gz cd PyYAML-3.11 python setup.py install # 7. \u5b89\u88c5MarkupSafe cd /opt/ansible tar xvzf MarkupSafe-0.9.3.tar.gz rm -f MarkupSafe-0.9.3.tar.gz cd MarkupSafe-0.9.3 python setup.py install cd /opt/ansible tar xvzf Jinja2-2.7.3.tar.gz rm -f Jinja2-2.7.3.tar.gz cd Jinja2-2.7.3 python setup.py install # 8. \u5b89\u88c5ecdsa cd /opt/ansible tar xvzf ecdsa-0.13.tar.gz rm -f ecdsa-0.13.tar.gz cd ecdsa-0.13 python setup.py install cd /opt/ansible tar xvzf paramiko-1.15.1.tar.gz rm -f paramiko-1.15.1.tar.gz cd paramiko-1.15.1 python setup.py install # 9. \u5b89\u88c5simplejson cd /opt/ansible tar xvzf simplejson-3.8.2.tar.gz rm -f simplejson-3.8.2.tar.gz cd simplejson-3.8.2 python setup.py install cd /opt/ansible tar xvzf ansible-latest.tar.gz rm -f ansible-latest.tar.gz cd ansible-2.1.0.0 python setup.py install","title":"ansible\u7684\u79bb\u7ebf\u5b89\u88c5"},{"location":"Ansible/#apollo-","text":"","title":"Apollo--\u643a\u7a0b\u6846\u67b6\u90e8\u95e8\u7814\u53d1\u7684\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0"},{"location":"Apache/","text":"Apache&PHP-FPM \u00b6 apachectl\u9009\u578b \u00b6 configtest\uff1a\u68c0\u67e5\u8bbe\u7f6e\u6587\u4ef6\u4e2d\u7684\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff1b fullstatus\uff1a\u663e\u793a\u670d\u52a1\u5668\u5b8c\u6574\u7684\u72b6\u6001\u4fe1\u606f\uff1b graceful\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff0c\u4f46\u4e0d\u4f1a\u4e2d\u65ad\u539f\u6709\u7684\u8fde\u63a5\uff1b help\uff1a\u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff1b restart\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff1b start\uff1a\u542f\u52a8Apache\u670d\u52a1\u5668\uff1b status\uff1a\u663e\u793a\u670d\u52a1\u5668\u6458\u8981\u7684\u72b6\u6001\u4fe1\u606f\uff1b stop\uff1a\u505c\u6b62Apache\u670d\u52a1\u5668\u3002 php\u79bb\u7ebf\u5b89\u88c5\uff1a cannot find config.m4. make sure that you run '/usr/local/php/bin/phpize' in the top level source directory of the module \u5176\u5b9e\u62a5\u8fd9\u4e2a\u9519\u7684\u539f\u56e0\u662f\uff0c\u5728\u6267\u884cphpize\u65f6\uff0c\u4e00\u5b9a\u8981\u5728\u9700\u8981\u6269\u5c55\u7f16\u8bd1\u7684php\u6a21\u5757\u76ee\u5f55\u4e2d\u8fdb\u884c/usr/local/php/bin/phpize \u8fd9\u6837\u624d\u4e0d\u4f1a\u62a5\u9519\u3002 \u5b89\u88c5php-ldap\u6a21\u5757 php-ldap\u6a21\u5757\u4f5c\u7528\u5c31\u662f\u5b9e\u73b0ldap\u8ba4\u8bc1\uff0c\u56e0\u6b64\u9700\u8981\u5b89\u88c5 1 \u3001\u5b89\u88c5\u8f6f\u4ef6\u5305\u89e3\u51b3\u4f9d\u8d56 yum install openldap yum install openldap-devel 2 \u3001\u62f7\u8d1d\u5e93\u6587\u4ef6 cp -frp /usr/lib64/libldap* /usr/lib/ 3 \u3001\u7f16\u8bd1\u5b89\u88c5php-ldap\u6a21\u5757 cd /usr/local/src/php-7.0.21/ext/ldap/\u3000\u3000 ( \u6e90\u7801\u5305\u8def\u5f84 ) /usr/local/php/bin/phpize \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 ( php\u5b89\u88c5\u8def\u5f84 ) ./configure --with-php-config = /usr/local/php/bin/php-config ( php\u5b89\u88c5\u8def\u5f84 ) make make install 4 \u3001\u7136\u540e\u5728php\u7684php.ini\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0http://120.76.120.248 \u5f00\u542fPHP\u7f13\u5b58 - \u4fee\u6539php.ini\u4e2d\uff1a realpath_cache_size = 4096k realpath_cache_ttl = 120 \u5f00\u542fNGINX\u7684GZIP\u5e76\u9690\u85cf\u7248\u672c\u53f7 - \u4fee\u6539nginx.conf\u4e2d\uff1a server_tokens off ; gzip on ; gzip_min_length 20k ; gzip_buffers 4 16k ; gzip_comp_level 4 ; gzip_types text/plain text/css text/javascript application/x-javascript application/xml application/x-httpd-php ; server { listen 80 default ; return 444 ; } php-fpm.conf\u91cd\u8981\u53c2\u6570\u8be6\u89e3 pid = run/php-fpm.pid pid\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/run/php-fpm.pid\uff0c\u5efa\u8bae\u5f00\u542f \u00b6 error_log = log/php-fpm.log \u9519\u8bef\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/log/php-fpm.log \u00b6 log_level = notice \u9519\u8bef\u7ea7\u522b. \u53ef\u7528\u7ea7\u522b\u4e3a: alert\uff08\u5fc5\u987b\u7acb\u5373\u5904\u7406\uff09, error\uff08\u9519\u8bef\u60c5\u51b5\uff09, warning\uff08\u8b66\u544a\u60c5\u51b5\uff09, notice\uff08\u4e00\u822c\u91cd\u8981\u4fe1\u606f\uff09, debug\uff08\u8c03\u8bd5\u4fe1\u606f\uff09. \u9ed8\u8ba4: notice. \u00b6 emergency_restart_threshold = 60 emergency_restart_interval = 60s \u8868\u793a\u5728emergency_restart_interval\u6240\u8bbe\u503c\u5185\u51fa\u73b0SIGSEGV\u6216\u8005SIGBUS\u9519\u8bef\u7684php-cgi\u8fdb\u7a0b\u6570\u5982\u679c\u8d85\u8fc7 emergency_restart_threshold\u4e2a\uff0cphp-fpm\u5c31\u4f1a\u4f18\u96c5\u91cd\u542f\u3002\u8fd9\u4e24\u4e2a\u9009\u9879\u4e00\u822c\u4fdd\u6301\u9ed8\u8ba4\u503c\u3002 \u00b6 process_control_timeout = 0 \u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u63a5\u53d7\u4e3b\u8fdb\u7a0b\u590d\u7528\u4fe1\u53f7\u7684\u8d85\u65f6\u65f6\u95f4. \u53ef\u7528\u5355\u4f4d: s(\u79d2), m(\u5206), h(\u5c0f\u65f6), \u6216\u8005 d(\u5929) \u9ed8\u8ba4\u5355\u4f4d: s(\u79d2). \u9ed8\u8ba4\u503c: 0. \u00b6 daemonize = yes \u540e\u53f0\u6267\u884cfpm,\u9ed8\u8ba4\u503c\u4e3ayes\uff0c\u5982\u679c\u4e3a\u4e86\u8c03\u8bd5\u53ef\u4ee5\u6539\u4e3ano\u3002\u5728FPM\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u8bbe\u7f6e\u6765\u8fd0\u884c\u591a\u4e2a\u8fdb\u7a0b\u6c60\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u9488\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u5355\u72ec\u8bbe\u7f6e\u3002 \u00b6 listen = 127.0.0.1:9000 fpm\u76d1\u542c\u7aef\u53e3\uff0c\u5373nginx\u4e2dphp\u5904\u7406\u7684\u5730\u5740\uff0c\u4e00\u822c\u9ed8\u8ba4\u503c\u5373\u53ef\u3002\u53ef\u7528\u683c\u5f0f\u4e3a: 'ip:port', 'port', '/path/to/unix/socket'. \u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u90fd\u9700\u8981\u8bbe\u7f6e. \u00b6 listen.backlog = -1 backlog\u6570\uff0c-1\u8868\u793a\u65e0\u9650\u5236\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\uff0c\u6b64\u884c\u6ce8\u91ca\u6389\u5c31\u884c\u3002backlog\u542b\u4e49\u53c2\u8003\uff1a http://www.3gyou.cc/?p=41 \u00b6 listen.allowed_clients = 127.0.0.1 \u5141\u8bb8\u8bbf\u95eeFastCGI\u8fdb\u7a0b\u7684IP\uff0c\u8bbe\u7f6eany\u4e3a\u4e0d\u9650\u5236IP\uff0c\u5982\u679c\u8981\u8bbe\u7f6e\u5176\u4ed6\u4e3b\u673a\u7684nginx\u4e5f\u80fd\u8bbf\u95ee\u8fd9\u53f0FPM\u8fdb\u7a0b\uff0clisten\u5904\u8981\u8bbe\u7f6e\u6210\u672c\u5730\u53ef\u88ab\u8bbf\u95ee\u7684IP\u3002\u9ed8\u8ba4\u503c\u662fany\u3002\u6bcf\u4e2a\u5730\u5740\u662f\u7528\u9017\u53f7\u5206\u9694. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u6216\u8005\u4e3a\u7a7a\uff0c\u5219\u5141\u8bb8\u4efb\u4f55\u670d\u52a1\u5668\u8bf7\u6c42\u8fde\u63a5 \u00b6 listen.owner = www listen.group = www listen.mode = 0666 unix socket\u8bbe\u7f6e\u9009\u9879\uff0c\u5982\u679c\u4f7f\u7528tcp\u65b9\u5f0f\u8bbf\u95ee\uff0c\u8fd9\u91cc\u6ce8\u91ca\u5373\u53ef\u3002 \u00b6 user = www group = www \u542f\u52a8\u8fdb\u7a0b\u7684\u5e10\u6237\u548c\u7ec4 \u00b6 pm = dynamic #\u5bf9\u4e8e\u4e13\u7528\u670d\u52a1\u5668\uff0cpm\u53ef\u4ee5\u8bbe\u7f6e\u4e3astatic\u3002 \u5982\u4f55\u63a7\u5236\u5b50\u8fdb\u7a0b\uff0c\u9009\u9879\u6709static\u548cdynamic\u3002\u5982\u679c\u9009\u62e9static\uff0c\u5219\u7531pm.max_children\u6307\u5b9a\u56fa\u5b9a\u7684\u5b50\u8fdb\u7a0b\u6570\u3002\u5982\u679c\u9009\u62e9dynamic\uff0c\u5219\u7531\u4e0b\u5f00\u53c2\u6570\u51b3\u5b9a\uff1a \u00b6 pm.max_children #\uff0c\u5b50\u8fdb\u7a0b\u6700\u5927\u6570 pm.start_servers #\uff0c\u542f\u52a8\u65f6\u7684\u8fdb\u7a0b\u6570 pm.min_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5c0f\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5c0f\u4e8e\u6b64\u503c\uff0c\u5219\u521b\u5efa\u65b0\u7684\u5b50\u8fdb\u7a0b pm.max_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5927\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5927\u4e8e\u6b64\u503c\uff0c\u6b64\u8fdb\u884c\u6e05\u7406 pm.max_requests = 1000 \u8bbe\u7f6e\u6bcf\u4e2a\u5b50\u8fdb\u7a0b\u91cd\u751f\u4e4b\u524d\u670d\u52a1\u7684\u8bf7\u6c42\u6570. \u5bf9\u4e8e\u53ef\u80fd\u5b58\u5728\u5185\u5b58\u6cc4\u6f0f\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u6765\u8bf4\u662f\u975e\u5e38\u6709\u7528\u7684. \u5982\u679c\u8bbe\u7f6e\u4e3a '0' \u5219\u4e00\u76f4\u63a5\u53d7\u8bf7\u6c42. \u7b49\u540c\u4e8e PHP_FCGI_MAX_REQUESTS \u73af\u5883\u53d8\u91cf. \u9ed8\u8ba4\u503c: 0. \u00b6 pm.status_path = /status FPM\u72b6\u6001\u9875\u9762\u7684\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95ee\u72b6\u6001\u9875\u9762. \u9ed8\u8ba4\u503c: none. munin\u76d1\u63a7\u4f1a\u4f7f\u7528\u5230 \u00b6 ping.path = /ping FPM\u76d1\u63a7\u9875\u9762\u7684ping\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95eeping\u9875\u9762. \u8be5\u9875\u9762\u7528\u4e8e\u5916\u90e8\u68c0\u6d4bFPM\u662f\u5426\u5b58\u6d3b\u5e76\u4e14\u53ef\u4ee5\u54cd\u5e94\u8bf7\u6c42. \u8bf7\u6ce8\u610f\u5fc5\u987b\u4ee5\u659c\u7ebf\u5f00\u5934 (/)\u3002 \u00b6 ping.response = pong \u7528\u4e8e\u5b9a\u4e49ping\u8bf7\u6c42\u7684\u8fd4\u56de\u76f8\u5e94. \u8fd4\u56de\u4e3a HTTP 200 \u7684 text/plain \u683c\u5f0f\u6587\u672c. \u9ed8\u8ba4\u503c: pong. \u00b6 request_terminate_timeout = 0 \u8bbe\u7f6e\u5355\u4e2a\u8bf7\u6c42\u7684\u8d85\u65f6\u4e2d\u6b62\u65f6\u95f4. \u8be5\u9009\u9879\u53ef\u80fd\u4f1a\u5bf9php.ini\u8bbe\u7f6e\u4e2d\u7684'max_execution_time'\u56e0\u4e3a\u67d0\u4e9b\u7279\u6b8a\u539f\u56e0\u6ca1\u6709\u4e2d\u6b62\u8fd0\u884c\u7684\u811a\u672c\u6709\u7528. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off'.\u5f53\u7ecf\u5e38\u51fa\u73b0502\u9519\u8bef\u65f6\u53ef\u4ee5\u5c1d\u8bd5\u66f4\u6539\u6b64\u9009\u9879\u3002 \u00b6 request_slowlog_timeout = 10s \u5f53\u4e00\u4e2a\u8bf7\u6c42\u8be5\u8bbe\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u5c31\u4f1a\u5c06\u5bf9\u5e94\u7684PHP\u8c03\u7528\u5806\u6808\u4fe1\u606f\u5b8c\u6574\u5199\u5165\u5230\u6162\u65e5\u5fd7\u4e2d. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off' \u00b6 slowlog = log/$pool.log.slow \u6162\u8bf7\u6c42\u7684\u8bb0\u5f55\u65e5\u5fd7,\u914d\u5408request_slowlog_timeout\u4f7f\u7528 \u00b6 rlimit_files = 1024 \u8bbe\u7f6e\u6587\u4ef6\u6253\u5f00\u63cf\u8ff0\u7b26\u7684rlimit\u9650\u5236. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c\u9ed8\u8ba4\u53ef\u6253\u5f00\u53e5\u67c4\u662f1024\uff0c\u53ef\u4f7f\u7528 ulimit -n\u67e5\u770b\uff0culimit -n 2048\u4fee\u6539\u3002 \u00b6 rlimit_core = 0 \u8bbe\u7f6e\u6838\u5fc3rlimit\u6700\u5927\u9650\u5236\u503c. \u53ef\u7528\u503c: 'unlimited' \u30010\u6216\u8005\u6b63\u6574\u6570. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c. \u00b6 chroot = \u542f\u52a8\u65f6\u7684Chroot\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219chroot\u4e0d\u88ab\u4f7f\u7528. \u00b6 chdir = \u8bbe\u7f6e\u542f\u52a8\u76ee\u5f55\uff0c\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8Chdir\u5230\u8be5\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u9ed8\u8ba4\u503c: \u5f53\u524d\u76ee\u5f55\uff0c\u6216\u8005/\u76ee\u5f55\uff08chroot\u65f6\uff09 \u00b6 catch_workers_output = yes \u91cd\u5b9a\u5411\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684stdout\u548cstderr\u5230\u4e3b\u8981\u7684\u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\u4e2d. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, stdout \u548c stderr \u5c06\u4f1a\u6839\u636eFastCGI\u7684\u89c4\u5219\u88ab\u91cd\u5b9a\u5411\u5230 /dev/null . \u9ed8\u8ba4\u503c: \u7a7a. \u00b6","title":"Apache"},{"location":"Apache/#apachephp-fpm","text":"","title":"Apache&amp;PHP-FPM"},{"location":"Apache/#apachectl","text":"configtest\uff1a\u68c0\u67e5\u8bbe\u7f6e\u6587\u4ef6\u4e2d\u7684\u8bed\u6cd5\u662f\u5426\u6b63\u786e\uff1b fullstatus\uff1a\u663e\u793a\u670d\u52a1\u5668\u5b8c\u6574\u7684\u72b6\u6001\u4fe1\u606f\uff1b graceful\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff0c\u4f46\u4e0d\u4f1a\u4e2d\u65ad\u539f\u6709\u7684\u8fde\u63a5\uff1b help\uff1a\u663e\u793a\u5e2e\u52a9\u4fe1\u606f\uff1b restart\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff1b start\uff1a\u542f\u52a8Apache\u670d\u52a1\u5668\uff1b status\uff1a\u663e\u793a\u670d\u52a1\u5668\u6458\u8981\u7684\u72b6\u6001\u4fe1\u606f\uff1b stop\uff1a\u505c\u6b62Apache\u670d\u52a1\u5668\u3002 php\u79bb\u7ebf\u5b89\u88c5\uff1a cannot find config.m4. make sure that you run '/usr/local/php/bin/phpize' in the top level source directory of the module \u5176\u5b9e\u62a5\u8fd9\u4e2a\u9519\u7684\u539f\u56e0\u662f\uff0c\u5728\u6267\u884cphpize\u65f6\uff0c\u4e00\u5b9a\u8981\u5728\u9700\u8981\u6269\u5c55\u7f16\u8bd1\u7684php\u6a21\u5757\u76ee\u5f55\u4e2d\u8fdb\u884c/usr/local/php/bin/phpize \u8fd9\u6837\u624d\u4e0d\u4f1a\u62a5\u9519\u3002 \u5b89\u88c5php-ldap\u6a21\u5757 php-ldap\u6a21\u5757\u4f5c\u7528\u5c31\u662f\u5b9e\u73b0ldap\u8ba4\u8bc1\uff0c\u56e0\u6b64\u9700\u8981\u5b89\u88c5 1 \u3001\u5b89\u88c5\u8f6f\u4ef6\u5305\u89e3\u51b3\u4f9d\u8d56 yum install openldap yum install openldap-devel 2 \u3001\u62f7\u8d1d\u5e93\u6587\u4ef6 cp -frp /usr/lib64/libldap* /usr/lib/ 3 \u3001\u7f16\u8bd1\u5b89\u88c5php-ldap\u6a21\u5757 cd /usr/local/src/php-7.0.21/ext/ldap/\u3000\u3000 ( \u6e90\u7801\u5305\u8def\u5f84 ) /usr/local/php/bin/phpize \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 ( php\u5b89\u88c5\u8def\u5f84 ) ./configure --with-php-config = /usr/local/php/bin/php-config ( php\u5b89\u88c5\u8def\u5f84 ) make make install 4 \u3001\u7136\u540e\u5728php\u7684php.ini\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0http://120.76.120.248 \u5f00\u542fPHP\u7f13\u5b58 - \u4fee\u6539php.ini\u4e2d\uff1a realpath_cache_size = 4096k realpath_cache_ttl = 120 \u5f00\u542fNGINX\u7684GZIP\u5e76\u9690\u85cf\u7248\u672c\u53f7 - \u4fee\u6539nginx.conf\u4e2d\uff1a server_tokens off ; gzip on ; gzip_min_length 20k ; gzip_buffers 4 16k ; gzip_comp_level 4 ; gzip_types text/plain text/css text/javascript application/x-javascript application/xml application/x-httpd-php ; server { listen 80 default ; return 444 ; } php-fpm.conf\u91cd\u8981\u53c2\u6570\u8be6\u89e3 pid = run/php-fpm.pid","title":"apachectl\u9009\u578b"},{"location":"Apache/#pidvarrunphp-fpmpid","text":"error_log = log/php-fpm.log","title":"pid\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/run/php-fpm.pid\uff0c\u5efa\u8bae\u5f00\u542f"},{"location":"Apache/#varlogphp-fpmlog","text":"log_level = notice","title":"\u9519\u8bef\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/log/php-fpm.log"},{"location":"Apache/#alert-error-warning-notice-debug-notice","text":"emergency_restart_threshold = 60 emergency_restart_interval = 60s","title":"\u9519\u8bef\u7ea7\u522b. \u53ef\u7528\u7ea7\u522b\u4e3a: alert\uff08\u5fc5\u987b\u7acb\u5373\u5904\u7406\uff09, error\uff08\u9519\u8bef\u60c5\u51b5\uff09, warning\uff08\u8b66\u544a\u60c5\u51b5\uff09, notice\uff08\u4e00\u822c\u91cd\u8981\u4fe1\u606f\uff09, debug\uff08\u8c03\u8bd5\u4fe1\u606f\uff09. \u9ed8\u8ba4: notice."},{"location":"Apache/#emergency_restart_intervalsigsegvsigbusphp-cgi-emergency_restart_thresholdphp-fpm","text":"process_control_timeout = 0","title":"\u8868\u793a\u5728emergency_restart_interval\u6240\u8bbe\u503c\u5185\u51fa\u73b0SIGSEGV\u6216\u8005SIGBUS\u9519\u8bef\u7684php-cgi\u8fdb\u7a0b\u6570\u5982\u679c\u8d85\u8fc7 emergency_restart_threshold\u4e2a\uff0cphp-fpm\u5c31\u4f1a\u4f18\u96c5\u91cd\u542f\u3002\u8fd9\u4e24\u4e2a\u9009\u9879\u4e00\u822c\u4fdd\u6301\u9ed8\u8ba4\u503c\u3002"},{"location":"Apache/#s-m-h-d-s-0","text":"daemonize = yes","title":"\u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u63a5\u53d7\u4e3b\u8fdb\u7a0b\u590d\u7528\u4fe1\u53f7\u7684\u8d85\u65f6\u65f6\u95f4. \u53ef\u7528\u5355\u4f4d: s(\u79d2), m(\u5206), h(\u5c0f\u65f6), \u6216\u8005 d(\u5929) \u9ed8\u8ba4\u5355\u4f4d: s(\u79d2). \u9ed8\u8ba4\u503c: 0."},{"location":"Apache/#fpmyesnofpm","text":"listen = 127.0.0.1:9000","title":"\u540e\u53f0\u6267\u884cfpm,\u9ed8\u8ba4\u503c\u4e3ayes\uff0c\u5982\u679c\u4e3a\u4e86\u8c03\u8bd5\u53ef\u4ee5\u6539\u4e3ano\u3002\u5728FPM\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u8bbe\u7f6e\u6765\u8fd0\u884c\u591a\u4e2a\u8fdb\u7a0b\u6c60\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u9488\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u5355\u72ec\u8bbe\u7f6e\u3002"},{"location":"Apache/#fpmnginxphp-ipport-port-pathtounixsocket","text":"listen.backlog = -1","title":"fpm\u76d1\u542c\u7aef\u53e3\uff0c\u5373nginx\u4e2dphp\u5904\u7406\u7684\u5730\u5740\uff0c\u4e00\u822c\u9ed8\u8ba4\u503c\u5373\u53ef\u3002\u53ef\u7528\u683c\u5f0f\u4e3a: 'ip:port', 'port', '/path/to/unix/socket'. \u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u90fd\u9700\u8981\u8bbe\u7f6e."},{"location":"Apache/#backlog-1backloghttpwww3gyouccp41","text":"listen.allowed_clients = 127.0.0.1","title":"backlog\u6570\uff0c-1\u8868\u793a\u65e0\u9650\u5236\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\uff0c\u6b64\u884c\u6ce8\u91ca\u6389\u5c31\u884c\u3002backlog\u542b\u4e49\u53c2\u8003\uff1ahttp://www.3gyou.cc/?p=41"},{"location":"Apache/#fastcgiipanyipnginxfpmlistenipany","text":"listen.owner = www listen.group = www listen.mode = 0666","title":"\u5141\u8bb8\u8bbf\u95eeFastCGI\u8fdb\u7a0b\u7684IP\uff0c\u8bbe\u7f6eany\u4e3a\u4e0d\u9650\u5236IP\uff0c\u5982\u679c\u8981\u8bbe\u7f6e\u5176\u4ed6\u4e3b\u673a\u7684nginx\u4e5f\u80fd\u8bbf\u95ee\u8fd9\u53f0FPM\u8fdb\u7a0b\uff0clisten\u5904\u8981\u8bbe\u7f6e\u6210\u672c\u5730\u53ef\u88ab\u8bbf\u95ee\u7684IP\u3002\u9ed8\u8ba4\u503c\u662fany\u3002\u6bcf\u4e2a\u5730\u5740\u662f\u7528\u9017\u53f7\u5206\u9694. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u6216\u8005\u4e3a\u7a7a\uff0c\u5219\u5141\u8bb8\u4efb\u4f55\u670d\u52a1\u5668\u8bf7\u6c42\u8fde\u63a5"},{"location":"Apache/#unix-sockettcp","text":"user = www group = www","title":"unix socket\u8bbe\u7f6e\u9009\u9879\uff0c\u5982\u679c\u4f7f\u7528tcp\u65b9\u5f0f\u8bbf\u95ee\uff0c\u8fd9\u91cc\u6ce8\u91ca\u5373\u53ef\u3002"},{"location":"Apache/#_1","text":"pm = dynamic #\u5bf9\u4e8e\u4e13\u7528\u670d\u52a1\u5668\uff0cpm\u53ef\u4ee5\u8bbe\u7f6e\u4e3astatic\u3002","title":"\u542f\u52a8\u8fdb\u7a0b\u7684\u5e10\u6237\u548c\u7ec4"},{"location":"Apache/#staticdynamicstaticpmmax_childrendynamic","text":"pm.max_children #\uff0c\u5b50\u8fdb\u7a0b\u6700\u5927\u6570 pm.start_servers #\uff0c\u542f\u52a8\u65f6\u7684\u8fdb\u7a0b\u6570 pm.min_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5c0f\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5c0f\u4e8e\u6b64\u503c\uff0c\u5219\u521b\u5efa\u65b0\u7684\u5b50\u8fdb\u7a0b pm.max_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5927\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5927\u4e8e\u6b64\u503c\uff0c\u6b64\u8fdb\u884c\u6e05\u7406 pm.max_requests = 1000","title":"\u5982\u4f55\u63a7\u5236\u5b50\u8fdb\u7a0b\uff0c\u9009\u9879\u6709static\u548cdynamic\u3002\u5982\u679c\u9009\u62e9static\uff0c\u5219\u7531pm.max_children\u6307\u5b9a\u56fa\u5b9a\u7684\u5b50\u8fdb\u7a0b\u6570\u3002\u5982\u679c\u9009\u62e9dynamic\uff0c\u5219\u7531\u4e0b\u5f00\u53c2\u6570\u51b3\u5b9a\uff1a"},{"location":"Apache/#0-php_fcgi_max_requests-0","text":"pm.status_path = /status","title":"\u8bbe\u7f6e\u6bcf\u4e2a\u5b50\u8fdb\u7a0b\u91cd\u751f\u4e4b\u524d\u670d\u52a1\u7684\u8bf7\u6c42\u6570. \u5bf9\u4e8e\u53ef\u80fd\u5b58\u5728\u5185\u5b58\u6cc4\u6f0f\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u6765\u8bf4\u662f\u975e\u5e38\u6709\u7528\u7684. \u5982\u679c\u8bbe\u7f6e\u4e3a '0' \u5219\u4e00\u76f4\u63a5\u53d7\u8bf7\u6c42. \u7b49\u540c\u4e8e PHP_FCGI_MAX_REQUESTS \u73af\u5883\u53d8\u91cf. \u9ed8\u8ba4\u503c: 0."},{"location":"Apache/#fpm-none-munin","text":"ping.path = /ping","title":"FPM\u72b6\u6001\u9875\u9762\u7684\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95ee\u72b6\u6001\u9875\u9762. \u9ed8\u8ba4\u503c: none. munin\u76d1\u63a7\u4f1a\u4f7f\u7528\u5230"},{"location":"Apache/#fpmping-ping-fpm","text":"ping.response = pong","title":"FPM\u76d1\u63a7\u9875\u9762\u7684ping\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95eeping\u9875\u9762. \u8be5\u9875\u9762\u7528\u4e8e\u5916\u90e8\u68c0\u6d4bFPM\u662f\u5426\u5b58\u6d3b\u5e76\u4e14\u53ef\u4ee5\u54cd\u5e94\u8bf7\u6c42. \u8bf7\u6ce8\u610f\u5fc5\u987b\u4ee5\u659c\u7ebf\u5f00\u5934 (/)\u3002"},{"location":"Apache/#ping-http-200-textplain-pong","text":"request_terminate_timeout = 0","title":"\u7528\u4e8e\u5b9a\u4e49ping\u8bf7\u6c42\u7684\u8fd4\u56de\u76f8\u5e94. \u8fd4\u56de\u4e3a HTTP 200 \u7684 text/plain \u683c\u5f0f\u6587\u672c. \u9ed8\u8ba4\u503c: pong."},{"location":"Apache/#phpinimax_execution_time-0-off502","text":"request_slowlog_timeout = 10s","title":"\u8bbe\u7f6e\u5355\u4e2a\u8bf7\u6c42\u7684\u8d85\u65f6\u4e2d\u6b62\u65f6\u95f4. \u8be5\u9009\u9879\u53ef\u80fd\u4f1a\u5bf9php.ini\u8bbe\u7f6e\u4e2d\u7684'max_execution_time'\u56e0\u4e3a\u67d0\u4e9b\u7279\u6b8a\u539f\u56e0\u6ca1\u6709\u4e2d\u6b62\u8fd0\u884c\u7684\u811a\u672c\u6709\u7528. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off'.\u5f53\u7ecf\u5e38\u51fa\u73b0502\u9519\u8bef\u65f6\u53ef\u4ee5\u5c1d\u8bd5\u66f4\u6539\u6b64\u9009\u9879\u3002"},{"location":"Apache/#php-0-off","text":"slowlog = log/$pool.log.slow","title":"\u5f53\u4e00\u4e2a\u8bf7\u6c42\u8be5\u8bbe\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u5c31\u4f1a\u5c06\u5bf9\u5e94\u7684PHP\u8c03\u7528\u5806\u6808\u4fe1\u606f\u5b8c\u6574\u5199\u5165\u5230\u6162\u65e5\u5fd7\u4e2d. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off'"},{"location":"Apache/#request_slowlog_timeout","text":"rlimit_files = 1024","title":"\u6162\u8bf7\u6c42\u7684\u8bb0\u5f55\u65e5\u5fd7,\u914d\u5408request_slowlog_timeout\u4f7f\u7528"},{"location":"Apache/#rlimit-1024-ulimit-nulimit-n-2048","text":"rlimit_core = 0","title":"\u8bbe\u7f6e\u6587\u4ef6\u6253\u5f00\u63cf\u8ff0\u7b26\u7684rlimit\u9650\u5236. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c\u9ed8\u8ba4\u53ef\u6253\u5f00\u53e5\u67c4\u662f1024\uff0c\u53ef\u4f7f\u7528 ulimit -n\u67e5\u770b\uff0culimit -n 2048\u4fee\u6539\u3002"},{"location":"Apache/#rlimit-unlimited-0","text":"chroot =","title":"\u8bbe\u7f6e\u6838\u5fc3rlimit\u6700\u5927\u9650\u5236\u503c. \u53ef\u7528\u503c: 'unlimited' \u30010\u6216\u8005\u6b63\u6574\u6570. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c."},{"location":"Apache/#chroot-chroot","text":"chdir =","title":"\u542f\u52a8\u65f6\u7684Chroot\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219chroot\u4e0d\u88ab\u4f7f\u7528."},{"location":"Apache/#chdir-chroot","text":"catch_workers_output = yes","title":"\u8bbe\u7f6e\u542f\u52a8\u76ee\u5f55\uff0c\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8Chdir\u5230\u8be5\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u9ed8\u8ba4\u503c: \u5f53\u524d\u76ee\u5f55\uff0c\u6216\u8005/\u76ee\u5f55\uff08chroot\u65f6\uff09"},{"location":"Apache/#stdoutstderr-stdout-stderr-fastcgi-devnull","text":"","title":"\u91cd\u5b9a\u5411\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684stdout\u548cstderr\u5230\u4e3b\u8981\u7684\u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\u4e2d. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, stdout \u548c stderr \u5c06\u4f1a\u6839\u636eFastCGI\u7684\u89c4\u5219\u88ab\u91cd\u5b9a\u5411\u5230 /dev/null . \u9ed8\u8ba4\u503c: \u7a7a."},{"location":"Caddy/","text":"","title":"Caddy"},{"location":"Ceph/","text":"","title":"Ceph"},{"location":"Cisco/","text":"","title":"Cisco"},{"location":"Coreos/","text":"CoreOS \u00b6 Coreos\u4ecb\u7ecd \u00b6 \u751f\u6210\u5b89\u5168\u54c8\u5e0c\u7684\u51e0\u79cd\u65b9\u6cd5\uff1a # On Debian/Ubuntu (via the package \"whois\") mkpasswd --method = SHA-512 --rounds = 4096 # OpenSSL (note: this will only make md5crypt. While better than plantext it should not be considered fully secure) openssl passwd -1 # Python python -c \"import crypt,random,string; print(crypt.crypt(input('clear-text password: '), '\\$6\\$' + ''.join([random.choice(string.ascii_letters + string.digits) for _ in range(16)])))\" # Perl (change password and salt values) perl -e 'print crypt(\"password\",\"\\$6\\$SALT\\$\") . \"\\n\"' # Set the disk size to 20GB vmware-vdiskmanager -x 20Gb coreos_developer_vmware_insecure.vmx \u914d\u7f6e\u6587\u4ef6\u793a\u4f8b \u00b6 passwd : users : - name : core ssh_authorized_keys : - ssh-rsa <REST OF SSH KEY> user@somewhere.com - ssh-rsa <REST OF ANOTHER SSH KEY> user@somewhere.com systemd : units : # Docker will be configured initially but we'll be using containerd exclusively and will disable it after containerd setup - name : docker.service enabled : true # containerd without docker as a shim, thanks to containerd.service.d/ overrides - name : containerd.service enabled : true - name : k8s-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=k8s installation script Wants=network-online.target After=network.target network-online.target [Service] Type=oneshot ExecStart=/ignition/init/k8s/install.sh - name : cni-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=cni plugin installation script Requires=k8s-install.service After=k8s-install.service [Service] Type=oneshot ExecStart=/ignition/init/cni/install.sh - name : containerd-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=containerd installation script Requires=cni-install.service After=cni-install.service [Service] Type=oneshot ExecStart=/ignition/init/cri-containerd/install.sh - name : kubeadm-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=kubeadm installation script Requires=containerd-install.service After=containerd-install.service [Service] Type=oneshot Environment=\"PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/opt/bin\" ExecStart=/ignition/init/kubeadm/kubeadm-install.sh - name : k8s-setup.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=kubernetes setup script Requires=kubeadm-install.service After=kubeadm-install.service [Service] Type=oneshot User=core Environment=\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/opt/bin\" ExecStart=/ignition/init/k8s/setup.sh storage : filesystems : - mount : device : /dev/disk/by-label/ROOT format : xfs wipe_filesystem : true label : ROOT files : - path : /opt/bin/kubeadm filesystem : root mode : 493 # 0755 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubeadm verification : hash : function : sha512 sum : fc96e821fd593a212c632a6c9093143fab5817f6833ba1df1ced2ce4fb82f1ebefde71d9a898e8f9574515e9ba19e40f6ab09a907f6b1b908d7adfcf57b3bf8b - path : /opt/bin/kubelet filesystem : root mode : 493 # 0755 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubelet verification : hash : function : sha512 sum : 5cf4bde886d832d1cc48c47aeb43768050f67fe0458a330e4702b8071567665c975ed1fe2296cba5aea95a6de0bec4b731a32525837cac24646fb0158e2c2f64 - path : /opt/bin/kubectl filesystem : root mode : 511 # 0777 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubectl verification : hash : function : sha512 sum : 38a2746ac7b87cf7969cf33ccac177e63a6a0020ac593b7d272d751889ab568ad46a60e436d2f44f3654e2b4b5b196eabf8860b3eb87368f0861e2b3eb545a80 - path : /etc/systemd/system/kubelet.service filesystem : root mode : 420 # 0644 contents : remote : url : https://raw.githubusercontent.com/kubernetes/kubernetes/v1.10.2/build/debs/kubelet.service verification : hash : function : sha512 sum : b9ca0db34fea67dfd0654e65d3898a72997b1360c1e802cab5adc4288199c1a08423f90751757af4a7f1ff5932bfd81d3e215ce9b9d3f4efa1c04a202228adc8 - path : /etc/systemd/system/kubelet.service.d/10-kubeadm.conf filesystem : root mode : 420 # 0644 contents : remote : url : https://raw.githubusercontent.com/kubernetes/kubernetes/v1.10.2/build/debs/10-kubeadm.conf verification : hash : function : sha512 sum : 32cfc8e56ec6e5ba93219852a68ec5eb25938a39c3e360ea4728fc71a14710b6ff85d0d84c2663eb5297d5dc21e1fad6914d6c0a8ce3357283f0b98ad4280ef7 - path : /ignition/init/cri-containerd/cri-containerd-1.1.0.linux-amd64.tar.gz filesystem : root mode : 420 # 0644 contents : remote : url : https://storage.googleapis.com/cri-containerd-release/cri-containerd-1.1.0.linux-amd64.tar.gz verification : hash : function : sha512 sum : c5db1b99e1155ed0dfe945bc1d53842fd015cb891f8b773c60fea73f9fe7c3e0bda755133765aa618c08765eb13dbf244affb5a1572d5a888ff4298ba3d790cf - path : /ignition/init/cni/cni-plugins-v0.7.1.tgz filesystem : root mode : 420 # 0644 contents : remote : url : https://github.com/containernetworking/plugins/releases/download/v0.7.1/cni-plugins-amd64-v0.7.1.tgz verification : hash : function : sha512 sum : b3b0c1cc7b65cea619bddae4c17b8b488e7e13796345c7f75e069af93d1146b90a66322be6334c4c107e8a0ccd7c6d0b859a44a6745f9b85a0239d1be9ad4ccd - path : /ignition/init/canal/rbac.yaml filesystem : root mode : 493 # 0755 contents : remote : url : https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/canal/rbac.yaml verification : hash : function : sha512 sum : e045645a1f37b4974890c3e4f8505a10bbb138ed0723869d7a7bc399c449072dfd2c8c2c482d3baac9bf700b7b0cfdca122cb260e70b437fb495eb86f9f6cccc - path : /ignition/init/canal/canal.yaml filesystem : root mode : 493 # 0755 contents : remote : url : https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/canal/canal.yaml verification : hash : function : sha512 sum : 5c4953d74680a2ff84349c730bba48d0d43e28b70217c59cdf736f65e198f362c25b534b686c10ed5370dbb1bca4a1326e42039ddee7eb7b0dd314cc08523b67 - path : /ignition/init/k8s/install.sh filesystem : root mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/bin/kubeadm && echo \"k8s binaries (kubeadm) already installed\" && exit 0 # NOTE: If RELEASE is updated, the SHA512 SUMs will need to be as well echo -e \"=> Installing k8s v1.10.2\" echo \"=> Cusomizing kubelet.service...\" sed -i \"s:/usr/bin:/opt/bin:g\" /etc/systemd/system/kubelet.service sed -i \"s:/usr/bin:/opt/bin:g\" /etc/systemd/system/kubelet.service.d/10-kubeadm.conf systemctl daemon-reload systemctl enable kubelet systemctl start kubelet - filesystem : root path : /ignition/init/cri-containerd/install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/containerd && echo \"containerd binaries already installed\" && exit 0 VERSION=1.1.0 echo -e \"=> Installing containerd v${VERSION}\" echo \"=> Installing containerd....\" cd /ignition/init/cri-containerd tar -C / -k -xzf cri-containerd-${VERSION}.linux-amd64.tar.gz echo \"=> Copying /usr/local binaries to /opt/bin ....\" mkdir -p /ignition/init/cri-containerd/unzipped tar -C unzipped -k -xzf cri-containerd-${VERSION}.linux-amd64.tar.gz cp -r unzipped/usr/local/bin/* /opt/bin systemctl start containerd echo \"=> Adding dropins....\" cat > /etc/systemd/system/kubelet.service.d/0-containerd.conf <<EOF [Service] Environment=\"KUBELET_EXTRA_ARGS=--container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock --volume-plugin-dir=/var/lib/kubelet/volumeplugins\" EOF mkdir -p /etc/systemd/system/containerd.service.d/ cat > /etc/systemd/system/containerd.service.d/0-direct-containerd.conf <<EOF [Service] ExecStart= ExecStart=/opt/bin/containerd EOF echo \"=> Triggering systemctl daemon-reload....\" systemctl daemon-reload systemctl restart containerd - filesystem : root path : /ignition/init/cni/install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/cni/bin && echo \"CNI binaries already installed\" && exit 0 VERSION=0.7.1 echo -e \"=> Installing CNI (v${VERSION}) binaries to /opt/cni/bin\" cd /ignition/init/cni mkdir -p /opt/cni/bin tar -C /opt/cni/bin -k -xzf cni-plugins-v${VERSION}.tgz - filesystem : root path : /ignition/init/kubeadm/kubeadm-install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Ensure kubeadm binary is present test -f /opt/bin/kubeadm || (echo \"Failed to find kubeadm binary\" && exit 1) # Exit if kubeadm has already been run (/etc/kubernetes folder would have been created) test -d /etc/kubernetes && echo \"/etc/kubernetes is present, kubeadm should have already been run once\" && exit 0 echo \"=> Running kubeadm init...\" /opt/bin/kubeadm init --cri-socket \"/run/containerd/containerd.sock\" --pod-network-cidr \"10.244.0.0/16\" # Disable docker (kubelet will use containerd runtime directly) sudo systemctl stop docker sudo systemctl disable docker echo \"=> Running kubeadm post-install set up for user 'core'\" mkdir -p /home/core/.kube cp -i /etc/kubernetes/admin.conf /home/core/.kube/config chown $(id -u core):$(id -g core) /home/core/.kube/config - filesystem : root path : /ignition/init/k8s/setup.sh mode : 493 # 0755 contents : inline : | #!/bin/bash # Ensure /etc/kubernetes is present (created by kubeadm) test -d /etc/kubernetes || (echo \"/etc/kubernetes not present, ensure kubeadm has run properly\" && exit 1) echo \"=> Enabling workload running on the master node\" kubectl taint nodes --all node-role.kubernetes.io/master- echo \"=> Installing canal\" kubectl apply -f /ignition/init/canal/rbac.yaml kubectl apply -f /ignition/init/canal/canal.yaml #!/bin/bash echo \"Installing coreos-install...\" curl -sSL https://raw.githubusercontent.com/coreos/init/master/bin/coreos-install > /bin/coreos-install chmod +x /bin/coreos-install echo \"Installing ct...\" curl -sSL https://github.com/coreos/container-linux-config-transpiler/releases/download/v0.8.0/ct-v0.8.0-x86_64-unknown-linux-gnu > /bin/ct echo \"9f9d9d9c802a6dc875067295aa9d7f44f1e66914cc992cf215dd459ee2b719fde4ebfa036bb8488cfd87ae2efafc5d767de776fe11a4661fc45e8d54385953a4 ct\" | sha512sum -c || ( echo \"ERROR: SHA512 Hash does not match for ct v0.8.0\" && exit 1 ) chmod +x /bin/ct","title":"ContainerOS"},{"location":"Coreos/#coreos","text":"","title":"CoreOS"},{"location":"Coreos/#coreos_1","text":"\u751f\u6210\u5b89\u5168\u54c8\u5e0c\u7684\u51e0\u79cd\u65b9\u6cd5\uff1a # On Debian/Ubuntu (via the package \"whois\") mkpasswd --method = SHA-512 --rounds = 4096 # OpenSSL (note: this will only make md5crypt. While better than plantext it should not be considered fully secure) openssl passwd -1 # Python python -c \"import crypt,random,string; print(crypt.crypt(input('clear-text password: '), '\\$6\\$' + ''.join([random.choice(string.ascii_letters + string.digits) for _ in range(16)])))\" # Perl (change password and salt values) perl -e 'print crypt(\"password\",\"\\$6\\$SALT\\$\") . \"\\n\"' # Set the disk size to 20GB vmware-vdiskmanager -x 20Gb coreos_developer_vmware_insecure.vmx","title":"Coreos\u4ecb\u7ecd"},{"location":"Coreos/#_1","text":"passwd : users : - name : core ssh_authorized_keys : - ssh-rsa <REST OF SSH KEY> user@somewhere.com - ssh-rsa <REST OF ANOTHER SSH KEY> user@somewhere.com systemd : units : # Docker will be configured initially but we'll be using containerd exclusively and will disable it after containerd setup - name : docker.service enabled : true # containerd without docker as a shim, thanks to containerd.service.d/ overrides - name : containerd.service enabled : true - name : k8s-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=k8s installation script Wants=network-online.target After=network.target network-online.target [Service] Type=oneshot ExecStart=/ignition/init/k8s/install.sh - name : cni-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=cni plugin installation script Requires=k8s-install.service After=k8s-install.service [Service] Type=oneshot ExecStart=/ignition/init/cni/install.sh - name : containerd-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=containerd installation script Requires=cni-install.service After=cni-install.service [Service] Type=oneshot ExecStart=/ignition/init/cri-containerd/install.sh - name : kubeadm-install.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=kubeadm installation script Requires=containerd-install.service After=containerd-install.service [Service] Type=oneshot Environment=\"PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/opt/bin\" ExecStart=/ignition/init/kubeadm/kubeadm-install.sh - name : k8s-setup.service enabled : true contents : | [Install] WantedBy=multi-user.target [Unit] Description=kubernetes setup script Requires=kubeadm-install.service After=kubeadm-install.service [Service] Type=oneshot User=core Environment=\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/opt/bin\" ExecStart=/ignition/init/k8s/setup.sh storage : filesystems : - mount : device : /dev/disk/by-label/ROOT format : xfs wipe_filesystem : true label : ROOT files : - path : /opt/bin/kubeadm filesystem : root mode : 493 # 0755 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubeadm verification : hash : function : sha512 sum : fc96e821fd593a212c632a6c9093143fab5817f6833ba1df1ced2ce4fb82f1ebefde71d9a898e8f9574515e9ba19e40f6ab09a907f6b1b908d7adfcf57b3bf8b - path : /opt/bin/kubelet filesystem : root mode : 493 # 0755 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubelet verification : hash : function : sha512 sum : 5cf4bde886d832d1cc48c47aeb43768050f67fe0458a330e4702b8071567665c975ed1fe2296cba5aea95a6de0bec4b731a32525837cac24646fb0158e2c2f64 - path : /opt/bin/kubectl filesystem : root mode : 511 # 0777 contents : remote : url : https://storage.googleapis.com/kubernetes-release/release/v1.10.2/bin/linux/amd64/kubectl verification : hash : function : sha512 sum : 38a2746ac7b87cf7969cf33ccac177e63a6a0020ac593b7d272d751889ab568ad46a60e436d2f44f3654e2b4b5b196eabf8860b3eb87368f0861e2b3eb545a80 - path : /etc/systemd/system/kubelet.service filesystem : root mode : 420 # 0644 contents : remote : url : https://raw.githubusercontent.com/kubernetes/kubernetes/v1.10.2/build/debs/kubelet.service verification : hash : function : sha512 sum : b9ca0db34fea67dfd0654e65d3898a72997b1360c1e802cab5adc4288199c1a08423f90751757af4a7f1ff5932bfd81d3e215ce9b9d3f4efa1c04a202228adc8 - path : /etc/systemd/system/kubelet.service.d/10-kubeadm.conf filesystem : root mode : 420 # 0644 contents : remote : url : https://raw.githubusercontent.com/kubernetes/kubernetes/v1.10.2/build/debs/10-kubeadm.conf verification : hash : function : sha512 sum : 32cfc8e56ec6e5ba93219852a68ec5eb25938a39c3e360ea4728fc71a14710b6ff85d0d84c2663eb5297d5dc21e1fad6914d6c0a8ce3357283f0b98ad4280ef7 - path : /ignition/init/cri-containerd/cri-containerd-1.1.0.linux-amd64.tar.gz filesystem : root mode : 420 # 0644 contents : remote : url : https://storage.googleapis.com/cri-containerd-release/cri-containerd-1.1.0.linux-amd64.tar.gz verification : hash : function : sha512 sum : c5db1b99e1155ed0dfe945bc1d53842fd015cb891f8b773c60fea73f9fe7c3e0bda755133765aa618c08765eb13dbf244affb5a1572d5a888ff4298ba3d790cf - path : /ignition/init/cni/cni-plugins-v0.7.1.tgz filesystem : root mode : 420 # 0644 contents : remote : url : https://github.com/containernetworking/plugins/releases/download/v0.7.1/cni-plugins-amd64-v0.7.1.tgz verification : hash : function : sha512 sum : b3b0c1cc7b65cea619bddae4c17b8b488e7e13796345c7f75e069af93d1146b90a66322be6334c4c107e8a0ccd7c6d0b859a44a6745f9b85a0239d1be9ad4ccd - path : /ignition/init/canal/rbac.yaml filesystem : root mode : 493 # 0755 contents : remote : url : https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/canal/rbac.yaml verification : hash : function : sha512 sum : e045645a1f37b4974890c3e4f8505a10bbb138ed0723869d7a7bc399c449072dfd2c8c2c482d3baac9bf700b7b0cfdca122cb260e70b437fb495eb86f9f6cccc - path : /ignition/init/canal/canal.yaml filesystem : root mode : 493 # 0755 contents : remote : url : https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/canal/canal.yaml verification : hash : function : sha512 sum : 5c4953d74680a2ff84349c730bba48d0d43e28b70217c59cdf736f65e198f362c25b534b686c10ed5370dbb1bca4a1326e42039ddee7eb7b0dd314cc08523b67 - path : /ignition/init/k8s/install.sh filesystem : root mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/bin/kubeadm && echo \"k8s binaries (kubeadm) already installed\" && exit 0 # NOTE: If RELEASE is updated, the SHA512 SUMs will need to be as well echo -e \"=> Installing k8s v1.10.2\" echo \"=> Cusomizing kubelet.service...\" sed -i \"s:/usr/bin:/opt/bin:g\" /etc/systemd/system/kubelet.service sed -i \"s:/usr/bin:/opt/bin:g\" /etc/systemd/system/kubelet.service.d/10-kubeadm.conf systemctl daemon-reload systemctl enable kubelet systemctl start kubelet - filesystem : root path : /ignition/init/cri-containerd/install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/containerd && echo \"containerd binaries already installed\" && exit 0 VERSION=1.1.0 echo -e \"=> Installing containerd v${VERSION}\" echo \"=> Installing containerd....\" cd /ignition/init/cri-containerd tar -C / -k -xzf cri-containerd-${VERSION}.linux-amd64.tar.gz echo \"=> Copying /usr/local binaries to /opt/bin ....\" mkdir -p /ignition/init/cri-containerd/unzipped tar -C unzipped -k -xzf cri-containerd-${VERSION}.linux-amd64.tar.gz cp -r unzipped/usr/local/bin/* /opt/bin systemctl start containerd echo \"=> Adding dropins....\" cat > /etc/systemd/system/kubelet.service.d/0-containerd.conf <<EOF [Service] Environment=\"KUBELET_EXTRA_ARGS=--container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock --volume-plugin-dir=/var/lib/kubelet/volumeplugins\" EOF mkdir -p /etc/systemd/system/containerd.service.d/ cat > /etc/systemd/system/containerd.service.d/0-direct-containerd.conf <<EOF [Service] ExecStart= ExecStart=/opt/bin/containerd EOF echo \"=> Triggering systemctl daemon-reload....\" systemctl daemon-reload systemctl restart containerd - filesystem : root path : /ignition/init/cni/install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Unzip the kubernetes binaries if not already present test -d /opt/cni/bin && echo \"CNI binaries already installed\" && exit 0 VERSION=0.7.1 echo -e \"=> Installing CNI (v${VERSION}) binaries to /opt/cni/bin\" cd /ignition/init/cni mkdir -p /opt/cni/bin tar -C /opt/cni/bin -k -xzf cni-plugins-v${VERSION}.tgz - filesystem : root path : /ignition/init/kubeadm/kubeadm-install.sh mode : 480 # 740 contents : inline : | #!/bin/bash # Ensure kubeadm binary is present test -f /opt/bin/kubeadm || (echo \"Failed to find kubeadm binary\" && exit 1) # Exit if kubeadm has already been run (/etc/kubernetes folder would have been created) test -d /etc/kubernetes && echo \"/etc/kubernetes is present, kubeadm should have already been run once\" && exit 0 echo \"=> Running kubeadm init...\" /opt/bin/kubeadm init --cri-socket \"/run/containerd/containerd.sock\" --pod-network-cidr \"10.244.0.0/16\" # Disable docker (kubelet will use containerd runtime directly) sudo systemctl stop docker sudo systemctl disable docker echo \"=> Running kubeadm post-install set up for user 'core'\" mkdir -p /home/core/.kube cp -i /etc/kubernetes/admin.conf /home/core/.kube/config chown $(id -u core):$(id -g core) /home/core/.kube/config - filesystem : root path : /ignition/init/k8s/setup.sh mode : 493 # 0755 contents : inline : | #!/bin/bash # Ensure /etc/kubernetes is present (created by kubeadm) test -d /etc/kubernetes || (echo \"/etc/kubernetes not present, ensure kubeadm has run properly\" && exit 1) echo \"=> Enabling workload running on the master node\" kubectl taint nodes --all node-role.kubernetes.io/master- echo \"=> Installing canal\" kubectl apply -f /ignition/init/canal/rbac.yaml kubectl apply -f /ignition/init/canal/canal.yaml #!/bin/bash echo \"Installing coreos-install...\" curl -sSL https://raw.githubusercontent.com/coreos/init/master/bin/coreos-install > /bin/coreos-install chmod +x /bin/coreos-install echo \"Installing ct...\" curl -sSL https://github.com/coreos/container-linux-config-transpiler/releases/download/v0.8.0/ct-v0.8.0-x86_64-unknown-linux-gnu > /bin/ct echo \"9f9d9d9c802a6dc875067295aa9d7f44f1e66914cc992cf215dd459ee2b719fde4ebfa036bb8488cfd87ae2efafc5d767de776fe11a4661fc45e8d54385953a4 ct\" | sha512sum -c || ( echo \"ERROR: SHA512 Hash does not match for ct v0.8.0\" && exit 1 ) chmod +x /bin/ct","title":"\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b"},{"location":"Docker/","text":"docker\u7b14\u8bb0 \u00b6 Offical:\u4e00\u6761\u547d\u4ee4\u5b89\u88c5\u6700\u65b0\u7a33\u5b9a\u7248docker\uff1acurl -fsSl https://get.docker.com | sh \u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684Docker Compose: sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose- ` uname -s ` - ` uname -m ` -o /usr/local/bin/docker-compose centos7\u4e0bdocker\u5b89\u88c5\u4e0e\u5378\u8f7d \u00b6 yum install -y yum-utils device-mapper-persistent-data lvm2 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo yum list docker-ce --showduplicates | sort -r yum install <FULLY-QUALIFIED-PACKAGE-NAME> # \u6839\u636edocker-ce-18.09.5-3.el7.x86_64 systemctl start docker systemctl enable docker Ubuntu (\u4f7f\u7528apt-get\u8fdb\u884c\u5b89\u88c5) \u00b6 # step 1: \u5b89\u88c5\u5fc5\u8981\u7684\u4e00\u4e9b\u7cfb\u7edf\u5de5\u5177 sudo apt-get update sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common # step 2: \u5b89\u88c5GPG\u8bc1\u4e66 curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add - # Step 3: \u5199\u5165\u8f6f\u4ef6\u6e90\u4fe1\u606f sudo add-apt-repository \"deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $( lsb_release -cs ) stable\" # Step 4: \u66f4\u65b0\u5e76\u5b89\u88c5 Docker-CE sudo apt-get -y update sudo apt-get -y install docker-ce # \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684Docker-CE: # Step 1: \u67e5\u627eDocker-CE\u7684\u7248\u672c: # apt-cache madison docker-ce # docker-ce | 17.03.1~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages # docker-ce | 17.03.0~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages # Step 2: \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684Docker-CE: (VERSION \u4f8b\u5982\u4e0a\u9762\u7684 17.03.1~ce-0~ubuntu-xenial) # sudo apt-get -y install docker-ce=[VERSION] \u5378\u8f7ddocker \u00b6 yum remove docker-ce rm -rf /var/lib/docker WARNING: Error loading config file: /home/user/.docker/config.json - stat /home/user/.docker/config.json: permission denied To fix this problem, either remove the ~/.docker/ directory (it is recreated automatically, but any custom settings are lost), or change its ownership and permissions using the following commands: $ sudo chown \" USER\":\" USER\":\" USER\" /home/\"$USER\"/.docker -R $ sudo chmod g+rwx \"$HOME/.docker\" -R centos6\u5b89\u88c5docker\u4f9d\u8d56\u51fa\u9519\u89e3\u51b3 \u00b6 yum remove docker-io rm -rf /var/lib/docker rm /etc/yum.repos.d/docker.repo yum install docker-io\u6216\u8005yum install the docker-engine-1.7.1 rpm yum install http://yum.dockerproject.org/repo/main/centos/6/Packages/docker-engine-1.7.1-1.el6.x86_64.rpm service docker status \u66f4\u6539docker\u955c\u50cf\u5b89\u88c5\u76ee\u5f55(\u65b0\u7248\u672c\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u53c2\u6570\u81ea\u5b9a\u4e49\u6307\u5b9a) \u00b6 \u65b9\u6cd5\u4e00\uff1a \u505c\u6b62docker\u8fdb\u7a0b Ubuntu/Debian\uff1a\u4f7f\u7528-g\u9009\u9879\u7f16\u8f91/etc/default/docker\u6587\u4ef6\uff1aDOCKER_OPTS = \u201c - dns 8 .8.8.8 -dns 8 .8.4.4 -g /mnt\u201d Fedora/Centos\uff1a\u7f16\u8f91/etc/sysconfig/docker\uff0c\u5e76\u5728other_args\u53d8\u91cf\u4e2d\u6dfb\u52a0-g\u9009\u9879\uff1aex\u3002 other_args = \u201c -g /var/lib/testdir\u201d\u3002\u5982\u679c\u6709\u591a\u4e2a\u9009\u9879\uff0c\u8bf7\u786e\u4fdd\u5c06\u5b83\u4eec\u62ec\u5728\u201c\u201d\u4e2d\u3002\u91cd\u542f\u540e\uff0c\uff08\u670d\u52a1docker\u91cd\u542f\uff09Docker\u5e94\u8be5\u4f7f\u7528\u65b0\u76ee\u5f55\u3002 \u65b9\u6cd5\u4e8c\uff1a \u4f7f\u7528\u7b26\u53f7\u94fe\u63a5\u662f\u53e6\u4e00\u79cd\u66f4\u6539\u56fe\u50cf\u5b58\u50a8\u7684\u65b9\u6cd5\uff0c\u6ce8\u610f - \u8fd9\u4e9b\u6b65\u9aa4\u53d6\u51b3\u4e8e\u60a8\u5f53\u524d\u7684/var/lib/docker\u662f\u5426\u4e3a\u5b9e\u9645\u76ee\u5f55\uff08\u4e0d\u662f\u6307\u5411\u5176\u4ed6\u4f4d\u7f6e\u7684\u7b26\u53f7\u94fe\u63a5\uff09 \u505c\u6b62docker\u8fdb\u7a0b \u5907\u4efd/var/lib/docker/\u76ee\u5f55 tar -zcC /var/lib docker > /mnt/pd0/var_lib_docker-backup- $( date +%s ) .tar.gz \u79fb\u52a8/var/lib/docker\u76ee\u5f55\u5230\u65b0\u5206\u533a: mv /var/lib/docker /mnt/pd0/docker \u6dfb\u52a0\u7b26\u53f7\u94fe\u63a5: ln -s /mnt/pd0/docker /var/lib/docker \u770b\u4e00\u4e0b\u76ee\u5f55\u7ed3\u6784\uff0c\u786e\u4fdd\u5b83\u770b\u8d77\u6765\u50cf\u662f\u5728mv\u4e4b\u524d\u7684\u4e00\u6837: ls /var/lib/docker/ ( \u8bf7\u6ce8\u610f\u7528\u4e8e\u89e3\u6790\u7b26\u53f7\u94fe\u63a5\u7684\u5c3e\u90e8\u659c\u6760 ) Docker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f \u00b6 \u901a\u8fc7 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\uff0c\u4e2d\u56fd\u533a\u7528\u6237\u80fd\u591f\u5feb\u901f\u8bbf\u95ee\u6700\u6d41\u884c\u7684 Docker \u955c\u50cf\u3002\u8be5\u955c\u50cf\u6258\u7ba1\u4e8e\u4e2d\u56fd\u5927\u9646\uff0c\u672c\u5730\u7528\u6237\u73b0\u5728\u5c06\u4f1a\u4eab\u53d7\u5230\u66f4\u5feb\u7684\u4e0b\u8f7d\u901f\u5ea6\u548c\u66f4\u5f3a\u7684\u7a33\u5b9a\u6027\uff0c\u4ece\u800c\u80fd\u591f\u66f4\u654f\u6377\u5730\u5f00\u53d1\u548c\u4ea4\u4ed8 Docker \u5316\u5e94\u7528\u3002 Docker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u53ef\u901a\u8fc7 registry.docker-cn.com \u8bbf\u95ee\u3002\u8be5\u955c\u50cf\u5e93\u53ea\u5305\u542b\u6d41\u884c\u7684\u516c\u6709\u955c\u50cf\u3002\u79c1\u6709\u955c\u50cf\u4ecd\u9700\u8981\u4ece\u7f8e\u56fd\u955c\u50cf\u5e93\u4e2d\u62c9\u53d6\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u76f4\u63a5\u4ece\u8be5\u955c\u50cf\u52a0\u901f\u5730\u5740\u8fdb\u884c\u62c9\u53d6\uff1a $ docker pull registry.docker-cn.com/myname/myrepo:mytag \u4f8b\u5982: $ docker pull registry.docker-cn.com/library/ubuntu:16.04 \u6ce8: \u9664\u975e\u60a8\u4fee\u6539\u4e86 Docker \u5b88\u62a4\u8fdb\u7a0b\u7684 ` --registry-mirror ` \u53c2\u6570 ( \u89c1\u4e0b\u6587 ) , \u5426\u5219\u60a8\u5c06\u9700\u8981\u5b8c\u6574\u5730\u6307\u5b9a\u5b98\u65b9\u955c\u50cf\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff0clibrary/ubuntu\u3001library/redis\u3001library/nginx\u3002 \u4f7f\u7528 --registry-mirror \u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b \u60a8\u53ef\u4ee5\u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b\u9ed8\u8ba4\u4f7f\u7528 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\u3002\u8fd9\u6837\u60a8\u53ef\u4ee5\u9ed8\u8ba4\u901a\u8fc7\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u62c9\u53d6\u955c\u50cf\uff0c\u800c\u65e0\u9700\u5728\u6bcf\u6b21\u62c9\u53d6\u65f6\u6307\u5b9a registry.docker-cn.com\u3002 \u60a8\u53ef\u4ee5\u5728 Docker \u5b88\u62a4\u8fdb\u7a0b\u542f\u52a8\u65f6\u4f20\u5165 --registry-mirror \u53c2\u6570\uff1a $ docker --registry-mirror = https://registry.docker-cn.com daemon \u4e3a\u4e86\u6c38\u4e45\u6027\u4fdd\u7559\u66f4\u6539\uff0c\u60a8\u53ef\u4ee5\u4fee\u6539 /etc/docker/daemon.json \u6587\u4ef6\u5e76\u6dfb\u52a0\u4e0a registry-mirrors \u952e\u503c\u3002 { \"registry-mirrors\" : [ \"https://registry.docker-cn.com\" ] } \u4fee\u6539\u4fdd\u5b58\u540e\u91cd\u542f Docker \u4ee5\u4f7f\u914d\u7f6e\u751f\u6548\u3002 \u6ce8: \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9002\u7528\u4e8e Mac \u7684 Docker \u548c\u9002\u7528\u4e8e Windows \u7684 Docker \u6765\u8fdb\u884c\u8bbe\u7f6e\u3002 \u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e \u00b6 \u5728Linux\u4e0a\u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e { \"authorization-plugins\" : [], \"data-root\" : \"\" , \"dns\" : [], \"dns-opts\" : [], \"dns-search\" : [], \"exec-opts\" : [], \"exec-root\" : \"\" , \"experimental\" : false , \"storage-driver\" : \"\" , \"storage-opts\" : [], \"labels\" : [], \"live-restore\" : true , \"log-driver\" : \"\" , \"log-opts\" : {}, \"mtu\" : 0 , \"pidfile\" : \"\" , \"cluster-store\" : \"\" , \"cluster-store-opts\" : {}, \"cluster-advertise\" : \"\" , \"max-concurrent-downloads\" : 3 , \"max-concurrent-uploads\" : 5 , \"default-shm-size\" : \"64M\" , \"shutdown-timeout\" : 15 , \"debug\" : true , \"hosts\" : [], \"log-level\" : \"\" , \"tls\" : true , \"tlsverify\" : true , \"tlscacert\" : \"\" , \"tlscert\" : \"\" , \"tlskey\" : \"\" , \"swarm-default-advertise-addr\" : \"\" , \"api-cors-header\" : \"\" , \"selinux-enabled\" : false , \"userns-remap\" : \"\" , \"group\" : \"\" , \"cgroup-parent\" : \"\" , \"default-ulimits\" : {}, \"init\" : false , \"init-path\" : \"/usr/libexec/docker-init\" , \"ipv6\" : false , \"iptables\" : false , \"ip-forward\" : false , \"ip-masq\" : false , \"userland-proxy\" : false , \"userland-proxy-path\" : \"/usr/libexec/docker-proxy\" , \"ip\" : \"0.0.0.0\" , \"bridge\" : \"\" , \"bip\" : \"\" , \"fixed-cidr\" : \"\" , \"fixed-cidr-v6\" : \"\" , \"default-gateway\" : \"\" , \"default-gateway-v6\" : \"\" , \"icc\" : false , \"raw-logs\" : false , \"allow-nondistributable-artifacts\" : [], \"registry-mirrors\" : [], \"seccomp-profile\" : \"\" , \"insecure-registries\" : [], \"no-new-privileges\" : false , \"default-runtime\" : \"runc\" , \"oom-score-adjust\" : -500 , \"node-generic-resources\" : [ \"NVIDIA-GPU=UUID1\" , \"NVIDIA-GPU=UUID2\" ], \"runtimes\" : { \"cc-runtime\" : { \"path\" : \"/usr/bin/cc-runtime\" }, \"custom\" : { \"path\" : \"/usr/local/bin/my-runc-replacement\" , \"runtimeArgs\" : [ \"--debug\" ] } } } \u5728Windows\u4e0a\u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e \u00b6 { \"authorization-plugins\" : [], \"data-root\" : \"\" , \"dns\" : [], \"dns-opts\" : [], \"dns-search\" : [], \"exec-opts\" : [], \"experimental\" : false , \"storage-driver\" : \"\" , \"storage-opts\" : [], \"labels\" : [], \"log-driver\" : \"\" , \"mtu\" : 0 , \"pidfile\" : \"\" , \"cluster-store\" : \"\" , \"cluster-advertise\" : \"\" , \"max-concurrent-downloads\" : 3 , \"max-concurrent-uploads\" : 5 , \"shutdown-timeout\" : 15 , \"debug\" : true , \"hosts\" : [], \"log-level\" : \"\" , \"tlsverify\" : true , \"tlscacert\" : \"\" , \"tlscert\" : \"\" , \"tlskey\" : \"\" , \"swarm-default-advertise-addr\" : \"\" , \"group\" : \"\" , \"default-ulimits\" : {}, \"bridge\" : \"\" , \"fixed-cidr\" : \"\" , \"raw-logs\" : false , \"allow-nondistributable-artifacts\" : [], \"registry-mirrors\" : [], \"insecure-registries\" : [] } ## Docker\u547d\u4ee4 ```info \u7528\u6cd5:docker [ OPTIONS ] COMMAND Options: --config string Location of client config files (default \"/root/.docker\" ) -D, --debug Enable debug mode -H, --host list Daemon socket(s) to connect to -l, --log-level string Set the logging level ( \"debug\" | \"info\" | \"warn\" | \"error\" | \"fatal\" ) (default \"info\" ) --tls Use TLS; implied by --tlsverify --tlscacert string Trust certs signed only by this CA (default \"/root/.docker/ca.pem\" ) --tlscert string Path to TLS certificate file (default \"/root/.docker/cert.pem\" ) --tlskey string Path to TLS key file (default \"/root/.docker/key.pem\" ) --tlsverify Use TLS and verify the remote -v, --version Print version information and quit Management Commands: builder Manage builds config Manage Docker configs container Manage containers engine Manage the docker engine image Manage images network Manage networks node Manage Swarm nodes plugin Manage plugins secret Manage Docker secrets service Manage services stack Manage Docker stacks swarm Manage Swarm system Manage Docker trust Manage trust on Docker images volume Manage volumes Commands: attach Attach local standard input, output, and error streams to a running container build Build an image from a Dockerfile commit Create a new image from a container's changes cp Copy files/folders between a container and the local filesystem create Create a new container diff Inspect changes to files or directories on a container's filesystem events Get real time events from the server exec Run a command in a running container export Export a container's filesystem as a tar archive history Show the history of an image images List images import Import the contents from a tarball to create a filesystem image info Display system-wide information inspect Return low-level information on Docker objects kill Kill one or more running containers load Load an image from a tar archive or STDIN login Log in to a Docker registry logout Log out from a Docker registry logs Fetch the logs of a container pause Pause all processes within one or more containers port List port mappings or a specific mapping for the container ps List containers pull Pull an image or a repository from a registry push Push an image or a repository to a registry rename Rename a container restart Restart one or more containers rm Remove one or more containers rmi Remove one or more images run Run a command in a new container save Save one or more images to a tar archive (streamed to STDOUT by default) search Search the Docker Hub for images start Start one or more stopped containers stats Display a live stream of container(s) resource usage statistics stop Stop one or more running containers tag Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE top Display the running processes of a container unpause Unpause all processes within one or more containers update Update configuration of one or more containers version Show the Docker version information wait Block until one or more containers stop, then print their exit codes Run 'docker COMMAND --help' for more information on a command. docker run -dt -p 127 .0.0.1:9980:9980 -e \"domain=192\\.168\\.124\\.3\" -e \"username=admin\" -e \"password=admin\" --restart always --cap-add MKNOD docker.io/thedarkknight/libreoffice-online-unlimited ## \u6e05\u7406\u5197\u4f59container\u548cimage\uff0c\u53ef\u91c7\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a ### \u505c\u6b62\u6240\u6709\u7684container\uff0c\u8fd9\u6837\u624d\u80fd\u591f\u5220\u9664\u5176\u4e2d\u7684images\uff1a docker stop $( docker ps -a -q ) ### \u5982\u679c\u60f3\u8981\u5220\u9664\u6240\u6709container\u7684\u8bdd\u518d\u52a0\u4e00\u4e2a\u6307\u4ee4\uff1a docker rm -f $( docker ps -a -q ) ### \u6839\u636e\u8fc7\u6ee4\u6761\u4ef6\u5220\u9664container\uff0c\u4f8b\u5982\uff1a\u5220\u9664\u67d0container\u4e4b\u524d\u7684container docker rm -f $( sudo docker ps --before = \"container_id_here\" -q ) ### \u5220\u9664\u6240\u6709\u9000\u51fa\u72b6\u6001\u7684container docker rm $( docker ps -q -f status = exited ) ### \u67e5\u770b\u5f53\u524d\u6709\u4e9b\u4ec0\u4e48images docker images ### \u5220\u9664images\uff0c\u901a\u8fc7image\u7684id\u6765\u6307\u5b9a\u5220\u9664\u8c01 ``` sh docker rmi <image id> \u60f3\u8981\u5220\u9664untagged images\uff0c\u4e5f\u5c31\u662f\u90a3\u4e9bid\u4e3aNone\u7684image\u7684\u8bdd\u53ef\u4ee5\u7528 \u00b6 docker rmi $( docker images | grep \"^<none>\" | awk \"{print $3 }\" ) \u8981\u5220\u9664\u5168\u90e8image\u7684\u8bdd \u00b6 docker rmi $(docker images -q) \u540c\u65f6\u5220\u9664container\u548cimages \u00b6 # stop and remove containers and associated images with common grep search term docker ps -a --no-trunc | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker stop && \\ docker ps -a --no-trunc | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker rm && \\ docker images --no-trunc | grep \"search_term_here\" | awk \"{print $3}\" | xargs -r --no-run-if-empty docker rmi # stops only exited containers and delete only non-tagged images docker ps --filter 'status=Exited' -a | xargs docker stop docker images --filter \"dangling=true\" -q | xargs docker rmi DELETE NETWORKS AND VOLUMES \u00b6 # clean up orphaned volumes docker volume rm $(docker volume ls -qf dangling=true) # clean up orphaned networks docker network rm $(docker network ls -q) NEW IMAGES/CONTAINERS \u00b6 # create new docker container, ie. ubuntu docker pull ubuntu:latest # 1x pull down image docker run -i -t ubuntu /bin/bash # drops you into new container as root Docker\u547d\u4ee4\uff1a \u00b6 \u5bb9\u5668\u64cd\u4f5c\u547d\u4ee4 docker ps <\u9009\u9879> -a,--all = false \u5217\u51fa\u6240\u6709\u5bb9\u5668\uff0c\u4e0d\u52a0-a\u8f93\u51farunning\u72b6\u6001\u5bb9\u5668 --before = \"\" \u5217\u51fa\u5728\u7279\u5b9a\u5bb9\u5668\u521b\u5efa\u4e4b\u524d\u7684\u5bb9\u5668\uff0c\u5305\u542b\u505c\u6b62\u7684\u5bb9\u5668 -f,--filter filter \u8bbe\u7f6e\u8f93\u51fa\u8fc7\u6ee4\uff0c\u5982\uff1a\u201cexited = 0 \u201d --format string \u66f4 -l,--lastest = false \u5217 \u51fa\u6700\u540e\u521b\u5efa\u7684\u5bb9\u5668\uff0c\u5305\u542b\u505c\u6b62\u7684\u5bb9\u5668 -q,--quiet = false \u53ea\u8f93\u51fa\u5bb9\u5668\u7684id \u95ee\u9898\u53ca\u6545\u969c\u89e3\u51b3\u529e\u6cd5\uff1a \u00b6 1.question\uff1aCannot connect to the Docker daemon. Is 'docker -d' running on this host? yum install -y device-mapper-libs device-mapper 2.helps whit error:'unexpected end of JON input' docker rm -f $(docker ps -a -q) #go to container command line docker exec -it \"container_name_here\" bash","title":"Docker"},{"location":"Docker/#docker","text":"Offical:\u4e00\u6761\u547d\u4ee4\u5b89\u88c5\u6700\u65b0\u7a33\u5b9a\u7248docker\uff1acurl -fsSl https://get.docker.com | sh \u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684Docker Compose: sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose- ` uname -s ` - ` uname -m ` -o /usr/local/bin/docker-compose","title":"docker\u7b14\u8bb0"},{"location":"Docker/#centos7docker","text":"yum install -y yum-utils device-mapper-persistent-data lvm2 yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo yum list docker-ce --showduplicates | sort -r yum install <FULLY-QUALIFIED-PACKAGE-NAME> # \u6839\u636edocker-ce-18.09.5-3.el7.x86_64 systemctl start docker systemctl enable docker","title":"centos7\u4e0bdocker\u5b89\u88c5\u4e0e\u5378\u8f7d"},{"location":"Docker/#ubuntu-apt-get","text":"# step 1: \u5b89\u88c5\u5fc5\u8981\u7684\u4e00\u4e9b\u7cfb\u7edf\u5de5\u5177 sudo apt-get update sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common # step 2: \u5b89\u88c5GPG\u8bc1\u4e66 curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add - # Step 3: \u5199\u5165\u8f6f\u4ef6\u6e90\u4fe1\u606f sudo add-apt-repository \"deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $( lsb_release -cs ) stable\" # Step 4: \u66f4\u65b0\u5e76\u5b89\u88c5 Docker-CE sudo apt-get -y update sudo apt-get -y install docker-ce # \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684Docker-CE: # Step 1: \u67e5\u627eDocker-CE\u7684\u7248\u672c: # apt-cache madison docker-ce # docker-ce | 17.03.1~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages # docker-ce | 17.03.0~ce-0~ubuntu-xenial | http://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages # Step 2: \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684Docker-CE: (VERSION \u4f8b\u5982\u4e0a\u9762\u7684 17.03.1~ce-0~ubuntu-xenial) # sudo apt-get -y install docker-ce=[VERSION]","title":"Ubuntu (\u4f7f\u7528apt-get\u8fdb\u884c\u5b89\u88c5)"},{"location":"Docker/#docker_1","text":"yum remove docker-ce rm -rf /var/lib/docker WARNING: Error loading config file: /home/user/.docker/config.json - stat /home/user/.docker/config.json: permission denied To fix this problem, either remove the ~/.docker/ directory (it is recreated automatically, but any custom settings are lost), or change its ownership and permissions using the following commands: $ sudo chown \" USER\":\" USER\":\" USER\" /home/\"$USER\"/.docker -R $ sudo chmod g+rwx \"$HOME/.docker\" -R","title":"\u5378\u8f7ddocker"},{"location":"Docker/#centos6docker","text":"yum remove docker-io rm -rf /var/lib/docker rm /etc/yum.repos.d/docker.repo yum install docker-io\u6216\u8005yum install the docker-engine-1.7.1 rpm yum install http://yum.dockerproject.org/repo/main/centos/6/Packages/docker-engine-1.7.1-1.el6.x86_64.rpm service docker status","title":"centos6\u5b89\u88c5docker\u4f9d\u8d56\u51fa\u9519\u89e3\u51b3"},{"location":"Docker/#docker_2","text":"\u65b9\u6cd5\u4e00\uff1a \u505c\u6b62docker\u8fdb\u7a0b Ubuntu/Debian\uff1a\u4f7f\u7528-g\u9009\u9879\u7f16\u8f91/etc/default/docker\u6587\u4ef6\uff1aDOCKER_OPTS = \u201c - dns 8 .8.8.8 -dns 8 .8.4.4 -g /mnt\u201d Fedora/Centos\uff1a\u7f16\u8f91/etc/sysconfig/docker\uff0c\u5e76\u5728other_args\u53d8\u91cf\u4e2d\u6dfb\u52a0-g\u9009\u9879\uff1aex\u3002 other_args = \u201c -g /var/lib/testdir\u201d\u3002\u5982\u679c\u6709\u591a\u4e2a\u9009\u9879\uff0c\u8bf7\u786e\u4fdd\u5c06\u5b83\u4eec\u62ec\u5728\u201c\u201d\u4e2d\u3002\u91cd\u542f\u540e\uff0c\uff08\u670d\u52a1docker\u91cd\u542f\uff09Docker\u5e94\u8be5\u4f7f\u7528\u65b0\u76ee\u5f55\u3002 \u65b9\u6cd5\u4e8c\uff1a \u4f7f\u7528\u7b26\u53f7\u94fe\u63a5\u662f\u53e6\u4e00\u79cd\u66f4\u6539\u56fe\u50cf\u5b58\u50a8\u7684\u65b9\u6cd5\uff0c\u6ce8\u610f - \u8fd9\u4e9b\u6b65\u9aa4\u53d6\u51b3\u4e8e\u60a8\u5f53\u524d\u7684/var/lib/docker\u662f\u5426\u4e3a\u5b9e\u9645\u76ee\u5f55\uff08\u4e0d\u662f\u6307\u5411\u5176\u4ed6\u4f4d\u7f6e\u7684\u7b26\u53f7\u94fe\u63a5\uff09 \u505c\u6b62docker\u8fdb\u7a0b \u5907\u4efd/var/lib/docker/\u76ee\u5f55 tar -zcC /var/lib docker > /mnt/pd0/var_lib_docker-backup- $( date +%s ) .tar.gz \u79fb\u52a8/var/lib/docker\u76ee\u5f55\u5230\u65b0\u5206\u533a: mv /var/lib/docker /mnt/pd0/docker \u6dfb\u52a0\u7b26\u53f7\u94fe\u63a5: ln -s /mnt/pd0/docker /var/lib/docker \u770b\u4e00\u4e0b\u76ee\u5f55\u7ed3\u6784\uff0c\u786e\u4fdd\u5b83\u770b\u8d77\u6765\u50cf\u662f\u5728mv\u4e4b\u524d\u7684\u4e00\u6837: ls /var/lib/docker/ ( \u8bf7\u6ce8\u610f\u7528\u4e8e\u89e3\u6790\u7b26\u53f7\u94fe\u63a5\u7684\u5c3e\u90e8\u659c\u6760 )","title":"\u66f4\u6539docker\u955c\u50cf\u5b89\u88c5\u76ee\u5f55(\u65b0\u7248\u672c\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u53c2\u6570\u81ea\u5b9a\u4e49\u6307\u5b9a)"},{"location":"Docker/#docker_3","text":"\u901a\u8fc7 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\uff0c\u4e2d\u56fd\u533a\u7528\u6237\u80fd\u591f\u5feb\u901f\u8bbf\u95ee\u6700\u6d41\u884c\u7684 Docker \u955c\u50cf\u3002\u8be5\u955c\u50cf\u6258\u7ba1\u4e8e\u4e2d\u56fd\u5927\u9646\uff0c\u672c\u5730\u7528\u6237\u73b0\u5728\u5c06\u4f1a\u4eab\u53d7\u5230\u66f4\u5feb\u7684\u4e0b\u8f7d\u901f\u5ea6\u548c\u66f4\u5f3a\u7684\u7a33\u5b9a\u6027\uff0c\u4ece\u800c\u80fd\u591f\u66f4\u654f\u6377\u5730\u5f00\u53d1\u548c\u4ea4\u4ed8 Docker \u5316\u5e94\u7528\u3002 Docker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u53ef\u901a\u8fc7 registry.docker-cn.com \u8bbf\u95ee\u3002\u8be5\u955c\u50cf\u5e93\u53ea\u5305\u542b\u6d41\u884c\u7684\u516c\u6709\u955c\u50cf\u3002\u79c1\u6709\u955c\u50cf\u4ecd\u9700\u8981\u4ece\u7f8e\u56fd\u955c\u50cf\u5e93\u4e2d\u62c9\u53d6\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u76f4\u63a5\u4ece\u8be5\u955c\u50cf\u52a0\u901f\u5730\u5740\u8fdb\u884c\u62c9\u53d6\uff1a $ docker pull registry.docker-cn.com/myname/myrepo:mytag \u4f8b\u5982: $ docker pull registry.docker-cn.com/library/ubuntu:16.04 \u6ce8: \u9664\u975e\u60a8\u4fee\u6539\u4e86 Docker \u5b88\u62a4\u8fdb\u7a0b\u7684 ` --registry-mirror ` \u53c2\u6570 ( \u89c1\u4e0b\u6587 ) , \u5426\u5219\u60a8\u5c06\u9700\u8981\u5b8c\u6574\u5730\u6307\u5b9a\u5b98\u65b9\u955c\u50cf\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff0clibrary/ubuntu\u3001library/redis\u3001library/nginx\u3002 \u4f7f\u7528 --registry-mirror \u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b \u60a8\u53ef\u4ee5\u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b\u9ed8\u8ba4\u4f7f\u7528 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\u3002\u8fd9\u6837\u60a8\u53ef\u4ee5\u9ed8\u8ba4\u901a\u8fc7\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u62c9\u53d6\u955c\u50cf\uff0c\u800c\u65e0\u9700\u5728\u6bcf\u6b21\u62c9\u53d6\u65f6\u6307\u5b9a registry.docker-cn.com\u3002 \u60a8\u53ef\u4ee5\u5728 Docker \u5b88\u62a4\u8fdb\u7a0b\u542f\u52a8\u65f6\u4f20\u5165 --registry-mirror \u53c2\u6570\uff1a $ docker --registry-mirror = https://registry.docker-cn.com daemon \u4e3a\u4e86\u6c38\u4e45\u6027\u4fdd\u7559\u66f4\u6539\uff0c\u60a8\u53ef\u4ee5\u4fee\u6539 /etc/docker/daemon.json \u6587\u4ef6\u5e76\u6dfb\u52a0\u4e0a registry-mirrors \u952e\u503c\u3002 { \"registry-mirrors\" : [ \"https://registry.docker-cn.com\" ] } \u4fee\u6539\u4fdd\u5b58\u540e\u91cd\u542f Docker \u4ee5\u4f7f\u914d\u7f6e\u751f\u6548\u3002 \u6ce8: \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9002\u7528\u4e8e Mac \u7684 Docker \u548c\u9002\u7528\u4e8e Windows \u7684 Docker \u6765\u8fdb\u884c\u8bbe\u7f6e\u3002","title":"Docker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f"},{"location":"Docker/#daemonjson","text":"\u5728Linux\u4e0a\u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e { \"authorization-plugins\" : [], \"data-root\" : \"\" , \"dns\" : [], \"dns-opts\" : [], \"dns-search\" : [], \"exec-opts\" : [], \"exec-root\" : \"\" , \"experimental\" : false , \"storage-driver\" : \"\" , \"storage-opts\" : [], \"labels\" : [], \"live-restore\" : true , \"log-driver\" : \"\" , \"log-opts\" : {}, \"mtu\" : 0 , \"pidfile\" : \"\" , \"cluster-store\" : \"\" , \"cluster-store-opts\" : {}, \"cluster-advertise\" : \"\" , \"max-concurrent-downloads\" : 3 , \"max-concurrent-uploads\" : 5 , \"default-shm-size\" : \"64M\" , \"shutdown-timeout\" : 15 , \"debug\" : true , \"hosts\" : [], \"log-level\" : \"\" , \"tls\" : true , \"tlsverify\" : true , \"tlscacert\" : \"\" , \"tlscert\" : \"\" , \"tlskey\" : \"\" , \"swarm-default-advertise-addr\" : \"\" , \"api-cors-header\" : \"\" , \"selinux-enabled\" : false , \"userns-remap\" : \"\" , \"group\" : \"\" , \"cgroup-parent\" : \"\" , \"default-ulimits\" : {}, \"init\" : false , \"init-path\" : \"/usr/libexec/docker-init\" , \"ipv6\" : false , \"iptables\" : false , \"ip-forward\" : false , \"ip-masq\" : false , \"userland-proxy\" : false , \"userland-proxy-path\" : \"/usr/libexec/docker-proxy\" , \"ip\" : \"0.0.0.0\" , \"bridge\" : \"\" , \"bip\" : \"\" , \"fixed-cidr\" : \"\" , \"fixed-cidr-v6\" : \"\" , \"default-gateway\" : \"\" , \"default-gateway-v6\" : \"\" , \"icc\" : false , \"raw-logs\" : false , \"allow-nondistributable-artifacts\" : [], \"registry-mirrors\" : [], \"seccomp-profile\" : \"\" , \"insecure-registries\" : [], \"no-new-privileges\" : false , \"default-runtime\" : \"runc\" , \"oom-score-adjust\" : -500 , \"node-generic-resources\" : [ \"NVIDIA-GPU=UUID1\" , \"NVIDIA-GPU=UUID2\" ], \"runtimes\" : { \"cc-runtime\" : { \"path\" : \"/usr/bin/cc-runtime\" }, \"custom\" : { \"path\" : \"/usr/local/bin/my-runc-replacement\" , \"runtimeArgs\" : [ \"--debug\" ] } } }","title":"\u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e"},{"location":"Docker/#windowsdaemonjson","text":"{ \"authorization-plugins\" : [], \"data-root\" : \"\" , \"dns\" : [], \"dns-opts\" : [], \"dns-search\" : [], \"exec-opts\" : [], \"experimental\" : false , \"storage-driver\" : \"\" , \"storage-opts\" : [], \"labels\" : [], \"log-driver\" : \"\" , \"mtu\" : 0 , \"pidfile\" : \"\" , \"cluster-store\" : \"\" , \"cluster-advertise\" : \"\" , \"max-concurrent-downloads\" : 3 , \"max-concurrent-uploads\" : 5 , \"shutdown-timeout\" : 15 , \"debug\" : true , \"hosts\" : [], \"log-level\" : \"\" , \"tlsverify\" : true , \"tlscacert\" : \"\" , \"tlscert\" : \"\" , \"tlskey\" : \"\" , \"swarm-default-advertise-addr\" : \"\" , \"group\" : \"\" , \"default-ulimits\" : {}, \"bridge\" : \"\" , \"fixed-cidr\" : \"\" , \"raw-logs\" : false , \"allow-nondistributable-artifacts\" : [], \"registry-mirrors\" : [], \"insecure-registries\" : [] } ## Docker\u547d\u4ee4 ```info \u7528\u6cd5:docker [ OPTIONS ] COMMAND Options: --config string Location of client config files (default \"/root/.docker\" ) -D, --debug Enable debug mode -H, --host list Daemon socket(s) to connect to -l, --log-level string Set the logging level ( \"debug\" | \"info\" | \"warn\" | \"error\" | \"fatal\" ) (default \"info\" ) --tls Use TLS; implied by --tlsverify --tlscacert string Trust certs signed only by this CA (default \"/root/.docker/ca.pem\" ) --tlscert string Path to TLS certificate file (default \"/root/.docker/cert.pem\" ) --tlskey string Path to TLS key file (default \"/root/.docker/key.pem\" ) --tlsverify Use TLS and verify the remote -v, --version Print version information and quit Management Commands: builder Manage builds config Manage Docker configs container Manage containers engine Manage the docker engine image Manage images network Manage networks node Manage Swarm nodes plugin Manage plugins secret Manage Docker secrets service Manage services stack Manage Docker stacks swarm Manage Swarm system Manage Docker trust Manage trust on Docker images volume Manage volumes Commands: attach Attach local standard input, output, and error streams to a running container build Build an image from a Dockerfile commit Create a new image from a container's changes cp Copy files/folders between a container and the local filesystem create Create a new container diff Inspect changes to files or directories on a container's filesystem events Get real time events from the server exec Run a command in a running container export Export a container's filesystem as a tar archive history Show the history of an image images List images import Import the contents from a tarball to create a filesystem image info Display system-wide information inspect Return low-level information on Docker objects kill Kill one or more running containers load Load an image from a tar archive or STDIN login Log in to a Docker registry logout Log out from a Docker registry logs Fetch the logs of a container pause Pause all processes within one or more containers port List port mappings or a specific mapping for the container ps List containers pull Pull an image or a repository from a registry push Push an image or a repository to a registry rename Rename a container restart Restart one or more containers rm Remove one or more containers rmi Remove one or more images run Run a command in a new container save Save one or more images to a tar archive (streamed to STDOUT by default) search Search the Docker Hub for images start Start one or more stopped containers stats Display a live stream of container(s) resource usage statistics stop Stop one or more running containers tag Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE top Display the running processes of a container unpause Unpause all processes within one or more containers update Update configuration of one or more containers version Show the Docker version information wait Block until one or more containers stop, then print their exit codes Run 'docker COMMAND --help' for more information on a command. docker run -dt -p 127 .0.0.1:9980:9980 -e \"domain=192\\.168\\.124\\.3\" -e \"username=admin\" -e \"password=admin\" --restart always --cap-add MKNOD docker.io/thedarkknight/libreoffice-online-unlimited ## \u6e05\u7406\u5197\u4f59container\u548cimage\uff0c\u53ef\u91c7\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a ### \u505c\u6b62\u6240\u6709\u7684container\uff0c\u8fd9\u6837\u624d\u80fd\u591f\u5220\u9664\u5176\u4e2d\u7684images\uff1a docker stop $( docker ps -a -q ) ### \u5982\u679c\u60f3\u8981\u5220\u9664\u6240\u6709container\u7684\u8bdd\u518d\u52a0\u4e00\u4e2a\u6307\u4ee4\uff1a docker rm -f $( docker ps -a -q ) ### \u6839\u636e\u8fc7\u6ee4\u6761\u4ef6\u5220\u9664container\uff0c\u4f8b\u5982\uff1a\u5220\u9664\u67d0container\u4e4b\u524d\u7684container docker rm -f $( sudo docker ps --before = \"container_id_here\" -q ) ### \u5220\u9664\u6240\u6709\u9000\u51fa\u72b6\u6001\u7684container docker rm $( docker ps -q -f status = exited ) ### \u67e5\u770b\u5f53\u524d\u6709\u4e9b\u4ec0\u4e48images docker images ### \u5220\u9664images\uff0c\u901a\u8fc7image\u7684id\u6765\u6307\u5b9a\u5220\u9664\u8c01 ``` sh docker rmi <image id>","title":"\u5728Windows\u4e0a\u5b98\u65b9\u793a\u4f8b\u7684daemon.json\u6587\u4ef6\u914d\u7f6e"},{"location":"Docker/#untagged-imagesidnoneimage","text":"docker rmi $( docker images | grep \"^<none>\" | awk \"{print $3 }\" )","title":"\u60f3\u8981\u5220\u9664untagged images\uff0c\u4e5f\u5c31\u662f\u90a3\u4e9bid\u4e3aNone\u7684image\u7684\u8bdd\u53ef\u4ee5\u7528"},{"location":"Docker/#image","text":"docker rmi $(docker images -q)","title":"\u8981\u5220\u9664\u5168\u90e8image\u7684\u8bdd"},{"location":"Docker/#containerimages","text":"# stop and remove containers and associated images with common grep search term docker ps -a --no-trunc | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker stop && \\ docker ps -a --no-trunc | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker rm && \\ docker images --no-trunc | grep \"search_term_here\" | awk \"{print $3}\" | xargs -r --no-run-if-empty docker rmi # stops only exited containers and delete only non-tagged images docker ps --filter 'status=Exited' -a | xargs docker stop docker images --filter \"dangling=true\" -q | xargs docker rmi","title":"\u540c\u65f6\u5220\u9664container\u548cimages"},{"location":"Docker/#delete-networks-and-volumes","text":"# clean up orphaned volumes docker volume rm $(docker volume ls -qf dangling=true) # clean up orphaned networks docker network rm $(docker network ls -q)","title":"DELETE NETWORKS AND VOLUMES"},{"location":"Docker/#new-imagescontainers","text":"# create new docker container, ie. ubuntu docker pull ubuntu:latest # 1x pull down image docker run -i -t ubuntu /bin/bash # drops you into new container as root","title":"NEW IMAGES/CONTAINERS"},{"location":"Docker/#docker_4","text":"\u5bb9\u5668\u64cd\u4f5c\u547d\u4ee4 docker ps <\u9009\u9879> -a,--all = false \u5217\u51fa\u6240\u6709\u5bb9\u5668\uff0c\u4e0d\u52a0-a\u8f93\u51farunning\u72b6\u6001\u5bb9\u5668 --before = \"\" \u5217\u51fa\u5728\u7279\u5b9a\u5bb9\u5668\u521b\u5efa\u4e4b\u524d\u7684\u5bb9\u5668\uff0c\u5305\u542b\u505c\u6b62\u7684\u5bb9\u5668 -f,--filter filter \u8bbe\u7f6e\u8f93\u51fa\u8fc7\u6ee4\uff0c\u5982\uff1a\u201cexited = 0 \u201d --format string \u66f4 -l,--lastest = false \u5217 \u51fa\u6700\u540e\u521b\u5efa\u7684\u5bb9\u5668\uff0c\u5305\u542b\u505c\u6b62\u7684\u5bb9\u5668 -q,--quiet = false \u53ea\u8f93\u51fa\u5bb9\u5668\u7684id","title":"Docker\u547d\u4ee4\uff1a"},{"location":"Docker/#_1","text":"1.question\uff1aCannot connect to the Docker daemon. Is 'docker -d' running on this host? yum install -y device-mapper-libs device-mapper 2.helps whit error:'unexpected end of JON input' docker rm -f $(docker ps -a -q) #go to container command line docker exec -it \"container_name_here\" bash","title":"\u95ee\u9898\u53ca\u6545\u969c\u89e3\u51b3\u529e\u6cd5\uff1a"},{"location":"Elk/","text":"ELK Stack \u00b6 Elasticsearch\u8fd1\u4e4e\u5b9e\u65f6(NRT)\u7684\u641c\u7d22\u5e73\u53f0\uff0c\u4ece\u7d22\u5f15\u6587\u6863\u5230\u53ef\u641c\u7d22\u6587\u6863\u7684\u65f6\u95f4\u6709\u4e00\u70b9\u5ef6\u8fdf(\u901a\u5e38\u662f\u4e00\u79d2) \u96c6\u7fa4\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\uff08\u670d\u52a1\u5668\uff09\u7684\u96c6\u5408\uff0c\u5b83\u4eec\u5171\u540c\u4fdd\u5b58\u60a8\u7684\u6574\u4e2a\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u8de8\u6240\u6709\u8282\u70b9\u7684\u8054\u5408\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u7fa4\u96c6\u7531\u552f\u4e00\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a\u201celasticsearch\u201d\u3002\u6b64\u540d\u79f0\u5f88\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u8282\u70b9\u8bbe\u7f6e\u4e3a\u6309\u540d\u79f0\u52a0\u5165\u7fa4\u96c6\uff0c\u5219\u8be5\u8282\u70b9\u53ea\u80fd\u662f\u7fa4\u96c6\u7684\u4e00\u90e8\u5206\u3002 \u8282\u70b9\u662f\u4f5c\u4e3a\u7fa4\u96c6\u4e00\u90e8\u5206\u7684\u5355\u4e2a\u670d\u52a1\u5668\uff0c\u5b58\u50a8\u6570\u636e\u5e76\u53c2\u4e0e\u7fa4\u96c6\u7684\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u4e0e\u96c6\u7fa4\u4e00\u6837\uff0c\u8282\u70b9\u7531\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u540d\u79f0\u662f\u5728\u542f\u52a8\u65f6\u5206\u914d\u7ed9\u8282\u70b9\u7684\u968f\u673a\u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26\uff08UUID\uff09 \u7d22\u5f15\u662f\u5177\u6709\u67d0\u4e9b\u7c7b\u4f3c\u7279\u5f81\u7684\u6587\u6863\u96c6\u5408\u3002\u6587\u6863\u662f\u53ef\u4ee5\u7f16\u5236\u7d22\u5f15\u7684\u57fa\u672c\u4fe1\u606f\u5355\u5143\u3002\u7d22\u5f15\u53ef\u80fd\u5b58\u50a8\u5927\u91cf\u53ef\u80fd\u8d85\u8fc7\u5355\u4e2a\u8282\u70b9\u7684\u786c\u4ef6\u9650\u5236\u7684\u6570\u636e\u3002\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u53ea\u9700\u5b9a\u4e49\u6240\u9700\u7684\u5206\u7247\u6570\u5373\u53ef\u3002\u6bcf\u4e2a\u5206\u7247\u672c\u8eab\u90fd\u662f\u4e00\u4e2a\u529f\u80fd\u9f50\u5168\u4e14\u72ec\u7acb\u7684\u201c\u7d22\u5f15\u201d\uff0c\u53ef\u4ee5\u6258\u7ba1\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a\u3002 \u5206\u7247Sharding\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u5b83\u5141\u8bb8\u60a8\u6c34\u5e73\u5206\u5272/\u7f29\u653e\u5185\u5bb9\u91cf \u5b83\u5141\u8bb8\u60a8\u8de8\u5206\u7247\uff08\u53ef\u80fd\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\uff09\u5206\u5e03\u548c\u5e76\u884c\u5316\u64cd\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd/\u541e\u5410\u91cf \u590d\u5236Replication\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u5b83\u5728\u788e\u7247/\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3002\u56e0\u6b64\uff0c\u8bf7\u52a1\u5fc5\u6ce8\u610f\uff0c\u526f\u672c\u5206\u7247\u6c38\u8fdc\u4e0d\u4f1a\u5728\u4e0e\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb/\u4e3b\u5206\u7247\u76f8\u540c\u7684\u8282\u70b9\u4e0a\u5206\u914d\u3002 \u5b83\u5141\u8bb8\u60a8\u6269\u5c55\u641c\u7d22\u91cf/\u541e\u5410\u91cf\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5728\u6240\u6709\u526f\u672c\u4e0a\u5e76\u884c\u6267\u884c\u641c\u7d22\u3002 \u603b\u800c\u8a00\u4e4b\uff0c\u6bcf\u4e2a\u7d22\u5f15\u53ef\u4ee5\u62c6\u5206\u4e3a\u591a\u4e2a\u5206\u7247\u3002\u7d22\u5f15\u4e5f\u53ef\u4ee5\u590d\u5236\u4e3a\u96f6\uff08\u8868\u793a\u6ca1\u6709\u526f\u672c\uff09\u6216\u66f4\u591a\u6b21\u3002\u590d\u5236\u540e\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5c06\u5177\u6709\u4e3b\u5206\u7247\uff08\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb\u5206\u7247\uff09\u548c\u526f\u672c\u5206\u7247\uff08\u4e3b\u5206\u7247\u7684\u526f\u672c\uff09\u3002\u53ef\u4ee5\u5728\u521b\u5efa\u7d22\u5f15\u65f6\u4e3a\u6bcf\u4e2a\u7d22\u5f15\u5b9a\u4e49\u5206\u7247\u548c\u526f\u672c\u7684\u6570\u91cf\u3002\u521b\u5efa\u7d22\u5f15\u540e\uff0c\u60a8\u53ef\u4ee5\u968f\u65f6\u52a8\u6001\u66f4\u6539\u526f\u672c\u6570\uff0c\u4f46\u4e0d\u80fd\u5728\u4e8b\u540e\u66f4\u6539\u5206\u7247\u6570\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cElasticsearch\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5206\u914d\u4e865\u4e2a\u4e3b\u5206\u7247\u548c1\u4e2a\u526f\u672c\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u7fa4\u96c6\u4e2d\u81f3\u5c11\u6709\u4e24\u4e2a\u8282\u70b9\uff0c\u5219\u7d22\u5f15\u5c06\u5305\u542b5\u4e2a\u4e3b\u5206\u7247\u548c\u53e6\u59165\u4e2a\u526f\u672c\u5206\u7247\uff081\u4e2a\u5b8c\u6574\u526f\u672c\uff09\uff0c\u603b\u8ba1\u4e3a\u6bcf\u4e2a\u7d22\u5f1510\u4e2a\u5206\u7247\u3002 curl -X PUT \"localhost:9200/customer?pretty\" #\u521b\u5efa\u540d\u4e3acustomer\u7684\u7d22\u5f15 curl -X GET \"localhost:9200/_cat/indices?v\" #\u5217\u51fa\u6240\u6709\u7d22\u5f15","title":"ELKStack"},{"location":"Elk/#elk-stack","text":"Elasticsearch\u8fd1\u4e4e\u5b9e\u65f6(NRT)\u7684\u641c\u7d22\u5e73\u53f0\uff0c\u4ece\u7d22\u5f15\u6587\u6863\u5230\u53ef\u641c\u7d22\u6587\u6863\u7684\u65f6\u95f4\u6709\u4e00\u70b9\u5ef6\u8fdf(\u901a\u5e38\u662f\u4e00\u79d2) \u96c6\u7fa4\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\uff08\u670d\u52a1\u5668\uff09\u7684\u96c6\u5408\uff0c\u5b83\u4eec\u5171\u540c\u4fdd\u5b58\u60a8\u7684\u6574\u4e2a\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u8de8\u6240\u6709\u8282\u70b9\u7684\u8054\u5408\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u7fa4\u96c6\u7531\u552f\u4e00\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a\u201celasticsearch\u201d\u3002\u6b64\u540d\u79f0\u5f88\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u8282\u70b9\u8bbe\u7f6e\u4e3a\u6309\u540d\u79f0\u52a0\u5165\u7fa4\u96c6\uff0c\u5219\u8be5\u8282\u70b9\u53ea\u80fd\u662f\u7fa4\u96c6\u7684\u4e00\u90e8\u5206\u3002 \u8282\u70b9\u662f\u4f5c\u4e3a\u7fa4\u96c6\u4e00\u90e8\u5206\u7684\u5355\u4e2a\u670d\u52a1\u5668\uff0c\u5b58\u50a8\u6570\u636e\u5e76\u53c2\u4e0e\u7fa4\u96c6\u7684\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u4e0e\u96c6\u7fa4\u4e00\u6837\uff0c\u8282\u70b9\u7531\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u540d\u79f0\u662f\u5728\u542f\u52a8\u65f6\u5206\u914d\u7ed9\u8282\u70b9\u7684\u968f\u673a\u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26\uff08UUID\uff09 \u7d22\u5f15\u662f\u5177\u6709\u67d0\u4e9b\u7c7b\u4f3c\u7279\u5f81\u7684\u6587\u6863\u96c6\u5408\u3002\u6587\u6863\u662f\u53ef\u4ee5\u7f16\u5236\u7d22\u5f15\u7684\u57fa\u672c\u4fe1\u606f\u5355\u5143\u3002\u7d22\u5f15\u53ef\u80fd\u5b58\u50a8\u5927\u91cf\u53ef\u80fd\u8d85\u8fc7\u5355\u4e2a\u8282\u70b9\u7684\u786c\u4ef6\u9650\u5236\u7684\u6570\u636e\u3002\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u53ea\u9700\u5b9a\u4e49\u6240\u9700\u7684\u5206\u7247\u6570\u5373\u53ef\u3002\u6bcf\u4e2a\u5206\u7247\u672c\u8eab\u90fd\u662f\u4e00\u4e2a\u529f\u80fd\u9f50\u5168\u4e14\u72ec\u7acb\u7684\u201c\u7d22\u5f15\u201d\uff0c\u53ef\u4ee5\u6258\u7ba1\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a\u3002 \u5206\u7247Sharding\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u5b83\u5141\u8bb8\u60a8\u6c34\u5e73\u5206\u5272/\u7f29\u653e\u5185\u5bb9\u91cf \u5b83\u5141\u8bb8\u60a8\u8de8\u5206\u7247\uff08\u53ef\u80fd\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\uff09\u5206\u5e03\u548c\u5e76\u884c\u5316\u64cd\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd/\u541e\u5410\u91cf \u590d\u5236Replication\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a \u5b83\u5728\u788e\u7247/\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3002\u56e0\u6b64\uff0c\u8bf7\u52a1\u5fc5\u6ce8\u610f\uff0c\u526f\u672c\u5206\u7247\u6c38\u8fdc\u4e0d\u4f1a\u5728\u4e0e\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb/\u4e3b\u5206\u7247\u76f8\u540c\u7684\u8282\u70b9\u4e0a\u5206\u914d\u3002 \u5b83\u5141\u8bb8\u60a8\u6269\u5c55\u641c\u7d22\u91cf/\u541e\u5410\u91cf\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5728\u6240\u6709\u526f\u672c\u4e0a\u5e76\u884c\u6267\u884c\u641c\u7d22\u3002 \u603b\u800c\u8a00\u4e4b\uff0c\u6bcf\u4e2a\u7d22\u5f15\u53ef\u4ee5\u62c6\u5206\u4e3a\u591a\u4e2a\u5206\u7247\u3002\u7d22\u5f15\u4e5f\u53ef\u4ee5\u590d\u5236\u4e3a\u96f6\uff08\u8868\u793a\u6ca1\u6709\u526f\u672c\uff09\u6216\u66f4\u591a\u6b21\u3002\u590d\u5236\u540e\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5c06\u5177\u6709\u4e3b\u5206\u7247\uff08\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb\u5206\u7247\uff09\u548c\u526f\u672c\u5206\u7247\uff08\u4e3b\u5206\u7247\u7684\u526f\u672c\uff09\u3002\u53ef\u4ee5\u5728\u521b\u5efa\u7d22\u5f15\u65f6\u4e3a\u6bcf\u4e2a\u7d22\u5f15\u5b9a\u4e49\u5206\u7247\u548c\u526f\u672c\u7684\u6570\u91cf\u3002\u521b\u5efa\u7d22\u5f15\u540e\uff0c\u60a8\u53ef\u4ee5\u968f\u65f6\u52a8\u6001\u66f4\u6539\u526f\u672c\u6570\uff0c\u4f46\u4e0d\u80fd\u5728\u4e8b\u540e\u66f4\u6539\u5206\u7247\u6570\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cElasticsearch\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5206\u914d\u4e865\u4e2a\u4e3b\u5206\u7247\u548c1\u4e2a\u526f\u672c\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u7fa4\u96c6\u4e2d\u81f3\u5c11\u6709\u4e24\u4e2a\u8282\u70b9\uff0c\u5219\u7d22\u5f15\u5c06\u5305\u542b5\u4e2a\u4e3b\u5206\u7247\u548c\u53e6\u59165\u4e2a\u526f\u672c\u5206\u7247\uff081\u4e2a\u5b8c\u6574\u526f\u672c\uff09\uff0c\u603b\u8ba1\u4e3a\u6bcf\u4e2a\u7d22\u5f1510\u4e2a\u5206\u7247\u3002 curl -X PUT \"localhost:9200/customer?pretty\" #\u521b\u5efa\u540d\u4e3acustomer\u7684\u7d22\u5f15 curl -X GET \"localhost:9200/_cat/indices?v\" #\u5217\u51fa\u6240\u6709\u7d22\u5f15","title":"ELK Stack"},{"location":"Firewalld/","text":"","title":"Firewalld"},{"location":"Git/","text":"Git \u00b6 \u4ee3\u7406\u8bbe\u7f6e \u00b6 # http\u548chttps\u534f\u8bae\u8bbe\u7f6esocks5\u4ee3\u7406 git config --global http.proxy 'socks5h://127.0.0.1:1080' # socks5, h\u8868\u793a\u5305\u62ec\u57df\u540d\u89e3\u6790 git config --global http.proxy http://127.0.0.1:108 # \u8bbe\u7f6ehttp\u548chttps\u4ee3\u7406 git config --global --unset http.proxy # \u53d6\u6d88\u4ee3\u7406 git config --global http.https://github.com.proxy socks5://127.0.0.1:1080 # \u53ea\u5bf9github.com\u8bbe\u7f6e\u4ee3\u7406 git config --global --unset http.https://github.com.proxy # \u53d6\u6d88\u5bf9github.com\u7684\u4ee3\u7406 # ssh\u534f\u8bae\u8bbe\u7f6e\u4ee3\u7406 # Linux\u4fee\u6539~/.ssh/config\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9 Host github.com User git ProxyCommand nc -v -x 127 .0.0.1:1080 %h %p # Windows\u5728\u7528\u6237\u76ee\u5f55\u4e0b\u4fee\u6539.ssh/config\u6587\u4ef6\uff0c\u6ce8\u610f\u8981\u5b89\u88c5gitforwindows\u5e76\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf Host github.com User git ProxyCommand connect -S 127 .0.0.1:1080 %h %p \u57fa\u672c\u8bbe\u7f6e \u00b6 git config --global core.autocrlf true # \u8bbe\u7f6etrue\u540e\uff0c\u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u81ea\u52a8\u8f6c\u4e3acrlf git config --global core.autocrlf input # \u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u4e0d\u81ea\u52a8\u8f6c\u4e3aCRLF git config --global core.autocrlf false # \u63d0\u4ea4\u548c\u7b7e\u51fa\u65f6\u4fdd\u7559crlf\u6362\u884c \u57fa\u672c\u4f7f\u7528\u6d41\u7a0b \u00b6 # \u5b89\u88c5\u540e\u8bbe\u7f6e\u7528\u6237\u540d\u548c\u90ae\u7bb1\uff1a git config --global user.name \"Your Name\" git config --global user.email \"email@example.com\" git init # \u521d\u59cb\u5316\u4ed3\u5e93 # \u6bcf\u6b21\u5f00\u53d1\u4e00\u4e2a\u65b0\u529f\u80fd\uff0c\u90fd\u5e94\u8be5\u5efa\u4e00\u4e2a\u65b0\u7684\u5355\u72ec\u5206\u652f,\u83b7\u53d6\u4e3b\u5e72master\u4ee3\u7801 git checkout master git pull # \u65b0\u5efa\u4e00\u4e2a\u5f00\u53d1\u5206\u652fmyfeature git checkout -b myfeature # \u63d0\u4ea4\u5206\u652f git add --all # \u4ecegit2.0\u540eall\u53c2\u6570\u662fgit add\u7684\u9ed8\u8ba4\u53c2\u6570 git add --all git remore add origin [ \u8fdc\u7a0b\u4ed3\u5e93\u8def\u5f84 ] git status # \u53c2\u6570vervose\u4f1a\u5217\u51fadiff\u7684\u7ed3\u679c git commit --vervose # \u4ee5\u7a7a\u6d88\u606fcommit\uff0c\u5373\u4e0d\u5199commit message git commit -a --allow-empty-message -m \"\" # \u8bbe\u7f6e\u8bb0\u4f4f\u5bc6\u7801\uff08\u9ed8\u8ba415\u5206\u949f\uff09\uff1a git config --global credential.helper cache # \u5982\u679c\u60f3\u81ea\u5df1\u8bbe\u7f6e\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff1a git config --global credential.helper 'cache --timeout=3600' # \u5b88\u62a4\u7a0b\u5e8f\u63d0\u524d\u9000\u51fa\uff0c\u8bf7\u5728\u8d85\u65f6\u4e4b\u524d\u5fd8\u8bb0\u6240\u6709\u7f13\u5b58\u7684\u51ed\u636e git credential-cache exit # \u957f\u671f\u5b58\u50a8\u5bc6\u7801\uff1a git config --global credential.helper store # \u53d6\u6d88\u5b58\u50a8\u5bc6\u7801 git config --unset-all credential.helper git config --global --unset-all credential.helper git config --system --unset-all credential.helper # \u5199\u63d0\u4ea4\u4fe1\u606f,\u63d0\u4ea4commit\u65f6\uff0c\u5fc5\u987b\u7ed9\u51fa\u5b8c\u6574\u7684\u63d0\u4ea4\u4fe1\u606f\u3002\u7b2c\u4e00\u884c\u662f\u4e0d\u8d85\u8fc750\u4e2a\u5b57\u7684\u63d0\u8981\uff0c\u7136\u540e\u7a7a\u4e00\u884c\uff0c\u7f57\u5217\u51fa\u6539\u52a8\u539f\u56e0\u3001\u4e3b\u8981\u53d8\u52a8\u3001\u4ee5\u53ca\u9700\u8981\u6ce8\u610f\u7684\u95ee\u9898\u3002\u6700\u540e\uff0c\u63d0\u4f9b\u5bf9\u5e94\u7684\u7f51\u5740\uff08\u6bd4\u5982Bug ticket\uff09\u3002 # \u4e0e\u4e3b\u5e72\u540c\u6b65-\u5206\u652f\u5f00\u53d1\u8fc7\u7a0b\u5e94\u7ecf\u5e38\u4e0e\u4e3b\u5e72\u4fdd\u6301\u540c\u6b65 git fetch origin git rebase origin/master # \u5408\u5e76commit,\u5206\u652f\u5f00\u53d1\u540e\uff0c\u53ef\u80fd\u5f88\u591acommit\uff0c\u5408\u5e76\u5230\u4e3b\u5e72\u65f6\uff0c\u6700\u597d\u53ea\u6709\u4e00\u4e2a\u6216\u4e24\u4e09\u4e2acommit\uff0c-i\u53c2\u6570\u8868\u793a\u4e92\u52a8(interactive) git rebase -i origin/master # \u63a8\u9001\u5206\u652f\u81f3\u8fdc\u7a0b\u4ed3\u5e93 git push --force origin myfeature # \u53d1\u9001pull request,\u63d0\u4ea4\u540e\uff0c\u53d1\u51fapull request\u5230master\u5206\u652f\uff0c\u8bf7\u6c42\u522b\u4eba\u8fdb\u884c\u4ee3\u7801review\uff0c\u786e\u8ba4\u53ef\u4ee5\u5408\u5e76\u5230master # \u5207\u6362\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff1a # \u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740 git remote set-url origin URL # \u66f4\u6362\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff0cURL\u4e3a\u65b0\u5730\u5740\u3002 # \u65b9\u5f0f\u4e8c\uff1a\u5148\u5220\u9664\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff0c\u7136\u540e\u518d\u6dfb\u52a0 git remote rm origin # \u5220\u9664\u73b0\u6709\u8fdc\u7a0b\u4ed3\u5e93 git remote add origin url # \u6dfb\u52a0\u65b0\u8fdc\u7a0b\u4ed3\u5e93 # \u67e5\u770b\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5730\u5740 git remote -v \u5e38\u7528git\u547d\u4ee4 \u00b6 # \u65b0\u5efa\u4ee3\u7801\u5e93 git init\u521d\u59cb\u5316 git clone [ url ] git clone --depth 1 2 .\u914d\u7f6e # \u663e\u793a\u5f53\u524d\u7684Git\u914d\u7f6e git config --list # \u7f16\u8f91Git\u914d\u7f6e\u6587\u4ef6 git config -e [ --global ] # \u8bbe\u7f6e\u63d0\u4ea4\u4ee3\u7801\u65f6\u7684\u7528\u6237\u4fe1\u606f git config [ --global ] user.name \"[name]\" git config [ --global ] user.email \"[email address]\" 3 .\u589e\u52a0/\u5220\u9664\u6587\u4ef6 # \u6dfb\u52a0\u6307\u5b9a\u6587\u4ef6\u5230\u6682\u5b58\u533a git add [ file1 ] [ file2 ] ... # \u6dfb\u52a0\u6307\u5b9a\u76ee\u5f55\u5230\u6682\u5b58\u533a\uff0c\u5305\u62ec\u5b50\u76ee\u5f55 git add [ dir ] # \u6dfb\u52a0\u5f53\u524d\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\u5230\u6682\u5b58\u533a git add . # \u6dfb\u52a0\u6bcf\u4e2a\u53d8\u5316\u524d\uff0c\u90fd\u4f1a\u8981\u6c42\u786e\u8ba4\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a\u6587\u4ef6\u7684\u591a\u5904\u53d8\u5316\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5206\u6b21\u63d0\u4ea4 git add -p # \u5220\u9664\u5de5\u4f5c\u533a\u6587\u4ef6\uff0c\u5e76\u4e14\u5c06\u8fd9\u6b21\u5220\u9664\u653e\u5165\u6682\u5b58\u533a git rm [ file1 ] [ file2 ] ... # \u505c\u6b62\u8ffd\u8e2a\u6307\u5b9a\u6587\u4ef6\uff0c\u4f46\u8be5\u6587\u4ef6\u4f1a\u4fdd\u7559\u5728\u5de5\u4f5c\u533a git rm -r --cached [ file ] # \u6539\u540d\u6587\u4ef6\uff0c\u5e76\u4e14\u5c06\u8fd9\u4e2a\u6539\u540d\u653e\u5165\u6682\u5b58\u533a git mv [ file-original ] [ file-renamed ] 4 .\u4ee3\u7801\u63d0\u4ea4 # \u63d0\u4ea4\u6682\u5b58\u533a\u5230\u4ed3\u5e93\u533a git commit -m [ message ] # \u63d0\u4ea4\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u4ed3\u5e93\u533a git commit [ file1 ] [ file2 ] ... -m [ message ] # \u63d0\u4ea4\u5de5\u4f5c\u533a\u81ea\u4e0a\u6b21commit\u4e4b\u540e\u7684\u53d8\u5316\uff0c\u76f4\u63a5\u5230\u4ed3\u5e93\u533a git commit -a # \u63d0\u4ea4\u65f6\u663e\u793a\u6240\u6709diff\u4fe1\u606f git commit -v # \u5982\u679c\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u65b0\u53d8\u5316\uff0c\u5219\u7528\u6765\u6539\u5199\u4e0a\u4e00\u6b21commit\u7684\u63d0\u4ea4\u4fe1\u606f git commit --amend -m [ message ] # \u91cd\u505a\u4e0a\u4e00\u6b21commit\uff0c\u5e76\u5305\u62ec\u6307\u5b9a\u6587\u4ef6\u7684\u65b0\u53d8\u5316 git commit --amend [ file1 ] [ file2 ] ... 5 .\u5206\u652f # \u5217\u51fa\u6240\u6709\u672c\u5730\u5206\u652f git branch # \u5217\u51fa\u6240\u6709\u8fdc\u7a0b\u5206\u652f git branch -r # \u5217\u51fa\u6240\u6709\u672c\u5730\u5206\u652f\u548c\u8fdc\u7a0b\u5206\u652f git branch -a # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u4f46\u4f9d\u7136\u505c\u7559\u5728\u5f53\u524d\u5206\u652f git branch [ branch-name ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u5e76\u5207\u6362\u5230\u8be5\u5206\u652f git checkout -b [ branch ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u6307\u5411\u6307\u5b9acommit git branch [ branch ] [ commit ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u4e0e\u6307\u5b9a\u7684\u8fdc\u7a0b\u5206\u652f\u5efa\u7acb\u8ffd\u8e2a\u5173\u7cfb git branch --track [ branch ] [ remote-branch ] # \u5207\u6362\u5230\u6307\u5b9a\u5206\u652f\uff0c\u5e76\u66f4\u65b0\u5de5\u4f5c\u533a git checkout [ branch-name ] # \u5207\u6362\u5230\u4e0a\u4e00\u4e2a\u5206\u652f git checkout - # \u5efa\u7acb\u8ffd\u8e2a\u5173\u7cfb\uff0c\u5728\u73b0\u6709\u5206\u652f\u4e0e\u6307\u5b9a\u7684\u8fdc\u7a0b\u5206\u652f\u4e4b\u95f4 git branch --set-upstream [ branch ] [ remote-branch ] # \u5408\u5e76\u6307\u5b9a\u5206\u652f\u5230\u5f53\u524d\u5206\u652f git merge [ branch ] # \u9009\u62e9\u4e00\u4e2acommit\uff0c\u5408\u5e76\u8fdb\u5f53\u524d\u5206\u652f git cherry-pick [ commit ] # \u5220\u9664\u5206\u652f git branch -d [ branch-name ] # \u5220\u9664\u8fdc\u7a0b\u5206\u652f git push origin --delete [ branch-name ] git branch -dr [ remote/branch ] 6 .\u6807\u7b7e # \u5217\u51fa\u6240\u6709tag git tag # \u65b0\u5efa\u4e00\u4e2atag\u5728\u5f53\u524dcommit git tag [ tag ] # \u65b0\u5efa\u4e00\u4e2atag\u5728\u6307\u5b9acommit git tag [ tag ] [ commit ] # \u5220\u9664\u672c\u5730tag git tag -d [ tag ] # \u5220\u9664\u8fdc\u7a0btag git push origin :refs/tags/ [ tagName ] # \u67e5\u770btag\u4fe1\u606f git show [ tag ] # \u63d0\u4ea4\u6307\u5b9atag git push [ remote ] [ tag ] # \u63d0\u4ea4\u6240\u6709tag git push [ remote ] --tags # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u6307\u5411\u67d0\u4e2atag git checkout -b [ branch ] [ tag ] 7 .\u67e5\u770b\u4fe1\u606f # \u663e\u793a\u6709\u53d8\u66f4\u7684\u6587\u4ef6 git status # \u663e\u793a\u5f53\u524d\u5206\u652f\u7684\u7248\u672c\u5386\u53f2 git log # \u663e\u793acommit\u5386\u53f2\uff0c\u4ee5\u53ca\u6bcf\u6b21commit\u53d1\u751f\u53d8\u66f4\u7684\u6587\u4ef6 git log --stat # \u641c\u7d22\u63d0\u4ea4\u5386\u53f2\uff0c\u6839\u636e\u5173\u952e\u8bcd git log -S [ keyword ] # \u663e\u793a\u67d0\u4e2acommit\u4e4b\u540e\u7684\u6240\u6709\u53d8\u52a8\uff0c\u6bcf\u4e2acommit\u5360\u636e\u4e00\u884c git log [ tag ] HEAD --pretty = format:%s # \u663e\u793a\u67d0\u4e2acommit\u4e4b\u540e\u7684\u6240\u6709\u53d8\u52a8\uff0c\u5176\"\u63d0\u4ea4\u8bf4\u660e\"\u5fc5\u987b\u7b26\u5408\u641c\u7d22\u6761\u4ef6 git log [tag] HEAD --grep feature # \u663e\u793a\u67d0\u4e2a\u6587\u4ef6\u7684\u7248\u672c\u5386\u53f2\uff0c\u5305\u62ec\u6587\u4ef6\u6539\u540d git log --follow [ file ] git whatchanged [ file ] # \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u76f8\u5173\u7684\u6bcf\u4e00\u6b21diff git log -p [ file ] # \u663e\u793a\u8fc7\u53bb5\u6b21\u63d0\u4ea4 git log -5 --pretty --oneline # \u663e\u793a\u6240\u6709\u63d0\u4ea4\u8fc7\u7684\u7528\u6237\uff0c\u6309\u63d0\u4ea4\u6b21\u6570\u6392\u5e8f git shortlog -sn # \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u662f\u4ec0\u4e48\u4eba\u5728\u4ec0\u4e48\u65f6\u95f4\u4fee\u6539\u8fc7 git blame [ file ] # \u663e\u793a\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u7684\u5dee\u5f02 git diff # \u663e\u793a\u6682\u5b58\u533a\u548c\u4e0a\u4e00\u4e2acommit\u7684\u5dee\u5f02 git diff --cached [ file ] # \u663e\u793a\u5de5\u4f5c\u533a\u4e0e\u5f53\u524d\u5206\u652f\u6700\u65b0commit\u4e4b\u95f4\u7684\u5dee\u5f02 git diff HEAD # \u663e\u793a\u4e24\u6b21\u63d0\u4ea4\u4e4b\u95f4\u7684\u5dee\u5f02 git diff [ first-branch ] ... [ second-branch ] # \u663e\u793a\u4eca\u5929\u4f60\u5199\u4e86\u591a\u5c11\u884c\u4ee3\u7801 git diff --shortstat \"@{0 day ago}\" # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u7684\u5143\u6570\u636e\u548c\u5185\u5bb9\u53d8\u5316 git show [ commit ] # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6 git show --name-only [ commit ] # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u65f6\uff0c\u67d0\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9 git show [commit]:[filename] # \u663e\u793a\u5f53\u524d\u5206\u652f\u7684\u6700\u8fd1\u51e0\u6b21\u63d0\u4ea4 git reflog 8 .\u8fdc\u7a0b\u540c\u6b65 # \u4e0b\u8f7d\u8fdc\u7a0b\u4ed3\u5e93\u7684\u6240\u6709\u53d8\u52a8 git fetch [ remote ] # \u663e\u793a\u6240\u6709\u8fdc\u7a0b\u4ed3\u5e93 git remote -v # \u663e\u793a\u67d0\u4e2a\u8fdc\u7a0b\u4ed3\u5e93\u7684\u4fe1\u606f git remote show [ remote ] # \u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u5e76\u547d\u540d git remote add [ shortname ] [ url ] # \u53d6\u56de\u8fdc\u7a0b\u4ed3\u5e93\u7684\u53d8\u5316\uff0c\u5e76\u4e0e\u672c\u5730\u5206\u652f\u5408\u5e76 git pull [remote] [branch] # \u4e0a\u4f20\u672c\u5730\u6307\u5b9a\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93 git push [ remote ] [ branch ] # \u5f3a\u884c\u63a8\u9001\u5f53\u524d\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u5373\u4f7f\u6709\u51b2\u7a81 git push [remote] --force # \u63a8\u9001\u6240\u6709\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93 git push [ remote ] --all 9 .\u64a4\u9500 # \u6062\u590d\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u5de5\u4f5c\u533a git checkout [ file ] # \u6062\u590d\u67d0\u4e2acommit\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a git checkout [ commit ] [ file ] # \u6062\u590d\u6682\u5b58\u533a\u7684\u6240\u6709\u6587\u4ef6\u5230\u5de5\u4f5c\u533a git checkout . # \u91cd\u7f6e\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\uff0c\u4e0e\u4e0a\u4e00\u6b21commit\u4fdd\u6301\u4e00\u81f4\uff0c\u4f46\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset [ file ] # \u91cd\u7f6e\u6682\u5b58\u533a\u4e0e\u5de5\u4f5c\u533a\uff0c\u4e0e\u4e0a\u4e00\u6b21commit\u4fdd\u6301\u4e00\u81f4 git reset --hard # \u91cd\u7f6e\u5f53\u524d\u5206\u652f\u7684\u6307\u9488\u4e3a\u6307\u5b9acommit\uff0c\u540c\u65f6\u91cd\u7f6e\u6682\u5b58\u533a\uff0c\u4f46\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset [ commit ] # \u91cd\u7f6e\u5f53\u524d\u5206\u652f\u7684HEAD\u4e3a\u6307\u5b9acommit\uff0c\u540c\u65f6\u91cd\u7f6e\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\uff0c\u4e0e\u6307\u5b9acommit\u4e00\u81f4 git reset --hard [commit] # \u91cd\u7f6e\u5f53\u524dHEAD\u4e3a\u6307\u5b9acommit\uff0c\u4f46\u4fdd\u6301\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset --keep [ commit ] # \u65b0\u5efa\u4e00\u4e2acommit\uff0c\u7528\u6765\u64a4\u9500\u6307\u5b9acommit # \u540e\u8005\u7684\u6240\u6709\u53d8\u5316\u90fd\u5c06\u88ab\u524d\u8005\u62b5\u6d88\uff0c\u5e76\u4e14\u5e94\u7528\u5230\u5f53\u524d\u5206\u652f git revert [ commit ] # \u6682\u65f6\u5c06\u672a\u63d0\u4ea4\u7684\u53d8\u5316\u79fb\u9664\uff0c\u7a0d\u540e\u518d\u79fb\u5165 git stash git stash pop 10 .\u5176\u4ed6 # \u751f\u6210\u4e00\u4e2a\u53ef\u4f9b\u53d1\u5e03\u7684\u538b\u7f29\u5305 git archive","title":"Git&GitLab"},{"location":"Git/#git","text":"","title":"Git"},{"location":"Git/#_1","text":"# http\u548chttps\u534f\u8bae\u8bbe\u7f6esocks5\u4ee3\u7406 git config --global http.proxy 'socks5h://127.0.0.1:1080' # socks5, h\u8868\u793a\u5305\u62ec\u57df\u540d\u89e3\u6790 git config --global http.proxy http://127.0.0.1:108 # \u8bbe\u7f6ehttp\u548chttps\u4ee3\u7406 git config --global --unset http.proxy # \u53d6\u6d88\u4ee3\u7406 git config --global http.https://github.com.proxy socks5://127.0.0.1:1080 # \u53ea\u5bf9github.com\u8bbe\u7f6e\u4ee3\u7406 git config --global --unset http.https://github.com.proxy # \u53d6\u6d88\u5bf9github.com\u7684\u4ee3\u7406 # ssh\u534f\u8bae\u8bbe\u7f6e\u4ee3\u7406 # Linux\u4fee\u6539~/.ssh/config\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9 Host github.com User git ProxyCommand nc -v -x 127 .0.0.1:1080 %h %p # Windows\u5728\u7528\u6237\u76ee\u5f55\u4e0b\u4fee\u6539.ssh/config\u6587\u4ef6\uff0c\u6ce8\u610f\u8981\u5b89\u88c5gitforwindows\u5e76\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf Host github.com User git ProxyCommand connect -S 127 .0.0.1:1080 %h %p","title":"\u4ee3\u7406\u8bbe\u7f6e"},{"location":"Git/#_2","text":"git config --global core.autocrlf true # \u8bbe\u7f6etrue\u540e\uff0c\u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u81ea\u52a8\u8f6c\u4e3acrlf git config --global core.autocrlf input # \u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u4e0d\u81ea\u52a8\u8f6c\u4e3aCRLF git config --global core.autocrlf false # \u63d0\u4ea4\u548c\u7b7e\u51fa\u65f6\u4fdd\u7559crlf\u6362\u884c","title":"\u57fa\u672c\u8bbe\u7f6e"},{"location":"Git/#_3","text":"# \u5b89\u88c5\u540e\u8bbe\u7f6e\u7528\u6237\u540d\u548c\u90ae\u7bb1\uff1a git config --global user.name \"Your Name\" git config --global user.email \"email@example.com\" git init # \u521d\u59cb\u5316\u4ed3\u5e93 # \u6bcf\u6b21\u5f00\u53d1\u4e00\u4e2a\u65b0\u529f\u80fd\uff0c\u90fd\u5e94\u8be5\u5efa\u4e00\u4e2a\u65b0\u7684\u5355\u72ec\u5206\u652f,\u83b7\u53d6\u4e3b\u5e72master\u4ee3\u7801 git checkout master git pull # \u65b0\u5efa\u4e00\u4e2a\u5f00\u53d1\u5206\u652fmyfeature git checkout -b myfeature # \u63d0\u4ea4\u5206\u652f git add --all # \u4ecegit2.0\u540eall\u53c2\u6570\u662fgit add\u7684\u9ed8\u8ba4\u53c2\u6570 git add --all git remore add origin [ \u8fdc\u7a0b\u4ed3\u5e93\u8def\u5f84 ] git status # \u53c2\u6570vervose\u4f1a\u5217\u51fadiff\u7684\u7ed3\u679c git commit --vervose # \u4ee5\u7a7a\u6d88\u606fcommit\uff0c\u5373\u4e0d\u5199commit message git commit -a --allow-empty-message -m \"\" # \u8bbe\u7f6e\u8bb0\u4f4f\u5bc6\u7801\uff08\u9ed8\u8ba415\u5206\u949f\uff09\uff1a git config --global credential.helper cache # \u5982\u679c\u60f3\u81ea\u5df1\u8bbe\u7f6e\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff1a git config --global credential.helper 'cache --timeout=3600' # \u5b88\u62a4\u7a0b\u5e8f\u63d0\u524d\u9000\u51fa\uff0c\u8bf7\u5728\u8d85\u65f6\u4e4b\u524d\u5fd8\u8bb0\u6240\u6709\u7f13\u5b58\u7684\u51ed\u636e git credential-cache exit # \u957f\u671f\u5b58\u50a8\u5bc6\u7801\uff1a git config --global credential.helper store # \u53d6\u6d88\u5b58\u50a8\u5bc6\u7801 git config --unset-all credential.helper git config --global --unset-all credential.helper git config --system --unset-all credential.helper # \u5199\u63d0\u4ea4\u4fe1\u606f,\u63d0\u4ea4commit\u65f6\uff0c\u5fc5\u987b\u7ed9\u51fa\u5b8c\u6574\u7684\u63d0\u4ea4\u4fe1\u606f\u3002\u7b2c\u4e00\u884c\u662f\u4e0d\u8d85\u8fc750\u4e2a\u5b57\u7684\u63d0\u8981\uff0c\u7136\u540e\u7a7a\u4e00\u884c\uff0c\u7f57\u5217\u51fa\u6539\u52a8\u539f\u56e0\u3001\u4e3b\u8981\u53d8\u52a8\u3001\u4ee5\u53ca\u9700\u8981\u6ce8\u610f\u7684\u95ee\u9898\u3002\u6700\u540e\uff0c\u63d0\u4f9b\u5bf9\u5e94\u7684\u7f51\u5740\uff08\u6bd4\u5982Bug ticket\uff09\u3002 # \u4e0e\u4e3b\u5e72\u540c\u6b65-\u5206\u652f\u5f00\u53d1\u8fc7\u7a0b\u5e94\u7ecf\u5e38\u4e0e\u4e3b\u5e72\u4fdd\u6301\u540c\u6b65 git fetch origin git rebase origin/master # \u5408\u5e76commit,\u5206\u652f\u5f00\u53d1\u540e\uff0c\u53ef\u80fd\u5f88\u591acommit\uff0c\u5408\u5e76\u5230\u4e3b\u5e72\u65f6\uff0c\u6700\u597d\u53ea\u6709\u4e00\u4e2a\u6216\u4e24\u4e09\u4e2acommit\uff0c-i\u53c2\u6570\u8868\u793a\u4e92\u52a8(interactive) git rebase -i origin/master # \u63a8\u9001\u5206\u652f\u81f3\u8fdc\u7a0b\u4ed3\u5e93 git push --force origin myfeature # \u53d1\u9001pull request,\u63d0\u4ea4\u540e\uff0c\u53d1\u51fapull request\u5230master\u5206\u652f\uff0c\u8bf7\u6c42\u522b\u4eba\u8fdb\u884c\u4ee3\u7801review\uff0c\u786e\u8ba4\u53ef\u4ee5\u5408\u5e76\u5230master # \u5207\u6362\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff1a # \u65b9\u5f0f\u4e00\uff1a\u4fee\u6539\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740 git remote set-url origin URL # \u66f4\u6362\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff0cURL\u4e3a\u65b0\u5730\u5740\u3002 # \u65b9\u5f0f\u4e8c\uff1a\u5148\u5220\u9664\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff0c\u7136\u540e\u518d\u6dfb\u52a0 git remote rm origin # \u5220\u9664\u73b0\u6709\u8fdc\u7a0b\u4ed3\u5e93 git remote add origin url # \u6dfb\u52a0\u65b0\u8fdc\u7a0b\u4ed3\u5e93 # \u67e5\u770b\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5730\u5740 git remote -v","title":"\u57fa\u672c\u4f7f\u7528\u6d41\u7a0b"},{"location":"Git/#git_1","text":"# \u65b0\u5efa\u4ee3\u7801\u5e93 git init\u521d\u59cb\u5316 git clone [ url ] git clone --depth 1 2 .\u914d\u7f6e # \u663e\u793a\u5f53\u524d\u7684Git\u914d\u7f6e git config --list # \u7f16\u8f91Git\u914d\u7f6e\u6587\u4ef6 git config -e [ --global ] # \u8bbe\u7f6e\u63d0\u4ea4\u4ee3\u7801\u65f6\u7684\u7528\u6237\u4fe1\u606f git config [ --global ] user.name \"[name]\" git config [ --global ] user.email \"[email address]\" 3 .\u589e\u52a0/\u5220\u9664\u6587\u4ef6 # \u6dfb\u52a0\u6307\u5b9a\u6587\u4ef6\u5230\u6682\u5b58\u533a git add [ file1 ] [ file2 ] ... # \u6dfb\u52a0\u6307\u5b9a\u76ee\u5f55\u5230\u6682\u5b58\u533a\uff0c\u5305\u62ec\u5b50\u76ee\u5f55 git add [ dir ] # \u6dfb\u52a0\u5f53\u524d\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\u5230\u6682\u5b58\u533a git add . # \u6dfb\u52a0\u6bcf\u4e2a\u53d8\u5316\u524d\uff0c\u90fd\u4f1a\u8981\u6c42\u786e\u8ba4\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a\u6587\u4ef6\u7684\u591a\u5904\u53d8\u5316\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5206\u6b21\u63d0\u4ea4 git add -p # \u5220\u9664\u5de5\u4f5c\u533a\u6587\u4ef6\uff0c\u5e76\u4e14\u5c06\u8fd9\u6b21\u5220\u9664\u653e\u5165\u6682\u5b58\u533a git rm [ file1 ] [ file2 ] ... # \u505c\u6b62\u8ffd\u8e2a\u6307\u5b9a\u6587\u4ef6\uff0c\u4f46\u8be5\u6587\u4ef6\u4f1a\u4fdd\u7559\u5728\u5de5\u4f5c\u533a git rm -r --cached [ file ] # \u6539\u540d\u6587\u4ef6\uff0c\u5e76\u4e14\u5c06\u8fd9\u4e2a\u6539\u540d\u653e\u5165\u6682\u5b58\u533a git mv [ file-original ] [ file-renamed ] 4 .\u4ee3\u7801\u63d0\u4ea4 # \u63d0\u4ea4\u6682\u5b58\u533a\u5230\u4ed3\u5e93\u533a git commit -m [ message ] # \u63d0\u4ea4\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u4ed3\u5e93\u533a git commit [ file1 ] [ file2 ] ... -m [ message ] # \u63d0\u4ea4\u5de5\u4f5c\u533a\u81ea\u4e0a\u6b21commit\u4e4b\u540e\u7684\u53d8\u5316\uff0c\u76f4\u63a5\u5230\u4ed3\u5e93\u533a git commit -a # \u63d0\u4ea4\u65f6\u663e\u793a\u6240\u6709diff\u4fe1\u606f git commit -v # \u5982\u679c\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u65b0\u53d8\u5316\uff0c\u5219\u7528\u6765\u6539\u5199\u4e0a\u4e00\u6b21commit\u7684\u63d0\u4ea4\u4fe1\u606f git commit --amend -m [ message ] # \u91cd\u505a\u4e0a\u4e00\u6b21commit\uff0c\u5e76\u5305\u62ec\u6307\u5b9a\u6587\u4ef6\u7684\u65b0\u53d8\u5316 git commit --amend [ file1 ] [ file2 ] ... 5 .\u5206\u652f # \u5217\u51fa\u6240\u6709\u672c\u5730\u5206\u652f git branch # \u5217\u51fa\u6240\u6709\u8fdc\u7a0b\u5206\u652f git branch -r # \u5217\u51fa\u6240\u6709\u672c\u5730\u5206\u652f\u548c\u8fdc\u7a0b\u5206\u652f git branch -a # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u4f46\u4f9d\u7136\u505c\u7559\u5728\u5f53\u524d\u5206\u652f git branch [ branch-name ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u5e76\u5207\u6362\u5230\u8be5\u5206\u652f git checkout -b [ branch ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u6307\u5411\u6307\u5b9acommit git branch [ branch ] [ commit ] # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u4e0e\u6307\u5b9a\u7684\u8fdc\u7a0b\u5206\u652f\u5efa\u7acb\u8ffd\u8e2a\u5173\u7cfb git branch --track [ branch ] [ remote-branch ] # \u5207\u6362\u5230\u6307\u5b9a\u5206\u652f\uff0c\u5e76\u66f4\u65b0\u5de5\u4f5c\u533a git checkout [ branch-name ] # \u5207\u6362\u5230\u4e0a\u4e00\u4e2a\u5206\u652f git checkout - # \u5efa\u7acb\u8ffd\u8e2a\u5173\u7cfb\uff0c\u5728\u73b0\u6709\u5206\u652f\u4e0e\u6307\u5b9a\u7684\u8fdc\u7a0b\u5206\u652f\u4e4b\u95f4 git branch --set-upstream [ branch ] [ remote-branch ] # \u5408\u5e76\u6307\u5b9a\u5206\u652f\u5230\u5f53\u524d\u5206\u652f git merge [ branch ] # \u9009\u62e9\u4e00\u4e2acommit\uff0c\u5408\u5e76\u8fdb\u5f53\u524d\u5206\u652f git cherry-pick [ commit ] # \u5220\u9664\u5206\u652f git branch -d [ branch-name ] # \u5220\u9664\u8fdc\u7a0b\u5206\u652f git push origin --delete [ branch-name ] git branch -dr [ remote/branch ] 6 .\u6807\u7b7e # \u5217\u51fa\u6240\u6709tag git tag # \u65b0\u5efa\u4e00\u4e2atag\u5728\u5f53\u524dcommit git tag [ tag ] # \u65b0\u5efa\u4e00\u4e2atag\u5728\u6307\u5b9acommit git tag [ tag ] [ commit ] # \u5220\u9664\u672c\u5730tag git tag -d [ tag ] # \u5220\u9664\u8fdc\u7a0btag git push origin :refs/tags/ [ tagName ] # \u67e5\u770btag\u4fe1\u606f git show [ tag ] # \u63d0\u4ea4\u6307\u5b9atag git push [ remote ] [ tag ] # \u63d0\u4ea4\u6240\u6709tag git push [ remote ] --tags # \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\uff0c\u6307\u5411\u67d0\u4e2atag git checkout -b [ branch ] [ tag ] 7 .\u67e5\u770b\u4fe1\u606f # \u663e\u793a\u6709\u53d8\u66f4\u7684\u6587\u4ef6 git status # \u663e\u793a\u5f53\u524d\u5206\u652f\u7684\u7248\u672c\u5386\u53f2 git log # \u663e\u793acommit\u5386\u53f2\uff0c\u4ee5\u53ca\u6bcf\u6b21commit\u53d1\u751f\u53d8\u66f4\u7684\u6587\u4ef6 git log --stat # \u641c\u7d22\u63d0\u4ea4\u5386\u53f2\uff0c\u6839\u636e\u5173\u952e\u8bcd git log -S [ keyword ] # \u663e\u793a\u67d0\u4e2acommit\u4e4b\u540e\u7684\u6240\u6709\u53d8\u52a8\uff0c\u6bcf\u4e2acommit\u5360\u636e\u4e00\u884c git log [ tag ] HEAD --pretty = format:%s # \u663e\u793a\u67d0\u4e2acommit\u4e4b\u540e\u7684\u6240\u6709\u53d8\u52a8\uff0c\u5176\"\u63d0\u4ea4\u8bf4\u660e\"\u5fc5\u987b\u7b26\u5408\u641c\u7d22\u6761\u4ef6 git log [tag] HEAD --grep feature # \u663e\u793a\u67d0\u4e2a\u6587\u4ef6\u7684\u7248\u672c\u5386\u53f2\uff0c\u5305\u62ec\u6587\u4ef6\u6539\u540d git log --follow [ file ] git whatchanged [ file ] # \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u76f8\u5173\u7684\u6bcf\u4e00\u6b21diff git log -p [ file ] # \u663e\u793a\u8fc7\u53bb5\u6b21\u63d0\u4ea4 git log -5 --pretty --oneline # \u663e\u793a\u6240\u6709\u63d0\u4ea4\u8fc7\u7684\u7528\u6237\uff0c\u6309\u63d0\u4ea4\u6b21\u6570\u6392\u5e8f git shortlog -sn # \u663e\u793a\u6307\u5b9a\u6587\u4ef6\u662f\u4ec0\u4e48\u4eba\u5728\u4ec0\u4e48\u65f6\u95f4\u4fee\u6539\u8fc7 git blame [ file ] # \u663e\u793a\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u7684\u5dee\u5f02 git diff # \u663e\u793a\u6682\u5b58\u533a\u548c\u4e0a\u4e00\u4e2acommit\u7684\u5dee\u5f02 git diff --cached [ file ] # \u663e\u793a\u5de5\u4f5c\u533a\u4e0e\u5f53\u524d\u5206\u652f\u6700\u65b0commit\u4e4b\u95f4\u7684\u5dee\u5f02 git diff HEAD # \u663e\u793a\u4e24\u6b21\u63d0\u4ea4\u4e4b\u95f4\u7684\u5dee\u5f02 git diff [ first-branch ] ... [ second-branch ] # \u663e\u793a\u4eca\u5929\u4f60\u5199\u4e86\u591a\u5c11\u884c\u4ee3\u7801 git diff --shortstat \"@{0 day ago}\" # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u7684\u5143\u6570\u636e\u548c\u5185\u5bb9\u53d8\u5316 git show [ commit ] # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6 git show --name-only [ commit ] # \u663e\u793a\u67d0\u6b21\u63d0\u4ea4\u65f6\uff0c\u67d0\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9 git show [commit]:[filename] # \u663e\u793a\u5f53\u524d\u5206\u652f\u7684\u6700\u8fd1\u51e0\u6b21\u63d0\u4ea4 git reflog 8 .\u8fdc\u7a0b\u540c\u6b65 # \u4e0b\u8f7d\u8fdc\u7a0b\u4ed3\u5e93\u7684\u6240\u6709\u53d8\u52a8 git fetch [ remote ] # \u663e\u793a\u6240\u6709\u8fdc\u7a0b\u4ed3\u5e93 git remote -v # \u663e\u793a\u67d0\u4e2a\u8fdc\u7a0b\u4ed3\u5e93\u7684\u4fe1\u606f git remote show [ remote ] # \u589e\u52a0\u4e00\u4e2a\u65b0\u7684\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u5e76\u547d\u540d git remote add [ shortname ] [ url ] # \u53d6\u56de\u8fdc\u7a0b\u4ed3\u5e93\u7684\u53d8\u5316\uff0c\u5e76\u4e0e\u672c\u5730\u5206\u652f\u5408\u5e76 git pull [remote] [branch] # \u4e0a\u4f20\u672c\u5730\u6307\u5b9a\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93 git push [ remote ] [ branch ] # \u5f3a\u884c\u63a8\u9001\u5f53\u524d\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u5373\u4f7f\u6709\u51b2\u7a81 git push [remote] --force # \u63a8\u9001\u6240\u6709\u5206\u652f\u5230\u8fdc\u7a0b\u4ed3\u5e93 git push [ remote ] --all 9 .\u64a4\u9500 # \u6062\u590d\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u5de5\u4f5c\u533a git checkout [ file ] # \u6062\u590d\u67d0\u4e2acommit\u7684\u6307\u5b9a\u6587\u4ef6\u5230\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a git checkout [ commit ] [ file ] # \u6062\u590d\u6682\u5b58\u533a\u7684\u6240\u6709\u6587\u4ef6\u5230\u5de5\u4f5c\u533a git checkout . # \u91cd\u7f6e\u6682\u5b58\u533a\u7684\u6307\u5b9a\u6587\u4ef6\uff0c\u4e0e\u4e0a\u4e00\u6b21commit\u4fdd\u6301\u4e00\u81f4\uff0c\u4f46\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset [ file ] # \u91cd\u7f6e\u6682\u5b58\u533a\u4e0e\u5de5\u4f5c\u533a\uff0c\u4e0e\u4e0a\u4e00\u6b21commit\u4fdd\u6301\u4e00\u81f4 git reset --hard # \u91cd\u7f6e\u5f53\u524d\u5206\u652f\u7684\u6307\u9488\u4e3a\u6307\u5b9acommit\uff0c\u540c\u65f6\u91cd\u7f6e\u6682\u5b58\u533a\uff0c\u4f46\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset [ commit ] # \u91cd\u7f6e\u5f53\u524d\u5206\u652f\u7684HEAD\u4e3a\u6307\u5b9acommit\uff0c\u540c\u65f6\u91cd\u7f6e\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\uff0c\u4e0e\u6307\u5b9acommit\u4e00\u81f4 git reset --hard [commit] # \u91cd\u7f6e\u5f53\u524dHEAD\u4e3a\u6307\u5b9acommit\uff0c\u4f46\u4fdd\u6301\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u4e0d\u53d8 git reset --keep [ commit ] # \u65b0\u5efa\u4e00\u4e2acommit\uff0c\u7528\u6765\u64a4\u9500\u6307\u5b9acommit # \u540e\u8005\u7684\u6240\u6709\u53d8\u5316\u90fd\u5c06\u88ab\u524d\u8005\u62b5\u6d88\uff0c\u5e76\u4e14\u5e94\u7528\u5230\u5f53\u524d\u5206\u652f git revert [ commit ] # \u6682\u65f6\u5c06\u672a\u63d0\u4ea4\u7684\u53d8\u5316\u79fb\u9664\uff0c\u7a0d\u540e\u518d\u79fb\u5165 git stash git stash pop 10 .\u5176\u4ed6 # \u751f\u6210\u4e00\u4e2a\u53ef\u4f9b\u53d1\u5e03\u7684\u538b\u7f29\u5305 git archive","title":"\u5e38\u7528git\u547d\u4ee4"},{"location":"GlusterFS/","text":"","title":"GlusterFS"},{"location":"Go/","text":"","title":"Go"},{"location":"Grafana/","text":"","title":"Grafana"},{"location":"Haproxy/","text":"Haproxy \u00b6 Intro \u00b6 \u4ecb\u7ecd\u8d1f\u8f7d\u5e73\u8861\u7684\u57fa\u7840\u77e5\u8bc6\uff0cHAProxy\u4f5c\u4e3a\u4e00\u79cd\u4ea7\u54c1\uff0c\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e0d\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e00\u4e9b\u5df2\u77e5\u7684\u9677\u9631\u907f\u514d\uff0c\u4e00\u4e9b\u7279\u5b9a\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\uff0c\u83b7\u53d6\u3001\u53d1\u5c55\u53ca\u66f4\u65b0\u5b83\uff0c\u5982\u4f55\u786e\u4fdd\u60a8\u8fd0\u884c\u6240\u6709\u5df2\u77e5\u7684\u4fee\u8865\u7a0b\u5e8f\uff0c\u5173\u4e8e\u5b83\u7684\u8865\u5145\u548c\u66ff\u4ee3\u54c1 HAProxy\u662f\uff1a TCP\u4ee3\u7406\uff1a\u5b83\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u4fa6\u542c\u5957\u63a5\u5b57\u7684TCP\u8fde\u63a5\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5e76\u5c06\u8fd9\u4e9b\u63d2\u5ea7\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5141\u8bb8\u6d41\u91cf\u4e24\u4e2a\u65b9\u5411\u6d41\u52a8; HTTP\u53cd\u5411\u4ee3\u7406\uff08\u5728HTTP\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u7f51\u5173\u201d\uff09\uff1a\u5b83\u672c\u8eab\u4f5c\u4e3a\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u63a5\u53d7\u7684\u8fde\u63a5\u63a5\u6536HTTP\u8bf7\u6c42\u4fa6\u542cTCP\u5957\u63a5\u5b57\uff0c\u5e76\u5c06\u6765\u81ea\u8fd9\u4e9b\u8fde\u63a5\u7684\u8bf7\u6c42\u4f20\u9012\u7ed9\u4f7f\u7528\u4e0d\u540c\u8fde\u63a5\u7684\u670d\u52a1\u5668 SSL\u7ec8\u7ed3\u5668/\u542f\u52a8\u5668/\u5378\u8f7d\u5668\uff1a\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u53ef\u4ee5\u4f7f\u7528SSL/TLS\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u751a\u81f3\u53cc\u5411\u8fde\u63a5 TCP\u89c4\u8303\u5316\u5668\uff1a\u7531\u4e8e\u64cd\u4f5c\u5728\u672c\u5730\u7ec8\u6b62\u8fde\u63a5\u7cfb\u7edf\uff0c\u53cc\u65b9\u6ca1\u6709\u5173\u7cfb\uff0c\u6240\u4ee5\u4ea4\u901a\u4e0d\u6b63\u5e38\u7b49\u65e0\u6548\u6570\u636e\u5305\uff0c\u6807\u5fd7\u7ec4\u5408\uff0c\u7a97\u53e3\u5e7f\u544a\uff0c\u5e8f\u5217\u53f7\uff0c\u4e0d\u5b8c\u6574\u7684\u8fde\u63a5\uff08SYN floods\uff09\uff0c\u6216\u8005\u4e0d\u4f1a\u4f20\u9012\u7ed9\u53e6\u4e00\u4e2a\u4fa7\u3002\u8fd9\u53ef\u4ee5\u4fdd\u62a4\u8106\u5f31\u7684TCP\u5806\u6808\u514d\u53d7\u534f\u8bae\u653b\u51fb\u5141\u8bb8\u4e0e\u5ba2\u6237\u7aef\u4f18\u5316\u8fde\u63a5\u53c2\u6570\u800c\u65e0\u9700\u4fee\u6539\u670d\u52a1\u5668\u7684TCP\u5806\u6808\u8bbe\u7f6e\u3002 HTTP\u89c4\u8303\u5316\u7a0b\u5e8f\uff1a\u914d\u7f6e\u4e3a\u5904\u7406HTTP\u6d41\u91cf\u65f6\uff0c\u4ec5\u6709\u6548\u5b8c\u6210\u8bf7\u6c42\u5df2\u901a\u8fc7\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u8bb8\u591a\u57fa\u4e8e\u534f\u8bae\u7684\u653b\u51fb\u3002\u53e6\u5916\uff0c\u5b58\u5728\u5bb9\u5dee\u7684\u534f\u8bae\u504f\u5dee\u5728\u89c4\u8303\u4e2d\u662f\u56fa\u5b9a\u7684\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u4e0d\u4f1a\u5f15\u8d77\u95ee\u9898\u670d\u52a1\u5668\uff08\u4f8b\u5982\u591a\u884c\u6807\u9898\uff09\u3002 HTTP\u4fee\u590d\u5de5\u5177\uff1a\u5b83\u53ef\u4ee5\u4fee\u6539/\u4fee\u590d/\u6dfb\u52a0/\u5220\u9664/\u91cd\u5199URL\u6216\u4efb\u4f55\u8bf7\u6c42\u6216\u54cd\u5e94\u6807\u5934\u3002\u8fd9\u6709\u52a9\u4e8e\u89e3\u51b3\u4e92\u64cd\u4f5c\u6027\u95ee\u9898\u5728\u590d\u6742\u7684\u73af\u5883\u4e2d\u3002 \u57fa\u4e8e\u5185\u5bb9\u7684\u4ea4\u6362\u673a\uff1a\u5b83\u53ef\u4ee5\u8003\u8651\u8bf7\u6c42\u4e2d\u7684\u4efb\u4f55\u5143\u7d20\u51b3\u5b9a\u5c06\u8bf7\u6c42\u6216\u8fde\u63a5\u4f20\u9012\u7ed9\u54ea\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\u6709\u53ef\u80fd\u901a\u8fc7\u540c\u4e00\u7aef\u53e3\u5904\u7406\u591a\u4e2a\u534f\u8bae\uff08\u4f8b\u5982HTTP\uff0cHTTPS\uff0cSSH\uff09\u3002 \u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u53ef\u4ee5\u5e73\u8861TCP\u8fde\u63a5\u548cHTTP\u8981\u6c42\u3002\u5728TCP\u6a21\u5f0f\u4e0b\uff0c\u6574\u4f53\u91c7\u7528\u8d1f\u8f7d\u5e73\u8861\u51b3\u7b56\u8fde\u63a5\u3002\u5728HTTP\u6a21\u5f0f\u4e0b\uff0c\u6839\u636e\u8bf7\u6c42\u505a\u51fa\u51b3\u5b9a\u3002 \u4ea4\u901a\u76d1\u7ba1\u673a\u6784\uff1a\u5b83\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u70b9\u5e94\u7528\u4e00\u4e9b\u901f\u7387\u9650\u5236\uff0c\u4fdd\u62a4\u670d\u52a1\u5668\u514d\u53d7\u8fc7\u8f7d\uff0c\u6839\u636e\u9700\u8981\u8c03\u6574\u6d41\u91cf\u4f18\u5148\u7ea7\u5185\u5bb9\uff0c\u751a\u81f3\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4f20\u9012\u7ed9\u4e0b\u5c42\u548c\u5916\u5c42\u7f51\u7edc\u7ec4\u4ef6\u901a\u8fc7\u6807\u8bb0\u6570\u636e\u5305\u3002 \u9488\u5bf9DDoS\u548c\u670d\u52a1\u6ee5\u7528\u7684\u4fdd\u62a4\uff1a\u5b83\u53ef\u4ee5\u4fdd\u6301\u5e7f\u6cdb\u7684\u6570\u91cf\u6bcf\u4e2aIP\u5730\u5740\uff0cURL\uff0ccookie\u7b49\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u5e76\u68c0\u6d4b\u4f55\u65f6\u6ee5\u7528\u53d1\u751f\uff0c\u7136\u540e\u91c7\u53d6\u884c\u52a8\uff08\u51cf\u6162\u8fdd\u6cd5\u8005\uff0c\u963b\u6b62\u4ed6\u4eec\uff0c\u53d1\u9001\u4ed6\u4eec\u8fc7\u65f6\u7684\u5185\u5bb9\u7b49\uff09\u3002 \u7f51\u7edc\u6545\u969c\u6392\u9664\u7684\u89c2\u5bdf\u70b9\uff1a\u7531\u4e8e\u7cbe\u5ea6\u5728\u65e5\u5fd7\u4e2d\u62a5\u544a\u7684\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u7f29\u5c0f\u4e00\u4e9b\u4e0e\u7f51\u7edc\u6709\u5173\u7684\u95ee\u9898\u3002 HTTP\u538b\u7f29\u5378\u8f7d\u7a0b\u5e8f\uff1a\u5b83\u53ef\u4ee5\u538b\u7f29\u4e0d\u662f\u7531\u670d\u52a1\u5668\u538b\u7f29\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u51cf\u5c11\u5ba2\u6237\u7aef\u7684\u9875\u9762\u52a0\u8f7d\u65f6\u95f4\u8fde\u63a5\u4e0d\u826f\u6216\u4f7f\u7528\u9ad8\u5ef6\u8fdf\u7684\u79fb\u52a8\u7f51\u7edc\u3002 HAProxy\u4e0d\u662f\uff1a \u4e00\u4e2a\u663e\u5f0f\u7684HTTP\u4ee3\u7406\uff0c\u5373\u6d4f\u89c8\u5668\u7528\u6765\u8bbf\u95ee\u7684\u4ee3\u7406\u4e92\u8054\u7f51\u3002\u6709\u4e13\u95e8\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u4f18\u79c0\u5f00\u6e90\u8f6f\u4ef6\uff0c\u6bd4\u5982Squid\u3002\u4f46\u662fHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u8fd9\u6837\u7684\u4ee3\u7406\u524d\u9762\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027\u3002 \u7f13\u5b58\u4ee3\u7406\uff1a\u5b83\u5c06\u6309\u539f\u6837\u8fd4\u56de\u4ece\u670d\u52a1\u5668\u6536\u5230\u7684\u5185\u5bb9\u5e76\u4e14\u4e0d\u4f1a\u5e72\u6270\u4efb\u4f55\u7f13\u5b58\u7b56\u7565\u3002\u6709\u4f18\u79c0\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Varnish\u3002\u53ef\u4ee5\u5b89\u88c5HAProxy\u5728\u8fd9\u6837\u7684\u7f13\u5b58\u524d\u9762\u63d0\u4f9bSSL\u5378\u8f7d\uff0c\u5e76\u901a\u8fc7\u53ef\u4f38\u7f29\u6027\u667a\u80fd\u8d1f\u8f7d\u5e73\u8861\u3002 \u6570\u636e\u6e05\u7406\u5668\uff1a\u5b83\u4e0d\u4f1a\u4fee\u6539\u8bf7\u6c42\u4f53\u548c\u54cd\u5e94\u4f53\u3002 \u4e00\u4e2aWeb\u670d\u52a1\u5668\uff1a\u5728\u542f\u52a8\u671f\u95f4\uff0c\u5b83\u5c06\u81ea\u5df1\u9694\u79bb\u5728\u4e00\u4e2achroot jail\u548c\u5220\u9664\u5176\u6743\u9650\uff0c\u4ee5\u4fbf\u5b83\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u5355\u4e2a\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\u4e00\u65e6\u5f00\u59cb\u3002\u56e0\u6b64\uff0c\u5b83\u65e0\u6cd5\u8f6c\u53d8\u4e3aWeb\u670d\u52a1\u5668\u3002\u90a3\u91cc\u662f\u975e\u5e38\u597d\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Apache\u6216Nginx\uff0c\u4ee5\u53caHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u5b83\u4eec\u524d\u9762\uff0c\u4ee5\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027\u3002 \u57fa\u4e8e\u6570\u636e\u5305\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u4e0d\u4f1a\u770b\u5230IP\u6570\u636e\u5305\uff0c\u4e5f\u4e0d\u4f1a\u770b\u5230UDP\u6570\u636e\u62a5\uff0c\u4e0d\u4f1a\u6267\u884cNAT\u751a\u81f3\u66f4\u5c11\u7684DSR\u3002\u8fd9\u4e9b\u662f\u8f83\u4f4e\u5c42\u7684\u4efb\u52a1\u3002\u4e00\u4e9b\u57fa\u4e8e\u5185\u6838\u7684\u7ec4\u4ef6\uff0c\u5982IPVS\uff08Linux\u865a\u62df\u670d\u52a1\u5668\uff09\u5df2\u7ecf\u505a\u5230\u4e86\u975e\u5e38\u597d\uff0c\u4e0eHAProxy\u5b8c\u7f8e\u642d\u914d HAProxy\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\uff0c\u4e8b\u4ef6\u9a71\u52a8\uff0c\u975e\u963b\u585e\u5f15\u64ce\u3002\u53ef\u4ee5\u4f7fHAProxy\u5728\u591a\u4e2a\u8fdb\u7a0b\u4e0a\u8fd0\u884c\uff0c\u4f46\u5b83\u968f\u4e4b\u800c\u6765 \u4e00\u4e9b\u9650\u5236\u3002\u901a\u5e38\uff0c\u5b83\u5728HTTP\u5173\u95ed\u6216TCP\u6a21\u5f0f\u4e0b\u6ca1\u6709\u610f\u4e49\uff0c\u56e0\u4e3a\u5185\u6838\u7aef\u4e0d\u80fd\u5f88\u597d\u5730\u6269\u5c55\u67d0\u4e9b\u64cd\u4f5c\uff0c\u4f8b\u5982connect()\uff0c\u5b83\u53ef\u4ee5\u5f88\u597d\u5730\u6269\u5c55HTTP\u4fdd\u6301\u6d3b\u52a8\u6a21\u5f0f\u4f46\u6027\u80fd\u53ef\u4ee5\u901a\u8fc7\u5355\u4e00\u6d41\u7a0b\u5b9e\u73b0\u7684\u5de5\u4f5c\u901a\u5e38\u4f18\u4e8e\u5e38\u89c1\u9700\u6c42\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\u4f46\u662f\uff0c\u5f53\u7528\u4f5cSSL\u65f6\uff0c\u5b83\u786e\u5b9e\u6709\u610f\u4e49offloader\uff0c\u5728\u591a\u8fdb\u7a0b\u6a21\u5f0f\u4e0b\u5f88\u597d\u5730\u652f\u6301\u6b64\u529f\u80fd\u3002 \u57fa\u672c\u529f\u80fd\uff1a\u4ee3\u7406 \u00b6 \u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5e72\u51c0\u7684\u8fde\u63a5\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u8fde\u63a5\u7f3a\u9677\u548c\u653b\u51fb \u76d1\u542c\u591a\u4e2aIP\u5730\u5740\u6216\u7aef\u53e3\uff0c\u751a\u81f3\u7aef\u53e3\u8303\u56f4 Transparent accept\uff1a\u62e6\u622a\u4efb\u610fIP\u5730\u5740\u6d41\u91cf\uff0c\u5c3d\u7ba1\u4e0d\u5c5e\u4e8e\u672c\u5730\u7cfb\u7edf \u670d\u52a1\u5668\u7aef\u53e3\u4e0d\u9700\u8981\u548c\u4fa6\u542c\u7aef\u53e3\u76f8\u5173\uff0c\u751a\u81f3\u662f\u7531\u56fa\u5b9a\u504f\u79fb\u91cf\u8f6c\u6362(\u5bf9\u8303\u56f4\u6709\u7528) \u4e3a\u591a\u7ad9\u70b9LB\u4e2d\u7684\u670d\u52a1\u5668\u63d0\u4f9b\u53ef\u9760\u7684\u8fd4\u56deIP\u5730\u5740 \u7531\u4e8e\u7f13\u51b2\u533a\u548c\u53ef\u80fd\u7684\u77ed\u6682\u8fde\u63a5\uff0c\u4e0b\u7ebf\u670d\u52a1\u5668\u6765\u51cf\u5c11\u5e76\u53d1\u8fde\u63a5\u6570\u548c\u5185\u5b58\u5360\u7528\u91cf \u4f18\u5316TCP\u5806\u6808(\u5982:SACK)\u62e5\u585e\u63a7\u5236\u548c\u51cf\u5c11RTT\u5f71\u54cd \u652f\u6301\u53cc\u65b9\u4e0d\u540c\u7684\u534f\u8bae\u7cfb\u5217(IPv4,IPv6,Unix) \u5f3a\u5236\u8d85\u65f6\uff1a\u5728\u8fde\u63a5\u7684\u4e0d\u540c\u9636\u6bb5\u652f\u6301\u591a\u7ea7\u522b\u7684\u8d85\u65f6\u8fde\u63a5\uff0c\u4ee5\u4fbf\u4e8e\u5df2\u6b7b\u4ea1\u7684\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u6216\u653b\u51fb\u8005\u5360\u7528\u8d44\u6e90\u65f6\u95f4\u592a\u957f \u534f\u8bae\u9a8c\u8bc1\uff1a\u68c0\u67e5HTTP\u3001SSL\u3001Playload\u5e76\u62d2\u7edd\u65e0\u6548\u534f\u8bae\u6210\u5206\uff0c\u9664\u975e\u6307\u5b9aaccept\u4ed6\u4eec \u5f3a\u5236\u7b56\u7565\uff1a\u786e\u4fdd\u53ea\u8f6c\u53d1\u5141\u8bb8\u7684\u5185\u5bb9 \u4f20\u5165\u548c\u4f20\u51fa\u8fde\u63a5\u90fd\u53ef\u80fd\u9650\u4e8e\u67d0\u4e9b\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\uff08\u4ec5\u9650Linux\uff09\uff0c\u53ef\u4ee5\u8f7b\u677e\u6784\u5efa\u8de8\u5bb9\u5668\uff0c\u591a\u79df\u6237\u8d1f\u8f7d\u5747\u8861\u5668; Proxy\u534f\u8bae\u5c06\u5ba2\u6237\u7aefIP\u5730\u5740\u5448\u73b0\u7ed9\u670d\u52a1\u5668\u5c3d\u7ba1\u975eHTTP\u6d41\u91cf\uff0c\u8fd9\u662fhaproxy\u6269\u5c55\uff0c\u76ee\u524d\u7b2c\u4e09\u65b9\u4ea7\u54c1\u6709\uff1a client : haproxy, hitch, stunnel, exaproxy, ELB, squid server : haproxy, hitch, postfix, exim, nginx, squid, node.js, varnish \u57fa\u672c\u529f\u80fd\uff1aSSL \u00b6 \u57fa\u4e8eSNI\u7684\u4e13\u6ce8\u4e8e\u6027\u80fd\u6ca1\u6709\u7ad9\u70b9\u9650\u5236\u7684\u591a\u4e3b\u673a \u652f\u6301\u7528\u6b63\u5219\u901a\u914d\u7b26\u5339\u914d\u8bc1\u4e66 \u5177\u6709\u53ef\u914d\u7f6e\u7b56\u7565\u7684\u57fa\u4e8e\u8bc1\u4e66\u7684\u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1\u672a\u80fd\u51fa\u793a\u6709\u6548\u8bc1\u4e66\uff0c\u5c06\u5141\u8bb8\u4e0d\u540c\u7684\u670d\u52a1\u5668\u91cd\u65b0\u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66 \u540e\u7aef\u670d\u52a1\u5668\u8eab\u4efd\u9a8c\u8bc1\u786e\u4fdd\u540e\u7aef\u670d\u52a1\u5668\u4e0d\u662f\u4e2d\u95f4\u4eba \u4f7f\u7528\u540e\u7aef\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u8ba9\u540e\u7aef\u670d\u52a1\u5668\u77e5\u9053\u5b83\u8fde\u63a5\u7684\u662f\u9884\u671f\u7684haproxy\u8282\u70b9 TLS NPN\u548cALPN\u6269\u5c55\u53ef\u4ee5\u53ef\u9760\u7684\u5378\u8f7dSPDY/HTTP2\u8fde\u63a5\u5e76\u4ee5\u660e\u6587\u5f62\u5f0f\u4f20\u9012\u7ed9\u540e\u7aef\u670d\u52a1\u5668 \u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u4ee5\u8bc1\u4e66\u9a8c\u8bc1\u7684\u8bf7\u6c42\u65f6\uff0cOCSP\u88c5\u8ba2\u901a\u8fc7\u5185\u8054\u6765\u8fdb\u4e00\u6b65\u51cf\u5c11\u9996\u9875\u52a0\u8f7d\u65f6\u95f4 \u52a8\u6001\u8bb0\u5f55\u5927\u5c0f\u8c03\u6574\u63d0\u4f9b\u9ad8\u6027\u80fd\u4f4e\u5ef6\u8fdf\u53ca\u901a\u8fc7\u8ba9\u6d4f\u89c8\u5668\u83b7\u53d6\u65b0object\u6765\u663e\u8457\u51cf\u5c11\u9875\u9762\u52a0\u8f7d \u6c38\u4e45\u8bbf\u95ee\u6240\u6709\u76f8\u5173\u7684SSL/TLS\u5c42\u4fe1\u606f\u4ee5\u8fdb\u884c\u65e5\u5fd7\u8bb0\u5f55\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u62a5\u544a\u7b49\u3002\u8fd9\u4e9b\u5143\u7d20\u53ef\u4ee5\u5d4c\u5165\u5230HTTP Header\u751a\u81f3\u4f5c\u4e3aProxy\u534f\u8bae\u6269\u5c55 \u5373\u4f7f\u5728\u6613\u53d7\u653b\u51fb\u7684SSL\u5e93\u4e2d\u4e5f\u80fd\u68c0\u6d4b\uff0c\u8bb0\u5f55\u548c\u963b\u6b62\u67d0\u4e9b\u5df2\u77e5\u653b\u51fb\uff0c\u4f8b\u5982\u5f71\u54cdOpenSSL\u67d0\u4e9b\u7248\u672c\u7684Heartbleed\u653b\u51fb \u652f\u6301\u65e0\u72b6\u6001\u4f1a\u8bdd\u6062\u590d\uff0c\u53ef\u4ee5\u4eceCLI\u66f4\u65b0TLS\u51ed\u8bc1 \u57fa\u672c\u529f\u80fd\uff1a\u76d1\u63a7 \u00b6 \u5229\u7528per-server\u53c2\u6570\u6301\u7eed\u76d1\u63a7\u670d\u52a1\u5668\u72b6\u6001\uff0c\u8fd9\u4e2a\u786e\u4fdd\u670d\u52a1\u5668\u7684\u8def\u5f84\u662f\u6b63\u5e38\u6d41\u91cf \u72b6\u6001\u68c0\u67e5\u652f\u6301up\u6216down\u6ede\u540e\u6309\u987a\u5e8f\u5207\u6362\uff0c\u9632\u6b62\u72b6\u6001\u9519\u4e71 \u53ef\u4ee5\u5c06\u68c0\u67e5\u53d1\u9001\u5230\u4e0d\u540c\u7684\u5730\u5740/\u7aef\u53e3/\u534f\u8bae:\u8fd9\u6837\u5f88\u5bb9\u6613\u88ab\u8ba4\u4e3a\u4ee3\u8868\u591a\u4e2a\u7684\u5355\u4e2a\u670d\u52a1\uff0c\u5982\uff1aHTTP+HTTPS\u670d\u52a1\u5668\u7684HTTPS\u7aef\u53e3 \u670d\u52a1\u5668\u53ef\u4ee5\u8ddf\u8e2a\u5176\u4ed6\u670d\u52a1\u5668\u5e76\u540c\u65f6\u5173\u95ed\uff0c\u53ef\u4ee5\u786e\u4fdd\u6258\u7ba1\u591a\u4e2a\u670d\u52a1\u7684\u670d\u52a1\u5668\u4ee5\u539f\u5b50\u65b9\u5f0f\u5931\u8d25\u800c\u6ca1\u6709\u4e00\u4e2a\u4f1a\u53d1\u9001\u5230\u5931\u8d25\u7684\u670d\u52a1\u5668 \u53ef\u4ee5\u5728\u670d\u52a1\u5668\u90e8\u7f72\u4ee3\u7406\u6765\u76d1\u63a7\u8d1f\u8f7d\u548c\u8fd0\u884c\u72b6\u6001 \u63d0\u4f9b\u5404\u79cd\u68c0\u67e5\u65b9\u6cd5\uff1aTCP\u8fde\u63a5\u3001HTTP\u8bf7\u6c42\u3001SMTP\u95ee\u5019\u3001SSL hello\uff0cLDAP\u3001SQL\u3001Redis\u3001send/expect\u811a\u672c\uff0c\u5168\u90e8\u5e26\u6216\u4e0d\u5e26ssl\u8fde\u63a5 \u72b6\u6001\u66f4\u6539\u5c06\u5728\u65e5\u5fd7\u548c\u7edf\u8ba1\u4fe1\u606f\u9875\u9762\u901a\u77e5\u5931\u8d25\u539f\u56e0\uff0c\u4e5f\u53ef\u53d1\u9001\u5230\u914d\u7f6e\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740 \u670d\u52a1\u5668\u72b6\u6001\u4e5f\u4f1a\u5728\u7edf\u8ba1\u4fe1\u606f\u754c\u9762\u663e\u793a\uff0c\u5e76\u53ef\u7528\u4e8e\u6267\u884c\u8def\u7531\u51b3\u7b56\uff0c\u4ee5\u4fbf\u4e8e\u5c06\u6d41\u91cf\u53d1\u9001\u5230\u4e0d\u540c\u7684farms haproxy\u53ef\u4ee5\u4f7f\u7528\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u8bf7\u6c42\u5c06\u4fe1\u606f\u4f20\u9012\u7ed9\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u670d\u52a1\u5668name\u3001weight\u3001\u5176\u4ed6\u670d\u52a1\u5668\u5728farm\u7684number(\u6570\u91cf)\u7b49\u3002\u6240\u4ee5\u670d\u52a1\u5668\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u6765\u8c03\u6574\u54cd\u5e94\u548c\u51b3\u7b56(\u4f8b\u5982\u63a8\u8fdf\u5907\u4efd\u4fdd\u6301\u66f4\u591a\u7684\u53ef\u7528CPU) \u670d\u52a1\u5668\u53ef\u4ee5\u7528\u5065\u5eb7\u68c0\u67e5\u62a5\u544a\u66f4\u8be6\u7ec6\u7684\u72b6\u6001\uff0c\u4e0d\u4ec5\u4ec5\u662fon\u6216off \u670d\u52a1\u5668\u81ea\u8eab\u53ef\u4ee5\u62a5\u544a\u72b6\u6001\u7ed9\u5176\u4ed6\u7ec4\u4ef6\uff0c\u5982\u8def\u7531\u5668\u6216\u5176\u4ed6\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5141\u8bb8\u6784\u5efa\u975e\u5e38\u5b8c\u6574\u7684\u591a\u8def\u5f84\u548c\u591a\u5c42\u57fa\u7840\u8bbe\u65bd \u57fa\u672c\u529f\u80fd\uff1a\u9ad8\u53ef\u7528 \u00b6 \u4ec5\u4f7f\u7528\u6709\u6548\u7684\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u81ea\u52a8\u9a71\u9010\u51fa\u8d1f\u8f7d\u5747\u8861\u519c\u573a \u652f\u6301\u6b63\u5e38\u5173\u95ed\uff0c\u4ee5\u4fbf\u4e8e\u4e0d\u5f71\u54cd\u6709\u4efb\u4f55\u5173\u7cfb\u7684\u519c\u573a \u5f53\u6d3b\u52a8\u670d\u52a1\u5668\u5173\u95ed\u65f6\uff0c\u5c06\u81ea\u52a8\u4f7f\u7528\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4fbf\u4e8e\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u4e0d\u4e22\u5931\u4f1a\u8bdd\uff0c\u8fd9\u4e5f\u5141\u8bb8\u6784\u5efa\u591a\u6761\u8def\u5f84\u5230\u8fbe\u540c\u4e00\u4e2a\u670d\u52a1\u5668(\u4f8b\u5982\u591a\u4e2a\u63a5\u53e3) \u5f53\u4e00\u4e2a\u519c\u573a\u670d\u52a1\u5668\u592a\u591a\u65f6\uff0c\u80fd\u8fd4\u56de\u670d\u52a1\u5668\u5931\u8d25\u72b6\u6001\uff0c\u8fd9\u548c\u76d1\u63a7\u529f\u80fd\u7ed3\u5408\u4f7f\u7528\uff0c\u8ba9\u5176\u4e3a\u4e0a\u6e38\u7ec4\u4ef6\u9009\u62e9\u7ed9\u5b9a\u670d\u52a1\u7684\u4e0d\u540cLB\u8282\u70b9 \u65e0\u72b6\u6001\u8bbe\u8ba1\u4f7f\u6784\u5efa\u96c6\u7fa4\u53d8\u5f97\u5bb9\u6613\uff0chaproxy\u53ef\u4ee5\u6700\u597d\u7684\u786e\u4fdd\u670d\u52a1\u8fde\u7eed\u6027\u800c\u65e0\u9700\u5b58\u50a8\u5728\u53d1\u751f\u6545\u969c\u65f6\u53ef\u80fd\u4e22\u5931\u7684\u4fe1\u606f \u4e0e\u6807\u51c6\u7684VRRP\u5b88\u62a4\u8fdb\u7a0b\u826f\u597d\u7684\u96c6\u6210\uff0chaproxy\u53ef\u4ee5\u8f7b\u677e\u7684\u5bf9\u72b6\u6001\u8fde\u63a5\u4fdd\u6301\u5e76\u4e8e\u6d6e\u52a8\u865a\u62dfIP\u5f88\u597d\u7684\u5bf9\u5e94 \u57fa\u672c\u529f\u80fd\uff1a\u8d1f\u8f7d\u5747\u8861 \u00b6 \u652f\u6301\u4e0d\u5c11\u4e8e9\u949f\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u5176\u4e2d\u4e00\u4e9b\u9002\u7528\u4e8e\u8f93\u5165\u6570\u636e\u4ee5\u63d0\u4f9b\u65e0\u9650\u7684\u53ef\u80fd\u6027\u5217\u8868\u3002\u6700\u666e\u904d\u7684\u662f round-robin (\u5bf9\u4e8e\u77ed\u8fde\u63a5\uff0c\u4f9d\u6b21\u9009\u62e9\u6bcf\u4e2a\u670d\u52a1\u5668) leastconn (\u5bf9\u4e8e\u957f\u8fde\u63a5\u9009\u62e9\u6700\u8fd1\u5f88\u5c11\u4f7f\u7528\u3001\u6700\u4f4e\u8fde\u63a5\u6570\u7684\u670d\u52a1\u5668) source (\u7528\u4e8eSSL farms\u6216\u7ec8\u7aef\u670d\u52a1\u5668farms)\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u6e90\u5730\u5740 URI (\u7528\u4e8eHTTP\u7f13\u5b58\uff0c\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8eHTTP\u3000URI) HDR (\u670d\u52a1\u5668\u4f9d\u8d56\u4e8e\u7279\u5b9a\u7684HTTP hearder\u5b57\u6bb5\u7684\u5185\u5bb9) \u4ee5\u4e0a\u7b97\u6cd5\u90fd\u652f\u6301per-server\u6743\u91cd\uff0c\u4ee5\u4fbf\u9002\u5e94\u519c\u573a\u4e2d\u4e0d\u540c\u670d\u52a1\u5668\uff0c\u6216\u8005\u4f5c\u7528\u4e8e\u6d41\u91cf\u6bd4\u8f83\u5c0f\u7684\u7279\u5b9a\u670d\u52a1\u5668(debug,\u5728\u4e0b\u4e00\u4e2a\u8f6f\u4ef6\u7248\u672c) \u52a8\u6001\u6743\u91cd\u652f\u6301round-robin leastconn \u4e00\u81f4\u6027hashing\uff0c\u8fd9\u5141\u8bb8\u4eceCLI\u52a8\u6001\u4fee\u6539\u670d\u52a1\u5668\u6743\u91cd\u751a\u81f3\u662f\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684\u4ee3\u7406 \u53ea\u8981\u652f\u6301\u52a8\u6001\u6743\u91cd\uff0c\u5c31\u652f\u6301\u6162\u542f\u52a8\uff0c\u8fd9\u5141\u8bb8\u670d\u52a1\u5668\u9010\u6b65\u83b7\u53d6\u6d41\u91cf\uff0c\u8fd9\u662f\u4e2a\u91cd\u8981\u7279\u5f81\uff0c\u5bf9\u4e8e\u9700\u8981\u5728\u8fd0\u884c\u65f6\u7f16\u8bd1\u7c7b\u7684\u8106\u5f31\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u4ee5\u53ca\u9700\u8981\u5728\u5b8c\u5168\u8fd0\u884c\u4e4b\u524d\u586b\u6ee1\u51b7\u7f13\u5b58 hashing(\u6563\u5217)\u53ef\u4ee5\u7528\u4e8e\u5404\u79cd\u5143\u7d20\uff0c\u5982\u5ba2\u6237\u7aef\u6e90\u5730\u5740\uff0cURL\u7ec4\u4ef6\uff0c\u67e5\u8be2\u5b57\u7b26\u4e32\u5143\u7d20\uff0cheader\u5b57\u7b26\u4e32\u503c\uff0cPOST\u53c2\u6570\uff0cRDP cookie \u4e00\u81f4\u6027\u6563\u5217\u53ef\u4ee5\u4fdd\u62a4\u670d\u52a1\u5668farm\u514d\u53d7\u5927\u91cf\u91cd\u65b0\u5206\u53d1\u7684\u5f71\u54cd\uff0c\u5728\u670d\u52a1\u5668farm\u949f\u6dfb\u52a0\u6216\u5220\u9664\u670d\u52a1\u5668\uff0c\u8fd9\u5728\u5927\u578b\u7f13\u5b58farm\u4e2d\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u5141\u8bb8\u6162\u542f\u52a8\u7528\u4e8e\u8865\u5145cold caches \u8bb8\u591a\u5185\u90e8\u6307\u6807\uff0c\u5982\u6bcf\u53f0\u670d\u52a1\u5668\u8fde\u63a5\u6570\u3001\u6bcf\u4e2a\u540e\u7aef\u53ef\u7528\u8fde\u63a5\u63d2\u69fd\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u6784\u5efa\u975e\u5e38\u5148\u8fdb\u7684\u8d1f\u8f7d\u5e73\u8861\u7b56\u7565 \u57fa\u672c\u7279\u5f81\uff1a\u7c98\u6027(Stickiness) \u00b6 haproxy\u63d0\u4f9b\u76f8\u5f53\u5168\u9762\u7684\u53ef\u80fd\u6027\u4fdd\u6301\u8bbf\u5ba2\u8bbf\u95ee\u76f8\u540c\u670d\u52a1\u5668\u751a\u81f3\u8de8\u8d8a\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u670d\u52a1\u5668\u6dfb\u52a0/\u5220\u9664\uff0cdown/up\u5faa\u73af\uff0c\u5e76\u8bbe\u8ba1\u65b9\u6cd5\u62b5\u6297\u4e4b\u95f4\u7684\u8ddd\u79bb\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u8282\u70b9\uff0c\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u590d\u5236 \u7c98\u6027\u4fe1\u606f\u53ef\u4ee5\u5355\u72ec\u5339\u914d\u548c\u5b66\u4e60\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u5982\uff1a\u53ef\u4ee5\u5339\u914dJSESSIONID cookie \u5728cookie\u548cURL\u90fd\u6709\uff0c\u6700\u591a\u540c\u4e00\u65f6\u95f4\u53ef\u5b66\u4e608\u4e2a\u5e76\u884c\u6e90\uff0c\u6bcf\u4e2a\u53ef\u80fd\u6307\u5411\u4e0d\u540c\u7684stick-table \u4ee5\u591a\u4e3b\u65b9\u5f0f\u5728\u6240\u6709\u8282\u70b9\u590d\u5236stick-tables \u5e38\u7528\u7684\u5143\u7d20\uff0c\u5982SSL-ID\u6216RDP cookie(\u7528\u4e8eTSE farm)\u76f4\u63a5\u6613\u4e8e\u64cd\u4f5c \u6240\u6709sticking rules\u53ef\u7531ACL\u52a8\u6001\u8c03\u8282 \u53ef\u4ee5\u51b3\u5b9a\u4e0dstick\u67d0\u4e9b\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4ee5\u4fbf\u4e8e\u5f53\u89c4\u5b9a\u7684\u670d\u52a1\u5668\u8fd4\u56de\u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u8fdb\u884cload back\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u8def\u5f84\u73af\u5883 \u5728 Configuration \u00b6 \u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6240\u6709\u914d\u7f6e\u5173\u952e\u5b57\u548c\u4ed6\u4eec\u7684\u9009\u62e9\u3002\u5b83\u5728\u9700\u8981\u66f4\u6539\u914d\u7f6e\u65f6\u4f7f\u7528 \u5173\u4e8eHTTP\u7684\u5feb\u901f\u63d0\u9192 \u00b6 \u5f53HAproxy\u5728HTTP\u6a21\u5f0f\u4e0b\u8fd0\u884c\u65f6\uff0c\u8bf7\u6c42\u548c\u76f8\u5e94\u90fd\u662f\u5b8c\u5168\u5206\u6790\u548c\u7d22\u5f15\uff0c\u56e0\u6b64\u51e0\u4e4e\u5728contents\u7684\u4efb\u4f55\u5185\u5bb9\u90fd\u53ef\u4ee5\u5efa\u7acb\u5339\u914d\u3002\u4e86\u89e3http\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u5f62\u6210\u7684\u65b9\u5f0f\u975e\u5e38\u91cd\u8981\uff0c\u53cahaproxy\u5982\u4f55\u5206\u89e3\u5b83\u4eec\uff0c\u7136\u540e\u5c31\u4f1a\u53d8\u5f97\u66f4\u5bb9\u6613\u7f16\u5199\u6b63\u786e\u7684\u89c4\u5219\u548c\u8c03\u8bd5\u73b0\u6709\u914d\u7f6e http\u4e8b\u52a1\u6a21\u578b\uff1ahttp\u534f\u8bae\u662f\u4e8b\u52a1\u9a71\u52a8\u7684\uff0c\u610f\u5473\u7740\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u9886\u5148\u4e00\u4e2a\u56de\u5e94 HAProxy\u652f\u63015\u79cd\u8fde\u63a5\u6a21\u5f0f\uff1a \u4fdd\u6301\u6d3b\u8dc3\uff1a\u5904\u7406\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\uff08\u9ed8\u8ba4\uff09 \u96a7\u9053\uff1a\u53ea\u5904\u7406\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u5176\u4ed6\u4e00\u5207\u90fd\u6ca1\u6709\u5206\u6790\u8f6c\u53d1 \u88ab\u52a8\u5173\u95ed\uff1a\u5728\u4e24\u4e2a\u65b9\u5411\u4e0a\u6dfb\u52a0\u201c\u8fde\u63a5\uff1a\u5173\u95ed\u201d\u7684\u96a7\u9053 \u670d\u52a1\u5668\u5173\u95ed\uff1a\u54cd\u5e94\u540e\u5173\u95ed\u9762\u5411\u670d\u52a1\u5668\u7684\u8fde\u63a5 \u5f3a\u5236\u5173\u95ed\uff1a\u54cd\u5e94\u7ed3\u675f\u540e\uff0c\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5 \u5bf9\u4e8eHTTP/2\uff0c\u8fde\u63a5\u6a21\u5f0f\u7c7b\u4f3c\u4e8e\u201c\u670d\u52a1\u5668\u5173\u95ed\u201d\u6a21\u5f0f\uff1a\u7ed9\u5b9a\u6240\u6709\u6d41\u7684\u72ec\u7acb\u6027\uff0c\u76ee\u524d\u6ca1\u6709\u5730\u65b9\u53ef\u4ee5\u6302\u7a7a\u95f2\u54cd\u5e94\u540e\u7684\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u56e0\u6b64\u5728\u54cd\u5e94\u540e\u5173\u95ed\u3002HTTP/2\u4ec5\u652f\u6301\u4f20\u5165\u8fde\u63a5\uff0c\u800c\u4e0d\u652f\u6301\u8fde\u63a5\u670d\u52a1\u5668 HAProxy\u7684\u914d\u7f6e\u8fc7\u7a0b\u6d89\u53ca3\u4e2a\u4e3b\u8981\u53c2\u6570\u6765\u6e90 1 . \u6765\u81ea\u547d\u4ee4\u884c\u7684\u53c2\u6570\uff0c\u5b83\u59cb\u7ec8\u4f18\u5148 2 . \u201c\u5168\u5c40\u201d\u90e8\u5206\uff0c\u7528\u4e8e\u8bbe\u7f6e\u6d41\u7a0b\u8303\u56f4\u7684\u53c2\u6570 3 . \u4ee3\u7406\u90e8\u5206\u53ef\u4ee5\u91c7\u53d6\u201c\u9ed8\u8ba4\u201d\uff0c\u201c\u542c\u201d\u7684\u5f62\u5f0f\uff0c\u201c\u524d\u7aef\u201d\u548c\u201c\u540e\u7aef\u201d \u914d\u7f6e\u6587\u4ef6\u652f\u6301 3 \u949f\u7c7b\u578b\uff1a\u8f6c\u4e49\u53cd\u659c\u6760\u3001\u53cc\u5f15\u53f7\u5f31\u5f15\u7528\u3001\u5355\u5f15\u53f7\u5f3a\u5f15\u7528 \u5982\u679c\u5fc5\u987b\u5728\u5b57\u7b26\u4e32\u8f93\u5165\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u901a\u8fc7\u53cd\u659c\u6760\u8fdb\u884c\u8f6c\u4e49 \\\u6807\u8bb0\u7a7a\u683c\u5e76\u5c06\u5176\u4e0e\u5206\u9694\u7b26\u533a\u5206\u5f00\u6765 \\\uff03\u6807\u8bb0\u54c8\u5e0c\u5e76\u5c06\u5176\u4e0e\u6ce8\u91ca\u533a\u5206\u5f00\u6765 \\\\\u4f7f\u7528\u53cd\u659c\u6760 '' \u4f7f\u7528\u5355\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f3a\u5f15\u7528\u533a\u5206\u5f00\u6765 \"\" \u4f7f\u7528\u53cc\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f31\u5f15\u7528\u533a\u5206\u5f00\u6765 Management \u00b6 \u5982\u4f55\u542f\u52a8haproxy\uff0c\u5982\u4f55\u8fd0\u884c\u65f6\u7ba1\u7406\u5b83\uff0c\u5982\u4f55\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u7ba1\u7406\u5b83\uff0c\u4ee5\u53ca\u5982\u4f55\u65e0\u7f1d\u5347\u7ea7 Architecture \u00b6 \u5982\u4f55\u6784\u5efa\u4e00\u4e2a\u6700\u597d\u7684\u8d1f\u8f7d\u5747\u8861\u57fa\u7840\u67b6\u6784\u4ee5\u53ca\u5982\u4f55\u4e0e\u7b2c\u4e09\u65b9\u4ea7\u54c1\u8fdb\u884c\u96c6\u6210","title":"HAProxy"},{"location":"Haproxy/#haproxy","text":"","title":"Haproxy"},{"location":"Haproxy/#intro","text":"\u4ecb\u7ecd\u8d1f\u8f7d\u5e73\u8861\u7684\u57fa\u7840\u77e5\u8bc6\uff0cHAProxy\u4f5c\u4e3a\u4e00\u79cd\u4ea7\u54c1\uff0c\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e0d\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e00\u4e9b\u5df2\u77e5\u7684\u9677\u9631\u907f\u514d\uff0c\u4e00\u4e9b\u7279\u5b9a\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\uff0c\u83b7\u53d6\u3001\u53d1\u5c55\u53ca\u66f4\u65b0\u5b83\uff0c\u5982\u4f55\u786e\u4fdd\u60a8\u8fd0\u884c\u6240\u6709\u5df2\u77e5\u7684\u4fee\u8865\u7a0b\u5e8f\uff0c\u5173\u4e8e\u5b83\u7684\u8865\u5145\u548c\u66ff\u4ee3\u54c1 HAProxy\u662f\uff1a TCP\u4ee3\u7406\uff1a\u5b83\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u4fa6\u542c\u5957\u63a5\u5b57\u7684TCP\u8fde\u63a5\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5e76\u5c06\u8fd9\u4e9b\u63d2\u5ea7\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5141\u8bb8\u6d41\u91cf\u4e24\u4e2a\u65b9\u5411\u6d41\u52a8; HTTP\u53cd\u5411\u4ee3\u7406\uff08\u5728HTTP\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u7f51\u5173\u201d\uff09\uff1a\u5b83\u672c\u8eab\u4f5c\u4e3a\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u63a5\u53d7\u7684\u8fde\u63a5\u63a5\u6536HTTP\u8bf7\u6c42\u4fa6\u542cTCP\u5957\u63a5\u5b57\uff0c\u5e76\u5c06\u6765\u81ea\u8fd9\u4e9b\u8fde\u63a5\u7684\u8bf7\u6c42\u4f20\u9012\u7ed9\u4f7f\u7528\u4e0d\u540c\u8fde\u63a5\u7684\u670d\u52a1\u5668 SSL\u7ec8\u7ed3\u5668/\u542f\u52a8\u5668/\u5378\u8f7d\u5668\uff1a\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u53ef\u4ee5\u4f7f\u7528SSL/TLS\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u751a\u81f3\u53cc\u5411\u8fde\u63a5 TCP\u89c4\u8303\u5316\u5668\uff1a\u7531\u4e8e\u64cd\u4f5c\u5728\u672c\u5730\u7ec8\u6b62\u8fde\u63a5\u7cfb\u7edf\uff0c\u53cc\u65b9\u6ca1\u6709\u5173\u7cfb\uff0c\u6240\u4ee5\u4ea4\u901a\u4e0d\u6b63\u5e38\u7b49\u65e0\u6548\u6570\u636e\u5305\uff0c\u6807\u5fd7\u7ec4\u5408\uff0c\u7a97\u53e3\u5e7f\u544a\uff0c\u5e8f\u5217\u53f7\uff0c\u4e0d\u5b8c\u6574\u7684\u8fde\u63a5\uff08SYN floods\uff09\uff0c\u6216\u8005\u4e0d\u4f1a\u4f20\u9012\u7ed9\u53e6\u4e00\u4e2a\u4fa7\u3002\u8fd9\u53ef\u4ee5\u4fdd\u62a4\u8106\u5f31\u7684TCP\u5806\u6808\u514d\u53d7\u534f\u8bae\u653b\u51fb\u5141\u8bb8\u4e0e\u5ba2\u6237\u7aef\u4f18\u5316\u8fde\u63a5\u53c2\u6570\u800c\u65e0\u9700\u4fee\u6539\u670d\u52a1\u5668\u7684TCP\u5806\u6808\u8bbe\u7f6e\u3002 HTTP\u89c4\u8303\u5316\u7a0b\u5e8f\uff1a\u914d\u7f6e\u4e3a\u5904\u7406HTTP\u6d41\u91cf\u65f6\uff0c\u4ec5\u6709\u6548\u5b8c\u6210\u8bf7\u6c42\u5df2\u901a\u8fc7\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u8bb8\u591a\u57fa\u4e8e\u534f\u8bae\u7684\u653b\u51fb\u3002\u53e6\u5916\uff0c\u5b58\u5728\u5bb9\u5dee\u7684\u534f\u8bae\u504f\u5dee\u5728\u89c4\u8303\u4e2d\u662f\u56fa\u5b9a\u7684\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u4e0d\u4f1a\u5f15\u8d77\u95ee\u9898\u670d\u52a1\u5668\uff08\u4f8b\u5982\u591a\u884c\u6807\u9898\uff09\u3002 HTTP\u4fee\u590d\u5de5\u5177\uff1a\u5b83\u53ef\u4ee5\u4fee\u6539/\u4fee\u590d/\u6dfb\u52a0/\u5220\u9664/\u91cd\u5199URL\u6216\u4efb\u4f55\u8bf7\u6c42\u6216\u54cd\u5e94\u6807\u5934\u3002\u8fd9\u6709\u52a9\u4e8e\u89e3\u51b3\u4e92\u64cd\u4f5c\u6027\u95ee\u9898\u5728\u590d\u6742\u7684\u73af\u5883\u4e2d\u3002 \u57fa\u4e8e\u5185\u5bb9\u7684\u4ea4\u6362\u673a\uff1a\u5b83\u53ef\u4ee5\u8003\u8651\u8bf7\u6c42\u4e2d\u7684\u4efb\u4f55\u5143\u7d20\u51b3\u5b9a\u5c06\u8bf7\u6c42\u6216\u8fde\u63a5\u4f20\u9012\u7ed9\u54ea\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\u6709\u53ef\u80fd\u901a\u8fc7\u540c\u4e00\u7aef\u53e3\u5904\u7406\u591a\u4e2a\u534f\u8bae\uff08\u4f8b\u5982HTTP\uff0cHTTPS\uff0cSSH\uff09\u3002 \u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u53ef\u4ee5\u5e73\u8861TCP\u8fde\u63a5\u548cHTTP\u8981\u6c42\u3002\u5728TCP\u6a21\u5f0f\u4e0b\uff0c\u6574\u4f53\u91c7\u7528\u8d1f\u8f7d\u5e73\u8861\u51b3\u7b56\u8fde\u63a5\u3002\u5728HTTP\u6a21\u5f0f\u4e0b\uff0c\u6839\u636e\u8bf7\u6c42\u505a\u51fa\u51b3\u5b9a\u3002 \u4ea4\u901a\u76d1\u7ba1\u673a\u6784\uff1a\u5b83\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u70b9\u5e94\u7528\u4e00\u4e9b\u901f\u7387\u9650\u5236\uff0c\u4fdd\u62a4\u670d\u52a1\u5668\u514d\u53d7\u8fc7\u8f7d\uff0c\u6839\u636e\u9700\u8981\u8c03\u6574\u6d41\u91cf\u4f18\u5148\u7ea7\u5185\u5bb9\uff0c\u751a\u81f3\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4f20\u9012\u7ed9\u4e0b\u5c42\u548c\u5916\u5c42\u7f51\u7edc\u7ec4\u4ef6\u901a\u8fc7\u6807\u8bb0\u6570\u636e\u5305\u3002 \u9488\u5bf9DDoS\u548c\u670d\u52a1\u6ee5\u7528\u7684\u4fdd\u62a4\uff1a\u5b83\u53ef\u4ee5\u4fdd\u6301\u5e7f\u6cdb\u7684\u6570\u91cf\u6bcf\u4e2aIP\u5730\u5740\uff0cURL\uff0ccookie\u7b49\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u5e76\u68c0\u6d4b\u4f55\u65f6\u6ee5\u7528\u53d1\u751f\uff0c\u7136\u540e\u91c7\u53d6\u884c\u52a8\uff08\u51cf\u6162\u8fdd\u6cd5\u8005\uff0c\u963b\u6b62\u4ed6\u4eec\uff0c\u53d1\u9001\u4ed6\u4eec\u8fc7\u65f6\u7684\u5185\u5bb9\u7b49\uff09\u3002 \u7f51\u7edc\u6545\u969c\u6392\u9664\u7684\u89c2\u5bdf\u70b9\uff1a\u7531\u4e8e\u7cbe\u5ea6\u5728\u65e5\u5fd7\u4e2d\u62a5\u544a\u7684\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u7f29\u5c0f\u4e00\u4e9b\u4e0e\u7f51\u7edc\u6709\u5173\u7684\u95ee\u9898\u3002 HTTP\u538b\u7f29\u5378\u8f7d\u7a0b\u5e8f\uff1a\u5b83\u53ef\u4ee5\u538b\u7f29\u4e0d\u662f\u7531\u670d\u52a1\u5668\u538b\u7f29\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u51cf\u5c11\u5ba2\u6237\u7aef\u7684\u9875\u9762\u52a0\u8f7d\u65f6\u95f4\u8fde\u63a5\u4e0d\u826f\u6216\u4f7f\u7528\u9ad8\u5ef6\u8fdf\u7684\u79fb\u52a8\u7f51\u7edc\u3002 HAProxy\u4e0d\u662f\uff1a \u4e00\u4e2a\u663e\u5f0f\u7684HTTP\u4ee3\u7406\uff0c\u5373\u6d4f\u89c8\u5668\u7528\u6765\u8bbf\u95ee\u7684\u4ee3\u7406\u4e92\u8054\u7f51\u3002\u6709\u4e13\u95e8\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u4f18\u79c0\u5f00\u6e90\u8f6f\u4ef6\uff0c\u6bd4\u5982Squid\u3002\u4f46\u662fHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u8fd9\u6837\u7684\u4ee3\u7406\u524d\u9762\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027\u3002 \u7f13\u5b58\u4ee3\u7406\uff1a\u5b83\u5c06\u6309\u539f\u6837\u8fd4\u56de\u4ece\u670d\u52a1\u5668\u6536\u5230\u7684\u5185\u5bb9\u5e76\u4e14\u4e0d\u4f1a\u5e72\u6270\u4efb\u4f55\u7f13\u5b58\u7b56\u7565\u3002\u6709\u4f18\u79c0\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Varnish\u3002\u53ef\u4ee5\u5b89\u88c5HAProxy\u5728\u8fd9\u6837\u7684\u7f13\u5b58\u524d\u9762\u63d0\u4f9bSSL\u5378\u8f7d\uff0c\u5e76\u901a\u8fc7\u53ef\u4f38\u7f29\u6027\u667a\u80fd\u8d1f\u8f7d\u5e73\u8861\u3002 \u6570\u636e\u6e05\u7406\u5668\uff1a\u5b83\u4e0d\u4f1a\u4fee\u6539\u8bf7\u6c42\u4f53\u548c\u54cd\u5e94\u4f53\u3002 \u4e00\u4e2aWeb\u670d\u52a1\u5668\uff1a\u5728\u542f\u52a8\u671f\u95f4\uff0c\u5b83\u5c06\u81ea\u5df1\u9694\u79bb\u5728\u4e00\u4e2achroot jail\u548c\u5220\u9664\u5176\u6743\u9650\uff0c\u4ee5\u4fbf\u5b83\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u5355\u4e2a\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\u4e00\u65e6\u5f00\u59cb\u3002\u56e0\u6b64\uff0c\u5b83\u65e0\u6cd5\u8f6c\u53d8\u4e3aWeb\u670d\u52a1\u5668\u3002\u90a3\u91cc\u662f\u975e\u5e38\u597d\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Apache\u6216Nginx\uff0c\u4ee5\u53caHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u5b83\u4eec\u524d\u9762\uff0c\u4ee5\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027\u3002 \u57fa\u4e8e\u6570\u636e\u5305\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u4e0d\u4f1a\u770b\u5230IP\u6570\u636e\u5305\uff0c\u4e5f\u4e0d\u4f1a\u770b\u5230UDP\u6570\u636e\u62a5\uff0c\u4e0d\u4f1a\u6267\u884cNAT\u751a\u81f3\u66f4\u5c11\u7684DSR\u3002\u8fd9\u4e9b\u662f\u8f83\u4f4e\u5c42\u7684\u4efb\u52a1\u3002\u4e00\u4e9b\u57fa\u4e8e\u5185\u6838\u7684\u7ec4\u4ef6\uff0c\u5982IPVS\uff08Linux\u865a\u62df\u670d\u52a1\u5668\uff09\u5df2\u7ecf\u505a\u5230\u4e86\u975e\u5e38\u597d\uff0c\u4e0eHAProxy\u5b8c\u7f8e\u642d\u914d HAProxy\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\uff0c\u4e8b\u4ef6\u9a71\u52a8\uff0c\u975e\u963b\u585e\u5f15\u64ce\u3002\u53ef\u4ee5\u4f7fHAProxy\u5728\u591a\u4e2a\u8fdb\u7a0b\u4e0a\u8fd0\u884c\uff0c\u4f46\u5b83\u968f\u4e4b\u800c\u6765 \u4e00\u4e9b\u9650\u5236\u3002\u901a\u5e38\uff0c\u5b83\u5728HTTP\u5173\u95ed\u6216TCP\u6a21\u5f0f\u4e0b\u6ca1\u6709\u610f\u4e49\uff0c\u56e0\u4e3a\u5185\u6838\u7aef\u4e0d\u80fd\u5f88\u597d\u5730\u6269\u5c55\u67d0\u4e9b\u64cd\u4f5c\uff0c\u4f8b\u5982connect()\uff0c\u5b83\u53ef\u4ee5\u5f88\u597d\u5730\u6269\u5c55HTTP\u4fdd\u6301\u6d3b\u52a8\u6a21\u5f0f\u4f46\u6027\u80fd\u53ef\u4ee5\u901a\u8fc7\u5355\u4e00\u6d41\u7a0b\u5b9e\u73b0\u7684\u5de5\u4f5c\u901a\u5e38\u4f18\u4e8e\u5e38\u89c1\u9700\u6c42\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\u4f46\u662f\uff0c\u5f53\u7528\u4f5cSSL\u65f6\uff0c\u5b83\u786e\u5b9e\u6709\u610f\u4e49offloader\uff0c\u5728\u591a\u8fdb\u7a0b\u6a21\u5f0f\u4e0b\u5f88\u597d\u5730\u652f\u6301\u6b64\u529f\u80fd\u3002","title":"Intro"},{"location":"Haproxy/#_1","text":"\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5e72\u51c0\u7684\u8fde\u63a5\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u8fde\u63a5\u7f3a\u9677\u548c\u653b\u51fb \u76d1\u542c\u591a\u4e2aIP\u5730\u5740\u6216\u7aef\u53e3\uff0c\u751a\u81f3\u7aef\u53e3\u8303\u56f4 Transparent accept\uff1a\u62e6\u622a\u4efb\u610fIP\u5730\u5740\u6d41\u91cf\uff0c\u5c3d\u7ba1\u4e0d\u5c5e\u4e8e\u672c\u5730\u7cfb\u7edf \u670d\u52a1\u5668\u7aef\u53e3\u4e0d\u9700\u8981\u548c\u4fa6\u542c\u7aef\u53e3\u76f8\u5173\uff0c\u751a\u81f3\u662f\u7531\u56fa\u5b9a\u504f\u79fb\u91cf\u8f6c\u6362(\u5bf9\u8303\u56f4\u6709\u7528) \u4e3a\u591a\u7ad9\u70b9LB\u4e2d\u7684\u670d\u52a1\u5668\u63d0\u4f9b\u53ef\u9760\u7684\u8fd4\u56deIP\u5730\u5740 \u7531\u4e8e\u7f13\u51b2\u533a\u548c\u53ef\u80fd\u7684\u77ed\u6682\u8fde\u63a5\uff0c\u4e0b\u7ebf\u670d\u52a1\u5668\u6765\u51cf\u5c11\u5e76\u53d1\u8fde\u63a5\u6570\u548c\u5185\u5b58\u5360\u7528\u91cf \u4f18\u5316TCP\u5806\u6808(\u5982:SACK)\u62e5\u585e\u63a7\u5236\u548c\u51cf\u5c11RTT\u5f71\u54cd \u652f\u6301\u53cc\u65b9\u4e0d\u540c\u7684\u534f\u8bae\u7cfb\u5217(IPv4,IPv6,Unix) \u5f3a\u5236\u8d85\u65f6\uff1a\u5728\u8fde\u63a5\u7684\u4e0d\u540c\u9636\u6bb5\u652f\u6301\u591a\u7ea7\u522b\u7684\u8d85\u65f6\u8fde\u63a5\uff0c\u4ee5\u4fbf\u4e8e\u5df2\u6b7b\u4ea1\u7684\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u6216\u653b\u51fb\u8005\u5360\u7528\u8d44\u6e90\u65f6\u95f4\u592a\u957f \u534f\u8bae\u9a8c\u8bc1\uff1a\u68c0\u67e5HTTP\u3001SSL\u3001Playload\u5e76\u62d2\u7edd\u65e0\u6548\u534f\u8bae\u6210\u5206\uff0c\u9664\u975e\u6307\u5b9aaccept\u4ed6\u4eec \u5f3a\u5236\u7b56\u7565\uff1a\u786e\u4fdd\u53ea\u8f6c\u53d1\u5141\u8bb8\u7684\u5185\u5bb9 \u4f20\u5165\u548c\u4f20\u51fa\u8fde\u63a5\u90fd\u53ef\u80fd\u9650\u4e8e\u67d0\u4e9b\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\uff08\u4ec5\u9650Linux\uff09\uff0c\u53ef\u4ee5\u8f7b\u677e\u6784\u5efa\u8de8\u5bb9\u5668\uff0c\u591a\u79df\u6237\u8d1f\u8f7d\u5747\u8861\u5668; Proxy\u534f\u8bae\u5c06\u5ba2\u6237\u7aefIP\u5730\u5740\u5448\u73b0\u7ed9\u670d\u52a1\u5668\u5c3d\u7ba1\u975eHTTP\u6d41\u91cf\uff0c\u8fd9\u662fhaproxy\u6269\u5c55\uff0c\u76ee\u524d\u7b2c\u4e09\u65b9\u4ea7\u54c1\u6709\uff1a client : haproxy, hitch, stunnel, exaproxy, ELB, squid server : haproxy, hitch, postfix, exim, nginx, squid, node.js, varnish","title":"\u57fa\u672c\u529f\u80fd\uff1a\u4ee3\u7406"},{"location":"Haproxy/#ssl","text":"\u57fa\u4e8eSNI\u7684\u4e13\u6ce8\u4e8e\u6027\u80fd\u6ca1\u6709\u7ad9\u70b9\u9650\u5236\u7684\u591a\u4e3b\u673a \u652f\u6301\u7528\u6b63\u5219\u901a\u914d\u7b26\u5339\u914d\u8bc1\u4e66 \u5177\u6709\u53ef\u914d\u7f6e\u7b56\u7565\u7684\u57fa\u4e8e\u8bc1\u4e66\u7684\u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1\u672a\u80fd\u51fa\u793a\u6709\u6548\u8bc1\u4e66\uff0c\u5c06\u5141\u8bb8\u4e0d\u540c\u7684\u670d\u52a1\u5668\u91cd\u65b0\u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66 \u540e\u7aef\u670d\u52a1\u5668\u8eab\u4efd\u9a8c\u8bc1\u786e\u4fdd\u540e\u7aef\u670d\u52a1\u5668\u4e0d\u662f\u4e2d\u95f4\u4eba \u4f7f\u7528\u540e\u7aef\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u8ba9\u540e\u7aef\u670d\u52a1\u5668\u77e5\u9053\u5b83\u8fde\u63a5\u7684\u662f\u9884\u671f\u7684haproxy\u8282\u70b9 TLS NPN\u548cALPN\u6269\u5c55\u53ef\u4ee5\u53ef\u9760\u7684\u5378\u8f7dSPDY/HTTP2\u8fde\u63a5\u5e76\u4ee5\u660e\u6587\u5f62\u5f0f\u4f20\u9012\u7ed9\u540e\u7aef\u670d\u52a1\u5668 \u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u4ee5\u8bc1\u4e66\u9a8c\u8bc1\u7684\u8bf7\u6c42\u65f6\uff0cOCSP\u88c5\u8ba2\u901a\u8fc7\u5185\u8054\u6765\u8fdb\u4e00\u6b65\u51cf\u5c11\u9996\u9875\u52a0\u8f7d\u65f6\u95f4 \u52a8\u6001\u8bb0\u5f55\u5927\u5c0f\u8c03\u6574\u63d0\u4f9b\u9ad8\u6027\u80fd\u4f4e\u5ef6\u8fdf\u53ca\u901a\u8fc7\u8ba9\u6d4f\u89c8\u5668\u83b7\u53d6\u65b0object\u6765\u663e\u8457\u51cf\u5c11\u9875\u9762\u52a0\u8f7d \u6c38\u4e45\u8bbf\u95ee\u6240\u6709\u76f8\u5173\u7684SSL/TLS\u5c42\u4fe1\u606f\u4ee5\u8fdb\u884c\u65e5\u5fd7\u8bb0\u5f55\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u62a5\u544a\u7b49\u3002\u8fd9\u4e9b\u5143\u7d20\u53ef\u4ee5\u5d4c\u5165\u5230HTTP Header\u751a\u81f3\u4f5c\u4e3aProxy\u534f\u8bae\u6269\u5c55 \u5373\u4f7f\u5728\u6613\u53d7\u653b\u51fb\u7684SSL\u5e93\u4e2d\u4e5f\u80fd\u68c0\u6d4b\uff0c\u8bb0\u5f55\u548c\u963b\u6b62\u67d0\u4e9b\u5df2\u77e5\u653b\u51fb\uff0c\u4f8b\u5982\u5f71\u54cdOpenSSL\u67d0\u4e9b\u7248\u672c\u7684Heartbleed\u653b\u51fb \u652f\u6301\u65e0\u72b6\u6001\u4f1a\u8bdd\u6062\u590d\uff0c\u53ef\u4ee5\u4eceCLI\u66f4\u65b0TLS\u51ed\u8bc1","title":"\u57fa\u672c\u529f\u80fd\uff1aSSL"},{"location":"Haproxy/#_2","text":"\u5229\u7528per-server\u53c2\u6570\u6301\u7eed\u76d1\u63a7\u670d\u52a1\u5668\u72b6\u6001\uff0c\u8fd9\u4e2a\u786e\u4fdd\u670d\u52a1\u5668\u7684\u8def\u5f84\u662f\u6b63\u5e38\u6d41\u91cf \u72b6\u6001\u68c0\u67e5\u652f\u6301up\u6216down\u6ede\u540e\u6309\u987a\u5e8f\u5207\u6362\uff0c\u9632\u6b62\u72b6\u6001\u9519\u4e71 \u53ef\u4ee5\u5c06\u68c0\u67e5\u53d1\u9001\u5230\u4e0d\u540c\u7684\u5730\u5740/\u7aef\u53e3/\u534f\u8bae:\u8fd9\u6837\u5f88\u5bb9\u6613\u88ab\u8ba4\u4e3a\u4ee3\u8868\u591a\u4e2a\u7684\u5355\u4e2a\u670d\u52a1\uff0c\u5982\uff1aHTTP+HTTPS\u670d\u52a1\u5668\u7684HTTPS\u7aef\u53e3 \u670d\u52a1\u5668\u53ef\u4ee5\u8ddf\u8e2a\u5176\u4ed6\u670d\u52a1\u5668\u5e76\u540c\u65f6\u5173\u95ed\uff0c\u53ef\u4ee5\u786e\u4fdd\u6258\u7ba1\u591a\u4e2a\u670d\u52a1\u7684\u670d\u52a1\u5668\u4ee5\u539f\u5b50\u65b9\u5f0f\u5931\u8d25\u800c\u6ca1\u6709\u4e00\u4e2a\u4f1a\u53d1\u9001\u5230\u5931\u8d25\u7684\u670d\u52a1\u5668 \u53ef\u4ee5\u5728\u670d\u52a1\u5668\u90e8\u7f72\u4ee3\u7406\u6765\u76d1\u63a7\u8d1f\u8f7d\u548c\u8fd0\u884c\u72b6\u6001 \u63d0\u4f9b\u5404\u79cd\u68c0\u67e5\u65b9\u6cd5\uff1aTCP\u8fde\u63a5\u3001HTTP\u8bf7\u6c42\u3001SMTP\u95ee\u5019\u3001SSL hello\uff0cLDAP\u3001SQL\u3001Redis\u3001send/expect\u811a\u672c\uff0c\u5168\u90e8\u5e26\u6216\u4e0d\u5e26ssl\u8fde\u63a5 \u72b6\u6001\u66f4\u6539\u5c06\u5728\u65e5\u5fd7\u548c\u7edf\u8ba1\u4fe1\u606f\u9875\u9762\u901a\u77e5\u5931\u8d25\u539f\u56e0\uff0c\u4e5f\u53ef\u53d1\u9001\u5230\u914d\u7f6e\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740 \u670d\u52a1\u5668\u72b6\u6001\u4e5f\u4f1a\u5728\u7edf\u8ba1\u4fe1\u606f\u754c\u9762\u663e\u793a\uff0c\u5e76\u53ef\u7528\u4e8e\u6267\u884c\u8def\u7531\u51b3\u7b56\uff0c\u4ee5\u4fbf\u4e8e\u5c06\u6d41\u91cf\u53d1\u9001\u5230\u4e0d\u540c\u7684farms haproxy\u53ef\u4ee5\u4f7f\u7528\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u8bf7\u6c42\u5c06\u4fe1\u606f\u4f20\u9012\u7ed9\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u670d\u52a1\u5668name\u3001weight\u3001\u5176\u4ed6\u670d\u52a1\u5668\u5728farm\u7684number(\u6570\u91cf)\u7b49\u3002\u6240\u4ee5\u670d\u52a1\u5668\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u6765\u8c03\u6574\u54cd\u5e94\u548c\u51b3\u7b56(\u4f8b\u5982\u63a8\u8fdf\u5907\u4efd\u4fdd\u6301\u66f4\u591a\u7684\u53ef\u7528CPU) \u670d\u52a1\u5668\u53ef\u4ee5\u7528\u5065\u5eb7\u68c0\u67e5\u62a5\u544a\u66f4\u8be6\u7ec6\u7684\u72b6\u6001\uff0c\u4e0d\u4ec5\u4ec5\u662fon\u6216off \u670d\u52a1\u5668\u81ea\u8eab\u53ef\u4ee5\u62a5\u544a\u72b6\u6001\u7ed9\u5176\u4ed6\u7ec4\u4ef6\uff0c\u5982\u8def\u7531\u5668\u6216\u5176\u4ed6\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5141\u8bb8\u6784\u5efa\u975e\u5e38\u5b8c\u6574\u7684\u591a\u8def\u5f84\u548c\u591a\u5c42\u57fa\u7840\u8bbe\u65bd","title":"\u57fa\u672c\u529f\u80fd\uff1a\u76d1\u63a7"},{"location":"Haproxy/#_3","text":"\u4ec5\u4f7f\u7528\u6709\u6548\u7684\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u81ea\u52a8\u9a71\u9010\u51fa\u8d1f\u8f7d\u5747\u8861\u519c\u573a \u652f\u6301\u6b63\u5e38\u5173\u95ed\uff0c\u4ee5\u4fbf\u4e8e\u4e0d\u5f71\u54cd\u6709\u4efb\u4f55\u5173\u7cfb\u7684\u519c\u573a \u5f53\u6d3b\u52a8\u670d\u52a1\u5668\u5173\u95ed\u65f6\uff0c\u5c06\u81ea\u52a8\u4f7f\u7528\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4fbf\u4e8e\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u4e0d\u4e22\u5931\u4f1a\u8bdd\uff0c\u8fd9\u4e5f\u5141\u8bb8\u6784\u5efa\u591a\u6761\u8def\u5f84\u5230\u8fbe\u540c\u4e00\u4e2a\u670d\u52a1\u5668(\u4f8b\u5982\u591a\u4e2a\u63a5\u53e3) \u5f53\u4e00\u4e2a\u519c\u573a\u670d\u52a1\u5668\u592a\u591a\u65f6\uff0c\u80fd\u8fd4\u56de\u670d\u52a1\u5668\u5931\u8d25\u72b6\u6001\uff0c\u8fd9\u548c\u76d1\u63a7\u529f\u80fd\u7ed3\u5408\u4f7f\u7528\uff0c\u8ba9\u5176\u4e3a\u4e0a\u6e38\u7ec4\u4ef6\u9009\u62e9\u7ed9\u5b9a\u670d\u52a1\u7684\u4e0d\u540cLB\u8282\u70b9 \u65e0\u72b6\u6001\u8bbe\u8ba1\u4f7f\u6784\u5efa\u96c6\u7fa4\u53d8\u5f97\u5bb9\u6613\uff0chaproxy\u53ef\u4ee5\u6700\u597d\u7684\u786e\u4fdd\u670d\u52a1\u8fde\u7eed\u6027\u800c\u65e0\u9700\u5b58\u50a8\u5728\u53d1\u751f\u6545\u969c\u65f6\u53ef\u80fd\u4e22\u5931\u7684\u4fe1\u606f \u4e0e\u6807\u51c6\u7684VRRP\u5b88\u62a4\u8fdb\u7a0b\u826f\u597d\u7684\u96c6\u6210\uff0chaproxy\u53ef\u4ee5\u8f7b\u677e\u7684\u5bf9\u72b6\u6001\u8fde\u63a5\u4fdd\u6301\u5e76\u4e8e\u6d6e\u52a8\u865a\u62dfIP\u5f88\u597d\u7684\u5bf9\u5e94","title":"\u57fa\u672c\u529f\u80fd\uff1a\u9ad8\u53ef\u7528"},{"location":"Haproxy/#_4","text":"\u652f\u6301\u4e0d\u5c11\u4e8e9\u949f\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u5176\u4e2d\u4e00\u4e9b\u9002\u7528\u4e8e\u8f93\u5165\u6570\u636e\u4ee5\u63d0\u4f9b\u65e0\u9650\u7684\u53ef\u80fd\u6027\u5217\u8868\u3002\u6700\u666e\u904d\u7684\u662f round-robin (\u5bf9\u4e8e\u77ed\u8fde\u63a5\uff0c\u4f9d\u6b21\u9009\u62e9\u6bcf\u4e2a\u670d\u52a1\u5668) leastconn (\u5bf9\u4e8e\u957f\u8fde\u63a5\u9009\u62e9\u6700\u8fd1\u5f88\u5c11\u4f7f\u7528\u3001\u6700\u4f4e\u8fde\u63a5\u6570\u7684\u670d\u52a1\u5668) source (\u7528\u4e8eSSL farms\u6216\u7ec8\u7aef\u670d\u52a1\u5668farms)\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u6e90\u5730\u5740 URI (\u7528\u4e8eHTTP\u7f13\u5b58\uff0c\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8eHTTP\u3000URI) HDR (\u670d\u52a1\u5668\u4f9d\u8d56\u4e8e\u7279\u5b9a\u7684HTTP hearder\u5b57\u6bb5\u7684\u5185\u5bb9) \u4ee5\u4e0a\u7b97\u6cd5\u90fd\u652f\u6301per-server\u6743\u91cd\uff0c\u4ee5\u4fbf\u9002\u5e94\u519c\u573a\u4e2d\u4e0d\u540c\u670d\u52a1\u5668\uff0c\u6216\u8005\u4f5c\u7528\u4e8e\u6d41\u91cf\u6bd4\u8f83\u5c0f\u7684\u7279\u5b9a\u670d\u52a1\u5668(debug,\u5728\u4e0b\u4e00\u4e2a\u8f6f\u4ef6\u7248\u672c) \u52a8\u6001\u6743\u91cd\u652f\u6301round-robin leastconn \u4e00\u81f4\u6027hashing\uff0c\u8fd9\u5141\u8bb8\u4eceCLI\u52a8\u6001\u4fee\u6539\u670d\u52a1\u5668\u6743\u91cd\u751a\u81f3\u662f\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684\u4ee3\u7406 \u53ea\u8981\u652f\u6301\u52a8\u6001\u6743\u91cd\uff0c\u5c31\u652f\u6301\u6162\u542f\u52a8\uff0c\u8fd9\u5141\u8bb8\u670d\u52a1\u5668\u9010\u6b65\u83b7\u53d6\u6d41\u91cf\uff0c\u8fd9\u662f\u4e2a\u91cd\u8981\u7279\u5f81\uff0c\u5bf9\u4e8e\u9700\u8981\u5728\u8fd0\u884c\u65f6\u7f16\u8bd1\u7c7b\u7684\u8106\u5f31\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u4ee5\u53ca\u9700\u8981\u5728\u5b8c\u5168\u8fd0\u884c\u4e4b\u524d\u586b\u6ee1\u51b7\u7f13\u5b58 hashing(\u6563\u5217)\u53ef\u4ee5\u7528\u4e8e\u5404\u79cd\u5143\u7d20\uff0c\u5982\u5ba2\u6237\u7aef\u6e90\u5730\u5740\uff0cURL\u7ec4\u4ef6\uff0c\u67e5\u8be2\u5b57\u7b26\u4e32\u5143\u7d20\uff0cheader\u5b57\u7b26\u4e32\u503c\uff0cPOST\u53c2\u6570\uff0cRDP cookie \u4e00\u81f4\u6027\u6563\u5217\u53ef\u4ee5\u4fdd\u62a4\u670d\u52a1\u5668farm\u514d\u53d7\u5927\u91cf\u91cd\u65b0\u5206\u53d1\u7684\u5f71\u54cd\uff0c\u5728\u670d\u52a1\u5668farm\u949f\u6dfb\u52a0\u6216\u5220\u9664\u670d\u52a1\u5668\uff0c\u8fd9\u5728\u5927\u578b\u7f13\u5b58farm\u4e2d\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u5141\u8bb8\u6162\u542f\u52a8\u7528\u4e8e\u8865\u5145cold caches \u8bb8\u591a\u5185\u90e8\u6307\u6807\uff0c\u5982\u6bcf\u53f0\u670d\u52a1\u5668\u8fde\u63a5\u6570\u3001\u6bcf\u4e2a\u540e\u7aef\u53ef\u7528\u8fde\u63a5\u63d2\u69fd\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u6784\u5efa\u975e\u5e38\u5148\u8fdb\u7684\u8d1f\u8f7d\u5e73\u8861\u7b56\u7565","title":"\u57fa\u672c\u529f\u80fd\uff1a\u8d1f\u8f7d\u5747\u8861"},{"location":"Haproxy/#stickiness","text":"haproxy\u63d0\u4f9b\u76f8\u5f53\u5168\u9762\u7684\u53ef\u80fd\u6027\u4fdd\u6301\u8bbf\u5ba2\u8bbf\u95ee\u76f8\u540c\u670d\u52a1\u5668\u751a\u81f3\u8de8\u8d8a\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u670d\u52a1\u5668\u6dfb\u52a0/\u5220\u9664\uff0cdown/up\u5faa\u73af\uff0c\u5e76\u8bbe\u8ba1\u65b9\u6cd5\u62b5\u6297\u4e4b\u95f4\u7684\u8ddd\u79bb\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u8282\u70b9\uff0c\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u590d\u5236 \u7c98\u6027\u4fe1\u606f\u53ef\u4ee5\u5355\u72ec\u5339\u914d\u548c\u5b66\u4e60\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u5982\uff1a\u53ef\u4ee5\u5339\u914dJSESSIONID cookie \u5728cookie\u548cURL\u90fd\u6709\uff0c\u6700\u591a\u540c\u4e00\u65f6\u95f4\u53ef\u5b66\u4e608\u4e2a\u5e76\u884c\u6e90\uff0c\u6bcf\u4e2a\u53ef\u80fd\u6307\u5411\u4e0d\u540c\u7684stick-table \u4ee5\u591a\u4e3b\u65b9\u5f0f\u5728\u6240\u6709\u8282\u70b9\u590d\u5236stick-tables \u5e38\u7528\u7684\u5143\u7d20\uff0c\u5982SSL-ID\u6216RDP cookie(\u7528\u4e8eTSE farm)\u76f4\u63a5\u6613\u4e8e\u64cd\u4f5c \u6240\u6709sticking rules\u53ef\u7531ACL\u52a8\u6001\u8c03\u8282 \u53ef\u4ee5\u51b3\u5b9a\u4e0dstick\u67d0\u4e9b\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4ee5\u4fbf\u4e8e\u5f53\u89c4\u5b9a\u7684\u670d\u52a1\u5668\u8fd4\u56de\u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u8fdb\u884cload back\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u8def\u5f84\u73af\u5883 \u5728","title":"\u57fa\u672c\u7279\u5f81\uff1a\u7c98\u6027(Stickiness)"},{"location":"Haproxy/#configuration","text":"\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6240\u6709\u914d\u7f6e\u5173\u952e\u5b57\u548c\u4ed6\u4eec\u7684\u9009\u62e9\u3002\u5b83\u5728\u9700\u8981\u66f4\u6539\u914d\u7f6e\u65f6\u4f7f\u7528","title":"Configuration"},{"location":"Haproxy/#http","text":"\u5f53HAproxy\u5728HTTP\u6a21\u5f0f\u4e0b\u8fd0\u884c\u65f6\uff0c\u8bf7\u6c42\u548c\u76f8\u5e94\u90fd\u662f\u5b8c\u5168\u5206\u6790\u548c\u7d22\u5f15\uff0c\u56e0\u6b64\u51e0\u4e4e\u5728contents\u7684\u4efb\u4f55\u5185\u5bb9\u90fd\u53ef\u4ee5\u5efa\u7acb\u5339\u914d\u3002\u4e86\u89e3http\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u5f62\u6210\u7684\u65b9\u5f0f\u975e\u5e38\u91cd\u8981\uff0c\u53cahaproxy\u5982\u4f55\u5206\u89e3\u5b83\u4eec\uff0c\u7136\u540e\u5c31\u4f1a\u53d8\u5f97\u66f4\u5bb9\u6613\u7f16\u5199\u6b63\u786e\u7684\u89c4\u5219\u548c\u8c03\u8bd5\u73b0\u6709\u914d\u7f6e http\u4e8b\u52a1\u6a21\u578b\uff1ahttp\u534f\u8bae\u662f\u4e8b\u52a1\u9a71\u52a8\u7684\uff0c\u610f\u5473\u7740\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u9886\u5148\u4e00\u4e2a\u56de\u5e94 HAProxy\u652f\u63015\u79cd\u8fde\u63a5\u6a21\u5f0f\uff1a \u4fdd\u6301\u6d3b\u8dc3\uff1a\u5904\u7406\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\uff08\u9ed8\u8ba4\uff09 \u96a7\u9053\uff1a\u53ea\u5904\u7406\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u5176\u4ed6\u4e00\u5207\u90fd\u6ca1\u6709\u5206\u6790\u8f6c\u53d1 \u88ab\u52a8\u5173\u95ed\uff1a\u5728\u4e24\u4e2a\u65b9\u5411\u4e0a\u6dfb\u52a0\u201c\u8fde\u63a5\uff1a\u5173\u95ed\u201d\u7684\u96a7\u9053 \u670d\u52a1\u5668\u5173\u95ed\uff1a\u54cd\u5e94\u540e\u5173\u95ed\u9762\u5411\u670d\u52a1\u5668\u7684\u8fde\u63a5 \u5f3a\u5236\u5173\u95ed\uff1a\u54cd\u5e94\u7ed3\u675f\u540e\uff0c\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5 \u5bf9\u4e8eHTTP/2\uff0c\u8fde\u63a5\u6a21\u5f0f\u7c7b\u4f3c\u4e8e\u201c\u670d\u52a1\u5668\u5173\u95ed\u201d\u6a21\u5f0f\uff1a\u7ed9\u5b9a\u6240\u6709\u6d41\u7684\u72ec\u7acb\u6027\uff0c\u76ee\u524d\u6ca1\u6709\u5730\u65b9\u53ef\u4ee5\u6302\u7a7a\u95f2\u54cd\u5e94\u540e\u7684\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u56e0\u6b64\u5728\u54cd\u5e94\u540e\u5173\u95ed\u3002HTTP/2\u4ec5\u652f\u6301\u4f20\u5165\u8fde\u63a5\uff0c\u800c\u4e0d\u652f\u6301\u8fde\u63a5\u670d\u52a1\u5668 HAProxy\u7684\u914d\u7f6e\u8fc7\u7a0b\u6d89\u53ca3\u4e2a\u4e3b\u8981\u53c2\u6570\u6765\u6e90 1 . \u6765\u81ea\u547d\u4ee4\u884c\u7684\u53c2\u6570\uff0c\u5b83\u59cb\u7ec8\u4f18\u5148 2 . \u201c\u5168\u5c40\u201d\u90e8\u5206\uff0c\u7528\u4e8e\u8bbe\u7f6e\u6d41\u7a0b\u8303\u56f4\u7684\u53c2\u6570 3 . \u4ee3\u7406\u90e8\u5206\u53ef\u4ee5\u91c7\u53d6\u201c\u9ed8\u8ba4\u201d\uff0c\u201c\u542c\u201d\u7684\u5f62\u5f0f\uff0c\u201c\u524d\u7aef\u201d\u548c\u201c\u540e\u7aef\u201d \u914d\u7f6e\u6587\u4ef6\u652f\u6301 3 \u949f\u7c7b\u578b\uff1a\u8f6c\u4e49\u53cd\u659c\u6760\u3001\u53cc\u5f15\u53f7\u5f31\u5f15\u7528\u3001\u5355\u5f15\u53f7\u5f3a\u5f15\u7528 \u5982\u679c\u5fc5\u987b\u5728\u5b57\u7b26\u4e32\u8f93\u5165\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u901a\u8fc7\u53cd\u659c\u6760\u8fdb\u884c\u8f6c\u4e49 \\\u6807\u8bb0\u7a7a\u683c\u5e76\u5c06\u5176\u4e0e\u5206\u9694\u7b26\u533a\u5206\u5f00\u6765 \\\uff03\u6807\u8bb0\u54c8\u5e0c\u5e76\u5c06\u5176\u4e0e\u6ce8\u91ca\u533a\u5206\u5f00\u6765 \\\\\u4f7f\u7528\u53cd\u659c\u6760 '' \u4f7f\u7528\u5355\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f3a\u5f15\u7528\u533a\u5206\u5f00\u6765 \"\" \u4f7f\u7528\u53cc\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f31\u5f15\u7528\u533a\u5206\u5f00\u6765","title":"\u5173\u4e8eHTTP\u7684\u5feb\u901f\u63d0\u9192"},{"location":"Haproxy/#management","text":"\u5982\u4f55\u542f\u52a8haproxy\uff0c\u5982\u4f55\u8fd0\u884c\u65f6\u7ba1\u7406\u5b83\uff0c\u5982\u4f55\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u7ba1\u7406\u5b83\uff0c\u4ee5\u53ca\u5982\u4f55\u65e0\u7f1d\u5347\u7ea7","title":"Management"},{"location":"Haproxy/#architecture","text":"\u5982\u4f55\u6784\u5efa\u4e00\u4e2a\u6700\u597d\u7684\u8d1f\u8f7d\u5747\u8861\u57fa\u7840\u67b6\u6784\u4ee5\u53ca\u5982\u4f55\u4e0e\u7b2c\u4e09\u65b9\u4ea7\u54c1\u8fdb\u884c\u96c6\u6210","title":"Architecture"},{"location":"Iptables/","text":"iptables \u00b6 \u9009\u9879\u8be6\u89e3 iptables\u5de5\u4f5c\u673a\u5236 \u57fa\u672c\u67b6\u6784\u6d41\u7a0b\u56fe \u57fa\u672c\u53c2\u6570 iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f \u9632\u706b\u5899\u7684\u7b56\u7565 \u5b9e\u4f8b \u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570 \u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5 \u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528 \u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219 \u914d\u7f6e\u767d\u540d\u5355 \u5f00\u542f\u76f8\u5e94\u7684\u670d\u52a1\u7aef\u53e3 \u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d \u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219 \u6e05\u9664\u5df2\u6709\u89c4\u5219 \u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3 \u5c4f\u853dIP \u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3 \u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219 \u7aef\u53e3\u6620\u5c04 \u5b57\u7b26\u4e32\u5339\u914d \u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb \u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb iptables\u5de5\u4f5c\u673a\u5236 \u00b6 iptables \u8868\u662f\u6309\u7167\u5bf9\u6570\u636e\u5305\u7684\u64cd\u4f5c\u533a\u5206\u7684\uff0c\u94fe\u4e5f\u88ab\u79f0\u4e3a\u94a9\u5b50\u51fd\u6570(hook functions)\u662f\u6309\u7167\u4e0d\u540c\u7684Hook\u51fd\u6570\u6765\u533a\u5206\u7684 \u8868 filter \u8d1f\u8d23\u5305\u8fc7\u6ee4\uff0c\u7528\u4e8e\u9632\u706b\u5899\u89c4\u5219 nat nat\u529f\u80fd(\u7aef\u53e3\u6620\u5c04\uff0c\u5730\u5740\u6620\u5c04,\u7f51\u5173\u8def\u7531\u7b49\uff09 mangle \u8d1f\u8d23IP\u6570\u636e\u5305\u5904\u7406\uff0c\u5982\uff1aTos\uff0c\u670d\u52a1\u7c7b\u578b\u7b49\uff0c\u7528\u4e8e\u5b9e\u73b0\u670d\u52a1\u8d28\u91cf raw \u8d1f\u8d23\u8fde\u63a5\u8ddf\u8e2a,\u5982:\u7f51\u5740\u8fc7\u6ee4 security \u7528\u4e8e\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236(SELinux\u7b49)\u7f51\u7edc\u89c4\u5219 \u94fe\u540d\u89c4\u5219 INPUT \u63a5\u6536\u6570\u636e\u5305 OUTPUT \u8f93\u51fa\u6570\u636e\u5305 FORWARD \u5728\u5185\u6838\u7a7a\u95f4\u4e2d\uff0c\u4ece\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u8fdb\u5165\uff0c\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u53bb\u3002\u8f6c\u53d1\u8fc7\u6ee4 PREROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u8868\u4e4b\u524d(DNAT) POSTROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u9009\u62e9\u4e4b\u540e(SNAT) \u52a8\u4f5c ACCEPT \u63a5\u6536\u6570\u636e\u5305 DROP \u4e22\u5f03\u6570\u636e\u5305 REDIRECT \u91cd\u5b9a\u5411\u3001\u6620\u5c04\u3001\u900f\u660e\u4ee3\u7406 DNAT \u76ee\u6807\u5730\u5740\u8f6c\u6362 SNAT \u6e90\u5730\u5740\u8f6c\u6362 MASQUERADE IP\u4f2a\u88c5\uff08NAT\uff09\uff0c\u7528\u4e8eADSL LOG \u65e5\u5fd7\u8bb0\u5f55 \u4e0b\u8868\u4e3a\uff1a\u4ece\u5de6\u5230\u53f3\u6bcf\u4e2a\u8868(Table)\u53ef\u7528\u7684\u94fe(Chains),\u5f53\u4ece\u4e0a\u5230\u4e0b\u663e\u793a\u5728\u89e6\u53d1\u5173\u8054\u7684netfilter\u6302\u94a9\u65f6\u8c03\u7528\u6bcf\u4e2a\u94fe\u7684\u987a\u5e8f Tables\u2193/Chains\u2192 PREROUTING INPUT FORWARD OUTPUT POSTROUTING (routing decision) \u2713 raw \u2713 \u2713 (connection tracking enabled) \u2713 \u2713 mangle \u2713 \u2713 \u2713 \u2713 \u2713 nat (DNAT) \u2713 \u2713 (routing decision) \u2713 \u2713 filter \u2713 \u2713 \u2713 security \u2713 \u2713 \u2713 nat (SNAT) \u2713 \u2713 iptables\u6570\u636e\u5305\u6d41\u7a0b \u00b6 \u53c2\u8003\u94fe\u63a5 # \u4ee5\u4e0b\u4e3a\u7b80\u6613\u6d41\u7a0b\uff1b\u5927\u591a\u6570\u4f7f\u7528\u60c5\u51b5\u4e0b\u90fd\u4e0d\u4f1a\u7528\u5230raw\uff0cmangle\u548csecurity\u8868\uff1b\u6ce8\u610f\uff1aIPv6\u6ca1\u6709nat \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513 \u2503 Network \u2503 \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b | | \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 table: raw,mangle,nat(destination) \u2502 \u2502 chain: PREROUTING \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | \u25bc \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 route outing decision \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u5224\u65ad\u5f53\u524d\u6570\u636e\u5305\u76ee\u7684IP\u5730\u5740\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 | \u662f\u5426\u4e3a\u672c\u673a\u7f51\u53e3\u7684IP\u5730\u5740 | | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u2502\u76ee\u7684IP\u975e\u672c\u673a\u7f51\u53e3IP | \u2502\u5982\u679c\u672c\u673a\u5f00\u542fIP_forward \u2502 \u76ee\u7684IP\u4e3a\u672c\u5730\u7f51\u53e3IP |\u5219\u6570\u636e\u5305\u8fdb\u5165\u8f6c\u53d1\u6d41\u7a0b \u2502 \u8fdb\u5165\u672c\u673a\u5904\u7406INPUT \u2502 \u2502 \u2502 \u25bc \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Table:mangle,filter\uff0csecurity | \u2502table: mangle,filter | \u2502 Chain:INPUT \u2502 \u2502chain: FORWARD \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | | | | \u25bc | \u250c \u2510 | \u2502local process\u2502 | \u2514 \u2518 | \u2502 | \u25bc | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | Routing decision \u5224\u65ad\u6570\u636e\u5305\u53d1\u5f80\u54ea\u4e2a\u7f51\u53e3 | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | \u2502 | \u25bc | \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 | \u2502 table: raw,mangle,nat(destination),filter,security \u2502 | \u2502 chain: OUTPUT \u2502 | \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | \u2502 | | | | | | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | +\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 routing decision \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u2502 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 table: mangle,nat(source) \u2502 \u2502 chain: PREROUTING \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\u6570\u636e\u94fe\u8def\u5c42\u5c01\u88c5\uff0c\u53d1\u9001\u5230\u7f51\u7edc | \u25bc \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513 \u2503 Network \u2503 \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b \u8865\u5145\uff1a`-A` \u4ee3\u8868\u8ffd\u52a0\uff0c`-I` \u4ee3\u8868\u63d2\u5165\uff0c`-D` \u4ee3\u8868\u5220\u6389\uff0c`-R` \u4ee3\u8868\u66ff\u6362\uff0c`-L` \u4ee3\u8868\u5217\u8868\uff0c`-p` \u4ee3\u8868\u534f\u8bae\uff0c`-s` \u4ee3\u8868\u6e90\u5730\u5740\uff0c\u5fc5\u987b\u662f IP \uff0c`-j` \u4ee3\u8868\u52a8\u4f5c\uff0c`-d` \u4ee3\u8868\u76ee\u6807\u5730\u5740\uff0c`-i` \u7f51\u5361\u8fdb\u5165\u662f\u6570\u636e\uff0c`-o` \u4ee3\u8868\u7f51\u5361\u8f93\u51fa\u7684\u6570\u636e iptables\u6ce8\u610f\u4e8b\u9879\uff1a \u4e13\u8868\u4e13\u7528\uff1afilter\u3001nat\u3001mangle\uff1b\u6ce8\u610f\u6570\u636e\u5305\u8d70\u5411\uff1aPREROUTING\u3001INPUT\u3001FORWARD\u3001OUTPUT\u3001POSTROUTING \u6240\u6709\u94fe\u540d\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u8868\u540d\u5fc5\u987b\u5c0f\u5199\uff0c\u6240\u6709\u52a8\u4f5c\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u5339\u914d\u5fc5\u987b\u5c0f\u5199 iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f \u00b6 iptables -t \u8868\u540d <-A/I/D/R> \u89c4\u5219\u94fe\u540d [ \u89c4\u5219\u53f7 ] <-i/o \u7f51\u5361\u540d> -p \u534f\u8bae\u540d <-s \u6e90IP/\u6e90\u5b50\u7f51> --sport \u6e90\u7aef\u53e3 <-d \u76ee\u6807IP/\u76ee\u6807\u5b50\u7f51> --dport \u76ee\u6807\u7aef\u53e3 -j \u52a8\u4f5c \u57fa\u672c\u53c2\u6570 \u00b6 \u53c2\u6570 \u4f5c\u7528 -P \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565:iptables -P INPUT (DROP -F \u6e05\u7a7a\u89c4\u5219\u94fe -L \u67e5\u770b\u89c4\u5219\u94fe -A \u5728\u89c4\u5219\u94fe\u7684\u672b\u5c3e\u52a0\u5165\u65b0\u89c4\u5219 -I num \u5728\u89c4\u5219\u94fe\u7684\u5934\u90e8\u52a0\u5165\u65b0\u89c4\u5219 -D num \u5220\u9664\u67d0\u4e00\u6761\u89c4\u5219 -s \u5339\u914d\u6765\u6e90\u5730\u5740IP/MASK\uff0c\u52a0\u53f9\u53f7\"!\"\u8868\u793a\u9664\u8fd9\u4e2aIP\u5916\u3002 -d \u5339\u914d\u76ee\u6807\u5730\u5740 -i \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u5165\u7684\u6570\u636e -o \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u51fa\u7684\u6570\u636e -p \u5339\u914d\u534f\u8bae,\u5982tcp,udp,icmp --dport num \u5339\u914d\u76ee\u6807\u7aef\u53e3\u53f7 --sport num \u5339\u914d\u6765\u6e90\u7aef\u53e3\u53f7 # \u901a\u7528\u5339\u914d\uff1a\u6e90\u5730\u5740\u76ee\u6807\u5730\u5740\u7684\u5339\u914d -t,--table table --->\uff1a\u5bf9\u6307\u5b9a\u7684\u8868 table \u8fdb\u884c\u64cd\u4f5c\uff0c table \u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u6b64\u9009\u9879\uff0c\u9ed8\u8ba4\u7684\u662f filter \u8868 -p --->\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662fTCP\u3001UDP\u3001ICMP\u7b49 # \u6309\u7167\u6765\u6e90\u76ee\u7684\u5730\u5740\u5339\u914d\uff0c\u53ef\u4ee5\u662fIP\u3001NET\u3001DOMAIN\uff0c\u4e5f\u53ef\u4e3a\u7a7a -s, --source [ ! ] address [ /mask ] --->\uff1a\u5339\u914d\u6765\u6e90\u5730\u5740\uff1b\u628a\u6307\u5b9a\u7684\u4e00\u4e2a\uff0f\u4e00\u7ec4\u5730\u5740\u4f5c\u4e3a\u6e90\u5730\u5740\uff0c\u6309\u6b64\u89c4\u5219\u8fdb\u884c\u8fc7\u6ee4\u3002\u5f53\u540e\u9762\u6ca1\u6709 mask \u65f6\uff0caddress \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.1\uff1b\u5f53 mask \u6307\u5b9a\u65f6\uff0c\u53ef\u4ee5\u8868\u793a\u4e00\u7ec4\u8303\u56f4\u5185\u7684\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.0/255.255.255.0 -d, --destination [ ! ] address [ /mask ] --->\uff1a\u5339\u914d\u76ee\u7684\u5730\u5740\uff1b\u5730\u5740\u683c\u5f0f\u540c\u4e0a\uff0c\u4f46\u8fd9\u91cc\u662f\u6307\u5b9a\u5730\u5740\u4e3a\u76ee\u7684\u5730\u5740\uff0c\u6309\u6b64\u8fdb\u884c\u8fc7\u6ee4 # \u6309\u7167\u7f51\u7edc\u63a5\u53e3\u5339\u914d -i, --in-interface [ ! ] <\u7f51\u7edc\u63a5\u53e3name> --->\uff1a\u5339\u914d\u6570\u636e\u8fdb\u5165\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u7684\u6765\u81ea\u6765\u81ea\u7f51\u7edc\u63a5\u53e3\uff0c\u6bd4\u5982\u6700\u5e38\u89c1\u7684 eth0 \u3002\u6ce8\u610f\uff1a\u5b83\u53ea\u5bf9 INPUT\uff0cFORWARD\uff0cPREROUTING \u8fd9\u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6b64\u9009\u9879\uff0c \u8bf4\u660e\u53ef\u4ee5\u6765\u81ea\u4efb\u4f55\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002\u540c\u524d\u9762\u7c7b\u4f3c\uff0c \"!\" \u8868\u793a\u53d6\u53cd -o, --out-interface [ ! ] <\u7f51\u7edc\u63a5\u53e3name> --->\uff1a\u5339\u914d\u6570\u636e\u6d41\u51fa\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3\u3002\u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528 # \u6309\u7aef\u53e3\u5339\u914d\uff0c--sport\u548c--dport\u5fc5\u987b\u914d\u5408-p\u53c2\u6570\u4f7f\u7528\uff0c\u4e14\u5fc5\u987b\u6307\u660e\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u4e2a\u522b\u7aef\u53e3\u6216\u7aef\u53e3\u8303\u56f4 --sport <\u5339\u914d\u6e90\u7aef\u53e3> --dport <\u5339\u914d\u76ee\u7684\u7aef\u53e3> # \u67e5\u770b\u7ba1\u7406\u547d\u4ee4 -L, --list [ chain ] \u5217\u51fa\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u5217\u51fa\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1bv:\u663e\u793a\u6bcf\u6761\u89c4\u5219\u7684\u5339\u914d\u5305\u6570\u91cf\u548c\u5339\u914d\u5b57\u8282\u6570\uff1bx:\u5728v\u9009\u9879\u57fa\u7840\u4e0a\u7981\u6b62\u81ea\u52a8\u5355\u4f4d\u6362\u7b97 ( K\u3001M ) ; n:\u53ea\u663e\u793aIP\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4e0d\u663e\u793a\u57df\u540d\u548c\u670d\u52a1\u540d\u79f0 # \u89c4\u5219\u7ba1\u7406\u547d\u4ee4 -A, --append chain rule-specification --->\uff1a\u5728\u6307\u5b9a\u94fe chain \u7684\u672b\u5c3e\u63d2\u5165\u6307\u5b9a\u7684\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u6761\u89c4\u5219\u4f1a\u88ab\u653e\u5230\u6700\u540e\uff0c\u6700\u540e\u624d\u4f1a\u88ab\u6267\u884c\u3002\u89c4\u5219\u662f\u7531\u540e\u9762\u7684\u5339\u914d\u6765\u6307\u5b9a -I, --insert chain [ rulenum ] rule-specification --->\uff1a\u5728\u94fechain\u4e2d\u7684\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u6761\u6216\u591a\u6761\u89c4\u5219\u3002\u9ed8\u8ba4\u89c4\u5219\u53f7\u662f1\uff0c\u8868\u793a\u5728\u94fe\u7684\u5934\u90e8\u63d2\u5165\u3002\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264 ( \u5df2\u6709\u89c4\u5219\u6570+1 ) \uff0c\u5426\u5219\u62a5\u9519 -D, --delete chain rule-specification -D, --delete chain rulenum --->\uff1a\u5728\u6307\u5b9a\u7684\u94fe chain \u4e2d\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u5b9a\u89c4\u5219\u6216\u6307\u5b9a\u89c4\u5219\u53f7\u3002\u82e5\u89c4\u5219\u5217\u8868\u6709\u591a\u6761\u76f8\u540c\u89c4\u5219\uff0c\u5219\u6309\u5185\u5bb9\u5339\u914d\u53ea\u5220\u9664\u5e8f\u53f7\u6700\u5c0f\u4e00\u6761\uff1b\u6309\u53f7\u7801\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519\uff1b\u6309\u5185\u5bb9\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u5b58\u5728\uff0c\u5426\u5219\u62a5\u9519 -R num --->\uff1aReplays\u66ff\u6362/\u4fee\u6539\u7b2c\u51e0\u6761\u89c4\u5219\uff1b\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519 # \u94fe\u7ba1\u7406\u547d\u4ee4\uff08\u8fd9\u90fd\u662f\u7acb\u5373\u751f\u6548\u7684\uff09 -P, --policy chain target --->\uff1a\u4e3a\u6307\u5b9a\u7684\u94fechain\u8bbe\u7f6e\u7b56\u7565 target\u3002\u6ce8\u610f\uff0c\u53ea\u6709\u5185\u7f6e\u7684\u94fe\u624d\u5141\u8bb8\u6709\u7b56\u7565\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u662f\u4e0d\u5141\u8bb8\u7684\u3002\u5f53\u6570\u636e\u5305\u6ca1\u6709\u88ab\u89c4\u5219\u5217\u8868\u7684\u4efb\u4f55\u89c4\u5219\u76f8\u5339\u914d\uff0c\u5219\u6309\u9ed8\u8ba4\u89c4\u5219\u5904\u7406\uff0c\u52a8\u4f5c\u524d\u4e0d\u80fd\u52a0-j\uff0c\u4e5f\u662f\u552f\u4e00\u5339\u914d\u52a8\u4f5c\u524d\u4e0d\u52a0-j\u9009\u62e9\u7684\u60c5\u51b5 -F, --flush [ chain ] --->\uff1a\u6e05\u7a7a\u6307\u5b9a\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u6e05\u7a7a\u8be5\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1b-F\u4ec5\u4ec5\u6e05\u7a7a\u94fe\u4e2d\u89c4\u5219\uff0c\u4e0d\u5f71\u54cd-P\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u89c4\u5219\uff1b-P\u8bbe\u7f6e\u4e86DROP\u540e\uff0c\u4f7f\u7528-F\u4f1a\u5c06\u5176\u6e05\u9664\u6389 -N, --new-chain chain --->\uff1a\u7528\u6307\u5b9a\u7684\u540d\u5b57\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u94fe -X, --delete-chain [ chain ] --->\uff1a\u5220\u9664\u6307\u5b9a\u7684\u94fe\uff0c\u8fd9\u4e2a\u94fe\u5fc5\u987b\u6ca1\u6709\u88ab\u5176\u5b83\u4efb\u4f55\u89c4\u5219\u5f15\u7528\uff0c\u800c\u4e14\u8fd9\u6761\u4e0a\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\u540d\uff0c\u5219\u4f1a\u5220\u9664\u8be5\u8868\u4e2d\u6240\u6709\u975e\u5185\u7f6e\u7684\u94fe -E, --rename-chain old-chain new-chain --->\uff1a\u7528\u6307\u5b9a\u7684\u65b0\u540d\u5b57\u53bb\u91cd\u547d\u540d\u6307\u5b9a\u7684\u94fe\u3002\u8fd9\u5e76\u4e0d\u4f1a\u5bf9\u94fe\u5185\u90e8\u7167\u6210\u4efb\u4f55\u5f71\u54cd -Z, --zero [ chain ] --->\uff1a\u628a\u6307\u5b9a\u94fe\uff0c\u6216\u8005\u8868\u4e2d\u7684\u6240\u6709\u94fe\u4e0a\u7684\u6240\u6709\u8ba1\u6570\u5668\u6e05\u96f6 -j, --jump target <\u6307\u5b9a\u76ee\u6807> --->\uff1a\u5373\u6ee1\u8db3\u67d0\u6761\u4ef6\u65f6\u8be5\u6267\u884c\u4ec0\u4e48\u6837\u7684\u52a8\u4f5c\u3002target \u53ef\u4ee5\u662f\u5185\u7f6e\u7684\u76ee\u6807\uff0c\u6bd4\u5982 ACCEPT\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u94fe # iptables\u5177\u4f53<\u52a8\u4f5c>\u8be6\u89e3\uff1aACCEPT\u3001DROP\u3001SNAT\u3001DNAT\u3001MASQUERADE -j ACCEPT # \u5141\u8bb8\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684permit) -j DROP # \u963b\u6b62\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe\u800c\u4e22\u5f03\u5b83(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684deny) -j DNAT --to IP [ -IP ][ :\u7aef\u53e3-\u7aef\u53e3 ]( nat\u8868\u7684PREROUTING\u94fe ) # \u76ee\u7684\u5730\u5740\u8f6c\u6362\uff0cDNAT\u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP\u5730\u5740\u6c60(\u4e00\u7ec4\u8fde\u7eed\u7684IP\u5730\u5740) -j SNAT --to IP [ -IP ][ :\u7aef\u53e3-\u7aef\u53e3 ] \uff08nat\u8868\u7684POSTROUTING \u94fe\uff09# \u6e90\u5730\u5740\u8f6c\u6362\uff0cSNAT \u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP \u5730\u5740\u6c60 ( \u4e00\u7ec4\u8fde\u7eed\u7684IP \u5730\u5740 ) -j MASQUERADE # \u52a8\u6001\u6e90\u5730\u5740\u8f6c\u6362(\u52a8\u6001IP\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528) # \u9644\u52a0\u6a21\u5757 \u6309\u5305\u72b6\u6001\u5339\u914d---- ( state ) \u6309\u6765\u6e90MAC \u5339\u914d-- ( mac ) \u6309\u5305\u901f\u7387\u5339\u914d---- ( limit ) \u591a\u7aef\u53e3\u5339\u914d------ ( multiport ) -m state --state \u72b6\u6001 # \u72b6\u6001\uff1aNEW\u3001RELATED\u3001ESTABLISHED\u3001INVALID NEW\uff1a\u6709\u522b\u4e8etcp\u7684syn ESTABLISHED\uff1a\u8fde\u63a5\u6001 RELATED\uff1a\u884d\u751f\u6001\uff0c\u4e0econntrack \u5173\u8054\uff08FTP\uff09 INVALID\uff1a\u4e0d\u80fd\u88ab\u8bc6\u522b\u5c5e\u4e8e\u54ea\u4e2a\u8fde\u63a5\u6216\u6ca1\u6709\u4efb\u4f55\u72b6\u6001 -m mac --mac-source MAC # \u5339\u914d\u67d0\u4e2aMAC \u5730\u5740\u3002\u62a5\u6587\u7ecf\u8fc7\u8def\u7531\u540e\uff0c\u6570\u636e\u5305\u4e2d\u539f\u6709\u7684mac \u4fe1\u606f\u4f1a\u88ab\u66ff\u6362\uff0c\u6240\u4ee5\u5728\u8def\u7531\u540e\u7684iptables \u4e2d\u4f7f\u7528mac \u6a21\u5757\u662f\u6ca1\u6709\u610f\u4e49\u7684 -m limit --limit \u5339\u914d\u901f\u7387 [ --burst \u7f13\u51b2\u6570\u91cf ] # \u7528\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u6570\u636e\u5305\u3002limit \u82f1\u8bed\u4e0a\u770b\u662f\u9650\u5236\u7684\u610f\u601d\uff0c\u4f46\u5b9e\u9645\u4e0a\u53ea\u662f\u6309\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u800c\u5df2\uff0c\u8981\u60f3\u9650\u5236\u7684\u8bdd\u540e\u9762\u8981\u518d\u8ddf\u4e00\u6761DROP -m multiport <--sports | --dports | --ports> \u7aef\u53e31 [ ,\u7aef\u53e32,..,\u7aef\u53e3n ] # \u4e00\u6b21\u6027\u5339\u914d\u591a\u4e2a\u7aef\u53e3\uff0c\u53ef\u4ee5\u533a\u5206\u6e90\u7aef\u53e3\uff0c\u76ee\u7684\u7aef\u53e3\u6216\u4e0d\u6307\u5b9a\u7aef\u53e3\u3002\u5fc5\u987b\u4e0e-p \u53c2\u6570\u4e00\u8d77\u4f7f\u7528 man iptables-extensions\u4e2d\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684\u652f\u6301\u7684module ; iptables-extensions\u7531\u591a\u4e2amach module\u548c\u591a\u4e2atarget module\u7ec4\u6210\uff0c\u6bcf\u4e2amodule\u90fd\u6709\u81ea\u5df1\u7684\u53c2\u6570 \u9632\u706b\u5899\u7684\u7b56\u7565 \u00b6 \u9632\u706b\u5899\u7b56\u7565\u4e00\u822c\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u53eb \u901a \u7b56\u7565\uff0c\u4e00\u79cd\u53eb \u5835 \u7b56\u7565\uff0c\u901a\u7b56\u7565\uff0c\u9ed8\u8ba4\u95e8\u662f\u5173\u7740\u7684\uff0c\u5fc5\u987b\u8981\u5b9a\u4e49\u8c01\u80fd\u8fdb\u3002\u5835\u7b56\u7565\u5219\u662f\uff0c\u5927\u95e8\u662f\u6d1e\u5f00\u7684\uff0c\u4f46\u662f\u4f60\u5fc5\u987b\u6709\u8eab\u4efd\u8ba4\u8bc1\uff0c\u5426\u5219\u4e0d\u80fd\u8fdb\uff0c \u6240\u4ee5\u901a\uff0c\u662f\u8981\u5168\u901a\uff0c\u800c\u5835\uff0c\u5219\u662f\u8981\u9009\u62e9 \u3002\u5f53\u6211\u4eec\u5b9a\u4e49\u7684\u7b56\u7565\u7684\u65f6\u5019\uff0c\u8981\u5206\u522b\u5b9a\u4e49\u591a\u6761\u529f\u80fd\uff0c\u5176\u4e2d\uff1a\u5b9a\u4e49\u6570\u636e\u5305\u4e2d\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\u7b56\u7565\uff0cfilter\u8fc7\u6ee4\u7684\u529f\u80fd\uff0c\u800c\u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\u529f\u80fd\u7684\u5219\u662fnat\u9009\u9879\u3002\u4e3a\u4e86\u8ba9\u8fd9\u4e9b\u529f\u80fd\u4ea4\u66ff\u5de5\u4f5c\uff0c\u6211\u4eec\u5236\u5b9a\u51fa\u4e86\u201c\u8868\u201d\u8fd9\u4e2a\u5b9a\u4e49\uff0c\u6765\u5b9a\u4e49\u3001\u533a\u5206\u5404\u79cd\u4e0d\u540c\u7684\u5de5\u4f5c\u529f\u80fd\u548c\u5904\u7406\u65b9\u5f0f\u3002 \u6211\u4eec\u73b0\u5728\u7528\u7684\u6bd4\u8f83\u591a\u7684\u529f\u80fd\u67093\u4e2a\uff1a filter \u5b9a\u4e49\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\uff0c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT nat \u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\uff0c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING mangle\u529f\u80fd:\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\uff0c\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING \u6211\u4eec\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\u5c31\u662f\u6765\u4fee\u6539TTL\u7684\u3002\u80fd\u591f\u5b9e\u73b0\u5c06\u6570\u636e\u5305\u7684\u5143\u6570\u636e\u62c6\u5f00\uff0c\u5728\u91cc\u9762\u505a\u6807\u8bb0/\u4fee\u6539\u5185\u5bb9\u7684\u3002\u800c\u9632\u706b\u5899\u6807\u8bb0\uff0c\u5176\u5b9e\u5c31\u662f\u9760mangle\u6765\u5b9e\u73b0\u7684\u3002 \u5c0f\u6269\u5c55: \u5bf9\u4e8efilter\u6765\u8bb2\u4e00\u822c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT \u5bf9\u4e8enat\u6765\u8bb2\u4e00\u822c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING \u800cmangle\u5219\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING iptables/netfilter\uff08\u8fd9\u6b3e\u8f6f\u4ef6\uff09\u662f\u5de5\u4f5c\u5728\u7528\u6237\u7a7a\u95f4\u7684\uff0c\u5b83\u53ef\u4ee5\u8ba9\u89c4\u5219\u8fdb\u884c\u751f\u6548\u7684\uff0c\u672c\u8eab\u4e0d\u662f\u4e00\u79cd\u670d\u52a1\uff0c\u800c\u4e14\u89c4\u5219\u662f\u7acb\u5373\u751f\u6548\u7684\u3002\u800c\u6211\u4eeciptables\u73b0\u5728\u88ab\u505a\u6210\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u542f\u52a8\uff0c\u505c\u6b62\u7684\u3002\u542f\u52a8\uff0c\u5219\u5c06\u89c4\u5219\u76f4\u63a5\u751f\u6548\uff0c\u505c\u6b62\uff0c\u5219\u5c06\u89c4\u5219\u64a4\u9500\u3002 iptables\u8fd8\u652f\u6301\u81ea\u5df1\u5b9a\u4e49\u94fe\u3002\u4f46\u662f\u81ea\u5df1\u5b9a\u4e49\u7684\u94fe\uff0c\u5fc5\u987b\u662f\u8ddf\u67d0\u79cd\u7279\u5b9a\u7684\u94fe\u5173\u8054\u8d77\u6765\u7684\u3002\u5728\u4e00\u4e2a\u5173\u5361\u8bbe\u5b9a\uff0c\u6307\u5b9a\u5f53\u6709\u6570\u636e\u7684\u65f6\u5019\u4e13\u95e8\u53bb\u627e\u67d0\u4e2a\u7279\u5b9a\u7684\u94fe\u6765\u5904\u7406\uff0c\u5f53\u90a3\u4e2a\u94fe\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u518d\u8fd4\u56de\u3002\u63a5\u7740\u5728\u7279\u5b9a\u7684\u94fe\u4e2d\u7ee7\u7eed\u68c0\u67e5\u3002 \u6ce8\u610f\uff1a\u89c4\u5219\u7684\u6b21\u5e8f\u975e\u5e38\u5173\u952e\uff0c \u8c01\u7684\u89c4\u5219\u8d8a\u4e25\u683c\uff0c\u5e94\u8be5\u653e\u7684\u8d8a\u9760\u524d \uff0c\u800c\u68c0\u67e5\u89c4\u5219\u7684\u65f6\u5019\uff0c\u662f\u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u67e5\u7684 \u5b9e\u4f8b \u00b6 # \u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d,\u4efb\u4f55\u6539\u52a8\u4e4b\u524d\u5148\u5907\u4efd\uff0c\u8bf7\u4fdd\u6301\u8fd9\u4e00\u4f18\u79c0\u7684\u4e60\u60ef cp /etc/sysconfig/iptables /etc/sysconfig/iptables.bak iptables-save > /etc/sysconfig/iptables # \u6e05\u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570 iptables -F # \u6e05\u7a7a\u6240\u6709\u7684\u9632\u706b\u5899\u89c4\u5219 iptables -X # \u5220\u9664\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7a7a\u94fe iptables -Z # \u6e05\u7a7a\u8ba1\u6570 iptables -A INPUT -s 192 .168.1.0/24 -p tcp --dport 22 -j ACCEPT # \u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5,22\u4e3a\u4f60\u7684ssh\u7aef\u53e3\uff0c -s 192.168.1.0/24\u8868\u793a\u5141\u8bb8\u8fd9\u4e2a\u7f51\u6bb5\u7684\u673a\u5668\u6765\u8fde\u63a5\uff0c\u5176\u5b83\u7f51\u6bb5\u7684ip\u5730\u5740\u662f\u767b\u9646\u4e0d\u4e86\u4f60\u7684\u673a\u5668\u7684\u3002 -j ACCEPT\u8868\u793a\u63a5\u53d7\u8fd9\u6837\u7684\u8bf7\u6c42 # \u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528;\u672c\u5730\u56de\u73af\u5730\u5740\u5c31\u662f\u90a3\u4e2a127.0.0.1\uff0c\u662f\u672c\u673a\u4e0a\u4f7f\u7528\u7684,\u5b83\u8fdb\u4e0e\u51fa\u90fd\u8bbe\u7f6e\u4e3a\u5141\u8bb8 iptables -A INPUT -i lo -j ACCEPT iptables -A OUTPUT -o lo -j ACCEPT # \u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219 iptables -P INPUT DROP # \u914d\u7f6e\u9ed8\u8ba4\u4e0d\u8ba9\u8fdb iptables -P FORWARD DROP # \u9ed8\u8ba4\u4e0d\u5141\u8bb8\u8f6c\u53d1 iptables -P OUTPUT ACCEPT # \u9ed8\u8ba4\u53ef\u4ee5\u51fa\u53bb # \u914d\u7f6e\u767d\u540d\u5355;\u9ed1\u540d\u5355\u5c31\u662f\u540e\u9762\u6362\u6210DROP iptables -A INPUT -p all -s 192 .168.1.0/24 -j ACCEPT # \u5141\u8bb8192.168.1.0\u7f51\u6bb5\u4e92\u76f8\u53ef\u4ee5\u8bbf\u95ee iptables -A INPUT -m mac --mac-source 00 :00:00:00:00:00 -j ACCEPT # \u5141\u8bb8mac\u5730\u5740\u4e3a00:00:00:00:00:00\u8bbf\u95ee iptables -A INPUT -p tcp -s 183 .121.3.7 --dport 3380 -j ACCEPT # \u5141\u8bb8183.121.3.7\u8bbf\u95ee\u672c\u673a\u76843380\u7aef\u53e3 iptables -A INPUT -p tcp -m multiport --dports 22 ,80,443 -j ACCEPT # \u5f00\u542f22,80,443\u7aef\u53e3 iptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT # \u5141\u8bb8\u88abping iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u5df2\u5efa\u7acb\u7684\u6216\u76f8\u5173\u8fde\u63a5\u7684\u901a\u884c # \u7981\u6b62\u5176\u4ed6\u672a\u5141\u8bb8\u7684\u89c4\u5219\u8bbf\u95ee iptables -A INPUT -j REJECT iptables -A FORWARD -j REJECT iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 25 -j REDIRECT --to-port 2525 # \u672c\u573025\u7aef\u53e3\u8f6c\u53d1\u52302525 iptables -A INPUT -p tcp --dport 80 -m limit --limit 100 /minute --limit-burst 200 -j ACCEPT # \u9650\u5236\u8fde\u63a5\u901f\u7387\uff0c\u6bcf\u5206\u949f100\u4e2a\uff0c\u4e0a\u9650200 iptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 3 -j REJECT # \u9650\u523622\u7aef\u53e3\u5e76\u53d1\u8fde\u63a5 # \u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219 iptables -L [ -t \u8868\u540d ] [ \u94fe\u540d ] - \u56db\u4e2a\u8868\u540d ` raw ` \uff0c ` nat ` \uff0c ` filter ` \uff0c ` mangle ` - \u4e94\u4e2a\u89c4\u5219\u94fe\u540d ` INPUT ` \u3001 ` OUTPUT ` \u3001 ` FORWARD ` \u3001 ` PREROUTING ` \u3001 ` POSTROUTING ` - filter\u8868\u5305\u542b ` INPUT ` \u3001 ` OUTPUT ` \u3001 ` FORWARD ` \u4e09\u4e2a\u89c4\u5219\u94fe ``` bash iptables -L -t nat # \u5217\u51fa nat \u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219 # ^ -t \u53c2\u6570\u6307\u5b9a\uff0c\u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a iptables -L -t nat --line-numbers # \u89c4\u5219\u5e26\u7f16\u53f7 iptables -L INPUT iptables -L -nv # \u67e5\u770b\uff0c\u8fd9\u4e2a\u5217\u8868\u770b\u8d77\u6765\u66f4\u8be6\u7ec6 \u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u00b6 # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219 iptables -A INPUT -s 192 .168.1.5 -j DROP \u5c06\u6240\u6709iptables\u4ee5\u5e8f\u53f7\u6807\u8bb0\u663e\u793a\uff0c\u6267\u884c\uff1a iptables -L -n --line-numbers \u6bd4\u5982\u8981\u5220\u9664INPUT\u91cc\u5e8f\u53f7\u4e3a8\u7684\u89c4\u5219\uff0c\u6267\u884c\uff1a iptables -D INPUT 8 \u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3 \u00b6 \u5c4f\u853dIP \u00b6 iptables -A INPUT -p tcp -m tcp -s 192 .168.0.8 -j DROP # \u5c4f\u853d\u6076\u610f\u4e3b\u673a\uff08\u6bd4\u5982\uff0c192.168.0.8 iptables -I INPUT -s 123 .45.6.7 -j DROP #\u5c4f\u853d\u5355\u4e2aIP\u7684\u547d\u4ee4 iptables -I INPUT -s 123 .0.0.0/8 -j DROP #\u5c01\u6574\u4e2a\u6bb5\u5373\u4ece123.0.0.1\u5230123.255.255.254\u7684\u547d\u4ee4 iptables -I INPUT -s 124 .45.0.0/16 -j DROP #\u5c01IP\u6bb5\u5373\u4ece123.45.0.1\u5230123.45.255.254\u7684\u547d\u4ee4 iptables -I INPUT -s 123 .45.6.0/24 -j DROP #\u5c01IP\u6bb5\u5373\u4ece123.45.6.1\u5230123.45.6.254\u7684\u547d\u4ee4\u662f \u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3 \u00b6 \u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\u3002 iptables -A FORWARD -o eth0 \u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u00b6 iptables -L -n -v Chain INPUT ( policy DROP 48106 packets, 2690K bytes ) pkts bytes target prot opt in out source destination 5075 589K ACCEPT all -- lo * 0 .0.0.0/0 0 .0.0.0/0 191K 90M ACCEPT tcp -- * * 0 .0.0.0/0 0 .0.0.0/0 tcp dpt:22 1499K 133M ACCEPT tcp -- * * 0 .0.0.0/0 0 .0.0.0/0 tcp dpt:80 4364K 6351M ACCEPT all -- * * 0 .0.0.0/0 0 .0.0.0/0 state RELATED,ESTABLISHED 6256 327K ACCEPT icmp -- * * 0 .0.0.0/0 0 .0.0.0/0 Chain FORWARD ( policy ACCEPT 0 packets, 0 bytes ) pkts bytes target prot opt in out source destination Chain OUTPUT ( policy ACCEPT 3382K packets, 1819M bytes ) pkts bytes target prot opt in out source destination 5075 589K ACCEPT all -- * lo 0 .0.0.0/0 0 .0.0.0/0 \u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219 \u00b6 \u516c\u7f51 210 . 14 . 67 . 7 \u8ba9\u5185\u7f51 192 . 168 . 188 . 0 / 24 \u4e0a\u7f51 iptables -t nat -A POSTROUTING -s 192 .168.188.0/24 -j SNAT --to-source 210 .14.67.127 \u7aef\u53e3\u6620\u5c04 \u00b6 \u672c\u673a\u7684 2222 \u7aef\u53e3\u6620\u5c04\u5230\u5185\u7f51 \u865a\u62df\u673a\u768422 \u7aef\u53e3 iptables -t nat -A PREROUTING -d 210 .14.67.127 -p tcp --dport 2222 -j DNAT --to-dest 192 .168.188.115:22 \u5b57\u7b26\u4e32\u5339\u914d \u00b6 \u6bd4\u5982\uff0c\u6211\u4eec\u8981\u8fc7\u6ee4\u6240\u6709TCP\u8fde\u63a5\u4e2d\u7684\u5b57\u7b26\u4e32 test \uff0c\u4e00\u65e6\u51fa\u73b0\u5b83\u6211\u4eec\u5c31\u7ec8\u6b62\u8fd9\u4e2a\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a iptables -A INPUT -p tcp -m string --algo kmp --string \"test\" -j REJECT --reject-with tcp-reset iptables -L # Chain INPUT (policy ACCEPT) # target prot opt source destination # REJECT tcp -- anywhere anywhere STRING match \"test\" ALGO name kmp TO 65535 reject-with tcp-reset # # Chain FORWARD (policy ACCEPT) # target prot opt source destination # # Chain OUTPUT (policy ACCEPT) # target prot opt source destination \u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb \u00b6 iptables -I INPUT -j DROP -p tcp -s 0 .0.0.0/0 -m string --algo kmp --string \"cmd.exe\" \u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb \u00b6 iptables -A INPUT -p tcp --syn -m limit --limit 5 /second -j ACCEPT \u66f4\u591a\u5b9e\u4f8b \u00b6 # \u7528iptables\u642d\u5efa\u4e00\u5957\u5f3a\u5927\u7684\u5b89\u5168\u9632\u62a4\u76fe http://www.imooc.com/learn/389 iptables: linux \u4e0b\u5e94\u7528\u5c42\u9632\u706b\u5899\u5de5\u5177 iptables 5\u94fe: \u5bf9\u5e94 Hook point netfilter: linux \u64cd\u4f5c\u7cfb\u7edf\u6838\u5fc3\u5c42\u5185\u90e8\u7684\u4e00\u4e2a\u6570\u636e\u5305\u5904\u7406\u6a21\u5757 Hook point: \u6570\u636e\u5305\u5728 netfilter \u4e2d\u7684\u6302\u8f7d\u70b9 ; ` PRE_ROUTING / INPUT / OUTPUT / FORWARD / POST_ROUTING ` iptables & netfilter ! []( http://7xq89b.com1.z0.glb.clouddn.com/netfilter & iptables.jpg ) iptables 4\u88685\u94fe ! []( http://7xq89b.com1.z0.glb.clouddn.com/iptables-data-stream.jpg ) iptables rules ! []( http://7xq89b.com1.z0.glb.clouddn.com/iptables-rules.jpg ) - 4\u8868 **filter**: \u8bbf\u95ee\u63a7\u5236 / \u89c4\u5219\u5339\u914d **nat**: \u5730\u5740\u8f6c\u53d1 mangle / raw - \u89c4\u5219 \u6570\u636e\u8bbf\u95ee\u63a7\u5236: ACCEPT / DROP / REJECT \u6570\u636e\u5305\u6539\u5199 ( nat -> \u5730\u5740\u8f6c\u6362 ) : snat / dnat \u4fe1\u606f\u8bb0\u5f55: log ## \u4f7f\u7528\u573a\u666f\u5b9e\u4f8b - \u573a\u666f\u4e00 \u5f00\u653e tcp 10 -22/80 \u7aef\u53e3 \u5f00\u653e icmp \u5176\u4ed6\u672a\u88ab\u5141\u8bb8\u7684\u7aef\u53e3\u7981\u6b62\u8bbf\u95ee \u5b58\u5728\u7684\u95ee\u9898: \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u672c\u673a ; \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u5176\u4ed6\u4e3b\u673a - \u573a\u666f\u4e8c ftp: \u9ed8\u8ba4\u88ab\u52a8\u6a21\u5f0f ( \u670d\u52a1\u5668\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u544a\u8bc9\u5ba2\u6237\u7aef, \u5ba2\u6237\u7aef\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u62c9\u53d6\u6570\u636e ) vsftpd: \u4f7f ftp \u652f\u6301\u4e3b\u52a8\u6a21\u5f0f ( \u5ba2\u6237\u7aef\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u901a\u77e5\u670d\u52a1\u5668, \u670d\u52a1\u5668\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u53d1\u9001\u6570\u636e ) - \u573a\u666f\u4e09 \u5141\u8bb8\u5916\u7f51\u8bbf\u95ee: web http -> 80 /tcp ; https -> 443 /tcp mail smtp -> 25 /tcp ; smtps -> 465 /tcp pop3 -> 110 /tcp ; pop3s -> 995 /tcp imap -> 143 /tcp \u5185\u90e8\u4f7f\u7528: file nfs -> 123 /udp samba -> 137 /138/139/445/tcp ftp -> 20 /21/tcp remote ssh -> 22 /tcp sql mysql -> 3306 /tcp oracle -> 1521 /tcp - \u573a\u666f\u56db nat \u8f6c\u53d1 - \u573a\u666f\u4e94 \u9632CC\u653b\u51fb iptables -L -F -A -D # list flush append delete # \u573a\u666f\u4e00 iptables -I INPUT -p tcp --dport 80 -j ACCEPT # \u5141\u8bb8 tcp 80 \u7aef\u53e3 iptables -I INPUT -p tcp --dport 10 :22 -j ACCEPT # \u5141\u8bb8 tcp 10-22 \u7aef\u53e3 iptables -I INPUT -p icmp -j ACCEPT # \u5141\u8bb8 icmp iptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709 # \u4f18\u5316\u573a\u666f\u4e00 iptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51 iptables -I INPUT -p tcp --dport 80 -s 10 .10.188.233 -j ACCEPT # \u53ea\u5141\u8bb8\u56fa\u5b9aip\u8bbf\u95ee80 # \u573a\u666f\u4e8c vi /etc/vsftpd/vsftpd.conf # \u4f7f\u7528 vsftpd \u5f00\u542f ftp \u4e3b\u52a8\u6a21\u5f0f port_enable = yes connect_from_port_20 = YES iptables -I INPUT -p tcp --dport 21 -j ACCEPT vi /etc/vsftpd/vsftpd.conf # \u5efa\u8bae\u4f7f\u7528 ftp \u88ab\u52a8\u6a21\u5f0f pasv_min_port = 50000 pasv_max_port = 60000 iptables -I INPUT -p tcp --dport 21 -j ACCEPT iptables -I INPUT -p tcp --dport 50000 :60000 -j ACCEPT # \u8fd8\u53ef\u4ee5\u4f7f\u7528 iptables \u6a21\u5757\u8ffd\u8e2a\u6765\u81ea\u52a8\u5f00\u53d1\u5bf9\u5e94\u7684\u7aef\u53e3 # \u573a\u666f\u4e09 iptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51 iptables -I INPUT -s 10 .10.155.0/24 -j ACCEPT # \u5141\u8bb8\u5185\u7f51\u8bbf\u95ee iptables -I INPUT -p tcp -m multiport --dports 80 ,1723 -j ACCEPT # \u5141\u8bb8\u7aef\u53e3, 80 -> http, 1723 -> vpn iptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709 iptables-save # \u4fdd\u5b58\u8bbe\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6 # \u573a\u666f\u56db iptables -t nat -L # \u67e5\u770b nat \u914d\u7f6e iptables -t nat -A POST_ROUTING -s 10 .10.177.0/24 -j SNAT --to 10 .10.188.232 # SNAT vi /etc/sysconfig/network # \u914d\u7f6e\u7f51\u5173 iptables -t nat -A POST_ROUTING -d 10 .10.188.232 -p tcp --dport 80 -j DNAT --to 10 .10.177.232:80 # DNAT #\u573a\u666f\u4e94 iptables -I INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 -j REJECT # \u9650\u5236\u5e76\u53d1\u8fde\u63a5\u8bbf\u95ee\u6570 iptables -I INPUT -m limit --limit 3 /hour --limit-burst 10 -j ACCEPT # limit\u6a21\u5757; --limit-burst \u9ed8\u8ba4\u4e3a5 \u6682\u672a\u6574\u7406 \u5355\u670d\u52a1\u5668\u9632\u62a4 \u00b6 # \u601d\u8def\uff1a\u786e\u5b9a\u5bf9\u5916\u670d\u52a1\u5bf9\u8c61\uff0c\u5bf9\u7f51\u7edc\u63a5\u53e3\u5904\u7406\uff0c\u72b6\u6001\u68c0\u6d4b\u5904\u7406\uff0c\u534f\u8bae\u548c\u7aef\u53e3\u5904\u7406\u3002\u4f8b\u5982\uff1a\u666e\u901aWEB\u670d\u52a1\u5668 iptables -A INPUT -i lo -j ACCEPT # \u5f00\u653e\u672c\u5730\u8bbf\u95ee iptables -A INPUT -p tcp -m multiport --dports 22 ,80,8080 -j ACCEPT # \u5f00\u653e22,80,8080tcp\u7aef\u53e3 iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT # \u5f00\u653e\u72b6\u6001\u4e3aRELATED,ESTABLISHED\u7684 iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT iptables -P INPUT DROP # \u5173\u6389\u5168\u90e8input\u94fe # \u6ce8\u610f\uff1a\u786e\u4fdd\u89c4\u5219\u987a\u5e8f\u6b63\u786e\uff0c\u5f04\u6e05\u903b\u8f91\u5173\u7cfb\uff0c\u5b66\u4f1a\u65f6\u523b\u4f7f\u7528-vnL \u5173\u4e8e\u7f51\u5173 \u00b6 # \u601d\u8def\uff1a\u641e\u6e05\u7f51\u7edc\u62d3\u6251\uff0c\u672c\u673a\u4e0a\u7f51\uff0c\u8bbe\u7f6enat\u542f\u7528\u8def\u7531\u8f6c\u53d1\uff0c\u5730\u5740\u4f2a\u88c5SNAT/MASQUERADE # ADSL\u62e8\u53f7\u4e0a\u7f51\u7684\u62d3\u6251\u5b9e\u4f8b\u5982\u4e0b echo \"1\" > /proc/sys/net/ipv4/ip_forward # \u5f00\u542f\u8f6c\u53d1 iptables -t nat -A POSTROUTING -s 192 .168.1.0/24 -o eth0 -j MASQUERADE \u9650\u5236\u5185\u7f51\u7528\u6237 \u00b6 # \u601d\u8def\uff1a\u8fc7\u6ee4\u4f4d\u7f6efilter\u8868FORWARD\u94fe\uff0c\u5339\u914d\u6761\u4ef6-s -d -p --s/dport;\u5904\u7406\u52a8\u4f5cACCEPT DROP iptables -A FORWARD -s 192 .168.0.3 -j DROP iptables -A FORWARD -m mac --mac-source 11 :22:33:44:55:66 -j DROP iptables -A FORWARD -d www.baidu.com -j DROP \u5185\u7f51\u505a\u5bf9\u5916\u670d\u52a1\u5668 \u00b6 # \u601d\u8def\uff1a\u670d\u52a1\u534f\u8bae(TCP/UDP)\uff1b\u5bf9\u5916\u670d\u52a1\u7aef\u53e3\uff0c\u5185\u90e8\u670d\u52a1\u5668\u79c1\u7f51IP\uff1b\u5185\u90e8\u771f\u6b63\u670d\u52a1\u7aef\u53e3 iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to 192 .168.1.1 iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 81 -j DNAT --to 192 .168.1.2:80 iptables -I INPUT -s ip -j DROP #\u5c4f\u853d\u6307\u5b9a ip \u8bbf\u95ee iptables -A INPUT -p tcp --dport 2222 -j ACCEPT #\u5141\u8bb8 2222 \u7aef\u53e3\u8bbf\u95ee iptables -A INPUT -p icmp --icmp-type 8 -s 0 /0 -j DROP #\u5c4f\u853d icmp \u534f\u8bae\uff0c\u5373\u5173\u95ed ping \u670d\u52a1 iptables -L -n --line-numbers #\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219\u5e76\u4ee5\u5e8f\u53f7\u663e\u793a iptables -D INPUT 8 #\u5220\u9664\u5e8f\u53f7\u4e3a 8 \u7684\u89c4\u5219 # ip_conntrack: table full, dropping packet\u95ee\u9898\u5904\u7406 iptables -t raw -A PREROUTING -d 1 .2.3.4 -p tcp --dport 80 -j NOTRACK iptables -A FORWARD -m state --state UNTRACKED -j ACCEPT","title":"Iptables"},{"location":"Iptables/#iptables","text":"\u9009\u9879\u8be6\u89e3 iptables\u5de5\u4f5c\u673a\u5236 \u57fa\u672c\u67b6\u6784\u6d41\u7a0b\u56fe \u57fa\u672c\u53c2\u6570 iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f \u9632\u706b\u5899\u7684\u7b56\u7565 \u5b9e\u4f8b \u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570 \u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5 \u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528 \u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219 \u914d\u7f6e\u767d\u540d\u5355 \u5f00\u542f\u76f8\u5e94\u7684\u670d\u52a1\u7aef\u53e3 \u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d \u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219 \u6e05\u9664\u5df2\u6709\u89c4\u5219 \u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3 \u5c4f\u853dIP \u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3 \u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219 \u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219 \u7aef\u53e3\u6620\u5c04 \u5b57\u7b26\u4e32\u5339\u914d \u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb \u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb","title":"iptables"},{"location":"Iptables/#iptables_1","text":"iptables \u8868\u662f\u6309\u7167\u5bf9\u6570\u636e\u5305\u7684\u64cd\u4f5c\u533a\u5206\u7684\uff0c\u94fe\u4e5f\u88ab\u79f0\u4e3a\u94a9\u5b50\u51fd\u6570(hook functions)\u662f\u6309\u7167\u4e0d\u540c\u7684Hook\u51fd\u6570\u6765\u533a\u5206\u7684 \u8868 filter \u8d1f\u8d23\u5305\u8fc7\u6ee4\uff0c\u7528\u4e8e\u9632\u706b\u5899\u89c4\u5219 nat nat\u529f\u80fd(\u7aef\u53e3\u6620\u5c04\uff0c\u5730\u5740\u6620\u5c04,\u7f51\u5173\u8def\u7531\u7b49\uff09 mangle \u8d1f\u8d23IP\u6570\u636e\u5305\u5904\u7406\uff0c\u5982\uff1aTos\uff0c\u670d\u52a1\u7c7b\u578b\u7b49\uff0c\u7528\u4e8e\u5b9e\u73b0\u670d\u52a1\u8d28\u91cf raw \u8d1f\u8d23\u8fde\u63a5\u8ddf\u8e2a,\u5982:\u7f51\u5740\u8fc7\u6ee4 security \u7528\u4e8e\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236(SELinux\u7b49)\u7f51\u7edc\u89c4\u5219 \u94fe\u540d\u89c4\u5219 INPUT \u63a5\u6536\u6570\u636e\u5305 OUTPUT \u8f93\u51fa\u6570\u636e\u5305 FORWARD \u5728\u5185\u6838\u7a7a\u95f4\u4e2d\uff0c\u4ece\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u8fdb\u5165\uff0c\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u53bb\u3002\u8f6c\u53d1\u8fc7\u6ee4 PREROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u8868\u4e4b\u524d(DNAT) POSTROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u9009\u62e9\u4e4b\u540e(SNAT) \u52a8\u4f5c ACCEPT \u63a5\u6536\u6570\u636e\u5305 DROP \u4e22\u5f03\u6570\u636e\u5305 REDIRECT \u91cd\u5b9a\u5411\u3001\u6620\u5c04\u3001\u900f\u660e\u4ee3\u7406 DNAT \u76ee\u6807\u5730\u5740\u8f6c\u6362 SNAT \u6e90\u5730\u5740\u8f6c\u6362 MASQUERADE IP\u4f2a\u88c5\uff08NAT\uff09\uff0c\u7528\u4e8eADSL LOG \u65e5\u5fd7\u8bb0\u5f55 \u4e0b\u8868\u4e3a\uff1a\u4ece\u5de6\u5230\u53f3\u6bcf\u4e2a\u8868(Table)\u53ef\u7528\u7684\u94fe(Chains),\u5f53\u4ece\u4e0a\u5230\u4e0b\u663e\u793a\u5728\u89e6\u53d1\u5173\u8054\u7684netfilter\u6302\u94a9\u65f6\u8c03\u7528\u6bcf\u4e2a\u94fe\u7684\u987a\u5e8f Tables\u2193/Chains\u2192 PREROUTING INPUT FORWARD OUTPUT POSTROUTING (routing decision) \u2713 raw \u2713 \u2713 (connection tracking enabled) \u2713 \u2713 mangle \u2713 \u2713 \u2713 \u2713 \u2713 nat (DNAT) \u2713 \u2713 (routing decision) \u2713 \u2713 filter \u2713 \u2713 \u2713 security \u2713 \u2713 \u2713 nat (SNAT) \u2713 \u2713","title":"iptables\u5de5\u4f5c\u673a\u5236"},{"location":"Iptables/#iptables_2","text":"\u53c2\u8003\u94fe\u63a5 # \u4ee5\u4e0b\u4e3a\u7b80\u6613\u6d41\u7a0b\uff1b\u5927\u591a\u6570\u4f7f\u7528\u60c5\u51b5\u4e0b\u90fd\u4e0d\u4f1a\u7528\u5230raw\uff0cmangle\u548csecurity\u8868\uff1b\u6ce8\u610f\uff1aIPv6\u6ca1\u6709nat \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513 \u2503 Network \u2503 \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b | | \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 table: raw,mangle,nat(destination) \u2502 \u2502 chain: PREROUTING \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | \u25bc \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 route outing decision \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u5224\u65ad\u5f53\u524d\u6570\u636e\u5305\u76ee\u7684IP\u5730\u5740\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 | \u662f\u5426\u4e3a\u672c\u673a\u7f51\u53e3\u7684IP\u5730\u5740 | | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u2502\u76ee\u7684IP\u975e\u672c\u673a\u7f51\u53e3IP | \u2502\u5982\u679c\u672c\u673a\u5f00\u542fIP_forward \u2502 \u76ee\u7684IP\u4e3a\u672c\u5730\u7f51\u53e3IP |\u5219\u6570\u636e\u5305\u8fdb\u5165\u8f6c\u53d1\u6d41\u7a0b \u2502 \u8fdb\u5165\u672c\u673a\u5904\u7406INPUT \u2502 \u2502 \u2502 \u25bc \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 Table:mangle,filter\uff0csecurity | \u2502table: mangle,filter | \u2502 Chain:INPUT \u2502 \u2502chain: FORWARD \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | | | | \u25bc | \u250c \u2510 | \u2502local process\u2502 | \u2514 \u2518 | \u2502 | \u25bc | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | Routing decision \u5224\u65ad\u6570\u636e\u5305\u53d1\u5f80\u54ea\u4e2a\u7f51\u53e3 | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | \u2502 | \u25bc | \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 | \u2502 table: raw,mangle,nat(destination),filter,security \u2502 | \u2502 chain: OUTPUT \u2502 | \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 | \u2502 | | | | | | \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 | +\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 routing decision \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 \u2502 \u2502 \u25bc \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 table: mangle,nat(source) \u2502 \u2502 chain: PREROUTING \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\u6570\u636e\u94fe\u8def\u5c42\u5c01\u88c5\uff0c\u53d1\u9001\u5230\u7f51\u7edc | \u25bc \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513 \u2503 Network \u2503 \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b \u8865\u5145\uff1a`-A` \u4ee3\u8868\u8ffd\u52a0\uff0c`-I` \u4ee3\u8868\u63d2\u5165\uff0c`-D` \u4ee3\u8868\u5220\u6389\uff0c`-R` \u4ee3\u8868\u66ff\u6362\uff0c`-L` \u4ee3\u8868\u5217\u8868\uff0c`-p` \u4ee3\u8868\u534f\u8bae\uff0c`-s` \u4ee3\u8868\u6e90\u5730\u5740\uff0c\u5fc5\u987b\u662f IP \uff0c`-j` \u4ee3\u8868\u52a8\u4f5c\uff0c`-d` \u4ee3\u8868\u76ee\u6807\u5730\u5740\uff0c`-i` \u7f51\u5361\u8fdb\u5165\u662f\u6570\u636e\uff0c`-o` \u4ee3\u8868\u7f51\u5361\u8f93\u51fa\u7684\u6570\u636e iptables\u6ce8\u610f\u4e8b\u9879\uff1a \u4e13\u8868\u4e13\u7528\uff1afilter\u3001nat\u3001mangle\uff1b\u6ce8\u610f\u6570\u636e\u5305\u8d70\u5411\uff1aPREROUTING\u3001INPUT\u3001FORWARD\u3001OUTPUT\u3001POSTROUTING \u6240\u6709\u94fe\u540d\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u8868\u540d\u5fc5\u987b\u5c0f\u5199\uff0c\u6240\u6709\u52a8\u4f5c\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u5339\u914d\u5fc5\u987b\u5c0f\u5199","title":"iptables\u6570\u636e\u5305\u6d41\u7a0b"},{"location":"Iptables/#iptables_3","text":"iptables -t \u8868\u540d <-A/I/D/R> \u89c4\u5219\u94fe\u540d [ \u89c4\u5219\u53f7 ] <-i/o \u7f51\u5361\u540d> -p \u534f\u8bae\u540d <-s \u6e90IP/\u6e90\u5b50\u7f51> --sport \u6e90\u7aef\u53e3 <-d \u76ee\u6807IP/\u76ee\u6807\u5b50\u7f51> --dport \u76ee\u6807\u7aef\u53e3 -j \u52a8\u4f5c","title":"iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f"},{"location":"Iptables/#_1","text":"\u53c2\u6570 \u4f5c\u7528 -P \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565:iptables -P INPUT (DROP -F \u6e05\u7a7a\u89c4\u5219\u94fe -L \u67e5\u770b\u89c4\u5219\u94fe -A \u5728\u89c4\u5219\u94fe\u7684\u672b\u5c3e\u52a0\u5165\u65b0\u89c4\u5219 -I num \u5728\u89c4\u5219\u94fe\u7684\u5934\u90e8\u52a0\u5165\u65b0\u89c4\u5219 -D num \u5220\u9664\u67d0\u4e00\u6761\u89c4\u5219 -s \u5339\u914d\u6765\u6e90\u5730\u5740IP/MASK\uff0c\u52a0\u53f9\u53f7\"!\"\u8868\u793a\u9664\u8fd9\u4e2aIP\u5916\u3002 -d \u5339\u914d\u76ee\u6807\u5730\u5740 -i \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u5165\u7684\u6570\u636e -o \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u51fa\u7684\u6570\u636e -p \u5339\u914d\u534f\u8bae,\u5982tcp,udp,icmp --dport num \u5339\u914d\u76ee\u6807\u7aef\u53e3\u53f7 --sport num \u5339\u914d\u6765\u6e90\u7aef\u53e3\u53f7 # \u901a\u7528\u5339\u914d\uff1a\u6e90\u5730\u5740\u76ee\u6807\u5730\u5740\u7684\u5339\u914d -t,--table table --->\uff1a\u5bf9\u6307\u5b9a\u7684\u8868 table \u8fdb\u884c\u64cd\u4f5c\uff0c table \u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u6b64\u9009\u9879\uff0c\u9ed8\u8ba4\u7684\u662f filter \u8868 -p --->\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662fTCP\u3001UDP\u3001ICMP\u7b49 # \u6309\u7167\u6765\u6e90\u76ee\u7684\u5730\u5740\u5339\u914d\uff0c\u53ef\u4ee5\u662fIP\u3001NET\u3001DOMAIN\uff0c\u4e5f\u53ef\u4e3a\u7a7a -s, --source [ ! ] address [ /mask ] --->\uff1a\u5339\u914d\u6765\u6e90\u5730\u5740\uff1b\u628a\u6307\u5b9a\u7684\u4e00\u4e2a\uff0f\u4e00\u7ec4\u5730\u5740\u4f5c\u4e3a\u6e90\u5730\u5740\uff0c\u6309\u6b64\u89c4\u5219\u8fdb\u884c\u8fc7\u6ee4\u3002\u5f53\u540e\u9762\u6ca1\u6709 mask \u65f6\uff0caddress \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.1\uff1b\u5f53 mask \u6307\u5b9a\u65f6\uff0c\u53ef\u4ee5\u8868\u793a\u4e00\u7ec4\u8303\u56f4\u5185\u7684\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.0/255.255.255.0 -d, --destination [ ! ] address [ /mask ] --->\uff1a\u5339\u914d\u76ee\u7684\u5730\u5740\uff1b\u5730\u5740\u683c\u5f0f\u540c\u4e0a\uff0c\u4f46\u8fd9\u91cc\u662f\u6307\u5b9a\u5730\u5740\u4e3a\u76ee\u7684\u5730\u5740\uff0c\u6309\u6b64\u8fdb\u884c\u8fc7\u6ee4 # \u6309\u7167\u7f51\u7edc\u63a5\u53e3\u5339\u914d -i, --in-interface [ ! ] <\u7f51\u7edc\u63a5\u53e3name> --->\uff1a\u5339\u914d\u6570\u636e\u8fdb\u5165\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u7684\u6765\u81ea\u6765\u81ea\u7f51\u7edc\u63a5\u53e3\uff0c\u6bd4\u5982\u6700\u5e38\u89c1\u7684 eth0 \u3002\u6ce8\u610f\uff1a\u5b83\u53ea\u5bf9 INPUT\uff0cFORWARD\uff0cPREROUTING \u8fd9\u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6b64\u9009\u9879\uff0c \u8bf4\u660e\u53ef\u4ee5\u6765\u81ea\u4efb\u4f55\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002\u540c\u524d\u9762\u7c7b\u4f3c\uff0c \"!\" \u8868\u793a\u53d6\u53cd -o, --out-interface [ ! ] <\u7f51\u7edc\u63a5\u53e3name> --->\uff1a\u5339\u914d\u6570\u636e\u6d41\u51fa\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3\u3002\u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528 # \u6309\u7aef\u53e3\u5339\u914d\uff0c--sport\u548c--dport\u5fc5\u987b\u914d\u5408-p\u53c2\u6570\u4f7f\u7528\uff0c\u4e14\u5fc5\u987b\u6307\u660e\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u4e2a\u522b\u7aef\u53e3\u6216\u7aef\u53e3\u8303\u56f4 --sport <\u5339\u914d\u6e90\u7aef\u53e3> --dport <\u5339\u914d\u76ee\u7684\u7aef\u53e3> # \u67e5\u770b\u7ba1\u7406\u547d\u4ee4 -L, --list [ chain ] \u5217\u51fa\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u5217\u51fa\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1bv:\u663e\u793a\u6bcf\u6761\u89c4\u5219\u7684\u5339\u914d\u5305\u6570\u91cf\u548c\u5339\u914d\u5b57\u8282\u6570\uff1bx:\u5728v\u9009\u9879\u57fa\u7840\u4e0a\u7981\u6b62\u81ea\u52a8\u5355\u4f4d\u6362\u7b97 ( K\u3001M ) ; n:\u53ea\u663e\u793aIP\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4e0d\u663e\u793a\u57df\u540d\u548c\u670d\u52a1\u540d\u79f0 # \u89c4\u5219\u7ba1\u7406\u547d\u4ee4 -A, --append chain rule-specification --->\uff1a\u5728\u6307\u5b9a\u94fe chain \u7684\u672b\u5c3e\u63d2\u5165\u6307\u5b9a\u7684\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u6761\u89c4\u5219\u4f1a\u88ab\u653e\u5230\u6700\u540e\uff0c\u6700\u540e\u624d\u4f1a\u88ab\u6267\u884c\u3002\u89c4\u5219\u662f\u7531\u540e\u9762\u7684\u5339\u914d\u6765\u6307\u5b9a -I, --insert chain [ rulenum ] rule-specification --->\uff1a\u5728\u94fechain\u4e2d\u7684\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u6761\u6216\u591a\u6761\u89c4\u5219\u3002\u9ed8\u8ba4\u89c4\u5219\u53f7\u662f1\uff0c\u8868\u793a\u5728\u94fe\u7684\u5934\u90e8\u63d2\u5165\u3002\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264 ( \u5df2\u6709\u89c4\u5219\u6570+1 ) \uff0c\u5426\u5219\u62a5\u9519 -D, --delete chain rule-specification -D, --delete chain rulenum --->\uff1a\u5728\u6307\u5b9a\u7684\u94fe chain \u4e2d\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u5b9a\u89c4\u5219\u6216\u6307\u5b9a\u89c4\u5219\u53f7\u3002\u82e5\u89c4\u5219\u5217\u8868\u6709\u591a\u6761\u76f8\u540c\u89c4\u5219\uff0c\u5219\u6309\u5185\u5bb9\u5339\u914d\u53ea\u5220\u9664\u5e8f\u53f7\u6700\u5c0f\u4e00\u6761\uff1b\u6309\u53f7\u7801\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519\uff1b\u6309\u5185\u5bb9\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u5b58\u5728\uff0c\u5426\u5219\u62a5\u9519 -R num --->\uff1aReplays\u66ff\u6362/\u4fee\u6539\u7b2c\u51e0\u6761\u89c4\u5219\uff1b\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519 # \u94fe\u7ba1\u7406\u547d\u4ee4\uff08\u8fd9\u90fd\u662f\u7acb\u5373\u751f\u6548\u7684\uff09 -P, --policy chain target --->\uff1a\u4e3a\u6307\u5b9a\u7684\u94fechain\u8bbe\u7f6e\u7b56\u7565 target\u3002\u6ce8\u610f\uff0c\u53ea\u6709\u5185\u7f6e\u7684\u94fe\u624d\u5141\u8bb8\u6709\u7b56\u7565\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u662f\u4e0d\u5141\u8bb8\u7684\u3002\u5f53\u6570\u636e\u5305\u6ca1\u6709\u88ab\u89c4\u5219\u5217\u8868\u7684\u4efb\u4f55\u89c4\u5219\u76f8\u5339\u914d\uff0c\u5219\u6309\u9ed8\u8ba4\u89c4\u5219\u5904\u7406\uff0c\u52a8\u4f5c\u524d\u4e0d\u80fd\u52a0-j\uff0c\u4e5f\u662f\u552f\u4e00\u5339\u914d\u52a8\u4f5c\u524d\u4e0d\u52a0-j\u9009\u62e9\u7684\u60c5\u51b5 -F, --flush [ chain ] --->\uff1a\u6e05\u7a7a\u6307\u5b9a\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u6e05\u7a7a\u8be5\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1b-F\u4ec5\u4ec5\u6e05\u7a7a\u94fe\u4e2d\u89c4\u5219\uff0c\u4e0d\u5f71\u54cd-P\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u89c4\u5219\uff1b-P\u8bbe\u7f6e\u4e86DROP\u540e\uff0c\u4f7f\u7528-F\u4f1a\u5c06\u5176\u6e05\u9664\u6389 -N, --new-chain chain --->\uff1a\u7528\u6307\u5b9a\u7684\u540d\u5b57\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u94fe -X, --delete-chain [ chain ] --->\uff1a\u5220\u9664\u6307\u5b9a\u7684\u94fe\uff0c\u8fd9\u4e2a\u94fe\u5fc5\u987b\u6ca1\u6709\u88ab\u5176\u5b83\u4efb\u4f55\u89c4\u5219\u5f15\u7528\uff0c\u800c\u4e14\u8fd9\u6761\u4e0a\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\u540d\uff0c\u5219\u4f1a\u5220\u9664\u8be5\u8868\u4e2d\u6240\u6709\u975e\u5185\u7f6e\u7684\u94fe -E, --rename-chain old-chain new-chain --->\uff1a\u7528\u6307\u5b9a\u7684\u65b0\u540d\u5b57\u53bb\u91cd\u547d\u540d\u6307\u5b9a\u7684\u94fe\u3002\u8fd9\u5e76\u4e0d\u4f1a\u5bf9\u94fe\u5185\u90e8\u7167\u6210\u4efb\u4f55\u5f71\u54cd -Z, --zero [ chain ] --->\uff1a\u628a\u6307\u5b9a\u94fe\uff0c\u6216\u8005\u8868\u4e2d\u7684\u6240\u6709\u94fe\u4e0a\u7684\u6240\u6709\u8ba1\u6570\u5668\u6e05\u96f6 -j, --jump target <\u6307\u5b9a\u76ee\u6807> --->\uff1a\u5373\u6ee1\u8db3\u67d0\u6761\u4ef6\u65f6\u8be5\u6267\u884c\u4ec0\u4e48\u6837\u7684\u52a8\u4f5c\u3002target \u53ef\u4ee5\u662f\u5185\u7f6e\u7684\u76ee\u6807\uff0c\u6bd4\u5982 ACCEPT\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u94fe # iptables\u5177\u4f53<\u52a8\u4f5c>\u8be6\u89e3\uff1aACCEPT\u3001DROP\u3001SNAT\u3001DNAT\u3001MASQUERADE -j ACCEPT # \u5141\u8bb8\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684permit) -j DROP # \u963b\u6b62\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe\u800c\u4e22\u5f03\u5b83(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684deny) -j DNAT --to IP [ -IP ][ :\u7aef\u53e3-\u7aef\u53e3 ]( nat\u8868\u7684PREROUTING\u94fe ) # \u76ee\u7684\u5730\u5740\u8f6c\u6362\uff0cDNAT\u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP\u5730\u5740\u6c60(\u4e00\u7ec4\u8fde\u7eed\u7684IP\u5730\u5740) -j SNAT --to IP [ -IP ][ :\u7aef\u53e3-\u7aef\u53e3 ] \uff08nat\u8868\u7684POSTROUTING \u94fe\uff09# \u6e90\u5730\u5740\u8f6c\u6362\uff0cSNAT \u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP \u5730\u5740\u6c60 ( \u4e00\u7ec4\u8fde\u7eed\u7684IP \u5730\u5740 ) -j MASQUERADE # \u52a8\u6001\u6e90\u5730\u5740\u8f6c\u6362(\u52a8\u6001IP\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528) # \u9644\u52a0\u6a21\u5757 \u6309\u5305\u72b6\u6001\u5339\u914d---- ( state ) \u6309\u6765\u6e90MAC \u5339\u914d-- ( mac ) \u6309\u5305\u901f\u7387\u5339\u914d---- ( limit ) \u591a\u7aef\u53e3\u5339\u914d------ ( multiport ) -m state --state \u72b6\u6001 # \u72b6\u6001\uff1aNEW\u3001RELATED\u3001ESTABLISHED\u3001INVALID NEW\uff1a\u6709\u522b\u4e8etcp\u7684syn ESTABLISHED\uff1a\u8fde\u63a5\u6001 RELATED\uff1a\u884d\u751f\u6001\uff0c\u4e0econntrack \u5173\u8054\uff08FTP\uff09 INVALID\uff1a\u4e0d\u80fd\u88ab\u8bc6\u522b\u5c5e\u4e8e\u54ea\u4e2a\u8fde\u63a5\u6216\u6ca1\u6709\u4efb\u4f55\u72b6\u6001 -m mac --mac-source MAC # \u5339\u914d\u67d0\u4e2aMAC \u5730\u5740\u3002\u62a5\u6587\u7ecf\u8fc7\u8def\u7531\u540e\uff0c\u6570\u636e\u5305\u4e2d\u539f\u6709\u7684mac \u4fe1\u606f\u4f1a\u88ab\u66ff\u6362\uff0c\u6240\u4ee5\u5728\u8def\u7531\u540e\u7684iptables \u4e2d\u4f7f\u7528mac \u6a21\u5757\u662f\u6ca1\u6709\u610f\u4e49\u7684 -m limit --limit \u5339\u914d\u901f\u7387 [ --burst \u7f13\u51b2\u6570\u91cf ] # \u7528\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u6570\u636e\u5305\u3002limit \u82f1\u8bed\u4e0a\u770b\u662f\u9650\u5236\u7684\u610f\u601d\uff0c\u4f46\u5b9e\u9645\u4e0a\u53ea\u662f\u6309\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u800c\u5df2\uff0c\u8981\u60f3\u9650\u5236\u7684\u8bdd\u540e\u9762\u8981\u518d\u8ddf\u4e00\u6761DROP -m multiport <--sports | --dports | --ports> \u7aef\u53e31 [ ,\u7aef\u53e32,..,\u7aef\u53e3n ] # \u4e00\u6b21\u6027\u5339\u914d\u591a\u4e2a\u7aef\u53e3\uff0c\u53ef\u4ee5\u533a\u5206\u6e90\u7aef\u53e3\uff0c\u76ee\u7684\u7aef\u53e3\u6216\u4e0d\u6307\u5b9a\u7aef\u53e3\u3002\u5fc5\u987b\u4e0e-p \u53c2\u6570\u4e00\u8d77\u4f7f\u7528 man iptables-extensions\u4e2d\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684\u652f\u6301\u7684module ; iptables-extensions\u7531\u591a\u4e2amach module\u548c\u591a\u4e2atarget module\u7ec4\u6210\uff0c\u6bcf\u4e2amodule\u90fd\u6709\u81ea\u5df1\u7684\u53c2\u6570","title":"\u57fa\u672c\u53c2\u6570"},{"location":"Iptables/#_2","text":"\u9632\u706b\u5899\u7b56\u7565\u4e00\u822c\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u53eb \u901a \u7b56\u7565\uff0c\u4e00\u79cd\u53eb \u5835 \u7b56\u7565\uff0c\u901a\u7b56\u7565\uff0c\u9ed8\u8ba4\u95e8\u662f\u5173\u7740\u7684\uff0c\u5fc5\u987b\u8981\u5b9a\u4e49\u8c01\u80fd\u8fdb\u3002\u5835\u7b56\u7565\u5219\u662f\uff0c\u5927\u95e8\u662f\u6d1e\u5f00\u7684\uff0c\u4f46\u662f\u4f60\u5fc5\u987b\u6709\u8eab\u4efd\u8ba4\u8bc1\uff0c\u5426\u5219\u4e0d\u80fd\u8fdb\uff0c \u6240\u4ee5\u901a\uff0c\u662f\u8981\u5168\u901a\uff0c\u800c\u5835\uff0c\u5219\u662f\u8981\u9009\u62e9 \u3002\u5f53\u6211\u4eec\u5b9a\u4e49\u7684\u7b56\u7565\u7684\u65f6\u5019\uff0c\u8981\u5206\u522b\u5b9a\u4e49\u591a\u6761\u529f\u80fd\uff0c\u5176\u4e2d\uff1a\u5b9a\u4e49\u6570\u636e\u5305\u4e2d\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\u7b56\u7565\uff0cfilter\u8fc7\u6ee4\u7684\u529f\u80fd\uff0c\u800c\u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\u529f\u80fd\u7684\u5219\u662fnat\u9009\u9879\u3002\u4e3a\u4e86\u8ba9\u8fd9\u4e9b\u529f\u80fd\u4ea4\u66ff\u5de5\u4f5c\uff0c\u6211\u4eec\u5236\u5b9a\u51fa\u4e86\u201c\u8868\u201d\u8fd9\u4e2a\u5b9a\u4e49\uff0c\u6765\u5b9a\u4e49\u3001\u533a\u5206\u5404\u79cd\u4e0d\u540c\u7684\u5de5\u4f5c\u529f\u80fd\u548c\u5904\u7406\u65b9\u5f0f\u3002 \u6211\u4eec\u73b0\u5728\u7528\u7684\u6bd4\u8f83\u591a\u7684\u529f\u80fd\u67093\u4e2a\uff1a filter \u5b9a\u4e49\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\uff0c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT nat \u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\uff0c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING mangle\u529f\u80fd:\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\uff0c\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING \u6211\u4eec\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\u5c31\u662f\u6765\u4fee\u6539TTL\u7684\u3002\u80fd\u591f\u5b9e\u73b0\u5c06\u6570\u636e\u5305\u7684\u5143\u6570\u636e\u62c6\u5f00\uff0c\u5728\u91cc\u9762\u505a\u6807\u8bb0/\u4fee\u6539\u5185\u5bb9\u7684\u3002\u800c\u9632\u706b\u5899\u6807\u8bb0\uff0c\u5176\u5b9e\u5c31\u662f\u9760mangle\u6765\u5b9e\u73b0\u7684\u3002 \u5c0f\u6269\u5c55: \u5bf9\u4e8efilter\u6765\u8bb2\u4e00\u822c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT \u5bf9\u4e8enat\u6765\u8bb2\u4e00\u822c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING \u800cmangle\u5219\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING iptables/netfilter\uff08\u8fd9\u6b3e\u8f6f\u4ef6\uff09\u662f\u5de5\u4f5c\u5728\u7528\u6237\u7a7a\u95f4\u7684\uff0c\u5b83\u53ef\u4ee5\u8ba9\u89c4\u5219\u8fdb\u884c\u751f\u6548\u7684\uff0c\u672c\u8eab\u4e0d\u662f\u4e00\u79cd\u670d\u52a1\uff0c\u800c\u4e14\u89c4\u5219\u662f\u7acb\u5373\u751f\u6548\u7684\u3002\u800c\u6211\u4eeciptables\u73b0\u5728\u88ab\u505a\u6210\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u542f\u52a8\uff0c\u505c\u6b62\u7684\u3002\u542f\u52a8\uff0c\u5219\u5c06\u89c4\u5219\u76f4\u63a5\u751f\u6548\uff0c\u505c\u6b62\uff0c\u5219\u5c06\u89c4\u5219\u64a4\u9500\u3002 iptables\u8fd8\u652f\u6301\u81ea\u5df1\u5b9a\u4e49\u94fe\u3002\u4f46\u662f\u81ea\u5df1\u5b9a\u4e49\u7684\u94fe\uff0c\u5fc5\u987b\u662f\u8ddf\u67d0\u79cd\u7279\u5b9a\u7684\u94fe\u5173\u8054\u8d77\u6765\u7684\u3002\u5728\u4e00\u4e2a\u5173\u5361\u8bbe\u5b9a\uff0c\u6307\u5b9a\u5f53\u6709\u6570\u636e\u7684\u65f6\u5019\u4e13\u95e8\u53bb\u627e\u67d0\u4e2a\u7279\u5b9a\u7684\u94fe\u6765\u5904\u7406\uff0c\u5f53\u90a3\u4e2a\u94fe\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u518d\u8fd4\u56de\u3002\u63a5\u7740\u5728\u7279\u5b9a\u7684\u94fe\u4e2d\u7ee7\u7eed\u68c0\u67e5\u3002 \u6ce8\u610f\uff1a\u89c4\u5219\u7684\u6b21\u5e8f\u975e\u5e38\u5173\u952e\uff0c \u8c01\u7684\u89c4\u5219\u8d8a\u4e25\u683c\uff0c\u5e94\u8be5\u653e\u7684\u8d8a\u9760\u524d \uff0c\u800c\u68c0\u67e5\u89c4\u5219\u7684\u65f6\u5019\uff0c\u662f\u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u67e5\u7684","title":"\u9632\u706b\u5899\u7684\u7b56\u7565"},{"location":"Iptables/#_3","text":"# \u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d,\u4efb\u4f55\u6539\u52a8\u4e4b\u524d\u5148\u5907\u4efd\uff0c\u8bf7\u4fdd\u6301\u8fd9\u4e00\u4f18\u79c0\u7684\u4e60\u60ef cp /etc/sysconfig/iptables /etc/sysconfig/iptables.bak iptables-save > /etc/sysconfig/iptables # \u6e05\u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570 iptables -F # \u6e05\u7a7a\u6240\u6709\u7684\u9632\u706b\u5899\u89c4\u5219 iptables -X # \u5220\u9664\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7a7a\u94fe iptables -Z # \u6e05\u7a7a\u8ba1\u6570 iptables -A INPUT -s 192 .168.1.0/24 -p tcp --dport 22 -j ACCEPT # \u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5,22\u4e3a\u4f60\u7684ssh\u7aef\u53e3\uff0c -s 192.168.1.0/24\u8868\u793a\u5141\u8bb8\u8fd9\u4e2a\u7f51\u6bb5\u7684\u673a\u5668\u6765\u8fde\u63a5\uff0c\u5176\u5b83\u7f51\u6bb5\u7684ip\u5730\u5740\u662f\u767b\u9646\u4e0d\u4e86\u4f60\u7684\u673a\u5668\u7684\u3002 -j ACCEPT\u8868\u793a\u63a5\u53d7\u8fd9\u6837\u7684\u8bf7\u6c42 # \u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528;\u672c\u5730\u56de\u73af\u5730\u5740\u5c31\u662f\u90a3\u4e2a127.0.0.1\uff0c\u662f\u672c\u673a\u4e0a\u4f7f\u7528\u7684,\u5b83\u8fdb\u4e0e\u51fa\u90fd\u8bbe\u7f6e\u4e3a\u5141\u8bb8 iptables -A INPUT -i lo -j ACCEPT iptables -A OUTPUT -o lo -j ACCEPT # \u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219 iptables -P INPUT DROP # \u914d\u7f6e\u9ed8\u8ba4\u4e0d\u8ba9\u8fdb iptables -P FORWARD DROP # \u9ed8\u8ba4\u4e0d\u5141\u8bb8\u8f6c\u53d1 iptables -P OUTPUT ACCEPT # \u9ed8\u8ba4\u53ef\u4ee5\u51fa\u53bb # \u914d\u7f6e\u767d\u540d\u5355;\u9ed1\u540d\u5355\u5c31\u662f\u540e\u9762\u6362\u6210DROP iptables -A INPUT -p all -s 192 .168.1.0/24 -j ACCEPT # \u5141\u8bb8192.168.1.0\u7f51\u6bb5\u4e92\u76f8\u53ef\u4ee5\u8bbf\u95ee iptables -A INPUT -m mac --mac-source 00 :00:00:00:00:00 -j ACCEPT # \u5141\u8bb8mac\u5730\u5740\u4e3a00:00:00:00:00:00\u8bbf\u95ee iptables -A INPUT -p tcp -s 183 .121.3.7 --dport 3380 -j ACCEPT # \u5141\u8bb8183.121.3.7\u8bbf\u95ee\u672c\u673a\u76843380\u7aef\u53e3 iptables -A INPUT -p tcp -m multiport --dports 22 ,80,443 -j ACCEPT # \u5f00\u542f22,80,443\u7aef\u53e3 iptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT # \u5141\u8bb8\u88abping iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u5df2\u5efa\u7acb\u7684\u6216\u76f8\u5173\u8fde\u63a5\u7684\u901a\u884c # \u7981\u6b62\u5176\u4ed6\u672a\u5141\u8bb8\u7684\u89c4\u5219\u8bbf\u95ee iptables -A INPUT -j REJECT iptables -A FORWARD -j REJECT iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 25 -j REDIRECT --to-port 2525 # \u672c\u573025\u7aef\u53e3\u8f6c\u53d1\u52302525 iptables -A INPUT -p tcp --dport 80 -m limit --limit 100 /minute --limit-burst 200 -j ACCEPT # \u9650\u5236\u8fde\u63a5\u901f\u7387\uff0c\u6bcf\u5206\u949f100\u4e2a\uff0c\u4e0a\u9650200 iptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 3 -j REJECT # \u9650\u523622\u7aef\u53e3\u5e76\u53d1\u8fde\u63a5 # \u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219 iptables -L [ -t \u8868\u540d ] [ \u94fe\u540d ] - \u56db\u4e2a\u8868\u540d ` raw ` \uff0c ` nat ` \uff0c ` filter ` \uff0c ` mangle ` - \u4e94\u4e2a\u89c4\u5219\u94fe\u540d ` INPUT ` \u3001 ` OUTPUT ` \u3001 ` FORWARD ` \u3001 ` PREROUTING ` \u3001 ` POSTROUTING ` - filter\u8868\u5305\u542b ` INPUT ` \u3001 ` OUTPUT ` \u3001 ` FORWARD ` \u4e09\u4e2a\u89c4\u5219\u94fe ``` bash iptables -L -t nat # \u5217\u51fa nat \u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219 # ^ -t \u53c2\u6570\u6307\u5b9a\uff0c\u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a iptables -L -t nat --line-numbers # \u89c4\u5219\u5e26\u7f16\u53f7 iptables -L INPUT iptables -L -nv # \u67e5\u770b\uff0c\u8fd9\u4e2a\u5217\u8868\u770b\u8d77\u6765\u66f4\u8be6\u7ec6","title":"\u5b9e\u4f8b"},{"location":"Iptables/#_4","text":"# \u6dfb\u52a0\u4e00\u6761\u89c4\u5219 iptables -A INPUT -s 192 .168.1.5 -j DROP \u5c06\u6240\u6709iptables\u4ee5\u5e8f\u53f7\u6807\u8bb0\u663e\u793a\uff0c\u6267\u884c\uff1a iptables -L -n --line-numbers \u6bd4\u5982\u8981\u5220\u9664INPUT\u91cc\u5e8f\u53f7\u4e3a8\u7684\u89c4\u5219\uff0c\u6267\u884c\uff1a iptables -D INPUT 8","title":"\u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219"},{"location":"Iptables/#_5","text":"","title":"\u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3"},{"location":"Iptables/#ip","text":"iptables -A INPUT -p tcp -m tcp -s 192 .168.0.8 -j DROP # \u5c4f\u853d\u6076\u610f\u4e3b\u673a\uff08\u6bd4\u5982\uff0c192.168.0.8 iptables -I INPUT -s 123 .45.6.7 -j DROP #\u5c4f\u853d\u5355\u4e2aIP\u7684\u547d\u4ee4 iptables -I INPUT -s 123 .0.0.0/8 -j DROP #\u5c01\u6574\u4e2a\u6bb5\u5373\u4ece123.0.0.1\u5230123.255.255.254\u7684\u547d\u4ee4 iptables -I INPUT -s 124 .45.0.0/16 -j DROP #\u5c01IP\u6bb5\u5373\u4ece123.45.0.1\u5230123.45.255.254\u7684\u547d\u4ee4 iptables -I INPUT -s 123 .45.6.0/24 -j DROP #\u5c01IP\u6bb5\u5373\u4ece123.45.6.1\u5230123.45.6.254\u7684\u547d\u4ee4\u662f","title":"\u5c4f\u853dIP"},{"location":"Iptables/#_6","text":"\u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\u3002 iptables -A FORWARD -o eth0","title":"\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3"},{"location":"Iptables/#_7","text":"iptables -L -n -v Chain INPUT ( policy DROP 48106 packets, 2690K bytes ) pkts bytes target prot opt in out source destination 5075 589K ACCEPT all -- lo * 0 .0.0.0/0 0 .0.0.0/0 191K 90M ACCEPT tcp -- * * 0 .0.0.0/0 0 .0.0.0/0 tcp dpt:22 1499K 133M ACCEPT tcp -- * * 0 .0.0.0/0 0 .0.0.0/0 tcp dpt:80 4364K 6351M ACCEPT all -- * * 0 .0.0.0/0 0 .0.0.0/0 state RELATED,ESTABLISHED 6256 327K ACCEPT icmp -- * * 0 .0.0.0/0 0 .0.0.0/0 Chain FORWARD ( policy ACCEPT 0 packets, 0 bytes ) pkts bytes target prot opt in out source destination Chain OUTPUT ( policy ACCEPT 3382K packets, 1819M bytes ) pkts bytes target prot opt in out source destination 5075 589K ACCEPT all -- * lo 0 .0.0.0/0 0 .0.0.0/0","title":"\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219"},{"location":"Iptables/#_8","text":"\u516c\u7f51 210 . 14 . 67 . 7 \u8ba9\u5185\u7f51 192 . 168 . 188 . 0 / 24 \u4e0a\u7f51 iptables -t nat -A POSTROUTING -s 192 .168.188.0/24 -j SNAT --to-source 210 .14.67.127","title":"\u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219"},{"location":"Iptables/#_9","text":"\u672c\u673a\u7684 2222 \u7aef\u53e3\u6620\u5c04\u5230\u5185\u7f51 \u865a\u62df\u673a\u768422 \u7aef\u53e3 iptables -t nat -A PREROUTING -d 210 .14.67.127 -p tcp --dport 2222 -j DNAT --to-dest 192 .168.188.115:22","title":"\u7aef\u53e3\u6620\u5c04"},{"location":"Iptables/#_10","text":"\u6bd4\u5982\uff0c\u6211\u4eec\u8981\u8fc7\u6ee4\u6240\u6709TCP\u8fde\u63a5\u4e2d\u7684\u5b57\u7b26\u4e32 test \uff0c\u4e00\u65e6\u51fa\u73b0\u5b83\u6211\u4eec\u5c31\u7ec8\u6b62\u8fd9\u4e2a\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a iptables -A INPUT -p tcp -m string --algo kmp --string \"test\" -j REJECT --reject-with tcp-reset iptables -L # Chain INPUT (policy ACCEPT) # target prot opt source destination # REJECT tcp -- anywhere anywhere STRING match \"test\" ALGO name kmp TO 65535 reject-with tcp-reset # # Chain FORWARD (policy ACCEPT) # target prot opt source destination # # Chain OUTPUT (policy ACCEPT) # target prot opt source destination","title":"\u5b57\u7b26\u4e32\u5339\u914d"},{"location":"Iptables/#windows","text":"iptables -I INPUT -j DROP -p tcp -s 0 .0.0.0/0 -m string --algo kmp --string \"cmd.exe\"","title":"\u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb"},{"location":"Iptables/#syn","text":"iptables -A INPUT -p tcp --syn -m limit --limit 5 /second -j ACCEPT","title":"\u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb"},{"location":"Iptables/#_11","text":"# \u7528iptables\u642d\u5efa\u4e00\u5957\u5f3a\u5927\u7684\u5b89\u5168\u9632\u62a4\u76fe http://www.imooc.com/learn/389 iptables: linux \u4e0b\u5e94\u7528\u5c42\u9632\u706b\u5899\u5de5\u5177 iptables 5\u94fe: \u5bf9\u5e94 Hook point netfilter: linux \u64cd\u4f5c\u7cfb\u7edf\u6838\u5fc3\u5c42\u5185\u90e8\u7684\u4e00\u4e2a\u6570\u636e\u5305\u5904\u7406\u6a21\u5757 Hook point: \u6570\u636e\u5305\u5728 netfilter \u4e2d\u7684\u6302\u8f7d\u70b9 ; ` PRE_ROUTING / INPUT / OUTPUT / FORWARD / POST_ROUTING ` iptables & netfilter ! []( http://7xq89b.com1.z0.glb.clouddn.com/netfilter & iptables.jpg ) iptables 4\u88685\u94fe ! []( http://7xq89b.com1.z0.glb.clouddn.com/iptables-data-stream.jpg ) iptables rules ! []( http://7xq89b.com1.z0.glb.clouddn.com/iptables-rules.jpg ) - 4\u8868 **filter**: \u8bbf\u95ee\u63a7\u5236 / \u89c4\u5219\u5339\u914d **nat**: \u5730\u5740\u8f6c\u53d1 mangle / raw - \u89c4\u5219 \u6570\u636e\u8bbf\u95ee\u63a7\u5236: ACCEPT / DROP / REJECT \u6570\u636e\u5305\u6539\u5199 ( nat -> \u5730\u5740\u8f6c\u6362 ) : snat / dnat \u4fe1\u606f\u8bb0\u5f55: log ## \u4f7f\u7528\u573a\u666f\u5b9e\u4f8b - \u573a\u666f\u4e00 \u5f00\u653e tcp 10 -22/80 \u7aef\u53e3 \u5f00\u653e icmp \u5176\u4ed6\u672a\u88ab\u5141\u8bb8\u7684\u7aef\u53e3\u7981\u6b62\u8bbf\u95ee \u5b58\u5728\u7684\u95ee\u9898: \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u672c\u673a ; \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u5176\u4ed6\u4e3b\u673a - \u573a\u666f\u4e8c ftp: \u9ed8\u8ba4\u88ab\u52a8\u6a21\u5f0f ( \u670d\u52a1\u5668\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u544a\u8bc9\u5ba2\u6237\u7aef, \u5ba2\u6237\u7aef\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u62c9\u53d6\u6570\u636e ) vsftpd: \u4f7f ftp \u652f\u6301\u4e3b\u52a8\u6a21\u5f0f ( \u5ba2\u6237\u7aef\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u901a\u77e5\u670d\u52a1\u5668, \u670d\u52a1\u5668\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u53d1\u9001\u6570\u636e ) - \u573a\u666f\u4e09 \u5141\u8bb8\u5916\u7f51\u8bbf\u95ee: web http -> 80 /tcp ; https -> 443 /tcp mail smtp -> 25 /tcp ; smtps -> 465 /tcp pop3 -> 110 /tcp ; pop3s -> 995 /tcp imap -> 143 /tcp \u5185\u90e8\u4f7f\u7528: file nfs -> 123 /udp samba -> 137 /138/139/445/tcp ftp -> 20 /21/tcp remote ssh -> 22 /tcp sql mysql -> 3306 /tcp oracle -> 1521 /tcp - \u573a\u666f\u56db nat \u8f6c\u53d1 - \u573a\u666f\u4e94 \u9632CC\u653b\u51fb iptables -L -F -A -D # list flush append delete # \u573a\u666f\u4e00 iptables -I INPUT -p tcp --dport 80 -j ACCEPT # \u5141\u8bb8 tcp 80 \u7aef\u53e3 iptables -I INPUT -p tcp --dport 10 :22 -j ACCEPT # \u5141\u8bb8 tcp 10-22 \u7aef\u53e3 iptables -I INPUT -p icmp -j ACCEPT # \u5141\u8bb8 icmp iptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709 # \u4f18\u5316\u573a\u666f\u4e00 iptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51 iptables -I INPUT -p tcp --dport 80 -s 10 .10.188.233 -j ACCEPT # \u53ea\u5141\u8bb8\u56fa\u5b9aip\u8bbf\u95ee80 # \u573a\u666f\u4e8c vi /etc/vsftpd/vsftpd.conf # \u4f7f\u7528 vsftpd \u5f00\u542f ftp \u4e3b\u52a8\u6a21\u5f0f port_enable = yes connect_from_port_20 = YES iptables -I INPUT -p tcp --dport 21 -j ACCEPT vi /etc/vsftpd/vsftpd.conf # \u5efa\u8bae\u4f7f\u7528 ftp \u88ab\u52a8\u6a21\u5f0f pasv_min_port = 50000 pasv_max_port = 60000 iptables -I INPUT -p tcp --dport 21 -j ACCEPT iptables -I INPUT -p tcp --dport 50000 :60000 -j ACCEPT # \u8fd8\u53ef\u4ee5\u4f7f\u7528 iptables \u6a21\u5757\u8ffd\u8e2a\u6765\u81ea\u52a8\u5f00\u53d1\u5bf9\u5e94\u7684\u7aef\u53e3 # \u573a\u666f\u4e09 iptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee iptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51 iptables -I INPUT -s 10 .10.155.0/24 -j ACCEPT # \u5141\u8bb8\u5185\u7f51\u8bbf\u95ee iptables -I INPUT -p tcp -m multiport --dports 80 ,1723 -j ACCEPT # \u5141\u8bb8\u7aef\u53e3, 80 -> http, 1723 -> vpn iptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709 iptables-save # \u4fdd\u5b58\u8bbe\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6 # \u573a\u666f\u56db iptables -t nat -L # \u67e5\u770b nat \u914d\u7f6e iptables -t nat -A POST_ROUTING -s 10 .10.177.0/24 -j SNAT --to 10 .10.188.232 # SNAT vi /etc/sysconfig/network # \u914d\u7f6e\u7f51\u5173 iptables -t nat -A POST_ROUTING -d 10 .10.188.232 -p tcp --dport 80 -j DNAT --to 10 .10.177.232:80 # DNAT #\u573a\u666f\u4e94 iptables -I INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 -j REJECT # \u9650\u5236\u5e76\u53d1\u8fde\u63a5\u8bbf\u95ee\u6570 iptables -I INPUT -m limit --limit 3 /hour --limit-burst 10 -j ACCEPT # limit\u6a21\u5757; --limit-burst \u9ed8\u8ba4\u4e3a5 \u6682\u672a\u6574\u7406","title":"\u66f4\u591a\u5b9e\u4f8b"},{"location":"Iptables/#_12","text":"# \u601d\u8def\uff1a\u786e\u5b9a\u5bf9\u5916\u670d\u52a1\u5bf9\u8c61\uff0c\u5bf9\u7f51\u7edc\u63a5\u53e3\u5904\u7406\uff0c\u72b6\u6001\u68c0\u6d4b\u5904\u7406\uff0c\u534f\u8bae\u548c\u7aef\u53e3\u5904\u7406\u3002\u4f8b\u5982\uff1a\u666e\u901aWEB\u670d\u52a1\u5668 iptables -A INPUT -i lo -j ACCEPT # \u5f00\u653e\u672c\u5730\u8bbf\u95ee iptables -A INPUT -p tcp -m multiport --dports 22 ,80,8080 -j ACCEPT # \u5f00\u653e22,80,8080tcp\u7aef\u53e3 iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT # \u5f00\u653e\u72b6\u6001\u4e3aRELATED,ESTABLISHED\u7684 iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT iptables -P INPUT DROP # \u5173\u6389\u5168\u90e8input\u94fe # \u6ce8\u610f\uff1a\u786e\u4fdd\u89c4\u5219\u987a\u5e8f\u6b63\u786e\uff0c\u5f04\u6e05\u903b\u8f91\u5173\u7cfb\uff0c\u5b66\u4f1a\u65f6\u523b\u4f7f\u7528-vnL","title":"\u5355\u670d\u52a1\u5668\u9632\u62a4"},{"location":"Iptables/#_13","text":"# \u601d\u8def\uff1a\u641e\u6e05\u7f51\u7edc\u62d3\u6251\uff0c\u672c\u673a\u4e0a\u7f51\uff0c\u8bbe\u7f6enat\u542f\u7528\u8def\u7531\u8f6c\u53d1\uff0c\u5730\u5740\u4f2a\u88c5SNAT/MASQUERADE # ADSL\u62e8\u53f7\u4e0a\u7f51\u7684\u62d3\u6251\u5b9e\u4f8b\u5982\u4e0b echo \"1\" > /proc/sys/net/ipv4/ip_forward # \u5f00\u542f\u8f6c\u53d1 iptables -t nat -A POSTROUTING -s 192 .168.1.0/24 -o eth0 -j MASQUERADE","title":"\u5173\u4e8e\u7f51\u5173"},{"location":"Iptables/#_14","text":"# \u601d\u8def\uff1a\u8fc7\u6ee4\u4f4d\u7f6efilter\u8868FORWARD\u94fe\uff0c\u5339\u914d\u6761\u4ef6-s -d -p --s/dport;\u5904\u7406\u52a8\u4f5cACCEPT DROP iptables -A FORWARD -s 192 .168.0.3 -j DROP iptables -A FORWARD -m mac --mac-source 11 :22:33:44:55:66 -j DROP iptables -A FORWARD -d www.baidu.com -j DROP","title":"\u9650\u5236\u5185\u7f51\u7528\u6237"},{"location":"Iptables/#_15","text":"# \u601d\u8def\uff1a\u670d\u52a1\u534f\u8bae(TCP/UDP)\uff1b\u5bf9\u5916\u670d\u52a1\u7aef\u53e3\uff0c\u5185\u90e8\u670d\u52a1\u5668\u79c1\u7f51IP\uff1b\u5185\u90e8\u771f\u6b63\u670d\u52a1\u7aef\u53e3 iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to 192 .168.1.1 iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 81 -j DNAT --to 192 .168.1.2:80 iptables -I INPUT -s ip -j DROP #\u5c4f\u853d\u6307\u5b9a ip \u8bbf\u95ee iptables -A INPUT -p tcp --dport 2222 -j ACCEPT #\u5141\u8bb8 2222 \u7aef\u53e3\u8bbf\u95ee iptables -A INPUT -p icmp --icmp-type 8 -s 0 /0 -j DROP #\u5c4f\u853d icmp \u534f\u8bae\uff0c\u5373\u5173\u95ed ping \u670d\u52a1 iptables -L -n --line-numbers #\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219\u5e76\u4ee5\u5e8f\u53f7\u663e\u793a iptables -D INPUT 8 #\u5220\u9664\u5e8f\u53f7\u4e3a 8 \u7684\u89c4\u5219 # ip_conntrack: table full, dropping packet\u95ee\u9898\u5904\u7406 iptables -t raw -A PREROUTING -d 1 .2.3.4 -p tcp --dport 80 -j NOTRACK iptables -A FORWARD -m state --state UNTRACKED -j ACCEPT","title":"\u5185\u7f51\u505a\u5bf9\u5916\u670d\u52a1\u5668"},{"location":"Jenkins/","text":"","title":"Jenkins"},{"location":"Kafka/","text":"","title":"Kafka"},{"location":"Kubernetes/","text":"Kubernetes \u00b6 OKD--The Origin Community Distribution of Kubernetes \u00b6","title":"Kubernetes"},{"location":"Kubernetes/#kubernetes","text":"","title":"Kubernetes"},{"location":"Kubernetes/#okd-the-origin-community-distribution-of-kubernetes","text":"","title":"OKD--The Origin Community Distribution of Kubernetes"},{"location":"LVS/","text":"Linux Virtual Server \u00b6 Linux\u865a\u62df\u670d\u52a1\u5668\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u6269\u5c55\u4e14\u9ad8\u5ea6\u53ef\u7528\u7684\u670d\u52a1\u5668 \uff0c\u6784\u5efa\u5728\u771f\u5b9e\u670d\u52a1\u5668\u96c6\u7fa4\u4e0a\u3002\u670d\u52a1\u5668\u7fa4\u96c6\u7684\u4f53\u7cfb\u7ed3\u6784\u5bf9\u6700\u7ec8\u7528\u6237\u5b8c\u5168\u900f\u660e\uff0c\u7528\u6237\u4e0e\u7fa4\u96c6\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c \u5c31\u597d\u50cf\u5b83\u53ea\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u865a\u62df\u670d\u52a1\u5668\u4e00\u6837 \u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5e73\u8861\u5668\u53ef\u4ee5\u901a\u8fc7\u9ad8\u901f LAN\u6216\u5730\u7406\u4e0a\u5206\u6563\u7684WAN\u4e92\u8fde \u3002\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u5c06\u8bf7\u6c42\u5206\u6d3e\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4f7f\u7fa4\u96c6\u7684\u5e76\u884c\u670d\u52a1\u5728\u5355\u4e2a IP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1 \uff0c\u8bf7\u6c42\u5206\u6d3e\u53ef\u4ee5\u4f7f\u7528 IP\u8d1f\u8f7d\u5e73\u8861\u6280\u672f\u6216\u5e94\u7528\u7ea7\u8d1f\u8f7d\u5747\u8861\u6280\u672f \u3002\u901a\u8fc7\u900f\u660e\u5730\u6dfb\u52a0\u6216\u5220\u9664\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6765\u5b9e\u73b0\u7cfb\u7edf\u7684\u53ef\u4f38\u7f29\u6027\u3002\u901a\u8fc7\u68c0\u6d4b\u8282\u70b9\u6216\u5b88\u62a4\u7a0b\u5e8f\u6545\u969c\u5e76\u9002\u5f53\u5730\u91cd\u65b0\u914d\u7f6e\u7cfb\u7edf\u6765\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3002 \u6784\u5efa\u670d\u52a1\u5668\u96c6\u7fa4\u65b9\u6cd5\uff1a DNS\u8d1f\u8f7d\u5e73\u8861 \uff1a \u7b80\u5355\uff0c\u5229\u7528\u57df\u540d\u7cfb\u7edf\u5c06\u57df\u540d\u89e3\u6790\u5230\u670d\u52a1\u5668\u4e0d\u540c\u7684 IP\u6765\u5206\u53d1\u8bf7\u6c42 \uff0c DNS\u670d\u52a1\u5668\u6839\u636e\u8c03\u5ea6\u7b56\u7565 ( \u5982\u5faa\u73af\u65b9\u5f0f ) \u53d1\u51fa\u670d\u52a1\u5668 IP\u5730\u5740 \uff0c\u7136\u540e\u4f7f\u7528\u76f8\u540c\u7684\u672c\u5730\u7f13\u5b58\u57df\u540d\u670d\u52a1\u5668\u5728\u6307\u5b9a\u7684\u57df\u540d\u89e3\u6790\u751f\u5b58\u65f6\u95f4 ( TTL ) \u4e2d\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u3002 \u4f46\u662f\uff0c\u7531\u4e8e\u5ba2\u6237\u7aef\u548c\u5206\u5c42 DNS\u7cfb\u7edf\u7684\u7f13\u5b58\u7279\u6027 \uff0c\u5f88\u5bb9\u6613\u5bfc\u81f4\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u6b64\u670d\u52a1\u5668\u4e0d\u5bb9\u6613\u5904\u7406\u5176\u5cf0\u503c\u8d1f\u8f7d\u3002\u5728 DNS\u670d\u52a1\u5668\u4e0a\u65e0\u6cd5\u5f88\u597d\u5730\u9009\u62e9\u540d\u79f0\u6620\u5c04\u7684TTL\u503c \uff0c\u5c0f\u503c DNS\u6d41\u91cf\u5f88\u9ad8\u4e14DNS\u670d\u52a1\u5668\u5c06\u6210\u4e3a\u74f6\u9888 \uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u503c\uff0c\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u5c06\u53d8\u5f97\u66f4\u7cdf\u3002\u5373\u4f7f TTL\u503c\u8bbe\u7f6e\u4e3a\u96f6 \uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u6bcf\u4e2a\u4e3b\u673a\uff0c\u4e0d\u540c\u7528\u6237\u7684\u8bbf\u95ee\u6a21\u5f0f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u4e3a\u6709\u4e9b\u4eba\u53ef\u80fd\u4ece\u7f51\u7ad9\u4e0a\u62bd\u53d6\u5927\u91cf\u9875\u9762\uff0c\u800c\u5176\u4ed6\u4eba\u53ef\u80fd\u53ea\u662f\u6d4f\u89c8\u51e0\u9875\u7136\u540e\u53bb\u8fdc\u3002\u6b64\u5916\uff0c\u5b83\u4e0d\u592a\u53ef\u9760\uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\uff0c\u5c06\u540d\u79f0\u6620\u5c04\u5230 IP\u5730\u5740\u7684\u5ba2\u6237\u7aef\u5c06\u53d1\u73b0\u670d\u52a1\u5668\u5df2\u5173\u95ed \u57fa\u4e8e\u8c03\u5ea6\u7a0b\u5e8f\u7684\u8d1f\u8f7d\u5e73\u8861\u7fa4\u96c6\uff1a \u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5206\u914d\u8d1f\u8f7d\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u7684\u5e76\u884c\u670d\u52a1\u53ef\u4ee5\u5728\u5355\u4e2a IP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1 \uff0c\u5e76\u4e14\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u50cf\u5355\u4e2a\u670d\u52a1\u5668\u4e00\u6837\u8fdb\u884c\u4ea4\u4e92\u4e0d\u77e5\u9053\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u670d\u52a1\u5668\u3002\u4e0e\u57fa\u4e8e DNS\u7684\u8d1f\u8f7d\u5e73\u8861\u76f8\u6bd4 \uff0c\u8c03\u5ea6\u7a0b\u5e8f\u53ef\u4ee5\u4ee5\u7cbe\u7ec6\u7684\u7c92\u5ea6\uff08\u4f8b\u5982\u6bcf\u4e2a\u8fde\u63a5\uff09\u8c03\u5ea6\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u5b9e\u73b0\u66f4\u597d\u7684\u8d1f\u8f7d\u5e73\u8861\u3002\u5f53\u4e00\u53f0\u6216\u591a\u53f0\u670d\u52a1\u5668\u53d1\u751f\u6545\u969c\u65f6\uff0c\u53ef\u4ee5\u5c4f\u853d\u6545\u969c\u3002\u670d\u52a1\u5668\u7ba1\u7406\u53d8\u5f97\u8d8a\u6765\u8d8a\u5bb9\u6613\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528\u670d\u52a1\u5668\u6216\u66f4\u591a\u670d\u52a1\u5668\uff0c\u8fd9\u4e0d\u4f1a\u4e2d\u65ad\u6700\u7ec8\u7528\u6237\u7684\u670d\u52a1\u3002 \u8d1f\u8f7d\u5747\u8861\u53ef\u4ee5\u5728\u4e24\u4e2a\u7ea7\u522b\u5b8c\u6210\uff0c\u5373\u5e94\u7528\u7ea7\u548c IP\u7ea7 \u3002\u5c06 HTTP\u8bf7\u6c42\u8f6c\u53d1\u5230\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540cWeb\u670d\u52a1\u5668 \uff0c\u83b7\u53d6\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u5176\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u7531\u4e8e\u5728\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u5904\u7406 HTTP\u8bf7\u6c42\u548c\u56de\u590d\u7684\u5f00\u9500\u5f88\u9ad8 \uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u6570\u91cf\u589e\u52a0\u5230 5 \u6216\u66f4\u591a\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u7ea7\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u65b0\u7684\u74f6\u9888\uff0c\u8fd9\u53d6\u51b3\u4e8e\u6bcf\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u7684\u541e\u5410\u91cf\u670d\u52a1\u5668 LinuxVirtualServer\u4ee5\u4e09\u79cdIP\u8d1f\u8f7d\u5747\u8861\u6280\u672f ( \u6570\u636e\u5305\u8f6c\u53d1\u65b9\u6cd5 ) \u5b9e\u73b0\u3002 1 . NAT\u65b9\u5f0f 2 . IP\u96a7\u9053 3 . \u76f4\u63a5\u8def\u7531 VS/NAT\uff0cVS/TUN\u548cVS/DR\u7684\u6bd4\u8f83\uff1a | \u5bf9\u6bd4\u65b9\u9762 | VS/NAT | VS/TUN | VS/DR | | :--------: | :--------: | :-------: | :--------: | | realserver | \u4efb\u4f55 | \u96a7\u9053 | \u975eARP\u8bbe\u5907 | | realserver network | \u79c1\u6709 | lan/wan | lan | | realserver numbers | low(10-20) | high | high | | realserver gateway | director | ownrouter | own router | | client connnects to | VIP | VIP | VIP | LVS\u96c6\u7fa4\u901a\u5e38\u91c7\u7528\u4e09\u8fde\u63a5\u67b6\u6784\uff1a \u4e09\u8fde\u63a5\u7ed3\u6784\u5305\u62ec\uff1a **\u8d1f\u8f7d\u5747\u8861\u5668**\u5b83\u662f\u6574\u4e2a\u96c6\u7fa4\u7cfb\u7edf\u7684\u524d\u7aef\u673a\u5668\uff0c\u5e76\u5728\u4e00\u7ec4\u670d\u52a1\u5668\u4e4b\u95f4\u5e73\u8861\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u8ba4\u4e3a\u6240\u6709\u670d\u52a1\u90fd\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u3002 **\u670d\u52a1\u5668\u7fa4\u96c6**\u5b83\u662f\u4e00\u7ec4\u8fd0\u884c\u5b9e\u9645\u7f51\u7edc\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u4f8b\u5982Web\uff0c\u90ae\u4ef6\uff0cFTP\uff0cDNS\u548c\u5a92\u4f53\u670d\u52a1\u3002 **\u5171\u4eab\u5b58\u50a8**\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5171\u4eab\u5b58\u50a8\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u53ef\u4ee5\u8f7b\u677e\u62e5\u6709\u76f8\u540c\u7684\u5185\u5bb9\u5e76\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\u3002 NAT: NAT(Network Address Translation)\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u5373\u5c06IP\u5730\u5740\u4ece\u4e00\u4e2a\u7ec4\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u7ec4\u7684\u529f\u80fd\u3002\u5f53\u5730\u5740\u6620\u5c04\u4e3aN\u5230N\u65f6\uff0c\u79f0\u4e3a\u9759\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362; \u5f53\u6620\u5c04\u662fM\u5230N\uff08M> N\uff09\u65f6\uff0c\u5b83\u88ab\u79f0\u4e3a\u52a8\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u3002\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u662f\u57fa\u672cNAT\u7684\u6269\u5c55\uff0c\u56e0\u4e3a\u8bb8\u591a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u88ab\u8f6c\u6362\u4e3a\u5355\u4e2a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u3002\u8fd9\u662fN-to-1\u6620\u5c04\uff0c\u5b9e\u73b0\u4e86Linux IP Masquerading(\u4f2a\u88c5)\u3002Linux\u4e0a\u7684NAT\u865a\u62df\u670d\u52a1\u5668\u662f\u901a\u8fc7\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u5b8c\u6210\u7684 \u5f53\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u670d\u52a1\u65f6\uff0c\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u8bf7\u6c42\u6570\u636e\u5305\uff08\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5916\u90e8IP\u5730\u5740\uff09\u5230\u8fbe\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u5982\u679c\u6839\u636e\u865a\u62df\u670d\u52a1\u5668\u89c4\u5219\u8868\u5339\u914d\u865a\u62df\u670d\u52a1\u5668\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u96c6\u7fa4\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u5c06\u76ee\u6807\u5730\u5740\u548c\u6570\u636e\u5305\u7684\u7aef\u53e3\u91cd\u5199\u4e3a\u6240\u9009\u670d\u52a1\u5668\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\uff0c\u5e76\u5c06\u6570\u636e\u5305\u8f6c\u53d1\u5230\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u91cd\u5199\u8be5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u56de\u590d\u6570\u636e\u5305\u8fd4\u56de\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u91cd\u5199\u4e3a\u865a\u62df\u670d\u52a1\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u5728\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 IP\u96a7\u9053\uff1a IP\u96a7\u9053\uff08IP\u5c01\u88c5\uff09\u662f\u4e00\u79cd\u5c06IP\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\u7684\u6280\u672f\uff0c\u5b83\u5141\u8bb8\u5c06\u53d1\u5f80\u4e00\u4e2aIP\u5730\u5740\u7684\u6570\u636e\u62a5\u5305\u88c5\u5e76\u91cd\u5b9a\u5411\u5230\u53e6\u4e00\u4e2aIP\u5730\u5740\u3002IP\u5c01\u88c5\u73b0\u5728\u901a\u5e38\u7528\u4e8e\u5916\u8054\u7f51\uff0c\u79fb\u52a8IP\uff0cIP\u591a\u64ad\uff0c\u96a7\u9053\u4e3b\u673a\u6216\u7f51\u7edc\u3002 \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u6839\u636e\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\uff0c\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u518d\u6b21\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u8be5\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u5c01\u88c5\u7684\u6570\u636e\u5305\u65f6\uff0c\u5b83\u4f1a\u89e3\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5904\u7406\u8bf7\u6c42\uff0c\u6700\u540e\u6839\u636e\u81ea\u5df1\u7684\u8def\u7531\u8868\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 \u76f4\u63a5\u8def\u7531: \u6b64\u8bf7\u6c42\u8c03\u5ea6\u65b9\u6cd5\u7c7b\u4f3c\u4e8eIBM\u7684NetDispatcher\u4e2d\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002\u865a\u62dfIP\u5730\u5740\u7531\u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u5171\u4eab\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u63a5\u53e3\u4e5f\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u7528\u4e8e\u63a5\u53d7\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u76f4\u63a5\u5c06\u6570\u636e\u5305\u8def\u7531\u5230\u9009\u5b9a\u7684\u670d\u52a1\u5668\u3002\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u7684\u975earp\u522b\u540d\u63a5\u53e3\u90fd\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u6216\u8005\u5c06\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u6570\u636e\u5305\u91cd\u5b9a\u5411\u5230\u672c\u5730\u5957\u63a5\u5b57\uff0c\u4ee5\u4fbf\u771f\u5b9e\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u672c\u5730\u5904\u7406\u6570\u636e\u5305\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u771f\u5b9e\u670d\u52a1\u5668\u5fc5\u987b\u901a\u8fc7HUB / Switch\u7269\u7406\u8fde\u63a5\u5176\u4e2d\u4e00\u4e2a\u63a5\u53e3\u3002\u901a\u8fc7\u76f4\u63a5\u8def\u7531\u7684\u865a\u62df\u670d\u52a1\u5668\u7684\u4f53\u7cfb\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\uff08LinuxDirector\uff09\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u76f4\u63a5\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u8be5\u6570\u636e\u5305\u5c06\u518d\u6b21\u76f4\u63a5\u8def\u7531\u5230\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u8f6c\u53d1\u7684\u6570\u636e\u5305\u65f6\uff0c\u670d\u52a1\u5668\u53d1\u73b0\u8be5\u6570\u636e\u5305\u662f\u7528\u4e8e\u5176\u522b\u540d\u63a5\u53e3\u4e0a\u7684\u5730\u5740\u6216\u672c\u5730\u5957\u63a5\u5b57\u7684\u5730\u5740\uff0c\u6240\u4ee5\u5b83\u5904\u7406\u8bf7\u6c42\u5e76\u6700\u7ec8\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 \u4f5c\u4e1a\u8c03\u5ea6\u7b97\u6cd5\uff1a \u5faa\u73af\u8c03\u5ea6Round Robin PR \u52a0\u6743\u5faa\u73af\u8c03\u5ea6Weighted Round Robin WPR \u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Least Connections LC \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Weighted Least Connections WLC \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Locality-Based Least Connections LBLC \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6Locality-Based Least Connections with Replication LBLCR \u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6Destination Hashing DH \u6e90\u54c8\u5e0c\u8c03\u5ea6Source Hashing SH \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6Shortest Expected Delay Scheduling SED \u4ece\u4e0d\u6392\u961f\u8c03\u5ea6Never Queue Scheduling NQ \u5faa\u73af\u8c03\u5ea6 \u5faa\u73af\u8c03\u5ea6\u7b97\u6cd5\u5c06\u6bcf\u4e2a\u4f20\u5165\u8bf7\u6c42\u53d1\u9001\u5230\u5176\u5217\u8868\u4e2d\u7684\u4e0b\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\uff0c\u5728\u4e09\u670d\u52a1\u5668\u96c6\u7fa4\uff08\u670d\u52a1\u5668A\uff0cB\u548cC\uff09\u4e2d\uff0c\u8bf7\u6c421\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u8bf7\u6c422\u5c06\u8f6c\u5230\u670d\u52a1\u5668B\uff0c\u8bf7\u6c423\u5c06\u8f6c\u5230\u670d\u52a1\u5668C\uff0c\u8bf7\u6c424\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u4ece\u800c\u5b8c\u6210\u9a91\u81ea\u884c\u8f66\u6216\u670d\u52a1\u5668'\u5faa\u73af'\u3002\u65e0\u8bba\u6bcf\u4e2a\u670d\u52a1\u5668\u9047\u5230\u7684\u4f20\u5165\u8fde\u63a5\u6570\u6216\u54cd\u5e94\u65f6\u95f4\u5982\u4f55\uff0c\u5b83\u90fd\u5c06\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u89c6\u4e3a\u76f8\u7b49\u3002\u4e0e\u4f20\u7edf\u7684\u5faa\u73afDNS\u76f8\u6bd4\uff0cVirtual Server\u5177\u6709\u4e00\u4e9b\u4f18\u52bf\u3002\u5faa\u73afDNS\u5c06\u5355\u4e2a\u57df\u89e3\u6790\u4e3a\u4e0d\u540c\u7684IP\u5730\u5740\uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u57fa\u4e8e\u4e3b\u673a\u7684\uff0c\u5e76\u4e14DNS\u67e5\u8be2\u7684\u7f13\u5b58\u963b\u788d\u4e86\u57fa\u672c\u7b97\u6cd5\uff0c\u8fd9\u4e9b\u56e0\u7d20\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u663e\u7740\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002 \u52a0\u6743\u5faa\u73af\u8c03\u5ea6 \u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u65e8\u5728\u66f4\u597d\u5730\u5904\u7406\u5177\u6709\u4e0d\u540c\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u3002\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5668\u5206\u914d\u4e00\u4e2a\u6743\u91cd\uff0c\u4e00\u4e2a\u8868\u793a\u5904\u7406\u80fd\u529b\u7684\u6574\u6570\u503c\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u9996\u5148\u63a5\u6536\u65b0\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u6743\u91cd\u8f83\u5c0f\u7684\u670d\u52a1\u5668\uff0c\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u6bd4\u5177\u6709\u8f83\u5c11\u6743\u91cd\u7684\u670d\u52a1\u5668\u83b7\u5f97\u66f4\u591a\u8fde\u63a5\uff0c\u5177\u6709\u76f8\u540c\u6743\u91cd\u7684\u670d \u4f8b\u5982\uff0c\u771f\u5b9e\u670d\u52a1\u5668A\uff0cB\u548cC\u5206\u522b\u5177\u6709\u6743\u91cd4,3,2\uff0c\u5728\u8c03\u5ea6\u5468\u671f\uff08mod sum\uff08Wi\uff09\uff09\u4e2d\uff0c\u826f\u597d\u7684\u8c03\u5ea6\u5e8f\u5217\u5c06\u662fAABABCABC\u3002\u5728\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u5b9e\u73b0\u4e2d\uff0c\u5728\u4fee\u6539\u865a\u62df\u670d\u52a1\u5668\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u5c06\u6839\u636e\u670d\u52a1\u5668\u6743\u91cd\u751f\u6210\u8c03\u5ea6\u5e8f\u5217\u3002 \u5f53\u771f\u5b9e\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u4e0d\u540c\u65f6\uff0c\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u4f18\u4e8e\u5faa\u73af\u8c03\u5ea6\u3002\u4f46\u662f\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5927\u591a\u6570\u9700\u8981\u5927\u54cd\u5e94\u7684\u8bf7\u6c42\u53ef\u80fd\u4f1a\u88ab\u5f15\u5bfc\u5230\u540c\u4e00\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u3002 \u5b9e\u9645\u4e0a\uff0c\u5faa\u73af\u8c03\u5ea6\u662f\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u4e00\u4e2a\u7279\u6b8a\u5b9e\u4f8b\uff0c\u5176\u4e2d\u6240\u6709\u6743\u91cd\u90fd\u76f8\u7b49\u3002 \u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u5c06\u7f51\u7edc\u8fde\u63a5\u5b9a\u5411\u5230\u5177\u6709\u6700\u5c11\u6570\u91cf\u7684\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u670d\u52a1\u5668\u3002\u8fd9\u662f\u52a8\u6001\u8c03\u5ea6\u7b97\u6cd5\u4e4b\u4e00; \u56e0\u4e3a\u5b83\u9700\u8981\u52a8\u6001\u8ba1\u7b97\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u5bf9\u4e8e\u7ba1\u7406\u5177\u6709\u7c7b\u4f3c\u6027\u80fd\u7684\u670d\u52a1\u5668\u96c6\u5408\u7684\u865a\u62df\u670d\u52a1\u5668\uff0c\u5f53\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\u65f6\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u53ef\u4ee5\u5e73\u6ed1\u5206\u53d1\u3002\u865a\u62df\u670d\u52a1\u5668\u5c06\u4f7f\u7528\u6700\u5c11\u7684\u6d3b\u52a8\u8fde\u63a5\u5c06\u8bf7\u6c42\u5b9a\u5411\u5230\u771f\u5b9e\u670d\u52a1\u5668\u3002 \u4e4d\u4e00\u770b\uff0c\u5373\u4f7f\u5b58\u5728\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e5f\u53ef\u80fd\u8868\u73b0\u826f\u597d\uff0c\u56e0\u4e3a\u66f4\u5feb\u7684\u670d\u52a1\u5668\u5c06\u83b7\u5f97\u66f4\u591a\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8eTCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u5b83\u65e0\u6cd5\u5f88\u597d\u5730\u6267\u884c\u3002TCP\u7684TIME_WAIT\u901a\u5e38\u662f2\u5206\u949f\uff0c\u5728\u8fd92\u5206\u949f\u5185\uff0c\u4e00\u4e2a\u7e41\u5fd9\u7684\u7f51\u7ad9\u7ecf\u5e38\u6536\u5230\u6570\u5343\u4e2a\u8fde\u63a5\uff0c\u4f8b\u5982\uff0c\u670d\u52a1\u5668A\u7684\u529f\u80fd\u662f\u670d\u52a1\u5668B\u7684\u4e24\u500d\uff0c\u670d\u52a1\u5668A\u5904\u7406\u6570\u5343\u4e2a\u8bf7\u6c42\u5e76\u5c06\u5b83\u4eec\u4fdd\u5b58\u5728TCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u4f46\u670d\u52a1\u5668B\u6b63\u5728\u722c\u884c\u4ee5\u5b8c\u6210\u5176\u6570\u5343\u4e2a\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e0d\u80fd\u5728\u5177\u6709\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5f88\u597d\u5730\u5e73\u8861\u8d1f\u8f7d\u3002 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u662f\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u8d85\u96c6\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6027\u80fd\u6743\u91cd\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u503c\u7684\u670d\u52a1\u5668\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u5c06\u83b7\u5f97\u66f4\u5927\u6bd4\u4f8b\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u865a\u62df\u670d\u52a1\u5668\u7ba1\u7406\u5458\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6743\u91cd\uff0c\u5e76\u4e14\u5c06\u7f51\u7edc\u8fde\u63a5\u5b89\u6392\u5230\u6bcf\u4e2a\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5f53\u524d\u6d3b\u52a8\u8fde\u63a5\u6570\u7684\u767e\u5206\u6bd4\u662f\u4e0e\u5176\u6743\u91cd\u7684\u6bd4\u7387\u3002\u9ed8\u8ba4\u6743\u91cd\u4e3a1\u3002 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a \u5047\u8bbe\u6709n\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668i\u7684\u6743\u91cd\u4e3aW i\uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u800c\u6d3b\u52a8\u8fde\u63a5C i \uff08i = 1\uff0c..\uff0cn\uff09\uff0cALL_CONNECTIONS\u662fC i\u7684\u603b\u548c \uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u4e0b\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u5c06\u88ab\u5b9a\u5411\u5230\u670d\u52a1\u5668j\uff0c\u5176\u4e2d \uff08C j / ALL_CONNECTIONS\uff09/ W j = min {\uff08C i / ALL_CONNECTIONS\uff09/ W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u7531\u4e8eALL_CONNECTIONS\u5728\u6b64\u67e5\u627e\u4e2d\u662f\u5e38\u91cf\uff0c\u56e0\u6b64\u65e0\u9700\u5c06C i\u9664\u4ee5ALL_CONNECTIONS\uff0c\u5b83\u53ef\u4ee5\u4f18\u5316\u4e3a C j / W j = min {C i / W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u9700\u8981\u6bd4\u6700\u5c0f\u8fde\u63a5\u66f4\u591a\u7684\u5212\u5206\u3002\u4e3a\u4e86\u5728\u670d\u52a1\u5668\u5177\u6709\u76f8\u540c\u7684\u5904\u7406\u80fd\u529b\u65f6\u6700\u5c0f\u5316\u8c03\u5ea6\u7684\u5f00\u9500\uff0c\u5b9e\u73b0\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u548c\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u3002 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5982\u679c\u670d\u52a1\u5668\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u4e14\u8d1f\u8f7d\u4e0d\u8db3\uff0c\u6b64\u7b97\u6cd5\u901a\u5e38\u4f1a\u5c06\u53d1\u5f80IP\u5730\u5740\u7684\u6570\u636e\u5305\u5b9a\u5411\u5230\u5176\u670d\u52a1\u5668\u3002\u5982\u679c\u670d\u52a1\u5668\u8fc7\u8f7d\uff08\u5176\u6d3b\u52a8\u8fde\u63a5\u6570\u5927\u4e8e\u5176\u6743\u91cd\uff09\u5e76\u4e14\u670d\u52a1\u5668\u5904\u4e8e\u534a\u8d1f\u8f7d\u72b6\u6001\uff0c\u5219\u5c06\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u670d\u52a1\u5668\u5206\u914d\u7ed9\u6b64IP\u5730\u5740\u3002 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6\u7b97\u6cd5\u4e5f\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5b83\u4e0eLBLC\u8c03\u5ea6\u7684\u4e0d\u540c\u4e4b\u5904\u5982\u4e0b\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u7ef4\u62a4\u4ece\u76ee\u6807\u5230\u53ef\u4ee5\u4e3a\u76ee\u6807\u670d\u52a1\u7684\u4e00\u7ec4\u670d\u52a1\u5668\u8282\u70b9\u7684\u6620\u5c04\u3002\u5bf9\u76ee\u6807\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u7ed9\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6700\u5c0f\u8fde\u63a5\u8282\u70b9\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u8fc7\u8f7d\uff0c\u5b83\u5c06\u5728\u96c6\u7fa4\u4e2d\u83b7\u53d6\u6700\u5c11\u8fde\u63a5\u8282\u70b9\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u672a\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fdb\u884c\u4fee\u6539\uff0c\u5219\u4f1a\u4ece\u670d\u52a1\u5668\u96c6\u4e2d\u5220\u9664\u8d1f\u8f7d\u6700\u591a\u7684\u8282\u70b9\uff0c\u4ee5\u907f\u514d\u9ad8\u5ea6\u590d\u5236\u3002 \u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6 \u76ee\u6807\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u76ee\u6807IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5\u3002 \u6e90\u54c8\u5e0c\u8c03\u5ea6 \u6e90\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u6e90IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5\u3002 \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6 \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\u4ee5\u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u5c06\u7f51\u7edc\u8fde\u63a5\u5206\u914d\u7ed9\u670d\u52a1\u5668\u3002\u5982\u679c\u53d1\u9001\u5230\u7b2ci\u4e2a\u670d\u52a1\u5668\uff0c\u4f5c\u4e1a\u5c06\u7ecf\u5386\u7684\u9884\u671f\u5ef6\u8fdf\u662f\uff08Ci + 1\uff09/ Ui\uff0c\u5176\u4e2dCi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u8fde\u63a5\u6570\uff0cUi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u7684\u56fa\u5b9a\u670d\u52a1\u901f\u7387\uff08\u6743\u91cd\uff09 \u3002 \u4ece\u4e0d\u6392\u961f\u8c03\u5ea6 \u6c38\u4e0d\u6392\u961f\u8c03\u5ea6\u7b97\u6cd5\u91c7\u7528\u53cc\u901f\u6a21\u578b\u3002\u5f53\u6709\u7a7a\u95f2\u670d\u52a1\u5668\u53ef\u7528\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u7a7a\u95f2\u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u5feb\u901f\u670d\u52a1\u5668\u3002\u5f53\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u670d\u52a1\u5668\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u4ee5\u6700\u5c0f\u5316\u5176\u9884\u671f\u5ef6\u8fdf\uff08\u6700\u77ed\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\uff09\u3002 LVS\u4e2dIP\u6216\u7f51\u7edc\u7684\u540d\u79f0 \u5178\u578b\u7684 LVS - NAT \u8bbe\u7f6e\uff1a LVS - NAT : no arp problem ( the realservers don ' t have the VIP) ________ | | | client | ( local or on internet ) | ________ | CIP | ( router ) DGW -- DIRECTOR - gateway | outside network | VIP -- Virtual IP ____ | _____ | | ( director can have 1 or 2 NICs ) | director | | __________ | DIP ( and PIP ) -- primary director IP = PIP ( the director which will be the master on bootup ) | -- secondary director IP = SIP ( the director which will be the backup on bootup ) | DRIP network ---------------------------------- | | | | | | RIP1 RIP2 RIP3 _____________ _____________ _____________ | | | | | | | realserver1 | | realserver2 | | realserver3 | | _____________ | | _____________ | | _____________ | \u5178\u578b\u7684 LVS - DR or LVS - Tun \u8bbe\u7f6e ________ | | | client | ( local or on internet ) | ________ | | ( router ) ----------- | SERVER_GW | | | VIP | ____ | _____ | | | ( director can have 1 or 2 NICs ) | director | | | __________ | | DIP | | | | | -----------------+---------------- | | | | | | RIP1 , VIP RIP2 , VIP RIP3 , VIP ____________ ____________ ____________ | | | | | | | realserver | | realserver | | realserver | | ____________ | | ____________ | | ____________ | client IP = CIP virtual IP = VIP - the IP on the director that the client connects to ) director IP = DIP - the IP on the director in the DIP / RIP ( DRIP ) network ( this is the realserver gateway for LVS - NAT ) realserver IP = RIP ( and RIP1 , RIP2 ... ) the IP on the realserver director GW = DGW - the director ' s gw (only needed for LVS-NAT) ( this can be the realserver gateway for LVS - DR and LVS - Tun ) VIP \u548c DIP \u8bbe\u7f6e\u4e3a\u8f85\u52a9 IP \uff08\u5373\u8be5 NIC ( \u7f51\u5361 ) \u4e0a\u6709\u53e6\u4e00\u4e2a\u4e3b IP \uff09\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728 director \u6545\u969c\u8f6c\u79fb\u540e\u5c06\u5b83\u4eec\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u590d\u5236\u7684 director \u3002\u5bf9\u4e8e\u4f7f\u7528\u5355\u4e2a director \u7684\u521d\u59cb\u8bbe\u7f6e\uff0c\u5c06 VIP \u548c DIP \u8bbe\u7f6e\u4e3a\u6b21\u8981 IP \u5c06\u4f7f\u6545\u969c\u8f6c\u79fb\u8bbe\u7f6e\u66f4\u52a0\u5bb9\u6613\u3002 DGW \u516c\u7f51IP\u7684\u9ed8\u8ba4\u7f51\u5173 VIP \u5ba2\u6237\u7aef\u8bbf\u95ee\u7684\u516c\u7f51IP\uff0cDirector\u7684\u865a\u62dfIP DIP Director\u7684\u771f\u5b9eIP RIP realserver\u7684IP RIP \u5ba2\u6237\u7aefIP \u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-NAT\u8f6c\u53d1 \u5728 direcotor\u4f7f\u7528\u4e00\u4e2a\u7f51\u5361 \uff0c\u4e5f\u53ef\u4f7f\u7528\u4e24\u4e2a\uff0c\u4f46\u8981\u6539\u53d8\u8bbe\u7f6e\u3002 ________ | | | client | | ________ | CIP = DGW = 192 . 168 . 2 . 254 ( eth0 ) | | __________ | | | | ( VIP = 192 . 168 . 2 . 110 , eth0 : 110 ) | director | ---| | __________ | | DIP = SGW = 192 . 168 . 1 . 9 ( eth0 ) | | ----------------------------------- | | | | RIP = 192 . 168 . 1 . 11 ( eth0 ) RIP = 192 . 168 . 1 . 12 ( eth0 ) ____________ ____________ | | | | | realserver | | realserver | | ____________ | | ____________ | \u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-DR\u8f6c\u53d1 \u5728\u5177\u6709\u5355\u4e2a NIC\u7684\u8ba1\u7b97\u673a\u4e0a\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc \uff08\u6b64\u5904\u4e3a 192 . 168 . 1 . 0 / 24 \uff09\u8bbe\u7f6e LVS \u3002\u4ee5\u592a\u7f51\u522b\u540d\u4e0a\u7684 IP \uff08\u4f8b\u5982 eth0 \uff1a 110 \uff0c lo \uff1a 0 \uff09\u7531 configure\u811a\u672c\u8bbe\u7f6e \u3002\u6ca1\u6709\u9ed8\u8ba4\u8def\u7531\uff0c\u5e76\u4e14\u6240\u6709\u8ba1\u7b97\u673a\u90fd\u5e94\u8be5\u80fd\u591f\u76f8\u4e92 ping\u901a \u3002 ________ | | | client | | ________ | CIP = SGW = 192 . 168 . 1 . 254 ( eth0 ) | | __________ | | | | ( VIP = 192 . 168 . 1 . 110 , eth0 : 110 ) | director | ---| | __________ | | DIP = 192 . 168 . 1 . 9 ( eth0 ) | | ----------------------------------- | | | | RIP = 192 . 168 . 1 . 11 ( eth0 ) RIP = 192 . 168 . 1 . 12 ( eth0 ) ( VIP = 192 . 168 . 1 . 110 , lo : 0 ) ( VIP = 192 . 168 . 1 . 110 , lo : 0 ) ____________ ____________ | | | | | realserver | | realserver | | ____________ | | ____________ | LVS+Keepalived\u89e3\u51b3\u65b9\u6848\u5b98\u65b9\u793a\u4f8b \u00b6 \u4f7f\u7528keepalived\u6784\u5efa\u4e00\u4e2a\u5177\u6709\u4e24\u4e2a\u8d1f\u8f7d\u5e73\u8861\u5668\u548c\u4e09\u4e2aWeb\u670d\u52a1\u5668\u7684\u9ad8\u53ef\u7528\u6027VS/NAT Web\u96c6\u7fa4\uff0c\u62d3\u6251\u56fe\u5982\u4e0b\uff1a \u5728\u672c\u4f8b\u4e2d\uff0cVIP\u5730\u5740\u548cDIP\u5730\u5740\u5206\u522b\u4e3a10.23.8.80\u548c172.18.1.254\u5747\u4e3a\u6d6e\u52a8IP\uff0c\u5b83\u4eec\u5728\u4e24\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\uff08LD1\u548cLD2\uff09\u4e4b\u95f4\u6d6e\u52a8\uff0c\u4e09\u4e2arealserver\u7684IP\u5730\u5740\u4e3a172.18.1.11,172.18.1.12\u548c172.18.1.13\u3002 float IP\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\u56fe\uff1a LD1\u4e0a\u7684keepalived\u914d\u7f6e\u6587\u4ef6\uff08/etc/keepalived/keepalived.conf\uff09\u5982\u4e0b: vrrp_sync_group VG1 { group { VI_1 VI_2 } } vrrp_instance VI_1 { state MASTER interface eth0 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10 . 23 . 8 . 80 } } vrrp_instance VI_2 { state MASTER interface eth1 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 172 . 18 . 1 . 254 } } virtual_server 10 . 23 . 8 . 80 80 { delay_loop 6 lb_algo wlc lb_kind NAT persistence_timeout 600 protocol TCP real_server 172 . 18 . 1 . 11 80 { weight 100 TCP_CHECK { connect_timeout 3 } } real_server 172 . 18 . 1 . 12 80 { weight 100 TCP_CHECK { connect_timeout 3 } } real_server 172 . 18 . 1 . 13 80 { weight 100 TCP_CHECK { connect_timeout 3 } } } LD2\u7684\u548cLD1\u76f8\u4f3c \uff0c\u53ea\u9700\u5c06 VI_1\u548cVI_2\u7684\u72b6\u6001\u4ecemaster\u6539\u4e3abackup Keepalived\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3 \u00b6 # \u5168\u5c40\u5b9a\u4e49\u6a21\u5757 global_defs { notification_email { acassen @firewall . loc failover @firewall . loc sysadmin @firewall . loc #\u90ae\u4ef6\u62a5\u8b66 } notification_email_from Alexandre . Cassen @firewall . loc \u6307\u5b9a\u53d1\u4ef6\u4eba smtp_server 192.168.200.1 #\u6307\u5b9asmtp\u670d\u52a1\u5668\u5730\u5740 smtp_connect_timeout 30 \u6307\u5b9asmtp\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 router_id LVS_DEVEL #\u8d1f\u8f7d\u5747\u8861\u6807\u8bc6 \uff0c \u5728\u5c40\u57df\u7f51\u5185\u5e94\u8be5\u662f\u552f\u4e00\u7684 \u3002 vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } \u8bf4\u660e \uff1a notification_email \uff1a \u6307\u5b9a\u5f53keepalived\u51fa\u73b0\u95ee\u9898\u65f6 \uff0c \u53d1\u9001\u90ae\u4ef6\u7ed9\u54ea\u4e9b\u7528\u6237 \u3002 notification_emai_from \uff1a \u53d1\u9001\u90ae\u4ef6\u65f6 \uff0c \u90ae\u4ef6\u7684\u6765\u6e90\u5730\u5740 \u3002 smtp_server < DOMAIN | IP > [ <PORT> ] \uff1a smtp\u670d\u52a1\u5668\u7684\u5730\u5740\u6216\u57df\u540d \u3002 \u9ed8\u8ba4\u7aef\u53e3\u4e3a25 . \u5982 \uff1a smtp_server smtp . felix . com 25 smtp_helo_name < HOST_NAME > \uff1a \u6307\u5b9a\u5728HELO\u6d88\u606f\u4e2d\u6240\u4f7f\u7528\u7684\u540d\u79f0 \u3002 \u9ed8\u8ba4\u4e3a\u672c\u5730\u4e3b\u673a\u540d \u3002 smtp_connect_timeout \uff1a \u6307\u5b9asmtp\u670d\u52a1\u5668\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 router_id \uff1a \u6307\u5b9a\u6807\u8bc6\u8be5\u673a\u5668\u7684route_id . \u5982 \uff1a route_id LVS_01 vrrp_mcast_group4 224.0.0.18 \uff1a \u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u4f7f\u7528\u7684IPV4\u7ec4\u64ad\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f224 .0.0.18 vrrp_mcast_group6 ff02 : : 12 \u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u6240\u4f7f\u7528\u7684IPV6\u7ec4\u64ad\u5730\u5740 \u3002 \u9ed8\u8ba4\u662fff02 : : 12 default_interface eth0 \uff1a \u8bbe\u7f6e\u9759\u6001\u5730\u5740\u9ed8\u8ba4\u7ed1\u5b9a\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662feth0 \u3002 lvs_sync_daemon < INTERFACE > < VRRP_INSTANCE > [ id <SYNC_ID> ] [ maxlen <LEN> ] [ port <PORT> ] [ ttl <TTL> ] [ group <IP ADDR> ] \u8bbe\u7f6eLVS\u540c\u6b65\u670d\u52a1\u7684\u76f8\u5173\u5185\u5bb9 \u3002 \u53ef\u4ee5\u540c\u6b65LVS\u7684\u72b6\u6001\u4fe1\u606f \u3002 INTERFACE \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684\u63a5\u53e3 \u3002 VRRP_INSTANCE \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684VRRP\u5b9e\u4f8b \u3002 id < SYNC_ID > \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u6240\u4f7f\u7528\u7684SYNCID \uff0c \u53ea\u6709\u76f8\u540c\u7684SYNCID\u624d\u4f1a\u540c\u6b65 \u3002 \u8303\u56f4\u662f0 - 255. maxlen \uff1a \u6307\u5b9a\u6570\u636e\u5305\u7684\u6700\u5927\u957f\u5ea6 \u3002 \u8303\u56f4\u662f1 - 65507 port \uff1a \u6307\u5b9a\u540c\u6b65\u6240\u4f7f\u7528\u7684UDP\u7aef\u53e3 \u3002 group \uff1a \u6307\u5b9a\u7ec4\u64adIP\u5730\u5740 \u3002 lvs_flush \uff1a \u5728keepalived\u542f\u52a8\u65f6 \uff0c \u5237\u65b0\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u7684LVS\u914d\u7f6e \u3002 vrrp_garp_master_delay 10 \uff1a \u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6 \uff0c \u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP \u3002 \u9ed8\u8ba4\u4e3a5s \uff0c 0 \u8868\u793a\u4e0d\u53d1\u9001\u7b2c\u4e8c\u7ec4\u514d\u7684\u514d\u8d39ARP \u3002 vrrp_garp_master_repeat 1 \uff1a \u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6 \uff0c \u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf \u3002 \u9ed8\u8ba4\u662f5 . vrrp_garp_lower_prio_delay 10 \uff1a \u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6 \uff0c \u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP \u3002 vrrp_garp_lower_prio_repeat 1 \uff1a \u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6 \uff0c \u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf \u3002 vrrp_garp_master_refresh 60 \uff1a \u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e \uff0c \u5237\u65b0\u514d\u8d39ARP\u7684\u6700\u5c0f\u65f6\u95f4\u95f4\u9694 ( \u4f1a\u518d\u6b21\u53d1\u9001\u514d\u8d39ARP ) \u3002 \u9ed8\u8ba4\u662f0 \uff0c \u8868\u793a\u4e0d\u4f1a\u5237\u65b0 \u3002 vrrp_garp_master_refresh_repeat 2 \uff1a \u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e \uff0c \u6bcf\u6b21\u5237\u65b0\u4f1a\u53d1\u9001\u591a\u5c11\u4e2a\u514d\u8d39ARP \u3002 \u9ed8\u8ba4\u662f1 . vrrp_garp_interval 0.001 \uff1a \u5728\u4e00\u4e2a\u63a5\u53e3\u53d1\u9001\u7684\u4e24\u4e2a\u514d\u8d39ARP\u4e4b\u95f4\u7684\u5ef6\u8fdf \u3002 \u53ef\u4ee5\u7cbe\u786e\u5230\u6beb\u79d2\u7ea7 \u3002 \u9ed8\u8ba4\u662f0 . vrrp_lower_prio_no_advert true | false \uff1a \u9ed8\u8ba4\u662ffalse \u3002 \u5982\u679c\u6536\u5230\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a \uff0c \u4e0d\u53d1\u9001\u4efb\u4f55\u901a\u544a \u3002 vrrp_version 2 | 3 \uff1a \u8bbe\u7f6e\u9ed8\u8ba4\u7684VRRP\u7248\u672c \u3002 \u9ed8\u8ba4\u662f2 . vrrp_check_unicast_src \uff1a \u5728\u5355\u64ad\u6a21\u5f0f\u4e2d \uff0c \u5f00\u542f\u5bf9VRRP\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u505a\u68c0\u67e5 \uff0c \u6e90\u5730\u5740\u5fc5\u987b\u662f\u5355\u64ad\u90bb\u5c45\u4e4b\u4e00 \u3002 vrrp_skip_check_adv_addr \uff1a \u9ed8\u8ba4\u662f\u4e0d\u8df3\u8fc7\u68c0\u67e5 \u3002 \u68c0\u67e5\u6536\u5230\u7684VRRP\u901a\u544a\u4e2d\u7684\u6240\u6709\u5730\u5740\u53ef\u80fd\u4f1a\u6bd4\u8f83\u8017\u65f6 \uff0c \u8bbe\u7f6e\u6b64\u547d\u4ee4\u7684\u610f\u601d\u662f \uff0c \u5982\u679c\u901a\u544a\u4e0e\u63a5\u6536\u7684\u4e0a\u4e00\u4e2a\u901a\u544a\u6765\u81ea\u76f8\u540c\u7684master\u8def\u7531\u5668 \uff0c \u5219\u4e0d\u6267\u884c\u68c0\u67e5 ( \u8df3\u8fc7\u68c0\u67e5 ) \u3002 vrrp_strict \uff1a \u4e25\u683c\u9075\u5b88VRRP\u534f\u8bae \u3002 \u4e0b\u5217\u60c5\u51b5\u5c06\u4f1a\u963b\u6b62\u542f\u52a8Keepalived \uff1a 1. \u6ca1\u6709VIP\u5730\u5740 \u3002 2. \u5355\u64ad\u90bb\u5c45 \u3002 3. \u5728VRRP\u7248\u672c2\u4e2d\u6709IPv6\u5730\u5740 \u3002 vrrp_iptables \uff1a \u4e0d\u6dfb\u52a0\u4efb\u4f55iptables\u89c4\u5219 \u3002 \u9ed8\u8ba4\u662f\u6dfb\u52a0iptables\u89c4\u5219\u7684 \u3002 \u5982\u679cvrrp\u8fdb\u7a0b\u6216check\u8fdb\u7a0b\u8d85\u65f6 \uff0c \u53ef\u4ee5\u7528\u4e0b\u9762\u76844\u4e2a\u9009\u9879 \u3002 \u53ef\u4ee5\u4f7f\u5904\u4e8eBACKUP\u72b6\u6001\u7684VRRP\u5b9e\u4f8b\u53d8\u6210MASTER\u72b6\u6001 \uff0c \u5373\u4f7fMASTER\u5b9e\u4f8b\u4f9d\u7136\u5728\u8fd0\u884c \u3002 \u56e0\u4e3aMASTER\u6216BACKUP\u7cfb\u7edf\u6bd4\u8f83\u6162 \uff0c \u4e0d\u80fd\u53ca\u65f6\u5904\u7406VRRP\u6570\u636e\u5305 \u3002 vrrp_priority <- 20 -- 19>\uff1a\u8bbe\u7f6eVRRP\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u3002 checker_priority <- 20 -- 19>\uff1a\u8bbe\u7f6echecker\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u3002 vrrp_no_swap \uff1a vrrp\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362 \u3002 checker_no_swap \uff1a checker\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362 \u3002 script_user < username > [ groupname ] \uff1a \u8bbe\u7f6e\u8fd0\u884c\u811a\u672c\u9ed8\u8ba4\u7528\u6237\u548c\u7ec4 \u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9a \uff0c \u5219\u9ed8\u8ba4\u7528\u6237\u4e3akeepalived_script ( \u9700\u8981\u8be5\u7528\u6237\u5b58\u5728 ) \uff0c \u5426\u5219\u4e3aroot\u7528\u6237 \u3002 \u9ed8\u8ba4groupname\u540cusername \u3002 enable_script_security \uff1a \u5982\u679c\u811a\u672c\u8def\u5f84\u7684\u4efb\u4e00\u90e8\u5206\u5bf9\u4e8e\u975eroot\u7528\u6237\u6765\u8bf4 \uff0c \u90fd\u5177\u6709\u53ef\u5199\u6743\u9650 \uff0c \u5219\u4e0d\u4f1a\u4ee5root\u8eab\u4efd\u8fd0\u884c\u811a\u672c \u3002 nopreempt \u9ed8\u8ba4\u662f\u62a2\u5360\u6a21\u5f0f \u8981\u662f\u7528\u975e\u62a2\u5360\u5f0f\u7684\u5c31\u52a0\u4e0anopreempt \u6ce8\u610f \uff1a \u4e0a\u8ff0\u4e3aglobal_defs\u4e2d\u7684\u6307\u4ee4 VRRPD\u914d\u7f6e\u5305\u542b\u5982\u4e0b\u5b50\u5757 \u00b6 vrrp_script vrrp_sync_group vrrp_instance \u4f5c\u7528 \uff1a \u6dfb\u52a0\u4e00\u4e2a\u5468\u671f\u6027\u6267\u884c\u7684\u811a\u672c \u3002 \u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u4f1a\u88ab\u8c03\u7528\u5b83\u7684\u6240\u6709\u7684VRRP Instance\u8bb0\u5f55 \u3002 \u6ce8\u610f \uff1a \u81f3\u5c11\u6709\u4e00\u4e2aVRRP\u5b9e\u4f8b\u8c03\u7528\u5b83\u5e76\u4e14\u4f18\u5148\u7ea7\u4e0d\u80fd\u4e3a0 . \u4f18\u5148\u7ea7\u8303\u56f4\u662f1 - 254. vrrp_script < SCRIPT_NAME > { ... } \u9009\u9879\u8bf4\u660e \uff1a scrip \"/path/to/somewhere\" \uff1a \u6307\u5b9a\u8981\u6267\u884c\u7684\u811a\u672c\u7684\u8def\u5f84 \u3002 interval < INTEGER > \uff1a \u6307\u5b9a\u811a\u672c\u6267\u884c\u7684\u95f4\u9694 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 \u9ed8\u8ba4\u4e3a1s \u3002 timeout < INTEGER > \uff1a \u6307\u5b9a\u5728\u591a\u5c11\u79d2\u540e \uff0c \u811a\u672c\u88ab\u8ba4\u4e3a\u6267\u884c\u5931\u8d25 \u3002 weight <- 254 --- 254>\uff1a\u8c03\u6574\u4f18\u5148\u7ea7\u3002\u9ed8\u8ba4\u4e3a2. rise < INTEGER > \uff1a \u6267\u884c\u6210\u529f\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u662f\u6210\u529f \u3002 fall < INTEGER > \uff1a \u6267\u884c\u5931\u8d25\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u5931\u8d25 \u3002 user < USERNAME > [ GROUPNAME ] \uff1a \u8fd0\u884c\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4 \u3002 init_fail \uff1a \u5047\u8bbe\u811a\u672c\u521d\u59cb\u72b6\u6001\u662f\u5931\u8d25\u72b6\u6001 \u3002 \u89e3\u91ca \uff1a weight \uff1a 1. \u5982\u679c\u811a\u672c\u6267\u884c\u6210\u529f ( \u9000\u51fa\u72b6\u6001\u7801\u4e3a0 ) \uff0c weight\u5927\u4e8e0 \uff0c \u5219priority\u589e\u52a0 \u3002 2. \u5982\u679c\u811a\u672c\u6267\u884c\u5931\u8d25 ( \u9000\u51fa\u72b6\u6001\u7801\u4e3a\u975e0 ) \uff0c weight\u5c0f\u4e8e0 \uff0c \u5219priority\u51cf\u5c11 \u3002 3. \u5176\u4ed6\u60c5\u51b5\u4e0b \uff0c priority\u4e0d\u53d8 \u3002 \u4f5c\u7528 \uff1a \u5c06\u6240\u6709\u76f8\u5173\u7684VRRP\u5b9e\u4f8b\u5b9a\u4e49\u5728\u4e00\u8d77 \uff0c \u4f5c\u4e3a\u4e00\u4e2aVRRP Group \uff0c \u5982\u679c\u7ec4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b9e\u4f8b\u51fa\u73b0\u95ee\u9898 \uff0c \u90fd\u53ef\u4ee5\u5b9e\u73b0Failover \u3002 vrrp_sync_group VG_1 { group { inside_network # vrrp instance name outside_network # vrrp instance name ... } ... } \u8bf4\u660e \uff1a \u5982\u679cusername\u548cgroupname\u6ca1\u6709\u6307\u5b9a \uff0c \u5219\u4ee5\u9ed8\u8ba4\u7684script_user\u6240\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4 \u3002 1. notify_master / path / to_master . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u6210\u4e3aMASTER\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 2. notify_backup / path / to_backup . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u6210\u4e3aBACKUP\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 3. notify_fault \"/path/fault.sh VG_1\" [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u8be5\u540c\u6b65\u7ec4Fault\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 4. notify / path / notify . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5728\u4efb\u4f55\u72b6\u6001\u90fd\u4f1a\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 \u8bf4\u660e \uff1a \u8be5\u811a\u672c\u4f1a\u5728notify_ * \u811a\u672c\u540e\u6267\u884c \u3002 notify\u53ef\u4ee5\u4f7f\u75283\u4e2a\u53c2\u6570 \uff0c \u5982\u4e0b \uff1a $ 1 \uff1a \u53ef\u4ee5\u662fGROUP\u6216INTANCE \uff0c \u8868\u660e\u540e\u9762\u662f\u7ec4\u8fd8\u662f\u5b9e\u4f8b \u3002 $ 2 \uff1a \u7ec4\u540d\u6216\u5b9e\u4f8b\u540d \u3002 $ 3 \uff1a \u8f6c\u6362\u540e\u7684\u76ee\u6807\u72b6\u6001 \u3002 \u6709 \uff1a MASTER \u3001 BACKUP \u3001 FAULT \u3002 5. smtp_alert \uff1a \u5f53\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6 \uff0c \u53d1\u9001\u90ae\u4ef6 \u3002 6. global_tracking \uff1a \u6240\u6709\u7684VRRP\u5b9e\u4f8b\u5171\u4eab\u76f8\u540c\u7684tracking\u914d\u7f6e \u3002 \u6ce8\u610f \uff1a \u811a\u672c\u6587\u4ef6\u8981\u52a0\u4e0ax\u6743\u9650 \uff0c \u540c\u65f6\u6307\u4ee4\u6700\u597d\u5199\u7edd\u5bf9\u8def\u5f84 \u3002 \u547d\u4ee4\u8bf4\u660e \uff1a state MASTER | BACKUP \uff1a \u6307\u5b9a\u8be5keepalived\u8282\u70b9\u7684\u521d\u59cb\u72b6\u6001 \u3002 interface eth0 \uff1a vrrp\u5b9e\u4f8b\u7ed1\u5b9a\u7684\u63a5\u53e3 \uff0c \u7528\u4e8e\u53d1\u9001VRRP\u5305 \u3002 use_vmac [ <VMAC_INTERFACE> ] \uff1a \u5728\u6307\u5b9a\u7684\u63a5\u53e3\u4ea7\u751f\u4e00\u4e2a\u5b50\u63a5\u53e3 \uff0c \u5982vrrp .51 \uff0c \u8be5\u63a5\u53e3\u7684MAC\u5730\u5740\u4e3a\u7ec4\u64ad\u5730\u5740 \uff0c \u901a\u8fc7\u8be5\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u5305 \u3002 vmac_xmit_base \uff1a \u901a\u8fc7\u57fa\u672c\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u6570\u636e\u5305 \uff0c \u800c\u4e0d\u662f\u901a\u8fc7VMAC\u63a5\u53e3 \u3002 native_ipv6 \uff1a \u5f3a\u5236VRRP\u5b9e\u4f8b\u4f7f\u7528IPV6 .( \u5f53\u540c\u65f6\u914d\u7f6e\u4e86IPV4\u548cIPV6\u7684\u65f6\u5019 ) dont_track_primary \uff1a \u5ffd\u7565VRRP\u63a5\u53e3\u7684\u9519\u8bef \uff0c \u9ed8\u8ba4\u662f\u6ca1\u6709\u914d\u7f6e\u7684 \u3002 track_interface { eth0 eth1 weight <- 254 - 254 > ... }\uff1a \u5982\u679ctrack\u7684\u63a5\u53e3\u6709\u4efb\u4f55\u4e00\u4e2a\u51fa\u73b0\u6545\u969c \uff0c \u90fd\u4f1a\u8fdb\u5165FAULT\u72b6\u6001 \u3002 track_script { < SCRIPT_NAME > < SCRIPT_NAME > weight <- 254 - 254 > }\uff1a \u6dfb\u52a0\u4e00\u4e2atrack\u811a\u672c ( vrrp_script\u914d\u7f6e\u7684\u811a\u672c \u3002 ) mcast_src_ip < IPADDR > \uff1a \u6307\u5b9a\u53d1\u9001\u7ec4\u64ad\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740 \u3002 unicast_src_ip < IPADDR > \uff1a \u6307\u5b9a\u53d1\u9001\u5355\u8584\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740 \u3002 version 2 | 3 \uff1a \u6307\u5b9a\u8be5\u5b9e\u4f8b\u6240\u4f7f\u7528\u7684VRRP\u7248\u672c \u3002 unicast_peer { < IPADDR > ... }\uff1a \u91c7\u7528\u5355\u64ad\u7684\u65b9\u5f0f\u53d1\u9001VRRP\u901a\u544a \uff0c \u6307\u5b9a\u5355\u64ad\u90bb\u5c45\u7684IP\u5730\u5740 \u3002 virtual_router_id 51 \uff1a \u6307\u5b9aVRRP\u5b9e\u4f8bID \uff0c \u8303\u56f4\u662f0 - 255. priority 100 \uff1a \u6307\u5b9a\u4f18\u5148\u7ea7 \uff0c \u4f18\u5148\u7ea7\u9ad8\u7684\u5c06\u6210\u4e3aMASTER \u3002 advert_int 1 \uff1a \u6307\u5b9a\u53d1\u9001VRRP\u901a\u544a\u7684\u95f4\u9694 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 authentication { auth_type PASS | AH \uff1a \u6307\u5b9a\u8ba4\u8bc1\u65b9\u5f0f \u3002 PASS\u7b80\u5355\u5bc6\u7801\u8ba4\u8bc1 ( \u63a8\u8350 ), AH : IPSEC\u8ba4\u8bc1 ( \u4e0d\u63a8\u8350 ) \u3002 auth_pass 1234 \uff1a \u6307\u5b9a\u8ba4\u8bc1\u6240\u4f7f\u7528\u7684\u5bc6\u7801 \u3002 \u6700\u591a8\u4f4d \u3002 } virtual_ipaddress { < IPADDR >/< MASK > brd < IPADDR > dev < STRING > scope < SCOPE > label < LABEL > 192.168.200.17 / 24 dev eth1 192.168.200.18 / 24 dev eth2 label eth2 : 1 }\uff1a \u6307\u5b9aVIP\u5730\u5740 \u3002 nopreempt \uff1a \u8bbe\u7f6e\u4e3a\u4e0d\u62a2\u5360 \u3002 \u9ed8\u8ba4\u662f\u62a2\u5360\u7684 \uff0c \u5f53\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6062\u590d\u540e \uff0c \u4f1a\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6210\u4e3aMASTER \uff0c \u800c\u4e0d\u62a2\u5360 \uff0c \u5219\u5141\u8bb8\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u7ee7\u7eed\u6210\u4e3aMASTER \uff0c \u5373\u4f7f\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u5df2\u7ecf\u4e0a\u7ebf \u3002 \u5982\u679c\u8981\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd \uff0c \u5219\u521d\u59cb\u5316\u72b6\u6001\u5fc5\u987b\u4e3aBACKUP \u3002 preempt_delay \uff1a \u8bbe\u7f6e\u62a2\u5360\u5ef6\u8fdf \u3002 \u5355\u4f4d\u662f\u79d2 \uff0c \u8303\u56f4\u662f0 ---1000\uff0c\u9ed8\u8ba4\u662f0.\u53d1\u73b0\u4f4e\u4f18\u5148\u7ea7\u7684MASTER\u540e\u591a\u5c11\u79d2\u5f00\u59cb\u62a2\u5360\u3002 \u901a\u77e5\u811a\u672c \uff1a notify_master < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify_backup < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify_fault < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify < STRING >|< QUOTED - STRING > [ username [groupname ] ] # \u5f53\u505c\u6b62VRRP\u65f6\u6267\u884c\u7684\u811a\u672c \u3002 notify_stop < STRING >|< QUOTED - STRING > [ username [groupname ] ] smtp_alert LVS\u914d\u7f6e \u00b6 virtual_server IP Port | virtual_server fwmark int | virtual_server group string { delay_loop < INT > \uff1a\u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4\u95f4\u9694\u3002 lb_argo rr | wrr | lc | wlc | lblc | sh | dh \uff1a LVS\u8c03\u5ea6\u7b97\u6cd5 \u3002 lb_kind NAT | DR | TUN \uff1a LVS\u6a21\u5f0f \u3002 persistence_timeout 360 \uff1a\u6301\u4e45\u5316\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2\u3002\u9ed8\u8ba4\u662f 6 \u5206\u949f\u3002 persistence_granularity \uff1a\u6301\u4e45\u5316\u8fde\u63a5\u7684\u9897\u7c92\u5ea6\u3002 protocol TCP | UDP | SCTP \uff1a 4 \u5c42\u534f\u8bae\u3002 ha_suspend \uff1a\u5982\u679c virtual server\u7684IP\u5730\u5740\u6ca1\u6709\u8bbe\u7f6e \uff0c\u5219\u4e0d\u8fdb\u884c\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u67e5\u3002 virtualhost < STRING > \uff1a\u4e3a HTTP_GET\u548cSSL_GET\u6267\u884c\u8981\u68c0\u67e5\u7684\u865a\u62df\u4e3b\u673a \u3002\u5982 virtualhost www . felix . com sorry_server < IPADDR > < PORT > \uff1a\u6dfb\u52a0\u4e00\u4e2a\u5907\u7528\u670d\u52a1\u5668\u3002\u5f53\u6240\u6709\u7684 RS\u90fd\u6545\u969c\u65f6 \u3002 sorry_server_inhibit \uff1a\u5c06 inhibit_on_failure\u6307\u4ee4\u5e94\u7528\u4e8esorry_server\u6307\u4ee4 \u3002 alpha \uff1a\u5728 keepalived\u542f\u52a8\u65f6 \uff0c\u5047\u8bbe\u6240\u6709\u7684 RS\u90fd\u662fdown \uff0c\u4ee5\u53ca\u5065\u5eb7\u68c0\u67e5\u662f\u5931\u8d25\u7684\u3002\u6709\u52a9\u4e8e\u9632\u6b62\u542f\u52a8\u65f6\u7684\u8bef\u62a5\u3002\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002 omega \uff1a\u5728 keepalived\u7ec8\u6b62\u65f6 \uff0c\u4f1a\u6267\u884c quorum_down\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u811a\u672c \u3002 quorum < INT > \uff1a\u9ed8\u8ba4\u503c 1 . \u6240\u6709\u7684\u5b58\u6d3b\u7684\u670d\u52a1\u5668\u7684\u603b\u7684\u6700\u5c0f\u6743\u91cd\u3002 quorum_up < STRING > \uff1a\u5f53 quorum\u589e\u957f\u5230\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6 \uff0c\u6267\u884c\u8be5\u811a\u672c\u3002 quorum_down < STRING > \uff1a\u5f53 quorum\u51cf\u5c11\u5230\u4e0d\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6 \uff0c\u6267\u884c\u8be5\u811a\u672c\u3002 } real_server IP Port { weight < INT > \uff1a \u7ed9\u670d\u52a1\u5668\u6307\u5b9a\u6743\u91cd \u3002 \u9ed8\u8ba4\u662f1 . inhibit_on_failure \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6 \uff0c \u5c06\u5176weight\u8bbe\u7f6e\u4e3a0 \uff0c \u800c\u4e0d\u662f\u4eceVirtual Server\u4e2d\u79fb\u9664 \u3002 notify_up < STRING > \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u6210\u529f\u65f6 \uff0c \u6267\u884c\u7684\u811a\u672c \u3002 notify_down < STRING > \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6 \uff0c \u6267\u884c\u7684\u811a\u672c \u3002 uthreshold < INT > \uff1a \u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5927\u8fde\u63a5\u6570 \u3002 lthreshold < INT > \uff1a \u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5c0f\u8fde\u63a5\u6570 \u3002 } # real_server\u4e2d\u7684\u5065\u5eb7\u68c0\u67e5 HTTP_GET | SSL_GET { url { path < STRING > \uff1a \u6307\u5b9a\u8981\u68c0\u67e5\u7684URL\u7684\u8def\u5f84 \u3002 \u5982path / or path / mrtg2 digest < STRING > \uff1a \u6458\u8981 \u3002 \u8ba1\u7b97\u65b9\u5f0f \uff1a genhash - s 172.17.100.1 - p 80 - u / index . html status_code < INT > \uff1a \u72b6\u6001\u7801 \u3002 } nb_get_retry < INT > \uff1a get\u5c1d\u8bd5\u6b21\u6570 \u3002 delay_before_retry < INT > \uff1a \u5728\u5c1d\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u957f\u65f6\u95f4 \u3002 connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 } TCP_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INIT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 \u9ed8\u8ba4\u662f1\u6b21 \u3002 delay_before_retry < INT > \uff1a \u9ed8\u8ba4\u662f1\u79d2 \u3002 \u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2 \u3002 } SMTP_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 delay_before_retry < INT > \uff1a \u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2 \u3002 helo_name < STRING > \uff1a \u7528\u4e8eSMTP HELO\u8bf7\u6c42\u7684\u5b57\u7b26\u4e32 \u3002 } DNS_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 \u9ed8\u8ba4\u662f3\u6b21 \u3002 type < STRING > \uff1a DNS query type \u3002 A / NS / CNAME / SOA / MX / TXT / AAAA name < STRING > \uff1a DNS\u67e5\u8be2\u7684\u57df\u540d \u3002 \u9ed8\u8ba4\u662f (.) } MISC_CHECK { misc_path < STRING > \uff1a \u5916\u90e8\u7684\u811a\u672c\u6216\u7a0b\u5e8f\u8def\u5f84 \u3002 misc_timeout < INT > \uff1a \u811a\u672c\u6267\u884c\u8d85\u65f6\u65f6\u95f4 \u3002 user USERNAME [ GROUPNAME ] \uff1a \u6307\u5b9a\u8fd0\u884c\u8be5\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4 \u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9aGROUPNAME \uff0c \u5219GROUPNAME\u540cUSERNAME \u3002 misc_dynamic \uff1a \u6839\u636e\u9000\u51fa\u72b6\u6001\u7801\u52a8\u6001\u8c03\u6574\u6743\u91cd \u3002 0 \uff0c \u5065\u5eb7\u68c0\u67e5\u6210\u529f \uff0c \u6743\u91cd\u4e0d\u53d8 \u3002 1 \uff0c \u5065\u5eb7\u68c0\u67e5\u5931\u8d25 \u3002 2 - 255 \uff0c \u5065\u5eb7\u68c0\u67e5\u6210\u529f \u3002 \u6743\u91cd\u8bbe\u7f6e\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u51cf\u53bb2 . \u5982\u9000\u51fa\u72b6\u6001\u7801\u662f250 \uff0c \u5219\u6743\u91cd\u8c03\u6574\u4e3a248 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 } \u4fee\u6539Keepalived\u65e5\u5fd7 \u00b6 # keepalived \u9ed8\u8ba4\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7 / var / log / messages \u4e2d vi / etc / sysconfig / keepalived # Options for keepalived . See ` keepalived -- help ' output and keepalived(8) and # keepalived . conf ( 5 ) man pages for a list of all options . Here are the most # common ones : # # -- vrrp - P Only run with VRRP subsystem . # -- check - C Only run with Health - checker subsystem . # -- dont - release - vrrp - V Dont remove VRRP VIPs & VROUTEs on daemon stop . # -- dont - release - ipvs - I Dont remove IPVS topology on daemon stop . # -- dump - conf - d Dump the configuration data . # -- log - detail - D Detailed log messages . # -- log - facility - S 0 - 7 Set local syslog facility ( default = LOG_DAEMON )( \u65e5\u5fd7\u7684\u7ea7\u522b ) # # \u628a KEEPALIVED_OPTIONS = \u201d - D \u201d \u4fee\u6539\u4e3a KEEPALIVED_OPTIONS = \u201d - D - d - S 0 \u201d\uff0c\u5176\u4e2d - S \u6307\u5b9a syslog \u7684 facility KEEPALIVED_OPTIONS = \" -D -d -S 0 \" # \u4fee\u6539 / etc / rsyslog . conf \u672b\u5c3e\u6dfb\u52a0 vi / etc / rsyslog . conf local0 . * / var / log / keepalived . log # \u91cd\u542f\u65e5\u5fd7\u8bb0\u5f55\u670d\u52a1 systemctl restart rsyslog # \u91cd\u542f keepalived systemctl restart keepalived \u65e5\u5fd7\u7ea7\u522b\uff1a\u6307\u5b9a\u89e6\u53d1\u65e5\u5fd7\u4e8b\u4ef6\u7684\u7ea7\u522b LVS-NAT+Keepalived\u4e3b\u4ece\u90e8\u7f72\u793a\u4f8b \u00b6 LVS-DR\u4fee\u6539virtual_server\u4e0blb_kind NAT\u53c2\u6570\u4e3alb_kind DR(LVS-DR\u4e3a\u5e38\u7528\u65b9\u5f0f) IP\u5730\u5740 \u4e3b\u673a\u540d \u7c7b\u578b 1.1.1.10 LVS-Master VIP 192.168.1.10 LVS-Master DIP 1.1.1.20 LVS-Backup VIP 192.168.1.20 LVS-Backup DIP 192.168.1.100 Web-node1 realserver1 192.168.1.200 Web-node2 realserver2 1.1.1.131 client client \u516c\u7f51\u6d6e\u52a8IP\uff1a1.1.1.1 \u5185\u7f51\u6d6e\u52a8IP\uff1a192.168.1.1 eth0:1.1.1.10 ___________ ___________ VIP | | | | | LVS-Master|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node1 |192.168.1.100 |___________| /|_________ | eth1:192.168.1.10 | /| DIP | / ________ | / | | | \\/ | client |\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014 /\\ |________| | / \\ | / \\ | / \\ eth0:1.1.1.20 |____ / \\/__________ VIP | | | | | LVS-Backup|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node2 |192.168.1.200 DIP |___________| /|___________| eth1:192.168.1.20 LVS\u670d\u52a1\u5668\u4e0a\u914d\u7f6eIP \u00b6 vim /etc/sysconfig/network-scripts/ifcfg-eth0 vim /etc/sysconfig/network-scripts/ifcfg-eth1 # \u4fee\u6539\u5185\u6838\u53c2\u6570 vim /etc/sysctl.conf net.ipv4.ip_forward = 1 net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.default.send_redirects = 0 net.ipv4.conf.eth0.send_redirects = 0 sysctl -p # realserver\u5206\u522b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 # \u7ed1\u5b9avip(centos6) ifconfig lo:0 1 .1.1.1 netmask 255 .255.255.255 broadcast 1 .1.1.1 # (centos7) ip a a 1 .1.1.1/24 dev lo:0 # arp\u6291\u5236 echo \"1\" >/proc/sys/net/ipv4/conf/lo/arp_ignore echo \"2\" >/proc/sys/net/ipv4/conf/lo/arp_announce echo \"1\" >/proc/sys/net/ipv4/conf/all/arp_ignore echo \"2\" >/proc/sys/net/ipv4/conf/all/arp_announce # arp_ignore:\u5b9a\u4e49\u63a5\u6536\u5230ARP\u8bf7\u6c42\u65f6\u7684\u54cd\u5e94\u7ea7\u522b 0 \uff1a\u53ea\u8981\u672c\u5730\u914d\u7f6e\u7684\u6709\u5bf9\u5e94\u5730\u5740\uff0c\u5c31\u7ed9\u4e88\u56de\u5e94\uff1b\u9ed8\u8ba4 1 \uff1a\u4ec5\u5728\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u5740\u914d\u7f6e\u5728\u5230\u8fbe\u7684\u63a5\u53e3\u4e0a\u65f6\uff0c\u624d\u7ed9\u4e88\u56de\u5e94 # arp_announce\uff1a\u5b9a\u4e49\u5c06\u81ea\u5df1\u7684\u5730\u5740\u5411\u5916\u901a\u544a\u65f6\u7684\u901a\u544a\u7ea7\u522b 0 \uff1a\u5c06\u672c\u5730\u4efb\u4f55\u63a5\u53e3\u4e0a\u7684\u4efb\u4f55\u5730\u5740\u5411\u5916\u901a\u544a\uff1b\u9ed8\u8ba4 1 \uff1a\u8bd5\u56fe\u4ec5\u5411\u76ee\u6807\u7f51\u7edc\u901a\u544a\u5176\u7f51\u7edc\u5339\u914d\u7684\u5730\u5740 2 \uff1a\u4ec5\u5411\u4e0e\u672c\u5730\u63a5\u53e3\u4e0a\u5730\u5740\u5339\u914d\u7684\u7f51\u7edc\u8fdb\u884c\u901a\u544a # \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u76f8\u540c\u7684\u914d\u7f6e\u9879 vrrp_instance VI_1 virtual_router_id 51 auth_type PASS auth_pass 1111 virtual_ipaddress # \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u4e0d\u76f8\u540c\u7684\u914d\u7f6e\u9879 router_id id1 state MASTER priority 100 # \u4e0a\u8ff0\u7b80\u5316\u8bbe\u7f6e--\u5728realserver\u521b\u5efa\u811a\u672crs.sh #!/bin/bash #\u9002\u7528\u4e8ecentos6 vip1 = 1 .1.1.10 vip2 = 1 .1.1.20 dev1 = lo:1 dev2 = lo:2 case $1 in start ) echo 1 > /proc/sys/net/ipv4/conf/all/arp_ignore echo 1 > /proc/sys/net/ipv4/conf/lo/arp_ignore echo 2 > /proc/sys/net/ipv4/conf/all/arp_announce echo 2 > /proc/sys/net/ipv4/conf/lo/arp_announce ifconfig $dev1 $vip1 netmask 255 .255.255.255 broadcast $vip up ifconfig $dev2 $vip2 netmask 255 .255.255.255 broadcast $vip2 up sysctl -p >/dev/null 2 > & 1 echo \"VS Server is Ready!\" ;; stop ) ifconfig $dev down echo 0 > /proc/sys/net/ipv4/conf/all/arp_ignore echo 0 > /proc/sys/net/ipv4/conf/lo/arp_ignore echo 0 > /proc/sys/net/ipv4/conf/all/arp_announce echo 0 > /proc/sys/net/ipv4/conf/lo/arp_announce echo \"VS Server is Cancel!\" ;; * ) echo \"Usage `basename $0 ` start|stop\" exit 1 ;; esac LVS\u670d\u52a1\u5668\u4e0a\u5206\u522b\u5b89\u88c5\u5e76\u914d\u7f6ekeepalived \u00b6 \u4e3bLVS\u914d\u7f6ekeepalived.conf \u00b6 global_defs { notification_email { your_email@qq.com # \u90ae\u4ef6\u53d1\u751f\u76ee\u7684\u4eba } notification_email_from keepalived@localhost smtp_server 127 .0.0.1 #\u672c\u673a\u90ae\u4ef6\u670d\u52a1\u5668 smtp_connect_timeout 30 #\u8d85\u65f6\u65f6\u95f4 router_id LVS_R1 # \u6807\u8bc6\u670d\u52a1\u5668ID } vrrp_sync_group VG1 { # \u8bbe\u7f6e\u5b9e\u4f8b\u7ec4 group { VI_1 VI_2 } } vrrp_instance VI_1 { # \u5b9e\u4f8b\u540d\u79f0\uff0c\u5b9e\u4f8b\u53ef\u4ee5\u4e00\u4e2a\uff0c\u4e5f\u53ef\u591a\u4e2a state MASTER # \u4e3bLVS\u670d\u52a1\u5668 interface eth0 # \u7f51\u5361\u63a5\u53e3 virtual_router_id 1 # \u670d\u52a1\u5668id priority 100 # \u4f18\u5148\u7ea7(0~255) advert_int 1 # \u5fc3\u8df3\u68c0\u6d4b1\u79d2\u6bcf\u6b21 authentication { # \u8bbe\u7f6e\u9a8c\u8bc1\uff0cmaster\u548cbackup\u5fc5\u987b\u76f8\u540c auth_type PASS # \u57fa\u4e8e\u5bc6\u7801\u9a8c\u8bc1\u7c7b\u578b auth_pass 1111 # \u5bc6\u7801 } virtual_ipaddress { 1 .1.1.1 # \u516c\u7f51\u6d6e\u52a8IP } } vrrp_instance VI_2 { state MASTER interface eth1 virtual_router_id 1 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192 .168.1.1 # \u5185\u7f51\u6d6e\u52a8IP } } virtual_server 1 .1.1.1 80 { delay_loop 15 # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4 lb_algo rr # \u8c03\u5ea6\u7b97\u6cd5 lb_kind NAT # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u8c03\u5ea6\u65b9\u5f0f protocol TCP real_server 192 .168.1.100 80 { weight 1 # \u6743\u91cd\u503c TCP_CHECK { # \u5065\u5eb7\u68c0\u67e5\u65b9\u5f0f connect_port 80 # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3 connect_timeout 3 # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4 nb_get_retry 3 # \u91cd\u8bd5\u6b21\u6570 delay_before_retry 4 # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4 } } real_server 192 .168.1.200 80 { weight 1 TCP_CHECK { connect_port 80 connect_timeout 3 nb_get_retry 3 delay_before_retry 4 } } } \u4eceLVS\u914d\u7f6e \u00b6 global_defs { router_id LVS_R1 } vrrp_sync_group VG1 { group { VI_1 VI_2 } } vrrp_instance VI_1 { state BACKUP interface eth0 virtual_router_id 1 priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 1 .1.1.1 } } vrrp_instance VI_2 { state BACKUP interface eth1 virtual_router_id 1 priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192 .168.1.1 } } virtual_server 1 .1.1.1 80 { delay_loop 15 # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4 lb_algo rr # \u8c03\u5ea6\u7b97\u6cd5 lb_kind NAT # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u6a21\u5f0f protocol TCP real_server 192 .168.1.100 80 { weight 1 # \u6743\u91cd\u503c TCP_CHECK { connect_port 80 # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3 connect_timeout 3 # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4 nb_get_retry 3 # \u91cd\u8bd5\u6b21\u6570 delay_before_retry 4 # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4 } } real_server 192 .168.1.200 80 { weight 1 TCP_CHECK { connect_port 80 connect_timeout 3 nb_get_retry 3 delay_before_retry 4 } } } \u521b\u5efa\u901a\u7528\u5355\u72ec\u7684\u68c0\u67e5\u90ae\u4ef6\u63d0\u9192\u811a\u672clvs_notify.sh \u00b6 #!/bin/bash contact = 'your_email_address' notify () { local mailsubject = \" $( hostname ) to be $1 , vip floating\" local mailbody = \" $( date + '%F %T' ) : vrrp transition, $( hostname ) changed to be $1 \" echo \" $mailbody \" | mail -s \" $mailsubject \" $contact } case $1 in master ) notify master ;; backup ) notify backup ;; fault ) notify fault ;; * ) echo \"Usage: $( basename $0 ) {master|backup|fault}\" exit 1 ;; esac","title":"LVS"},{"location":"LVS/#linux-virtual-server","text":"Linux\u865a\u62df\u670d\u52a1\u5668\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u6269\u5c55\u4e14\u9ad8\u5ea6\u53ef\u7528\u7684\u670d\u52a1\u5668 \uff0c\u6784\u5efa\u5728\u771f\u5b9e\u670d\u52a1\u5668\u96c6\u7fa4\u4e0a\u3002\u670d\u52a1\u5668\u7fa4\u96c6\u7684\u4f53\u7cfb\u7ed3\u6784\u5bf9\u6700\u7ec8\u7528\u6237\u5b8c\u5168\u900f\u660e\uff0c\u7528\u6237\u4e0e\u7fa4\u96c6\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\uff0c \u5c31\u597d\u50cf\u5b83\u53ea\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u865a\u62df\u670d\u52a1\u5668\u4e00\u6837 \u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5e73\u8861\u5668\u53ef\u4ee5\u901a\u8fc7\u9ad8\u901f LAN\u6216\u5730\u7406\u4e0a\u5206\u6563\u7684WAN\u4e92\u8fde \u3002\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u5c06\u8bf7\u6c42\u5206\u6d3e\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4f7f\u7fa4\u96c6\u7684\u5e76\u884c\u670d\u52a1\u5728\u5355\u4e2a IP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1 \uff0c\u8bf7\u6c42\u5206\u6d3e\u53ef\u4ee5\u4f7f\u7528 IP\u8d1f\u8f7d\u5e73\u8861\u6280\u672f\u6216\u5e94\u7528\u7ea7\u8d1f\u8f7d\u5747\u8861\u6280\u672f \u3002\u901a\u8fc7\u900f\u660e\u5730\u6dfb\u52a0\u6216\u5220\u9664\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6765\u5b9e\u73b0\u7cfb\u7edf\u7684\u53ef\u4f38\u7f29\u6027\u3002\u901a\u8fc7\u68c0\u6d4b\u8282\u70b9\u6216\u5b88\u62a4\u7a0b\u5e8f\u6545\u969c\u5e76\u9002\u5f53\u5730\u91cd\u65b0\u914d\u7f6e\u7cfb\u7edf\u6765\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3002 \u6784\u5efa\u670d\u52a1\u5668\u96c6\u7fa4\u65b9\u6cd5\uff1a DNS\u8d1f\u8f7d\u5e73\u8861 \uff1a \u7b80\u5355\uff0c\u5229\u7528\u57df\u540d\u7cfb\u7edf\u5c06\u57df\u540d\u89e3\u6790\u5230\u670d\u52a1\u5668\u4e0d\u540c\u7684 IP\u6765\u5206\u53d1\u8bf7\u6c42 \uff0c DNS\u670d\u52a1\u5668\u6839\u636e\u8c03\u5ea6\u7b56\u7565 ( \u5982\u5faa\u73af\u65b9\u5f0f ) \u53d1\u51fa\u670d\u52a1\u5668 IP\u5730\u5740 \uff0c\u7136\u540e\u4f7f\u7528\u76f8\u540c\u7684\u672c\u5730\u7f13\u5b58\u57df\u540d\u670d\u52a1\u5668\u5728\u6307\u5b9a\u7684\u57df\u540d\u89e3\u6790\u751f\u5b58\u65f6\u95f4 ( TTL ) \u4e2d\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u3002 \u4f46\u662f\uff0c\u7531\u4e8e\u5ba2\u6237\u7aef\u548c\u5206\u5c42 DNS\u7cfb\u7edf\u7684\u7f13\u5b58\u7279\u6027 \uff0c\u5f88\u5bb9\u6613\u5bfc\u81f4\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u6b64\u670d\u52a1\u5668\u4e0d\u5bb9\u6613\u5904\u7406\u5176\u5cf0\u503c\u8d1f\u8f7d\u3002\u5728 DNS\u670d\u52a1\u5668\u4e0a\u65e0\u6cd5\u5f88\u597d\u5730\u9009\u62e9\u540d\u79f0\u6620\u5c04\u7684TTL\u503c \uff0c\u5c0f\u503c DNS\u6d41\u91cf\u5f88\u9ad8\u4e14DNS\u670d\u52a1\u5668\u5c06\u6210\u4e3a\u74f6\u9888 \uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u503c\uff0c\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u5c06\u53d8\u5f97\u66f4\u7cdf\u3002\u5373\u4f7f TTL\u503c\u8bbe\u7f6e\u4e3a\u96f6 \uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u6bcf\u4e2a\u4e3b\u673a\uff0c\u4e0d\u540c\u7528\u6237\u7684\u8bbf\u95ee\u6a21\u5f0f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u4e3a\u6709\u4e9b\u4eba\u53ef\u80fd\u4ece\u7f51\u7ad9\u4e0a\u62bd\u53d6\u5927\u91cf\u9875\u9762\uff0c\u800c\u5176\u4ed6\u4eba\u53ef\u80fd\u53ea\u662f\u6d4f\u89c8\u51e0\u9875\u7136\u540e\u53bb\u8fdc\u3002\u6b64\u5916\uff0c\u5b83\u4e0d\u592a\u53ef\u9760\uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\uff0c\u5c06\u540d\u79f0\u6620\u5c04\u5230 IP\u5730\u5740\u7684\u5ba2\u6237\u7aef\u5c06\u53d1\u73b0\u670d\u52a1\u5668\u5df2\u5173\u95ed \u57fa\u4e8e\u8c03\u5ea6\u7a0b\u5e8f\u7684\u8d1f\u8f7d\u5e73\u8861\u7fa4\u96c6\uff1a \u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5206\u914d\u8d1f\u8f7d\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u7684\u5e76\u884c\u670d\u52a1\u53ef\u4ee5\u5728\u5355\u4e2a IP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1 \uff0c\u5e76\u4e14\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u50cf\u5355\u4e2a\u670d\u52a1\u5668\u4e00\u6837\u8fdb\u884c\u4ea4\u4e92\u4e0d\u77e5\u9053\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u670d\u52a1\u5668\u3002\u4e0e\u57fa\u4e8e DNS\u7684\u8d1f\u8f7d\u5e73\u8861\u76f8\u6bd4 \uff0c\u8c03\u5ea6\u7a0b\u5e8f\u53ef\u4ee5\u4ee5\u7cbe\u7ec6\u7684\u7c92\u5ea6\uff08\u4f8b\u5982\u6bcf\u4e2a\u8fde\u63a5\uff09\u8c03\u5ea6\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u5b9e\u73b0\u66f4\u597d\u7684\u8d1f\u8f7d\u5e73\u8861\u3002\u5f53\u4e00\u53f0\u6216\u591a\u53f0\u670d\u52a1\u5668\u53d1\u751f\u6545\u969c\u65f6\uff0c\u53ef\u4ee5\u5c4f\u853d\u6545\u969c\u3002\u670d\u52a1\u5668\u7ba1\u7406\u53d8\u5f97\u8d8a\u6765\u8d8a\u5bb9\u6613\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528\u670d\u52a1\u5668\u6216\u66f4\u591a\u670d\u52a1\u5668\uff0c\u8fd9\u4e0d\u4f1a\u4e2d\u65ad\u6700\u7ec8\u7528\u6237\u7684\u670d\u52a1\u3002 \u8d1f\u8f7d\u5747\u8861\u53ef\u4ee5\u5728\u4e24\u4e2a\u7ea7\u522b\u5b8c\u6210\uff0c\u5373\u5e94\u7528\u7ea7\u548c IP\u7ea7 \u3002\u5c06 HTTP\u8bf7\u6c42\u8f6c\u53d1\u5230\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540cWeb\u670d\u52a1\u5668 \uff0c\u83b7\u53d6\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u5176\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u7531\u4e8e\u5728\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u5904\u7406 HTTP\u8bf7\u6c42\u548c\u56de\u590d\u7684\u5f00\u9500\u5f88\u9ad8 \uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u6570\u91cf\u589e\u52a0\u5230 5 \u6216\u66f4\u591a\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u7ea7\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u65b0\u7684\u74f6\u9888\uff0c\u8fd9\u53d6\u51b3\u4e8e\u6bcf\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u7684\u541e\u5410\u91cf\u670d\u52a1\u5668 LinuxVirtualServer\u4ee5\u4e09\u79cdIP\u8d1f\u8f7d\u5747\u8861\u6280\u672f ( \u6570\u636e\u5305\u8f6c\u53d1\u65b9\u6cd5 ) \u5b9e\u73b0\u3002 1 . NAT\u65b9\u5f0f 2 . IP\u96a7\u9053 3 . \u76f4\u63a5\u8def\u7531 VS/NAT\uff0cVS/TUN\u548cVS/DR\u7684\u6bd4\u8f83\uff1a | \u5bf9\u6bd4\u65b9\u9762 | VS/NAT | VS/TUN | VS/DR | | :--------: | :--------: | :-------: | :--------: | | realserver | \u4efb\u4f55 | \u96a7\u9053 | \u975eARP\u8bbe\u5907 | | realserver network | \u79c1\u6709 | lan/wan | lan | | realserver numbers | low(10-20) | high | high | | realserver gateway | director | ownrouter | own router | | client connnects to | VIP | VIP | VIP | LVS\u96c6\u7fa4\u901a\u5e38\u91c7\u7528\u4e09\u8fde\u63a5\u67b6\u6784\uff1a \u4e09\u8fde\u63a5\u7ed3\u6784\u5305\u62ec\uff1a **\u8d1f\u8f7d\u5747\u8861\u5668**\u5b83\u662f\u6574\u4e2a\u96c6\u7fa4\u7cfb\u7edf\u7684\u524d\u7aef\u673a\u5668\uff0c\u5e76\u5728\u4e00\u7ec4\u670d\u52a1\u5668\u4e4b\u95f4\u5e73\u8861\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u8ba4\u4e3a\u6240\u6709\u670d\u52a1\u90fd\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u3002 **\u670d\u52a1\u5668\u7fa4\u96c6**\u5b83\u662f\u4e00\u7ec4\u8fd0\u884c\u5b9e\u9645\u7f51\u7edc\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u4f8b\u5982Web\uff0c\u90ae\u4ef6\uff0cFTP\uff0cDNS\u548c\u5a92\u4f53\u670d\u52a1\u3002 **\u5171\u4eab\u5b58\u50a8**\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5171\u4eab\u5b58\u50a8\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u53ef\u4ee5\u8f7b\u677e\u62e5\u6709\u76f8\u540c\u7684\u5185\u5bb9\u5e76\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\u3002 NAT: NAT(Network Address Translation)\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u5373\u5c06IP\u5730\u5740\u4ece\u4e00\u4e2a\u7ec4\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u7ec4\u7684\u529f\u80fd\u3002\u5f53\u5730\u5740\u6620\u5c04\u4e3aN\u5230N\u65f6\uff0c\u79f0\u4e3a\u9759\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362; \u5f53\u6620\u5c04\u662fM\u5230N\uff08M> N\uff09\u65f6\uff0c\u5b83\u88ab\u79f0\u4e3a\u52a8\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u3002\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u662f\u57fa\u672cNAT\u7684\u6269\u5c55\uff0c\u56e0\u4e3a\u8bb8\u591a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u88ab\u8f6c\u6362\u4e3a\u5355\u4e2a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u3002\u8fd9\u662fN-to-1\u6620\u5c04\uff0c\u5b9e\u73b0\u4e86Linux IP Masquerading(\u4f2a\u88c5)\u3002Linux\u4e0a\u7684NAT\u865a\u62df\u670d\u52a1\u5668\u662f\u901a\u8fc7\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u5b8c\u6210\u7684 \u5f53\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u670d\u52a1\u65f6\uff0c\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u8bf7\u6c42\u6570\u636e\u5305\uff08\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5916\u90e8IP\u5730\u5740\uff09\u5230\u8fbe\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u5982\u679c\u6839\u636e\u865a\u62df\u670d\u52a1\u5668\u89c4\u5219\u8868\u5339\u914d\u865a\u62df\u670d\u52a1\u5668\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u96c6\u7fa4\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u5c06\u76ee\u6807\u5730\u5740\u548c\u6570\u636e\u5305\u7684\u7aef\u53e3\u91cd\u5199\u4e3a\u6240\u9009\u670d\u52a1\u5668\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\uff0c\u5e76\u5c06\u6570\u636e\u5305\u8f6c\u53d1\u5230\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u91cd\u5199\u8be5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u56de\u590d\u6570\u636e\u5305\u8fd4\u56de\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u91cd\u5199\u4e3a\u865a\u62df\u670d\u52a1\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u5728\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 IP\u96a7\u9053\uff1a IP\u96a7\u9053\uff08IP\u5c01\u88c5\uff09\u662f\u4e00\u79cd\u5c06IP\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\u7684\u6280\u672f\uff0c\u5b83\u5141\u8bb8\u5c06\u53d1\u5f80\u4e00\u4e2aIP\u5730\u5740\u7684\u6570\u636e\u62a5\u5305\u88c5\u5e76\u91cd\u5b9a\u5411\u5230\u53e6\u4e00\u4e2aIP\u5730\u5740\u3002IP\u5c01\u88c5\u73b0\u5728\u901a\u5e38\u7528\u4e8e\u5916\u8054\u7f51\uff0c\u79fb\u52a8IP\uff0cIP\u591a\u64ad\uff0c\u96a7\u9053\u4e3b\u673a\u6216\u7f51\u7edc\u3002 \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u6839\u636e\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\uff0c\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u518d\u6b21\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u8be5\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u5c01\u88c5\u7684\u6570\u636e\u5305\u65f6\uff0c\u5b83\u4f1a\u89e3\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5904\u7406\u8bf7\u6c42\uff0c\u6700\u540e\u6839\u636e\u81ea\u5df1\u7684\u8def\u7531\u8868\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 \u76f4\u63a5\u8def\u7531: \u6b64\u8bf7\u6c42\u8c03\u5ea6\u65b9\u6cd5\u7c7b\u4f3c\u4e8eIBM\u7684NetDispatcher\u4e2d\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002\u865a\u62dfIP\u5730\u5740\u7531\u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u5171\u4eab\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u63a5\u53e3\u4e5f\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u7528\u4e8e\u63a5\u53d7\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u76f4\u63a5\u5c06\u6570\u636e\u5305\u8def\u7531\u5230\u9009\u5b9a\u7684\u670d\u52a1\u5668\u3002\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u7684\u975earp\u522b\u540d\u63a5\u53e3\u90fd\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u6216\u8005\u5c06\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u6570\u636e\u5305\u91cd\u5b9a\u5411\u5230\u672c\u5730\u5957\u63a5\u5b57\uff0c\u4ee5\u4fbf\u771f\u5b9e\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u672c\u5730\u5904\u7406\u6570\u636e\u5305\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u771f\u5b9e\u670d\u52a1\u5668\u5fc5\u987b\u901a\u8fc7HUB / Switch\u7269\u7406\u8fde\u63a5\u5176\u4e2d\u4e00\u4e2a\u63a5\u53e3\u3002\u901a\u8fc7\u76f4\u63a5\u8def\u7531\u7684\u865a\u62df\u670d\u52a1\u5668\u7684\u4f53\u7cfb\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\uff08LinuxDirector\uff09\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u76f4\u63a5\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u8be5\u6570\u636e\u5305\u5c06\u518d\u6b21\u76f4\u63a5\u8def\u7531\u5230\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u8f6c\u53d1\u7684\u6570\u636e\u5305\u65f6\uff0c\u670d\u52a1\u5668\u53d1\u73b0\u8be5\u6570\u636e\u5305\u662f\u7528\u4e8e\u5176\u522b\u540d\u63a5\u53e3\u4e0a\u7684\u5730\u5740\u6216\u672c\u5730\u5957\u63a5\u5b57\u7684\u5730\u5740\uff0c\u6240\u4ee5\u5b83\u5904\u7406\u8bf7\u6c42\u5e76\u6700\u7ec8\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664\u3002 \u4f5c\u4e1a\u8c03\u5ea6\u7b97\u6cd5\uff1a \u5faa\u73af\u8c03\u5ea6Round Robin PR \u52a0\u6743\u5faa\u73af\u8c03\u5ea6Weighted Round Robin WPR \u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Least Connections LC \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Weighted Least Connections WLC \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Locality-Based Least Connections LBLC \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6Locality-Based Least Connections with Replication LBLCR \u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6Destination Hashing DH \u6e90\u54c8\u5e0c\u8c03\u5ea6Source Hashing SH \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6Shortest Expected Delay Scheduling SED \u4ece\u4e0d\u6392\u961f\u8c03\u5ea6Never Queue Scheduling NQ \u5faa\u73af\u8c03\u5ea6 \u5faa\u73af\u8c03\u5ea6\u7b97\u6cd5\u5c06\u6bcf\u4e2a\u4f20\u5165\u8bf7\u6c42\u53d1\u9001\u5230\u5176\u5217\u8868\u4e2d\u7684\u4e0b\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\uff0c\u5728\u4e09\u670d\u52a1\u5668\u96c6\u7fa4\uff08\u670d\u52a1\u5668A\uff0cB\u548cC\uff09\u4e2d\uff0c\u8bf7\u6c421\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u8bf7\u6c422\u5c06\u8f6c\u5230\u670d\u52a1\u5668B\uff0c\u8bf7\u6c423\u5c06\u8f6c\u5230\u670d\u52a1\u5668C\uff0c\u8bf7\u6c424\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u4ece\u800c\u5b8c\u6210\u9a91\u81ea\u884c\u8f66\u6216\u670d\u52a1\u5668'\u5faa\u73af'\u3002\u65e0\u8bba\u6bcf\u4e2a\u670d\u52a1\u5668\u9047\u5230\u7684\u4f20\u5165\u8fde\u63a5\u6570\u6216\u54cd\u5e94\u65f6\u95f4\u5982\u4f55\uff0c\u5b83\u90fd\u5c06\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u89c6\u4e3a\u76f8\u7b49\u3002\u4e0e\u4f20\u7edf\u7684\u5faa\u73afDNS\u76f8\u6bd4\uff0cVirtual Server\u5177\u6709\u4e00\u4e9b\u4f18\u52bf\u3002\u5faa\u73afDNS\u5c06\u5355\u4e2a\u57df\u89e3\u6790\u4e3a\u4e0d\u540c\u7684IP\u5730\u5740\uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u57fa\u4e8e\u4e3b\u673a\u7684\uff0c\u5e76\u4e14DNS\u67e5\u8be2\u7684\u7f13\u5b58\u963b\u788d\u4e86\u57fa\u672c\u7b97\u6cd5\uff0c\u8fd9\u4e9b\u56e0\u7d20\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u663e\u7740\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002 \u52a0\u6743\u5faa\u73af\u8c03\u5ea6 \u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u65e8\u5728\u66f4\u597d\u5730\u5904\u7406\u5177\u6709\u4e0d\u540c\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u3002\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5668\u5206\u914d\u4e00\u4e2a\u6743\u91cd\uff0c\u4e00\u4e2a\u8868\u793a\u5904\u7406\u80fd\u529b\u7684\u6574\u6570\u503c\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u9996\u5148\u63a5\u6536\u65b0\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u6743\u91cd\u8f83\u5c0f\u7684\u670d\u52a1\u5668\uff0c\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u6bd4\u5177\u6709\u8f83\u5c11\u6743\u91cd\u7684\u670d\u52a1\u5668\u83b7\u5f97\u66f4\u591a\u8fde\u63a5\uff0c\u5177\u6709\u76f8\u540c\u6743\u91cd\u7684\u670d \u4f8b\u5982\uff0c\u771f\u5b9e\u670d\u52a1\u5668A\uff0cB\u548cC\u5206\u522b\u5177\u6709\u6743\u91cd4,3,2\uff0c\u5728\u8c03\u5ea6\u5468\u671f\uff08mod sum\uff08Wi\uff09\uff09\u4e2d\uff0c\u826f\u597d\u7684\u8c03\u5ea6\u5e8f\u5217\u5c06\u662fAABABCABC\u3002\u5728\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u5b9e\u73b0\u4e2d\uff0c\u5728\u4fee\u6539\u865a\u62df\u670d\u52a1\u5668\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u5c06\u6839\u636e\u670d\u52a1\u5668\u6743\u91cd\u751f\u6210\u8c03\u5ea6\u5e8f\u5217\u3002 \u5f53\u771f\u5b9e\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u4e0d\u540c\u65f6\uff0c\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u4f18\u4e8e\u5faa\u73af\u8c03\u5ea6\u3002\u4f46\u662f\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5927\u591a\u6570\u9700\u8981\u5927\u54cd\u5e94\u7684\u8bf7\u6c42\u53ef\u80fd\u4f1a\u88ab\u5f15\u5bfc\u5230\u540c\u4e00\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u3002 \u5b9e\u9645\u4e0a\uff0c\u5faa\u73af\u8c03\u5ea6\u662f\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u4e00\u4e2a\u7279\u6b8a\u5b9e\u4f8b\uff0c\u5176\u4e2d\u6240\u6709\u6743\u91cd\u90fd\u76f8\u7b49\u3002 \u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u5c06\u7f51\u7edc\u8fde\u63a5\u5b9a\u5411\u5230\u5177\u6709\u6700\u5c11\u6570\u91cf\u7684\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u670d\u52a1\u5668\u3002\u8fd9\u662f\u52a8\u6001\u8c03\u5ea6\u7b97\u6cd5\u4e4b\u4e00; \u56e0\u4e3a\u5b83\u9700\u8981\u52a8\u6001\u8ba1\u7b97\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u5bf9\u4e8e\u7ba1\u7406\u5177\u6709\u7c7b\u4f3c\u6027\u80fd\u7684\u670d\u52a1\u5668\u96c6\u5408\u7684\u865a\u62df\u670d\u52a1\u5668\uff0c\u5f53\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\u65f6\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u53ef\u4ee5\u5e73\u6ed1\u5206\u53d1\u3002\u865a\u62df\u670d\u52a1\u5668\u5c06\u4f7f\u7528\u6700\u5c11\u7684\u6d3b\u52a8\u8fde\u63a5\u5c06\u8bf7\u6c42\u5b9a\u5411\u5230\u771f\u5b9e\u670d\u52a1\u5668\u3002 \u4e4d\u4e00\u770b\uff0c\u5373\u4f7f\u5b58\u5728\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e5f\u53ef\u80fd\u8868\u73b0\u826f\u597d\uff0c\u56e0\u4e3a\u66f4\u5feb\u7684\u670d\u52a1\u5668\u5c06\u83b7\u5f97\u66f4\u591a\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8eTCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u5b83\u65e0\u6cd5\u5f88\u597d\u5730\u6267\u884c\u3002TCP\u7684TIME_WAIT\u901a\u5e38\u662f2\u5206\u949f\uff0c\u5728\u8fd92\u5206\u949f\u5185\uff0c\u4e00\u4e2a\u7e41\u5fd9\u7684\u7f51\u7ad9\u7ecf\u5e38\u6536\u5230\u6570\u5343\u4e2a\u8fde\u63a5\uff0c\u4f8b\u5982\uff0c\u670d\u52a1\u5668A\u7684\u529f\u80fd\u662f\u670d\u52a1\u5668B\u7684\u4e24\u500d\uff0c\u670d\u52a1\u5668A\u5904\u7406\u6570\u5343\u4e2a\u8bf7\u6c42\u5e76\u5c06\u5b83\u4eec\u4fdd\u5b58\u5728TCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u4f46\u670d\u52a1\u5668B\u6b63\u5728\u722c\u884c\u4ee5\u5b8c\u6210\u5176\u6570\u5343\u4e2a\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e0d\u80fd\u5728\u5177\u6709\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5f88\u597d\u5730\u5e73\u8861\u8d1f\u8f7d\u3002 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u662f\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u8d85\u96c6\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6027\u80fd\u6743\u91cd\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u503c\u7684\u670d\u52a1\u5668\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u5c06\u83b7\u5f97\u66f4\u5927\u6bd4\u4f8b\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u865a\u62df\u670d\u52a1\u5668\u7ba1\u7406\u5458\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6743\u91cd\uff0c\u5e76\u4e14\u5c06\u7f51\u7edc\u8fde\u63a5\u5b89\u6392\u5230\u6bcf\u4e2a\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5f53\u524d\u6d3b\u52a8\u8fde\u63a5\u6570\u7684\u767e\u5206\u6bd4\u662f\u4e0e\u5176\u6743\u91cd\u7684\u6bd4\u7387\u3002\u9ed8\u8ba4\u6743\u91cd\u4e3a1\u3002 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a \u5047\u8bbe\u6709n\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668i\u7684\u6743\u91cd\u4e3aW i\uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u800c\u6d3b\u52a8\u8fde\u63a5C i \uff08i = 1\uff0c..\uff0cn\uff09\uff0cALL_CONNECTIONS\u662fC i\u7684\u603b\u548c \uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u4e0b\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u5c06\u88ab\u5b9a\u5411\u5230\u670d\u52a1\u5668j\uff0c\u5176\u4e2d \uff08C j / ALL_CONNECTIONS\uff09/ W j = min {\uff08C i / ALL_CONNECTIONS\uff09/ W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u7531\u4e8eALL_CONNECTIONS\u5728\u6b64\u67e5\u627e\u4e2d\u662f\u5e38\u91cf\uff0c\u56e0\u6b64\u65e0\u9700\u5c06C i\u9664\u4ee5ALL_CONNECTIONS\uff0c\u5b83\u53ef\u4ee5\u4f18\u5316\u4e3a C j / W j = min {C i / W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u9700\u8981\u6bd4\u6700\u5c0f\u8fde\u63a5\u66f4\u591a\u7684\u5212\u5206\u3002\u4e3a\u4e86\u5728\u670d\u52a1\u5668\u5177\u6709\u76f8\u540c\u7684\u5904\u7406\u80fd\u529b\u65f6\u6700\u5c0f\u5316\u8c03\u5ea6\u7684\u5f00\u9500\uff0c\u5b9e\u73b0\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u548c\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u3002 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5982\u679c\u670d\u52a1\u5668\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u4e14\u8d1f\u8f7d\u4e0d\u8db3\uff0c\u6b64\u7b97\u6cd5\u901a\u5e38\u4f1a\u5c06\u53d1\u5f80IP\u5730\u5740\u7684\u6570\u636e\u5305\u5b9a\u5411\u5230\u5176\u670d\u52a1\u5668\u3002\u5982\u679c\u670d\u52a1\u5668\u8fc7\u8f7d\uff08\u5176\u6d3b\u52a8\u8fde\u63a5\u6570\u5927\u4e8e\u5176\u6743\u91cd\uff09\u5e76\u4e14\u670d\u52a1\u5668\u5904\u4e8e\u534a\u8d1f\u8f7d\u72b6\u6001\uff0c\u5219\u5c06\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u670d\u52a1\u5668\u5206\u914d\u7ed9\u6b64IP\u5730\u5740\u3002 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6\u7b97\u6cd5\u4e5f\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5b83\u4e0eLBLC\u8c03\u5ea6\u7684\u4e0d\u540c\u4e4b\u5904\u5982\u4e0b\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u7ef4\u62a4\u4ece\u76ee\u6807\u5230\u53ef\u4ee5\u4e3a\u76ee\u6807\u670d\u52a1\u7684\u4e00\u7ec4\u670d\u52a1\u5668\u8282\u70b9\u7684\u6620\u5c04\u3002\u5bf9\u76ee\u6807\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u7ed9\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6700\u5c0f\u8fde\u63a5\u8282\u70b9\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u8fc7\u8f7d\uff0c\u5b83\u5c06\u5728\u96c6\u7fa4\u4e2d\u83b7\u53d6\u6700\u5c11\u8fde\u63a5\u8282\u70b9\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u672a\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fdb\u884c\u4fee\u6539\uff0c\u5219\u4f1a\u4ece\u670d\u52a1\u5668\u96c6\u4e2d\u5220\u9664\u8d1f\u8f7d\u6700\u591a\u7684\u8282\u70b9\uff0c\u4ee5\u907f\u514d\u9ad8\u5ea6\u590d\u5236\u3002 \u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6 \u76ee\u6807\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u76ee\u6807IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5\u3002 \u6e90\u54c8\u5e0c\u8c03\u5ea6 \u6e90\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u6e90IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5\u3002 \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6 \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\u4ee5\u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u5c06\u7f51\u7edc\u8fde\u63a5\u5206\u914d\u7ed9\u670d\u52a1\u5668\u3002\u5982\u679c\u53d1\u9001\u5230\u7b2ci\u4e2a\u670d\u52a1\u5668\uff0c\u4f5c\u4e1a\u5c06\u7ecf\u5386\u7684\u9884\u671f\u5ef6\u8fdf\u662f\uff08Ci + 1\uff09/ Ui\uff0c\u5176\u4e2dCi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u8fde\u63a5\u6570\uff0cUi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u7684\u56fa\u5b9a\u670d\u52a1\u901f\u7387\uff08\u6743\u91cd\uff09 \u3002 \u4ece\u4e0d\u6392\u961f\u8c03\u5ea6 \u6c38\u4e0d\u6392\u961f\u8c03\u5ea6\u7b97\u6cd5\u91c7\u7528\u53cc\u901f\u6a21\u578b\u3002\u5f53\u6709\u7a7a\u95f2\u670d\u52a1\u5668\u53ef\u7528\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u7a7a\u95f2\u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u5feb\u901f\u670d\u52a1\u5668\u3002\u5f53\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u670d\u52a1\u5668\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u4ee5\u6700\u5c0f\u5316\u5176\u9884\u671f\u5ef6\u8fdf\uff08\u6700\u77ed\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\uff09\u3002 LVS\u4e2dIP\u6216\u7f51\u7edc\u7684\u540d\u79f0 \u5178\u578b\u7684 LVS - NAT \u8bbe\u7f6e\uff1a LVS - NAT : no arp problem ( the realservers don ' t have the VIP) ________ | | | client | ( local or on internet ) | ________ | CIP | ( router ) DGW -- DIRECTOR - gateway | outside network | VIP -- Virtual IP ____ | _____ | | ( director can have 1 or 2 NICs ) | director | | __________ | DIP ( and PIP ) -- primary director IP = PIP ( the director which will be the master on bootup ) | -- secondary director IP = SIP ( the director which will be the backup on bootup ) | DRIP network ---------------------------------- | | | | | | RIP1 RIP2 RIP3 _____________ _____________ _____________ | | | | | | | realserver1 | | realserver2 | | realserver3 | | _____________ | | _____________ | | _____________ | \u5178\u578b\u7684 LVS - DR or LVS - Tun \u8bbe\u7f6e ________ | | | client | ( local or on internet ) | ________ | | ( router ) ----------- | SERVER_GW | | | VIP | ____ | _____ | | | ( director can have 1 or 2 NICs ) | director | | | __________ | | DIP | | | | | -----------------+---------------- | | | | | | RIP1 , VIP RIP2 , VIP RIP3 , VIP ____________ ____________ ____________ | | | | | | | realserver | | realserver | | realserver | | ____________ | | ____________ | | ____________ | client IP = CIP virtual IP = VIP - the IP on the director that the client connects to ) director IP = DIP - the IP on the director in the DIP / RIP ( DRIP ) network ( this is the realserver gateway for LVS - NAT ) realserver IP = RIP ( and RIP1 , RIP2 ... ) the IP on the realserver director GW = DGW - the director ' s gw (only needed for LVS-NAT) ( this can be the realserver gateway for LVS - DR and LVS - Tun ) VIP \u548c DIP \u8bbe\u7f6e\u4e3a\u8f85\u52a9 IP \uff08\u5373\u8be5 NIC ( \u7f51\u5361 ) \u4e0a\u6709\u53e6\u4e00\u4e2a\u4e3b IP \uff09\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728 director \u6545\u969c\u8f6c\u79fb\u540e\u5c06\u5b83\u4eec\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u590d\u5236\u7684 director \u3002\u5bf9\u4e8e\u4f7f\u7528\u5355\u4e2a director \u7684\u521d\u59cb\u8bbe\u7f6e\uff0c\u5c06 VIP \u548c DIP \u8bbe\u7f6e\u4e3a\u6b21\u8981 IP \u5c06\u4f7f\u6545\u969c\u8f6c\u79fb\u8bbe\u7f6e\u66f4\u52a0\u5bb9\u6613\u3002 DGW \u516c\u7f51IP\u7684\u9ed8\u8ba4\u7f51\u5173 VIP \u5ba2\u6237\u7aef\u8bbf\u95ee\u7684\u516c\u7f51IP\uff0cDirector\u7684\u865a\u62dfIP DIP Director\u7684\u771f\u5b9eIP RIP realserver\u7684IP RIP \u5ba2\u6237\u7aefIP \u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-NAT\u8f6c\u53d1 \u5728 direcotor\u4f7f\u7528\u4e00\u4e2a\u7f51\u5361 \uff0c\u4e5f\u53ef\u4f7f\u7528\u4e24\u4e2a\uff0c\u4f46\u8981\u6539\u53d8\u8bbe\u7f6e\u3002 ________ | | | client | | ________ | CIP = DGW = 192 . 168 . 2 . 254 ( eth0 ) | | __________ | | | | ( VIP = 192 . 168 . 2 . 110 , eth0 : 110 ) | director | ---| | __________ | | DIP = SGW = 192 . 168 . 1 . 9 ( eth0 ) | | ----------------------------------- | | | | RIP = 192 . 168 . 1 . 11 ( eth0 ) RIP = 192 . 168 . 1 . 12 ( eth0 ) ____________ ____________ | | | | | realserver | | realserver | | ____________ | | ____________ | \u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-DR\u8f6c\u53d1 \u5728\u5177\u6709\u5355\u4e2a NIC\u7684\u8ba1\u7b97\u673a\u4e0a\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc \uff08\u6b64\u5904\u4e3a 192 . 168 . 1 . 0 / 24 \uff09\u8bbe\u7f6e LVS \u3002\u4ee5\u592a\u7f51\u522b\u540d\u4e0a\u7684 IP \uff08\u4f8b\u5982 eth0 \uff1a 110 \uff0c lo \uff1a 0 \uff09\u7531 configure\u811a\u672c\u8bbe\u7f6e \u3002\u6ca1\u6709\u9ed8\u8ba4\u8def\u7531\uff0c\u5e76\u4e14\u6240\u6709\u8ba1\u7b97\u673a\u90fd\u5e94\u8be5\u80fd\u591f\u76f8\u4e92 ping\u901a \u3002 ________ | | | client | | ________ | CIP = SGW = 192 . 168 . 1 . 254 ( eth0 ) | | __________ | | | | ( VIP = 192 . 168 . 1 . 110 , eth0 : 110 ) | director | ---| | __________ | | DIP = 192 . 168 . 1 . 9 ( eth0 ) | | ----------------------------------- | | | | RIP = 192 . 168 . 1 . 11 ( eth0 ) RIP = 192 . 168 . 1 . 12 ( eth0 ) ( VIP = 192 . 168 . 1 . 110 , lo : 0 ) ( VIP = 192 . 168 . 1 . 110 , lo : 0 ) ____________ ____________ | | | | | realserver | | realserver | | ____________ | | ____________ |","title":"Linux Virtual Server"},{"location":"LVS/#lvskeepalived","text":"\u4f7f\u7528keepalived\u6784\u5efa\u4e00\u4e2a\u5177\u6709\u4e24\u4e2a\u8d1f\u8f7d\u5e73\u8861\u5668\u548c\u4e09\u4e2aWeb\u670d\u52a1\u5668\u7684\u9ad8\u53ef\u7528\u6027VS/NAT Web\u96c6\u7fa4\uff0c\u62d3\u6251\u56fe\u5982\u4e0b\uff1a \u5728\u672c\u4f8b\u4e2d\uff0cVIP\u5730\u5740\u548cDIP\u5730\u5740\u5206\u522b\u4e3a10.23.8.80\u548c172.18.1.254\u5747\u4e3a\u6d6e\u52a8IP\uff0c\u5b83\u4eec\u5728\u4e24\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\uff08LD1\u548cLD2\uff09\u4e4b\u95f4\u6d6e\u52a8\uff0c\u4e09\u4e2arealserver\u7684IP\u5730\u5740\u4e3a172.18.1.11,172.18.1.12\u548c172.18.1.13\u3002 float IP\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\u56fe\uff1a LD1\u4e0a\u7684keepalived\u914d\u7f6e\u6587\u4ef6\uff08/etc/keepalived/keepalived.conf\uff09\u5982\u4e0b: vrrp_sync_group VG1 { group { VI_1 VI_2 } } vrrp_instance VI_1 { state MASTER interface eth0 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 10 . 23 . 8 . 80 } } vrrp_instance VI_2 { state MASTER interface eth1 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 172 . 18 . 1 . 254 } } virtual_server 10 . 23 . 8 . 80 80 { delay_loop 6 lb_algo wlc lb_kind NAT persistence_timeout 600 protocol TCP real_server 172 . 18 . 1 . 11 80 { weight 100 TCP_CHECK { connect_timeout 3 } } real_server 172 . 18 . 1 . 12 80 { weight 100 TCP_CHECK { connect_timeout 3 } } real_server 172 . 18 . 1 . 13 80 { weight 100 TCP_CHECK { connect_timeout 3 } } } LD2\u7684\u548cLD1\u76f8\u4f3c \uff0c\u53ea\u9700\u5c06 VI_1\u548cVI_2\u7684\u72b6\u6001\u4ecemaster\u6539\u4e3abackup","title":"LVS+Keepalived\u89e3\u51b3\u65b9\u6848\u5b98\u65b9\u793a\u4f8b"},{"location":"LVS/#keepalived","text":"# \u5168\u5c40\u5b9a\u4e49\u6a21\u5757 global_defs { notification_email { acassen @firewall . loc failover @firewall . loc sysadmin @firewall . loc #\u90ae\u4ef6\u62a5\u8b66 } notification_email_from Alexandre . Cassen @firewall . loc \u6307\u5b9a\u53d1\u4ef6\u4eba smtp_server 192.168.200.1 #\u6307\u5b9asmtp\u670d\u52a1\u5668\u5730\u5740 smtp_connect_timeout 30 \u6307\u5b9asmtp\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 router_id LVS_DEVEL #\u8d1f\u8f7d\u5747\u8861\u6807\u8bc6 \uff0c \u5728\u5c40\u57df\u7f51\u5185\u5e94\u8be5\u662f\u552f\u4e00\u7684 \u3002 vrrp_skip_check_adv_addr vrrp_strict vrrp_garp_interval 0 vrrp_gna_interval 0 } \u8bf4\u660e \uff1a notification_email \uff1a \u6307\u5b9a\u5f53keepalived\u51fa\u73b0\u95ee\u9898\u65f6 \uff0c \u53d1\u9001\u90ae\u4ef6\u7ed9\u54ea\u4e9b\u7528\u6237 \u3002 notification_emai_from \uff1a \u53d1\u9001\u90ae\u4ef6\u65f6 \uff0c \u90ae\u4ef6\u7684\u6765\u6e90\u5730\u5740 \u3002 smtp_server < DOMAIN | IP > [ <PORT> ] \uff1a smtp\u670d\u52a1\u5668\u7684\u5730\u5740\u6216\u57df\u540d \u3002 \u9ed8\u8ba4\u7aef\u53e3\u4e3a25 . \u5982 \uff1a smtp_server smtp . felix . com 25 smtp_helo_name < HOST_NAME > \uff1a \u6307\u5b9a\u5728HELO\u6d88\u606f\u4e2d\u6240\u4f7f\u7528\u7684\u540d\u79f0 \u3002 \u9ed8\u8ba4\u4e3a\u672c\u5730\u4e3b\u673a\u540d \u3002 smtp_connect_timeout \uff1a \u6307\u5b9asmtp\u670d\u52a1\u5668\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 router_id \uff1a \u6307\u5b9a\u6807\u8bc6\u8be5\u673a\u5668\u7684route_id . \u5982 \uff1a route_id LVS_01 vrrp_mcast_group4 224.0.0.18 \uff1a \u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u4f7f\u7528\u7684IPV4\u7ec4\u64ad\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f224 .0.0.18 vrrp_mcast_group6 ff02 : : 12 \u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u6240\u4f7f\u7528\u7684IPV6\u7ec4\u64ad\u5730\u5740 \u3002 \u9ed8\u8ba4\u662fff02 : : 12 default_interface eth0 \uff1a \u8bbe\u7f6e\u9759\u6001\u5730\u5740\u9ed8\u8ba4\u7ed1\u5b9a\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662feth0 \u3002 lvs_sync_daemon < INTERFACE > < VRRP_INSTANCE > [ id <SYNC_ID> ] [ maxlen <LEN> ] [ port <PORT> ] [ ttl <TTL> ] [ group <IP ADDR> ] \u8bbe\u7f6eLVS\u540c\u6b65\u670d\u52a1\u7684\u76f8\u5173\u5185\u5bb9 \u3002 \u53ef\u4ee5\u540c\u6b65LVS\u7684\u72b6\u6001\u4fe1\u606f \u3002 INTERFACE \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684\u63a5\u53e3 \u3002 VRRP_INSTANCE \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684VRRP\u5b9e\u4f8b \u3002 id < SYNC_ID > \uff1a \u6307\u5b9a\u540c\u6b65\u670d\u52a1\u6240\u4f7f\u7528\u7684SYNCID \uff0c \u53ea\u6709\u76f8\u540c\u7684SYNCID\u624d\u4f1a\u540c\u6b65 \u3002 \u8303\u56f4\u662f0 - 255. maxlen \uff1a \u6307\u5b9a\u6570\u636e\u5305\u7684\u6700\u5927\u957f\u5ea6 \u3002 \u8303\u56f4\u662f1 - 65507 port \uff1a \u6307\u5b9a\u540c\u6b65\u6240\u4f7f\u7528\u7684UDP\u7aef\u53e3 \u3002 group \uff1a \u6307\u5b9a\u7ec4\u64adIP\u5730\u5740 \u3002 lvs_flush \uff1a \u5728keepalived\u542f\u52a8\u65f6 \uff0c \u5237\u65b0\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u7684LVS\u914d\u7f6e \u3002 vrrp_garp_master_delay 10 \uff1a \u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6 \uff0c \u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP \u3002 \u9ed8\u8ba4\u4e3a5s \uff0c 0 \u8868\u793a\u4e0d\u53d1\u9001\u7b2c\u4e8c\u7ec4\u514d\u7684\u514d\u8d39ARP \u3002 vrrp_garp_master_repeat 1 \uff1a \u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6 \uff0c \u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf \u3002 \u9ed8\u8ba4\u662f5 . vrrp_garp_lower_prio_delay 10 \uff1a \u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6 \uff0c \u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP \u3002 vrrp_garp_lower_prio_repeat 1 \uff1a \u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6 \uff0c \u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf \u3002 vrrp_garp_master_refresh 60 \uff1a \u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e \uff0c \u5237\u65b0\u514d\u8d39ARP\u7684\u6700\u5c0f\u65f6\u95f4\u95f4\u9694 ( \u4f1a\u518d\u6b21\u53d1\u9001\u514d\u8d39ARP ) \u3002 \u9ed8\u8ba4\u662f0 \uff0c \u8868\u793a\u4e0d\u4f1a\u5237\u65b0 \u3002 vrrp_garp_master_refresh_repeat 2 \uff1a \u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e \uff0c \u6bcf\u6b21\u5237\u65b0\u4f1a\u53d1\u9001\u591a\u5c11\u4e2a\u514d\u8d39ARP \u3002 \u9ed8\u8ba4\u662f1 . vrrp_garp_interval 0.001 \uff1a \u5728\u4e00\u4e2a\u63a5\u53e3\u53d1\u9001\u7684\u4e24\u4e2a\u514d\u8d39ARP\u4e4b\u95f4\u7684\u5ef6\u8fdf \u3002 \u53ef\u4ee5\u7cbe\u786e\u5230\u6beb\u79d2\u7ea7 \u3002 \u9ed8\u8ba4\u662f0 . vrrp_lower_prio_no_advert true | false \uff1a \u9ed8\u8ba4\u662ffalse \u3002 \u5982\u679c\u6536\u5230\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a \uff0c \u4e0d\u53d1\u9001\u4efb\u4f55\u901a\u544a \u3002 vrrp_version 2 | 3 \uff1a \u8bbe\u7f6e\u9ed8\u8ba4\u7684VRRP\u7248\u672c \u3002 \u9ed8\u8ba4\u662f2 . vrrp_check_unicast_src \uff1a \u5728\u5355\u64ad\u6a21\u5f0f\u4e2d \uff0c \u5f00\u542f\u5bf9VRRP\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u505a\u68c0\u67e5 \uff0c \u6e90\u5730\u5740\u5fc5\u987b\u662f\u5355\u64ad\u90bb\u5c45\u4e4b\u4e00 \u3002 vrrp_skip_check_adv_addr \uff1a \u9ed8\u8ba4\u662f\u4e0d\u8df3\u8fc7\u68c0\u67e5 \u3002 \u68c0\u67e5\u6536\u5230\u7684VRRP\u901a\u544a\u4e2d\u7684\u6240\u6709\u5730\u5740\u53ef\u80fd\u4f1a\u6bd4\u8f83\u8017\u65f6 \uff0c \u8bbe\u7f6e\u6b64\u547d\u4ee4\u7684\u610f\u601d\u662f \uff0c \u5982\u679c\u901a\u544a\u4e0e\u63a5\u6536\u7684\u4e0a\u4e00\u4e2a\u901a\u544a\u6765\u81ea\u76f8\u540c\u7684master\u8def\u7531\u5668 \uff0c \u5219\u4e0d\u6267\u884c\u68c0\u67e5 ( \u8df3\u8fc7\u68c0\u67e5 ) \u3002 vrrp_strict \uff1a \u4e25\u683c\u9075\u5b88VRRP\u534f\u8bae \u3002 \u4e0b\u5217\u60c5\u51b5\u5c06\u4f1a\u963b\u6b62\u542f\u52a8Keepalived \uff1a 1. \u6ca1\u6709VIP\u5730\u5740 \u3002 2. \u5355\u64ad\u90bb\u5c45 \u3002 3. \u5728VRRP\u7248\u672c2\u4e2d\u6709IPv6\u5730\u5740 \u3002 vrrp_iptables \uff1a \u4e0d\u6dfb\u52a0\u4efb\u4f55iptables\u89c4\u5219 \u3002 \u9ed8\u8ba4\u662f\u6dfb\u52a0iptables\u89c4\u5219\u7684 \u3002 \u5982\u679cvrrp\u8fdb\u7a0b\u6216check\u8fdb\u7a0b\u8d85\u65f6 \uff0c \u53ef\u4ee5\u7528\u4e0b\u9762\u76844\u4e2a\u9009\u9879 \u3002 \u53ef\u4ee5\u4f7f\u5904\u4e8eBACKUP\u72b6\u6001\u7684VRRP\u5b9e\u4f8b\u53d8\u6210MASTER\u72b6\u6001 \uff0c \u5373\u4f7fMASTER\u5b9e\u4f8b\u4f9d\u7136\u5728\u8fd0\u884c \u3002 \u56e0\u4e3aMASTER\u6216BACKUP\u7cfb\u7edf\u6bd4\u8f83\u6162 \uff0c \u4e0d\u80fd\u53ca\u65f6\u5904\u7406VRRP\u6570\u636e\u5305 \u3002 vrrp_priority <- 20 -- 19>\uff1a\u8bbe\u7f6eVRRP\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u3002 checker_priority <- 20 -- 19>\uff1a\u8bbe\u7f6echecker\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\u3002 vrrp_no_swap \uff1a vrrp\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362 \u3002 checker_no_swap \uff1a checker\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362 \u3002 script_user < username > [ groupname ] \uff1a \u8bbe\u7f6e\u8fd0\u884c\u811a\u672c\u9ed8\u8ba4\u7528\u6237\u548c\u7ec4 \u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9a \uff0c \u5219\u9ed8\u8ba4\u7528\u6237\u4e3akeepalived_script ( \u9700\u8981\u8be5\u7528\u6237\u5b58\u5728 ) \uff0c \u5426\u5219\u4e3aroot\u7528\u6237 \u3002 \u9ed8\u8ba4groupname\u540cusername \u3002 enable_script_security \uff1a \u5982\u679c\u811a\u672c\u8def\u5f84\u7684\u4efb\u4e00\u90e8\u5206\u5bf9\u4e8e\u975eroot\u7528\u6237\u6765\u8bf4 \uff0c \u90fd\u5177\u6709\u53ef\u5199\u6743\u9650 \uff0c \u5219\u4e0d\u4f1a\u4ee5root\u8eab\u4efd\u8fd0\u884c\u811a\u672c \u3002 nopreempt \u9ed8\u8ba4\u662f\u62a2\u5360\u6a21\u5f0f \u8981\u662f\u7528\u975e\u62a2\u5360\u5f0f\u7684\u5c31\u52a0\u4e0anopreempt \u6ce8\u610f \uff1a \u4e0a\u8ff0\u4e3aglobal_defs\u4e2d\u7684\u6307\u4ee4","title":"Keepalived\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3"},{"location":"LVS/#vrrpd","text":"vrrp_script vrrp_sync_group vrrp_instance \u4f5c\u7528 \uff1a \u6dfb\u52a0\u4e00\u4e2a\u5468\u671f\u6027\u6267\u884c\u7684\u811a\u672c \u3002 \u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u4f1a\u88ab\u8c03\u7528\u5b83\u7684\u6240\u6709\u7684VRRP Instance\u8bb0\u5f55 \u3002 \u6ce8\u610f \uff1a \u81f3\u5c11\u6709\u4e00\u4e2aVRRP\u5b9e\u4f8b\u8c03\u7528\u5b83\u5e76\u4e14\u4f18\u5148\u7ea7\u4e0d\u80fd\u4e3a0 . \u4f18\u5148\u7ea7\u8303\u56f4\u662f1 - 254. vrrp_script < SCRIPT_NAME > { ... } \u9009\u9879\u8bf4\u660e \uff1a scrip \"/path/to/somewhere\" \uff1a \u6307\u5b9a\u8981\u6267\u884c\u7684\u811a\u672c\u7684\u8def\u5f84 \u3002 interval < INTEGER > \uff1a \u6307\u5b9a\u811a\u672c\u6267\u884c\u7684\u95f4\u9694 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 \u9ed8\u8ba4\u4e3a1s \u3002 timeout < INTEGER > \uff1a \u6307\u5b9a\u5728\u591a\u5c11\u79d2\u540e \uff0c \u811a\u672c\u88ab\u8ba4\u4e3a\u6267\u884c\u5931\u8d25 \u3002 weight <- 254 --- 254>\uff1a\u8c03\u6574\u4f18\u5148\u7ea7\u3002\u9ed8\u8ba4\u4e3a2. rise < INTEGER > \uff1a \u6267\u884c\u6210\u529f\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u662f\u6210\u529f \u3002 fall < INTEGER > \uff1a \u6267\u884c\u5931\u8d25\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u5931\u8d25 \u3002 user < USERNAME > [ GROUPNAME ] \uff1a \u8fd0\u884c\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4 \u3002 init_fail \uff1a \u5047\u8bbe\u811a\u672c\u521d\u59cb\u72b6\u6001\u662f\u5931\u8d25\u72b6\u6001 \u3002 \u89e3\u91ca \uff1a weight \uff1a 1. \u5982\u679c\u811a\u672c\u6267\u884c\u6210\u529f ( \u9000\u51fa\u72b6\u6001\u7801\u4e3a0 ) \uff0c weight\u5927\u4e8e0 \uff0c \u5219priority\u589e\u52a0 \u3002 2. \u5982\u679c\u811a\u672c\u6267\u884c\u5931\u8d25 ( \u9000\u51fa\u72b6\u6001\u7801\u4e3a\u975e0 ) \uff0c weight\u5c0f\u4e8e0 \uff0c \u5219priority\u51cf\u5c11 \u3002 3. \u5176\u4ed6\u60c5\u51b5\u4e0b \uff0c priority\u4e0d\u53d8 \u3002 \u4f5c\u7528 \uff1a \u5c06\u6240\u6709\u76f8\u5173\u7684VRRP\u5b9e\u4f8b\u5b9a\u4e49\u5728\u4e00\u8d77 \uff0c \u4f5c\u4e3a\u4e00\u4e2aVRRP Group \uff0c \u5982\u679c\u7ec4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b9e\u4f8b\u51fa\u73b0\u95ee\u9898 \uff0c \u90fd\u53ef\u4ee5\u5b9e\u73b0Failover \u3002 vrrp_sync_group VG_1 { group { inside_network # vrrp instance name outside_network # vrrp instance name ... } ... } \u8bf4\u660e \uff1a \u5982\u679cusername\u548cgroupname\u6ca1\u6709\u6307\u5b9a \uff0c \u5219\u4ee5\u9ed8\u8ba4\u7684script_user\u6240\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4 \u3002 1. notify_master / path / to_master . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u6210\u4e3aMASTER\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 2. notify_backup / path / to_backup . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u6210\u4e3aBACKUP\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 3. notify_fault \"/path/fault.sh VG_1\" [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5f53\u8be5\u540c\u6b65\u7ec4Fault\u65f6 \uff0c \u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 4. notify / path / notify . sh [ username [groupname ] ] \u4f5c\u7528 \uff1a \u5728\u4efb\u4f55\u72b6\u6001\u90fd\u4f1a\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c \u3002 \u8bf4\u660e \uff1a \u8be5\u811a\u672c\u4f1a\u5728notify_ * \u811a\u672c\u540e\u6267\u884c \u3002 notify\u53ef\u4ee5\u4f7f\u75283\u4e2a\u53c2\u6570 \uff0c \u5982\u4e0b \uff1a $ 1 \uff1a \u53ef\u4ee5\u662fGROUP\u6216INTANCE \uff0c \u8868\u660e\u540e\u9762\u662f\u7ec4\u8fd8\u662f\u5b9e\u4f8b \u3002 $ 2 \uff1a \u7ec4\u540d\u6216\u5b9e\u4f8b\u540d \u3002 $ 3 \uff1a \u8f6c\u6362\u540e\u7684\u76ee\u6807\u72b6\u6001 \u3002 \u6709 \uff1a MASTER \u3001 BACKUP \u3001 FAULT \u3002 5. smtp_alert \uff1a \u5f53\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6 \uff0c \u53d1\u9001\u90ae\u4ef6 \u3002 6. global_tracking \uff1a \u6240\u6709\u7684VRRP\u5b9e\u4f8b\u5171\u4eab\u76f8\u540c\u7684tracking\u914d\u7f6e \u3002 \u6ce8\u610f \uff1a \u811a\u672c\u6587\u4ef6\u8981\u52a0\u4e0ax\u6743\u9650 \uff0c \u540c\u65f6\u6307\u4ee4\u6700\u597d\u5199\u7edd\u5bf9\u8def\u5f84 \u3002 \u547d\u4ee4\u8bf4\u660e \uff1a state MASTER | BACKUP \uff1a \u6307\u5b9a\u8be5keepalived\u8282\u70b9\u7684\u521d\u59cb\u72b6\u6001 \u3002 interface eth0 \uff1a vrrp\u5b9e\u4f8b\u7ed1\u5b9a\u7684\u63a5\u53e3 \uff0c \u7528\u4e8e\u53d1\u9001VRRP\u5305 \u3002 use_vmac [ <VMAC_INTERFACE> ] \uff1a \u5728\u6307\u5b9a\u7684\u63a5\u53e3\u4ea7\u751f\u4e00\u4e2a\u5b50\u63a5\u53e3 \uff0c \u5982vrrp .51 \uff0c \u8be5\u63a5\u53e3\u7684MAC\u5730\u5740\u4e3a\u7ec4\u64ad\u5730\u5740 \uff0c \u901a\u8fc7\u8be5\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u5305 \u3002 vmac_xmit_base \uff1a \u901a\u8fc7\u57fa\u672c\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u6570\u636e\u5305 \uff0c \u800c\u4e0d\u662f\u901a\u8fc7VMAC\u63a5\u53e3 \u3002 native_ipv6 \uff1a \u5f3a\u5236VRRP\u5b9e\u4f8b\u4f7f\u7528IPV6 .( \u5f53\u540c\u65f6\u914d\u7f6e\u4e86IPV4\u548cIPV6\u7684\u65f6\u5019 ) dont_track_primary \uff1a \u5ffd\u7565VRRP\u63a5\u53e3\u7684\u9519\u8bef \uff0c \u9ed8\u8ba4\u662f\u6ca1\u6709\u914d\u7f6e\u7684 \u3002 track_interface { eth0 eth1 weight <- 254 - 254 > ... }\uff1a \u5982\u679ctrack\u7684\u63a5\u53e3\u6709\u4efb\u4f55\u4e00\u4e2a\u51fa\u73b0\u6545\u969c \uff0c \u90fd\u4f1a\u8fdb\u5165FAULT\u72b6\u6001 \u3002 track_script { < SCRIPT_NAME > < SCRIPT_NAME > weight <- 254 - 254 > }\uff1a \u6dfb\u52a0\u4e00\u4e2atrack\u811a\u672c ( vrrp_script\u914d\u7f6e\u7684\u811a\u672c \u3002 ) mcast_src_ip < IPADDR > \uff1a \u6307\u5b9a\u53d1\u9001\u7ec4\u64ad\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740 \u3002 unicast_src_ip < IPADDR > \uff1a \u6307\u5b9a\u53d1\u9001\u5355\u8584\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740 \u3002 version 2 | 3 \uff1a \u6307\u5b9a\u8be5\u5b9e\u4f8b\u6240\u4f7f\u7528\u7684VRRP\u7248\u672c \u3002 unicast_peer { < IPADDR > ... }\uff1a \u91c7\u7528\u5355\u64ad\u7684\u65b9\u5f0f\u53d1\u9001VRRP\u901a\u544a \uff0c \u6307\u5b9a\u5355\u64ad\u90bb\u5c45\u7684IP\u5730\u5740 \u3002 virtual_router_id 51 \uff1a \u6307\u5b9aVRRP\u5b9e\u4f8bID \uff0c \u8303\u56f4\u662f0 - 255. priority 100 \uff1a \u6307\u5b9a\u4f18\u5148\u7ea7 \uff0c \u4f18\u5148\u7ea7\u9ad8\u7684\u5c06\u6210\u4e3aMASTER \u3002 advert_int 1 \uff1a \u6307\u5b9a\u53d1\u9001VRRP\u901a\u544a\u7684\u95f4\u9694 \u3002 \u5355\u4f4d\u662f\u79d2 \u3002 authentication { auth_type PASS | AH \uff1a \u6307\u5b9a\u8ba4\u8bc1\u65b9\u5f0f \u3002 PASS\u7b80\u5355\u5bc6\u7801\u8ba4\u8bc1 ( \u63a8\u8350 ), AH : IPSEC\u8ba4\u8bc1 ( \u4e0d\u63a8\u8350 ) \u3002 auth_pass 1234 \uff1a \u6307\u5b9a\u8ba4\u8bc1\u6240\u4f7f\u7528\u7684\u5bc6\u7801 \u3002 \u6700\u591a8\u4f4d \u3002 } virtual_ipaddress { < IPADDR >/< MASK > brd < IPADDR > dev < STRING > scope < SCOPE > label < LABEL > 192.168.200.17 / 24 dev eth1 192.168.200.18 / 24 dev eth2 label eth2 : 1 }\uff1a \u6307\u5b9aVIP\u5730\u5740 \u3002 nopreempt \uff1a \u8bbe\u7f6e\u4e3a\u4e0d\u62a2\u5360 \u3002 \u9ed8\u8ba4\u662f\u62a2\u5360\u7684 \uff0c \u5f53\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6062\u590d\u540e \uff0c \u4f1a\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6210\u4e3aMASTER \uff0c \u800c\u4e0d\u62a2\u5360 \uff0c \u5219\u5141\u8bb8\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u7ee7\u7eed\u6210\u4e3aMASTER \uff0c \u5373\u4f7f\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u5df2\u7ecf\u4e0a\u7ebf \u3002 \u5982\u679c\u8981\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd \uff0c \u5219\u521d\u59cb\u5316\u72b6\u6001\u5fc5\u987b\u4e3aBACKUP \u3002 preempt_delay \uff1a \u8bbe\u7f6e\u62a2\u5360\u5ef6\u8fdf \u3002 \u5355\u4f4d\u662f\u79d2 \uff0c \u8303\u56f4\u662f0 ---1000\uff0c\u9ed8\u8ba4\u662f0.\u53d1\u73b0\u4f4e\u4f18\u5148\u7ea7\u7684MASTER\u540e\u591a\u5c11\u79d2\u5f00\u59cb\u62a2\u5360\u3002 \u901a\u77e5\u811a\u672c \uff1a notify_master < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify_backup < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify_fault < STRING >|< QUOTED - STRING > [ username [groupname ] ] notify < STRING >|< QUOTED - STRING > [ username [groupname ] ] # \u5f53\u505c\u6b62VRRP\u65f6\u6267\u884c\u7684\u811a\u672c \u3002 notify_stop < STRING >|< QUOTED - STRING > [ username [groupname ] ] smtp_alert","title":"VRRPD\u914d\u7f6e\u5305\u542b\u5982\u4e0b\u5b50\u5757"},{"location":"LVS/#lvs","text":"virtual_server IP Port | virtual_server fwmark int | virtual_server group string { delay_loop < INT > \uff1a\u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4\u95f4\u9694\u3002 lb_argo rr | wrr | lc | wlc | lblc | sh | dh \uff1a LVS\u8c03\u5ea6\u7b97\u6cd5 \u3002 lb_kind NAT | DR | TUN \uff1a LVS\u6a21\u5f0f \u3002 persistence_timeout 360 \uff1a\u6301\u4e45\u5316\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2\u3002\u9ed8\u8ba4\u662f 6 \u5206\u949f\u3002 persistence_granularity \uff1a\u6301\u4e45\u5316\u8fde\u63a5\u7684\u9897\u7c92\u5ea6\u3002 protocol TCP | UDP | SCTP \uff1a 4 \u5c42\u534f\u8bae\u3002 ha_suspend \uff1a\u5982\u679c virtual server\u7684IP\u5730\u5740\u6ca1\u6709\u8bbe\u7f6e \uff0c\u5219\u4e0d\u8fdb\u884c\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u67e5\u3002 virtualhost < STRING > \uff1a\u4e3a HTTP_GET\u548cSSL_GET\u6267\u884c\u8981\u68c0\u67e5\u7684\u865a\u62df\u4e3b\u673a \u3002\u5982 virtualhost www . felix . com sorry_server < IPADDR > < PORT > \uff1a\u6dfb\u52a0\u4e00\u4e2a\u5907\u7528\u670d\u52a1\u5668\u3002\u5f53\u6240\u6709\u7684 RS\u90fd\u6545\u969c\u65f6 \u3002 sorry_server_inhibit \uff1a\u5c06 inhibit_on_failure\u6307\u4ee4\u5e94\u7528\u4e8esorry_server\u6307\u4ee4 \u3002 alpha \uff1a\u5728 keepalived\u542f\u52a8\u65f6 \uff0c\u5047\u8bbe\u6240\u6709\u7684 RS\u90fd\u662fdown \uff0c\u4ee5\u53ca\u5065\u5eb7\u68c0\u67e5\u662f\u5931\u8d25\u7684\u3002\u6709\u52a9\u4e8e\u9632\u6b62\u542f\u52a8\u65f6\u7684\u8bef\u62a5\u3002\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002 omega \uff1a\u5728 keepalived\u7ec8\u6b62\u65f6 \uff0c\u4f1a\u6267\u884c quorum_down\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u811a\u672c \u3002 quorum < INT > \uff1a\u9ed8\u8ba4\u503c 1 . \u6240\u6709\u7684\u5b58\u6d3b\u7684\u670d\u52a1\u5668\u7684\u603b\u7684\u6700\u5c0f\u6743\u91cd\u3002 quorum_up < STRING > \uff1a\u5f53 quorum\u589e\u957f\u5230\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6 \uff0c\u6267\u884c\u8be5\u811a\u672c\u3002 quorum_down < STRING > \uff1a\u5f53 quorum\u51cf\u5c11\u5230\u4e0d\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6 \uff0c\u6267\u884c\u8be5\u811a\u672c\u3002 } real_server IP Port { weight < INT > \uff1a \u7ed9\u670d\u52a1\u5668\u6307\u5b9a\u6743\u91cd \u3002 \u9ed8\u8ba4\u662f1 . inhibit_on_failure \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6 \uff0c \u5c06\u5176weight\u8bbe\u7f6e\u4e3a0 \uff0c \u800c\u4e0d\u662f\u4eceVirtual Server\u4e2d\u79fb\u9664 \u3002 notify_up < STRING > \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u6210\u529f\u65f6 \uff0c \u6267\u884c\u7684\u811a\u672c \u3002 notify_down < STRING > \uff1a \u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6 \uff0c \u6267\u884c\u7684\u811a\u672c \u3002 uthreshold < INT > \uff1a \u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5927\u8fde\u63a5\u6570 \u3002 lthreshold < INT > \uff1a \u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5c0f\u8fde\u63a5\u6570 \u3002 } # real_server\u4e2d\u7684\u5065\u5eb7\u68c0\u67e5 HTTP_GET | SSL_GET { url { path < STRING > \uff1a \u6307\u5b9a\u8981\u68c0\u67e5\u7684URL\u7684\u8def\u5f84 \u3002 \u5982path / or path / mrtg2 digest < STRING > \uff1a \u6458\u8981 \u3002 \u8ba1\u7b97\u65b9\u5f0f \uff1a genhash - s 172.17.100.1 - p 80 - u / index . html status_code < INT > \uff1a \u72b6\u6001\u7801 \u3002 } nb_get_retry < INT > \uff1a get\u5c1d\u8bd5\u6b21\u6570 \u3002 delay_before_retry < INT > \uff1a \u5728\u5c1d\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u957f\u65f6\u95f4 \u3002 connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 } TCP_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INIT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 \u9ed8\u8ba4\u662f1\u6b21 \u3002 delay_before_retry < INT > \uff1a \u9ed8\u8ba4\u662f1\u79d2 \u3002 \u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2 \u3002 } SMTP_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 delay_before_retry < INT > \uff1a \u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2 \u3002 helo_name < STRING > \uff1a \u7528\u4e8eSMTP HELO\u8bf7\u6c42\u7684\u5b57\u7b26\u4e32 \u3002 } DNS_CHECK { connect_ip < IP ADDRESS > \uff1a \u8fde\u63a5\u7684IP\u5730\u5740 \u3002 \u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740 \u3002 connect_port < PORT > \uff1a \u8fde\u63a5\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3 \u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3 bindto < IP ADDRESS > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740 \u3002 bind_port < PORT > \uff1a \u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3 \u3002 connect_timeout < INT > \uff1a \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 \u3002 \u9ed8\u8ba4\u662f5s \u3002 fwmark < INTEGER > \uff1a \u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0 \u3002 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 retry < INT > \uff1a \u91cd\u8bd5\u6b21\u6570 \u3002 \u9ed8\u8ba4\u662f3\u6b21 \u3002 type < STRING > \uff1a DNS query type \u3002 A / NS / CNAME / SOA / MX / TXT / AAAA name < STRING > \uff1a DNS\u67e5\u8be2\u7684\u57df\u540d \u3002 \u9ed8\u8ba4\u662f (.) } MISC_CHECK { misc_path < STRING > \uff1a \u5916\u90e8\u7684\u811a\u672c\u6216\u7a0b\u5e8f\u8def\u5f84 \u3002 misc_timeout < INT > \uff1a \u811a\u672c\u6267\u884c\u8d85\u65f6\u65f6\u95f4 \u3002 user USERNAME [ GROUPNAME ] \uff1a \u6307\u5b9a\u8fd0\u884c\u8be5\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4 \u3002 \u5982\u679c\u6ca1\u6709\u6307\u5b9aGROUPNAME \uff0c \u5219GROUPNAME\u540cUSERNAME \u3002 misc_dynamic \uff1a \u6839\u636e\u9000\u51fa\u72b6\u6001\u7801\u52a8\u6001\u8c03\u6574\u6743\u91cd \u3002 0 \uff0c \u5065\u5eb7\u68c0\u67e5\u6210\u529f \uff0c \u6743\u91cd\u4e0d\u53d8 \u3002 1 \uff0c \u5065\u5eb7\u68c0\u67e5\u5931\u8d25 \u3002 2 - 255 \uff0c \u5065\u5eb7\u68c0\u67e5\u6210\u529f \u3002 \u6743\u91cd\u8bbe\u7f6e\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u51cf\u53bb2 . \u5982\u9000\u51fa\u72b6\u6001\u7801\u662f250 \uff0c \u5219\u6743\u91cd\u8c03\u6574\u4e3a248 warmup < INT > \uff1a \u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf \uff0c \u6700\u5927\u4e3aN\u79d2 \u3002 \u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e \u3002 \u5982\u679c\u4e3a0 \uff0c \u5219\u5173\u95ed\u8be5\u529f\u80fd \u3002 }","title":"LVS\u914d\u7f6e"},{"location":"LVS/#keepalived_1","text":"# keepalived \u9ed8\u8ba4\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7 / var / log / messages \u4e2d vi / etc / sysconfig / keepalived # Options for keepalived . See ` keepalived -- help ' output and keepalived(8) and # keepalived . conf ( 5 ) man pages for a list of all options . Here are the most # common ones : # # -- vrrp - P Only run with VRRP subsystem . # -- check - C Only run with Health - checker subsystem . # -- dont - release - vrrp - V Dont remove VRRP VIPs & VROUTEs on daemon stop . # -- dont - release - ipvs - I Dont remove IPVS topology on daemon stop . # -- dump - conf - d Dump the configuration data . # -- log - detail - D Detailed log messages . # -- log - facility - S 0 - 7 Set local syslog facility ( default = LOG_DAEMON )( \u65e5\u5fd7\u7684\u7ea7\u522b ) # # \u628a KEEPALIVED_OPTIONS = \u201d - D \u201d \u4fee\u6539\u4e3a KEEPALIVED_OPTIONS = \u201d - D - d - S 0 \u201d\uff0c\u5176\u4e2d - S \u6307\u5b9a syslog \u7684 facility KEEPALIVED_OPTIONS = \" -D -d -S 0 \" # \u4fee\u6539 / etc / rsyslog . conf \u672b\u5c3e\u6dfb\u52a0 vi / etc / rsyslog . conf local0 . * / var / log / keepalived . log # \u91cd\u542f\u65e5\u5fd7\u8bb0\u5f55\u670d\u52a1 systemctl restart rsyslog # \u91cd\u542f keepalived systemctl restart keepalived \u65e5\u5fd7\u7ea7\u522b\uff1a\u6307\u5b9a\u89e6\u53d1\u65e5\u5fd7\u4e8b\u4ef6\u7684\u7ea7\u522b","title":"\u4fee\u6539Keepalived\u65e5\u5fd7"},{"location":"LVS/#lvs-natkeepalived","text":"LVS-DR\u4fee\u6539virtual_server\u4e0blb_kind NAT\u53c2\u6570\u4e3alb_kind DR(LVS-DR\u4e3a\u5e38\u7528\u65b9\u5f0f) IP\u5730\u5740 \u4e3b\u673a\u540d \u7c7b\u578b 1.1.1.10 LVS-Master VIP 192.168.1.10 LVS-Master DIP 1.1.1.20 LVS-Backup VIP 192.168.1.20 LVS-Backup DIP 192.168.1.100 Web-node1 realserver1 192.168.1.200 Web-node2 realserver2 1.1.1.131 client client \u516c\u7f51\u6d6e\u52a8IP\uff1a1.1.1.1 \u5185\u7f51\u6d6e\u52a8IP\uff1a192.168.1.1 eth0:1.1.1.10 ___________ ___________ VIP | | | | | LVS-Master|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node1 |192.168.1.100 |___________| /|_________ | eth1:192.168.1.10 | /| DIP | / ________ | / | | | \\/ | client |\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014 /\\ |________| | / \\ | / \\ | / \\ eth0:1.1.1.20 |____ / \\/__________ VIP | | | | | LVS-Backup|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node2 |192.168.1.200 DIP |___________| /|___________| eth1:192.168.1.20","title":"LVS-NAT+Keepalived\u4e3b\u4ece\u90e8\u7f72\u793a\u4f8b"},{"location":"LVS/#lvsip","text":"vim /etc/sysconfig/network-scripts/ifcfg-eth0 vim /etc/sysconfig/network-scripts/ifcfg-eth1 # \u4fee\u6539\u5185\u6838\u53c2\u6570 vim /etc/sysctl.conf net.ipv4.ip_forward = 1 net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.default.send_redirects = 0 net.ipv4.conf.eth0.send_redirects = 0 sysctl -p # realserver\u5206\u522b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 # \u7ed1\u5b9avip(centos6) ifconfig lo:0 1 .1.1.1 netmask 255 .255.255.255 broadcast 1 .1.1.1 # (centos7) ip a a 1 .1.1.1/24 dev lo:0 # arp\u6291\u5236 echo \"1\" >/proc/sys/net/ipv4/conf/lo/arp_ignore echo \"2\" >/proc/sys/net/ipv4/conf/lo/arp_announce echo \"1\" >/proc/sys/net/ipv4/conf/all/arp_ignore echo \"2\" >/proc/sys/net/ipv4/conf/all/arp_announce # arp_ignore:\u5b9a\u4e49\u63a5\u6536\u5230ARP\u8bf7\u6c42\u65f6\u7684\u54cd\u5e94\u7ea7\u522b 0 \uff1a\u53ea\u8981\u672c\u5730\u914d\u7f6e\u7684\u6709\u5bf9\u5e94\u5730\u5740\uff0c\u5c31\u7ed9\u4e88\u56de\u5e94\uff1b\u9ed8\u8ba4 1 \uff1a\u4ec5\u5728\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u5740\u914d\u7f6e\u5728\u5230\u8fbe\u7684\u63a5\u53e3\u4e0a\u65f6\uff0c\u624d\u7ed9\u4e88\u56de\u5e94 # arp_announce\uff1a\u5b9a\u4e49\u5c06\u81ea\u5df1\u7684\u5730\u5740\u5411\u5916\u901a\u544a\u65f6\u7684\u901a\u544a\u7ea7\u522b 0 \uff1a\u5c06\u672c\u5730\u4efb\u4f55\u63a5\u53e3\u4e0a\u7684\u4efb\u4f55\u5730\u5740\u5411\u5916\u901a\u544a\uff1b\u9ed8\u8ba4 1 \uff1a\u8bd5\u56fe\u4ec5\u5411\u76ee\u6807\u7f51\u7edc\u901a\u544a\u5176\u7f51\u7edc\u5339\u914d\u7684\u5730\u5740 2 \uff1a\u4ec5\u5411\u4e0e\u672c\u5730\u63a5\u53e3\u4e0a\u5730\u5740\u5339\u914d\u7684\u7f51\u7edc\u8fdb\u884c\u901a\u544a # \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u76f8\u540c\u7684\u914d\u7f6e\u9879 vrrp_instance VI_1 virtual_router_id 51 auth_type PASS auth_pass 1111 virtual_ipaddress # \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u4e0d\u76f8\u540c\u7684\u914d\u7f6e\u9879 router_id id1 state MASTER priority 100 # \u4e0a\u8ff0\u7b80\u5316\u8bbe\u7f6e--\u5728realserver\u521b\u5efa\u811a\u672crs.sh #!/bin/bash #\u9002\u7528\u4e8ecentos6 vip1 = 1 .1.1.10 vip2 = 1 .1.1.20 dev1 = lo:1 dev2 = lo:2 case $1 in start ) echo 1 > /proc/sys/net/ipv4/conf/all/arp_ignore echo 1 > /proc/sys/net/ipv4/conf/lo/arp_ignore echo 2 > /proc/sys/net/ipv4/conf/all/arp_announce echo 2 > /proc/sys/net/ipv4/conf/lo/arp_announce ifconfig $dev1 $vip1 netmask 255 .255.255.255 broadcast $vip up ifconfig $dev2 $vip2 netmask 255 .255.255.255 broadcast $vip2 up sysctl -p >/dev/null 2 > & 1 echo \"VS Server is Ready!\" ;; stop ) ifconfig $dev down echo 0 > /proc/sys/net/ipv4/conf/all/arp_ignore echo 0 > /proc/sys/net/ipv4/conf/lo/arp_ignore echo 0 > /proc/sys/net/ipv4/conf/all/arp_announce echo 0 > /proc/sys/net/ipv4/conf/lo/arp_announce echo \"VS Server is Cancel!\" ;; * ) echo \"Usage `basename $0 ` start|stop\" exit 1 ;; esac","title":"LVS\u670d\u52a1\u5668\u4e0a\u914d\u7f6eIP"},{"location":"LVS/#lvskeepalived_1","text":"","title":"LVS\u670d\u52a1\u5668\u4e0a\u5206\u522b\u5b89\u88c5\u5e76\u914d\u7f6ekeepalived"},{"location":"LVS/#lvskeepalivedconf","text":"global_defs { notification_email { your_email@qq.com # \u90ae\u4ef6\u53d1\u751f\u76ee\u7684\u4eba } notification_email_from keepalived@localhost smtp_server 127 .0.0.1 #\u672c\u673a\u90ae\u4ef6\u670d\u52a1\u5668 smtp_connect_timeout 30 #\u8d85\u65f6\u65f6\u95f4 router_id LVS_R1 # \u6807\u8bc6\u670d\u52a1\u5668ID } vrrp_sync_group VG1 { # \u8bbe\u7f6e\u5b9e\u4f8b\u7ec4 group { VI_1 VI_2 } } vrrp_instance VI_1 { # \u5b9e\u4f8b\u540d\u79f0\uff0c\u5b9e\u4f8b\u53ef\u4ee5\u4e00\u4e2a\uff0c\u4e5f\u53ef\u591a\u4e2a state MASTER # \u4e3bLVS\u670d\u52a1\u5668 interface eth0 # \u7f51\u5361\u63a5\u53e3 virtual_router_id 1 # \u670d\u52a1\u5668id priority 100 # \u4f18\u5148\u7ea7(0~255) advert_int 1 # \u5fc3\u8df3\u68c0\u6d4b1\u79d2\u6bcf\u6b21 authentication { # \u8bbe\u7f6e\u9a8c\u8bc1\uff0cmaster\u548cbackup\u5fc5\u987b\u76f8\u540c auth_type PASS # \u57fa\u4e8e\u5bc6\u7801\u9a8c\u8bc1\u7c7b\u578b auth_pass 1111 # \u5bc6\u7801 } virtual_ipaddress { 1 .1.1.1 # \u516c\u7f51\u6d6e\u52a8IP } } vrrp_instance VI_2 { state MASTER interface eth1 virtual_router_id 1 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192 .168.1.1 # \u5185\u7f51\u6d6e\u52a8IP } } virtual_server 1 .1.1.1 80 { delay_loop 15 # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4 lb_algo rr # \u8c03\u5ea6\u7b97\u6cd5 lb_kind NAT # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u8c03\u5ea6\u65b9\u5f0f protocol TCP real_server 192 .168.1.100 80 { weight 1 # \u6743\u91cd\u503c TCP_CHECK { # \u5065\u5eb7\u68c0\u67e5\u65b9\u5f0f connect_port 80 # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3 connect_timeout 3 # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4 nb_get_retry 3 # \u91cd\u8bd5\u6b21\u6570 delay_before_retry 4 # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4 } } real_server 192 .168.1.200 80 { weight 1 TCP_CHECK { connect_port 80 connect_timeout 3 nb_get_retry 3 delay_before_retry 4 } } }","title":"\u4e3bLVS\u914d\u7f6ekeepalived.conf"},{"location":"LVS/#lvs_1","text":"global_defs { router_id LVS_R1 } vrrp_sync_group VG1 { group { VI_1 VI_2 } } vrrp_instance VI_1 { state BACKUP interface eth0 virtual_router_id 1 priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 1 .1.1.1 } } vrrp_instance VI_2 { state BACKUP interface eth1 virtual_router_id 1 priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192 .168.1.1 } } virtual_server 1 .1.1.1 80 { delay_loop 15 # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4 lb_algo rr # \u8c03\u5ea6\u7b97\u6cd5 lb_kind NAT # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u6a21\u5f0f protocol TCP real_server 192 .168.1.100 80 { weight 1 # \u6743\u91cd\u503c TCP_CHECK { connect_port 80 # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3 connect_timeout 3 # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4 nb_get_retry 3 # \u91cd\u8bd5\u6b21\u6570 delay_before_retry 4 # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4 } } real_server 192 .168.1.200 80 { weight 1 TCP_CHECK { connect_port 80 connect_timeout 3 nb_get_retry 3 delay_before_retry 4 } } }","title":"\u4eceLVS\u914d\u7f6e"},{"location":"LVS/#lvs_notifysh","text":"#!/bin/bash contact = 'your_email_address' notify () { local mailsubject = \" $( hostname ) to be $1 , vip floating\" local mailbody = \" $( date + '%F %T' ) : vrrp transition, $( hostname ) changed to be $1 \" echo \" $mailbody \" | mail -s \" $mailsubject \" $contact } case $1 in master ) notify master ;; backup ) notify backup ;; fault ) notify fault ;; * ) echo \"Usage: $( basename $0 ) {master|backup|fault}\" exit 1 ;; esac","title":"\u521b\u5efa\u901a\u7528\u5355\u72ec\u7684\u68c0\u67e5\u90ae\u4ef6\u63d0\u9192\u811a\u672clvs_notify.sh"},{"location":"Linux/","text":"Linux \u00b6 I. stunnel -> varnish -> HAProxy -> nginx -> nodeJS -> memcached(redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8]) II. Apache Traffic Server/Squid/Vanish + HAProxy + Nginx + memcached(Redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8]) III. nginx (for HTTP compression) \u2013> Varnish cache (for caching) \u2013> HTTP level load balancer (HAProxy, or nginx, or the Varnish built-in) \u2013> webservers \u5206\u533a\u65b9\u6848\u53c2\u8003 \u00b6 \u670d\u52a1\u5668\u7c7b\u578b \u57fa\u672craid\u65b9\u6848 \u5355\u673a\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\uff0c\u4e00\u822c\u53ef\u91c7\u7528raid5\u6298\u4e2d \u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982LVS\u7b49\uff09 \u6570\u636e\u91cf\u5c0f\uff0c\u91cd\u8981\u6027\u9ad8\uff0c\u53ef\u91c7\u7528RAID1 \u8d1f\u8f7d\u5747\u8861\u4e0b\u7684RS server \u6570\u636e\u91cf\u5927\uff0c\u91cd\u8981\u6027\u4e0d\u9ad8\uff0c\u6709\u6027\u80fd\u8981\u6c42\uff0c\u6570\u636e\u8981\u6c42\u4f4e\uff0c\u53ef\u91c7\u7528RAID0 \u6570\u636e\u5e93\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\u4e3b\u5e93\u53ef\u91c7\u53d6raid10/raid5\uff0c\u4ece\u5e93\u53ef\u91c7\u7528raid0\u63d0\u9ad8\u6027\u80fd\uff08\u8bfb\u5199\u5206\u79bb\u7684\u60c5\u51b5\u4e0b\uff09 \u5b58\u50a8\u670d\u52a1\u5668 \u53ef\u91c7\u53d6sata\u76d8\uff0craid5 \u5171\u4eab\u5b58\u50a8\u670d\u52a1\u5668\uff08\u5982NFS\uff09 \u89c6\u6027\u80fd\u53ca\u8bbf\u95ee\u8981\u6c42\u53ef\u4ee5raid5,raid10,\u751a\u81f3raid0\uff08\u8981\u6709\u9ad8\u53ef\u7528\u6216\u53cc\u5199\u65b9\u6848\uff09 \u76d1\u63a7\u670d\u52a1\u5668 \u5355\u76d8\u6216\u53cc\u76d8raid1\u5373\u53ef\u3002\u4e09\u76d8\u5c31RAID5\uff0c\u770b\u5bb9\u91cf\u8981\u6c42\u52a0\u76d8\u5373\u53ef Linux\u6587\u4ef6\u7cfb\u7edf \u00b6 linux\u78c1\u76d8\u8be6\u89e3 \u00b6 \u78c1\u76d8\u5206\u533a\u6709\u4e3b\u5206\u533a\u3001\u6269\u5c55\u5206\u533a\u3001\u903b\u8f91\u5206\u533a\uff0c\u4e00\u5757\u786c\u76d8\u6700\u591a\u53ef\u4ee5\u6709\u56db\u4e2a\u4e3b\u5206\u533a\uff0c\u5176\u4e2d\u4e00\u4e2a\u4e3b\u5206\u533a\u7684\u4f4d\u7f6e\u53ef\u4ee5\u7528\u4e00\u4e2a\u6269\u5c55\u5206\u533a\u66ff\u6362\uff0c\u4e14\u4e00\u5757\u786c\u76d8\u53ea\u80fd\u6709\u4e00\u4e2a\u6269\u5c55 \u5206\u533a\uff0c\u5728\u8fd9\u4e2a\u6269\u5c55\u5206\u533a\u5185\u53ef\u4ee5\u5212\u5206\u591a\u4e2a\u903b\u8f91\u5206\u533a \u9884\u8ba1\u8d85\u8fc7\u56db\u4e2a\u5206\u533a\uff0c\u81f3\u5c11\u4e00\u4e2a\u6269\u5c55\u5206\u533a\uff1a 3 p + 1 e \u3001 2 p + 1 e \u3001 1 p + 1 e -----p\uff1a\u4e3b\u5206\u533a\u3001e\uff1a\u6269\u5c55\u5206\u533a \u78c1\u76d8\u5206\u533a\u7684\u8bbe\u5907\u540d\uff1a \u5728 linux\u4e2d \uff0c\u901a\u8fc7\u8bbe\u5907\u540d\u8bbf\u95ee\u8bbe\u5907\uff0c\u8bbe\u5907\u540d\u5b58\u653e\u5728 / dev\u76ee\u5f55 * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / hda * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / hdb * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / sda * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / sdb \u5206\u533a\u5219\u4f7f\u7528\u6570\u5b57\u7f16\u53f7\u6807\u8bc6\uff1a * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / hda1 * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / hdb1 * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / sdb1 \u6ce8\u610f\uff1a \u5206\u533a\u6570\u5b57\u7f16\u53f7 1 - 4 \u7559\u7ed9\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\u4f7f\u7528\uff0c\u903b\u8f91\u5206\u533a\u662f\u5728\u6269\u5c55\u5206\u533a\u7684\u57fa\u7840\u4e0a\u7f16\u53f7\u4ece 5 \u5f00\u59cb SCSI / SAS / SATA / USB\u63a5\u53e3\u7684\u786c\u76d8\u7684\u8bbe\u5907\u540d\u5747\u4ee5 / dev / sd\u5f00\u5934 \uff0c\u4e0d\u540c\u786c\u76d8\u7f16\u53f7\u4f9d\u6b21\u662f / dev / sda \u3001 / dev / sdb SAS / SATA\u662f\u4e3b\u6d41\u786c\u76d8\u63a5\u53e3 \uff0c SSD\u56fa\u6001\u786c\u76d8 \uff0c\u901f\u5ea6\u6027\u80fd SSD > SAS > SATA linux\u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\u89e3\u6790 \u00b6 \u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\uff1a \u56fa\u4ef6 firmware ( CMOS / BIOS ) post \u52a0\u7535\u81ea\u68c0 \u5bf9\u4e8e\u56fa\u4ef6\u7684\u7406\u89e3\uff0c\u662f\u4ecb\u4e8e\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u8f6f\u4ef6\u4ee3\u7801\uff0c\u4f46\u540c\u65f6\u70e7\u5f55\u5230\u786c\u4ef6\u5f53\u4e2d\uff1b CMOS \u56fa\u5316\u5728\u786c\u4ef6\u4e2d\uff0c\u4f5c\u4e3a\u56fa\u4ef6\u7684\u5e73\u53f0\uff0c BIOS \u662f\u7ba1\u7406 CMOS \u7684\u7ba1\u7406\u754c\u9762 \u63a5\u7740\uff0c\u81ea\u4e3e\u7a0b\u5e8f bootloader ( GRUB ) ,\u8f7d\u5165\u5185\u6838 \u7b2c\u4e00\u6b65\u7684\u6700\u540e\u8981\u8bfb\u53d6\u786c\u76d8\u4e2d\u7684 MBR \uff0c\u5305\u542b\u4e86 BootLoader ,\u5728 MBR \u4e2d\u8fd8\u5305\u542b\u4e86\u5206\u533a\u8868\u7b49\u4fe1\u606f \u5185\u6838\u7684\u5de5\u4f5c\uff0c\u9a71\u52a8\u786c\u4ef6\uff0c\u542f\u52a8\u521d\u59cb\u8fdb\u7a0b init ;\u5728kernel\u4e2d\u5927\u90e8\u5206\u90fd\u662f\u7a0b\u5e8f\uff1binit\u542f\u52a8\u540e\u8bfb\u53d6inittab\u6587\u4ef6\uff0c\u6267\u884c\u7f3a\u7701\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\uff0c\u4ece\u800c\u7ee7\u5f15\u5bfc\u8fc7\u7a0b\uff1b \u5728 linux \u7cfb\u7edf\u4e2d\uff0c init \u662f\u7b2c\u4e00\u4e2a\u5b58\u5728\u7684\u8fdb\u7a0b\uff0c\u5b83\u7684 PID \u6052\u4e3a\u4e00\uff0c\u4f46\u4e5f\u5fc5\u987b\u5411\u4e00\u4e2a\u66f4\u9ad8\u7ea7\u7684\u529f\u80fd\u8d1f\u8d23\uff1a PID \u4e3a\u96f6\u7684\u5185\u6838\u8c03\u5ea6\u5668\uff0c\u4ece\u800c\u83b7\u5f97 cpu \u65f6\u95f4 \u5173\u952e\u70b9\uff1a\u5bf9\u4e8e\u7236\u5b50\u8fdb\u7a0b\u7684\u5173\u7cfb\u3002\u9996\u5148\uff0c\u7236\u8fdb\u7a0b\u4e2d\u65ad\uff0c\u5b50\u8fdb\u7a0b\u540c\u6837\u4f1a\u4e2d\u65ad\uff1b\u5982\u679c\u7236\u8fdb\u7a0b\u4e2d\u65ad\u540e\uff0c\u5b50\u8fdb\u7a0b\u6ca1\u6709\u4e2d\u65ad\uff0c\u8fd9\u79cd\u5173\u7cfb\u5f62\u8c61\u79f0\u4e4b\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u53d1\u73b0\u540e \u4f1a\u5c06\u5b64\u513f\u8fdb\u7a0b\u6307\u5411\u7236\u8fdb\u7a0b init ;\u5982\u679c\u7236\u8fdb\u7a0b\u6b63\u5e38\uff0c\u800c\u5b50\u8fdb\u7a0b\u4e2d\u65ad\u7684\u8bdd\uff0c\u8fd9\u6837\u6ef4\u5173\u7cfb\u79f0\u4e4b\u4e3a\u50f5\u5c38\u8fdb\u7a0b\uff1b\u8fd9\u4e24\u79cd\u8fdb\u7a0b\u5728\u7cfb\u7edf\u4e2d\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684 \u5907\u6ce8\uff1a linux \u4e2d\u7684\u8fd0\u884c\u7ea7\u522b\u7c7b\u4f3c\u4e8e windows \u5e73\u53f0\u4e2d\u7684 F8 \u529f\u80fd \u5355\u7528\u6237\u6a21\u5f0f\uff08\u7ea7\u522b 1 \uff09\u7c7b\u4f3c windos \u5e73\u53f0\u4e2d F8 \u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u533a\u522b\u662f\u6ca1\u6709\u56fe\u5f62\u754c\u9762\uff0c\u53ea\u6709\u547d\u4ee4\u8f93\u5165 \u8fd0\u884c\u7ea7\u522b 2 \u548c 3 \u7684\u533a\u522b\u5c31\u662f 2 \u7ea7\u522b\u6ca1\u6709 NFS \u529f\u80fd\uff0c\u540c\u65f6\u90fd\u662f\u591a\u7528\u6237\u6a21\u5f0f \u67e5\u770b\u5f53\u524d\u7684\u8fd0\u884c\u7ea7\u522b\uff1a runlevel \u8fd0\u884c\u7ea7\u522b\u7684\u5207\u6362\uff1a init 0 1 2 3 4 5 S \u6216\u8005 telinit 0 1 2 3 4 5 \u6269\u5c55\uff1a\u5b9e\u9645\u5927\u5bb6\u901a\u8fc7\u547d\u4ee4 ls - l ` which telinit `\u5f97\u77e5 telinit \u540d\u662f init \u547d\u4ee4\u7684\u4e00\u4e2a\u8f6f\u8fde\u63a5\u800c\u5df2 grep - v \" ^# \" / etc / inittabl #\u63d0\u53d6\u6709\u6548\u884c\uff0c\u4f5c\u4e3a\u5206\u6790\u6570\u636e \u6587\u4ef6\u683c\u5f0f\u5206\u6790\uff1a\uff08\u5b57\u6bb5\u7ec4\u6210\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a\uff09 id : runlevels action : process id \u6807\u793a\u7b26,\u4e00\u822c\u90fd\u662f\u4e24\u4f4d\u5b57\u6bcd\u6216\u8005\u6570\u5b57 runlevels \u6307\u5b9a\u8fd0\u884c\u7ea7\u522b\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff1b\u4f8b\u5982::\u4ee3\u8868 0 - 6 action \u6307\u5b9a\u8fd0\u884c\u72b6\u6001 process \u6307\u5b9a\u8981\u8fd0\u884c\u7684\u811a\u672c\u6216\u8005\u547d\u4ee4 action \u53d6\u503c\uff1a initdefault \u8868\u793a\u7cfb\u7edf\u7f3a\u7701\u7684\u542f\u52a8\u8fd0\u884c\u7ea7\u522b sysinit \u7cfb\u7edf\u542f\u52a8\u65f6\u6267\u884c process \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4 wait \u6267\u884c process \u4e2d\u6307\u5b9a\u547d\u4ee4\uff0c\u5e76\u7b49\u5230\u7ed3\u675f\u540e\u5728\u8fd0\u884c\u5176\u4ed6\u7684\u547d\u4ee4 one \u6267\u884c process \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u7ed3\u675f ctrlaltdel \u6309\u4e0b\u7ec4\u5408\u952e\u6267\u884c process \u6307\u5b9a\u7684\u547d\u4ee4\uff1b ( \u5173\u673a\u7684\u64cd\u4f5c ) \u5148\u540e\u987a\u5e8f\uff1a 1 . id : 3 : initdefault \uff1a 2 . l3 : 3 : wait : / etc / rc . d / rc 3 . / etc / rc . d / rc3 . d \u5224\u65ad\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\u8c03\u7528 / etc / rc . d / rc \u811a\u672c\uff0c\u6267\u884c\u76f8\u5173\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e2d\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u5b8c\u6210\u76f8\u5e94\u8fd0\u884c\u7ea7\u522b\u7684\u521d\u59cb\u5316\u914d\u7f6e\uff1b\u4e4b\u540e\u627e\u5230 / etc / rc . d / rc3 . d \u811a\u672c\uff0c \u5b8c\u6210\u7cfb\u7edf\u540e\u7eed\u7684\u5f15\u5bfc\u8fc7\u7a0b\uff0c\u5176\u4f5c\u7528\u662f\u5206\u522b\u5b58\u653e\u5bf9\u5e94\u4e8e\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u94fe\u63a5\u5230 init . d \u76ee\u5f55\u4e2d\u7684\u76f8\u5e94\u811a\u672c / etc / rc . d / r3 . d \u76ee\u5f55\u5305\u542b\u4e86\u4e24\u79cd\u6587\u4ef6\u5f88\u91cd\u8981\uff0c\u4e00\u79cd\u5927\u5199 S \u5f00\u5934\uff0c\u53e6\u4e00\u79cd\u662f\u5927\u5199\u7684 K \u5f00\u5934 S start K kill number \u8868\u793a\u542f\u52a8\u7684\u987a\u5e8f\uff0c\u6570\u5b57\u8d8a\u5c0f\u4f18\u5148\u542f\u52a8\uff1b\u5982\u679c\u6570\u5b57\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u4f1a\u6309\u7167\u521b\u5efa\u7684\u65f6\u95f4 Firmware | BootLoader | Kernel | init | / etc / inittab | initdefault | / etc / rc . d / rc . sysinit | / etc / rc . d / rc | / etc / rc . d / rcN . d | Login ( username , password ) \u542f\u52a8\u7cfb\u7edf\u9996\u5148\u56fa\u4ef6\u7684\u52a0\u7535\u81ea\u68c0\uff1b\u5178\u578b\u4e3a PC \u4e2d cmos / bios \u4f5c\u7528\u662f\u5728\u7269\u5c42\u6b21\u9762\u4e0a\u68c0\u6d4b\u6240\u6709\u7684\u786c\u4ef6\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1b\u5982\u679c\u786c\u4ef6\u6b63\u5e38\u7684\u8bdd\uff0c\u4f1a\u8bfb\u53d6\u786c\u76d8\u7684\u4e0a\u5b58\u653e \u7269\u7406\u6570\u636e\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e MBR \uff0c MBR \u4e3b\u8981\u662f\u5b58\u653e\u81ea\u4e3e\u7a0b\u5e8f BootLoader \uff0c\u5728 linux \u7cfb\u7edf\u4e2d\u6211\u4eec\u5927\u591a\u6570\u91c7\u7528\u7684\u662f GRUB \uff0c GRUB \u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u8f7d\u5165\u5185\u6838\uff1b\u8f7d\u5165 \u5185\u6838\u540e\uff0c\u4e24\u4e2a\u4f5c\u7528\uff0c\u7b2c\u4e00\u662f\u5728 linux \u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u4e0a\u662f\u9a71\u52a8\u786c\u4ef6\u548c\u542f\u52a8 init \u8fdb\u7a0b\uff1b\u7136\u540e\u8bfb\u53d6 / etc / inittab \u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u7f6e\u6587\u4ef6\u4f1a\u5224\u65ad\u7cfb\u7edf\u7f3a\u7701\u7684\u8fd0\u884c \u7ea7\u522b\u7136\u540e\u6267\u884c\u811a\u672c / etc / rc . d / rc . sysinit \u52a0\u8f7d\u57fa\u672c\u7684\u7cfb\u7edf\u670d\u52a1\uff1b\u63a5\u7740\u6839\u636e\u8bbe\u7f6e\u7684\u7f3a\u7701\u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\uff08 id : 3 , 5 : initdefault :\uff09\u6267\u884c / etc / rc . d / rc \u811a\u672c\uff0c\u6b64\u811a\u672c\u4f1a\u5224\u65ad initdefault \uff0c\u7136\u540e\u542f\u52a8\u5bf9\u5e94\u7684\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e0b\u9762\u7684\u7a0b\u5e8f / etc / rc . d / rcN . d \uff0c\u6700\u540e\u51fa\u73b0\u767b\u9646\u754c\u9762\u4e86\uff0c\u8f93\u5165\u6b63\u786e\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef \u767b\u5f55\u7cfb\u7edf\u7ee7\u800c\u7ba1\u7406\u670d\u52a1\u5668 / etc / rc . d / init . d \u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u4e86\u5404\u4e2a\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c / etc / init . d \u53d1\u73b0\u6b64\u6587\u4ef6\u662f / etc / rc . d / init . d \u7684\u8f6f\u8fde\u63a5 \u6dfb\u52a0\u786c\u76d8\u6216\u5206\u533a\u8be6\u7ec6\u6b65\u9aa4 \u00b6 dmesg | grep sdb # \u68c0\u67e5\u786c\u76d8\u8bbe\u5907sdb\u662f\u5426\u5b58\u5728 fdisk -l /dev/sdb # \u67e5\u770b\u6b64\u786c\u76d8\u8bbe\u5907\u4fe1\u606f fdisk /dev/sdb # \u5bf9\u786c\u76d8\u8fdb\u884c\u5206\u533a\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u65f6ext4\u7c7b\u578b\uff0cid=83\uff0cid=82\u662fswap : << comment \u8f93\u5165`m`\u5217\u51fa\u53ef\u4ee5\u6267\u884c\u7684\u547d\u4ee4\uff1a command (m for help): m \u8f93\u5165`p`\u5217\u51fa\u78c1\u76d8\u76ee\u524d\u7684\u5206\u533a\u60c5\u51b5\uff1a Command (m for help): p \u8f93\u5165`d`\u7136\u540e\u9009\u62e9\u5206\u533a\uff0c\u5220\u9664\u73b0\u6709\u5206\u533a\uff1a Command (m for help): d Partition number (1-4): 1 Command (m for help): d Selected partition 2 \u67e5\u770b\u5206\u533a\u60c5\u51b5\uff0c\u786e\u8ba4\u5206\u533a\u5df2\u7ecf\u5220\u9664(\u5bf9\u5e94\u5206\u533a\u5220\u9664\u540e\uff0c\u4e0d\u4f1a\u518d\u663e\u793a)\uff1a Command (m for help): p \u8f93\u5165`n`\u5efa\u7acb\u65b0\u7684\u78c1\u76d8\u5206\u533a\uff0c\u9996\u5148\u5efa\u7acb\u4e24\u4e2a\u4e3b\u78c1\u76d8\u5206\u533a\uff1a Command (m for help): n Command action e extended p primary partition (1-4) p //\u5efa\u7acb\u4e3b\u5206\u533a Partition number (1-4): 1 //\u5206\u533a\u53f7 First cylinder (1-391, default 1): //\u5206\u533a\u8d77\u59cb\u4f4d\u7f6e Using default value 1 last cylinder or +size or +sizeM or +sizeK (1-391, default 391): 100 //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3a\u6247\u533a Command (m for help): n //\u518d\u5efa\u7acb\u4e00\u4e2a\u5206\u533a Command action e extended p primary partition (1-4) p Partition number (1-4): 2 //\u5206\u533a\u53f7\u4e3a2 First cylinder (101-391, default 101): Using default value 101 Last cylinder or +size or +sizeM or +sizeK (101-391, default 391): +200M //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3aM \u786e\u8ba4\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u518d\u5efa\u7acb\u4e00\u4e2a\u903b\u8f91\u5206\u533a\uff1a Command (m for help): n Command action e extended p primary partition (1-4) e //\u9009\u62e9\u6269\u5c55\u5206\u533a Partition number (1-4): 3 First cylinder (126-391, default 126): Using default value 126 Last cylinder or +size or +sizeM or +sizeK (126-391, default 391): Using default value 391 \u786e\u8ba4\u6269\u5c55\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u5728\u6269\u5c55\u5206\u533a\u4e0a\u5efa\u7acb\u4e24\u4e2a\u903b\u8f91\u5206\u533a\uff1a Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l //\u9009\u62e9\u903b\u8f91\u5206\u533a First cylinder (126-391, default 126): Using default value 126 Last cylinder or +size or +sizeM or +sizeK (126-391, default 391): +400M Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l First cylinder (176-391, default 176): Using default value 176 Last cylinder or +size or +sizeM or +sizeK (176-391, default 391): Using default value 391 \u786e\u8ba4\u903b\u8f91\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u6700\u540e\u5bf9\u5206\u533a\u64cd\u4f5c\u8fdb\u884c\u5199\u5165\u4fdd\u5b58\uff1a Command (m for help): w # \u5efa\u7acb\u597d\u5206\u533a\u4e4b\u540e\u6211\u4eec\u8fd8\u9700\u8981\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u624d\u80fd\u5728\u7cfb\u7edf\u4e2d\u4f7f\u7528\u78c1\u76d8 mkfs.ext4 /dev/sdb1 # \u5728sdb1\u4e0a\u5efa\u7acbext4\u5206\u533a \u786c\u76d8sdb\u6211\u4eec\u5efa\u7acb\u4e862\u4e2a\u4e3b\u5206\u533a\uff08sdb1\uff0csdb2\uff09\uff0c1\u4e2a\u6269\u5c55\u5206\u533a\uff08sdb3\uff09\uff0c2\u4e2a\u903b\u8f91\u5206\u533a\uff08sdb5\uff0csdb6\uff09 \u6ce8\u610f\uff1a\u4e3b\u5206\u533a\u548c\u6269\u5c55\u5206\u533a\u7684\u78c1\u76d8\u53f7\u4f4d1-4\uff0c\u4e5f\u5c31\u662f\u8bf4\u6700\u591a\u67094\u4e2a\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\uff0c\u903b\u8f91\u5206\u533a\u5f00\u59cb\u7684\u78c1\u76d8\u53f7\u4e3a5\uff0c\u56e0\u6b64\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u6ca1\u6709sdb4 # \u5efa\u7acb\u4e24\u4e2a\u76ee\u5f55`/oracle`\u548c`/web`\uff0c\u5c06\u65b0\u5efa\u597d\u7684\u4e24\u4e2a\u5206\u533a\u6302\u8f7d\u5230\u7cfb\u7edf mkdir /oracle mkdir /web mount /dev/sdb1 /oracle mount /dev/sdb6 /web \u5982\u679c\u9700\u8981\u6bcf\u6b21\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\u5219\u9700\u8981\u4fee\u6539`/etc/fstab`\u6587\u4ef6\uff0c\u52a0\u5165\u4e24\u884c\u914d\u7f6e\uff1a /dev/sdb1 /oracle ext4 defaults 0 0 /dev/sdb6 /web ext4 defaults 0 0 comment Linux\u76ee\u5f55\u7ed3\u6784FHS \u00b6 \u57fa\u672c\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff1a ( \u53ef\u4ee5\u7528 file \u547d\u4ee4\u6765\u8bc6\u522b ) * \u666e\u901a\u6587\u4ef6\uff1a\u5982\u6587\u672c\u6587\u4ef6\u3001 c \u8bed\u8a00\u6e90\u4ee3\u7801\u3001 shell \u811a\u672c\u7b49\uff0c\u53ef\u4ee5\u7528 cat \u3001 less \u3001 more \u3001 vi \u7b49\u6765\u5bdf\u770b\u5185\u5bb9\uff0c\u7528 mv \u6765\u6539\u540d * \u76ee\u5f55\u6587\u4ef6\uff1a\u5305\u62ec\u6587\u4ef6\u540d\u3001\u5b50\u76ee\u5f55\u540d\u53ca\u5176\u6307\u9488\uff0c\u53ef\u4ee5\u7528 ls \u5217\u51fa\u76ee\u5f55\u6587\u4ef6 * \u94fe\u63a5\u6587\u4ef6\uff1a\u662f\u6307\u5411\u4e00\u7d22\u5f15\u8282\u70b9\u7684\u90a3\u4e9b\u76ee\u5f55\u6761\u76ee\uff0c\u7528 ls \u6765\u67e5\u770b\u65f6\uff0c\u94fe\u63a5\u6587\u4ef6\u7684\u6807\u5fd7\u7528 l \u5f00\u5934\uff0c\u800c\u6587\u4ef6\u540e\u4ee5 \" -> \" \u6307\u5411\u6240\u94fe\u63a5\u7684\u6587\u4ef6 * \u7279\u6b8a\u6587\u4ef6\uff1a\u5982\u78c1\u76d8\u3001\u7ec8\u7aef\u3001\u6253\u5370\u673a\u7b49\u90fd\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8868\u793a\u51fa\u6765\uff0c\u5e38\u653e\u5728 / dev \u76ee\u5f55\u5185 ~ \uff1a\u4ee3\u8868\u7528\u6237\u81ea\u5df1\u7684\u5bbf\u4e3b\u76ee\u5f55 .\uff1a\u8868\u793a\u5f53\u524d\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528. / \u8868\u793a ..\uff1a\u8868\u793a\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528.. / \u8868\u793a / bin \u4fdd\u5b58\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u53ef\u6267\u884c\u7684\u6307\u4ee4\uff09\u6743\u9650\u5bf9\u6240\u6709\u7528\u6237\u5f00\u653e / boot \u5b58\u653e\u5f00\u673a\u542f\u52a8\u52a0\u8f7d\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6,\u5305\u62ec\u5f15\u5bfc\u6587\u4ef6\u3001\u5185\u6838\u6587\u4ef6\u3001\u9a71\u52a8\u3001 \u63d2\u4ef6\u3001\u6a21\u5757\u7b49\uff1b ( \u5982 kernel \u548c grup ) / dev \u5b58\u653e\u4e86\u6240\u6709\u7684\u786c\u4ef6\u8bbe\u5907\u6587\u4ef6\uff1b\u7f51\u5361\uff0c\u58f0\u5361\uff0c\u786c\u76d8\uff0c\u5149\u9a71\uff1b tty1 , tty2 \u7ec8\u7aef\uff0c\u8bbe\u5907\u6587\u4ef6\u76ee\u5f55\uff0c\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u5b58\u653e\u6240\u6709\u7cfb\u7edf\u4e2d device \u7684\u76f8\u5173 \u4fe1\u606f\uff0c\u4e0d\u8bba\u662f\u4f7f\u7528\u7684\u6216\u672a\u4f7f\u7528\u7684\u8bbe\u5907\uff0c\u53ea\u8981\u6709\u53ef\u80fd\u4f7f\u7528\u5230\uff0c\u5c31\u4f1a\u5728 / dev \u4e2d\u5efa\u7acb\u4e00\u4e2a\u76f8\u5bf9\u5e94\u7684\u8bbe\u5907\u6587\u4ef6\uff1b\u8bbe\u5907\u6587\u4ef6\u5206\u4e3a 2 \u79cd\u7c7b\u578b\uff1a\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\u548c \u5757\u8bbe\u5907\u6587\u4ef6 ( \u76ee\u5f55\u4e2d\u57fa\u672c\u4e0a\u90fd\u662f\u8bbe\u5907\u6587\u4ef6\uff0c\u5982\u786c\u76d8\u8bbe\u5907\u6587\u4ef6 / dev / sda ) / dev / console \u7cfb\u7edf\u63a7\u5236\u53f0\uff0c\u4e5f\u5c31\u662f\u76f4\u63a5\u548c\u7cfb\u7edf\u8fde\u63a5\u7684\u76d1\u89c6\u5668 / dev / hd IDE \u8bbe\u5907\u6587\u4ef6 / dev / sd sata \u3001 usb \u3001 scsi \u7b49\u8bbe\u5907\u6587\u4ef6 / dev / fd \u8f6f\u9a71\u8bbe\u5907\u6587\u4ef6 / dev / tty \u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6 / dev / pty \u63d0\u4f9b\u8fdc\u7a0b\u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6 / dev / null \u6240\u8c13 \" \u9ed1\u6d1e \" \uff0c\u6240\u6709\u5199\u5165\u8be5\u8bbe\u5907\u7684\u4fe1\u606f\u90fd\u5c06\u6d88\u5931\uff0c\u5982\u5f53\u60f3\u5c06\u5c4f\u5e55\u4e0a\u7684\u8f93\u51fa\u4fe1\u606f\u9690\u85cf\u8d77\u6765\u65f6\uff0c\u53ea\u8981\u5c06\u8f93\u51fa\u4fe1\u606f\u8f93\u5165\u5230 / dev / null \u5373\u53ef / etc \u7cfb\u7edf\u3001\u7f51\u7edc\u6216\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u7b80\u5355\u7684\u5c06 / etc \u76ee\u5f55\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff1a \u57fa\u672c\u6587\u4ef6\uff1a\u6240\u6709\u76f4\u63a5\u653e\u5728 / etc \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5f52\u7c7b\u4e3a\u57fa\u672c\u6587\u4ef6 aliases \uff1a\u7528\u4e8e\u8bbe\u7f6e\u90ae\u4ef6\u522b\u540d auto . * \uff1a\u4ee3\u8868\u7684\u662f\u4e00\u7cfb\u5217 autofs \u670d\u52a1\u6240\u9700\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e2a\u670d\u52a1\u4e3b\u8981\u662f\u8ba9\u7ba1\u7406\u5458\u53ef\u4ee5\u4e8b\u5148\u5b9a\u4e49\u51fa\u4e00\u4e9b\u7f51\u7edc\u3001\u672c\u673a\u6216\u5149\u9a71\u7b49\u9ed8\u8ba4\u7684\u8def\u5f84 auto . master \uff1a\u8d1f\u8d23\u89c4\u5212\u76ee\u5f55\u7684\u5206\u914d\u4e0e\u4f7f\u7528\uff0c\u76ee\u524d\u9ed8\u8ba4\u63d0\u4f9b\u4e09\u79cd\u81ea\u52a8\u6302\u8f7d\u6a21\u5f0f auto . misc \uff1a\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u90fd\u4ee5\u5b9e\u4f53\u8fde\u63a5\u672c\u673a\u7684\u78c1\u76d8\u9a71\u52a8\u5668\u4e3a\u4e3b auto . net \uff1a\u5e76\u4e0d\u662f\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u662f\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c\u5728\u4f7f\u7528\u4e0a\u5176\u5b9e\u4e0d\u987b\u505a\u4efb\u4f55\u8c03\u6574\uff1b auto . smb \uff1a\u4e0e auto . net \u4e00\u6837\uff0c\u90fd\u662f\u4ee5\u4e2a\u811a\u672c\u6587\u4ef6 bashrc \uff1a\u7528\u6237\u767b\u5f55\u529f\u80fd\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u522b\u540d profile \uff1a\u4e0e\u7cfb\u7edf\u73af\u5883\u914d\u7f6e\u6216\u521d\u59cb\u5316\u8f6f\u4ef6\u7684\u76f8\u5173\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u53d8\u91cf DIR_COLORS \uff1a\u7528\u4e8e\u914d\u7f6e ls \u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9 tty \u767b\u5f55\u7684\u7528\u6237 DIR_COLORS . xterm \uff1a\u7528\u4e8e\u914d\u7f6e ls \u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9 xterm \u767b\u5f55\u7684\u7528\u6237 fstab \uff1a\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6 inittab \uff1a\u542f\u52a8\u65f6\u7cfb\u7edf\u6240\u9700\u8981\u7684\u7b2c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1b\u4e5f\u5373\u662f init \u8fdb\u7a0b\u7684\u914d\u7f6e\u6587\u4ef6 issue \uff1a\u7528\u6237\u672c\u673a\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f issue . net \uff1a\u7528\u6237\u7f51\u7edc\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f ld . so . conf \uff1a\u5305\u542b ld . so . conf . d /*.conf\u914d\u7f6e\uff1b\u4e3b\u8981\u662fld.so.conf.d/*.conf\u76ee\u5f55\u7684\u4f5c\u7528 localtime\uff1a\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u65f6\u533a\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u5bf9\u5e94\u7684\u65f6\u533a\u6587\u4ef6\u90fd\u5b58\u5728\u4e8e/usr/share/zoneinfo/ motd\uff1a\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u663e\u793a\u7684\u4fe1\u606f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 mtab\uff1a\u53ef\u4ee5\u5f53\u505a\u662f\u68c0\u67e5\u5f53\u524d\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u60c5\u51b5\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u4e0emount\u547d\u4ee4\u7ed3\u679c\u4e00\u81f4 prelink.conf\uff1a\u5b9a\u4e49\u54ea\u4e9b\u6267\u884c\u6587\u4ef6\u548c\u51fd\u6570\u5e93\u662f\u9700\u8981\u9884\u5148\u8fde\u63a5\u7684 securetty\uff1a\u4e3b\u8981\u662flogin\u7a0b\u5e8f\u5728\u4f7f\u7528\u7684\uff0c\u53ea\u8981\u662f\u5217\u5728\u8be5\u6587\u4ef6\u4e2d\u7684\u63a5\u53e3\uff0c\u5c31\u8868\u793a\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u63a5\u53e3\uff0c\u76f8\u53cd\uff0c\u82e5\u4ece\u5217\u8868\u4e2d\u5220\u9664\uff0c\u5219\u65e0\u6cd5\u4f7f\u7528\u8be5\u63a5\u53e3 shells\uff1a\u8bb0\u5f55\u76ee\u524d\u7cfb\u7edf\u6240\u62e5\u6709shell\u79cd\u7c7b\u7684\u8def\u5f84\uff0c\u901a\u8fc7cssh\u547d\u4ee4\u4f7f\u7528 sudoers\uff1asudo\u547d\u4ee4\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u914d\u7f6e\u6743\u9650\u7684\u5206\u914d\u65b9\u5f0f sysctl.conf\uff1a\u4e3b\u8981\u662f\u5e2e\u52a9\u7528\u6237\u914d\u7f6e/proc/sys\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u503c\uff0c\u4e0esysctl\u547d\u4ee4\u5bf9\u5e94 syslogd.conf\uff1a\u662fsyslogd\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6 host.conf\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u8bf4\u660e\u89e3\u6790\u7684\u65b9\u5f0f\u53ca\u987a\u5e8f hosts\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u5217\u51fa\u6240\u6709\u9700\u8981\u672c\u5730\u89e3\u6790\u7684\u4e3b\u673a\u540d\u4e0eIP\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb hosts.allow\u548chosts.deny\uff1alinux\u7f51\u7edc\u5b89\u5168\u673a\u5236TCP Wrapper\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 nsswitch.conf\uff1a\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u5e94\u5982\u4f55\u67e5\u8be2\u4e3b\u673a\u540d\u3001\u5bc6\u7801\u3001\u7528\u6237\u7ec4\u3001\u7f51\u7edc\u7b49\uff0c\u6216\u662f\u67e5\u8be2\u987a\u5e8f\u7684\u7f16\u6392 resolv.conf\uff1a\u8bb0\u5f55DNS\u670d\u52a1\u5668\u5730\u5740\uff0c\u7528\u4e8eDNS\u57df\u540d\u89e3\u6790 services\uff1a\u5b9a\u4e49\u4e86\u7f51\u7edc\u670d\u52a1\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7 xinetd.conf\uff1axinetd\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u76ee\u7684\u662f\u4e3axinetd.d\u4e0b\u7684\u6240\u6709\u5b50\u670d\u52a1\u5efa\u7acb\u4e00\u4e2a\u6807\u51c6\u7684\u89c4\u8303\u4f7f\u5176\u53ef\u4ee5\u9075\u5faa anacrontab\uff1a\u5c5e\u4e8e\u4e00\u79cd\u4efb\u52a1\u8ba1\u5212\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0canacrontab\u8f6f\u4ef6\u548ccrond\u5176\u5b9e\u6709\u70b9\u76f8\u8f85\u76f8\u6210\uff0ccrond\u8d1f\u8d23\u4efb\u52a1\u8ba1\u5212\uff0c\u800canacrontab\u5219\u662f \u8d1f\u8d23\u4ee5\"\u95f4\u9694\u591a\u4e45\"\u4e3a\u4e3b\u8981\u7684\u76ee\u6807 at.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528at\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1 at.allow\uff1a\u4e0eat.deny\u521a\u597d\u76f8\u53cd crontab\uff1acrontab\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0ccrond\u9ed8\u8ba4\u4f1a\u6267\u884c\u7684\u6587\u4ef6\u53ef\u4ee5\u53c2\u8003\u6b64\u914d\u7f6e\u6587\u4ef6 cron.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528crond\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1 cron.allow\uff1a\u4e0ecron.deny\u521a\u597d\u76f8\u53cd exports\uff1a\u662fNFS\u670d\u52a1\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u5c06\u672c\u673a\u7684\u76ee\u5f55\u5171\u4eab\u5230\u7f51\u7edc\u4e0a\uff0c\u4f9b\u5176\u4ed6\u4eba\u4f7f\u7528 group\u4e0egshadow\uff1a\u7528\u6237\u7ec4\u914d\u7f6e\u6587\u4ef6\uff0cgroup\u4e3b\u8981\u4fdd\u5b58\u7528\u6237\u7ec4\u4fe1\u606f\uff0cgshadow\u4e3b\u8981\u4fdd\u5b58\u7fa4\u7ec4\u5bc6\u7801 login.defs\uff1a\u8bbe\u7f6e\u7cfb\u7edf\u5728\u5efa\u7acb\u8d26\u53f7\u65f6\u6240\u53c2\u8003\u7684\u914d\u7f6e passwd\uff1a\u4e3b\u8981\u4fdd\u5b58\u7cfb\u7edf\u7528\u6237\u8d26\u53f7\u7684\u4fe1\u606f shadow\uff1alinux\u7cfb\u7edf\u901a\u5e38\u5305\u7ecf\u8fc7\"hash\"\u5904\u7406\u540e\u7684\u5bc6\u7801\u5b58\u50a8\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d protocols\uff1a\u901a\u4fe1\u534f\u8bae\u5bf9\u5e94\u7aef\u53e3\u53f7\u7684\u4e00\u4e2a\u5bf9\u7167\u8868\uff0c\u5305\u542b\u534f\u8bae\u540d\u79f0\u3001\u534f\u8bae\u53f7\u7801\u3001\u6ce8\u91ca\u7b49 wgetrc\uff1awget\u7a0b\u5e8f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u4e2d\u6709quota\u3001mail header\u3001\u91cd\u4f20\u6587\u4ef6\u7684\u9884\u8bbe\u6b21\u6570\u3001firewall\u548cproxy\u7b49\u76f8\u5173\u8bbe\u7f6e init.d\uff1aRHEL\u4e2d\u6240\u6709\u670d\u52a1\u7684\u9ed8\u8ba4\u542f\u52a8\u811a\u672c\u90fd\u5b58\u653e\u5728\u8fd9\u91cc\uff1b\u8fd9\u4e2a\u662f\u94fe\u63a5\u6587\u4ef6\uff0c\u94fe\u63a5\u5230/etc/rc.d/init.d csh.cshrc\u548ccsh.login\uff1a \u7528\u6237\u542f\u52a8c shells\u6267\u884c\u7684\u521d\u59cb\u5316\u914d\u7f6e\u6587\u4ef6 printcap\uff1alinux\u7cfb\u7edf\u4e2d\u6253\u5370\u673a\u8bbe\u5907\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 \u670d\u52a1\u5668\u76ee\u5f55\uff1a\u5982samba\u3001http\u3001vsftpd\u7b49\u670d\u52a1\u5668\u914d\u7f6e\u76f8\u5173\u76ee\u5f55 cups\uff1alinux\u4e0b\u7684\u6253\u5370\u673a\u670d\u52a1\u5668\uff0c\u76ee\u5f55\u4e0b\u5b58\u653e\u7684\u662f\u6253\u5370\u673a\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6 dnsmasq.d\uff1adnsmasq\u662f\u4e00\u79cdDNS\u7684\"\u8f7b\u8584\u673a\u79cd\"\uff0c\u8f6c\u4e3a\u533a\u57df\u6216\u5c0f\u578b\u7f51\u7edc\u6240\u8bbe\u8ba1\uff0c\u62e5\u6709\u6bd4\u4e00\u822cDNS\u66f4\u4e3a\u65b9\u4fbf\u7b80\u6613\u7684\u914d\u7f6e httpd\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u76ee\u5f55 mail\uff1aMail Server\u7ec4\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5982sendmail ntp\uff1a\u7f51\u7edc\u65f6\u95f4\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4e3a/etc/ntp.conf openldap\uff1a\u76ee\u5f55\u660e\u663e\u662fLDAP\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u8f6f\u4ef6\u540d\u79f0\u4e3aOpenLDAP postfix\uff1apostfix\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 samba\uff1a\u6587\u4ef6\u5171\u4eab\u670d\u52a1samba\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 smrsh\uff1a\u8fd9\u662fsendmail\u4e3a\u4e86\u9650\u5236\u7528\u6237\u53ef\u4f7f\u7528\u7684\u547d\u4ee4\u8bbe\u8ba1\u7684\u7a0b\u5e8f\uff0c\u5c06\u539f\u672c\u7528\u6237\u6240\u4f7f\u7528\u7684/bin/sh\u66ff\u6362\u4e3a/usr/sbin/smrsh snmp\uff1a\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u5b58\u5728snmpd.conf\u4e3b\u914d\u7f6e\u6587\u4ef6 squid\uff1a\u8fd9\u662flinux\u4e0b\u7684\u4ee3\u7406\u670d\u52a1\u5668squid\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsquid.conf ssh\uff1aSSH\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsshd_config vsftpd\uff1avsftpd\u670d\u52a1\u5668\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fvsftpd.conf xinetd.d\uff1axinetd\u662f\u4e00\u4e2a\u7ba1\u7406\u591a\u4e2a\u670d\u52a1\u7684daemon\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5217\u51fa\u7684\u670d\u52a1\u90fd\u662f\u7531xinetd\u8fdb\u7a0b\u7ba1\u7406\u7684\uff0c\u5176\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/xinetd.conf \u7cfb\u7edf\u76ee\u5f55\uff1a\u5982sysconfig\u3001xen\u6216\u7f51\u7edc\u914d\u7f6e\u7b49\u4e0e\u7cfb\u7edf\u8fd0\u884c\u76f8\u5173\u7684\u76ee\u5f55 blkid\uff1a\u6b64\u76ee\u5f55\u6240\u5b58\u653e\u4e00\u4e2a\u5757\u8bbe\u5907ID\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u533a\u5757\u8bbe\u5907\u7684\u6807\u7b7e\u540d\u79f0\u3001\u786c\u4ef6\u7684\u552f\u4e00\u8bc6\u522b\u7801\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u7b49\u57fa\u672c\u4fe1\u606f bluetooth\uff1alinux\u4e0b\u4f7f\u7528\u84dd\u7259\u8bbe\u5907\u6240\u9700\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u542f\u52a8\u84dd\u7259\u68c0\u6d4b\u7684\u4e3b\u8981\u670d\u52a1\u4ecd\u662f/etc/rc.d/init.d/bluetooth\uff0c\u8be5\u7a0b\u5e8f\u4f7f\u7528\u7684\u662f hcid.conf\u914d\u7f6e\u6587\u4ef6 cron.X\uff1acron.X\u7684\u76ee\u5f55\u90fd\u662f\u7ed9cron\u8f6f\u4ef6\u5b58\u653e\u5176\u9700\u8981\u4efb\u52a1\u8ba1\u5212\u7684\u6587\u4ef6\u6240\u4f7f\u7528\u7684\uff0c\u6309\u4efb\u52a1\u8ba1\u5212\u65f6\u95f4\u7684\u957f\u77ed\u53ca\u914d\u7f6e\u7279\u6027\u5206\u4e3acron.d\u3001cron.daily\u3001 cron.hourly\u3001cron.monthly\u3001cron.weekly\u4e94\u4e2a\u4e3b\u8981\u76ee\u5f55 dbus-1\uff1aD-BUS\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0cD-BUS\u4e5f\u662f\u4e00\u79cdIPC\u4ea4\u6d41\u7684\u65b9\u5f0f default\uff1a\u8fd9\u91cc\u662f\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u8f6f\u4ef6\u9ed8\u8ba4\u503c\u7684\u76ee\u5f55\uff0c\u5b58\u653e\u67d0\u4e9b\u8f6f\u4ef6\u6267\u884c\u65f6\u7684\u57fa\u672c\u53c2\u6570 firmware\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u5b58\u653e\u7684\u4e1c\u897f\u662f\u975e\u5e38\u5e95\u5c42\u7684\u4fe1\u606f\uff0c\u662fCPU\u6240\u9700\u7684microcode\u7684\u5b9e\u4f53\u6587\u4ef6 foomatic\uff1a\u4e0e\u6253\u5370\u673a\u76f8\u5173\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5b9e\u73b0\u6253\u5370\u4e00\u5bf9\u591a\u7684\u65b9\u5f0f\uff0c\u5728foomatic\u4e2d\uff0c\u53ef\u4ee5\u8bb0\u5f55\u591a\u6761\u6253\u5370\u673a\u6570\u636e\uff0c\u8ba9\u7528\u6237\u53ea\u5728\u4f7f\u7528\u524d\u5148\u884c\u914d\u7f6e\u6240\u6709 \u9700\u8981\u4f7f\u7528\u7684\u6253\u5370\u673a\u5373\u53ef hal\uff1a\u5168\u540dHardware Abstraction Layer\uff0c\u662flinux\u4e00\u79cd\u7ba1\u7406\u786c\u4ef6\u7684\u673a\u5236\uff0c\u5b83\u4f1a\u5e2e\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u7528\u6237\u641c\u96c6\u6240\u6709PCI\u53caUSB\u7b49\u786c\u4ef6\u4fe1\u606f\uff0c \u56e0\u6b64\u7528\u6237\u53ef\u4ee5\u5f88\u7b80\u5355\u5e76\u5b9e\u65f6\u5730\u901a\u8fc7HAL\u7684\u65b9\u5f0f\u53d6\u5f97\u786c\u4ef6\u7684\u76f8\u5173\u6570\u636e isdn\uff1aISDN\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u91cc\u9762\u5305\u542b\u53ef\u62e8\u53f7\u7684\u7528\u6237\u3001\u7535\u8bdd\u3001\u8054\u673a\u65b9\u5f0f\u7b49 ld.so.conf.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fldconfig\u6240\u4f7f\u7528\u7684\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\uff0c\u5b83\u662f\u7531/etc/ld.so.conf\u6587\u4ef6\u6240\u51b3\u5b9a\u7684\uff1bldconfig\u547d\u4ee4\u7684\u76ee\u7684\u5728\u4e8e\u5c06\u7cfb\u7edf \u4e2d\u7684\u4e00\u4e9b\u51fd\u6570\u5e93\u9884\u5148\u5b58\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u8ba9\u7cfb\u7edf\u4f7f\u7528\u65f6\u53ef\u4ee5\u6bd4\u4ee5\u5f80\u901a\u8fc7\u786c\u76d8\u7684\u8bfb\u53d6\u901f\u5ea6\u6765\u7684\u66f4\u5feb\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u63d0\u9ad8\u7cfb\u7edf\u6027\u80fd\uff0c \u5c24\u5176\u5f53\u8981\u91cd\u590d\u8bfb\u53d6\u65f6\u66f4\u660e\u663e\uff1bldconfig\u8981\u5c06\u54ea\u4e9b\u51fd\u6570\u5e93\u4e22\u5230\u5185\u5b58\u4e2d\uff0c\u5219\u987b\u770b/etc/ld.so.conf\u6587\u4ef6\u4e2d\u6240\u8bb0\u5f55\u7684\u4fe1\u606f logrotate.d\uff1a\u6b64\u76ee\u5f55\u5bf9\u7cfb\u7edf\u7ba1\u7406\u5458\u6765\u8bf4\uff0c\u662f\u5341\u5206\u91cd\u8981\u7684\u4e00\u4e2a\u76ee\u5f55\uff0c\u56e0\u4e3a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e86\u5982\u4f55\u5b9a\u671f\u5907\u4efd\u7cfb\u7edf\u6240\u9700\u8981\u5907\u4efd\u7684\u7cfb\u7edf\u6216\u8f6f\u4ef6 \u65e5\u5fd7\u6587\u4ef6\u53ca\u5907\u4efd\u65b9\u5f0f\uff0c\u76ee\u5f55\u662f\u7531logrotate\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0c\u800c\u91cc\u9762\u6240\u6709\u6587\u4ef6\u662f\u7531\u5404\u8f6f\u4ef6\u5404\u81ea\u4ea7\u751f\u7684\uff1b\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662f /etc/logrotate.conf logwatch\uff1alogrotate\u4e3b\u8981\u662f\u5b9e\u73b0\u5982\u4f55\u5907\u4efd\u65e5\u5fd7\u6587\u4ef6\uff0c\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662f\u8bb0\u8f7d\u5982\u4f55\u5206\u6790\u65e5\u5fd7\u6587\u4ef6\u5e76\u544a\u8bc9\u7528\u6237\u7684\u8f6f\u4ef6logwatch\u7684\u914d\u7f6e\u76ee\u5f55 lsb-release.d\uff1aLSB\u662f\u4e00\u4e2a\u7531\u5f88\u591a\u4eba\u6240\u6267\u884c\u7684\u9879\u76ee\uff0c\u5176\u76ee\u7684\u662f\u5c06\u6240\u6709\u7684Linux\u53d1\u884c\u7248\u5b9a\u4e49\u4e3a\u4e00\u4e9b\u5171\u540c\u7684\u6807\u51c6 lvm\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fLVM\u7684\u57fa\u672c\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u914d\u7f6e\u6216\u64cd\u4f5c\u4e00\u822c\u90fd\u53ea\u9700\u8981\u901a\u8fc7LVM\u63d0\u4f9b\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u4f1a\u7528\u5230\u8fd9\u4e2a\u76ee\u5f55\uff0c\u9664\u975e\u8981\u4f7f\u7528\u5230\u5f88\u9ad8\u7ea7\u7684\u914d\u7f6e \u624d\u4f1a\u66f4\u6539\u6b64\u6587\u4ef6 makedev.d\uff1aMAKEDEV\u8f6f\u4ef6\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cMAKEDEV\u4e3b\u8981\u7528\u6765\u4ea7\u751f\u8bbe\u5907\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728/dev\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u7531\u8fd9\u4e2a\u547d\u4ee4\u4ea7\u751f\u7684\uff0c \u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e3b\u8981\u662f\u9488\u5bf9\u8bbe\u5907\u6587\u4ef6\u7684\u5b9a\u4e49\u6216\u5c5e\u6027\uff0c\u76ee\u5f55\u4e2d\u5b58\u5728\u7684\u8bbe\u5907\u6587\u4ef6\u53ef\u4ee5\u7531MAKEDEV\u6765\u521b\u5efa\uff0c\u5426\u5219\u9700\u8981\u4f7f\u7528mknod\u547d\u4ee4 modprobe.d\uff1a\u662fmodprobe\u547d\u4ee4\u7684\u4f4f\u914d\u7f6e\u76ee\u5f55\uff0c\u4e00\u822c\u7cfb\u7edf\u542f\u52a8\u9ed8\u8ba4\u8981\u52a0\u8f7d\u7684\u6a21\u5757\u653e\u5728/etc/modprobe.conf\u4e2d netplug\u548cnetplug.d\uff1a\u8fd9\u4e24\u4e2a\u76ee\u5f55\u548c\u7f51\u7edc\u63a5\u53e3\u7684\u8054\u673a\u4e0e\u5426\u7531\u76f4\u63a5\u5173\u7cfb\uff0c\u56e0\u4e3a\u4e3b\u8981\u662f\u63a7\u5236\u8054\u673a\u65f6\u7684\u63a5\u53e3\u64cd\u4f5c opt\uff1a\u6b64\u76ee\u5f55\u539f\u672c\u662f\u5b9a\u4e49\u4e3a\u5b58\u653e\u6240\u6709\u989d\u5916\u5b89\u88c5\u8f6f\u4ef6\u7684\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u76ee\u524d\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\uff0c\u6b64\u76ee\u5f55\u4e3a\u7a7a pcmcia\uff1a\u8fd9\u662fPCMCIA\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cPCMCIA\u662f\u7b14\u8bb0\u672c\u7535\u8111\u4e0d\u53ef\u6216\u7f3a\u7684\u63a5\u53e3\uff0c\u9700\u8981\u5373\u63d2\u5373\u7528\u7684\u65b9\u5f0f\uff0c\u6b64\u63a5\u53e3\u4f7f\u7528\u8f83\u5c11 pm\uff1a\u7531pm-utils\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u76ee\u5f55\uff0cpm-utils\u662f\u4e00\u5957\u7535\u6e90\u7ba1\u7406\u7684\u5de5\u5177\u8f6f\u4ef6\uff0c\u5176\u4e2d/usr/lib/pm-utils\u4e5f\u662f\u4e3b\u8981\u76ee\u5f55\u4e4b\u4e00 ppp\uff1appp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d profile.d\uff1a\u76ee\u5f55\u5b58\u653e\u7cfb\u7edf\u90e8\u5206\u7684\u8f6f\u4ef6\u914d\u7f6e\uff0c\u4f46\u6309\u4e0d\u540c\u7684shell\u6267\u884c\u4e0d\u540c\u6587\u4ef6\uff0c\u9ed8\u8ba4\u6240\u4f7f\u7528bash\u4f1a\u76f4\u63a5\u6267\u884c\u8be5\u76ee\u5f55\u4e0b\u6240\u6709\u6269\u5c55\u540d\u4e3a.sh\u7684\u6587\u4ef6 rc.d\uff1a\u4e3b\u8981\u7528\u6765\u5b9a\u4e49\u5728\u6bcf\u4e00\u4e2a\u6267\u884c\u9636\u6bb5\u5fc5\u987b\u8981\u6267\u884c\u54ea\u4e9b\u7cfb\u7edf\u670d\u52a1\u6216\u7a0b\u5e8f\uff0c\u5728\u76ee\u5f55\u4e2d\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u91cd\u8981\u7684\u90e8\u5206\uff1a --rc.sysinit\uff1a\u7cfb\u7edf\u4e00\u5f00\u59cb\u542f\u52a8\u65f6\u6240\u9047\u5230\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u6b64\u811a\u672c\u8bb0\u5f55\u670d\u52a1\u542f\u52a8\u4e4b\u524d\u6240\u9700\u51c6\u5907\u7684\u6240\u6709\u4e8b\u60c5\uff0c\u5305\u62ec\u542f\u52a8\u65f6\u7684\u6b22\u8fce\u753b\u9762 --rcX.d\uff1a\u5728rc.sysinit\u6587\u4ef6\u4e4b\u540e\u6240\u8981\u6267\u884c\u7684\uff0cX\u662f\u7cfb\u7edf\u542f\u52a8\u65f6\u7684initdefault\u503c\uff0c\u503c\u4e3a\u51e0\u5219\u4f1a\u8f6c\u5230\u90a3\u4e2a\u76ee\u5f55\u4e0b\uff0c\u5e76\u6267\u884c\u5176\u4e2d\u7684 \u6240\u6709\u6587\u4ef6\uff0c\u5728\u6b64\u76ee\u5f55\u4e2d\uff0c\u6587\u4ef6\u4e00\u5f8b\u90fd\u7531\u4e24\u4e2a\u82f1\u6587\u5b57\u6bcd\u5f00\u59cbK\u548cS\uff0cK\u4ee3\u8868kill\uff0cS\u4ee3\u8868Start --rc.local\uff1a\u7cfb\u7edf\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u6700\u540e\u4e00\u4e2a\u6267\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u5f00\u673a\u542f\u52a8\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u653e\u7f6e\u5728\u8fd9\u4e2a\u811a\u672c\u6587\u4ef6\u4e2d\uff0c\u4ee5\u5b9e\u73b0\u81ea\u52a8 \u8fd0\u884c\u7684\u76ee\u7684 readahead.d\uff1a\u662freadahead\u7a0b\u5e8f\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3a\u4e86\u52a0\u901f\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f7f\u7528\u901f\u5ea6\uff0creadahead_early\u548creadahead_later\u8fd9\u4e24\u4e2a\u8fdb\u7a0b\u5728 \u7cfb\u7edf\u52a0\u8f7d\u65f6\uff0c\u76f4\u63a5\u5c06\u65e5\u5e38\u6240\u9700\u8981\u7684\u4e00\u4e9b\u6587\u4ef6\uff0c\u5168\u90e8\u5148\u653e\u5230\u786c\u76d8\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d redhat-lsb\uff1a\u90fdlsb-release.d\u76ee\u5f55\u90fd\u662f\u7531\u7a0b\u5e8fredhat-lsb\u6240\u63d0\u4f9b\u7684 rwtab.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u4e00\u4e2a\u5728\u542f\u52a8\u65f6\u4f1a\u53bb\u53c2\u8003\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u7684\u6587\u4ef6\u5728/etc/rwtab\uff1b\u8fd9\u662f\u4e00\u4e2a\u7cfb\u7edf\u521d\u671f\u7684\u5907\u4efd\u673a\u5236 sane.d\uff1a\u8fd9\u662f\u5728\u7cfb\u7edf\u4e0b\u8981\u4f7f\u7528\u626b\u63cf\u4eea\u6240\u9700\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662fsane.conf\uff0csane\u4e3a\u4e86\u65b9\u4fbf\u7528\u6237\u5728\u5404\u5f0f\u7684\u626b\u63cf\u4eea\u8fde\u63a5\u65f6\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c \u56e0\u6b64\u5728\u8fd9\u4e00\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e86\u5f88\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u626b\u63cf\u4eea\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u8ba9\u7cfb\u7edf\u5728\u68c0\u6d4b\u5230\u626b\u63cf\u4eea\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 setuptool.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\"setup\"\u7cfb\u7edf\u914d\u7f6e\u5de5\u5177\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55 skel\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u7528\u6237\u5bbf\u4e3b\u76ee\u5f55\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5f53\u5efa\u7acb\u4e00\u4e2a\u7528\u6237\u65f6\uff0c\u4f1a\u628a\u6b64\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u590d\u5236\u4e00\u4efd\u5230\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55\uff0c\u4f5c\u4e3a\u7528\u6237\u7684\u521d\u59cb\u5316\u914d\u7f6e sysconfig\uff1a\u975e\u5e38\u91cd\u8981\u7684\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u7684\u5b58\u653e\u76ee\u5f55\uff0c\u91cc\u9762\u653e\u7f6e\u4e86\u5927\u91cf\u7cfb\u7edf\u542f\u52a8\u53ca\u8fd0\u884c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6 sysconfig/network-scripts/ifcfg-eth0\uff1a\u7f51\u5361eth0\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8bbe\u7f6e\u5185\u5bb9\u5305\u62ec\u8bbe\u5907\u540d\u79f0\u3001IP\u5730\u5740\u3001\u5e7f\u64ad\u5730\u5740\u3001\u7f51\u5173\u5730\u5740\u3001\u7f51\u6bb5\u3001 \u5f00\u673a\u662f\u5426\u6fc0\u6d3b\u7b49\u53c2\u6570 udev\uff1audev\u7a0b\u5e8f\u672c\u8eab\u662f\u4e00\u5957\u8bbe\u5907\u7684\u7ba1\u7406\u673a\u5236\uff0cudev\u901a\u8fc7sysfs\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u6b63\u786e\u5730\u638c\u63e1\u76ee\u524d\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u786c\u4ef6\u8bbe\u5907\uff0c\u4ee5\u53ca\u9488\u5bf9\u6bcf\u4e00\u4e2a\u786c\u4ef6 \u8bbe\u5907\u505a\u51fa\u4e0d\u540c\u7684\u5224\u65ad\u4e0e\u6267\u884c yum\u548cyum.repos.d\uff1a\u4e24\u4e2a\u90fd\u662fyum\u914d\u7f6e\u76ee\u5f55\uff0c\u53ef\u7528\u6765\u66ff\u4ee3rpm\u5305\u7ba1\u7406\u65b9\u5f0f\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/yum.conf\uff1byum\u662f\u66f4\u65b0\u65b9\u5f0f\u53ca\u5916\u6302\u7a0b\u5e8f\u7684 \u914d\u7f6e\u76ee\u5f55\uff0cyum.repos.d\u662f\u5b58\u653e\u5b9a\u671f\u66f4\u65b0\u7ec4\u4ef6\u5185\u5bb9\u7684\u4fe1\u606f \u5b89\u5168\u6027\u76ee\u5f55\uff1a\u5982selinux\u6216pam.d\u7b49\u7ba1\u7406\u7cfb\u7edf\u5b89\u5168\u6027\u7684\u76ee\u5f55 audit\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u4ee3\u8868\u7684\u662f\u4e00\u79cd\u548c\u76ee\u5f55\u540d\u79f0\u4e00\u81f4\u7684audit\u5b89\u5168\u673a\u5236\uff0c\u4e3b\u8981\u4ee5\u670d\u52a1\u7684\u65b9\u5f0f\u534f\u52a9\u7ba1\u7406\u5458\u6301\u7eed\u76d1\u63a7\u5404\u6587\u4ef6\u88ab\u5b58\u53d6\u7684\u60c5\u51b5\uff1b\u76ee\u5f55\u4e0b\u7684 audit.rules\u6587\u4ef6\u4e3b\u8981\u662f\u5b9a\u4e49\u4e00\u4e9b\u5fc5\u8981\u7684\u76d1\u63a7\u89c4\u5219 pam.d\uff1a\u6b64\u76ee\u5f55\u662fLinux-PAM\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u5408/lib/security\u76ee\u5f55\u4e2d\u6240\u6709\u89c9\u5f97\u51fd\u6570\u5e93\uff0c\u63d0\u4f9bLinux\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u8ba4\u8bc1\u7684\u673a\u5236 pam_pkcs11\uff1aPAM\u673a\u5236\u4e2d\u7684\u4e00\u79cd\u767b\u5f55\u6a21\u5757\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u901a\u8fc7smart card\u505a\u767b\u5f55\u7684\u64cd\u4f5c pki\uff1aPKI\u662f\u4e00\u79cd\u516c\u5f00\u5bc6\u94a5\u7684\u7ba1\u7406\u65b9\u5f0f\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u7ba1\u7406\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8ba9\u6240\u6709\u7f51\u7edc\u4f20\u8f93\u6709\u66f4\u591a\u4fdd\u969c racoon\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531ipsec-tools\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0cipsec\u7684\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u5b9e\u73b0VPN\u7684\u7f51\u8def\u6280\u672f\uff0c\u5728racoon\u76ee\u5f55\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6 racoon.conf\u4e2d\uff0c\u5b9a\u4e49\u5728ipsec\u64cd\u4f5c\u4e2d\u6240\u9700\u8981\u7684\u52a0\u5bc6\u7b97\u6cd5\u79cd\u7c7b\u4ee5\u53ca\u5176\u4ed6\u7ec6\u8282\u7684\u914d\u7f6e security\uff1a\u4e0epam.d\u76ee\u5f55\u76f8\u8f85\u76f8\u6210\uff0cpam.d\u4e2d\u7684\u6240\u6709PAM\u7684\u89c4\u5219\u90fd\u8981\u7528\u5230/lib/security\u4e0b\u7684PAM\u51fd\u6570\u5e93\uff0c\u800c/etc/security\u76ee\u5f55\u4e2d\uff0c\u5c31\u662f \u9488\u5bf9\u8fd9\u4e9b\u51fd\u6570\u5e93\uff0c\u63d0\u4f9b\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec6\u8282\u914d\u7f6e\uff0c\u5bf9\u5e0c\u671b\u8c03\u6574\u7cfb\u7edf\u5b89\u5168\u6027\u90e8\u5206\u589e\u52a0\u4e86\u975e\u5e38\u5927\u7684\u65b9\u4fbf\u6027 selinux\uff1aselinux\u662f\u4e00\u4e2a\u5f88\u65b0\u7684\u5b89\u5168\u6027\u65b9\u6848\uff0c\u5b83\u662f\u4e00\u79cd\u9488\u5bf9\u5404\u79cd\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u8bbe\u5907\u6216daemon\u7b49\u5728linux\u6240\u9700\u4f7f\u7528\u5230\u7684\u5b89\u5168\u6027\u673a\u5236\uff0c\u800c\u4e14\u5176 \u5b89\u5168\u6027\u7684\u6570\u636e\u65f6\u76f4\u63a5\u8bb0\u5f55\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d wpa_supplicant\uff1a\u8fd9\u4e2a\u76ee\u5f55\u88ab\u5f52\u7c7b\u5230\u5b89\u5168\u6027\u76ee\u5f55\u4e2d\uff0c\u662f\u56e0\u4e3a\u5176\u5c5e\u4e8e\u65e0\u7ebf\u4e2d\u5b89\u5168\u8ba4\u8bc1\u7684\u90e8\u5206\uff0c\u5b58\u5728wpa_supplicant.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u6237 \u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u52a0\u5165\u5df2\u77e5\u53ef\u767b\u9646\u7684AP X Windows\u76ee\u5f55\uff1a\u5982X11\u6216gdm\u7ba1\u7406X windows\u542f\u52a8\u6216\u4f7f\u7528\u4e0a\u7684\u914d\u7f6e\u76ee\u5f55 alternatives\uff1alinux\u4e0b\u53ef\u8fa8\u8bc6\u6269\u5c55\u540d\u7684\"\u6587\u4ef6\u7c7b\u578b\"\u9009\u9879\uff0c\u53ef\u4ee5\u9488\u5bf9\u540c\u4e00\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u9009\u51fa\u4e00\u4e2a\u9ed8\u8ba4\u7528\u6237\u6240\u8981\u4f7f\u7528\u7684\u7a0b\u5e8f\u53bb\u6267\u884c\uff1b /etc/alternatives\u76ee\u5f55\u4e0b\u6709\u6240\u6709\u76ee\u524d\u5df2\u7ecf\u5b9a\u4e49\u7684\u7a0b\u5e8f\u540d\u79f0\uff0c\u90fd\u4ee5\u8f6f\u94fe\u63a5\u7684\u65b9\u5f0f\u5b58\u5728\uff0c\u91cc\u9762\u6bcf\u4e00\u4e2a\u6587\u4ef6\u5176\u5b9e\u90fd\u6709\u5b9a\u4e49\u597d\u7684 \u9ed8\u8ba4\u6267\u884c\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528alternatives\u547d\u4ee4\u67e5\u770b\u53ca\u4fee\u6539\u914d\u7f6e fonts\uff1a\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662ffontconfig\u8f6f\u4ef6\u7684\u6700\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e2d/etc/fonts/fonts.conf\u5c31\u662f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c/etc/fonts\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e \u90fd\u662f\u4ee5XML\u7684\u65b9\u5f0f\u914d\u7f6e\u7684 gconf\uff1a\u8fd9\u4e00\u76ee\u5f55\u662fGConf2\u7684\u7ec4\u4ef6\u6240\u5efa\u7acb\u7684\uff0cGConf\u7684\u4f5c\u7528\u5c31\u662f\u63d0\u4f9bGNOME\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u6ce8\u518c\u7684\u673a\u5236\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8ewindows\u4e0b\u7684regedit gdm\uff1a\u5168\u540d\u4e3aGNOME Display Manger\uff0c\u4e5f\u5c31\u662f\u534f\u52a9X Windows\u542f\u52a8\u7684\u7ba1\u7406\u8f6f\u4ef6\uff0c\u5728GDM\u4e2d\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fcustom.conf\uff0c\u5728X windows\u4e0b \u53ef\u4ee5\u5229\u7528gdmsetup\u547d\u4ee4\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e gnome-vfs-2.0\uff1aGNOME VFS\u673a\u5236\uff0c\u8ba9GNOME\u7684\u7cfb\u7edf\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e00\u79cd\u6587\u4ef6\u683c\u5f0f\u8981\u5982\u4f55\u5f00\u542f\u6216\u6d4f\u89c8\uff0c\u800c\u6240\u6709\u7684\u914d\u7f6e\u90fd\u9700\u8981\u6709\u76f8\u5bf9\u5e94\u7684\u51fd\u6570\u5e93 gtk-2.0\uff1a\u7531gtk+\u7ec4\u4ef6\u63d0\u4f9b\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u662f\u63d0\u4f9bX Windows\u7a97\u53e3\u7684\u989c\u8272\u3001\u6309\u94ae\u6216\u56fe\u6848\uff0c\u5305\u542b\u8f6f\u4ef6\u9009\u9879\u7684\u753b\u9762\u3001\u9009\u9879\u7684\u6309\u94ae\u3001\u6eda\u52a8\u8f74\u7684\u6837\u5f0f\u7b49 kde\uff1aKDE Desktop Manager\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff1b\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fkdmrc NetworkManager\uff1a\u6b64\u76ee\u5f55\u7684\u76ee\u7684\u662f\u8ba9\u7528\u6237\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u64cd\u4f5c\u548c\u914d\u7f6e\uff0c\u53ea\u8981\u7528\u6237\u66fe\u7ecf\u767b\u9646\u8fc7\u65e0\u7ebfAP\uff0c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u540e\u518d\u6b21\u767b\u9646\u65f6\u5c31 \u53ef\u4ee5\u65b9\u4fbf\u7684\u767b\u9646 pango\uff1apango\u662f\u4e00\u5957\u534f\u52a9GTK+\u5c06\u5b57\u4f53\u63cf\u7ed8\u51fa\u6765\u7684\u51fd\u6570\u5e93\uff0c\u4e0d\u8bba\u4efb\u4f55\u7684\u5b57\u4f53\u6216\u8bed\u8a00\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7pango\u63cf\u7ed8\u51fa\u6765 rhgb\uff1a\u7cfb\u7edf\u5728\u8fdb\u5165X Windows\u4e4b\u524d\uff0c\u6709\u4e00\u4e2a\u524d\u7f6e\u914d\u7f6e\u7684\u56fe\u5f62\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5c31\u662frhgb\uff0c\u5176\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u542f\u52a8\u53d8\u5f97\u6f02\u4eae scim\uff1a\u662fLinux\u4e0b\u76ee\u524d\u5f88\u597d\u7528\u7684\u8f93\u5165\u6cd5 sound\uff1aGNOME\u4e0b\u6709\u8bb8\u591a\u7684\u5e94\u7528\u8f6f\u4ef6\uff0c\u5f88\u591a\u90fd\u4f1a\u6709\u5176\u7279\u6b8a\u7684\u58f0\u97f3\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u5b58\u653e\u6240\u6709\u58f0\u97f3\u7684\u547d\u4ee4\u8def\u5f84 X11\uff1aX windows\u7684\u6838\u5fc3\u914d\u7f6e\u76ee\u5f55\uff1b\u8be5\u76ee\u5f55\u4e0b\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u4ef6\u6709prefdm(\u5224\u65adX windows\u4f7f\u7528\u54ea\u4e00\u4e2aDisplay Manager)\u3001\u4e3b\u914d\u7f6e\u6587\u4ef6 xorg.conf(\u5b9a\u4e86X windows\u6240\u9700\u4f7f\u7528\u7684\u952e\u76d8\u3001\u9f20\u6807\u3001\u663e\u5361\u7b49\u76f8\u5173\u786c\u4ef6\u8bbe\u5907\uff0c\u91cd\u70b9\u662f\u5173\u4e8e\u663e\u5361\u7684\u914d\u7f6e)\u3001xinit\u5b50\u76ee\u5f55 (\u91cc\u9762\u90fd\u662f\u4e00\u4e9bX windows\u8d44\u6e90\u76f8\u5173\u7684\u914d\u7f6e) xdg\uff1aX windows\u4e0a\u7684\u83dc\u5355\u753b\u9762\uff0c\u5c31\u662f\u4ece\u8fd9\u91cc\u51fa\u6765\u7684\uff0c\u6240\u6709\u5728X windows\u4e2d\u4f7f\u7528\u7684\u83dc\u5355\u6587\u5b57\u53ca\u5206\u7c7b\uff0c\u90fd\u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u505a\u914d\u7f6e\uff0c\u5176\u4e0b\u7684\u5b50\u76ee\u5f55 menu\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u91cc\u9762\u7684\u6587\u4ef6\u81ea\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ba1\u7406\u3001\u5916\u89c2\u7b49\u83dc\u5355\u5185\u5bb9 \u5176\u4ed6\u76ee\u5f55\uff1a\u9488\u5bf9\u5355\u4e00\u7279\u6b8a\u8f6f\u4ef6\u7684\u914d\u7f6e\u6216\u672a\u80fd\u6309\u4ee5\u4e0a\u5206\u7c7b\u65b9\u5f0f\u5219\u653e\u5728\u6b64\u76ee\u5f55\u4e2d a2ps.cfg\u548ca2ps-site.cfg\uff1a\u7528\u4e8e\u5c06\u4e00\u4efd\u6587\u4ef6\u683c\u5f0f\u8f6c\u6362\u4e3apostscript\u7684\u683c\u5f0f\uff0c\u5728\u67d0\u4e9b\u6253\u5370\u673a\u6216\u5c06\u6587\u4ef6\u8f93\u51fa\u6210\u4e00\u4efd\u6807\u51c6\u683c\u5f0f\u6587\u4ef6\u65f6\uff0c\u4f1a\u88ab\u7528\u5230 alsa\uff1a\u4e3b\u8981\u4efb\u52a1\u5728\u4e8e\u63d0\u4f9blinux\u58f0\u97f3\u53ca\u58f0\u97f3\u7684\u529f\u80fd\uff0c\u5e76\u8bd5\u7740\u8ba9\u5176\u6027\u80fd\u8fbe\u5230\u6700\u4f73\u5316 ghostscript\uff1alinux\u4e0b\u8bfb\u53d6Adobe\u683c\u5f0f\u6587\u4ef6(\u5982pdf)\uff0c\u5c31\u662f\u4f7f\u7528ghostscript\u547d\u4ee4\uff0c\u6b64\u76ee\u5f55\u4e3b\u8981\u7528\u4e8e\u8bbe\u7f6e\u5728\u663e\u793a\u65f6\u4f7f\u7528\u54ea\u79cd\u5b57\u4f53\u4f5c\u4e3a\u9ed8\u8ba4\u5b57\u4f53 gre.d\uff1aGRE\u662fMozilla\u6ce8\u518c\u7684\u4e00\u79cd\u673a\u5236\uff0c\u76ee\u5f55\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6gre.conf\u4f1a\u6ce8\u660e\u6240\u4f7f\u7528\u7684Mozilla\u8f6f\u4ef6\u7684\u8def\u5f84\u548c\u7248\u672c iproute2\uff1aiproute2\u662f\u4e00\u5957\u975e\u5e38\u5f3a\u5927\u7684\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\uff0ciproute2\u63d0\u4f9b\u7684\u529f\u80fd\u6709\u5f88\u591a\u79cd\uff0c\u6b64\u76ee\u5f55\u4e2d\u5b58\u653e\u4e00\u4e9b\u7f51\u7edc\u7684\u57fa\u672c\u914d\u7f6e\u503c java\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531jpackage-utils\u8f6f\u4ef6\u63d0\u4f9b\u7684\uff0c\u8fd9\u4e2a\u76ee\u5f55\u662f\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u6709maven\u3001jvm\u3001jvm-common\u90fd\u662f\u7531 jpackage-utils\u8f6f\u4ef6\u4ea7\u751f\u7684\uff0cjpackage\u662f\u4e00\u4e2a\u4e13\u95e8\u4e3a\u4e86\u63d0\u4f9bjava\u7a0b\u5e8f\u4e0e\u51fd\u6570\u5e93\u6240\u5b58\u5728\u7684\u8f6f\u4ef6 mgetty+sendfax\uff1a\u4e3b\u8981\u7528\u4e8e\u4f7f\u7528linux\u67b6\u6784\u4e00\u53f0fax server\uff0c\u53ef\u4ee5\u4f7f\u7528mgetty.config\u6765\u914d\u7f6e\u9700\u8981\u6709\u5173\u4f20\u771f\u63a5\u6536\u548c\u53d1\u9001\u7684\u64cd\u4f5c php.d\uff1a\u4e3b\u8981\u5b58\u653e\u7684\u5404\u8f6f\u4ef6(\u5982dbase\u3001ldap\u3001mysql\u7b49)\u4e0ephp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6 reader.conf.d\uff1a\u5b58\u653esmart card\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u7531\u7a0b\u5e8fpcsc-lite\u63d0\u4f9b\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/reader.conf dumpdates\uff1a\u5b58\u653edump\u547d\u4ee4\u7684\u6267\u884c\u65e5\u671f\uff0cdump\u547d\u4ee4\u53ef\u4ee5\u5bf9ext2/ext3\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u68c0\u67e5\u5907\u4efd /home \u9ed8\u8ba4\u5b58\u653e\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55(\u9664\u4e86root\u7528\u6237) /home/~/.bashrc\uff1a\u63d0\u4f9bbash\u73af\u5883\u4e2d\u6240\u9700\u4f7f\u7528\u7684\u522b\u540d /home/~/.bash_profile\uff1a\u63d0\u4f9bbash\u73af\u5883\u6240\u9700\u7684\u53d8\u91cf\uff1b\u4e00\u822c\u5148\u6267.bashrc\u540e\uff0c\u624d\u4f1a\u518d\u6267\u884c.bash_profile /home/~/.bash_history\uff1a\u7528\u6237\u5386\u53f2\u547d\u4ee4\u6587\u4ef6\uff0c\u8bb0\u5f55\u7528\u6237\u66fe\u7ecf\u8f93\u5165\u7684\u6240\u6709\u547d\u4ee4\uff1b(\u9ed8\u8ba4\u4e3a1000\u6761\uff0c\u53ef\u4ee5\u901a\u8fc7HISTSIZE\u53d8\u91cf\u66f4\u6539) /home/~/.bash_logout\uff1a\u5f53\u7528\u6237\u6ce8\u9500\u7684\u540c\u65f6\uff0c\u7cfb\u7edf\u81ea\u52a8\u751f\u6210.bash_logout\u6587\u4ef6\uff0c\u5982\u9700\u8981\u8bb0\u5f55\u7528\u6237\u6ce8\u9500\u7684\u5176\u4ed6\u4fe1\u606f\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u673a\u5236\u53bb\u5b8c\u6210 /root \u7ba1\u7406\u5458root\u7684\u5bbf\u4e3b\u76ee\u5f55 /lib \u9700\u8981\u5171\u4eab\u7684\u51fd\u6570\u5e93\u4e0ekernel\u6a21\u5757\uff0c\u7cfb\u7edfkernel\u542f\u52a8\u6240\u4f7f\u7528\u7684\u51fd\u6570\u5e93\uff0c\u6216\u8005\u5f53\u6267\u884c\u4e00\u4e9b\u5728/bin\u548c/sbin\u4e2d\u7684\u547d\u4ee4\u65f6\u4f7f\u7528\u7684\u51fd\u6570\u5e93 /mnt \u6302\u8f7d\u70b9\u76ee\u5f55\uff1b\u4e00\u822c\u7684\u81ea\u52a8\u6302\u5728/media\u76ee\u5f55(\u5982\u78c1\u76d8\u5206\u533a\uff0c\u7f51\u7edc\u5171\u4eab) /media \u79fb\u52a8\u5b58\u50a8\u8bbe\u5907\u9ed8\u8ba4\u6302\u8f7d\u70b9\uff1b(\u5982\u5149\u76d8) /opt \u5e38\u7528\u4e8e\u653e\u7f6e\u5927\u578b\u7684\u5e94\u7528\u8f6f\u4ef6\uff1b\u6570\u636e\u5e93\u6587\u4ef6 /proc \u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4fdd\u5b58\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5185\u5b58\u4fe1\u606f\uff0cCPU\u4fe1\u606f\uff0c\u865a\u62df\u5185\u5b58\u4fe1\u606f\uff0c\u7535\u6e90\u4fe1\u606f\uff1bcpuinfo ,meminfo ,acpi,scsi, vmstat,uptime;\u6bcf\u6b21\u542f\u52a8\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u65b0\u7684/porc\u6587\u4ef6\uff0c\u6765\u8bb0\u5f55\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5e76\u4e0d\u662f\u5b58\u653e\u5728\u786c\u76d8\u4e0a\uff0c\u800c\u662f\u5185\u5b58\u955c\u50cf\u4e2d\u7684\uff1b \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u6b64\u76ee\u5f55\u662fkernel\u52a0\u8f7d\u540e\uff0c\u5728\u5185\u5b58\u91cc\u9762\u5efa\u7acb\u7684\u4e00\u4e2a\u865a\u62df\u76ee\u5f55\uff0c\u6709\u4e13\u5c5e\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u63d0\u4f9b\u7cfb\u7edf\u4e00\u4e9b\u5b9e\u65f6\u7684\u4fe1\u606f\uff0c\u6b64\u76ee\u5f55\u4e0b\u4e0d\u80fd \u5efa\u7acb\u548c\u5220\u9664\u6587\u4ef6\uff1b(\u67d0\u4e9b\u6587\u4ef6\u53ef\u4ee5\u4fee\u6539) /proc\u4e3b\u8981\u4f5c\u7528\u53ef\u4ee5\u6574\u7406\u4e3a\uff1a \u6574\u7406\u7cfb\u7edf\u5185\u90e8\u7684\u4fe1\u606f \u5b58\u653e\u4e3b\u673a\u786c\u4ef6\u4fe1\u606f \u8c03\u6574\u7cfb\u7edf\u6267\u884c\u65f6\u7684\u53c2\u6570 \u68c0\u67e5\u53ca\u4fee\u6539\u7f51\u7edc\u548c\u4e3b\u673a\u7684\u53c2\u6570 \u68c0\u67e5\u53ca\u8c03\u6574\u7cfb\u7edf\u7684\u5185\u5b58\u548c\u6027\u80fd /proc\u4e0b\u5e38\u7528\u7684\u4fe1\u606f\u6587\u4ef6\u6709\uff1a /proc/cpuinfo\uff1acpu\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u5982\u7c7b\u578b\u3001\u5382\u5bb6\u3001\u578b\u53f7\u548c\u6027\u80fd\u7b49 /proc/devices\uff1a\u8bb0\u5f55\u6240\u6709\u5728/dev\u76ee\u5f55\u4e2d\u76f8\u5173\u7684\u8bbe\u5907\u6587\u4ef6\u5206\u7c7b\u65b9\u5f0f /proc/filesystems\uff1a\u5f53\u524d\u8fd0\u884c\u5185\u6838\u6240\u914d\u7f6e\u7684\u6587\u4ef6\u7cfb\u7edf /proc/interrupts\uff1a\u53ef\u4ee5\u67e5\u770b\u6bcf\u4e00\u4e2aIRQ\u7684\u7f16\u53f7\u5bf9\u5e94\u5230\u54ea\u4e00\u4e2a\u786c\u4ef6\u5907 /proc/loadavg\uff1a\u7cfb\u7edf\"\u5e73\u5747\u8d1f\u8f7d\"\uff0c3\u4e2a\u6570\u636e\u6307\u51fa\u7cfb\u7edf\u5f53\u524d\u7684\u5de5\u4f5c\u8d1f\u8f7d /proc/dma\uff1a\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684DMA\u901a\u9053 /proc/ioports\uff1a\u5c06\u76ee\u524d\u7cfb\u7edf\u4e0a\u6240\u6709\u53ef\u770b\u5230\u7684\u786c\u4ef6\u5bf9\u5e94\u5230\u5185\u5b58\u4f4d\u7f6e\u7684\u914d\u8868\u7684\u8be6\u7ec6\u4fe1\u606f\u5448\u73b0\u51fa\u6765 /proc/kcore\uff1a\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u68c0\u6d4b\u5230\u7684\u7269\u7406\u5185\u5b58\uff0c\u4e3b\u673a\u5185\u5b58\u591a\u5927\uff0c\u8fd9\u4e2a\u4ef6\u5c31\u6709\u591a\u5927 /proc/kmsg\uff1a\u5728\u7cfb\u7edf\u5c1a\u672a\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\u9636\u6bb5\uff0c\u628a\u52a0\u8f7dkernel\u548cinitr\u7684\u4fe1\u606f\u5148\u8bb0\u5f55\u5230\u8be5\u6587\u4ef6\u4e2d\uff0c\u540e\u7eed\u4f1a\u5c06\u65e5\u5fd7\u4fe1\u606f\u5199\u5165/var/log/messag\u6587\u4ef6\u4e2d /proc/meminfo\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u5185\u5b58\u4fe1\u606f /proc/modules\uff1a\u4e0elsmod\u547d\u4ee4\u67e5\u770b\u5230\u7684\u6a21\u5757\u4fe1\u606f\u5b8c\u5168\u4e00\u81f4 /proc/mtrr\uff1a\u8d1f\u8d23\u5185\u5b58\u914d\u7f6e\u7684\u673a\u5236 /proc/iomem\uff1a\u4e3b\u8981\u7528\u4e8e\u50a8\u5b58\u914d\u7f6e\u540e\u6240\u6709\u5185\u5b58\u50a8\u5b58\u7684\u660e\u7ec6\u4fe1\u606f /proc/partitions\uff1a\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u5b9e\u65f6\u5448\u73b0\u7cfb\u7edf\u76ee\u524d\u770b\u5230\u7684\u5206\u533a /proc/\u6570\u5b57\u76ee\u5f55\uff1a\u6570\u5b57\u76ee\u5f55\u5f88\u591a\uff0c\u5b83\u4eec\u4ee3\u8868\u6240\u6709\u76ee\u524d\u6b63\u5728\u7cfb\u7edf\u4e2d\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f /proc/bus\uff1a\u6709\u5173\u8be5\u4e3b\u673a\u4e0a\u73b0\u6709\u603b\u7ebf\u7684\u6240\u6709\u4fe1\u606f\uff0c\u5982\u8f93\u5165\u8bbe\u5907\u3001PCI\u53e3\u3001PCMCIA\u6269\u5c55\u5361\u53caUSB\u63a5\u53e3\u4fe1\u606f /proc/net\u76ee\u5f55\uff1a\u5b58\u653e\u7684\u90fd\u662f\u4e00\u4e9b\u7f51\u7edc\u76f8\u5173\u7684\u865a\u62df\u914d\u7f6e\u6587\u4ef6\uff0c\u90fdASCII\u6587\u4ef6\uff0c\u53ef\u4ee5\u67e5\u770b(\u4e0eifconfig\u3001arp\u3001netstat\u7b49\u6709\u5173) /proc/scsi\uff1a\u4fdd\u5b58\u7cfb\u7edf\u4e0a\u6240\u6709\u7684scsi\u8bbe\u5907\u4fe1\u606f(\u5305\u62ecsata\u548cusb\u8bbe\u5907\u4fe1\u606f) /proc/sys\u76ee\u5f55\uff1a\u5b58\u653e\u7cfb\u7edf\u6838\u5fc3\u6240\u4f7f\u7528\u7684\u4e00\u4e9b\u53d8\u91cf\uff0c\u6839\u636e\u4e0d\u540c\u6027\u8d28\u7684\u4ef6\u800c\u5b58\u653e\u5728\u4e0d\u540c\u7684\u5b50\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7/etc/sysctl.conf\u6587\u4ef6\u8bbe\u7f6e\u66f4\u6539\u5176\u9ed8\u8ba4\u503c\uff1b \u53d8\u91cf\u65f6\u5b9e\u65f6\u7684\u53d8\u66f4\uff0c\u6709\u5f88\u591a\u8bbe\u7f6e\u5f88\u8c61\u662f\u5f00\u5173\uff0c\u8bbe\u7f6e\u540e\u4e0a\u751f\u6548 /proc/tty\uff1a\u5b58\u653e\u6709\u5173\u76ee\u524d\u53ef\u7528\u7684\u6b63\u5728\u4f7f\u7528\u7684tty\u8bbe\u5907\u7684\u4fe1\u606f /proc/self\uff1a\u5b58\u653e\u5230\u67e5\u770b/proc\u7684\u7a0b\u5e8f\u7684\u8fdb\u7a0b\u76ee\u5f55\u7684\u7b26\u53f7\u8fde\u63a5\uff0c\u5f532\u8fdb\u7a0b\u67e5\u770bproc\u65f6\uff0c\u8fd9\u5c06\u4f1a\u662f\u4e0d\u540c\u7684\u8fde\u63a5\uff1b\u4e3b\u8981\u4fbf\u4e8e\u7a0b\u5e8f\u5f97\u5230\u5b83\u81ea\u5df1\u7684\u7a0b\u76ee\u5f55 /proc/stat\uff1a\u7cfb\u7edf\u7684\u4e0d\u540c\u72b6\u6001\u4fe1\u606f /proc/uptime\uff1a\u7cfb\u7edf\u542f\u52a8\u7684\u65f6\u95f4\u957f\u5ea6 /proc/version\uff1a\u7cfb\u7edf\u6838\u5fc3\u7248\u672c /sbin \u5b58\u653e\u7279\u6743\u7ea7\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u7279\u6743\u7ea7\u53ef\u6267\u884c\u547d\u4ee4\uff09\u53ea\u6709root\u7528\u6237\u53ef\u4ee5\u6267\u884c\uff1b\u8f83\u5371\u9669\u7684\u547d\u4ee4\u4fdd\u5b58\u5176\u4e2d\uff1b(\u591a\u6570\u7ba1\u7406\u547d\u4ee4\u9ed8\u8ba4\u53ea\u6709\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528) /usr\uff1a\u5b89\u88c5\u9664\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u5916\u7684\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u6216\u7ec4\u4ef6\uff0c\u4e00\u822c\u53ef\u4ee5\u8ba4\u4e3alinux\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u9ed8\u8ba4\u90fd\u5b89\u88c5\u5728\u6b64\u76ee\u5f55\u4e2d /usr/bin\uff1a\u4e00\u822c\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u5230\u7684\u7a0b\u5e8f\uff0c\u6216\u8005\u8be5\u8f6f\u4ef6\u9ed8\u8ba4\u5c31\u662f\u8981\u6240\u6709\u7528\u6237\u4f7f\u7528\u624d\u4f1a\u653e\u5728\u8be5\u76ee\u5f55\u4e2d /usr/sbin\uff1a\u4e00\u4e9b\u7cfb\u7edf\u6709\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u4e0e/sbin\u6bd4\u8d77\u6765\uff0c\u662f\u4e00\u4e9b\u8f83\u6b21\u8981\u7684\u6587\u4ef6 /usr/etc\uff1a\u81ea\u884c\u5b89\u88c5\u6216\u975e\u7cfb\u7edf\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 /usr/games\uff1a\u53ea\u8981\u662f\u7535\u8111\u6e38\u620f\u76f8\u5173\u7684\u8f6f\u4ef6\uff0c\u5c31\u90fd\u5b89\u88c5\u5230\u8fd9\u4e2a\u76ee\u5f55 /usr/include\uff1a\u5b58\u653e\u7684\u6587\u4ef6\u90fd\u662f\u4e00\u4e9b\u7cfb\u7edf\u4e2d\u7528\u6237\u6240\u4f1a\u4f7f\u7528\u5230\u7684C\u8bedheader\u6587\u4ef6\uff0c\u4fdd\u5b58\u7684\u90fd\u662f\".h\"\u7684\u6587\u4ef6 /usr/kerberos\uff1akerberos\u662f\u4e00\u79cd\u5b89\u5168\u673a\u5236\uff0c\u8ba9\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6301kerberos\u673a\u5236\u7cfb\u7edf\u4e0a\u7684\u90e8\u5206\u8d44\u6e90 /usr/lib\uff1a\u5b58\u653e\u4e00\u4e9b\u51fd\u6570\u5e93\u3001\u6267\u884c\u6587\u4ef6\u53ca\u8fde\u63a5\u6587\u4ef6\uff0c\u7279\u522b\u7684\u662f\uff0c\u5b58\u5728\u8fd9\u91cc\u9762\u7684\u6587\u4ef6\u90fd\u662f\u4e0d\u5e0c\u671b\u76f4\u63a5\u88ab\u7528\u6237\u6216shell\u811a\u672c\u6240\u4f7f\u7528\u7684\u6587\u4ef6\uff0c/usr/lib\u4e2d\u6709 \u975e\u5e38\u591a\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e00\u4e2a\u8f6f\u4ef6\u90fd\u6709\u5176\u5404\u81ea\u6240\u9700\u7684\u51fd\u5e93 /usr/libexec\uff1a\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\u5e94\u8be5\u90fd\u53ef\u4ee5\u653e\u7f6e/usr/lib\u4e0b /usr/local\uff1alinux\u7cfb\u7edf\u4e2d\u5b89\u88c5\u7684\u5171\u4eab\u8f6f\u4ef6\u7a0b\u5e8f\u6700\u597d\u7684\u65b9\u5f0f\u662f\u5b89\u88c5/usr/local\u4e0b\uff0c\u6309\u7167linux\u6807\u51c6\u76ee\u5f55\u7ed3\u6784\uff0c\u65b0\u5efa\u7acb\u7684\u8f6f\u4ef6\u90fd\u5e94\u8be5\u653e/usr/local\u4e0b /usr/local/bin\uff1a\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55 /usr/local/sbin\uff1a\u540c\u6837\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f46\u6b64\u76ee\u5f55\u95e8\u9488\u5bf9\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u6587\u4ef6 /usr/local/lib\uff1a\u8f6f\u4ef6\u76f8\u5173\u7684\u51fd\u6570\u5e93 /usr/local/share\uff1a\u5f53\u6587\u4ef6\u6027\u8d28\u4e0d\u597d\u5f52\u5c5e\u65f6\u5c31\u4f1a\u653e\u5728\u6b64\uff0cman\u518c\u5c31\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b /usr/local/src\uff1a\u6240\u5b89\u88c5\u8f6f\u4ef6\u7684\u6e90\u4ee3\u7801\u653e\u7f6e\u5728\u6b64 /usr/share\uff1a\u6b64\u76ee\u5f55\u90fd\u662f\u4e00\u4e9b\u5171\u4eab\u4fe1\u606f\uff0c\u6700\u5e38\u88ab\u7528\u5230\u7684\u5c31/usr/share/man\u8fd9\u4e2a\u76ee\u5f55\uff0c/usr/share\u91cc\u7684\u4fe1\u606f\u65f6\u8de8\u5e73\u53f0\u7684 /usr/share/doc\uff1a\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u5e2e\u52a9\u6587\u4ef6\u7684\u5730\u65b9 /usr/share/man\uff1amanpage\u7684\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u4e5f\u662f\u4f7f\u7528man\u67e5\u770b\u624b\u518c\u65f6\u67e5\u8be2\u7684\u8def\u5f84 /usr/src\uff1a\u4e3b\u8981\u50a8\u5b58\u5185\u6838\u6e90\u4ee3\u7801\u7684\u6587\u4ef6 /usr/X11R6\uff1a\u5b58\u653e\u4e00\u4e9bX windows\u7cfb\u7edf\u7684\u76f8\u5173\u6587\u4ef6 /var \u52a8\u6001\u6587\u4ef6\u6216\u6570\u636e\u5b58\u653e\u76ee\u5f55\uff0c\u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u4e00\u822c\u5efa\u8bae\u628a\u6b64\u76ee\u5f55\u5355\u72ec\u5212\u5206\u4e00\u4e2a\u5206\u533a /var/account\uff1a\u662flinux\u7cfb\u7edf\u4e0b\u7684\u5ba1\u6838\u673a\u5236(psacct)\u5bf9\u5e94\u7684\u76ee\u5f55 /var/cache\uff1a\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u65f6\u6240\u6709\u7a0b\u5e8f\u6240\u4ea7\u751f\u7684\u7f13\u5b58\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u4f1a\u5c06\u6570\u636e\u7559\u4e00\u4efd\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d /var/empty\uff1a\u9ed8\u8ba4\u662fsshd\u7a0b\u5e8f\u7528\u5230\u7684\u8fd9\u4e2a\u76ee\u5f55\uff0c\u5f53\u5efa\u7acbssh\u8fde\u63a5\uff0cssh\u670d\u52a1\u5668\u5fc5\u987b\u4f7f\u7528\u8be5\u76ee\u5f55\u4e0b\u7684sshd\u5b50\u76ee\u5f55 /var/ftp\uff1aftp\u670d\u52a1\u5668\u8f6f\u4ef6\u4e00\u822c\u9ed8\u8ba4\u4f1a\u5c06\u533f\u540d\u767b\u9646\u7684\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55 /var/gdm\uff1agdm\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u5f53\u524d\u6240\u5360\u7528\u7684console\u8bb0\u5f55\u53ca\u901a\u8fc7gdm\u6267\u884c\u7684X windows\u8bb0\u5f55\uff0c\u53ea\u6709\u901a\u8fc7gdm\u7a97\u53e3\u7684\u65e5\u5fd7\u624d\u4f1a\u5b58\u653e\u5728\u6b64 /var/lib\uff1a\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u5f88\u591a\u4e0e\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0\u540c\u540d\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e2a\u5b50\u76ee\u5f55\u4e0b\u90fd\u662f\u5e94\u7528\u6267\u884c\u7684\u72b6\u6001\u4fe1\u606f /var/lock\uff1a\u6bcf\u4e2a\u670d\u52a1\u4e00\u5f00\u59cb\u90fd\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u4ea7\u751f\u4e00\u4e2a\u8be5\u670d\u52a1\u7684\u7a7a\u6587\u4ef6\uff0c\u4e3b\u8981\u662f\u907f\u514d\u670d\u52a1\u542f\u52a8\u51b2\u7a81 /var/log\uff1a\u5e38\u7528\u76ee\u5f55\uff0c\u4e13\u95e8\u7528\u6765\u5b58\u653e\u6240\u6709\u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u5f88\u591a\u7cfb\u7edf\u3001\u8f6f\u4ef6\u3001\u7528\u6237\u7b49\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f\uff1b\u91cc\u9762\u6709\u4e00\u4e9b\u6587\u4ef6\u662f\u6bd4\u8f83\u5e38\u7528\u7684 lastlog\uff1a\u8bb0\u5f55\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u7684\u4fe1\u606f\uff0c\u4f7f\u7528lastlog\u547d\u4ee4\u8bfb\u53d6 message\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u51e0\u4e4e\u6240\u6709\u4fe1\u606f\uff0c\u4e3b\u8981\u5305\u62ec\u542f\u52a8\u4fe1\u606f\uff0csyslogd\u670d\u52a1\u8bb0\u5f55\u7684\u4fe1\u606f\u7b49 wtmp\uff1a\u8bb0\u5f55\u6240\u6709\u7528\u6237\u767b\u9646\u53ca\u6ce8\u9500\u7684\u4fe1\u606f\uff0c\u4f7f\u7528last\u547d\u4ee4\u8bfb\u53d6 secure\uff1a\u8bb0\u5f55\u767b\u5f55\u7cfb\u7edf\u8bbf\u95ee\u6570\u636e\u7684\u6587\u4ef6\uff0c\u5982ssh pop3 telnet ftp\u7b49\u90fd\u4f1a\u8bb0\u5f55\u5728\u6b64\u6587\u4ef6\u4e2d /var/log/httpd/access_log\uff1ahttpd\u8bbf\u95ee\u65e5\u5fd7 /var/log/httpd/error_log\uff1ahttpd\u9519\u8bef\u65e5\u5fd7 btmp\uff1a\u8bb0\u5f55\u5931\u8d25\u7684\u7528\u6237\u767b\u5f55 utmp\uff1a \u7eaa\u5f55\u5f53\u524d\u767b\u5f55\u7684\u6bcf\u4e2a\u7528\u6237 xferlog\uff1aftp\u4f1a\u8bdd\u65e5\u5fd7 boot.log\uff1a\u8bb0\u5f55\u5f00\u673a\u6216\u4e00\u4e9b\u670d\u52a1\u542f\u52a8\u65f6\u6240\u663e\u793a\u7684\u542f\u52a8\u548c\u5173\u95ed\u4fe1\u606f /var/log/maillog\u6216/var/log/mail/*\uff1a\u8bb0\u5f55\u90ae\u4ef6\u8bbf\u95ee\u6216\u5f80\u6765\u7684\u7528\u6237\u4fe1\u606f cron\uff1a \u8bb0\u5f55crontab\u4f8b\u884c\u6027\u670d\u52a1\u7684\u5185\u5bb9 dmesg\uff1a\u5f00\u673a\u5f15\u5bfc\u65e5\u5fd7\u4fe1\u606f sudolog\uff1a\u7eaa\u5f55\u4f7f\u7528sudo\u53d1\u51fa\u7684\u547d\u4ee4 sulog\uff1a \u7eaa\u5f55\u4f7f\u7528su\u547d\u4ee4\u7684\u4f7f\u7528 /var/named\uff1abind\u8f6f\u4ef6\u5b9e\u73b0\u7684DNS\u670d\u52a1\u5668\u7684\u533a\u57df\u6570\u636e\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b /var/nis\u548c/var/yp\uff1a\u90fd\u662fNIS\u670d\u52a1\u673a\u5236\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0cnis\u4e3b\u8981\u8bb0\u5f55\u6240\u6709\u7f51\u7edc\u4e2d\u6bcf\u4e00\u4e2aclient\u7684\u8fde\u63a5\u4fe1\u606f\uff1byp\u662flinux\u7684nis\u670d\u52a1\u7684\u65e5\u5fd7\u6587\u4ef6\u5b58\u653e\u7684\u76ee\u5f55 /var/run\uff1a\u6b64\u76ee\u5f55\u4e2d\u7684\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u8bb0\u8f7d\u76ee\u524d\u7cfb\u7edf\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u7684PID\u503c\uff0c\u6bcf\u4e00\u4e2a\u6587\u4ef6\u90fd\u662f\u4ee5\u4e2a\u72ec\u7acb\u7684PID\u8bb0\u5f55\uff1b\u6b64\u76ee\u5f55\u4e0b\u5b58\u653e\u4e00\u4e2a\u7279\u6b8a\u6587\u4ef6utmp\uff0c\u6b64\u6587\u4ef6\u8bb0\u5f55\u76ee\u524d\u8c01\u5728\u4f7f\u7528\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528utmpdump\u547d\u4ee4\u624d\u80fd\u770b\u5230\u5176\u4e2d\u7684\u5185\u5bb9 /var/spool\uff1a\u91cc\u9762\u4e3b\u8981\u90fd\u662f\u4e00\u4e9b\u4e34\u65f6\u5b58\u653e\uff0c\u968f\u65f6\u4f1a\u88ab\u7528\u6237\u6240\u8c03\u7528\u7684\u6570\u636e\uff1b\u6253\u5370\u673a\u3001\u90ae\u4ef6\u3001\u4ee3\u7406\u670d\u52a1\u5668\u7b49\u5047\u8131\u673a\u76ee\u5f55\u5b58\u653e\u5728\u8be5\u76ee\u5f55\u4e0b /var/tmp\uff1a\u4e13\u95e8\u4e3a\u4e86\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5728\u5b89\u88c5\u6216\u6267\u884c\u65f6\uff0c\u9700\u8981\u5728\u91cd\u542f\u540e\u4f7f\u7528\u7684\u67d0\u4e9b\u6587\u4ef6\u65f6\uff0c\u80fd\u5c06\u8be5\u6587\u4ef6\u6682\u65f6\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\uff0c\u5b8c\u6210\u540e\u518d\u884c\u5220\u9664 /var/www\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u5bbf\u4e3b\u76ee\u5f55 /lost+found:\u5b58\u653e\u4e86\u4e00\u4e9b\u7cfb\u7edf\u51fa\u9519\u7684\u68c0\u67e5\u7ed3\u679c\uff1b\u5f02\u5e38\u65ad\u7535\u60c5\u51b5\u3001\u6b7b\u673a\uff1b\u9ed8\u8ba4\u76ee\u5f55\u662f\u7a7a\u7684,\u901a\u5e38\u4f7f\u7528fsck\u8fdb\u884c\u6587\u4ef6\u4fee\u590d\uff0c\u4fee\u590d\u540e\u6587\u4ef6\u5219\u88ab\u5b58\u653e\u4e8e\u6b64\u76ee\u5f55 /misc\uff1a\u81ea\u52a8\u6302\u8f7d\u670d\u52a1\u76ee\u5f55\uff0c\u5bf9\u5e94autofs\u670d\u52a1 /srv\uff1a\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u4e00\u4e9b\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u67d0\u4e9b\u8f6f\u4ef6\u53ef\u80fd\u4f1a\u628a\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u591a\u6570\u90fd\u662f/etc\u76ee\u5f55\u4e0b\uff0c\u6b64\u76ee\u5f55\u6ca1\u6709\u88ab\u5177\u4f53\u7684\u5b9a\u4e49 /temp \u4e34\u65f6\u6587\u4ef6\u5b58\u653e\u70b9\uff1b\u6b64\u76ee\u5f55\u6709\u7279\u6b8a\u7684\u6743\u9650\u4f4d\u7c98\u6ede\u4f4d\uff1a1777 /tftpboot\uff1a\u8fdc\u7a0b\u542f\u52a8tftpserver\u7684\u6839\u76ee\u5f55\uff0c\u8fd9\u4e2a\u76ee\u5f55\u53ea\u6709\u5b89\u88c5\u4e86tftp-server\u8f6f\u4ef6\u540e\u624d\u4f1a\u4ea7\u751f \u5907\u6ce8\uff1a\u5982\u679c\u8981\u505a\u7cfb\u7edf\u7ea7\u5907\u4efd\u7684\u8bdd\uff0c/etc ,/boot\u662f\u5fc5\u987b\u8981\u5907\u4efd\u7684\u76ee\u5f55\uff0c\u5907\u4efd\u5206\u4e3a\uff1a\u7cfb\u7edf\u5907\u4efd\u548c\u7528\u6237\u5907\u4efd /sbin /usr/sbin\u662froot\u8d26\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84 /bin /usr/bin\u5bf9\u4e8e\u666e\u901a\u7528\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84 bin\u4ee3\u8868binnary \uff1bsbin \u4ee3\u8868super binnary /usr\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u548cwindows\u7cfb\u7edf\u4e0a\u7684windows\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u6838\u5fc3\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e GRUB\u914d\u7f6e\u6587\u4ef6\u8bb2\u89e3\uff1a \u00b6 \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a / etc / grub . conf\u662f\u4e2a\u8f6f\u8fde\u63a5\u6587\u4ef6 \u539f\u59cb\u6587\u4ef6 / boot / grub / grub . conf grep - v \"^#\" / boot / grub / grub . conf | more \u5b57\u6bb5\uff1a default\u5b9a\u4e49\u7f3a\u7701\u542f\u52a8\u7cfb\u7edf , 0 \u8868\u793a\u7b2c\u4e00\u4e2a\uff0c 1 \u8868\u793a\u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8 ------------------------------------------------- timeout \u5b9a\u4e49\u4e86\u7f3a\u7701\u7b49\u5f85\u65f6\u95f4\uff1b\u9ed8\u8ba4 5 \u79d2 ------------------------------------------------- splashimage \u5b9a\u4e49\u4e86 GRUB\u542f\u52a8\u65f6\u7684\u754c\u9762\u56fe\u7247 ------------------------------------------------- hiddenmenu \u9690\u85cf\u83dc\u5355 ------------------------------------------------- title \u5b9a\u4e49\u4e86\u83dc\u5355\u9879\u540d\u79f0 ------------------------------------------------- root \u4f5c\u7528\u662f\u8bbe\u7f6e GRUB\u7684\u6839\u8bbe\u5907\u4e5f\u5c31\u662f\u5185\u6838\u6240\u5728\u7684\u5206\u533a ------------------------------------------------- kernel \u5b9a\u4e49\u4e86\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e ------------------------------------------------- initrd \u547d\u4ee4\u52a0\u8f7d\u955c\u50cf\u6587\u4ef6\u4ee5\u53ca\u663e\u793a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e ------------------------------------------------- GRUB\u8bbe\u7f6e\u5bc6\u7801 \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u4f7f\u7528 GRUB\u81ea\u5e26\u7684grub - md5 - crypt\u547d\u4ee4 grub - md5 - crypt \u5728\u56fe\u5f62\u754c\u9762\u6211\u53ef\u4ee5\u9009\u62e9\u590d\u5236\u9009\u9879\u8fdb\u884c\u590d\u5236\uff0c\u5728\u5b57\u7b26\u7ec8\u7aef\u754c\u9762\u4e0a\u4f7f\u7528\u9f20\u6807\u53f3\u952e\u590d\u5236\u52a0\u5bc6\u5b57\u7b26 \u7f16\u8f91 / etc / grub . conf\u914d\u7f6e\u6587\u4ef6 \uff0c\u5728 hiddenmenu\u5b57\u6bb5\u4e0b\u9762\u63d2\u5165\u5173\u4e8e\u63d2\u5165\u4f4d\u7f6e\u6ca1\u6709\u4e25\u683c\u7684\u8981\u6c42 \uff09 password --md5 \u52a0\u5bc6\u5b57\u7b26\uff08-md5\u8868\u793a\u53e3\u4ee4\u662fmd5\u52a0\u5bc6\u7684\uff09 \u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u63d2\u5165\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff1b\u7136\u540e\u9000\u51fa\u4fdd\u6301\u5373\u53ef \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u662f\u5728 GRUB\u4ea4\u4e92\u547d\u4ee4\u884c\u754c\u9762\u4f7f\u7528md5crypt\u547d\u4ee4 \uff0c\u6548\u679c\u662f\u4e00\u6837\u7684 grub grub > md5crypt password : GRUB\u7684\u7cfb\u7edf\u4fee\u590d \uff1a\uff08\u624b\u5de5\u4fee\u590d\uff09\u6545\u610f\u4fee\u6539 kernel\u6307\u5b9a\u7684\u5185\u6838\u6587\u4ef6 grub > cat / grub / grub . conf \u4e3a\u4ec0\u4e48\u6ca1\u6709 / boot\u539f\u56e0\u5c31\u662fgrub\u5b58\u653e\u5728 / boot\u5206\u533a grub > \u6307\u5b9a\u5185\u6838\u6240\u5728\u7684\u5206\u533a root ( hd0 , 0 ) grub > \u6307\u5b9a\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e grub > \u6307\u5b9a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e grub > boot \u624b\u5de5\u4fee\u590d\u5c5e\u4e8e\u547d\u4ee4\u884c\u64cd\u4f5c\uff1b\u5982\u4fee\u6539\u4e86 / etc / inittab\u4e2d\u7684\u9ed8\u8ba4\u542f\u52a8\u7ea7\u522b\u7684\u8bdd \uff0c\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7 grub\u542f\u52a8\u83dc\u5355\u6765\u8fdb\u884c\u4fee\u590d \uff1a\u5728 kernel\u884c\u76f4\u63a5\u52a0\u5165\u542f\u52a8\u7ea7\u522b \u7ec8\u6781\u4fee\u590d\u6a21\u5f0f\uff1a\u5149\u76d8\u4fee\u590d \u5149\u76d8\u5f15\u5bfc\uff0c F5\u952e \uff0c\u952e\u5165 linux rescue \u6848\u4f8b 1 \uff1a\u5c1d\u8bd5\u5220\u9664 / etc / inittab \uff0c\u4e4b\u524d\u5148\u505a\u597d\u5907\u4efd cp / etc / inittab / etc / inittab . bak rm - rf / etc / inittab \u6848\u4f8b 2 \uff1a\u5982\u679c\u5fd8\u8bb0\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u540c\u65f6\u4e5f\u5fd8\u8bb0\u4e86 GRUB\u7684\u4fdd\u62a4\u5bc6\u7801\u7684\u8bdd \uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 GRUB\u7684\u7cfb\u7edf\u4fee\u590d\u6216\u8005\u4f7f\u7528\u5149\u76d8\u7684\u5f15\u5bfc\u4fee\u590d\u6765\u89e3\u51b3\u6b64\u95ee\u9898 fstab\u6587\u4ef6\u542b\u4e49\u5982\u4e0b\uff1a \u00b6 \u7269\u7406\u5206\u533a/\u5377\u6807\uff1b\u53ef\u4ee5\u4f7f\u7528UUID\u3001\u8bbe\u5907\u8def\u5f84/dev/\u3001\u534f\u8bae/\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u6216\u7f51\u7edc\u5171\u4eab\u540d\u79f0\u8868\u793a \u6302\u8f7d\u70b9(\u6ce8\u610f\uff1aswap\u6ca1\u6709\u6302\u8f7d\u70b9) \u6587\u4ef6\u7cfb\u7edf,auto\u901a\u5e38\u7528\u4e8e\u53ef\u79fb\u52a8\u8bbe\u5907\uff0c\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u6216\u7f51\u7edc\u5171\u4eab\u7f51\u7edc\u534f\u8bae \u6302\u8f7d\u65f6\u4f7f\u7528\u7684\u53c2\u6570\uff1b\u6b64\u9009\u9879\u53d6\u51b3\u4e8e\u6587\u4ef6\u7cfb\u7edf\uff0cdefault=rw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\u548casync sync/async \u6587\u4ef6\u7cfb\u7edf\u7684\u6240\u6709I/O\u540c\u6b65\u6216\u5f02\u6b65\u5b8c\u6210 auto \u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u81ea\u52a8\u6302\u8f7d\uff08\u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u9009\u9879\u4f20\u9012\u6302\u8f7d\u65f6\uff09\u3002\u786e\u5b9e\u6ca1\u6709\u5fc5\u8981\uff0c\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u8fd9\u662fmount -a\u7684\u9ed8\u8ba4\u64cd\u4f5c noauto \u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u6302\u8f7d\u65f6\u4e0d\u4f1a\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u60a8\u5fc5\u987b\u663e\u5f0f\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf dev/nodev \u89e3\u91ca\u6216\u4e0d\u89e3\u91ca\u5b57\u7b26\u6216\u963b\u6b62\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u8bbe\u5907 exec/noexec \u5141\u8bb8\u6216\u963b\u6b62\u4ece\u6587\u4ef6\u7cfb\u7edf\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6 suid/nosuid \u5141\u8bb8\u6216\u963b\u6b62suid\u548csgid\u4f4d\u7684\u64cd\u4f5c ro \u6302\u8f7d\u4e3a\u53ea\u8bfb rw \u6302\u8f7d\u4e3a\u8bfb\u5199 user \u5141\u8bb8\u4efb\u4f55\u7528\u6237\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u9664\u975e\u88ab\u8986\u76d6\uff0c\u8fd9\u5c06\u81ea\u52a8\u8868\u793anoexec\uff0cnosuid\uff0cnodev\u9664\u975e\u88ab\u989d\u5916\u9009\u9879\u8986\u76d6 nouser \u4ec5\u5141\u8bb8root\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u8bbe\u7f6e defaults \u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u3002\u7b49\u6548\u4e8erw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\uff0casync _netdev \u8fd9\u662f\u4e00\u4e2a\u7f51\u7edc\u8bbe\u5907\uff0c\u5728\u542f\u52a8\u7f51\u7edc\u540e\u5c06\u5176\u5b89\u88c5\u3002\u4ec5\u5bf9fstype nfs\u6709\u6548 noatime,nodiratime \u7981\u6b62\u8bb0\u5f55\u6700\u8fd1\u8bbf\u95ee\u65f6\u95f4\u6233\uff0c\u8bbe\u7f6enoatime\u53ef\u4e0d\u5fc5\u518d\u8bbe\u7f6enodiratime relatime \u5b9e\u65f6\u66f4\u65b0inode\u8bbf\u95ee\u8bb0\u5f55\u65f6\u95f4\u6233 owner \u5141\u8bb8\u8bbe\u5907\u88ab\u90a3\u4e2a\u6240\u6709\u8005\u6302\u8f7d \u542f\u7528\u6216\u7981\u7528\u8bbe\u5907/\u5206\u533a\u7684\u5907\u4efd(dump\u662f\u5907\u4efd\u5de5\u5177)\uff0c1\u8868\u793a\u5f00\u542f\uff0c0\u8868\u793a\u5ffd\u7565 \u63a7\u5236fsck\u5728\u5f15\u5bfc\u65f6\u68c0\u67e5\u8bbe\u5907/\u5206\u533a\u7684\u9519\u8bef\u7684\u987a\u5e8f\uff0c\u6839\u8bbe\u5907\u5e94\u4e3a1\u3002\u5176\u4ed6\u5206\u533a\u5e94\u4e3a2\u62160\u4ee5\u7981\u7528\u68c0\u67e5 Linux_\u7528\u6237\u3001\u7ec4\u548c\u6743\u9650 \u00b6 Linux\u7528\u6237\u548c\u7528\u6237\u7ec4 \u00b6 # \u67e5\u770b\u7cfb\u7edf\u4e2d\u6709\u591a\u5c11\u7684\u7528\u6237\u6570\u91cf wc - l / etc / passwd cut - d \" : \" - f 1 / etc / passwd # \u7528\u6237\u548c\u7ec4\u7684\u6587\u4ef6 / etc / passwd / etc / group # \u5f71\u5b50\u53e3\u4ee4\uff1a\uff08\u771f\u6b63\u53e3\u4ee4\u6587\u4ef6\u8def\u5f84\uff09 \u7528\u6237\uff1a / etc / shadow \u7ec4\uff1a / etc / gshadow # / etc / passwd\u4e2d7\u6bb5\u610f\u4e49 \uff1a\u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a UID : GID \uff1a\u7528\u6237\u63cf\u8ff0\u4fe1\u606f\uff1a\u5bb6\u76ee\u5f55\uff1a\u9ed8\u8ba4 SHELL account : \u7528\u6237\u540d password : \u5bc6\u7801 UID \uff1a\u7528\u6237 ID \uff0c\u5206\u4e3a\u4e09\u7c7b\uff1a root\u7528\u6237 \uff1a 0 \uff0c\u666e\u901a\u7528\u6237\uff1a 500 - 60000 \uff0c\u4f2a\u7528\u6237\uff1a 1 - 499 GID \uff1a\u7ec4 ID \uff0c\u6bcf\u4e2a\u7528\u6237\u81f3\u5c11\u5c5e\u4e8e\u4e00\u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u53ef\u4ee5\u6709\u591a\u4e2a\u7528\u6237\uff0c\u540c\u4e00\u7528\u6237\u7ec4\u7684\u7528\u6237\u7ee7\u627f\u6539\u7ec4\u7684\u6743\u9650 \u7528\u6237\u63cf\u8ff0\u4fe1\u606f : \u9488\u5bf9\u7528\u6237\u7684\u7b80\u4ecb HOME DIR \uff1a\u5bb6\u76ee\u5f55 SHELL \uff1a\u7528\u6237\u7684\u9ed8\u8ba4 shell # / etc / group\u4e2d4\u6bb5\u610f\u4e49 \uff1a\u7ec4\u540d\uff1a\u5bc6\u7801\uff1a GID : \u4ee5\u6b64\u7ec4\u4e3a\u5176\u9644\u52a0\u7ec4\u7684\u7528\u6237\u5217\u8868 # / etc / shadow\u4e2d8\u6bb5\u610f\u4e49 \uff1a \u5b57\u6bb5 1 \uff1a\u7528\u6237\u5e10\u53f7\u7684\u540d\u79f0 \u5b57\u6bb5 2 \uff1a\u52a0\u5bc6\u7684\u5bc6\u7801\u5b57\u4e32\u4fe1\u606f \u5b57\u6bb5 3 \uff1a\u4e0a\u6b21\u4fee\u6539\u5bc6\u7801\u7684\u65f6\u95f4\uff08 1970 / 1 / 1 \u8ddd\u4fee\u6539\u65f6\u95f4\u7684\u5929\u6570\uff09 \u5b57\u6bb5 4 \uff1a\u5bc6\u7801\u7684\u6700\u77ed\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 0 \u5b57\u6bb5 5 \uff1a\u5bc6\u7801\u7684\u6700\u957f\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 99999 \u5b57\u6bb5 6 \uff1a\u63d0\u524d\u591a\u5c11\u5929\u8b66\u544a\u7528\u6237\u53e3\u4ee4\u5c06\u8fc7\u671f\uff0c\u9ed8\u8ba4\u503c\u4e3a 7 \u5b57\u6bb5 7 \uff1a\u5728\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u591a\u5c11\u5929\u7981\u7528\u6b64\u7528\u6237 \u5b57\u6bb5 8 \uff1a\u5e10\u53f7\u5931\u6548\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a \u7a7a \u5b57\u6bb5 9 \uff1a\u4fdd\u7559\u5b57\u6bb5\uff08\u672a\u4f7f\u7528 ) # \u4f2a\u7528\u6237\uff1a \u4f2a\u7528\u6237\u5c31\u662f\u7cfb\u7edf\u548c\u7a0b\u5e8f\u64cd\u4f5c\u65f6\u8c03\u7528\u7684\u7528\u6237\uff0c\u4e0e\u7cfb\u7edf\u548c\u7a0b\u5e8f\u670d\u52a1\u76f8\u5173\u3002\u4f8b\u5982\uff1a bin \u3001 daemon \u3001 shutdown \u3001 halt\u7b49 \uff0c\u4efb\u4f55 linux\u64cd\u4f5c\u7cfb\u7edf\u90fd\u9ed8\u8ba4 \u6709\u8fd9\u4e9b\u4f2a\u7528\u6237\uff0c\u662f\u7cfb\u7edf\u81ea\u52a8\u751f\u6210\u7684\uff0c\u4f8b\u5982\uff1a mail \u3001 apache \u3001 ftp\u7b49 \uff0c\u4e0e linux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u76f8\u5173 \uff0c\u800c\u4e14\u6b64\u7c7b\u7684\u7528\u6237\u4e0d\u9700\u8981\u767b\u5f55\u6216\u8005\u662f\u65e0\u6cd5\u767b\u5f55 \u7cfb\u7edf\u5f53\u4e2d\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6ca1\u6709\u76f8\u5e94\u7684\u5bbf\u4e3b\u76ee\u5f55 # \u6269\u5c55\u77e5\u8bc6\u70b9\uff1a \u5173\u4e8e\u5efa\u7acb\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\u7684\u8fc7\u7a0b\u5206\u6790\uff1a\u5bc6\u7801\u5148\u5199\u5165 / etc / passwd\u6587\u4ef6\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5 \uff0c\u63a5\u7740\u901a\u8fc7\u6307\u4ee4\u8f6c\u5230 / etc / shadow\u6587\u4ef6\u4e2d \uff0c\u8f6c\u5316\u7684\u547d\u4ee4\u662f psconv \uff0c \u8fc7\u7a0b\u662f\u81ea\u52a8\u5b8c\u6210\uff0c\u56de\u5199\u7684\u547d\u4ee4\u662f pwunconv \uff0c\u6267\u884c\u6b64\u547d\u4ee4\u540e\u5bc6\u7801\u4f1a\u5728 / etc / passwd\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5X\u4e2d\u51fa\u73b0\u4e14\u662f\u52a0\u5bc6\u7684 \uff0c\u8fd9\u4e5f\u8bf4\u660e\u4e86\u5bc6\u7801\u4f4d\u4fdd\u7559\u7684\u539f\u56e0 \u767b\u9646\u4fe1\u606f\u6587\u4ef6\uff1a / etc / motd \u767b\u5f55\u6210\u529f\u540e\u4f1a\u770b\u5230\u63d0\u793a\u4fe1\u606f \u4fee\u6539 / etc / issue\u6587\u4ef6\u7684\u8bdd \uff0c\u662f\u5728\u767b\u5f55\u4e4b\u524d\u5c31\u53ef\u4ee5\u770b\u5230\uff1b\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u9632\u6b62\u770b\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c\u4fe1\u606f\uff0c\u53ef\u4ee5\u4fee\u6539 / etc / issue\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u8005\u76f4\u63a5\u5220\u9664\u5373\u53ef / etc / issue . net\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\u662f\u4f5c\u4e3atelnet\u670d\u52a1\u7684\u63d0\u793a\u4fe1\u606f issue \u5185\u7684\u5404\u4ee3\u7801\u610f\u4e49\u8868\u793a\u5982\u4e0b\u6240\u793a\uff1a\uff08\u7ba1\u7406\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0\uff09 / l \u663e\u793a\u7b2c\u51e0\u4e2a\u7ec8\u7aef\u673a\u63a5\u53e3 / m \u663e\u793a\u786c\u4ef6\u7684\u7b49\u7ea7 ( i386 / i486 / i586 / i686 ...) / n \u663e\u793a\u4e3b\u673a\u7684\u7f51\u7edc\u540d\u79f0 / o \u663e\u793a domain name / r \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c ( \u76f8\u5f53\u4e8e uname - r ) / t \u663e\u793a\u672c\u5730\u7aef\u65f6\u95f4\u7684\u65f6\u95f4 / s \u64cd\u4f5c\u7cfb\u7edf\u7684\u540d\u79f0 / v \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c \u6743\u9650\uff1ar, w, x \u00b6 # \u6587\u4ef6\u6743\u9650\uff1a r --4\uff1a\u53ef\u8bfb w --2\uff1a\u53ef\u5199 x --1: \u53ef\u6267\u884c\uff0ceXacutable # \u76ee\u5f55\u6743\u9650\uff1a w : \u53ef\u4ee5\u5728\u6b64\u76ee\u5f55\u521b\u5efa\u6587\u4ef6 r : \u53ef\u4ee5\u5bf9\u6b64\u76ee\u5f55\u6267\u884c ls\u4ee5\u5217\u51fa\u5185\u90e8\u7684\u6240\u6709\u6587\u4ef6 x : \u53ef\u4ee5\u4f7f\u7528 cd\u5207\u6362\u8fdb\u6b64\u76ee\u5f55 \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ls - l\u67e5\u770b\u5185\u90e8\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f # \u6743\u9650\u4e09\u4f4d\u4e00\u4f53\uff1a rwx : \u53ef\u8bfb\u53ef\u5b66\u53ef\u6267\u884c r --:\u53ea\u8bfb r - x : \u8bfb\u548c\u6267\u884c ---\uff1a\u65e0\u6743\u9650 # \u516b\u8fdb\u5236\u8868\u793a\uff1a 0 000 ---\uff1a\u65e0\u6743\u9650 1 001 --x: \u6267\u884c 2 010 - w - : \u5199 3 011 - wx : \u5199\u548c\u6267\u884c 4 100 r --: \u53ea\u8bfb 5 101 r - x : \u8bfb\u548c\u6267\u884c 6 110 rw - : \u8bfb\u5199 7 111 rwx : \u8bfb\u5199\u6267\u884c # \u4f8b\u5982\uff1a rw - r -----: 640 rw - r --r--: 644 rw - rw ----: 660 rwxr - xr - x : 755 rwxrwxr - x : 775 \u4e09\u3001\u7279\u6b8a\u6743\u9650 \u00b6 \u7279\u6b8a\u6743\u9650\uff1a s , s , t 1 . SUID : \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u4e3b\uff0c\u800c\u4e0d\u662f\u52a8\u8005 \u683c\u5f0f\uff1a chmod u + s FILE \uff0c chmod u - s FILE \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3as \uff1b\u5426\u5219\u663e\u793a S 2 . SGID : \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u7ec4\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u7ec4\uff0c\u800c\u4e0d\u662f\u52a8\u8005\u6240\u5c5e\u7684\u57fa\u672c\u7ec4 \u683c\u5f0f\uff1a chmod g + s FILE \uff0c chmod g - s FILE \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3as \uff1b\u5426\u5219\u663e\u793a S 3 . Sticky bit ( \u7c98\u6ede\u4f4d ): \u5728\u4e00\u4e2a\u516c\u5171\u76ee\u5f55\uff0c\u6bcf\u4e2a\u90fd\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\uff0c\u5220\u9664\u81ea\u5df1\u7684\u6587\u4ef6\uff0c\u4f46\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u6587\u4ef6\u3002 \u5f53\u2f6c\u5f55\u88ab\u8bbe\u7f6e\u4e86\u7c98\u6ede\u4f4d\u6743\u9650\u4ee5\u540e\uff0c\u5373\u4fbf\u2f64\u6237\u5bf9\u8be5\u2f6c\u5f55\u6709\u5199\u2f0a\u6743\u9650\uff0c\u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u2f6c\u5f55 \u4e2d\u5176\u4ed6\u2f64\u6237\u7684\u2f42\u4ef6\u6570\u636e\uff0c\u2f7d\u662f\u53ea\u6709\u8be5\u2f42\u4ef6\u7684\u6240\u6709\u8005\u548c root \u2f64\u6237\u624d\u6709\u6743\u5c06\u5176\u5220\u9664 \u683c\u5f0f\uff1a chmod o + t DIR \uff0c chmod o - t DIR \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3at \uff1b\u5426\u5219\u663e\u793a T \uff1b\u7c98\u6ede\u4f4d\u6743\u9650\u662f\u9488\u5bf9\u76ee\u5f55\u7684\uff0c\u5bf9\u6587\u4ef6\u65e0\u6548 4 . umask \uff1a \u6587\u4ef6\u9ed8\u8ba4\u6743\u9650\uff1a 666 - umask \u6587\u4ef6\u5939\u9ed8\u8ba4\u6743\u9650\uff1a 777 - umask \u7279\u6b8a\u6743\u9650\u9ed8\u8ba4\u4e3a 0 \u9ed8\u8ba4 umask \uff1a umask = 0022 \u66f4\u6539 umask \uff1a umask 0023 \u6ce8\u610f\uff1a\u6587\u4ef6\u9ed8\u8ba4\u4e0d\u80fd\u5177\u6709\u6267\u884c\u6743\u9650\uff0c\u5982\u679c\u7b97\u5f97\u7684\u7ed3\u679c\u4e2d\u6709\u6267\u884c\u6743\u9650\uff0c\u5219\u5c06\u6743\u9650\u52a0 1 \u7cfb\u7edf\u547d\u4ee4\u884c\u5feb\u6377\u952e \u00b6 # \u8bf4\u660e Ctrl \u2013 k # \u5148\u6309\u4f4f Ctrl \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e Alt \u2013 k # \u5148\u6309\u4f4f Alt \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e M \u2013 k # \u5148\u5355\u51fb Esc \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e # \u79fb\u52a8\u5149\u6807 Ctrl - \u5de6\u53f3\u952e # \u5728\u5355\u8bcd\u4e4b\u95f4\u8df3\u8f6c Ctrl \u2013 a # \u79fb\u5230\u884c\u9996 Ctrl \u2013 e # \u79fb\u5230\u884c\u5c3e Ctrl \u2013 b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 Ctrl \u2013 f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 Alt \u2013 b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd Alt \u2013 f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd Ctrl \u2013 xx # \u5728\u547d\u4ee4\u884c\u5c3e\u548c\u5149\u6807\u4e4b\u95f4\u79fb\u52a8 M - b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd M - f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd # \u7f16\u8f91\u547d\u4ee4 Ctrl \u2013 h # \u5220\u9664\u5149\u6807\u5de6\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26 Ctrl \u2013 d # \u5220\u9664\u5149\u6807\u53f3\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26\uff08\u6ce8\u610f\u5f53\u524d\u547d\u4ee4\u884c\u6ca1\u6709\u4efb\u4f55\u5b57\u7b26\u65f6\uff0c\u4f1a\u6ce8\u9500\u7cfb\u7edf\u6216\u7ed3\u675f\u7ec8\u7aef\uff09 Ctrl \u2013 w # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u5de6\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u9996\u5220 Alt \u2013 d # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u53f3\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u5c3e\u5220 M \u2013 d # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5355\u8bcd\uff0c\u76f4\u5230\u8be5\u5355\u8bcd\u7ed3\u675f Ctrl \u2013 k # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u53f3\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u7ed3\u675f Ctrl \u2013 u # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5de6\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u5f00\u59cb Ctrl \u2013 y # \u7c98\u8d34 Ctrl + u\u6216ctrl + k\u526a\u5207\u7684\u5185\u5bb9 ctrl \u2013 t # \u4ea4\u6362\u5149\u6807\u5904\u548c\u4e4b\u524d\u4e24\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e Alt + . # \u4f7f\u7528\u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570 Ctrl \u2013 _ # \u56de\u590d\u4e4b\u524d\u7684\u72b6\u6001\u3002\u64a4\u9500\u64cd\u4f5c Ctrl - a + Ctrl - k \u6216 Ctrl - e + Ctrl - u \u6216 Ctrl - k + Ctrl - u # \u7ec4\u5408\u53ef\u5220\u9664\u6574\u884c # \u63a7\u5236\u547d\u4ee4 Ctrl \u2013 l # \u6e05\u9664\u5c4f\u5e55\uff0c\u7136\u540e\uff0c\u5728\u6700\u4e0a\u9762\u91cd\u65b0\u663e\u793a\u76ee\u524d\u5149\u6807\u6240\u5728\u7684\u8fd9\u4e00\u884c\u7684\u5185\u5bb9 Ctrl \u2013 o # \u6267\u884c\u5f53\u524d\u547d\u4ee4\uff0c\u5e76\u9009\u62e9\u4e0a\u4e00\u6761\u547d\u4ee4 Ctrl \u2013 s # \u963b\u6b62\u5c4f\u5e55\u8f93\u51fa Ctrl \u2013 q # \u5141\u8bb8\u5c4f\u5e55\u8f93\u51fa Ctrl \u2013 c # \u7ec8\u6b62\u547d\u4ee4 Ctrl \u2013 z # \u6302\u8d77\u547d\u4ee4 # Bang ( ! ) \u547d\u4ee4 !! # \u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4 ^ foo ^ bar # \u628a\u4e0a\u4e00\u6761\u547d\u4ee4\u91cc\u7684 foo\u66ff\u6362\u4e3abar \uff0c\u5e76\u6267\u884c ! wget # \u6267\u884c\u6700\u8fd1\u7684\u4ee5 wget\u5f00\u5934\u7684\u547d\u4ee4 ! wget p # \u4ec5\u6253\u5370\u6700\u8fd1\u7684\u4ee5 wget\u5f00\u5934\u7684\u547d\u4ee4 \uff0c\u4e0d\u6267\u884c ! $ # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff0c \u4e0e Alt - . \u548c $ _ \u76f8\u540c !* # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6240\u6709\u53c2\u6570 !* p # \u6253\u5370\u4e0a\u4e00\u6761\u547d\u4ee4\u662f\u6240\u6709\u53c2\u6570\uff0c\u4e5f\u5373 !* \u7684\u5185\u5bb9 ^ abc # \u5220\u9664\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 abc ^ foo ^ bar # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar ^ foo ^ bar ^ # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar !- n # \u6267\u884c\u524d n\u6761\u547d\u4ee4 \uff0c\u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4 !- 1 \uff0c \u6267\u884c\u524d 5 \u6761\u547d\u4ee4\u7684\u683c\u5f0f\u662f !- 5 # \u67e5\u627e\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 p # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0a\u4e00\u6761\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 n # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0b\u4e00\u6761\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 r # \u641c\u7d22\u5386\u53f2\u547d\u4ee4\uff0c\u8f93\u5165\u540e\u663e\u793a\u5386\u53f2\u547d\u4ee4\u4e2d\u4e00\u6761\u5339\u914d\u547d\u4ee4\uff0c Enter\u952e\u6267\u884c\u5339\u914d\u547d\u4ee4 \uff1b ESC\u952e\u5728\u547d\u4ee4\u884c\u663e\u793a\u800c\u4e0d\u6267\u884c\u5339\u914d\u547d\u4ee4 Ctrl \u2013 g # \u4ece\u5386\u53f2\u641c\u7d22\u6a21\u5f0f\uff08 Ctrl \u2013 r \uff09\u9000\u51fa # \u91cd\u590d\u6267\u884c\u64cd\u4f5c\u52a8\u4f5c M \u2013 \u64cd\u4f5c\u6b21\u6570 \u64cd\u4f5c\u52a8\u4f5c # \u6307\u5b9a\u64cd\u4f5c\u6b21\u6570\uff0c\u91cd\u590d\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c Centos\u6e90\u8bbe\u7f6e \u00b6 # \u66f4\u6539yum\u6e90\u4e3a\u963f\u91cc\u4e91 # \u5907\u4efd mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup # \u4e0b\u8f7d\u65b0\u7684\u5bf9\u5e94\u7248\u672cCentOS-Base.repo \u5230/etc/yum.repos.d/ ## CentOS 5 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-5.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-5.repo ## CentOS 6 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo ## CentOS 7 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo # \u66f4\u6539yum\u6e90\u4e3a163 # \u5907\u4efd mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup # \u4e0b\u8f7d\u5bf9\u5e94\u7248\u672crepo\u6587\u4ef6, \u653e\u5165/etc/yum.repos.d/(\u64cd\u4f5c\u524d\u8bf7\u505a\u597d\u76f8\u5e94\u5907\u4efd) CentOS5 http://mirrors.163.com/.help/CentOS5-Base-163.repo CentOS6 http://mirrors.163.com/.help/CentOS6-Base-163.repo CentOS7 http://mirrors.163.com/.help/CentOS7-Base-163.repo yum clean all # \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6210\u7f13\u5b58 yum makecache fast # \u4e4b\u540e\u8fd0\u884cyum makecache\u751f\u6210\u7f13\u5b58 yum -y upgrade # \u53ea\u5347\u7ea7\u6240\u6709\u5305\uff0c\u4e0d\u5347\u7ea7\u8f6f\u4ef6\u548c\u7cfb\u7edf\u5185\u6838 yum -y update # \u5347\u7ea7\u6240\u6709\u5305\u540c\u65f6\u4e5f\u5347\u7ea7\u8f6f\u4ef6\u548c\u7cfb\u7edf\u5185\u6838 # \u5728\u7ebf\u5b89\u88c5epel\u6e90 rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm yum -y install epel-release ubuntu Desktop\u76f8\u5173\u8bbe\u7f6e \u00b6 xdotool mouseup 1 # \u6302\u8d77\u540e\u8fdb\u5165\u7cfb\u7edf\u8f93\u5165,\u7136\u540e\u6ce8\u9500\u91cd\u65b0\u767b\u5f55 gsettings set com.canonical.unity.launcher launcher-position bottom # \u5c06ubuntu\u542f\u52a8\u680f\u79fb\u52a8\u5230\u6700\u4e0b\u65b9 gsettings get com.canonical.unity.launcher launcher-position # \u5f97\u5230\u542f\u52a8\u680f\u4f4d\u7f6e # \u8bbe\u7f6e\u4e34\u65f6\u6587\u4ef6\u4e0d\u518d\u653e\u7f6e\u5728\u786c\u76d8\u52a0\u5feb\u901f\u5ea6\uff0c\u800c\u653e\u5728\u865a\u62dfRAM\u78c1\u76d8\u4e0a\u3002\u603b\u5185\u5b58\u5fc5\u987b\u5927\u4e8e4G cp -v /usr/share/systemd/tmp.mount /etc/systemd/system/ systemctl enable tmp.mount systemctl reload tmp.mount # \u4e0d\u751f\u6548\u53ef\u91cd\u542f\u8ba1\u7b97\u673a\u3002systemctl status tmp.mount\u68c0\u67e5\u72b6\u6001 # \u53d6\u6d88tmpfs,\u5220\u9664\u540e\u91cd\u542f\u751f\u6548 rm -v /etc/systemd/system/tmp.mount : << comment # \u51cf\u5c11\u6587\u4ef6\u5199\u5165(\u5f53\u7528\u4e8e\u975e\u670d\u52a1\u5668\u65f6)\u5728/etc/fstab\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a tmpfs /tmp tmpfs defaults 0 0 tmpfs /var/tmp tmpfs defaults 0 0 tmpfs /var/log tmpfs defaults 0 0 comment # \u81ea\u5b9a\u4e49terminal\u4f4d\u7f6e\u548c\u5927\u5c0f cp /usr/share/applications/gnome-terminal.desktop ~/.local/share/applications sed -i 's/^Exec=gnome-terminal$/& --geometry=80x24+100+100/' ~/.local/share/applications/gnome-terminal.desktop gsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal --geometry=80x24+100+100' # \u5220\u9664\u81ea\u5b9a\u4e49 rm ~/.local/share/applications/gnome-terminal.desktop gsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal' BASH\u73af\u5883\u53d8\u91cf\u7684\u8bbe\u7f6e\u65b9\u6cd5\uff1a \u00b6 # \u65b9\u6cd5\u4e00\uff1a\u4fee\u6539\u7528\u6237\u4e3b\u76ee\u5f55\u4e0b\u7684.profile\u6216.bashrc\u6587\u4ef6(\u63a8\u8350)\uff0c\u5728\u6587\u4ef6\u672b\u5c3e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u53ea\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548 export PATH = \" $PATH :your path1:your path2\" # \u65b9\u6cd5\u4e8c\uff1a\u4fee\u6539\u7f16\u8f91\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684profile\u6587\u4ef6(\u8c28\u614e)\uff1a\u5728\u6700\u540e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u5bf9\u6240\u6709\u7684\u7528\u6237\u90fd\u6709\u6548 export PATH = \" $PATH :your path1:your path2\" # \u65b9\u6cd5\u4e09\uff1a\u4fee\u6539\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684 environment \u6587\u4ef6\u7684PATH\u53d8\u91cf(\u8c28\u614e),\u5404\u4e2apath\u4e4b\u95f4\u5192\u53f7\u5206\u5272\uff0c\u5f71\u54cd\u6240\u6709\u7528\u6237 # \u65b9\u6cd5\u56db\uff1a\u76f4\u63a5\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165,\u8fd9\u79cd\u65b9\u5f0f\u53d8\u91cf\u7acb\u5373\u751f\u6548\uff0c\u4f46\u7528\u6237\u6ce8\u9500\u6216\u7cfb\u7edf\u91cd\u542f\u540e\u8bbe\u7f6e\u53d8\u6210\u65e0\u6548\uff0c\u9002\u5408\u4e34\u65f6\u53d8\u91cf\u7684\u8bbe\u7f6e export PATH = \" $PATH :your path1:your path2\" # \u4fdd\u5b58\u540e\u6267\u884csource\u547d\u4ee4\u751f\u6548 Linux\u5b89\u88c5\u8bbe\u7f6ejava\u73af\u5883 \u00b6 # \u5728 CentOS7\u5b89\u88c5Oracle Java JDK8 rpm - qa | grep - E '^open[jre|jdk]|j[re|dk]' # \u67e5\u627e\u5df2\u5b89\u88c5\u7684 jdk\u7ec4\u4ef6 yum remove java - $ Version # \u5378\u8f7d\u4e4b\u524d\u5df2\u5b89\u88c5\u7684 jdk # \u5728 / usr\u76ee\u5f55\u521b\u5efajava\u6587\u4ef6\u5939 \uff0c\u4e0b\u8f7d jdk\u5305http : // www . oracle . com / technetwork / java / javase / downloads / index . html mkdir / usr / java wget http : // download . oracle . com / otn - pub / java / jdk / 8 u161 - b12 / ... tar . gz tar - zxvf jdk .. # \u7f16\u8f91 . bashrc\u6587\u4ef6 \uff0c\u5728 export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL\u4e0b\u9762\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801 \uff1a export JAVA_HOME =/ usr / java / jdk - $ version export PATH = $ JAVA_HOME / bin : $ PATH export CLASSPATH = .: $ JAVA_HOME / lib / dt . jar : $ JAVA_HOME / lib / tools . jar # \u914d\u7f6e\u751f\u6548\u5e76\u9a8c\u8bc1 source . bashrc && java --version SSH\u76f8\u5173\u547d\u4ee4\u548c\u914d\u7f6e \u00b6 ssh\u57fa\u672c\u52a0\u56fa\u5efa\u8bae \u00b6 \u4f7f\u7528\u975e\u5bc6\u7801\u767b\u9646\u65b9\u5f0f\u5982\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5ffd\u7565\u6b64\u9879\u3002\u5728 / etc / login . defs \u4e2d\u5c06 PASS_MAX_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a 60 - 180 \u4e4b\u95f4\uff0c \u5982 PASS_MAX_DAYS 90 \u3002\u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4\u8bbe\u7f6e root\u5bc6\u7801\u5931\u6548\u65f6\u95f4 \uff1a chage --maxdays 90 root \u5728 / etc / login . defs \u4e2d\u5c06 PASS_MIN_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a 7 - 14 \u4e4b\u95f4 , \u5efa\u8bae\u4e3a 7 \uff1a PASS_MIN_DAYS 7 \u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4 \u4e3a root\u7528\u6237\u8bbe\u7f6e \uff1a chage --mindays 7 root \u7f16\u8f91 / etc / security / pwquality . conf \uff0c\u628a minlen \uff08\u5bc6\u7801\u6700\u5c0f\u957f\u5ea6\uff09\u8bbe\u7f6e\u4e3a 9 - 32 \u4f4d\uff0c\u628a minclass \uff08\u81f3\u5c11\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u3001 \u5927\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7279\u6b8a\u5b57\u7b26\u7b49 4 \u7c7b\u5b57\u7b26\u4e2d\u7b49 3 \u7c7b\u6216 4 \u7c7b\uff09\u8bbe\u7f6e\u4e3a 3 \u6216 4 \u3002\u5982\uff1a minlen = 10 minclass = 3 sed\u547d\u4ee4\u66f4\u6539\u9ed8\u8ba4ssh\u8fde\u63a5\u7aef\u53e3 \u00b6 iptables -I INPUT -p tcp --dport 22 -j ACCEPT # iptables\u5f00\u653e22\u7aef\u53e3 sed -i \"/A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT/d\" /etc/sysconfig/iptables iptables save service iptables restart sed -i 's/#Port 22/Port 2121/' /etc/ssh/sshd_config # \u4fee\u6539sshd_config\u6587\u4ef6\uff0c\u5c06#Port 22\u76f4\u63a5\u66ff\u6362\u6210Port 2121 sshd_config\u914d\u7f6e\u8be6\u89e3\uff08/etc/ssh/sshd_config\uff09 \u00b6 # The strategy used for options in the default sshd_config shipped with # OpenSSH is to specify options with their default value where # possible , but leave them commented . Uncommented options override the # default value # # AddressFamily \u6307\u5b9a sshd \u5e94\u5f53\u4f7f\u7528\u54ea\u79cd\u5730\u5740\u65cf\u3002\u53d6\u503c\u8303\u56f4\u662f\uff1a \" any \" ( \u9ed8\u8ba4 ) \u3001 \" inet \" ( \u4ec5 IPv4 ) \u3001 \" inet6 \" ( \u4ec5 IPv6 ) # AddressFamily any # \u6307\u5b9a sshd \u76d1\u542c\u7684\u7f51\u7edc\u5730\u5740\uff0c\u9ed8\u8ba4\u76d1\u542c\u6240\u6709\u5730\u5740\u3002\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u683c\u5f0f\uff1a # ListenAddress host | IPv4_addr | IPv6_addr # ListenAddress host | IPv4_addr : port # ListenAddress [ host | IPv6_addr ]: port # \u5982\u679c\u672a\u6307\u5b9a port \uff0c\u90a3\u4e48\u5c06\u4f7f\u7528 Port \u6307\u4ee4\u7684\u503c # \u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a ListenAddress \u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u5730\u5740 # ListenAddress 0 . 0 . 0 . 0 # ListenAddress :: # HostKey # \u4e3b\u673a\u79c1\u94a5\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u6743\u9650\u4e0d\u5bf9\uff0c sshd \u53ef\u80fd\u4f1a\u62d2\u7edd\u542f\u52a8 # SSH - 1 \u9ed8\u8ba4\u662f / etc / ssh / ssh_host_key # SSH - 2 \u9ed8\u8ba4\u662f / etc / ssh / ssh_host_rsa_key \u548c / etc / ssh / ssh_host_dsa_key # \u4e00\u53f0\u4e3b\u673a\u53ef\u4ee5\u62e5\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u79c1\u94a5\u3002 \" rsa1 \" \u4ec5\u7528\u4e8e SSH - 1 \uff0c \" dsa \" \u548c \" rsa \" \u4ec5\u7528\u4e8e SSH - 2 # HostKey / etc / ssh / ssh_host_rsa_key # HostKey / etc / ssh / ssh_host_ecdsa_key # HostKey / etc / ssh / ssh_host_ed25519_key # \u6307\u5b9a SSH - 2 \u5141\u8bb8\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002\u591a\u4e2a\u7b97\u6cd5\u4e4b\u95f4\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u53ef\u4ee5\u4f7f\u7528\u7684\u7b97\u6cd5\u5982\u4e0b\uff1a # \" aes128-cbc \" , \" aes192-cbc \" , \" aes256-cbc \" , \" aes128-ctr \" , \" aes192-ctr \" , \" aes256-ctr \" , # \" 3des-cbc \" , \" arcfour128 \" , \" arcfour256 \" , \" arcfour \" , \" blowfish-cbc \" , \" cast128-cbc \" # \u9ed8\u8ba4\u503c\u662f\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u6240\u6709\u7b97\u6cd5 # Ciphers and keying # RekeyLimit default none # \u6307\u5b9a sshd \u5c06\u65e5\u5fd7\u6d88\u606f\u901a\u8fc7\u54ea\u4e2a\u65e5\u5fd7\u5b50\u7cfb\u7edf ( facility ) \u53d1\u9001\u3002\u6709\u6548\u503c\u662f\uff1a DAEMON , USER , AUTH ( \u9ed8\u8ba4 ) , LOCAL0 , LOCAL1 , LOCAL2 , LOCAL3 , # LOCAL4 , LOCAL5 , LOCAL6 , LOCAL7 # Logging # SyslogFacility AUTH # \u6307\u5b9a sshd ( 8 ) \u7684\u65e5\u5fd7\u7b49\u7ea7 ( \u8be6\u7ec6\u7a0b\u5ea6 ) \u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # QUIET , FATAL , ERROR , INFO ( \u9ed8\u8ba4 ) , VERBOSE , DEBUG , DEBUG1 , DEBUG2 , DEBUG3 # DEBUG \u4e0e DEBUG1 \u7b49\u4ef7\uff1b DEBUG2 \u548c DEBUG3 \u5219\u5206\u522b\u6307\u5b9a\u4e86\u66f4\u8be6\u7ec6\u3001\u66f4\u7f57\u55e6\u7684\u65e5\u5fd7\u8f93\u51fa # \u6bd4 DEBUG \u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\u53ef\u80fd\u4f1a\u6cc4\u6f0f\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f\uff0c\u56e0\u6b64\u53cd\u5bf9\u4f7f\u7528 # LogLevel INFO # Authentication : # \u9650\u5236\u7528\u6237\u5fc5\u987b\u5728\u6307\u5b9a\u7684\u65f6\u9650\u5185\u8ba4\u8bc1\u6210\u529f\uff0c 0 \u8868\u793a\u65e0\u9650\u5236\u3002\u9ed8\u8ba4\u503c\u662f 120 \u79d2 # LoginGraceTime 2 m # \u662f\u5426\u5141\u8bb8 root \u767b\u5f55\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # \" yes \" ( \u9ed8\u8ba4 ) \u8868\u793a\u5141\u8bb8\u3002 \" no \" \u8868\u793a\u7981\u6b62 # \" without-password \" \u8868\u793a\u7981\u6b62\u4f7f\u7528\u5bc6\u7801\u8ba4\u8bc1\u767b\u5f55 # \" forced-commands-only \" \u8868\u793a\u53ea\u6709\u5728\u6307\u5b9a\u4e86 command \u9009\u9879\u65f6\u624d\u5141\u8bb8\u4f7f\u7528\u516c\u94a5\u8ba4\u8bc1\u767b\u5f55\u3002\u540c\u65f6\u5176\u5b83\u8ba4\u8bc1\u65b9\u6cd5\u5168\u90e8\u88ab\u7981\u6b62\u3002\u8be5\u503c\u5e38\u7528\u4e8e\u505a\u8fdc\u7a0b\u5907\u4efd\u4e4b\u7c7b\u7684\u4e8b\u60c5 # PermitRootLogin prohibit - password # \u6307\u5b9a\u662f\u5426\u8981\u6c42 sshd \u5728\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u524d\u5bf9\u7528\u6237\u4e3b\u76ee\u5f55\u548c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u5bbf\u4e3b\u548c\u6743\u9650\u68c0\u67e5\u3002\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c \" yes \" \u6765\u9884\u9632\u53ef\u80fd\u51fa\u73b0\u7684\u4f4e\u7ea7\u9519\u8bef # StrictModes yes # \u6307\u5b9a\u6bcf\u4e2a\u8fde\u63a5\u6700\u5927\u5141\u8bb8\u7684\u8ba4\u8bc1\u6b21\u6570\u3002\u9ed8\u8ba4\u503c\u662f 6 # \u5982\u679c\u5931\u8d25\u8ba4\u8bc1\u7684\u6b21\u6570\u8d85\u8fc7\u8fd9\u4e2a\u6570\u503c\u7684\u4e00\u534a\uff0c\u8fde\u63a5\u5c06\u88ab\u5f3a\u5236\u65ad\u5f00\uff0c\u4e14\u4f1a\u751f\u6210\u989d\u5916\u7684\u5931\u8d25\u65e5\u5fd7\u6d88\u606f # MaxAuthTries 6 # MaxSessions 10 # \u662f\u5426\u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\u3002\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u3002\u9ed8\u8ba4\u503c\u4e3a \" yes \" # PubkeyAuthentication yes ###################################################################################################################### # \u5b58\u653e\u8be5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u767b\u5f55\u7684 RSA / DSA \u516c\u94a5 # \u8be5\u6307\u4ee4\u4e2d\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u6839\u636e\u8fde\u63a5\u65f6\u7684\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u5c55\u5f00\u7684\u7b26\u53f7\uff1a # %% \u8868\u793a ' % ' \u3001 % h \u8868\u793a\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3001 % u \u8868\u793a\u8be5\u7528\u6237\u7684\u7528\u6237\u540d # \u7ecf\u8fc7\u6269\u5c55\u4e4b\u540e\u7684\u503c\u5fc5\u987b\u8981\u4e48\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u8981\u4e48\u662f\u76f8\u5bf9\u4e8e\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84 # \u9ed8\u8ba4\u503c\u662f \" .ssh/authorized_keys \" # Expect . ssh / authorized_keys2 to be disregarded by default in future # AuthorizedKeysFile . ssh / authorized_keys . ssh / authorized_keys2 ###################################################################################################################### # AuthorizedPrincipalsFile none # AuthorizedKeysCommand none # AuthorizedKeysCommandUser nobody # \u662f\u5426\u4f7f\u7528\u5f3a\u53ef\u4fe1\u4e3b\u673a\u8ba4\u8bc1 ( \u901a\u8fc7\u68c0\u67e5\u8fdc\u7a0b\u4e3b\u673a\u540d\u548c\u5173\u8054\u7684\u7528\u6237\u540d\u8fdb\u884c\u8ba4\u8bc1 ) \u3002\u4ec5\u7528\u4e8e SSH - 1 # \u8fd9\u662f\u901a\u8fc7\u5728 RSA \u8ba4\u8bc1\u6210\u529f\u540e\u518d\u68c0\u67e5 ~/ . rhosts \u6216 / etc / hosts . equiv \u8fdb\u884c\u8ba4\u8bc1\u7684 # \u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" # RhostsRSAAuthentication # \u8fd9\u4e2a\u6307\u4ee4\u4e0e RhostsRSAAuthentication \u7c7b\u4f3c\uff0c\u4f46\u662f\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u3002\u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" # \u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" \u7981\u6b62\u8fd9\u79cd\u4e0d\u5b89\u5168\u7684\u8ba4\u8bc1\u65b9\u5f0f # For this to work you will also need host keys in / etc / ssh / ssh_known_hosts # HostbasedAuthentication no # HostbasedUsesNameFromPacketOnly # \u5728\u5f00\u542f HostbasedAuthentication \u7684\u60c5\u51b5\u4e0b\uff0c # \u6307\u5b9a\u670d\u52a1\u5668\u5728\u4f7f\u7528 ~/ . shosts ~/ . rhosts / etc / hosts . equiv \u8fdb\u884c\u8fdc\u7a0b\u4e3b\u673a\u540d\u5339\u914d\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u53cd\u5411\u57df\u540d\u67e5\u8be2 # \" yes \" \u8868\u793a sshd \u4fe1\u4efb\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4e3b\u673a\u540d\u800c\u4e0d\u8fdb\u884c\u53cd\u5411\u67e5\u8be2\u3002\u9ed8\u8ba4\u503c\u662f \" no \" # \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565\u7528\u6237\u7684 ~/ . ssh / known_hosts \u6587\u4ef6 # \u9ed8\u8ba4\u503c\u662f \" no \" \u3002\u4e3a\u4e86\u63d0\u9ad8\u5b89\u5168\u6027\uff0c\u53ef\u4ee5\u8bbe\u4e3a \" yes \" # Change to yes if you don ' t trust ~/.ssh/known_hosts for # HostbasedAuthentication # IgnoreUserKnownHosts no # \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565 . rhosts \u548c . shosts \u6587\u4ef6 # \u4e0d\u8fc7 / etc / hosts . equiv \u548c / etc / shosts . equiv \u4ecd\u5c06\u88ab\u4f7f\u7528\u3002\u63a8\u8350\u8bbe\u4e3a\u9ed8\u8ba4\u503c \" yes \" # Don ' t read the user ' s ~/ . rhosts and ~/ . shosts files # IgnoreRhosts yes # To disable tunneled clear text passwords , change to no here ! # \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e\u5bc6\u7801\u7684\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u4e3a \" yes \" # PasswordAuthentication yes # \u662f\u5426\u5141\u8bb8\u5bc6\u7801\u4e3a\u7a7a\u7684\u7528\u6237\u8fdc\u7a0b\u767b\u5f55\u3002\u9ed8\u8ba4\u4e3a \" no \" # PermitEmptyPasswords no # \u662f\u5426\u5141\u8bb8\u8d28\u7591 - \u5e94\u7b54 ( challenge - response ) \u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # \u6240\u6709 login . conf ( 5 ) \u4e2d\u5141\u8bb8\u7684\u8ba4\u8bc1\u65b9\u5f0f\u90fd\u88ab\u652f\u6301 # Change to yes to enable challenge - response passwords ( beware issues with # some PAM modules and threads ) ChallengeResponseAuthentication no # Kerberos options # \u662f\u5426\u8981\u6c42\u7528\u6237\u4e3a PasswordAuthentication \u63d0\u4f9b\u7684\u5bc6\u7801\u5fc5\u987b\u901a\u8fc7 Kerberos KDC \u8ba4\u8bc1\uff0c\u4e5f\u5c31\u662f\u662f\u5426\u4f7f\u7528 Kerberos \u8ba4\u8bc1 # \u8981\u4f7f\u7528 Kerberos \u8ba4\u8bc1\uff0c\u670d\u52a1\u5668\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u6821\u9a8c KDC identity \u7684 Kerberos servtab \u3002\u9ed8\u8ba4\u503c\u662f \" no \" # KerberosAuthentication no # \u5982\u679c Kerberos \u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25\uff0c\u90a3\u4e48\u8be5\u5bc6\u7801\u8fd8\u5c06\u8981\u901a\u8fc7\u5176\u5b83\u7684\u8ba4\u8bc1\u673a\u5236 ( \u6bd4\u5982 / etc / passwd ) # \u9ed8\u8ba4\u503c\u4e3a \" yes \" # KerberosOrLocalPasswd yes # \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u7684 ticket \u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # KerberosTicketCleanup yes # \u5982\u679c\u4f7f\u7528\u4e86 AFS \u5e76\u4e14\u8be5\u7528\u6237\u6709\u4e00\u4e2a Kerberos 5 TGT \uff0c\u90a3\u4e48\u5f00\u542f\u8be5\u6307\u4ee4\u540e\uff0c # \u5c06\u4f1a\u5728\u8bbf\u95ee\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u524d\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a AFS token \u3002\u9ed8\u8ba4\u4e3a \" no \" # KerberosGetAFSToken no # GSSAPI options # \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e GSSAPI \u7684\u7528\u6237\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u4e3a \" no \" \u3002\u4ec5\u7528\u4e8e SSH - 2 # GSSAPIAuthentication no # \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u51ed\u8bc1\u7f13\u5b58\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" \u3002\u4ec5\u7528\u4e8e SSH - 2 # GSSAPICleanupCredentials yes # GSSAPIStrictAcceptorCheck yes # GSSAPIKeyExchange no # Set this to ' yes ' to enable PAM authentication , account processing , # and session processing . If this is enabled , PAM authentication will # be allowed through the ChallengeResponseAuthentication and # PasswordAuthentication . Depending on your PAM configuration , # PAM authentication via ChallengeResponseAuthentication may bypass # the setting of \" PermitRootLogin without-password \" # If you just want the PAM account and session checks to run without # PAM authentication , then enable this but set PasswordAuthentication # and ChallengeResponseAuthentication to ' no ' UsePAM yes # AllowAgentForwarding yes # \u662f\u5426\u5141\u8bb8 TCP \u8f6c\u53d1\uff0c\u9ed8\u8ba4\u503c\u4e3a \" yes \" # \u7981\u6b62 TCP \u8f6c\u53d1\u5e76\u4e0d\u80fd\u589e\u5f3a\u5b89\u5168\u6027\uff0c\u9664\u975e\u7981\u6b62\u4e86\u7528\u6237\u5bf9 shell \u7684\u8bbf\u95ee\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668 # AllowTcpForwarding yes ###################################################################################################################### # GatewayPorts # \u662f\u5426\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u672c\u5730\u7684\u8f6c\u53d1\u7aef\u53e3\u3002\u9ed8\u8ba4\u503c\u662f \" no \" # sshd ( 8 ) \u9ed8\u8ba4\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230 loopback \u5730\u5740\u3002\u8fd9\u6837\u5c06\u963b\u6b62\u5176\u5b83\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230\u8f6c\u53d1\u7aef\u53e3 # GatewayPorts \u6307\u4ee4\u53ef\u4ee5\u8ba9 sshd \u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u975e loopback \u5730\u5740\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u4e86 # \" no \" \u8868\u793a\u4ec5\u5141\u8bb8\u672c\u5730\u8fde\u63a5\uff0c \" yes \" \u8868\u793a\u5f3a\u5236\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u7edf\u914d\u5730\u5740 ( wildcard address ) \uff0c # \" clientspecified \" \u8868\u793a\u5141\u8bb8\u5ba2\u6237\u7aef\u9009\u62e9\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u54ea\u4e2a\u5730\u5740 # GatewayPorts no ###################################################################################################################### # \u662f\u5426\u5141\u8bb8\u8fdb\u884c X11 \u8f6c\u53d1\u3002\u9ed8\u8ba4\u503c\u662f \" no \" \uff0c\u8bbe\u4e3a \" yes \" \u8868\u793a\u5141\u8bb8 # \u5982\u679c\u5141\u8bb8 X11 \u8f6c\u53d1\u5e76\u4e14 sshd ( 8 ) \u4ee3\u7406\u7684\u663e\u793a\u533a\u88ab\u914d\u7f6e\u4e3a\u5728\u542b\u6709\u901a\u914d\u7b26\u7684\u5730\u5740 ( X11UseLocalhost ) \u4e0a\u76d1\u542c # \u90a3\u4e48\u5c06\u53ef\u80fd\u6709\u989d\u5916\u7684\u4fe1\u606f\u88ab\u6cc4\u6f0f\u3002\u7531\u4e8e\u4f7f\u7528 X11 \u8f6c\u53d1\u7684\u53ef\u80fd\u5e26\u6765\u7684\u98ce\u9669\uff0c\u6b64\u6307\u4ee4\u9ed8\u8ba4\u503c\u4e3a \" no \" # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7981\u6b62 X11 \u8f6c\u53d1\u5e76\u4e0d\u80fd\u7981\u6b62\u7528\u6237\u8f6c\u53d1 X11 \u901a\u4fe1\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668 # \u5982\u679c\u542f\u7528\u4e86 UseLogin \uff0c\u90a3\u4e48 X11 \u8f6c\u53d1\u5c06\u88ab\u81ea\u52a8\u7981\u6b62 X11Forwarding yes # \u6307\u5b9a sshdX11 \u8f6c\u53d1\u7684\u7b2c\u4e00\u4e2a\u53ef\u7528\u7684\u663e\u793a\u533a ( display ) \u6570\u5b57\u3002\u9ed8\u8ba4\u503c\u662f 10 # \u8fd9\u4e2a\u53ef\u4ee5\u7528\u4e8e\u9632\u6b62 sshd \u5360\u7528\u4e86\u771f\u5b9e\u7684 X11 \u670d\u52a1\u5668\u663e\u793a\u533a\uff0c\u4ece\u800c\u53d1\u751f\u6df7\u6dc6 # X11DisplayOffset 10 # sshd \u662f\u5426\u5e94\u5f53\u5c06 X11 \u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730 loopback \u5730\u5740\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # sshd \u9ed8\u8ba4\u5c06\u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730 loopback \u5730\u5740\u5e76\u5c06 DISPLAY \u73af\u5883\u53d8\u91cf\u7684\u4e3b\u673a\u540d\u90e8\u5206\u8bbe\u4e3a \" localhost \" # \u8fd9\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230 proxy display \u3002\u4e0d\u8fc7\u67d0\u4e9b\u8001\u65e7\u7684 X11 \u5ba2\u6237\u7aef\u4e0d\u80fd\u5728\u6b64\u914d\u7f6e\u4e0b\u6b63\u5e38\u5de5\u4f5c # \u4e3a\u4e86\u517c\u5bb9\u8fd9\u4e9b\u8001\u65e7\u7684 X11 \u5ba2\u6237\u7aef\uff0c\u4f60\u53ef\u4ee5\u8bbe\u4e3a \" no \" # X11UseLocalhost yes # PermitTTY yes # \u6307\u5b9a sshd \u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370 / etc / motd \u6587\u4ef6\u7684\u5185\u5bb9\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" PrintMotd no # \u6307\u5b9a sshd \u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370\u6700\u540e\u4e00\u4f4d\u7528\u6237\u7684\u767b\u5f55\u65f6\u95f4\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # PrintLastLog yes # \u6307\u5b9a\u7cfb\u7edf\u662f\u5426\u5411\u5ba2\u6237\u7aef\u53d1\u9001 TCPkeepalive \u6d88\u606f\u3002\u9ed8\u8ba4 \" yes \" \u3002\u6d88\u606f\u53ef\u4ee5\u68c0\u6d4b\u5230\u6b7b\u8fde\u63a5\u3001\u8fde\u63a5\u4e0d\u5f53\u5173\u95ed\u3001\u5ba2\u6237\u7aef\u5d29\u6e83\u7b49\u5f02\u5e38\u3002\u53ef\u4ee5\u8bbe\u4e3a \" no \" \u5173\u95ed\u8fd9\u4e2a\u7279\u6027 # TCPKeepAlive yes # \u662f\u5426\u5728\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\u7684\u767b\u5f55\u8fc7\u7a0b\u4e2d\u4f7f\u7528 login ( 1 ) \u3002\u9ed8\u8ba4\u503c\u662f \" no \" # \u5982\u679c\u5f00\u542f\u6b64\u6307\u4ee4\uff0c\u90a3\u4e48 X11Forwarding \u5c06\u4f1a\u88ab\u7981\u6b62\uff0c\u56e0\u4e3a login ( 1 ) \u4e0d\u77e5\u9053\u5982\u4f55\u5904\u7406 xauth ( 1 ) cookies # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c login ( 1 ) \u662f\u7981\u6b62\u7528\u4e8e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u7684 # \u5982\u679c\u6307\u5b9a\u4e86 UsePrivilegeSeparation \uff0c\u90a3\u4e48\u5b83\u5c06\u5728\u8ba4\u8bc1\u5b8c\u6210\u540e\u88ab\u7981\u7528 # UseLogin no # \u662f\u5426\u8ba9 sshd \u901a\u8fc7\u521b\u5efa\u975e\u7279\u6743\u5b50\u8fdb\u7a0b\u5904\u7406\u63a5\u5165\u8bf7\u6c42\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u6743\u9650\u5206\u79bb\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # \u8ba4\u8bc1\u6210\u529f\u540e\uff0c\u5c06\u4ee5\u8be5\u8ba4\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u521b\u5efa\u53e6\u4e00\u4e2a\u5b50\u8fdb\u7a0b,\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u901a\u8fc7\u6709\u7f3a\u9677\u7684\u5b50\u8fdb\u7a0b\u63d0\u5347\u6743\u9650\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u66f4\u52a0\u5b89\u5168 # UsePrivilegeSeparation sandbox # \u6307\u5b9a\u662f\u5426\u5141\u8bb8 sshd ( 8 ) \u5904\u7406 ~/ . ssh / environment \u4ee5\u53ca ~/ . ssh / authorized_keys \u4e2d\u7684 environment = \u9009\u9879 # \u9ed8\u8ba4\u503c\u662f \" no \" \u3002\u5982\u679c\u8bbe\u4e3a \" yes \" \u53ef\u80fd\u4f1a\u5bfc\u81f4\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u67d0\u4e9b\u673a\u5236 ( \u6bd4\u5982 LD_PRELOAD ) \u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\uff0c\u9020\u6210\u5b89\u5168\u6f0f\u6d1e # PermitUserEnvironment no # \u662f\u5426\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u8fd8\u662f\u5ef6\u8fdf\u5230\u8ba4\u8bc1\u6210\u529f\u4e4b\u540e\u518d\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29 # \u53ef\u7528\u503c\uff1a \" yes \" , \" delayed \" ( \u9ed8\u8ba4 ) , \" no \" # Compression delayed ###################################################################################################################### # \u8bbe\u7f6e\u4e00\u4e2a\u4ee5\u79d2\u8bb0\u7684\u65f6\u957f\uff0c\u5982\u679c\u8d85\u8fc7\u8fd9\u4e48\u957f\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u6570\u636e\uff0c # sshd ( 8 ) \u5c06\u901a\u8fc7\u5b89\u5168\u901a\u9053\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a \" alive \" \u6d88\u606f\uff0c\u5e76\u7b49\u5019\u5e94\u7b54 # \u9ed8\u8ba4\u503c 0 \u8868\u793a\u4e0d\u53d1\u9001 \" alive \" \u6d88\u606f\u3002\u8fd9\u4e2a\u9009\u9879\u4ec5\u5bf9 SSH - 2 \u6709\u6548 # ClientAliveInterval 0 ###################################################################################################################### # sshd \u5728\u672a\u6536\u5230\u4efb\u4f55\u5ba2\u6237\u7aef\u56de\u5e94\u524d\u6700\u591a\u5141\u8bb8\u53d1\u9001\u591a\u5c11\u4e2a \" alive \" \u6d88\u606f\u3002\u9ed8\u8ba4\u503c\u662f 3 # \u5230\u8fbe\u8fd9\u4e2a\u4e0a\u9650\u540e\uff0c sshd ( 8 ) \u5c06\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3001\u5173\u95ed\u4f1a\u8bdd # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \" alive \" \u6d88\u606f\u4e0e TCPKeepAlive \u6709\u5f88\u5927\u5dee\u5f02 # \" alive \" \u6d88\u606f\u662f\u901a\u8fc7\u52a0\u5bc6\u8fde\u63a5\u53d1\u9001\u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u88ab\u6b3a\u9a97\uff1b\u800c TCPKeepAlive \u5374\u662f\u53ef\u4ee5\u88ab\u6b3a\u9a97\u7684 # \u5982\u679c ClientAliveInterval \u88ab\u8bbe\u4e3a 15 \u5e76\u4e14\u5c06 ClientAliveCountMax \u4fdd\u6301\u4e3a\u9ed8\u8ba4\u503c\uff0c # \u90a3\u4e48\u65e0\u5e94\u7b54\u7684\u5ba2\u6237\u7aef\u5927\u7ea6\u4f1a\u5728 45 \u79d2\u540e\u88ab\u5f3a\u5236\u65ad\u5f00\u3002\u8fd9\u4e2a\u6307\u4ee4\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u534f\u8bae # ClientAliveCountMax 3 ###################################################################################################################### # \u6307\u5b9a sshd \u662f\u5426\u5e94\u8be5\u5bf9\u8fdc\u7a0b\u4e3b\u673a\u540d\u8fdb\u884c\u53cd\u5411\u89e3\u6790\uff0c\u4ee5\u68c0\u67e5\u6b64\u4e3b\u673a\u540d\u662f\u5426\u4e0e\u5176 IP \u5730\u5740\u771f\u5b9e\u5bf9\u5e94\u3002\u9ed8\u8ba4\u503c\u4e3a \" yes \" # UseDNS no # \u6307\u5b9a\u5728\u54ea\u4e2a\u6587\u4ef6\u4e2d\u5b58\u653e SSH \u5b88\u62a4\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\uff0c\u9ed8\u8ba4\u4e3a / var / run / sshd . pid \u6587\u4ef6 # PidFile / var / run / sshd . pid # \u6700\u5927\u5141\u8bb8\u4fdd\u6301\u591a\u5c11\u4e2a\u672a\u8ba4\u8bc1\u7684\u8fde\u63a5\u3002\u9ed8\u8ba4\u503c\u662f 10 # \u5230\u8fbe\u9650\u5236\u540e\uff0c\u5c06\u4e0d\u518d\u63a5\u53d7\u65b0\u8fde\u63a5\uff0c\u9664\u975e\u5148\u524d\u7684\u8fde\u63a5\u8ba4\u8bc1\u6210\u529f\u6216\u8d85\u51fa LoginGraceTime \u7684\u9650\u5236 # MaxStartups 10 : 30 : 100 # \u662f\u5426\u5141\u8bb8 tun ( 4 ) \u8bbe\u5907\u8f6c\u53d1\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # \" yes \" , \" point-to-point \" ( layer 3 ) , \" ethernet \" ( layer 2 ) , \" no \" ( \u9ed8\u8ba4 ) # \" yes \" \u540c\u65f6\u8574\u542b\u7740 \" point-to-point \" \u548c \" ethernet \" # PermitTunnel no # ChrootDirectory none # VersionAddendum none # \u8fd9\u4e2a\u7279\u6027\u4ec5\u80fd\u7528\u4e8e SSH - 2 \uff0c\u9ed8\u8ba4\u4ec0\u4e48\u5185\u5bb9\u4e5f\u4e0d\u663e\u793a\u3002 \" none \" \u8868\u793a\u7981\u7528\u8fd9\u4e2a\u7279\u6027 # no default banner path # Banner none ###################################################################################################################### # AcceptEnv # \u6307\u5b9a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u54ea\u4e9b\u73af\u5883\u53d8\u91cf\u5c06\u4f1a\u88ab\u4f20\u9012\u5230\u4f1a\u8bdd\u73af\u5883\u4e2d\u3002[\u6ce8\u610f]\u53ea\u6709 SSH - 2 \u534f\u8bae\u652f\u6301\u73af\u5883\u53d8\u91cf\u7684\u4f20\u9012 # \u7ec6\u8282\u53ef\u4ee5\u53c2\u8003 / etc / ssh / ssh_config \u4e2d\u7684 SendEnv \u914d\u7f6e\u6307\u4ee4 # \u6307\u4ee4\u7684\u503c\u662f\u7a7a\u683c\u5206\u9694\u7684\u53d8\u91cf\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 ' * ' \u548c ' ? ' \u4f5c\u4e3a\u901a\u914d\u7b26 ) \u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a AcceptEnv \u8fbe\u5230\u540c\u6837\u7684\u76ee\u7684 # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4f1a\u88ab\u7528\u4e8e\u7ed5\u8fc7\u7981\u6b62\u7528\u6237\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002\u7531\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u8be5\u6307\u4ee4\u5e94\u5f53\u5c0f\u5fc3\u4f7f\u7528 # \u9ed8\u8ba4\u662f\u4e0d\u4f20\u9012\u4efb\u4f55\u73af\u5883\u53d8\u91cf # Allow client to pass locale environment variables AcceptEnv LANG LC_ * ###################################################################################################################### # \u7cfb\u7edf\u5185\u5f00\u542f ssh \u670d\u52a1\u548c sftp \u670d\u52a1\u90fd\u662f\u901a\u8fc7 / usr / sbin / sshd \u8fd9\u4e2a\u540e\u53f0\u7a0b\u5e8f\u76d1\u542c 22 \u7aef\u53e3\uff0c\u800c sftp \u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u5b50\u670d\u52a1\uff0c\u662f\u901a\u8fc7 / etc / ssh / sshd_config \u914d\u7f6e # \u6587\u4ef6\u4e2d\u7684 Subsystem \u5b9e\u73b0\u7684\uff0c\u5982\u679c\u6ca1\u6709\u914d\u7f6e Subsystem \u53c2\u6570\uff0c\u5219\u7cfb\u7edf\u662f\u4e0d\u80fd sftp \u8bbf\u95ee\u7684 # override default of no subsystems Subsystem sftp / usr / lib / openssh / sftp - server # AllowGroups # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7ec4 # \u8fd9\u91cc\u7684 \" \u7ec4 \" \u662f\u6307 \" \u4e3b\u7ec4 \" ( primary group ) \uff0c\u4e5f\u5c31\u662f / etc / passwd \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 GID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # AllowGroups < \u7ec4\u540d 1 > < \u7ec4\u540d 2 > < \u7ec4\u540d 3 > .. ##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00\u3002\u5f53\u591a\u4e2a\u7528\u6237\u9700\u8981\u901a\u8fc7 ssh \u767b\u5f55\u7cfb\u7edf\u65f6\uff0c\u53ef\u5c06\u6240\u6709\u7528\u6237\u52a0\u5165\u4e00\u4e2a\u7ec4\u4e2d # DenyGroups # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u5c06\u88ab\u62d2\u7edd\u767b\u5f55 # \u8fd9\u91cc\u7684 \" \u7ec4 \" \u662f\u6307 \" \u4e3b\u7ec4 \" ( primary group ) \uff0c\u4e5f\u5c31\u662f / etc / passwd \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 GID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # DenyGroups < \u7ec4\u540d 1 > < \u7ec4\u540d 2 > < \u7ec4\u540d 3 > .. ##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00 ###################################################################################################################### # AllowUsers # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7528\u6237\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7528\u6237 # \u5982\u679c\u6307\u5b9a\u4e86 USER @ HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5\u3002# override default of no subsystems # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 UID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a Subsystem sftp / usr / lib / openssh / sftp - server # DenyUsers , AllowUsers , DenyGroups , AllowGroups # AllowUsers < \u7528\u6237\u540d 1 > < \u7528\u6237\u540d 2 > < \u7528\u6237\u540d 3 > .. ##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00 # DenyUsers # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7528\u6237\u5c06\u88ab\u62d2\u7edd\u767b\u5f55 # \u5982\u679c\u6307\u5b9a\u4e86 USER @ HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 UID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # DenyUsers < \u7528\u6237\u540d 1 > < \u7528\u6237\u540d 2 > < \u7528\u6237\u540d 3 > .. ##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00 ###################################################################################################################### # Match # \u5f15\u5165\u4e00\u4e2a\u6761\u4ef6\u5757\u3002\u5757\u7684\u7ed3\u5c3e\u6807\u5fd7\u662f\u53e6\u4e00\u4e2a Match \u6307\u4ee4\u6216\u8005\u6587\u4ef6\u7ed3\u5c3e # \u5982\u679c Match \u884c\u4e0a\u6307\u5b9a\u7684\u6761\u4ef6\u90fd\u6ee1\u8db3\uff0c\u90a3\u4e48\u968f\u540e\u7684\u6307\u4ee4\u5c06\u8986\u76d6\u5168\u5c40\u914d\u7f6e\u4e2d\u7684\u6307\u4ee4 # Match \u7684\u503c\u662f\u4e00\u4e2a\u6216\u591a\u4e2a \" \u6761\u4ef6-\u6a21\u5f0f \" \u5bf9\u3002\u53ef\u7528\u7684 \" \u6761\u4ef6 \" \u662f\uff1a User , Group , Host , Address # \u53ea\u6709\u4e0b\u5217\u6307\u4ee4\u53ef\u4ee5\u5728 Match \u5757\u4e2d\u4f7f\u7528\uff1a AllowTcpForwarding , Banner , # ForceCommand , GatewayPorts , GSSApiAuthentication , # KbdInteractiveAuthentication , KerberosAuthentication , # PasswordAuthentication , PermitOpen , PermitRootLogin , # RhostsRSAAuthentication , RSAAuthentication , X11DisplayOffset , # X11Forwarding , X11UseLocalHost # \u6307\u5b9a TCP \u7aef\u53e3\u8f6c\u53d1\u5141\u8bb8\u7684\u76ee\u7684\u5730\uff0c\u53ef\u4ee5\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u591a\u4e2a\u8f6c\u53d1\u76ee\u6807\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u8f6c\u53d1\u8bf7\u6c42 # \u5408\u6cd5\u7684\u6307\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a # PermitOpen host : port # PermitOpen IPv4_addr : port # PermitOpen [ IPv6_addr ]: port # \" any \" \u53ef\u4ee5\u7528\u4e8e\u79fb\u9664\u6240\u6709\u9650\u5236\u5e76\u5141\u8bb8\u4e00\u5207\u8f6c\u53d1\u8bf7\u6c42 # Example of overriding settings on a per - user basis # Match User anoncvs # X11Forwarding no # AllowTcpForwarding no # PermitTTY no # ForceCommand cvs server # ForceCommand # \u5f3a\u5236\u6267\u884c\u8fd9\u91cc\u6307\u5b9a\u7684\u547d\u4ee4\u800c\u5ffd\u7565\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4efb\u4f55\u547d\u4ee4\u3002\u8fd9\u4e2a\u547d\u4ee4\u5c06\u4f7f\u7528\u7528\u6237\u7684\u767b\u5f55 shell \u6267\u884c ( shell - c ) # \u8fd9\u53ef\u4ee5\u5e94\u7528\u4e8e shell \u3001\u547d\u4ee4\u3001\u5b50\u7cfb\u7edf\u7684\u5b8c\u6210\uff0c\u901a\u5e38\u7528\u4e8e Match \u5757\u4e2d # \u8fd9\u4e2a\u547d\u4ee4\u6700\u521d\u662f\u5728\u5ba2\u6237\u7aef\u901a\u8fc7 SSH_ORIGINAL_COMMAND \u73af\u5883\u53d8\u91cf\u6765\u652f\u6301\u7684 PermitRootLogin yes # \u6307\u5b9a sshd \u5b88\u62a4\u8fdb\u7a0b\u76d1\u542c\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u4e3a 22 \u3002\u53ef\u4ee5\u4f7f\u7528\u591a\u6761\u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u7aef\u53e3 # \u9ed8\u8ba4\u5c06\u5728\u672c\u673a\u7684\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4e0a\u76d1\u542c\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7 ListenAddress \u6307\u5b9a\u53ea\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u63a5\u53e3\u4e0a\u76d1\u542c Port 22 SSH\u7aef\u53e3\u8f6c\u53d1 \u00b6 SSH\u7aef\u53e3\u8f6c\u53d1\u5c06\u5176\u4ed6TCP\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e\u901a\u8fc7SSH\u94fe\u8def\u8f6c\u53d1\uff0c\u5e76\u81ea\u52a8\u52a0\u5bc6\u548c\u89e3\u5bc6 \u672c\u5730\u8f6c\u53d1\u5b9e\u4f8b \u00b6 # \u547d\u4ee4\u683c\u5f0f\uff1a ssh - L < local port > : < remote host > : < remote port > < SSH hostname > # \u5b9e\u4f8b\uff1a\u4e00\u53f0 LDAP server \uff0c\u4f46\u9650\u5236\u8fdc\u7a0b\u673a\u5668\u8fde\u63a5\uff0c\u6b64\u65f6\u5229\u7528 ssh\u7aef\u53e3\u8f6c\u53d1\u5b9e\u73b0\u4ece\u8fdc\u7a0b\u673a\u5668\u6d4b\u8bd5server\u7684\u76ee\u7684 ( \u8fd9\u91cc\u7684\u8fdc\u7a0b\u673a\u5668\u662f\u76f8\u5bf9\u4e8e server\u6765\u8bb2\u7684 ) # LDAP client\u6267\u884c\u6b64\u547d\u4ee4\u5efa\u7acbssh\u672c\u5730\u7aef\u53e3\u8f6c\u53d1 \uff0c\u5b9e\u73b0\u901a\u8fc7 ssh\u96a7\u9053\u4ece\u672c\u57307001\u7aef\u53e3\u8fde\u63a5\u8fdc\u7aef\u7684389\u7aef\u53e3 ssh - L 7001 : localhost : 389 LDAPServer # SSH \u540c\u65f6\u63d0\u4f9b\u4e86 GatewayPorts \u5173\u952e\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u5b83\u4e0e\u5176\u4ed6\u673a\u5668\u5171\u4eab\u8fd9\u4e2a\u672c\u5730\u7aef\u53e3\u8f6c\u53d1 ssh - g - L < local port > : < remote host > : < remote port > < SSH hostname > ...................... ||| ......................... ...... LDAP Client ..... ||| ...... LDAP Server ........ ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ ... Local Port 7001 .... ||| ....... LDAP Port 389 ..... ........ \u2198 ............. ||| .............. \u2197 .......... ..... SSH Clinet ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ..... ................... SSH tunnel ..................... .................................................. # \u672c\u5730\u670d\u52a1\u5668 LDAP Client\u82e5\u63d0\u793a\u65e0\u6cd5\u89e3\u6790hostname LDAPServer , \u5219\u5728 / etc / hosts\u6587\u4ef6\u6dfb\u52a0localhost LDAPServer\u5373\u53ef # \u5728\u9009\u62e9\u7aef\u53e3\u53f7\u65f6\u8981\u6ce8\u610f\u975e\u7ba1\u7406\u5458\u5e10\u53f7\u662f\u65e0\u6743\u7ed1\u5b9a 1 - 1023 \u7aef\u53e3\u7684\uff0c\u6240\u4ee5\u4e00\u822c\u662f\u9009\u7528\u4e00\u4e2a 1024 - 65535 \u4e4b\u95f4\u7684\u5e76\u4e14\u5c1a\u672a\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u5373\u53ef # \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u673a\u5668\uff08 LDAP Client \uff09\u4e0a\u7684\u5e94\u7528\u76f4\u63a5\u914d\u7f6e\u5230\u672c\u673a\u7684 7001 \u7aef\u53e3\u4e0a\uff08\u800c\u4e0d\u662f LDAP \u670d\u52a1\u5668\u7684 389 \u7aef\u53e3\u4e0a\uff09 \u8fdc\u7a0b\u8f6c\u53d1\u5b9e\u4f8b \u00b6 \u5047\u8bbe\u7531\u4e8e\u7f51\u7edc\u6216\u9632\u706b\u5899\u7684\u539f\u56e0\u6211\u4eec\u4e0d\u80fd\u7528 SSH\u76f4\u63a5\u4eceLDAP Client Host\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668 \uff08 Ldap Server Host \uff09\uff0c\u4f46\u662f\u53cd\u5411\u8fde\u63a5\u5374\u662f\u88ab\u5141\u8bb8\u7684 , \u6b64\u65f6\u6211\u4eec\u7684\u9009\u62e9\u81ea\u7136\u5c31\u662f\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u4e86 # \u547d\u4ee4\u683c\u5f0f\uff1a ssh - R < local port > : < remote host > : < remote port > < SSH hostname > # \u5728 LDAP\u670d\u52a1\u5668 \uff08 LdapServertHost \uff09\u7aef\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a ssh - R 7001 : localhost : 389 LdapClientHost ...................... ||| ......................... ...... LDAP Client ..... ||| ...... LDAP Server ........ ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ ... Local Port 7001 .... ||| ....... LDAP Port 389 ..... ........ \u2198 ............. ||| .............. \u2197 .......... ..... SSH Server ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Client ..... ................... SSH tunnel ..................... .................................................. \u591a\u4e3b\u673a\u8f6c\u53d1\u5e94\u7528\u5b9e\u4f8b \u00b6 # \u672c\u5730\u8f6c\u53d1\u547d\u4ee4\u4e2d\u7684<remote host>\u548c<SSH hostname>\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\u673a\u5668 ssh - L < local port >:< remote host >:< remote port > < SSH hostname > # \u770b\u4e00\u4e2a\u6d89\u53ca\u5230\u56db\u53f0\u673a\u5668 (A,B,C,D) \u7684\u4f8b\u5b50,\u5728 SSH Client(C) \u6267\u884c\u4e0b\u5217\u547d\u4ee4\u6765\u5efa\u7acb SSH \u8fde\u63a5\u4ee5\u53ca\u7aef\u53e3\u8f6c\u53d1\uff1a ssh - g - L 7001 :< B >: 389 < D > \u7136\u540e\u5e94\u7528\u5ba2\u6237\u7aef\uff08 A \uff09\u4e0a\u914d\u7f6e\u8fde\u63a5\u673a\u5668\uff08 C \uff09\u7684 7001 \u7aef\u53e3\u5373\u53ef , \u5728\u4e0a\u8ff0\u8fde\u63a5\u4e2d\uff0c\uff08 A \uff09 <-> ( C ) \u4ee5\u53ca ( B ) <-> ( D ) \u4e4b\u95f4\u7684\u8fde\u63a5\u5e76\u4e0d\u662f\u5b89\u5168\u8fde\u63a5\uff0c \u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u7ecf\u8fc7 SSH \u7684\u52a0\u5bc6\u53ca\u89e3\u5bc6 ........................................................................................ ...................................... ||| ............................................... ...................................... ||| ............................................... ............. #############............|||............................................... ............. #############............|||............................................... .............LDAP Clinet ( A ) ........... ||| ...........LADP Server ( B ) ...................... ............. #############............|||............................................... ............. #############............|||..........#################.................... ............. @@@@@@@@@@@@@ ............ ||| .......... ##@@@@@@#########.................... ........... #################..........|||..........#################.................... ........... #################..........|||..........#################.................... ..............LDAP App................ ||| .............LDAP Port 389 ..................... .................. \u2191 ................... ||| ................... \u2191 ........................... .................. \u2193 ................... ||| ................... \u2193 ........................... ..............SSH Client ( C ) ........... ||| ..............SSH Server ( D ) .................... ........... @@@@@@@@@@@@@@@@@ .......... ||| ............ @@@@@@@@@@@@@@@@@ .................. ........... #################..........|||............#################.................. ........... #################..........|||............#################.................. ............Local Port 7001 ........... ||| ............................................... ..............SSH Client... \u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592 ...SSH Server........................ ....................................SSH tunnel.......................................... ........................................................................................ \u52a8\u6001\u8f6c\u53d1\u5b9e\u4f8b \u00b6 # \u5f53\u6211\u4eec\u5728\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684 WiFi \u73af\u5883\u4e0b\u4e0a\u7f51\uff0c\u7528 SSH \u52a8\u6001\u8f6c\u53d1\u6765\u4fdd\u62a4\u6211\u4eec\u7684\u7f51\u9875\u6d4f\u89c8\u53ca MSN \u4fe1\u606f\u65e0\u7591\u662f\u5341\u5206\u5fc5\u8981\u7684\u3002\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2a socks\u4ee3\u7406\u670d\u52a1 # \u547d\u4ee4\u683c\u5f0f\uff1a ssh - D < local port > < SSH Server > \u6b64\u65f6\u76f4\u63a5\u4f7f\u7528 localhost : 7001 \u6765\u4f5c\u4e3a\u6b63\u5e38\u7684 SOCKS \u4ee3\u7406\u6765\u4f7f\u7528 , SSH \u6240\u5305\u62a4\u7684\u8303\u56f4\u53ea\u5305\u62ec\u4ece\u6d4f\u89c8\u5668\u7aef\uff08 SSH Client \u7aef\uff09\u5230 SSH Server \u7aef\u7684\u8fde\u63a5\uff0c \u5e76\u4e0d\u5305\u542b\u4ece SSH Server \u7aef \u5230\u76ee\u6807\u7f51\u7ad9\u7684\u8fde\u63a5\u3002\u5982\u679c\u540e\u534a\u622a\u8fde\u63a5\u7684\u5b89\u5168\u4e0d\u80fd\u5f97\u5230\u5145\u5206\u7684\u4fdd\u8bc1\u7684\u8bdd\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u4e0d\u662f\u5408\u9002\u7684\u89e3\u51b3\u65b9\u6848 ........................................................................................... ..................................... ||| ................................................... ..................................... ||| ................................................... ........... Brower \u3001 MSN Client ........ ||| ....... ________________________________ ............ ............ @############@ ........... ||| ....... | :::::::::::::::::::::::::::::: | ............ ............ @############@ ........... ||| ....... | :::::::: WEB Site , MSN ...::::::: | ............ ............ @############@ ........... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... --------------------------------............ .............. Port 7001 .............. ||| ............. Dynamic Port ( \u52a8\u6001\u7aef\u53e3 )................. .............. SSH Clinet .... \u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ........................... ................................... SSH tunnel .............................................. ..................................... ||| ................................................... ..................................... ||| ................................................... ........................................................................................... X\u534f\u8bae\u8f6c\u53d1\u5b9e\u4f8b \u00b6 # \u53ef\u7528\u4f5c\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\uff0c\u88ab\u8fdc\u7a0b\u7aef\u662f Windows\u53ef\u5b89\u88c5xming\u4f5c\u4e3axserver \u3002 ssh client\u53ef\u4ee5\u9009\u62e9putty\u914d\u7f6essh\u8bbf\u95ee\u5e76\u5efa\u7acbx - forward \uff08\u8f6c\u53d1\uff09 \u5728 X Server\u7aef\u6267\u884c\u4e00\u4e0b\u547d\u4ee4 \uff0c\u53d1\u8d77\u4e00\u4e2a SSH\u8fde\u63a5 \u3002\u7136\u540e\u5728 X Client\u7aef\u8fd0\u884c\u8fdc\u7a0bX\u684c\u9762\u8fde\u63a5\u5ba2\u6237\u7aef ssh - X < SSH Server > .................................................. ...... X Server ........ ||| ...... X Clinet ........... ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ .......... \u2191 ........... ||| .. DISPLAY = locahost : 10 . 1 .. .......... \u2193 ........... ||| .............. \u2193 .......... ..... SSH Client ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ..... ................... SSH tunnel ..................... .................................................. \u4e3b\u673a\u8c03\u6574 [es.net] \u00b6 \u7f51\u7edc\u6545\u969c\u6392\u67e5\u53c2\u8003 ## \u5173\u4e8e\u8d85\u5927\u578b\u6570\u636e\u96c6\u4f20\u8f93\u95ee\u9898 ( \u5f15\u7528 es . net ) \u5728 Unix \u73af\u5883\u4e2d\uff0c scp \uff0c sftp \u548c rsync \u901a\u5e38\u7528\u4e8e\u5728\u4e3b\u673a\u4e4b\u95f4\u590d\u5236\u6570\u636e\u3002\u867d\u7136\u8fd9\u4e9b\u5de5\u5177\u5728\u672c\u5730\u73af\u5883\u4e2d\u8fd0\u884c\u826f\u597d\uff0c\u4f46\u5b83\u4eec\u5728 WAN \u4e0a\u7684\u6027\u80fd\u5f88\u5dee\u3002 scp \u548c sftp \u7684 openssh \u7248\u672c\u5177\u6709\u5185\u7f6e\u7684 1 MB \u7f13\u51b2\u533a\uff0c\u4e25\u91cd\u9650\u5236\u4e86 WAN \u4e0a\u7684\u6027\u80fd\u3002\u5c3d\u7ba1 rsync \u4e0d\u662f openssh \u53d1\u884c\u7248\u7684\u4e00\u90e8\u5206\uff0c\u4f46 rsync \u901a\u5e38\u4f7f\u7528 ssh \u4f5c\u4e3a\u4f20\u8f93\uff0c\u56e0\u6b64 \u53d7\u5230\u5e95\u5c42 ssh \u5b9e\u73b0\u6240\u65bd\u52a0\u7684\u9650\u5236\u3002 \u5982\u679c\u60a8\u9700\u8981\u5728 RTT \u8d85\u8fc7 20 \u6beb\u79d2\u7684\u7f51\u7edc\u8def\u5f84\u4e0a\u4f20\u8f93\u5927\u578b\u6570\u636e\u96c6\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177 \u5339\u5179\u5821\u8d85\u7ea7\u8ba1\u7b97\u673a\u4e2d\u5fc3\u63d0\u4f9b\u4e86\u89e3\u51b3 scp \u548c sftp \u5173\u4e8e\u8fd9\u4e2a\u95ee\u9898\u7684\u8865\u4e01\uff1a HPN - SSH \uff1a https : // www . psc . edu / hpn - ssh # \u6839\u636e es net \u5b98\u7f51 TCP \u6ce8\u610f\u4e8b\u9879 \u6ce8\u610f\uff1a\u5e94\u8be5\u5355\u72ec\u4f7f\u7528 net . tcp_mem \uff0c\u56e0\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u6ca1\u95ee\u9898\u3002\u4e00\u4e9b\u6027\u80fd\u4e13\u5bb6\u8bf4\uff0c\u8fd8\u8981\u589e\u52a0 net . core . optmem_max \u4ee5\u5339\u914d net . core . rmem_max \u548c net . core . wmem_max \uff0c\u4f46\u6211\u4eec\u6ca1\u6709\u53d1\u73b0\u8fd9\u6709\u4efb\u4f55\u533a\u522b\u3002\u4e00\u4e9b\u4e13\u5bb6\u8fd8\u8bf4\u5c06 net . ipv4 . tcp_timestamps \u548c net . ipv4 . tcp_sack \u8bbe\u7f6e\u4e3a 0 \uff0c \u8fd9\u6837\u505a\u53ef\u4ee5\u51cf\u5c11 CPU \u8d1f\u8f7d\uff0c\u4f46\u9ed8\u8ba4\u503c\u662f 1 \u5bf9\u4e8e\u6027\u80fd\u5176\u5b9e\u66f4\u6709\u5e2e\u52a9 \u5bf9\u4e8e\u8f83\u65e7\u7684\u64cd\u4f5c\u7cfb\uff08\u4f8b\u5982 CentOS5 / 6 \uff09\uff0c\u589e\u52a0 net . core . netdev_max_backlog \u503c\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd # UDP \u8c03\u6574 1 . \u4f7f\u7528 jumbo frames \u5728 9 k MTUs \u4e0b\u53ef\u4ee5\u4f7f\u6027\u80fd\u63d0\u9ad8 4 - 5 \u500d 2 . \u6570\u636e\u5305\u5927\u5c0f\uff1a\u6700\u597d\u7684\u6027\u80fd\u662f MTU \u5927\u5c0f\u51cf\u53bb\u6570\u636e\u5305\u5934\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a 9000 Byte MTU \uff0c ipv4 \u662f 8972 \uff0c ipv6 \u662f 8952 3 . socket \u7f13\u5b58\u5927\u5c0f\uff1a\u5bf9\u4e8e UDP \uff0c\u7f13\u51b2\u533a\u5927\u5c0f\u4e0e TCP \u7684\u65b9\u5f0f\u65e0\u5173\uff0c\u4f46\u9ed8\u8ba4\u503c\u4ecd\u7136\u4e0d\u591f\u5927\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5c06\u5957\u63a5\u5b57\u7f13\u51b2\u533a\u8bbe\u7f6e\u4e3a 4 M \u4f3c\u4e4e\u6709\u5f88\u5927\u5e2e\u52a9 4 . CPU \u9009\u62e9\uff1a 10 G \u7684 UDP \u901a\u5e38\u662f CPU \u9650\u5236\uff0c\u56e0\u6b64\u9700\u8981\u8003\u8651\u5185\u6838\uff0c\u5c24\u5176\u5728 Sandy \u6216 lvy Bridge \u4e3b\u677f # \u865a\u62df\u673a\u8c03\u6574 ## XEN \u3001 KVM \u7c7b\u578b \u8981\u5c06\u6240\u6709\u7684\u4e3b\u673a\u5904\u7406\u5668\u529f\u80fd\u4f20\u9012\u7ed9 guest \u865a\u62df\u673a\u6267\u884c qemu - cpu host \u5982\u679c\u5e0c\u671b\u4fdd\u7559\u517c\u5bb9\u6027\uff0c\u5219\u53ef\u4ee5\u5411 guest \u865a\u62df\u673a\u516c\u5f00\u6240\u9009\u529f\u80fd\u3002\u5982\u679c\u6240\u6709\u4e3b\u673a\u90fd\u5177\u6709\u8fd9\u4e9b\u529f\u80fd\uff0c\u5219\u4f1a\u4fdd\u7559\u517c\u5bb9\u6027 qemu - cpu qemu64 , + ssse3 , + sse4 . 1 , + sse4 . 2 , + x2apic \u8981\u67e5\u770b\u4e3b\u673a CPU \u4e0e guest \u865a\u62df\u673a\u529f\u80fd\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u53ea\u9700\u6bd4\u8f83\u6bcf\u4e2a\u7cfb\u7edf\u4e0a\u4ee5\u4e0b\u547d\u4ee4\u7684\u8f93\u51fa grep flags / proc / cpuinfo | uniq qemu \u9ed8\u8ba4\u4f7f\u7528\u7528\u6237\u6a21\u5f0f\u7f51\u7edc ( slirp ) \uff0c\u65e0\u9700\u4e8b\u5148\u5b89\u88c5\u5373\u53ef\u5728\u4e3b\u673a\u4f7f\u7528\u7ba1\u7406\u6743\u9650\uff0c\u4f46\u662f\u5f88\u6162\uff0c\u83b7\u5f97\u9ad8\u6027\u80fd\u53ef\u901a\u8fc7 - net tap \u547d\u4ee4\u884c\u5f00\u5173\u5207\u6362\u5230\u6865\u63a5\u6a21\u5f0f qemu - net nic , model = virtio , mac = ... - net tap , ifname = ... \u6216 qemu - net nic , model = virtio , mac = ... - net bridge , br = ..., helper =/ usr / local / libexec / qemu - bridge - helper \u9664\u4e86 virtio \u4e4b\u5916\uff0c vt - d passthrough \u65b9\u6cd5\u53ef\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd qemu - net none - device vfio - pci , host = ... QEMU \u652f\u6301\u5404\u79cd\u5b58\u50a8\u683c\u5f0f\u548c\u540e\u7aef\u3002\u6700\u5bb9\u6613\u4f7f\u7528\u7684\u662f raw \u548c qcow2 \u683c\u5f0f\uff0c\u4f46\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u6700\u597d\u4f7f\u7528\u539f\u59cb\u5206\u533a\u3002\u521b\u5efa\u903b\u8f91\u5377\u6216\u5206\u533a\u5e76\u5c06\u5176\u5206\u914d\u7ed9 guest \u865a\u62df\u673a\uff1a qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio QEMU \u8fd8\u652f\u6301\u5404\u79cd\u7f13\u5b58\u6a21\u5f0f\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u539f\u59cb\u5377\u6216\u5206\u533a\uff0c\u6700\u597d\u5b8c\u5168\u907f\u514d\u7f13\u5b58\uff0c\u8fd9\u4f1a\u51cf\u5c11\u6570\u636e\u526f\u672c\u548c\u603b\u7ebf\u6d41\u91cf qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio \u4e0e\u7f51\u7edc\u4e00\u6837\uff0c QEMU \u652f\u6301\u591a\u79cd\u5b58\u50a8\u63a5\u53e3\u3002\u9ed8\u8ba4\u503c IDE \u53d7\u5230\u6765\u5bbe\u7684\u9ad8\u5ea6\u652f\u6301\uff0c\u4f46\u53ef\u80fd\u5f88\u6162\uff0c\u5c24\u5176\u662f\u78c1\u76d8\u9635\u5217\u3002\u5982\u679c\u60a8\u7684 guest \u865a\u62df\u673a\u652f\u6301\u5b83\uff0c\u8bf7\u4f7f\u7528 virtio \u63a5\u53e3 \u4e0d\u8981\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528 linux \u6587\u4ef6\u7cfb\u7edf btrfs \u6765\u83b7\u53d6\u56fe\u50cf\u6587\u4ef6\u3002\u8fd9\u5c06\u5bfc\u81f4\u4f4e IO \u6027\u80fd\u3002\u5f53\u5ba2\u6237\u7aef\u8fdb\u884c\u9ad8 IO \u6d41\u91cf\u65f6\uff0c kvm guest \u865a\u62df\u673a\u751a\u81f3\u53ef\u80fd\u4f1a\u51bb\u7ed3 qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio ## VMware \u7c7b\u578b [ VMware \u517c\u5bb9\u6027\u6307\u5357] ( http : // www . vmware . com / resources / compatibility / search . php ) \u4f18\u5316\u5185\u6838\u53c2\u6570 [\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574] \u00b6 \u4fee\u6539\u5185\u6838\u53c2\u6570\u65b9\u6cd5: echo\u8ffd\u52a0\u5230\u6587\u4ef6\u91cc\u5982\uff1aecho \"1\" >/proc/sys/net/ipv4/tcp_syn_retries\uff0c\u6216\u4f7f\u7528sysctl -w\u547d\u4ee4\uff0c\u4f46\u91cd\u542f\u540e\u5931\u6548,\u628a\u53c2\u6570\u6dfb\u52a0\u5230 /etc/sysctl.conf\u4e2d\uff0c\u7136\u540e\u6267\u884csysctl -p\u4f7f\u53c2\u6570\u751f\u6548\uff0c\u6c38\u4e45\u751f\u6548\u3002\u5185\u6838\u751f\u4ea7\u73af\u5883\u5e38\u7528\u4f18\u5316\u53c2\u6570\u53c2\u8003\uff0c\u5177\u4f53\u4f18\u5316\u503c\u8981\u53c2\u8003\u5e94\u7528\u573a\u666f\u548c\u8bbe\u5907 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / kernel / # \u5f00\u542f execshild ,\u5373\u5185\u5b58\u7f13\u51b2\u533a\u6ea2\u51fa\u4fdd\u62a4 kernel . exec - shield = 1 kernel . randomize_va_space = 1 kernel . sysrq = 0 # \u63a7\u5236\u5185\u6838\u7684\u7cfb\u7edf\u8bf7\u6c42\u8c03\u8bd5\u529f\u80fd\uff0c\u4e3a\u5b89\u5168\u8d77\u89c1\u8bbe\u4e3a 0 \u5173\u95ed kernel . core_uses_pid = 1 # \u63a7\u5236\u6838\u5fc3\u8f6c\u50a8\u662f\u5426\u5c06 PID \u9644\u52a0\u5230\u6838\u5fc3\u6587\u4ef6\u540d,\u7528\u4e8e\u8c03\u8bd5\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\u3002 kernel . msgmnb = 65536 # \u6bcf\u4e2a\u6d88\u606f\u961f\u5217\u7684\u5927\u5c0f\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\u9650\u5236 kernel . msgmax = 65536 # \u6574\u4e2a\u7cfb\u7edf\u6700\u5927\u6d88\u606f\u961f\u5217\u6570\u91cf\u9650\u5236 kernel . shmmax = 67108864 # \u589e\u52a0\u5206\u914d\u7ed9 shm ( \u5355\u4e2a\u5171\u4eab\u5185\u5b58\u6bb5 ) \u7684\u6700\u5927\u5185\u5b58\u91cf ( \u5355\u4f4d\uff1a\u5b57\u8282 ) \u9650\u5236\uff0c\u8ba1\u7b97\u516c\u5f0f 64 G * 1024 * 1024 * 1024 ( \u5b57\u8282 ) kernel . shmall = 4294967296 # \u6240\u6709\u5185\u5b58\u5927\u5c0f ( \u5355\u4f4d\uff1a\u9875\uff0c 1 \u9875 = 4 Kb ) \uff0c\u8ba1\u7b97\u516c\u5f0f 16 G * 1024 * 1024 * 1024 / 4 KB ( \u9875 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / bridge / # bridge - nf \u4f7f\u5f97 netfilter \u53ef\u4ee5\u5bf9 Linux \u7f51\u6865\u4e0a\u7684 IPv4 / ARP / IPv6 \u5305\u8fc7\u6ee4\uff0c\u4ee5\u4e0b\u662f\u5e38\u7528\u914d\u7f6e\uff0c 1 \u4ee3\u8868\u542f\u7528\uff0c 0 \u4ee3\u8868\u4e0d\u542f\u7528 net . bridge . bridge - nf - call - arptables = 0 # \u662f\u5426\u542f\u7528\u5728 arptables \u7684 FORWARD \u4e2d\u8fc7\u6ee4\u7f51\u6865\u7684 ARP \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - call - ip6tables = 0 # \u662f\u5426\u542f\u7528\u5728 ip6tables \u94fe\u4e2d\u8fc7\u6ee4 IPv6 \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - call - iptables = 0 # \u662f\u5426\u542f\u7528\u5728 iptables \u94fe\u4e2d\u8fc7\u6ee4 IPv4 \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - filter - vlan - tagged = 0 # \u662f\u5426\u542f\u7528\u5728 iptables / arptables \u4e2d\u8fc7\u6ee4\u6253\u4e86 vlan \u6807\u7b7e\u7684\u5305 ( \u9ed8\u8ba4\uff1a 0 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / core / net . core . rmem_default = 65535 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . rmem_max = 25165824 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 ( 24 MB ) net . core . wmem_default = 65535 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . wmem_max = 25165824 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . hot_list_length = 256 # \u589e\u52a0\u8981\u7f13\u5b58\u7684 skb - heads \u6570\u76ee net . core . optmem_max = 40960 # \u589e\u52a0\u5185\u5b58\u7f13\u51b2\u533a\u7684\u6700\u5927\u6570\u91cf ( \u9ed8\u8ba4\uff1a 20480 ) net . core . busy_poll = 50 # \u8f6e\u8be2\u6709\u52a9\u4e8e\u51cf\u5c11\u7f51\u7edc\u63a5\u6536\u8def\u5f84\u4e2d\u7684\u5ef6\u8fdf,\u5141\u8bb8\u5957\u63a5\u5b57\u5c42\u4ee3\u7801\u8f6e\u8be2\u7f51\u7edc\u8bbe\u5907\u7684\u63a5\u6536\u961f\u5217\uff0c\u5e76\u7981\u7528\u7f51\u7edc\u4e2d\u65ad ( \u9ed8\u8ba4\uff1a 0 ) net . core . netdev_max_backlog = 16384 # \u5f53\u63a5\u53e3\u63a5\u6536\u6570\u636e\u5305\u7684\u901f\u5ea6\u8d85\u8fc7\u5185\u6838\u53ef\u4ee5\u5904\u7406\u7684\u901f\u5ea6\u65f6\uff0c\u589e\u52a0 incoming \u8fde\u63a5\u7684\u6570\u91cf\uff0c backlog \u961f\u5217\u8bbe\u7f6e \u5728 INPUT \u7aef\u6392\u961f\u7684\u6700\u5927\u6570\u636e\u5305\u6570,\u9ad8\u8d1f\u8f7d\u53ef\u4ee5\u589e\u52a0\u8be5\u503c ( \u9ed8\u8ba4\uff1a 1000 ) net . core . somaxconn = 1024 # \u589e\u52a0 incoming \u8fde\u63a5\u6570, somaxconn \u5b9a\u4e49\u6bcf\u4e2a listen \u8c03\u7528\u5206\u914d\u7684 request_sock \u7ed3\u6784\u7684\u6570\u91cf\u3002\u6b64\u961f\u5217\u5728\u76d1\u542c\u5957\u63a5\u5b57\u7684 \u751f\u547d\u5468\u671f\u4e2d\u662f\u6301\u4e45\u6027\u7684, web \u5e94\u7528\u73af\u5883\u975e\u5e38\u6709\u5fc5\u8981\u8c03\u6574\u6b64\u503c net . core . default_qdisc = fq # \u63a8\u8350\u7528\u4e8e Centos7 \u3001 Debian8 \u4e3b\u673a\u3002 \u5728 centos5 \u6216 6 \u4e3b\u673a\u9700\u8981\u5728 / etc / rc . local \u6dfb\u52a0\uff1a / sbin / ifconfig ethN txqueuelen 10000 ( N \u4ee3\u8868 10 G NIC \u7684\u7f16\u53f7\uff0c\u5373\u4e07\u5146\u7f51\u5361\u7684\u7cfb\u7edf\u7f16\u53f7 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a / proc / sys / fs / fs . file - max = 2097152 # \u589e\u52a0\u6587\u4ef6\u53e5\u67c4\u548c inode \u7f13\u5b58\u7684\u5927\u5c0f # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / ipv4 / net . ipv4 . ip_forward = 1 # \u503c\u4e3a 0 \u8868\u793a\u7981\u6b62\u6570\u636e\u8f6c\u53d1\uff0c 1 \u5219\u5f00\u542f net . ipv4 . tcp_no_metrics_save = 1 # \u4e0d\u8981\u5728\u5173\u95ed\u8fde\u63a5\u65f6\u7f13\u5b58 metrics net . ipv4 . tcp_congestion_control = cubic # \u8bbe\u7f6e\u9ed8\u8ba4\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u662f cubic , ( \u63a8\u8350\u4f7f\u7528 htcp ) net . ipv4 . tcp_mtu_probing = 1 # \u8bbe\u7f6e\u4e3b\u673a\u542f\u7528 jumbo frames \uff0c\u907f\u514d MTU \u9ed1\u6d1e\u95ee\u9898 net . ipv4 . tcp_rfc1337 = 1 # \u9632\u6b62 TCP \u65f6\u95f4\u7b49\u5f85 net . ipv4 . icmp_echo_ignore_broadcasts = 1 # \u8bbe\u7f6e\u4e3a 1 \u8868\u793a\u5ffd\u7565 icmp \u5e7f\u64ad\u8bf7\u6c42,\u907f\u514d\u653e\u5927\u653b\u51fb net . ipv4 . icmp_ignore_bogus_error_responses = 1 # \u5f00\u542f\u6076\u610f icmp \u9519\u8bef\u6d88\u606f\u4fdd\u62a4 net . ipv4 . icmp_echo_ignore_all = 1 # \u5ffd\u7565\u6240\u6709 icmp \u8bf7\u6c42,\u5373\u5173\u95ed ping net . ipv4 . tcp_keepalive_time = 600 # TCP \u53d1\u9001 keepalive \u6d88\u606f\u7684\u9891\u7387 ( \u5355\u4f4d\uff1a\u79d2 ) ,\u7528\u4e8e\u786e\u8ba4 TCP \u8fde\u63a5\u662f\u5426\u6709\u6548\uff0c\u9632\u6b62\u5efa\u7acb\u8fde\u63a5\u4f46\u4e0d\u53d1\u9001\u6570\u636e\u7684\u653b\u51fb net . ipv4 . tcp_keepalive_probes = 5 # \u53d1\u9001 keepalive \u6d88\u606f\u8d85\u65f6\u4e4b\u524d\u7684\u63a2\u6d4b\u6b21\u6570 # \u9ed8\u8ba4\u503c\uff1a 9 \uff0c\u63a8\u8350 5 net . ipv4 . tcp_keepalive_intvl = 15 # \u786e\u5b9a\u4e86 isAlive \u95f4\u9694\u63a2\u6d4b\u4e4b\u95f4\u7684\u7b49\u5f85\u65f6\u95f4 ( \u9ed8\u8ba4 75 s ,\u5efa\u8bae 15 - 30 s ) net . ipv4 . tcp_retries1 = 3 # \u653e\u5f03\u56de\u5e94\u4e00\u4e2a TCP \u8fde\u63a5\u8bf7\u6c42\u524d\u8fdb\u884c\u91cd\u8bd5\u7684\u6b21\u6570\u3002 RFC \u89c4\u5b9a\u503c\u6700\u4f4e\u4e3a 3 \uff0c\u9ed8\u8ba4\u503c\u4e3a 3 net . ipv4 . tcp_retries2 = 5 # \u5728\u4e22\u5f03\u6fc0\u6d3b\u5df2\u5efa\u7acb\u901a\u8baf\u72b6\u51b5\u7684 TCP \u8fde\u63a5\u4e4b\u524d\ufe50\u9700\u8981\u8fdb\u884c\u591a\u5c11\u6b21\u91cd\u8bd5\u3002\u9ed8\u8ba4\u503c\u4e3a 15 net . ipv4 . tcp_orphan_retries = 3 # \u672c\u5730\u4e22\u5f03 TCP \u8fde\u63a5\u524d\u8fdb\u884c\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4 7 net . ipv4 . tcp_abort_on_overflow = 0 # \u5b88\u62a4\u8fdb\u7a0b\u8fc7\u4e8e\u7e41\u5fd9\u4e0d\u80fd\u63a5\u53d7\u65b0\u7684\u8fde\u63a5\u65f6\uff0c\u5c31\u53d1\u9001 reset \u4fe1\u606f\uff0c\u9ed8\u8ba4 0 net . ipv4 . tcp_syncookies = 1 # \u5f00\u542f SYN Cookies \uff0c\u5f53\u51fa\u73b0 SYN \u7b49\u5f85\u961f\u5217\u6ea2\u51fa\u65f6\uff0c\u542f\u7528 cookies \u6765\u5904\u7406\uff0c\u53ef\u4ee5\u505a SYN \u6d2a\u6c34\u653b\u51fb\u4fdd\u62a4 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_stdurg = 0 # \u9ed8\u8ba4\u4f7f\u7528 tcp urg pointer \u5b57\u6bb5\u4e2d\u7684\u4e3b\u673a\u8bf7\u6c42\u89e3\u91ca\u529f\u80fd\uff0c\u6253\u5f00\u53ef\u80fd\u5bfc\u81f4\u4e0d\u80fd\u6b63\u5e38\u901a\u4fe1 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_window_scaling = 1 # \u652f\u6301\u66f4\u5927\u7684 TCP / ip \u4f1a\u8bdd\u7684\u6ed1\u52a8\u7a97\u53e3,\u5982\u679c TCP \u7a97\u53e3\u6700\u5927\u8d85\u8fc7 65535 ( 64 K ) , \u5fc5\u987b\u8bbe\u7f6e\u8be5\u6570\u503c\u4e3a 1 net . ipv4 . tcp_timestamps = 1 # \u53ef\u9632\u8303\u4f2a\u9020\u7684 sequence \u53f7\u7801\uff0c\u542f\u7528\u5b9e\u73b0\u66f4\u597d\u7684\u7f51\u7edc\u6027\u80fd ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_sack = 1 # \u5f00\u542f\u6709\u9009\u62e9\u7684\u5e94\u7b54,\u7528\u4e8e\u67e5\u770b\u7279\u5b9a\u7684\u9057\u5931\u6570\u636e\u5305\uff0c\u7528\u4e8e\u5feb\u901f\u6062\u590d\u8fde\u63a5\u72b6\u6001 ( \u9ed8\u8ba4 1 ) net . ipv4 . tcp_fack = 1 # \u6253\u5f00 fack \u62e5\u585e\u907f\u514d\u548c\u5feb\u901f\u91cd\u4f20\u529f\u80fd\uff0c\u6ce8\u610f\uff1a\u5f53 tcp_sack \u8bbe\u7f6e\u4e3a 0 \u65f6\uff0c\u6b64\u503c\u8bbe\u7f6e 1 \u4e5f\u662f\u65e0\u6548\u7684 ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_dsack = 1 # \u5141\u8bb8 TCP \u53d1\u9001 \" \u4e24\u4e2a\u5b8c\u5168\u76f8\u540c \" \u7684 SACK ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_ecn = 0 # TCP \u7684\u76f4\u63a5\u62e5\u585e\u901a\u544a\u529f\u80fd ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_reordering = 5 # TCP \u6d41\u4e2d\u91cd\u6392\u5e8f\u7684\u6570\u636e\u62a5\u6700\u5927\u6570\u91cf\u3002\u4e00\u822c\u63a8\u8350\u628a\u8fd9\u4e2a\u6570\u503c\u7565\u5fae\u8c03\u6574\u5927\u4e00\u4e9b ( \u9ed8\u8ba4\uff1a 3 ) net . ipv4 . tcp_retrans_collapse = 0 # \u5bf9\u4e8e\u67d0\u4e9b\u6709 bug \u7684\u6253\u5370\u673a\u63d0\u4f9b\u9488\u5bf9\u5176 bug \u7684\u517c\u5bb9\u6027\u3002\u4e00\u822c\u4e0d\u9700\u8981\u8fd9\u4e2a\u652f\u6301,\u53ef\u4ee5\u5173\u95ed\u5b83 ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_app_win = 31 # \u4fdd\u7559 max_window / 2 ^ tcp_app_win \u6570\u91cf\u7684\u7528\u4e8e\u5e94\u7528\u7f13\u5b58\uff0c 0 \u8868\u793a\u4e0d\u9700\u8981\u7f13\u5b58 ( \u9ed8\u8ba4\uff1a 31 ) net . ipv4 . tcp_adv_win_scale = 2 # \u8ba1\u7b97\u7f13\u51b2\u5f00\u9500 ( \u9ed8\u8ba4\uff1a 2 ) net . ipv4 . tcp_low_latency = 0 # \u5141\u8bb8 tcp / ip \u6808\u5728\u9ad8\u541e\u5410\u4e0b\u4f4e\u5ef6\u8fdf\uff0c\u4e00\u822c\u7981\u7528\uff0c\u4f46\u5728 beowulf \u96c6\u7fa4\u4e2d\u6253\u5f00\u5f88\u6709\u5e2e\u52a9 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_westwood = 0 # \u542f\u7528\u53d1\u9001\u7aef\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0c\u53ef\u5bf9\u5e26\u5bbd\u5229\u7528\u60c5\u51b5\u8fdb\u884c\u4f18\u5316 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_bic = 0 # \u4e3a\u5feb\u901f\u957f\u8ddd\u79bb\u7f51\u7edc\u542f\u7528 binary increase congestion \uff1b\u53ef\u66f4\u597d\u5229\u7528 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . ip_local_port_range = 1024 65000 # \u5bf9\u5916\u8fde\u63a5\u7aef\u53e3\u8303\u56f4\uff0c RHEL 7 default : 32768 61000 net . ipv4 . ip_conntrack_max = 65536 # \u7cfb\u7edf\u6700\u5927\u652f\u6301\u7684 ipv4 \u8fde\u63a5\u6570 ( \u9ed8\u8ba4\uff1a 65536 ) \uff0c\u4f46\u5982\u679c\u5185\u5b58 128 M \u4ee5\u4e0b\uff0c\u6700\u5927\u53ea\u6709 8192 net . ipv4 . tcp_syn_retries = 3 # \u5728\u5185\u6838\u653e\u5f03\u5efa\u7acb\u8fde\u63a5\u4e4b\u524d\u53d1\u9001 SYN \u5305\u7684\u6570\u91cf,\u6b64\u503c\u4e0d\u5e94\u5927\u4e8e 255 \uff0c\u9ed8\u8ba4\u662f 5 \uff0c\u9ad8\u8d1f\u8f7d\u7269\u7406 \u901a\u4fe1\u826f\u597d\u65f6\uff0c\u5efa\u8bae\u4e3a 2 \uff0c\u6b64\u503c\u4ec5\u9488\u5bf9\u5bf9\u5916\u8fde\u63a5\uff0c\u5bf9\u8fdb\u6765\u7684\u8fde\u63a5\u5219\u7531 tcp_retries \u51b3\u5b9a net . ipv4 . tcp_synack_retries = 2 # \u5bf9\u4e8e\u8fdc\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42 SYN \uff0c\u5185\u6838\u4f1a\u53d1\u9001 SYN + ACK \u6570\u636e\u5305\u4ee5\u786e\u8ba4\u6536\u5230\u4e0a\u4e00\u4e2a SYN \u8bf7\u6c42\u3002\u5373\u4e09\u6b21\u63e1\u624b\u7684\u7b2c\u4e8c\u6b21\u63e1\u624b\u3002 \u6b64\u8bbe\u7f6e\u51b3\u5b9a\u5185\u6838\u653e\u5f03\u8fde\u63a5\u4e4b\u524d\u53d1\u9001 SYN + ACK \u5305\u7684\u6570\u91cf\uff0c\u4e0d\u5e94\u5927\u4e8e 255 \uff0c\u9ed8\u8ba4\u4e3a 5 net . ipv4 . tcp_fin_timeout = 15 # \u6b64\u53c2\u6570\u51b3\u5b9a\u4e86 TCP \u8fde\u63a5\u4fdd\u6301\u5728 FIN - WAIT - 2 \u72b6\u6001\u7684\u65f6\u95f4\uff0c ( \u9ed8\u8ba4 60 s \uff0c\u5efa\u8bae 15 - 30 s ) \u5bf9\u4e8e\u751f\u6210\u6216\u652f\u6301\u9ad8\u7ea7\u522b\u7f51\u7edc \u6d41\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u7cfb\u7edf\uff0c\u6b64\u503c\u8bbe\u7f6e\u5230 10 \u79d2\u4ee5\u4e0b net . ipv4 . tcp_max_syn_backlog = 2048 # \u8bb0\u5f55\u5c1a\u672a\u6536\u5230\u5ba2\u6237\u7aef\u786e\u8ba4\u4fe1\u606f\u7684\u8fde\u63a5\u8bf7\u6c42\u7684\u6700\u5927\u503c\uff0c\u5185\u5b58\u5927\u4e8e 128 Mb \u9ed8\u8ba4 1024 \uff0c\u5185\u5b58\u5c0f\u4e8e 128 \u65f6\uff0c\u5219\u503c \u9ed8\u8ba4\u65f6 128 ,\u670d\u52a1\u5668\u8fc7\u8f7d\u65f6\u53ef\u589e\u52a0\u6b64\u503c net . ipv4 . tcp_limit_output_bytes = 131072 # \u9ed8\u8ba4\u662f 262144 \u5b57\u8282\uff1b\u9650\u5236\u8bbe\u5907\u4e0a\u7684\u5b57\u8282\u6570\uff0c\u4ee5\u51cf\u5c11\u8f83\u5927\u961f\u5217\u5927\u5c0f\u5bfc\u81f4\u7684\u5ef6\u8fdf\u6548\u5e94\uff1b\u5bf9\u4e8e\u5ef6\u8fdf\u4f18\u5148 \u7ea7\u9ad8\u4e8e\u541e\u5410\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u73af\u5883\uff0c\u964d\u4f4e\u6b64\u503c\u53ef\u4ee5\u6539\u5584\u5ef6\u8fdf\uff0c\u63a8\u8350 131072 \u5b57\u8282 # \u589e\u52a0 time - wait \u5b58\u50a8\u6c60\u5927\u5c0f\u53ef\u9632\u6b62\u7b80\u5355 DOS \u653b\u51fb net . ipv4 . tcp_max_tw_buckets = 1440000 # \u6307\u5b9a\u5141\u8bb8\u5728\u4efb\u4f55\u65f6\u95f4\u5b58\u5728\u7684\u201c time - wait \u201d\u72b6\u6001\u7684\u6700\u5927 sockets \u6570\u3002\u5982\u679c\u8d85\u8fc7\u6700\u5927\u503c\uff0c\u5219\u4f1a\u7acb\u5373\u9500\u6bc1\u5904\u4e8e \u201c time - wait \u201d\u72b6\u6001\u7684\u5957\u63a5\u5b57\u5e76\u663e\u793a\u8b66\u544a\u3002\u6b64\u8bbe\u7f6e\u7528\u4e8e\u963b\u6b62\u67d0\u4e9b\u7c7b\u578b\u7684\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\u5728\u964d\u4f4e\u6b64\u503c\u4e4b\u524d\u5e94\u5c0f\u5fc3 \u8c28\u614e\u3002\u66f4\u6539\u540e\uff0c\u5e94\u589e\u52a0\u5176\u503c\uff0c\u5c24\u5176\u662f\u5728\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e86\u66f4\u591a\u5185\u5b58\u6216\u7f51\u7edc\u9700\u6c42\u8f83\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5916\u90e8\u5a01\u80c1\u5f71\u54cd\u65f6 \u9ed8\u8ba4 262144 \uff0c\u5f53\u7f51\u7edc\u9700\u6c42\u5f88\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5230\u5916\u90e8\u5a01\u80c1\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u5230 450000 net . ipv4 . tcp_tw_recycle = 1 # \u5f00\u542f TCP \u8fde\u63a5\u4e2d time_wait sockets \u7684\u5feb\u901f\u56de\u6536,\u9ed8\u8ba4\u4e3a 0 net . ipv4 . tcp_tw_reuse = 1 # \u5f00\u542f TCP \u8fde\u63a5\u590d\u7528\uff0c\u5141\u8bb8\u5c06 time_wait sockets \u91cd\u65b0\u7528\u4e8e\u65b0\u7684 TCP \u8fde\u63a5 ( \u4e3b\u8981\u9488\u5bf9 time_wait \u8fde\u63a5 ) \u542f\u7528\u540e\uff0c\u6b64\u53c2\u6570 \u53ef\u4ee5\u7ed5\u8fc7\u901a\u5e38\u4e0e\u5957\u63a5\u5b57\u521b\u5efa\u76f8\u5173\u7684\u5206\u914d\u548c\u521d\u59cb\u5316\u5f00\u9500\uff0c\u4ece\u800c\u8282\u7701 CPU \u5468\u671f\uff0c\u7cfb\u7edf\u8d1f\u8f7d\u548c\u65f6\u95f4 net . ipv4 . tcp_max_orphans = 32768 # \u544a\u8bc9\u5185\u6838\u6709\u591a\u5c11 TCP \u5957\u63a5\u5b57\u672a\u9644\u52a0\u5230\u7cfb\u7edf\u4fdd\u7559\u7684\u4efb\u4f55\u7528\u6237\u6587\u4ef6\u53e5\u67c4\u7684\u6700\u5927\u6570\u91cf,\u5982\u679c\u8d85\u8fc7\u6b64\u6570\u91cf\uff0c\u5219\u7acb\u5373\u91cd\u7f6e \u5b64\u7acb\u8fde\u63a5\u5e76\u6253\u5370\u8b66\u544a\u3002\u6b64\u9650\u5236\u4ec5\u7528\u4e8e\u9632\u6b62\u7b80\u5355\u7684 DoS \u653b\u51fb\uff0c\u4f46\u4e0d\u80fd\u4eba\u4e3a\u5730\u4f9d\u8d56\u6b64\u9650\u5236\u6216\u964d\u4f4e\u9650\u5236\uff0c\u800c\u662f\u589e\u52a0 \u5b83\uff08\u53ef\u80fd\u5728\u589e\u52a0\u5df2\u5b89\u88c5\u7684\u5185\u5b58\u4e4b\u540e\uff09\uff0c\u5982\u679c\u7f51\u7edc\u6761\u4ef6\u9700\u8981\u8d85\u8fc7\u9ed8\u8ba4\u503c\uff0c\u8c03\u6574\u7f51\u7edc\u670d\u52a1\u4ee5\u5ef6\u8fdf\u5e76\u66f4\u79ef\u6781\u5730\u6740\u6b7b \u8fd9\u4e9b\u72b6\u6001\u3002\u518d\u6b21\u63d0\u9192\uff1a\u6bcf\u4e2a orphan \u90fd\u4f1a\u5403\u6389\u5927\u7ea6 64 K \u7684 unswappable \u5185\u5b58 ( \u9ed8\u8ba4\uff1a 8192 ) # \u589e\u52a0\u8bfb\u53d6\u7f13\u51b2\u533a\u7a7a\u95f4 net . ipv4 . udp_rmem_min = 16384 net . ipv4 . tcp_rmem = 4096 87380 25165824 # \u4e09\u4e2a\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684\u6700\u5c0f\u503c\u3001\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c # \u589e\u52a0\u53ef\u5206\u914d\u7684\u5199\u7f13\u51b2\u533a\u7a7a\u95f4 net . ipv4 . udp_wmem_min = 16384 net . ipv4 . tcp_wmem = 4096 65536 25165824 # \u4e09\u4e2a\u53c2\u6570\u4f9d\u6b21\u4e3a\uff1a\u6700\u5c0f\u503c\uff0c\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c\uff1b\u6700\u5c0f\u503c\u8868\u793a\u65b0\u521b\u5efa\u7684 \u5957\u63a5\u5b57\u4f5c\u4e3a\u5176\u521b\u5efa\u7684\u4e00\u90e8\u5206\u6709\u6743\u83b7\u5f97\u7684\u6700\u5c0f\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff1b\u9ed8\u8ba4\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684 \u521d\u59cb\u5927\u5c0f\uff1b\u6700\u5927\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u7684\u81ea\u52a8\u8c03\u6574\u53d1\u9001\u7f13\u51b2\u533a\u7684\u6700\u5927\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u8be5\u503c\u4e0d\u4f1a\u8986\u76d6 net . core . rmem_max \u3002\u6839\u636e\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684\u5185\u5b58\u91cf\uff0c\u6b64\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\u4ecb\u4e8e 64 K \u5b57\u8282\u548c 4 M \u5b57\u8282\u4e4b\u95f4\u3002 \u5efa\u8bae\u4f7f\u7528 16 M \u5b57\u8282\u6216\u66f4\u9ad8\u7684\u6700\u5927\u503c\uff08\u53d6\u51b3\u4e8e\u5185\u6838\u7ea7\u522b\uff09\uff0c\u5c24\u5176\u662f 10 \u5343\u5146\u4f4d\u9002\u914d\u5668 # \u589e\u52a0\u53ef\u5206\u914d\u7684\u6700\u5927\u603b\u7f13\u51b2\u533a\u7a7a\u95f4,\u6b64\u4e3a\u4ee5 page \u4e3a\u5355\u4f4d\uff08 4096 \u5b57\u8282\uff09\u6d4b\u91cf net . ipv4 . udp_mem = 65536 131072 262144 net . ipv4 . tcp_mem = 65536 131072 262144 # \u7b2c\u4e00\u6b21\u4f4e\u4e8e\u6b64\u503c, TCP \u6ca1\u6709\u5185\u5b58\u538b\u529b,\u7b2c\u4e8c\u6b21\u8fdb\u5165\u5185\u5b58\u538b\u529b\u9636\u6bb5, \u7b2c\u4e09\u6b21 TCP \u62d2\u7edd\u5206\u914d socket ( \u9ed8\u8ba4\uff1a 5814 7754 11628 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u4e0b\uff1a / proc / sys / net / ipv4 / conf / #\u542f\u7528\u6e90\u8def\u7531\u6838\u67e5\u529f\u80fd\uff0c\u53cd\u5411\u8def\u5f84\u8fc7\u6ee4 # 0 \u2014\u2014\u672a\u8fdb\u884c\u6e90\u9a8c\u8bc1 # 1 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u4e25\u683c\u6a21\u5f0f # 2 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u677e\u6563\u6a21\u5f0f net . ipv4 . conf . all . rp_filter = 1 net . ipv4 . conf . default . rp_filter = 1 # \u786e\u4fdd\u65e0\u4eba\u80fd\u4fee\u6539\u8def\u7531\u8868 net . ipv4 . conf . all . accept_redirects = 0 net . ipv4 . conf . all . secure_redirects = 0 net . ipv4 . conf . default . accept_redirects = 0 # \u7981\u6b62 icmp \u91cd\u5b9a\u5411\u68c0\u67e5 net . ipv4 . conf . default . secure_redirects = 0 # \u4e0d\u5145\u5f53\u8def\u7531\u5668 net . ipv4 . conf . all . send_redirects = 0 net . ipv4 . conf . default . send_redirects = 0 # \u8bb0\u5f55\u5728\u4e0d\u53ef\u8fbe\u7684\u5730\u5740\u7684\u6570\u636e\u5305 ( \u9519\u8bef\u7684\u8def\u7531 ) \uff1b\u5f00\u542f\u5e76\u8bb0\u5f55\u6b3a\u9a97\u3001\u6e90\u8def\u7531\u3001\u91cd\u5b9a\u5411\u6570\u636e\u5305 net . ipv4 . conf . all . log_martians = 1 net . ipv4 . conf . default . log_martians = 1 net . ipv4 . conf . all . accept_source_route = 0 # \u5904\u7406\u65e0\u6e90\u8def\u7531\u7684\u5305 net . ipv4 . conf . default . accept_source_route = 0 # \u7981\u7528\u6240\u6709 IP \u6e90\u8def\u7531 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a / proc / sys / net / ipv4 / route / net . ipv4 . route . gc_timeout = 100 # \u8def\u7531\u5237\u65b0\u9891\u7387 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b ( \u9632\u706b\u5899\u76f8\u5173 ) \uff1a / proc / sys / net / netfilter / # nf_conntrack \u662f Linux \u5185\u6838\u8fde\u63a5\u8ddf\u8e2a\u7684\u6a21\u5757\uff1a\u4e0e nf_conntrack \u76f8\u5173\u7684\u5185\u6838\u53c2\u6570\u6709\u4e09\u4e2a\uff1a # 1 \u3001 nf_conntrack_max \uff1a\u8fde\u63a5\u8ddf\u8e2a\u8868\u7684\u5927\u5c0f\uff0c\u5efa\u8bae\u6839\u636e\u5185\u5b58\u8ba1\u7b97\u8be5\u503c CONNTRACK_MAX = RAMSIZE ( in bytes ) / 16384 / ( x / 32 ) \uff0c \u5e76\u6ee1\u8db3 nf_conntrack_max = 4 * nf_conntrack_buckets \uff0c\u9ed8\u8ba4 262144 # 2 \u3001 nf_conntrack_buckets \uff1a\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\uff0c ( nf_conntrack_max / nf_conntrack_buckets \u5c31\u662f\u6bcf\u6761\u54c8\u5e0c\u8bb0\u5f55\u94fe\u8868\u7684\u957f\u5ea6 ) \uff0c\u9ed8\u8ba4 65536 # 3 \u3001 nf_conntrack_tcp_timeout_established \uff1a tcp \u4f1a\u8bdd\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\uff1a 432000 ( 5 \u5929 ) # \u4ee5\u4e0b\u4e3a 64 \u5185\u5b58\u63a8\u8350\u914d\u7f6e net . nf_conntrack_max = 262144 net . netfilter . nf_conntrack_max = 65536 # \u7cfb\u7edf\u652f\u6301\u7684\u6700\u5927 ipv4 \u8fde\u63a5\u6570 ( \u9ed8\u8ba4\uff1a 65536 ) net . netfilter . nf_conntrack_tcp_timeout_established = 300 # \u5df2\u5efa\u7acb\u7684 tcp \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 ( \u9ed8\u8ba4\uff1a 43200 \uff0c\u5373 5 \u5929 ) net . netfilter . nf_conntrack_buckets = 1048576 ( \u9ed8\u8ba4\uff1a 65535 ) net . netfilter . nf_conntrack_tcp_timeout_time_wait = 30 # time_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 120 ) net . netfilter . nf_conntrack_tcp_timeout_close_wait = 60 # close_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 60 ) net . netfilter . nf_conntrack_tcp_timeout_fin_wait = 30 # fin_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 120 ) \u4e0d\u5e38\u7528\u8bbe\u7f6e\u548c\u8bb0\u5f55 \u00b6 \u670d\u52a1\u5668\u914d\u7f6e\u53cc\u673a\u4e92\u4fe1 \u00b6 # \u670d\u52a1\u56681\u7684IP\uff1a192.168.1.1 \u670d\u52a1\u56682\u7684IP\uff1a192.168.1.2 # \u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e0a\u5206\u522b\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c ssh-keygen -t rsa -b 4096 # \u521b\u5efa\u516c\u94a5\u548c\u5bc6\u94a5 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5c06\u81ea\u5df1\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 # \u5c06\u516c\u94a5\u4e92\u76f8\u590d\u5236\u5230\u5bf9\u5e94\u7684\u4e3b\u673a # \u65b9\u6cd5\u4e00:\u4f7f\u7528ssh-copy-id\u547d\u4ee4 ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.2 # \u57281\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.2,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.1 # \u57282\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.1,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys # \u65b9\u6cd5\u4e8c\uff1a\u4f7f\u7528ssh\u547d\u4ee4\u5e76\u7528cat\u8ffd\u52a0\u5230authorized_keys\u4e2d ssh 192 .168.1.2 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5728\u670d\u52a1\u56681\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56682\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 ssh 192 .168.1.1 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5728\u670d\u52a1\u56682\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56681\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 ssh 192 .168.1.2 ifconfig # \u6d4b\u8bd5,\u5728\u670d\u52a1\u56681\u4e0a\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u7684\u8bdd\u5c31\u65e0\u9700\u8f93\u5165\u5bc6\u7801\u4e5f\u80fd\u663e\u793a\u670d\u52a1\u56682\u7684\u7f51\u5361\u4fe1\u606f centos\u5b8c\u5168\u91cd\u88c5python\u548cyum \u00b6 # \u5220\u9664\u73b0\u6709Python rpm -qa | grep python | xargs rpm -ev --allmatches --nodeps # \u5f3a\u5236\u5220\u9664\u5df2\u5b89\u88c5\u7a0b\u5e8f\u53ca\u5176\u5173\u8054 whereis python | xargs rm -frv # \u5220\u9664\u6240\u6709\u6b8b\u4f59\u6587\u4ef6,xargs\uff0c\u5141\u8bb8\u4f60\u5bf9\u8f93\u51fa\u6267\u884c\u5176\u4ed6\u67d0\u4e9b\u547d\u4ee4 whereis python # \u9a8c\u8bc1\u5220\u9664\uff0c\u8fd4\u56de\u65e0\u7ed3\u679c # \u5220\u9664\u73b0\u6709\u7684yum rpm -qa | grep yum | xargs rpm -ev --allmatches --nodeps whereis yum | xargs rm -frv # \u4ecehttp://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\u4e0b\u8f7d\u76f8\u5e94\u7684\u5305,\u7531\u4e8e\u6e90\u4e2d\u7248\u672c\u4f1a\u66f4\u65b0\uff0c\u5177\u4f53\u8bf7\u67e5\u770bURL\u4e2d\u7684\u7248\u672c\uff01 rpm -Uvh --replacepkgs *.rpm # \u53ef\u80fd\u4e4b\u95f4\u8fd8\u9700\u8981zlib\u548czlib-devel\u5305\uff0c\u6839\u636e\u60c5\u51b5\u4e0b\u8f7d\u5e76\u5b89\u88c5\uff01\u5b89\u88c5\u5b8c\u8fdb\u884c\u6d4b\u8bd5 # \u6e90\u7801\u7f16\u8bd1\u5b89\u88c5yum wget http://yum.baseurl.org/download/3.4/yum-3.4.3.tar.gz tar xvf yum-3.4.3.tar.gz && cd yum-3.4.3 yummain.py install yum # \u5982\u679c\u7ed3\u679c\u63d0\u793a\u9519\u8bef\uff1a CRITICAL:yum.cli:Config Error: Error accessing file for config file:///etc/\u7f3a\u5c11\u914d\u7f6e\u6587\u4ef6 # \u5728etc\u76ee\u5f55\u4e0b\u9762\u65b0\u5efayum.conf\u6587\u4ef6\uff0c\u7136\u540e\u518d\u6b21\u8fd0\u884c yummain.py install yum\uff0c\u987a\u5229\u5b8c\u6210\u5b89\u88c5 \u666e\u901a\u8d26\u53f7\u8d4b\u4e88root\u6743\u9650 \u00b6 # \u5efa\u8bae\u4f7f\u7528\u65b9\u6cd5\u4e8c\uff0c\u4e0d\u8981\u8f7b\u6613\u4f7f\u7528\u65b9\u6cd5\u4e09 : << comment # \u65b9\u6cd5\u4e00\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230%wheel\u4e00\u884c\uff0c\u628a\u524d\u9762\u7684\u6ce8\u91ca\uff08#\uff09\u53bb\u6389 Allows people in group wheel to run all commands %wheel ALL=(ALL) ALL \u7136\u540e\u4fee\u6539\u7528\u6237\uff0c\u4f7f\u5176\u5c5e\u4e8eroot\u7ec4\uff08wheel\uff09\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a #usermod -g root tommy \u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c comment : << comment # \u65b9\u6cd5\u4e8c\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230root\u4e00\u884c\uff0c\u5728root\u4e0b\u9762\u6dfb\u52a0\u4e00\u884c\uff0c\u5982\u4e0b\u6240\u793a\uff1a Allow root to run any commands anywhere root ALL=(ALL) ALL tommy ALL=(ALL) ALL \u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c comment : << comment # \u65b9\u6cd5\u4e09\uff1a \u4fee\u6539 /etc/passwd \u6587\u4ef6\uff0c\u627e\u5230\u5982\u4e0b\u884c\uff0c\u628a\u7528\u6237ID\u4fee\u6539\u4e3a 0 \uff0c\u5982\u4e0b\u6240\u793a\uff1a tommy:x:500:500:tommy:/home/tommy:/bin/bash \u4fee\u6539\u540e\u5982\u4e0b tommy:x:0:500:tommy:/home/tommy:/bin/bash \u4fdd\u5b58\uff0c\u7528tommy\u8d26\u6237\u767b\u5f55\u540e\uff0c\u76f4\u63a5\u83b7\u53d6\u7684\u5c31\u662froot\u5e10\u53f7\u7684\u6743\u9650 comment \u672a\u91c7\u7528\u53cc\u673a\u70ed\u5907\u9632\u6b62\u670d\u52a1\u4e2d\u65ad--float IP(\u6d6e\u52a8IP\u914d\u7f6e) \u00b6 : << comment \u6709\u4e24\u53f0Linux\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u4e00\u53f0\u4e3b\u673a\uff08IP\uff1a192.168.2.2\uff09\u5bf9\u5916\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u53e6\u4e00\u53f0\u4ece\u673a\uff08IP\uff1a192.168.2.3\uff09\u80fd\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\uff0c\u4f46IP\u5730\u5740 \u6ca1\u6709\u5bf9\u5916\u90e8\u516c\u5f00,\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u90fd\u662f192.168.2.2\u8fd9\u4e2aIP\u5730\u5740\uff0c\u5982\u679c\u4e3b\u673a\u6545\u969c\uff0c\u5219\u4f1a\u4f7f\u7f51\u7edc\u670d\u52a1\u6682\u65f6\u4e2d\u65ad \u7531\u4e8e\u6ca1\u6709\u91c7\u7528\u53cc\u673a\u70ed\u5907\u4efd\u6280\u672f,\u8003\u8651\u7528Linux\u811a\u672c\u6765\u5b9e\u73b0\u7b80\u5355\u7684\u6d6e\u52a8IP\u6280\u672f\uff0c\u5f53\u4e3b\u673a\u6545\u969c\u65f6\u4ece\u673a\u83b7\u5f97192.168.2.2\u8fd9\u4e2aIP\uff0c\u6682\u65f6\u66ff\u4ee3\u4e3b\u673a\u63d0\u4f9b\u670d\u52a1\uff0c\u5f53\u4e3b\u673a \u6062\u590d\u65f6\uff0c\u4ece\u673a\u81ea\u52a8\u91ca\u653e\u8fd9\u4e2aIP \u601d\u8def\uff1a \u5229\u7528\u5355\u4e2a\u7f51\u5361\u7ed1\u5b9a\u591a\u4e2aIP\u5730\u5740\u7684\u6280\u672f\u548ccrontab\u81ea\u52a8\u6267\u884c\u6280\u672f \u4e3a\u4e3b\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u9759\u6001IP\uff0c\u5982192.168.2.8,\u8fd9\u4e2a\u5730\u5740\u4fbf\u4e8e\u4ece\u673a\u5224\u65ad\u7684 \u4e3a\u4ece\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u52a8\u6001IP\uff0c127.0.0.1\uff0c\u5b83\u5728\u4e3b\u673a\u6545\u969c\u65f6\u5c06\u4f1a\u88ab\u811a\u672c\u4fee\u6539\u4e3a192.168.2.2 \u5728\u4ece\u673a\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u811a\u672c /root/autoFloatIP.sh\uff0c\u4f7f\u7528crontab\u6280\u672f\u8ba9\u8fd9\u4e2a\u811a\u672c\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u8fd9\u4e2a\u811a\u672c\u7684\u4f5c\u7528\u662f\u5224\u65ad\u4e3b\u673a\u7684\u5730\u5740192.168.2.8\u80fd\u5426 Ping\u901a\uff0c\u4e00\u65e6\u4e0d\u6b63\u5e38\u5219\u5c06\u8ba9\u81ea\u5df1\u7684\u7f51\u5361\u591a\u4f59\u7684\u90a3\u4e2aIP\u5730\u5740\u6539\u4e3a192.168.2.2\uff0c\u5982\u679c\u4e3b\u673a\u6062\u590d\uff0c\u5219\u5c06\u8fd9\u4e2a\u5730\u5740\u6539\u56de\u4e3a127.0.0.1 comment # \u6b65\u9aa4\u5982\u4e0b\uff1a # 1. \u4e3a\u4e3b\u673a\u6dfb\u52a0\u4e00\u4e2a\u9759\u6001IP192.168.2.8\uff0c\u5728/etc/sysconfig/network-scripts\u76ee\u5f55\u4fee\u6539\u7c7b\u4f3cifcfg-eth0:1\u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a: DEVICE = eth0:1 IPADDR = 139 .24.214.82 NETMASK = 255 .255.255.0 ONBOOT = yes # 2. \u5728\u4ece\u673a\u4e0a\uff0c\u5728/root\u4e0b\u5efa\u7acb\u4e00\u4e2a\u811a\u672cautoFloatIP.sh,\u5185\u5bb9\u5982\u4e0b\uff1a #!/bin/bash c1 = $( ping 139 .24.214.82 -c 1 | grep Unreachable | wc -l ) if [ $c1 -gt 0 ] ; then c2 = $( ping 139 .24.214.82 -c 10 | grep Unreachable | wc -l ) if [ $c2 -gt 9 ] ; then c3 = $( ping 139 .24.214.22 -c 10 | grep Unreachable | wc -l ) if [ $c3 -gt 9 ] ; then /sbin/ifconfig eth0:1 139 .24.214.22 netmask 255 .255.254.0 echo \"float ip to 22\" fi fi echo \"can not connect\" else c4 = $( /sbin/ifconfig | grep 139 .24.214.22 | wc -l ) if [ $c4 -gt 0 ] ; then /sbin/ifconfig eth0:2 127 .0.0.1 netmask 255 .255.254.0 echo \"reset ip\" fi echo \"connection is ok\" fi # \u5176\u4e2d\u5173\u952e\u7684\u547d\u4ee4\u5982\u4e0b\uff0c\u7528\u8fd9\u4e2a\u65b9\u6cd5\u6765\u52a8\u6001\u4fee\u6539IP\uff0c\u52a8\u6001IP\u5728\u7535\u8111\u91cd\u542f\u4f1a\u6d88\u5931 /sbin/ifconfig eth0:1 139 .24.214.22 netmask 255 .255.254.0 /sbin/ifconfig eth0:2 127 .0.0.1 netmask 255 .255.254.0 # 3. \u4ece\u673a\u4e0a\u5efa\u7acbcrontab\uff0c\u52a0\u4e0a\u5982\u4e0b\u4e00\u884c\u5e76\u4fdd\u5b58 * * * * * /root/autoFloatIP.sh > /dev/null 2 > & 1 \u5b89\u88c5\u6700\u65b0\u7a33\u5b9acentos\u5185\u6838&\u66f4\u6539\u4e3a\u9759\u6001ip\u3001\u7f51\u5361\u540d\u79f0 \u00b6 # \u5728CentOS\u4e3b\u673a\u4e0a\u5b89\u88c5\u6700\u65b0\u7684\u7a33\u5b9a\u5185\u6838 # \u5bfc\u5165key\uff08\u5185\u68383.0\u4ee5\u4e0a\u9700\u8981\u5bfc\u5165key\uff09,\u5982\u679c\u5df2\u7ecf\u4fee\u6539\u4e86repo\u7684gpgcheck=0\u4e5f\u53ef\u4ee5\u4e0d\u5bfc\u5165key rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org # To install ELRepo for RHEL-6, SL-6 or CentOS-6 rpm -Uvh http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm # \u5b89\u88c5elrepo\u7684yum\u6e90,To install ELRepo for RHEL-7, SL-7 or CentOS-7 rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm # \u5b89\u88c5\u5185\u6838,\u5728yum\u7684ELRepo\u6e90\u4e2d\uff0c\u6709mainline\u9881\u5e03\u7684\uff0c\u53ef\u4ee5\u8fd9\u6837\u5b89\u88c5 yum --enablerepo = elrepo-kernel install kernel-ml-devel kernel-ml -y yum --enablerepo = elrepo-kernel install kernel-lt -y # \u5b89\u88c5long term\u7684\u5185\u6838 # \u914d\u7f6eGrub\u4f7f\u7528\u65b0\u5185\u6838\uff0c\u914d\u7f6e\u5b8c\u540e\u91cd\u542f\u542f\u7528\u65b0\u5185\u6838 ## CentOS 6\u914d\u7f6e\uff0c\u4fee\u6539/boot/grub/grub.conf default = 0 # \u66f4\u6539\u4e3a 0 fallback = 1 # \u6dfb\u52a0\u6b64\u9879 ## CentOS 7 grub2-set-default 0 grub2-install /dev/sda grub2-mkconfig -o /boot/grub2/grub.cfg # \u66f4\u6539\u4e3a\u9759\u6001IP\uff1a/etc/sysconfig/network-scripts/ifcfg-ens33 BOOTPROTO = \"static\" #dhcp\u6539\u4e3astatic ONBOOT = \"yes\" #\u5f00\u673a\u542f\u7528\u672c\u914d\u7f6e IPADDR = 192 .168.7.106 #\u9759\u6001IP GATEWAY = 192 .168.7.1 #\u9ed8\u8ba4\u7f51\u5173 NETMASK = 255 .255.255.0 #\u5b50\u7f51\u63a9\u7801 DNS1 = 192 .168.7.1 #DNS \u914d\u7f6e vim /etc/sysconfig/grub # \u7f16\u8f91 grub \u914d\u7f6e\u6587\u4ef6,\u5b9e\u9645\u662f/etc/default/grub\u7684\u8f6f\u8fde\u63a5 # \u4e3aGRUB_CMDLINE_LINUX\u53d8\u91cf\u589e\u52a02\u4e2a\u53c2\u6570\uff0c\u5177\u4f53\u5185\u5bb9\u5982\u4e0b(\u52a0\u7c97)\uff1a GRUB_CMDLINE_LINUX = \"crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap net.ifnames=0 biosdevname=0 rhgb quiet\" # \u91cd\u65b0\u751f\u6210 grub \u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8 Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u901a\u8fc7 ip addr \u53ef\u4ee5\u770b\u5230\u7f51\u5361\u540d\u79f0\u5df2\u7ecf\u53d8\u4e3a eth0 grub2-mkconfig -o /boot/grub2/grub.cfg # \u4fee\u6539\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\uff0c\u539f\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u4e3a ifcfg-ens33\uff0c\u8fd9\u91cc\u9700\u8981\u4fee\u6539\u4e3aethx\u7684\u683c\u5f0f\uff0c\u5e76\u9002\u5f53\u8c03\u6574\u7f51\u5361\u914d\u7f6e\u6587\u4ef6 mv /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-eth0 # \u4fee\u6539ifcfg-eth0\u6587\u4ef6\u5982\u4e0b\u5185\u5bb9(\u5176\u5b83\u5185\u5bb9\u4e0d\u53d8) NAME = eth0 DEVICE = eth0 systemctl restart network.service # \u91cd\u542f\u7f51\u7edc\u670d\u52a1\uff0c\u6ce8\u610f\uff1aifcfg-ens33 \u6587\u4ef6\u6700\u597d\u5220\u9664\u6389\uff0c\u5426\u5219\u91cd\u542f network \u670d\u52a1\u65f6\u5019\u4f1a\u62a5\u9519 Linux\u6570\u636e\u6062\u590d\uff1a\u6700\u597d\u662f\u5907\u4efd\u800c\u4e0d\u662f\u5c1d\u8bd5\u6062\u590d \u00b6 SystemRescueCd \u00b6 # \u5b98\u7f51\uff1ahttp://www.system-rescue-cd.org/ \u5176\u4ed6 \u00b6 # \u53c2\u8003\u94fe\u63a5\uff1a https : // help . ubuntu . com / community / DataRecovery \u60c5\u51b5\u4e00\uff1a\u4e22\u5931\u5206\u533a\uff1a\u5982\u679c\u5206\u533a\u51fa\u9519\u4e14\u5206\u533a\u8868\u4e0d\u663e\u793a\u8be5\u5206\u533a\uff0c\u53ea\u8981\u672a\u5411\u8be5\u7a7a\u95f4\u5199\u5165\u6570\u636e\uff0c\u5219\u6570\u636e\u4ecd\u4f1a\u5b58\u5728 # GNU Parted 1 . \u4f7f\u7528 live cd \u6216\u989d\u5916\u7cfb\u7edf\uff0c\u8fdb\u5165\u7cfb\u7edf\u7ec8\u7aef\u9996\u5148\u6267\u884c\uff0c swapoff - a \uff0c\u6302\u8f7d\u95ee\u9898\u78c1\u76d8 2 . \u8fd0\u884c partted \uff0c parted / dev / sda ,\u8fd9\u91cc / dev / sda \u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907 3 . \u8fd0\u884c\u6062\u590d\u9009\u9879\uff1a rescue START END \uff0c\u5982\u679c\u627e\u5230\u6f5c\u5728\u7684\u5206\u533a\u5219\u4f1a\u63d0\u793a\u662f\u5426\u6dfb\u52a0\u5230\u5206\u533a\u8868\u4e2d # Testdisk testdisk \u4e5f\u53ef\u4ee5\u6062\u590d\u5206\u533a\u3002\u5b89\u88c5 testdisk \u8f6f\u4ef6\u5305\u3002 \u8fd0\u884c testdisk \uff0c\u5b83\u5c06\u626b\u63cf\u60a8\u7684\u8ba1\u7b97\u673a\u4e2d\u7684\u4ecb\u8d28\uff0c\u5e76\u4e3a\u60a8\u63d0\u4f9b\u83dc\u5355\u9a71\u52a8\u7684\u65b9\u6cd5\u6765\u6062\u590d\u5206\u533a # Gpart \u5b89\u88c5 gpart \uff0c\u6267\u884c gpart / dev / sda \uff0c / dev / sda \u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907,\u6700\u597d\u662f gpart - W / dev / sda / dev / sdb \u5199\u5165\u5230\u53e6\u4e00\u4e2a\u8bbe\u5907 \u60c5\u51b5\u4e8c\uff1a\u6620\u50cf\u635f\u574f\u7684\u8bbe\u5907\uff0c\u6587\u4ef6\u7cfb\u7edf\u6216\u9a71\u52a8\u5668 # GNU ddrescue ( \u5b89\u88c5\u540e\u547d\u4ee4\u4e3a ddrescue ) \u7f51\u5740\uff1a http : // www . gnu . org / software / ddrescue / ddrescue . html # dd_rescue \u7f51\u5740\uff1a http : // www . garloff . de / kurt / linux / ddrescue / \u5982\u679c\u60a8\u6b63\u5728\u6210\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f\u5927\u4e8e 4 gig \uff0c\u5219\u5c06\u65e0\u6cd5\u4f7f\u7528 MSDOS \uff08 VFAT \uff09\u6587\u4ef6\u7cfb\u7edf\uff08\u901a\u5e38\u5728 USB \u9a71\u52a8\u5668\u4e0a\u627e\u5230\uff09\u6765\u5b58\u50a8\u56fe\u50cf\uff0c\u56e0\u4e3a\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a 4 G \u3002 \u8fd9\u6837\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u3002 \u4f7f\u7528 EXT3 \u6216\u5176\u4ed6\u53ef\u4ee5\u5904\u7406\u6b64\u7c7b\u6587\u4ef6\u5927\u5c0f\u7684\u6587\u4ef6\u7cfb\u7edf # \u5c06\u5728 / dev / hd2 \u7684\u5206\u533a\u6062\u590d\u5230 / dev / hdb2 ddrescue - r3 / dev / hda2 / dev / hdb2 logfie e2fsck - v - f / dev / hdb2 mount - t ext2 - o ro / dev / hdb2 / mnt # \u6062\u590d\u5728 / dev / cdrom \u4e2d\u7684\u4e00\u4e2a CD - ROM ,\u5c06 cdimage \u5199\u5165\u7a7a\u767d\u7684 CD - ROM ddrescue - b 2048 / dev / cdrom cdimage logfie \u4ece\u6062\u590d\u7684\u6620\u50cf\u63d0\u53d6\u6587\u4ef6\u7cfb\u7edf\u6765\u6062\u590d\u6587\u4ef6 \u5b89\u88c5 sleuthkit \u8f6f\u4ef6 mmls file - b \u6b64\u547d\u4ee4\u6765\u663e\u793a\u5728\u6620\u50cf\u4e2d\u627e\u5230\u7684\u5206\u533a mount - o loop , offset = 16384 file mnt \u663e\u793a\u591a\u4e2a\u5206\u533a\uff0c\u6b64\u793a\u4f8b\u4ece\u5757 32 \u5904\u5b89\u88c5 dos \u5206\u533a\uff0c\u8ba1\u7b97\u5b57\u8282\u6570\u9700\u8981\u4e58 512 \uff0c\u5f97\u51fa 16384 mount - t ntfs - or , force , loop , offset = 32256 file mnt \u6302\u8f7d windows \u521b\u5efa\u7684 ntfs \u5206\u533a ( 63 \u4e58 512 = 32256 ) \u5229\u7528 foremost \u6062\u590d\u6587\u4ef6,\u5047\u8bbe\u9700\u8981\u6062\u590d\u7684\u662f / dev / hda foremost - i / dev / hda - o / recovery / foremost foremost - t jpg - i / dev / hda - o / recovery / foremost \u6062\u590d\u7279\u5b9a\u7c7b\u578b\u6587\u4ef6 scalpel \u8f6f\u4ef6\u4e5f\u53ef\u7528\u6765\u6062\u590d\uff1a scalpel File - o dir File \u662f\u6620\u50cf\u6587\u4ef6\u6216\u8bbe\u5907\uff0c dir \u662f\u8f93\u51fa\u76ee\u5f55 magicrescue \u4f7f\u7528 magic bytes \u626b\u63cf\u6587\u4ef6\u6765\u8bc6\u522b\u6587\u4ef6\u7684\u5b58\u5728\u548c\u7c7b\u578b \u4ece / dev / sda1 \u5206\u533a\u6062\u590d gzip \u548c png \u6587\u4ef6\uff1a magicrescue - r gzip - r png - d ~/ output / dev / sda1 Photorec \u65e8\u5728\u4ece\u6570\u7801\u76f8\u673a\u7684\u5185\u5b58\u6216\u786c\u76d8\u4e2d\u6062\u590d\u4e22\u5931\u7684\u7167\u7247\uff0c\u5df2\u6269\u5c55\u652f\u6301 80 \u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u6587\u4ef6\uff0c photorec \u662f testdisk \u8f6f\u4ef6\u5305\u7684\u4e00\u90e8\u5206 ntfsprogs \u53ef\u4ee5\u4ece NTFS \u7cfb\u7edf\u6062\u590d\u5df2\u5220\u9664\u6587\u4ef6\uff0c Windows \u548c linux \u4e0b\u90fd\u6709\u6b64\u8f6f\u4ef6\uff0c\u5927\u81f4\u6709\u4e09\u79cd\u6a21\u5f0f\uff1a 1 . \u626b\u63cf\uff1a\u641c\u7d22\u5df2\u5220\u9664\u7684\u6587\u4ef6\u5e76\u67e5\u627e\u6709\u5173\u5b83\u4eec\u7684\u4fe1\u606f\uff0c nftsundelete / dev / sda1 2 . \u53d6\u6d88\u5220\u9664\uff1a ntfsundelete / dev / sda1 - u - i 3689 - o work . doc - d ~/ output 3 . \u590d\u5236\uff1a ntfsdelete / dev / sda1 - u - m * . jpg ntfsundelete / dev / sda1 - u - i 14159 \u6839\u636e\u6587\u4ef6\u7684 inode \u6062\u590d sleuth kit \u548c autopsy \u662f\u4e24\u4e2a\u57fa\u4e8e GUI \u7684\u6062\u590d\u8f6f\u4ef6 # extundelete \u4e3b\u9875\uff1a http : // extundelete . sourceforge . net / \u4e0b\u8f7d\u5730\u5740\uff1a http : // nchc . dl . sourceforge . net / project / extundelete / extundelete / 0 . 2 . 0 / extundelete - 0 . 2 . 0 . tar . bz2 ubuntu \u7528\u6237\u53ef\u76f4\u63a5\u5b89\u88c5: apt - get install extundelete . / configure && make && make install # \u5982\u679c\u63d0\u793a\u627e\u4e0d\u5230 ext2fs \u5e93\uff0c\u4f7f\u7528 yum - y install e2fsprogs * \u5b89\u88c5 # \u6570\u636e\u6062\u590d 1 . \u5378\u8f7d\u9700\u8981\u6062\u590d\u6587\u4ef6\u7684\u5206\u533a fuser - k / mnt / test / <-- \u7ed3\u675f\u4f7f\u7528\u67d0\u5206\u533a\u7684\u8fdb\u7a0b\u6811 umount / mnt / test <-- \u5378\u8f7d\u5206\u533a 2 . \u4f7f\u7528 extundelete \u67e5\u770b\u5206\u533a\u4e0a\u5b58\u5728\u7684\u6587\u4ef6 extundelete -- inode 2 / dev / sdb1 # -- inode \u4e3a\u67e5\u627e\u67d0 i \u8282\u70b9\u4e2d\u7684\u5185\u5bb9\uff0c\u4f7f\u7528 2 \u5219\u8bf4\u660e\u4e3a\u641c\u7d22\uff0c\u5982\u679c\u9700\u8fdb\u5165\u76ee\u5f55\u641c\u7d22\uff0c\u53ea\u987b\u8981\u6307\u5b9a\u76ee\u5f55 I \u8282\u70b9\u5373\u53ef # -- restore - inode \u6062\u590d\u6307\u5b9a\u7684 I \u8282\u70b9\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5168\u5c06\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6\u653e\u5728\u5f53\u524d\u8def\u5f84 RECOVERED_FILES / \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a file . I \u8282\u70b9\u53f7 extundelete -- restore - inode 13 / dev / sdb1 ls RECOVERED_FILES / mount / dev / sdb1 / mnt / test / mv RECOVERED_FILES / file . 13 / mnt / test / resolv . conf mv RECOVERED_FILES / file . 14 / mnt / test / hosts cat / mnt / test / hosts # \u67e5\u770b\u88ab\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6 \u662f\u5426\u4e0e\u6e90\u6587\u4ef6\u4e00\u81f4 cat / mnt / test / resolv . conf \u57fa\u672c\u670d\u52a1\u642d\u5efa \u00b6 Vsftp \u00b6 VSFTPv3 . 0 . 3 \u7248\u672c\u914d\u7f6e vsftpd . conf\u6587\u4ef6\u8be6\u89e3 vsftpd . conf\u7684\u683c\u5f0f\u975e\u5e38\u7b80\u5355 \u3002\u6bcf\u4e00\u884c\u90fd\u662f\u6ce8\u91ca\u6216\u6307\u4ee4\u3002\u6ce8\u91ca\u884c\u4ee5\uff03\u5f00\u5934\u5e76\u88ab\u5ffd\u7565\u3002\u6307\u4ee4\u884c\u7684\u683c\u5f0f\u4e3a\uff1a\u9009\u9879 = \u503c \u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\u5728\u9009\u9879\uff0c = \u548c\u503c\u4e4b\u95f4\u653e\u7f6e\u4efb\u4f55\u7a7a\u683c\u662f\u9519\u8bef\u7684\u3002\u6bcf\u4e2a\u8bbe\u7f6e\u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7f16\u8bd1\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539 / etc / rc . d / init . d / vsftpd # \u542f\u52a8\u811a\u672c / etc / pam . d / vsftpd # PAM\u8ba4\u8bc1\u6587\u4ef6 / etc / vsftpd / ftpusers # \u7981\u6b62\u4f7f\u7528 Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6 / etc / vsftpd / user_list # \u7981\u6b62\u6216\u5141\u8bb8\u4f7f\u7528 Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6 / var / ftp # \u533f\u540d\u7528\u6237\u4e3b\u76ee\u5f55 \u5e03\u5c14\u9009\u9879\u5217\u8868\uff0c\u5e03\u5c14\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u4e3a yes\u6216no allow_anon_ssl \u4ec5\u5728 ssl_enable \u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\u9002\u7528 \u3002\u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \u9ed8\u8ba4\u503c\uff1a NO anon_mkdir_write_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u521b\u5efa\u65b0\u76ee\u5f55\u3002\u4e3a\u6b64\uff0c \u5fc5\u987b\u6fc0\u6d3b\u9009\u9879 write_enable \uff0c\u5e76\u4e14\u533f\u540d ftp\u7528\u6237\u5fc5\u987b\u5177\u6709\u7236\u76ee\u5f55\u7684\u5199\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a NO anon_other_write_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u6267\u884c\u9664\u4e0a\u8f7d\u548c\u521b\u5efa\u76ee\u5f55\u4e4b\u5916\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982\u5220\u9664\u548c\u91cd\u547d\u540d\u3002\u901a\u5e38\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff0c\u4f46\u4e3a\u4e86\u5b8c\u6574\u6027\u800c\u5305\u62ec\u5728\u5185 \u9ed8\u8ba4\u503c\uff1a NO anon_upload_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u4e0a\u8f7d\u6587\u4ef6\u3002\u4e3a\u6b64\uff0c \u5fc5\u987b\u6fc0\u6d3b\u9009\u9879 write_enable \uff0c\u5e76\u4e14\u533f\u540d ftp\u7528\u6237\u5fc5\u987b\u5177\u6709\u6240\u9700\u4e0a\u8f7d\u4f4d\u7f6e\u7684\u5199\u5165\u6743\u9650 \u3002 \u865a\u62df\u7528\u6237\u4e0a\u4f20\u4e5f\u9700\u8981\u6b64\u8bbe\u7f6e , \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u865a\u62df\u7528\u6237\u4f7f\u7528\u533f\u540d\uff08\u5373\u6700\u5927\u9650\u5236\uff09\u6743\u9650\u8fdb\u884c\u5904\u7406 \u9ed8\u8ba4\u503c\uff1a NO anon_world_readable_only \u542f\u7528\u540e\uff0c\u5c06\u53ea\u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0b\u8f7d\u4e16\u754c\u53ef\u8bfb\u7684\u6587\u4ef6\u3002\u8fd9\u662f\u8ba4\u8bc6\u5230 ftp\u7528\u6237\u53ef\u80fd\u62e5\u6709\u6587\u4ef6 \uff0c\u5c24\u5176\u662f\u5728\u4e0a\u4f20\u7684\u60c5\u51b5\u4e0b \u9ed8\u8ba4\u503c\uff1a\u662f anonymous_enable \u63a7\u5236\u662f\u5426\u5141\u8bb8\u533f\u540d\u767b\u5f55\u3002\u5982\u679c\u542f\u7528\uff0c\u5219\u7528\u6237\u540d ftp \u548c anonymous \u90fd\u5c06\u88ab\u8bc6\u522b\u4e3a\u533f\u540d\u767b\u5f55 \u9ed8\u8ba4\u503c\uff1a YES ascii_download_enable \u542f\u7528\u540e\uff0c ASCII\u6a21\u5f0f\u6570\u636e\u4f20\u8f93\u5c06\u5728\u4e0b\u8f7d\u65f6\u53d7\u5230\u5c0a\u91cd \u9ed8\u8ba4\u503c\uff1a NO ascii_upload_enable \u542f\u7528\u540e\uff0c\u4e0a\u4f20\u65f6\u5c06\u9075\u5faa ASCII\u6a21\u5f0f\u6570\u636e\u4f20\u8f93 \u9ed8\u8ba4\u503c\uff1a NO async_abor_enable \u542f\u7528\u540e\uff0c\u5c06\u542f\u7528\u79f0\u4e3a\u201c\u5f02\u6b65 ABOR \u201d\u7684\u7279\u6b8a FTP\u547d\u4ee4 \u3002\u53ea\u6709\u4e0d\u660e\u667a\u7684 FTP\u5ba2\u6237\u7aef\u624d\u4f1a\u4f7f\u7528\u6b64\u529f\u80fd \u3002\u6b64\u5916\uff0c\u6b64\u529f\u80fd\u96be\u4ee5\u5904\u7406\uff0c\u56e0\u6b64\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7981\u7528\u3002\u9057\u61be\u7684\u662f\uff0c\u9664\u975e \u6b64\u529f\u80fd\u53ef\u7528\uff0c\u5426\u5219\u67d0\u4e9b FTP\u5ba2\u6237\u7aef\u5c06\u5728\u53d6\u6d88\u4f20\u8f93\u65f6\u6302\u8d77 \uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u5e0c\u671b\u542f\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a NO background \u542f\u7528\u540e\uff0c vsftpd\u4ee5 \u201c listen \u201d\u6a21\u5f0f\u542f\u52a8\uff0c vsftpd\u5c06\u4e3a\u4fa6\u542c\u5668\u8fdb\u7a0b\u63d0\u4f9b\u80cc\u666f \u3002\u5373\u63a7\u4ef6\u5c06\u7acb\u5373\u8fd4\u56de\u5230\u542f\u52a8 vsftpd\u7684shell \u9ed8\u8ba4\u503c\uff1a NO check_shell \u6ce8\u610f\uff01\u6b64\u9009\u9879\u4ec5\u5bf9 vsftpd\u7684\u975ePAM\u6784\u5efa\u6709\u6548 \u3002\u5982\u679c\u7981\u7528\uff0c vsftpd\u5c06\u4e0d\u4f1a\u68c0\u67e5 / etc / shells\u662f\u5426\u6709\u7528\u4e8e\u672c\u5730\u767b\u5f55\u7684\u7528\u6237shell \u9ed8\u8ba4\u503c\uff1a\u662f chmod_enable \u542f\u7528\u540e\uff0c\u5141\u8bb8\u4f7f\u7528 SITE CHMOD\u547d\u4ee4 \u3002\u6ce8\u610f\uff01\u8fd9\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u7528\u6237\u3002\u533f\u540d\u7528\u6237\u6c38\u8fdc\u4e0d\u4f1a\u4f7f\u7528 SITE CHMOD \u9ed8\u8ba4\u503c\uff1a\u662f chown_uploads \u5982\u679c\u542f\u7528\uff0c\u5219\u6240\u6709\u533f\u540d\u4e0a\u8f7d\u7684\u6587\u4ef6\u90fd\u5c06\u66f4\u6539\u4e3a\u8bbe\u7f6e chown_username\u4e2d\u6307\u5b9a\u7684\u7528\u6237 \u3002\u4ece\u7ba1\u7406\uff08\u53ef\u80fd\u662f\u5b89\u5168\u6027\uff09\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u5f88\u6709\u7528 \u9ed8\u8ba4\u503c\uff1a NO chroot_list_enable \u8bbe\u4e3a yes\u53ef\u4ee5\u5728\u767b\u5f55\u65f6\u63d0\u4f9b\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684chroot \uff08\uff09 jail\u4e2d\u7684\u672c\u5730\u7528\u6237\u5217\u8868 \u3002\u5982\u679c chroot_local_user\u8bbe\u7f6e\u4e3aYES \uff0c\u5219\u542b\u4e49\u7565\u6709\u4e0d\u540c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u5217\u8868\u4e0d\u88ab\u653e\u7f6e\u5728 chroot \uff08\uff09 jail\u4e2d\u7684\u7528\u6237\u5217\u8868 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5305\u542b\u6b64\u5217\u8868\u6587\u4ef6\u662f / etc / vsftpd . chroot_list \uff0c\u4f46\u53ef\u4f7f\u7528 chroot_list_file\u8bbe\u7f6e\u8986\u76d6\u5b83 \u9ed8\u8ba4\u503c\uff1a NO chroot_local_user \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u767b\u5f55\u540e\u672c\u5730\u7528\u6237\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\u5c06\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684 chroot \uff08\uff09 jail\u4e2d \u3002 \u8b66\u544a\uff1a \u6b64\u9009\u9879\u5177\u6709\u5b89\u5168\u9690\u60a3\uff0c\u5c24\u5176\u662f\u5728\u7528\u6237\u5177\u6709\u4e0a\u8f7d\u6743\u9650\u6216 shell\u8bbf\u95ee\u6743\u9650\u7684\u60c5\u51b5\u4e0b \u3002\u53ea\u6709\u5728\u60a8\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u65f6\u624d\u542f\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u5b89\u5168\u9690\u60a3\u4e0d\u662f vsftpd\u7279\u5b9a\u7684 \u3002 \u5b83\u4eec\u9002\u7528\u4e8e\u6240\u6709\u63d0\u4f9b\u5c06\u672c\u5730\u7528\u6237\u653e\u5165 chroot \uff08\uff09 jail\u7684FTP\u5b88\u62a4\u8fdb\u7a0b \u9ed8\u8ba4\u503c\uff1a NO connect_from_port_20 \u8fd9\u53ef\u4ee5\u63a7\u5236 PORT\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u662f\u5426\u5728\u670d\u52a1\u5668\u8ba1\u7b97\u673a\u4e0a\u4f7f\u7528\u7aef\u53e320 \uff08 ftp - data \uff09\u3002\u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0c\u4e00\u4e9b\u5ba2\u6237\u53ef\u80fd\u4f1a\u575a\u6301\u8ba4\u4e3a\u662f\u8fd9\u79cd\u60c5\u51b5\u3002\u76f8\u53cd\uff0c\u7981\u7528\u6b64\u9009\u9879 \u53ef\u4f7f vsftpd\u4ee5\u8f83\u4f4e\u7684\u6743\u9650\u8fd0\u884c \u9ed8\u8ba4\u503c\uff1a NO \uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 debug_ssl \u5982\u679c\u4e3a true \uff0c\u5219\u5c06 OpenSSL\u8fde\u63a5\u8bca\u65ad\u8f6c\u50a8\u5230vsftpd\u65e5\u5fd7\u6587\u4ef6 \u3002\uff08\u5728 v2 . 0 . 6 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO delete_failed_uploads \u5982\u679c\u4e3a true \uff0c\u5219\u5220\u9664\u4efb\u4f55\u5931\u8d25\u7684\u4e0a\u8f7d\u6587\u4ef6\u3002\uff08\u5728 v2 . 0 . 7 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO deny_email_enable \u5982\u679c\u6fc0\u6d3b\uff0c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u533f\u540d\u5bc6\u7801\u7535\u5b50\u90ae\u4ef6\u54cd\u5e94\u5217\u8868\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u767b\u5f55\u88ab\u62d2\u7edd\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5305\u542b\u6b64\u5217\u8868\u4e2d\u7684\u6587\u4ef6\u662f / etc / vsftpd . banned_emails \uff0c\u4f46\u4f60\u53ef\u4ee5\u4e0e \u8986\u76d6\u8fd9\u4e2a banned_email_file \u8bbe\u7f6e \u9ed8\u8ba4\u503c\uff1a NO dirlist_enable \u5982\u679c\u8bbe\u7f6e\u4e3a NO \uff0c\u5219\u6240\u6709\u76ee\u5f55\u5217\u8868\u547d\u4ee4\u90fd\u5c06\u62d2\u7edd\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a\u662f dirmessage_enable \u5982\u679c\u542f\u7528\uff0c FTP\u670d\u52a1\u5668\u7684\u7528\u6237\u9996\u6b21\u8fdb\u5165\u65b0\u76ee\u5f55\u65f6\u53ef\u4ee5\u663e\u793a\u6d88\u606f \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f1a\u626b\u63cf\u76ee\u5f55\u4ee5\u67e5\u627e\u6587\u4ef6 . message \uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u8bbe\u7f6e message_file\u8986\u76d6\u8be5\u76ee\u5f55 \u9ed8\u8ba4\u503c\uff1a NO \uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 download_enable \u5982\u679c\u8bbe\u7f6e\u4e3a NO \uff0c\u5219\u6240\u6709\u4e0b\u8f7d\u8bf7\u6c42\u90fd\u5c06\u62d2\u7edd\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a\u662f dual_log_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4f1a\u5e76\u884c\u751f\u6210\u4e24\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a / var / log / xferlog \u548c / var / log / vsftpd . log \u3002\u524d\u8005\u662f\u4e00\u4e2a wu - ftpd\u6837\u5f0f\u7684\u4f20\u8f93\u65e5\u5fd7 \uff0c\u53ef\u4ee5 \u901a\u8fc7\u6807\u51c6\u5de5\u5177\u89e3\u6790\u3002\u540e\u8005\u662f vsftpd\u81ea\u5df1\u7684\u6837\u5f0f\u65e5\u5fd7 \u9ed8\u8ba4\u503c\uff1a NO force_dot_files \u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u4ee5\u3002\u5f00\u5934\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u3002\u5373\u4f7f\u5ba2\u6237\u7aef\u672a\u4f7f\u7528\u201c a \u201d\u6807\u5fd7\uff0c\u4e5f\u5c06\u663e\u793a\u5728\u76ee\u5f55\u5217\u8868\u4e2d\u3002\u6b64\u8986\u76d6\u4e0d\u5305\u62ec\u201c\u3002\u201d \u548c\u201c .. \u201d\u6761\u76ee \u9ed8\u8ba4\u503c\uff1a NO force_anon_data_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \uff0c\u4ee5\u4fbf\u5728\u6570\u636e\u8fde\u63a5\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e \u9ed8\u8ba4\u503c\uff1a NO force_anon_logins_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5\u4ee5\u53d1\u9001\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1a NO force_local_data_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \uff0c\u4ee5\u4fbf\u5728\u6570\u636e\u8fde\u63a5\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e \u9ed8\u8ba4\u503c\uff1a\u662f force_local_logins_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5\u4ee5\u53d1\u9001\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1a\u662f guest_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u90fd\u88ab\u5f52\u7c7b\u4e3a\u201c\u8bbf\u5ba2\u201d\u767b\u5f55\u3002 guest \u865a\u62df\u673a\u767b\u5f55\u5c06\u91cd\u65b0\u6620\u5c04\u5230 guest_username \u8bbe\u7f6e\u4e2d\u6307\u5b9a\u7684\u7528\u6237 \u9ed8\u8ba4\u503c\uff1a NO hide_ids \u5982\u679c\u542f\u7528\uff0c\u76ee\u5f55\u5217\u8868\u4e2d\u7684\u6240\u6709\u7528\u6237\u548c\u7ec4\u4fe1\u606f\u5c06\u663e\u793a\u4e3a\u201c ftp \u201d \u9ed8\u8ba4\u503c\uff1a NO implicit_ssl \u5982\u679c\u542f\u7528\uff0c\u5219 SSL\u63e1\u624b\u662f\u6240\u6709\u8fde\u63a5 \uff08 FTPS\u534f\u8bae \uff09\u4e0a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u3002\u8981\u652f\u6301\u663e\u5f0f SSL\u548c / \u6216\u7eaf\u6587\u672c\uff0c\u8fd8\u5e94\u8fd0\u884c\u5355\u72ec\u7684 vsftpd\u4fa6\u542c\u5668\u8fdb\u7a0b \u9ed8\u8ba4\u503c\uff1a NO \u542c \u5982\u679c\u542f\u7528\uff0c vsftpd\u5c06\u4ee5\u72ec\u7acb\u6a21\u5f0f\u8fd0\u884c \u3002\u8fd9\u610f\u5473\u7740 vsftpd\u4e0d\u80fd\u4ece\u67d0\u79cd\u7c7b\u578b\u7684inetd\u8fd0\u884c \u3002\u76f8\u53cd\uff0c vsftpd\u53ef\u6267\u884c\u6587\u4ef6\u76f4\u63a5\u8fd0\u884c\u4e00\u6b21 \u3002 \u7136\u540e\uff0c vsftpd\u5c06\u8d1f\u8d23\u76d1\u542c\u548c\u5904\u7406\u4f20\u5165\u7684\u8fde\u63a5 \u9ed8\u8ba4\u503c\uff1a\u662f listen_ipv6 \u4e0e listen\u53c2\u6570\u4e00\u6837 \uff0c\u9664\u4e86 vsftpd\u5c06\u4fa6\u542cIPv6\u5957\u63a5\u5b57\u800c\u4e0d\u662fIPv4\u5957\u63a5\u5b57 \u3002\u6b64\u53c2\u6570\u548c listen\u53c2\u6570\u662f\u4e92\u65a5\u7684 \u9ed8\u8ba4\u503c\uff1a NO local_enable \u63a7\u5236\u662f\u5426\u5141\u8bb8\u672c\u5730\u767b\u5f55\u3002\u5982\u679c\u542f\u7528\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 / etc / passwd\u4e2d\u7684\u666e\u901a\u7528\u6237\u5e10\u6237 \uff08\u6216 PAM\u914d\u7f6e\u5f15\u7528\u7684\u4efb\u4f55\u4f4d\u7f6e \uff09\u767b\u5f55\u3002 \u5fc5\u987b\u542f\u7528\u6b64\u529f\u80fd\u624d\u80fd\u4f7f\u4efb\u4f55\u975e\u533f\u540d\u767b\u5f55\u5de5\u4f5c\uff0c\u5305\u62ec\u865a\u62df\u7528\u6237 \u9ed8\u8ba4\u503c\uff1a NO lock_upload_files \u542f\u7528\u540e\uff0c\u6240\u6709\u4e0a\u8f7d\u90fd\u4f1a\u7ee7\u7eed\u5bf9\u4e0a\u8f7d\u6587\u4ef6\u8fdb\u884c\u5199\u9501\u5b9a\u3002\u6240\u6709\u4e0b\u8f7d\u90fd\u7ee7\u7eed\u4e0b\u8f7d\u6587\u4ef6\u4e0a\u7684\u5171\u4eab\u8bfb\u9501\u5b9a\u3002 \u8b66\u544a\uff01\u5728\u542f\u7528\u6b64\u529f\u80fd\u4e4b\u524d\uff0c\u8bf7\u6ce8\u610f\u6076\u610f\u9605\u8bfb\u5668\u53ef\u80fd\u4f1a\u4f7f\u60f3\u8981\u6dfb\u52a0\u6587\u4ef6\u7684\u4f5c\u8005\u611f\u5230\u9965\u997f \u9ed8\u8ba4\u503c\uff1a\u662f log_ftp_protocol \u542f\u7528\u540e\uff0c\u5c06\u8bb0\u5f55\u6240\u6709 FTP\u8bf7\u6c42\u548c\u54cd\u5e94 \uff0c\u524d\u63d0\u662f\u672a\u542f\u7528 xferlog_std_format\u9009\u9879 \u3002\u7528\u4e8e\u8c03\u8bd5 \u9ed8\u8ba4\u503c\uff1a NO ls_recurse_enable \u542f\u7528\u540e\uff0c\u6b64\u8bbe\u7f6e\u5c06\u5141\u8bb8\u4f7f\u7528\u201c ls - R \u201d\u3002\u8fd9\u662f\u4e00\u4e2a\u8f83\u5c0f\u7684\u5b89\u5168\u98ce\u9669\uff0c\u56e0\u4e3a\u5927\u578b\u7ad9\u70b9\u9876\u5c42\u7684 ls - R\u53ef\u80fd\u4f1a\u6d88\u8017\u5927\u91cf\u8d44\u6e90 \u9ed8\u8ba4\u503c\uff1a NO mdtm_write \u542f\u7528\u540e\uff0c\u6b64\u8bbe\u7f6e\u5c06\u5141\u8bb8 MDTM\u8bbe\u7f6e\u6587\u4ef6\u4fee\u6539\u65f6\u95f4 \uff08\u6839\u636e\u901a\u5e38\u7684\u8bbf\u95ee\u68c0\u67e5\uff09 \u9ed8\u8ba4\u503c\uff1a\u662f no_anon_password \u542f\u7528\u540e\uff0c\u8fd9\u4f1a\u963b\u6b62 vsftpd\u8bf7\u6c42\u533f\u540d\u5bc6\u7801 - \u533f\u540d\u7528\u6237\u5c06\u76f4\u63a5\u767b\u5f55 \u9ed8\u8ba4\u503c\uff1a NO no_log_lock \u542f\u7528\u540e\uff0c\u8fd9\u4f1a\u963b\u6b62 vsftpd\u5728\u5199\u5165\u65e5\u5fd7\u6587\u4ef6\u65f6\u8fdb\u884c\u6587\u4ef6\u9501\u5b9a \u3002\u901a\u5e38\u4e0d\u5e94\u542f\u7528\u6b64\u9009\u9879\u3002\u5b83\u5b58\u5728\u4ee5\u89e3\u51b3\u64cd\u4f5c\u7cfb\u7edf\u9519\u8bef\uff0c\u4f8b\u5982 Solaris / Veritas\u6587\u4ef6\u7cfb\u7edf\u7ec4\u5408 \uff0c \u5df2\u7ecf\u89c2\u5bdf\u5230\u6709\u65f6\u4f1a\u51fa\u73b0\u8bd5\u56fe\u9501\u5b9a\u65e5\u5fd7\u6587\u4ef6\u7684\u6302\u8d77 \u9ed8\u8ba4\u503c\uff1a NO one_process_model \u5982\u679c\u60a8\u6709 Linux 2 . 4 \u5185\u6838\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u5b89\u5168\u6a21\u578b\uff0c\u6bcf\u4e2a\u8fde\u63a5\u53ea\u4f7f\u7528\u4e00\u4e2a\u8fdb\u7a0b\u3002\u5b83\u662f\u4e00\u79cd\u4e0d\u592a\u7eaf\u7cb9\u7684\u5b89\u5168\u6a21\u578b\uff0c\u4f46\u4f1a\u63d0\u9ad8\u60a8\u7684\u6027\u80fd\u3002 \u9664\u975e\u60a8\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\uff0c\u5e76\u4e14\u60a8\u7684\u7ad9\u70b9\u652f\u6301\u5927\u91cf\u540c\u65f6\u8fde\u63a5\u7684\u7528\u6237\uff0c\u5426\u5219\u60a8\u771f\u7684\u4e0d\u60f3\u542f\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a NO passwd_chroot_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4e0e chroot_local_user\u4e00\u8d77 \uff0c\u7136\u540e\u53ef\u4ee5\u57fa\u4e8e\u6bcf\u4e2a\u7528\u6237\u6307\u5b9a chroot \uff08\uff09 jail\u4f4d\u7f6e \u3002\u6bcf\u4e2a\u7528\u6237\u7684 jail\u90fd\u662f\u4ece / etc / passwd\u4e2d \u7684\u4e3b\u76ee\u5f55\u5b57\u7b26\u4e32\u6d3e\u751f\u7684\u3002\u4e3b\u76ee\u5f55\u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0 / . / \u8868\u793a jail\u4f4d\u4e8e\u8def\u5f84\u4e2d\u7684\u7279\u5b9a\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1a NO pasv_addr_resolve \u5982\u679c\u8981\u5728 pasv_address \u9009\u9879\u4e2d\u4f7f\u7528\u4e3b\u673a\u540d\uff08\u800c\u4e0d\u662f IP\u5730\u5740 \uff09\uff0c\u8bf7\u8bbe\u7f6e\u4e3a YES \u9ed8\u8ba4\u503c\uff1a NO pasv_enable \u5982\u679c\u8981\u7981\u7528 PASV\u83b7\u53d6\u6570\u636e\u8fde\u63a5\u7684\u65b9\u6cd5 \uff0c\u8bf7\u8bbe\u7f6e\u4e3a NO \u9ed8\u8ba4\u503c\uff1a\u662f pasv_promiscuous \u5982\u679c\u8981\u7981\u7528 PASV\u5b89\u5168\u68c0\u67e5 \uff0c\u5219\u8bbe\u7f6e\u4e3a YES \uff0c\u4ee5\u786e\u4fdd\u6570\u636e\u8fde\u63a5\u6e90\u81ea\u4e0e\u63a7\u5236\u8fde\u63a5\u76f8\u540c\u7684 IP\u5730\u5740 \u3002\u53ea\u6709\u5728\u4f60\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u542f\u7528\u5bf9\u6b64\u7684\u552f\u4e00\u5408\u6cd5 \u7528\u9014\u662f\u91c7\u7528\u67d0\u79cd\u5f62\u5f0f\u7684\u5b89\u5168\u96a7\u9053\u65b9\u6848\uff0c\u6216\u8005\u53ef\u80fd\u662f\u4e3a\u4e86\u4fc3\u8fdb FXP\u652f\u6301 \u9ed8\u8ba4\u503c\uff1a NO port_enable \u5982\u679c\u8981\u7981\u6b62 PORT\u65b9\u6cd5\u83b7\u53d6\u6570\u636e\u8fde\u63a5 \uff0c\u8bf7\u8bbe\u7f6e\u4e3a NO \u9ed8\u8ba4\u503c\uff1a\u662f port_promiscuous \u5982\u679c\u8981\u7981\u7528 PORT\u5b89\u5168\u68c0\u67e5 \uff0c\u5219\u8bbe\u7f6e\u4e3a YES \uff0c\u4ee5\u786e\u4fdd\u4f20\u51fa\u6570\u636e\u8fde\u63a5\u53ea\u80fd\u8fde\u63a5\u5230\u5ba2\u6237\u7aef\u3002\u53ea\u6709\u5728\u4f60\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u542f\u7528 \u9ed8\u8ba4\u503c\uff1a NO require_cert \u5982\u679c\u8bbe\u7f6e\u4e3a yes \uff0c\u5219\u9700\u8981\u6240\u6709 SSL\u5ba2\u6237\u7aef\u8fde\u63a5\u6765\u63d0\u4f9b\u5ba2\u6237\u7aef\u8bc1\u4e66 \u3002\u5e94\u7528\u4e8e\u6b64\u8bc1\u4e66\u7684\u9a8c\u8bc1\u7a0b\u5ea6\u7531 validate_cert\u63a7\u5236 \uff08\u5728 v2 . 0 . 6 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO require_ssl_reuse \u5982\u679c\u8bbe\u7f6e\u4e3a yes \uff0c\u5219\u9700\u8981\u6240\u6709 SSL\u6570\u636e\u8fde\u63a5\u4ee5\u5c55\u793aSSL\u4f1a\u8bdd\u91cd\u7528 \uff08\u8fd9\u8bc1\u660e\u5b83\u4eec\u77e5\u9053\u4e0e\u63a7\u5236\u901a\u9053\u76f8\u540c\u7684\u4e3b\u5bc6\u94a5\uff09\u3002\u867d\u7136\u8fd9\u662f\u4e00\u4e2a\u5b89\u5168\u7684\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u4f46\u5b83\u53ef\u80fd\u4f1a\u7834\u574f \u8bb8\u591a FTP\u5ba2\u6237\u7aef \uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u5e0c\u671b\u7981\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a\u662f run_as_launching_user \u5982\u679c\u60a8\u5e0c\u671b vsftpd\u4ee5\u542f\u52a8vsftpd\u7684\u7528\u6237\u8eab\u4efd\u8fd0\u884c \uff0c\u8bf7\u8bbe\u7f6e\u4e3a YES \u3002\u5728\u6839\u8bbf\u95ee\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5f88\u6709\u7528\u3002\u5927\u89c4\u6a21\u8b66\u544a\uff01\u9664\u975e\u60a8\u5b8c\u5168\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\uff0c \u5426\u5219\u4e0d\u8981\u542f\u7528\u6b64\u9009\u9879\uff0c\u56e0\u4e3a\u5929\u771f\u5730\u4f7f\u7528\u6b64\u9009\u9879\u4f1a\u4ea7\u751f\u5927\u91cf\u5b89\u5168\u95ee\u9898\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u8bbe\u7f6e\u6b64\u9009\u9879\u65f6\uff0c vsftpd\u4e0d\u4f1a / \u4e0d\u80fd\u4f7f\u7528 chroot\u6280\u672f\u6765\u9650\u5236\u6587\u4ef6\u8bbf\u95ee \uff08\u5373\u4f7f\u7531 root\u542f\u52a8 \uff09\u3002\u4e00\u4e2a\u7cdf\u7cd5\u7684\u66ff\u4ee3\u54c1\u53ef\u80fd\u662f\u4f7f\u7528 deny_file \u8bbe\u7f6e\u5982{ /* }\uff0c\u4f46\u8fd9\u79cd\u53ef\u9760\u6027\u65e0\u6cd5\u4e0echroot\u76f8\u6bd4\uff0c\u5e76\u4e14\u4e0d\u5e94\u8be5\u4f9d\u8d56\u3002\u5982\u679c\u4f7f\u7528\u6b64\u9009\u9879\uff0c \u5219\u9002\u7528\u5bf9\u5176\u4ed6\u9009\u9879\u7684\u8bb8\u591a\u9650\u5236\u3002\u4f8b\u5982\uff0c\u9700\u8981\u6743\u9650\u7684\u9009\u9879\uff08\u4f8b\u5982\u975e\u533f\u540d\u767b\u5f55\uff0c\u4e0a\u8f7d\u6240\u6709\u6743\u66f4\u6539\uff0c\u4ece\u7aef\u53e320\u8fde\u63a5\u548c\u5c0f\u4e8e1024\u7684\u4fa6\u542c\u7aef\u53e3\uff09\u9884\u8ba1\u4e0d\u8d77\u4f5c\u7528\u3002 \u5176\u4ed6\u9009\u9879\u53ef\u80fd\u4f1a\u53d7\u5230\u5f71\u54cd \u9ed8\u8ba4\u503c\uff1aNO secure_email_list_enable \u5982\u679c\u60a8\u53ea\u60f3\u63a5\u53d7\u533f\u540d\u767b\u5f55\u7684\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u5bc6\u7801\u5217\u8868\uff0c\u8bf7\u8bbe\u7f6e\u4e3aYES\u3002\u8fd9\u975e\u5e38\u6709\u7528\uff0c\u53ef\u4ee5\u5728\u4e0d\u9700\u8981\u865a\u62df\u7528\u6237\u7684\u60c5\u51b5\u4e0b\u9650\u5236\u5bf9\u4f4e\u5b89\u5168\u6027\u5185\u5bb9\u7684\u8bbf\u95ee\u3002\u542f\u7528\u540e\uff0c\u9664\u975e \u63d0\u4f9b\u7684\u5bc6\u7801\u5217\u5728email_password_file \u8bbe\u7f6e\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\uff0c\u5426\u5219\u5c06\u963b\u6b62\u533f\u540d\u767b\u5f55 \u3002\u6587\u4ef6\u683c\u5f0f\u662f\u6bcf\u884c\u4e00\u4e2a\u5bc6\u7801\uff0c\u6ca1\u6709\u989d\u5916\u7684\u7a7a\u683c\u3002 \u9ed8\u8ba4\u6587\u4ef6\u540d\u662f/etc/vsftpd.email_passwords \u9ed8\u8ba4\u503c\uff1aNO session_support \u8fd9\u53ef\u4ee5\u63a7\u5236vsftpd\u662f\u5426\u5c1d\u8bd5\u7ef4\u62a4\u767b\u5f55\u4f1a\u8bdd\u3002\u5982\u679cvsftpd\u7ef4\u62a4\u4f1a\u8bdd\uff0c\u5b83\u5c06\u5c1d\u8bd5\u66f4\u65b0utmp\u548cwtmp\u3002\u5982\u679c\u4f7f\u7528PAM\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5b83\u4e5f\u4f1a\u6253\u5f00\u4e00\u4e2apam_session\uff0c \u5e76\u4e14\u53ea\u6709\u5728\u6ce8\u9500\u65f6\u5173\u95ed\u5b83\u3002\u5982\u679c\u60a8\u4e0d\u9700\u8981\u4f1a\u8bdd\u65e5\u5fd7\u8bb0\u5f55\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u7981\u7528\u6b64\u529f\u80fd\uff0c\u5e76\u4e14\u60a8\u5e0c\u671b\u4e3avsftpd\u63d0\u4f9b\u66f4\u591a\u673a\u4f1a\u4ee5\u66f4\u5c11\u7684\u8fdb\u7a0b\u548c/\u6216\u66f4\u5c11\u7684\u6743\u9650\u8fd0\u884c\u3002 \u6ce8 - utmp\u548cwtmp\u652f\u6301\u4ec5\u5728PAM\u542f\u200b\u200b\u7528\u7684\u7248\u672c\u4e2d\u63d0\u4f9b \u9ed8\u8ba4\u503c\uff1aNO setproctitle_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u5c1d\u8bd5\u5728\u7cfb\u7edf\u8fdb\u7a0b\u5217\u8868\u4e2d\u663e\u793a\u4f1a\u8bdd\u72b6\u6001\u4fe1\u606f\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u62a5\u544a\u7684\u8fdb\u7a0b\u540d\u79f0\u5c06\u66f4\u6539\u4ee5\u53cd\u6620vsftpd\u4f1a\u8bdd\u6b63\u5728\u6267\u884c\u7684\u64cd\u4f5c\uff08\u7a7a\u95f2\uff0c\u4e0b\u8f7d\u7b49\uff09\u3002 \u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5c06\u5176\u5173\u95ed \u9ed8\u8ba4\u503c\uff1aNO ssl_enable \u5982\u679c\u542f\u7528\uff0c\u5e76\u4e14vsftpd\u662f\u9488\u5bf9OpenSSL\u7f16\u8bd1\u7684\uff0c\u5219vsftpd\u5c06\u901a\u8fc7SSL\u652f\u6301\u5b89\u5168\u8fde\u63a5\u3002\u8fd9\u9002\u7528\u4e8e\u63a7\u5236\u8fde\u63a5\uff08\u5305\u62ec\u767b\u5f55\uff09\u4ee5\u53ca\u6570\u636e\u8fde\u63a5\u3002 \u60a8\u4e5f\u9700\u8981\u4e00\u4e2a\u652f\u6301SSL\u7684\u5ba2\u6237\u7aef\u3002\u6ce8\u610f\uff01\uff01\u8bf7\u6ce8\u610f\u542f\u7528\u6b64\u9009\u9879\u3002\u53ea\u6709\u5728\u9700\u8981\u65f6\u624d\u542f\u7528\u5b83\u3002vsftpd\u65e0\u6cd5\u4fdd\u8bc1OpenSSL\u5e93\u7684\u5b89\u5168\u6027\u3002\u901a\u8fc7\u542f\u7528\u6b64\u9009\u9879\uff0c \u60a8\u58f0\u660e\u60a8\u4fe1\u4efb\u5df2\u5b89\u88c5\u7684OpenSSL\u5e93\u7684\u5b89\u5168\u6027 \u9ed8\u8ba4\u503c\uff1aNO ssl_request_cert \u5982\u679c\u542f\u7528\uff0cvsftpd\u4f1a\u8981\u6c42\uff08\u4f46\u4e0d\u4e00\u5b9a\u9700\u8981,\u89c1 require_cert\uff09\u4e00\u4e2a\u8bc1\u4e66\u4e0a\u7684\u4f20\u5165 SSL \u8fde\u63a5\u3002\u901a\u5e38\u8fd9 \u4e0d\u5e94\u8be5\u9020\u6210\u4efb\u4f55\u9ebb\u70e6 \u9ed8\u8ba4\u503c\uff1a\u662f ssl_sslv2 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8SSL v2\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1aNO ssl_sslv3 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8SSL v3\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1aNO ssl_tlsv1 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8TLS v1\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1a\u662f strict_ssl_read_eof \u5982\u679c\u542f\u7528\uff0c\u5219\u9700\u8981\u901a\u8fc7SSL\u7ec8\u6b62SSL\u6570\u636e\u4e0a\u8f7d\uff0c\u800c\u4e0d\u662f\u5957\u63a5\u5b57\u4e0a\u7684EOF\u3002\u9700\u8981\u6b64\u9009\u9879\u4ee5\u786e\u4fdd\u653b\u51fb\u8005\u672a\u4f7f\u7528\u4f2a\u9020\u7684TCP FIN\u8fc7\u65e9\u7ec8\u6b62\u4e0a\u8f7d\u3002\u4e0d\u5e78\u7684\u662f\uff0c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u6ca1\u6709\u542f\u7528\uff0c\u56e0\u4e3a\u5f88\u5c11\u6709\u5ba2\u6237\u7aef\u80fd\u591f\u6b63\u786e\u4f7f\u7528\u5b83\u3002\uff08v2.0.7\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO strict_ssl_write_shutdown \u5982\u679c\u542f\u7528\uff0c\u5219\u9700\u8981\u901a\u8fc7SSL\u7ec8\u6b62SSL\u6570\u636e\u4e0b\u8f7d\uff0c\u800c\u4e0d\u662f\u5957\u63a5\u5b57\u4e0a\u7684EOF\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u662f\u5173\u95ed\u7684\uff0c\u56e0\u4e3a\u6211\u65e0\u6cd5\u627e\u5230\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u5355\u4e2aFTP\u5ba2\u6237\u7aef\u3002 \u8fd9\u662f\u6b21\u8981\u7684\u3002\u5b83\u5f71\u54cd\u7684\u662f\u6211\u4eec\u5224\u65ad\u5ba2\u6237\u662f\u5426\u786e\u8ba4\u5b8c\u5168\u6536\u5230\u8be5\u6587\u4ef6\u7684\u80fd\u529b\u3002\u5373\u4f7f\u6ca1\u6709\u6b64\u9009\u9879\uff0c\u5ba2\u6237\u7aef\u4e5f\u80fd\u591f\u68c0\u67e5\u4e0b\u8f7d\u7684\u5b8c\u6574\u6027\u3002\uff08v2.0.7\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO syslog_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4efb\u4f55\u5df2\u8f6c\u81f3/var/log/vsftpd.log\u7684\u65e5\u5fd7\u8f93\u51fa\u5c06\u8f6c\u5230\u7cfb\u7edf\u65e5\u5fd7\u3002\u8bb0\u5f55\u5728FTPD\u5de5\u5177\u4e0b\u5b8c\u6210 \u9ed8\u8ba4\u503c\uff1aNO tcp_wrappers\u7684 \u5982\u679c\u542f\u7528\uff0c\u5e76\u4e14vsftpd\u662f\u4f7f\u7528tcp_wrappers\u652f\u6301\u7f16\u8bd1\u7684\uff0c\u5219\u4f20\u5165\u8fde\u63a5\u5c06\u901a\u8fc7tcp_wrappers\u8bbf\u95ee\u63a7\u5236\u63d0\u4f9b\u3002\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u79cd\u57fa\u4e8e\u6bcf\u4e2aIP\u7684\u914d\u7f6e\u673a\u5236\u3002 \u5982\u679ctcp_wrappers\u8bbe\u7f6eVSFTPD_LOAD_CONF\u73af\u5883\u53d8\u91cf\uff0c\u5219vsftpd\u4f1a\u8bdd\u5c06\u5c1d\u8bd5\u52a0\u8f7d\u6b64\u53d8\u91cf\u4e2d\u6307\u5b9a\u7684vsftpd\u914d\u7f6e\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1aNO text_userdb_names \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6570\u5b57ID\u663e\u793a\u5728\u76ee\u5f55\u5217\u8868\u7684\u7528\u6237\u548c\u7ec4\u5b57\u6bb5\u4e2d\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u6b64\u53c2\u6570\u6765\u83b7\u53d6\u6587\u672c\u540d\u79f0\u3002\u51fa\u4e8e\u6027\u80fd\u539f\u56e0\uff0c\u5b83\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u9ed8\u8ba4\u503c\uff1aNO tilde_user_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u5c1d\u8bd5\u89e3\u6790\u8def\u5f84\u540d\uff0c\u4f8b\u5982~chris / pics\uff0c\u5373\u4ee3\u5b57\u53f7\u540e\u8ddf\u7528\u6237\u540d\u3002\u8bf7\u6ce8\u610f\uff0cvsftpd\u5c06\u59cb\u7ec8\u89e3\u6790\u8def\u5f84\u540d\u301c\u548c\u301c/ something \uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u301c\u89e3\u6790\u4e3a\u521d\u59cb\u767b\u5f55\u76ee\u5f55\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u53ea\u6709 \u5728_current_ chroot\uff08\uff09jail\u4e2d\u627e\u5230\u6587\u4ef6/ etc / passwd\u65f6\uff0c\u301c\u7528\u6237\u8def\u5f84\u624d\u4f1a\u89e3\u6790 \u9ed8\u8ba4\u503c\uff1aNO use_localtime \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u663e\u793a\u5f53\u524d\u65f6\u533a\u4e2d\u5305\u542b\u65f6\u95f4\u7684\u76ee\u5f55\u5217\u8868\u3002\u9ed8\u8ba4\u4e3a\u663e\u793aGMT\u3002MDTM FTP\u547d\u4ee4\u8fd4\u56de\u7684\u65f6\u95f4\u4e5f\u53d7\u6b64\u9009\u9879\u7684\u5f71\u54cd \u9ed8\u8ba4\u503c\uff1aNO use_sendfile \u7528\u4e8e\u6d4b\u8bd5\u5728\u5e73\u53f0\u4e0a\u4f7f\u7528sendfile\uff08\uff09\u7cfb\u7edf\u8c03\u7528\u7684\u76f8\u5bf9\u597d\u5904\u7684\u5185\u90e8\u8bbe\u7f6e \u9ed8\u8ba4\u503c\uff1a\u662f userlist_deny \u5982\u679c \u6fc0\u6d3buserlist_enable\uff0c\u5219\u68c0\u67e5\u6b64\u9009\u9879 \u3002\u5982\u679c\u5c06\u6b64\u8bbe\u7f6e\u8bbe\u7f6e\u4e3aNO\uff0c\u5219\u5c06\u62d2\u7edd\u7528\u6237\u767b\u5f55\uff0c\u9664\u975e\u5b83\u4eec\u660e\u786e\u5217\u5728userlist_file\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d \u3002 \u62d2\u7edd\u767b\u5f55\u65f6\uff0c\u5c06\u5728\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4e4b\u524d\u53d1\u51fa\u62d2\u7edd \u9ed8\u8ba4\u503c\uff1a\u662f userlist_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u4eceuserlist_file\u7ed9\u51fa\u7684\u6587\u4ef6\u540d\u52a0\u8f7d\u7528\u6237\u540d\u5217\u8868 \u3002\u5982\u679c\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u6b64\u6587\u4ef6\u4e2d\u7684\u540d\u79f0\u767b\u5f55\uff0c\u5219\u5728\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u4e4b\u524d\uff0c \u4ed6\u4eec\u5c06\u88ab\u62d2\u7edd\u3002\u8fd9\u53ef\u80fd\u6709\u52a9\u4e8e\u9632\u6b62\u4f20\u8f93\u660e\u6587\u5bc6\u7801\u3002\u53e6\u8bf7\u53c2\u89c1 userlist_deny \u9ed8\u8ba4\u503c\uff1aNO validate_cert \u5982\u679c\u8bbe\u7f6e\u4e3ayes\uff0c\u5219\u6536\u5230\u7684\u6240\u6709SSL\u5ba2\u6237\u7aef\u8bc1\u4e66\u90fd\u5fc5\u987b\u9a8c\u8bc1OK\u3002\u81ea\u7b7e\u540d\u8bc1\u4e66\u4e0d\u6784\u6210OK\u9a8c\u8bc1\u3002\uff08v2.0.6\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO virtual_use_local_privs \u5982\u679c\u542f\u7528\uff0c\u865a\u62df\u7528\u6237\u5c06\u4f7f\u7528\u4e0e\u672c\u5730\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u865a\u62df\u7528\u6237\u5c06\u4f7f\u7528\u4e0e\u533f\u540d\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\uff0c\u8fd9\u5f80\u5f80\u66f4\u5177\u9650\u5236\u6027\uff08\u7279\u522b\u662f\u5728\u5199\u8bbf\u95ee\u65b9\u9762\uff09 \u9ed8\u8ba4\u503c\uff1aNO WRITE_ENABLE \u8fd9\u53ef\u4ee5\u63a7\u5236\u662f\u5426\u5141\u8bb8\u4efb\u4f55\u66f4\u6539\u6587\u4ef6\u7cfb\u7edf\u7684FTP\u547d\u4ee4\u3002\u7528\u6237\u5bf9ftp\u670d\u52a1\u5668\u7684\u5199\u6743\u9650\u3002\u8fd9\u4e9b\u547d\u4ee4\u662f\uff1aSTOR\uff0cDELE\uff0cRNFR\uff0cRNTO\uff0cMKD\uff0cRMD\uff0cAPPE\u548cSITE \u9ed8\u8ba4\u503c\uff1aNO xferlog_enable \u5982\u679c\u542f\u7528\uff0c\u5c06\u4fdd\u7559\u65e5\u5fd7\u6587\u4ef6\uff0c\u8be6\u7ec6\u8bf4\u660e\u4e0a\u8f7d\u548c\u4e0b\u8f7d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u6587\u4ef6\u5c06\u653e\u5728/var/log/vsftpd.log\u4e2d\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u8bbe\u7f6evsftpd_log_file\u8986\u76d6\u6b64\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1aNO\uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 xferlog_std_format \u5982\u679c\u542f\u7528\uff0c\u4f20\u8f93\u65e5\u5fd7\u6587\u4ef6\u5c06\u4ee5\u6807\u51c6xferlog\u683c\u5f0f\u5199\u5165\uff0c\u5982wu-ftpd\u6240\u4f7f\u7528\u3002\u8fd9\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u60a8\u53ef\u4ee5\u91cd\u7528\u73b0\u6709\u7684\u4f20\u8f93\u7edf\u8ba1\u4fe1\u606f\u751f\u6210\u5668 \u4f46\u662f\uff0c \u9ed8\u8ba4\u683c\u5f0f\u66f4\u5177\u53ef\u8bfb\u6027\u3002\u6b64\u6837\u5f0f\u7684\u65e5\u5fd7\u6587\u4ef6\u7684\u7f3a\u7701\u4f4d\u7f6e\u662f/ var / log / xferlog\uff0c\u4f46\u60a8\u53ef\u4ee5\u4f7f\u7528xferlog_file\u8bbe\u7f6e\u8fdb\u884c \u66f4\u6539 \u9ed8\u8ba4\u503c\uff1aNO \u6570\u5b57\u9009\u9879 \u4ee5\u4e0b\u662f\u6570\u5b57\u9009\u9879\u5217\u8868\u3002\u5fc5\u987b\u5c06\u6570\u5b57\u9009\u9879\u8bbe\u7f6e\u4e3a\u975e\u8d1f\u6574\u6570\u3002\u652f\u6301\u516b\u8fdb\u5236\u6570\uff0c\u4ee5\u65b9\u4fbfumask\u9009\u9879\u3002\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u6570\uff0c\u8bf7\u4f7f\u75280\u4f5c\u4e3a\u6570\u5b57\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57 accept_timeout \u8fdc\u7a0b\u5ba2\u6237\u7aef\u4e0ePASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5efa\u7acb\u8fde\u63a5\u7684\u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a60 anon_max_rate \u533f\u540d\u5ba2\u6237\u7aef\u5141\u8bb8\u7684\u6700\u5927\u6570\u636e\u4f20\u8f93\u901f\u7387\uff08\u4ee5\u5b57\u8282/\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 anon_umask \u4e3a\u533f\u540d\u7528\u6237\u8bbe\u7f6e\u7528\u4e8e\u6587\u4ef6\u521b\u5efa\u7684umask\u7684\u503c\u3002\u6ce8\u610f\uff01\u5982\u679c\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u503c\uff0c\u8bf7\u8bb0\u4f4f\u201c0\u201d\u524d\u7f00\uff0c\u5426\u5219\u8be5\u503c\u5c06\u88ab\u89c6\u4e3a\u57fa\u6570\u4e3a10\u7684\u6574\u6570\uff01 \u9ed8\u8ba4\u503c\uff1a077 chown_upload_mode \u8981\u5f3a\u5236\u8fdb\u884cchown\uff08\uff09ed\u533f\u540d\u4e0a\u4f20\u7684\u6587\u4ef6\u6a21\u5f0f\u3002\uff08\u5728v2.0.6\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a0600 connect_timeout \u8fdc\u7a0b\u5ba2\u6237\u7aef\u54cd\u5e94\u6211\u4eec\u7684PORT\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u7684\u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a60 data_connection_timeout \u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\uff0c\u5927\u81f4\u662f\u5141\u8bb8\u6570\u636e\u4f20\u8f93\u505c\u6b62\u800c\u6ca1\u6709\u8fdb\u5ea6\u7684\u6700\u957f\u65f6\u95f4\u3002\u5982\u679c\u8d85\u65f6\u89e6\u53d1\uff0c\u5219\u542f\u52a8\u8fdc\u7a0b\u5ba2\u6237\u7aef \u9ed8\u8ba4\u503c\uff1a300 delay_failed_login \u62a5\u544a\u767b\u5f55\u5931\u8d25\u4e4b\u524d\u6682\u505c\u7684\u79d2\u6570 \u9ed8\u8ba4\u503c\uff1a1 delay_successful_login \u5141\u8bb8\u6210\u529f\u767b\u5f55\u4e4b\u524d\u6682\u505c\u7684\u79d2\u6570 \u9ed8\u8ba4\u503c\uff1a0 file_open_mode \u7528\u4e8e\u521b\u5efa\u4e0a\u8f7d\u6587\u4ef6\u7684\u6743\u9650\u3002Umasks\u5e94\u7528\u4e8e\u6b64\u503c\u4e4b\u4e0a\u3002\u5982\u679c\u60a8\u5e0c\u671b\u4e0a\u4f20\u7684\u6587\u4ef6\u53ef\u6267\u884c\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u66f4\u6539\u4e3a0777 \u9ed8\u8ba4\u503c\uff1a0666 ftp_data_port PORT\u6837\u5f0f\u8fde\u63a5\u6e90\u81ea\u7684\u7aef\u53e3\uff08\u53ea\u8981 \u542f\u7528\u540d\u79f0\u4e0d\u4f73\u7684 connect_from_port_20\uff09 \u9ed8\u8ba4\u503c\uff1a20 idle_session_timeout \u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\uff0c\u5373\u8fdc\u7a0b\u5ba2\u6237\u7aef\u5728FTP\u547d\u4ee4\u4e4b\u95f4\u53ef\u80fd\u82b1\u8d39\u7684\u6700\u957f\u65f6\u95f4\u3002\u5982\u679c\u8d85\u65f6\u89e6\u53d1\uff0c\u5219\u542f\u52a8\u8fdc\u7a0b\u5ba2\u6237\u7aef \u9ed8\u8ba4\u503c\uff1a300 listen_port \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u5b83\u5c06\u4fa6\u542c\u4f20\u5165FTP\u8fde\u63a5\u7684\u7aef\u53e3 \u9ed8\u8ba4\u503c\uff1a21 local_max_rate \u672c\u5730\u8eab\u4efd\u9a8c\u8bc1\u7528\u6237\u5141\u8bb8\u7684\u6700\u5927\u6570\u636e\u4f20\u8f93\u901f\u7387\uff08\u4ee5\u5b57\u8282/\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 local_umask \u4e3a\u672c\u5730\u7528\u6237\u8bbe\u7f6e\u7528\u4e8e\u6587\u4ef6\u521b\u5efa\u7684umask\u7684\u503c\u3002\u6ce8\u610f\uff01\u5982\u679c\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u503c\uff0c\u8bf7\u8bb0\u4f4f\u201c0\u201d\u524d\u7f00\uff0c\u5426\u5219\u8be5\u503c\u5c06\u88ab\u89c6\u4e3a\u57fa\u6570\u4e3a10\u7684\u6574\u6570\uff01 \u9ed8\u8ba4\u503c\uff1a077 max_clients \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u8fd9\u662f\u53ef\u4ee5\u8fde\u63a5\u7684\u6700\u5927\u5ba2\u6237\u7aef\u6570\u3002\u8fde\u63a5\u7684\u4efb\u4f55\u5176\u4ed6\u5ba2\u6237\u7aef\u90fd\u5c06\u6536\u5230\u9519\u8bef\u6d88\u606f \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 max_login_fails \u5728\u8fd9\u4e48\u591a\u767b\u5f55\u5931\u8d25\u4e4b\u540e\uff0c\u4f1a\u8bdd\u88ab\u7ec8\u6b62 \u9ed8\u8ba4\u503c\uff1a3 max_per_ip \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u8fd9\u662f\u53ef\u4ee5\u4ece\u540c\u4e00\u6e90Internet\u5730\u5740\u8fde\u63a5\u7684\u6700\u5927\u5ba2\u6237\u7aef\u6570\u3002\u5982\u679c\u5ba2\u6237\u7aef\u8d85\u8fc7\u6b64\u9650\u5236\uff0c\u5c06\u6536\u5230\u9519\u8bef\u6d88\u606f \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 pasv_max_port \u4e3aPASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5206\u914d\u7684\u6700\u5927\u7aef\u53e3\u3002\u53ef\u7528\u4e8e\u6307\u5b9a\u7a84\u7aef\u53e3\u8303\u56f4\u4ee5\u534f\u52a9\u9632\u706b\u5899 \u9ed8\u8ba4\u503c\uff1a0\uff08\u4f7f\u7528\u4efb\u4f55\u7aef\u53e3\uff09 pasv_min_port \u4e3aPASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5206\u914d\u7684\u6700\u5c0f\u7aef\u53e3\u3002\u53ef\u7528\u4e8e\u6307\u5b9a\u7a84\u7aef\u53e3\u8303\u56f4\u4ee5\u534f\u52a9\u9632\u706b\u5899 \u9ed8\u8ba4\u503c\uff1a0\uff08\u4f7f\u7528\u4efb\u4f55\u7aef\u53e3\uff09 trans_chunk_size \u60a8\u53ef\u80fd\u4e0d\u60f3\u66f4\u6539\u6b64\u8bbe\u7f6e\uff0c\u4f46\u5c1d\u8bd5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u7c7b\u4f3c8192\u7684\u8bbe\u5907\uff0c\u4ee5\u83b7\u5f97\u66f4\u5e73\u6ed1\u7684\u5e26\u5bbd\u9650\u5236\u5668 \u9ed8\u8ba4\u503c\uff1a0\uff08\u8ba9vsftpd\u9009\u62e9\u5408\u7406\u7684\u8bbe\u7f6e\uff09 STRING OPTIONS \u4ee5\u4e0b\u662f\u5b57\u7b26\u4e32\u9009\u9879\u5217\u8868 anon_root \u6b64\u9009\u9879\u8868\u793avsftpd\u5728\u533f\u540d\u767b\u5f55\u540e\u5c1d\u8bd5\u66f4\u6539\u7684\u76ee\u5f55\u3002\u5931\u8d25\u88ab\u9ed8\u9ed8\u5730\u5ffd\u7565\u4e86 \u9ed8\u8ba4\u503c:(\u65e0\uff09 banned_email_file \u6b64\u9009\u9879\u662f\u5305\u542b\u4e0d\u5141\u8bb8\u7684\u533f\u540d\u7535\u5b50\u90ae\u4ef6\u5bc6\u7801\u5217\u8868\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c \u542f\u7528\u4e86\u9009\u9879deny_email_enable\uff0c\u5219\u4f1a\u67e5\u8be2\u6b64\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.banned_emails banner_file \u6b64\u9009\u9879\u662f\u5305\u542b\u8981\u5728\u6709\u4eba\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\u663e\u793a\u7684\u6587\u672c\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c\u8bbe\u7f6e\uff0c\u5b83\u5c06\u8986\u76d6ftpd_banner \u9009\u9879\u63d0\u4f9b\u7684\u6807\u9898\u5b57\u7b26\u4e32 \u9ed8\u8ba4\u503c:(\u65e0\uff09 ca_certs_file \u6b64\u9009\u9879\u662f\u7528\u4e8e\u52a0\u8f7d\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66\u7684\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u9a8c\u8bc1\u5ba2\u6237\u7aef\u8bc1\u4e66\u3002\u9057\u61be\u7684\u662f\uff0c\u7531\u4e8evsftpd\u4f7f\u7528\u53d7\u9650\u5236\u7684\u6587\u4ef6\u7cfb\u7edf\u7a7a\u95f4\uff08chroot\uff09\uff0c \u56e0\u6b64\u672a\u4f7f\u7528\u9ed8\u8ba4\u7684SSL CA\u8bc1\u4e66\u8def\u5f84\u3002\uff08\u5728v2.0.6\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c:(\u65e0\uff09 chown_username \u8fd9\u662f\u83b7\u5f97\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u6240\u6709\u6743\u7684\u7528\u6237\u7684\u540d\u79f0\u3002\u4ec5\u5f53\u8bbe\u7f6e\u4e86\u53e6\u4e00\u4e2a\u9009\u9879chown_uploads\u65f6\uff0c\u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u9ed8\u8ba4\u503c\uff1aroot chroot_list_file \u8be5\u9009\u9879\u662f\u5305\u542b\u672c\u5730\u7528\u6237\u5217\u8868\u7684\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u8be5\u5217\u8868\u5c06\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684chroot\uff08\uff09jail\u4e2d\u3002\u4ec5\u5f53 \u542f\u7528\u4e86\u9009\u9879chroot_list_enable\u65f6\uff0c \u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u3002\u5982\u679c \u542f\u7528\u4e86\u9009\u9879 chroot_local_user\uff0c\u5219\u5217\u8868\u6587\u4ef6\u5c06\u6210\u4e3a\u672a\u653e\u7f6e\u5728chroot\uff08\uff09jail\u4e2d\u7684\u7528\u6237\u5217\u8868 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.chroot_list chroot_list\u6587\u4ef6\uff0c\"/etc/vsftpd.chroot_list\"\u6587\u4ef6\u4e2d\u5305\u542b\u7684\u7528\u6237\uff0c\u5728\u767b\u5f55\u540e\u5c06\u4e0d\u80fd\u5207\u6362\u5230\u81ea\u5df1\u76ee\u5f55\u4ee5\u5916\u7684\u5176\u4ed6\u76ee\u5f55\uff0c\u7531FTP\u670d\u52a1\u5668\u81ea\u52a8 \u5730\"chrooted\"\u5230\u7528\u6237\u81ea\u5df1\u7684home\u76ee\u5f55\u4e0b\u3002\u8fd9\u5c06\u4f7f\u5f97chroot_list\u6587\u4ef6\u4e2d\u7684\u7528\u6237\u4e0d\u80fd\u968f\u610f\u8f6c\u5230\u5176\u4ed6\u7528\u6237\u7684FTP home\u76ee\u5f55\u4e0b\uff0c\u4ece\u800c\u6709\u5229\u4e8eFTP\u670d \u52a1\u5668\u7684\u5b89\u5168\u7ba1\u7406\u548c\u9690\u79c1\u4fdd\u62a4 cmds_allowed \u6b64\u9009\u9879\u6307\u5b9a\u5141\u8bb8\u7684FTP\u547d\u4ee4\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\uff08\u767b\u5f55\u540e.USER\uff0cPASS\u548cQUIT\u4ee5\u53ca\u5176\u4ed6\u59cb\u7ec8\u5141\u8bb8\u767b\u5f55\u524d\uff09\u3002\u5176\u4ed6\u547d\u4ee4\u88ab\u62d2\u7edd\u3002 \u8fd9\u662f\u4e00\u79cd\u771f\u6b63\u9501\u5b9aFTP\u670d\u52a1\u5668\u7684\u5f3a\u5927\u65b9\u6cd5\u3002\u793a\u4f8b\uff1acmds_allowed = PASV\uff0cRETR\uff0cQUIT \u9ed8\u8ba4\u503c:(\u65e0\uff09 cmds_denied \u6b64\u9009\u9879\u6307\u5b9a\u4ee5\u9017\u53f7\u5206\u9694\u7684\u62d2\u7eddFTP\u547d\u4ee4\u5217\u8868\uff08\u767b\u5f55\u540e\u3002\u59cb\u7ec8\u5141\u8bb8\u767b\u5f55\u524d\u4f7f\u7528USER\uff0cPASS\uff0cQUIT\u7b49\uff09\u3002 \u5982\u679c\u6b64\u547d\u4ee4\u548ccmds_allowed\u4e0a\u90fd\u51fa\u73b0\u547d\u4ee4\uff0c \u5219\u62d2\u7edd\u4f18\u5148\u3002\uff08\u5728v2.1.0\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c:(\u65e0\uff09 deny_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u540d\uff08\u548c\u76ee\u5f55\u540d\u7b49\uff09\u7684\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6a21\u5f0f\u4e0d\u5e94\u4ee5\u4efb\u4f55\u65b9\u5f0f\u8bbf\u95ee\u3002\u53d7\u5f71\u54cd\u7684\u9879\u76ee\u4e0d\u4f1a\u88ab\u9690\u85cf\uff0c\u4f46\u4efb\u4f55\u5bf9\u5b83\u4eec\u505a\u4efb\u4f55\u4e8b\u60c5\u7684\u5c1d\u8bd5 \uff08\u4e0b\u8f7d\uff0c\u66f4\u6539\u5230\u76ee\u5f55\uff0c\u5f71\u54cd\u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\u7b49\uff09\u90fd\u5c06\u88ab\u62d2\u7edd\u3002\u6b64\u9009\u9879\u975e\u5e38\u7b80\u5355\uff0c\u4e0d\u5e94\u7528\u4e8e\u4e25\u683c\u7684\u8bbf\u95ee\u63a7\u5236 - \u5e94\u4f18\u5148\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u7684\u6743\u9650\u3002\u4f46\u662f\uff0c \u6b64\u9009\u9879\u5728\u67d0\u4e9b\u865a\u62df\u7528\u6237\u8bbe\u7f6e\u4e2d\u53ef\u80fd\u5f88\u6709\u7528\u3002\u7279\u522b\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u6587\u4ef6\u540d\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u540d\u79f0\u8bbf\u95ee\uff08\u53ef\u80fd\u662f\u7531\u4e8e\u7b26\u53f7\u94fe\u63a5\u6216\u786c\u94fe\u63a5\uff09\uff0c\u90a3\u4e48\u5fc5\u987b\u6ce8\u610f \u62d2\u7edd\u8bbf\u95ee\u6240\u6709\u540d\u79f0\u3002\u5982\u679c\u9879\u76ee\u7684\u540d\u79f0\u5305\u542bhide_file\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32\uff0c\u6216\u8005\u5b83\u4eec\u4e0ehide_file\u6307\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u5c06\u62d2\u7edd\u8bbf\u95ee\u9879\u76ee\u3002 \u6ce8\u610fvsftpd\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4ee3\u7801\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5b83\u662f\u5b8c\u6574\u6b63\u5219\u8868\u8fbe\u5f0f\u529f\u80fd\u7684\u5b50\u96c6\u3002\u56e0\u6b64\uff0c\u60a8\u9700\u8981\u4ed4\u7ec6\u800c\u8be6\u5c3d\u5730\u6d4b\u8bd5\u6b64\u9009\u9879\u7684\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u3002 \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u9ed8\u8ba4\u503c:(\u65e0\uff09 dsa_cert_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684DSA\u8bc1\u4e66\u7684\u4f4d\u7f6e \u9ed8\u8ba4\u503c:(\u65e0 - RSA\u8bc1\u4e66\u5c31\u8db3\u591f\u4e86\uff09 dsa_private_key_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684DSA\u79c1\u94a5\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u6b64\u9009\u9879\uff0c\u5219\u9884\u671f\u79c1\u94a5\u4e0e\u8bc1\u4e66\u4f4d\u4e8e\u540c\u4e00\u6587\u4ef6\u4e2d \u9ed8\u8ba4\u503c:(\u65e0\uff09 email_password_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u63d0\u4f9bsecure_email_list_enable \u8bbe\u7f6e\u4f7f\u7528\u7684\u5907\u7528\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.email_passwords ftp_username \u8fd9\u662f\u6211\u4eec\u7528\u4e8e\u5904\u7406\u533f\u540dFTP\u7684\u7528\u6237\u7684\u540d\u79f0\u3002\u8be5\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u662f\u533f\u540dFTP\u533a\u57df\u7684\u6839\u76ee\u5f55 \u9ed8\u8ba4\u503c\uff1aftp ftpd_banner \u6b64\u5b57\u7b26\u4e32\u9009\u9879\u5141\u8bb8\u60a8\u5728\u9996\u6b21\u8fdb\u5165\u8fde\u63a5\u65f6\u8986\u76d6vsftpd\u663e\u793a\u7684\u95ee\u5019\u8bed\u6a2a\u5e45 \u9ed8\u8ba4\u503c:(\u65e0 - \u663e\u793a\u9ed8\u8ba4\u7684vsftpd\u6a2a\u5e45\uff09 guest_username \u6709\u5173 \u8bbf\u5ba2\u767b\u5f55\u7684\u63cf\u8ff0\uff0c\u8bf7\u53c2\u9605\u5e03\u5c14\u503c\u8bbe\u7f6e guest_enable\u3002\u6b64\u8bbe\u7f6e\u662f\u8bbf\u5ba2\u7528\u6237\u6620\u5c04\u5230\u7684\u771f\u5b9e\u7528\u6237\u540d \u9ed8\u8ba4\u503c\uff1aftp hide_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u540d\uff08\u548c\u76ee\u5f55\u540d\u79f0\u7b49\uff09\u7684\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6a21\u5f0f\u5e94\u8be5\u4ece\u76ee\u5f55\u5217\u8868\u4e2d\u9690\u85cf\u3002\u5c3d\u7ba1\u88ab\u9690\u85cf\uff0c\u4f46\u662f\u77e5\u9053\u5b9e\u9645\u4f7f\u7528\u7684\u540d\u79f0\u7684\u5ba2\u6237\u53ef\u4ee5\u5b8c\u5168\u8bbf\u95ee\u6587\u4ef6/\u76ee\u5f55\u7b49\u3002 \u5982\u679c\u9879\u76ee\u7684\u540d\u79f0\u5305\u542bhide_file\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32\uff0c\u6216\u8005\u5b83\u4eec\u4e0ehide_file\u6307\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u5c06\u9690\u85cf\u8fd9\u4e9b\u9879\u76ee\u3002\u8bf7\u6ce8\u610f\uff0cvsftpd\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4ee3\u7801 \u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5b83\u662f\u5b8c\u6574\u6b63\u5219\u8868\u8fbe\u5f0f\u529f\u80fd\u7684\u5b50\u96c6\u3002\u6709\u5173 \u5177\u4f53\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c \u8bf7\u53c2\u9605 deny_file\u3002\u793a\u4f8b\uff1ahide_file = {*\u3002mp3\uff0c.hidden\uff0chide *\uff0ch\uff1f} \u9ed8\u8ba4\u503c:(\u65e0\uff09 listen_address \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u6b64\u8bbe\u7f6e\u53ef\u80fd\u4f1a\u8986\u76d6\uff08\u6240\u6709\u672c\u5730\u63a5\u53e3\u7684\uff09\u9ed8\u8ba4\u4fa6\u542c\u5730\u5740\u3002\u63d0\u4f9b\u6570\u5b57IP\u5730\u5740 \u9ed8\u8ba4\u503c:(\u65e0\uff09 listen_address6 \u4e0elisten_address\u7c7b\u4f3c\uff0c\u4f46\u6307\u5b9aIPv6\u4fa6\u542c\u5668\u7684\u9ed8\u8ba4\u4fa6\u542c\u5730\u5740\uff08\u5982\u679c\u8bbe\u7f6e\u4e86listen_ipv6\uff0c\u5219\u4f7f\u7528\u8be5\u5730\u5740\uff09\u3002\u683c\u5f0f\u662f\u6807\u51c6IPv6\u5730\u5740\u683c\u5f0f \u9ed8\u8ba4\u503c:(\u65e0\uff09 local_root \u6b64\u9009\u9879\u8868\u793avsftpd\u5728\u672c\u5730\uff08\u5373\u975e\u533f\u540d\uff09\u767b\u5f55\u540e\u5c1d\u8bd5\u66f4\u6539\u7684\u76ee\u5f55\u3002\u5931\u8d25\u88ab\u9ed8\u9ed8\u5730\u5ffd\u7565\u4e86 \u9ed8\u8ba4\u503c:(\u65e0\uff09 message_file \u6b64\u9009\u9879\u662f\u8f93\u5165\u65b0\u76ee\u5f55\u65f6\u6211\u4eec\u67e5\u627e\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5185\u5bb9\u663e\u793a\u7ed9\u8fdc\u7a0b\u7528\u6237\u3002\u4ec5\u5f53 \u542f\u7528\u4e86\u9009\u9879dirmessage_enable\u65f6\uff0c\u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u9ed8\u8ba4\u503c\uff1a.message nopriv_user \u8fd9\u662fvsftpd\u5728\u5b8c\u5168\u6ca1\u6709\u7279\u6743\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u7684\u7528\u6237\u540d\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u5e94\u8be5\u662f\u4e13\u7528\u7528\u6237\uff0c\u800c\u4e0d\u662f\u4efb\u4f55\u4eba\u3002\u5728\u5927\u591a\u6570\u673a\u5668\u4e0a\uff0c\u7528\u6237\u6ca1\u6709\u503e\u5411\u4e8e\u4f7f\u7528\u5f88\u591a\u91cd\u8981\u7684\u4e1c\u897f \u9ed8\u8ba4\u503c\uff1a\u6ca1\u4eba pam_service_name \u6b64\u5b57\u7b26\u4e32\u662fvsftpd\u5c06\u4f7f\u7528\u7684PAM\u670d\u52a1\u7684\u540d\u79f0 \u9ed8\u8ba4\u503c\uff1aftp pasv_address\u8bbe\u7f6e \u4f7f\u7528\u6b64\u9009\u9879\u53ef\u8986\u76d6vsftpd\u5c06\u54cd\u5e94PASV\u547d\u4ee4\u800c\u901a\u544a\u7684IP\u5730\u5740\u3002\u63d0\u4f9b\u6570\u5b57IP\u5730\u5740\uff0c\u9664\u975e \u542f\u7528\u4e86pasv_addr_resolve\uff0c \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u5728\u542f\u52a8\u65f6\u4e3a\u60a8\u89e3\u6790DNS\u7684\u4e3b\u673a\u540d \u9ed8\u8ba4\u503c:(\u65e0 - \u5730\u5740\u53d6\u81ea\u4f20\u5165\u7684\u8fde\u63a5\u5957\u63a5\u5b57\uff09 rsa_cert_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684RSA\u8bc1\u4e66\u7684\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1a/usr/share/ssl/certs/vsftpd.pem rsa_private_key_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684RSA\u79c1\u94a5\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u6b64\u9009\u9879\uff0c\u5219\u9884\u671f\u79c1\u94a5\u4e0e\u8bc1\u4e66\u4f4d\u4e8e\u540c\u4e00\u6587\u4ef6\u4e2d \u9ed8\u8ba4\u503c:(\u65e0\uff09 secure_chroot_dir \u6b64\u9009\u9879\u5e94\u8be5\u662f\u7a7a\u76ee\u5f55\u7684\u540d\u79f0\u3002\u6b64\u5916\uff0cftp\u7528\u6237\u4e0d\u5e94\u8be5\u5199\u5165\u8be5\u76ee\u5f55\u3002\u6b64\u76ee\u5f55\u6709\u65f6\u7528\u4f5c\u5b89\u5168chroot\uff08\uff09jail\uff0cvsftpd\u4e0d\u9700\u8981\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee \u9ed8\u8ba4\u503c\uff1a/ usr / share / empty \u7684ssl_ciphers \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u9009\u62e9vsftpd\u5141\u8bb8\u52a0\u5bc6SSL\u8fde\u63a5\u7684SSL\u5bc6\u7801\u3002\u6709\u5173 \u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u5bc6\u7801\u624b\u518c\u9875\u3002\u8bf7\u6ce8\u610f\uff0c\u9650\u5236\u5bc6\u7801\u53ef\u80fd\u662f\u4e00\u79cd\u6709\u7528\u7684\u5b89\u5168\u9884\u9632\u63aa\u65bd\uff0c \u56e0\u4e3a\u5b83\u53ef\u4ee5\u9632\u6b62\u6076\u610f\u8fdc\u7a0b\u65b9\u5f3a\u5236\u4f7f\u7528\u5df2\u53d1\u73b0\u95ee\u9898\u7684\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1aDES-CBC3-SHA user_config_dir \u8fd9\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u9009\u9879\u5141\u8bb8\u57fa\u4e8e\u6bcf\u4e2a\u7528\u6237\u8986\u76d6\u624b\u518c\u9875\u4e2d\u6307\u5b9a\u7684\u4efb\u4f55\u914d\u7f6e\u9009\u9879\u3002\u7528\u6cd5\u5f88\u7b80\u5355\uff0c\u6700\u597d\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u3002\u5982\u679c\u5c06 user_config_dir \u8bbe\u7f6e \u4e3a / etc / vsftpd_user_conf \u7136\u540e\u4ee5\u7528\u6237\u201cchris\u201d\u8eab\u4efd\u767b\u5f55\uff0c\u5219vsftpd\u5c06 \u5728\u4f1a\u8bdd\u671f\u95f4\u5e94\u7528\u6587\u4ef6 / etc / vsftpd_user_conf / chris \u4e2d\u7684\u8bbe\u7f6e\u3002\u6b64\u6587\u4ef6\u7684\u683c\u5f0f\u8be6\u89c1\u672c\u624b\u518c\u9875\uff01\u8bf7\u6ce8\u610f\uff0c\u5e76\u975e\u6240\u6709\u8bbe\u7f6e\u90fd\u5bf9\u6bcf\u4e2a\u7528\u6237\u6709\u6548\u3002\u4f8b\u5982\uff0c\u8bb8\u591a\u8bbe\u7f6e\u4ec5\u5728\u7528\u6237\u4f1a\u8bdd\u542f\u52a8\u4e4b\u524d\u3002\u4e0d\u4f1a\u5f71\u54cd\u6bcf\u4e2a\u7528\u6237\u7684\u4efb\u4f55 \u884c\u4e3a\u7684\u8bbe\u7f6e\u793a\u4f8b\u5305\u62eclisten_address\uff0cbanner_file\uff0cmax_per_ip\uff0cmax_clients\uff0cxferlog_file\u7b49 \u9ed8\u8ba4\u503c:(\u65e0\uff09 user_sub_token \u6b64\u9009\u9879\u4e0e\u865a\u62df\u7528\u6237\u7ed3\u5408\u4f7f\u7528\u975e\u5e38\u6709\u7528\u3002\u5b83\u7528\u4e8e\u6839\u636e\u6a21\u677f\u4e3a\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u81ea\u52a8\u751f\u6210\u4e3b\u76ee\u5f55\u3002\u4f8b\u5982\uff0c\u5982\u679c\u901a\u8fc7guest_username\u6307\u5b9a\u7684\u771f\u5b9e\u7528\u6237\u7684\u4e3b\u76ee\u5f55 \u662f / home / virtual / $ USER\uff0c\u5e76\u4e14 user_sub_token \u8bbe\u7f6e\u4e3a $ USER\uff0c\u90a3\u4e48\u5f53\u865a\u62df\u7528\u6237fred\u767b\u5f55\u65f6\uff0c\u4ed6\u5c06\u7ed3\u675f\u901a\u5e38\u662f\u5728\u76ee\u5f55 / home / virtual / fred\u4e2d\u3002\u5982\u679clocal_root \u5305\u542b user_sub_token\uff0c\u5219\u6b64\u9009\u9879\u4e5f\u4f1a \u751f\u6548 \u9ed8\u8ba4\u503c:(\u65e0\uff09 userlist_file \u6b64\u9009\u9879\u662fuserlist_enable \u9009\u9879\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\u52a0\u8f7d\u7684\u6587\u4ef6\u7684\u540d\u79f0 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.user_list vsftpd_log_file \u6b64\u9009\u9879\u662f\u6211\u4eec\u7f16\u5199vsftpd\u6837\u5f0f\u65e5\u5fd7\u6587\u4ef6\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u4ec5\u5f53 \u8bbe\u7f6e\u4e86\u9009\u9879xferlog_enable\u5e76\u4e14\u672a\u8bbe\u7f6exferlog_std_format\u65f6\uff0c \u624d\u4f1a\u5199\u5165\u6b64\u65e5\u5fd7 \u3002 \u6216\u8005\uff0c\u5982\u679c\u5df2\u8bbe\u7f6e\u9009\u9879dual_log_enable\uff0c\u5219\u4f1a\u5199\u5165 \u3002\u53e6\u4e00\u4e2a\u590d\u6742\u56e0\u7d20 - \u5982\u679c\u60a8\u8bbe\u7f6e\u4e86 syslog_enable\uff0c\u5219\u4e0d\u4f1a\u5199\u5165\u6b64\u6587\u4ef6\uff0c\u800c\u662f\u5c06\u8f93\u51fa\u53d1\u9001\u5230\u7cfb\u7edf\u65e5\u5fd7 \u9ed8\u8ba4\u503c\uff1a/var/log/vsftpd.log xferlog_file \u6b64\u9009\u9879\u662f\u6211\u4eec\u7f16\u5199wu-ftpd\u6837\u5f0f\u4f20\u8f93\u65e5\u5fd7\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u4ec5\u5f53 \u8bbe\u7f6e\u4e86 xferlog_enable\u9009\u9879\u4ee5\u53caxferlog_std_format\u65f6\u624d\u4f1a\u5199\u5165\u4f20\u8f93\u65e5\u5fd7 \u3002 \u6216\u8005\uff0c\u5982\u679c\u5df2\u8bbe\u7f6e\u9009\u9879dual_log_enable\uff0c\u5219\u4f1a\u5199\u5165 \u9ed8\u8ba4\u503c\uff1a/var/log/xferlog Bind-DNS \u00b6 # DNS-bind\u5b89\u88c5\u548c\u914d\u7f6e https://ftp.isc.org/ http://www.isc.org/downloads/ wget https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = tar-gz https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = win-32-bit https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = win-64-bit tar -zxvf ./configure --with-openssl --enable-threads --with-libxml2 make && make install touch /etc/named.conf named -V named -g \u89e3\u51b3bind9 dumping master file tmp-xxxx open permission denied\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6cd5\u5982\u4e0b\uff1a \u5bf9\u4e8eRedhat Linux\uff0c\u53ea\u8981\u5728slave\u90a3\u53f0\u7684dns\u4e3b\u673a\u4e0a\u4fee\u6539/etc/sysconfig/named\u52a0\u4e0aENABLE_ZONE_WRITE = yes\uff0c\u91cd\u542fnamed\u5373\u53ef \u5bf9\u4e8eUbuntu\u7cfb\u7edf\uff0c\u4fee\u6539/etc/apparmor.d/usr.sbin.named\uff0c\u67e5\u627e/etc/bind/** r\uff0c\u4fee\u6539\u6210/etc/bind/** rw\uff0c \u7136\u540e\u91cd\u542fapparmor\uff1a/etc/init.d/apparmor rstart\u6216\u8005reload\u914d\u7f6e\uff1acat /etc/apparmor.d/usr.sbin.named | sudo apparmor_parser -r Email \u00b6 # PostFix Dovecot\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u540e\u53f0\u7ba1\u7406 # \u5b98\u65b9postfix\u5b89\u88c5\u548c\u914d\u7f6e PGP key\u4e0b\u8f7d\u5730\u5740\uff1ahttps://repo.dovecot.org/DOVECOT-REPO-GPG ## debian\u5b89\u88c5\u548c\u914d\u7f6e # Jessie (8.0)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/debian/jessie jessie main # Stretch (9.0)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/debian/stretch stretch main # \u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot-core dovecot-dbg dovecot-dev dovecot-gssapi dovecot-imapd dovecot-imaptest dovecot-ldap dovecot-lmtpd dovecot-lua dovecot-lucene dovecot-managesieved dovecot-mysql dovecot-pgsql dovecot-pigeonhole-dbg dovecot-pop3d dovecot-sieve-dev dovecot-sieve dovecot-solr dovecot-sqlite dovecot-submissiond ## CentOS 6&7\u5b89\u88c5\u548c\u914d\u7f6e # \u521b\u5efa/etc/yum.repos.d/dovecot.repo [ dovecot-2.3-latest ] name = Dovecot 2 .3 CentOS $releasever - $basearch baseurl = http://repo.dovecot.org/ce-2.3-latest/centos/ $releasever /RPMS/ $basearch gpgkey = https://repo.dovecot.org/DOVECOT-REPO-GPG gpgcheck = 1 enabled = 1 # \u65b0\u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot dovecot-debuginfo dovecot-devel dovecot-imaptest dovecot-imaptest-debuginfo dovecot-lua dovecot-mysql dovecot-pgsql dovecot-pigeonhole dovecot-pigeonhole-debuginfo dovecot-pigeonhole-devel ## Ubuntu\u5b89\u88c5\u548c\u914d\u7f6e # Trusty (14.04 LTS)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/ubuntu/trusty trusty main # Xenial (16.04 LTS)\u5b89\u88c5 Create /etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg Create /etc/apt/sources.list.d/dovecot.list. If you want to use https, make sure you have installed apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/ubuntu/xenial xenial main # \u65b0\u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot-core dovecot-dbg dovecot-dev dovecot-gssapi dovecot-imapd dovecot-imaptest dovecot-ldap dovecot-lmtpd dovecot-lua dovecot-lucene dovecot-managesieved dovecot-mysql dovecot-pgsql dovecot-pigeonhole-dbg dovecot-pop3d dovecot-sieve-dev dovecot-sieve dovecot-solr dovecot-sqlite dovecot-submissiond ## source tarballs\u6587\u4ef6\u7f16\u8bd1\u5b89\u88c5 # \u4e0b\u8f7d\u5730\u5740\uff1ahttps://dovecot.org/download.html https://dovecot.org/releases/2.3/dovecot-2.3.0.tar.gz tar -zxvf dovecot-2.3.0 ./configure make && make install # \u81ea\u5b9a\u4e49\u5b89\u88c5\u4f4d\u7f6e\u548c\u5e93\u7684\u8def\u5f84 CPPFLAGS = \"-I/opt/openssl/include\" LDFLAGS = \"-L/opt/openssl/lib\" ./configure # \u4ecegit\u514b\u9686\u7f16\u8bd1\u5b89\u88c5 git clone https://github.com/dovecot/core.git dovecot # \u63a5\u7740\u8fdb\u5165\u76ee\u5f55\u8fd0\u884c./autogen.sh\u751f\u6210\u914d\u7f6e\u811a\u672c\u548c\u5176\u4ed6\u9700\u8981\u7684\u6587\u4ef6 # \u9700\u8981\u63d0\u524d\u5b89\u88c5\u7684\u5305 autoconf automake libtool pkg-config gettext pandoc ( \u4e0d\u662f\u5fc5\u987b\u5b89\u88c5\uff0c\u9664\u975e\u8981\u4f7f\u7528: PANDOC = false ./configure ) GNU make # \u5efa\u8bae\u6dfb\u52a0--enable-maintainer-mode\u53c2\u6570\u5230configure\u811a\u672c ./autogen.sh ./configure --enable-maintainer-mode make && make install ## \u5176\u4ed6` \u975e\u5b98\u65b9\u8865\u4e01\u5730\u5740\uff1ahttps://dovecot.org/patches/ \u989d\u5916\u5de5\u5177\u5730\u5740\uff1ahttps://dovecot.org/tools/ GitHub\u4ed3\u5e93\u5730\u5740\uff1ahttps://github.com/dovecot/ Optional Configure Options \u00b6 -- help = short just lists the options added by the particular package ( = Dovecot ) Options are usually listed as -- with - something or -- enable - something . If you want to disable them , do it as -- without - something or -- disable - something . There are many default options that come from autoconf , automake or libtool . They are explained elsewhere Here is a list of options that Dovecot adds . You should not usually have to change these , but they are described here just for completeness : -- enable - devel - checks Enables some extra sanity checks . This is mainly useful for developers . It does quite a lot of unnecessary work but should catch some programming mistakes more quickly -- enable - asserts Enable assertion checks , enabled by default . Disabling them may slightly save some CPU , but if there are bugs they can cause more problems since they are not detected as early -- without - shared - libs Link Dovecot binaries with static libraries instead of dynamic libraries -- disable - largefile Specifies if we use 32 bit or 64 bit file offsets in 32 bit CPUs . 64 bit is the default if the system supports it ( Linux and Solaris do ) . Dropping this to 32 bit may save some memory , but it prevents accessing any file larger than 2 GB -- with - mem - align = BYTES Specifies memory alignment used for memory allocations . It is needed with many non - x86 systems and it should speed up x86 systems too . Default is 8 , to make sure 64 bit memory accessing works -- with - ioloop = IOLOOP Specifies what I / O loop method to use . Possibilities are select , poll , epoll and kqueue . The default is to use the best method available on your system -- with - notify = NOTIFY Specifies what file system notification method to use . Possibilities are dnotify , inotify ( both on Linux ) , kqueue ( FreeBSD ) and none . The default is to use the best method available on your system . See Notify method above for more information -- with - storages = FORMATS Specifies what mailbox formats to support . Note : Independent of this option , the formats raw and shared will be always built -- with - solr Build with Solr full text search support -- with - zlib Build with zlib compression support ( default if detected ) -- with - bzlib Build with bzip2 compression support ( default if detected ) SQL Driver Options SQL drivers are typically used only for authentication , but they may be used as a lib - dict backend too , which can be used by plugins for different purposes -- with - sql - drivers Build with specified SQL drivers . Defaults to all that were found with autodetection -- with - pgsql Build with PostgreSQL support ( requires pgsql - devel , libpq - dev or similar package ) -- with - mysql Build with MySQL support ( requires mysql - devel , libmysqlclient15 - dev or similar package ) -- with - sqlite Build with SQLite3 driver support ( requires sqlite - devel , libsqlite3 - dev or similar package ) Authentication Backend Options The basic backends are built if the system is detected to support them : -- with - shadow Build with shadow password support -- with - pam Build with PAM support -- with - nss Build with NSS support -- with - sia Build with Tru64 SIA support -- with - bsdauth Build with BSD authentication support ( if supported by your OS ) Some backends require extra libraries and are not necessarily wanted , so they are built only if specifically enabled : -- with - sql Build with generic SQL support ( drivers are enabled separately ) -- with - ldap Build with LDAP support ( requires openldap - devel , libldap2 - dev or similar package ) -- with - gssapi Build with GSSAPI authentication support ( requires krb5 - devel , libkrb5 - dev or similar package ) -- with - vpopmail Build with vpopmail support ( requires vpopmail sources or a devel package ) It is also possible to build these as plugins by giving e . g . -- with - sql = plugin Dynamic IMAP and POP3 Modules The mail_plugins setting lists all plugins that Dovecot is supposed to load from the mail_plugin_dir directory at program start . These plugins can do anything they want . They are only expected to contain the < plugin name > _init and < plugin name > _deinit functions which are called at startup and at exit * The plugin filename is prefixed with a number which specifies the order in which the plugins are loaded . This is important if one plugin depends on another email\u5b89\u88c5\u8fc7\u7a0b\u76f8\u5173\u95ee\u9898\u548c\u914d\u7f6e \u00b6 # \u51fa\u73b0Maildir\u6743\u9650\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5 # \u68c0\u67e5selinux\u72b6\u6001\u5e76\u5173\u95ed # \u65b9\u6cd5\u4e00\uff1a/usr/sbin/sestatus -v # \u65b9\u6cd5\u4e8c\uff1a getenforce 0 # \u8bbe\u7f6eselinux\u4e3apermissive\u6a21\u5f0f()\u4e34\u65f6\u5173\u95ed\uff0c\u4e0d\u7528\u91cd\u542f\uff0c\u91cd\u542f\u540e\u5931\u6548 # \u6c38\u4e45\u751f\u6548\u65b9\u6cd5\uff1a vi /etc/selinux/config SELINUX = enforcing\u66f4\u6539\u4e3aSELINUX = disabled # \u5efa\u7acb\u9632\u706b\u5899\u89c4\u5219 vi /usr/local/sbin/startmailf #!/bin/bash #create: #Creater: iptables -I INPUT -p tcp --dport 110 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1110\u7aef\u53e3\uff0cPOP3\u7684IP\u5165\u53e3 iptables -I INPUT -p udp --dport 110 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1110\u7aef\u53e3\uff0cPOP3\u7684\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p tcp --dport 25 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u53d1\u4fe125\u7aef\u53e3\uff0cIP\u5165\u53e3 iptables -I INPUT -p udp --dport 25 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u53d1\u4fe125\u7aef\u53e3\uff0c\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p udp --dport 143 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1143\u7aef\u53e3\uff0cIMAP\u7684IP\u5165\u53e3 iptables -I INPUT -p tcp --dport 143 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1143\u7aef\u53e3\uff0cIMAP\u7684\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p udp --dport 22 -j ACCEPT #\u5f00\u653ePUTTY\u548cWINSCP 22\u53f7\u7aef\u53e3\uff0c\u65b9\u4fbf\u7ba1\u7406\u5458\u8fdb\u5165 iptables -I INPUT -p tcp --dport 22 -j ACCEPT #\u5f00\u653ePUTTY\u548cWINSCP 22\u53f7\u7aef\u53e3\uff0c\u65b9\u4fbf\u7ba1\u7406\u5458\u8fdb\u5165 iptables -I INPUT -p tcp --dport 53 -j ACCEPT #\u5f00\u653eDNS\u67e5\u8be2\u7aef\u53e3\uff0c\u8fd9\u6837\u80fd\u89e3\u6790\u5230\u90ae\u4ef6\u670d\u52a1\u5668 iptables -I INPUT -p udp --dport 53 -j ACCEPT #\u5f00\u653eDNS\u67e5\u8be2\u7aef\u53e3\uff0c\u8fd9\u6837\u80fd\u89e3\u6790\u5230\u90ae\u4ef6\u670d\u52a1\u5668 service network restart #\u91cd\u542f\u7f51\u7edc service postfix restart #\u91cd\u542fpostfix service dovecot restart #\u91cd\u542fdovecot service saslauthd restart #\u91cd\u542fASAL\u6388\u6743 #\u4e5f\u53ef\u4ee5\u518d\u52a0456\uff0c1925\uff0c587\u7b49\u90ae\u4ef6SSL/TLS\u7aef\u53e3\uff0c80\u7f51\u9875\u7ba1\u7406\u7aef\u53e3\uff0c\u6839\u636e\u4f60\u7684\u90ae\u4ef6\u670d\u52a1\u5668\u800c\u5b9a # \u5c06\u9632\u706b\u5899\u89c4\u5219\u5f00\u673a\u81ea\u542f\u52a8 vi /etc/rc.local #!/bin/sh # # This script will be executed *after* all the other init scripts # You can put your own initialization stuff in here if you don't # want to do the full Sys V style init stuff touch /var/lock/subsys/local sh /usr/local/sbin/startmailf #\u628a\u521b\u5efa\u7684\u9632\u706b\u5899\u89c4\u5219\u52a0\u5728\u8fd9\u4e00\u884c # CentOS\u7cfb\u7edf\u4e00\u822c\u90fd\u81ea\u5e26sendmail\u7684\uff0c\u5982\u679c\u4e0d\u9700\u8981\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5220\u9664 rpm -e sendmail # \u68c0\u67e5\u9ed8\u8ba4\u90ae\u4ef6\u4f20\u8f93\u4ee3\u7406(MTA) * alternatives --display mta # \u9ed8\u8ba4\u662fsendmail\uff0c\u66f4\u6539MTA\u4e3apostfix /usr/sbin/alternatives --set mta /usr/sbin/sendmail.postfix # \u914d\u7f6ePostfix * Postfix\u914d\u7f6e\u6587\u4ef6\u4e3b\u8981\u662f\u4e24\u4e2amaster.cf\u548cmain.cf\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u914d\u7f6emain.cf\uff0c\u5373/etc/postfix/main.cf # \u66f4\u6539\u4ee5\u4e0b\u5185\u5bb9 myhostname = mail.1a-centosserver.com mydomain = 1a-centosserver.com myorigin = $mydomain inet_interfaces = all mydestination = $myhostname , localhost. $mydomain , localhost, $mydomain mynetworks = 192 .168.13.0/24, 127 .0.0.0/8 relay_domains = home_mailbox = Maildir/ # \u914d\u7f6e\u6587\u4ef6\u89e3\u91ca\uff1a mydomain: mydomain\u53c2\u6570\u662f\u6307email\u670d\u52a1\u5668\u7684\u57df\u540d\uff0c\u8bf7\u786e\u4fdd\u4e3a\u6b63\u5f0f\u57df\u540d\uff08\u5982centos.bz\uff09 myhostname: myhostname\u53c2\u6570\u662f\u6307\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u79f0\uff08\u5982\u6211\u7684\u670d\u52a1\u5668\u4e3b\u673a\u540d\u79f0\u662fmail.centos.bz\uff09 myorigin: myorigin\u53c2\u6570\u6307\u5b9a\u672c\u5730\u53d1\u9001\u90ae\u4ef6\u4e2d\u6765\u6e90\u548c\u4f20\u9012\u663e\u793a\u7684\u57df\u540d\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0cmydomain\u662fcentos.bz\uff0c\u4e5f\u662f\u6211\u7684\u57df\u540d \u5bf9\u4e8e\u4e0b\u9762\u7684\u4e00\u884c\uff0c\u6211\u4eec\u7684\u90ae\u4ef6\u5730\u5740\u662fuser@centos.bz\u800c\u4e0d\u662fuser@mail.centos.bz myorigin = $mydomain mynetworks: mynetworks\u53c2\u6570\u6307\u5b9a\u53d7\u4fe1\u4efbSMTP\u7684\u5217\u8868\uff0c\u5177\u4f53\u7684\u8bf4\uff0c\u53d7\u4fe1\u4efb\u7684SMTP\u5ba2\u6237\u7aef\u5141\u8bb8\u901a\u8fc7Postfix\u4f20\u9012\u90ae\u4ef6 mydestination: mydestination\u53c2\u6570\u6307\u5b9a\u54ea\u4e9b\u90ae\u4ef6\u5730\u5740\u5141\u8bb8\u5728\u672c\u5730\u53d1\u9001\u90ae\u4ef6\u3002\u8fd9\u662f\u4e00\u7ec4\u88ab\u4fe1\u4efb\u7684\u5141\u8bb8\u901a\u8fc7\u670d\u52a1\u5668\u53d1\u9001\u6216\u4f20\u9012\u90ae\u4ef6\u7684IP\u5730\u5740\u3002\u7528\u6237\u8bd5\u56fe\u901a\u8fc7\u53d1\u9001\u4ece\u6b64\u5904\u672a\u5217\u51fa\u7684IP\u5730\u5740\u7684\u539f\u59cb\u670d\u52a1\u5668\u7684\u90ae\u4ef6\u5c06\u88ab\u62d2\u7edd inet_interfaces: inet_interfaces\u53c2\u6570\u8bbe\u7f6e\u7f51\u7edc\u63a5\u53e3\u4ee5\u4fbfPostfix\u80fd\u63a5\u6536\u5230\u90ae\u4ef6 relay_domains: \u8be5\u53c2\u6570\u662f\u7cfb\u7edf\u4f20\u9012\u90ae\u4ef6\u7684\u76ee\u7684\u57df\u540d\u5217\u8868\u3002\u5982\u679c\u7559\u7a7a\uff0c\u6211\u4eec\u4fdd\u8bc1\u4e86\u6211\u4eec\u7684\u90ae\u4ef6\u670d\u52a1\u5668\u4e0d\u5bf9\u4e0d\u4fe1\u4efb\u7684\u7f51\u7edc\u5f00\u653e home_mailbox: \u8be5\u53c2\u6570\u8bbe\u7f6e\u90ae\u7bb1\u8def\u5f84\u4e0e\u7528\u6237\u76ee\u5f55\u6709\u5173\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u90ae\u7bb1\u98ce\u683c # \u6d4b\u8bd5Postfix SMTP\u8fde\u63a5 service postfix status \u68c0\u6d4b\u9ed8\u8ba4smtp\u7aef\u53e325\u662f\u5426\u5df2\u7ecf\u76d1\u542c netstat -an | grep 25 \u8bbe\u7f6epostfix\u5f00\u673a\u542f\u52a8 chkconfig postfix on \u5f00\u59cb\u6d4b\u8bd5postfix\u662f\u5426\u5de5\u4f5c\u6b63\u5e38 telnet localhost 25 \u6240\u6709\u90ae\u4ef6\u53d1\u9001\u5230/home/user/Maildir/new # \u90ae\u4ef6\u522b\u540d\u8bbe\u7f6e \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a/etc/alises\u91cc\uff0c\u683c\u5f0f\uff1a [ Format ] Receiving Account or other aliaes:recipient A,recipient B,.... \u4f8b\u4e00:root:root,james # \u8868\u793aroot\u7528\u6237\u7684\u90ae\u4ef6\u5bf9\u4e8e\u7528\u6237james\u548croot\u90fd\u53ef\u4ee5\u63a5\u6536\u5230 \u4f8b\u4e8c\uff1aclass2017:james,anna,mark #\u8bbe\u7f6e\u7fa4\u90ae\u4ef6\uff0c\u8868\u793a\u8bbe\u7f6e\u4e86\u7fa4\u90ae\u4ef6\u540dclass2017\uff0c\u5f53\u53d1\u9001\u4e00\u5c01\u90ae\u4ef6\u5230class2017@qq.com\u65f6\uff0c\u7528\u6237james\u3001anna\u3001mark\u90fd\u53ef\u4ee5\u6536\u5230\u90ae\u4ef6 \u4f7f\u7528\u201cnewaliases\u201d\u547d\u4ee4\u6fc0\u6d3b\u90ae\u4ef6\u522b\u540d\u529f\u80fd \u5f53\u7f16\u8f91/etc/aliases\u6587\u4ef6\u540e\uff0c\u5fc5\u987b\u6267\u884cnewaliases\u547d\u4ee4\u66f4\u65b0\u522b\u540d\u6570\u636e\u5e93 POP/IMAP\u8bbe\u7f6e \u4e3a\u4e86\u4f7f\u7528\u6237\u53ef\u4ee5\u5728\u672c\u5730\u673a\u5668\u4e0b\u8f7d\u90ae\u4ef6\uff0c\u5fc5\u987b\u5728\u90ae\u4ef6\u670d\u52a1\u5668\u5b89\u88c5\u5e76\u8bbe\u7f6ePOP\u6216IMAP\uff0cdocecot\u662f\u9002\u7528\u5728Linux\u90ae\u4ef6\u7cfb\u7edfPOP/IMAP\u90ae\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff0c\u652f\u6301maildir\u548cmbox\u683c\u5f0f \u5b89\u88c5\u548c\u914d\u7f6edovecot \u00b6 * \u9996\u5148\u68c0\u6d4bdovecot\u8f6f\u4ef6\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5 rpm -qa dovecot \u7528yum\u547d\u4ee4\u5b89\u88c5\uff1ayum -y install dovecot Dovecot\u914d\u7f6e\u6587\u4ef6\u5728/etc/dovecot.conf\uff0c\u9700\u8981\u6539\u52a8\u7684\u5730\u65b9\u5982\u4e0b vim /etc/dovecot.conf # Protocols we want to be serving: imap imaps pop3 pop3s # If you only want to use dovecot-auth, you can set this to \"none\" protocols = imap imaps pop3 pop3s \u5220\u9664protocols\u884c\u524d\u9762\u7684\u201c#\u201d\u6765\u6fc0\u6d3bimap imaps pop3\u548cpop3s\u670d\u52a1 \u542f\u52a8dovecot: service dovecot start #centos6.x systemctl start dovecot #centos7.x chkconfig dovecot on #centos6.x systemctl enable dovecot #centos7.x \u4f7f\u7528telnet\u547d\u4ee4\u68c0\u6d4b110\uff08pop3\uff09\u548c143\uff08imap\uff09\u7aef\u53e3 telnet 127 .0.0.1 110 telnet 127 .0.0.1 143 ps -ef | grep dovecot # \u663e\u793adovecot\u5b88\u62a4\u8fdb\u7a0b # \u914d\u7f6e\u4f7f\u7528Dovecot SASL\u8fdb\u884cSMTP\u9a8c\u8bc1 # 1\u3001\u7f16\u8f91 /etc/dovecot.conf\uff0c\u786e\u4fddauth default\u533a\u57df\u6709\u5982\u4e0b\u8bbe\u7f6e\u503c\uff1a auth default { socket listen { client { path = /var/spool/postfix/private/auth mode = 0660 user = postfix group = postfix } } mechanisms = plain login } # 2\u3001\u7f16\u8f91/etc/postfix/main.cf\uff0c\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\u542f\u7528sasl\u8ba4\u8bc1 smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_unauth_destination broken_sasl_auth_clients = yes # 3\u3001\u91cd\u542f\u670d\u52a1 service postfix restart service dovecot restart # \u73b0\u5728\u4f60\u53ef\u4ee5\u4f7f\u7528\u90ae\u4ef6\u5ba2\u6237\u7aef\u4ee3\u7406\u8f6f\u4ef6\u548c\u7cfb\u7edf\u7528\u6237\u53ca\u5bc6\u7801\u6765\u8fde\u63a5\u6211\u4eec\u7684Dovecot\u670d\u52a1\u5668\u4e86 # **\u8be6\u7ec6\u914d\u7f6e\u6587\u6863\u8bf4\u660e** * /etc/postfix/\u76ee\u5f55\u6709\u4e24\u4e2a\u4e3b\u914d\u7f6e\u6587\u4ef6main.cf\u548cmaster.cf\uff0c\u6211\u4eec\u4e3b\u8981\u8bbe\u7f6emain.cf\uff0cmaster.cf\u57fa\u672c\u4fdd\u6301\u9ed8\u8ba4\u5c31\u884c postfix\u6709100\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53bb\u6539\u5c11\u91cf\u7684\u53c2\u6570\uff0c\u5176\u5b83\u4fdd\u6301\u9ed8\u8ba4\u5c31\u53ef \u4fee\u6539\u4efb\u4f55\u6587\u4ef6\u4e4b\u524d\u5fc5\u987b\u628a\u539f\u6587\u4ef6\u5907\u4efd cp /etc/postfix/main.cf /etc/postfix/main.cf.bak vi /etc/postfix/main.cf alias_database = hash:/etc/aliases #\u7528\u6237\u522b\u540d\u6570\u636e\u6587\u4ef6\uff0c\u9ed8\u8ba4\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53ef\u6539\u6210SQL,LDAP,VIRTUAL alias_maps = hash:/etc/aliases #\u7528\u6237\u522b\u540d\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53ef\u6539\u6210SQL,LDAP,VIRTUAL broken_sasl_auth_clients = yes #\u8bbe\u5b9a SASL \u652f\u6301\u975e\u6807\u51c6 E-mail Client \u7684\u8ba4\u8bc1\u52a8\u4f5c\uff0c\u81ea\u5df1\u6dfb\u52a0 command_directory = /usr/sbin #\u547d\u4ee4\u76ee\u5f55 \u9ed8\u8ba4 config_directory = /etc/postfix #\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 \u9ed8\u8ba4 daemon_directory = /usr/libexec/postfix #\u5b88\u62a4\u8fdb\u7a0b\u76ee\u5f55 \u9ed8\u8ba4 data_directory = /var/lib/postfix #\u6570\u636e\u76ee\u5f55 \u9ed8\u8ba4 debug_peer_level = 2 #\u6392\u9519\u7ba1\u7406\u7ea7\u522b \u9ed8\u8ba4 home_mailbox = Maildir/ #\u4e3b\u76ee\u5f55\u5b58\u50a8\u683c\u5f0f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8bbe\u6210\u53e6\u5916\u7684\u683c\u5f0fmbox\uff0c html_directory = no #\u662f\u5426\u652f\u6301\u7f51\u9875\u683c\u5f0f\u7ba1\u7406 inet_interfaces = all #\u53c2\u6570\u6307\u5b9apostfix\u7cfb\u7edf\u76d1\u542c\u7684\u7f51\u7edc\u63a5\u53e3 inet_protocols = all #\u53ea\u652f\u6301IPv4\u534f\u8bae\uff0c\u8fd8\u662fIPv4 IPv6\u90fd\u652f\u6301,\u8fd8\u662f\u4e3b\u673a\uff0cip mail_owner = postfix #\u90ae\u4ef6\u53ca\u90ae\u4ef6\u961f\u5217\u7684\u6240\u6709\u8005 #mail_spool_directory = /vbox #\u6307\u5b9aUNIX\u98ce\u683c\u7684\u90ae\u7bb1\u4fdd\u5b58\u7684\u76ee\u5f55\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u7cfb\u7edf\u7c7b\u578b mailq_path = /usr/bin/mailq.postfix #\u6307\u5b9a\u67e5\u770b\u90ae\u4ef6\u961f\u5217\u547d\u4ee4MAILQ\u7684\u8def\u5f84 manpage_directory = /usr/share/man #Postfix\u7684\u5728\u7ebf\u624b\u518c\u9875\u7684\u4f4d\u7f6e mydestination = $myhostname ,... #\u53c2\u6570\u6307\u5b9apostfix\u63a5\u6536\u90ae\u4ef6\u65f6\u6536\u4ef6\u4eba\u7684\u57df\u540d\uff0c\u5373\u60a8\u7684postfix\u7cfb\u7edf\u8981\u63a5\u6536\u5230\u54ea\u4e2a\u57df\u540d\u7684\u90ae\u4ef6 mydomain = davistest.com #\u53c2\u6570\u6307\u5b9a\u60a8\u7684\u57df\u540d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cpostfix\u5c06myhostname\u7684\u7b2c\u4e00\u90e8\u5206\u5220\u9664\u800c\u4f5c\u4e3amydomain\u7684\u503c myhostname = mail.davistest.com #\u53c2\u6570\u6307\u5b9a\u8fd0\u884cpostfix\u90ae\u4ef6\u7cfb\u7edf\u7684\u4e3b\u673a\u7684\u4e3b\u673a\u540d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5176\u503c\u88ab\u8bbe\u5b9a\u4e3a\u672c\u5730\u673a\u5668\u540d mynetworks = 192 .168.1.0/24 #\u53c2\u6570\u6307\u5b9a\u4f60\u6240\u5728\u7684\u7f51\u7edc\u7684\u7f51\u7edc\u5730\u5740\uff0cpostfix\u7cfb\u7edf\u6839\u636e\u5176\u503c\u6765\u533a\u522b\u7528\u6237\u662f\u8fdc\u7a0b\u7684\u8fd8\u662f\u672c\u5730\u7684 myorigin = $mydomain #\u53c2\u6570\u7528\u6765\u6307\u660e\u53d1\u4ef6\u4eba\u6240\u5728\u7684\u57df\u540d newaliases_path = /usr/bin/newaliases.postfix #\u5237\u65b0\u522b\u540d\u547d\u4ee4newaliases\u8def\u5f84 queue_directory = /var/spool/postfix #\u6307\u5b9a\u961f\u5217\u7684\u4f4d\u7f6e readme_directory = /usr/share/doc/postfix-2.6.6/README_FILES #\u5e2e\u52a9\u6587\u6863\u4f4d\u7f6e sample_directory = /usr/share/doc/postfix-2.6.6/samples #\u6a21\u677f\u6587\u4ef6\u4f4d\u7f6e sendmail_path = /usr/sbin/sendmail.postfix #\u53d1\u9001\u90ae\u4ef6\u547d\u4ee4\u7684\u4f4d\u7f6e setgid_group = postdrop #\u8fd9\u4e2a\u7ec4\u662f\u63d0\u4ea4\u90ae\u4ef6\u548c\u5bf9\u5217\u7ba1\u7406\u547d\u4ee4 message_size_limit = 10240000 #\u9650\u5236\u53d1\u9001\u4eba\u5355\u4e2a\u90ae\u4ef6\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u662fByte smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated,reject_unauth_destination #\u4fe1\u4ef6\u6536\u4ef6\u7684\u9650\u5236 smtpd_sasl_security_options = noanonymous #\u62d2\u7edd\u533f\u540d\u767b\u5165 smtpd_sasl_auth_enable = yes #Postfix SMTP server\u652f\u63f4SASL\u9a8c\u8bc1 smtpd_sasl_path = private/auth #postfix\u4e0edovecot\u901a\u8baf\u7a0b\u5e8f\u6587\u4ef6\u8def\u5f84 smtpd_sasl_type = dovecot #\u6307\u5b9asasl\u9a8c\u8bc1\u7a0b\u5e8f unknown_local_recipient_reject_code = 550 #\u62d2\u7edd\u4e0d\u5b58\u5728\u7684\u672c\u5730\u5e10\u6237\uff0f\u300c\u4e0d\u660e\u4f7f\u7528\u8005\u300d(unknown user) #\u5982\u679c\u6536\u4fe1\u5730\u5740\u7684\u4eba\u540d\u90e8\u4efd\uff0c\u5728\u4efb\u4f55\u5bf9\u7167\u8868\u3001\u522b\u540d\u8868\u3001\u7cfb\u7edf\u5e10\u6237\u90fd\u67e5\u4e0d\u51fa\u6765\uff0c #\u8fd9\u4e2a\u4eba\u4f1a\u88ab\u89c6\u4e3a\u300c\u4e0d\u660e\u4f7f\u7528\u8005\u300d(unknown user)\uff0c\u7cfb\u7edf\u4f1a\u62d2\u6536 #\u5982\u679c\u5e0c\u671b\u8490\u96c6\u8fd9\u7c7b\u4fe1\u4ef6\uff0c\u4f7f\u7528\u4e0b\u5217\u8bbe\u5b9a\uff0c\u5e76\u6307\u5b9a\u96c6\u4e2d\u6536\u96c6\u7684\u4fe1\u7bb1 #\u4ee5\u4e0a\u7684mydestination\u4e00\u5b9a\u8981\u6709\u672c\u673a\u4e3b\u673a\u540d\uff0c\u8981\u4e0d\u7136\u4f1a\u6536\u4e0d\u5230\u4fe1 # postfix\u4e5f\u81ea\u5e26\u5f88\u591a\u53cd\u5783\u573e\u8bbe\u7f6e\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4ee5\u53ca\u81ea\u5df1\u7684\u9700\u8981\u8fdb\u884c\u8c03\u6574 smtpd_helo_required = yes #\u63e1\u624b\u8981\u6c42 smtpd_delay_reject = yes #\u4e2d\u7ee7\u8981\u6c42 smtpd_client_restrictions = check_client_access hash:/etc/postfix/client_access #\u5ba2\u6237\u7aef\u8bbf\u95ee\u63a7\u5236\u5217\u8868 smtpd_helo_restrictions = reject_invalid_hostname,check_helo_access hash:/usr/local/etc/postfix/helo_access#\u4e3b\u673a\u548c\u63e1\u624b\u63a7\u5236\u5217\u8868 smtpd_sender_restrictions = #\u5ba2\u6237\u7aef\u53d1\u9001\u4eba\u63a7\u5236\u5217\u8868 reject_non_fqdn_sender, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u57df\u540d\u7684\u53d1\u9001\u8005 reject_unknown_sender_domain, #\u62d2\u6536\u4e0d\u77e5\u53d1\u4ef6\u4eba\u57df\u7684\u53d1\u9001\u8005 check_sender_access hash:/usr/local/etc/postfix/sender_access #\u53d1\u4ef6\u4eba\u63a7\u5236\u5217\u8868 smtpd_recipient_restrictions = #\u6536\u4ef6\u63a7\u5236 permit_mynetworks, #\u5141\u8bb8\u6211\u7684\u7f51\u7edc\u5b9a\u4e49\u7684\u5ba2\u6237\u7aef\u6536\u4fe1 permit_sasl_authenticated, #\u5141\u8bb8simple authenticated security layer \u6388\u6743\u7684\u5ba2\u6237\u7aef reject_non_fqdn_hostname, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u7684\u4e3b\u673a reject_non_fqdn_sender, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u7684\u53d1\u9001\u4eba reject_non_fqdn_recipient, #\u62d2\u6536\u6ca1\u6ce8\u518c\u7684\u63a5\u6536\u8005 reject_unauth_destination, #\u62d2\u6536\u6ca1\u6388\u6743\u7684\u76ee\u7684\u4e3b\u673a reject_invalid_hostname, #\u62d2\u6536\u4e0d\u53ef\u7528\u7684\u4e3b\u673a #\u8fd8\u6709\u5f88\u591a smtpd_data_restrictions = reject_unauth_pipelining #\u62d2\u7edd\u6ca1\u6709\u6388\u6743\u7684\u901a\u9053 header_checks = regexp:/postfix/head_checks #\u7edd\u5bf9\u8def\u5f84\u90ae\u4ef6\u5934\uff08\u4e3b\u9898\uff0c\u9644\u4ef6\u540d\u7b49\uff09\u63a7\u5236\u5217\u8868 body_checks = regexp:/etc/postfix/body_checks ##\u7edd\u5bf9\u8def\u5f84\u90ae\u4ef6\u5185\u5bb9\u63a7\u5236\u5217\u8868 \u521b\u5efa\u521a\u624d\u6307\u5b9a\u7684\u6587\u4ef6\u5c31\u4e0d\u4e00\u4e00\u5199\u51fa\u6765\u4e86\uff0c\u7167\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u884c\u4e86 touch /usr/local/etc/postfix/head_checks touch /usr/local/etc/postfix/body_checks postmap /usr/local/etc/postfix/head_checks postmap /usr/local/etc/postfix/body_checks \u8fd8\u662f\u4f8b\u4e3e\u4e00\u4e0b\u5427\uff0c\u8981\u4e0d\u7136\u60f3\u4e86\u89e3\u7684\u90fd\u4e0d\u77e5\u6587\u6863\u600e\u4e48\u5199 \u5047\u5982/etc/postfix/mail.cf \u4e0b\u6709\u5982\u4e0b\u53cd\u5783\u573e\u8bbe\u7f6e\uff1a smtpd_client_restrictions = check_client_access hash:/etc/postfix/access_client smtpd_helo_restrictions = check_client_access hash:/etc/postfix/helo_client smtpd_sender_restrictions = check_client_access hash:/etc/postfix/sender_client smtpd_recipient_restrictions = check_client_access hash:/etc/postfix/recipient_client header_checks = regexp:/etc/postfix/header_check body_checks = regexp:/etc/postfix/body_check \u90a3\u4e48\u6211\u4eec\u5728access_client/helo_client/sender_client/recipient_client \u6587\u4ef6\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a \u5217\u8868\u5206\u4e09\u9879\uff0c\u7b2c\u4e00\u9879\u662f\u89c4\u5219\u5185\u5bb9\uff0c\u7b2c\u4e8c\u9879\u662f\u5bf9\u6ee1\u8db3\u89c4\u5219\u65f6\u6240\u91c7\u53d6\u7684\u884c\u52a8\uff0c\u7b2c\u4e09\u9879\u662f\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u4fe1\u606f \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u4f60\u4e0d\u53ef\u4ee5\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\u53d1\u90ae\u4ef6\uff01access_client \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u7981\u6b62davis\u901a\u8fc7\u672c\u670d\u52a1\u5668\u53d1\u9001\u90ae\u4ef6 sender_client \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u670d\u52a1\u5668\u62d2\u6536\u6765\u81eadavis\u7684\u90ae\u4ef6. recipient_client \u5ba2\u6237\u7aefIP/\u57df\u540d 550 /REJECT/OK.. \u670d\u52a1\u5668\u62d2\u7edd\u4f60\u7684\u8fde\u63a5. helo_client \u4e0d\u8be6\u8bf4\u4e86\uff0c\u77e5\u9053\u5b83\u662f\u600e\u4e48\u5de5\u4f5c\u7684\u5c31\u884c\u4e86\uff0c\u73b0\u5728\u6709\u5f88\u591a\u8f6f\u4ef6,\u6bd4\u5982Mailscanner..\u529f\u80fd\u5f3a\u5927\uff0c\u6613\u7ba1\u7406 \u914d\u5b8c\u4e4b\u540e\uff0c\u4f60\u53ef\u4ee5\u7528postconf -n main.cf\u53bb\u67e5\u770b\u6ca1\u6709\u6ce8\u91ca\u7684\u5185\u5bb9 \u6211\u4eec\u7528pam\u53bb\u8c03\u7528\u8fde\u63a5\u7cfb\u7edf\u7528\u6237\u4e3a\u90ae\u4ef6\u7528\u6237\u9a8c\u8bc1saslauthd,\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528LDAP,MYSQL\u7b49\uff0c\u6216SYRUS\u7684shadow.\u540e\u9762\u6211\u4eec\u4f1a\u8bb2\u5230 # Directory in which to place saslauthd's listening socket, pid file, and so # on. This directory must already exist SOCKETDIR = /var/run/saslauthd # Mechanism to use when checking passwords. Run \"saslauthd -v\" to get a list # of which mechanism your installation was compiled with the ablity to use MECH = pam #\u8fd9\u884cMECH\u8bbe\u6210pam # Options sent to the saslauthd. If the MECH is other than \"pam\" uncomment the next line # DAEMONOPTS=--user saslauth # Additional flags to pass to saslauthd on the command line. See saslauthd(8) # for the list of accepted flags FLAGS = \u6211\u4eec\u7528\u7684\u662fdovecot\u7ed9\u5ba2\u6237\u7aef\u9a8c\u8bc1\u6536\u4fe1\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u786e\u5b9apam\u4e0b\u7684dovecot\u6388\u6743\u5982\u4e0b Vi /etc/pam.d/dovecot #%PAM-1.0 auth required pam_nologin.so auth include password-auth account include password-auth session include password-auth \u63a5\u7740\u914d\u7f6edovecot\u7684\u6536\u4fe1 protocols = imap pop3 lmtp #\u5f00\u653eIMAP POP3 \u7b49\u534f\u8bae \u8def\u5f84/etc/dovecot/dovecot.conf auth_mechanisms = plain login #\u6388\u6743\u673a\u5236\uff0c\u5982\u679c\u6211\u4eec\u7528POSTADMIN\u7f51\u9875\u7ba1\u7406\uff0c\u4e5f\u53ef\u7528\u4ec0\u4e48MD5\u7b49\u7b49 #\u8def\u5f84/etc/dovecot/conf.d/10-auth.conf disable_plaintext_auth = no #\u5141\u8bb8\u7528\u660e\u6587\u8ba4\u8bc1\u767b\u9646\uff0c\u8def\u5f84/etc/dovecot/conf.d/10-auth.conf listen = * #\u6211\u4eec\u53ea\u76d1\u542cIPV4\u7aef\u53e3\u3002\u8def\u5f84/etc/dovecot/dovecot.conf mail_location = maildir:/vbox/%u/Maildir #\u90ae\u4ef6\u76ee\u5f55\uff0c%u\u8868\u793a\u7528\u6237\u540d\u3002\u8def\u5f84/etc/dovecot/conf.d/10-mail.conf mbox_write_locks = fcntl #\u90ae\u7bb1\u9501\u7684\u65b9\u6cd5\u3002\u8def\u5f84/etc/dovecot/conf.d/10-mail.conf passdb { #\u5e10\u6237\u6388\u6743 args = dovecot #\u5c31\u662f/etc/pam.d/\u4e0b\u7684dovecot\u6587\u4ef6 driver = pam #\u5e10\u6237\u6388\u6743\u6570\u636e\u63d0\u4f9b\u5546 } # \u8def\u5f84/etc/dovecot/conf.d/auth-system.conf.ext service auth { #\u670d\u52a1\u6388\u6743 unix_listener /var/spool/postfix/private/auth { #UNIX\u76d1\u542c\u7684\u6388\u6743\u6587\u4ef6 group = postfix #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7684\u5c5e\u7ec4\u4e3aPOSTFIX mode = 0666 #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7ec4\u6743\u9650\u4e3a666 user = postfix #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7684\u5c5e\u4e3b\u4e3apostfix } #\u8def\u5f84 /etc/dovecot/conf.d/auth-system.conf.ext } userdb { #\u7528\u6237\u6570\u636e driver = passwd #\u5171\u7528\u7cfb\u7edf\u5bc6\u7801\u9a71\u52a8 } # \u5efa\u7acb\u90ae\u4ef6\u5b58\u653e\u76ee\u5f55\u90ae\u4ef6\u5907\u4efd\u76ee\u5f55 mkdir /vbox #\u5efa\u7acb\u90ae\u4ef6MAILDIR\u76ee\u5f55 chmod 755 /vbox #\u7ed9\u6743\u9650 mkdir /backup #\u5220\u9664\u7528\u6237\u7684\u5907\u4efd\u76ee\u5f55 chmod 755 /backup #\u5907\u4efd\u76ee\u5f55\u6743\u9650 mkdir /etc/postfix/Mail_Group #\u90ae\u4ef6\u7ec4\u8f6f\u94fe\u76ee\u5f55\uff0c\u4ee5\u540e\u505a\u7ba1\u7406\u9762\u7248\u811a\u672c\u8981\u7528 # \u542f\u52a8\u670d\u52a1 service postfix start service dovecot start service saslauthd start # \u8bbe\u7f6e\u670d\u52a1\u5f00\u673a\u81ea\u52a8\u542f\u52a8 chkconfig postfix on chkconfig dovecot on chkconfig saslauthd on ## \u811a\u672c\u7f16\u5199 # \u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 vi /usr/local/sbin/main #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai echo \"1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7\" #\u5728\u5c4f\u5e55\u4e0a\u8f93\u51fa\u83dc\u5355 echo \"2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7\" echo \"3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7\" echo \"4 \u65b0\u5efa\u90ae\u4ef6\u7ec4\" echo \"5 \u5220\u9664\u90ae\u4ef6\u7ec4\" echo \"6 \u67e5\u770b\u90ae\u4ef6\u7ec4\" echo \"7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4\" echo \"8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237\" echo \"0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406\" order = \"\" #\u8bbe\u53c2\u6570\u4e3a\u4f60\u8981\u5148\u62e9\u7684\u83dc\u5355 echo \"\u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a\" read order echo $order >/tmp/order.txt if [ \" $order \" == \"1\" ] ; then #\u8bbe\u6761\u4ef6\u6839\u636e\u4f60\u7684\u9009\u62e9\u8df3\u5230\u76f8\u5e94\u7684\u7ba1\u7406\u6a21\u5757 mailacounts ; elif [ \" $order \" == \"2\" ] ; then viewusers ; elif [ \" $order \" == \"3\" ] ; then dusers ; elif [ \" $order \" == \"4\" ] ; then groupacounts ; elif [ \" $order \" == \"5\" ] ; then dgroup ; elif [ \" $order \" == \"6\" ] ; then viewgroup ; elif [ \" $order \" == \"7\" ] ; then AMFG ; elif [ \" $order \" == \"8\" ] ; then RMFG ; elif [ \" $order \" == \"0\" ] ; then exit 0 ; else #\u5982\u679c\u4f60\u7684\u9009\u62e9\u4e0d\u662f\u4ee5\u4e0a\u83dc\u5355\uff0c\u63d0\u793a\u9519\u8bef\u5e76\u8fd4\u56de\u63a7\u5236\u9762\u7248 echo \"\u4efb\u52a1\u4ee3\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01\" main fi # \u65b0\u5efa\u90ae\u4ef6\u6a21\u5757 vi /usr/local/sbin/mailacounts home = \"/vbox/\" #\u6ca1\u7f6e\u76ee\u5f55\u53c2\u6570 useraccount = \"\" #\u8bbe\u7f6e\u7528\u6237\u53c2\u6570 echo \"\u8bf7\u7ed9\u65b0\u7528\u6237\u540d\u5b57\uff1a\" read useraccount echo $useraccount > /tmp/user.txt #\u7ed9\u7528\u6237\u53c2\u6570\u8d4b\u503c userpass = \"\" #\u8bbe\u7f6e\u5bc6\u7801\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff1a\" read userpass echo $userpass > /tmp/pass.txt #\u7ed9\u5bc6\u7801\u53c2\u6570\u8d4b\u503c useradd -d $home / $useraccount $useraccount #\u6dfb\u52a0\u7528\u6237\u5e76\u6307\u5b9a\u90ae\u4ef6\u4e3b\u76ee\u5f55 echo $userpass | passwd --stdin $useraccount #\u8bbe\u7f6e\u90ae\u7bb1\u5bc6\u7801 mkdir -p $home / $useraccount /Maildir/ { cur,new,tmp } #\u5efa\u90ae\u4ef6\u76ee\u5f55\u548c\u6587\u4ef6 mkdir -p $home / $useraccount /Maildir/.Drafts/ { cur,new,tmp } mkdir -p $home / $useraccount /Maildir/.Sent/ { cur,new,tmp } mkdir -p $home / $useraccount /Maildir/.Trash/ { cur,new,tmp } chown -R $useraccount $home / $useraccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\uff0dR\u662f\u505a\u4e2a\u9012\u5f52\uff0c\u4e5f\u5c31\u662f\u8bf4\u6587\u4ef6\u5939\u4e0b\u6240\u4ee5\u6709\u5b50\u6587\u4ef6\u5939\u548c\u6587\u4ef6 chmod 700 -R $home / $useraccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6709\u5b8c\u5168\u6743\u9650\uff0c\u5176\u5b83\u4eba\u6ca1\u4efb\u4f55\u6743\u9650 main #\u56de\u5230\u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 # \u65b0\u5efa\u90ae\u4ef6\u7ec4\u6a21\u5757 vim /usr/local/sbin/groupacounts #/bin/bash #Create: 14-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ #\u663e\u793a\u73b0\u6709\u7ec4 home = \"/vbox/\" #\u6ca1\u7f6e\u76ee\u5f55\u53c2\u6570 groupaccount = \"\" #\u8bbe\u7f6e\u90ae\u4ef6\u7ec4\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u65b0\u90ae\u4ef6\u7ec4\u540d\uff1a\" read groupaccount echo $groupaccount > /tmp/group.txt #\u7ed9\u7ec4\u90ae\u7bb1\u53c2\u6570\u8d4b\u503c grouppass = \"\" #\u8bbe\u7f6e\u5bc6\u7801\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u65b0\u90ae\u4ef6\u7ec4\u5bc6\u7801\uff1a\" read grouppass echo $grouppass > /tmp/pass.txt #\u7ed9\u5bc6\u7801\u53c2\u6570\u8d4b\u503c useradd -d $home / $groupaccount $groupaccount #\u6dfb\u52a0\u7ec4\u90ae\u7bb1\u5e76\u6307\u5b9a\u90ae\u4ef6\u4e3b\u76ee\u5f55 echo $grouppass | passwd --stdin $groupaccount #\u8bbe\u7f6e\u7ec4\u90ae\u7bb1\u5bc6\u7801 mkdir -p $home / $groupraccount /Maildir/ { cur,new,tmp } #\u5efa\u7ec4\u90ae\u4ef6\u76ee\u5f55\u548c\u6587\u4ef6 mkdir -p $home / $groupaccount /Maildir/.Drafts/ { cur,new,tmp } mkdir -p $home / $groupaccount /Maildir/.Sent/ { cur,new,tmp } mkdir -p $home / $groupaccount /Maildir/.Trash/ { cur,new,tmp } chown -R $groupaccount $home / $groupaccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6743\u9650\uff0dR\u662f\u505a\u4e2a\u9012\u5f52\uff0c\u4e5f\u5c31\u662f\u8bf4\u6587\u4ef6\u5939\u4e0b\u6240\u4ee5\u6709\u5b50\u6587\u4ef6\u5939\u548c\u6587\u4ef6 chmod 700 -R $home / $groupaccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6709\u5b8c\u5168\u6743\u9650\uff0c\u5176\u5b83\u4eba\u6ca1\u4efb\u4f55\u6743\u9650 touch $home / $groupaccount /.forward #\u5efa\u7ec4\u90ae\u4ef6\u540d\u5355\u8868 chown root $home / $groupaccount /.forward #\u8bbe\u7f6e\u6743\u9650\u7ed9\u540d\u5355\u8868 chmod 755 $home / $groupaccount /.forward ln -s $home / $groupaccount /.forward /etc/postfix/Mail_Group/ $groupaccount #\u505a\u4e00\u4e2a\u8f6f\u8fde\u7ed3\uff0c\u4fbf\u4e8e\u67e5\u627e main #\u56de\u5230\u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 # \u6dfb\u52a0\u90ae\u7bb1\u5230\u6307\u5b9a\u90ae\u7bb1\u7ec4\u6a21\u5757 vim /usr/local/sbin/AMFG #!/bin/bash #Create Date: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group Groupname = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u52a0\u5165\u7684\u7ec4\u5168\u79f0\uff1a\" read Groupname echo $Groupname >/tmp/Groupname.txt cat -n /vbox/ $Groupname /.forward usermail = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u52a0\u7ec4\u7684\u7528\u6237\u90ae\u4ef6\u5730\u5740\uff1a\" read usermail echo $usermail >/tmp/usermail.txt echo $usermail >> /vbox/ $Groupname /.forward main # \u5220\u9664\u90ae\u7bb1\u5e10\u53f7\u6a21\u5757 vim /usr/local/sbin/dusers #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /vbox/ deluser = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\uff1a\" read deluser echo $deluser > /tmp/deluser.txt cp -R -u -i /vbox/ $deluser /backup/ userdel $deluser rm -rf /vbox/ $deluser main \u5220\u9664\u90ae\u7bb1\u7ec4\u6a21\u5757 vim /usr/local/sbin/dgroup #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ degroup = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u90ae\u4ef6\u7ec4\uff1a\" read degroup echo $degroup > /tmp/degroup.txt cp -R -u -i /vbox/ $degroup /backup/ userdel $degroup rm -rf /vbox/ $degroup main # \u67e5\u627e\u90ae\u7bb1\u7528\u6237\u6a21\u5757 vim /usr/local/sbin/viewusers #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /vbox/ >/tmp/userview.txt cat -n /tmp/userview.txt svuser = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u67e5\u627e\u7684\u7528\u6237\u540d\uff1a\" read svuser echo $svuser > /tmp/svuser.txt if grep -q $svuser /tmp/userview.txt ; then echo \"\u7528\u6237 $svuser\u5df2\u7ecf\u5b58\u5728 !\" ; else echo \"\u7528\u6237 $svuser\u4e0d\u5b58\u5728 !\" ; fi grep -n $svuser /tmp/userview.txt main # \u67e5\u627e\u7528\u6237\u7ec4\u6a21\u5757 vim /usr/local/sbin/viewgroup #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ >/tmp/groupview.txt cat -n /tmp/groupview.txt svgroup = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u67e5\u627e\u7684\u90ae\u4ef6\u7ec4\uff1a\" read svgroup echo $svuser > /tmp/svgroup.txt if grep -q $svgroup /tmp/groupview.txt ; then echo \"\u90ae\u4ef6\u7ec4 $svgroup\u5df2\u7ecf\u5b58\u5728 !\" ; else echo \"\u90ae\u4ef6\u7ec4 $group\u4e0d\u5b58\u5728 !\" ; fi grep -n $svgroup /tmp/groupview.txt main # \u4ece\u90ae\u7bb1\u7ec4\u91cc\u5220\u9664\u7528\u6237\u6a21\u5757 vi /usr/local/sbin/RMFG #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group >/tmp/groupview.txt cat -n /tmp/groupview.txt sgroup = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\u5c5e\u7ec4\u540d\u79f0\uff1a\" read sgroup echo $scgoup >/tmp/sgroup.txt cat -n /vbox/ $sgroup /.forward rguser = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\u7f16\u53f7\uff1a\" read rguser echo $rguser >/tmp/rguser.txt sed -i '' $rguser 'd' /vbox/ $sgroup /.forward #\u6309\u7f16\u53f7\u5220\u9664 #sed -i \u201c/$rguser/d\u201d /vbox/$sgroup/.forward #\u6309\u5730\u5740\u5220\u9664 main \u7ba1\u7406\u5458\u624b\u518c \u00b6 # \u8fdb\u5165\u670d\u52a1\u5668\uff0c\u8f93\u5165\u90ae\u4ef6\u7ba1\u7406\u547d\u4ee4main,\u7ba1\u7406\u6240\u6709\u7684\u4efb\u52a1 [ root@mail sbin ] # main 1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7 3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7 4 \u65b0\u5efa\u90ae\u4ef6\u7ec4 5 \u5220\u9664\u90ae\u4ef6\u7ec4 6 \u67e5\u770b\u90ae\u4ef6\u7ec4 7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4 8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237 0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406 \u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a # \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 [ root@mail ~ ] # main 1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7 3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7 4 \u65b0\u5efa\u90ae\u4ef6\u7ec4 5 \u5220\u9664\u90ae\u4ef6\u7ec4 6 \u67e5\u770b\u90ae\u4ef6\u7ec4 7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4 8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237 0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406 \u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a 1 \u8bf7\u7ed9\u65b0\u7528\u6237\u540d\u5b57\uff1a john \u8bf7\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff1a 123456 Changing password for user john passwd: all authentication tokens updated successfully # \u5ba2\u6237\u7aef\u6d4b\u8bd5 \u53ea\u6d4b\u8bd5\u6536\u53d1\u4fe1\uff0c\u5176\u5b83\u7ec4\u5440\uff0c\u5b89\u5168\u7b49\u90fd\u53ef\u4ee5\u81ea\u884c\u8bbe\u7f6e # PostfixAdmin\u7f51\u9875\u7ba1\u7406\u754c\u9762 # \u4f9d\u8d56\u5305\u7684\u5b89\u88c5 yum install \uff0d y mysql - server php php - mysql php - imap php - mbstring # [ PostfixAdmin\u8f6f\u4ef6\u6e90\u7801\u5305\u4e0b\u8f7d\u7f51\u5740 ] ( https : // sourceforge . net / projects / postfixadmin / files / postfixadmin / ) # \u4e0b\u8f7d\u89e3\u538b\u540e\u6dfb\u52a0\u6743\u9650 tar - xzvf postfixadmin - 2.92 . tar . gz chmod 777 / postfixadmin / - R # \u4fee\u6539PostfixAdmin\u7f51\u9875\u4e3b\u914d\u7f6e\u6587\u4ef6 vim / postfixadmin / config . inc . php $ CONF [ 'configured' ] = true ; $ CONF [ 'postfix_admin_url' ] = '/postfixadmin' ; $ CONF [ 'database_type' ] = 'mysqli' ; $ CONF [ 'database_host' ] = 'localhost' ; $ CONF [ 'database_user' ] = 'vmail' ; $ CONF [ 'database_password' ] = 'vmail' ; $ CONF [ 'database_name' ] = 'vmail' ; $ CONF [ 'domain_path' ] = 'YES' ; $ CONF [ 'domain_in_mailbox' ] = 'NO' ; $ CONF [ 'encrypt' ] = 'dovecot:CRAM-MD5' ; $ CONF [ 'emailcheck_resolve_domain ] = 'NO' ; $ CONF [ 'dovecotpw' ] = \"/usr/bin/doveadm pw\" ; # \u65b0\u5efaPostfixAdmin\u6570\u636e\u5e93,\u542f\u52a8MySql\u670d\u52a1 service mysqld start \u8fdb\u5165MySql\u547d\u4ee4\u5de5\u5177\uff0c\u9ed8\u8ba4\u7684MySql\u7528\u6237root\u7684\u5bc6\u7801\u662f\u7a7a\u7684 mysql -u root -p mysql> CREATE DATABASE vmail ; mysql> GRANT ALL PRIVILEGES ON vmail.* TO 'vmail' @ 'localhost' IDENTIFIED BY 'vmail' ; mysql> flush privileges ; mysql> \\q touch /postfixadmin/DATABASE_MYSQL.TXT mysql -uvmail -p vmail < /postfixadmin/DATABASE_MYSQL.TXT \u5982\u679c\u663e\u793aACCESS DENIY, mysql -u vmail -p vmail mysql> set password = password ( 'newpassword' ) \u914d\u7f6ePostfixAdmin\u7f51\u9875\u7ba1\u7406\u5e94\u7528 \u5b89\u88c5\u7f51\u9875\u7a0b\u5e8fapache, \u9ed8\u8ba4\u662f\u5df2\u5b89\u88c5\u7684\uff0c\u6240\u4ee5\u8fd9\u4f60\u53ef\u4ee5\u7701\u4e86\uff0c\u4f60\u53ef\u4ee5\u5148\u67e5\u770b\u4e00\u4e0b\uff0c\u662f\u5426\u6709\u5b89\u88c5\uff0c\u518d\u51b3\u5b9a rpm -qa | grep httpd #\u67e5\u770b\u662f\u5426\u5b89\u88c5 yum install httpd -y #\u5b89\u88c5 \u65b0\u5efa\u7f51\u9875\u7d22\u5f15\u6587\u4ef6 vim /etc/httpd/conf.d/postfixadmin.conf Alias /postfixadmin /postfixadmin \u542f\u52a8Apache\u670d\u52a1 service httpd start POSTFIX\u7684\u865a\u62df\u7528\u6237MYSQL\u8bbe\u7f6e\u548csasl\u8bbe\u7f6e \u5efa\u7acb\u90ae\u4ef6\u76ee\u5f55\u548c\u7ba1\u7406\u7528\u6237 useradd -u 1000 -d /vmail -s /sbin/nologin vmail mkdir /vmail chmod 770 /vmail/ chown vmail:vmail /vmail/ vim /etc/postfix/main.cf \u52a0\u5165\u5982\u4e0b\u8bbe\u7f6e ######################Virtual Settings########################## virtual_mailbox_domains = proxy:mysql:/etc/postfix/mysql_virtual_domains_maps.cf virtual_alias_maps = proxy:mysql:/etc/postfix/mysql_virtual_alias_maps.cf virtual_mailbox_maps = proxy:mysql:/etc/postfix/mysql_virtual_mailbox_maps.cf virtual_mailbox_base = /vmail virtual_minimum_uid = 1000 virtual_uid_maps = static:1000 virtual_gid_maps = static:1000 virtual_transport = dovecot #####################SASL Settings############################### smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous broken_sasl_auth_clients = yes smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_non_fqdn_hostname, reject_non_fqdn_sender, reject_non_fqdn_recipient, reject_unknown_sender_domain, reject_unknown_recipient_domain, reject_unauth_pipelining, reject_unauth_destination, reject_invalid_hostname ###################Mail Quota Settings############################### message_size_limit = 204800000 maximal_queue_lifetime = 1d bounce_queue_lifetime = 1d vim /etc/postfix/master.cf \u6700\u540e\u884c\u52a0\u5165\uff0cflages \u524d\u4e00\u5b9a\u8981\u6709\u4e24\u4e2a\u7a7a\u683c\u54e6 dovecot unix - n n - - pipe flags = DRhu user = vmail:vmail argv = /usr/libexec/dovecot/deliver -d ${ recipient } [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_domains_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = domain select_field = domain where_field = domain additional_conditions = and backupmx = '0' and active = '1' [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_alias_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = alias select_field = goto where_field = address additonal_conditions = and active = '1' [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_mailbox_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = mailbox select_field = CONCAT ( domain, '/' ,maildir ) where_field = username additional_conditions = and active = '1' vim /etc/postfix/mysql_virtual_mailbox_limit_maps.cf user = vmail password vmail hosts = localhost dbname = vmail table = mailbox select_field = quota where_field = username additional_conditions = and active = '1' DOVECOT\u6536\u4fe1\u548cSMTPD\u8ba4\u8bc1 [ root@mail ~ ] # vim /etc/dovecot/dovecot.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 protocols = imap pop3 lmtp listen = * base_dir = /var/run/dovecot/ #first_valid_uid = 89 #last_valid_uid = 89 #maildir_copy_with_hardlinks = yes [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-auth.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 disable_plaintext_auth = no auth_mechanisms = plain login cram-md5 !include auth-sql.conf.ext [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-master.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 unix_listener /var/spool/postfix/private/auth { mode = 0666 user = vmail group = vmail } [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-mail.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 mail_location = maildir:/vmail/%u/Maildir [ root@mail ~ ] # vim /etc/dovecot/conf.d/15-lda.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 protocol lda { postmaster_address = postmaster@dggd.com sendmail_path = /usr/lib/sendmail auth_socket_path = /var/run/dovecot/auth-master } [ root@mail ~ ] # vim /etc/dovecot/conf.d/20-pop3.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 pop3_uidl_format = %08Xu%08Xv [ root@mail ~ ] # vim /etc/dovecot/conf.d/auth-sql.conf.ext \u4fee\u6539\u5982\u4e0b\u9009\u9879 passdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext } userdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext } [ root@mail ~ ] # vim /etc/dovecot/dovecot-sql.conf.ext driver = mysql connect = host = localhost dbname = vmail user = vmail password = vmail default_pass_scheme = PLAIN-MD5 password_query = SELECT username as user, password, '/vmail/%d/%n' as userdb_home, 'maildir:/vmail/%d/%n/Maildir' as userdb_mail, 1000 as userdb_uid, 1000 as userdb_gid FROM mailbox WHERE username = '%u' AND active = '1' user_query = SELECT '/vmail/%d/%n' as home, 'maildir:/vmail/%d/%n/Maildir' as mail, 1000 AS uid, 1000 AS gid, concat ( 'dirsize:storage=' , quota ) AS quota FROM mailbox WHERE username = '%u' AND active = '1' \u6539\u6587\u4ef6\u6743\u9650 [ root@mail ~ ] # chmod 600 /etc/dovecot/* -R [ root@mail ~ ] # chown vmail /etc/dovecot/* -R [ root@mail ~ ] # chomd 777 /var/run/dovecot/auth-master \u6253\u5f00PostfixAdmin\u7ba1\u7406\u754c\u9762 http://localhost/postfixadmin/setup.php \u586b\u5199\u5b89\u88c5\u5bc6\u7801 \u590d\u5236\u4ea7\u751f\u51fa\u6765\u7684\u5b89\u88c5\u5bc6\u7801\u5199\u5165\u5230\u4e3b\u914d\u7f6e\u6587\u4ef6/postfixadmin/config.inc.php\u7684 $CONF [ 'setup_password' ] = '' ; \u7136\u540e\u8bbe\u7f6e\u8d85\u7ea7\u7ba1\u7406\u5458\u548c\u5bc6\u7801 \u63a5\u7740\u6210\u529f\u7684\u767b\u9646PostfixAdmin\u7ba1\u7406\u4f60\u7684\u90ae\u4ef6\u5e10\u6237 RoundCube\u7f51\u9875\u8bbf\u95ee\u5ba2\u6237\u7aef \u4e0b\u8f7d\u89e3\u538b\u6539\u540d\uff0c\u653e\u5165\u7f51\u9875\u5f15\u5bfc\u8def\u5f84 \u4e0b\u8f7d wget http://sourceforge.net/projects/roundcubemail/files/roundcubemail/1.0.3/roundcubemail-1.0.3.tar.gz/download \u89e3\u538b tar -zxvf roundcubemail-1.0.3.tar.gz \u653e\u5165\u7f51\u9875\u5f15\u5bfc\u8def\u5f84 cp roundcubemail-1.0.3 /var/www/html/ -R \u6539\u540d mv /var/www/html/roundcubemail-1.0.3 /var/www/html/usermail Apache\u6dfb\u52a0php\u6a21\u5757 vim /etc/httpd/conf/httpd.conf \u6dfb\u52a0\u4e0b\u9762\u4e24\u884c AddType application/x-httpd-php .php PHPIniDir \"/etc/php.ini\" \u6dfb\u52a0PHP\u6a21\u5757\u65f6\u95f4\u533a\u57df vim /etc/php.ini \u6dfb\u52a0\u4e0b\u9762\u4e00\u884c date.timezone = Asia/Shanghai \u4fee\u6539\u6743\u9650 chmod 777 /var/www/html/usermail/temp chmod 777 /var/www/html/usermail/logs chmod 777 /var/www/html/usermail/config -R chmod 777 /var/lib/php/session -R \u914d\u7f6eCONFIG\u6587\u4ef6\u4e0epostfixadmin\u8fde\u63a5\u540c\u4e00\u4e2a\u6570\u636e\u5e93 \u542f\u7528CONFIG\u6587\u4ef6 cp /var/www/html/usermail/config/config.inc.php.sample /var/www/html/usermail/config/config.inc.php \u6539\u5199MYSQL\u6570\u636e\u67e5\u8be2\u4e0ePOSTFIXADMIN\u4e00\u6837 vim /var/www/html/usermail/config/config.inc.php \u4fee\u6539\u4e0b\u9762\u4e00\u884c $config [ 'db_dsnw' ] = 'mysql://vmail:vmail@localhost/vmail' ; $config [ 'enable_installer' ] = true ; \u5b89\u88c5PHP-DOM yum install php53-dom yum -y install php-dom \u7f51\u9875\u914d\u7f6e 1 : http://\u57df\u540d\u6216IP/usermail/installer \u6253\u5f00IE\uff0c\u70b9\u51fbNEXT ( \u4e0b\u4e00\u6b65 ) 2 : Create config\uff0c\u8bbe\u7f6e\u4f60\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u663e\u793a/\u670d\u52a1\u5668\u540d/\u7f51\u7edc/\u6570\u636e\u5e93\u8fde\u63a5 ( \u4e0epostfixadmin\u76f8\u540c\u6570\u636e ) ..\u7b49\u7b49\u3002\u81ea\u5df1\u63e3\u6478 3 : TEST CONFIG \u51fa\u73b0\u5982\u4e0bNOT OK.\u6570\u636e\u5e93\u6ca1\u6709\u521d\u59cb\u5316 Check DB config DSN ( write ) : OK DB Schema: NOT OK ( Database not initialized ) \u70b9\u51fb Initialize Database, \u521d\u59cb\u5316\u6570\u636e\uff0c\u5b83\u4f1a\u8fd4\u56de\u7ed3\u679cOK Check DB config DSN ( write ) : OK DB Schema: OK DB Write: OK DB Time: OK \u8f93\u5165POSTFIXADMIN\u5efa\u7684\u90ae\u4ef6\u5730\u5740\u6d4b\u8bd5SMTP\u548cIMAP.\u4f1a\u8fd4\u56de\u7ed3\u679cOK \u5b8c\u6210\u4e86\uff0chttp://\u57df\u540d\u6216IP/usermail *** *** *** <h1 style = \"text-align:center\" >OPENWEBMAIL\u7f51\u9875\u90ae\u4ef6\u67b6\u8bbe</h1> # \u5b89\u88c5\u524d\u63d0\uff1ayum \u2013y install perl-suidperl perl-Compress-Zlib perl-Text-Iconv\u6216yum install -y perl* \u5982\u679cPERL-TEST-ICOV \u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u53c2\u7167\u5982\u4e0b\u53bb\u4e0b\u8f7d: wget http://openwebmail.org/openwebmail/download/redhat/rpm/packages/centos5/ \\ perl-Text-Iconv/i386/perl-Text-Iconv-1.7-2.el5.i386.rpm \u5b89\u88c5\uff1arpm -ivh perl-Text-Iconv-1.7-2.el5.i386.rpm \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a rpm \u2013qa | grep perl- \u5b89\u88c5APACHE: Yum \u2013y install httpd \u8fdb\u5165YUM\u6e90\u76ee\u5f55\uff1acd /etc/yum.repos.d \u4e0b\u8f7dYum\u6e90\uff1awpget http://openwebmail.org/openwebmail/download/redhat/rpm/release/openwebmail.repo \u5728\u7ebf\u5b89\u88c5\uff1aYum \u2013y install openwebmail \u79bb\u7ebf\u5b89\u88c5\uff1ahttp://openwebmail.org/openwebmail/download/release/openwebmail-2.53.tar.gz # \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff1a vim /var/www/cgi-bin/openwebmail/etc/default/dbm.conf vim /var/www/cgi-bin/openwebmail/etc/dbm.conf dbm_ext .pag dbmopen_ext none dbmopen_haslock yes smtpserver 192 .168.222.41 cd /var/www/cgi-bin/openwebmail/ ./openwebmail-tool.pl \u2013-init # \u6d4b\u8bd5 IE\u8bbf\u95ee\uff1ahttp://mail.davis.dg/cgi-bin/openwebmail/openwebmail.pl # POSTFIX\u90ae\u4ef6\u6062\u590d \u4f8b\u5982\uff1a\u6062\u590d\u201cDNS\u201d\u90ae\u4ef6\u76ee\u5f55 \u4ece\u90ae\u4ef6\u670d\u52a1\u5668backup\u76ee\u5f55/restore/davis_dai\u627e\u5230\u8981\u6062\u590d\u7684 cd /restore/davis_dai/Maildir drwx\u2014\u2014 5 davis_dai 2000 4 .0K Nov 14 14 :36 .Boss drwx\u2014\u2014 5 davis_dai 2000 4 .0K Oct 8 2012 .Deleted Items drwx\u2014\u2014 5 davis_dai 2000 4 .0K May 6 09 :12 .Deleted Messages drwx\u2014\u2014 5 davis_dai users 4 .0K Nov 14 14 :36 .DNS cp -a .DNS /home/davis_dai/Maildir Fix the permission chown davis_dai /home/davis_dai/Maildir/.DNS -R sendmail\u5b89\u88c5 ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.15.2.tar.gz","title":"Linux"},{"location":"Linux/#linux","text":"I. stunnel -> varnish -> HAProxy -> nginx -> nodeJS -> memcached(redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8]) II. Apache Traffic Server/Squid/Vanish + HAProxy + Nginx + memcached(Redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8]) III. nginx (for HTTP compression) \u2013> Varnish cache (for caching) \u2013> HTTP level load balancer (HAProxy, or nginx, or the Varnish built-in) \u2013> webservers","title":"Linux"},{"location":"Linux/#_1","text":"\u670d\u52a1\u5668\u7c7b\u578b \u57fa\u672craid\u65b9\u6848 \u5355\u673a\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\uff0c\u4e00\u822c\u53ef\u91c7\u7528raid5\u6298\u4e2d \u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982LVS\u7b49\uff09 \u6570\u636e\u91cf\u5c0f\uff0c\u91cd\u8981\u6027\u9ad8\uff0c\u53ef\u91c7\u7528RAID1 \u8d1f\u8f7d\u5747\u8861\u4e0b\u7684RS server \u6570\u636e\u91cf\u5927\uff0c\u91cd\u8981\u6027\u4e0d\u9ad8\uff0c\u6709\u6027\u80fd\u8981\u6c42\uff0c\u6570\u636e\u8981\u6c42\u4f4e\uff0c\u53ef\u91c7\u7528RAID0 \u6570\u636e\u5e93\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\u4e3b\u5e93\u53ef\u91c7\u53d6raid10/raid5\uff0c\u4ece\u5e93\u53ef\u91c7\u7528raid0\u63d0\u9ad8\u6027\u80fd\uff08\u8bfb\u5199\u5206\u79bb\u7684\u60c5\u51b5\u4e0b\uff09 \u5b58\u50a8\u670d\u52a1\u5668 \u53ef\u91c7\u53d6sata\u76d8\uff0craid5 \u5171\u4eab\u5b58\u50a8\u670d\u52a1\u5668\uff08\u5982NFS\uff09 \u89c6\u6027\u80fd\u53ca\u8bbf\u95ee\u8981\u6c42\u53ef\u4ee5raid5,raid10,\u751a\u81f3raid0\uff08\u8981\u6709\u9ad8\u53ef\u7528\u6216\u53cc\u5199\u65b9\u6848\uff09 \u76d1\u63a7\u670d\u52a1\u5668 \u5355\u76d8\u6216\u53cc\u76d8raid1\u5373\u53ef\u3002\u4e09\u76d8\u5c31RAID5\uff0c\u770b\u5bb9\u91cf\u8981\u6c42\u52a0\u76d8\u5373\u53ef","title":"\u5206\u533a\u65b9\u6848\u53c2\u8003"},{"location":"Linux/#linux_1","text":"","title":"Linux\u6587\u4ef6\u7cfb\u7edf"},{"location":"Linux/#linux_2","text":"\u78c1\u76d8\u5206\u533a\u6709\u4e3b\u5206\u533a\u3001\u6269\u5c55\u5206\u533a\u3001\u903b\u8f91\u5206\u533a\uff0c\u4e00\u5757\u786c\u76d8\u6700\u591a\u53ef\u4ee5\u6709\u56db\u4e2a\u4e3b\u5206\u533a\uff0c\u5176\u4e2d\u4e00\u4e2a\u4e3b\u5206\u533a\u7684\u4f4d\u7f6e\u53ef\u4ee5\u7528\u4e00\u4e2a\u6269\u5c55\u5206\u533a\u66ff\u6362\uff0c\u4e14\u4e00\u5757\u786c\u76d8\u53ea\u80fd\u6709\u4e00\u4e2a\u6269\u5c55 \u5206\u533a\uff0c\u5728\u8fd9\u4e2a\u6269\u5c55\u5206\u533a\u5185\u53ef\u4ee5\u5212\u5206\u591a\u4e2a\u903b\u8f91\u5206\u533a \u9884\u8ba1\u8d85\u8fc7\u56db\u4e2a\u5206\u533a\uff0c\u81f3\u5c11\u4e00\u4e2a\u6269\u5c55\u5206\u533a\uff1a 3 p + 1 e \u3001 2 p + 1 e \u3001 1 p + 1 e -----p\uff1a\u4e3b\u5206\u533a\u3001e\uff1a\u6269\u5c55\u5206\u533a \u78c1\u76d8\u5206\u533a\u7684\u8bbe\u5907\u540d\uff1a \u5728 linux\u4e2d \uff0c\u901a\u8fc7\u8bbe\u5907\u540d\u8bbf\u95ee\u8bbe\u5907\uff0c\u8bbe\u5907\u540d\u5b58\u653e\u5728 / dev\u76ee\u5f55 * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / hda * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / hdb * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / sda * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a / dev / sdb \u5206\u533a\u5219\u4f7f\u7528\u6570\u5b57\u7f16\u53f7\u6807\u8bc6\uff1a * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / hda1 * \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757 IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / hdb1 * \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757 SCSI\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a / dev / sdb1 \u6ce8\u610f\uff1a \u5206\u533a\u6570\u5b57\u7f16\u53f7 1 - 4 \u7559\u7ed9\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\u4f7f\u7528\uff0c\u903b\u8f91\u5206\u533a\u662f\u5728\u6269\u5c55\u5206\u533a\u7684\u57fa\u7840\u4e0a\u7f16\u53f7\u4ece 5 \u5f00\u59cb SCSI / SAS / SATA / USB\u63a5\u53e3\u7684\u786c\u76d8\u7684\u8bbe\u5907\u540d\u5747\u4ee5 / dev / sd\u5f00\u5934 \uff0c\u4e0d\u540c\u786c\u76d8\u7f16\u53f7\u4f9d\u6b21\u662f / dev / sda \u3001 / dev / sdb SAS / SATA\u662f\u4e3b\u6d41\u786c\u76d8\u63a5\u53e3 \uff0c SSD\u56fa\u6001\u786c\u76d8 \uff0c\u901f\u5ea6\u6027\u80fd SSD > SAS > SATA","title":"linux\u78c1\u76d8\u8be6\u89e3"},{"location":"Linux/#linux_3","text":"\u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\uff1a \u56fa\u4ef6 firmware ( CMOS / BIOS ) post \u52a0\u7535\u81ea\u68c0 \u5bf9\u4e8e\u56fa\u4ef6\u7684\u7406\u89e3\uff0c\u662f\u4ecb\u4e8e\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u8f6f\u4ef6\u4ee3\u7801\uff0c\u4f46\u540c\u65f6\u70e7\u5f55\u5230\u786c\u4ef6\u5f53\u4e2d\uff1b CMOS \u56fa\u5316\u5728\u786c\u4ef6\u4e2d\uff0c\u4f5c\u4e3a\u56fa\u4ef6\u7684\u5e73\u53f0\uff0c BIOS \u662f\u7ba1\u7406 CMOS \u7684\u7ba1\u7406\u754c\u9762 \u63a5\u7740\uff0c\u81ea\u4e3e\u7a0b\u5e8f bootloader ( GRUB ) ,\u8f7d\u5165\u5185\u6838 \u7b2c\u4e00\u6b65\u7684\u6700\u540e\u8981\u8bfb\u53d6\u786c\u76d8\u4e2d\u7684 MBR \uff0c\u5305\u542b\u4e86 BootLoader ,\u5728 MBR \u4e2d\u8fd8\u5305\u542b\u4e86\u5206\u533a\u8868\u7b49\u4fe1\u606f \u5185\u6838\u7684\u5de5\u4f5c\uff0c\u9a71\u52a8\u786c\u4ef6\uff0c\u542f\u52a8\u521d\u59cb\u8fdb\u7a0b init ;\u5728kernel\u4e2d\u5927\u90e8\u5206\u90fd\u662f\u7a0b\u5e8f\uff1binit\u542f\u52a8\u540e\u8bfb\u53d6inittab\u6587\u4ef6\uff0c\u6267\u884c\u7f3a\u7701\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\uff0c\u4ece\u800c\u7ee7\u5f15\u5bfc\u8fc7\u7a0b\uff1b \u5728 linux \u7cfb\u7edf\u4e2d\uff0c init \u662f\u7b2c\u4e00\u4e2a\u5b58\u5728\u7684\u8fdb\u7a0b\uff0c\u5b83\u7684 PID \u6052\u4e3a\u4e00\uff0c\u4f46\u4e5f\u5fc5\u987b\u5411\u4e00\u4e2a\u66f4\u9ad8\u7ea7\u7684\u529f\u80fd\u8d1f\u8d23\uff1a PID \u4e3a\u96f6\u7684\u5185\u6838\u8c03\u5ea6\u5668\uff0c\u4ece\u800c\u83b7\u5f97 cpu \u65f6\u95f4 \u5173\u952e\u70b9\uff1a\u5bf9\u4e8e\u7236\u5b50\u8fdb\u7a0b\u7684\u5173\u7cfb\u3002\u9996\u5148\uff0c\u7236\u8fdb\u7a0b\u4e2d\u65ad\uff0c\u5b50\u8fdb\u7a0b\u540c\u6837\u4f1a\u4e2d\u65ad\uff1b\u5982\u679c\u7236\u8fdb\u7a0b\u4e2d\u65ad\u540e\uff0c\u5b50\u8fdb\u7a0b\u6ca1\u6709\u4e2d\u65ad\uff0c\u8fd9\u79cd\u5173\u7cfb\u5f62\u8c61\u79f0\u4e4b\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u53d1\u73b0\u540e \u4f1a\u5c06\u5b64\u513f\u8fdb\u7a0b\u6307\u5411\u7236\u8fdb\u7a0b init ;\u5982\u679c\u7236\u8fdb\u7a0b\u6b63\u5e38\uff0c\u800c\u5b50\u8fdb\u7a0b\u4e2d\u65ad\u7684\u8bdd\uff0c\u8fd9\u6837\u6ef4\u5173\u7cfb\u79f0\u4e4b\u4e3a\u50f5\u5c38\u8fdb\u7a0b\uff1b\u8fd9\u4e24\u79cd\u8fdb\u7a0b\u5728\u7cfb\u7edf\u4e2d\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684 \u5907\u6ce8\uff1a linux \u4e2d\u7684\u8fd0\u884c\u7ea7\u522b\u7c7b\u4f3c\u4e8e windows \u5e73\u53f0\u4e2d\u7684 F8 \u529f\u80fd \u5355\u7528\u6237\u6a21\u5f0f\uff08\u7ea7\u522b 1 \uff09\u7c7b\u4f3c windos \u5e73\u53f0\u4e2d F8 \u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u533a\u522b\u662f\u6ca1\u6709\u56fe\u5f62\u754c\u9762\uff0c\u53ea\u6709\u547d\u4ee4\u8f93\u5165 \u8fd0\u884c\u7ea7\u522b 2 \u548c 3 \u7684\u533a\u522b\u5c31\u662f 2 \u7ea7\u522b\u6ca1\u6709 NFS \u529f\u80fd\uff0c\u540c\u65f6\u90fd\u662f\u591a\u7528\u6237\u6a21\u5f0f \u67e5\u770b\u5f53\u524d\u7684\u8fd0\u884c\u7ea7\u522b\uff1a runlevel \u8fd0\u884c\u7ea7\u522b\u7684\u5207\u6362\uff1a init 0 1 2 3 4 5 S \u6216\u8005 telinit 0 1 2 3 4 5 \u6269\u5c55\uff1a\u5b9e\u9645\u5927\u5bb6\u901a\u8fc7\u547d\u4ee4 ls - l ` which telinit `\u5f97\u77e5 telinit \u540d\u662f init \u547d\u4ee4\u7684\u4e00\u4e2a\u8f6f\u8fde\u63a5\u800c\u5df2 grep - v \" ^# \" / etc / inittabl #\u63d0\u53d6\u6709\u6548\u884c\uff0c\u4f5c\u4e3a\u5206\u6790\u6570\u636e \u6587\u4ef6\u683c\u5f0f\u5206\u6790\uff1a\uff08\u5b57\u6bb5\u7ec4\u6210\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a\uff09 id : runlevels action : process id \u6807\u793a\u7b26,\u4e00\u822c\u90fd\u662f\u4e24\u4f4d\u5b57\u6bcd\u6216\u8005\u6570\u5b57 runlevels \u6307\u5b9a\u8fd0\u884c\u7ea7\u522b\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff1b\u4f8b\u5982::\u4ee3\u8868 0 - 6 action \u6307\u5b9a\u8fd0\u884c\u72b6\u6001 process \u6307\u5b9a\u8981\u8fd0\u884c\u7684\u811a\u672c\u6216\u8005\u547d\u4ee4 action \u53d6\u503c\uff1a initdefault \u8868\u793a\u7cfb\u7edf\u7f3a\u7701\u7684\u542f\u52a8\u8fd0\u884c\u7ea7\u522b sysinit \u7cfb\u7edf\u542f\u52a8\u65f6\u6267\u884c process \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4 wait \u6267\u884c process \u4e2d\u6307\u5b9a\u547d\u4ee4\uff0c\u5e76\u7b49\u5230\u7ed3\u675f\u540e\u5728\u8fd0\u884c\u5176\u4ed6\u7684\u547d\u4ee4 one \u6267\u884c process \u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u7ed3\u675f ctrlaltdel \u6309\u4e0b\u7ec4\u5408\u952e\u6267\u884c process \u6307\u5b9a\u7684\u547d\u4ee4\uff1b ( \u5173\u673a\u7684\u64cd\u4f5c ) \u5148\u540e\u987a\u5e8f\uff1a 1 . id : 3 : initdefault \uff1a 2 . l3 : 3 : wait : / etc / rc . d / rc 3 . / etc / rc . d / rc3 . d \u5224\u65ad\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\u8c03\u7528 / etc / rc . d / rc \u811a\u672c\uff0c\u6267\u884c\u76f8\u5173\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e2d\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u5b8c\u6210\u76f8\u5e94\u8fd0\u884c\u7ea7\u522b\u7684\u521d\u59cb\u5316\u914d\u7f6e\uff1b\u4e4b\u540e\u627e\u5230 / etc / rc . d / rc3 . d \u811a\u672c\uff0c \u5b8c\u6210\u7cfb\u7edf\u540e\u7eed\u7684\u5f15\u5bfc\u8fc7\u7a0b\uff0c\u5176\u4f5c\u7528\u662f\u5206\u522b\u5b58\u653e\u5bf9\u5e94\u4e8e\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u94fe\u63a5\u5230 init . d \u76ee\u5f55\u4e2d\u7684\u76f8\u5e94\u811a\u672c / etc / rc . d / r3 . d \u76ee\u5f55\u5305\u542b\u4e86\u4e24\u79cd\u6587\u4ef6\u5f88\u91cd\u8981\uff0c\u4e00\u79cd\u5927\u5199 S \u5f00\u5934\uff0c\u53e6\u4e00\u79cd\u662f\u5927\u5199\u7684 K \u5f00\u5934 S start K kill number \u8868\u793a\u542f\u52a8\u7684\u987a\u5e8f\uff0c\u6570\u5b57\u8d8a\u5c0f\u4f18\u5148\u542f\u52a8\uff1b\u5982\u679c\u6570\u5b57\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u4f1a\u6309\u7167\u521b\u5efa\u7684\u65f6\u95f4 Firmware | BootLoader | Kernel | init | / etc / inittab | initdefault | / etc / rc . d / rc . sysinit | / etc / rc . d / rc | / etc / rc . d / rcN . d | Login ( username , password ) \u542f\u52a8\u7cfb\u7edf\u9996\u5148\u56fa\u4ef6\u7684\u52a0\u7535\u81ea\u68c0\uff1b\u5178\u578b\u4e3a PC \u4e2d cmos / bios \u4f5c\u7528\u662f\u5728\u7269\u5c42\u6b21\u9762\u4e0a\u68c0\u6d4b\u6240\u6709\u7684\u786c\u4ef6\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1b\u5982\u679c\u786c\u4ef6\u6b63\u5e38\u7684\u8bdd\uff0c\u4f1a\u8bfb\u53d6\u786c\u76d8\u7684\u4e0a\u5b58\u653e \u7269\u7406\u6570\u636e\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e MBR \uff0c MBR \u4e3b\u8981\u662f\u5b58\u653e\u81ea\u4e3e\u7a0b\u5e8f BootLoader \uff0c\u5728 linux \u7cfb\u7edf\u4e2d\u6211\u4eec\u5927\u591a\u6570\u91c7\u7528\u7684\u662f GRUB \uff0c GRUB \u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u8f7d\u5165\u5185\u6838\uff1b\u8f7d\u5165 \u5185\u6838\u540e\uff0c\u4e24\u4e2a\u4f5c\u7528\uff0c\u7b2c\u4e00\u662f\u5728 linux \u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u4e0a\u662f\u9a71\u52a8\u786c\u4ef6\u548c\u542f\u52a8 init \u8fdb\u7a0b\uff1b\u7136\u540e\u8bfb\u53d6 / etc / inittab \u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u7f6e\u6587\u4ef6\u4f1a\u5224\u65ad\u7cfb\u7edf\u7f3a\u7701\u7684\u8fd0\u884c \u7ea7\u522b\u7136\u540e\u6267\u884c\u811a\u672c / etc / rc . d / rc . sysinit \u52a0\u8f7d\u57fa\u672c\u7684\u7cfb\u7edf\u670d\u52a1\uff1b\u63a5\u7740\u6839\u636e\u8bbe\u7f6e\u7684\u7f3a\u7701\u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\uff08 id : 3 , 5 : initdefault :\uff09\u6267\u884c / etc / rc . d / rc \u811a\u672c\uff0c\u6b64\u811a\u672c\u4f1a\u5224\u65ad initdefault \uff0c\u7136\u540e\u542f\u52a8\u5bf9\u5e94\u7684\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e0b\u9762\u7684\u7a0b\u5e8f / etc / rc . d / rcN . d \uff0c\u6700\u540e\u51fa\u73b0\u767b\u9646\u754c\u9762\u4e86\uff0c\u8f93\u5165\u6b63\u786e\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef \u767b\u5f55\u7cfb\u7edf\u7ee7\u800c\u7ba1\u7406\u670d\u52a1\u5668 / etc / rc . d / init . d \u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u4e86\u5404\u4e2a\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c / etc / init . d \u53d1\u73b0\u6b64\u6587\u4ef6\u662f / etc / rc . d / init . d \u7684\u8f6f\u8fde\u63a5","title":"linux\u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\u89e3\u6790"},{"location":"Linux/#_2","text":"dmesg | grep sdb # \u68c0\u67e5\u786c\u76d8\u8bbe\u5907sdb\u662f\u5426\u5b58\u5728 fdisk -l /dev/sdb # \u67e5\u770b\u6b64\u786c\u76d8\u8bbe\u5907\u4fe1\u606f fdisk /dev/sdb # \u5bf9\u786c\u76d8\u8fdb\u884c\u5206\u533a\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u65f6ext4\u7c7b\u578b\uff0cid=83\uff0cid=82\u662fswap : << comment \u8f93\u5165`m`\u5217\u51fa\u53ef\u4ee5\u6267\u884c\u7684\u547d\u4ee4\uff1a command (m for help): m \u8f93\u5165`p`\u5217\u51fa\u78c1\u76d8\u76ee\u524d\u7684\u5206\u533a\u60c5\u51b5\uff1a Command (m for help): p \u8f93\u5165`d`\u7136\u540e\u9009\u62e9\u5206\u533a\uff0c\u5220\u9664\u73b0\u6709\u5206\u533a\uff1a Command (m for help): d Partition number (1-4): 1 Command (m for help): d Selected partition 2 \u67e5\u770b\u5206\u533a\u60c5\u51b5\uff0c\u786e\u8ba4\u5206\u533a\u5df2\u7ecf\u5220\u9664(\u5bf9\u5e94\u5206\u533a\u5220\u9664\u540e\uff0c\u4e0d\u4f1a\u518d\u663e\u793a)\uff1a Command (m for help): p \u8f93\u5165`n`\u5efa\u7acb\u65b0\u7684\u78c1\u76d8\u5206\u533a\uff0c\u9996\u5148\u5efa\u7acb\u4e24\u4e2a\u4e3b\u78c1\u76d8\u5206\u533a\uff1a Command (m for help): n Command action e extended p primary partition (1-4) p //\u5efa\u7acb\u4e3b\u5206\u533a Partition number (1-4): 1 //\u5206\u533a\u53f7 First cylinder (1-391, default 1): //\u5206\u533a\u8d77\u59cb\u4f4d\u7f6e Using default value 1 last cylinder or +size or +sizeM or +sizeK (1-391, default 391): 100 //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3a\u6247\u533a Command (m for help): n //\u518d\u5efa\u7acb\u4e00\u4e2a\u5206\u533a Command action e extended p primary partition (1-4) p Partition number (1-4): 2 //\u5206\u533a\u53f7\u4e3a2 First cylinder (101-391, default 101): Using default value 101 Last cylinder or +size or +sizeM or +sizeK (101-391, default 391): +200M //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3aM \u786e\u8ba4\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u518d\u5efa\u7acb\u4e00\u4e2a\u903b\u8f91\u5206\u533a\uff1a Command (m for help): n Command action e extended p primary partition (1-4) e //\u9009\u62e9\u6269\u5c55\u5206\u533a Partition number (1-4): 3 First cylinder (126-391, default 126): Using default value 126 Last cylinder or +size or +sizeM or +sizeK (126-391, default 391): Using default value 391 \u786e\u8ba4\u6269\u5c55\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u5728\u6269\u5c55\u5206\u533a\u4e0a\u5efa\u7acb\u4e24\u4e2a\u903b\u8f91\u5206\u533a\uff1a Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l //\u9009\u62e9\u903b\u8f91\u5206\u533a First cylinder (126-391, default 126): Using default value 126 Last cylinder or +size or +sizeM or +sizeK (126-391, default 391): +400M Command (m for help): n Command action l logical (5 or over) p primary partition (1-4) l First cylinder (176-391, default 176): Using default value 176 Last cylinder or +size or +sizeM or +sizeK (176-391, default 391): Using default value 391 \u786e\u8ba4\u903b\u8f91\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a Command (m for help): p \u6700\u540e\u5bf9\u5206\u533a\u64cd\u4f5c\u8fdb\u884c\u5199\u5165\u4fdd\u5b58\uff1a Command (m for help): w # \u5efa\u7acb\u597d\u5206\u533a\u4e4b\u540e\u6211\u4eec\u8fd8\u9700\u8981\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u624d\u80fd\u5728\u7cfb\u7edf\u4e2d\u4f7f\u7528\u78c1\u76d8 mkfs.ext4 /dev/sdb1 # \u5728sdb1\u4e0a\u5efa\u7acbext4\u5206\u533a \u786c\u76d8sdb\u6211\u4eec\u5efa\u7acb\u4e862\u4e2a\u4e3b\u5206\u533a\uff08sdb1\uff0csdb2\uff09\uff0c1\u4e2a\u6269\u5c55\u5206\u533a\uff08sdb3\uff09\uff0c2\u4e2a\u903b\u8f91\u5206\u533a\uff08sdb5\uff0csdb6\uff09 \u6ce8\u610f\uff1a\u4e3b\u5206\u533a\u548c\u6269\u5c55\u5206\u533a\u7684\u78c1\u76d8\u53f7\u4f4d1-4\uff0c\u4e5f\u5c31\u662f\u8bf4\u6700\u591a\u67094\u4e2a\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\uff0c\u903b\u8f91\u5206\u533a\u5f00\u59cb\u7684\u78c1\u76d8\u53f7\u4e3a5\uff0c\u56e0\u6b64\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u6ca1\u6709sdb4 # \u5efa\u7acb\u4e24\u4e2a\u76ee\u5f55`/oracle`\u548c`/web`\uff0c\u5c06\u65b0\u5efa\u597d\u7684\u4e24\u4e2a\u5206\u533a\u6302\u8f7d\u5230\u7cfb\u7edf mkdir /oracle mkdir /web mount /dev/sdb1 /oracle mount /dev/sdb6 /web \u5982\u679c\u9700\u8981\u6bcf\u6b21\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\u5219\u9700\u8981\u4fee\u6539`/etc/fstab`\u6587\u4ef6\uff0c\u52a0\u5165\u4e24\u884c\u914d\u7f6e\uff1a /dev/sdb1 /oracle ext4 defaults 0 0 /dev/sdb6 /web ext4 defaults 0 0 comment","title":"\u6dfb\u52a0\u786c\u76d8\u6216\u5206\u533a\u8be6\u7ec6\u6b65\u9aa4"},{"location":"Linux/#linuxfhs","text":"\u57fa\u672c\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff1a ( \u53ef\u4ee5\u7528 file \u547d\u4ee4\u6765\u8bc6\u522b ) * \u666e\u901a\u6587\u4ef6\uff1a\u5982\u6587\u672c\u6587\u4ef6\u3001 c \u8bed\u8a00\u6e90\u4ee3\u7801\u3001 shell \u811a\u672c\u7b49\uff0c\u53ef\u4ee5\u7528 cat \u3001 less \u3001 more \u3001 vi \u7b49\u6765\u5bdf\u770b\u5185\u5bb9\uff0c\u7528 mv \u6765\u6539\u540d * \u76ee\u5f55\u6587\u4ef6\uff1a\u5305\u62ec\u6587\u4ef6\u540d\u3001\u5b50\u76ee\u5f55\u540d\u53ca\u5176\u6307\u9488\uff0c\u53ef\u4ee5\u7528 ls \u5217\u51fa\u76ee\u5f55\u6587\u4ef6 * \u94fe\u63a5\u6587\u4ef6\uff1a\u662f\u6307\u5411\u4e00\u7d22\u5f15\u8282\u70b9\u7684\u90a3\u4e9b\u76ee\u5f55\u6761\u76ee\uff0c\u7528 ls \u6765\u67e5\u770b\u65f6\uff0c\u94fe\u63a5\u6587\u4ef6\u7684\u6807\u5fd7\u7528 l \u5f00\u5934\uff0c\u800c\u6587\u4ef6\u540e\u4ee5 \" -> \" \u6307\u5411\u6240\u94fe\u63a5\u7684\u6587\u4ef6 * \u7279\u6b8a\u6587\u4ef6\uff1a\u5982\u78c1\u76d8\u3001\u7ec8\u7aef\u3001\u6253\u5370\u673a\u7b49\u90fd\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8868\u793a\u51fa\u6765\uff0c\u5e38\u653e\u5728 / dev \u76ee\u5f55\u5185 ~ \uff1a\u4ee3\u8868\u7528\u6237\u81ea\u5df1\u7684\u5bbf\u4e3b\u76ee\u5f55 .\uff1a\u8868\u793a\u5f53\u524d\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528. / \u8868\u793a ..\uff1a\u8868\u793a\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528.. / \u8868\u793a / bin \u4fdd\u5b58\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u53ef\u6267\u884c\u7684\u6307\u4ee4\uff09\u6743\u9650\u5bf9\u6240\u6709\u7528\u6237\u5f00\u653e / boot \u5b58\u653e\u5f00\u673a\u542f\u52a8\u52a0\u8f7d\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6,\u5305\u62ec\u5f15\u5bfc\u6587\u4ef6\u3001\u5185\u6838\u6587\u4ef6\u3001\u9a71\u52a8\u3001 \u63d2\u4ef6\u3001\u6a21\u5757\u7b49\uff1b ( \u5982 kernel \u548c grup ) / dev \u5b58\u653e\u4e86\u6240\u6709\u7684\u786c\u4ef6\u8bbe\u5907\u6587\u4ef6\uff1b\u7f51\u5361\uff0c\u58f0\u5361\uff0c\u786c\u76d8\uff0c\u5149\u9a71\uff1b tty1 , tty2 \u7ec8\u7aef\uff0c\u8bbe\u5907\u6587\u4ef6\u76ee\u5f55\uff0c\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u5b58\u653e\u6240\u6709\u7cfb\u7edf\u4e2d device \u7684\u76f8\u5173 \u4fe1\u606f\uff0c\u4e0d\u8bba\u662f\u4f7f\u7528\u7684\u6216\u672a\u4f7f\u7528\u7684\u8bbe\u5907\uff0c\u53ea\u8981\u6709\u53ef\u80fd\u4f7f\u7528\u5230\uff0c\u5c31\u4f1a\u5728 / dev \u4e2d\u5efa\u7acb\u4e00\u4e2a\u76f8\u5bf9\u5e94\u7684\u8bbe\u5907\u6587\u4ef6\uff1b\u8bbe\u5907\u6587\u4ef6\u5206\u4e3a 2 \u79cd\u7c7b\u578b\uff1a\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\u548c \u5757\u8bbe\u5907\u6587\u4ef6 ( \u76ee\u5f55\u4e2d\u57fa\u672c\u4e0a\u90fd\u662f\u8bbe\u5907\u6587\u4ef6\uff0c\u5982\u786c\u76d8\u8bbe\u5907\u6587\u4ef6 / dev / sda ) / dev / console \u7cfb\u7edf\u63a7\u5236\u53f0\uff0c\u4e5f\u5c31\u662f\u76f4\u63a5\u548c\u7cfb\u7edf\u8fde\u63a5\u7684\u76d1\u89c6\u5668 / dev / hd IDE \u8bbe\u5907\u6587\u4ef6 / dev / sd sata \u3001 usb \u3001 scsi \u7b49\u8bbe\u5907\u6587\u4ef6 / dev / fd \u8f6f\u9a71\u8bbe\u5907\u6587\u4ef6 / dev / tty \u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6 / dev / pty \u63d0\u4f9b\u8fdc\u7a0b\u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6 / dev / null \u6240\u8c13 \" \u9ed1\u6d1e \" \uff0c\u6240\u6709\u5199\u5165\u8be5\u8bbe\u5907\u7684\u4fe1\u606f\u90fd\u5c06\u6d88\u5931\uff0c\u5982\u5f53\u60f3\u5c06\u5c4f\u5e55\u4e0a\u7684\u8f93\u51fa\u4fe1\u606f\u9690\u85cf\u8d77\u6765\u65f6\uff0c\u53ea\u8981\u5c06\u8f93\u51fa\u4fe1\u606f\u8f93\u5165\u5230 / dev / null \u5373\u53ef / etc \u7cfb\u7edf\u3001\u7f51\u7edc\u6216\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u7b80\u5355\u7684\u5c06 / etc \u76ee\u5f55\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff1a \u57fa\u672c\u6587\u4ef6\uff1a\u6240\u6709\u76f4\u63a5\u653e\u5728 / etc \u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5f52\u7c7b\u4e3a\u57fa\u672c\u6587\u4ef6 aliases \uff1a\u7528\u4e8e\u8bbe\u7f6e\u90ae\u4ef6\u522b\u540d auto . * \uff1a\u4ee3\u8868\u7684\u662f\u4e00\u7cfb\u5217 autofs \u670d\u52a1\u6240\u9700\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e2a\u670d\u52a1\u4e3b\u8981\u662f\u8ba9\u7ba1\u7406\u5458\u53ef\u4ee5\u4e8b\u5148\u5b9a\u4e49\u51fa\u4e00\u4e9b\u7f51\u7edc\u3001\u672c\u673a\u6216\u5149\u9a71\u7b49\u9ed8\u8ba4\u7684\u8def\u5f84 auto . master \uff1a\u8d1f\u8d23\u89c4\u5212\u76ee\u5f55\u7684\u5206\u914d\u4e0e\u4f7f\u7528\uff0c\u76ee\u524d\u9ed8\u8ba4\u63d0\u4f9b\u4e09\u79cd\u81ea\u52a8\u6302\u8f7d\u6a21\u5f0f auto . misc \uff1a\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u90fd\u4ee5\u5b9e\u4f53\u8fde\u63a5\u672c\u673a\u7684\u78c1\u76d8\u9a71\u52a8\u5668\u4e3a\u4e3b auto . net \uff1a\u5e76\u4e0d\u662f\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u662f\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c\u5728\u4f7f\u7528\u4e0a\u5176\u5b9e\u4e0d\u987b\u505a\u4efb\u4f55\u8c03\u6574\uff1b auto . smb \uff1a\u4e0e auto . net \u4e00\u6837\uff0c\u90fd\u662f\u4ee5\u4e2a\u811a\u672c\u6587\u4ef6 bashrc \uff1a\u7528\u6237\u767b\u5f55\u529f\u80fd\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u522b\u540d profile \uff1a\u4e0e\u7cfb\u7edf\u73af\u5883\u914d\u7f6e\u6216\u521d\u59cb\u5316\u8f6f\u4ef6\u7684\u76f8\u5173\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u53d8\u91cf DIR_COLORS \uff1a\u7528\u4e8e\u914d\u7f6e ls \u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9 tty \u767b\u5f55\u7684\u7528\u6237 DIR_COLORS . xterm \uff1a\u7528\u4e8e\u914d\u7f6e ls \u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9 xterm \u767b\u5f55\u7684\u7528\u6237 fstab \uff1a\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6 inittab \uff1a\u542f\u52a8\u65f6\u7cfb\u7edf\u6240\u9700\u8981\u7684\u7b2c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1b\u4e5f\u5373\u662f init \u8fdb\u7a0b\u7684\u914d\u7f6e\u6587\u4ef6 issue \uff1a\u7528\u6237\u672c\u673a\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f issue . net \uff1a\u7528\u6237\u7f51\u7edc\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f ld . so . conf \uff1a\u5305\u542b ld . so . conf . d /*.conf\u914d\u7f6e\uff1b\u4e3b\u8981\u662fld.so.conf.d/*.conf\u76ee\u5f55\u7684\u4f5c\u7528 localtime\uff1a\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u65f6\u533a\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u5bf9\u5e94\u7684\u65f6\u533a\u6587\u4ef6\u90fd\u5b58\u5728\u4e8e/usr/share/zoneinfo/ motd\uff1a\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u663e\u793a\u7684\u4fe1\u606f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 mtab\uff1a\u53ef\u4ee5\u5f53\u505a\u662f\u68c0\u67e5\u5f53\u524d\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u60c5\u51b5\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u4e0emount\u547d\u4ee4\u7ed3\u679c\u4e00\u81f4 prelink.conf\uff1a\u5b9a\u4e49\u54ea\u4e9b\u6267\u884c\u6587\u4ef6\u548c\u51fd\u6570\u5e93\u662f\u9700\u8981\u9884\u5148\u8fde\u63a5\u7684 securetty\uff1a\u4e3b\u8981\u662flogin\u7a0b\u5e8f\u5728\u4f7f\u7528\u7684\uff0c\u53ea\u8981\u662f\u5217\u5728\u8be5\u6587\u4ef6\u4e2d\u7684\u63a5\u53e3\uff0c\u5c31\u8868\u793a\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u63a5\u53e3\uff0c\u76f8\u53cd\uff0c\u82e5\u4ece\u5217\u8868\u4e2d\u5220\u9664\uff0c\u5219\u65e0\u6cd5\u4f7f\u7528\u8be5\u63a5\u53e3 shells\uff1a\u8bb0\u5f55\u76ee\u524d\u7cfb\u7edf\u6240\u62e5\u6709shell\u79cd\u7c7b\u7684\u8def\u5f84\uff0c\u901a\u8fc7cssh\u547d\u4ee4\u4f7f\u7528 sudoers\uff1asudo\u547d\u4ee4\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u914d\u7f6e\u6743\u9650\u7684\u5206\u914d\u65b9\u5f0f sysctl.conf\uff1a\u4e3b\u8981\u662f\u5e2e\u52a9\u7528\u6237\u914d\u7f6e/proc/sys\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u503c\uff0c\u4e0esysctl\u547d\u4ee4\u5bf9\u5e94 syslogd.conf\uff1a\u662fsyslogd\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6 host.conf\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u8bf4\u660e\u89e3\u6790\u7684\u65b9\u5f0f\u53ca\u987a\u5e8f hosts\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u5217\u51fa\u6240\u6709\u9700\u8981\u672c\u5730\u89e3\u6790\u7684\u4e3b\u673a\u540d\u4e0eIP\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb hosts.allow\u548chosts.deny\uff1alinux\u7f51\u7edc\u5b89\u5168\u673a\u5236TCP Wrapper\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 nsswitch.conf\uff1a\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u5e94\u5982\u4f55\u67e5\u8be2\u4e3b\u673a\u540d\u3001\u5bc6\u7801\u3001\u7528\u6237\u7ec4\u3001\u7f51\u7edc\u7b49\uff0c\u6216\u662f\u67e5\u8be2\u987a\u5e8f\u7684\u7f16\u6392 resolv.conf\uff1a\u8bb0\u5f55DNS\u670d\u52a1\u5668\u5730\u5740\uff0c\u7528\u4e8eDNS\u57df\u540d\u89e3\u6790 services\uff1a\u5b9a\u4e49\u4e86\u7f51\u7edc\u670d\u52a1\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7 xinetd.conf\uff1axinetd\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u76ee\u7684\u662f\u4e3axinetd.d\u4e0b\u7684\u6240\u6709\u5b50\u670d\u52a1\u5efa\u7acb\u4e00\u4e2a\u6807\u51c6\u7684\u89c4\u8303\u4f7f\u5176\u53ef\u4ee5\u9075\u5faa anacrontab\uff1a\u5c5e\u4e8e\u4e00\u79cd\u4efb\u52a1\u8ba1\u5212\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0canacrontab\u8f6f\u4ef6\u548ccrond\u5176\u5b9e\u6709\u70b9\u76f8\u8f85\u76f8\u6210\uff0ccrond\u8d1f\u8d23\u4efb\u52a1\u8ba1\u5212\uff0c\u800canacrontab\u5219\u662f \u8d1f\u8d23\u4ee5\"\u95f4\u9694\u591a\u4e45\"\u4e3a\u4e3b\u8981\u7684\u76ee\u6807 at.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528at\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1 at.allow\uff1a\u4e0eat.deny\u521a\u597d\u76f8\u53cd crontab\uff1acrontab\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0ccrond\u9ed8\u8ba4\u4f1a\u6267\u884c\u7684\u6587\u4ef6\u53ef\u4ee5\u53c2\u8003\u6b64\u914d\u7f6e\u6587\u4ef6 cron.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528crond\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1 cron.allow\uff1a\u4e0ecron.deny\u521a\u597d\u76f8\u53cd exports\uff1a\u662fNFS\u670d\u52a1\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u5c06\u672c\u673a\u7684\u76ee\u5f55\u5171\u4eab\u5230\u7f51\u7edc\u4e0a\uff0c\u4f9b\u5176\u4ed6\u4eba\u4f7f\u7528 group\u4e0egshadow\uff1a\u7528\u6237\u7ec4\u914d\u7f6e\u6587\u4ef6\uff0cgroup\u4e3b\u8981\u4fdd\u5b58\u7528\u6237\u7ec4\u4fe1\u606f\uff0cgshadow\u4e3b\u8981\u4fdd\u5b58\u7fa4\u7ec4\u5bc6\u7801 login.defs\uff1a\u8bbe\u7f6e\u7cfb\u7edf\u5728\u5efa\u7acb\u8d26\u53f7\u65f6\u6240\u53c2\u8003\u7684\u914d\u7f6e passwd\uff1a\u4e3b\u8981\u4fdd\u5b58\u7cfb\u7edf\u7528\u6237\u8d26\u53f7\u7684\u4fe1\u606f shadow\uff1alinux\u7cfb\u7edf\u901a\u5e38\u5305\u7ecf\u8fc7\"hash\"\u5904\u7406\u540e\u7684\u5bc6\u7801\u5b58\u50a8\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d protocols\uff1a\u901a\u4fe1\u534f\u8bae\u5bf9\u5e94\u7aef\u53e3\u53f7\u7684\u4e00\u4e2a\u5bf9\u7167\u8868\uff0c\u5305\u542b\u534f\u8bae\u540d\u79f0\u3001\u534f\u8bae\u53f7\u7801\u3001\u6ce8\u91ca\u7b49 wgetrc\uff1awget\u7a0b\u5e8f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u4e2d\u6709quota\u3001mail header\u3001\u91cd\u4f20\u6587\u4ef6\u7684\u9884\u8bbe\u6b21\u6570\u3001firewall\u548cproxy\u7b49\u76f8\u5173\u8bbe\u7f6e init.d\uff1aRHEL\u4e2d\u6240\u6709\u670d\u52a1\u7684\u9ed8\u8ba4\u542f\u52a8\u811a\u672c\u90fd\u5b58\u653e\u5728\u8fd9\u91cc\uff1b\u8fd9\u4e2a\u662f\u94fe\u63a5\u6587\u4ef6\uff0c\u94fe\u63a5\u5230/etc/rc.d/init.d csh.cshrc\u548ccsh.login\uff1a \u7528\u6237\u542f\u52a8c shells\u6267\u884c\u7684\u521d\u59cb\u5316\u914d\u7f6e\u6587\u4ef6 printcap\uff1alinux\u7cfb\u7edf\u4e2d\u6253\u5370\u673a\u8bbe\u5907\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6 \u670d\u52a1\u5668\u76ee\u5f55\uff1a\u5982samba\u3001http\u3001vsftpd\u7b49\u670d\u52a1\u5668\u914d\u7f6e\u76f8\u5173\u76ee\u5f55 cups\uff1alinux\u4e0b\u7684\u6253\u5370\u673a\u670d\u52a1\u5668\uff0c\u76ee\u5f55\u4e0b\u5b58\u653e\u7684\u662f\u6253\u5370\u673a\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6 dnsmasq.d\uff1adnsmasq\u662f\u4e00\u79cdDNS\u7684\"\u8f7b\u8584\u673a\u79cd\"\uff0c\u8f6c\u4e3a\u533a\u57df\u6216\u5c0f\u578b\u7f51\u7edc\u6240\u8bbe\u8ba1\uff0c\u62e5\u6709\u6bd4\u4e00\u822cDNS\u66f4\u4e3a\u65b9\u4fbf\u7b80\u6613\u7684\u914d\u7f6e httpd\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u76ee\u5f55 mail\uff1aMail Server\u7ec4\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5982sendmail ntp\uff1a\u7f51\u7edc\u65f6\u95f4\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4e3a/etc/ntp.conf openldap\uff1a\u76ee\u5f55\u660e\u663e\u662fLDAP\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u8f6f\u4ef6\u540d\u79f0\u4e3aOpenLDAP postfix\uff1apostfix\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 samba\uff1a\u6587\u4ef6\u5171\u4eab\u670d\u52a1samba\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 smrsh\uff1a\u8fd9\u662fsendmail\u4e3a\u4e86\u9650\u5236\u7528\u6237\u53ef\u4f7f\u7528\u7684\u547d\u4ee4\u8bbe\u8ba1\u7684\u7a0b\u5e8f\uff0c\u5c06\u539f\u672c\u7528\u6237\u6240\u4f7f\u7528\u7684/bin/sh\u66ff\u6362\u4e3a/usr/sbin/smrsh snmp\uff1a\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u5b58\u5728snmpd.conf\u4e3b\u914d\u7f6e\u6587\u4ef6 squid\uff1a\u8fd9\u662flinux\u4e0b\u7684\u4ee3\u7406\u670d\u52a1\u5668squid\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsquid.conf ssh\uff1aSSH\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsshd_config vsftpd\uff1avsftpd\u670d\u52a1\u5668\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fvsftpd.conf xinetd.d\uff1axinetd\u662f\u4e00\u4e2a\u7ba1\u7406\u591a\u4e2a\u670d\u52a1\u7684daemon\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5217\u51fa\u7684\u670d\u52a1\u90fd\u662f\u7531xinetd\u8fdb\u7a0b\u7ba1\u7406\u7684\uff0c\u5176\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/xinetd.conf \u7cfb\u7edf\u76ee\u5f55\uff1a\u5982sysconfig\u3001xen\u6216\u7f51\u7edc\u914d\u7f6e\u7b49\u4e0e\u7cfb\u7edf\u8fd0\u884c\u76f8\u5173\u7684\u76ee\u5f55 blkid\uff1a\u6b64\u76ee\u5f55\u6240\u5b58\u653e\u4e00\u4e2a\u5757\u8bbe\u5907ID\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u533a\u5757\u8bbe\u5907\u7684\u6807\u7b7e\u540d\u79f0\u3001\u786c\u4ef6\u7684\u552f\u4e00\u8bc6\u522b\u7801\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u7b49\u57fa\u672c\u4fe1\u606f bluetooth\uff1alinux\u4e0b\u4f7f\u7528\u84dd\u7259\u8bbe\u5907\u6240\u9700\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u542f\u52a8\u84dd\u7259\u68c0\u6d4b\u7684\u4e3b\u8981\u670d\u52a1\u4ecd\u662f/etc/rc.d/init.d/bluetooth\uff0c\u8be5\u7a0b\u5e8f\u4f7f\u7528\u7684\u662f hcid.conf\u914d\u7f6e\u6587\u4ef6 cron.X\uff1acron.X\u7684\u76ee\u5f55\u90fd\u662f\u7ed9cron\u8f6f\u4ef6\u5b58\u653e\u5176\u9700\u8981\u4efb\u52a1\u8ba1\u5212\u7684\u6587\u4ef6\u6240\u4f7f\u7528\u7684\uff0c\u6309\u4efb\u52a1\u8ba1\u5212\u65f6\u95f4\u7684\u957f\u77ed\u53ca\u914d\u7f6e\u7279\u6027\u5206\u4e3acron.d\u3001cron.daily\u3001 cron.hourly\u3001cron.monthly\u3001cron.weekly\u4e94\u4e2a\u4e3b\u8981\u76ee\u5f55 dbus-1\uff1aD-BUS\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0cD-BUS\u4e5f\u662f\u4e00\u79cdIPC\u4ea4\u6d41\u7684\u65b9\u5f0f default\uff1a\u8fd9\u91cc\u662f\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u8f6f\u4ef6\u9ed8\u8ba4\u503c\u7684\u76ee\u5f55\uff0c\u5b58\u653e\u67d0\u4e9b\u8f6f\u4ef6\u6267\u884c\u65f6\u7684\u57fa\u672c\u53c2\u6570 firmware\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u5b58\u653e\u7684\u4e1c\u897f\u662f\u975e\u5e38\u5e95\u5c42\u7684\u4fe1\u606f\uff0c\u662fCPU\u6240\u9700\u7684microcode\u7684\u5b9e\u4f53\u6587\u4ef6 foomatic\uff1a\u4e0e\u6253\u5370\u673a\u76f8\u5173\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5b9e\u73b0\u6253\u5370\u4e00\u5bf9\u591a\u7684\u65b9\u5f0f\uff0c\u5728foomatic\u4e2d\uff0c\u53ef\u4ee5\u8bb0\u5f55\u591a\u6761\u6253\u5370\u673a\u6570\u636e\uff0c\u8ba9\u7528\u6237\u53ea\u5728\u4f7f\u7528\u524d\u5148\u884c\u914d\u7f6e\u6240\u6709 \u9700\u8981\u4f7f\u7528\u7684\u6253\u5370\u673a\u5373\u53ef hal\uff1a\u5168\u540dHardware Abstraction Layer\uff0c\u662flinux\u4e00\u79cd\u7ba1\u7406\u786c\u4ef6\u7684\u673a\u5236\uff0c\u5b83\u4f1a\u5e2e\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u7528\u6237\u641c\u96c6\u6240\u6709PCI\u53caUSB\u7b49\u786c\u4ef6\u4fe1\u606f\uff0c \u56e0\u6b64\u7528\u6237\u53ef\u4ee5\u5f88\u7b80\u5355\u5e76\u5b9e\u65f6\u5730\u901a\u8fc7HAL\u7684\u65b9\u5f0f\u53d6\u5f97\u786c\u4ef6\u7684\u76f8\u5173\u6570\u636e isdn\uff1aISDN\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u91cc\u9762\u5305\u542b\u53ef\u62e8\u53f7\u7684\u7528\u6237\u3001\u7535\u8bdd\u3001\u8054\u673a\u65b9\u5f0f\u7b49 ld.so.conf.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fldconfig\u6240\u4f7f\u7528\u7684\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\uff0c\u5b83\u662f\u7531/etc/ld.so.conf\u6587\u4ef6\u6240\u51b3\u5b9a\u7684\uff1bldconfig\u547d\u4ee4\u7684\u76ee\u7684\u5728\u4e8e\u5c06\u7cfb\u7edf \u4e2d\u7684\u4e00\u4e9b\u51fd\u6570\u5e93\u9884\u5148\u5b58\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u8ba9\u7cfb\u7edf\u4f7f\u7528\u65f6\u53ef\u4ee5\u6bd4\u4ee5\u5f80\u901a\u8fc7\u786c\u76d8\u7684\u8bfb\u53d6\u901f\u5ea6\u6765\u7684\u66f4\u5feb\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u63d0\u9ad8\u7cfb\u7edf\u6027\u80fd\uff0c \u5c24\u5176\u5f53\u8981\u91cd\u590d\u8bfb\u53d6\u65f6\u66f4\u660e\u663e\uff1bldconfig\u8981\u5c06\u54ea\u4e9b\u51fd\u6570\u5e93\u4e22\u5230\u5185\u5b58\u4e2d\uff0c\u5219\u987b\u770b/etc/ld.so.conf\u6587\u4ef6\u4e2d\u6240\u8bb0\u5f55\u7684\u4fe1\u606f logrotate.d\uff1a\u6b64\u76ee\u5f55\u5bf9\u7cfb\u7edf\u7ba1\u7406\u5458\u6765\u8bf4\uff0c\u662f\u5341\u5206\u91cd\u8981\u7684\u4e00\u4e2a\u76ee\u5f55\uff0c\u56e0\u4e3a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e86\u5982\u4f55\u5b9a\u671f\u5907\u4efd\u7cfb\u7edf\u6240\u9700\u8981\u5907\u4efd\u7684\u7cfb\u7edf\u6216\u8f6f\u4ef6 \u65e5\u5fd7\u6587\u4ef6\u53ca\u5907\u4efd\u65b9\u5f0f\uff0c\u76ee\u5f55\u662f\u7531logrotate\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0c\u800c\u91cc\u9762\u6240\u6709\u6587\u4ef6\u662f\u7531\u5404\u8f6f\u4ef6\u5404\u81ea\u4ea7\u751f\u7684\uff1b\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662f /etc/logrotate.conf logwatch\uff1alogrotate\u4e3b\u8981\u662f\u5b9e\u73b0\u5982\u4f55\u5907\u4efd\u65e5\u5fd7\u6587\u4ef6\uff0c\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662f\u8bb0\u8f7d\u5982\u4f55\u5206\u6790\u65e5\u5fd7\u6587\u4ef6\u5e76\u544a\u8bc9\u7528\u6237\u7684\u8f6f\u4ef6logwatch\u7684\u914d\u7f6e\u76ee\u5f55 lsb-release.d\uff1aLSB\u662f\u4e00\u4e2a\u7531\u5f88\u591a\u4eba\u6240\u6267\u884c\u7684\u9879\u76ee\uff0c\u5176\u76ee\u7684\u662f\u5c06\u6240\u6709\u7684Linux\u53d1\u884c\u7248\u5b9a\u4e49\u4e3a\u4e00\u4e9b\u5171\u540c\u7684\u6807\u51c6 lvm\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fLVM\u7684\u57fa\u672c\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u914d\u7f6e\u6216\u64cd\u4f5c\u4e00\u822c\u90fd\u53ea\u9700\u8981\u901a\u8fc7LVM\u63d0\u4f9b\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u4f1a\u7528\u5230\u8fd9\u4e2a\u76ee\u5f55\uff0c\u9664\u975e\u8981\u4f7f\u7528\u5230\u5f88\u9ad8\u7ea7\u7684\u914d\u7f6e \u624d\u4f1a\u66f4\u6539\u6b64\u6587\u4ef6 makedev.d\uff1aMAKEDEV\u8f6f\u4ef6\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cMAKEDEV\u4e3b\u8981\u7528\u6765\u4ea7\u751f\u8bbe\u5907\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728/dev\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u7531\u8fd9\u4e2a\u547d\u4ee4\u4ea7\u751f\u7684\uff0c \u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e3b\u8981\u662f\u9488\u5bf9\u8bbe\u5907\u6587\u4ef6\u7684\u5b9a\u4e49\u6216\u5c5e\u6027\uff0c\u76ee\u5f55\u4e2d\u5b58\u5728\u7684\u8bbe\u5907\u6587\u4ef6\u53ef\u4ee5\u7531MAKEDEV\u6765\u521b\u5efa\uff0c\u5426\u5219\u9700\u8981\u4f7f\u7528mknod\u547d\u4ee4 modprobe.d\uff1a\u662fmodprobe\u547d\u4ee4\u7684\u4f4f\u914d\u7f6e\u76ee\u5f55\uff0c\u4e00\u822c\u7cfb\u7edf\u542f\u52a8\u9ed8\u8ba4\u8981\u52a0\u8f7d\u7684\u6a21\u5757\u653e\u5728/etc/modprobe.conf\u4e2d netplug\u548cnetplug.d\uff1a\u8fd9\u4e24\u4e2a\u76ee\u5f55\u548c\u7f51\u7edc\u63a5\u53e3\u7684\u8054\u673a\u4e0e\u5426\u7531\u76f4\u63a5\u5173\u7cfb\uff0c\u56e0\u4e3a\u4e3b\u8981\u662f\u63a7\u5236\u8054\u673a\u65f6\u7684\u63a5\u53e3\u64cd\u4f5c opt\uff1a\u6b64\u76ee\u5f55\u539f\u672c\u662f\u5b9a\u4e49\u4e3a\u5b58\u653e\u6240\u6709\u989d\u5916\u5b89\u88c5\u8f6f\u4ef6\u7684\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u76ee\u524d\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\uff0c\u6b64\u76ee\u5f55\u4e3a\u7a7a pcmcia\uff1a\u8fd9\u662fPCMCIA\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cPCMCIA\u662f\u7b14\u8bb0\u672c\u7535\u8111\u4e0d\u53ef\u6216\u7f3a\u7684\u63a5\u53e3\uff0c\u9700\u8981\u5373\u63d2\u5373\u7528\u7684\u65b9\u5f0f\uff0c\u6b64\u63a5\u53e3\u4f7f\u7528\u8f83\u5c11 pm\uff1a\u7531pm-utils\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u76ee\u5f55\uff0cpm-utils\u662f\u4e00\u5957\u7535\u6e90\u7ba1\u7406\u7684\u5de5\u5177\u8f6f\u4ef6\uff0c\u5176\u4e2d/usr/lib/pm-utils\u4e5f\u662f\u4e3b\u8981\u76ee\u5f55\u4e4b\u4e00 ppp\uff1appp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d profile.d\uff1a\u76ee\u5f55\u5b58\u653e\u7cfb\u7edf\u90e8\u5206\u7684\u8f6f\u4ef6\u914d\u7f6e\uff0c\u4f46\u6309\u4e0d\u540c\u7684shell\u6267\u884c\u4e0d\u540c\u6587\u4ef6\uff0c\u9ed8\u8ba4\u6240\u4f7f\u7528bash\u4f1a\u76f4\u63a5\u6267\u884c\u8be5\u76ee\u5f55\u4e0b\u6240\u6709\u6269\u5c55\u540d\u4e3a.sh\u7684\u6587\u4ef6 rc.d\uff1a\u4e3b\u8981\u7528\u6765\u5b9a\u4e49\u5728\u6bcf\u4e00\u4e2a\u6267\u884c\u9636\u6bb5\u5fc5\u987b\u8981\u6267\u884c\u54ea\u4e9b\u7cfb\u7edf\u670d\u52a1\u6216\u7a0b\u5e8f\uff0c\u5728\u76ee\u5f55\u4e2d\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u91cd\u8981\u7684\u90e8\u5206\uff1a --rc.sysinit\uff1a\u7cfb\u7edf\u4e00\u5f00\u59cb\u542f\u52a8\u65f6\u6240\u9047\u5230\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u6b64\u811a\u672c\u8bb0\u5f55\u670d\u52a1\u542f\u52a8\u4e4b\u524d\u6240\u9700\u51c6\u5907\u7684\u6240\u6709\u4e8b\u60c5\uff0c\u5305\u62ec\u542f\u52a8\u65f6\u7684\u6b22\u8fce\u753b\u9762 --rcX.d\uff1a\u5728rc.sysinit\u6587\u4ef6\u4e4b\u540e\u6240\u8981\u6267\u884c\u7684\uff0cX\u662f\u7cfb\u7edf\u542f\u52a8\u65f6\u7684initdefault\u503c\uff0c\u503c\u4e3a\u51e0\u5219\u4f1a\u8f6c\u5230\u90a3\u4e2a\u76ee\u5f55\u4e0b\uff0c\u5e76\u6267\u884c\u5176\u4e2d\u7684 \u6240\u6709\u6587\u4ef6\uff0c\u5728\u6b64\u76ee\u5f55\u4e2d\uff0c\u6587\u4ef6\u4e00\u5f8b\u90fd\u7531\u4e24\u4e2a\u82f1\u6587\u5b57\u6bcd\u5f00\u59cbK\u548cS\uff0cK\u4ee3\u8868kill\uff0cS\u4ee3\u8868Start --rc.local\uff1a\u7cfb\u7edf\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u6700\u540e\u4e00\u4e2a\u6267\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u5f00\u673a\u542f\u52a8\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u653e\u7f6e\u5728\u8fd9\u4e2a\u811a\u672c\u6587\u4ef6\u4e2d\uff0c\u4ee5\u5b9e\u73b0\u81ea\u52a8 \u8fd0\u884c\u7684\u76ee\u7684 readahead.d\uff1a\u662freadahead\u7a0b\u5e8f\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3a\u4e86\u52a0\u901f\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f7f\u7528\u901f\u5ea6\uff0creadahead_early\u548creadahead_later\u8fd9\u4e24\u4e2a\u8fdb\u7a0b\u5728 \u7cfb\u7edf\u52a0\u8f7d\u65f6\uff0c\u76f4\u63a5\u5c06\u65e5\u5e38\u6240\u9700\u8981\u7684\u4e00\u4e9b\u6587\u4ef6\uff0c\u5168\u90e8\u5148\u653e\u5230\u786c\u76d8\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d redhat-lsb\uff1a\u90fdlsb-release.d\u76ee\u5f55\u90fd\u662f\u7531\u7a0b\u5e8fredhat-lsb\u6240\u63d0\u4f9b\u7684 rwtab.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u4e00\u4e2a\u5728\u542f\u52a8\u65f6\u4f1a\u53bb\u53c2\u8003\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u7684\u6587\u4ef6\u5728/etc/rwtab\uff1b\u8fd9\u662f\u4e00\u4e2a\u7cfb\u7edf\u521d\u671f\u7684\u5907\u4efd\u673a\u5236 sane.d\uff1a\u8fd9\u662f\u5728\u7cfb\u7edf\u4e0b\u8981\u4f7f\u7528\u626b\u63cf\u4eea\u6240\u9700\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662fsane.conf\uff0csane\u4e3a\u4e86\u65b9\u4fbf\u7528\u6237\u5728\u5404\u5f0f\u7684\u626b\u63cf\u4eea\u8fde\u63a5\u65f6\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c \u56e0\u6b64\u5728\u8fd9\u4e00\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e86\u5f88\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u626b\u63cf\u4eea\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u8ba9\u7cfb\u7edf\u5728\u68c0\u6d4b\u5230\u626b\u63cf\u4eea\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 setuptool.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\"setup\"\u7cfb\u7edf\u914d\u7f6e\u5de5\u5177\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55 skel\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u7528\u6237\u5bbf\u4e3b\u76ee\u5f55\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5f53\u5efa\u7acb\u4e00\u4e2a\u7528\u6237\u65f6\uff0c\u4f1a\u628a\u6b64\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u590d\u5236\u4e00\u4efd\u5230\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55\uff0c\u4f5c\u4e3a\u7528\u6237\u7684\u521d\u59cb\u5316\u914d\u7f6e sysconfig\uff1a\u975e\u5e38\u91cd\u8981\u7684\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u7684\u5b58\u653e\u76ee\u5f55\uff0c\u91cc\u9762\u653e\u7f6e\u4e86\u5927\u91cf\u7cfb\u7edf\u542f\u52a8\u53ca\u8fd0\u884c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6 sysconfig/network-scripts/ifcfg-eth0\uff1a\u7f51\u5361eth0\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8bbe\u7f6e\u5185\u5bb9\u5305\u62ec\u8bbe\u5907\u540d\u79f0\u3001IP\u5730\u5740\u3001\u5e7f\u64ad\u5730\u5740\u3001\u7f51\u5173\u5730\u5740\u3001\u7f51\u6bb5\u3001 \u5f00\u673a\u662f\u5426\u6fc0\u6d3b\u7b49\u53c2\u6570 udev\uff1audev\u7a0b\u5e8f\u672c\u8eab\u662f\u4e00\u5957\u8bbe\u5907\u7684\u7ba1\u7406\u673a\u5236\uff0cudev\u901a\u8fc7sysfs\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u6b63\u786e\u5730\u638c\u63e1\u76ee\u524d\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u786c\u4ef6\u8bbe\u5907\uff0c\u4ee5\u53ca\u9488\u5bf9\u6bcf\u4e00\u4e2a\u786c\u4ef6 \u8bbe\u5907\u505a\u51fa\u4e0d\u540c\u7684\u5224\u65ad\u4e0e\u6267\u884c yum\u548cyum.repos.d\uff1a\u4e24\u4e2a\u90fd\u662fyum\u914d\u7f6e\u76ee\u5f55\uff0c\u53ef\u7528\u6765\u66ff\u4ee3rpm\u5305\u7ba1\u7406\u65b9\u5f0f\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/yum.conf\uff1byum\u662f\u66f4\u65b0\u65b9\u5f0f\u53ca\u5916\u6302\u7a0b\u5e8f\u7684 \u914d\u7f6e\u76ee\u5f55\uff0cyum.repos.d\u662f\u5b58\u653e\u5b9a\u671f\u66f4\u65b0\u7ec4\u4ef6\u5185\u5bb9\u7684\u4fe1\u606f \u5b89\u5168\u6027\u76ee\u5f55\uff1a\u5982selinux\u6216pam.d\u7b49\u7ba1\u7406\u7cfb\u7edf\u5b89\u5168\u6027\u7684\u76ee\u5f55 audit\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u4ee3\u8868\u7684\u662f\u4e00\u79cd\u548c\u76ee\u5f55\u540d\u79f0\u4e00\u81f4\u7684audit\u5b89\u5168\u673a\u5236\uff0c\u4e3b\u8981\u4ee5\u670d\u52a1\u7684\u65b9\u5f0f\u534f\u52a9\u7ba1\u7406\u5458\u6301\u7eed\u76d1\u63a7\u5404\u6587\u4ef6\u88ab\u5b58\u53d6\u7684\u60c5\u51b5\uff1b\u76ee\u5f55\u4e0b\u7684 audit.rules\u6587\u4ef6\u4e3b\u8981\u662f\u5b9a\u4e49\u4e00\u4e9b\u5fc5\u8981\u7684\u76d1\u63a7\u89c4\u5219 pam.d\uff1a\u6b64\u76ee\u5f55\u662fLinux-PAM\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u5408/lib/security\u76ee\u5f55\u4e2d\u6240\u6709\u89c9\u5f97\u51fd\u6570\u5e93\uff0c\u63d0\u4f9bLinux\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u8ba4\u8bc1\u7684\u673a\u5236 pam_pkcs11\uff1aPAM\u673a\u5236\u4e2d\u7684\u4e00\u79cd\u767b\u5f55\u6a21\u5757\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u901a\u8fc7smart card\u505a\u767b\u5f55\u7684\u64cd\u4f5c pki\uff1aPKI\u662f\u4e00\u79cd\u516c\u5f00\u5bc6\u94a5\u7684\u7ba1\u7406\u65b9\u5f0f\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u7ba1\u7406\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8ba9\u6240\u6709\u7f51\u7edc\u4f20\u8f93\u6709\u66f4\u591a\u4fdd\u969c racoon\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531ipsec-tools\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0cipsec\u7684\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u5b9e\u73b0VPN\u7684\u7f51\u8def\u6280\u672f\uff0c\u5728racoon\u76ee\u5f55\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6 racoon.conf\u4e2d\uff0c\u5b9a\u4e49\u5728ipsec\u64cd\u4f5c\u4e2d\u6240\u9700\u8981\u7684\u52a0\u5bc6\u7b97\u6cd5\u79cd\u7c7b\u4ee5\u53ca\u5176\u4ed6\u7ec6\u8282\u7684\u914d\u7f6e security\uff1a\u4e0epam.d\u76ee\u5f55\u76f8\u8f85\u76f8\u6210\uff0cpam.d\u4e2d\u7684\u6240\u6709PAM\u7684\u89c4\u5219\u90fd\u8981\u7528\u5230/lib/security\u4e0b\u7684PAM\u51fd\u6570\u5e93\uff0c\u800c/etc/security\u76ee\u5f55\u4e2d\uff0c\u5c31\u662f \u9488\u5bf9\u8fd9\u4e9b\u51fd\u6570\u5e93\uff0c\u63d0\u4f9b\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec6\u8282\u914d\u7f6e\uff0c\u5bf9\u5e0c\u671b\u8c03\u6574\u7cfb\u7edf\u5b89\u5168\u6027\u90e8\u5206\u589e\u52a0\u4e86\u975e\u5e38\u5927\u7684\u65b9\u4fbf\u6027 selinux\uff1aselinux\u662f\u4e00\u4e2a\u5f88\u65b0\u7684\u5b89\u5168\u6027\u65b9\u6848\uff0c\u5b83\u662f\u4e00\u79cd\u9488\u5bf9\u5404\u79cd\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u8bbe\u5907\u6216daemon\u7b49\u5728linux\u6240\u9700\u4f7f\u7528\u5230\u7684\u5b89\u5168\u6027\u673a\u5236\uff0c\u800c\u4e14\u5176 \u5b89\u5168\u6027\u7684\u6570\u636e\u65f6\u76f4\u63a5\u8bb0\u5f55\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d wpa_supplicant\uff1a\u8fd9\u4e2a\u76ee\u5f55\u88ab\u5f52\u7c7b\u5230\u5b89\u5168\u6027\u76ee\u5f55\u4e2d\uff0c\u662f\u56e0\u4e3a\u5176\u5c5e\u4e8e\u65e0\u7ebf\u4e2d\u5b89\u5168\u8ba4\u8bc1\u7684\u90e8\u5206\uff0c\u5b58\u5728wpa_supplicant.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u6237 \u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u52a0\u5165\u5df2\u77e5\u53ef\u767b\u9646\u7684AP X Windows\u76ee\u5f55\uff1a\u5982X11\u6216gdm\u7ba1\u7406X windows\u542f\u52a8\u6216\u4f7f\u7528\u4e0a\u7684\u914d\u7f6e\u76ee\u5f55 alternatives\uff1alinux\u4e0b\u53ef\u8fa8\u8bc6\u6269\u5c55\u540d\u7684\"\u6587\u4ef6\u7c7b\u578b\"\u9009\u9879\uff0c\u53ef\u4ee5\u9488\u5bf9\u540c\u4e00\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u9009\u51fa\u4e00\u4e2a\u9ed8\u8ba4\u7528\u6237\u6240\u8981\u4f7f\u7528\u7684\u7a0b\u5e8f\u53bb\u6267\u884c\uff1b /etc/alternatives\u76ee\u5f55\u4e0b\u6709\u6240\u6709\u76ee\u524d\u5df2\u7ecf\u5b9a\u4e49\u7684\u7a0b\u5e8f\u540d\u79f0\uff0c\u90fd\u4ee5\u8f6f\u94fe\u63a5\u7684\u65b9\u5f0f\u5b58\u5728\uff0c\u91cc\u9762\u6bcf\u4e00\u4e2a\u6587\u4ef6\u5176\u5b9e\u90fd\u6709\u5b9a\u4e49\u597d\u7684 \u9ed8\u8ba4\u6267\u884c\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528alternatives\u547d\u4ee4\u67e5\u770b\u53ca\u4fee\u6539\u914d\u7f6e fonts\uff1a\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662ffontconfig\u8f6f\u4ef6\u7684\u6700\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e2d/etc/fonts/fonts.conf\u5c31\u662f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c/etc/fonts\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e \u90fd\u662f\u4ee5XML\u7684\u65b9\u5f0f\u914d\u7f6e\u7684 gconf\uff1a\u8fd9\u4e00\u76ee\u5f55\u662fGConf2\u7684\u7ec4\u4ef6\u6240\u5efa\u7acb\u7684\uff0cGConf\u7684\u4f5c\u7528\u5c31\u662f\u63d0\u4f9bGNOME\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u6ce8\u518c\u7684\u673a\u5236\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8ewindows\u4e0b\u7684regedit gdm\uff1a\u5168\u540d\u4e3aGNOME Display Manger\uff0c\u4e5f\u5c31\u662f\u534f\u52a9X Windows\u542f\u52a8\u7684\u7ba1\u7406\u8f6f\u4ef6\uff0c\u5728GDM\u4e2d\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fcustom.conf\uff0c\u5728X windows\u4e0b \u53ef\u4ee5\u5229\u7528gdmsetup\u547d\u4ee4\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e gnome-vfs-2.0\uff1aGNOME VFS\u673a\u5236\uff0c\u8ba9GNOME\u7684\u7cfb\u7edf\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e00\u79cd\u6587\u4ef6\u683c\u5f0f\u8981\u5982\u4f55\u5f00\u542f\u6216\u6d4f\u89c8\uff0c\u800c\u6240\u6709\u7684\u914d\u7f6e\u90fd\u9700\u8981\u6709\u76f8\u5bf9\u5e94\u7684\u51fd\u6570\u5e93 gtk-2.0\uff1a\u7531gtk+\u7ec4\u4ef6\u63d0\u4f9b\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u662f\u63d0\u4f9bX Windows\u7a97\u53e3\u7684\u989c\u8272\u3001\u6309\u94ae\u6216\u56fe\u6848\uff0c\u5305\u542b\u8f6f\u4ef6\u9009\u9879\u7684\u753b\u9762\u3001\u9009\u9879\u7684\u6309\u94ae\u3001\u6eda\u52a8\u8f74\u7684\u6837\u5f0f\u7b49 kde\uff1aKDE Desktop Manager\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff1b\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fkdmrc NetworkManager\uff1a\u6b64\u76ee\u5f55\u7684\u76ee\u7684\u662f\u8ba9\u7528\u6237\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u64cd\u4f5c\u548c\u914d\u7f6e\uff0c\u53ea\u8981\u7528\u6237\u66fe\u7ecf\u767b\u9646\u8fc7\u65e0\u7ebfAP\uff0c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u540e\u518d\u6b21\u767b\u9646\u65f6\u5c31 \u53ef\u4ee5\u65b9\u4fbf\u7684\u767b\u9646 pango\uff1apango\u662f\u4e00\u5957\u534f\u52a9GTK+\u5c06\u5b57\u4f53\u63cf\u7ed8\u51fa\u6765\u7684\u51fd\u6570\u5e93\uff0c\u4e0d\u8bba\u4efb\u4f55\u7684\u5b57\u4f53\u6216\u8bed\u8a00\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7pango\u63cf\u7ed8\u51fa\u6765 rhgb\uff1a\u7cfb\u7edf\u5728\u8fdb\u5165X Windows\u4e4b\u524d\uff0c\u6709\u4e00\u4e2a\u524d\u7f6e\u914d\u7f6e\u7684\u56fe\u5f62\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5c31\u662frhgb\uff0c\u5176\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u542f\u52a8\u53d8\u5f97\u6f02\u4eae scim\uff1a\u662fLinux\u4e0b\u76ee\u524d\u5f88\u597d\u7528\u7684\u8f93\u5165\u6cd5 sound\uff1aGNOME\u4e0b\u6709\u8bb8\u591a\u7684\u5e94\u7528\u8f6f\u4ef6\uff0c\u5f88\u591a\u90fd\u4f1a\u6709\u5176\u7279\u6b8a\u7684\u58f0\u97f3\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u5b58\u653e\u6240\u6709\u58f0\u97f3\u7684\u547d\u4ee4\u8def\u5f84 X11\uff1aX windows\u7684\u6838\u5fc3\u914d\u7f6e\u76ee\u5f55\uff1b\u8be5\u76ee\u5f55\u4e0b\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u4ef6\u6709prefdm(\u5224\u65adX windows\u4f7f\u7528\u54ea\u4e00\u4e2aDisplay Manager)\u3001\u4e3b\u914d\u7f6e\u6587\u4ef6 xorg.conf(\u5b9a\u4e86X windows\u6240\u9700\u4f7f\u7528\u7684\u952e\u76d8\u3001\u9f20\u6807\u3001\u663e\u5361\u7b49\u76f8\u5173\u786c\u4ef6\u8bbe\u5907\uff0c\u91cd\u70b9\u662f\u5173\u4e8e\u663e\u5361\u7684\u914d\u7f6e)\u3001xinit\u5b50\u76ee\u5f55 (\u91cc\u9762\u90fd\u662f\u4e00\u4e9bX windows\u8d44\u6e90\u76f8\u5173\u7684\u914d\u7f6e) xdg\uff1aX windows\u4e0a\u7684\u83dc\u5355\u753b\u9762\uff0c\u5c31\u662f\u4ece\u8fd9\u91cc\u51fa\u6765\u7684\uff0c\u6240\u6709\u5728X windows\u4e2d\u4f7f\u7528\u7684\u83dc\u5355\u6587\u5b57\u53ca\u5206\u7c7b\uff0c\u90fd\u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u505a\u914d\u7f6e\uff0c\u5176\u4e0b\u7684\u5b50\u76ee\u5f55 menu\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u91cc\u9762\u7684\u6587\u4ef6\u81ea\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ba1\u7406\u3001\u5916\u89c2\u7b49\u83dc\u5355\u5185\u5bb9 \u5176\u4ed6\u76ee\u5f55\uff1a\u9488\u5bf9\u5355\u4e00\u7279\u6b8a\u8f6f\u4ef6\u7684\u914d\u7f6e\u6216\u672a\u80fd\u6309\u4ee5\u4e0a\u5206\u7c7b\u65b9\u5f0f\u5219\u653e\u5728\u6b64\u76ee\u5f55\u4e2d a2ps.cfg\u548ca2ps-site.cfg\uff1a\u7528\u4e8e\u5c06\u4e00\u4efd\u6587\u4ef6\u683c\u5f0f\u8f6c\u6362\u4e3apostscript\u7684\u683c\u5f0f\uff0c\u5728\u67d0\u4e9b\u6253\u5370\u673a\u6216\u5c06\u6587\u4ef6\u8f93\u51fa\u6210\u4e00\u4efd\u6807\u51c6\u683c\u5f0f\u6587\u4ef6\u65f6\uff0c\u4f1a\u88ab\u7528\u5230 alsa\uff1a\u4e3b\u8981\u4efb\u52a1\u5728\u4e8e\u63d0\u4f9blinux\u58f0\u97f3\u53ca\u58f0\u97f3\u7684\u529f\u80fd\uff0c\u5e76\u8bd5\u7740\u8ba9\u5176\u6027\u80fd\u8fbe\u5230\u6700\u4f73\u5316 ghostscript\uff1alinux\u4e0b\u8bfb\u53d6Adobe\u683c\u5f0f\u6587\u4ef6(\u5982pdf)\uff0c\u5c31\u662f\u4f7f\u7528ghostscript\u547d\u4ee4\uff0c\u6b64\u76ee\u5f55\u4e3b\u8981\u7528\u4e8e\u8bbe\u7f6e\u5728\u663e\u793a\u65f6\u4f7f\u7528\u54ea\u79cd\u5b57\u4f53\u4f5c\u4e3a\u9ed8\u8ba4\u5b57\u4f53 gre.d\uff1aGRE\u662fMozilla\u6ce8\u518c\u7684\u4e00\u79cd\u673a\u5236\uff0c\u76ee\u5f55\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6gre.conf\u4f1a\u6ce8\u660e\u6240\u4f7f\u7528\u7684Mozilla\u8f6f\u4ef6\u7684\u8def\u5f84\u548c\u7248\u672c iproute2\uff1aiproute2\u662f\u4e00\u5957\u975e\u5e38\u5f3a\u5927\u7684\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\uff0ciproute2\u63d0\u4f9b\u7684\u529f\u80fd\u6709\u5f88\u591a\u79cd\uff0c\u6b64\u76ee\u5f55\u4e2d\u5b58\u653e\u4e00\u4e9b\u7f51\u7edc\u7684\u57fa\u672c\u914d\u7f6e\u503c java\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531jpackage-utils\u8f6f\u4ef6\u63d0\u4f9b\u7684\uff0c\u8fd9\u4e2a\u76ee\u5f55\u662f\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u6709maven\u3001jvm\u3001jvm-common\u90fd\u662f\u7531 jpackage-utils\u8f6f\u4ef6\u4ea7\u751f\u7684\uff0cjpackage\u662f\u4e00\u4e2a\u4e13\u95e8\u4e3a\u4e86\u63d0\u4f9bjava\u7a0b\u5e8f\u4e0e\u51fd\u6570\u5e93\u6240\u5b58\u5728\u7684\u8f6f\u4ef6 mgetty+sendfax\uff1a\u4e3b\u8981\u7528\u4e8e\u4f7f\u7528linux\u67b6\u6784\u4e00\u53f0fax server\uff0c\u53ef\u4ee5\u4f7f\u7528mgetty.config\u6765\u914d\u7f6e\u9700\u8981\u6709\u5173\u4f20\u771f\u63a5\u6536\u548c\u53d1\u9001\u7684\u64cd\u4f5c php.d\uff1a\u4e3b\u8981\u5b58\u653e\u7684\u5404\u8f6f\u4ef6(\u5982dbase\u3001ldap\u3001mysql\u7b49)\u4e0ephp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6 reader.conf.d\uff1a\u5b58\u653esmart card\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u7531\u7a0b\u5e8fpcsc-lite\u63d0\u4f9b\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/reader.conf dumpdates\uff1a\u5b58\u653edump\u547d\u4ee4\u7684\u6267\u884c\u65e5\u671f\uff0cdump\u547d\u4ee4\u53ef\u4ee5\u5bf9ext2/ext3\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u68c0\u67e5\u5907\u4efd /home \u9ed8\u8ba4\u5b58\u653e\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55(\u9664\u4e86root\u7528\u6237) /home/~/.bashrc\uff1a\u63d0\u4f9bbash\u73af\u5883\u4e2d\u6240\u9700\u4f7f\u7528\u7684\u522b\u540d /home/~/.bash_profile\uff1a\u63d0\u4f9bbash\u73af\u5883\u6240\u9700\u7684\u53d8\u91cf\uff1b\u4e00\u822c\u5148\u6267.bashrc\u540e\uff0c\u624d\u4f1a\u518d\u6267\u884c.bash_profile /home/~/.bash_history\uff1a\u7528\u6237\u5386\u53f2\u547d\u4ee4\u6587\u4ef6\uff0c\u8bb0\u5f55\u7528\u6237\u66fe\u7ecf\u8f93\u5165\u7684\u6240\u6709\u547d\u4ee4\uff1b(\u9ed8\u8ba4\u4e3a1000\u6761\uff0c\u53ef\u4ee5\u901a\u8fc7HISTSIZE\u53d8\u91cf\u66f4\u6539) /home/~/.bash_logout\uff1a\u5f53\u7528\u6237\u6ce8\u9500\u7684\u540c\u65f6\uff0c\u7cfb\u7edf\u81ea\u52a8\u751f\u6210.bash_logout\u6587\u4ef6\uff0c\u5982\u9700\u8981\u8bb0\u5f55\u7528\u6237\u6ce8\u9500\u7684\u5176\u4ed6\u4fe1\u606f\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u673a\u5236\u53bb\u5b8c\u6210 /root \u7ba1\u7406\u5458root\u7684\u5bbf\u4e3b\u76ee\u5f55 /lib \u9700\u8981\u5171\u4eab\u7684\u51fd\u6570\u5e93\u4e0ekernel\u6a21\u5757\uff0c\u7cfb\u7edfkernel\u542f\u52a8\u6240\u4f7f\u7528\u7684\u51fd\u6570\u5e93\uff0c\u6216\u8005\u5f53\u6267\u884c\u4e00\u4e9b\u5728/bin\u548c/sbin\u4e2d\u7684\u547d\u4ee4\u65f6\u4f7f\u7528\u7684\u51fd\u6570\u5e93 /mnt \u6302\u8f7d\u70b9\u76ee\u5f55\uff1b\u4e00\u822c\u7684\u81ea\u52a8\u6302\u5728/media\u76ee\u5f55(\u5982\u78c1\u76d8\u5206\u533a\uff0c\u7f51\u7edc\u5171\u4eab) /media \u79fb\u52a8\u5b58\u50a8\u8bbe\u5907\u9ed8\u8ba4\u6302\u8f7d\u70b9\uff1b(\u5982\u5149\u76d8) /opt \u5e38\u7528\u4e8e\u653e\u7f6e\u5927\u578b\u7684\u5e94\u7528\u8f6f\u4ef6\uff1b\u6570\u636e\u5e93\u6587\u4ef6 /proc \u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4fdd\u5b58\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5185\u5b58\u4fe1\u606f\uff0cCPU\u4fe1\u606f\uff0c\u865a\u62df\u5185\u5b58\u4fe1\u606f\uff0c\u7535\u6e90\u4fe1\u606f\uff1bcpuinfo ,meminfo ,acpi,scsi, vmstat,uptime;\u6bcf\u6b21\u542f\u52a8\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u65b0\u7684/porc\u6587\u4ef6\uff0c\u6765\u8bb0\u5f55\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5e76\u4e0d\u662f\u5b58\u653e\u5728\u786c\u76d8\u4e0a\uff0c\u800c\u662f\u5185\u5b58\u955c\u50cf\u4e2d\u7684\uff1b \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u6b64\u76ee\u5f55\u662fkernel\u52a0\u8f7d\u540e\uff0c\u5728\u5185\u5b58\u91cc\u9762\u5efa\u7acb\u7684\u4e00\u4e2a\u865a\u62df\u76ee\u5f55\uff0c\u6709\u4e13\u5c5e\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u63d0\u4f9b\u7cfb\u7edf\u4e00\u4e9b\u5b9e\u65f6\u7684\u4fe1\u606f\uff0c\u6b64\u76ee\u5f55\u4e0b\u4e0d\u80fd \u5efa\u7acb\u548c\u5220\u9664\u6587\u4ef6\uff1b(\u67d0\u4e9b\u6587\u4ef6\u53ef\u4ee5\u4fee\u6539) /proc\u4e3b\u8981\u4f5c\u7528\u53ef\u4ee5\u6574\u7406\u4e3a\uff1a \u6574\u7406\u7cfb\u7edf\u5185\u90e8\u7684\u4fe1\u606f \u5b58\u653e\u4e3b\u673a\u786c\u4ef6\u4fe1\u606f \u8c03\u6574\u7cfb\u7edf\u6267\u884c\u65f6\u7684\u53c2\u6570 \u68c0\u67e5\u53ca\u4fee\u6539\u7f51\u7edc\u548c\u4e3b\u673a\u7684\u53c2\u6570 \u68c0\u67e5\u53ca\u8c03\u6574\u7cfb\u7edf\u7684\u5185\u5b58\u548c\u6027\u80fd /proc\u4e0b\u5e38\u7528\u7684\u4fe1\u606f\u6587\u4ef6\u6709\uff1a /proc/cpuinfo\uff1acpu\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u5982\u7c7b\u578b\u3001\u5382\u5bb6\u3001\u578b\u53f7\u548c\u6027\u80fd\u7b49 /proc/devices\uff1a\u8bb0\u5f55\u6240\u6709\u5728/dev\u76ee\u5f55\u4e2d\u76f8\u5173\u7684\u8bbe\u5907\u6587\u4ef6\u5206\u7c7b\u65b9\u5f0f /proc/filesystems\uff1a\u5f53\u524d\u8fd0\u884c\u5185\u6838\u6240\u914d\u7f6e\u7684\u6587\u4ef6\u7cfb\u7edf /proc/interrupts\uff1a\u53ef\u4ee5\u67e5\u770b\u6bcf\u4e00\u4e2aIRQ\u7684\u7f16\u53f7\u5bf9\u5e94\u5230\u54ea\u4e00\u4e2a\u786c\u4ef6\u5907 /proc/loadavg\uff1a\u7cfb\u7edf\"\u5e73\u5747\u8d1f\u8f7d\"\uff0c3\u4e2a\u6570\u636e\u6307\u51fa\u7cfb\u7edf\u5f53\u524d\u7684\u5de5\u4f5c\u8d1f\u8f7d /proc/dma\uff1a\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684DMA\u901a\u9053 /proc/ioports\uff1a\u5c06\u76ee\u524d\u7cfb\u7edf\u4e0a\u6240\u6709\u53ef\u770b\u5230\u7684\u786c\u4ef6\u5bf9\u5e94\u5230\u5185\u5b58\u4f4d\u7f6e\u7684\u914d\u8868\u7684\u8be6\u7ec6\u4fe1\u606f\u5448\u73b0\u51fa\u6765 /proc/kcore\uff1a\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u68c0\u6d4b\u5230\u7684\u7269\u7406\u5185\u5b58\uff0c\u4e3b\u673a\u5185\u5b58\u591a\u5927\uff0c\u8fd9\u4e2a\u4ef6\u5c31\u6709\u591a\u5927 /proc/kmsg\uff1a\u5728\u7cfb\u7edf\u5c1a\u672a\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\u9636\u6bb5\uff0c\u628a\u52a0\u8f7dkernel\u548cinitr\u7684\u4fe1\u606f\u5148\u8bb0\u5f55\u5230\u8be5\u6587\u4ef6\u4e2d\uff0c\u540e\u7eed\u4f1a\u5c06\u65e5\u5fd7\u4fe1\u606f\u5199\u5165/var/log/messag\u6587\u4ef6\u4e2d /proc/meminfo\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u5185\u5b58\u4fe1\u606f /proc/modules\uff1a\u4e0elsmod\u547d\u4ee4\u67e5\u770b\u5230\u7684\u6a21\u5757\u4fe1\u606f\u5b8c\u5168\u4e00\u81f4 /proc/mtrr\uff1a\u8d1f\u8d23\u5185\u5b58\u914d\u7f6e\u7684\u673a\u5236 /proc/iomem\uff1a\u4e3b\u8981\u7528\u4e8e\u50a8\u5b58\u914d\u7f6e\u540e\u6240\u6709\u5185\u5b58\u50a8\u5b58\u7684\u660e\u7ec6\u4fe1\u606f /proc/partitions\uff1a\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u5b9e\u65f6\u5448\u73b0\u7cfb\u7edf\u76ee\u524d\u770b\u5230\u7684\u5206\u533a /proc/\u6570\u5b57\u76ee\u5f55\uff1a\u6570\u5b57\u76ee\u5f55\u5f88\u591a\uff0c\u5b83\u4eec\u4ee3\u8868\u6240\u6709\u76ee\u524d\u6b63\u5728\u7cfb\u7edf\u4e2d\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f /proc/bus\uff1a\u6709\u5173\u8be5\u4e3b\u673a\u4e0a\u73b0\u6709\u603b\u7ebf\u7684\u6240\u6709\u4fe1\u606f\uff0c\u5982\u8f93\u5165\u8bbe\u5907\u3001PCI\u53e3\u3001PCMCIA\u6269\u5c55\u5361\u53caUSB\u63a5\u53e3\u4fe1\u606f /proc/net\u76ee\u5f55\uff1a\u5b58\u653e\u7684\u90fd\u662f\u4e00\u4e9b\u7f51\u7edc\u76f8\u5173\u7684\u865a\u62df\u914d\u7f6e\u6587\u4ef6\uff0c\u90fdASCII\u6587\u4ef6\uff0c\u53ef\u4ee5\u67e5\u770b(\u4e0eifconfig\u3001arp\u3001netstat\u7b49\u6709\u5173) /proc/scsi\uff1a\u4fdd\u5b58\u7cfb\u7edf\u4e0a\u6240\u6709\u7684scsi\u8bbe\u5907\u4fe1\u606f(\u5305\u62ecsata\u548cusb\u8bbe\u5907\u4fe1\u606f) /proc/sys\u76ee\u5f55\uff1a\u5b58\u653e\u7cfb\u7edf\u6838\u5fc3\u6240\u4f7f\u7528\u7684\u4e00\u4e9b\u53d8\u91cf\uff0c\u6839\u636e\u4e0d\u540c\u6027\u8d28\u7684\u4ef6\u800c\u5b58\u653e\u5728\u4e0d\u540c\u7684\u5b50\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7/etc/sysctl.conf\u6587\u4ef6\u8bbe\u7f6e\u66f4\u6539\u5176\u9ed8\u8ba4\u503c\uff1b \u53d8\u91cf\u65f6\u5b9e\u65f6\u7684\u53d8\u66f4\uff0c\u6709\u5f88\u591a\u8bbe\u7f6e\u5f88\u8c61\u662f\u5f00\u5173\uff0c\u8bbe\u7f6e\u540e\u4e0a\u751f\u6548 /proc/tty\uff1a\u5b58\u653e\u6709\u5173\u76ee\u524d\u53ef\u7528\u7684\u6b63\u5728\u4f7f\u7528\u7684tty\u8bbe\u5907\u7684\u4fe1\u606f /proc/self\uff1a\u5b58\u653e\u5230\u67e5\u770b/proc\u7684\u7a0b\u5e8f\u7684\u8fdb\u7a0b\u76ee\u5f55\u7684\u7b26\u53f7\u8fde\u63a5\uff0c\u5f532\u8fdb\u7a0b\u67e5\u770bproc\u65f6\uff0c\u8fd9\u5c06\u4f1a\u662f\u4e0d\u540c\u7684\u8fde\u63a5\uff1b\u4e3b\u8981\u4fbf\u4e8e\u7a0b\u5e8f\u5f97\u5230\u5b83\u81ea\u5df1\u7684\u7a0b\u76ee\u5f55 /proc/stat\uff1a\u7cfb\u7edf\u7684\u4e0d\u540c\u72b6\u6001\u4fe1\u606f /proc/uptime\uff1a\u7cfb\u7edf\u542f\u52a8\u7684\u65f6\u95f4\u957f\u5ea6 /proc/version\uff1a\u7cfb\u7edf\u6838\u5fc3\u7248\u672c /sbin \u5b58\u653e\u7279\u6743\u7ea7\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u7279\u6743\u7ea7\u53ef\u6267\u884c\u547d\u4ee4\uff09\u53ea\u6709root\u7528\u6237\u53ef\u4ee5\u6267\u884c\uff1b\u8f83\u5371\u9669\u7684\u547d\u4ee4\u4fdd\u5b58\u5176\u4e2d\uff1b(\u591a\u6570\u7ba1\u7406\u547d\u4ee4\u9ed8\u8ba4\u53ea\u6709\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528) /usr\uff1a\u5b89\u88c5\u9664\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u5916\u7684\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u6216\u7ec4\u4ef6\uff0c\u4e00\u822c\u53ef\u4ee5\u8ba4\u4e3alinux\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u9ed8\u8ba4\u90fd\u5b89\u88c5\u5728\u6b64\u76ee\u5f55\u4e2d /usr/bin\uff1a\u4e00\u822c\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u5230\u7684\u7a0b\u5e8f\uff0c\u6216\u8005\u8be5\u8f6f\u4ef6\u9ed8\u8ba4\u5c31\u662f\u8981\u6240\u6709\u7528\u6237\u4f7f\u7528\u624d\u4f1a\u653e\u5728\u8be5\u76ee\u5f55\u4e2d /usr/sbin\uff1a\u4e00\u4e9b\u7cfb\u7edf\u6709\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u4e0e/sbin\u6bd4\u8d77\u6765\uff0c\u662f\u4e00\u4e9b\u8f83\u6b21\u8981\u7684\u6587\u4ef6 /usr/etc\uff1a\u81ea\u884c\u5b89\u88c5\u6216\u975e\u7cfb\u7edf\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 /usr/games\uff1a\u53ea\u8981\u662f\u7535\u8111\u6e38\u620f\u76f8\u5173\u7684\u8f6f\u4ef6\uff0c\u5c31\u90fd\u5b89\u88c5\u5230\u8fd9\u4e2a\u76ee\u5f55 /usr/include\uff1a\u5b58\u653e\u7684\u6587\u4ef6\u90fd\u662f\u4e00\u4e9b\u7cfb\u7edf\u4e2d\u7528\u6237\u6240\u4f1a\u4f7f\u7528\u5230\u7684C\u8bedheader\u6587\u4ef6\uff0c\u4fdd\u5b58\u7684\u90fd\u662f\".h\"\u7684\u6587\u4ef6 /usr/kerberos\uff1akerberos\u662f\u4e00\u79cd\u5b89\u5168\u673a\u5236\uff0c\u8ba9\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6301kerberos\u673a\u5236\u7cfb\u7edf\u4e0a\u7684\u90e8\u5206\u8d44\u6e90 /usr/lib\uff1a\u5b58\u653e\u4e00\u4e9b\u51fd\u6570\u5e93\u3001\u6267\u884c\u6587\u4ef6\u53ca\u8fde\u63a5\u6587\u4ef6\uff0c\u7279\u522b\u7684\u662f\uff0c\u5b58\u5728\u8fd9\u91cc\u9762\u7684\u6587\u4ef6\u90fd\u662f\u4e0d\u5e0c\u671b\u76f4\u63a5\u88ab\u7528\u6237\u6216shell\u811a\u672c\u6240\u4f7f\u7528\u7684\u6587\u4ef6\uff0c/usr/lib\u4e2d\u6709 \u975e\u5e38\u591a\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e00\u4e2a\u8f6f\u4ef6\u90fd\u6709\u5176\u5404\u81ea\u6240\u9700\u7684\u51fd\u5e93 /usr/libexec\uff1a\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\u5e94\u8be5\u90fd\u53ef\u4ee5\u653e\u7f6e/usr/lib\u4e0b /usr/local\uff1alinux\u7cfb\u7edf\u4e2d\u5b89\u88c5\u7684\u5171\u4eab\u8f6f\u4ef6\u7a0b\u5e8f\u6700\u597d\u7684\u65b9\u5f0f\u662f\u5b89\u88c5/usr/local\u4e0b\uff0c\u6309\u7167linux\u6807\u51c6\u76ee\u5f55\u7ed3\u6784\uff0c\u65b0\u5efa\u7acb\u7684\u8f6f\u4ef6\u90fd\u5e94\u8be5\u653e/usr/local\u4e0b /usr/local/bin\uff1a\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55 /usr/local/sbin\uff1a\u540c\u6837\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f46\u6b64\u76ee\u5f55\u95e8\u9488\u5bf9\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u6587\u4ef6 /usr/local/lib\uff1a\u8f6f\u4ef6\u76f8\u5173\u7684\u51fd\u6570\u5e93 /usr/local/share\uff1a\u5f53\u6587\u4ef6\u6027\u8d28\u4e0d\u597d\u5f52\u5c5e\u65f6\u5c31\u4f1a\u653e\u5728\u6b64\uff0cman\u518c\u5c31\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b /usr/local/src\uff1a\u6240\u5b89\u88c5\u8f6f\u4ef6\u7684\u6e90\u4ee3\u7801\u653e\u7f6e\u5728\u6b64 /usr/share\uff1a\u6b64\u76ee\u5f55\u90fd\u662f\u4e00\u4e9b\u5171\u4eab\u4fe1\u606f\uff0c\u6700\u5e38\u88ab\u7528\u5230\u7684\u5c31/usr/share/man\u8fd9\u4e2a\u76ee\u5f55\uff0c/usr/share\u91cc\u7684\u4fe1\u606f\u65f6\u8de8\u5e73\u53f0\u7684 /usr/share/doc\uff1a\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u5e2e\u52a9\u6587\u4ef6\u7684\u5730\u65b9 /usr/share/man\uff1amanpage\u7684\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u4e5f\u662f\u4f7f\u7528man\u67e5\u770b\u624b\u518c\u65f6\u67e5\u8be2\u7684\u8def\u5f84 /usr/src\uff1a\u4e3b\u8981\u50a8\u5b58\u5185\u6838\u6e90\u4ee3\u7801\u7684\u6587\u4ef6 /usr/X11R6\uff1a\u5b58\u653e\u4e00\u4e9bX windows\u7cfb\u7edf\u7684\u76f8\u5173\u6587\u4ef6 /var \u52a8\u6001\u6587\u4ef6\u6216\u6570\u636e\u5b58\u653e\u76ee\u5f55\uff0c\u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u4e00\u822c\u5efa\u8bae\u628a\u6b64\u76ee\u5f55\u5355\u72ec\u5212\u5206\u4e00\u4e2a\u5206\u533a /var/account\uff1a\u662flinux\u7cfb\u7edf\u4e0b\u7684\u5ba1\u6838\u673a\u5236(psacct)\u5bf9\u5e94\u7684\u76ee\u5f55 /var/cache\uff1a\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u65f6\u6240\u6709\u7a0b\u5e8f\u6240\u4ea7\u751f\u7684\u7f13\u5b58\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u4f1a\u5c06\u6570\u636e\u7559\u4e00\u4efd\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d /var/empty\uff1a\u9ed8\u8ba4\u662fsshd\u7a0b\u5e8f\u7528\u5230\u7684\u8fd9\u4e2a\u76ee\u5f55\uff0c\u5f53\u5efa\u7acbssh\u8fde\u63a5\uff0cssh\u670d\u52a1\u5668\u5fc5\u987b\u4f7f\u7528\u8be5\u76ee\u5f55\u4e0b\u7684sshd\u5b50\u76ee\u5f55 /var/ftp\uff1aftp\u670d\u52a1\u5668\u8f6f\u4ef6\u4e00\u822c\u9ed8\u8ba4\u4f1a\u5c06\u533f\u540d\u767b\u9646\u7684\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55 /var/gdm\uff1agdm\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u5f53\u524d\u6240\u5360\u7528\u7684console\u8bb0\u5f55\u53ca\u901a\u8fc7gdm\u6267\u884c\u7684X windows\u8bb0\u5f55\uff0c\u53ea\u6709\u901a\u8fc7gdm\u7a97\u53e3\u7684\u65e5\u5fd7\u624d\u4f1a\u5b58\u653e\u5728\u6b64 /var/lib\uff1a\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u5f88\u591a\u4e0e\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0\u540c\u540d\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e2a\u5b50\u76ee\u5f55\u4e0b\u90fd\u662f\u5e94\u7528\u6267\u884c\u7684\u72b6\u6001\u4fe1\u606f /var/lock\uff1a\u6bcf\u4e2a\u670d\u52a1\u4e00\u5f00\u59cb\u90fd\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u4ea7\u751f\u4e00\u4e2a\u8be5\u670d\u52a1\u7684\u7a7a\u6587\u4ef6\uff0c\u4e3b\u8981\u662f\u907f\u514d\u670d\u52a1\u542f\u52a8\u51b2\u7a81 /var/log\uff1a\u5e38\u7528\u76ee\u5f55\uff0c\u4e13\u95e8\u7528\u6765\u5b58\u653e\u6240\u6709\u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u5f88\u591a\u7cfb\u7edf\u3001\u8f6f\u4ef6\u3001\u7528\u6237\u7b49\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f\uff1b\u91cc\u9762\u6709\u4e00\u4e9b\u6587\u4ef6\u662f\u6bd4\u8f83\u5e38\u7528\u7684 lastlog\uff1a\u8bb0\u5f55\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u7684\u4fe1\u606f\uff0c\u4f7f\u7528lastlog\u547d\u4ee4\u8bfb\u53d6 message\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u51e0\u4e4e\u6240\u6709\u4fe1\u606f\uff0c\u4e3b\u8981\u5305\u62ec\u542f\u52a8\u4fe1\u606f\uff0csyslogd\u670d\u52a1\u8bb0\u5f55\u7684\u4fe1\u606f\u7b49 wtmp\uff1a\u8bb0\u5f55\u6240\u6709\u7528\u6237\u767b\u9646\u53ca\u6ce8\u9500\u7684\u4fe1\u606f\uff0c\u4f7f\u7528last\u547d\u4ee4\u8bfb\u53d6 secure\uff1a\u8bb0\u5f55\u767b\u5f55\u7cfb\u7edf\u8bbf\u95ee\u6570\u636e\u7684\u6587\u4ef6\uff0c\u5982ssh pop3 telnet ftp\u7b49\u90fd\u4f1a\u8bb0\u5f55\u5728\u6b64\u6587\u4ef6\u4e2d /var/log/httpd/access_log\uff1ahttpd\u8bbf\u95ee\u65e5\u5fd7 /var/log/httpd/error_log\uff1ahttpd\u9519\u8bef\u65e5\u5fd7 btmp\uff1a\u8bb0\u5f55\u5931\u8d25\u7684\u7528\u6237\u767b\u5f55 utmp\uff1a \u7eaa\u5f55\u5f53\u524d\u767b\u5f55\u7684\u6bcf\u4e2a\u7528\u6237 xferlog\uff1aftp\u4f1a\u8bdd\u65e5\u5fd7 boot.log\uff1a\u8bb0\u5f55\u5f00\u673a\u6216\u4e00\u4e9b\u670d\u52a1\u542f\u52a8\u65f6\u6240\u663e\u793a\u7684\u542f\u52a8\u548c\u5173\u95ed\u4fe1\u606f /var/log/maillog\u6216/var/log/mail/*\uff1a\u8bb0\u5f55\u90ae\u4ef6\u8bbf\u95ee\u6216\u5f80\u6765\u7684\u7528\u6237\u4fe1\u606f cron\uff1a \u8bb0\u5f55crontab\u4f8b\u884c\u6027\u670d\u52a1\u7684\u5185\u5bb9 dmesg\uff1a\u5f00\u673a\u5f15\u5bfc\u65e5\u5fd7\u4fe1\u606f sudolog\uff1a\u7eaa\u5f55\u4f7f\u7528sudo\u53d1\u51fa\u7684\u547d\u4ee4 sulog\uff1a \u7eaa\u5f55\u4f7f\u7528su\u547d\u4ee4\u7684\u4f7f\u7528 /var/named\uff1abind\u8f6f\u4ef6\u5b9e\u73b0\u7684DNS\u670d\u52a1\u5668\u7684\u533a\u57df\u6570\u636e\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b /var/nis\u548c/var/yp\uff1a\u90fd\u662fNIS\u670d\u52a1\u673a\u5236\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0cnis\u4e3b\u8981\u8bb0\u5f55\u6240\u6709\u7f51\u7edc\u4e2d\u6bcf\u4e00\u4e2aclient\u7684\u8fde\u63a5\u4fe1\u606f\uff1byp\u662flinux\u7684nis\u670d\u52a1\u7684\u65e5\u5fd7\u6587\u4ef6\u5b58\u653e\u7684\u76ee\u5f55 /var/run\uff1a\u6b64\u76ee\u5f55\u4e2d\u7684\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u8bb0\u8f7d\u76ee\u524d\u7cfb\u7edf\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u7684PID\u503c\uff0c\u6bcf\u4e00\u4e2a\u6587\u4ef6\u90fd\u662f\u4ee5\u4e2a\u72ec\u7acb\u7684PID\u8bb0\u5f55\uff1b\u6b64\u76ee\u5f55\u4e0b\u5b58\u653e\u4e00\u4e2a\u7279\u6b8a\u6587\u4ef6utmp\uff0c\u6b64\u6587\u4ef6\u8bb0\u5f55\u76ee\u524d\u8c01\u5728\u4f7f\u7528\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528utmpdump\u547d\u4ee4\u624d\u80fd\u770b\u5230\u5176\u4e2d\u7684\u5185\u5bb9 /var/spool\uff1a\u91cc\u9762\u4e3b\u8981\u90fd\u662f\u4e00\u4e9b\u4e34\u65f6\u5b58\u653e\uff0c\u968f\u65f6\u4f1a\u88ab\u7528\u6237\u6240\u8c03\u7528\u7684\u6570\u636e\uff1b\u6253\u5370\u673a\u3001\u90ae\u4ef6\u3001\u4ee3\u7406\u670d\u52a1\u5668\u7b49\u5047\u8131\u673a\u76ee\u5f55\u5b58\u653e\u5728\u8be5\u76ee\u5f55\u4e0b /var/tmp\uff1a\u4e13\u95e8\u4e3a\u4e86\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5728\u5b89\u88c5\u6216\u6267\u884c\u65f6\uff0c\u9700\u8981\u5728\u91cd\u542f\u540e\u4f7f\u7528\u7684\u67d0\u4e9b\u6587\u4ef6\u65f6\uff0c\u80fd\u5c06\u8be5\u6587\u4ef6\u6682\u65f6\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\uff0c\u5b8c\u6210\u540e\u518d\u884c\u5220\u9664 /var/www\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u5bbf\u4e3b\u76ee\u5f55 /lost+found:\u5b58\u653e\u4e86\u4e00\u4e9b\u7cfb\u7edf\u51fa\u9519\u7684\u68c0\u67e5\u7ed3\u679c\uff1b\u5f02\u5e38\u65ad\u7535\u60c5\u51b5\u3001\u6b7b\u673a\uff1b\u9ed8\u8ba4\u76ee\u5f55\u662f\u7a7a\u7684,\u901a\u5e38\u4f7f\u7528fsck\u8fdb\u884c\u6587\u4ef6\u4fee\u590d\uff0c\u4fee\u590d\u540e\u6587\u4ef6\u5219\u88ab\u5b58\u653e\u4e8e\u6b64\u76ee\u5f55 /misc\uff1a\u81ea\u52a8\u6302\u8f7d\u670d\u52a1\u76ee\u5f55\uff0c\u5bf9\u5e94autofs\u670d\u52a1 /srv\uff1a\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u4e00\u4e9b\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u67d0\u4e9b\u8f6f\u4ef6\u53ef\u80fd\u4f1a\u628a\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u591a\u6570\u90fd\u662f/etc\u76ee\u5f55\u4e0b\uff0c\u6b64\u76ee\u5f55\u6ca1\u6709\u88ab\u5177\u4f53\u7684\u5b9a\u4e49 /temp \u4e34\u65f6\u6587\u4ef6\u5b58\u653e\u70b9\uff1b\u6b64\u76ee\u5f55\u6709\u7279\u6b8a\u7684\u6743\u9650\u4f4d\u7c98\u6ede\u4f4d\uff1a1777 /tftpboot\uff1a\u8fdc\u7a0b\u542f\u52a8tftpserver\u7684\u6839\u76ee\u5f55\uff0c\u8fd9\u4e2a\u76ee\u5f55\u53ea\u6709\u5b89\u88c5\u4e86tftp-server\u8f6f\u4ef6\u540e\u624d\u4f1a\u4ea7\u751f \u5907\u6ce8\uff1a\u5982\u679c\u8981\u505a\u7cfb\u7edf\u7ea7\u5907\u4efd\u7684\u8bdd\uff0c/etc ,/boot\u662f\u5fc5\u987b\u8981\u5907\u4efd\u7684\u76ee\u5f55\uff0c\u5907\u4efd\u5206\u4e3a\uff1a\u7cfb\u7edf\u5907\u4efd\u548c\u7528\u6237\u5907\u4efd /sbin /usr/sbin\u662froot\u8d26\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84 /bin /usr/bin\u5bf9\u4e8e\u666e\u901a\u7528\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84 bin\u4ee3\u8868binnary \uff1bsbin \u4ee3\u8868super binnary /usr\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u548cwindows\u7cfb\u7edf\u4e0a\u7684windows\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u6838\u5fc3\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e","title":"Linux\u76ee\u5f55\u7ed3\u6784FHS"},{"location":"Linux/#grub","text":"\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a / etc / grub . conf\u662f\u4e2a\u8f6f\u8fde\u63a5\u6587\u4ef6 \u539f\u59cb\u6587\u4ef6 / boot / grub / grub . conf grep - v \"^#\" / boot / grub / grub . conf | more \u5b57\u6bb5\uff1a default\u5b9a\u4e49\u7f3a\u7701\u542f\u52a8\u7cfb\u7edf , 0 \u8868\u793a\u7b2c\u4e00\u4e2a\uff0c 1 \u8868\u793a\u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8 ------------------------------------------------- timeout \u5b9a\u4e49\u4e86\u7f3a\u7701\u7b49\u5f85\u65f6\u95f4\uff1b\u9ed8\u8ba4 5 \u79d2 ------------------------------------------------- splashimage \u5b9a\u4e49\u4e86 GRUB\u542f\u52a8\u65f6\u7684\u754c\u9762\u56fe\u7247 ------------------------------------------------- hiddenmenu \u9690\u85cf\u83dc\u5355 ------------------------------------------------- title \u5b9a\u4e49\u4e86\u83dc\u5355\u9879\u540d\u79f0 ------------------------------------------------- root \u4f5c\u7528\u662f\u8bbe\u7f6e GRUB\u7684\u6839\u8bbe\u5907\u4e5f\u5c31\u662f\u5185\u6838\u6240\u5728\u7684\u5206\u533a ------------------------------------------------- kernel \u5b9a\u4e49\u4e86\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e ------------------------------------------------- initrd \u547d\u4ee4\u52a0\u8f7d\u955c\u50cf\u6587\u4ef6\u4ee5\u53ca\u663e\u793a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e ------------------------------------------------- GRUB\u8bbe\u7f6e\u5bc6\u7801 \u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u4f7f\u7528 GRUB\u81ea\u5e26\u7684grub - md5 - crypt\u547d\u4ee4 grub - md5 - crypt \u5728\u56fe\u5f62\u754c\u9762\u6211\u53ef\u4ee5\u9009\u62e9\u590d\u5236\u9009\u9879\u8fdb\u884c\u590d\u5236\uff0c\u5728\u5b57\u7b26\u7ec8\u7aef\u754c\u9762\u4e0a\u4f7f\u7528\u9f20\u6807\u53f3\u952e\u590d\u5236\u52a0\u5bc6\u5b57\u7b26 \u7f16\u8f91 / etc / grub . conf\u914d\u7f6e\u6587\u4ef6 \uff0c\u5728 hiddenmenu\u5b57\u6bb5\u4e0b\u9762\u63d2\u5165\u5173\u4e8e\u63d2\u5165\u4f4d\u7f6e\u6ca1\u6709\u4e25\u683c\u7684\u8981\u6c42 \uff09 password --md5 \u52a0\u5bc6\u5b57\u7b26\uff08-md5\u8868\u793a\u53e3\u4ee4\u662fmd5\u52a0\u5bc6\u7684\uff09 \u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u63d2\u5165\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff1b\u7136\u540e\u9000\u51fa\u4fdd\u6301\u5373\u53ef \u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u662f\u5728 GRUB\u4ea4\u4e92\u547d\u4ee4\u884c\u754c\u9762\u4f7f\u7528md5crypt\u547d\u4ee4 \uff0c\u6548\u679c\u662f\u4e00\u6837\u7684 grub grub > md5crypt password : GRUB\u7684\u7cfb\u7edf\u4fee\u590d \uff1a\uff08\u624b\u5de5\u4fee\u590d\uff09\u6545\u610f\u4fee\u6539 kernel\u6307\u5b9a\u7684\u5185\u6838\u6587\u4ef6 grub > cat / grub / grub . conf \u4e3a\u4ec0\u4e48\u6ca1\u6709 / boot\u539f\u56e0\u5c31\u662fgrub\u5b58\u653e\u5728 / boot\u5206\u533a grub > \u6307\u5b9a\u5185\u6838\u6240\u5728\u7684\u5206\u533a root ( hd0 , 0 ) grub > \u6307\u5b9a\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e grub > \u6307\u5b9a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e grub > boot \u624b\u5de5\u4fee\u590d\u5c5e\u4e8e\u547d\u4ee4\u884c\u64cd\u4f5c\uff1b\u5982\u4fee\u6539\u4e86 / etc / inittab\u4e2d\u7684\u9ed8\u8ba4\u542f\u52a8\u7ea7\u522b\u7684\u8bdd \uff0c\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7 grub\u542f\u52a8\u83dc\u5355\u6765\u8fdb\u884c\u4fee\u590d \uff1a\u5728 kernel\u884c\u76f4\u63a5\u52a0\u5165\u542f\u52a8\u7ea7\u522b \u7ec8\u6781\u4fee\u590d\u6a21\u5f0f\uff1a\u5149\u76d8\u4fee\u590d \u5149\u76d8\u5f15\u5bfc\uff0c F5\u952e \uff0c\u952e\u5165 linux rescue \u6848\u4f8b 1 \uff1a\u5c1d\u8bd5\u5220\u9664 / etc / inittab \uff0c\u4e4b\u524d\u5148\u505a\u597d\u5907\u4efd cp / etc / inittab / etc / inittab . bak rm - rf / etc / inittab \u6848\u4f8b 2 \uff1a\u5982\u679c\u5fd8\u8bb0\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u540c\u65f6\u4e5f\u5fd8\u8bb0\u4e86 GRUB\u7684\u4fdd\u62a4\u5bc6\u7801\u7684\u8bdd \uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 GRUB\u7684\u7cfb\u7edf\u4fee\u590d\u6216\u8005\u4f7f\u7528\u5149\u76d8\u7684\u5f15\u5bfc\u4fee\u590d\u6765\u89e3\u51b3\u6b64\u95ee\u9898","title":"GRUB\u914d\u7f6e\u6587\u4ef6\u8bb2\u89e3\uff1a"},{"location":"Linux/#fstab","text":"\u7269\u7406\u5206\u533a/\u5377\u6807\uff1b\u53ef\u4ee5\u4f7f\u7528UUID\u3001\u8bbe\u5907\u8def\u5f84/dev/\u3001\u534f\u8bae/\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u6216\u7f51\u7edc\u5171\u4eab\u540d\u79f0\u8868\u793a \u6302\u8f7d\u70b9(\u6ce8\u610f\uff1aswap\u6ca1\u6709\u6302\u8f7d\u70b9) \u6587\u4ef6\u7cfb\u7edf,auto\u901a\u5e38\u7528\u4e8e\u53ef\u79fb\u52a8\u8bbe\u5907\uff0c\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u6216\u7f51\u7edc\u5171\u4eab\u7f51\u7edc\u534f\u8bae \u6302\u8f7d\u65f6\u4f7f\u7528\u7684\u53c2\u6570\uff1b\u6b64\u9009\u9879\u53d6\u51b3\u4e8e\u6587\u4ef6\u7cfb\u7edf\uff0cdefault=rw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\u548casync sync/async \u6587\u4ef6\u7cfb\u7edf\u7684\u6240\u6709I/O\u540c\u6b65\u6216\u5f02\u6b65\u5b8c\u6210 auto \u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u81ea\u52a8\u6302\u8f7d\uff08\u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u9009\u9879\u4f20\u9012\u6302\u8f7d\u65f6\uff09\u3002\u786e\u5b9e\u6ca1\u6709\u5fc5\u8981\uff0c\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u8fd9\u662fmount -a\u7684\u9ed8\u8ba4\u64cd\u4f5c noauto \u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u6302\u8f7d\u65f6\u4e0d\u4f1a\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u60a8\u5fc5\u987b\u663e\u5f0f\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf dev/nodev \u89e3\u91ca\u6216\u4e0d\u89e3\u91ca\u5b57\u7b26\u6216\u963b\u6b62\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u8bbe\u5907 exec/noexec \u5141\u8bb8\u6216\u963b\u6b62\u4ece\u6587\u4ef6\u7cfb\u7edf\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6 suid/nosuid \u5141\u8bb8\u6216\u963b\u6b62suid\u548csgid\u4f4d\u7684\u64cd\u4f5c ro \u6302\u8f7d\u4e3a\u53ea\u8bfb rw \u6302\u8f7d\u4e3a\u8bfb\u5199 user \u5141\u8bb8\u4efb\u4f55\u7528\u6237\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u9664\u975e\u88ab\u8986\u76d6\uff0c\u8fd9\u5c06\u81ea\u52a8\u8868\u793anoexec\uff0cnosuid\uff0cnodev\u9664\u975e\u88ab\u989d\u5916\u9009\u9879\u8986\u76d6 nouser \u4ec5\u5141\u8bb8root\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u8bbe\u7f6e defaults \u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u3002\u7b49\u6548\u4e8erw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\uff0casync _netdev \u8fd9\u662f\u4e00\u4e2a\u7f51\u7edc\u8bbe\u5907\uff0c\u5728\u542f\u52a8\u7f51\u7edc\u540e\u5c06\u5176\u5b89\u88c5\u3002\u4ec5\u5bf9fstype nfs\u6709\u6548 noatime,nodiratime \u7981\u6b62\u8bb0\u5f55\u6700\u8fd1\u8bbf\u95ee\u65f6\u95f4\u6233\uff0c\u8bbe\u7f6enoatime\u53ef\u4e0d\u5fc5\u518d\u8bbe\u7f6enodiratime relatime \u5b9e\u65f6\u66f4\u65b0inode\u8bbf\u95ee\u8bb0\u5f55\u65f6\u95f4\u6233 owner \u5141\u8bb8\u8bbe\u5907\u88ab\u90a3\u4e2a\u6240\u6709\u8005\u6302\u8f7d \u542f\u7528\u6216\u7981\u7528\u8bbe\u5907/\u5206\u533a\u7684\u5907\u4efd(dump\u662f\u5907\u4efd\u5de5\u5177)\uff0c1\u8868\u793a\u5f00\u542f\uff0c0\u8868\u793a\u5ffd\u7565 \u63a7\u5236fsck\u5728\u5f15\u5bfc\u65f6\u68c0\u67e5\u8bbe\u5907/\u5206\u533a\u7684\u9519\u8bef\u7684\u987a\u5e8f\uff0c\u6839\u8bbe\u5907\u5e94\u4e3a1\u3002\u5176\u4ed6\u5206\u533a\u5e94\u4e3a2\u62160\u4ee5\u7981\u7528\u68c0\u67e5","title":"fstab\u6587\u4ef6\u542b\u4e49\u5982\u4e0b\uff1a"},{"location":"Linux/#linux_","text":"","title":"Linux_\u7528\u6237\u3001\u7ec4\u548c\u6743\u9650"},{"location":"Linux/#linux_4","text":"# \u67e5\u770b\u7cfb\u7edf\u4e2d\u6709\u591a\u5c11\u7684\u7528\u6237\u6570\u91cf wc - l / etc / passwd cut - d \" : \" - f 1 / etc / passwd # \u7528\u6237\u548c\u7ec4\u7684\u6587\u4ef6 / etc / passwd / etc / group # \u5f71\u5b50\u53e3\u4ee4\uff1a\uff08\u771f\u6b63\u53e3\u4ee4\u6587\u4ef6\u8def\u5f84\uff09 \u7528\u6237\uff1a / etc / shadow \u7ec4\uff1a / etc / gshadow # / etc / passwd\u4e2d7\u6bb5\u610f\u4e49 \uff1a\u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1a UID : GID \uff1a\u7528\u6237\u63cf\u8ff0\u4fe1\u606f\uff1a\u5bb6\u76ee\u5f55\uff1a\u9ed8\u8ba4 SHELL account : \u7528\u6237\u540d password : \u5bc6\u7801 UID \uff1a\u7528\u6237 ID \uff0c\u5206\u4e3a\u4e09\u7c7b\uff1a root\u7528\u6237 \uff1a 0 \uff0c\u666e\u901a\u7528\u6237\uff1a 500 - 60000 \uff0c\u4f2a\u7528\u6237\uff1a 1 - 499 GID \uff1a\u7ec4 ID \uff0c\u6bcf\u4e2a\u7528\u6237\u81f3\u5c11\u5c5e\u4e8e\u4e00\u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u53ef\u4ee5\u6709\u591a\u4e2a\u7528\u6237\uff0c\u540c\u4e00\u7528\u6237\u7ec4\u7684\u7528\u6237\u7ee7\u627f\u6539\u7ec4\u7684\u6743\u9650 \u7528\u6237\u63cf\u8ff0\u4fe1\u606f : \u9488\u5bf9\u7528\u6237\u7684\u7b80\u4ecb HOME DIR \uff1a\u5bb6\u76ee\u5f55 SHELL \uff1a\u7528\u6237\u7684\u9ed8\u8ba4 shell # / etc / group\u4e2d4\u6bb5\u610f\u4e49 \uff1a\u7ec4\u540d\uff1a\u5bc6\u7801\uff1a GID : \u4ee5\u6b64\u7ec4\u4e3a\u5176\u9644\u52a0\u7ec4\u7684\u7528\u6237\u5217\u8868 # / etc / shadow\u4e2d8\u6bb5\u610f\u4e49 \uff1a \u5b57\u6bb5 1 \uff1a\u7528\u6237\u5e10\u53f7\u7684\u540d\u79f0 \u5b57\u6bb5 2 \uff1a\u52a0\u5bc6\u7684\u5bc6\u7801\u5b57\u4e32\u4fe1\u606f \u5b57\u6bb5 3 \uff1a\u4e0a\u6b21\u4fee\u6539\u5bc6\u7801\u7684\u65f6\u95f4\uff08 1970 / 1 / 1 \u8ddd\u4fee\u6539\u65f6\u95f4\u7684\u5929\u6570\uff09 \u5b57\u6bb5 4 \uff1a\u5bc6\u7801\u7684\u6700\u77ed\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 0 \u5b57\u6bb5 5 \uff1a\u5bc6\u7801\u7684\u6700\u957f\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a 99999 \u5b57\u6bb5 6 \uff1a\u63d0\u524d\u591a\u5c11\u5929\u8b66\u544a\u7528\u6237\u53e3\u4ee4\u5c06\u8fc7\u671f\uff0c\u9ed8\u8ba4\u503c\u4e3a 7 \u5b57\u6bb5 7 \uff1a\u5728\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u591a\u5c11\u5929\u7981\u7528\u6b64\u7528\u6237 \u5b57\u6bb5 8 \uff1a\u5e10\u53f7\u5931\u6548\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a \u7a7a \u5b57\u6bb5 9 \uff1a\u4fdd\u7559\u5b57\u6bb5\uff08\u672a\u4f7f\u7528 ) # \u4f2a\u7528\u6237\uff1a \u4f2a\u7528\u6237\u5c31\u662f\u7cfb\u7edf\u548c\u7a0b\u5e8f\u64cd\u4f5c\u65f6\u8c03\u7528\u7684\u7528\u6237\uff0c\u4e0e\u7cfb\u7edf\u548c\u7a0b\u5e8f\u670d\u52a1\u76f8\u5173\u3002\u4f8b\u5982\uff1a bin \u3001 daemon \u3001 shutdown \u3001 halt\u7b49 \uff0c\u4efb\u4f55 linux\u64cd\u4f5c\u7cfb\u7edf\u90fd\u9ed8\u8ba4 \u6709\u8fd9\u4e9b\u4f2a\u7528\u6237\uff0c\u662f\u7cfb\u7edf\u81ea\u52a8\u751f\u6210\u7684\uff0c\u4f8b\u5982\uff1a mail \u3001 apache \u3001 ftp\u7b49 \uff0c\u4e0e linux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u76f8\u5173 \uff0c\u800c\u4e14\u6b64\u7c7b\u7684\u7528\u6237\u4e0d\u9700\u8981\u767b\u5f55\u6216\u8005\u662f\u65e0\u6cd5\u767b\u5f55 \u7cfb\u7edf\u5f53\u4e2d\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6ca1\u6709\u76f8\u5e94\u7684\u5bbf\u4e3b\u76ee\u5f55 # \u6269\u5c55\u77e5\u8bc6\u70b9\uff1a \u5173\u4e8e\u5efa\u7acb\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\u7684\u8fc7\u7a0b\u5206\u6790\uff1a\u5bc6\u7801\u5148\u5199\u5165 / etc / passwd\u6587\u4ef6\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5 \uff0c\u63a5\u7740\u901a\u8fc7\u6307\u4ee4\u8f6c\u5230 / etc / shadow\u6587\u4ef6\u4e2d \uff0c\u8f6c\u5316\u7684\u547d\u4ee4\u662f psconv \uff0c \u8fc7\u7a0b\u662f\u81ea\u52a8\u5b8c\u6210\uff0c\u56de\u5199\u7684\u547d\u4ee4\u662f pwunconv \uff0c\u6267\u884c\u6b64\u547d\u4ee4\u540e\u5bc6\u7801\u4f1a\u5728 / etc / passwd\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5X\u4e2d\u51fa\u73b0\u4e14\u662f\u52a0\u5bc6\u7684 \uff0c\u8fd9\u4e5f\u8bf4\u660e\u4e86\u5bc6\u7801\u4f4d\u4fdd\u7559\u7684\u539f\u56e0 \u767b\u9646\u4fe1\u606f\u6587\u4ef6\uff1a / etc / motd \u767b\u5f55\u6210\u529f\u540e\u4f1a\u770b\u5230\u63d0\u793a\u4fe1\u606f \u4fee\u6539 / etc / issue\u6587\u4ef6\u7684\u8bdd \uff0c\u662f\u5728\u767b\u5f55\u4e4b\u524d\u5c31\u53ef\u4ee5\u770b\u5230\uff1b\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u9632\u6b62\u770b\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c\u4fe1\u606f\uff0c\u53ef\u4ee5\u4fee\u6539 / etc / issue\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u8005\u76f4\u63a5\u5220\u9664\u5373\u53ef / etc / issue . net\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\u662f\u4f5c\u4e3atelnet\u670d\u52a1\u7684\u63d0\u793a\u4fe1\u606f issue \u5185\u7684\u5404\u4ee3\u7801\u610f\u4e49\u8868\u793a\u5982\u4e0b\u6240\u793a\uff1a\uff08\u7ba1\u7406\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0\uff09 / l \u663e\u793a\u7b2c\u51e0\u4e2a\u7ec8\u7aef\u673a\u63a5\u53e3 / m \u663e\u793a\u786c\u4ef6\u7684\u7b49\u7ea7 ( i386 / i486 / i586 / i686 ...) / n \u663e\u793a\u4e3b\u673a\u7684\u7f51\u7edc\u540d\u79f0 / o \u663e\u793a domain name / r \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c ( \u76f8\u5f53\u4e8e uname - r ) / t \u663e\u793a\u672c\u5730\u7aef\u65f6\u95f4\u7684\u65f6\u95f4 / s \u64cd\u4f5c\u7cfb\u7edf\u7684\u540d\u79f0 / v \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c","title":"Linux\u7528\u6237\u548c\u7528\u6237\u7ec4"},{"location":"Linux/#r-w-x","text":"# \u6587\u4ef6\u6743\u9650\uff1a r --4\uff1a\u53ef\u8bfb w --2\uff1a\u53ef\u5199 x --1: \u53ef\u6267\u884c\uff0ceXacutable # \u76ee\u5f55\u6743\u9650\uff1a w : \u53ef\u4ee5\u5728\u6b64\u76ee\u5f55\u521b\u5efa\u6587\u4ef6 r : \u53ef\u4ee5\u5bf9\u6b64\u76ee\u5f55\u6267\u884c ls\u4ee5\u5217\u51fa\u5185\u90e8\u7684\u6240\u6709\u6587\u4ef6 x : \u53ef\u4ee5\u4f7f\u7528 cd\u5207\u6362\u8fdb\u6b64\u76ee\u5f55 \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ls - l\u67e5\u770b\u5185\u90e8\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f # \u6743\u9650\u4e09\u4f4d\u4e00\u4f53\uff1a rwx : \u53ef\u8bfb\u53ef\u5b66\u53ef\u6267\u884c r --:\u53ea\u8bfb r - x : \u8bfb\u548c\u6267\u884c ---\uff1a\u65e0\u6743\u9650 # \u516b\u8fdb\u5236\u8868\u793a\uff1a 0 000 ---\uff1a\u65e0\u6743\u9650 1 001 --x: \u6267\u884c 2 010 - w - : \u5199 3 011 - wx : \u5199\u548c\u6267\u884c 4 100 r --: \u53ea\u8bfb 5 101 r - x : \u8bfb\u548c\u6267\u884c 6 110 rw - : \u8bfb\u5199 7 111 rwx : \u8bfb\u5199\u6267\u884c # \u4f8b\u5982\uff1a rw - r -----: 640 rw - r --r--: 644 rw - rw ----: 660 rwxr - xr - x : 755 rwxrwxr - x : 775","title":"\u6743\u9650\uff1ar, w, x"},{"location":"Linux/#_3","text":"\u7279\u6b8a\u6743\u9650\uff1a s , s , t 1 . SUID : \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u4e3b\uff0c\u800c\u4e0d\u662f\u52a8\u8005 \u683c\u5f0f\uff1a chmod u + s FILE \uff0c chmod u - s FILE \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3as \uff1b\u5426\u5219\u663e\u793a S 2 . SGID : \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u7ec4\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u7ec4\uff0c\u800c\u4e0d\u662f\u52a8\u8005\u6240\u5c5e\u7684\u57fa\u672c\u7ec4 \u683c\u5f0f\uff1a chmod g + s FILE \uff0c chmod g - s FILE \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3as \uff1b\u5426\u5219\u663e\u793a S 3 . Sticky bit ( \u7c98\u6ede\u4f4d ): \u5728\u4e00\u4e2a\u516c\u5171\u76ee\u5f55\uff0c\u6bcf\u4e2a\u90fd\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\uff0c\u5220\u9664\u81ea\u5df1\u7684\u6587\u4ef6\uff0c\u4f46\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u6587\u4ef6\u3002 \u5f53\u2f6c\u5f55\u88ab\u8bbe\u7f6e\u4e86\u7c98\u6ede\u4f4d\u6743\u9650\u4ee5\u540e\uff0c\u5373\u4fbf\u2f64\u6237\u5bf9\u8be5\u2f6c\u5f55\u6709\u5199\u2f0a\u6743\u9650\uff0c\u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u2f6c\u5f55 \u4e2d\u5176\u4ed6\u2f64\u6237\u7684\u2f42\u4ef6\u6570\u636e\uff0c\u2f7d\u662f\u53ea\u6709\u8be5\u2f42\u4ef6\u7684\u6240\u6709\u8005\u548c root \u2f64\u6237\u624d\u6709\u6743\u5c06\u5176\u5220\u9664 \u683c\u5f0f\uff1a chmod o + t DIR \uff0c chmod o - t DIR \u6ce8\u610f\uff1a\u5982\u679c FILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650 \uff0c\u5219 SUID\u663e\u793a\u4e3at \uff1b\u5426\u5219\u663e\u793a T \uff1b\u7c98\u6ede\u4f4d\u6743\u9650\u662f\u9488\u5bf9\u76ee\u5f55\u7684\uff0c\u5bf9\u6587\u4ef6\u65e0\u6548 4 . umask \uff1a \u6587\u4ef6\u9ed8\u8ba4\u6743\u9650\uff1a 666 - umask \u6587\u4ef6\u5939\u9ed8\u8ba4\u6743\u9650\uff1a 777 - umask \u7279\u6b8a\u6743\u9650\u9ed8\u8ba4\u4e3a 0 \u9ed8\u8ba4 umask \uff1a umask = 0022 \u66f4\u6539 umask \uff1a umask 0023 \u6ce8\u610f\uff1a\u6587\u4ef6\u9ed8\u8ba4\u4e0d\u80fd\u5177\u6709\u6267\u884c\u6743\u9650\uff0c\u5982\u679c\u7b97\u5f97\u7684\u7ed3\u679c\u4e2d\u6709\u6267\u884c\u6743\u9650\uff0c\u5219\u5c06\u6743\u9650\u52a0 1","title":"\u4e09\u3001\u7279\u6b8a\u6743\u9650"},{"location":"Linux/#_4","text":"# \u8bf4\u660e Ctrl \u2013 k # \u5148\u6309\u4f4f Ctrl \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e Alt \u2013 k # \u5148\u6309\u4f4f Alt \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e M \u2013 k # \u5148\u5355\u51fb Esc \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e # \u79fb\u52a8\u5149\u6807 Ctrl - \u5de6\u53f3\u952e # \u5728\u5355\u8bcd\u4e4b\u95f4\u8df3\u8f6c Ctrl \u2013 a # \u79fb\u5230\u884c\u9996 Ctrl \u2013 e # \u79fb\u5230\u884c\u5c3e Ctrl \u2013 b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 Ctrl \u2013 f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 Alt \u2013 b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd Alt \u2013 f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd Ctrl \u2013 xx # \u5728\u547d\u4ee4\u884c\u5c3e\u548c\u5149\u6807\u4e4b\u95f4\u79fb\u52a8 M - b # \u5f80\u56de ( \u5de6 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd M - f # \u5f80\u540e ( \u53f3 ) \u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd # \u7f16\u8f91\u547d\u4ee4 Ctrl \u2013 h # \u5220\u9664\u5149\u6807\u5de6\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26 Ctrl \u2013 d # \u5220\u9664\u5149\u6807\u53f3\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26\uff08\u6ce8\u610f\u5f53\u524d\u547d\u4ee4\u884c\u6ca1\u6709\u4efb\u4f55\u5b57\u7b26\u65f6\uff0c\u4f1a\u6ce8\u9500\u7cfb\u7edf\u6216\u7ed3\u675f\u7ec8\u7aef\uff09 Ctrl \u2013 w # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u5de6\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u9996\u5220 Alt \u2013 d # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u53f3\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u5c3e\u5220 M \u2013 d # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5355\u8bcd\uff0c\u76f4\u5230\u8be5\u5355\u8bcd\u7ed3\u675f Ctrl \u2013 k # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u53f3\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u7ed3\u675f Ctrl \u2013 u # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5de6\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u5f00\u59cb Ctrl \u2013 y # \u7c98\u8d34 Ctrl + u\u6216ctrl + k\u526a\u5207\u7684\u5185\u5bb9 ctrl \u2013 t # \u4ea4\u6362\u5149\u6807\u5904\u548c\u4e4b\u524d\u4e24\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e Alt + . # \u4f7f\u7528\u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570 Ctrl \u2013 _ # \u56de\u590d\u4e4b\u524d\u7684\u72b6\u6001\u3002\u64a4\u9500\u64cd\u4f5c Ctrl - a + Ctrl - k \u6216 Ctrl - e + Ctrl - u \u6216 Ctrl - k + Ctrl - u # \u7ec4\u5408\u53ef\u5220\u9664\u6574\u884c # \u63a7\u5236\u547d\u4ee4 Ctrl \u2013 l # \u6e05\u9664\u5c4f\u5e55\uff0c\u7136\u540e\uff0c\u5728\u6700\u4e0a\u9762\u91cd\u65b0\u663e\u793a\u76ee\u524d\u5149\u6807\u6240\u5728\u7684\u8fd9\u4e00\u884c\u7684\u5185\u5bb9 Ctrl \u2013 o # \u6267\u884c\u5f53\u524d\u547d\u4ee4\uff0c\u5e76\u9009\u62e9\u4e0a\u4e00\u6761\u547d\u4ee4 Ctrl \u2013 s # \u963b\u6b62\u5c4f\u5e55\u8f93\u51fa Ctrl \u2013 q # \u5141\u8bb8\u5c4f\u5e55\u8f93\u51fa Ctrl \u2013 c # \u7ec8\u6b62\u547d\u4ee4 Ctrl \u2013 z # \u6302\u8d77\u547d\u4ee4 # Bang ( ! ) \u547d\u4ee4 !! # \u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4 ^ foo ^ bar # \u628a\u4e0a\u4e00\u6761\u547d\u4ee4\u91cc\u7684 foo\u66ff\u6362\u4e3abar \uff0c\u5e76\u6267\u884c ! wget # \u6267\u884c\u6700\u8fd1\u7684\u4ee5 wget\u5f00\u5934\u7684\u547d\u4ee4 ! wget p # \u4ec5\u6253\u5370\u6700\u8fd1\u7684\u4ee5 wget\u5f00\u5934\u7684\u547d\u4ee4 \uff0c\u4e0d\u6267\u884c ! $ # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff0c \u4e0e Alt - . \u548c $ _ \u76f8\u540c !* # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6240\u6709\u53c2\u6570 !* p # \u6253\u5370\u4e0a\u4e00\u6761\u547d\u4ee4\u662f\u6240\u6709\u53c2\u6570\uff0c\u4e5f\u5373 !* \u7684\u5185\u5bb9 ^ abc # \u5220\u9664\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 abc ^ foo ^ bar # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar ^ foo ^ bar ^ # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar !- n # \u6267\u884c\u524d n\u6761\u547d\u4ee4 \uff0c\u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4 !- 1 \uff0c \u6267\u884c\u524d 5 \u6761\u547d\u4ee4\u7684\u683c\u5f0f\u662f !- 5 # \u67e5\u627e\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 p # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0a\u4e00\u6761\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 n # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0b\u4e00\u6761\u5386\u53f2\u547d\u4ee4 Ctrl \u2013 r # \u641c\u7d22\u5386\u53f2\u547d\u4ee4\uff0c\u8f93\u5165\u540e\u663e\u793a\u5386\u53f2\u547d\u4ee4\u4e2d\u4e00\u6761\u5339\u914d\u547d\u4ee4\uff0c Enter\u952e\u6267\u884c\u5339\u914d\u547d\u4ee4 \uff1b ESC\u952e\u5728\u547d\u4ee4\u884c\u663e\u793a\u800c\u4e0d\u6267\u884c\u5339\u914d\u547d\u4ee4 Ctrl \u2013 g # \u4ece\u5386\u53f2\u641c\u7d22\u6a21\u5f0f\uff08 Ctrl \u2013 r \uff09\u9000\u51fa # \u91cd\u590d\u6267\u884c\u64cd\u4f5c\u52a8\u4f5c M \u2013 \u64cd\u4f5c\u6b21\u6570 \u64cd\u4f5c\u52a8\u4f5c # \u6307\u5b9a\u64cd\u4f5c\u6b21\u6570\uff0c\u91cd\u590d\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c","title":"\u7cfb\u7edf\u547d\u4ee4\u884c\u5feb\u6377\u952e"},{"location":"Linux/#centos","text":"# \u66f4\u6539yum\u6e90\u4e3a\u963f\u91cc\u4e91 # \u5907\u4efd mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup # \u4e0b\u8f7d\u65b0\u7684\u5bf9\u5e94\u7248\u672cCentOS-Base.repo \u5230/etc/yum.repos.d/ ## CentOS 5 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-5.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-5.repo ## CentOS 6 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo ## CentOS 7 wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo # \u66f4\u6539yum\u6e90\u4e3a163 # \u5907\u4efd mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup # \u4e0b\u8f7d\u5bf9\u5e94\u7248\u672crepo\u6587\u4ef6, \u653e\u5165/etc/yum.repos.d/(\u64cd\u4f5c\u524d\u8bf7\u505a\u597d\u76f8\u5e94\u5907\u4efd) CentOS5 http://mirrors.163.com/.help/CentOS5-Base-163.repo CentOS6 http://mirrors.163.com/.help/CentOS6-Base-163.repo CentOS7 http://mirrors.163.com/.help/CentOS7-Base-163.repo yum clean all # \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u751f\u6210\u7f13\u5b58 yum makecache fast # \u4e4b\u540e\u8fd0\u884cyum makecache\u751f\u6210\u7f13\u5b58 yum -y upgrade # \u53ea\u5347\u7ea7\u6240\u6709\u5305\uff0c\u4e0d\u5347\u7ea7\u8f6f\u4ef6\u548c\u7cfb\u7edf\u5185\u6838 yum -y update # \u5347\u7ea7\u6240\u6709\u5305\u540c\u65f6\u4e5f\u5347\u7ea7\u8f6f\u4ef6\u548c\u7cfb\u7edf\u5185\u6838 # \u5728\u7ebf\u5b89\u88c5epel\u6e90 rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm yum -y install epel-release","title":"Centos\u6e90\u8bbe\u7f6e"},{"location":"Linux/#ubuntu-desktop","text":"xdotool mouseup 1 # \u6302\u8d77\u540e\u8fdb\u5165\u7cfb\u7edf\u8f93\u5165,\u7136\u540e\u6ce8\u9500\u91cd\u65b0\u767b\u5f55 gsettings set com.canonical.unity.launcher launcher-position bottom # \u5c06ubuntu\u542f\u52a8\u680f\u79fb\u52a8\u5230\u6700\u4e0b\u65b9 gsettings get com.canonical.unity.launcher launcher-position # \u5f97\u5230\u542f\u52a8\u680f\u4f4d\u7f6e # \u8bbe\u7f6e\u4e34\u65f6\u6587\u4ef6\u4e0d\u518d\u653e\u7f6e\u5728\u786c\u76d8\u52a0\u5feb\u901f\u5ea6\uff0c\u800c\u653e\u5728\u865a\u62dfRAM\u78c1\u76d8\u4e0a\u3002\u603b\u5185\u5b58\u5fc5\u987b\u5927\u4e8e4G cp -v /usr/share/systemd/tmp.mount /etc/systemd/system/ systemctl enable tmp.mount systemctl reload tmp.mount # \u4e0d\u751f\u6548\u53ef\u91cd\u542f\u8ba1\u7b97\u673a\u3002systemctl status tmp.mount\u68c0\u67e5\u72b6\u6001 # \u53d6\u6d88tmpfs,\u5220\u9664\u540e\u91cd\u542f\u751f\u6548 rm -v /etc/systemd/system/tmp.mount : << comment # \u51cf\u5c11\u6587\u4ef6\u5199\u5165(\u5f53\u7528\u4e8e\u975e\u670d\u52a1\u5668\u65f6)\u5728/etc/fstab\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a tmpfs /tmp tmpfs defaults 0 0 tmpfs /var/tmp tmpfs defaults 0 0 tmpfs /var/log tmpfs defaults 0 0 comment # \u81ea\u5b9a\u4e49terminal\u4f4d\u7f6e\u548c\u5927\u5c0f cp /usr/share/applications/gnome-terminal.desktop ~/.local/share/applications sed -i 's/^Exec=gnome-terminal$/& --geometry=80x24+100+100/' ~/.local/share/applications/gnome-terminal.desktop gsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal --geometry=80x24+100+100' # \u5220\u9664\u81ea\u5b9a\u4e49 rm ~/.local/share/applications/gnome-terminal.desktop gsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal'","title":"ubuntu Desktop\u76f8\u5173\u8bbe\u7f6e"},{"location":"Linux/#bash","text":"# \u65b9\u6cd5\u4e00\uff1a\u4fee\u6539\u7528\u6237\u4e3b\u76ee\u5f55\u4e0b\u7684.profile\u6216.bashrc\u6587\u4ef6(\u63a8\u8350)\uff0c\u5728\u6587\u4ef6\u672b\u5c3e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u53ea\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548 export PATH = \" $PATH :your path1:your path2\" # \u65b9\u6cd5\u4e8c\uff1a\u4fee\u6539\u7f16\u8f91\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684profile\u6587\u4ef6(\u8c28\u614e)\uff1a\u5728\u6700\u540e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u5bf9\u6240\u6709\u7684\u7528\u6237\u90fd\u6709\u6548 export PATH = \" $PATH :your path1:your path2\" # \u65b9\u6cd5\u4e09\uff1a\u4fee\u6539\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684 environment \u6587\u4ef6\u7684PATH\u53d8\u91cf(\u8c28\u614e),\u5404\u4e2apath\u4e4b\u95f4\u5192\u53f7\u5206\u5272\uff0c\u5f71\u54cd\u6240\u6709\u7528\u6237 # \u65b9\u6cd5\u56db\uff1a\u76f4\u63a5\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165,\u8fd9\u79cd\u65b9\u5f0f\u53d8\u91cf\u7acb\u5373\u751f\u6548\uff0c\u4f46\u7528\u6237\u6ce8\u9500\u6216\u7cfb\u7edf\u91cd\u542f\u540e\u8bbe\u7f6e\u53d8\u6210\u65e0\u6548\uff0c\u9002\u5408\u4e34\u65f6\u53d8\u91cf\u7684\u8bbe\u7f6e export PATH = \" $PATH :your path1:your path2\" # \u4fdd\u5b58\u540e\u6267\u884csource\u547d\u4ee4\u751f\u6548","title":"BASH\u73af\u5883\u53d8\u91cf\u7684\u8bbe\u7f6e\u65b9\u6cd5\uff1a"},{"location":"Linux/#linuxjava","text":"# \u5728 CentOS7\u5b89\u88c5Oracle Java JDK8 rpm - qa | grep - E '^open[jre|jdk]|j[re|dk]' # \u67e5\u627e\u5df2\u5b89\u88c5\u7684 jdk\u7ec4\u4ef6 yum remove java - $ Version # \u5378\u8f7d\u4e4b\u524d\u5df2\u5b89\u88c5\u7684 jdk # \u5728 / usr\u76ee\u5f55\u521b\u5efajava\u6587\u4ef6\u5939 \uff0c\u4e0b\u8f7d jdk\u5305http : // www . oracle . com / technetwork / java / javase / downloads / index . html mkdir / usr / java wget http : // download . oracle . com / otn - pub / java / jdk / 8 u161 - b12 / ... tar . gz tar - zxvf jdk .. # \u7f16\u8f91 . bashrc\u6587\u4ef6 \uff0c\u5728 export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL\u4e0b\u9762\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801 \uff1a export JAVA_HOME =/ usr / java / jdk - $ version export PATH = $ JAVA_HOME / bin : $ PATH export CLASSPATH = .: $ JAVA_HOME / lib / dt . jar : $ JAVA_HOME / lib / tools . jar # \u914d\u7f6e\u751f\u6548\u5e76\u9a8c\u8bc1 source . bashrc && java --version","title":"Linux\u5b89\u88c5\u8bbe\u7f6ejava\u73af\u5883"},{"location":"Linux/#ssh","text":"","title":"SSH\u76f8\u5173\u547d\u4ee4\u548c\u914d\u7f6e"},{"location":"Linux/#ssh_1","text":"\u4f7f\u7528\u975e\u5bc6\u7801\u767b\u9646\u65b9\u5f0f\u5982\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5ffd\u7565\u6b64\u9879\u3002\u5728 / etc / login . defs \u4e2d\u5c06 PASS_MAX_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a 60 - 180 \u4e4b\u95f4\uff0c \u5982 PASS_MAX_DAYS 90 \u3002\u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4\u8bbe\u7f6e root\u5bc6\u7801\u5931\u6548\u65f6\u95f4 \uff1a chage --maxdays 90 root \u5728 / etc / login . defs \u4e2d\u5c06 PASS_MIN_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a 7 - 14 \u4e4b\u95f4 , \u5efa\u8bae\u4e3a 7 \uff1a PASS_MIN_DAYS 7 \u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4 \u4e3a root\u7528\u6237\u8bbe\u7f6e \uff1a chage --mindays 7 root \u7f16\u8f91 / etc / security / pwquality . conf \uff0c\u628a minlen \uff08\u5bc6\u7801\u6700\u5c0f\u957f\u5ea6\uff09\u8bbe\u7f6e\u4e3a 9 - 32 \u4f4d\uff0c\u628a minclass \uff08\u81f3\u5c11\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u3001 \u5927\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7279\u6b8a\u5b57\u7b26\u7b49 4 \u7c7b\u5b57\u7b26\u4e2d\u7b49 3 \u7c7b\u6216 4 \u7c7b\uff09\u8bbe\u7f6e\u4e3a 3 \u6216 4 \u3002\u5982\uff1a minlen = 10 minclass = 3","title":"ssh\u57fa\u672c\u52a0\u56fa\u5efa\u8bae"},{"location":"Linux/#sedssh","text":"iptables -I INPUT -p tcp --dport 22 -j ACCEPT # iptables\u5f00\u653e22\u7aef\u53e3 sed -i \"/A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT/d\" /etc/sysconfig/iptables iptables save service iptables restart sed -i 's/#Port 22/Port 2121/' /etc/ssh/sshd_config # \u4fee\u6539sshd_config\u6587\u4ef6\uff0c\u5c06#Port 22\u76f4\u63a5\u66ff\u6362\u6210Port 2121","title":"sed\u547d\u4ee4\u66f4\u6539\u9ed8\u8ba4ssh\u8fde\u63a5\u7aef\u53e3"},{"location":"Linux/#sshd_configetcsshsshd_config","text":"# The strategy used for options in the default sshd_config shipped with # OpenSSH is to specify options with their default value where # possible , but leave them commented . Uncommented options override the # default value # # AddressFamily \u6307\u5b9a sshd \u5e94\u5f53\u4f7f\u7528\u54ea\u79cd\u5730\u5740\u65cf\u3002\u53d6\u503c\u8303\u56f4\u662f\uff1a \" any \" ( \u9ed8\u8ba4 ) \u3001 \" inet \" ( \u4ec5 IPv4 ) \u3001 \" inet6 \" ( \u4ec5 IPv6 ) # AddressFamily any # \u6307\u5b9a sshd \u76d1\u542c\u7684\u7f51\u7edc\u5730\u5740\uff0c\u9ed8\u8ba4\u76d1\u542c\u6240\u6709\u5730\u5740\u3002\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u683c\u5f0f\uff1a # ListenAddress host | IPv4_addr | IPv6_addr # ListenAddress host | IPv4_addr : port # ListenAddress [ host | IPv6_addr ]: port # \u5982\u679c\u672a\u6307\u5b9a port \uff0c\u90a3\u4e48\u5c06\u4f7f\u7528 Port \u6307\u4ee4\u7684\u503c # \u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a ListenAddress \u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u5730\u5740 # ListenAddress 0 . 0 . 0 . 0 # ListenAddress :: # HostKey # \u4e3b\u673a\u79c1\u94a5\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u6743\u9650\u4e0d\u5bf9\uff0c sshd \u53ef\u80fd\u4f1a\u62d2\u7edd\u542f\u52a8 # SSH - 1 \u9ed8\u8ba4\u662f / etc / ssh / ssh_host_key # SSH - 2 \u9ed8\u8ba4\u662f / etc / ssh / ssh_host_rsa_key \u548c / etc / ssh / ssh_host_dsa_key # \u4e00\u53f0\u4e3b\u673a\u53ef\u4ee5\u62e5\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u79c1\u94a5\u3002 \" rsa1 \" \u4ec5\u7528\u4e8e SSH - 1 \uff0c \" dsa \" \u548c \" rsa \" \u4ec5\u7528\u4e8e SSH - 2 # HostKey / etc / ssh / ssh_host_rsa_key # HostKey / etc / ssh / ssh_host_ecdsa_key # HostKey / etc / ssh / ssh_host_ed25519_key # \u6307\u5b9a SSH - 2 \u5141\u8bb8\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002\u591a\u4e2a\u7b97\u6cd5\u4e4b\u95f4\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u53ef\u4ee5\u4f7f\u7528\u7684\u7b97\u6cd5\u5982\u4e0b\uff1a # \" aes128-cbc \" , \" aes192-cbc \" , \" aes256-cbc \" , \" aes128-ctr \" , \" aes192-ctr \" , \" aes256-ctr \" , # \" 3des-cbc \" , \" arcfour128 \" , \" arcfour256 \" , \" arcfour \" , \" blowfish-cbc \" , \" cast128-cbc \" # \u9ed8\u8ba4\u503c\u662f\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u6240\u6709\u7b97\u6cd5 # Ciphers and keying # RekeyLimit default none # \u6307\u5b9a sshd \u5c06\u65e5\u5fd7\u6d88\u606f\u901a\u8fc7\u54ea\u4e2a\u65e5\u5fd7\u5b50\u7cfb\u7edf ( facility ) \u53d1\u9001\u3002\u6709\u6548\u503c\u662f\uff1a DAEMON , USER , AUTH ( \u9ed8\u8ba4 ) , LOCAL0 , LOCAL1 , LOCAL2 , LOCAL3 , # LOCAL4 , LOCAL5 , LOCAL6 , LOCAL7 # Logging # SyslogFacility AUTH # \u6307\u5b9a sshd ( 8 ) \u7684\u65e5\u5fd7\u7b49\u7ea7 ( \u8be6\u7ec6\u7a0b\u5ea6 ) \u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # QUIET , FATAL , ERROR , INFO ( \u9ed8\u8ba4 ) , VERBOSE , DEBUG , DEBUG1 , DEBUG2 , DEBUG3 # DEBUG \u4e0e DEBUG1 \u7b49\u4ef7\uff1b DEBUG2 \u548c DEBUG3 \u5219\u5206\u522b\u6307\u5b9a\u4e86\u66f4\u8be6\u7ec6\u3001\u66f4\u7f57\u55e6\u7684\u65e5\u5fd7\u8f93\u51fa # \u6bd4 DEBUG \u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\u53ef\u80fd\u4f1a\u6cc4\u6f0f\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f\uff0c\u56e0\u6b64\u53cd\u5bf9\u4f7f\u7528 # LogLevel INFO # Authentication : # \u9650\u5236\u7528\u6237\u5fc5\u987b\u5728\u6307\u5b9a\u7684\u65f6\u9650\u5185\u8ba4\u8bc1\u6210\u529f\uff0c 0 \u8868\u793a\u65e0\u9650\u5236\u3002\u9ed8\u8ba4\u503c\u662f 120 \u79d2 # LoginGraceTime 2 m # \u662f\u5426\u5141\u8bb8 root \u767b\u5f55\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # \" yes \" ( \u9ed8\u8ba4 ) \u8868\u793a\u5141\u8bb8\u3002 \" no \" \u8868\u793a\u7981\u6b62 # \" without-password \" \u8868\u793a\u7981\u6b62\u4f7f\u7528\u5bc6\u7801\u8ba4\u8bc1\u767b\u5f55 # \" forced-commands-only \" \u8868\u793a\u53ea\u6709\u5728\u6307\u5b9a\u4e86 command \u9009\u9879\u65f6\u624d\u5141\u8bb8\u4f7f\u7528\u516c\u94a5\u8ba4\u8bc1\u767b\u5f55\u3002\u540c\u65f6\u5176\u5b83\u8ba4\u8bc1\u65b9\u6cd5\u5168\u90e8\u88ab\u7981\u6b62\u3002\u8be5\u503c\u5e38\u7528\u4e8e\u505a\u8fdc\u7a0b\u5907\u4efd\u4e4b\u7c7b\u7684\u4e8b\u60c5 # PermitRootLogin prohibit - password # \u6307\u5b9a\u662f\u5426\u8981\u6c42 sshd \u5728\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u524d\u5bf9\u7528\u6237\u4e3b\u76ee\u5f55\u548c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u5bbf\u4e3b\u548c\u6743\u9650\u68c0\u67e5\u3002\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c \" yes \" \u6765\u9884\u9632\u53ef\u80fd\u51fa\u73b0\u7684\u4f4e\u7ea7\u9519\u8bef # StrictModes yes # \u6307\u5b9a\u6bcf\u4e2a\u8fde\u63a5\u6700\u5927\u5141\u8bb8\u7684\u8ba4\u8bc1\u6b21\u6570\u3002\u9ed8\u8ba4\u503c\u662f 6 # \u5982\u679c\u5931\u8d25\u8ba4\u8bc1\u7684\u6b21\u6570\u8d85\u8fc7\u8fd9\u4e2a\u6570\u503c\u7684\u4e00\u534a\uff0c\u8fde\u63a5\u5c06\u88ab\u5f3a\u5236\u65ad\u5f00\uff0c\u4e14\u4f1a\u751f\u6210\u989d\u5916\u7684\u5931\u8d25\u65e5\u5fd7\u6d88\u606f # MaxAuthTries 6 # MaxSessions 10 # \u662f\u5426\u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\u3002\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u3002\u9ed8\u8ba4\u503c\u4e3a \" yes \" # PubkeyAuthentication yes ###################################################################################################################### # \u5b58\u653e\u8be5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u767b\u5f55\u7684 RSA / DSA \u516c\u94a5 # \u8be5\u6307\u4ee4\u4e2d\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u6839\u636e\u8fde\u63a5\u65f6\u7684\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u5c55\u5f00\u7684\u7b26\u53f7\uff1a # %% \u8868\u793a ' % ' \u3001 % h \u8868\u793a\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3001 % u \u8868\u793a\u8be5\u7528\u6237\u7684\u7528\u6237\u540d # \u7ecf\u8fc7\u6269\u5c55\u4e4b\u540e\u7684\u503c\u5fc5\u987b\u8981\u4e48\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u8981\u4e48\u662f\u76f8\u5bf9\u4e8e\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84 # \u9ed8\u8ba4\u503c\u662f \" .ssh/authorized_keys \" # Expect . ssh / authorized_keys2 to be disregarded by default in future # AuthorizedKeysFile . ssh / authorized_keys . ssh / authorized_keys2 ###################################################################################################################### # AuthorizedPrincipalsFile none # AuthorizedKeysCommand none # AuthorizedKeysCommandUser nobody # \u662f\u5426\u4f7f\u7528\u5f3a\u53ef\u4fe1\u4e3b\u673a\u8ba4\u8bc1 ( \u901a\u8fc7\u68c0\u67e5\u8fdc\u7a0b\u4e3b\u673a\u540d\u548c\u5173\u8054\u7684\u7528\u6237\u540d\u8fdb\u884c\u8ba4\u8bc1 ) \u3002\u4ec5\u7528\u4e8e SSH - 1 # \u8fd9\u662f\u901a\u8fc7\u5728 RSA \u8ba4\u8bc1\u6210\u529f\u540e\u518d\u68c0\u67e5 ~/ . rhosts \u6216 / etc / hosts . equiv \u8fdb\u884c\u8ba4\u8bc1\u7684 # \u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" # RhostsRSAAuthentication # \u8fd9\u4e2a\u6307\u4ee4\u4e0e RhostsRSAAuthentication \u7c7b\u4f3c\uff0c\u4f46\u662f\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u3002\u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" # \u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c \" no \" \u7981\u6b62\u8fd9\u79cd\u4e0d\u5b89\u5168\u7684\u8ba4\u8bc1\u65b9\u5f0f # For this to work you will also need host keys in / etc / ssh / ssh_known_hosts # HostbasedAuthentication no # HostbasedUsesNameFromPacketOnly # \u5728\u5f00\u542f HostbasedAuthentication \u7684\u60c5\u51b5\u4e0b\uff0c # \u6307\u5b9a\u670d\u52a1\u5668\u5728\u4f7f\u7528 ~/ . shosts ~/ . rhosts / etc / hosts . equiv \u8fdb\u884c\u8fdc\u7a0b\u4e3b\u673a\u540d\u5339\u914d\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u53cd\u5411\u57df\u540d\u67e5\u8be2 # \" yes \" \u8868\u793a sshd \u4fe1\u4efb\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4e3b\u673a\u540d\u800c\u4e0d\u8fdb\u884c\u53cd\u5411\u67e5\u8be2\u3002\u9ed8\u8ba4\u503c\u662f \" no \" # \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565\u7528\u6237\u7684 ~/ . ssh / known_hosts \u6587\u4ef6 # \u9ed8\u8ba4\u503c\u662f \" no \" \u3002\u4e3a\u4e86\u63d0\u9ad8\u5b89\u5168\u6027\uff0c\u53ef\u4ee5\u8bbe\u4e3a \" yes \" # Change to yes if you don ' t trust ~/.ssh/known_hosts for # HostbasedAuthentication # IgnoreUserKnownHosts no # \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565 . rhosts \u548c . shosts \u6587\u4ef6 # \u4e0d\u8fc7 / etc / hosts . equiv \u548c / etc / shosts . equiv \u4ecd\u5c06\u88ab\u4f7f\u7528\u3002\u63a8\u8350\u8bbe\u4e3a\u9ed8\u8ba4\u503c \" yes \" # Don ' t read the user ' s ~/ . rhosts and ~/ . shosts files # IgnoreRhosts yes # To disable tunneled clear text passwords , change to no here ! # \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e\u5bc6\u7801\u7684\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u4e3a \" yes \" # PasswordAuthentication yes # \u662f\u5426\u5141\u8bb8\u5bc6\u7801\u4e3a\u7a7a\u7684\u7528\u6237\u8fdc\u7a0b\u767b\u5f55\u3002\u9ed8\u8ba4\u4e3a \" no \" # PermitEmptyPasswords no # \u662f\u5426\u5141\u8bb8\u8d28\u7591 - \u5e94\u7b54 ( challenge - response ) \u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # \u6240\u6709 login . conf ( 5 ) \u4e2d\u5141\u8bb8\u7684\u8ba4\u8bc1\u65b9\u5f0f\u90fd\u88ab\u652f\u6301 # Change to yes to enable challenge - response passwords ( beware issues with # some PAM modules and threads ) ChallengeResponseAuthentication no # Kerberos options # \u662f\u5426\u8981\u6c42\u7528\u6237\u4e3a PasswordAuthentication \u63d0\u4f9b\u7684\u5bc6\u7801\u5fc5\u987b\u901a\u8fc7 Kerberos KDC \u8ba4\u8bc1\uff0c\u4e5f\u5c31\u662f\u662f\u5426\u4f7f\u7528 Kerberos \u8ba4\u8bc1 # \u8981\u4f7f\u7528 Kerberos \u8ba4\u8bc1\uff0c\u670d\u52a1\u5668\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u6821\u9a8c KDC identity \u7684 Kerberos servtab \u3002\u9ed8\u8ba4\u503c\u662f \" no \" # KerberosAuthentication no # \u5982\u679c Kerberos \u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25\uff0c\u90a3\u4e48\u8be5\u5bc6\u7801\u8fd8\u5c06\u8981\u901a\u8fc7\u5176\u5b83\u7684\u8ba4\u8bc1\u673a\u5236 ( \u6bd4\u5982 / etc / passwd ) # \u9ed8\u8ba4\u503c\u4e3a \" yes \" # KerberosOrLocalPasswd yes # \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u7684 ticket \u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # KerberosTicketCleanup yes # \u5982\u679c\u4f7f\u7528\u4e86 AFS \u5e76\u4e14\u8be5\u7528\u6237\u6709\u4e00\u4e2a Kerberos 5 TGT \uff0c\u90a3\u4e48\u5f00\u542f\u8be5\u6307\u4ee4\u540e\uff0c # \u5c06\u4f1a\u5728\u8bbf\u95ee\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u524d\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a AFS token \u3002\u9ed8\u8ba4\u4e3a \" no \" # KerberosGetAFSToken no # GSSAPI options # \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e GSSAPI \u7684\u7528\u6237\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u4e3a \" no \" \u3002\u4ec5\u7528\u4e8e SSH - 2 # GSSAPIAuthentication no # \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u51ed\u8bc1\u7f13\u5b58\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" \u3002\u4ec5\u7528\u4e8e SSH - 2 # GSSAPICleanupCredentials yes # GSSAPIStrictAcceptorCheck yes # GSSAPIKeyExchange no # Set this to ' yes ' to enable PAM authentication , account processing , # and session processing . If this is enabled , PAM authentication will # be allowed through the ChallengeResponseAuthentication and # PasswordAuthentication . Depending on your PAM configuration , # PAM authentication via ChallengeResponseAuthentication may bypass # the setting of \" PermitRootLogin without-password \" # If you just want the PAM account and session checks to run without # PAM authentication , then enable this but set PasswordAuthentication # and ChallengeResponseAuthentication to ' no ' UsePAM yes # AllowAgentForwarding yes # \u662f\u5426\u5141\u8bb8 TCP \u8f6c\u53d1\uff0c\u9ed8\u8ba4\u503c\u4e3a \" yes \" # \u7981\u6b62 TCP \u8f6c\u53d1\u5e76\u4e0d\u80fd\u589e\u5f3a\u5b89\u5168\u6027\uff0c\u9664\u975e\u7981\u6b62\u4e86\u7528\u6237\u5bf9 shell \u7684\u8bbf\u95ee\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668 # AllowTcpForwarding yes ###################################################################################################################### # GatewayPorts # \u662f\u5426\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u672c\u5730\u7684\u8f6c\u53d1\u7aef\u53e3\u3002\u9ed8\u8ba4\u503c\u662f \" no \" # sshd ( 8 ) \u9ed8\u8ba4\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230 loopback \u5730\u5740\u3002\u8fd9\u6837\u5c06\u963b\u6b62\u5176\u5b83\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230\u8f6c\u53d1\u7aef\u53e3 # GatewayPorts \u6307\u4ee4\u53ef\u4ee5\u8ba9 sshd \u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u975e loopback \u5730\u5740\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u4e86 # \" no \" \u8868\u793a\u4ec5\u5141\u8bb8\u672c\u5730\u8fde\u63a5\uff0c \" yes \" \u8868\u793a\u5f3a\u5236\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u7edf\u914d\u5730\u5740 ( wildcard address ) \uff0c # \" clientspecified \" \u8868\u793a\u5141\u8bb8\u5ba2\u6237\u7aef\u9009\u62e9\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u54ea\u4e2a\u5730\u5740 # GatewayPorts no ###################################################################################################################### # \u662f\u5426\u5141\u8bb8\u8fdb\u884c X11 \u8f6c\u53d1\u3002\u9ed8\u8ba4\u503c\u662f \" no \" \uff0c\u8bbe\u4e3a \" yes \" \u8868\u793a\u5141\u8bb8 # \u5982\u679c\u5141\u8bb8 X11 \u8f6c\u53d1\u5e76\u4e14 sshd ( 8 ) \u4ee3\u7406\u7684\u663e\u793a\u533a\u88ab\u914d\u7f6e\u4e3a\u5728\u542b\u6709\u901a\u914d\u7b26\u7684\u5730\u5740 ( X11UseLocalhost ) \u4e0a\u76d1\u542c # \u90a3\u4e48\u5c06\u53ef\u80fd\u6709\u989d\u5916\u7684\u4fe1\u606f\u88ab\u6cc4\u6f0f\u3002\u7531\u4e8e\u4f7f\u7528 X11 \u8f6c\u53d1\u7684\u53ef\u80fd\u5e26\u6765\u7684\u98ce\u9669\uff0c\u6b64\u6307\u4ee4\u9ed8\u8ba4\u503c\u4e3a \" no \" # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7981\u6b62 X11 \u8f6c\u53d1\u5e76\u4e0d\u80fd\u7981\u6b62\u7528\u6237\u8f6c\u53d1 X11 \u901a\u4fe1\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668 # \u5982\u679c\u542f\u7528\u4e86 UseLogin \uff0c\u90a3\u4e48 X11 \u8f6c\u53d1\u5c06\u88ab\u81ea\u52a8\u7981\u6b62 X11Forwarding yes # \u6307\u5b9a sshdX11 \u8f6c\u53d1\u7684\u7b2c\u4e00\u4e2a\u53ef\u7528\u7684\u663e\u793a\u533a ( display ) \u6570\u5b57\u3002\u9ed8\u8ba4\u503c\u662f 10 # \u8fd9\u4e2a\u53ef\u4ee5\u7528\u4e8e\u9632\u6b62 sshd \u5360\u7528\u4e86\u771f\u5b9e\u7684 X11 \u670d\u52a1\u5668\u663e\u793a\u533a\uff0c\u4ece\u800c\u53d1\u751f\u6df7\u6dc6 # X11DisplayOffset 10 # sshd \u662f\u5426\u5e94\u5f53\u5c06 X11 \u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730 loopback \u5730\u5740\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # sshd \u9ed8\u8ba4\u5c06\u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730 loopback \u5730\u5740\u5e76\u5c06 DISPLAY \u73af\u5883\u53d8\u91cf\u7684\u4e3b\u673a\u540d\u90e8\u5206\u8bbe\u4e3a \" localhost \" # \u8fd9\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230 proxy display \u3002\u4e0d\u8fc7\u67d0\u4e9b\u8001\u65e7\u7684 X11 \u5ba2\u6237\u7aef\u4e0d\u80fd\u5728\u6b64\u914d\u7f6e\u4e0b\u6b63\u5e38\u5de5\u4f5c # \u4e3a\u4e86\u517c\u5bb9\u8fd9\u4e9b\u8001\u65e7\u7684 X11 \u5ba2\u6237\u7aef\uff0c\u4f60\u53ef\u4ee5\u8bbe\u4e3a \" no \" # X11UseLocalhost yes # PermitTTY yes # \u6307\u5b9a sshd \u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370 / etc / motd \u6587\u4ef6\u7684\u5185\u5bb9\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" PrintMotd no # \u6307\u5b9a sshd \u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370\u6700\u540e\u4e00\u4f4d\u7528\u6237\u7684\u767b\u5f55\u65f6\u95f4\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # PrintLastLog yes # \u6307\u5b9a\u7cfb\u7edf\u662f\u5426\u5411\u5ba2\u6237\u7aef\u53d1\u9001 TCPkeepalive \u6d88\u606f\u3002\u9ed8\u8ba4 \" yes \" \u3002\u6d88\u606f\u53ef\u4ee5\u68c0\u6d4b\u5230\u6b7b\u8fde\u63a5\u3001\u8fde\u63a5\u4e0d\u5f53\u5173\u95ed\u3001\u5ba2\u6237\u7aef\u5d29\u6e83\u7b49\u5f02\u5e38\u3002\u53ef\u4ee5\u8bbe\u4e3a \" no \" \u5173\u95ed\u8fd9\u4e2a\u7279\u6027 # TCPKeepAlive yes # \u662f\u5426\u5728\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\u7684\u767b\u5f55\u8fc7\u7a0b\u4e2d\u4f7f\u7528 login ( 1 ) \u3002\u9ed8\u8ba4\u503c\u662f \" no \" # \u5982\u679c\u5f00\u542f\u6b64\u6307\u4ee4\uff0c\u90a3\u4e48 X11Forwarding \u5c06\u4f1a\u88ab\u7981\u6b62\uff0c\u56e0\u4e3a login ( 1 ) \u4e0d\u77e5\u9053\u5982\u4f55\u5904\u7406 xauth ( 1 ) cookies # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c login ( 1 ) \u662f\u7981\u6b62\u7528\u4e8e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u7684 # \u5982\u679c\u6307\u5b9a\u4e86 UsePrivilegeSeparation \uff0c\u90a3\u4e48\u5b83\u5c06\u5728\u8ba4\u8bc1\u5b8c\u6210\u540e\u88ab\u7981\u7528 # UseLogin no # \u662f\u5426\u8ba9 sshd \u901a\u8fc7\u521b\u5efa\u975e\u7279\u6743\u5b50\u8fdb\u7a0b\u5904\u7406\u63a5\u5165\u8bf7\u6c42\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u6743\u9650\u5206\u79bb\u3002\u9ed8\u8ba4\u503c\u662f \" yes \" # \u8ba4\u8bc1\u6210\u529f\u540e\uff0c\u5c06\u4ee5\u8be5\u8ba4\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u521b\u5efa\u53e6\u4e00\u4e2a\u5b50\u8fdb\u7a0b,\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u901a\u8fc7\u6709\u7f3a\u9677\u7684\u5b50\u8fdb\u7a0b\u63d0\u5347\u6743\u9650\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u66f4\u52a0\u5b89\u5168 # UsePrivilegeSeparation sandbox # \u6307\u5b9a\u662f\u5426\u5141\u8bb8 sshd ( 8 ) \u5904\u7406 ~/ . ssh / environment \u4ee5\u53ca ~/ . ssh / authorized_keys \u4e2d\u7684 environment = \u9009\u9879 # \u9ed8\u8ba4\u503c\u662f \" no \" \u3002\u5982\u679c\u8bbe\u4e3a \" yes \" \u53ef\u80fd\u4f1a\u5bfc\u81f4\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u67d0\u4e9b\u673a\u5236 ( \u6bd4\u5982 LD_PRELOAD ) \u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\uff0c\u9020\u6210\u5b89\u5168\u6f0f\u6d1e # PermitUserEnvironment no # \u662f\u5426\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u8fd8\u662f\u5ef6\u8fdf\u5230\u8ba4\u8bc1\u6210\u529f\u4e4b\u540e\u518d\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29 # \u53ef\u7528\u503c\uff1a \" yes \" , \" delayed \" ( \u9ed8\u8ba4 ) , \" no \" # Compression delayed ###################################################################################################################### # \u8bbe\u7f6e\u4e00\u4e2a\u4ee5\u79d2\u8bb0\u7684\u65f6\u957f\uff0c\u5982\u679c\u8d85\u8fc7\u8fd9\u4e48\u957f\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u6570\u636e\uff0c # sshd ( 8 ) \u5c06\u901a\u8fc7\u5b89\u5168\u901a\u9053\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a \" alive \" \u6d88\u606f\uff0c\u5e76\u7b49\u5019\u5e94\u7b54 # \u9ed8\u8ba4\u503c 0 \u8868\u793a\u4e0d\u53d1\u9001 \" alive \" \u6d88\u606f\u3002\u8fd9\u4e2a\u9009\u9879\u4ec5\u5bf9 SSH - 2 \u6709\u6548 # ClientAliveInterval 0 ###################################################################################################################### # sshd \u5728\u672a\u6536\u5230\u4efb\u4f55\u5ba2\u6237\u7aef\u56de\u5e94\u524d\u6700\u591a\u5141\u8bb8\u53d1\u9001\u591a\u5c11\u4e2a \" alive \" \u6d88\u606f\u3002\u9ed8\u8ba4\u503c\u662f 3 # \u5230\u8fbe\u8fd9\u4e2a\u4e0a\u9650\u540e\uff0c sshd ( 8 ) \u5c06\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3001\u5173\u95ed\u4f1a\u8bdd # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c \" alive \" \u6d88\u606f\u4e0e TCPKeepAlive \u6709\u5f88\u5927\u5dee\u5f02 # \" alive \" \u6d88\u606f\u662f\u901a\u8fc7\u52a0\u5bc6\u8fde\u63a5\u53d1\u9001\u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u88ab\u6b3a\u9a97\uff1b\u800c TCPKeepAlive \u5374\u662f\u53ef\u4ee5\u88ab\u6b3a\u9a97\u7684 # \u5982\u679c ClientAliveInterval \u88ab\u8bbe\u4e3a 15 \u5e76\u4e14\u5c06 ClientAliveCountMax \u4fdd\u6301\u4e3a\u9ed8\u8ba4\u503c\uff0c # \u90a3\u4e48\u65e0\u5e94\u7b54\u7684\u5ba2\u6237\u7aef\u5927\u7ea6\u4f1a\u5728 45 \u79d2\u540e\u88ab\u5f3a\u5236\u65ad\u5f00\u3002\u8fd9\u4e2a\u6307\u4ee4\u4ec5\u53ef\u4ee5\u7528\u4e8e SSH - 2 \u534f\u8bae # ClientAliveCountMax 3 ###################################################################################################################### # \u6307\u5b9a sshd \u662f\u5426\u5e94\u8be5\u5bf9\u8fdc\u7a0b\u4e3b\u673a\u540d\u8fdb\u884c\u53cd\u5411\u89e3\u6790\uff0c\u4ee5\u68c0\u67e5\u6b64\u4e3b\u673a\u540d\u662f\u5426\u4e0e\u5176 IP \u5730\u5740\u771f\u5b9e\u5bf9\u5e94\u3002\u9ed8\u8ba4\u503c\u4e3a \" yes \" # UseDNS no # \u6307\u5b9a\u5728\u54ea\u4e2a\u6587\u4ef6\u4e2d\u5b58\u653e SSH \u5b88\u62a4\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\uff0c\u9ed8\u8ba4\u4e3a / var / run / sshd . pid \u6587\u4ef6 # PidFile / var / run / sshd . pid # \u6700\u5927\u5141\u8bb8\u4fdd\u6301\u591a\u5c11\u4e2a\u672a\u8ba4\u8bc1\u7684\u8fde\u63a5\u3002\u9ed8\u8ba4\u503c\u662f 10 # \u5230\u8fbe\u9650\u5236\u540e\uff0c\u5c06\u4e0d\u518d\u63a5\u53d7\u65b0\u8fde\u63a5\uff0c\u9664\u975e\u5148\u524d\u7684\u8fde\u63a5\u8ba4\u8bc1\u6210\u529f\u6216\u8d85\u51fa LoginGraceTime \u7684\u9650\u5236 # MaxStartups 10 : 30 : 100 # \u662f\u5426\u5141\u8bb8 tun ( 4 ) \u8bbe\u5907\u8f6c\u53d1\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a # \" yes \" , \" point-to-point \" ( layer 3 ) , \" ethernet \" ( layer 2 ) , \" no \" ( \u9ed8\u8ba4 ) # \" yes \" \u540c\u65f6\u8574\u542b\u7740 \" point-to-point \" \u548c \" ethernet \" # PermitTunnel no # ChrootDirectory none # VersionAddendum none # \u8fd9\u4e2a\u7279\u6027\u4ec5\u80fd\u7528\u4e8e SSH - 2 \uff0c\u9ed8\u8ba4\u4ec0\u4e48\u5185\u5bb9\u4e5f\u4e0d\u663e\u793a\u3002 \" none \" \u8868\u793a\u7981\u7528\u8fd9\u4e2a\u7279\u6027 # no default banner path # Banner none ###################################################################################################################### # AcceptEnv # \u6307\u5b9a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u54ea\u4e9b\u73af\u5883\u53d8\u91cf\u5c06\u4f1a\u88ab\u4f20\u9012\u5230\u4f1a\u8bdd\u73af\u5883\u4e2d\u3002[\u6ce8\u610f]\u53ea\u6709 SSH - 2 \u534f\u8bae\u652f\u6301\u73af\u5883\u53d8\u91cf\u7684\u4f20\u9012 # \u7ec6\u8282\u53ef\u4ee5\u53c2\u8003 / etc / ssh / ssh_config \u4e2d\u7684 SendEnv \u914d\u7f6e\u6307\u4ee4 # \u6307\u4ee4\u7684\u503c\u662f\u7a7a\u683c\u5206\u9694\u7684\u53d8\u91cf\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 ' * ' \u548c ' ? ' \u4f5c\u4e3a\u901a\u914d\u7b26 ) \u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a AcceptEnv \u8fbe\u5230\u540c\u6837\u7684\u76ee\u7684 # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4f1a\u88ab\u7528\u4e8e\u7ed5\u8fc7\u7981\u6b62\u7528\u6237\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002\u7531\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u8be5\u6307\u4ee4\u5e94\u5f53\u5c0f\u5fc3\u4f7f\u7528 # \u9ed8\u8ba4\u662f\u4e0d\u4f20\u9012\u4efb\u4f55\u73af\u5883\u53d8\u91cf # Allow client to pass locale environment variables AcceptEnv LANG LC_ * ###################################################################################################################### # \u7cfb\u7edf\u5185\u5f00\u542f ssh \u670d\u52a1\u548c sftp \u670d\u52a1\u90fd\u662f\u901a\u8fc7 / usr / sbin / sshd \u8fd9\u4e2a\u540e\u53f0\u7a0b\u5e8f\u76d1\u542c 22 \u7aef\u53e3\uff0c\u800c sftp \u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u5b50\u670d\u52a1\uff0c\u662f\u901a\u8fc7 / etc / ssh / sshd_config \u914d\u7f6e # \u6587\u4ef6\u4e2d\u7684 Subsystem \u5b9e\u73b0\u7684\uff0c\u5982\u679c\u6ca1\u6709\u914d\u7f6e Subsystem \u53c2\u6570\uff0c\u5219\u7cfb\u7edf\u662f\u4e0d\u80fd sftp \u8bbf\u95ee\u7684 # override default of no subsystems Subsystem sftp / usr / lib / openssh / sftp - server # AllowGroups # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7ec4 # \u8fd9\u91cc\u7684 \" \u7ec4 \" \u662f\u6307 \" \u4e3b\u7ec4 \" ( primary group ) \uff0c\u4e5f\u5c31\u662f / etc / passwd \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 GID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # AllowGroups < \u7ec4\u540d 1 > < \u7ec4\u540d 2 > < \u7ec4\u540d 3 > .. ##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00\u3002\u5f53\u591a\u4e2a\u7528\u6237\u9700\u8981\u901a\u8fc7 ssh \u767b\u5f55\u7cfb\u7edf\u65f6\uff0c\u53ef\u5c06\u6240\u6709\u7528\u6237\u52a0\u5165\u4e00\u4e2a\u7ec4\u4e2d # DenyGroups # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u5c06\u88ab\u62d2\u7edd\u767b\u5f55 # \u8fd9\u91cc\u7684 \" \u7ec4 \" \u662f\u6307 \" \u4e3b\u7ec4 \" ( primary group ) \uff0c\u4e5f\u5c31\u662f / etc / passwd \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 GID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # DenyGroups < \u7ec4\u540d 1 > < \u7ec4\u540d 2 > < \u7ec4\u540d 3 > .. ##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00 ###################################################################################################################### # AllowUsers # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7528\u6237\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7528\u6237 # \u5982\u679c\u6307\u5b9a\u4e86 USER @ HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5\u3002# override default of no subsystems # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 UID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a Subsystem sftp / usr / lib / openssh / sftp - server # DenyUsers , AllowUsers , DenyGroups , AllowGroups # AllowUsers < \u7528\u6237\u540d 1 > < \u7528\u6237\u540d 2 > < \u7528\u6237\u540d 3 > .. ##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00 # DenyUsers # \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868 ( \u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528 \" * \" \u548c \" ? \" \u901a\u914d\u7b26 ) \u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55 # \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7528\u6237\u5c06\u88ab\u62d2\u7edd\u767b\u5f55 # \u5982\u679c\u6307\u5b9a\u4e86 USER @ HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5 # \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528 UID \u3002\u76f8\u5173\u7684 allow / deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a # DenyUsers , AllowUsers , DenyGroups , AllowGroups # DenyUsers < \u7528\u6237\u540d 1 > < \u7528\u6237\u540d 2 > < \u7528\u6237\u540d 3 > .. ##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00 ###################################################################################################################### # Match # \u5f15\u5165\u4e00\u4e2a\u6761\u4ef6\u5757\u3002\u5757\u7684\u7ed3\u5c3e\u6807\u5fd7\u662f\u53e6\u4e00\u4e2a Match \u6307\u4ee4\u6216\u8005\u6587\u4ef6\u7ed3\u5c3e # \u5982\u679c Match \u884c\u4e0a\u6307\u5b9a\u7684\u6761\u4ef6\u90fd\u6ee1\u8db3\uff0c\u90a3\u4e48\u968f\u540e\u7684\u6307\u4ee4\u5c06\u8986\u76d6\u5168\u5c40\u914d\u7f6e\u4e2d\u7684\u6307\u4ee4 # Match \u7684\u503c\u662f\u4e00\u4e2a\u6216\u591a\u4e2a \" \u6761\u4ef6-\u6a21\u5f0f \" \u5bf9\u3002\u53ef\u7528\u7684 \" \u6761\u4ef6 \" \u662f\uff1a User , Group , Host , Address # \u53ea\u6709\u4e0b\u5217\u6307\u4ee4\u53ef\u4ee5\u5728 Match \u5757\u4e2d\u4f7f\u7528\uff1a AllowTcpForwarding , Banner , # ForceCommand , GatewayPorts , GSSApiAuthentication , # KbdInteractiveAuthentication , KerberosAuthentication , # PasswordAuthentication , PermitOpen , PermitRootLogin , # RhostsRSAAuthentication , RSAAuthentication , X11DisplayOffset , # X11Forwarding , X11UseLocalHost # \u6307\u5b9a TCP \u7aef\u53e3\u8f6c\u53d1\u5141\u8bb8\u7684\u76ee\u7684\u5730\uff0c\u53ef\u4ee5\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u591a\u4e2a\u8f6c\u53d1\u76ee\u6807\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u8f6c\u53d1\u8bf7\u6c42 # \u5408\u6cd5\u7684\u6307\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a # PermitOpen host : port # PermitOpen IPv4_addr : port # PermitOpen [ IPv6_addr ]: port # \" any \" \u53ef\u4ee5\u7528\u4e8e\u79fb\u9664\u6240\u6709\u9650\u5236\u5e76\u5141\u8bb8\u4e00\u5207\u8f6c\u53d1\u8bf7\u6c42 # Example of overriding settings on a per - user basis # Match User anoncvs # X11Forwarding no # AllowTcpForwarding no # PermitTTY no # ForceCommand cvs server # ForceCommand # \u5f3a\u5236\u6267\u884c\u8fd9\u91cc\u6307\u5b9a\u7684\u547d\u4ee4\u800c\u5ffd\u7565\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4efb\u4f55\u547d\u4ee4\u3002\u8fd9\u4e2a\u547d\u4ee4\u5c06\u4f7f\u7528\u7528\u6237\u7684\u767b\u5f55 shell \u6267\u884c ( shell - c ) # \u8fd9\u53ef\u4ee5\u5e94\u7528\u4e8e shell \u3001\u547d\u4ee4\u3001\u5b50\u7cfb\u7edf\u7684\u5b8c\u6210\uff0c\u901a\u5e38\u7528\u4e8e Match \u5757\u4e2d # \u8fd9\u4e2a\u547d\u4ee4\u6700\u521d\u662f\u5728\u5ba2\u6237\u7aef\u901a\u8fc7 SSH_ORIGINAL_COMMAND \u73af\u5883\u53d8\u91cf\u6765\u652f\u6301\u7684 PermitRootLogin yes # \u6307\u5b9a sshd \u5b88\u62a4\u8fdb\u7a0b\u76d1\u542c\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u4e3a 22 \u3002\u53ef\u4ee5\u4f7f\u7528\u591a\u6761\u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u7aef\u53e3 # \u9ed8\u8ba4\u5c06\u5728\u672c\u673a\u7684\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4e0a\u76d1\u542c\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7 ListenAddress \u6307\u5b9a\u53ea\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u63a5\u53e3\u4e0a\u76d1\u542c Port 22","title":"sshd_config\u914d\u7f6e\u8be6\u89e3\uff08/etc/ssh/sshd_config\uff09"},{"location":"Linux/#ssh_2","text":"SSH\u7aef\u53e3\u8f6c\u53d1\u5c06\u5176\u4ed6TCP\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e\u901a\u8fc7SSH\u94fe\u8def\u8f6c\u53d1\uff0c\u5e76\u81ea\u52a8\u52a0\u5bc6\u548c\u89e3\u5bc6","title":"SSH\u7aef\u53e3\u8f6c\u53d1"},{"location":"Linux/#_5","text":"# \u547d\u4ee4\u683c\u5f0f\uff1a ssh - L < local port > : < remote host > : < remote port > < SSH hostname > # \u5b9e\u4f8b\uff1a\u4e00\u53f0 LDAP server \uff0c\u4f46\u9650\u5236\u8fdc\u7a0b\u673a\u5668\u8fde\u63a5\uff0c\u6b64\u65f6\u5229\u7528 ssh\u7aef\u53e3\u8f6c\u53d1\u5b9e\u73b0\u4ece\u8fdc\u7a0b\u673a\u5668\u6d4b\u8bd5server\u7684\u76ee\u7684 ( \u8fd9\u91cc\u7684\u8fdc\u7a0b\u673a\u5668\u662f\u76f8\u5bf9\u4e8e server\u6765\u8bb2\u7684 ) # LDAP client\u6267\u884c\u6b64\u547d\u4ee4\u5efa\u7acbssh\u672c\u5730\u7aef\u53e3\u8f6c\u53d1 \uff0c\u5b9e\u73b0\u901a\u8fc7 ssh\u96a7\u9053\u4ece\u672c\u57307001\u7aef\u53e3\u8fde\u63a5\u8fdc\u7aef\u7684389\u7aef\u53e3 ssh - L 7001 : localhost : 389 LDAPServer # SSH \u540c\u65f6\u63d0\u4f9b\u4e86 GatewayPorts \u5173\u952e\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u5b83\u4e0e\u5176\u4ed6\u673a\u5668\u5171\u4eab\u8fd9\u4e2a\u672c\u5730\u7aef\u53e3\u8f6c\u53d1 ssh - g - L < local port > : < remote host > : < remote port > < SSH hostname > ...................... ||| ......................... ...... LDAP Client ..... ||| ...... LDAP Server ........ ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ ... Local Port 7001 .... ||| ....... LDAP Port 389 ..... ........ \u2198 ............. ||| .............. \u2197 .......... ..... SSH Clinet ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ..... ................... SSH tunnel ..................... .................................................. # \u672c\u5730\u670d\u52a1\u5668 LDAP Client\u82e5\u63d0\u793a\u65e0\u6cd5\u89e3\u6790hostname LDAPServer , \u5219\u5728 / etc / hosts\u6587\u4ef6\u6dfb\u52a0localhost LDAPServer\u5373\u53ef # \u5728\u9009\u62e9\u7aef\u53e3\u53f7\u65f6\u8981\u6ce8\u610f\u975e\u7ba1\u7406\u5458\u5e10\u53f7\u662f\u65e0\u6743\u7ed1\u5b9a 1 - 1023 \u7aef\u53e3\u7684\uff0c\u6240\u4ee5\u4e00\u822c\u662f\u9009\u7528\u4e00\u4e2a 1024 - 65535 \u4e4b\u95f4\u7684\u5e76\u4e14\u5c1a\u672a\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u5373\u53ef # \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u673a\u5668\uff08 LDAP Client \uff09\u4e0a\u7684\u5e94\u7528\u76f4\u63a5\u914d\u7f6e\u5230\u672c\u673a\u7684 7001 \u7aef\u53e3\u4e0a\uff08\u800c\u4e0d\u662f LDAP \u670d\u52a1\u5668\u7684 389 \u7aef\u53e3\u4e0a\uff09","title":"\u672c\u5730\u8f6c\u53d1\u5b9e\u4f8b"},{"location":"Linux/#_6","text":"\u5047\u8bbe\u7531\u4e8e\u7f51\u7edc\u6216\u9632\u706b\u5899\u7684\u539f\u56e0\u6211\u4eec\u4e0d\u80fd\u7528 SSH\u76f4\u63a5\u4eceLDAP Client Host\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668 \uff08 Ldap Server Host \uff09\uff0c\u4f46\u662f\u53cd\u5411\u8fde\u63a5\u5374\u662f\u88ab\u5141\u8bb8\u7684 , \u6b64\u65f6\u6211\u4eec\u7684\u9009\u62e9\u81ea\u7136\u5c31\u662f\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u4e86 # \u547d\u4ee4\u683c\u5f0f\uff1a ssh - R < local port > : < remote host > : < remote port > < SSH hostname > # \u5728 LDAP\u670d\u52a1\u5668 \uff08 LdapServertHost \uff09\u7aef\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a ssh - R 7001 : localhost : 389 LdapClientHost ...................... ||| ......................... ...... LDAP Client ..... ||| ...... LDAP Server ........ ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ ... Local Port 7001 .... ||| ....... LDAP Port 389 ..... ........ \u2198 ............. ||| .............. \u2197 .......... ..... SSH Server ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Client ..... ................... SSH tunnel ..................... ..................................................","title":"\u8fdc\u7a0b\u8f6c\u53d1\u5b9e\u4f8b"},{"location":"Linux/#_7","text":"# \u672c\u5730\u8f6c\u53d1\u547d\u4ee4\u4e2d\u7684<remote host>\u548c<SSH hostname>\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\u673a\u5668 ssh - L < local port >:< remote host >:< remote port > < SSH hostname > # \u770b\u4e00\u4e2a\u6d89\u53ca\u5230\u56db\u53f0\u673a\u5668 (A,B,C,D) \u7684\u4f8b\u5b50,\u5728 SSH Client(C) \u6267\u884c\u4e0b\u5217\u547d\u4ee4\u6765\u5efa\u7acb SSH \u8fde\u63a5\u4ee5\u53ca\u7aef\u53e3\u8f6c\u53d1\uff1a ssh - g - L 7001 :< B >: 389 < D > \u7136\u540e\u5e94\u7528\u5ba2\u6237\u7aef\uff08 A \uff09\u4e0a\u914d\u7f6e\u8fde\u63a5\u673a\u5668\uff08 C \uff09\u7684 7001 \u7aef\u53e3\u5373\u53ef , \u5728\u4e0a\u8ff0\u8fde\u63a5\u4e2d\uff0c\uff08 A \uff09 <-> ( C ) \u4ee5\u53ca ( B ) <-> ( D ) \u4e4b\u95f4\u7684\u8fde\u63a5\u5e76\u4e0d\u662f\u5b89\u5168\u8fde\u63a5\uff0c \u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u7ecf\u8fc7 SSH \u7684\u52a0\u5bc6\u53ca\u89e3\u5bc6 ........................................................................................ ...................................... ||| ............................................... ...................................... ||| ............................................... ............. #############............|||............................................... ............. #############............|||............................................... .............LDAP Clinet ( A ) ........... ||| ...........LADP Server ( B ) ...................... ............. #############............|||............................................... ............. #############............|||..........#################.................... ............. @@@@@@@@@@@@@ ............ ||| .......... ##@@@@@@#########.................... ........... #################..........|||..........#################.................... ........... #################..........|||..........#################.................... ..............LDAP App................ ||| .............LDAP Port 389 ..................... .................. \u2191 ................... ||| ................... \u2191 ........................... .................. \u2193 ................... ||| ................... \u2193 ........................... ..............SSH Client ( C ) ........... ||| ..............SSH Server ( D ) .................... ........... @@@@@@@@@@@@@@@@@ .......... ||| ............ @@@@@@@@@@@@@@@@@ .................. ........... #################..........|||............#################.................. ........... #################..........|||............#################.................. ............Local Port 7001 ........... ||| ............................................... ..............SSH Client... \u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592 ...SSH Server........................ ....................................SSH tunnel.......................................... ........................................................................................","title":"\u591a\u4e3b\u673a\u8f6c\u53d1\u5e94\u7528\u5b9e\u4f8b"},{"location":"Linux/#_8","text":"# \u5f53\u6211\u4eec\u5728\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684 WiFi \u73af\u5883\u4e0b\u4e0a\u7f51\uff0c\u7528 SSH \u52a8\u6001\u8f6c\u53d1\u6765\u4fdd\u62a4\u6211\u4eec\u7684\u7f51\u9875\u6d4f\u89c8\u53ca MSN \u4fe1\u606f\u65e0\u7591\u662f\u5341\u5206\u5fc5\u8981\u7684\u3002\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2a socks\u4ee3\u7406\u670d\u52a1 # \u547d\u4ee4\u683c\u5f0f\uff1a ssh - D < local port > < SSH Server > \u6b64\u65f6\u76f4\u63a5\u4f7f\u7528 localhost : 7001 \u6765\u4f5c\u4e3a\u6b63\u5e38\u7684 SOCKS \u4ee3\u7406\u6765\u4f7f\u7528 , SSH \u6240\u5305\u62a4\u7684\u8303\u56f4\u53ea\u5305\u62ec\u4ece\u6d4f\u89c8\u5668\u7aef\uff08 SSH Client \u7aef\uff09\u5230 SSH Server \u7aef\u7684\u8fde\u63a5\uff0c \u5e76\u4e0d\u5305\u542b\u4ece SSH Server \u7aef \u5230\u76ee\u6807\u7f51\u7ad9\u7684\u8fde\u63a5\u3002\u5982\u679c\u540e\u534a\u622a\u8fde\u63a5\u7684\u5b89\u5168\u4e0d\u80fd\u5f97\u5230\u5145\u5206\u7684\u4fdd\u8bc1\u7684\u8bdd\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u4e0d\u662f\u5408\u9002\u7684\u89e3\u51b3\u65b9\u6848 ........................................................................................... ..................................... ||| ................................................... ..................................... ||| ................................................... ........... Brower \u3001 MSN Client ........ ||| ....... ________________________________ ............ ............ @############@ ........... ||| ....... | :::::::::::::::::::::::::::::: | ............ ............ @############@ ........... ||| ....... | :::::::: WEB Site , MSN ...::::::: | ............ ............ @############@ ........... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... | :::::::::::::::::::::::::::::: | ............ .......... @################@ ......... ||| ....... --------------------------------............ .............. Port 7001 .............. ||| ............. Dynamic Port ( \u52a8\u6001\u7aef\u53e3 )................. .............. SSH Clinet .... \u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ........................... ................................... SSH tunnel .............................................. ..................................... ||| ................................................... ..................................... ||| ................................................... ...........................................................................................","title":"\u52a8\u6001\u8f6c\u53d1\u5b9e\u4f8b"},{"location":"Linux/#x","text":"# \u53ef\u7528\u4f5c\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\uff0c\u88ab\u8fdc\u7a0b\u7aef\u662f Windows\u53ef\u5b89\u88c5xming\u4f5c\u4e3axserver \u3002 ssh client\u53ef\u4ee5\u9009\u62e9putty\u914d\u7f6essh\u8bbf\u95ee\u5e76\u5efa\u7acbx - forward \uff08\u8f6c\u53d1\uff09 \u5728 X Server\u7aef\u6267\u884c\u4e00\u4e0b\u547d\u4ee4 \uff0c\u53d1\u8d77\u4e00\u4e2a SSH\u8fde\u63a5 \u3002\u7136\u540e\u5728 X Client\u7aef\u8fd0\u884c\u8fdc\u7a0bX\u684c\u9762\u8fde\u63a5\u5ba2\u6237\u7aef ssh - X < SSH Server > .................................................. ...... X Server ........ ||| ...... X Clinet ........... ...................... ||| ......................... ....... ######## ....... ||| ......................... ....... ######## ....... ||| ..... ############ ........ ....... ######## ....... ||| ..... ############ ........ ...... @@@@@@@@@@ ...... ||| ..... #@@@@####### ........ ..... ############ ..... ||| ..... ############ ........ ..... ############ ..... ||| ..... ############ ........ .......... \u2191 ........... ||| .. DISPLAY = locahost : 10 . 1 .. .......... \u2193 ........... ||| .............. \u2193 .......... ..... SSH Client ... \u2592\u2592\u2592\u2592\u2592\u2592\u2592 ..... SSH Server ..... ................... SSH tunnel ..................... ..................................................","title":"X\u534f\u8bae\u8f6c\u53d1\u5b9e\u4f8b"},{"location":"Linux/#esnet","text":"\u7f51\u7edc\u6545\u969c\u6392\u67e5\u53c2\u8003 ## \u5173\u4e8e\u8d85\u5927\u578b\u6570\u636e\u96c6\u4f20\u8f93\u95ee\u9898 ( \u5f15\u7528 es . net ) \u5728 Unix \u73af\u5883\u4e2d\uff0c scp \uff0c sftp \u548c rsync \u901a\u5e38\u7528\u4e8e\u5728\u4e3b\u673a\u4e4b\u95f4\u590d\u5236\u6570\u636e\u3002\u867d\u7136\u8fd9\u4e9b\u5de5\u5177\u5728\u672c\u5730\u73af\u5883\u4e2d\u8fd0\u884c\u826f\u597d\uff0c\u4f46\u5b83\u4eec\u5728 WAN \u4e0a\u7684\u6027\u80fd\u5f88\u5dee\u3002 scp \u548c sftp \u7684 openssh \u7248\u672c\u5177\u6709\u5185\u7f6e\u7684 1 MB \u7f13\u51b2\u533a\uff0c\u4e25\u91cd\u9650\u5236\u4e86 WAN \u4e0a\u7684\u6027\u80fd\u3002\u5c3d\u7ba1 rsync \u4e0d\u662f openssh \u53d1\u884c\u7248\u7684\u4e00\u90e8\u5206\uff0c\u4f46 rsync \u901a\u5e38\u4f7f\u7528 ssh \u4f5c\u4e3a\u4f20\u8f93\uff0c\u56e0\u6b64 \u53d7\u5230\u5e95\u5c42 ssh \u5b9e\u73b0\u6240\u65bd\u52a0\u7684\u9650\u5236\u3002 \u5982\u679c\u60a8\u9700\u8981\u5728 RTT \u8d85\u8fc7 20 \u6beb\u79d2\u7684\u7f51\u7edc\u8def\u5f84\u4e0a\u4f20\u8f93\u5927\u578b\u6570\u636e\u96c6\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177 \u5339\u5179\u5821\u8d85\u7ea7\u8ba1\u7b97\u673a\u4e2d\u5fc3\u63d0\u4f9b\u4e86\u89e3\u51b3 scp \u548c sftp \u5173\u4e8e\u8fd9\u4e2a\u95ee\u9898\u7684\u8865\u4e01\uff1a HPN - SSH \uff1a https : // www . psc . edu / hpn - ssh # \u6839\u636e es net \u5b98\u7f51 TCP \u6ce8\u610f\u4e8b\u9879 \u6ce8\u610f\uff1a\u5e94\u8be5\u5355\u72ec\u4f7f\u7528 net . tcp_mem \uff0c\u56e0\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u6ca1\u95ee\u9898\u3002\u4e00\u4e9b\u6027\u80fd\u4e13\u5bb6\u8bf4\uff0c\u8fd8\u8981\u589e\u52a0 net . core . optmem_max \u4ee5\u5339\u914d net . core . rmem_max \u548c net . core . wmem_max \uff0c\u4f46\u6211\u4eec\u6ca1\u6709\u53d1\u73b0\u8fd9\u6709\u4efb\u4f55\u533a\u522b\u3002\u4e00\u4e9b\u4e13\u5bb6\u8fd8\u8bf4\u5c06 net . ipv4 . tcp_timestamps \u548c net . ipv4 . tcp_sack \u8bbe\u7f6e\u4e3a 0 \uff0c \u8fd9\u6837\u505a\u53ef\u4ee5\u51cf\u5c11 CPU \u8d1f\u8f7d\uff0c\u4f46\u9ed8\u8ba4\u503c\u662f 1 \u5bf9\u4e8e\u6027\u80fd\u5176\u5b9e\u66f4\u6709\u5e2e\u52a9 \u5bf9\u4e8e\u8f83\u65e7\u7684\u64cd\u4f5c\u7cfb\uff08\u4f8b\u5982 CentOS5 / 6 \uff09\uff0c\u589e\u52a0 net . core . netdev_max_backlog \u503c\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd # UDP \u8c03\u6574 1 . \u4f7f\u7528 jumbo frames \u5728 9 k MTUs \u4e0b\u53ef\u4ee5\u4f7f\u6027\u80fd\u63d0\u9ad8 4 - 5 \u500d 2 . \u6570\u636e\u5305\u5927\u5c0f\uff1a\u6700\u597d\u7684\u6027\u80fd\u662f MTU \u5927\u5c0f\u51cf\u53bb\u6570\u636e\u5305\u5934\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a 9000 Byte MTU \uff0c ipv4 \u662f 8972 \uff0c ipv6 \u662f 8952 3 . socket \u7f13\u5b58\u5927\u5c0f\uff1a\u5bf9\u4e8e UDP \uff0c\u7f13\u51b2\u533a\u5927\u5c0f\u4e0e TCP \u7684\u65b9\u5f0f\u65e0\u5173\uff0c\u4f46\u9ed8\u8ba4\u503c\u4ecd\u7136\u4e0d\u591f\u5927\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5c06\u5957\u63a5\u5b57\u7f13\u51b2\u533a\u8bbe\u7f6e\u4e3a 4 M \u4f3c\u4e4e\u6709\u5f88\u5927\u5e2e\u52a9 4 . CPU \u9009\u62e9\uff1a 10 G \u7684 UDP \u901a\u5e38\u662f CPU \u9650\u5236\uff0c\u56e0\u6b64\u9700\u8981\u8003\u8651\u5185\u6838\uff0c\u5c24\u5176\u5728 Sandy \u6216 lvy Bridge \u4e3b\u677f # \u865a\u62df\u673a\u8c03\u6574 ## XEN \u3001 KVM \u7c7b\u578b \u8981\u5c06\u6240\u6709\u7684\u4e3b\u673a\u5904\u7406\u5668\u529f\u80fd\u4f20\u9012\u7ed9 guest \u865a\u62df\u673a\u6267\u884c qemu - cpu host \u5982\u679c\u5e0c\u671b\u4fdd\u7559\u517c\u5bb9\u6027\uff0c\u5219\u53ef\u4ee5\u5411 guest \u865a\u62df\u673a\u516c\u5f00\u6240\u9009\u529f\u80fd\u3002\u5982\u679c\u6240\u6709\u4e3b\u673a\u90fd\u5177\u6709\u8fd9\u4e9b\u529f\u80fd\uff0c\u5219\u4f1a\u4fdd\u7559\u517c\u5bb9\u6027 qemu - cpu qemu64 , + ssse3 , + sse4 . 1 , + sse4 . 2 , + x2apic \u8981\u67e5\u770b\u4e3b\u673a CPU \u4e0e guest \u865a\u62df\u673a\u529f\u80fd\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u53ea\u9700\u6bd4\u8f83\u6bcf\u4e2a\u7cfb\u7edf\u4e0a\u4ee5\u4e0b\u547d\u4ee4\u7684\u8f93\u51fa grep flags / proc / cpuinfo | uniq qemu \u9ed8\u8ba4\u4f7f\u7528\u7528\u6237\u6a21\u5f0f\u7f51\u7edc ( slirp ) \uff0c\u65e0\u9700\u4e8b\u5148\u5b89\u88c5\u5373\u53ef\u5728\u4e3b\u673a\u4f7f\u7528\u7ba1\u7406\u6743\u9650\uff0c\u4f46\u662f\u5f88\u6162\uff0c\u83b7\u5f97\u9ad8\u6027\u80fd\u53ef\u901a\u8fc7 - net tap \u547d\u4ee4\u884c\u5f00\u5173\u5207\u6362\u5230\u6865\u63a5\u6a21\u5f0f qemu - net nic , model = virtio , mac = ... - net tap , ifname = ... \u6216 qemu - net nic , model = virtio , mac = ... - net bridge , br = ..., helper =/ usr / local / libexec / qemu - bridge - helper \u9664\u4e86 virtio \u4e4b\u5916\uff0c vt - d passthrough \u65b9\u6cd5\u53ef\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd qemu - net none - device vfio - pci , host = ... QEMU \u652f\u6301\u5404\u79cd\u5b58\u50a8\u683c\u5f0f\u548c\u540e\u7aef\u3002\u6700\u5bb9\u6613\u4f7f\u7528\u7684\u662f raw \u548c qcow2 \u683c\u5f0f\uff0c\u4f46\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u6700\u597d\u4f7f\u7528\u539f\u59cb\u5206\u533a\u3002\u521b\u5efa\u903b\u8f91\u5377\u6216\u5206\u533a\u5e76\u5c06\u5176\u5206\u914d\u7ed9 guest \u865a\u62df\u673a\uff1a qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio QEMU \u8fd8\u652f\u6301\u5404\u79cd\u7f13\u5b58\u6a21\u5f0f\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u539f\u59cb\u5377\u6216\u5206\u533a\uff0c\u6700\u597d\u5b8c\u5168\u907f\u514d\u7f13\u5b58\uff0c\u8fd9\u4f1a\u51cf\u5c11\u6570\u636e\u526f\u672c\u548c\u603b\u7ebf\u6d41\u91cf qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio \u4e0e\u7f51\u7edc\u4e00\u6837\uff0c QEMU \u652f\u6301\u591a\u79cd\u5b58\u50a8\u63a5\u53e3\u3002\u9ed8\u8ba4\u503c IDE \u53d7\u5230\u6765\u5bbe\u7684\u9ad8\u5ea6\u652f\u6301\uff0c\u4f46\u53ef\u80fd\u5f88\u6162\uff0c\u5c24\u5176\u662f\u78c1\u76d8\u9635\u5217\u3002\u5982\u679c\u60a8\u7684 guest \u865a\u62df\u673a\u652f\u6301\u5b83\uff0c\u8bf7\u4f7f\u7528 virtio \u63a5\u53e3 \u4e0d\u8981\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528 linux \u6587\u4ef6\u7cfb\u7edf btrfs \u6765\u83b7\u53d6\u56fe\u50cf\u6587\u4ef6\u3002\u8fd9\u5c06\u5bfc\u81f4\u4f4e IO \u6027\u80fd\u3002\u5f53\u5ba2\u6237\u7aef\u8fdb\u884c\u9ad8 IO \u6d41\u91cf\u65f6\uff0c kvm guest \u865a\u62df\u673a\u751a\u81f3\u53ef\u80fd\u4f1a\u51bb\u7ed3 qemu - drive file =/ dev / mapper / ImagesVolumeGroup - Guest1 , cache = none , if = virtio ## VMware \u7c7b\u578b [ VMware \u517c\u5bb9\u6027\u6307\u5357] ( http : // www . vmware . com / resources / compatibility / search . php )","title":"\u4e3b\u673a\u8c03\u6574 [es.net]"},{"location":"Linux/#_9","text":"\u4fee\u6539\u5185\u6838\u53c2\u6570\u65b9\u6cd5: echo\u8ffd\u52a0\u5230\u6587\u4ef6\u91cc\u5982\uff1aecho \"1\" >/proc/sys/net/ipv4/tcp_syn_retries\uff0c\u6216\u4f7f\u7528sysctl -w\u547d\u4ee4\uff0c\u4f46\u91cd\u542f\u540e\u5931\u6548,\u628a\u53c2\u6570\u6dfb\u52a0\u5230 /etc/sysctl.conf\u4e2d\uff0c\u7136\u540e\u6267\u884csysctl -p\u4f7f\u53c2\u6570\u751f\u6548\uff0c\u6c38\u4e45\u751f\u6548\u3002\u5185\u6838\u751f\u4ea7\u73af\u5883\u5e38\u7528\u4f18\u5316\u53c2\u6570\u53c2\u8003\uff0c\u5177\u4f53\u4f18\u5316\u503c\u8981\u53c2\u8003\u5e94\u7528\u573a\u666f\u548c\u8bbe\u5907 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / kernel / # \u5f00\u542f execshild ,\u5373\u5185\u5b58\u7f13\u51b2\u533a\u6ea2\u51fa\u4fdd\u62a4 kernel . exec - shield = 1 kernel . randomize_va_space = 1 kernel . sysrq = 0 # \u63a7\u5236\u5185\u6838\u7684\u7cfb\u7edf\u8bf7\u6c42\u8c03\u8bd5\u529f\u80fd\uff0c\u4e3a\u5b89\u5168\u8d77\u89c1\u8bbe\u4e3a 0 \u5173\u95ed kernel . core_uses_pid = 1 # \u63a7\u5236\u6838\u5fc3\u8f6c\u50a8\u662f\u5426\u5c06 PID \u9644\u52a0\u5230\u6838\u5fc3\u6587\u4ef6\u540d,\u7528\u4e8e\u8c03\u8bd5\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\u3002 kernel . msgmnb = 65536 # \u6bcf\u4e2a\u6d88\u606f\u961f\u5217\u7684\u5927\u5c0f\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\u9650\u5236 kernel . msgmax = 65536 # \u6574\u4e2a\u7cfb\u7edf\u6700\u5927\u6d88\u606f\u961f\u5217\u6570\u91cf\u9650\u5236 kernel . shmmax = 67108864 # \u589e\u52a0\u5206\u914d\u7ed9 shm ( \u5355\u4e2a\u5171\u4eab\u5185\u5b58\u6bb5 ) \u7684\u6700\u5927\u5185\u5b58\u91cf ( \u5355\u4f4d\uff1a\u5b57\u8282 ) \u9650\u5236\uff0c\u8ba1\u7b97\u516c\u5f0f 64 G * 1024 * 1024 * 1024 ( \u5b57\u8282 ) kernel . shmall = 4294967296 # \u6240\u6709\u5185\u5b58\u5927\u5c0f ( \u5355\u4f4d\uff1a\u9875\uff0c 1 \u9875 = 4 Kb ) \uff0c\u8ba1\u7b97\u516c\u5f0f 16 G * 1024 * 1024 * 1024 / 4 KB ( \u9875 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / bridge / # bridge - nf \u4f7f\u5f97 netfilter \u53ef\u4ee5\u5bf9 Linux \u7f51\u6865\u4e0a\u7684 IPv4 / ARP / IPv6 \u5305\u8fc7\u6ee4\uff0c\u4ee5\u4e0b\u662f\u5e38\u7528\u914d\u7f6e\uff0c 1 \u4ee3\u8868\u542f\u7528\uff0c 0 \u4ee3\u8868\u4e0d\u542f\u7528 net . bridge . bridge - nf - call - arptables = 0 # \u662f\u5426\u542f\u7528\u5728 arptables \u7684 FORWARD \u4e2d\u8fc7\u6ee4\u7f51\u6865\u7684 ARP \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - call - ip6tables = 0 # \u662f\u5426\u542f\u7528\u5728 ip6tables \u94fe\u4e2d\u8fc7\u6ee4 IPv6 \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - call - iptables = 0 # \u662f\u5426\u542f\u7528\u5728 iptables \u94fe\u4e2d\u8fc7\u6ee4 IPv4 \u5305 ( \u9ed8\u8ba4\uff1a 0 ) net . bridge . bridge - nf - filter - vlan - tagged = 0 # \u662f\u5426\u542f\u7528\u5728 iptables / arptables \u4e2d\u8fc7\u6ee4\u6253\u4e86 vlan \u6807\u7b7e\u7684\u5305 ( \u9ed8\u8ba4\uff1a 0 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / core / net . core . rmem_default = 65535 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . rmem_max = 25165824 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 ( 24 MB ) net . core . wmem_default = 65535 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . wmem_max = 25165824 # \u4e3a TCP socket \u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09 net . core . hot_list_length = 256 # \u589e\u52a0\u8981\u7f13\u5b58\u7684 skb - heads \u6570\u76ee net . core . optmem_max = 40960 # \u589e\u52a0\u5185\u5b58\u7f13\u51b2\u533a\u7684\u6700\u5927\u6570\u91cf ( \u9ed8\u8ba4\uff1a 20480 ) net . core . busy_poll = 50 # \u8f6e\u8be2\u6709\u52a9\u4e8e\u51cf\u5c11\u7f51\u7edc\u63a5\u6536\u8def\u5f84\u4e2d\u7684\u5ef6\u8fdf,\u5141\u8bb8\u5957\u63a5\u5b57\u5c42\u4ee3\u7801\u8f6e\u8be2\u7f51\u7edc\u8bbe\u5907\u7684\u63a5\u6536\u961f\u5217\uff0c\u5e76\u7981\u7528\u7f51\u7edc\u4e2d\u65ad ( \u9ed8\u8ba4\uff1a 0 ) net . core . netdev_max_backlog = 16384 # \u5f53\u63a5\u53e3\u63a5\u6536\u6570\u636e\u5305\u7684\u901f\u5ea6\u8d85\u8fc7\u5185\u6838\u53ef\u4ee5\u5904\u7406\u7684\u901f\u5ea6\u65f6\uff0c\u589e\u52a0 incoming \u8fde\u63a5\u7684\u6570\u91cf\uff0c backlog \u961f\u5217\u8bbe\u7f6e \u5728 INPUT \u7aef\u6392\u961f\u7684\u6700\u5927\u6570\u636e\u5305\u6570,\u9ad8\u8d1f\u8f7d\u53ef\u4ee5\u589e\u52a0\u8be5\u503c ( \u9ed8\u8ba4\uff1a 1000 ) net . core . somaxconn = 1024 # \u589e\u52a0 incoming \u8fde\u63a5\u6570, somaxconn \u5b9a\u4e49\u6bcf\u4e2a listen \u8c03\u7528\u5206\u914d\u7684 request_sock \u7ed3\u6784\u7684\u6570\u91cf\u3002\u6b64\u961f\u5217\u5728\u76d1\u542c\u5957\u63a5\u5b57\u7684 \u751f\u547d\u5468\u671f\u4e2d\u662f\u6301\u4e45\u6027\u7684, web \u5e94\u7528\u73af\u5883\u975e\u5e38\u6709\u5fc5\u8981\u8c03\u6574\u6b64\u503c net . core . default_qdisc = fq # \u63a8\u8350\u7528\u4e8e Centos7 \u3001 Debian8 \u4e3b\u673a\u3002 \u5728 centos5 \u6216 6 \u4e3b\u673a\u9700\u8981\u5728 / etc / rc . local \u6dfb\u52a0\uff1a / sbin / ifconfig ethN txqueuelen 10000 ( N \u4ee3\u8868 10 G NIC \u7684\u7f16\u53f7\uff0c\u5373\u4e07\u5146\u7f51\u5361\u7684\u7cfb\u7edf\u7f16\u53f7 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a / proc / sys / fs / fs . file - max = 2097152 # \u589e\u52a0\u6587\u4ef6\u53e5\u67c4\u548c inode \u7f13\u5b58\u7684\u5927\u5c0f # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a / proc / sys / net / ipv4 / net . ipv4 . ip_forward = 1 # \u503c\u4e3a 0 \u8868\u793a\u7981\u6b62\u6570\u636e\u8f6c\u53d1\uff0c 1 \u5219\u5f00\u542f net . ipv4 . tcp_no_metrics_save = 1 # \u4e0d\u8981\u5728\u5173\u95ed\u8fde\u63a5\u65f6\u7f13\u5b58 metrics net . ipv4 . tcp_congestion_control = cubic # \u8bbe\u7f6e\u9ed8\u8ba4\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u662f cubic , ( \u63a8\u8350\u4f7f\u7528 htcp ) net . ipv4 . tcp_mtu_probing = 1 # \u8bbe\u7f6e\u4e3b\u673a\u542f\u7528 jumbo frames \uff0c\u907f\u514d MTU \u9ed1\u6d1e\u95ee\u9898 net . ipv4 . tcp_rfc1337 = 1 # \u9632\u6b62 TCP \u65f6\u95f4\u7b49\u5f85 net . ipv4 . icmp_echo_ignore_broadcasts = 1 # \u8bbe\u7f6e\u4e3a 1 \u8868\u793a\u5ffd\u7565 icmp \u5e7f\u64ad\u8bf7\u6c42,\u907f\u514d\u653e\u5927\u653b\u51fb net . ipv4 . icmp_ignore_bogus_error_responses = 1 # \u5f00\u542f\u6076\u610f icmp \u9519\u8bef\u6d88\u606f\u4fdd\u62a4 net . ipv4 . icmp_echo_ignore_all = 1 # \u5ffd\u7565\u6240\u6709 icmp \u8bf7\u6c42,\u5373\u5173\u95ed ping net . ipv4 . tcp_keepalive_time = 600 # TCP \u53d1\u9001 keepalive \u6d88\u606f\u7684\u9891\u7387 ( \u5355\u4f4d\uff1a\u79d2 ) ,\u7528\u4e8e\u786e\u8ba4 TCP \u8fde\u63a5\u662f\u5426\u6709\u6548\uff0c\u9632\u6b62\u5efa\u7acb\u8fde\u63a5\u4f46\u4e0d\u53d1\u9001\u6570\u636e\u7684\u653b\u51fb net . ipv4 . tcp_keepalive_probes = 5 # \u53d1\u9001 keepalive \u6d88\u606f\u8d85\u65f6\u4e4b\u524d\u7684\u63a2\u6d4b\u6b21\u6570 # \u9ed8\u8ba4\u503c\uff1a 9 \uff0c\u63a8\u8350 5 net . ipv4 . tcp_keepalive_intvl = 15 # \u786e\u5b9a\u4e86 isAlive \u95f4\u9694\u63a2\u6d4b\u4e4b\u95f4\u7684\u7b49\u5f85\u65f6\u95f4 ( \u9ed8\u8ba4 75 s ,\u5efa\u8bae 15 - 30 s ) net . ipv4 . tcp_retries1 = 3 # \u653e\u5f03\u56de\u5e94\u4e00\u4e2a TCP \u8fde\u63a5\u8bf7\u6c42\u524d\u8fdb\u884c\u91cd\u8bd5\u7684\u6b21\u6570\u3002 RFC \u89c4\u5b9a\u503c\u6700\u4f4e\u4e3a 3 \uff0c\u9ed8\u8ba4\u503c\u4e3a 3 net . ipv4 . tcp_retries2 = 5 # \u5728\u4e22\u5f03\u6fc0\u6d3b\u5df2\u5efa\u7acb\u901a\u8baf\u72b6\u51b5\u7684 TCP \u8fde\u63a5\u4e4b\u524d\ufe50\u9700\u8981\u8fdb\u884c\u591a\u5c11\u6b21\u91cd\u8bd5\u3002\u9ed8\u8ba4\u503c\u4e3a 15 net . ipv4 . tcp_orphan_retries = 3 # \u672c\u5730\u4e22\u5f03 TCP \u8fde\u63a5\u524d\u8fdb\u884c\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4 7 net . ipv4 . tcp_abort_on_overflow = 0 # \u5b88\u62a4\u8fdb\u7a0b\u8fc7\u4e8e\u7e41\u5fd9\u4e0d\u80fd\u63a5\u53d7\u65b0\u7684\u8fde\u63a5\u65f6\uff0c\u5c31\u53d1\u9001 reset \u4fe1\u606f\uff0c\u9ed8\u8ba4 0 net . ipv4 . tcp_syncookies = 1 # \u5f00\u542f SYN Cookies \uff0c\u5f53\u51fa\u73b0 SYN \u7b49\u5f85\u961f\u5217\u6ea2\u51fa\u65f6\uff0c\u542f\u7528 cookies \u6765\u5904\u7406\uff0c\u53ef\u4ee5\u505a SYN \u6d2a\u6c34\u653b\u51fb\u4fdd\u62a4 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_stdurg = 0 # \u9ed8\u8ba4\u4f7f\u7528 tcp urg pointer \u5b57\u6bb5\u4e2d\u7684\u4e3b\u673a\u8bf7\u6c42\u89e3\u91ca\u529f\u80fd\uff0c\u6253\u5f00\u53ef\u80fd\u5bfc\u81f4\u4e0d\u80fd\u6b63\u5e38\u901a\u4fe1 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_window_scaling = 1 # \u652f\u6301\u66f4\u5927\u7684 TCP / ip \u4f1a\u8bdd\u7684\u6ed1\u52a8\u7a97\u53e3,\u5982\u679c TCP \u7a97\u53e3\u6700\u5927\u8d85\u8fc7 65535 ( 64 K ) , \u5fc5\u987b\u8bbe\u7f6e\u8be5\u6570\u503c\u4e3a 1 net . ipv4 . tcp_timestamps = 1 # \u53ef\u9632\u8303\u4f2a\u9020\u7684 sequence \u53f7\u7801\uff0c\u542f\u7528\u5b9e\u73b0\u66f4\u597d\u7684\u7f51\u7edc\u6027\u80fd ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_sack = 1 # \u5f00\u542f\u6709\u9009\u62e9\u7684\u5e94\u7b54,\u7528\u4e8e\u67e5\u770b\u7279\u5b9a\u7684\u9057\u5931\u6570\u636e\u5305\uff0c\u7528\u4e8e\u5feb\u901f\u6062\u590d\u8fde\u63a5\u72b6\u6001 ( \u9ed8\u8ba4 1 ) net . ipv4 . tcp_fack = 1 # \u6253\u5f00 fack \u62e5\u585e\u907f\u514d\u548c\u5feb\u901f\u91cd\u4f20\u529f\u80fd\uff0c\u6ce8\u610f\uff1a\u5f53 tcp_sack \u8bbe\u7f6e\u4e3a 0 \u65f6\uff0c\u6b64\u503c\u8bbe\u7f6e 1 \u4e5f\u662f\u65e0\u6548\u7684 ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_dsack = 1 # \u5141\u8bb8 TCP \u53d1\u9001 \" \u4e24\u4e2a\u5b8c\u5168\u76f8\u540c \" \u7684 SACK ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_ecn = 0 # TCP \u7684\u76f4\u63a5\u62e5\u585e\u901a\u544a\u529f\u80fd ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_reordering = 5 # TCP \u6d41\u4e2d\u91cd\u6392\u5e8f\u7684\u6570\u636e\u62a5\u6700\u5927\u6570\u91cf\u3002\u4e00\u822c\u63a8\u8350\u628a\u8fd9\u4e2a\u6570\u503c\u7565\u5fae\u8c03\u6574\u5927\u4e00\u4e9b ( \u9ed8\u8ba4\uff1a 3 ) net . ipv4 . tcp_retrans_collapse = 0 # \u5bf9\u4e8e\u67d0\u4e9b\u6709 bug \u7684\u6253\u5370\u673a\u63d0\u4f9b\u9488\u5bf9\u5176 bug \u7684\u517c\u5bb9\u6027\u3002\u4e00\u822c\u4e0d\u9700\u8981\u8fd9\u4e2a\u652f\u6301,\u53ef\u4ee5\u5173\u95ed\u5b83 ( \u9ed8\u8ba4\uff1a 1 ) net . ipv4 . tcp_app_win = 31 # \u4fdd\u7559 max_window / 2 ^ tcp_app_win \u6570\u91cf\u7684\u7528\u4e8e\u5e94\u7528\u7f13\u5b58\uff0c 0 \u8868\u793a\u4e0d\u9700\u8981\u7f13\u5b58 ( \u9ed8\u8ba4\uff1a 31 ) net . ipv4 . tcp_adv_win_scale = 2 # \u8ba1\u7b97\u7f13\u51b2\u5f00\u9500 ( \u9ed8\u8ba4\uff1a 2 ) net . ipv4 . tcp_low_latency = 0 # \u5141\u8bb8 tcp / ip \u6808\u5728\u9ad8\u541e\u5410\u4e0b\u4f4e\u5ef6\u8fdf\uff0c\u4e00\u822c\u7981\u7528\uff0c\u4f46\u5728 beowulf \u96c6\u7fa4\u4e2d\u6253\u5f00\u5f88\u6709\u5e2e\u52a9 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_westwood = 0 # \u542f\u7528\u53d1\u9001\u7aef\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0c\u53ef\u5bf9\u5e26\u5bbd\u5229\u7528\u60c5\u51b5\u8fdb\u884c\u4f18\u5316 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . tcp_bic = 0 # \u4e3a\u5feb\u901f\u957f\u8ddd\u79bb\u7f51\u7edc\u542f\u7528 binary increase congestion \uff1b\u53ef\u66f4\u597d\u5229\u7528 ( \u9ed8\u8ba4\uff1a 0 ) net . ipv4 . ip_local_port_range = 1024 65000 # \u5bf9\u5916\u8fde\u63a5\u7aef\u53e3\u8303\u56f4\uff0c RHEL 7 default : 32768 61000 net . ipv4 . ip_conntrack_max = 65536 # \u7cfb\u7edf\u6700\u5927\u652f\u6301\u7684 ipv4 \u8fde\u63a5\u6570 ( \u9ed8\u8ba4\uff1a 65536 ) \uff0c\u4f46\u5982\u679c\u5185\u5b58 128 M \u4ee5\u4e0b\uff0c\u6700\u5927\u53ea\u6709 8192 net . ipv4 . tcp_syn_retries = 3 # \u5728\u5185\u6838\u653e\u5f03\u5efa\u7acb\u8fde\u63a5\u4e4b\u524d\u53d1\u9001 SYN \u5305\u7684\u6570\u91cf,\u6b64\u503c\u4e0d\u5e94\u5927\u4e8e 255 \uff0c\u9ed8\u8ba4\u662f 5 \uff0c\u9ad8\u8d1f\u8f7d\u7269\u7406 \u901a\u4fe1\u826f\u597d\u65f6\uff0c\u5efa\u8bae\u4e3a 2 \uff0c\u6b64\u503c\u4ec5\u9488\u5bf9\u5bf9\u5916\u8fde\u63a5\uff0c\u5bf9\u8fdb\u6765\u7684\u8fde\u63a5\u5219\u7531 tcp_retries \u51b3\u5b9a net . ipv4 . tcp_synack_retries = 2 # \u5bf9\u4e8e\u8fdc\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42 SYN \uff0c\u5185\u6838\u4f1a\u53d1\u9001 SYN + ACK \u6570\u636e\u5305\u4ee5\u786e\u8ba4\u6536\u5230\u4e0a\u4e00\u4e2a SYN \u8bf7\u6c42\u3002\u5373\u4e09\u6b21\u63e1\u624b\u7684\u7b2c\u4e8c\u6b21\u63e1\u624b\u3002 \u6b64\u8bbe\u7f6e\u51b3\u5b9a\u5185\u6838\u653e\u5f03\u8fde\u63a5\u4e4b\u524d\u53d1\u9001 SYN + ACK \u5305\u7684\u6570\u91cf\uff0c\u4e0d\u5e94\u5927\u4e8e 255 \uff0c\u9ed8\u8ba4\u4e3a 5 net . ipv4 . tcp_fin_timeout = 15 # \u6b64\u53c2\u6570\u51b3\u5b9a\u4e86 TCP \u8fde\u63a5\u4fdd\u6301\u5728 FIN - WAIT - 2 \u72b6\u6001\u7684\u65f6\u95f4\uff0c ( \u9ed8\u8ba4 60 s \uff0c\u5efa\u8bae 15 - 30 s ) \u5bf9\u4e8e\u751f\u6210\u6216\u652f\u6301\u9ad8\u7ea7\u522b\u7f51\u7edc \u6d41\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u7cfb\u7edf\uff0c\u6b64\u503c\u8bbe\u7f6e\u5230 10 \u79d2\u4ee5\u4e0b net . ipv4 . tcp_max_syn_backlog = 2048 # \u8bb0\u5f55\u5c1a\u672a\u6536\u5230\u5ba2\u6237\u7aef\u786e\u8ba4\u4fe1\u606f\u7684\u8fde\u63a5\u8bf7\u6c42\u7684\u6700\u5927\u503c\uff0c\u5185\u5b58\u5927\u4e8e 128 Mb \u9ed8\u8ba4 1024 \uff0c\u5185\u5b58\u5c0f\u4e8e 128 \u65f6\uff0c\u5219\u503c \u9ed8\u8ba4\u65f6 128 ,\u670d\u52a1\u5668\u8fc7\u8f7d\u65f6\u53ef\u589e\u52a0\u6b64\u503c net . ipv4 . tcp_limit_output_bytes = 131072 # \u9ed8\u8ba4\u662f 262144 \u5b57\u8282\uff1b\u9650\u5236\u8bbe\u5907\u4e0a\u7684\u5b57\u8282\u6570\uff0c\u4ee5\u51cf\u5c11\u8f83\u5927\u961f\u5217\u5927\u5c0f\u5bfc\u81f4\u7684\u5ef6\u8fdf\u6548\u5e94\uff1b\u5bf9\u4e8e\u5ef6\u8fdf\u4f18\u5148 \u7ea7\u9ad8\u4e8e\u541e\u5410\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u73af\u5883\uff0c\u964d\u4f4e\u6b64\u503c\u53ef\u4ee5\u6539\u5584\u5ef6\u8fdf\uff0c\u63a8\u8350 131072 \u5b57\u8282 # \u589e\u52a0 time - wait \u5b58\u50a8\u6c60\u5927\u5c0f\u53ef\u9632\u6b62\u7b80\u5355 DOS \u653b\u51fb net . ipv4 . tcp_max_tw_buckets = 1440000 # \u6307\u5b9a\u5141\u8bb8\u5728\u4efb\u4f55\u65f6\u95f4\u5b58\u5728\u7684\u201c time - wait \u201d\u72b6\u6001\u7684\u6700\u5927 sockets \u6570\u3002\u5982\u679c\u8d85\u8fc7\u6700\u5927\u503c\uff0c\u5219\u4f1a\u7acb\u5373\u9500\u6bc1\u5904\u4e8e \u201c time - wait \u201d\u72b6\u6001\u7684\u5957\u63a5\u5b57\u5e76\u663e\u793a\u8b66\u544a\u3002\u6b64\u8bbe\u7f6e\u7528\u4e8e\u963b\u6b62\u67d0\u4e9b\u7c7b\u578b\u7684\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\u5728\u964d\u4f4e\u6b64\u503c\u4e4b\u524d\u5e94\u5c0f\u5fc3 \u8c28\u614e\u3002\u66f4\u6539\u540e\uff0c\u5e94\u589e\u52a0\u5176\u503c\uff0c\u5c24\u5176\u662f\u5728\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e86\u66f4\u591a\u5185\u5b58\u6216\u7f51\u7edc\u9700\u6c42\u8f83\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5916\u90e8\u5a01\u80c1\u5f71\u54cd\u65f6 \u9ed8\u8ba4 262144 \uff0c\u5f53\u7f51\u7edc\u9700\u6c42\u5f88\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5230\u5916\u90e8\u5a01\u80c1\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u5230 450000 net . ipv4 . tcp_tw_recycle = 1 # \u5f00\u542f TCP \u8fde\u63a5\u4e2d time_wait sockets \u7684\u5feb\u901f\u56de\u6536,\u9ed8\u8ba4\u4e3a 0 net . ipv4 . tcp_tw_reuse = 1 # \u5f00\u542f TCP \u8fde\u63a5\u590d\u7528\uff0c\u5141\u8bb8\u5c06 time_wait sockets \u91cd\u65b0\u7528\u4e8e\u65b0\u7684 TCP \u8fde\u63a5 ( \u4e3b\u8981\u9488\u5bf9 time_wait \u8fde\u63a5 ) \u542f\u7528\u540e\uff0c\u6b64\u53c2\u6570 \u53ef\u4ee5\u7ed5\u8fc7\u901a\u5e38\u4e0e\u5957\u63a5\u5b57\u521b\u5efa\u76f8\u5173\u7684\u5206\u914d\u548c\u521d\u59cb\u5316\u5f00\u9500\uff0c\u4ece\u800c\u8282\u7701 CPU \u5468\u671f\uff0c\u7cfb\u7edf\u8d1f\u8f7d\u548c\u65f6\u95f4 net . ipv4 . tcp_max_orphans = 32768 # \u544a\u8bc9\u5185\u6838\u6709\u591a\u5c11 TCP \u5957\u63a5\u5b57\u672a\u9644\u52a0\u5230\u7cfb\u7edf\u4fdd\u7559\u7684\u4efb\u4f55\u7528\u6237\u6587\u4ef6\u53e5\u67c4\u7684\u6700\u5927\u6570\u91cf,\u5982\u679c\u8d85\u8fc7\u6b64\u6570\u91cf\uff0c\u5219\u7acb\u5373\u91cd\u7f6e \u5b64\u7acb\u8fde\u63a5\u5e76\u6253\u5370\u8b66\u544a\u3002\u6b64\u9650\u5236\u4ec5\u7528\u4e8e\u9632\u6b62\u7b80\u5355\u7684 DoS \u653b\u51fb\uff0c\u4f46\u4e0d\u80fd\u4eba\u4e3a\u5730\u4f9d\u8d56\u6b64\u9650\u5236\u6216\u964d\u4f4e\u9650\u5236\uff0c\u800c\u662f\u589e\u52a0 \u5b83\uff08\u53ef\u80fd\u5728\u589e\u52a0\u5df2\u5b89\u88c5\u7684\u5185\u5b58\u4e4b\u540e\uff09\uff0c\u5982\u679c\u7f51\u7edc\u6761\u4ef6\u9700\u8981\u8d85\u8fc7\u9ed8\u8ba4\u503c\uff0c\u8c03\u6574\u7f51\u7edc\u670d\u52a1\u4ee5\u5ef6\u8fdf\u5e76\u66f4\u79ef\u6781\u5730\u6740\u6b7b \u8fd9\u4e9b\u72b6\u6001\u3002\u518d\u6b21\u63d0\u9192\uff1a\u6bcf\u4e2a orphan \u90fd\u4f1a\u5403\u6389\u5927\u7ea6 64 K \u7684 unswappable \u5185\u5b58 ( \u9ed8\u8ba4\uff1a 8192 ) # \u589e\u52a0\u8bfb\u53d6\u7f13\u51b2\u533a\u7a7a\u95f4 net . ipv4 . udp_rmem_min = 16384 net . ipv4 . tcp_rmem = 4096 87380 25165824 # \u4e09\u4e2a\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684\u6700\u5c0f\u503c\u3001\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c # \u589e\u52a0\u53ef\u5206\u914d\u7684\u5199\u7f13\u51b2\u533a\u7a7a\u95f4 net . ipv4 . udp_wmem_min = 16384 net . ipv4 . tcp_wmem = 4096 65536 25165824 # \u4e09\u4e2a\u53c2\u6570\u4f9d\u6b21\u4e3a\uff1a\u6700\u5c0f\u503c\uff0c\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c\uff1b\u6700\u5c0f\u503c\u8868\u793a\u65b0\u521b\u5efa\u7684 \u5957\u63a5\u5b57\u4f5c\u4e3a\u5176\u521b\u5efa\u7684\u4e00\u90e8\u5206\u6709\u6743\u83b7\u5f97\u7684\u6700\u5c0f\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff1b\u9ed8\u8ba4\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684 \u521d\u59cb\u5927\u5c0f\uff1b\u6700\u5927\u503c\u8868\u793a TCP \u5957\u63a5\u5b57\u7684\u81ea\u52a8\u8c03\u6574\u53d1\u9001\u7f13\u51b2\u533a\u7684\u6700\u5927\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u8be5\u503c\u4e0d\u4f1a\u8986\u76d6 net . core . rmem_max \u3002\u6839\u636e\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684\u5185\u5b58\u91cf\uff0c\u6b64\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\u4ecb\u4e8e 64 K \u5b57\u8282\u548c 4 M \u5b57\u8282\u4e4b\u95f4\u3002 \u5efa\u8bae\u4f7f\u7528 16 M \u5b57\u8282\u6216\u66f4\u9ad8\u7684\u6700\u5927\u503c\uff08\u53d6\u51b3\u4e8e\u5185\u6838\u7ea7\u522b\uff09\uff0c\u5c24\u5176\u662f 10 \u5343\u5146\u4f4d\u9002\u914d\u5668 # \u589e\u52a0\u53ef\u5206\u914d\u7684\u6700\u5927\u603b\u7f13\u51b2\u533a\u7a7a\u95f4,\u6b64\u4e3a\u4ee5 page \u4e3a\u5355\u4f4d\uff08 4096 \u5b57\u8282\uff09\u6d4b\u91cf net . ipv4 . udp_mem = 65536 131072 262144 net . ipv4 . tcp_mem = 65536 131072 262144 # \u7b2c\u4e00\u6b21\u4f4e\u4e8e\u6b64\u503c, TCP \u6ca1\u6709\u5185\u5b58\u538b\u529b,\u7b2c\u4e8c\u6b21\u8fdb\u5165\u5185\u5b58\u538b\u529b\u9636\u6bb5, \u7b2c\u4e09\u6b21 TCP \u62d2\u7edd\u5206\u914d socket ( \u9ed8\u8ba4\uff1a 5814 7754 11628 ) # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u4e0b\uff1a / proc / sys / net / ipv4 / conf / #\u542f\u7528\u6e90\u8def\u7531\u6838\u67e5\u529f\u80fd\uff0c\u53cd\u5411\u8def\u5f84\u8fc7\u6ee4 # 0 \u2014\u2014\u672a\u8fdb\u884c\u6e90\u9a8c\u8bc1 # 1 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u4e25\u683c\u6a21\u5f0f # 2 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u677e\u6563\u6a21\u5f0f net . ipv4 . conf . all . rp_filter = 1 net . ipv4 . conf . default . rp_filter = 1 # \u786e\u4fdd\u65e0\u4eba\u80fd\u4fee\u6539\u8def\u7531\u8868 net . ipv4 . conf . all . accept_redirects = 0 net . ipv4 . conf . all . secure_redirects = 0 net . ipv4 . conf . default . accept_redirects = 0 # \u7981\u6b62 icmp \u91cd\u5b9a\u5411\u68c0\u67e5 net . ipv4 . conf . default . secure_redirects = 0 # \u4e0d\u5145\u5f53\u8def\u7531\u5668 net . ipv4 . conf . all . send_redirects = 0 net . ipv4 . conf . default . send_redirects = 0 # \u8bb0\u5f55\u5728\u4e0d\u53ef\u8fbe\u7684\u5730\u5740\u7684\u6570\u636e\u5305 ( \u9519\u8bef\u7684\u8def\u7531 ) \uff1b\u5f00\u542f\u5e76\u8bb0\u5f55\u6b3a\u9a97\u3001\u6e90\u8def\u7531\u3001\u91cd\u5b9a\u5411\u6570\u636e\u5305 net . ipv4 . conf . all . log_martians = 1 net . ipv4 . conf . default . log_martians = 1 net . ipv4 . conf . all . accept_source_route = 0 # \u5904\u7406\u65e0\u6e90\u8def\u7531\u7684\u5305 net . ipv4 . conf . default . accept_source_route = 0 # \u7981\u7528\u6240\u6709 IP \u6e90\u8def\u7531 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a / proc / sys / net / ipv4 / route / net . ipv4 . route . gc_timeout = 100 # \u8def\u7531\u5237\u65b0\u9891\u7387 # \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b ( \u9632\u706b\u5899\u76f8\u5173 ) \uff1a / proc / sys / net / netfilter / # nf_conntrack \u662f Linux \u5185\u6838\u8fde\u63a5\u8ddf\u8e2a\u7684\u6a21\u5757\uff1a\u4e0e nf_conntrack \u76f8\u5173\u7684\u5185\u6838\u53c2\u6570\u6709\u4e09\u4e2a\uff1a # 1 \u3001 nf_conntrack_max \uff1a\u8fde\u63a5\u8ddf\u8e2a\u8868\u7684\u5927\u5c0f\uff0c\u5efa\u8bae\u6839\u636e\u5185\u5b58\u8ba1\u7b97\u8be5\u503c CONNTRACK_MAX = RAMSIZE ( in bytes ) / 16384 / ( x / 32 ) \uff0c \u5e76\u6ee1\u8db3 nf_conntrack_max = 4 * nf_conntrack_buckets \uff0c\u9ed8\u8ba4 262144 # 2 \u3001 nf_conntrack_buckets \uff1a\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\uff0c ( nf_conntrack_max / nf_conntrack_buckets \u5c31\u662f\u6bcf\u6761\u54c8\u5e0c\u8bb0\u5f55\u94fe\u8868\u7684\u957f\u5ea6 ) \uff0c\u9ed8\u8ba4 65536 # 3 \u3001 nf_conntrack_tcp_timeout_established \uff1a tcp \u4f1a\u8bdd\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\uff1a 432000 ( 5 \u5929 ) # \u4ee5\u4e0b\u4e3a 64 \u5185\u5b58\u63a8\u8350\u914d\u7f6e net . nf_conntrack_max = 262144 net . netfilter . nf_conntrack_max = 65536 # \u7cfb\u7edf\u652f\u6301\u7684\u6700\u5927 ipv4 \u8fde\u63a5\u6570 ( \u9ed8\u8ba4\uff1a 65536 ) net . netfilter . nf_conntrack_tcp_timeout_established = 300 # \u5df2\u5efa\u7acb\u7684 tcp \u8fde\u63a5\u8d85\u65f6\u65f6\u95f4 ( \u9ed8\u8ba4\uff1a 43200 \uff0c\u5373 5 \u5929 ) net . netfilter . nf_conntrack_buckets = 1048576 ( \u9ed8\u8ba4\uff1a 65535 ) net . netfilter . nf_conntrack_tcp_timeout_time_wait = 30 # time_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 120 ) net . netfilter . nf_conntrack_tcp_timeout_close_wait = 60 # close_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 60 ) net . netfilter . nf_conntrack_tcp_timeout_fin_wait = 30 # fin_wait \u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5 ( \u9ed8\u8ba4\uff1a 120 )","title":"\u4f18\u5316\u5185\u6838\u53c2\u6570 [\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574]"},{"location":"Linux/#_10","text":"","title":"\u4e0d\u5e38\u7528\u8bbe\u7f6e\u548c\u8bb0\u5f55"},{"location":"Linux/#_11","text":"# \u670d\u52a1\u56681\u7684IP\uff1a192.168.1.1 \u670d\u52a1\u56682\u7684IP\uff1a192.168.1.2 # \u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e0a\u5206\u522b\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c ssh-keygen -t rsa -b 4096 # \u521b\u5efa\u516c\u94a5\u548c\u5bc6\u94a5 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5c06\u81ea\u5df1\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 # \u5c06\u516c\u94a5\u4e92\u76f8\u590d\u5236\u5230\u5bf9\u5e94\u7684\u4e3b\u673a # \u65b9\u6cd5\u4e00:\u4f7f\u7528ssh-copy-id\u547d\u4ee4 ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.2 # \u57281\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.2,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.1 # \u57282\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.1,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys # \u65b9\u6cd5\u4e8c\uff1a\u4f7f\u7528ssh\u547d\u4ee4\u5e76\u7528cat\u8ffd\u52a0\u5230authorized_keys\u4e2d ssh 192 .168.1.2 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5728\u670d\u52a1\u56681\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56682\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 ssh 192 .168.1.1 cat ~/.ssh/id_rsa.pub >> authorized_keys # \u5728\u670d\u52a1\u56682\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56681\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5 ssh 192 .168.1.2 ifconfig # \u6d4b\u8bd5,\u5728\u670d\u52a1\u56681\u4e0a\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u7684\u8bdd\u5c31\u65e0\u9700\u8f93\u5165\u5bc6\u7801\u4e5f\u80fd\u663e\u793a\u670d\u52a1\u56682\u7684\u7f51\u5361\u4fe1\u606f","title":"\u670d\u52a1\u5668\u914d\u7f6e\u53cc\u673a\u4e92\u4fe1"},{"location":"Linux/#centospythonyum","text":"# \u5220\u9664\u73b0\u6709Python rpm -qa | grep python | xargs rpm -ev --allmatches --nodeps # \u5f3a\u5236\u5220\u9664\u5df2\u5b89\u88c5\u7a0b\u5e8f\u53ca\u5176\u5173\u8054 whereis python | xargs rm -frv # \u5220\u9664\u6240\u6709\u6b8b\u4f59\u6587\u4ef6,xargs\uff0c\u5141\u8bb8\u4f60\u5bf9\u8f93\u51fa\u6267\u884c\u5176\u4ed6\u67d0\u4e9b\u547d\u4ee4 whereis python # \u9a8c\u8bc1\u5220\u9664\uff0c\u8fd4\u56de\u65e0\u7ed3\u679c # \u5220\u9664\u73b0\u6709\u7684yum rpm -qa | grep yum | xargs rpm -ev --allmatches --nodeps whereis yum | xargs rm -frv # \u4ecehttp://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\u4e0b\u8f7d\u76f8\u5e94\u7684\u5305,\u7531\u4e8e\u6e90\u4e2d\u7248\u672c\u4f1a\u66f4\u65b0\uff0c\u5177\u4f53\u8bf7\u67e5\u770bURL\u4e2d\u7684\u7248\u672c\uff01 rpm -Uvh --replacepkgs *.rpm # \u53ef\u80fd\u4e4b\u95f4\u8fd8\u9700\u8981zlib\u548czlib-devel\u5305\uff0c\u6839\u636e\u60c5\u51b5\u4e0b\u8f7d\u5e76\u5b89\u88c5\uff01\u5b89\u88c5\u5b8c\u8fdb\u884c\u6d4b\u8bd5 # \u6e90\u7801\u7f16\u8bd1\u5b89\u88c5yum wget http://yum.baseurl.org/download/3.4/yum-3.4.3.tar.gz tar xvf yum-3.4.3.tar.gz && cd yum-3.4.3 yummain.py install yum # \u5982\u679c\u7ed3\u679c\u63d0\u793a\u9519\u8bef\uff1a CRITICAL:yum.cli:Config Error: Error accessing file for config file:///etc/\u7f3a\u5c11\u914d\u7f6e\u6587\u4ef6 # \u5728etc\u76ee\u5f55\u4e0b\u9762\u65b0\u5efayum.conf\u6587\u4ef6\uff0c\u7136\u540e\u518d\u6b21\u8fd0\u884c yummain.py install yum\uff0c\u987a\u5229\u5b8c\u6210\u5b89\u88c5","title":"centos\u5b8c\u5168\u91cd\u88c5python\u548cyum"},{"location":"Linux/#root","text":"# \u5efa\u8bae\u4f7f\u7528\u65b9\u6cd5\u4e8c\uff0c\u4e0d\u8981\u8f7b\u6613\u4f7f\u7528\u65b9\u6cd5\u4e09 : << comment # \u65b9\u6cd5\u4e00\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230%wheel\u4e00\u884c\uff0c\u628a\u524d\u9762\u7684\u6ce8\u91ca\uff08#\uff09\u53bb\u6389 Allows people in group wheel to run all commands %wheel ALL=(ALL) ALL \u7136\u540e\u4fee\u6539\u7528\u6237\uff0c\u4f7f\u5176\u5c5e\u4e8eroot\u7ec4\uff08wheel\uff09\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a #usermod -g root tommy \u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c comment : << comment # \u65b9\u6cd5\u4e8c\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230root\u4e00\u884c\uff0c\u5728root\u4e0b\u9762\u6dfb\u52a0\u4e00\u884c\uff0c\u5982\u4e0b\u6240\u793a\uff1a Allow root to run any commands anywhere root ALL=(ALL) ALL tommy ALL=(ALL) ALL \u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c comment : << comment # \u65b9\u6cd5\u4e09\uff1a \u4fee\u6539 /etc/passwd \u6587\u4ef6\uff0c\u627e\u5230\u5982\u4e0b\u884c\uff0c\u628a\u7528\u6237ID\u4fee\u6539\u4e3a 0 \uff0c\u5982\u4e0b\u6240\u793a\uff1a tommy:x:500:500:tommy:/home/tommy:/bin/bash \u4fee\u6539\u540e\u5982\u4e0b tommy:x:0:500:tommy:/home/tommy:/bin/bash \u4fdd\u5b58\uff0c\u7528tommy\u8d26\u6237\u767b\u5f55\u540e\uff0c\u76f4\u63a5\u83b7\u53d6\u7684\u5c31\u662froot\u5e10\u53f7\u7684\u6743\u9650 comment","title":"\u666e\u901a\u8d26\u53f7\u8d4b\u4e88root\u6743\u9650"},{"location":"Linux/#-float-ipip","text":": << comment \u6709\u4e24\u53f0Linux\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u4e00\u53f0\u4e3b\u673a\uff08IP\uff1a192.168.2.2\uff09\u5bf9\u5916\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u53e6\u4e00\u53f0\u4ece\u673a\uff08IP\uff1a192.168.2.3\uff09\u80fd\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\uff0c\u4f46IP\u5730\u5740 \u6ca1\u6709\u5bf9\u5916\u90e8\u516c\u5f00,\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u90fd\u662f192.168.2.2\u8fd9\u4e2aIP\u5730\u5740\uff0c\u5982\u679c\u4e3b\u673a\u6545\u969c\uff0c\u5219\u4f1a\u4f7f\u7f51\u7edc\u670d\u52a1\u6682\u65f6\u4e2d\u65ad \u7531\u4e8e\u6ca1\u6709\u91c7\u7528\u53cc\u673a\u70ed\u5907\u4efd\u6280\u672f,\u8003\u8651\u7528Linux\u811a\u672c\u6765\u5b9e\u73b0\u7b80\u5355\u7684\u6d6e\u52a8IP\u6280\u672f\uff0c\u5f53\u4e3b\u673a\u6545\u969c\u65f6\u4ece\u673a\u83b7\u5f97192.168.2.2\u8fd9\u4e2aIP\uff0c\u6682\u65f6\u66ff\u4ee3\u4e3b\u673a\u63d0\u4f9b\u670d\u52a1\uff0c\u5f53\u4e3b\u673a \u6062\u590d\u65f6\uff0c\u4ece\u673a\u81ea\u52a8\u91ca\u653e\u8fd9\u4e2aIP \u601d\u8def\uff1a \u5229\u7528\u5355\u4e2a\u7f51\u5361\u7ed1\u5b9a\u591a\u4e2aIP\u5730\u5740\u7684\u6280\u672f\u548ccrontab\u81ea\u52a8\u6267\u884c\u6280\u672f \u4e3a\u4e3b\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u9759\u6001IP\uff0c\u5982192.168.2.8,\u8fd9\u4e2a\u5730\u5740\u4fbf\u4e8e\u4ece\u673a\u5224\u65ad\u7684 \u4e3a\u4ece\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u52a8\u6001IP\uff0c127.0.0.1\uff0c\u5b83\u5728\u4e3b\u673a\u6545\u969c\u65f6\u5c06\u4f1a\u88ab\u811a\u672c\u4fee\u6539\u4e3a192.168.2.2 \u5728\u4ece\u673a\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u811a\u672c /root/autoFloatIP.sh\uff0c\u4f7f\u7528crontab\u6280\u672f\u8ba9\u8fd9\u4e2a\u811a\u672c\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u8fd9\u4e2a\u811a\u672c\u7684\u4f5c\u7528\u662f\u5224\u65ad\u4e3b\u673a\u7684\u5730\u5740192.168.2.8\u80fd\u5426 Ping\u901a\uff0c\u4e00\u65e6\u4e0d\u6b63\u5e38\u5219\u5c06\u8ba9\u81ea\u5df1\u7684\u7f51\u5361\u591a\u4f59\u7684\u90a3\u4e2aIP\u5730\u5740\u6539\u4e3a192.168.2.2\uff0c\u5982\u679c\u4e3b\u673a\u6062\u590d\uff0c\u5219\u5c06\u8fd9\u4e2a\u5730\u5740\u6539\u56de\u4e3a127.0.0.1 comment # \u6b65\u9aa4\u5982\u4e0b\uff1a # 1. \u4e3a\u4e3b\u673a\u6dfb\u52a0\u4e00\u4e2a\u9759\u6001IP192.168.2.8\uff0c\u5728/etc/sysconfig/network-scripts\u76ee\u5f55\u4fee\u6539\u7c7b\u4f3cifcfg-eth0:1\u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a: DEVICE = eth0:1 IPADDR = 139 .24.214.82 NETMASK = 255 .255.255.0 ONBOOT = yes # 2. \u5728\u4ece\u673a\u4e0a\uff0c\u5728/root\u4e0b\u5efa\u7acb\u4e00\u4e2a\u811a\u672cautoFloatIP.sh,\u5185\u5bb9\u5982\u4e0b\uff1a #!/bin/bash c1 = $( ping 139 .24.214.82 -c 1 | grep Unreachable | wc -l ) if [ $c1 -gt 0 ] ; then c2 = $( ping 139 .24.214.82 -c 10 | grep Unreachable | wc -l ) if [ $c2 -gt 9 ] ; then c3 = $( ping 139 .24.214.22 -c 10 | grep Unreachable | wc -l ) if [ $c3 -gt 9 ] ; then /sbin/ifconfig eth0:1 139 .24.214.22 netmask 255 .255.254.0 echo \"float ip to 22\" fi fi echo \"can not connect\" else c4 = $( /sbin/ifconfig | grep 139 .24.214.22 | wc -l ) if [ $c4 -gt 0 ] ; then /sbin/ifconfig eth0:2 127 .0.0.1 netmask 255 .255.254.0 echo \"reset ip\" fi echo \"connection is ok\" fi # \u5176\u4e2d\u5173\u952e\u7684\u547d\u4ee4\u5982\u4e0b\uff0c\u7528\u8fd9\u4e2a\u65b9\u6cd5\u6765\u52a8\u6001\u4fee\u6539IP\uff0c\u52a8\u6001IP\u5728\u7535\u8111\u91cd\u542f\u4f1a\u6d88\u5931 /sbin/ifconfig eth0:1 139 .24.214.22 netmask 255 .255.254.0 /sbin/ifconfig eth0:2 127 .0.0.1 netmask 255 .255.254.0 # 3. \u4ece\u673a\u4e0a\u5efa\u7acbcrontab\uff0c\u52a0\u4e0a\u5982\u4e0b\u4e00\u884c\u5e76\u4fdd\u5b58 * * * * * /root/autoFloatIP.sh > /dev/null 2 > & 1","title":"\u672a\u91c7\u7528\u53cc\u673a\u70ed\u5907\u9632\u6b62\u670d\u52a1\u4e2d\u65ad--float IP(\u6d6e\u52a8IP\u914d\u7f6e)"},{"location":"Linux/#centosip","text":"# \u5728CentOS\u4e3b\u673a\u4e0a\u5b89\u88c5\u6700\u65b0\u7684\u7a33\u5b9a\u5185\u6838 # \u5bfc\u5165key\uff08\u5185\u68383.0\u4ee5\u4e0a\u9700\u8981\u5bfc\u5165key\uff09,\u5982\u679c\u5df2\u7ecf\u4fee\u6539\u4e86repo\u7684gpgcheck=0\u4e5f\u53ef\u4ee5\u4e0d\u5bfc\u5165key rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org # To install ELRepo for RHEL-6, SL-6 or CentOS-6 rpm -Uvh http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm # \u5b89\u88c5elrepo\u7684yum\u6e90,To install ELRepo for RHEL-7, SL-7 or CentOS-7 rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm # \u5b89\u88c5\u5185\u6838,\u5728yum\u7684ELRepo\u6e90\u4e2d\uff0c\u6709mainline\u9881\u5e03\u7684\uff0c\u53ef\u4ee5\u8fd9\u6837\u5b89\u88c5 yum --enablerepo = elrepo-kernel install kernel-ml-devel kernel-ml -y yum --enablerepo = elrepo-kernel install kernel-lt -y # \u5b89\u88c5long term\u7684\u5185\u6838 # \u914d\u7f6eGrub\u4f7f\u7528\u65b0\u5185\u6838\uff0c\u914d\u7f6e\u5b8c\u540e\u91cd\u542f\u542f\u7528\u65b0\u5185\u6838 ## CentOS 6\u914d\u7f6e\uff0c\u4fee\u6539/boot/grub/grub.conf default = 0 # \u66f4\u6539\u4e3a 0 fallback = 1 # \u6dfb\u52a0\u6b64\u9879 ## CentOS 7 grub2-set-default 0 grub2-install /dev/sda grub2-mkconfig -o /boot/grub2/grub.cfg # \u66f4\u6539\u4e3a\u9759\u6001IP\uff1a/etc/sysconfig/network-scripts/ifcfg-ens33 BOOTPROTO = \"static\" #dhcp\u6539\u4e3astatic ONBOOT = \"yes\" #\u5f00\u673a\u542f\u7528\u672c\u914d\u7f6e IPADDR = 192 .168.7.106 #\u9759\u6001IP GATEWAY = 192 .168.7.1 #\u9ed8\u8ba4\u7f51\u5173 NETMASK = 255 .255.255.0 #\u5b50\u7f51\u63a9\u7801 DNS1 = 192 .168.7.1 #DNS \u914d\u7f6e vim /etc/sysconfig/grub # \u7f16\u8f91 grub \u914d\u7f6e\u6587\u4ef6,\u5b9e\u9645\u662f/etc/default/grub\u7684\u8f6f\u8fde\u63a5 # \u4e3aGRUB_CMDLINE_LINUX\u53d8\u91cf\u589e\u52a02\u4e2a\u53c2\u6570\uff0c\u5177\u4f53\u5185\u5bb9\u5982\u4e0b(\u52a0\u7c97)\uff1a GRUB_CMDLINE_LINUX = \"crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap net.ifnames=0 biosdevname=0 rhgb quiet\" # \u91cd\u65b0\u751f\u6210 grub \u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8 Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u901a\u8fc7 ip addr \u53ef\u4ee5\u770b\u5230\u7f51\u5361\u540d\u79f0\u5df2\u7ecf\u53d8\u4e3a eth0 grub2-mkconfig -o /boot/grub2/grub.cfg # \u4fee\u6539\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\uff0c\u539f\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u4e3a ifcfg-ens33\uff0c\u8fd9\u91cc\u9700\u8981\u4fee\u6539\u4e3aethx\u7684\u683c\u5f0f\uff0c\u5e76\u9002\u5f53\u8c03\u6574\u7f51\u5361\u914d\u7f6e\u6587\u4ef6 mv /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-eth0 # \u4fee\u6539ifcfg-eth0\u6587\u4ef6\u5982\u4e0b\u5185\u5bb9(\u5176\u5b83\u5185\u5bb9\u4e0d\u53d8) NAME = eth0 DEVICE = eth0 systemctl restart network.service # \u91cd\u542f\u7f51\u7edc\u670d\u52a1\uff0c\u6ce8\u610f\uff1aifcfg-ens33 \u6587\u4ef6\u6700\u597d\u5220\u9664\u6389\uff0c\u5426\u5219\u91cd\u542f network \u670d\u52a1\u65f6\u5019\u4f1a\u62a5\u9519","title":"\u5b89\u88c5\u6700\u65b0\u7a33\u5b9acentos\u5185\u6838&amp;\u66f4\u6539\u4e3a\u9759\u6001ip\u3001\u7f51\u5361\u540d\u79f0"},{"location":"Linux/#linux_5","text":"","title":"Linux\u6570\u636e\u6062\u590d\uff1a\u6700\u597d\u662f\u5907\u4efd\u800c\u4e0d\u662f\u5c1d\u8bd5\u6062\u590d"},{"location":"Linux/#systemrescuecd","text":"# \u5b98\u7f51\uff1ahttp://www.system-rescue-cd.org/","title":"SystemRescueCd"},{"location":"Linux/#_12","text":"# \u53c2\u8003\u94fe\u63a5\uff1a https : // help . ubuntu . com / community / DataRecovery \u60c5\u51b5\u4e00\uff1a\u4e22\u5931\u5206\u533a\uff1a\u5982\u679c\u5206\u533a\u51fa\u9519\u4e14\u5206\u533a\u8868\u4e0d\u663e\u793a\u8be5\u5206\u533a\uff0c\u53ea\u8981\u672a\u5411\u8be5\u7a7a\u95f4\u5199\u5165\u6570\u636e\uff0c\u5219\u6570\u636e\u4ecd\u4f1a\u5b58\u5728 # GNU Parted 1 . \u4f7f\u7528 live cd \u6216\u989d\u5916\u7cfb\u7edf\uff0c\u8fdb\u5165\u7cfb\u7edf\u7ec8\u7aef\u9996\u5148\u6267\u884c\uff0c swapoff - a \uff0c\u6302\u8f7d\u95ee\u9898\u78c1\u76d8 2 . \u8fd0\u884c partted \uff0c parted / dev / sda ,\u8fd9\u91cc / dev / sda \u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907 3 . \u8fd0\u884c\u6062\u590d\u9009\u9879\uff1a rescue START END \uff0c\u5982\u679c\u627e\u5230\u6f5c\u5728\u7684\u5206\u533a\u5219\u4f1a\u63d0\u793a\u662f\u5426\u6dfb\u52a0\u5230\u5206\u533a\u8868\u4e2d # Testdisk testdisk \u4e5f\u53ef\u4ee5\u6062\u590d\u5206\u533a\u3002\u5b89\u88c5 testdisk \u8f6f\u4ef6\u5305\u3002 \u8fd0\u884c testdisk \uff0c\u5b83\u5c06\u626b\u63cf\u60a8\u7684\u8ba1\u7b97\u673a\u4e2d\u7684\u4ecb\u8d28\uff0c\u5e76\u4e3a\u60a8\u63d0\u4f9b\u83dc\u5355\u9a71\u52a8\u7684\u65b9\u6cd5\u6765\u6062\u590d\u5206\u533a # Gpart \u5b89\u88c5 gpart \uff0c\u6267\u884c gpart / dev / sda \uff0c / dev / sda \u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907,\u6700\u597d\u662f gpart - W / dev / sda / dev / sdb \u5199\u5165\u5230\u53e6\u4e00\u4e2a\u8bbe\u5907 \u60c5\u51b5\u4e8c\uff1a\u6620\u50cf\u635f\u574f\u7684\u8bbe\u5907\uff0c\u6587\u4ef6\u7cfb\u7edf\u6216\u9a71\u52a8\u5668 # GNU ddrescue ( \u5b89\u88c5\u540e\u547d\u4ee4\u4e3a ddrescue ) \u7f51\u5740\uff1a http : // www . gnu . org / software / ddrescue / ddrescue . html # dd_rescue \u7f51\u5740\uff1a http : // www . garloff . de / kurt / linux / ddrescue / \u5982\u679c\u60a8\u6b63\u5728\u6210\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f\u5927\u4e8e 4 gig \uff0c\u5219\u5c06\u65e0\u6cd5\u4f7f\u7528 MSDOS \uff08 VFAT \uff09\u6587\u4ef6\u7cfb\u7edf\uff08\u901a\u5e38\u5728 USB \u9a71\u52a8\u5668\u4e0a\u627e\u5230\uff09\u6765\u5b58\u50a8\u56fe\u50cf\uff0c\u56e0\u4e3a\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a 4 G \u3002 \u8fd9\u6837\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u3002 \u4f7f\u7528 EXT3 \u6216\u5176\u4ed6\u53ef\u4ee5\u5904\u7406\u6b64\u7c7b\u6587\u4ef6\u5927\u5c0f\u7684\u6587\u4ef6\u7cfb\u7edf # \u5c06\u5728 / dev / hd2 \u7684\u5206\u533a\u6062\u590d\u5230 / dev / hdb2 ddrescue - r3 / dev / hda2 / dev / hdb2 logfie e2fsck - v - f / dev / hdb2 mount - t ext2 - o ro / dev / hdb2 / mnt # \u6062\u590d\u5728 / dev / cdrom \u4e2d\u7684\u4e00\u4e2a CD - ROM ,\u5c06 cdimage \u5199\u5165\u7a7a\u767d\u7684 CD - ROM ddrescue - b 2048 / dev / cdrom cdimage logfie \u4ece\u6062\u590d\u7684\u6620\u50cf\u63d0\u53d6\u6587\u4ef6\u7cfb\u7edf\u6765\u6062\u590d\u6587\u4ef6 \u5b89\u88c5 sleuthkit \u8f6f\u4ef6 mmls file - b \u6b64\u547d\u4ee4\u6765\u663e\u793a\u5728\u6620\u50cf\u4e2d\u627e\u5230\u7684\u5206\u533a mount - o loop , offset = 16384 file mnt \u663e\u793a\u591a\u4e2a\u5206\u533a\uff0c\u6b64\u793a\u4f8b\u4ece\u5757 32 \u5904\u5b89\u88c5 dos \u5206\u533a\uff0c\u8ba1\u7b97\u5b57\u8282\u6570\u9700\u8981\u4e58 512 \uff0c\u5f97\u51fa 16384 mount - t ntfs - or , force , loop , offset = 32256 file mnt \u6302\u8f7d windows \u521b\u5efa\u7684 ntfs \u5206\u533a ( 63 \u4e58 512 = 32256 ) \u5229\u7528 foremost \u6062\u590d\u6587\u4ef6,\u5047\u8bbe\u9700\u8981\u6062\u590d\u7684\u662f / dev / hda foremost - i / dev / hda - o / recovery / foremost foremost - t jpg - i / dev / hda - o / recovery / foremost \u6062\u590d\u7279\u5b9a\u7c7b\u578b\u6587\u4ef6 scalpel \u8f6f\u4ef6\u4e5f\u53ef\u7528\u6765\u6062\u590d\uff1a scalpel File - o dir File \u662f\u6620\u50cf\u6587\u4ef6\u6216\u8bbe\u5907\uff0c dir \u662f\u8f93\u51fa\u76ee\u5f55 magicrescue \u4f7f\u7528 magic bytes \u626b\u63cf\u6587\u4ef6\u6765\u8bc6\u522b\u6587\u4ef6\u7684\u5b58\u5728\u548c\u7c7b\u578b \u4ece / dev / sda1 \u5206\u533a\u6062\u590d gzip \u548c png \u6587\u4ef6\uff1a magicrescue - r gzip - r png - d ~/ output / dev / sda1 Photorec \u65e8\u5728\u4ece\u6570\u7801\u76f8\u673a\u7684\u5185\u5b58\u6216\u786c\u76d8\u4e2d\u6062\u590d\u4e22\u5931\u7684\u7167\u7247\uff0c\u5df2\u6269\u5c55\u652f\u6301 80 \u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u6587\u4ef6\uff0c photorec \u662f testdisk \u8f6f\u4ef6\u5305\u7684\u4e00\u90e8\u5206 ntfsprogs \u53ef\u4ee5\u4ece NTFS \u7cfb\u7edf\u6062\u590d\u5df2\u5220\u9664\u6587\u4ef6\uff0c Windows \u548c linux \u4e0b\u90fd\u6709\u6b64\u8f6f\u4ef6\uff0c\u5927\u81f4\u6709\u4e09\u79cd\u6a21\u5f0f\uff1a 1 . \u626b\u63cf\uff1a\u641c\u7d22\u5df2\u5220\u9664\u7684\u6587\u4ef6\u5e76\u67e5\u627e\u6709\u5173\u5b83\u4eec\u7684\u4fe1\u606f\uff0c nftsundelete / dev / sda1 2 . \u53d6\u6d88\u5220\u9664\uff1a ntfsundelete / dev / sda1 - u - i 3689 - o work . doc - d ~/ output 3 . \u590d\u5236\uff1a ntfsdelete / dev / sda1 - u - m * . jpg ntfsundelete / dev / sda1 - u - i 14159 \u6839\u636e\u6587\u4ef6\u7684 inode \u6062\u590d sleuth kit \u548c autopsy \u662f\u4e24\u4e2a\u57fa\u4e8e GUI \u7684\u6062\u590d\u8f6f\u4ef6 # extundelete \u4e3b\u9875\uff1a http : // extundelete . sourceforge . net / \u4e0b\u8f7d\u5730\u5740\uff1a http : // nchc . dl . sourceforge . net / project / extundelete / extundelete / 0 . 2 . 0 / extundelete - 0 . 2 . 0 . tar . bz2 ubuntu \u7528\u6237\u53ef\u76f4\u63a5\u5b89\u88c5: apt - get install extundelete . / configure && make && make install # \u5982\u679c\u63d0\u793a\u627e\u4e0d\u5230 ext2fs \u5e93\uff0c\u4f7f\u7528 yum - y install e2fsprogs * \u5b89\u88c5 # \u6570\u636e\u6062\u590d 1 . \u5378\u8f7d\u9700\u8981\u6062\u590d\u6587\u4ef6\u7684\u5206\u533a fuser - k / mnt / test / <-- \u7ed3\u675f\u4f7f\u7528\u67d0\u5206\u533a\u7684\u8fdb\u7a0b\u6811 umount / mnt / test <-- \u5378\u8f7d\u5206\u533a 2 . \u4f7f\u7528 extundelete \u67e5\u770b\u5206\u533a\u4e0a\u5b58\u5728\u7684\u6587\u4ef6 extundelete -- inode 2 / dev / sdb1 # -- inode \u4e3a\u67e5\u627e\u67d0 i \u8282\u70b9\u4e2d\u7684\u5185\u5bb9\uff0c\u4f7f\u7528 2 \u5219\u8bf4\u660e\u4e3a\u641c\u7d22\uff0c\u5982\u679c\u9700\u8fdb\u5165\u76ee\u5f55\u641c\u7d22\uff0c\u53ea\u987b\u8981\u6307\u5b9a\u76ee\u5f55 I \u8282\u70b9\u5373\u53ef # -- restore - inode \u6062\u590d\u6307\u5b9a\u7684 I \u8282\u70b9\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5168\u5c06\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6\u653e\u5728\u5f53\u524d\u8def\u5f84 RECOVERED_FILES / \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a file . I \u8282\u70b9\u53f7 extundelete -- restore - inode 13 / dev / sdb1 ls RECOVERED_FILES / mount / dev / sdb1 / mnt / test / mv RECOVERED_FILES / file . 13 / mnt / test / resolv . conf mv RECOVERED_FILES / file . 14 / mnt / test / hosts cat / mnt / test / hosts # \u67e5\u770b\u88ab\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6 \u662f\u5426\u4e0e\u6e90\u6587\u4ef6\u4e00\u81f4 cat / mnt / test / resolv . conf","title":"\u5176\u4ed6"},{"location":"Linux/#_13","text":"","title":"\u57fa\u672c\u670d\u52a1\u642d\u5efa"},{"location":"Linux/#vsftp","text":"VSFTPv3 . 0 . 3 \u7248\u672c\u914d\u7f6e vsftpd . conf\u6587\u4ef6\u8be6\u89e3 vsftpd . conf\u7684\u683c\u5f0f\u975e\u5e38\u7b80\u5355 \u3002\u6bcf\u4e00\u884c\u90fd\u662f\u6ce8\u91ca\u6216\u6307\u4ee4\u3002\u6ce8\u91ca\u884c\u4ee5\uff03\u5f00\u5934\u5e76\u88ab\u5ffd\u7565\u3002\u6307\u4ee4\u884c\u7684\u683c\u5f0f\u4e3a\uff1a\u9009\u9879 = \u503c \u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\u5728\u9009\u9879\uff0c = \u548c\u503c\u4e4b\u95f4\u653e\u7f6e\u4efb\u4f55\u7a7a\u683c\u662f\u9519\u8bef\u7684\u3002\u6bcf\u4e2a\u8bbe\u7f6e\u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7f16\u8bd1\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539 / etc / rc . d / init . d / vsftpd # \u542f\u52a8\u811a\u672c / etc / pam . d / vsftpd # PAM\u8ba4\u8bc1\u6587\u4ef6 / etc / vsftpd / ftpusers # \u7981\u6b62\u4f7f\u7528 Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6 / etc / vsftpd / user_list # \u7981\u6b62\u6216\u5141\u8bb8\u4f7f\u7528 Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6 / var / ftp # \u533f\u540d\u7528\u6237\u4e3b\u76ee\u5f55 \u5e03\u5c14\u9009\u9879\u5217\u8868\uff0c\u5e03\u5c14\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e\u4e3a yes\u6216no allow_anon_ssl \u4ec5\u5728 ssl_enable \u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\u9002\u7528 \u3002\u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \u9ed8\u8ba4\u503c\uff1a NO anon_mkdir_write_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u521b\u5efa\u65b0\u76ee\u5f55\u3002\u4e3a\u6b64\uff0c \u5fc5\u987b\u6fc0\u6d3b\u9009\u9879 write_enable \uff0c\u5e76\u4e14\u533f\u540d ftp\u7528\u6237\u5fc5\u987b\u5177\u6709\u7236\u76ee\u5f55\u7684\u5199\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a NO anon_other_write_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u6267\u884c\u9664\u4e0a\u8f7d\u548c\u521b\u5efa\u76ee\u5f55\u4e4b\u5916\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982\u5220\u9664\u548c\u91cd\u547d\u540d\u3002\u901a\u5e38\u4e0d\u5efa\u8bae\u8fd9\u6837\u505a\uff0c\u4f46\u4e3a\u4e86\u5b8c\u6574\u6027\u800c\u5305\u62ec\u5728\u5185 \u9ed8\u8ba4\u503c\uff1a NO anon_upload_enable \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u5141\u8bb8\u533f\u540d\u7528\u6237\u5728\u7279\u5b9a\u6761\u4ef6\u4e0b\u4e0a\u8f7d\u6587\u4ef6\u3002\u4e3a\u6b64\uff0c \u5fc5\u987b\u6fc0\u6d3b\u9009\u9879 write_enable \uff0c\u5e76\u4e14\u533f\u540d ftp\u7528\u6237\u5fc5\u987b\u5177\u6709\u6240\u9700\u4e0a\u8f7d\u4f4d\u7f6e\u7684\u5199\u5165\u6743\u9650 \u3002 \u865a\u62df\u7528\u6237\u4e0a\u4f20\u4e5f\u9700\u8981\u6b64\u8bbe\u7f6e , \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u865a\u62df\u7528\u6237\u4f7f\u7528\u533f\u540d\uff08\u5373\u6700\u5927\u9650\u5236\uff09\u6743\u9650\u8fdb\u884c\u5904\u7406 \u9ed8\u8ba4\u503c\uff1a NO anon_world_readable_only \u542f\u7528\u540e\uff0c\u5c06\u53ea\u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0b\u8f7d\u4e16\u754c\u53ef\u8bfb\u7684\u6587\u4ef6\u3002\u8fd9\u662f\u8ba4\u8bc6\u5230 ftp\u7528\u6237\u53ef\u80fd\u62e5\u6709\u6587\u4ef6 \uff0c\u5c24\u5176\u662f\u5728\u4e0a\u4f20\u7684\u60c5\u51b5\u4e0b \u9ed8\u8ba4\u503c\uff1a\u662f anonymous_enable \u63a7\u5236\u662f\u5426\u5141\u8bb8\u533f\u540d\u767b\u5f55\u3002\u5982\u679c\u542f\u7528\uff0c\u5219\u7528\u6237\u540d ftp \u548c anonymous \u90fd\u5c06\u88ab\u8bc6\u522b\u4e3a\u533f\u540d\u767b\u5f55 \u9ed8\u8ba4\u503c\uff1a YES ascii_download_enable \u542f\u7528\u540e\uff0c ASCII\u6a21\u5f0f\u6570\u636e\u4f20\u8f93\u5c06\u5728\u4e0b\u8f7d\u65f6\u53d7\u5230\u5c0a\u91cd \u9ed8\u8ba4\u503c\uff1a NO ascii_upload_enable \u542f\u7528\u540e\uff0c\u4e0a\u4f20\u65f6\u5c06\u9075\u5faa ASCII\u6a21\u5f0f\u6570\u636e\u4f20\u8f93 \u9ed8\u8ba4\u503c\uff1a NO async_abor_enable \u542f\u7528\u540e\uff0c\u5c06\u542f\u7528\u79f0\u4e3a\u201c\u5f02\u6b65 ABOR \u201d\u7684\u7279\u6b8a FTP\u547d\u4ee4 \u3002\u53ea\u6709\u4e0d\u660e\u667a\u7684 FTP\u5ba2\u6237\u7aef\u624d\u4f1a\u4f7f\u7528\u6b64\u529f\u80fd \u3002\u6b64\u5916\uff0c\u6b64\u529f\u80fd\u96be\u4ee5\u5904\u7406\uff0c\u56e0\u6b64\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7981\u7528\u3002\u9057\u61be\u7684\u662f\uff0c\u9664\u975e \u6b64\u529f\u80fd\u53ef\u7528\uff0c\u5426\u5219\u67d0\u4e9b FTP\u5ba2\u6237\u7aef\u5c06\u5728\u53d6\u6d88\u4f20\u8f93\u65f6\u6302\u8d77 \uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u5e0c\u671b\u542f\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a NO background \u542f\u7528\u540e\uff0c vsftpd\u4ee5 \u201c listen \u201d\u6a21\u5f0f\u542f\u52a8\uff0c vsftpd\u5c06\u4e3a\u4fa6\u542c\u5668\u8fdb\u7a0b\u63d0\u4f9b\u80cc\u666f \u3002\u5373\u63a7\u4ef6\u5c06\u7acb\u5373\u8fd4\u56de\u5230\u542f\u52a8 vsftpd\u7684shell \u9ed8\u8ba4\u503c\uff1a NO check_shell \u6ce8\u610f\uff01\u6b64\u9009\u9879\u4ec5\u5bf9 vsftpd\u7684\u975ePAM\u6784\u5efa\u6709\u6548 \u3002\u5982\u679c\u7981\u7528\uff0c vsftpd\u5c06\u4e0d\u4f1a\u68c0\u67e5 / etc / shells\u662f\u5426\u6709\u7528\u4e8e\u672c\u5730\u767b\u5f55\u7684\u7528\u6237shell \u9ed8\u8ba4\u503c\uff1a\u662f chmod_enable \u542f\u7528\u540e\uff0c\u5141\u8bb8\u4f7f\u7528 SITE CHMOD\u547d\u4ee4 \u3002\u6ce8\u610f\uff01\u8fd9\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u7528\u6237\u3002\u533f\u540d\u7528\u6237\u6c38\u8fdc\u4e0d\u4f1a\u4f7f\u7528 SITE CHMOD \u9ed8\u8ba4\u503c\uff1a\u662f chown_uploads \u5982\u679c\u542f\u7528\uff0c\u5219\u6240\u6709\u533f\u540d\u4e0a\u8f7d\u7684\u6587\u4ef6\u90fd\u5c06\u66f4\u6539\u4e3a\u8bbe\u7f6e chown_username\u4e2d\u6307\u5b9a\u7684\u7528\u6237 \u3002\u4ece\u7ba1\u7406\uff08\u53ef\u80fd\u662f\u5b89\u5168\u6027\uff09\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u8fd9\u5f88\u6709\u7528 \u9ed8\u8ba4\u503c\uff1a NO chroot_list_enable \u8bbe\u4e3a yes\u53ef\u4ee5\u5728\u767b\u5f55\u65f6\u63d0\u4f9b\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684chroot \uff08\uff09 jail\u4e2d\u7684\u672c\u5730\u7528\u6237\u5217\u8868 \u3002\u5982\u679c chroot_local_user\u8bbe\u7f6e\u4e3aYES \uff0c\u5219\u542b\u4e49\u7565\u6709\u4e0d\u540c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u5217\u8868\u4e0d\u88ab\u653e\u7f6e\u5728 chroot \uff08\uff09 jail\u4e2d\u7684\u7528\u6237\u5217\u8868 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5305\u542b\u6b64\u5217\u8868\u6587\u4ef6\u662f / etc / vsftpd . chroot_list \uff0c\u4f46\u53ef\u4f7f\u7528 chroot_list_file\u8bbe\u7f6e\u8986\u76d6\u5b83 \u9ed8\u8ba4\u503c\uff1a NO chroot_local_user \u5982\u679c\u8bbe\u7f6e\u4e3a YES \uff0c\u5219\u767b\u5f55\u540e\u672c\u5730\u7528\u6237\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\u5c06\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684 chroot \uff08\uff09 jail\u4e2d \u3002 \u8b66\u544a\uff1a \u6b64\u9009\u9879\u5177\u6709\u5b89\u5168\u9690\u60a3\uff0c\u5c24\u5176\u662f\u5728\u7528\u6237\u5177\u6709\u4e0a\u8f7d\u6743\u9650\u6216 shell\u8bbf\u95ee\u6743\u9650\u7684\u60c5\u51b5\u4e0b \u3002\u53ea\u6709\u5728\u60a8\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u65f6\u624d\u542f\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u5b89\u5168\u9690\u60a3\u4e0d\u662f vsftpd\u7279\u5b9a\u7684 \u3002 \u5b83\u4eec\u9002\u7528\u4e8e\u6240\u6709\u63d0\u4f9b\u5c06\u672c\u5730\u7528\u6237\u653e\u5165 chroot \uff08\uff09 jail\u7684FTP\u5b88\u62a4\u8fdb\u7a0b \u9ed8\u8ba4\u503c\uff1a NO connect_from_port_20 \u8fd9\u53ef\u4ee5\u63a7\u5236 PORT\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u662f\u5426\u5728\u670d\u52a1\u5668\u8ba1\u7b97\u673a\u4e0a\u4f7f\u7528\u7aef\u53e320 \uff08 ftp - data \uff09\u3002\u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0c\u4e00\u4e9b\u5ba2\u6237\u53ef\u80fd\u4f1a\u575a\u6301\u8ba4\u4e3a\u662f\u8fd9\u79cd\u60c5\u51b5\u3002\u76f8\u53cd\uff0c\u7981\u7528\u6b64\u9009\u9879 \u53ef\u4f7f vsftpd\u4ee5\u8f83\u4f4e\u7684\u6743\u9650\u8fd0\u884c \u9ed8\u8ba4\u503c\uff1a NO \uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 debug_ssl \u5982\u679c\u4e3a true \uff0c\u5219\u5c06 OpenSSL\u8fde\u63a5\u8bca\u65ad\u8f6c\u50a8\u5230vsftpd\u65e5\u5fd7\u6587\u4ef6 \u3002\uff08\u5728 v2 . 0 . 6 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO delete_failed_uploads \u5982\u679c\u4e3a true \uff0c\u5219\u5220\u9664\u4efb\u4f55\u5931\u8d25\u7684\u4e0a\u8f7d\u6587\u4ef6\u3002\uff08\u5728 v2 . 0 . 7 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO deny_email_enable \u5982\u679c\u6fc0\u6d3b\uff0c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u533f\u540d\u5bc6\u7801\u7535\u5b50\u90ae\u4ef6\u54cd\u5e94\u5217\u8868\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u767b\u5f55\u88ab\u62d2\u7edd\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5305\u542b\u6b64\u5217\u8868\u4e2d\u7684\u6587\u4ef6\u662f / etc / vsftpd . banned_emails \uff0c\u4f46\u4f60\u53ef\u4ee5\u4e0e \u8986\u76d6\u8fd9\u4e2a banned_email_file \u8bbe\u7f6e \u9ed8\u8ba4\u503c\uff1a NO dirlist_enable \u5982\u679c\u8bbe\u7f6e\u4e3a NO \uff0c\u5219\u6240\u6709\u76ee\u5f55\u5217\u8868\u547d\u4ee4\u90fd\u5c06\u62d2\u7edd\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a\u662f dirmessage_enable \u5982\u679c\u542f\u7528\uff0c FTP\u670d\u52a1\u5668\u7684\u7528\u6237\u9996\u6b21\u8fdb\u5165\u65b0\u76ee\u5f55\u65f6\u53ef\u4ee5\u663e\u793a\u6d88\u606f \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f1a\u626b\u63cf\u76ee\u5f55\u4ee5\u67e5\u627e\u6587\u4ef6 . message \uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u8bbe\u7f6e message_file\u8986\u76d6\u8be5\u76ee\u5f55 \u9ed8\u8ba4\u503c\uff1a NO \uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 download_enable \u5982\u679c\u8bbe\u7f6e\u4e3a NO \uff0c\u5219\u6240\u6709\u4e0b\u8f7d\u8bf7\u6c42\u90fd\u5c06\u62d2\u7edd\u6743\u9650 \u9ed8\u8ba4\u503c\uff1a\u662f dual_log_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4f1a\u5e76\u884c\u751f\u6210\u4e24\u4e2a\u65e5\u5fd7\u6587\u4ef6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a / var / log / xferlog \u548c / var / log / vsftpd . log \u3002\u524d\u8005\u662f\u4e00\u4e2a wu - ftpd\u6837\u5f0f\u7684\u4f20\u8f93\u65e5\u5fd7 \uff0c\u53ef\u4ee5 \u901a\u8fc7\u6807\u51c6\u5de5\u5177\u89e3\u6790\u3002\u540e\u8005\u662f vsftpd\u81ea\u5df1\u7684\u6837\u5f0f\u65e5\u5fd7 \u9ed8\u8ba4\u503c\uff1a NO force_dot_files \u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u4ee5\u3002\u5f00\u5934\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u3002\u5373\u4f7f\u5ba2\u6237\u7aef\u672a\u4f7f\u7528\u201c a \u201d\u6807\u5fd7\uff0c\u4e5f\u5c06\u663e\u793a\u5728\u76ee\u5f55\u5217\u8868\u4e2d\u3002\u6b64\u8986\u76d6\u4e0d\u5305\u62ec\u201c\u3002\u201d \u548c\u201c .. \u201d\u6761\u76ee \u9ed8\u8ba4\u503c\uff1a NO force_anon_data_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \uff0c\u4ee5\u4fbf\u5728\u6570\u636e\u8fde\u63a5\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e \u9ed8\u8ba4\u503c\uff1a NO force_anon_logins_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5\u4ee5\u53d1\u9001\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1a NO force_local_data_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5 \uff0c\u4ee5\u4fbf\u5728\u6570\u636e\u8fde\u63a5\u4e0a\u53d1\u9001\u548c\u63a5\u6536\u6570\u636e \u9ed8\u8ba4\u503c\uff1a\u662f force_local_logins_ssl \u4ec5 \u5728\u6fc0\u6d3b ssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u6fc0\u6d3b\uff0c\u5219\u5f3a\u5236\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u4f7f\u7528\u5b89\u5168 SSL\u8fde\u63a5\u4ee5\u53d1\u9001\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1a\u662f guest_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u6240\u6709\u975e\u533f\u540d\u767b\u5f55\u90fd\u88ab\u5f52\u7c7b\u4e3a\u201c\u8bbf\u5ba2\u201d\u767b\u5f55\u3002 guest \u865a\u62df\u673a\u767b\u5f55\u5c06\u91cd\u65b0\u6620\u5c04\u5230 guest_username \u8bbe\u7f6e\u4e2d\u6307\u5b9a\u7684\u7528\u6237 \u9ed8\u8ba4\u503c\uff1a NO hide_ids \u5982\u679c\u542f\u7528\uff0c\u76ee\u5f55\u5217\u8868\u4e2d\u7684\u6240\u6709\u7528\u6237\u548c\u7ec4\u4fe1\u606f\u5c06\u663e\u793a\u4e3a\u201c ftp \u201d \u9ed8\u8ba4\u503c\uff1a NO implicit_ssl \u5982\u679c\u542f\u7528\uff0c\u5219 SSL\u63e1\u624b\u662f\u6240\u6709\u8fde\u63a5 \uff08 FTPS\u534f\u8bae \uff09\u4e0a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u3002\u8981\u652f\u6301\u663e\u5f0f SSL\u548c / \u6216\u7eaf\u6587\u672c\uff0c\u8fd8\u5e94\u8fd0\u884c\u5355\u72ec\u7684 vsftpd\u4fa6\u542c\u5668\u8fdb\u7a0b \u9ed8\u8ba4\u503c\uff1a NO \u542c \u5982\u679c\u542f\u7528\uff0c vsftpd\u5c06\u4ee5\u72ec\u7acb\u6a21\u5f0f\u8fd0\u884c \u3002\u8fd9\u610f\u5473\u7740 vsftpd\u4e0d\u80fd\u4ece\u67d0\u79cd\u7c7b\u578b\u7684inetd\u8fd0\u884c \u3002\u76f8\u53cd\uff0c vsftpd\u53ef\u6267\u884c\u6587\u4ef6\u76f4\u63a5\u8fd0\u884c\u4e00\u6b21 \u3002 \u7136\u540e\uff0c vsftpd\u5c06\u8d1f\u8d23\u76d1\u542c\u548c\u5904\u7406\u4f20\u5165\u7684\u8fde\u63a5 \u9ed8\u8ba4\u503c\uff1a\u662f listen_ipv6 \u4e0e listen\u53c2\u6570\u4e00\u6837 \uff0c\u9664\u4e86 vsftpd\u5c06\u4fa6\u542cIPv6\u5957\u63a5\u5b57\u800c\u4e0d\u662fIPv4\u5957\u63a5\u5b57 \u3002\u6b64\u53c2\u6570\u548c listen\u53c2\u6570\u662f\u4e92\u65a5\u7684 \u9ed8\u8ba4\u503c\uff1a NO local_enable \u63a7\u5236\u662f\u5426\u5141\u8bb8\u672c\u5730\u767b\u5f55\u3002\u5982\u679c\u542f\u7528\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 / etc / passwd\u4e2d\u7684\u666e\u901a\u7528\u6237\u5e10\u6237 \uff08\u6216 PAM\u914d\u7f6e\u5f15\u7528\u7684\u4efb\u4f55\u4f4d\u7f6e \uff09\u767b\u5f55\u3002 \u5fc5\u987b\u542f\u7528\u6b64\u529f\u80fd\u624d\u80fd\u4f7f\u4efb\u4f55\u975e\u533f\u540d\u767b\u5f55\u5de5\u4f5c\uff0c\u5305\u62ec\u865a\u62df\u7528\u6237 \u9ed8\u8ba4\u503c\uff1a NO lock_upload_files \u542f\u7528\u540e\uff0c\u6240\u6709\u4e0a\u8f7d\u90fd\u4f1a\u7ee7\u7eed\u5bf9\u4e0a\u8f7d\u6587\u4ef6\u8fdb\u884c\u5199\u9501\u5b9a\u3002\u6240\u6709\u4e0b\u8f7d\u90fd\u7ee7\u7eed\u4e0b\u8f7d\u6587\u4ef6\u4e0a\u7684\u5171\u4eab\u8bfb\u9501\u5b9a\u3002 \u8b66\u544a\uff01\u5728\u542f\u7528\u6b64\u529f\u80fd\u4e4b\u524d\uff0c\u8bf7\u6ce8\u610f\u6076\u610f\u9605\u8bfb\u5668\u53ef\u80fd\u4f1a\u4f7f\u60f3\u8981\u6dfb\u52a0\u6587\u4ef6\u7684\u4f5c\u8005\u611f\u5230\u9965\u997f \u9ed8\u8ba4\u503c\uff1a\u662f log_ftp_protocol \u542f\u7528\u540e\uff0c\u5c06\u8bb0\u5f55\u6240\u6709 FTP\u8bf7\u6c42\u548c\u54cd\u5e94 \uff0c\u524d\u63d0\u662f\u672a\u542f\u7528 xferlog_std_format\u9009\u9879 \u3002\u7528\u4e8e\u8c03\u8bd5 \u9ed8\u8ba4\u503c\uff1a NO ls_recurse_enable \u542f\u7528\u540e\uff0c\u6b64\u8bbe\u7f6e\u5c06\u5141\u8bb8\u4f7f\u7528\u201c ls - R \u201d\u3002\u8fd9\u662f\u4e00\u4e2a\u8f83\u5c0f\u7684\u5b89\u5168\u98ce\u9669\uff0c\u56e0\u4e3a\u5927\u578b\u7ad9\u70b9\u9876\u5c42\u7684 ls - R\u53ef\u80fd\u4f1a\u6d88\u8017\u5927\u91cf\u8d44\u6e90 \u9ed8\u8ba4\u503c\uff1a NO mdtm_write \u542f\u7528\u540e\uff0c\u6b64\u8bbe\u7f6e\u5c06\u5141\u8bb8 MDTM\u8bbe\u7f6e\u6587\u4ef6\u4fee\u6539\u65f6\u95f4 \uff08\u6839\u636e\u901a\u5e38\u7684\u8bbf\u95ee\u68c0\u67e5\uff09 \u9ed8\u8ba4\u503c\uff1a\u662f no_anon_password \u542f\u7528\u540e\uff0c\u8fd9\u4f1a\u963b\u6b62 vsftpd\u8bf7\u6c42\u533f\u540d\u5bc6\u7801 - \u533f\u540d\u7528\u6237\u5c06\u76f4\u63a5\u767b\u5f55 \u9ed8\u8ba4\u503c\uff1a NO no_log_lock \u542f\u7528\u540e\uff0c\u8fd9\u4f1a\u963b\u6b62 vsftpd\u5728\u5199\u5165\u65e5\u5fd7\u6587\u4ef6\u65f6\u8fdb\u884c\u6587\u4ef6\u9501\u5b9a \u3002\u901a\u5e38\u4e0d\u5e94\u542f\u7528\u6b64\u9009\u9879\u3002\u5b83\u5b58\u5728\u4ee5\u89e3\u51b3\u64cd\u4f5c\u7cfb\u7edf\u9519\u8bef\uff0c\u4f8b\u5982 Solaris / Veritas\u6587\u4ef6\u7cfb\u7edf\u7ec4\u5408 \uff0c \u5df2\u7ecf\u89c2\u5bdf\u5230\u6709\u65f6\u4f1a\u51fa\u73b0\u8bd5\u56fe\u9501\u5b9a\u65e5\u5fd7\u6587\u4ef6\u7684\u6302\u8d77 \u9ed8\u8ba4\u503c\uff1a NO one_process_model \u5982\u679c\u60a8\u6709 Linux 2 . 4 \u5185\u6838\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u5b89\u5168\u6a21\u578b\uff0c\u6bcf\u4e2a\u8fde\u63a5\u53ea\u4f7f\u7528\u4e00\u4e2a\u8fdb\u7a0b\u3002\u5b83\u662f\u4e00\u79cd\u4e0d\u592a\u7eaf\u7cb9\u7684\u5b89\u5168\u6a21\u578b\uff0c\u4f46\u4f1a\u63d0\u9ad8\u60a8\u7684\u6027\u80fd\u3002 \u9664\u975e\u60a8\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\uff0c\u5e76\u4e14\u60a8\u7684\u7ad9\u70b9\u652f\u6301\u5927\u91cf\u540c\u65f6\u8fde\u63a5\u7684\u7528\u6237\uff0c\u5426\u5219\u60a8\u771f\u7684\u4e0d\u60f3\u542f\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a NO passwd_chroot_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4e0e chroot_local_user\u4e00\u8d77 \uff0c\u7136\u540e\u53ef\u4ee5\u57fa\u4e8e\u6bcf\u4e2a\u7528\u6237\u6307\u5b9a chroot \uff08\uff09 jail\u4f4d\u7f6e \u3002\u6bcf\u4e2a\u7528\u6237\u7684 jail\u90fd\u662f\u4ece / etc / passwd\u4e2d \u7684\u4e3b\u76ee\u5f55\u5b57\u7b26\u4e32\u6d3e\u751f\u7684\u3002\u4e3b\u76ee\u5f55\u5b57\u7b26\u4e32\u4e2d\u51fa\u73b0 / . / \u8868\u793a jail\u4f4d\u4e8e\u8def\u5f84\u4e2d\u7684\u7279\u5b9a\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1a NO pasv_addr_resolve \u5982\u679c\u8981\u5728 pasv_address \u9009\u9879\u4e2d\u4f7f\u7528\u4e3b\u673a\u540d\uff08\u800c\u4e0d\u662f IP\u5730\u5740 \uff09\uff0c\u8bf7\u8bbe\u7f6e\u4e3a YES \u9ed8\u8ba4\u503c\uff1a NO pasv_enable \u5982\u679c\u8981\u7981\u7528 PASV\u83b7\u53d6\u6570\u636e\u8fde\u63a5\u7684\u65b9\u6cd5 \uff0c\u8bf7\u8bbe\u7f6e\u4e3a NO \u9ed8\u8ba4\u503c\uff1a\u662f pasv_promiscuous \u5982\u679c\u8981\u7981\u7528 PASV\u5b89\u5168\u68c0\u67e5 \uff0c\u5219\u8bbe\u7f6e\u4e3a YES \uff0c\u4ee5\u786e\u4fdd\u6570\u636e\u8fde\u63a5\u6e90\u81ea\u4e0e\u63a7\u5236\u8fde\u63a5\u76f8\u540c\u7684 IP\u5730\u5740 \u3002\u53ea\u6709\u5728\u4f60\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u542f\u7528\u5bf9\u6b64\u7684\u552f\u4e00\u5408\u6cd5 \u7528\u9014\u662f\u91c7\u7528\u67d0\u79cd\u5f62\u5f0f\u7684\u5b89\u5168\u96a7\u9053\u65b9\u6848\uff0c\u6216\u8005\u53ef\u80fd\u662f\u4e3a\u4e86\u4fc3\u8fdb FXP\u652f\u6301 \u9ed8\u8ba4\u503c\uff1a NO port_enable \u5982\u679c\u8981\u7981\u6b62 PORT\u65b9\u6cd5\u83b7\u53d6\u6570\u636e\u8fde\u63a5 \uff0c\u8bf7\u8bbe\u7f6e\u4e3a NO \u9ed8\u8ba4\u503c\uff1a\u662f port_promiscuous \u5982\u679c\u8981\u7981\u7528 PORT\u5b89\u5168\u68c0\u67e5 \uff0c\u5219\u8bbe\u7f6e\u4e3a YES \uff0c\u4ee5\u786e\u4fdd\u4f20\u51fa\u6570\u636e\u8fde\u63a5\u53ea\u80fd\u8fde\u63a5\u5230\u5ba2\u6237\u7aef\u3002\u53ea\u6709\u5728\u4f60\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u542f\u7528 \u9ed8\u8ba4\u503c\uff1a NO require_cert \u5982\u679c\u8bbe\u7f6e\u4e3a yes \uff0c\u5219\u9700\u8981\u6240\u6709 SSL\u5ba2\u6237\u7aef\u8fde\u63a5\u6765\u63d0\u4f9b\u5ba2\u6237\u7aef\u8bc1\u4e66 \u3002\u5e94\u7528\u4e8e\u6b64\u8bc1\u4e66\u7684\u9a8c\u8bc1\u7a0b\u5ea6\u7531 validate_cert\u63a7\u5236 \uff08\u5728 v2 . 0 . 6 \u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a NO require_ssl_reuse \u5982\u679c\u8bbe\u7f6e\u4e3a yes \uff0c\u5219\u9700\u8981\u6240\u6709 SSL\u6570\u636e\u8fde\u63a5\u4ee5\u5c55\u793aSSL\u4f1a\u8bdd\u91cd\u7528 \uff08\u8fd9\u8bc1\u660e\u5b83\u4eec\u77e5\u9053\u4e0e\u63a7\u5236\u901a\u9053\u76f8\u540c\u7684\u4e3b\u5bc6\u94a5\uff09\u3002\u867d\u7136\u8fd9\u662f\u4e00\u4e2a\u5b89\u5168\u7684\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u4f46\u5b83\u53ef\u80fd\u4f1a\u7834\u574f \u8bb8\u591a FTP\u5ba2\u6237\u7aef \uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u5e0c\u671b\u7981\u7528\u5b83 \u9ed8\u8ba4\u503c\uff1a\u662f run_as_launching_user \u5982\u679c\u60a8\u5e0c\u671b vsftpd\u4ee5\u542f\u52a8vsftpd\u7684\u7528\u6237\u8eab\u4efd\u8fd0\u884c \uff0c\u8bf7\u8bbe\u7f6e\u4e3a YES \u3002\u5728\u6839\u8bbf\u95ee\u4e0d\u53ef\u7528\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u5f88\u6709\u7528\u3002\u5927\u89c4\u6a21\u8b66\u544a\uff01\u9664\u975e\u60a8\u5b8c\u5168\u77e5\u9053\u81ea\u5df1\u5728\u505a\u4ec0\u4e48\uff0c \u5426\u5219\u4e0d\u8981\u542f\u7528\u6b64\u9009\u9879\uff0c\u56e0\u4e3a\u5929\u771f\u5730\u4f7f\u7528\u6b64\u9009\u9879\u4f1a\u4ea7\u751f\u5927\u91cf\u5b89\u5168\u95ee\u9898\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5f53\u8bbe\u7f6e\u6b64\u9009\u9879\u65f6\uff0c vsftpd\u4e0d\u4f1a / \u4e0d\u80fd\u4f7f\u7528 chroot\u6280\u672f\u6765\u9650\u5236\u6587\u4ef6\u8bbf\u95ee \uff08\u5373\u4f7f\u7531 root\u542f\u52a8 \uff09\u3002\u4e00\u4e2a\u7cdf\u7cd5\u7684\u66ff\u4ee3\u54c1\u53ef\u80fd\u662f\u4f7f\u7528 deny_file \u8bbe\u7f6e\u5982{ /* }\uff0c\u4f46\u8fd9\u79cd\u53ef\u9760\u6027\u65e0\u6cd5\u4e0echroot\u76f8\u6bd4\uff0c\u5e76\u4e14\u4e0d\u5e94\u8be5\u4f9d\u8d56\u3002\u5982\u679c\u4f7f\u7528\u6b64\u9009\u9879\uff0c \u5219\u9002\u7528\u5bf9\u5176\u4ed6\u9009\u9879\u7684\u8bb8\u591a\u9650\u5236\u3002\u4f8b\u5982\uff0c\u9700\u8981\u6743\u9650\u7684\u9009\u9879\uff08\u4f8b\u5982\u975e\u533f\u540d\u767b\u5f55\uff0c\u4e0a\u8f7d\u6240\u6709\u6743\u66f4\u6539\uff0c\u4ece\u7aef\u53e320\u8fde\u63a5\u548c\u5c0f\u4e8e1024\u7684\u4fa6\u542c\u7aef\u53e3\uff09\u9884\u8ba1\u4e0d\u8d77\u4f5c\u7528\u3002 \u5176\u4ed6\u9009\u9879\u53ef\u80fd\u4f1a\u53d7\u5230\u5f71\u54cd \u9ed8\u8ba4\u503c\uff1aNO secure_email_list_enable \u5982\u679c\u60a8\u53ea\u60f3\u63a5\u53d7\u533f\u540d\u767b\u5f55\u7684\u6307\u5b9a\u7535\u5b50\u90ae\u4ef6\u5bc6\u7801\u5217\u8868\uff0c\u8bf7\u8bbe\u7f6e\u4e3aYES\u3002\u8fd9\u975e\u5e38\u6709\u7528\uff0c\u53ef\u4ee5\u5728\u4e0d\u9700\u8981\u865a\u62df\u7528\u6237\u7684\u60c5\u51b5\u4e0b\u9650\u5236\u5bf9\u4f4e\u5b89\u5168\u6027\u5185\u5bb9\u7684\u8bbf\u95ee\u3002\u542f\u7528\u540e\uff0c\u9664\u975e \u63d0\u4f9b\u7684\u5bc6\u7801\u5217\u5728email_password_file \u8bbe\u7f6e\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d\uff0c\u5426\u5219\u5c06\u963b\u6b62\u533f\u540d\u767b\u5f55 \u3002\u6587\u4ef6\u683c\u5f0f\u662f\u6bcf\u884c\u4e00\u4e2a\u5bc6\u7801\uff0c\u6ca1\u6709\u989d\u5916\u7684\u7a7a\u683c\u3002 \u9ed8\u8ba4\u6587\u4ef6\u540d\u662f/etc/vsftpd.email_passwords \u9ed8\u8ba4\u503c\uff1aNO session_support \u8fd9\u53ef\u4ee5\u63a7\u5236vsftpd\u662f\u5426\u5c1d\u8bd5\u7ef4\u62a4\u767b\u5f55\u4f1a\u8bdd\u3002\u5982\u679cvsftpd\u7ef4\u62a4\u4f1a\u8bdd\uff0c\u5b83\u5c06\u5c1d\u8bd5\u66f4\u65b0utmp\u548cwtmp\u3002\u5982\u679c\u4f7f\u7528PAM\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5b83\u4e5f\u4f1a\u6253\u5f00\u4e00\u4e2apam_session\uff0c \u5e76\u4e14\u53ea\u6709\u5728\u6ce8\u9500\u65f6\u5173\u95ed\u5b83\u3002\u5982\u679c\u60a8\u4e0d\u9700\u8981\u4f1a\u8bdd\u65e5\u5fd7\u8bb0\u5f55\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u7981\u7528\u6b64\u529f\u80fd\uff0c\u5e76\u4e14\u60a8\u5e0c\u671b\u4e3avsftpd\u63d0\u4f9b\u66f4\u591a\u673a\u4f1a\u4ee5\u66f4\u5c11\u7684\u8fdb\u7a0b\u548c/\u6216\u66f4\u5c11\u7684\u6743\u9650\u8fd0\u884c\u3002 \u6ce8 - utmp\u548cwtmp\u652f\u6301\u4ec5\u5728PAM\u542f\u200b\u200b\u7528\u7684\u7248\u672c\u4e2d\u63d0\u4f9b \u9ed8\u8ba4\u503c\uff1aNO setproctitle_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u5c1d\u8bd5\u5728\u7cfb\u7edf\u8fdb\u7a0b\u5217\u8868\u4e2d\u663e\u793a\u4f1a\u8bdd\u72b6\u6001\u4fe1\u606f\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u62a5\u544a\u7684\u8fdb\u7a0b\u540d\u79f0\u5c06\u66f4\u6539\u4ee5\u53cd\u6620vsftpd\u4f1a\u8bdd\u6b63\u5728\u6267\u884c\u7684\u64cd\u4f5c\uff08\u7a7a\u95f2\uff0c\u4e0b\u8f7d\u7b49\uff09\u3002 \u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5c06\u5176\u5173\u95ed \u9ed8\u8ba4\u503c\uff1aNO ssl_enable \u5982\u679c\u542f\u7528\uff0c\u5e76\u4e14vsftpd\u662f\u9488\u5bf9OpenSSL\u7f16\u8bd1\u7684\uff0c\u5219vsftpd\u5c06\u901a\u8fc7SSL\u652f\u6301\u5b89\u5168\u8fde\u63a5\u3002\u8fd9\u9002\u7528\u4e8e\u63a7\u5236\u8fde\u63a5\uff08\u5305\u62ec\u767b\u5f55\uff09\u4ee5\u53ca\u6570\u636e\u8fde\u63a5\u3002 \u60a8\u4e5f\u9700\u8981\u4e00\u4e2a\u652f\u6301SSL\u7684\u5ba2\u6237\u7aef\u3002\u6ce8\u610f\uff01\uff01\u8bf7\u6ce8\u610f\u542f\u7528\u6b64\u9009\u9879\u3002\u53ea\u6709\u5728\u9700\u8981\u65f6\u624d\u542f\u7528\u5b83\u3002vsftpd\u65e0\u6cd5\u4fdd\u8bc1OpenSSL\u5e93\u7684\u5b89\u5168\u6027\u3002\u901a\u8fc7\u542f\u7528\u6b64\u9009\u9879\uff0c \u60a8\u58f0\u660e\u60a8\u4fe1\u4efb\u5df2\u5b89\u88c5\u7684OpenSSL\u5e93\u7684\u5b89\u5168\u6027 \u9ed8\u8ba4\u503c\uff1aNO ssl_request_cert \u5982\u679c\u542f\u7528\uff0cvsftpd\u4f1a\u8981\u6c42\uff08\u4f46\u4e0d\u4e00\u5b9a\u9700\u8981,\u89c1 require_cert\uff09\u4e00\u4e2a\u8bc1\u4e66\u4e0a\u7684\u4f20\u5165 SSL \u8fde\u63a5\u3002\u901a\u5e38\u8fd9 \u4e0d\u5e94\u8be5\u9020\u6210\u4efb\u4f55\u9ebb\u70e6 \u9ed8\u8ba4\u503c\uff1a\u662f ssl_sslv2 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8SSL v2\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1aNO ssl_sslv3 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8SSL v3\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1aNO ssl_tlsv1 \u4ec5 \u5728\u6fc0\u6d3bssl_enable\u65f6\u9002\u7528 \u3002\u5982\u679c\u542f\u7528\uff0c\u6b64\u9009\u9879\u5c06\u5141\u8bb8TLS v1\u534f\u8bae\u8fde\u63a5\u3002TLS v1\u8fde\u63a5\u662f\u9996\u9009 \u9ed8\u8ba4\u503c\uff1a\u662f strict_ssl_read_eof \u5982\u679c\u542f\u7528\uff0c\u5219\u9700\u8981\u901a\u8fc7SSL\u7ec8\u6b62SSL\u6570\u636e\u4e0a\u8f7d\uff0c\u800c\u4e0d\u662f\u5957\u63a5\u5b57\u4e0a\u7684EOF\u3002\u9700\u8981\u6b64\u9009\u9879\u4ee5\u786e\u4fdd\u653b\u51fb\u8005\u672a\u4f7f\u7528\u4f2a\u9020\u7684TCP FIN\u8fc7\u65e9\u7ec8\u6b62\u4e0a\u8f7d\u3002\u4e0d\u5e78\u7684\u662f\uff0c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u6ca1\u6709\u542f\u7528\uff0c\u56e0\u4e3a\u5f88\u5c11\u6709\u5ba2\u6237\u7aef\u80fd\u591f\u6b63\u786e\u4f7f\u7528\u5b83\u3002\uff08v2.0.7\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO strict_ssl_write_shutdown \u5982\u679c\u542f\u7528\uff0c\u5219\u9700\u8981\u901a\u8fc7SSL\u7ec8\u6b62SSL\u6570\u636e\u4e0b\u8f7d\uff0c\u800c\u4e0d\u662f\u5957\u63a5\u5b57\u4e0a\u7684EOF\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8fd9\u662f\u5173\u95ed\u7684\uff0c\u56e0\u4e3a\u6211\u65e0\u6cd5\u627e\u5230\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u5355\u4e2aFTP\u5ba2\u6237\u7aef\u3002 \u8fd9\u662f\u6b21\u8981\u7684\u3002\u5b83\u5f71\u54cd\u7684\u662f\u6211\u4eec\u5224\u65ad\u5ba2\u6237\u662f\u5426\u786e\u8ba4\u5b8c\u5168\u6536\u5230\u8be5\u6587\u4ef6\u7684\u80fd\u529b\u3002\u5373\u4f7f\u6ca1\u6709\u6b64\u9009\u9879\uff0c\u5ba2\u6237\u7aef\u4e5f\u80fd\u591f\u68c0\u67e5\u4e0b\u8f7d\u7684\u5b8c\u6574\u6027\u3002\uff08v2.0.7\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO syslog_enable \u5982\u679c\u542f\u7528\uff0c\u5219\u4efb\u4f55\u5df2\u8f6c\u81f3/var/log/vsftpd.log\u7684\u65e5\u5fd7\u8f93\u51fa\u5c06\u8f6c\u5230\u7cfb\u7edf\u65e5\u5fd7\u3002\u8bb0\u5f55\u5728FTPD\u5de5\u5177\u4e0b\u5b8c\u6210 \u9ed8\u8ba4\u503c\uff1aNO tcp_wrappers\u7684 \u5982\u679c\u542f\u7528\uff0c\u5e76\u4e14vsftpd\u662f\u4f7f\u7528tcp_wrappers\u652f\u6301\u7f16\u8bd1\u7684\uff0c\u5219\u4f20\u5165\u8fde\u63a5\u5c06\u901a\u8fc7tcp_wrappers\u8bbf\u95ee\u63a7\u5236\u63d0\u4f9b\u3002\u6b64\u5916\uff0c\u8fd8\u6709\u4e00\u79cd\u57fa\u4e8e\u6bcf\u4e2aIP\u7684\u914d\u7f6e\u673a\u5236\u3002 \u5982\u679ctcp_wrappers\u8bbe\u7f6eVSFTPD_LOAD_CONF\u73af\u5883\u53d8\u91cf\uff0c\u5219vsftpd\u4f1a\u8bdd\u5c06\u5c1d\u8bd5\u52a0\u8f7d\u6b64\u53d8\u91cf\u4e2d\u6307\u5b9a\u7684vsftpd\u914d\u7f6e\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1aNO text_userdb_names \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6570\u5b57ID\u663e\u793a\u5728\u76ee\u5f55\u5217\u8868\u7684\u7528\u6237\u548c\u7ec4\u5b57\u6bb5\u4e2d\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u542f\u7528\u6b64\u53c2\u6570\u6765\u83b7\u53d6\u6587\u672c\u540d\u79f0\u3002\u51fa\u4e8e\u6027\u80fd\u539f\u56e0\uff0c\u5b83\u9ed8\u8ba4\u662f\u5173\u95ed\u7684 \u9ed8\u8ba4\u503c\uff1aNO tilde_user_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u5c1d\u8bd5\u89e3\u6790\u8def\u5f84\u540d\uff0c\u4f8b\u5982~chris / pics\uff0c\u5373\u4ee3\u5b57\u53f7\u540e\u8ddf\u7528\u6237\u540d\u3002\u8bf7\u6ce8\u610f\uff0cvsftpd\u5c06\u59cb\u7ec8\u89e3\u6790\u8def\u5f84\u540d\u301c\u548c\u301c/ something \uff08\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u301c\u89e3\u6790\u4e3a\u521d\u59cb\u767b\u5f55\u76ee\u5f55\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u53ea\u6709 \u5728_current_ chroot\uff08\uff09jail\u4e2d\u627e\u5230\u6587\u4ef6/ etc / passwd\u65f6\uff0c\u301c\u7528\u6237\u8def\u5f84\u624d\u4f1a\u89e3\u6790 \u9ed8\u8ba4\u503c\uff1aNO use_localtime \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u663e\u793a\u5f53\u524d\u65f6\u533a\u4e2d\u5305\u542b\u65f6\u95f4\u7684\u76ee\u5f55\u5217\u8868\u3002\u9ed8\u8ba4\u4e3a\u663e\u793aGMT\u3002MDTM FTP\u547d\u4ee4\u8fd4\u56de\u7684\u65f6\u95f4\u4e5f\u53d7\u6b64\u9009\u9879\u7684\u5f71\u54cd \u9ed8\u8ba4\u503c\uff1aNO use_sendfile \u7528\u4e8e\u6d4b\u8bd5\u5728\u5e73\u53f0\u4e0a\u4f7f\u7528sendfile\uff08\uff09\u7cfb\u7edf\u8c03\u7528\u7684\u76f8\u5bf9\u597d\u5904\u7684\u5185\u90e8\u8bbe\u7f6e \u9ed8\u8ba4\u503c\uff1a\u662f userlist_deny \u5982\u679c \u6fc0\u6d3buserlist_enable\uff0c\u5219\u68c0\u67e5\u6b64\u9009\u9879 \u3002\u5982\u679c\u5c06\u6b64\u8bbe\u7f6e\u8bbe\u7f6e\u4e3aNO\uff0c\u5219\u5c06\u62d2\u7edd\u7528\u6237\u767b\u5f55\uff0c\u9664\u975e\u5b83\u4eec\u660e\u786e\u5217\u5728userlist_file\u6307\u5b9a\u7684\u6587\u4ef6\u4e2d \u3002 \u62d2\u7edd\u767b\u5f55\u65f6\uff0c\u5c06\u5728\u8981\u6c42\u7528\u6237\u8f93\u5165\u5bc6\u7801\u4e4b\u524d\u53d1\u51fa\u62d2\u7edd \u9ed8\u8ba4\u503c\uff1a\u662f userlist_enable \u5982\u679c\u542f\u7528\uff0cvsftpd\u5c06\u4eceuserlist_file\u7ed9\u51fa\u7684\u6587\u4ef6\u540d\u52a0\u8f7d\u7528\u6237\u540d\u5217\u8868 \u3002\u5982\u679c\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u6b64\u6587\u4ef6\u4e2d\u7684\u540d\u79f0\u767b\u5f55\uff0c\u5219\u5728\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u4e4b\u524d\uff0c \u4ed6\u4eec\u5c06\u88ab\u62d2\u7edd\u3002\u8fd9\u53ef\u80fd\u6709\u52a9\u4e8e\u9632\u6b62\u4f20\u8f93\u660e\u6587\u5bc6\u7801\u3002\u53e6\u8bf7\u53c2\u89c1 userlist_deny \u9ed8\u8ba4\u503c\uff1aNO validate_cert \u5982\u679c\u8bbe\u7f6e\u4e3ayes\uff0c\u5219\u6536\u5230\u7684\u6240\u6709SSL\u5ba2\u6237\u7aef\u8bc1\u4e66\u90fd\u5fc5\u987b\u9a8c\u8bc1OK\u3002\u81ea\u7b7e\u540d\u8bc1\u4e66\u4e0d\u6784\u6210OK\u9a8c\u8bc1\u3002\uff08v2.0.6\u4e2d\u7684\u65b0\u529f\u80fd\uff09 \u9ed8\u8ba4\u503c\uff1aNO virtual_use_local_privs \u5982\u679c\u542f\u7528\uff0c\u865a\u62df\u7528\u6237\u5c06\u4f7f\u7528\u4e0e\u672c\u5730\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u865a\u62df\u7528\u6237\u5c06\u4f7f\u7528\u4e0e\u533f\u540d\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\uff0c\u8fd9\u5f80\u5f80\u66f4\u5177\u9650\u5236\u6027\uff08\u7279\u522b\u662f\u5728\u5199\u8bbf\u95ee\u65b9\u9762\uff09 \u9ed8\u8ba4\u503c\uff1aNO WRITE_ENABLE \u8fd9\u53ef\u4ee5\u63a7\u5236\u662f\u5426\u5141\u8bb8\u4efb\u4f55\u66f4\u6539\u6587\u4ef6\u7cfb\u7edf\u7684FTP\u547d\u4ee4\u3002\u7528\u6237\u5bf9ftp\u670d\u52a1\u5668\u7684\u5199\u6743\u9650\u3002\u8fd9\u4e9b\u547d\u4ee4\u662f\uff1aSTOR\uff0cDELE\uff0cRNFR\uff0cRNTO\uff0cMKD\uff0cRMD\uff0cAPPE\u548cSITE \u9ed8\u8ba4\u503c\uff1aNO xferlog_enable \u5982\u679c\u542f\u7528\uff0c\u5c06\u4fdd\u7559\u65e5\u5fd7\u6587\u4ef6\uff0c\u8be6\u7ec6\u8bf4\u660e\u4e0a\u8f7d\u548c\u4e0b\u8f7d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u6587\u4ef6\u5c06\u653e\u5728/var/log/vsftpd.log\u4e2d\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u8bbe\u7f6evsftpd_log_file\u8986\u76d6\u6b64\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1aNO\uff08\u4f46\u662f\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u542f\u7528\u5b83\uff09 xferlog_std_format \u5982\u679c\u542f\u7528\uff0c\u4f20\u8f93\u65e5\u5fd7\u6587\u4ef6\u5c06\u4ee5\u6807\u51c6xferlog\u683c\u5f0f\u5199\u5165\uff0c\u5982wu-ftpd\u6240\u4f7f\u7528\u3002\u8fd9\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u60a8\u53ef\u4ee5\u91cd\u7528\u73b0\u6709\u7684\u4f20\u8f93\u7edf\u8ba1\u4fe1\u606f\u751f\u6210\u5668 \u4f46\u662f\uff0c \u9ed8\u8ba4\u683c\u5f0f\u66f4\u5177\u53ef\u8bfb\u6027\u3002\u6b64\u6837\u5f0f\u7684\u65e5\u5fd7\u6587\u4ef6\u7684\u7f3a\u7701\u4f4d\u7f6e\u662f/ var / log / xferlog\uff0c\u4f46\u60a8\u53ef\u4ee5\u4f7f\u7528xferlog_file\u8bbe\u7f6e\u8fdb\u884c \u66f4\u6539 \u9ed8\u8ba4\u503c\uff1aNO \u6570\u5b57\u9009\u9879 \u4ee5\u4e0b\u662f\u6570\u5b57\u9009\u9879\u5217\u8868\u3002\u5fc5\u987b\u5c06\u6570\u5b57\u9009\u9879\u8bbe\u7f6e\u4e3a\u975e\u8d1f\u6574\u6570\u3002\u652f\u6301\u516b\u8fdb\u5236\u6570\uff0c\u4ee5\u65b9\u4fbfumask\u9009\u9879\u3002\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u6570\uff0c\u8bf7\u4f7f\u75280\u4f5c\u4e3a\u6570\u5b57\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57 accept_timeout \u8fdc\u7a0b\u5ba2\u6237\u7aef\u4e0ePASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5efa\u7acb\u8fde\u63a5\u7684\u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a60 anon_max_rate \u533f\u540d\u5ba2\u6237\u7aef\u5141\u8bb8\u7684\u6700\u5927\u6570\u636e\u4f20\u8f93\u901f\u7387\uff08\u4ee5\u5b57\u8282/\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 anon_umask \u4e3a\u533f\u540d\u7528\u6237\u8bbe\u7f6e\u7528\u4e8e\u6587\u4ef6\u521b\u5efa\u7684umask\u7684\u503c\u3002\u6ce8\u610f\uff01\u5982\u679c\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u503c\uff0c\u8bf7\u8bb0\u4f4f\u201c0\u201d\u524d\u7f00\uff0c\u5426\u5219\u8be5\u503c\u5c06\u88ab\u89c6\u4e3a\u57fa\u6570\u4e3a10\u7684\u6574\u6570\uff01 \u9ed8\u8ba4\u503c\uff1a077 chown_upload_mode \u8981\u5f3a\u5236\u8fdb\u884cchown\uff08\uff09ed\u533f\u540d\u4e0a\u4f20\u7684\u6587\u4ef6\u6a21\u5f0f\u3002\uff08\u5728v2.0.6\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c\uff1a0600 connect_timeout \u8fdc\u7a0b\u5ba2\u6237\u7aef\u54cd\u5e94\u6211\u4eec\u7684PORT\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u7684\u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a60 data_connection_timeout \u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\uff0c\u5927\u81f4\u662f\u5141\u8bb8\u6570\u636e\u4f20\u8f93\u505c\u6b62\u800c\u6ca1\u6709\u8fdb\u5ea6\u7684\u6700\u957f\u65f6\u95f4\u3002\u5982\u679c\u8d85\u65f6\u89e6\u53d1\uff0c\u5219\u542f\u52a8\u8fdc\u7a0b\u5ba2\u6237\u7aef \u9ed8\u8ba4\u503c\uff1a300 delay_failed_login \u62a5\u544a\u767b\u5f55\u5931\u8d25\u4e4b\u524d\u6682\u505c\u7684\u79d2\u6570 \u9ed8\u8ba4\u503c\uff1a1 delay_successful_login \u5141\u8bb8\u6210\u529f\u767b\u5f55\u4e4b\u524d\u6682\u505c\u7684\u79d2\u6570 \u9ed8\u8ba4\u503c\uff1a0 file_open_mode \u7528\u4e8e\u521b\u5efa\u4e0a\u8f7d\u6587\u4ef6\u7684\u6743\u9650\u3002Umasks\u5e94\u7528\u4e8e\u6b64\u503c\u4e4b\u4e0a\u3002\u5982\u679c\u60a8\u5e0c\u671b\u4e0a\u4f20\u7684\u6587\u4ef6\u53ef\u6267\u884c\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u66f4\u6539\u4e3a0777 \u9ed8\u8ba4\u503c\uff1a0666 ftp_data_port PORT\u6837\u5f0f\u8fde\u63a5\u6e90\u81ea\u7684\u7aef\u53e3\uff08\u53ea\u8981 \u542f\u7528\u540d\u79f0\u4e0d\u4f73\u7684 connect_from_port_20\uff09 \u9ed8\u8ba4\u503c\uff1a20 idle_session_timeout \u8d85\u65f6\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\uff0c\u5373\u8fdc\u7a0b\u5ba2\u6237\u7aef\u5728FTP\u547d\u4ee4\u4e4b\u95f4\u53ef\u80fd\u82b1\u8d39\u7684\u6700\u957f\u65f6\u95f4\u3002\u5982\u679c\u8d85\u65f6\u89e6\u53d1\uff0c\u5219\u542f\u52a8\u8fdc\u7a0b\u5ba2\u6237\u7aef \u9ed8\u8ba4\u503c\uff1a300 listen_port \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u5b83\u5c06\u4fa6\u542c\u4f20\u5165FTP\u8fde\u63a5\u7684\u7aef\u53e3 \u9ed8\u8ba4\u503c\uff1a21 local_max_rate \u672c\u5730\u8eab\u4efd\u9a8c\u8bc1\u7528\u6237\u5141\u8bb8\u7684\u6700\u5927\u6570\u636e\u4f20\u8f93\u901f\u7387\uff08\u4ee5\u5b57\u8282/\u79d2\u4e3a\u5355\u4f4d\uff09 \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 local_umask \u4e3a\u672c\u5730\u7528\u6237\u8bbe\u7f6e\u7528\u4e8e\u6587\u4ef6\u521b\u5efa\u7684umask\u7684\u503c\u3002\u6ce8\u610f\uff01\u5982\u679c\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u503c\uff0c\u8bf7\u8bb0\u4f4f\u201c0\u201d\u524d\u7f00\uff0c\u5426\u5219\u8be5\u503c\u5c06\u88ab\u89c6\u4e3a\u57fa\u6570\u4e3a10\u7684\u6574\u6570\uff01 \u9ed8\u8ba4\u503c\uff1a077 max_clients \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u8fd9\u662f\u53ef\u4ee5\u8fde\u63a5\u7684\u6700\u5927\u5ba2\u6237\u7aef\u6570\u3002\u8fde\u63a5\u7684\u4efb\u4f55\u5176\u4ed6\u5ba2\u6237\u7aef\u90fd\u5c06\u6536\u5230\u9519\u8bef\u6d88\u606f \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 max_login_fails \u5728\u8fd9\u4e48\u591a\u767b\u5f55\u5931\u8d25\u4e4b\u540e\uff0c\u4f1a\u8bdd\u88ab\u7ec8\u6b62 \u9ed8\u8ba4\u503c\uff1a3 max_per_ip \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u8fd9\u662f\u53ef\u4ee5\u4ece\u540c\u4e00\u6e90Internet\u5730\u5740\u8fde\u63a5\u7684\u6700\u5927\u5ba2\u6237\u7aef\u6570\u3002\u5982\u679c\u5ba2\u6237\u7aef\u8d85\u8fc7\u6b64\u9650\u5236\uff0c\u5c06\u6536\u5230\u9519\u8bef\u6d88\u606f \u9ed8\u8ba4\u503c\uff1a0\uff08\u65e0\u9650\u5236\uff09 pasv_max_port \u4e3aPASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5206\u914d\u7684\u6700\u5927\u7aef\u53e3\u3002\u53ef\u7528\u4e8e\u6307\u5b9a\u7a84\u7aef\u53e3\u8303\u56f4\u4ee5\u534f\u52a9\u9632\u706b\u5899 \u9ed8\u8ba4\u503c\uff1a0\uff08\u4f7f\u7528\u4efb\u4f55\u7aef\u53e3\uff09 pasv_min_port \u4e3aPASV\u6837\u5f0f\u6570\u636e\u8fde\u63a5\u5206\u914d\u7684\u6700\u5c0f\u7aef\u53e3\u3002\u53ef\u7528\u4e8e\u6307\u5b9a\u7a84\u7aef\u53e3\u8303\u56f4\u4ee5\u534f\u52a9\u9632\u706b\u5899 \u9ed8\u8ba4\u503c\uff1a0\uff08\u4f7f\u7528\u4efb\u4f55\u7aef\u53e3\uff09 trans_chunk_size \u60a8\u53ef\u80fd\u4e0d\u60f3\u66f4\u6539\u6b64\u8bbe\u7f6e\uff0c\u4f46\u5c1d\u8bd5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u7c7b\u4f3c8192\u7684\u8bbe\u5907\uff0c\u4ee5\u83b7\u5f97\u66f4\u5e73\u6ed1\u7684\u5e26\u5bbd\u9650\u5236\u5668 \u9ed8\u8ba4\u503c\uff1a0\uff08\u8ba9vsftpd\u9009\u62e9\u5408\u7406\u7684\u8bbe\u7f6e\uff09 STRING OPTIONS \u4ee5\u4e0b\u662f\u5b57\u7b26\u4e32\u9009\u9879\u5217\u8868 anon_root \u6b64\u9009\u9879\u8868\u793avsftpd\u5728\u533f\u540d\u767b\u5f55\u540e\u5c1d\u8bd5\u66f4\u6539\u7684\u76ee\u5f55\u3002\u5931\u8d25\u88ab\u9ed8\u9ed8\u5730\u5ffd\u7565\u4e86 \u9ed8\u8ba4\u503c:(\u65e0\uff09 banned_email_file \u6b64\u9009\u9879\u662f\u5305\u542b\u4e0d\u5141\u8bb8\u7684\u533f\u540d\u7535\u5b50\u90ae\u4ef6\u5bc6\u7801\u5217\u8868\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c \u542f\u7528\u4e86\u9009\u9879deny_email_enable\uff0c\u5219\u4f1a\u67e5\u8be2\u6b64\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.banned_emails banner_file \u6b64\u9009\u9879\u662f\u5305\u542b\u8981\u5728\u6709\u4eba\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\u663e\u793a\u7684\u6587\u672c\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c\u8bbe\u7f6e\uff0c\u5b83\u5c06\u8986\u76d6ftpd_banner \u9009\u9879\u63d0\u4f9b\u7684\u6807\u9898\u5b57\u7b26\u4e32 \u9ed8\u8ba4\u503c:(\u65e0\uff09 ca_certs_file \u6b64\u9009\u9879\u662f\u7528\u4e8e\u52a0\u8f7d\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8bc1\u4e66\u7684\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u9a8c\u8bc1\u5ba2\u6237\u7aef\u8bc1\u4e66\u3002\u9057\u61be\u7684\u662f\uff0c\u7531\u4e8evsftpd\u4f7f\u7528\u53d7\u9650\u5236\u7684\u6587\u4ef6\u7cfb\u7edf\u7a7a\u95f4\uff08chroot\uff09\uff0c \u56e0\u6b64\u672a\u4f7f\u7528\u9ed8\u8ba4\u7684SSL CA\u8bc1\u4e66\u8def\u5f84\u3002\uff08\u5728v2.0.6\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c:(\u65e0\uff09 chown_username \u8fd9\u662f\u83b7\u5f97\u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u6240\u6709\u6743\u7684\u7528\u6237\u7684\u540d\u79f0\u3002\u4ec5\u5f53\u8bbe\u7f6e\u4e86\u53e6\u4e00\u4e2a\u9009\u9879chown_uploads\u65f6\uff0c\u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u9ed8\u8ba4\u503c\uff1aroot chroot_list_file \u8be5\u9009\u9879\u662f\u5305\u542b\u672c\u5730\u7528\u6237\u5217\u8868\u7684\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u8be5\u5217\u8868\u5c06\u653e\u7f6e\u5728\u5176\u4e3b\u76ee\u5f55\u4e2d\u7684chroot\uff08\uff09jail\u4e2d\u3002\u4ec5\u5f53 \u542f\u7528\u4e86\u9009\u9879chroot_list_enable\u65f6\uff0c \u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u3002\u5982\u679c \u542f\u7528\u4e86\u9009\u9879 chroot_local_user\uff0c\u5219\u5217\u8868\u6587\u4ef6\u5c06\u6210\u4e3a\u672a\u653e\u7f6e\u5728chroot\uff08\uff09jail\u4e2d\u7684\u7528\u6237\u5217\u8868 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.chroot_list chroot_list\u6587\u4ef6\uff0c\"/etc/vsftpd.chroot_list\"\u6587\u4ef6\u4e2d\u5305\u542b\u7684\u7528\u6237\uff0c\u5728\u767b\u5f55\u540e\u5c06\u4e0d\u80fd\u5207\u6362\u5230\u81ea\u5df1\u76ee\u5f55\u4ee5\u5916\u7684\u5176\u4ed6\u76ee\u5f55\uff0c\u7531FTP\u670d\u52a1\u5668\u81ea\u52a8 \u5730\"chrooted\"\u5230\u7528\u6237\u81ea\u5df1\u7684home\u76ee\u5f55\u4e0b\u3002\u8fd9\u5c06\u4f7f\u5f97chroot_list\u6587\u4ef6\u4e2d\u7684\u7528\u6237\u4e0d\u80fd\u968f\u610f\u8f6c\u5230\u5176\u4ed6\u7528\u6237\u7684FTP home\u76ee\u5f55\u4e0b\uff0c\u4ece\u800c\u6709\u5229\u4e8eFTP\u670d \u52a1\u5668\u7684\u5b89\u5168\u7ba1\u7406\u548c\u9690\u79c1\u4fdd\u62a4 cmds_allowed \u6b64\u9009\u9879\u6307\u5b9a\u5141\u8bb8\u7684FTP\u547d\u4ee4\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\uff08\u767b\u5f55\u540e.USER\uff0cPASS\u548cQUIT\u4ee5\u53ca\u5176\u4ed6\u59cb\u7ec8\u5141\u8bb8\u767b\u5f55\u524d\uff09\u3002\u5176\u4ed6\u547d\u4ee4\u88ab\u62d2\u7edd\u3002 \u8fd9\u662f\u4e00\u79cd\u771f\u6b63\u9501\u5b9aFTP\u670d\u52a1\u5668\u7684\u5f3a\u5927\u65b9\u6cd5\u3002\u793a\u4f8b\uff1acmds_allowed = PASV\uff0cRETR\uff0cQUIT \u9ed8\u8ba4\u503c:(\u65e0\uff09 cmds_denied \u6b64\u9009\u9879\u6307\u5b9a\u4ee5\u9017\u53f7\u5206\u9694\u7684\u62d2\u7eddFTP\u547d\u4ee4\u5217\u8868\uff08\u767b\u5f55\u540e\u3002\u59cb\u7ec8\u5141\u8bb8\u767b\u5f55\u524d\u4f7f\u7528USER\uff0cPASS\uff0cQUIT\u7b49\uff09\u3002 \u5982\u679c\u6b64\u547d\u4ee4\u548ccmds_allowed\u4e0a\u90fd\u51fa\u73b0\u547d\u4ee4\uff0c \u5219\u62d2\u7edd\u4f18\u5148\u3002\uff08\u5728v2.1.0\u4e2d\u6dfb\u52a0\uff09 \u9ed8\u8ba4\u503c:(\u65e0\uff09 deny_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u540d\uff08\u548c\u76ee\u5f55\u540d\u7b49\uff09\u7684\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6a21\u5f0f\u4e0d\u5e94\u4ee5\u4efb\u4f55\u65b9\u5f0f\u8bbf\u95ee\u3002\u53d7\u5f71\u54cd\u7684\u9879\u76ee\u4e0d\u4f1a\u88ab\u9690\u85cf\uff0c\u4f46\u4efb\u4f55\u5bf9\u5b83\u4eec\u505a\u4efb\u4f55\u4e8b\u60c5\u7684\u5c1d\u8bd5 \uff08\u4e0b\u8f7d\uff0c\u66f4\u6539\u5230\u76ee\u5f55\uff0c\u5f71\u54cd\u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\u7b49\uff09\u90fd\u5c06\u88ab\u62d2\u7edd\u3002\u6b64\u9009\u9879\u975e\u5e38\u7b80\u5355\uff0c\u4e0d\u5e94\u7528\u4e8e\u4e25\u683c\u7684\u8bbf\u95ee\u63a7\u5236 - \u5e94\u4f18\u5148\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u7684\u6743\u9650\u3002\u4f46\u662f\uff0c \u6b64\u9009\u9879\u5728\u67d0\u4e9b\u865a\u62df\u7528\u6237\u8bbe\u7f6e\u4e2d\u53ef\u80fd\u5f88\u6709\u7528\u3002\u7279\u522b\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u6587\u4ef6\u540d\u53ef\u4ee5\u901a\u8fc7\u5404\u79cd\u540d\u79f0\u8bbf\u95ee\uff08\u53ef\u80fd\u662f\u7531\u4e8e\u7b26\u53f7\u94fe\u63a5\u6216\u786c\u94fe\u63a5\uff09\uff0c\u90a3\u4e48\u5fc5\u987b\u6ce8\u610f \u62d2\u7edd\u8bbf\u95ee\u6240\u6709\u540d\u79f0\u3002\u5982\u679c\u9879\u76ee\u7684\u540d\u79f0\u5305\u542bhide_file\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32\uff0c\u6216\u8005\u5b83\u4eec\u4e0ehide_file\u6307\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u5c06\u62d2\u7edd\u8bbf\u95ee\u9879\u76ee\u3002 \u6ce8\u610fvsftpd\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4ee3\u7801\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5b83\u662f\u5b8c\u6574\u6b63\u5219\u8868\u8fbe\u5f0f\u529f\u80fd\u7684\u5b50\u96c6\u3002\u56e0\u6b64\uff0c\u60a8\u9700\u8981\u4ed4\u7ec6\u800c\u8be6\u5c3d\u5730\u6d4b\u8bd5\u6b64\u9009\u9879\u7684\u4efb\u4f55\u5e94\u7528\u7a0b\u5e8f\u3002 \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u5e76\u4e14\u7531\u4e8e\u5176\u66f4\u9ad8\u7684\u53ef\u9760\u6027\uff0c\u5efa\u8bae\u60a8\u5bf9\u4efb\u4f55\u91cd\u8981\u7684\u5b89\u5168\u7b56\u7565\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u6743\u9650\u3002\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u662f\u4efb\u610f\u6570\u91cf\u7684* ,? \u548cunnested {\uff0c}\u8fd0\u7b97\u7b26\u3002 \u4ec5\u5728\u8def\u5f84\u7684\u6700\u540e\u4e00\u4e2a\u7ec4\u4ef6\u4e0a\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u4f8b\u5982a / b /\uff1f\u652f\u6301\uff0c\u4f46/\uff1f/ c\u4e0d\u652f\u6301\u3002\u793a\u4f8b\uff1adeny_file = {*\u3002mp3\uff0c*\u3002mov\uff0c.private} \u9ed8\u8ba4\u503c:(\u65e0\uff09 dsa_cert_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684DSA\u8bc1\u4e66\u7684\u4f4d\u7f6e \u9ed8\u8ba4\u503c:(\u65e0 - RSA\u8bc1\u4e66\u5c31\u8db3\u591f\u4e86\uff09 dsa_private_key_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684DSA\u79c1\u94a5\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u6b64\u9009\u9879\uff0c\u5219\u9884\u671f\u79c1\u94a5\u4e0e\u8bc1\u4e66\u4f4d\u4e8e\u540c\u4e00\u6587\u4ef6\u4e2d \u9ed8\u8ba4\u503c:(\u65e0\uff09 email_password_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u63d0\u4f9bsecure_email_list_enable \u8bbe\u7f6e\u4f7f\u7528\u7684\u5907\u7528\u6587\u4ef6 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.email_passwords ftp_username \u8fd9\u662f\u6211\u4eec\u7528\u4e8e\u5904\u7406\u533f\u540dFTP\u7684\u7528\u6237\u7684\u540d\u79f0\u3002\u8be5\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u662f\u533f\u540dFTP\u533a\u57df\u7684\u6839\u76ee\u5f55 \u9ed8\u8ba4\u503c\uff1aftp ftpd_banner \u6b64\u5b57\u7b26\u4e32\u9009\u9879\u5141\u8bb8\u60a8\u5728\u9996\u6b21\u8fdb\u5165\u8fde\u63a5\u65f6\u8986\u76d6vsftpd\u663e\u793a\u7684\u95ee\u5019\u8bed\u6a2a\u5e45 \u9ed8\u8ba4\u503c:(\u65e0 - \u663e\u793a\u9ed8\u8ba4\u7684vsftpd\u6a2a\u5e45\uff09 guest_username \u6709\u5173 \u8bbf\u5ba2\u767b\u5f55\u7684\u63cf\u8ff0\uff0c\u8bf7\u53c2\u9605\u5e03\u5c14\u503c\u8bbe\u7f6e guest_enable\u3002\u6b64\u8bbe\u7f6e\u662f\u8bbf\u5ba2\u7528\u6237\u6620\u5c04\u5230\u7684\u771f\u5b9e\u7528\u6237\u540d \u9ed8\u8ba4\u503c\uff1aftp hide_file \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u8bbe\u7f6e\u6587\u4ef6\u540d\uff08\u548c\u76ee\u5f55\u540d\u79f0\u7b49\uff09\u7684\u6a21\u5f0f\uff0c\u8fd9\u4e9b\u6a21\u5f0f\u5e94\u8be5\u4ece\u76ee\u5f55\u5217\u8868\u4e2d\u9690\u85cf\u3002\u5c3d\u7ba1\u88ab\u9690\u85cf\uff0c\u4f46\u662f\u77e5\u9053\u5b9e\u9645\u4f7f\u7528\u7684\u540d\u79f0\u7684\u5ba2\u6237\u53ef\u4ee5\u5b8c\u5168\u8bbf\u95ee\u6587\u4ef6/\u76ee\u5f55\u7b49\u3002 \u5982\u679c\u9879\u76ee\u7684\u540d\u79f0\u5305\u542bhide_file\u7ed9\u51fa\u7684\u5b57\u7b26\u4e32\uff0c\u6216\u8005\u5b83\u4eec\u4e0ehide_file\u6307\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u5c06\u9690\u85cf\u8fd9\u4e9b\u9879\u76ee\u3002\u8bf7\u6ce8\u610f\uff0cvsftpd\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u4ee3\u7801 \u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5b9e\u73b0\uff0c\u5b83\u662f\u5b8c\u6574\u6b63\u5219\u8868\u8fbe\u5f0f\u529f\u80fd\u7684\u5b50\u96c6\u3002\u6709\u5173 \u5177\u4f53\u652f\u6301\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u8bed\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c \u8bf7\u53c2\u9605 deny_file\u3002\u793a\u4f8b\uff1ahide_file = {*\u3002mp3\uff0c.hidden\uff0chide *\uff0ch\uff1f} \u9ed8\u8ba4\u503c:(\u65e0\uff09 listen_address \u5982\u679cvsftpd\u5904\u4e8e\u72ec\u7acb\u6a21\u5f0f\uff0c\u5219\u6b64\u8bbe\u7f6e\u53ef\u80fd\u4f1a\u8986\u76d6\uff08\u6240\u6709\u672c\u5730\u63a5\u53e3\u7684\uff09\u9ed8\u8ba4\u4fa6\u542c\u5730\u5740\u3002\u63d0\u4f9b\u6570\u5b57IP\u5730\u5740 \u9ed8\u8ba4\u503c:(\u65e0\uff09 listen_address6 \u4e0elisten_address\u7c7b\u4f3c\uff0c\u4f46\u6307\u5b9aIPv6\u4fa6\u542c\u5668\u7684\u9ed8\u8ba4\u4fa6\u542c\u5730\u5740\uff08\u5982\u679c\u8bbe\u7f6e\u4e86listen_ipv6\uff0c\u5219\u4f7f\u7528\u8be5\u5730\u5740\uff09\u3002\u683c\u5f0f\u662f\u6807\u51c6IPv6\u5730\u5740\u683c\u5f0f \u9ed8\u8ba4\u503c:(\u65e0\uff09 local_root \u6b64\u9009\u9879\u8868\u793avsftpd\u5728\u672c\u5730\uff08\u5373\u975e\u533f\u540d\uff09\u767b\u5f55\u540e\u5c1d\u8bd5\u66f4\u6539\u7684\u76ee\u5f55\u3002\u5931\u8d25\u88ab\u9ed8\u9ed8\u5730\u5ffd\u7565\u4e86 \u9ed8\u8ba4\u503c:(\u65e0\uff09 message_file \u6b64\u9009\u9879\u662f\u8f93\u5165\u65b0\u76ee\u5f55\u65f6\u6211\u4eec\u67e5\u627e\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5185\u5bb9\u663e\u793a\u7ed9\u8fdc\u7a0b\u7528\u6237\u3002\u4ec5\u5f53 \u542f\u7528\u4e86\u9009\u9879dirmessage_enable\u65f6\uff0c\u6b64\u9009\u9879\u624d\u6709\u610f\u4e49 \u9ed8\u8ba4\u503c\uff1a.message nopriv_user \u8fd9\u662fvsftpd\u5728\u5b8c\u5168\u6ca1\u6709\u7279\u6743\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u7684\u7528\u6237\u540d\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u5e94\u8be5\u662f\u4e13\u7528\u7528\u6237\uff0c\u800c\u4e0d\u662f\u4efb\u4f55\u4eba\u3002\u5728\u5927\u591a\u6570\u673a\u5668\u4e0a\uff0c\u7528\u6237\u6ca1\u6709\u503e\u5411\u4e8e\u4f7f\u7528\u5f88\u591a\u91cd\u8981\u7684\u4e1c\u897f \u9ed8\u8ba4\u503c\uff1a\u6ca1\u4eba pam_service_name \u6b64\u5b57\u7b26\u4e32\u662fvsftpd\u5c06\u4f7f\u7528\u7684PAM\u670d\u52a1\u7684\u540d\u79f0 \u9ed8\u8ba4\u503c\uff1aftp pasv_address\u8bbe\u7f6e \u4f7f\u7528\u6b64\u9009\u9879\u53ef\u8986\u76d6vsftpd\u5c06\u54cd\u5e94PASV\u547d\u4ee4\u800c\u901a\u544a\u7684IP\u5730\u5740\u3002\u63d0\u4f9b\u6570\u5b57IP\u5730\u5740\uff0c\u9664\u975e \u542f\u7528\u4e86pasv_addr_resolve\uff0c \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u4ee5\u63d0\u4f9b\u5728\u542f\u52a8\u65f6\u4e3a\u60a8\u89e3\u6790DNS\u7684\u4e3b\u673a\u540d \u9ed8\u8ba4\u503c:(\u65e0 - \u5730\u5740\u53d6\u81ea\u4f20\u5165\u7684\u8fde\u63a5\u5957\u63a5\u5b57\uff09 rsa_cert_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684RSA\u8bc1\u4e66\u7684\u4f4d\u7f6e \u9ed8\u8ba4\u503c\uff1a/usr/share/ssl/certs/vsftpd.pem rsa_private_key_file \u6b64\u9009\u9879\u6307\u5b9a\u7528\u4e8eSSL\u52a0\u5bc6\u8fde\u63a5\u7684RSA\u79c1\u94a5\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u6b64\u9009\u9879\uff0c\u5219\u9884\u671f\u79c1\u94a5\u4e0e\u8bc1\u4e66\u4f4d\u4e8e\u540c\u4e00\u6587\u4ef6\u4e2d \u9ed8\u8ba4\u503c:(\u65e0\uff09 secure_chroot_dir \u6b64\u9009\u9879\u5e94\u8be5\u662f\u7a7a\u76ee\u5f55\u7684\u540d\u79f0\u3002\u6b64\u5916\uff0cftp\u7528\u6237\u4e0d\u5e94\u8be5\u5199\u5165\u8be5\u76ee\u5f55\u3002\u6b64\u76ee\u5f55\u6709\u65f6\u7528\u4f5c\u5b89\u5168chroot\uff08\uff09jail\uff0cvsftpd\u4e0d\u9700\u8981\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee \u9ed8\u8ba4\u503c\uff1a/ usr / share / empty \u7684ssl_ciphers \u6b64\u9009\u9879\u53ef\u7528\u4e8e\u9009\u62e9vsftpd\u5141\u8bb8\u52a0\u5bc6SSL\u8fde\u63a5\u7684SSL\u5bc6\u7801\u3002\u6709\u5173 \u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u5bc6\u7801\u624b\u518c\u9875\u3002\u8bf7\u6ce8\u610f\uff0c\u9650\u5236\u5bc6\u7801\u53ef\u80fd\u662f\u4e00\u79cd\u6709\u7528\u7684\u5b89\u5168\u9884\u9632\u63aa\u65bd\uff0c \u56e0\u4e3a\u5b83\u53ef\u4ee5\u9632\u6b62\u6076\u610f\u8fdc\u7a0b\u65b9\u5f3a\u5236\u4f7f\u7528\u5df2\u53d1\u73b0\u95ee\u9898\u7684\u5bc6\u7801 \u9ed8\u8ba4\u503c\uff1aDES-CBC3-SHA user_config_dir \u8fd9\u4e2a\u529f\u80fd\u5f3a\u5927\u7684\u9009\u9879\u5141\u8bb8\u57fa\u4e8e\u6bcf\u4e2a\u7528\u6237\u8986\u76d6\u624b\u518c\u9875\u4e2d\u6307\u5b9a\u7684\u4efb\u4f55\u914d\u7f6e\u9009\u9879\u3002\u7528\u6cd5\u5f88\u7b80\u5355\uff0c\u6700\u597d\u7528\u4e00\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u3002\u5982\u679c\u5c06 user_config_dir \u8bbe\u7f6e \u4e3a / etc / vsftpd_user_conf \u7136\u540e\u4ee5\u7528\u6237\u201cchris\u201d\u8eab\u4efd\u767b\u5f55\uff0c\u5219vsftpd\u5c06 \u5728\u4f1a\u8bdd\u671f\u95f4\u5e94\u7528\u6587\u4ef6 / etc / vsftpd_user_conf / chris \u4e2d\u7684\u8bbe\u7f6e\u3002\u6b64\u6587\u4ef6\u7684\u683c\u5f0f\u8be6\u89c1\u672c\u624b\u518c\u9875\uff01\u8bf7\u6ce8\u610f\uff0c\u5e76\u975e\u6240\u6709\u8bbe\u7f6e\u90fd\u5bf9\u6bcf\u4e2a\u7528\u6237\u6709\u6548\u3002\u4f8b\u5982\uff0c\u8bb8\u591a\u8bbe\u7f6e\u4ec5\u5728\u7528\u6237\u4f1a\u8bdd\u542f\u52a8\u4e4b\u524d\u3002\u4e0d\u4f1a\u5f71\u54cd\u6bcf\u4e2a\u7528\u6237\u7684\u4efb\u4f55 \u884c\u4e3a\u7684\u8bbe\u7f6e\u793a\u4f8b\u5305\u62eclisten_address\uff0cbanner_file\uff0cmax_per_ip\uff0cmax_clients\uff0cxferlog_file\u7b49 \u9ed8\u8ba4\u503c:(\u65e0\uff09 user_sub_token \u6b64\u9009\u9879\u4e0e\u865a\u62df\u7528\u6237\u7ed3\u5408\u4f7f\u7528\u975e\u5e38\u6709\u7528\u3002\u5b83\u7528\u4e8e\u6839\u636e\u6a21\u677f\u4e3a\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u81ea\u52a8\u751f\u6210\u4e3b\u76ee\u5f55\u3002\u4f8b\u5982\uff0c\u5982\u679c\u901a\u8fc7guest_username\u6307\u5b9a\u7684\u771f\u5b9e\u7528\u6237\u7684\u4e3b\u76ee\u5f55 \u662f / home / virtual / $ USER\uff0c\u5e76\u4e14 user_sub_token \u8bbe\u7f6e\u4e3a $ USER\uff0c\u90a3\u4e48\u5f53\u865a\u62df\u7528\u6237fred\u767b\u5f55\u65f6\uff0c\u4ed6\u5c06\u7ed3\u675f\u901a\u5e38\u662f\u5728\u76ee\u5f55 / home / virtual / fred\u4e2d\u3002\u5982\u679clocal_root \u5305\u542b user_sub_token\uff0c\u5219\u6b64\u9009\u9879\u4e5f\u4f1a \u751f\u6548 \u9ed8\u8ba4\u503c:(\u65e0\uff09 userlist_file \u6b64\u9009\u9879\u662fuserlist_enable \u9009\u9879\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\u52a0\u8f7d\u7684\u6587\u4ef6\u7684\u540d\u79f0 \u9ed8\u8ba4\u503c\uff1a/etc/vsftpd.user_list vsftpd_log_file \u6b64\u9009\u9879\u662f\u6211\u4eec\u7f16\u5199vsftpd\u6837\u5f0f\u65e5\u5fd7\u6587\u4ef6\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u4ec5\u5f53 \u8bbe\u7f6e\u4e86\u9009\u9879xferlog_enable\u5e76\u4e14\u672a\u8bbe\u7f6exferlog_std_format\u65f6\uff0c \u624d\u4f1a\u5199\u5165\u6b64\u65e5\u5fd7 \u3002 \u6216\u8005\uff0c\u5982\u679c\u5df2\u8bbe\u7f6e\u9009\u9879dual_log_enable\uff0c\u5219\u4f1a\u5199\u5165 \u3002\u53e6\u4e00\u4e2a\u590d\u6742\u56e0\u7d20 - \u5982\u679c\u60a8\u8bbe\u7f6e\u4e86 syslog_enable\uff0c\u5219\u4e0d\u4f1a\u5199\u5165\u6b64\u6587\u4ef6\uff0c\u800c\u662f\u5c06\u8f93\u51fa\u53d1\u9001\u5230\u7cfb\u7edf\u65e5\u5fd7 \u9ed8\u8ba4\u503c\uff1a/var/log/vsftpd.log xferlog_file \u6b64\u9009\u9879\u662f\u6211\u4eec\u7f16\u5199wu-ftpd\u6837\u5f0f\u4f20\u8f93\u65e5\u5fd7\u7684\u6587\u4ef6\u7684\u540d\u79f0\u3002\u4ec5\u5f53 \u8bbe\u7f6e\u4e86 xferlog_enable\u9009\u9879\u4ee5\u53caxferlog_std_format\u65f6\u624d\u4f1a\u5199\u5165\u4f20\u8f93\u65e5\u5fd7 \u3002 \u6216\u8005\uff0c\u5982\u679c\u5df2\u8bbe\u7f6e\u9009\u9879dual_log_enable\uff0c\u5219\u4f1a\u5199\u5165 \u9ed8\u8ba4\u503c\uff1a/var/log/xferlog","title":"Vsftp"},{"location":"Linux/#bind-dns","text":"# DNS-bind\u5b89\u88c5\u548c\u914d\u7f6e https://ftp.isc.org/ http://www.isc.org/downloads/ wget https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = tar-gz https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = win-32-bit https://www.isc.org/downloads/file/bind-9-10-6-p1/?version = win-64-bit tar -zxvf ./configure --with-openssl --enable-threads --with-libxml2 make && make install touch /etc/named.conf named -V named -g \u89e3\u51b3bind9 dumping master file tmp-xxxx open permission denied\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6cd5\u5982\u4e0b\uff1a \u5bf9\u4e8eRedhat Linux\uff0c\u53ea\u8981\u5728slave\u90a3\u53f0\u7684dns\u4e3b\u673a\u4e0a\u4fee\u6539/etc/sysconfig/named\u52a0\u4e0aENABLE_ZONE_WRITE = yes\uff0c\u91cd\u542fnamed\u5373\u53ef \u5bf9\u4e8eUbuntu\u7cfb\u7edf\uff0c\u4fee\u6539/etc/apparmor.d/usr.sbin.named\uff0c\u67e5\u627e/etc/bind/** r\uff0c\u4fee\u6539\u6210/etc/bind/** rw\uff0c \u7136\u540e\u91cd\u542fapparmor\uff1a/etc/init.d/apparmor rstart\u6216\u8005reload\u914d\u7f6e\uff1acat /etc/apparmor.d/usr.sbin.named | sudo apparmor_parser -r","title":"Bind-DNS"},{"location":"Linux/#email","text":"# PostFix Dovecot\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u540e\u53f0\u7ba1\u7406 # \u5b98\u65b9postfix\u5b89\u88c5\u548c\u914d\u7f6e PGP key\u4e0b\u8f7d\u5730\u5740\uff1ahttps://repo.dovecot.org/DOVECOT-REPO-GPG ## debian\u5b89\u88c5\u548c\u914d\u7f6e # Jessie (8.0)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/debian/jessie jessie main # Stretch (9.0)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/debian/stretch stretch main # \u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot-core dovecot-dbg dovecot-dev dovecot-gssapi dovecot-imapd dovecot-imaptest dovecot-ldap dovecot-lmtpd dovecot-lua dovecot-lucene dovecot-managesieved dovecot-mysql dovecot-pgsql dovecot-pigeonhole-dbg dovecot-pop3d dovecot-sieve-dev dovecot-sieve dovecot-solr dovecot-sqlite dovecot-submissiond ## CentOS 6&7\u5b89\u88c5\u548c\u914d\u7f6e # \u521b\u5efa/etc/yum.repos.d/dovecot.repo [ dovecot-2.3-latest ] name = Dovecot 2 .3 CentOS $releasever - $basearch baseurl = http://repo.dovecot.org/ce-2.3-latest/centos/ $releasever /RPMS/ $basearch gpgkey = https://repo.dovecot.org/DOVECOT-REPO-GPG gpgcheck = 1 enabled = 1 # \u65b0\u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot dovecot-debuginfo dovecot-devel dovecot-imaptest dovecot-imaptest-debuginfo dovecot-lua dovecot-mysql dovecot-pgsql dovecot-pigeonhole dovecot-pigeonhole-debuginfo dovecot-pigeonhole-devel ## Ubuntu\u5b89\u88c5\u548c\u914d\u7f6e # Trusty (14.04 LTS)\u5b89\u88c5 # \u521b\u5efa/etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg # \u521b\u5efa/etc/apt/sources.list.d/dovecot.list \u60f3\u8981\u4f7f\u7528https\uff0c\u786e\u4fdd\u5b89\u88c5apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/ubuntu/trusty trusty main # Xenial (16.04 LTS)\u5b89\u88c5 Create /etc/apt/trusted.gpg.d/dovecot.gpg curl https://repo.dovecot.org/DOVECOT-REPO-GPG | gpg --import gpg --export ED409DA1 > /etc/apt/trusted.gpg.d/dovecot.gpg Create /etc/apt/sources.list.d/dovecot.list. If you want to use https, make sure you have installed apt-transport-https deb https://repo.dovecot.org/ce-2.3-latest/ubuntu/xenial xenial main # \u65b0\u5b89\u88c5\u9700\u8981\u7684\u5305\u540d dovecot-core dovecot-dbg dovecot-dev dovecot-gssapi dovecot-imapd dovecot-imaptest dovecot-ldap dovecot-lmtpd dovecot-lua dovecot-lucene dovecot-managesieved dovecot-mysql dovecot-pgsql dovecot-pigeonhole-dbg dovecot-pop3d dovecot-sieve-dev dovecot-sieve dovecot-solr dovecot-sqlite dovecot-submissiond ## source tarballs\u6587\u4ef6\u7f16\u8bd1\u5b89\u88c5 # \u4e0b\u8f7d\u5730\u5740\uff1ahttps://dovecot.org/download.html https://dovecot.org/releases/2.3/dovecot-2.3.0.tar.gz tar -zxvf dovecot-2.3.0 ./configure make && make install # \u81ea\u5b9a\u4e49\u5b89\u88c5\u4f4d\u7f6e\u548c\u5e93\u7684\u8def\u5f84 CPPFLAGS = \"-I/opt/openssl/include\" LDFLAGS = \"-L/opt/openssl/lib\" ./configure # \u4ecegit\u514b\u9686\u7f16\u8bd1\u5b89\u88c5 git clone https://github.com/dovecot/core.git dovecot # \u63a5\u7740\u8fdb\u5165\u76ee\u5f55\u8fd0\u884c./autogen.sh\u751f\u6210\u914d\u7f6e\u811a\u672c\u548c\u5176\u4ed6\u9700\u8981\u7684\u6587\u4ef6 # \u9700\u8981\u63d0\u524d\u5b89\u88c5\u7684\u5305 autoconf automake libtool pkg-config gettext pandoc ( \u4e0d\u662f\u5fc5\u987b\u5b89\u88c5\uff0c\u9664\u975e\u8981\u4f7f\u7528: PANDOC = false ./configure ) GNU make # \u5efa\u8bae\u6dfb\u52a0--enable-maintainer-mode\u53c2\u6570\u5230configure\u811a\u672c ./autogen.sh ./configure --enable-maintainer-mode make && make install ## \u5176\u4ed6` \u975e\u5b98\u65b9\u8865\u4e01\u5730\u5740\uff1ahttps://dovecot.org/patches/ \u989d\u5916\u5de5\u5177\u5730\u5740\uff1ahttps://dovecot.org/tools/ GitHub\u4ed3\u5e93\u5730\u5740\uff1ahttps://github.com/dovecot/","title":"Email"},{"location":"Linux/#optional-configure-options","text":"-- help = short just lists the options added by the particular package ( = Dovecot ) Options are usually listed as -- with - something or -- enable - something . If you want to disable them , do it as -- without - something or -- disable - something . There are many default options that come from autoconf , automake or libtool . They are explained elsewhere Here is a list of options that Dovecot adds . You should not usually have to change these , but they are described here just for completeness : -- enable - devel - checks Enables some extra sanity checks . This is mainly useful for developers . It does quite a lot of unnecessary work but should catch some programming mistakes more quickly -- enable - asserts Enable assertion checks , enabled by default . Disabling them may slightly save some CPU , but if there are bugs they can cause more problems since they are not detected as early -- without - shared - libs Link Dovecot binaries with static libraries instead of dynamic libraries -- disable - largefile Specifies if we use 32 bit or 64 bit file offsets in 32 bit CPUs . 64 bit is the default if the system supports it ( Linux and Solaris do ) . Dropping this to 32 bit may save some memory , but it prevents accessing any file larger than 2 GB -- with - mem - align = BYTES Specifies memory alignment used for memory allocations . It is needed with many non - x86 systems and it should speed up x86 systems too . Default is 8 , to make sure 64 bit memory accessing works -- with - ioloop = IOLOOP Specifies what I / O loop method to use . Possibilities are select , poll , epoll and kqueue . The default is to use the best method available on your system -- with - notify = NOTIFY Specifies what file system notification method to use . Possibilities are dnotify , inotify ( both on Linux ) , kqueue ( FreeBSD ) and none . The default is to use the best method available on your system . See Notify method above for more information -- with - storages = FORMATS Specifies what mailbox formats to support . Note : Independent of this option , the formats raw and shared will be always built -- with - solr Build with Solr full text search support -- with - zlib Build with zlib compression support ( default if detected ) -- with - bzlib Build with bzip2 compression support ( default if detected ) SQL Driver Options SQL drivers are typically used only for authentication , but they may be used as a lib - dict backend too , which can be used by plugins for different purposes -- with - sql - drivers Build with specified SQL drivers . Defaults to all that were found with autodetection -- with - pgsql Build with PostgreSQL support ( requires pgsql - devel , libpq - dev or similar package ) -- with - mysql Build with MySQL support ( requires mysql - devel , libmysqlclient15 - dev or similar package ) -- with - sqlite Build with SQLite3 driver support ( requires sqlite - devel , libsqlite3 - dev or similar package ) Authentication Backend Options The basic backends are built if the system is detected to support them : -- with - shadow Build with shadow password support -- with - pam Build with PAM support -- with - nss Build with NSS support -- with - sia Build with Tru64 SIA support -- with - bsdauth Build with BSD authentication support ( if supported by your OS ) Some backends require extra libraries and are not necessarily wanted , so they are built only if specifically enabled : -- with - sql Build with generic SQL support ( drivers are enabled separately ) -- with - ldap Build with LDAP support ( requires openldap - devel , libldap2 - dev or similar package ) -- with - gssapi Build with GSSAPI authentication support ( requires krb5 - devel , libkrb5 - dev or similar package ) -- with - vpopmail Build with vpopmail support ( requires vpopmail sources or a devel package ) It is also possible to build these as plugins by giving e . g . -- with - sql = plugin Dynamic IMAP and POP3 Modules The mail_plugins setting lists all plugins that Dovecot is supposed to load from the mail_plugin_dir directory at program start . These plugins can do anything they want . They are only expected to contain the < plugin name > _init and < plugin name > _deinit functions which are called at startup and at exit * The plugin filename is prefixed with a number which specifies the order in which the plugins are loaded . This is important if one plugin depends on another","title":"Optional Configure Options"},{"location":"Linux/#email_1","text":"# \u51fa\u73b0Maildir\u6743\u9650\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5 # \u68c0\u67e5selinux\u72b6\u6001\u5e76\u5173\u95ed # \u65b9\u6cd5\u4e00\uff1a/usr/sbin/sestatus -v # \u65b9\u6cd5\u4e8c\uff1a getenforce 0 # \u8bbe\u7f6eselinux\u4e3apermissive\u6a21\u5f0f()\u4e34\u65f6\u5173\u95ed\uff0c\u4e0d\u7528\u91cd\u542f\uff0c\u91cd\u542f\u540e\u5931\u6548 # \u6c38\u4e45\u751f\u6548\u65b9\u6cd5\uff1a vi /etc/selinux/config SELINUX = enforcing\u66f4\u6539\u4e3aSELINUX = disabled # \u5efa\u7acb\u9632\u706b\u5899\u89c4\u5219 vi /usr/local/sbin/startmailf #!/bin/bash #create: #Creater: iptables -I INPUT -p tcp --dport 110 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1110\u7aef\u53e3\uff0cPOP3\u7684IP\u5165\u53e3 iptables -I INPUT -p udp --dport 110 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1110\u7aef\u53e3\uff0cPOP3\u7684\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p tcp --dport 25 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u53d1\u4fe125\u7aef\u53e3\uff0cIP\u5165\u53e3 iptables -I INPUT -p udp --dport 25 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u53d1\u4fe125\u7aef\u53e3\uff0c\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p udp --dport 143 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1143\u7aef\u53e3\uff0cIMAP\u7684IP\u5165\u53e3 iptables -I INPUT -p tcp --dport 143 -j ACCEPT #\u5141\u8bb8\u90ae\u4ef6\u6536\u4fe1143\u7aef\u53e3\uff0cIMAP\u7684\u5e26\u6570\u636e\u5305\u5165\u53e3 iptables -I INPUT -p udp --dport 22 -j ACCEPT #\u5f00\u653ePUTTY\u548cWINSCP 22\u53f7\u7aef\u53e3\uff0c\u65b9\u4fbf\u7ba1\u7406\u5458\u8fdb\u5165 iptables -I INPUT -p tcp --dport 22 -j ACCEPT #\u5f00\u653ePUTTY\u548cWINSCP 22\u53f7\u7aef\u53e3\uff0c\u65b9\u4fbf\u7ba1\u7406\u5458\u8fdb\u5165 iptables -I INPUT -p tcp --dport 53 -j ACCEPT #\u5f00\u653eDNS\u67e5\u8be2\u7aef\u53e3\uff0c\u8fd9\u6837\u80fd\u89e3\u6790\u5230\u90ae\u4ef6\u670d\u52a1\u5668 iptables -I INPUT -p udp --dport 53 -j ACCEPT #\u5f00\u653eDNS\u67e5\u8be2\u7aef\u53e3\uff0c\u8fd9\u6837\u80fd\u89e3\u6790\u5230\u90ae\u4ef6\u670d\u52a1\u5668 service network restart #\u91cd\u542f\u7f51\u7edc service postfix restart #\u91cd\u542fpostfix service dovecot restart #\u91cd\u542fdovecot service saslauthd restart #\u91cd\u542fASAL\u6388\u6743 #\u4e5f\u53ef\u4ee5\u518d\u52a0456\uff0c1925\uff0c587\u7b49\u90ae\u4ef6SSL/TLS\u7aef\u53e3\uff0c80\u7f51\u9875\u7ba1\u7406\u7aef\u53e3\uff0c\u6839\u636e\u4f60\u7684\u90ae\u4ef6\u670d\u52a1\u5668\u800c\u5b9a # \u5c06\u9632\u706b\u5899\u89c4\u5219\u5f00\u673a\u81ea\u542f\u52a8 vi /etc/rc.local #!/bin/sh # # This script will be executed *after* all the other init scripts # You can put your own initialization stuff in here if you don't # want to do the full Sys V style init stuff touch /var/lock/subsys/local sh /usr/local/sbin/startmailf #\u628a\u521b\u5efa\u7684\u9632\u706b\u5899\u89c4\u5219\u52a0\u5728\u8fd9\u4e00\u884c # CentOS\u7cfb\u7edf\u4e00\u822c\u90fd\u81ea\u5e26sendmail\u7684\uff0c\u5982\u679c\u4e0d\u9700\u8981\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5220\u9664 rpm -e sendmail # \u68c0\u67e5\u9ed8\u8ba4\u90ae\u4ef6\u4f20\u8f93\u4ee3\u7406(MTA) * alternatives --display mta # \u9ed8\u8ba4\u662fsendmail\uff0c\u66f4\u6539MTA\u4e3apostfix /usr/sbin/alternatives --set mta /usr/sbin/sendmail.postfix # \u914d\u7f6ePostfix * Postfix\u914d\u7f6e\u6587\u4ef6\u4e3b\u8981\u662f\u4e24\u4e2amaster.cf\u548cmain.cf\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u914d\u7f6emain.cf\uff0c\u5373/etc/postfix/main.cf # \u66f4\u6539\u4ee5\u4e0b\u5185\u5bb9 myhostname = mail.1a-centosserver.com mydomain = 1a-centosserver.com myorigin = $mydomain inet_interfaces = all mydestination = $myhostname , localhost. $mydomain , localhost, $mydomain mynetworks = 192 .168.13.0/24, 127 .0.0.0/8 relay_domains = home_mailbox = Maildir/ # \u914d\u7f6e\u6587\u4ef6\u89e3\u91ca\uff1a mydomain: mydomain\u53c2\u6570\u662f\u6307email\u670d\u52a1\u5668\u7684\u57df\u540d\uff0c\u8bf7\u786e\u4fdd\u4e3a\u6b63\u5f0f\u57df\u540d\uff08\u5982centos.bz\uff09 myhostname: myhostname\u53c2\u6570\u662f\u6307\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u79f0\uff08\u5982\u6211\u7684\u670d\u52a1\u5668\u4e3b\u673a\u540d\u79f0\u662fmail.centos.bz\uff09 myorigin: myorigin\u53c2\u6570\u6307\u5b9a\u672c\u5730\u53d1\u9001\u90ae\u4ef6\u4e2d\u6765\u6e90\u548c\u4f20\u9012\u663e\u793a\u7684\u57df\u540d\u3002\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\uff0cmydomain\u662fcentos.bz\uff0c\u4e5f\u662f\u6211\u7684\u57df\u540d \u5bf9\u4e8e\u4e0b\u9762\u7684\u4e00\u884c\uff0c\u6211\u4eec\u7684\u90ae\u4ef6\u5730\u5740\u662fuser@centos.bz\u800c\u4e0d\u662fuser@mail.centos.bz myorigin = $mydomain mynetworks: mynetworks\u53c2\u6570\u6307\u5b9a\u53d7\u4fe1\u4efbSMTP\u7684\u5217\u8868\uff0c\u5177\u4f53\u7684\u8bf4\uff0c\u53d7\u4fe1\u4efb\u7684SMTP\u5ba2\u6237\u7aef\u5141\u8bb8\u901a\u8fc7Postfix\u4f20\u9012\u90ae\u4ef6 mydestination: mydestination\u53c2\u6570\u6307\u5b9a\u54ea\u4e9b\u90ae\u4ef6\u5730\u5740\u5141\u8bb8\u5728\u672c\u5730\u53d1\u9001\u90ae\u4ef6\u3002\u8fd9\u662f\u4e00\u7ec4\u88ab\u4fe1\u4efb\u7684\u5141\u8bb8\u901a\u8fc7\u670d\u52a1\u5668\u53d1\u9001\u6216\u4f20\u9012\u90ae\u4ef6\u7684IP\u5730\u5740\u3002\u7528\u6237\u8bd5\u56fe\u901a\u8fc7\u53d1\u9001\u4ece\u6b64\u5904\u672a\u5217\u51fa\u7684IP\u5730\u5740\u7684\u539f\u59cb\u670d\u52a1\u5668\u7684\u90ae\u4ef6\u5c06\u88ab\u62d2\u7edd inet_interfaces: inet_interfaces\u53c2\u6570\u8bbe\u7f6e\u7f51\u7edc\u63a5\u53e3\u4ee5\u4fbfPostfix\u80fd\u63a5\u6536\u5230\u90ae\u4ef6 relay_domains: \u8be5\u53c2\u6570\u662f\u7cfb\u7edf\u4f20\u9012\u90ae\u4ef6\u7684\u76ee\u7684\u57df\u540d\u5217\u8868\u3002\u5982\u679c\u7559\u7a7a\uff0c\u6211\u4eec\u4fdd\u8bc1\u4e86\u6211\u4eec\u7684\u90ae\u4ef6\u670d\u52a1\u5668\u4e0d\u5bf9\u4e0d\u4fe1\u4efb\u7684\u7f51\u7edc\u5f00\u653e home_mailbox: \u8be5\u53c2\u6570\u8bbe\u7f6e\u90ae\u7bb1\u8def\u5f84\u4e0e\u7528\u6237\u76ee\u5f55\u6709\u5173\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u90ae\u7bb1\u98ce\u683c # \u6d4b\u8bd5Postfix SMTP\u8fde\u63a5 service postfix status \u68c0\u6d4b\u9ed8\u8ba4smtp\u7aef\u53e325\u662f\u5426\u5df2\u7ecf\u76d1\u542c netstat -an | grep 25 \u8bbe\u7f6epostfix\u5f00\u673a\u542f\u52a8 chkconfig postfix on \u5f00\u59cb\u6d4b\u8bd5postfix\u662f\u5426\u5de5\u4f5c\u6b63\u5e38 telnet localhost 25 \u6240\u6709\u90ae\u4ef6\u53d1\u9001\u5230/home/user/Maildir/new # \u90ae\u4ef6\u522b\u540d\u8bbe\u7f6e \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a/etc/alises\u91cc\uff0c\u683c\u5f0f\uff1a [ Format ] Receiving Account or other aliaes:recipient A,recipient B,.... \u4f8b\u4e00:root:root,james # \u8868\u793aroot\u7528\u6237\u7684\u90ae\u4ef6\u5bf9\u4e8e\u7528\u6237james\u548croot\u90fd\u53ef\u4ee5\u63a5\u6536\u5230 \u4f8b\u4e8c\uff1aclass2017:james,anna,mark #\u8bbe\u7f6e\u7fa4\u90ae\u4ef6\uff0c\u8868\u793a\u8bbe\u7f6e\u4e86\u7fa4\u90ae\u4ef6\u540dclass2017\uff0c\u5f53\u53d1\u9001\u4e00\u5c01\u90ae\u4ef6\u5230class2017@qq.com\u65f6\uff0c\u7528\u6237james\u3001anna\u3001mark\u90fd\u53ef\u4ee5\u6536\u5230\u90ae\u4ef6 \u4f7f\u7528\u201cnewaliases\u201d\u547d\u4ee4\u6fc0\u6d3b\u90ae\u4ef6\u522b\u540d\u529f\u80fd \u5f53\u7f16\u8f91/etc/aliases\u6587\u4ef6\u540e\uff0c\u5fc5\u987b\u6267\u884cnewaliases\u547d\u4ee4\u66f4\u65b0\u522b\u540d\u6570\u636e\u5e93 POP/IMAP\u8bbe\u7f6e \u4e3a\u4e86\u4f7f\u7528\u6237\u53ef\u4ee5\u5728\u672c\u5730\u673a\u5668\u4e0b\u8f7d\u90ae\u4ef6\uff0c\u5fc5\u987b\u5728\u90ae\u4ef6\u670d\u52a1\u5668\u5b89\u88c5\u5e76\u8bbe\u7f6ePOP\u6216IMAP\uff0cdocecot\u662f\u9002\u7528\u5728Linux\u90ae\u4ef6\u7cfb\u7edfPOP/IMAP\u90ae\u4ef6\u670d\u52a1\u5668\u4e4b\u4e00\uff0c\u652f\u6301maildir\u548cmbox\u683c\u5f0f","title":"email\u5b89\u88c5\u8fc7\u7a0b\u76f8\u5173\u95ee\u9898\u548c\u914d\u7f6e"},{"location":"Linux/#dovecot","text":"* \u9996\u5148\u68c0\u6d4bdovecot\u8f6f\u4ef6\u5305\u662f\u5426\u5df2\u7ecf\u5b89\u88c5 rpm -qa dovecot \u7528yum\u547d\u4ee4\u5b89\u88c5\uff1ayum -y install dovecot Dovecot\u914d\u7f6e\u6587\u4ef6\u5728/etc/dovecot.conf\uff0c\u9700\u8981\u6539\u52a8\u7684\u5730\u65b9\u5982\u4e0b vim /etc/dovecot.conf # Protocols we want to be serving: imap imaps pop3 pop3s # If you only want to use dovecot-auth, you can set this to \"none\" protocols = imap imaps pop3 pop3s \u5220\u9664protocols\u884c\u524d\u9762\u7684\u201c#\u201d\u6765\u6fc0\u6d3bimap imaps pop3\u548cpop3s\u670d\u52a1 \u542f\u52a8dovecot: service dovecot start #centos6.x systemctl start dovecot #centos7.x chkconfig dovecot on #centos6.x systemctl enable dovecot #centos7.x \u4f7f\u7528telnet\u547d\u4ee4\u68c0\u6d4b110\uff08pop3\uff09\u548c143\uff08imap\uff09\u7aef\u53e3 telnet 127 .0.0.1 110 telnet 127 .0.0.1 143 ps -ef | grep dovecot # \u663e\u793adovecot\u5b88\u62a4\u8fdb\u7a0b # \u914d\u7f6e\u4f7f\u7528Dovecot SASL\u8fdb\u884cSMTP\u9a8c\u8bc1 # 1\u3001\u7f16\u8f91 /etc/dovecot.conf\uff0c\u786e\u4fddauth default\u533a\u57df\u6709\u5982\u4e0b\u8bbe\u7f6e\u503c\uff1a auth default { socket listen { client { path = /var/spool/postfix/private/auth mode = 0660 user = postfix group = postfix } } mechanisms = plain login } # 2\u3001\u7f16\u8f91/etc/postfix/main.cf\uff0c\u589e\u52a0\u5982\u4e0b\u4ee3\u7801\u542f\u7528sasl\u8ba4\u8bc1 smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_unauth_destination broken_sasl_auth_clients = yes # 3\u3001\u91cd\u542f\u670d\u52a1 service postfix restart service dovecot restart # \u73b0\u5728\u4f60\u53ef\u4ee5\u4f7f\u7528\u90ae\u4ef6\u5ba2\u6237\u7aef\u4ee3\u7406\u8f6f\u4ef6\u548c\u7cfb\u7edf\u7528\u6237\u53ca\u5bc6\u7801\u6765\u8fde\u63a5\u6211\u4eec\u7684Dovecot\u670d\u52a1\u5668\u4e86 # **\u8be6\u7ec6\u914d\u7f6e\u6587\u6863\u8bf4\u660e** * /etc/postfix/\u76ee\u5f55\u6709\u4e24\u4e2a\u4e3b\u914d\u7f6e\u6587\u4ef6main.cf\u548cmaster.cf\uff0c\u6211\u4eec\u4e3b\u8981\u8bbe\u7f6emain.cf\uff0cmaster.cf\u57fa\u672c\u4fdd\u6301\u9ed8\u8ba4\u5c31\u884c postfix\u6709100\u591a\u4e2a\u53c2\u6570\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53bb\u6539\u5c11\u91cf\u7684\u53c2\u6570\uff0c\u5176\u5b83\u4fdd\u6301\u9ed8\u8ba4\u5c31\u53ef \u4fee\u6539\u4efb\u4f55\u6587\u4ef6\u4e4b\u524d\u5fc5\u987b\u628a\u539f\u6587\u4ef6\u5907\u4efd cp /etc/postfix/main.cf /etc/postfix/main.cf.bak vi /etc/postfix/main.cf alias_database = hash:/etc/aliases #\u7528\u6237\u522b\u540d\u6570\u636e\u6587\u4ef6\uff0c\u9ed8\u8ba4\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53ef\u6539\u6210SQL,LDAP,VIRTUAL alias_maps = hash:/etc/aliases #\u7528\u6237\u522b\u540d\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\uff0c\u53ef\u6839\u636e\u81ea\u5df1\u7684\u8981\u6c42\u53ef\u6539\u6210SQL,LDAP,VIRTUAL broken_sasl_auth_clients = yes #\u8bbe\u5b9a SASL \u652f\u6301\u975e\u6807\u51c6 E-mail Client \u7684\u8ba4\u8bc1\u52a8\u4f5c\uff0c\u81ea\u5df1\u6dfb\u52a0 command_directory = /usr/sbin #\u547d\u4ee4\u76ee\u5f55 \u9ed8\u8ba4 config_directory = /etc/postfix #\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 \u9ed8\u8ba4 daemon_directory = /usr/libexec/postfix #\u5b88\u62a4\u8fdb\u7a0b\u76ee\u5f55 \u9ed8\u8ba4 data_directory = /var/lib/postfix #\u6570\u636e\u76ee\u5f55 \u9ed8\u8ba4 debug_peer_level = 2 #\u6392\u9519\u7ba1\u7406\u7ea7\u522b \u9ed8\u8ba4 home_mailbox = Maildir/ #\u4e3b\u76ee\u5f55\u5b58\u50a8\u683c\u5f0f\uff0c\u4f60\u4e5f\u53ef\u4ee5\u8bbe\u6210\u53e6\u5916\u7684\u683c\u5f0fmbox\uff0c html_directory = no #\u662f\u5426\u652f\u6301\u7f51\u9875\u683c\u5f0f\u7ba1\u7406 inet_interfaces = all #\u53c2\u6570\u6307\u5b9apostfix\u7cfb\u7edf\u76d1\u542c\u7684\u7f51\u7edc\u63a5\u53e3 inet_protocols = all #\u53ea\u652f\u6301IPv4\u534f\u8bae\uff0c\u8fd8\u662fIPv4 IPv6\u90fd\u652f\u6301,\u8fd8\u662f\u4e3b\u673a\uff0cip mail_owner = postfix #\u90ae\u4ef6\u53ca\u90ae\u4ef6\u961f\u5217\u7684\u6240\u6709\u8005 #mail_spool_directory = /vbox #\u6307\u5b9aUNIX\u98ce\u683c\u7684\u90ae\u7bb1\u4fdd\u5b58\u7684\u76ee\u5f55\u3002\u9ed8\u8ba4\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u7cfb\u7edf\u7c7b\u578b mailq_path = /usr/bin/mailq.postfix #\u6307\u5b9a\u67e5\u770b\u90ae\u4ef6\u961f\u5217\u547d\u4ee4MAILQ\u7684\u8def\u5f84 manpage_directory = /usr/share/man #Postfix\u7684\u5728\u7ebf\u624b\u518c\u9875\u7684\u4f4d\u7f6e mydestination = $myhostname ,... #\u53c2\u6570\u6307\u5b9apostfix\u63a5\u6536\u90ae\u4ef6\u65f6\u6536\u4ef6\u4eba\u7684\u57df\u540d\uff0c\u5373\u60a8\u7684postfix\u7cfb\u7edf\u8981\u63a5\u6536\u5230\u54ea\u4e2a\u57df\u540d\u7684\u90ae\u4ef6 mydomain = davistest.com #\u53c2\u6570\u6307\u5b9a\u60a8\u7684\u57df\u540d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cpostfix\u5c06myhostname\u7684\u7b2c\u4e00\u90e8\u5206\u5220\u9664\u800c\u4f5c\u4e3amydomain\u7684\u503c myhostname = mail.davistest.com #\u53c2\u6570\u6307\u5b9a\u8fd0\u884cpostfix\u90ae\u4ef6\u7cfb\u7edf\u7684\u4e3b\u673a\u7684\u4e3b\u673a\u540d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5176\u503c\u88ab\u8bbe\u5b9a\u4e3a\u672c\u5730\u673a\u5668\u540d mynetworks = 192 .168.1.0/24 #\u53c2\u6570\u6307\u5b9a\u4f60\u6240\u5728\u7684\u7f51\u7edc\u7684\u7f51\u7edc\u5730\u5740\uff0cpostfix\u7cfb\u7edf\u6839\u636e\u5176\u503c\u6765\u533a\u522b\u7528\u6237\u662f\u8fdc\u7a0b\u7684\u8fd8\u662f\u672c\u5730\u7684 myorigin = $mydomain #\u53c2\u6570\u7528\u6765\u6307\u660e\u53d1\u4ef6\u4eba\u6240\u5728\u7684\u57df\u540d newaliases_path = /usr/bin/newaliases.postfix #\u5237\u65b0\u522b\u540d\u547d\u4ee4newaliases\u8def\u5f84 queue_directory = /var/spool/postfix #\u6307\u5b9a\u961f\u5217\u7684\u4f4d\u7f6e readme_directory = /usr/share/doc/postfix-2.6.6/README_FILES #\u5e2e\u52a9\u6587\u6863\u4f4d\u7f6e sample_directory = /usr/share/doc/postfix-2.6.6/samples #\u6a21\u677f\u6587\u4ef6\u4f4d\u7f6e sendmail_path = /usr/sbin/sendmail.postfix #\u53d1\u9001\u90ae\u4ef6\u547d\u4ee4\u7684\u4f4d\u7f6e setgid_group = postdrop #\u8fd9\u4e2a\u7ec4\u662f\u63d0\u4ea4\u90ae\u4ef6\u548c\u5bf9\u5217\u7ba1\u7406\u547d\u4ee4 message_size_limit = 10240000 #\u9650\u5236\u53d1\u9001\u4eba\u5355\u4e2a\u90ae\u4ef6\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u662fByte smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated,reject_unauth_destination #\u4fe1\u4ef6\u6536\u4ef6\u7684\u9650\u5236 smtpd_sasl_security_options = noanonymous #\u62d2\u7edd\u533f\u540d\u767b\u5165 smtpd_sasl_auth_enable = yes #Postfix SMTP server\u652f\u63f4SASL\u9a8c\u8bc1 smtpd_sasl_path = private/auth #postfix\u4e0edovecot\u901a\u8baf\u7a0b\u5e8f\u6587\u4ef6\u8def\u5f84 smtpd_sasl_type = dovecot #\u6307\u5b9asasl\u9a8c\u8bc1\u7a0b\u5e8f unknown_local_recipient_reject_code = 550 #\u62d2\u7edd\u4e0d\u5b58\u5728\u7684\u672c\u5730\u5e10\u6237\uff0f\u300c\u4e0d\u660e\u4f7f\u7528\u8005\u300d(unknown user) #\u5982\u679c\u6536\u4fe1\u5730\u5740\u7684\u4eba\u540d\u90e8\u4efd\uff0c\u5728\u4efb\u4f55\u5bf9\u7167\u8868\u3001\u522b\u540d\u8868\u3001\u7cfb\u7edf\u5e10\u6237\u90fd\u67e5\u4e0d\u51fa\u6765\uff0c #\u8fd9\u4e2a\u4eba\u4f1a\u88ab\u89c6\u4e3a\u300c\u4e0d\u660e\u4f7f\u7528\u8005\u300d(unknown user)\uff0c\u7cfb\u7edf\u4f1a\u62d2\u6536 #\u5982\u679c\u5e0c\u671b\u8490\u96c6\u8fd9\u7c7b\u4fe1\u4ef6\uff0c\u4f7f\u7528\u4e0b\u5217\u8bbe\u5b9a\uff0c\u5e76\u6307\u5b9a\u96c6\u4e2d\u6536\u96c6\u7684\u4fe1\u7bb1 #\u4ee5\u4e0a\u7684mydestination\u4e00\u5b9a\u8981\u6709\u672c\u673a\u4e3b\u673a\u540d\uff0c\u8981\u4e0d\u7136\u4f1a\u6536\u4e0d\u5230\u4fe1 # postfix\u4e5f\u81ea\u5e26\u5f88\u591a\u53cd\u5783\u573e\u8bbe\u7f6e\uff0c\u53ef\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4ee5\u53ca\u81ea\u5df1\u7684\u9700\u8981\u8fdb\u884c\u8c03\u6574 smtpd_helo_required = yes #\u63e1\u624b\u8981\u6c42 smtpd_delay_reject = yes #\u4e2d\u7ee7\u8981\u6c42 smtpd_client_restrictions = check_client_access hash:/etc/postfix/client_access #\u5ba2\u6237\u7aef\u8bbf\u95ee\u63a7\u5236\u5217\u8868 smtpd_helo_restrictions = reject_invalid_hostname,check_helo_access hash:/usr/local/etc/postfix/helo_access#\u4e3b\u673a\u548c\u63e1\u624b\u63a7\u5236\u5217\u8868 smtpd_sender_restrictions = #\u5ba2\u6237\u7aef\u53d1\u9001\u4eba\u63a7\u5236\u5217\u8868 reject_non_fqdn_sender, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u57df\u540d\u7684\u53d1\u9001\u8005 reject_unknown_sender_domain, #\u62d2\u6536\u4e0d\u77e5\u53d1\u4ef6\u4eba\u57df\u7684\u53d1\u9001\u8005 check_sender_access hash:/usr/local/etc/postfix/sender_access #\u53d1\u4ef6\u4eba\u63a7\u5236\u5217\u8868 smtpd_recipient_restrictions = #\u6536\u4ef6\u63a7\u5236 permit_mynetworks, #\u5141\u8bb8\u6211\u7684\u7f51\u7edc\u5b9a\u4e49\u7684\u5ba2\u6237\u7aef\u6536\u4fe1 permit_sasl_authenticated, #\u5141\u8bb8simple authenticated security layer \u6388\u6743\u7684\u5ba2\u6237\u7aef reject_non_fqdn_hostname, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u7684\u4e3b\u673a reject_non_fqdn_sender, #\u62d2\u6536\u6ca1\u6709\u6ce8\u518c\u7684\u53d1\u9001\u4eba reject_non_fqdn_recipient, #\u62d2\u6536\u6ca1\u6ce8\u518c\u7684\u63a5\u6536\u8005 reject_unauth_destination, #\u62d2\u6536\u6ca1\u6388\u6743\u7684\u76ee\u7684\u4e3b\u673a reject_invalid_hostname, #\u62d2\u6536\u4e0d\u53ef\u7528\u7684\u4e3b\u673a #\u8fd8\u6709\u5f88\u591a smtpd_data_restrictions = reject_unauth_pipelining #\u62d2\u7edd\u6ca1\u6709\u6388\u6743\u7684\u901a\u9053 header_checks = regexp:/postfix/head_checks #\u7edd\u5bf9\u8def\u5f84\u90ae\u4ef6\u5934\uff08\u4e3b\u9898\uff0c\u9644\u4ef6\u540d\u7b49\uff09\u63a7\u5236\u5217\u8868 body_checks = regexp:/etc/postfix/body_checks ##\u7edd\u5bf9\u8def\u5f84\u90ae\u4ef6\u5185\u5bb9\u63a7\u5236\u5217\u8868 \u521b\u5efa\u521a\u624d\u6307\u5b9a\u7684\u6587\u4ef6\u5c31\u4e0d\u4e00\u4e00\u5199\u51fa\u6765\u4e86\uff0c\u7167\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u884c\u4e86 touch /usr/local/etc/postfix/head_checks touch /usr/local/etc/postfix/body_checks postmap /usr/local/etc/postfix/head_checks postmap /usr/local/etc/postfix/body_checks \u8fd8\u662f\u4f8b\u4e3e\u4e00\u4e0b\u5427\uff0c\u8981\u4e0d\u7136\u60f3\u4e86\u89e3\u7684\u90fd\u4e0d\u77e5\u6587\u6863\u600e\u4e48\u5199 \u5047\u5982/etc/postfix/mail.cf \u4e0b\u6709\u5982\u4e0b\u53cd\u5783\u573e\u8bbe\u7f6e\uff1a smtpd_client_restrictions = check_client_access hash:/etc/postfix/access_client smtpd_helo_restrictions = check_client_access hash:/etc/postfix/helo_client smtpd_sender_restrictions = check_client_access hash:/etc/postfix/sender_client smtpd_recipient_restrictions = check_client_access hash:/etc/postfix/recipient_client header_checks = regexp:/etc/postfix/header_check body_checks = regexp:/etc/postfix/body_check \u90a3\u4e48\u6211\u4eec\u5728access_client/helo_client/sender_client/recipient_client \u6587\u4ef6\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a \u5217\u8868\u5206\u4e09\u9879\uff0c\u7b2c\u4e00\u9879\u662f\u89c4\u5219\u5185\u5bb9\uff0c\u7b2c\u4e8c\u9879\u662f\u5bf9\u6ee1\u8db3\u89c4\u5219\u65f6\u6240\u91c7\u53d6\u7684\u884c\u52a8\uff0c\u7b2c\u4e09\u9879\u662f\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u4fe1\u606f \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u4f60\u4e0d\u53ef\u4ee5\u901a\u8fc7\u6211\u4eec\u7684\u670d\u52a1\u5668\u53d1\u90ae\u4ef6\uff01access_client \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u7981\u6b62davis\u901a\u8fc7\u672c\u670d\u52a1\u5668\u53d1\u9001\u90ae\u4ef6 sender_client \u5ba2\u6237\u7aef\u57df\u540d/ip 550 /REJECT/OK.. \u670d\u52a1\u5668\u62d2\u6536\u6765\u81eadavis\u7684\u90ae\u4ef6. recipient_client \u5ba2\u6237\u7aefIP/\u57df\u540d 550 /REJECT/OK.. \u670d\u52a1\u5668\u62d2\u7edd\u4f60\u7684\u8fde\u63a5. helo_client \u4e0d\u8be6\u8bf4\u4e86\uff0c\u77e5\u9053\u5b83\u662f\u600e\u4e48\u5de5\u4f5c\u7684\u5c31\u884c\u4e86\uff0c\u73b0\u5728\u6709\u5f88\u591a\u8f6f\u4ef6,\u6bd4\u5982Mailscanner..\u529f\u80fd\u5f3a\u5927\uff0c\u6613\u7ba1\u7406 \u914d\u5b8c\u4e4b\u540e\uff0c\u4f60\u53ef\u4ee5\u7528postconf -n main.cf\u53bb\u67e5\u770b\u6ca1\u6709\u6ce8\u91ca\u7684\u5185\u5bb9 \u6211\u4eec\u7528pam\u53bb\u8c03\u7528\u8fde\u63a5\u7cfb\u7edf\u7528\u6237\u4e3a\u90ae\u4ef6\u7528\u6237\u9a8c\u8bc1saslauthd,\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528LDAP,MYSQL\u7b49\uff0c\u6216SYRUS\u7684shadow.\u540e\u9762\u6211\u4eec\u4f1a\u8bb2\u5230 # Directory in which to place saslauthd's listening socket, pid file, and so # on. This directory must already exist SOCKETDIR = /var/run/saslauthd # Mechanism to use when checking passwords. Run \"saslauthd -v\" to get a list # of which mechanism your installation was compiled with the ablity to use MECH = pam #\u8fd9\u884cMECH\u8bbe\u6210pam # Options sent to the saslauthd. If the MECH is other than \"pam\" uncomment the next line # DAEMONOPTS=--user saslauth # Additional flags to pass to saslauthd on the command line. See saslauthd(8) # for the list of accepted flags FLAGS = \u6211\u4eec\u7528\u7684\u662fdovecot\u7ed9\u5ba2\u6237\u7aef\u9a8c\u8bc1\u6536\u4fe1\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u786e\u5b9apam\u4e0b\u7684dovecot\u6388\u6743\u5982\u4e0b Vi /etc/pam.d/dovecot #%PAM-1.0 auth required pam_nologin.so auth include password-auth account include password-auth session include password-auth \u63a5\u7740\u914d\u7f6edovecot\u7684\u6536\u4fe1 protocols = imap pop3 lmtp #\u5f00\u653eIMAP POP3 \u7b49\u534f\u8bae \u8def\u5f84/etc/dovecot/dovecot.conf auth_mechanisms = plain login #\u6388\u6743\u673a\u5236\uff0c\u5982\u679c\u6211\u4eec\u7528POSTADMIN\u7f51\u9875\u7ba1\u7406\uff0c\u4e5f\u53ef\u7528\u4ec0\u4e48MD5\u7b49\u7b49 #\u8def\u5f84/etc/dovecot/conf.d/10-auth.conf disable_plaintext_auth = no #\u5141\u8bb8\u7528\u660e\u6587\u8ba4\u8bc1\u767b\u9646\uff0c\u8def\u5f84/etc/dovecot/conf.d/10-auth.conf listen = * #\u6211\u4eec\u53ea\u76d1\u542cIPV4\u7aef\u53e3\u3002\u8def\u5f84/etc/dovecot/dovecot.conf mail_location = maildir:/vbox/%u/Maildir #\u90ae\u4ef6\u76ee\u5f55\uff0c%u\u8868\u793a\u7528\u6237\u540d\u3002\u8def\u5f84/etc/dovecot/conf.d/10-mail.conf mbox_write_locks = fcntl #\u90ae\u7bb1\u9501\u7684\u65b9\u6cd5\u3002\u8def\u5f84/etc/dovecot/conf.d/10-mail.conf passdb { #\u5e10\u6237\u6388\u6743 args = dovecot #\u5c31\u662f/etc/pam.d/\u4e0b\u7684dovecot\u6587\u4ef6 driver = pam #\u5e10\u6237\u6388\u6743\u6570\u636e\u63d0\u4f9b\u5546 } # \u8def\u5f84/etc/dovecot/conf.d/auth-system.conf.ext service auth { #\u670d\u52a1\u6388\u6743 unix_listener /var/spool/postfix/private/auth { #UNIX\u76d1\u542c\u7684\u6388\u6743\u6587\u4ef6 group = postfix #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7684\u5c5e\u7ec4\u4e3aPOSTFIX mode = 0666 #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7ec4\u6743\u9650\u4e3a666 user = postfix #\u6307\u5b9a\u76d1\u542c\u6388\u6743\u6587\u4ef6\u7684\u5c5e\u4e3b\u4e3apostfix } #\u8def\u5f84 /etc/dovecot/conf.d/auth-system.conf.ext } userdb { #\u7528\u6237\u6570\u636e driver = passwd #\u5171\u7528\u7cfb\u7edf\u5bc6\u7801\u9a71\u52a8 } # \u5efa\u7acb\u90ae\u4ef6\u5b58\u653e\u76ee\u5f55\u90ae\u4ef6\u5907\u4efd\u76ee\u5f55 mkdir /vbox #\u5efa\u7acb\u90ae\u4ef6MAILDIR\u76ee\u5f55 chmod 755 /vbox #\u7ed9\u6743\u9650 mkdir /backup #\u5220\u9664\u7528\u6237\u7684\u5907\u4efd\u76ee\u5f55 chmod 755 /backup #\u5907\u4efd\u76ee\u5f55\u6743\u9650 mkdir /etc/postfix/Mail_Group #\u90ae\u4ef6\u7ec4\u8f6f\u94fe\u76ee\u5f55\uff0c\u4ee5\u540e\u505a\u7ba1\u7406\u9762\u7248\u811a\u672c\u8981\u7528 # \u542f\u52a8\u670d\u52a1 service postfix start service dovecot start service saslauthd start # \u8bbe\u7f6e\u670d\u52a1\u5f00\u673a\u81ea\u52a8\u542f\u52a8 chkconfig postfix on chkconfig dovecot on chkconfig saslauthd on ## \u811a\u672c\u7f16\u5199 # \u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 vi /usr/local/sbin/main #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai echo \"1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7\" #\u5728\u5c4f\u5e55\u4e0a\u8f93\u51fa\u83dc\u5355 echo \"2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7\" echo \"3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7\" echo \"4 \u65b0\u5efa\u90ae\u4ef6\u7ec4\" echo \"5 \u5220\u9664\u90ae\u4ef6\u7ec4\" echo \"6 \u67e5\u770b\u90ae\u4ef6\u7ec4\" echo \"7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4\" echo \"8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237\" echo \"0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406\" order = \"\" #\u8bbe\u53c2\u6570\u4e3a\u4f60\u8981\u5148\u62e9\u7684\u83dc\u5355 echo \"\u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a\" read order echo $order >/tmp/order.txt if [ \" $order \" == \"1\" ] ; then #\u8bbe\u6761\u4ef6\u6839\u636e\u4f60\u7684\u9009\u62e9\u8df3\u5230\u76f8\u5e94\u7684\u7ba1\u7406\u6a21\u5757 mailacounts ; elif [ \" $order \" == \"2\" ] ; then viewusers ; elif [ \" $order \" == \"3\" ] ; then dusers ; elif [ \" $order \" == \"4\" ] ; then groupacounts ; elif [ \" $order \" == \"5\" ] ; then dgroup ; elif [ \" $order \" == \"6\" ] ; then viewgroup ; elif [ \" $order \" == \"7\" ] ; then AMFG ; elif [ \" $order \" == \"8\" ] ; then RMFG ; elif [ \" $order \" == \"0\" ] ; then exit 0 ; else #\u5982\u679c\u4f60\u7684\u9009\u62e9\u4e0d\u662f\u4ee5\u4e0a\u83dc\u5355\uff0c\u63d0\u793a\u9519\u8bef\u5e76\u8fd4\u56de\u63a7\u5236\u9762\u7248 echo \"\u4efb\u52a1\u4ee3\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\uff01\" main fi # \u65b0\u5efa\u90ae\u4ef6\u6a21\u5757 vi /usr/local/sbin/mailacounts home = \"/vbox/\" #\u6ca1\u7f6e\u76ee\u5f55\u53c2\u6570 useraccount = \"\" #\u8bbe\u7f6e\u7528\u6237\u53c2\u6570 echo \"\u8bf7\u7ed9\u65b0\u7528\u6237\u540d\u5b57\uff1a\" read useraccount echo $useraccount > /tmp/user.txt #\u7ed9\u7528\u6237\u53c2\u6570\u8d4b\u503c userpass = \"\" #\u8bbe\u7f6e\u5bc6\u7801\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff1a\" read userpass echo $userpass > /tmp/pass.txt #\u7ed9\u5bc6\u7801\u53c2\u6570\u8d4b\u503c useradd -d $home / $useraccount $useraccount #\u6dfb\u52a0\u7528\u6237\u5e76\u6307\u5b9a\u90ae\u4ef6\u4e3b\u76ee\u5f55 echo $userpass | passwd --stdin $useraccount #\u8bbe\u7f6e\u90ae\u7bb1\u5bc6\u7801 mkdir -p $home / $useraccount /Maildir/ { cur,new,tmp } #\u5efa\u90ae\u4ef6\u76ee\u5f55\u548c\u6587\u4ef6 mkdir -p $home / $useraccount /Maildir/.Drafts/ { cur,new,tmp } mkdir -p $home / $useraccount /Maildir/.Sent/ { cur,new,tmp } mkdir -p $home / $useraccount /Maildir/.Trash/ { cur,new,tmp } chown -R $useraccount $home / $useraccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\uff0dR\u662f\u505a\u4e2a\u9012\u5f52\uff0c\u4e5f\u5c31\u662f\u8bf4\u6587\u4ef6\u5939\u4e0b\u6240\u4ee5\u6709\u5b50\u6587\u4ef6\u5939\u548c\u6587\u4ef6 chmod 700 -R $home / $useraccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6709\u5b8c\u5168\u6743\u9650\uff0c\u5176\u5b83\u4eba\u6ca1\u4efb\u4f55\u6743\u9650 main #\u56de\u5230\u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 # \u65b0\u5efa\u90ae\u4ef6\u7ec4\u6a21\u5757 vim /usr/local/sbin/groupacounts #/bin/bash #Create: 14-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ #\u663e\u793a\u73b0\u6709\u7ec4 home = \"/vbox/\" #\u6ca1\u7f6e\u76ee\u5f55\u53c2\u6570 groupaccount = \"\" #\u8bbe\u7f6e\u90ae\u4ef6\u7ec4\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u65b0\u90ae\u4ef6\u7ec4\u540d\uff1a\" read groupaccount echo $groupaccount > /tmp/group.txt #\u7ed9\u7ec4\u90ae\u7bb1\u53c2\u6570\u8d4b\u503c grouppass = \"\" #\u8bbe\u7f6e\u5bc6\u7801\u53c2\u6570 echo \"\u8bf7\u8f93\u5165\u65b0\u90ae\u4ef6\u7ec4\u5bc6\u7801\uff1a\" read grouppass echo $grouppass > /tmp/pass.txt #\u7ed9\u5bc6\u7801\u53c2\u6570\u8d4b\u503c useradd -d $home / $groupaccount $groupaccount #\u6dfb\u52a0\u7ec4\u90ae\u7bb1\u5e76\u6307\u5b9a\u90ae\u4ef6\u4e3b\u76ee\u5f55 echo $grouppass | passwd --stdin $groupaccount #\u8bbe\u7f6e\u7ec4\u90ae\u7bb1\u5bc6\u7801 mkdir -p $home / $groupraccount /Maildir/ { cur,new,tmp } #\u5efa\u7ec4\u90ae\u4ef6\u76ee\u5f55\u548c\u6587\u4ef6 mkdir -p $home / $groupaccount /Maildir/.Drafts/ { cur,new,tmp } mkdir -p $home / $groupaccount /Maildir/.Sent/ { cur,new,tmp } mkdir -p $home / $groupaccount /Maildir/.Trash/ { cur,new,tmp } chown -R $groupaccount $home / $groupaccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6743\u9650\uff0dR\u662f\u505a\u4e2a\u9012\u5f52\uff0c\u4e5f\u5c31\u662f\u8bf4\u6587\u4ef6\u5939\u4e0b\u6240\u4ee5\u6709\u5b50\u6587\u4ef6\u5939\u548c\u6587\u4ef6 chmod 700 -R $home / $groupaccount /* #\u8bbe\u7f6e\u5c5e\u4e3b\u6709\u5b8c\u5168\u6743\u9650\uff0c\u5176\u5b83\u4eba\u6ca1\u4efb\u4f55\u6743\u9650 touch $home / $groupaccount /.forward #\u5efa\u7ec4\u90ae\u4ef6\u540d\u5355\u8868 chown root $home / $groupaccount /.forward #\u8bbe\u7f6e\u6743\u9650\u7ed9\u540d\u5355\u8868 chmod 755 $home / $groupaccount /.forward ln -s $home / $groupaccount /.forward /etc/postfix/Mail_Group/ $groupaccount #\u505a\u4e00\u4e2a\u8f6f\u8fde\u7ed3\uff0c\u4fbf\u4e8e\u67e5\u627e main #\u56de\u5230\u7ba1\u7406\u5458\u63a7\u5236\u9762\u7248 # \u6dfb\u52a0\u90ae\u7bb1\u5230\u6307\u5b9a\u90ae\u7bb1\u7ec4\u6a21\u5757 vim /usr/local/sbin/AMFG #!/bin/bash #Create Date: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group Groupname = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u52a0\u5165\u7684\u7ec4\u5168\u79f0\uff1a\" read Groupname echo $Groupname >/tmp/Groupname.txt cat -n /vbox/ $Groupname /.forward usermail = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u52a0\u7ec4\u7684\u7528\u6237\u90ae\u4ef6\u5730\u5740\uff1a\" read usermail echo $usermail >/tmp/usermail.txt echo $usermail >> /vbox/ $Groupname /.forward main # \u5220\u9664\u90ae\u7bb1\u5e10\u53f7\u6a21\u5757 vim /usr/local/sbin/dusers #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /vbox/ deluser = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\uff1a\" read deluser echo $deluser > /tmp/deluser.txt cp -R -u -i /vbox/ $deluser /backup/ userdel $deluser rm -rf /vbox/ $deluser main \u5220\u9664\u90ae\u7bb1\u7ec4\u6a21\u5757 vim /usr/local/sbin/dgroup #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ degroup = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u90ae\u4ef6\u7ec4\uff1a\" read degroup echo $degroup > /tmp/degroup.txt cp -R -u -i /vbox/ $degroup /backup/ userdel $degroup rm -rf /vbox/ $degroup main # \u67e5\u627e\u90ae\u7bb1\u7528\u6237\u6a21\u5757 vim /usr/local/sbin/viewusers #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /vbox/ >/tmp/userview.txt cat -n /tmp/userview.txt svuser = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u67e5\u627e\u7684\u7528\u6237\u540d\uff1a\" read svuser echo $svuser > /tmp/svuser.txt if grep -q $svuser /tmp/userview.txt ; then echo \"\u7528\u6237 $svuser\u5df2\u7ecf\u5b58\u5728 !\" ; else echo \"\u7528\u6237 $svuser\u4e0d\u5b58\u5728 !\" ; fi grep -n $svuser /tmp/userview.txt main # \u67e5\u627e\u7528\u6237\u7ec4\u6a21\u5757 vim /usr/local/sbin/viewgroup #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group/ >/tmp/groupview.txt cat -n /tmp/groupview.txt svgroup = \"\" echo \"\u8bf7\u8f93\u5165\u4f60\u8981\u67e5\u627e\u7684\u90ae\u4ef6\u7ec4\uff1a\" read svgroup echo $svuser > /tmp/svgroup.txt if grep -q $svgroup /tmp/groupview.txt ; then echo \"\u90ae\u4ef6\u7ec4 $svgroup\u5df2\u7ecf\u5b58\u5728 !\" ; else echo \"\u90ae\u4ef6\u7ec4 $group\u4e0d\u5b58\u5728 !\" ; fi grep -n $svgroup /tmp/groupview.txt main # \u4ece\u90ae\u7bb1\u7ec4\u91cc\u5220\u9664\u7528\u6237\u6a21\u5757 vi /usr/local/sbin/RMFG #!/bin/bash #create: 15-Nov-2014 #Creater: Davis Dai ls /etc/postfix/Mail_Group >/tmp/groupview.txt cat -n /tmp/groupview.txt sgroup = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\u5c5e\u7ec4\u540d\u79f0\uff1a\" read sgroup echo $scgoup >/tmp/sgroup.txt cat -n /vbox/ $sgroup /.forward rguser = \"\" echo \"\u8bf7\u952e\u5165\u4f60\u8981\u5220\u9664\u7684\u7528\u6237\u7f16\u53f7\uff1a\" read rguser echo $rguser >/tmp/rguser.txt sed -i '' $rguser 'd' /vbox/ $sgroup /.forward #\u6309\u7f16\u53f7\u5220\u9664 #sed -i \u201c/$rguser/d\u201d /vbox/$sgroup/.forward #\u6309\u5730\u5740\u5220\u9664 main","title":"\u5b89\u88c5\u548c\u914d\u7f6edovecot"},{"location":"Linux/#_14","text":"# \u8fdb\u5165\u670d\u52a1\u5668\uff0c\u8f93\u5165\u90ae\u4ef6\u7ba1\u7406\u547d\u4ee4main,\u7ba1\u7406\u6240\u6709\u7684\u4efb\u52a1 [ root@mail sbin ] # main 1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7 3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7 4 \u65b0\u5efa\u90ae\u4ef6\u7ec4 5 \u5220\u9664\u90ae\u4ef6\u7ec4 6 \u67e5\u770b\u90ae\u4ef6\u7ec4 7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4 8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237 0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406 \u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a # \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 [ root@mail ~ ] # main 1 \u65b0\u5efa\u90ae\u4ef6\u5e10\u53f7 2 \u67e5\u770b\u90ae\u4ef6\u5e10\u53f7 3 \u5220\u9664\u90ae\u4ef6\u5e10\u53f7 4 \u65b0\u5efa\u90ae\u4ef6\u7ec4 5 \u5220\u9664\u90ae\u4ef6\u7ec4 6 \u67e5\u770b\u90ae\u4ef6\u7ec4 7 \u6dfb\u52a0\u7528\u6237\u5230\u7ec4 8 \u4ece\u7ec4\u91cc\u5220\u9664\u7528\u6237 0 \u9000\u51fa\u90ae\u4ef6\u7ba1\u7406 \u8bf7\u9009\u62e9\u4efb\u52a1\u4ee3\u7801\uff1a 1 \u8bf7\u7ed9\u65b0\u7528\u6237\u540d\u5b57\uff1a john \u8bf7\u8f93\u5165\u7528\u6237\u5bc6\u7801\uff1a 123456 Changing password for user john passwd: all authentication tokens updated successfully # \u5ba2\u6237\u7aef\u6d4b\u8bd5 \u53ea\u6d4b\u8bd5\u6536\u53d1\u4fe1\uff0c\u5176\u5b83\u7ec4\u5440\uff0c\u5b89\u5168\u7b49\u90fd\u53ef\u4ee5\u81ea\u884c\u8bbe\u7f6e # PostfixAdmin\u7f51\u9875\u7ba1\u7406\u754c\u9762 # \u4f9d\u8d56\u5305\u7684\u5b89\u88c5 yum install \uff0d y mysql - server php php - mysql php - imap php - mbstring # [ PostfixAdmin\u8f6f\u4ef6\u6e90\u7801\u5305\u4e0b\u8f7d\u7f51\u5740 ] ( https : // sourceforge . net / projects / postfixadmin / files / postfixadmin / ) # \u4e0b\u8f7d\u89e3\u538b\u540e\u6dfb\u52a0\u6743\u9650 tar - xzvf postfixadmin - 2.92 . tar . gz chmod 777 / postfixadmin / - R # \u4fee\u6539PostfixAdmin\u7f51\u9875\u4e3b\u914d\u7f6e\u6587\u4ef6 vim / postfixadmin / config . inc . php $ CONF [ 'configured' ] = true ; $ CONF [ 'postfix_admin_url' ] = '/postfixadmin' ; $ CONF [ 'database_type' ] = 'mysqli' ; $ CONF [ 'database_host' ] = 'localhost' ; $ CONF [ 'database_user' ] = 'vmail' ; $ CONF [ 'database_password' ] = 'vmail' ; $ CONF [ 'database_name' ] = 'vmail' ; $ CONF [ 'domain_path' ] = 'YES' ; $ CONF [ 'domain_in_mailbox' ] = 'NO' ; $ CONF [ 'encrypt' ] = 'dovecot:CRAM-MD5' ; $ CONF [ 'emailcheck_resolve_domain ] = 'NO' ; $ CONF [ 'dovecotpw' ] = \"/usr/bin/doveadm pw\" ; # \u65b0\u5efaPostfixAdmin\u6570\u636e\u5e93,\u542f\u52a8MySql\u670d\u52a1 service mysqld start \u8fdb\u5165MySql\u547d\u4ee4\u5de5\u5177\uff0c\u9ed8\u8ba4\u7684MySql\u7528\u6237root\u7684\u5bc6\u7801\u662f\u7a7a\u7684 mysql -u root -p mysql> CREATE DATABASE vmail ; mysql> GRANT ALL PRIVILEGES ON vmail.* TO 'vmail' @ 'localhost' IDENTIFIED BY 'vmail' ; mysql> flush privileges ; mysql> \\q touch /postfixadmin/DATABASE_MYSQL.TXT mysql -uvmail -p vmail < /postfixadmin/DATABASE_MYSQL.TXT \u5982\u679c\u663e\u793aACCESS DENIY, mysql -u vmail -p vmail mysql> set password = password ( 'newpassword' ) \u914d\u7f6ePostfixAdmin\u7f51\u9875\u7ba1\u7406\u5e94\u7528 \u5b89\u88c5\u7f51\u9875\u7a0b\u5e8fapache, \u9ed8\u8ba4\u662f\u5df2\u5b89\u88c5\u7684\uff0c\u6240\u4ee5\u8fd9\u4f60\u53ef\u4ee5\u7701\u4e86\uff0c\u4f60\u53ef\u4ee5\u5148\u67e5\u770b\u4e00\u4e0b\uff0c\u662f\u5426\u6709\u5b89\u88c5\uff0c\u518d\u51b3\u5b9a rpm -qa | grep httpd #\u67e5\u770b\u662f\u5426\u5b89\u88c5 yum install httpd -y #\u5b89\u88c5 \u65b0\u5efa\u7f51\u9875\u7d22\u5f15\u6587\u4ef6 vim /etc/httpd/conf.d/postfixadmin.conf Alias /postfixadmin /postfixadmin \u542f\u52a8Apache\u670d\u52a1 service httpd start POSTFIX\u7684\u865a\u62df\u7528\u6237MYSQL\u8bbe\u7f6e\u548csasl\u8bbe\u7f6e \u5efa\u7acb\u90ae\u4ef6\u76ee\u5f55\u548c\u7ba1\u7406\u7528\u6237 useradd -u 1000 -d /vmail -s /sbin/nologin vmail mkdir /vmail chmod 770 /vmail/ chown vmail:vmail /vmail/ vim /etc/postfix/main.cf \u52a0\u5165\u5982\u4e0b\u8bbe\u7f6e ######################Virtual Settings########################## virtual_mailbox_domains = proxy:mysql:/etc/postfix/mysql_virtual_domains_maps.cf virtual_alias_maps = proxy:mysql:/etc/postfix/mysql_virtual_alias_maps.cf virtual_mailbox_maps = proxy:mysql:/etc/postfix/mysql_virtual_mailbox_maps.cf virtual_mailbox_base = /vmail virtual_minimum_uid = 1000 virtual_uid_maps = static:1000 virtual_gid_maps = static:1000 virtual_transport = dovecot #####################SASL Settings############################### smtpd_sasl_type = dovecot smtpd_sasl_path = private/auth smtpd_sasl_auth_enable = yes smtpd_sasl_security_options = noanonymous broken_sasl_auth_clients = yes smtpd_recipient_restrictions = permit_mynetworks, permit_sasl_authenticated, reject_non_fqdn_hostname, reject_non_fqdn_sender, reject_non_fqdn_recipient, reject_unknown_sender_domain, reject_unknown_recipient_domain, reject_unauth_pipelining, reject_unauth_destination, reject_invalid_hostname ###################Mail Quota Settings############################### message_size_limit = 204800000 maximal_queue_lifetime = 1d bounce_queue_lifetime = 1d vim /etc/postfix/master.cf \u6700\u540e\u884c\u52a0\u5165\uff0cflages \u524d\u4e00\u5b9a\u8981\u6709\u4e24\u4e2a\u7a7a\u683c\u54e6 dovecot unix - n n - - pipe flags = DRhu user = vmail:vmail argv = /usr/libexec/dovecot/deliver -d ${ recipient } [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_domains_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = domain select_field = domain where_field = domain additional_conditions = and backupmx = '0' and active = '1' [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_alias_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = alias select_field = goto where_field = address additonal_conditions = and active = '1' [ root@mail ~ ] # vim /etc/postfix/mysql_virtual_mailbox_maps.cf user = vmail password = vmail hosts = localhost dbname = vmail table = mailbox select_field = CONCAT ( domain, '/' ,maildir ) where_field = username additional_conditions = and active = '1' vim /etc/postfix/mysql_virtual_mailbox_limit_maps.cf user = vmail password vmail hosts = localhost dbname = vmail table = mailbox select_field = quota where_field = username additional_conditions = and active = '1' DOVECOT\u6536\u4fe1\u548cSMTPD\u8ba4\u8bc1 [ root@mail ~ ] # vim /etc/dovecot/dovecot.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 protocols = imap pop3 lmtp listen = * base_dir = /var/run/dovecot/ #first_valid_uid = 89 #last_valid_uid = 89 #maildir_copy_with_hardlinks = yes [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-auth.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 disable_plaintext_auth = no auth_mechanisms = plain login cram-md5 !include auth-sql.conf.ext [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-master.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 unix_listener /var/spool/postfix/private/auth { mode = 0666 user = vmail group = vmail } [ root@mail ~ ] # vim /etc/dovecot/conf.d/10-mail.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 mail_location = maildir:/vmail/%u/Maildir [ root@mail ~ ] # vim /etc/dovecot/conf.d/15-lda.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 protocol lda { postmaster_address = postmaster@dggd.com sendmail_path = /usr/lib/sendmail auth_socket_path = /var/run/dovecot/auth-master } [ root@mail ~ ] # vim /etc/dovecot/conf.d/20-pop3.conf \u4fee\u6539\u5982\u4e0b\u9009\u9879 pop3_uidl_format = %08Xu%08Xv [ root@mail ~ ] # vim /etc/dovecot/conf.d/auth-sql.conf.ext \u4fee\u6539\u5982\u4e0b\u9009\u9879 passdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext } userdb { driver = sql args = /etc/dovecot/dovecot-sql.conf.ext } [ root@mail ~ ] # vim /etc/dovecot/dovecot-sql.conf.ext driver = mysql connect = host = localhost dbname = vmail user = vmail password = vmail default_pass_scheme = PLAIN-MD5 password_query = SELECT username as user, password, '/vmail/%d/%n' as userdb_home, 'maildir:/vmail/%d/%n/Maildir' as userdb_mail, 1000 as userdb_uid, 1000 as userdb_gid FROM mailbox WHERE username = '%u' AND active = '1' user_query = SELECT '/vmail/%d/%n' as home, 'maildir:/vmail/%d/%n/Maildir' as mail, 1000 AS uid, 1000 AS gid, concat ( 'dirsize:storage=' , quota ) AS quota FROM mailbox WHERE username = '%u' AND active = '1' \u6539\u6587\u4ef6\u6743\u9650 [ root@mail ~ ] # chmod 600 /etc/dovecot/* -R [ root@mail ~ ] # chown vmail /etc/dovecot/* -R [ root@mail ~ ] # chomd 777 /var/run/dovecot/auth-master \u6253\u5f00PostfixAdmin\u7ba1\u7406\u754c\u9762 http://localhost/postfixadmin/setup.php \u586b\u5199\u5b89\u88c5\u5bc6\u7801 \u590d\u5236\u4ea7\u751f\u51fa\u6765\u7684\u5b89\u88c5\u5bc6\u7801\u5199\u5165\u5230\u4e3b\u914d\u7f6e\u6587\u4ef6/postfixadmin/config.inc.php\u7684 $CONF [ 'setup_password' ] = '' ; \u7136\u540e\u8bbe\u7f6e\u8d85\u7ea7\u7ba1\u7406\u5458\u548c\u5bc6\u7801 \u63a5\u7740\u6210\u529f\u7684\u767b\u9646PostfixAdmin\u7ba1\u7406\u4f60\u7684\u90ae\u4ef6\u5e10\u6237 RoundCube\u7f51\u9875\u8bbf\u95ee\u5ba2\u6237\u7aef \u4e0b\u8f7d\u89e3\u538b\u6539\u540d\uff0c\u653e\u5165\u7f51\u9875\u5f15\u5bfc\u8def\u5f84 \u4e0b\u8f7d wget http://sourceforge.net/projects/roundcubemail/files/roundcubemail/1.0.3/roundcubemail-1.0.3.tar.gz/download \u89e3\u538b tar -zxvf roundcubemail-1.0.3.tar.gz \u653e\u5165\u7f51\u9875\u5f15\u5bfc\u8def\u5f84 cp roundcubemail-1.0.3 /var/www/html/ -R \u6539\u540d mv /var/www/html/roundcubemail-1.0.3 /var/www/html/usermail Apache\u6dfb\u52a0php\u6a21\u5757 vim /etc/httpd/conf/httpd.conf \u6dfb\u52a0\u4e0b\u9762\u4e24\u884c AddType application/x-httpd-php .php PHPIniDir \"/etc/php.ini\" \u6dfb\u52a0PHP\u6a21\u5757\u65f6\u95f4\u533a\u57df vim /etc/php.ini \u6dfb\u52a0\u4e0b\u9762\u4e00\u884c date.timezone = Asia/Shanghai \u4fee\u6539\u6743\u9650 chmod 777 /var/www/html/usermail/temp chmod 777 /var/www/html/usermail/logs chmod 777 /var/www/html/usermail/config -R chmod 777 /var/lib/php/session -R \u914d\u7f6eCONFIG\u6587\u4ef6\u4e0epostfixadmin\u8fde\u63a5\u540c\u4e00\u4e2a\u6570\u636e\u5e93 \u542f\u7528CONFIG\u6587\u4ef6 cp /var/www/html/usermail/config/config.inc.php.sample /var/www/html/usermail/config/config.inc.php \u6539\u5199MYSQL\u6570\u636e\u67e5\u8be2\u4e0ePOSTFIXADMIN\u4e00\u6837 vim /var/www/html/usermail/config/config.inc.php \u4fee\u6539\u4e0b\u9762\u4e00\u884c $config [ 'db_dsnw' ] = 'mysql://vmail:vmail@localhost/vmail' ; $config [ 'enable_installer' ] = true ; \u5b89\u88c5PHP-DOM yum install php53-dom yum -y install php-dom \u7f51\u9875\u914d\u7f6e 1 : http://\u57df\u540d\u6216IP/usermail/installer \u6253\u5f00IE\uff0c\u70b9\u51fbNEXT ( \u4e0b\u4e00\u6b65 ) 2 : Create config\uff0c\u8bbe\u7f6e\u4f60\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u663e\u793a/\u670d\u52a1\u5668\u540d/\u7f51\u7edc/\u6570\u636e\u5e93\u8fde\u63a5 ( \u4e0epostfixadmin\u76f8\u540c\u6570\u636e ) ..\u7b49\u7b49\u3002\u81ea\u5df1\u63e3\u6478 3 : TEST CONFIG \u51fa\u73b0\u5982\u4e0bNOT OK.\u6570\u636e\u5e93\u6ca1\u6709\u521d\u59cb\u5316 Check DB config DSN ( write ) : OK DB Schema: NOT OK ( Database not initialized ) \u70b9\u51fb Initialize Database, \u521d\u59cb\u5316\u6570\u636e\uff0c\u5b83\u4f1a\u8fd4\u56de\u7ed3\u679cOK Check DB config DSN ( write ) : OK DB Schema: OK DB Write: OK DB Time: OK \u8f93\u5165POSTFIXADMIN\u5efa\u7684\u90ae\u4ef6\u5730\u5740\u6d4b\u8bd5SMTP\u548cIMAP.\u4f1a\u8fd4\u56de\u7ed3\u679cOK \u5b8c\u6210\u4e86\uff0chttp://\u57df\u540d\u6216IP/usermail *** *** *** <h1 style = \"text-align:center\" >OPENWEBMAIL\u7f51\u9875\u90ae\u4ef6\u67b6\u8bbe</h1> # \u5b89\u88c5\u524d\u63d0\uff1ayum \u2013y install perl-suidperl perl-Compress-Zlib perl-Text-Iconv\u6216yum install -y perl* \u5982\u679cPERL-TEST-ICOV \u5b89\u88c5\u5931\u8d25\uff0c\u8bf7\u53c2\u7167\u5982\u4e0b\u53bb\u4e0b\u8f7d: wget http://openwebmail.org/openwebmail/download/redhat/rpm/packages/centos5/ \\ perl-Text-Iconv/i386/perl-Text-Iconv-1.7-2.el5.i386.rpm \u5b89\u88c5\uff1arpm -ivh perl-Text-Iconv-1.7-2.el5.i386.rpm \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u6210\u529f\uff1a rpm \u2013qa | grep perl- \u5b89\u88c5APACHE: Yum \u2013y install httpd \u8fdb\u5165YUM\u6e90\u76ee\u5f55\uff1acd /etc/yum.repos.d \u4e0b\u8f7dYum\u6e90\uff1awpget http://openwebmail.org/openwebmail/download/redhat/rpm/release/openwebmail.repo \u5728\u7ebf\u5b89\u88c5\uff1aYum \u2013y install openwebmail \u79bb\u7ebf\u5b89\u88c5\uff1ahttp://openwebmail.org/openwebmail/download/release/openwebmail-2.53.tar.gz # \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff1a vim /var/www/cgi-bin/openwebmail/etc/default/dbm.conf vim /var/www/cgi-bin/openwebmail/etc/dbm.conf dbm_ext .pag dbmopen_ext none dbmopen_haslock yes smtpserver 192 .168.222.41 cd /var/www/cgi-bin/openwebmail/ ./openwebmail-tool.pl \u2013-init # \u6d4b\u8bd5 IE\u8bbf\u95ee\uff1ahttp://mail.davis.dg/cgi-bin/openwebmail/openwebmail.pl # POSTFIX\u90ae\u4ef6\u6062\u590d \u4f8b\u5982\uff1a\u6062\u590d\u201cDNS\u201d\u90ae\u4ef6\u76ee\u5f55 \u4ece\u90ae\u4ef6\u670d\u52a1\u5668backup\u76ee\u5f55/restore/davis_dai\u627e\u5230\u8981\u6062\u590d\u7684 cd /restore/davis_dai/Maildir drwx\u2014\u2014 5 davis_dai 2000 4 .0K Nov 14 14 :36 .Boss drwx\u2014\u2014 5 davis_dai 2000 4 .0K Oct 8 2012 .Deleted Items drwx\u2014\u2014 5 davis_dai 2000 4 .0K May 6 09 :12 .Deleted Messages drwx\u2014\u2014 5 davis_dai users 4 .0K Nov 14 14 :36 .DNS cp -a .DNS /home/davis_dai/Maildir Fix the permission chown davis_dai /home/davis_dai/Maildir/.DNS -R sendmail\u5b89\u88c5 ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.15.2.tar.gz","title":"\u7ba1\u7406\u5458\u624b\u518c"},{"location":"Memcached/","text":"memcached\u914d\u7f6e\u6587\u4ef6 \u00b6 #! /bin/bash # # memcached: MemCached Daemon # # chkconfig: - 90 25 # description: MemCached Daemon # ### BEGIN INIT INFO # Provides: memcached # Required-Start: $syslog # Required-Stop: $syslog # Should-Start: $local_fs # Should-Stop: $local_fs # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: memcached - Memory caching daemon # Description: memcached - Memory caching daemon ### END INIT INFO IP = 127.0.0.1 PORT = 11211 USER = root MAXCONN = 1024 CACHESIZE = 64 OPTIONS = \"\" RETVAL = 0 prog = \"memcached\" start () { echo -n $\"Starting $prog: \" /usr/local/memcached/bin/memcached -d -l $IP -p $PORT -u $USER -m $CACHESIZE -c $MAXCONN -P /var/run/memcached.pid $OPTIONS if [ \"$?\" ! = 0 ] ; then echo \" failed\" exit 1 else touch /var/lock/subsys/memcached echo \" done\" fi } stop () { echo -n $\"Stopping $prog: \" if [ ! -e /var/run/$prog.pid ]; then echo -n $\"$prog is not running.\" exit 1 fi kill `cat /var/run/memcached.pid` if [ \"$?\" ! = 0 ] ; then echo \" failed\" exit 1 else rm -f /var/lock/subsys/memcached rm -f /var/run/memcached.pid echo \" done\" fi } restart () { $0 stop sleep 2 $0 start } # See how we were called. case \"$1\" in start) start ;; stop) stop ;; restart|reload) restart ;; *) echo $\"Usage: $0 {start|stop|status|restart|reload}\" exit 1 ;; esac exit $? \u6e05\u7a7amemcache\u7f13\u5b58 \u9ed8\u8ba4memcache\u4f1a\u76d1\u542c11221\u7aef\u53e3\uff0c\u5982\u679c\u60f3\u6e05\u7a7a\u670d\u52a1\u5668\u4e0amemecache\u7684\u7f13\u5b58\uff0c\u5927\u5bb6\u4e00\u822c\u4f7f\u7528\u7684\u662f\uff1a telnet localhost 11211 flush_all quit \u540c\u6837\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a echo \u201cflush_all\u201d | nc localhost 11211 \u6216 echo \u201cflush_all\u201d | nc -q localhost 11211 \u4f7f\u7528flush_all \u540e\u5e76\u4e0d\u662f\u5220\u9664memcache\u4e0a\u7684key\uff0c\u800c\u662f\u7f6e\u4e3a\u8fc7\u671f","title":"Memcached"},{"location":"Memcached/#memcached","text":"#! /bin/bash # # memcached: MemCached Daemon # # chkconfig: - 90 25 # description: MemCached Daemon # ### BEGIN INIT INFO # Provides: memcached # Required-Start: $syslog # Required-Stop: $syslog # Should-Start: $local_fs # Should-Stop: $local_fs # Default-Start: 2 3 4 5 # Default-Stop: 0 1 6 # Short-Description: memcached - Memory caching daemon # Description: memcached - Memory caching daemon ### END INIT INFO IP = 127.0.0.1 PORT = 11211 USER = root MAXCONN = 1024 CACHESIZE = 64 OPTIONS = \"\" RETVAL = 0 prog = \"memcached\" start () { echo -n $\"Starting $prog: \" /usr/local/memcached/bin/memcached -d -l $IP -p $PORT -u $USER -m $CACHESIZE -c $MAXCONN -P /var/run/memcached.pid $OPTIONS if [ \"$?\" ! = 0 ] ; then echo \" failed\" exit 1 else touch /var/lock/subsys/memcached echo \" done\" fi } stop () { echo -n $\"Stopping $prog: \" if [ ! -e /var/run/$prog.pid ]; then echo -n $\"$prog is not running.\" exit 1 fi kill `cat /var/run/memcached.pid` if [ \"$?\" ! = 0 ] ; then echo \" failed\" exit 1 else rm -f /var/lock/subsys/memcached rm -f /var/run/memcached.pid echo \" done\" fi } restart () { $0 stop sleep 2 $0 start } # See how we were called. case \"$1\" in start) start ;; stop) stop ;; restart|reload) restart ;; *) echo $\"Usage: $0 {start|stop|status|restart|reload}\" exit 1 ;; esac exit $? \u6e05\u7a7amemcache\u7f13\u5b58 \u9ed8\u8ba4memcache\u4f1a\u76d1\u542c11221\u7aef\u53e3\uff0c\u5982\u679c\u60f3\u6e05\u7a7a\u670d\u52a1\u5668\u4e0amemecache\u7684\u7f13\u5b58\uff0c\u5927\u5bb6\u4e00\u822c\u4f7f\u7528\u7684\u662f\uff1a telnet localhost 11211 flush_all quit \u540c\u6837\u4e5f\u53ef\u4ee5\u4f7f\u7528\uff1a echo \u201cflush_all\u201d | nc localhost 11211 \u6216 echo \u201cflush_all\u201d | nc -q localhost 11211 \u4f7f\u7528flush_all \u540e\u5e76\u4e0d\u662f\u5220\u9664memcache\u4e0a\u7684key\uff0c\u800c\u662f\u7f6e\u4e3a\u8fc7\u671f","title":"memcached\u914d\u7f6e\u6587\u4ef6"},{"location":"MongoDB/","text":"MongoDB-4.0.10 \u00b6 \u57fa\u7840 \u00b6 views\u662f\u53ea\u8bfb\u7684\u4e14\u65e0\u6cd5\u91cd\u65b0\u547d\u540d\uff0c\u5bf9\u89c6\u56fe\u6267\u884c\u5199\u64cd\u4f5c\u4f1a\u62a5\u9519\uff0c\u89c6\u56fe\u652f\u6301\u7684\u8bfb\u64cd\u4f5c\u6709\uff1a db . collection . find () db . collection . findOne () db . collection . aggregate () db . collection . countDocuments () db . collection . estimatedDocumentCount () db . collection . count () db . collection . distinct () \u89c6\u56fe\u4f7f\u7528\u57fa\u7840\u96c6\u5408\u7684\u7d22\u5f15\u3002\u7531\u4e8e\u7d22\u5f15\u4f4d\u4e8e\u57fa\u7840\u96c6\u5408\u4e0a\uff0c\u56e0\u6b64\u65e0\u6cd5\u76f4\u63a5\u5728\u89c6\u56fe\u4e0a\u521b\u5efa\uff0c\u5220\u9664\u6216\u91cd\u65b0\u6784\u5efa\u7d22\u5f15\uff0c\u4e5f\u65e0\u6cd5\u5728\u89c6\u56fe\u4e0a\u83b7\u53d6\u7d22\u5f15\u5217\u8868\u3002\u65e0\u6cd5\u5728\u89c6\u56fe\u4f7f\u7528 natural\u6392\u5e8f,\u5982\u679c\u89c6\u56fe\u662f\u57fa\u4e8e\u5206\u7247\u521b\u5efa\uff0c\u5219\u89c6\u56fe\u4e5f\u88ab\u89c6\u4e3a\u5206\u7247\uff0c\u65e0\u6cd5\u4e3afrom\u5b57\u6bb5 natural\u6392\u5e8f,\u5982\u679c\u89c6\u56fe\u662f\u57fa\u4e8e\u5206\u7247\u521b\u5efa\uff0c\u5219\u89c6\u56fe\u4e5f\u88ab\u89c6\u4e3a\u5206\u7247\uff0c\u65e0\u6cd5\u4e3afrom\u5b57\u6bb5 lookup\u548c$graphlookup\u64cd\u4f5c\u6307\u5b9a\u5206\u7247\u89c6\u56fe\u3002 \u521b\u5efa\u89c6\u56fe\u662f\u53ef\u4ee5\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\uff0c\u9ed8\u8ba4\u89c4\u5219\u662f\u201c\u7b80\u5355\u201d\u4e8c\u8fdb\u5236\u6bd4\u8f83\u6392\u5e8f\u89c4\u5219\uff0c\u591a\u4e2a\u89c6\u56fe\u505a\u805a\u5408\u64cd\u4f5c\uff0c\u6392\u5e8f\u89c4\u5219\u5fc5\u987b\u76f8\u540c find()\u5bf9\u89c6\u56fe\u7684\u64cd\u4f5c\u4e0d\u652f\u6301\u4ee5\u4e0bProjection\u64cd\u4f5c\u7b26\uff1a $ $elemMatch $slice $meta Capped Collections \u00b6 Capped Collections\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u96c6\u5408\uff0c\u652f\u6301\u57fa\u4e8e\u63d2\u5165\u987a\u5e8f\u63d2\u5165\u548c\u68c0\u7d22\u6587\u6863\u7684\u9ad8\u541e\u5410\u91cf\u64cd\u4f5c\u3002\u4ee5\u7c7b\u4f3c\u4e8e\u5faa\u73af\u7f13\u51b2\u533a\u7684\u65b9\u5f0f\u5de5\u4f5c\uff1a\u4e00\u65e6\u96c6\u5408\u586b\u5145\u5176\u5206\u914d\u7684\u7a7a\u95f4\uff0c\u5b83\u901a\u8fc7\u81ea\u52a8\u5220\u9664\u96c6\u5408\u4e2d\u6700\u65e7\u7684\u6587\u6863\u4e3a\u65b0\u6587\u6863\u817e\u51fa\u7a7a\u95f4 \u65e0\u6cd5\u4ececapped\u96c6\u5408\u5220\u9664\u6587\u6863\uff0c\u8981\u4ece\u96c6\u5408\u5220\u9664\u6587\u6863\u7684\u65b9\u6cd5\uff0c\u4f7f\u7528drop()\u65b9\u6cd5\u5220\u9664\u96c6\u5408\u5e76\u91cd\u65b0\u521b\u5efa\uff0ccapped\u96c6\u5408\u65e0\u6cd5\u5206\u7247\u3002\u521b\u5efacapped\u96c6\u5408\uff0c\u5fc5\u987b\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u6307\u5b9a\u96c6\u5408\u7684\u6700\u5927\u5927\u5c0f\u3002\u5982\u679csize\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e4096\uff0c\u5219\u96c6\u5408\u7684\u4e0a\u9650\u4e3a4096\u5b57\u8282\u3002\u5426\u5219\uff0cMongoDB\u5c06\u63d0\u9ad8\u63d0\u4f9b\u7684\u5927\u5c0f\uff0c\u4f7f\u5176\u6210\u4e3a256\u7684\u6574\u6570\u500d\uff1b\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8be5max\u5b57\u6bb5\u4e3a\u96c6\u5408\u6307\u5b9a\u6700\u5927\u6587\u6863\u6570\u3002\u8be5size\u53c2\u6570\u603b\u662f\u5fc5\u9700\u7684\uff0c\u5373\u4f7f\u4f60\u6307\u5b9amax\u7684\u6587\u4ef6\u6570\u91cf\u3002\u5982\u679c\u96c6\u5408\u5728\u8fbe\u5230\u6700\u5927\u6587\u6863\u8ba1\u6570\u4e4b\u524d\u8fbe\u5230\u6700\u5927\u5927\u5c0f\u9650\u5236\uff0cMongoDB\u5c06\u5220\u9664\u65e7\u6587\u6863 \u5c06\u96c6\u5408\u8f6c\u6362\u4e3acapped\u96c6\u5408:db.runCommand({\"convertToCapped\": \"collectionName\", size: 10000});\u5728\u64cd\u4f5c\u671f\u95f4\u4fdd\u5b58\u6570\u636e\u5e93\u72ec\u5360\u9501\u3002\u9501\u5b9a\u540c\u4e00\u6570\u636e\u5e93\u7684\u5176\u4ed6\u64cd\u4f5c\u5c06\u88ab\u963b\u6b62\uff0c\u76f4\u5230\u64cd\u4f5c\u5b8c\u6210 capped\u66ff\u4ee3\u65b9\u6848\uff1a\u4f7f\u7528TTL(\u751f\u5b58\u65f6\u95f4)\u7d22\u5f15\u4ece\u96c6\u5408\u5220\u9664\u8fc7\u671f\u6570\u636e\uff1b\u8fd9\u4e9b\u7d22\u5f15\u5141\u8bb8\u60a8\u6839\u636e\u65e5\u671f\u7c7b\u578b\u5b57\u6bb5\u7684\u503c\u548c\u7d22\u5f15\u7684TTL\u503c\u4f7f\u6b63\u5e38\u96c6\u5408\u4e2d\u7684\u6570\u636e\u5230\u671f\u548c\u5220\u9664\u3002TTL\u7d22\u5f15\u4e0ecapped\u96c6\u5408\u4e0d\u517c\u5bb9 \u6bcf\u79cdBSON\u7c7b\u578b\u90fd\u6709\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6807\u8bc6\u7b26\uff0c\u5982\u4e0b\u8868\u6240\u793a | Type | Number | Alias | Notes | | :------: | :------: | :------: | :------: | | Double | 1 | \u201cdouble\u201d | | String | 2 | \u201cstring\u201d | | Object | 3 | \u201cobject\u201d | | Array | 4 | \u201carray\u201d | | Binary data | 5 | \u201cbinData\u201d | | Undefined | 6 | \u201cundefined\u201d | \u5df2\u5e9f\u5f03 | | ObjectId | 7 | \u201cobjectId\u201d | | Boolean | 8 | \u201cbool\u201d | | Date | 9 | \u201cdate\u201d | | Null | 10 | \u201cnull\u201d | | Regular Expression | 11 | \u201cregex\u201d | | DBPointer | 12 | \u201cdbPointer\u201d | \u5df2\u5e9f\u5f03 | | JavaScript | 13 | \u201cjavascript\u201d | | Symbol | 14 | \u201csymbol\u201d | \u5df2\u5e9f\u5f03 | | JavaScript (with scope) | 15 | \u201cjavascriptWithScope\u201d | | 32-bit integer | 16 | \u201cint\u201d | | Timestamp | 17 | \u201ctimestamp\u201d | | 64-bit integer | 18 | \u201clong\u201d | | Decimal128 | 19 | \u201cdecimal\u201d | New in version 3.4. | | Min key | -1 | \u201cminKey\u201d | | Max key | 127 | \u201cmaxKey\u201d | ObjectId\u503c\u753112\u4e2a\u5b57\u8282\u7ec4\u6210\uff1a \u4e00\u4e2a4\u5b57\u8282\u7684\u503c\uff0c\u8868\u793aUnix\u7eaa\u5143\u4ee5\u6765\u7684\u79d2\u6570 \u4e00\u4e2a5\u5b57\u8282\u7684\u968f\u673a\u503c \u4e00\u4e2a3\u5b57\u8282\u7684\u8ba1\u6570\u5668\uff0c\u4ee5\u968f\u673a\u503c\u5f00\u59cb \u6bd4\u8f83\u4f1a\u5c06\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\u89c6\u4e3a\u7a7a\u7684BSON\u5bf9\u8c61\uff0c\u6bd4\u8f83\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u65f6\uff0cMongoDB\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1b\u7531\u4f4e\u5230\u9ad8\uff1a MinKey (internal type) Null Numbers (ints, longs, doubles, decimals) Symbol, String Object Array BinData ObjectId Boolean Date Timestamp Regular Expression MaxKey (internal type) Object\u6bd4\u8f83\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1a \u6309\u7167\u5b83\u4eec\u5728BSON\u5bf9\u8c61\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u9012\u5f52\u5730\u6bd4\u8f83\u952e\u503c\u5bf9\u3002 \u6bd4\u8f83\u5173\u952e\u5b57\u6bb5\u540d\u79f0\u3002 \u5982\u679c\u952e\u5b57\u6bb5\u540d\u79f0\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u5b57\u6bb5\u503c\u3002 \u5982\u679c\u5b57\u6bb5\u503c\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u4e0b\u4e00\u4e2a\u952e/\u503c\u5bf9\uff08\u8fd4\u56de\u6b65\u9aa41\uff09\u3002\u6ca1\u6709\u8fdb\u4e00\u6b65\u5bf9\u7684\u5bf9\u8c61\u5c0f\u4e8e\u5177\u6709\u66f4\u591a\u5bf9\u7684\u5bf9\u8c61\u3002 BinData\u6392\u5e8f\u987a\u5e8f\u4e3a\uff1a \u9996\u5148\uff0c\u6570\u636e\u7684\u957f\u5ea6\u6216\u5927\u5c0f\u3002 \u7136\u540e\uff0c\u901a\u8fc7BSON\u4e00\u5b57\u8282\u5b50\u7c7b\u578b\u3002 \u6700\u540e\uff0c\u901a\u8fc7\u6570\u636e\uff0c\u6267\u884c\u9010\u5b57\u8282\u6bd4\u8f83\u3002 # \u914d\u7f6e\u65e5\u5fd7 systemLog : verbosity : 5 #\u65e5\u5fd7\u7ea7\u522b : \u8303\u56f4\u662f 0 - 5 , 0 \u662f MongoDB\u7684\u9ed8\u8ba4\u65e5\u5fd7\u7ea7\u522b \uff0c 5 \u5305\u542b\u4e86 debug\u4fe1\u606f quiet : false #\u5b89\u9759\u6a21\u5f0f\uff0c\u662f\u5426\u8f93\u51fa\u65e5\u5fd7 traceAllExceptions : true #\u662f\u5426\u6253\u5370\u8be6\u7ec6\u7684\u65e5\u5fd7\u4fe1\u606f\uff0c\u5f00\u542f # syslogFacility: <string> #\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7\u4e2d\uff0c\u5982\u679c\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u5219systemLog.destination=syslog. # path: <string> # logAppend: <boolean> # logRotate: <string> # destination: <string> # timeStampFormat: <string> # component: # accessControl: # verbosity: <int> # command: # verbosity: <int> destination : file # mogodb\u65e5\u5fd7\u7684\u4ea7\u751f\u65b9\u5f0f : file = \u6307\u5b9a\u7684\u6587\u4ef6 , syslog\u7cfb\u7edf\u65e5\u5fd7 \uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u6307\u5411\u6807\u51c6\u8f93\u51fa\u6d41\u3002 logAppend : true #\u5728 mongodb\u91cd\u542f\u65f6 , \u7ee7\u7eed\u5f80\u5df2\u6709\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u8ffd\u52a0\u5185\u5bb9\uff0c\u800c\u4e0d\u662f\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 . path : / data / mongodb / mongod . log #\u65e5\u5fd7\u6587\u4ef6\u7684\u8f93\u51fa\u8def\u5f84\uff0c mongo\u5c06\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6 . logRotate : reopen # 3.0.0 , \u4e24\u4e2a\u503c : rename = \u91cd\u547d\u540d\u65e5\u5fd7\u6587\u4ef6\uff0c reopen = \u5173\u95ed\u5e76\u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 . \u5982\u679c\u4f7f\u7528 reopen\u5219\u8981\u4f7fsystemLog . logAppend = true . timeStampFormat : iso8601 - utc #\u65e5\u5fd7\u4e2d\u65f6\u95f4\u6233\u7684\u683c\u5f0f : ctime = Wed Dec 31 18 : 17 : 54.811 , iso8601 - utc = 1970 - 01 - 01 T00 : 00 : 00.000 Z , # iso8601 - local = \u672c\u5730\u65f6\u95f4\u683c\u5f0f #\u65e5\u5fd7\u7ec4\u4ef6\u7684\u5177\u4f53\u9009\u9879 component : #\u7d22\u5f15\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 index : verbosity : 5 #\u67e5\u8be2\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 query : verbosity : 5 #\u590d\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 replication : verbosity : 5 #\u5fc3\u8df3\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6 #heartbeats: #verbosity: 5 #\u56de\u6eda\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6 #heartbeats: #verbosity: 5 #\u5199\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 write : verbosity : 5 #\u8bbf\u95ee\u63a7\u5236\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 accessControl : verbosity : 5 #\u547d\u4ee4\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 command : verbosity : 5 #\u63a7\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 control : verbosity : 5 #\u8bca\u65ad\u6d88\u606f\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.2 ftdc : verbosity : 5 #\u5730\u7406\u7a7a\u95f4\u89e3\u6790\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 geo : verbosity : 5 #\u7f51\u7edc\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 network : verbosity : 5 #\u5206\u7247\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 sharding : verbosity : 5 #\u5b58\u50a8\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 storage : verbosity : 5 #\u65e5\u5fd7\u7ec4\u4ef6\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 journal : verbosity : 5 # \u8fdb\u7a0b\u7ba1\u7406\u914d\u7f6e processManagement : fork : true # \u4ee5\u5b88\u62a4\u7ebf\u7a0b\u6a21\u5f0f\u5728\u540e\u53f0\u8fd0\u884c pidFilePath : / data / mongodb / mongod . pid # \u6307\u5b9a\u4fdd\u5b58 PID\u7684\u6587\u4ef6 \u3002 #\u65f6\u533a\u6587\u4ef6:https: //downloads.mongodb.org/olson_tz_db/timezonedb-latest.zip #timeZoneInfo: #\u52a0\u8f7d\u6570\u636e\u5e93\u65f6\u533a\u7684\u5b8c\u6574\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u91c7\u7528\u9ed8\u8ba4\u65f6\u533a\u3002 # \u7f51\u7edc\u914d\u7f6e net : port : 27017 # mongodb\u76d1\u542c\u7684TCP\u7aef\u53e3 bindIp : 0.0.0.0 #\u5141\u8bb8\u8bbf\u95ee\u7684 IP\u5730\u5740\u96c6\u5408 \uff0c\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u662f 127.0.0.1 \uff0c\u5982\u679c\u9700\u8981\u8bbe\u7f6e\u591a\u4e2a\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7 [,] \u5206\u5272\uff0c\u4f8b\u5982 : A , B , C #bindIpAll: true #\u662f\u5426\u7ed1\u5b9a\u6240\u6709\u7684IP\uff0c\u5141\u8bb8\u8bbf\u95ee. version:3.6 maxIncomingConnections : 65536 #\u6700\u5927\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba4 65536 wireObjectCheck : true #\u9a8c\u8bc1\u5ba2\u6237\u7aef\u7684\u6240\u6709\u8bf7\u6c42\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u63d2\u5165\u6076\u610f\u6216\u8005\u65e0\u6548\u7684 BSON\u6570\u636e \uff0c\u5bf9\u4e8e\u9ad8\u5ea6\u5d4c\u5957\u7684\u81ea\u95ee\u5f53\u5bf9\u8c61\uff0c\u6027\u80fd\u5f71\u54cd\u5f88\u5c0f . ipv6 : false #\u542f\u7528\u6216\u7981\u7528 ipv6\u652f\u6301 . #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c. #unixDomainSocket: #enabled: true #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c. #pathPrefix: <string> #\u5957\u63a5\u5b57\u7684\u8def\u5f84 #filePermissions: <int> #\u5957\u63a5\u5b57\u6587\u4ef6\u6743\u9650 #3.6\u7248\u672c\u5220\u9664http\u9009\u9879\uff0c\u6539\u4e3a\u4e86ssl. # ssl: #sslOnNormalPorts: <boolean> # \u88ab2.6\u7248\u672c\u542f\u7528\uff0c\u6539\u7528mode: requireSSL. #\u542f\u7528TSL/SSL: # disabled=\u4e0d\u542f\u7528TLS/SSL, # allowSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl. # preferSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl. # requireSSL=\u670d\u52a1\u5668\u4ec5\u4f7f\u7528\u5e76\u63a5\u53d7TLS/SSL\u52a0\u5bc6\u94fe\u63a5. #mode: disabled #PEMKeyFile: <string> #.pem\u8bc1\u4e66\u5b58\u653e\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84. #PEMKeyPassword: <string> #\u7528\u4e8e\u89e3\u5bc6PEM\u7684\u5bc6\u94a5\u6587\u4ef6. #clusterFile: <string> #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u5185\u90e8\u8eab\u4efd\u9a8c\u8bc1\u7684PEM\u6587\u4ef6. #clusterPassword: <string> #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u7528\u4e8e\u89e3\u5bc6\u5185\u90e8\u9a8c\u8bc1PEM\u6587\u4ef6\u7684\u5bc6\u94a5. #CAFile: <string> #.pem\u5305\u542b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8ddf\u8bc1\u4e66\u94fe\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84. #CRLFile: <string> #.pem\u5305\u542b\u8bc1\u4e66\u540a\u9500\u5217\u8868\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84. #allowConnectionsWithoutCertificates: false #\u5f31\u8bc1\u4e66\u9a8c\u8bc1 #allowInvalidCertificates: <boolean> #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u8bc1\u4e66\uff0c\u5173\u95ed\u8bc1\u4e66\u68c0\u67e5 #allowInvalidHostnames: <boolean> #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u7684\u4e3b\u673a\u540d\uff0c\u7981\u7528\u4e3b\u673a\u540d\u6821\u9a8c #disabledProtocols: <string> #\u7981\u7528\u6307\u5b9a\u534f\u8bae #FIPSMode: <boolean> #\u542f\u7528\u6216\u7981\u7528\u4f7f\u7528\u5b89\u88c5OpenSSL\u5e93\u7684\u7684FIPS\u6a21\u5f0f #zlib\u538b\u7f29\u5668\u7684\u652f\u6301\uff0cadd to Version:3.4,version:3.6,\u9ed8\u8ba4\u4f7f\u7528snappy. #\u5982\u679c\u5404\u65b9\u4e0d\u5171\u7528\u81f3\u5c11\u4e00\u4e2a\u901a\u7528\u538b\u7f29\u5668\uff0c\u5219\u53cc\u65b9\u4e4b\u95f4\u7684\u6d88\u606f\u662f\u672a\u538b\u7f29\u7684. #compression: #compressors: snappy #\u6307\u5b9a\u4f20\u8f93\u5c42\u901a\u77e5\u65b9\u5f0f,\u9ed8\u8ba4asio\uff0cversion:3.6 #transportLayer: asio #\u6307\u5b9a\u7ebf\u7a0b\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6267\u884c\u6a21\u578b\uff1asynchronous=\u4f7f\u7528\u540c\u6b65\u7f51\u7edc\u5e76\u5728\u6bcf\u4e2a\u94fe\u63a5\u7684\u57fa\u7840\u4e0a\u7ba1\u7406\u5176\u7f51\u7edc\u7ebf\u7a0b\u6c60.adaptive:\u4f7f\u7528\u65b0\u7684\u5b9e\u9a8c\u6027\u7684\u5f02\u6b65\u7f51\u7edc\u6a21\u5f0f. #\u5176\u4e2d\u5f53\u503c\u4e3aadaptive\uff0c\u8981\u6c42#transportLayer\u7684\u503c\u4e3aasio. #serviceExecutor: <string> #\u5b89\u5168\u7ba1\u7406 #security: #keyFile: <string> #\u5b58\u50a8\u5171\u4eab\u5bc6\u94a5\u7684\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84 #\u7528\u4e8e\u96c6\u7fa4\u8eab\u4efd\u9a8c\u8bc1\u7684\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5f0f # - keyFile:\u4f7f\u7528\u5bc6\u94a5\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1. # - sendKeyFile: \u53d1\u9001\u5bc6\u94a5\u6587\u4ef6\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66. # - sendX509:\u53d1\u9001x.509\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66. # - x509:\u63a8\u8350\u4f7f\u7528\uff0c\u53d1\u9001x.509\u8bc1\u4e66\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4e14\u53ea\u63a5\u53d7x.509\u8bc1\u4e66. #clusterAuthMode: <string> #\u542f\u7528\u6216\u7981\u7528\u57fa\u4e8e\u89d2\u8272\u7684\u63a7\u5236\u8bbf\u95ee(RBAC)\u6765\u63a7\u5236\u6bcf\u4e2a\u7528\u6237\u5bf9\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c\u7684\u8bbf\u95ee\u3002 # - enabled:\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u88ab\u6388\u6743\u7684\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c. # - disabled:\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u4efb\u4f55\u8d44\u6e90\u548c\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c. #authorization: <string> #transitionToAuth: <boolean> #\u7528\u6237\u53ef\u4ee5\u5728\u6ca1\u6709\u4efb\u4f55\u8bbf\u95ee\u63a7\u5236\u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u673a\u5668\uff0c\u5e76\u8fdb\u884c\u8bfb\u5199\u548c\u7ba1\u7406\u64cd\u4f5c. version:3.4 #javascriptEnabled: <boolean> #\u542f\u7528\u6216\u7981\u7528\u670d\u52a1\u5668\u7aefjavascript\u7684\u6267\u884c. #redactClientLogData: <boolean> #\u8bb0\u5f55\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u4e5f\u8bb0\u5f55\u4e0b\u6765. version:3.4 AND ONLY MongoDB Enterprise #\u914d\u7f6eSASL #sasl: #hostName: <string> #\u7528\u4e8e\u914d\u7f6eSASL\u548cKerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u5b8c\u5168\u9650\u5b9a\u670d\u52a1\u5668\u57df\u540d. #serviceName: <string> #\u4f7f\u7528SASL\u7684\u670d\u52a1\u7684\u6ce8\u518c\u540d\u79f0. #saslauthdSocketPath: <string> #UNIX\u57df\u5957\u63a5\u5b57\u6587\u4ef6\u7684\u8def\u5f84. #enableEncryption: <boolean> #\u4e3aWiredTiger\u5b58\u50a8\u5f15\u64ce\u542f\u7528\u673a\u5bc6. #encryptionCipherMode: <string> #\u9759\u6001\u52a0\u5bc6\u7684\u5bc6\u7801\u6a21\u5f0f:AES256-CBC=\u5bc6\u7801\u5757\u94fe\u63a5\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6, #AES256-GCM=Galois / Counter\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6 #encryptionKeyFile: <string> #\u901a\u8fc7KMIP \u4ee5\u5916\u7684\u8fdb\u7a0b\u7ba1\u7406\u5bc6\u94a5\u65f6\uff0c\u672c\u5730\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84[MongoDB Enterprise] # #\u6ce8\u610f:security.kmip\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.2. # #kmip: #keyIdentifier: <string> #KMIP\u670d\u52a1\u5668\u4e2d\u73b0\u6709\u79d8\u94a5\u7684\u552f\u4e00KNIP\u6807\u8bc6\u7b26.version:3.2 #rotateMasterKey: <boolean> #\u65cb\u8f6c\u4e3b\u79d8\u94a5\u5e76\u91cd\u65b0\u52a0\u5bc6\u5185\u90e8\u79d8\u94a5\u5e93.version:3.2[MongoDB Enterprise] #serverName: <string> #\u8fd0\u884cKMIP\u670d\u52a1\u5668\u7684\u5bc6\u94a5\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\u7684\u4e3b\u673a\u540d\u6216IP\u5730\u5740.[MongoDB Enterprise] #port: <string> #KMIP\u670d\u52a1\u5668\u6b63\u5728\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u3002 #clientCertificateFile: <string> #\u5305\u542b\u7528\u4e8e\u5411KMIP\u670d\u52a1\u5668\u9a8c\u8bc1MongoDB\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66\u8def\u5f84\u7684\u5b57\u7b26\u4e32\u3002 #clientCertificatePassword: <string> #\u7528\u4e8e\u89e3\u5bc6\u5ba2\u6237\u7aef\u8bc1\u4e66\uff08\u5373security.kmip.clientCertificateFile\uff09\u7684\u5bc6\u7801 #serverCAFile: <string> #CA\u6587\u4ef6\u7684\u8def\u5f84\u3002\u7528\u4e8e\u9a8c\u8bc1\u4e0eKMIP\u670d\u52a1\u5668\u7684\u5b89\u5168\u5ba2\u6237\u7aef\u8fde\u63a5\u3002 # #\u6ce8\u610f:security.ldap\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.4. # # ldap: # servers: <string> #\u901a\u8fc7LDAP\u786e\u5b9a\u6267\u884c\u64cd\u4f5c\u7684\u7528\u6237\u662f\u5426\u88ab\u6388\u6743\uff0c\u591a\u4e2a\u670d\u52a1\u5668\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7[,]\u5206\u5272. # bind: # method: <string> #\u8be5\u65b9\u6cd5mongod\u6216mongos\u7528\u4e8e\u5411LDAP\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 # - simple- mongod\u6216mongos\u4f7f\u7528\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002 # - sasl- mongod\u6216mongos\u4f7f\u7528SASL\u534f\u8bae\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 # saslMechanisms: <string> #\u4ee5\u9017\u53f7\u5206\u9694\u7684SASL\u673a\u5236\u5217\u8868. # queryUser: <string> #\u7ed1\u5b9aLADP\u67e5\u8be2\u7528\u6237. # queryPassword: <string> #\u7ed1\u5b9aLADP\u670d\u52a1\u5668\u7684\u5bc6\u7801. # useOSDefaults: <boolean> #\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668\u65f6\uff0c\u5141\u8bb8mongod\u6216mongos\u4f7f\u7528Windows\u767b\u5f55\u51ed\u636e\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u7ed1\u5b9a\u3002 # transportSecurity: <string> #\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cmongod\u6216mongos\u521b\u5efa\u4e00\u4e2a\u5230LDAP\u670d\u52a1\u5668\u7684TLS / SSL\u5b89\u5168\u8fde\u63a5. # timeoutMS: <int> #\u7b49\u5f85LDAP\u670d\u52a1\u5668\u54cd\u5e94\u8bf7\u6c42\u65f6\u95f4(\u6beb\u79d2). # userToDNMapping: <string> #\u7528\u4e8e\u9a8c\u8bc1\u7684\u7528\u6237\u540d\u6620\u5c04\u5230LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\u3002 # - match=ECMAScript\u683c\u5f0f\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u6b63\u5219\u8868\u8fbe\u5f0f\uff09\u4e0e\u63d0\u4f9b\u7684\u7528\u6237\u540d\u5339\u914d\u3002 # \u6bcf\u4e2a\u62ec\u53f7\u5305\u56f4\u7684\u90e8\u5206\u8868\u793a\u7531substitutionor \u4f7f\u7528\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6355\u83b7\u7ec4ldapQuery\u3002 # - substitution=LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\u683c\u5f0f\u5316\u6a21\u677f\u3002 # - ldapQuery=LDAP\u67e5\u8be2\u683c\u5f0f\u5316\u6a21\u677f. # authz: # queryTemplate: <string> #\u4e00\u4e2a\u76f8\u5bf9\u7684LDAP\u67e5\u8be2URL. # # \u5c5e\u6027\u8bbe\u7f6e\u9009\u9879 # #setParameter: # ldapUserCacheInvalidationInterval: <int> #\u7528\u4e8e\u4f7f\u7528LDAP\u6388\u6743mongod\u6216mongos\u4f7f\u7528LDAP\u6388\u6743\u7684\u670d\u52a1\u5668(\u79d2)\u3002 # <parameter1>: <value1> # <parameter2>: <value2> # \u5b58\u50a8\u8bbe\u7f6e storage : dbPath : / data / mongodb # mongod\u5b9e\u4f8b\u5b58\u50a8\u6570\u636e\u7684\u76ee\u5f55 , \u9ed8\u8ba4\u503c\uff1a / data / db . indexBuildRetry : true #\u6307\u5b9a mongodb\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u662f\u5426\u91cd\u5efa\u4e0d\u5b8c\u6574\u7684\u7d22\u5f15 , \u9ed8\u8ba4 : true . # repairPath: <string> # MongoDB\u5728--repair\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u5c06\u4f7f\u7528\u7684\u5de5\u4f5c\u76ee\u5f55 \u3002 # \u5f53--repair\u5b8c\u6210\u540e,storage.repairPath\u76ee\u5f55\u662f\u7a7a\u7684,\u5e76\u4e14 dbPath\u5305\u542b\u4e86\u4fee\u590d\u7684\u6587\u4ef6\u3002 # \u8be5storage.repairPath\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u4ec5\u9002\u7528\u4e8emongod\u4f7f\u7528MMAPv1\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b\u3002 journal : enabled : true #\u542f\u7528\u6216\u7981\u7528\u8010\u4e45\u6027\u65e5\u5fd7\u4ee5\u786e\u4fdd\u6570\u636e\u6587\u4ef6\u4fdd\u6301\u6709\u6548\u5e76\u53ef\u6062\u590d\u3002 64 bit\u9ed8\u8ba4\u5f00\u542f , 32 bit\u9ed8\u8ba4\u5173\u95ed . # \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b \u3002 commitIntervalMs : 100 # mongod\u65e5\u5fd7\u64cd\u4f5c\u4e4b\u95f4\u8fdb\u7a0b\u5141\u8bb8\u7684\u6700\u5927\u65f6\u95f4\u91cf ( \u6beb\u79d2 ), \u8303\u56f4\u662f 1 - 500 , \u9ed8\u8ba4\u503c\u662f 100 \uff0c # \u8be5\u503c\u592a\u4f4e\u4f1a\u589e\u52a0\u65e5\u5fd7\u7684\u6301\u4e45\u6027\uff0c\u4f46\u662f\u4f1a\u727a\u7272\u78c1\u76d8\u6027\u80fd. # \u8be5storage.journal.commitIntervalMs\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b \u3002 # directoryPerDB: <boolean> #MongoDB\u4f7f\u7528\u5355\u72ec\u7684\u76ee\u5f55\u6765\u5b58\u50a8\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\u3002 # \u76ee\u5f55\u4f4d\u4e8estorage.dbPath\u76ee\u5f55\u4e0b\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5b50\u76ee\u5f55\u540d\u79f0\u90fd\u4e0e\u6570\u636e\u5e93\u540d\u79f0\u76f8\u5bf9\u5e94\u3002 # 3.0\u7248\u672c\u6709\u53d8\u66f4. # syncPeriodSecs: <int> #\u5728MongoDB\u5c06\u6570\u636e\u901a\u8fc7sync\u64cd\u4f5c\u5237\u65b0\u5230\u6570\u636e\u6587\u4ef6\u4e4b\u524d\u53ef\u4ee5\u4f20\u9012\u7684\u65f6\u95f4\u91cf,\u9ed8\u8ba460s. # \u4e0d\u8981\u5728\u751f\u4ea7\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u6b64\u503c\u3002\u5728\u51e0\u4e4e\u6240\u6709\u60c5\u51b5\u4e0b\uff0c\u60a8\u90fd\u5e94\u8be5\u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u3002 # engine: <string> #mongod\u6570\u636e\u5e93\u7684\u5b58\u50a8\u5f15\u64ce\u3002 # \u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\uff0c3.0\u7248\u672c\u4e2d\u7684\u65b0\u529f\u80fd,\u4eceMongoDB 3.2\u5f00\u59cb\uff0cwiredTiger\u662f\u9ed8\u8ba4\u503c\u3002 # mmapv1=\u6307\u5b9aMMAPv1\u5b58\u50a8\u5f15\u64ce\u3002 # wiredTiger=\u6307\u5b9aWiredTiger\u5b58\u50a8\u5f15\u64ce\u3002 # inMemory=\u6307\u5b9a\u5185\u5b58\u4e2d\u5b58\u50a8\u5f15\u64ce\u3002 mmapv1 : preallocDataFiles : true #\u542f\u7528\u6216\u7981\u7528\u6570\u636e\u6587\u4ef6\u7684\u9884\u5206\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c MongoDB\u4e0d\u9884\u5148\u5206\u914d\u6570\u636e\u6587\u4ef6 \u3002 nsSize : 16 #\u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u9ed8\u8ba4\u5927\u5c0f\uff0c\u5b83\u662f\u4ee5\u6587\u4ef6\u7ed3\u5c3e\u7684\u6587\u4ef6 . ns \u3002\u6bcf\u4e2a\u96c6\u5408\u548c\u7d22\u5f15\u90fd\u88ab\u89c6\u4e3a\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\u3002 # \u4f7f\u7528\u6b64\u8bbe\u7f6e\u63a7\u5236\u65b0\u521b\u5efa\u7684\u540d\u79f0\u7a7a\u95f4\u6587\u4ef6\u7684\u5927\u5c0f\u3002\u8be5\u9009\u9879\u5bf9\u73b0\u6709\u6587\u4ef6\u6ca1\u6709\u5f71\u54cd\u3002 # \u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u662f2047\u5146\u5b57\u8282\u3002\u9ed8\u8ba4\u503c16\u5146\u5b57\u8282\u63d0\u4f9b\u4e86\u5927\u7ea624,000\u4e2a\u540d\u79f0\u7a7a\u95f4\u3002 quota : enforced : false #\u542f\u7528\u6216\u7981\u7528\u5f3a\u5236\u6bcf\u4e2a\u6570\u636e\u5e93\u53ef\u80fd\u5177\u6709\u7684\u6570\u5b57\u6570\u636e\u6587\u4ef6\u7684\u6700\u5927\u9650\u5236\u3002 # \u4f7f\u7528\u8be5storage.mmapv1.quota.enforced\u9009\u9879\u8fd0\u884c\u65f6\uff0cMongoDB\u6bcf\u4e2a\u6570\u636e\u5e93\u6700\u591a\u67098\u4e2a\u6570\u636e\u6587\u4ef6\u3002 # \u901a\u8fc7\u8c03\u6574storage.quota.maxFilesPerDB\u6765\u8c03\u6574\u8fd9\u4e2a\u9650\u5236\u3002 maxFilesPerDB : 8 #\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\u6587\u4ef6\u6570\u91cf\u9650\u5236\uff0c\u9ed8\u8ba4\u662f 8. \u8be5\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8e\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8e mongod . smallFiles : false #\u5982\u679c\u4f60\u6709\u5927\u91cf\u7684\u6570\u636e\u5e93\uff0c\u6bcf\u4e2a\u4fdd\u5b58\u5c11\u91cf\u6570\u636e\u3002 MongoDB\u4f7f\u7528\u8f83\u5c0f\u7684\u9ed8\u8ba4\u6587\u4ef6\u5927\u5c0f \u3002 # \u8be5storage.mmapv1.smallFiles\u9009\u9879\u53ef\u51cf\u5c11\u6570\u636e\u6587\u4ef6\u7684\u521d\u59cb\u5927\u5c0f\uff0c\u5e76\u5c06\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a512\u5146\u5b57\u8282\u3002 # storage.mmapv1.smallFiles\u4e5f\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ece1\u5343\u5146\u5b57\u8282\u51cf\u5c11\u5230128\u5146\u5b57\u8282\u3002 # journal: # debugFlags: <int> #\u63d0\u4f9b\u6d4b\u8bd5\u529f\u80fd\u3002\u4e0d\u7528\u4e8e\u4e00\u822c\u7528\u9014\uff0c\u5e76\u4e14\u4f1a\u5728\u7cfb\u7edf\u5f02\u5e38\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u5f71\u54cd\u6570\u636e\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u3002 # commitIntervalMs: <num> #MongoDB 3.2\u5f03\u7528\u8be5 torage.mmapv1.journal.commitIntervalMs\u8bbe\u7f6e\u3002 # \u6539\u4e3a\u4f7f\u7528storage.journal.commitIntervalMs\u3002 # wiredTiger: # engineConfig: # cacheSizeGB: <number> #WiredTiger\u5c06\u7528\u4e8e\u6240\u6709\u6570\u636e\u7684\u5185\u90e8\u7f13\u5b58\u7684\u6700\u5927\u5927\u5c0f,\u9ed8\u8ba4\u91c7\u7528RAB-1GB\u768450%\u548c256MB\u7684\u6700\u5927\u503c. # \u5c3d\u53ef\u80fd\u4e0d\u8981\u8d85\u8fc7\u6700\u5927\u503c. # journalCompressor: <string> #\u7528\u4e8e\u538b\u7f29WiredTiger\u65e5\u5fd7\u6570\u636e\u7684\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0 # directoryForIndexes: true #mongod\u5c06\u7d22\u5f15\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d index, # \u5e76\u5c06\u96c6\u5408\u6570\u636e\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d collection\u3002 # collectionConfig: # blockCompressor: <string> #\u7528\u4e8e\u538b\u7f29\u6536\u96c6\u6570\u636e\u7684\u9ed8\u8ba4\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0 indexConfig : prefixCompression : true #\u542f\u7528\u6216\u7981\u7528\u7d22\u5f15\u6570\u636e\u7684\u524d\u7f00\u538b\u7f29\u3002 # inMemory: #\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # engineConfig: # inMemorySizeGB: <number> #\u4e3a\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u6570\u636e\u5206\u914d\u7684\u6700\u5927\u5185\u5b58\u91cf\uff0c # \u5305\u62ec\u7d22\u5f15\uff0coplog\uff08\u5982\u679c mongod\u662f\u526f\u672c\u96c6\uff0c\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u5143\u6570\u636e\u7684\u4e00\u90e8\u5206\uff09\u7b49\u3002 # \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u4f7f\u752850\uff05\u7684\u7269\u7406RAM\u51cf1 GB\u3002 #\u8fd0\u884c\u5206\u6790\u914d\u7f6e operationProfiling : mode : slowOp #\u6307\u5b9a\u5e94\u8be5\u5206\u6790\u54ea\u4e9b\u64cd\u4f5c\uff0c\u5206\u6790\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6027\u80fd . # - off=\u5206\u6790\u5668\u5df2\u5173\u95ed\uff0c\u5e76\u4e14\u4e0d\u6536\u96c6\u4efb\u4f55\u6570\u636e\u3002\u8fd9\u662f\u9ed8\u8ba4\u7684\u5206\u6790\u5668\u7ea7\u522b\u3002 # - slowOp=\u5206\u6790\u5668\u6536\u96c6\u6bd4\u82b1\u8d39\u65f6\u95f4\u66f4\u957f\u7684\u64cd\u4f5c\u7684\u6570\u636eslowms\u3002 # - all=\u5206\u6790\u5668\u6536\u96c6\u6240\u6709\u64cd\u4f5c\u7684\u6570\u636e\u3002 slowOpThresholdMs : 100 #\u6162\u64cd\u4f5c\u65f6\u95f4\u9608\u503c\uff0c\u9ed8\u8ba4 100. # slowOpSampleRate: <double> #\u6162\u64cd\u4f5c\u91c7\u6837\u7387\uff0c0-1\u4e4b\u95f4\uff0c\u5305\u542b0,1. # #\u590d\u5236\u8bbe\u7f6e # #replication: # oplogSizeMB: <int> #\u590d\u5236\u64cd\u4f5c\u65e5\u5fd7\u7684\u6700\u5927\u5927\u5c0f\uff08MB\uff09 # replSetName: <string> #mongod\u4e00\u90e8\u5206\u7684\u526f\u672c\u96c6\u7684\u540d\u79f0\u3002\u526f\u672c\u96c6\u4e2d\u7684\u6240\u6709\u4e3b\u673a\u5fc5\u987b\u5177\u6709\u76f8\u540c\u7684\u96c6\u540d\u79f0\u3002\u4ec5\u9002\u7528\u4e8emongod. # secondaryIndexPrefetch: <string> #\u4ec5\u9002\u7528\u4e8emmapv1 \u5b58\u50a8\u5f15\u64ce. # \u5728\u5e94\u7528oplog\u4e2d\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u526f\u672c\u96c6\u7684\u6b21\u8981\u6210\u5458\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u7d22\u5f15\u3002 # - none=\u8f85\u52a9\u7a0b\u5e8f\u4e0d\u4f1a\u5c06\u7d22\u5f15\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002 # - all=\u8f85\u52a9\u7a0b\u5e8f\u52a0\u8f7d\u4e0e\u64cd\u4f5c\u76f8\u5173\u7684\u6240\u6709\u7d22\u5f15\u3002 # - _id_only=Secondaries\u4e0d\u4f1a\u5c06\u989d\u5916\u7684\u7d22\u5f15\u52a0\u8f7d\u5230\u5df2\u6709_id\u7d22\u5f15\u4e4b\u5916\u7684\u5185\u5b58\u4e2d\u3002 # enableMajorityReadConcern: <boolean> ## Deprecated in 3.6 # \u4eceMongoDB 3.6\u5f00\u59cb\uff0c\"majority\"\u59cb\u7ec8\u542f\u7528\u8bfb\u53d6\u5173\u6ce8\uff0c\u5e76\u4e14\u6b64\u8bbe\u7f6e\u4e0d\u8d77\u4f5c\u7528\u3002 # localPingThresholdMs: <int> #mongos\u7528\u4e8e\u786e\u5b9a\u54ea\u4e9b\u8f85\u52a9\u526f\u672c\u96c6\u6210\u5458\u4ece\u5ba2\u6237\u7aef\u4f20\u9012\u8bfb\u53d6\u64cd\u4f5c\u7684ping\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002 # \u9ed8\u8ba4\u503c15\u5bf9\u5e94\u4e8e\u6240\u6709\u5ba2\u6237\u7aef\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684\u9ed8\u8ba4\u503c\u3002 # # \u5206\u7247\u8bbe\u7f6e # #sharding: # clusterRole: <string> #mongod\u5b9e\u4f8b\u5728\u5206\u7247\u7fa4\u96c6\u4e2d\u626e\u6f14\u7684\u89d2\u8272 # - configsvr=\u5c06\u6b64\u5b9e\u4f8b\u4f5c\u4e3a\u914d\u7f6e\u670d\u52a1\u5668\u542f\u52a8\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827019\u7aef\u53e3\u4e0a\u542f\u52a8\u3002 # - shardsvr=\u542f\u52a8\u6b64\u5b9e\u4f8b\u4e3a\u788e\u7247\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827018\u7aef\u53e3\u4e0a\u542f\u52a8\u3002 # \u8bbe\u7f6esharding.clusterRole\u8981\u6c42mongod \u5b9e\u4f8b\u4e0e\u590d\u5236\u4e00\u8d77\u8fd0\u884c\u3002 # \u8981\u5c06\u5b9e\u4f8b\u90e8\u7f72\u4e3a\u526f\u672c\u96c6\u6210\u5458\uff0c\u8bf7\u4f7f\u7528\u8be5replSetName \u8bbe\u7f6e\u5e76\u6307\u5b9a\u526f\u672c\u96c6\u7684\u540d\u79f0\u3002 # archiveMovedChunks: false #\u4ece3.2\u5f00\u59cb\uff0cMongoDB false\u7528\u4f5c\u9ed8\u8ba4\u503c\u3002\u5728\u5757\u8fc1\u79fb\u671f\u95f4\uff0c\u5206\u7247\u4e0d\u4f1a\u4fdd\u5b58\u4ece\u5206\u7247\u8fc1\u79fb\u7684\u6587\u6863\u3002 # configDB: <configReplSetName>/cfg1.example.net:27017, cfg2.example.net:27017,... #\u8be5\u914d\u7f6e\u670d\u52a1\u5668\u7528\u4e8e \u5206\u7247\u7fa4\u96c6\u3002 # # \u5ba1\u8ba1\u65e5\u5fd7\u8bbe\u7f6e,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # #auditLog: # destination: file #\u8bbe\u7f6e\u540e\uff0cauditLog.destination\u542f\u7528\u4f7f\u7528\u6307\u5b9a\u683c\u5f0f\u5f80\u6307\u5b9a\u76ee\u6807\u53d1\u9001\u6240\u6709\u5ba1\u6838\u4e8b\u4ef6\u3002 ## - syslog=\u4ee5JSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\u5230\u7cfb\u7edf\u65e5\u5fd7. ## - console=\u4ee5stdoutJSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\u3002 ## - file=\u5c06\u5ba1\u6838\u4e8b\u4ef6\u8f93\u51fa\u5230\u4ee5\u4e2d\u6307\u5b9aauditLog.path\u683c\u5f0fauditLog.format\u6307\u5b9a\u7684\u6587\u4ef6 \u3002 # format: JSON #\u7528\u4e8e\u5ba1\u8ba1\u7684\u8f93\u51fa\u6587\u4ef6\u7684\u683c\u5f0f,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c(JSON/BSON). # path: <string> #\u8f93\u51fa\u6587\u4ef6\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c. # filter: <string> #\u8fc7\u6ee4\u6307\u5b9a\u7c7b\u578b\u7684\u64cd\u4f5c\u7684\u8bb0\u5f55\u3002 # # \u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\u914d\u7f6e # #snmp: # subagent: <boolean> #\u8be5snmp.subagent\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u5982\u679csnmp.subagent\u662ftrue\uff0cSNMP\u8fd0\u884c\u7684\u5b50\u4ee3\u7406\u3002 # master: <boolean> #\u5f53snmp.master\u662ftrue\uff0cSNMP\u8fd0\u884c\u4f5c\u4e3a\u4e00\u4e2a\u4e3b\u7ad9\u3002\u00b7 # # \u6587\u672c\u641c\u7d22\u9009\u9879 ,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # #basisTech: # rootDirectory:<string> #\u6307\u5b9aBasis Technology Rosette\u8bed\u8a00\u5b66\u5e73\u53f0\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u4ee5\u652f\u6301\u7528\u4e8e\u6587\u672c\u641c\u7d22\u64cd\u4f5c\u7684\u5176\u4ed6\u8bed\u8a00\u3002 mongo shell \u00b6 \u5e38\u89c1\u7684mongoshell\u5e2e\u52a9\u4e0eJavaScript\u7b49\u6548\u9879\u8868 Shell Helpers JavaScript Equivalents show dbs, show databases db.adminCommand('listDatabases') use <[db]> db = db.getSiblingDB('<[db]>') show collections db.getCollectionNames() show users db.getUsers() show roles db.getRoles({showBuiltinRoles: true}) show log <[logname]> db.adminCommand({ 'getLog' : '<[logname]>' }) show logs db.adminCommand({ 'getLog' : '*' }) it cursor = db.collection.find() if ( cursor.hasNext() ){ cursor.next(); } MongoDB CRUD \u64cd\u4f5c \u00b6 \u63d2\u5165\u6587\u4ef6 \u00b6 db . collection . insertOne () // \u63d2\u5165\u4e00\u4e2a\u6587\u6863 db . collection . insertMany () // \u63d2\u5165\u591a\u4e2a\u6587\u6863 db . collection . insert () // \u63d2\u5165\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u6863 db . collection . update () // when used with the ** upsert : true ** option db . collection . updateOne () // when used with the ** upsert : true ** option db . collection . updateMany () // when used with the ** upsert : true ** option db . collection . findAndModify () // when used with the ** upsert : true ** option db . collection . findOneAndUpdate () // when used with the ** upsert : true ** option db . collection . findOneAndReplace () // when used with the ** upsert : true ** option db . collection . save () db . collection . bulkWrite () \u67e5\u8be2\u6587\u6863 \u00b6 db . collection . find ({ person : { age : 21 , sex : \"male\" }}); // \u67e5\u8be2\u5d4c\u5165/\u5d4c\u5957\u5f0f\u6587\u6863 db . collection . find ({ \"person.sex\" : \"male\" }); // \u5339\u914d\u5d4c\u5165\u5f0f\u6587\u6863\u67d0\u4e2a\u5b57\u6bb5 db . collection . find ({ tags : [ \"blue\" , \"red\" ]}); // \u5339\u914d\u6570\u7ec4 db . collection . find ({ tags : \"red\" , \"blank\" }); // \u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u7684\u4e24\u4e2a\u5143\u7d20 db . collection . find ({ tags : { $all : [ \"red\" , \"blank\" ]}}) // \u4e0d\u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u4e24\u4e2a\u5143\u7d20(\u67e5\u8be2\u53ea\u8981\u5305\u542b\u8fd9\u4e24\u4e2a\u5143\u7d20\u7684\u6240\u6709\u7ed3\u679c) db . collection . find ({ age : { $gt : 1 , $lt : 2 }}) // \u96c6\u5408\u4e2dage\u6570\u7ec4\u4e2d\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5927\u4e8e1\uff0c\u53e6\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5c0f\u4e8e2\uff0c\u6216\u8005\u5355\u4e2a\u5143\u7d20\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6 db . collection . find ({ age : { $elemMatch : { $gt : 1 , $lt : 2 }}}) // \u4f7f\u7528$elemMatch\u8fd0\u7b97\u7b26\u5728\u6570\u7ec4\u7684\u5143\u7d20\u4e0a\u6307\u5b9a\u591a\u4e2a\u6761\u4ef6\uff0c\u4ee5\u4fbf\u81f3\u5c11\u4e00\u4e2a\u6570\u7ec4\u5143\u7d20\u6ee1\u8db3\u6240\u6709\u6307\u5b9a\u7684\u6761\u4ef6\u3002\u6b64\u67e5\u8be2\u6761\u4ef6\u8868\u793aage\u6570\u7ec4\u5305\u542b\u81f3\u5c11\u4e00\u4e2a\u5927\u4e8e1\u4e14\u5c0f\u4e8e2\u7684\u5143\u7d20 db . collection . find ( { \"tags\" : { $size : 3 } } ) // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u957f\u5ea6\u4e3a3 db . collection . find ( { \"tags.2\" : { \"$exists\" : 1 } } ) // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u6570\u91cf\u5927\u4e8e2(\u5b9e\u9645\u5229\u7528\u6570\u7ec4\u7d22\u5f15\u6765\u5b9e\u73b0\u7684) \u67e5\u8be2\u5d4c\u5957\u5728\u6570\u7ec4\u4e2d\u7684\u6587\u6863\u793a\u4f8b \uff1a db . inventory . insertMany ( [ { item : \"journal\" , instock : [ { warehouse : \"A\" , qty : 5 }, { warehouse : \"C\" , qty : 15 } ] }, { item : \"notebook\" , instock : [ { warehouse : \"C\" , qty : 5 } ] }, { item : \"paper\" , instock : [ { warehouse : \"A\" , qty : 60 }, { warehouse : \"B\" , qty : 15 } ] }, { item : \"planner\" , instock : [ { warehouse : \"A\" , qty : 40 }, { warehouse : \"B\" , qty : 5 } ] }, { item : \"postcard\" , instock : [ { warehouse : \"B\" , qty : 15 }, { warehouse : \"C\" , qty : 35 } ] } ]); db . inventory . find ( { \"instock\" : { warehouse : \"A\" , qty : 5 } } ) // \u5339\u914d\u5728invertory\u96c6\u5408\u4e2dinstock\u6570\u7ec4\u5143\u7d20\u4e0e\u6307\u5b9a\u6587\u6863\u5339\u914d\u7684\u6587\u6863\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6587\u6863\u4f5c\u4e3a\u6570\u7ec4\u7684\u5143\u7d20\uff1b\u6ce8\u610f\uff1a\u6574\u4e2a\u5d4c\u5165/\u5d4c\u5957\u6587\u6863\u4e0a\u7684\u7b49\u5f0f\u5339\u914d\u9700\u8981\u6307\u5b9a\u6587\u6863\u7684\u5b8c\u5168\u5339\u914d db . inventory . find ( { \"instock\" : { $elemMatch : { qty : 5 , warehouse : \"A\" } } } ) // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863\u81f3\u5c11\u4e00\u4e2aqty\u503c\u4e3a5\uff0cwarehost\u503c\u4e3aA db . inventory . find ( { \"instock\" : { $elemMatch : { qty : { $gt : 10 , $lte : 20 } } } } ) // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863qty\u503c\u5927\u4e8e10\u4e14\u5c0f\u4e8e\u7b49\u4e8e20 db . inventory . find ( { \"instock.qty\" : { $gt : 10 , $lte : 20 } } ) // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\u7684qty\u5b57\u6bb5\u5927\u4e8e10\u5e76\u4e14\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\uff08\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5165\u6587\u6863\uff09\u7684qty\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e20 db . inventory . find ( { \"instock.qty\" : 5 , \"instock.warehouse\" : \"A\" } ) // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863\u5305\u542b\u5b57\u6bb5qty\u503c\u4e3a5\uff0c\u4e14\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863warehouse\u5b57\u6bb5\u503c\u4e3aA(\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5957\u6587\u6863) db . inventory . find ({ \"instock.qty\" : { $lte : 20 }}) // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863 db . inventory . find ({ \"instock.0.qty\" : { $lte : 20 }}) // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863\uff0c\u7d22\u5f15\u4e3a0\u4e14qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u53ea\u8fd4\u56deitem\u3001status\u53ca_id\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { status : 0 , instock : 0 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u6392\u9664status\u548cinstock\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 , \"size.uom\" : 1 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u62ecitem\u3001status\u5b57\u6bb5\u53ca\u5d4c\u5165\u6587\u6863size\u7684uom\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 , instock : { $slice : - 1 } } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u542bitem\u3001status\u5b57\u6bb5instock\uff0c$slice\u8fd0\u7b97\u7b26\u8fd4\u56deinstock\u6570\u7ec4\u6700\u540e\u4e00\u4e2a\u5143\u7d20 db . inventory . find ({ item : null }); // \u67e5\u8be2item\u5b57\u6bb5\u4e3anull\uff0c\u6216\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863 db . inventory . find ({ item : { $type : 10 }}); // \u53ea\u67e5\u8be2item\u5b57\u6bb5\u503c\u7c7b\u578b\u662f10(\u5373null\u7c7b\u578b)\u7684\u6587\u6863 db . inventory . find ({ item : { $exists : false }}) // \u53ea\u67e5\u8be2\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863 \u66f4\u65b0\u6587\u6863 \u00b6 db . inventory . updateOne ({ item : \"paper\" },{ $set : { \"size.uom\" : \"cm\" , status : \"P\" }, $currentDate : { lastModified : true }}); // \u66f4\u65b0\u4e00\u4e2a\u6587\u6863item\u5b57\u6bb5\u503c\u4e3apaper\uff0c\u5c06size\u6570\u7ec4\u4e2duom\u66f4\u65b0\u4e3acm\uff0cstatus\u66f4\u65b0\u4e3aP db . inventory . updateMany ({ \"qty\" : { $lt : 50 }},{ $set : { \"size.uom\" : \"in\" , status : \"Z\" }, $currentDate : { lastModified : true }}); // \u66f4\u65b0qty\u5b57\u6bb5\u503c\u5c0f\u4e8e50\uff0c\u66f4\u65b0size\u6570\u7ec4uom\u5b57\u6bb5\u503c\u4e3ain\uff0cstatus\u5b57\u6bb5\u503c\u4e3aZ\uff0c\u7528$currentDate\u64cd\u4f5c\u66f4\u65b0lastModified\u5b57\u6bb5\u4e3a\u5f53\u524d\u65f6\u95f4\uff0c\u6ca1\u6709\u6b64\u5b57\u6bb5 db . collection . update () // \u66f4\u65b0\u6216\u66ff\u6362\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u5355\u4e2a\u6587\u6863\uff0c\u6216\u66f4\u65b0\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863 // \u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u66f4\u65b0\u6587\u6863 db . collection . findOneAndReplace () db . collection . findOneAndUpdate () db . collection . findAndModify () db . collection . save () db . collection . bulkWrite () \u5220\u9664\u6587\u6863 \u00b6 db . collection . deleteMany ( {} ) // \u5220\u9664\u96c6\u5408\u6240\u6709\u6587\u6863 db . collection . deleteOne ( { status : \"D\" } ) // \u5220\u9664 status\u4e3aD\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . remove () // \u5220\u9664\u5355\u4e2a\u6587\u6863\u6216\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863 \u5220\u9664\u64cd\u4f5c\u4e0d\u4f1a\u5220\u9664\u7d22\u5f15\uff0c\u5373\u4f7f\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6240\u6709\u6587\u6863\uff01 MongoDB\u4e2d\u7684\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u662f\u5355\u4e2a\u6587\u6863\u7ea7\u522b\u7684\u539f\u5b50\u64cd\u4f5c \u4ee5\u4e0b\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\uff1a db . collection . findOneAndDelete () // findOneAndDelete () \u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879 . \u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . findAndModify () // findAndModify () \u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879 . \u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . bulkWrite () \u6279\u91cf\u5199\u5165\u64cd\u4f5c \u00b6 db . collection . bulkWrite () // \u6b64\u65b9\u6cd5\u53ef\u4ee5\u6279\u91cf\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\u64cd\u4f5c\u3002\u6279\u91cf\u5199\u64cd\u4f5c\u53ef\u4ee5\u6709\u5e8f\u4e5f\u53ef\u65e0\u5e8f\u3002 // \u901a\u8fc7\u6709\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0c MongoDB\u4ee5\u4e32\u884c\u65b9\u5f0f\u6267\u884c\u64cd\u4f5c \u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0c MongoDB\u5c06\u8fd4\u56de\u800c\u4e0d\u5904\u7406\u5217\u8868\u4e2d\u7684\u4efb\u4f55\u5269\u4f59\u5199\u64cd\u4f5c // \u4f7f\u7528\u65e0\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0c MongoDB\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u64cd\u4f5c \uff0c\u4f46\u4e0d\u4fdd\u8bc1\u8fd9\u79cd\u884c\u4e3a\u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0c MongoDB\u5c06\u7ee7\u7eed\u5904\u7406\u5217\u8868\u4e2d\u7684\u5269\u4f59\u5199\u64cd\u4f5c // \u5206\u7247\u96c6\u5408\u4e0a\uff0c\u6709\u5e8f\u64cd\u4f5c\u901a\u5e38\u6bd4\u65e0\u5e8f\u8981\u6162\uff0c bulk . Write () \u9ed8\u8ba4\u662f\u6709\u5e8f\u64cd\u4f5c bulkWrite () \u652f\u6301\u4ee5\u4e0b\u5199\u64cd\u4f5c\uff1a insertOne updateOne updateMany replaceOne deleteOne deleteMany \u6279\u91cf\u63d2\u5165\u5230\u5206\u7247\u96c6\u5408\u7684\u7b56\u7565\uff1a 1 . \u9884\u5206\u5272\u96c6\u5408 2 . \u65e0\u5e8f\u5199\u5165 mongos 3 . \u907f\u514d\u5355\u8c03\u8282\u6d41 --Avoid Monotonic Throttling(\u6b64\u5904\u5b58\u7591) \u53ef\u91cd\u8bd5\u7684\u5199\u5165 \u00b6 \u53ef\u91cd\u8bd5\u5199\u5165\u8981\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6\uff1a 1 . \u9700\u8981\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4 2 . \u652f\u6301\u6587\u6863\u9501\u5b9a\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u4f8b\u5982\uff1a WiredTiger\u6216inmemory\u5185\u5b58\u5b58\u50a8\u5f15\u64ce 3 . MongoDB 3 . 6 + \u7248\u672c\u9a71\u52a8\u7a0b\u5e8f 4 . \u96c6\u7fa4\u4e2d MongoDB\u7248\u672c\u5927\u4e8e\u7b49\u4e8e3 . 6 5 . \u5199\u64cd\u4f5c\u51fa\u9519\uff0c Write Concern\u4e3a0\u7684\u4e0d\u91cd\u8bd5 transaction commit\u548cabort operations \u5982\u679c\u63d0\u4ea4\u64cd\u4f5c\u6216\u4e2d\u6b62\u64cd\u4f5c\u9047\u5230\u9519\u8bef\uff0c MongoDB\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u91cd\u8bd5\u8be5\u64cd\u4f5c\u4e00\u6b21 \uff0c\u65e0\u8bba\u662f\u5426 retryWrites\u8bbe\u7f6e\u4e3atrue \u4e8b\u52a1\u5185\u7684\u5199\u64cd\u4f5c\u662f\u4e0d\u80fd\u5355\u72ec\u91cd\u8bd5\u5199\u5165\u7684\uff0c\u65e0\u8bba retryWrites\u662f\u5426\u8bbe\u7f6e\u4e3atrue \uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0d\u542f\u52a8\u91cd\u8bd5\u5199\u5165 \u4ee5\u4e0b\u4e3a\u53ef\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c ( Write Concern\u4e0d\u80fd\u662f { w : 0 } ) \uff1a // \u63d2\u5165\u64cd\u4f5c db . collection . insertOne () db . collection . insert () db . collection . insertMany () // \u5355\u6587\u6863\u66f4\u65b0\u64cd\u4f5c db . collection . updateOne () db . collection . replaceOne () db . collection . save () db . collection . update () \u8fd9\u91cc multi\u662ffalse // \u5355\u4e2a\u6587\u6863\u5220\u9664\u64cd\u4f5c db . collection . deleteOne () db . collection . remove () \u8fd9\u91cc justOne\u662ftrue // findAndModify\u64cd\u4f5c \u3002\u6240\u6709 findAndModify\u64cd\u4f5c\u90fd\u662f\u5355\u6587\u6863\u64cd\u4f5c db . collection . findAndModify () db . collection . findOneAndDelete () db . collection . findOneAndReplace () db . collection . findOneAndUpdate () // \u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982 updateMany db . collection . bulkWrite () \u4f7f\u7528\u4ee5\u4e0b\u5199\u64cd\u4f5c : insertOne updateOne replaceOne deleteOne // \u4ec5\u5305\u542b\u5355\u6587\u6863\u7684\u6279\u91cf\u5199\u5165\u64cd\u4f5c\uff0c\u4e00\u4e2a\u53ef\u91cd\u8bd5\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6307\u5b9a\u5199\u5165\u64cd\u4f5c\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982 update\u6307\u5b9amulti\u9009\u9879\u4e3atrue Bulk \u8fd0\u4f5c\uff1a\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e3a\u8be5\u9009\u9879 update\u6307\u5b9a\u7684\u64cd\u4f5c \u3002 truemulti Bulk . find . removeOne () Bulk . find . replaceOne () Bulk . find . replaceOne () \u53ef\u91cd\u8bd5\u5199\u5165\u6709\u52a9\u4e8e\u89e3\u51b3\u77ac\u65f6\u7f51\u7edc\u9519\u8bef\u548c\u526f\u672c\u96c6\u9009\u4e3e\uff0c\u5e76\u4e0d\u80fd\u89e3\u51b3\u6301\u4e45\u6027\u7f51\u7edc\u9519\u8bef\uff0c\u56e0\u4e3a\u53ea\u8fdb\u884c\u4e00\u6b21\u91cd\u8bd5\u5c1d\u8bd5 \u5982\u679c\u9a71\u52a8\u7a0b\u5e8f\u5728\u76ee\u6807\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u5206\u7247\u4e2d\u627e\u4e0d\u5230\u6b63\u5e38\u7684\u4e3b\u8282\u70b9\uff0c\u5219\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u5728 serverSelectionTimeoutMS\u5728\u91cd\u8bd5\u4e4b\u524d\u7b49\u5f85\u4ee5\u786e\u5b9a\u65b0\u7684\u4e3b\u8282\u70b9 \uff0c\u53ef\u91cd\u8bd5\u5199\u5165\u4e0d\u80fd\u89e3\u51b3\u6545\u969c\u8f6c\u79fb\u671f\u95f4\uff0c\u65f6\u95f4\u8d85\u8fc7 serverSelectionTimeoutMS\u7684\u5b9e\u4f8b \u6ce8\u610f\uff1a\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u51fa\u5199\u5165\u64cd\u4f5c\u5728\u8d85\u8fc7 serverSelectionTimeoutMS\u6ca1\u6709\u54cd\u5e94 \uff0c\u6709\u53ef\u80fd\u5728\u5ba2\u6237\u7aef\u91cd\u65b0\u54cd\u5e94\u65f6 ( \u6ca1\u6709\u91cd\u65b0\u542f\u52a8 ) \uff0c\u5219\u53ef\u80fd\u4f1a\u518d\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c\u3002 db . serverStatus () \u5305\u542b\u6709\u5173\u8be5 transactions\u90e8\u5206\u4e2d\u53ef\u91cd\u8bd5\u5199\u5165\u7684\u7edf\u8ba1\u4fe1\u606f \u6587\u672c\u641c\u7d22 \u00b6 \u793a\u4f8b\u6587\u6863\u5982\u4e0b\u6240\u793a\uff1a | _id | description | name | | :------: | :------: | :------: | | _id | description | name | | 1 | Coffee and cakes | Java Hut | | 2 | Gourmet hamburgers | Burger Buns | | 3 | Just coffee | Coffee Shop | | 4 | Discount clothing | Clothes Clothes Clothes | | 5 | Indonesian goods | Java Shopping | // \u89c6\u56fe\u4e0d\u652f\u6301\u6587\u672c\u641c\u7d22\uff1b\u6587\u672c\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5b57\u7b26\u4e32\u5185\u5bb9\u7684\u6587\u672c\u641c\u7d22\u67e5\u8be2\u3002 text\u7d22\u5f15\u53ef\u4ee5\u5305\u62ec\u5176\u503c\u4e3a\u5b57\u7b26\u4e32\u6216\u5b57\u7b26\u4e32\u5143\u7d20\u6570\u7ec4\u7684\u4efb\u4f55\u5b57\u6bb5 // \u8981\u6267\u884c\u6587\u672c\u641c\u7d22\u67e5\u8be2\uff0c\u60a8\u5fc5\u987b text\u5728\u96c6\u5408\u4e0a\u6709\u7d22\u5f15 \u3002\u96c6\u5408\u53ea\u80fd\u6709\u4e00\u4e2a\u6587\u672c\u641c\u7d22\u7d22\u5f15\uff0c\u4f46\u8be5\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u591a\u4e2a\u5b57\u6bb5 // \u4f7f\u7528$ text\u67e5\u8be2\u8fd0\u7b97\u7b26\u5bf9\u5177\u6709\u6587\u672c\u7d22\u5f15\u7684\u96c6\u5408\u6267\u884c\u6587\u672c\u641c\u7d22 \u3002$ text\u5c06\u4f7f\u7528\u7a7a\u683c\u548c\u5927\u591a\u6570\u6807\u70b9\u7b26\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u6765\u6807\u8bb0\u641c\u7d22\u5b57\u7b26\u4e32 \uff0c\u5e76 OR\u5728\u641c\u7d22\u5b57\u7b26\u4e32\u4e2d\u6267\u884c\u6240\u6709\u6b64\u7c7b\u6807\u8bb0\u7684\u903b\u8f91 db . stores . find ( { $ text : { $ search : \"java shop\" } } ) // \u67e5\u627e stores\u96c6\u5408\u5305\u542bjava shop\u7684\u4efb\u4f55\u6587\u6863 db . stores . find ( { $ text : { $ search : \"java -shop\" } } ) // \u67e5\u627e stores\u96c6\u5408\u5305\u542bjava\u6392\u9664shop\u7684\u4efb\u4f55\u6587\u6863 db . stores . find ( { $ text : { $ search : \"java coffee shop\" } } , { score : { $ meta : \"textScore\" } } ). sort ( { score : { $ meta : \"textScore\" } } ) // \u8981\u6309\u76f8\u5173\u6027\u5f97\u5206\u7684\u987a\u5e8f\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f aggregation pipeline\u4e5f\u53ef\u4ee5\u8fdb\u884ctext\u641c\u7d22 db . stores . createIndex ( { name : \"text\" , description : \"text\" } ) // \u521b\u5efa\u7d22\u5f15 , \u5141\u8bb8\u5728 name\u548cdescription\u5b57\u6bb5\u4e0a\u8fdb\u884c\u6587\u672c\u641c\u7d22 \u5728\u805a\u5408\u7ba1\u9053\u4e2d\u901a\u8fc7$ text\u5728$match\u9636\u6bb5\u4f7f\u7528\u67e5\u8be2\u8fd0\u7b97\u7b26\u8fdb\u884c\u6587\u672c\u641c\u7d22 \uff1b\u805a\u5408\u7ba1\u9053\u4e2d\u7684\u6587\u672c\u641c\u7d22\u5177\u6709\u4ee5\u4e0b\u9650\u5236\uff1a 1 . $ match\u9636\u6bb5\u5305\u542b\u7684$text\u5fc5\u987b\u5728\u6d41\u6c34\u7ebf\u7684\u7b2c\u4e00\u9636\u6bb5 2 . \u4e00\u4e2a text\u64cd\u4f5c\u53ea\u80fd\u5728\u6d41\u6c34\u9636\u6bb5\u51fa\u73b0\u4e00\u6b21 3 . text\u64cd\u4f5c\u4e0d\u80fd\u51fa\u73b0\u5728$or\u6216$not\u8868\u8fbe\u5f0f 4 . \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6587\u672c\u641c\u7d22\u4e0d\u4f1a\u6309\u5339\u914d\u5206\u6570\u7684\u987a\u5e8f\u8fd4\u56de\u5339\u914d\u7684\u6587\u6863\uff0c\u5728$ sort\u9636\u6bb5\u4f7f\u7528$meta\u805a\u5408\u8868\u8fbe\u5f0f \u5730\u7406\u7a7a\u95f4\u67e5\u8be2 \u00b6 // \u6307\u5b9aGeoJSON\u6570\u636e , \u4f7f\u7528\u5d4c\u5165\u5f0f\u6587\u6863\uff1a 1. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5\u540d\u4e3atype\uff0c\u6307\u5b9aGeoJSON\u5bf9\u8c61\u7c7b\u578b 2. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5coordinates\uff0c\u7528\u4e8e\u6307\u5b9a\u5bf9\u8c61\u7684\u5750\u6807\uff0c\u6307\u5b9a\u7ecf\u7eac\u5ea6\u5750\u6807\uff0c\u6709\u6548\u7ecf\u5ea6 - 180 \u81f3180 ( \u5305\u62ec\u4e24\u8005 ) \uff0c\u6709\u6548\u7eac\u5ea6 - 90 \u523090 ( \u5305\u62ec\u4e24\u8005 ) location : { type : \"Point\" , coordinates : [ - 73.856077 , 40.848447 ] } MongoDB\u63d0\u4f9b\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5730\u7406\u7a7a\u95f4\u67e5\u8be2 \uff1a 2 dsphere\u7d22\u5f15\u652f\u6301\u5728\u7c7b\u4f3c\u5730\u7403\u7684\u7403\u4f53\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2 db . collection . createIndex ({ location field : \"2dsphere\" }) // \u521b\u5efa2dsphere\u7d22\u5f15 2 d\u7d22\u5f15\u652f\u6301\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2 , \u7d22\u5f15\u652f\u6301$nearSphere\u5728\u7403\u4f53\u4e0a\u8ba1\u7b97\u7684\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u8fd8\u662f\u4f7f\u75282dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2\uff0c2d\u5bf9\u7403\u5f62\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u7684\u7ed3\u679c\uff0c\u5982\uff1a\u4f7f\u75282d\u5305\u56f4\u6781\u70b9\u7684\u7403\u5f62\u67e5\u8be2\u7d22\u5f15 \u5206\u7247\u96c6\u5408\u65f6\uff0c\u4e0d\u80fd\u5c06\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u4f5c\u4e3a\u5206\u7247\u952e\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\u5728\u5206\u7247\u96c6\u5408\u4e0a\u521b\u5efa\u5730\u5740\u7a7a\u95f4\u7d22\u5f15 \u5206\u7247\u96c6\u5408\u652f\u6301\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\uff1a 1. $ geoNear \u805a\u5408\u9636\u6bb5 2. $ near\u548c$nearSphere\u67e5\u8be2\u8fd0\u7b97\u7b26 3. geoNear\u547d\u4ee4 \u5728\u5206\u7247\u96c6\u7fa4\uff0c\u53ef\u4ee5\u4f7f\u7528$geoWithin\u548c$geoIntersect\u6765\u67e5\u8be2\u5730\u7406\u7a7a\u95f4\u6570\u636e \u4ee5\u4e0b\u4e3a\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\uff1a $ geoIntersects // \u9009\u62e9\u548cGeoJSON\u51e0\u4f55\u4f53\u76f8\u4ea4\u7684\u51e0\u4f55\uff0c\u8be52dsphere\u7d22\u5f15\u652f\u6301$geoIntersects $ geoWithin // \u9009\u62e9\u8fb9\u754cGeoJSON\u51e0\u4f55\u4f53\u5185\u7684\u51e0\u4f55 , \u8be52dsphpere\u548c2d\u7d22\u5f15\u652f\u6301$geoWithin $ near // \u8fd4\u56de\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $ near $ nearSphere // \u8fd4\u56de\u7403\u4f53\u4e0a\u67d0\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $ nearSphere \u5730\u7406\u7a7a\u95f4\u547d\u4ee4\uff1a geoNear\uff08\u5728MongoDB 4.0 \u4e2d\u4e0d\u63a8\u8350\u4f7f\u7528\uff09 // \u6267\u884c\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\uff0c\u8fd4\u56de\u6700\u63a5\u8fd1\u7ed9\u5b9a\u70b9\u7684\u6587\u6863\u3002\u4e0d\u63a8\u8350\u4f7f\u7528\u7684geoNear\u547d\u4ee4\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15 \u5730\u7406\u7a7a\u95f4\u805a\u5408\u9636\u6bb5: $ geoNear // \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd $ match\uff0c$sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 $ geoNear\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15 \u5730\u7406\u7a7a\u95f4\u6a21\u578b: MongoDB\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u53ef\u4ee5\u89e3\u91ca\u5e73\u9762\u6216\u7403\u9762\u4e0a\u7684\u51e0\u4f55\u4f53 2 dsphere \u7d22\u5f15\u4ec5\u652f\u6301\u7403\u5f62\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u7403\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09 2 d\u7d22\u5f15\u652f\u6301\u5e73\u9762\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u5e73\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09\u548c\u4e00\u4e9b\u7403\u5f62\u67e5\u8be2\u3002\u867d\u71362d \u7d22\u5f15\u652f\u6301\u67d0\u4e9b\u7403\u5f62\u67e5\u8be2\uff0c\u4f46\u4f7f\u75282d\u8fd9\u4e9b\u7403\u5f62\u67e5\u8be2\u7684\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002\u5982\u679c\u53ef\u80fd\uff0c\u8bf7\u4f7f\u7528 2 dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2 \u4e0b\u8868\u5217\u51fa\u4e86\u6bcf\u4e2a\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\u4f7f\u7528\u7684\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\u652f\u6301\u7684\u67e5\u8be2\uff1a [ http : // docs . mongodb . com / manual / geospatial - queries/ ] | \u64cd\u4f5c | \u7403\u5f62/\u5e73\u9762\u67e5\u8be2 | \u5907\u6ce8 | | :- -----: | :- -----: | :- -----: | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | // write - concern { w : < value > , j : < boolean > , wtimeot : < number > } w\u9009\u9879 \uff1a\u786e\u8ba4\u5199\u5165\u8bf7\u6c42\u4f20\u9012\u7ed9 mongod\u5b9e\u4f8b\u7684\u6570\u91cf \uff0c 1 \u8868\u793a\u4f20\u9012\u5199\u5165\u64cd\u4f5c\u7ed9\u4e00\u4e2a standalone\u6216\u526f\u672c\u7684\u4e00\u4e2a\u4e3b\u8282\u70b9 \uff1b 0 \u5199\u5165\u64cd\u4f5c\u6ca1\u6709\u786e\u8ba4\uff0c w\u5927\u4e8e1\u662f\u56e0\u4e3a\u9700\u8981\u6765\u81ea\u5176\u4ed6\u8f85\u52a9\u6570\u636e\u8282\u70b9\u7684\u786e\u8ba4 j\u9009\u9879 \uff1a\u786e\u8ba4\u5199\u64cd\u4f5c\u5df2\u5199\u5165\u78c1\u76d8\u65e5\u5fd7 ( on - disk journal ) wtimeout : \u5199\u5165\u7684\u65f6\u95f4\u9650\u5236 ( \u6beb\u79d2\u4e3a\u5355\u4f4d ) \uff0c wtimeout\u4ec5\u9650\u4e8ew\u5927\u4e8e1\u7684\u60c5\u51b5 MongoDBCRUD\u6982\u5ff5 \u00b6 // \u539f\u5b50\u6027\u548c\u4e8b\u52a1 \u5f53\u5355\u4e2a\u5199\u64cd\u4f5c ( \u5982\uff1a db . collection . updateMany ()) \u4fee\u6539\u591a\u4e2a\u6587\u4ef6\u65f6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u7684\u4fee\u6539\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u4f46\u662f\u6574\u4e2a\u64cd\u4f5c\u4e0d\u662f\uff01 // \u5e76\u53d1\u63a7\u5236 \u5e76\u53d1\u63a7\u5236\u5141\u8bb8\u591a\u4e2a\u7a0b\u5e8f\u540c\u65f6\u8fd0\u884c\uff0c\u800c\u4e0d\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\u6216\u51b2\u7a81 \u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u5b57\u6bb5\u4e0a\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u8be5\u7d22\u5f15\u53ea\u6709\u552f\u4e00\u503c\u3002\u53ef\u4ee5\u9632\u6b62\u63d2\u5165\u3001\u66f4\u65b0\u521b\u5efa\u91cd\u590d\u6570\u636e\u3002\u5728\u591a\u4e2a\u5b57\u6bb5\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u4ee5\u5f3a\u5236\u8be5\u5b57\u6bb5\u7ec4\u5408\u7684\u552f\u4e00\u6027\u3002 \u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u4e3a\u5199\u64cd\u4f5c\u7684\u67e5\u8be2\u8c13\u8bcd\u4e2d\u6307\u5b9a\u5b57\u6bb5\u9884\u671f\u7684\u5f53\u524d\u503c // \u8bfb\u53d6\u9694\u79bb , \u4e00\u81f4\u6027\u548c Recency \u5206\u5e03\u5f0f\u67e5\u8be2\u3001\u67e5\u8be2\u4f18\u5316\u3001\u67e5\u8be2\u6027\u80fd\u3001\u4f18\u5316\u67e5\u8be2 \u00b6 oplog \u662f\u5bf9\u6570\u636e\u96c6\u64cd\u4f5c\u7684\u53ef\u91cd\u73b0\u5e8f\u5217,\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u5d4c\u5165\u5f0f\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u67e5\u8be2\uff1b\u5982\u679c\u7d22\u5f15\u8ddf\u8e2a\u54ea\u4e2a\u6216\u54ea\u4e9b\u5b57\u6bb5\u5bfc\u81f4\u7d22\u5f15\u4e3a\u591a\u5efa\u7d22\u5f15\uff0c\u5219\u591a\u5efa\u7d22\u5f15\u53ef\u4ee5\u8986\u76d6\u975e\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2\u3002 ( \u591a\u5efa\u7d22\u5f15\u4e0d\u80fd\u8986\u76d6\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2 ) \uff1b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u65e0\u6cd5\u8986\u76d6\u7d22\u5f15\u3002\u8981\u786e\u5b9a\u4e00\u4e2a\u67e5\u8be2\u662f\u5426\u4e3a\u8986\u76d6\u67e5\u8be2\uff0c\u4f7f\u7528 db . collection . explain () \u6216 explain () \u4f7f\u7528 Database Profiler \u8bc4\u4f30\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c // \u4f18\u5316\u67e5\u8be2 1 . \u521b\u5efa\u652f\u6301\u67e5\u8be2\u7684\u7d22\u5f15 2 . \u5982\u7ecf\u5e38\u5bf9 timestamp \u5b57\u6bb5\u8fdb\u884c\u6392\u5e8f\u6027\u67e5\u8be2\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u5728 timestamp \u5b57\u6bb5\u521b\u5efa\u7d22\u5f15\uff0c\u67e5\u8be2\u65f6\u4f7f\u7528 db . collection . find () . sort ( { timestamp : - 1 } ) \u66f4\u5feb\u5f97\u5230\u7ed3\u679c\uff0c\u56e0\u4e3a MongoDB \u53ef\u4ee5\u6309\u7167\u5347\u5e8f\u6216\u964d\u5e8f\u8bfb\u53d6\u7d22\u5f15\u3002 3 . \u7d22\u5f15\u652f\u6301\u67e5\u8be2\u3001\u66f4\u65b0\u64cd\u4f5c\u548c\u805a\u5408\u7ba1\u9053\u7684\u67d0\u4e9b\u9636\u6bb5\uff1b\u5982\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\uff0c\u5219 BinData \u7c7b\u578b\u7684\u7d22\u5f15\u5efa\u53ef\u4ee5\u66f4\u6709\u6548\u7684\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\u3002 * \u4e8c\u8fdb\u5236\u5b50\u7c7b\u578b\u503c\u5f97\u8303\u56f4\u4e3a 0 - 7 \u6216 128 - 135 * \u5b57\u8282\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a\uff1a 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 10 , 12 , 14 , 16 , 20 , 24 \u6216 32 4 . \u9650\u5236\u67e5\u8be2\u7ed3\u679c\u6570\uff0c\u901a\u8fc7 limit () \u65b9\u6cd5\u51cf\u5c11\u67e5\u8be2\u5bf9\u7f51\u7edc\u8d44\u6e90\u7684\u6d88\u8017\u3002\u901a\u5e38\u548c sort () \u7ed3\u5408\u4f7f\u7528 5 . \u4f7f\u7528\u9884\u6d4b\u8fd4\u56de\u5fc5\u8981\u7684\u6570\u636e\uff1b\u53ea\u9700\u8981\u6587\u6863\u7684\u90e8\u5206\u5b57\u6bb5\u65f6\uff0c\u53ea\u8fd4\u56de\u6240\u9700\u7684\u5b57\u6bb5\u53ef\u4ee5\u83b7\u53d6\u66f4\u597d\u7684\u6027\u80fd\u3002 6 . \u4f7f\u7528$ hint \u9009\u62e9\u4e00\u4e2a\u7279\u5b9a\u7684\u6307\u6570\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u4e3a\u7279\u5b9a\u64cd\u4f5c\u9009\u62e9\u6700\u4f73\u7684\u7d22\u5f15\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528$ hint () \u65b9\u6cd5\u5f3a\u5236\u4f7f\u7528\u7279\u5b9a\u7d22\u5f15\u3002 hint () \u652f\u6301\u6027\u80fd\u6d4b\u8bd5\u6216\u5728\u67d0\u4e9b\u67e5\u8be2\uff0c\u5728\u4e00\u4e9b\u67e5\u8be2\u4e2d\uff0c\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5fc5\u987b\u5305\u542b\u5728\u591a\u4e2a\u7d22\u5f15\u4e2d\u3002 7 . \u4f7f\u7528\u589e\u91cf\u8fd0\u7b97\u7b26\u6267\u884c\u64cd\u4f5c\u670d\u52a1\u7aef\uff0c MongoDB \u7684$ inc \u8fd0\u7b97\u7b26\u6765\u589e\u52a0\u6216\u51cf\u5c11\u6587\u6863\u4e2d\u7684\u503c\uff0c\u8be5\u64cd\u4f5c\u589e\u52a0\u670d\u52a1\u7aef\u5b57\u6bb5\u7684\u503c\uff0c\u4f5c\u4e3a\u9009\u62e9\u6587\u6863\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0c\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u7b80\u5355\u4fee\u6539\uff0c\u7136\u540e\u5c06\u6574\u4e2a\u6587\u6863\u5199\u5165\u670d\u52a1\u5668\u3002$ inc \u64cd\u4f5c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u907f\u514d\u7ade\u4e89\u6761\u4ef6\uff0c\u8fd9\u5c06\u5bfc\u81f4\u4e24\u4e2a\u5e94\u7528\u5b9e\u4f8b\u5bf9\u540c\u4e00\u4e2a\u6587\u4ef6\u67e5\u8be2\u65f6\uff0c\u624b\u52a8\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5e76\u4fdd\u5b58\u6574\u4e2a\u6587\u4ef6\u56de\u5230\u540c\u4e00\u65f6\u95f4\u3002 // \u5199\u64cd\u4f5c\u6027\u80fd \u96c6\u5408\u4e2d\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u589e\u52a0\u6027\u80fd\u7684\u5f00\u9500\uff1b\u56e0\u96c6\u5408\u4e2d\u6bcf\u4e2a insert \u548c delete \u5199\u5165\u64cd\u4f5c\u3002 MongoDB \u90fd\u4f1a\u4ece\u76ee\u6807\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u4e2d\u63d2\u5165\u6216\u5220\u9664\u5bf9\u5e94\u7684\u6587\u6863\u952e\u3002 update \u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u65b0\u5728\u8fd9\u4e2a\u96c6\u5408\u4e2d\u7d22\u5f15\u7684\u5b50\u96c6\uff0c\u53d6\u51b3\u4e8e\u66f4\u65b0\u65f6\u8fd9\u4e2a\u952e\u7684\u5f71\u54cd\u3002 // \u6ce8\u610f\uff1a\u5982\u679c\u5199\u5165\u64cd\u4f5c\u4e2d\u6d89\u53ca\u7684\u6587\u6863\u5305\u542b\u5728\u7d22\u5f15\u4e2d\uff0c MongoDB \u5219\u4ec5\u66f4\u65b0 sparse \u6216 partial \u7d22\u5f15 ( sparse \u548c partial \u4e3a MongoDB \u7684\u7d22\u5f15\u7c7b\u578b ) \u67d0\u4e9b\u66f4\u65b0\u64cd\u4f5c\u53ef\u80fd\u589e\u52a0\u6587\u6863\u7684\u5927\u5c0f\u3002\u5982:\u5411\u6587\u6863\u589e\u52a0\u5b57\u6bb5\u3002\u5bf9\u4e8e MMAPv1 \u5f15\u64ce\uff0c\u5982\u679c\u66f4\u65b0\u64cd\u4f5c\u5bfc\u81f4\u6587\u6863\u8d85\u8fc7\u5f53\u524d\u5206\u914d\u7684\u8bb0\u5f55\u5927\u5c0f\u3002 MongoDB \u4f1a\u5c06\u6587\u6863\u91cd\u65b0\u5b9a\u4f4d\u5230\u78c1\u76d8\u4e0a\u3002\u5e76\u7559\u6709\u8db3\u591f\u7684\u8fde\u7eed\u7a7a\u95f4\u6765\u4fdd\u5b58\u6587\u6863\u3002\u9700\u8981\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u6bd4\u6ca1\u6709\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u82b1\u8d39\u7684\u65f6\u95f4\u66f4\u957f\uff0c\u7279\u522b\u662f\u5728\u96c6\u5408\u5177\u6709\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\u3002\u5982\u679c\u96c6\u5408\u5177\u6709\u7d22\u5f15\uff0c MongoDB \u5fc5\u987b\u66f4\u65b0\u6240\u6709\u7d22\u5f15\u6761\u76ee\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u7d22\u5f15\u7684\u96c6\u5408\uff0c\u6b64\u79fb\u52a8\u5c06\u5f71\u54cd\u5199\u5165\u541e\u5410\u91cf // explain \u7ed3\u679c Stages \u63cf\u8ff0\u4e86\u64cd\u4f5c -- \u5982\uff1a COLLSCAN \u7528\u4e8e\u96c6\u5408\u626b\u63cf IXSCAN \u7528\u4e8e\u626b\u63cf\u7d22\u5f15\u952e FETCH \u7528\u4e8e\u68c0\u7d22\u6587\u6863 SHARD_MERGE \u7528\u4e8e\u5408\u5e76\u5206\u7247\u7684\u7ed3\u679c SHARDING_FILTER \u7528\u4e8e\u4ece\u5206\u7247\u4e2d\u8fc7\u6ee4\u6389\u5b64\u7acb\u6587\u6863 // explain result explain . queryPlanner // \u5305\u542b\u67e5\u8be2\u4f18\u5316\u5668\u9009\u62e9\u67e5\u8be2\u8ba1\u5212\u7684\u4fe1\u606f explain . queryPlanner . namespace // // \u5206\u6790\u67e5\u8be2\u6027\u80fd \u5229\u7528 cursor . explain ( \" executionStats \" ) \u548c db . collection . explain ( \" executionStats \" ) \u65b9\u6cd5\u67e5\u770b\u6709\u5173\u67e5\u8be2\u6027\u80fd\u7684\u7edf\u8ba1\u4fe1\u606f 1 . queryPlanner . winningPlan . stage // COLLSCAN \u8868\u793a\u96c6\u5408\u626b\u63cf\uff0c\u4e5f\u5c31\u8868\u660e mongod \u5fc5\u987b\u626b\u63cf\u6574\u4e2a\u96c6\u5408\u6587\u6863\u6765\u8bc6\u522b\u7ed3\u679c\u3002 2 . executionStats . nReturned // \u663e\u793a 3 \uff0c\u8868\u660e\u67e5\u8be2\u5339\u914d\u5230\u4e09\u4e2a\u6587\u6863 3 . executionStats . totalKeysExamined // \u663e\u793a 0 \uff0c\u8868\u660e\u6b64\u67e5\u8be2\u672a\u7528\u5230\u7d22\u5f15 4 . executionStats . totalDocsExamined // \u663e\u793a 10 \uff0c\u8868\u660e MongoDB \u5fc5\u987b\u626b\u63cf\u7684\u6587\u6863\u6570\u91cf ( \u6b64\u5904\u4e3a 10 \u4e2a ) \u624d\u80fd\u67e5\u627e\u5230\u548c\u6761\u4ef6\u5339\u914d\u76f8\u7b26\u7684\u6587\u6863\u3002 5 . queryPlanner . winningPlan . inputStage . stage // \u663e\u793a IXSCAN \u8868\u793a\u6b64\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15 // \u6bd4\u8f83\u7d22\u5f15\u6027\u80fd \u624b\u52a8\u6bd4\u8f83\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15\u67e5\u8be2\u7684\u6027\u80fd\uff0c\u53ef\u4ee5 hint () \u548c explain () \u65b9\u6cd5\u7ed3\u5408\u4f7f\u7528\uff0c\u6dfb\u52a0\u590d\u5408\u7d22\u5f15\u65f6\uff0c\u5b57\u6bb5\u7684\u987a\u5e8f\u975e\u5e38\u91cd\u8981\uff1b\u987a\u5e8f\u4e0d\u540c\u53ef\u80fd\u4f1a\u5bf9\u67e5\u8be2\u9020\u6210\u7684\u5f71\u54cd\u4e0d\u540c\uff0c\u6027\u80fd\u4ea7\u751f\u5dee\u5f02\uff1b\u4f8b\u5982\uff1a db . collection . createIndex ( { quantity : 1 , type : 1 } ) // \u7d22\u5f15\u5148\u6309 quantity \u5b57\u6bb5\u6392\u5e8f\uff0c\u7136\u540e\u6309\u7167 type \u5b57\u6bb5\u6392\u5e8f db . collection . createIndex ( { type : 1 , quantity : 1 } ) // \u7d22\u5f15\u5148 type \u5b57\u6bb5\u6392\u5e8f\uff0c\u518d\u6309 quantity \u5b57\u6bb5\u6392\u5e8f // Tailable Cursors \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u67e5\u8be2\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u4f1a\u5173\u95ed\u8fd4\u56de\u7684\u6570\u636e cursor \uff0c Tailable Cursors \u7c7b\u4f3c\u4e8e tail - f \u547d\u4ee4\u3002\u4f5c\u7528\u5728 capped \u96c6\u5408\u4e0a\uff0c\u5f53\u5ba2\u6237\u7aef\u6709\u65b0\u7684\u6587\u6863\u63d2\u5165\u5230 capped \u96c6\u5408\u65f6\uff0c tailable \u6e38\u6807\u5c06\u7ee7\u7eed\u68c0\u7d22\u6587\u6863\u3002 MongoDB \u526f\u672c\u96c6\u5c31\u4f7f\u7528 tailable \u6e38\u6807\u6765\u8ddf\u8e2a\u4e3b\u8282\u70b9\u7684 oplog \u3002 \u6ce8\u610f\uff1a\u5982\u679c\u67e5\u8be2\u5b57\u6bb5\u4f4d\u4e8e\u7d22\u5f15\u5b57\u6bb5\uff0c\u4e0d\u8981\u4f7f\u7528 tailable \u6e38\u6807\uff0c\u4f7f\u7528\u5e38\u89c4\u6e38\u6807\u5373\u53ef\uff0c\u8ddf\u8e2a\u67e5\u8be2\u8fd4\u56de\u7684\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002\u8981\u68c0\u7d22\u65b0\u6dfb\u52a0\u7684\u6587\u6863\uff0c\u8bf7\u4f7f\u7528\u67e5\u8be2\u6761\u4ef6\u4e2d\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u518d\u6b21\u67e5\u8be2\u96c6\u5408\u3002\u4f8b\u5982\uff1a db . collection . find ( { indexedField : { $ gt : lastvalue } } ) \u8003\u8651\u4ee5\u4e0b\u4e0e tailable \u6e38\u6807\u76f8\u5173\u7684\u884c\u4e3a\uff1a 1 . Tailable \u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\u5e76\u6309\u81ea\u7136\u987a\u5e8f\u8fd4\u56de\u6587\u6863 2 . \u7531\u4e8e tailable \u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\uff0c\u56e0\u6b64\u67e5\u8be2\u7684\u521d\u59cb\u626b\u63cf\u5f00\u9500\u5f88\u5927\uff0c\u4f46\u5728\u540e\u7eed\u7684\u65b0\u6dfb\u52a0\u6587\u6863\u68c0\u7d22\u6d88\u8017\u5f88\u5c0f 3 . \u4ee5\u4e0b\u60c5\u51b5 Tailable \u6e38\u6807\u53ef\u80fd\u4f1a\u6b7b\u4ea1\u6216\u8005\u65e0\u6548\uff1a * \u67e5\u8be2\u8fd4\u56de\u4e0d\u5339\u914d * \u6e38\u6807\u8fd4\u56de\u96c6\u5408 \" end \" \u5904\u7684\u6587\u6863\uff0c\u7136\u540e\u5e94\u7528\u7a0b\u5e8f\u5220\u9664\u4e86\u8be5\u6587\u6863 \u4e00\u4e2a\u6b7b\u4ea1\u7684 cursor \u6709\u4e00\u4e2a id \u4e3a 0 \u805a\u5408(Aggregation) \u00b6 \u805a\u5408\u64cd\u4f5c\u5c06\u6765\u81ea\u591a\u4e2a\u6587\u6863\u7684\u503c\u7ec4\u5408\u4e00\u8d77\uff0c\u5e76\u4e14\u5bf9\u5206\u7ec4\u6570\u636e\u6267\u884c\u5404\u79cd\u64cd\u4f5c\u540e\u8fd4\u56de\u5355\u4e2a\u7ed3\u679c\u3002MongoDB\u4e09\u79cd\u6267\u884c\u805a\u5408\u7684\u65b9\u5f0f\uff1a\u805a\u5408\u7ba1\u9053\u3001map-reduce\u51fd\u6570\u548c\u5355\u7528\u9014(single purpose)\u805a\u5408\u65b9\u6cd5\u3002 \u805a\u5408\u7ba1\u9053 \u00b6 \u6700\u57fa\u672c\u7684\u7ba1\u9053\u9636\u6bb5\u662f\u8fc7\u6ee4\u5668\uff0c\u64cd\u4f5c\u7c7b\u4f3c\u4e8e\u67e5\u8be2\u548c\u6587\u6863\u8f6c\u6362\u3002\u5176\u4ed6\u7ba1\u9053\u64cd\u4f5c\u63d0\u4f9b\u4e86\u6309\u7279\u5b9a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\u548c\u6392\u5e8f\u7684\u5de5\u5177\u4ee5\u53ca\u7528\u4e8e\u805a\u5408\u6570\u7ec4\u5185\u5bb9\u7684\u5de5\u5177\uff0c\u5305\u62ec\u6587\u6863\u4e2d\u7684\u6570\u7ec4\u3002\u6b64\u65b9\u5f0f\u662fMongoDB\u6570\u636e\u805a\u5408\u7684\u9996\u9009\u65b9\u6cd5 map-reduce\u51fd\u6570\uff1a\u901a\u5e38\uff0cmap-reduce\u64cd\u4f5c\u6709\u4e24\u4e2a\u9636\u6bb5\uff1a\u4e00\u4e2amap\u9636\u6bb5\uff0c\u5b83\u5904\u7406\u6bcf\u4e2a\u6587\u6863\u5e76\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u53d1\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\uff0c\u5e76\u51cf\u5c11\u7ec4\u5408map\u64cd\u4f5c\u8f93\u51fa\u7684\u9636\u6bb5\u3002\u53ef\u9009\u5730\uff0cmap-reduce\u53ef\u4ee5\u5177\u6709 \u6700\u7ec8\u5316\u9636\u6bb5\u4ee5\u5bf9\u7ed3\u679c\u8fdb\u884c\u6700\u7ec8\u4fee\u6539\u3002\u4e0e\u5176\u4ed6\u805a\u5408\u64cd\u4f5c\u4e00\u6837\uff0cmap-reduce\u53ef\u4ee5\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\u4ee5\u9009\u62e9\u8f93\u5165\u6587\u6863\u4ee5\u53ca\u6392\u5e8f\u548c\u9650\u5236\u7ed3\u679c\u3002Map-reduce\u4f7f\u7528\u81ea\u5b9a\u4e49JavaScript\u51fd\u6570\u6765\u6267\u884c\u6620\u5c04\u548c\u51cf\u5c11\u64cd\u4f5c\uff0c\u4ee5\u53ca\u53ef\u9009\u7684finalize\u64cd\u4f5c\u3002\u867d\u7136\u81ea\u5b9a\u4e49JavaScript\u4e0e\u805a\u5408\u7ba1\u9053\u76f8\u6bd4\u63d0\u4f9b\u4e86\u6781\u5927\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u901a\u5e38\uff0cmap-reduce\u6bd4\u805a\u5408\u7ba1\u9053\u6548\u7387\u66f4\u4f4e\uff0c\u66f4\u590d\u6742 map-reduce \u5355\u7528\u9014\u805a\u5408\u64cd\u4f5c\uff1aMongoDB\u6709db.collection.estimatedDocumentCount()\uff0cdb.collection.count()\u548cdb.collection.distinct(),\u8fd9\u4e9b\u64cd\u4f5c\u805a\u5408\u90fd\u53ea\u80fd\u805a\u5408\u6765\u81ea\u5355\u4e2a\u96c6\u5408\u7684\u6587\u6863 \u805a\u5408\u7ba1\u9053\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\uff1a\u67d0\u4e9b\u9636\u6bb5\u5c06\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u64cd\u4f5c\u6570\uff0c\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u6307\u5b9a\u8981\u5e94\u7528\u4e8e\u8f93\u5165\u6587\u6863\u7684\u8f6c\u6362\u3002\u8868\u8fbe\u5f0f\u5177\u6709\u6587\u6863\u7ed3\u6784\u4e14\u5305\u542b\u5176\u4ed6\u8868\u8fbe\u5f0f\u3002 \u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u53ea\u80fd\u64cd\u4f5c\u5728\u5f53\u524d\u6d41\u6c34\u7ebf\u7684\u6587\u6863\u5e76\u4e14\u4e0d\u80fd\u5f15\u7528\u5176\u4ed6\u6587\u6863\u4e2d\u7684\u6570\u636e\u3002\u8868\u8fbe\u5f0f\u63d0\u4f9b\u6587\u6863\u7684\u5185\u5b58\u4e2d\u8f6c\u6362\u64cd\u4f5c\u3002\u901a\u5e38\uff0c\u5f53\u805a\u5408\u8fc7\u7a0b\u5e26\u6709\u4e00\u4e2a\u4f8b\u5916\uff1a accumulator\u8868\u8fbe\u5f0f \uff0c\u8868\u8fbe\u5f0f\u662f\u65e0\u72b6\u6001\u7684\u3002\u4ec5\u8fdb\u884c\u8bc4\u4f30 \u8fd9\u4e2a\u7d2f\u52a0\u5668\u7528\u5728$ group\u9636\u6bb5 \uff0c\u4fdd\u6301\u5176\u72b6\u6001 ( \u4f8b\u5982\uff1a totals , maximums , minimums\u548crelated data ) \u901a\u8fc7\u6d41\u6c34\u7ebf\u4f5c\u4e3a\u6587\u6863\u5904\u7406\u8fdb\u7a0b \u5728$ project\u9636\u6bb5\u4f7f\u7528\u4e00\u4e9b\u7d2f\u52a0\u5668 \uff0c\u4f46\u5728\u6b64\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u7d2f\u52a0\u5668\u4e0d\u4f1a\u5728\u6587\u6863\u4e2d\u4fdd\u6301\u5176\u72b6\u6001\u3002 \u4f7f\u7528\u4ee5\u4e0b\u64cd\u4f5c\u53ef\u4ee5\u907f\u514d\u626b\u63cf\u6574\u4e2a\u96c6\u5408\uff1a \u6d41\u6c34\u7ebf\u64cd\u4f5c\u7b26\u548c\u7d22\u5f15\uff1a\u5f53$ match\u548c$sort\u51fa\u73b0\u5728\u7ba1\u9053\u6d41\u6c34\u7ebf\u8d77\u59cb\u4f4d\u7f6e\u53ef\u4ee5\u5229\u7528\u7d22\u5f15\u7684\u4f18\u52bf \u3002$ GeoNear\u7ba1\u9053\u5219\u53ef\u4ee5\u6709\u4e00\u4e2a\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7684\u4f18\u52bf \uff0c\u5f53\u4f7f\u7528$ geoNear\u65f6 \uff0c\u5176\u5fc5\u987b\u5728\u805a\u5408\u7ba1\u9053\u64cd\u4f5c\u4e2d\u7684\u7b2c\u4e00\u4e2a\u9636\u6bb5\u3002 \u9650\u5236\uff1a\u805a\u5408\u7ba1\u9053\u5bf9\u503c\u7c7b\u578b\u548c\u7ed3\u679c\u5927\u5c0f\u6709\u4e00\u5b9a\u7684\u9650\u5236 \u805a\u5408\u7ba1\u9053\u4f18\u5316\uff1a Projection\u4f18\u5316 \uff1a\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u786e\u5b9a\u5b83\u662f\u5426\u4ec5\u9700\u8981\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u5b50\u96c6\u6765\u83b7\u5f97\u7ed3\u679c\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u7ba1\u9053\u5c06\u53ea\u4f7f\u7528\u90a3\u4e9b\u5fc5\u9700\u7684\u5b57\u6bb5\uff0c\u51cf\u5c11\u901a\u8fc7\u7ba1\u9053\u7684\u6570\u636e\u91cf \u6d41\u6c34\u7ebf\u5e8f\u5217\u5316\u4f18\u5316\uff1a$ project\u6216$addFields + $ match\u5e8f\u5217\u4f18\u5316 \uff1b\u5bf9\u4e8e\u5305\u542b projection\u9636\u6bb5 ( $ project\u6216$addFields ) \u540e\u9762\u8ddf\u7740\u4e00\u4e2a$ match\u9636\u6bb5\u7684\u805a\u5408\u6d41\u6c34\u7ebf \uff0c\u5728 projection\u4e4b\u524dMongoDB\u79fb\u52a8$match\u9636\u6bb5\u4e2d\u4efb\u4f55\u8fc7\u6ee4\u5668\u4e0d\u9700\u8981\u5728projection\u9636\u6bb5\u8ba1\u7b97\u7684\u503c\u7ed9\u4e00\u4e2a\u65b0\u7684$match\u9636\u6bb5 \u805a\u5408\u7ba1\u9053\u9650\u5236\uff1a \u4f7f\u7528 aggregate\u547d\u4ee4\u7684\u805a\u5408\u64cd\u4f5c\u5177\u6709\u4ee5\u4e0b\u9650\u5236 \uff1a 1 . \u7ed3\u679c\u5927\u5c0f\u9650\u5236\uff1a\u6b64 aggregate\u547d\u4ee4\u53ef\u4ee5\u8fd4\u56de\u6e38\u6807\u6216\u5c06\u7ed3\u679c\u5b58\u50a8\u5728\u96c6\u5408\u4e2d \u3002\u76ee\u524d 16 M 2 . \u5185\u5b58\u9650\u5236\uff1a\u7ba1\u9053\u9636\u6bb5\u7684 RAM\u9650\u5236\u4e3a100M \uff0c\u5982\u679c\u67d0\u4e2a\u9636\u6bb5\u8d85\u8fc7\u6b64\u9650\u5236\uff0c\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u5141\u8bb8\u5904\u7406\u5927\u578b\u6570\u636e\u96c6\uff0c\u4f7f\u7528 allowDishUse\u9009\u9879\u5c06\u6570\u636e\u5199\u5165\u5230\u4e34\u65f6\u6587\u4ef6 $ groupLookkup\u9636\u6bb5\u5fc5\u987b\u4fdd\u6301\u5728100M\u7684\u5185\u5b58\u9650\u5236\u4e2d \uff0c\u5982\u679c allowDishUse : true\u6307\u5b9a\u5728aggregate () \u64cd\u4f5c\uff0c$ graphLookup\u9636\u6bb5\u4f1a\u5ffd\u7565\u6b64\u9009\u9879 \u3002\u5982\u679c\u6709\u5176\u4ed6\u9636\u6bb5\u5728 aggregate () \u64cd\u4f5c\u4e2d\uff0c allowDiskUse : true\u9009\u9879\u5c06\u5f71\u54cd\u8fd9\u4e9b\u9636\u6bb5 \u805a\u5408\u7ba1\u9053\u548c\u5206\u7247\u96c6\u5408\uff1a \u5982\u679c\u7ba1\u9053\u7684\u5f00\u59cb\u5728\u5206\u7247\u952e\u6709\u4e00\u4e2a\u786e\u5207\u7684$ match \uff0c\u5219\u6574\u4e2a\u7ba1\u9053\u4ec5\u5728\u5339\u914d\u7684\u5206\u7247\u4e0a\u8fd0\u884c\u3002\u5bf9\u4e8e\u5fc5\u987b\u5728\u591a\u4e2a\u5206\u7247\u4e0a\u8fd0\u884c\u7684\u805a\u5408\u64cd\u4f5c\u3002\u5982\u679c\u64cd\u4f5c\u4e0d\u9700\u8981\u5728\u6570\u636e\u5e93\u4e3b\u5206\u7247\u8fd0\u884c\uff0c\u5219\u8fd9\u4e9b\u64cd\u4f5c\u4f1a\u5c06\u7ed3\u679c\u8def\u7531\u5230\u968f\u673a\u7684\u5206\u7247\u4e0a\u6765\u5408\u5e76\u7ed3\u679c\uff0c\u907f\u514d\u4f7f\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u8d85\u8f7d\u3002$ out\u548c$lookup\u9636\u6bb5\u9700\u8981\u5728\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u4e0a\u8fd0\u884c \u5728\u5c06\u805a\u5408\u7ba1\u9053\u5206\u6210\u4e24\u90e8\u5206\u65f6\uff0c\u7ba1\u9053\u88ab\u62c6\u5206\u4ee5\u786e\u4fdd\u5206\u7247\u5728\u8003\u8651\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684\u9636\u6bb5\uff1b\u4f18\u5316\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7248\u672c\u4e4b\u95f4\u53d1\u751f\u53d8\u5316 Map-Reduce \u00b6 \u805a\u5408\u53c2\u8003 \u00b6 \u805a\u5408\u7ba1\u9053\u5feb\u901f\u53c2\u8003\uff1aStages(db.collection.aggregate)\u9664\u4e86 out\u548c out\u548c geoNear\u9636\u6bb5\u90fd\u53ef\u4ee5\u5728\u7ba1\u9053\u4e2d\u591a\u6b21\u51fa\u73b0 Stages(db.collection.aggregate) \u00b6 \u9636\u6bb5 \u63cf\u8ff0 $addFields \u5411\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\u3002\u7c7b\u4f3c\u4e8e project\uff0c project\uff0c addFields\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863; \u5177\u4f53\u800c\u8a00\uff0c\u901a\u8fc7\u5411\u8f93\u51fa\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u8be5\u6587\u6863\u5305\u542b\u8f93\u5165\u6587\u6863\u7684\u73b0\u6709\u5b57\u6bb5\u548c\u65b0\u6dfb\u52a0\u5b57\u6bb5 $bucket \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u548c\u5b58\u50a8\u533a\u8fb9\u754c\uff0c\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7ec4\uff0c\u79f0\u4e3a\u5b58\u50a8\u6876 $bucketAuto \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7c7b\u4e3a\u7279\u5b9a\u6570\u91cf\u7684\u7ec4\uff08\u79f0\u4e3a\u5b58\u50a8\u6876\uff09\u3002\u81ea\u52a8\u786e\u5b9a\u5b58\u50a8\u6876\u8fb9\u754c\uff0c\u4ee5\u5c1d\u8bd5\u5c06\u6587\u6863\u5747\u5300\u5730\u5206\u914d\u5230\u6307\u5b9a\u6570\u91cf\u7684\u5b58\u50a8\u6876\u4e2d $collStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u6216\u89c6\u56fe\u7684\u7edf\u8ba1\u4fe1\u606f $count \u8fd4\u56de\u805a\u5408\u7ba1\u9053\u6b64\u9636\u6bb5\u7684\u6587\u6863\u6570\u91cf\u8ba1\u6570 $facet \u5728\u540c\u4e00\u7ec4\u8f93\u5165\u6587\u6863\u7684\u5355\u4e2a\u9636\u6bb5\u5185\u5904\u7406\u591a\u4e2a\u805a\u5408\u7ba1\u9053\u3002\u652f\u6301\u521b\u5efa\u80fd\u591f\u5728\u5355\u4e2a\u9636\u6bb5\u4e2d\u8de8\u591a\u4e2a\u7ef4\u5ea6\u6216\u65b9\u9762\u8868\u5f81\u6570\u636e\u7684\u591a\u9762\u805a\u5408 $geoNear \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd match\uff0c match\uff0c sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 $graphLookup \u5bf9\u96c6\u5408\u6267\u884c\u9012\u5f52\u641c\u7d22\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\uff0c\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\u5b57\u6bb5\uff0c\u5176\u4e2d\u5305\u542b\u8be5\u6587\u6863\u7684\u9012\u5f52\u641c\u7d22\u7684\u904d\u5386\u7ed3\u679c\u3002 $group \u6309\u6307\u5b9a\u7684\u6807\u8bc6\u7b26\u8868\u8fbe\u5f0f\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u5c06\u7d2f\u52a0\u5668\u8868\u8fbe\u5f0f\uff08\u5982\u679c\u5df2\u6307\u5b9a\uff09\u5e94\u7528\u4e8e\u6bcf\u4e2a\u7ec4\u3002\u6d88\u8017\u6240\u6709\u8f93\u5165\u6587\u6863\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u4e0d\u540c\u7684\u7ec4\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002\u8f93\u51fa\u6587\u6863\u4ec5\u5305\u542b\u6807\u8bc6\u7b26\u5b57\u6bb5\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u5305\u542b\u7d2f\u79ef\u5b57\u6bb5\u3002 $indexStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u7684\u4f7f\u7528\u7684\u7edf\u8ba1\u4fe1\u606f\u3002 $limit \u5c06\u672a\u4fee\u6539\u7684\u524dn\u4e2a\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u9650\u5236\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u96f6\u6587\u6863\uff08\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $listSessions \u5217\u51fa\u6d3b\u52a8\u65f6\u95f4\u8db3\u4ee5\u4f20\u64ad\u5230system.sessions\u96c6\u5408\u7684\u6240\u6709\u4f1a\u8bdd\u3002 $lookup \u5bf9\u540c\u4e00\u6570\u636e\u5e93\u4e2d\u7684\u53e6\u4e00\u4e2a\u96c6\u5408\u6267\u884c\u5de6\u5916\u8fde\u63a5\uff0c\u4ee5 \u4ece\u201c\u5df2\u8fde\u63a5\u201d\u96c6\u5408\u4e2d\u8fc7\u6ee4\u6587\u6863\u4ee5\u8fdb\u884c\u5904\u7406\u3002 $match \u8fc7\u6ee4\u6587\u6863\u6d41\u4ee5\u4ec5\u5141\u8bb8\u5339\u914d\u7684\u6587\u6863\u672a\u7ecf\u4fee\u6539\u5730\u4f20\u9012\u5230\u4e0b\u4e00\u4e2a\u7ba1\u9053\u9636\u6bb5\u3002 $match\u4f7f\u7528\u6807\u51c6\u7684MongoDB\u67e5\u8be2\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5339\u914d\uff09\u6216\u96f6\u6587\u6863\uff08\u4e0d\u5339\u914d\uff09\u3002 $out \u5c06\u805a\u5408\u7ba1\u9053\u7684\u7ed3\u679c\u6587\u6863\u5199\u5165\u96c6\u5408\u3002\u8981\u4f7f\u7528$out\u821e\u53f0\uff0c\u5b83\u5fc5\u987b\u662f\u7ba1\u9053\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\u3002 $project \u91cd\u65b0\u6574\u5f62\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\uff0c\u4f8b\u5982\u6dfb\u52a0\u65b0\u5b57\u6bb5\u6216\u5220\u9664\u73b0\u6709\u5b57\u6bb5\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $redact \u901a\u8fc7\u57fa\u4e8e\u6587\u6863\u672c\u8eab\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\u9650\u5236\u6bcf\u4e2a\u6587\u6863\u7684\u5185\u5bb9\u6765\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\u3002\u5305\u542b$project\u548c\u7684\u529f\u80fd $match\u3002\u53ef\u7528\u4e8e\u5b9e\u73b0\u5b57\u6bb5\u7ea7\u522b\u7684\u7f16\u8f91\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6216\u96f6\u4e2a\u6587\u6863\u3002 $replaceRoot \u7528\u6307\u5b9a\u7684\u5d4c\u5165\u6587\u6863\u66ff\u6362\u6587\u6863\u3002\u8be5\u64cd\u4f5c\u5c06\u66ff\u6362\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6240\u6709\u73b0\u6709\u5b57\u6bb5\uff0c\u5305\u62ec_id\u5b57\u6bb5\u3002\u6307\u5b9a\u5d4c\u5165\u5728\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6587\u6863\u4ee5\u5c06\u5d4c\u5165\u6587\u6863\u63d0\u5347\u5230\u9876\u5c42\u3002 $sample \u4ece\u8f93\u5165\u4e2d\u968f\u673a\u9009\u62e9\u6307\u5b9a\u6570\u91cf\u7684\u6587\u6863\u3002 $skip \u8df3\u8fc7\u524dn\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u8df3\u8fc7\u7f16\u53f7\uff0c\u5e76\u5c06\u672a\u4fee\u6539\u7684\u5176\u4f59\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u96f6\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u4e00\u4e2a\u6587\u6863\uff08\u5982\u679c\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $sort \u6309\u6307\u5b9a\u7684\u6392\u5e8f\u952e\u91cd\u65b0\u6392\u5e8f\u6587\u6863\u6d41\u3002\u53ea\u6709\u8ba2\u5355\u6539\u53d8; \u6587\u4ef6\u4fdd\u6301\u4e0d\u53d8\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $sortByCount \u6839\u636e\u6307\u5b9a\u8868\u8fbe\u5f0f\u7684\u503c\u5bf9\u4f20\u5165\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u8ba1\u7b97\u6bcf\u4e2a\u4e0d\u540c\u7ec4\u4e2d\u7684\u6587\u6863\u8ba1\u6570\u3002 $unwind \u4ece\u8f93\u5165\u6587\u6863\u89e3\u6784\u6570\u7ec4\u5b57\u6bb5\u4ee5\u8f93\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u6587\u6863\u3002\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\u90fd\u4f7f\u7528\u5143\u7d20\u503c\u66ff\u6362\u6570\u7ec4\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fan\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6570\u7ec4\u5143\u7d20\u7684\u6570\u91cf\uff0c\u5bf9\u4e8e\u7a7a\u6570\u7ec4\uff0c\u53ef\u4ee5\u4e3a\u96f6\u3002 Stages(db.aggregate) \u00b6 MongoDB\u8fd8\u63d0\u4f9bdb.aggregate\u65b9\u6cd5\uff1a \u540d\u79f0 \u63cf\u8ff0 $currentOp \u8fd4\u56de\u6709\u5173MongoDB\u90e8\u7f72\u7684\u6d3b\u52a8 \u548c/\u6216 \u4f11\u7720\u64cd\u4f5c\u7684\u4fe1\u606f $listLocalSessions \u5217\u51fa\u6700\u8fd1\u5728\u5f53\u524d\u8fde\u63a5mongos\u6216mongod\u5b9e\u4f8b\u4e0a\u7684\u6240\u6709\u6d3b\u52a8\u56de\u8bdd\uff0c\u8fd9\u4e9b\u4f1a\u8bdd\u4e0d\u4e00\u5b9a\u90fd\u4f20\u5230system.sessions\u96c6\u5408\u4e2d \u8868\u8fbe\u5f0f\u53ef\u4ee5\u5305\u62ec\u5b57\u6bb5\u8def\u5f84\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u6587\u5b57\uff0c \u8868\u8fbe\u5f0f\u5bf9\u8c61\u548c \u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u3002\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5d4c\u5957 \u5e03\u5c14\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\uff0c\u5e76\u8fd4\u56de\u5e03\u5c14\u503c\u4f5c\u4e3a\u7ed3\u679c\u3002\u9664\u4e86false\u5e03\u5c14\u503c\uff0c\u5e03\u5c14\u8868\u8fbe\u5f0f\u4e3afalse\u5982\u4e0b\uff1anull\uff0c0\uff0c\u548cundefined \u7684\u503c\u3002\u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u6240\u6709\u5176\u4ed6\u503c\u8ba1\u7b97\u4e3atrue\uff0c\u5305\u62ec\u975e\u96f6\u6570\u503c\u548c\u6570\u7ec4 \u540d\u79f0 \u63cf\u8ff0 $and \u4ec5\u5728\u5176\u6240\u6709\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue,\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $not \u8fd4\u56de\u4e0e\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u76f8\u53cd\u7684\u5e03\u5c14\u503c\uff0c\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $or \u5f53\u4efb\u4f55\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue\uff0c\u5141\u8bb8\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f \u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u9664\u4e86$cmp\u8fd4\u56de\u4e00\u4e2a\u6570\u5b57\u3002\u6bd4\u8f83\u8868\u8fbe\u5f0f\u91c7\u7528\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u5e76\u6bd4\u8f83\u503c\u548c\u7c7b\u578b\uff0c\u4f7f\u7528\u6307\u5b9a\u7684BSON\u6bd4\u8f83\u987a\u5e8f\u6765\u8868\u793a\u4e0d\u540c\u7c7b\u578b\u7684\u503c \u540d\u79f0 \u63cf\u8ff0 $cmp \u8fd4\u56de0\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u76f8\u7b49\u7684\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6240\u8ff0\u7b2c\u4e8c\u503c\uff0c\u4ee5\u53ca-1\u6bd4\u6240\u8ff0\u7b2c\u4e8c\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u662f\u4ee5\u4e0b\u3002 $eq \u8fd4\u56detrue\u503c\u662f\u5426\u76f8\u7b49\u3002 $gt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $gte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $ne true\u5982\u679c\u503c\u4e0d\u76f8\u7b49\u5219\u8fd4\u56de\u3002 \u6761\u4ef6\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $cond \u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\uff0c\u7528\u4e8e\u8ba1\u7b97\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u5176\u4ed6\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4e4b\u4e00\u7684\u503c\u3002\u63a5\u53d7\u6709\u5e8f\u5217\u8868\u4e2d\u7684\u4e09\u4e2a\u8868\u8fbe\u5f0f\u6216\u4e09\u4e2a\u547d\u540d\u53c2\u6570\u3002 $ifNull \u5982\u679c\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5bfc\u81f4null\u7ed3\u679c\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u975enull\u7ed3\u679c\u6216\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u7a7a\u7ed3\u679c\u5305\u542b\u672a\u5b9a\u4e49\u503c\u6216\u7f3a\u5c11\u5b57\u6bb5\u7684\u5b9e\u4f8b\u3002\u63a5\u53d7\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u53c2\u6570\u3002\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u53ef\u4ee5\u4e3anull\u3002 $switch \u8bc4\u4f30\u4e00\u7cfb\u5217\u6848\u4f8b\u8868\u8fbe\u3002\u5f53\u5b83\u627e\u5230\u4e00\u4e2a\u6c42\u503c\u7684\u8868\u8fbe\u5f0f\u65f6true\uff0c$switch\u6267\u884c\u4e00\u4e2a\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5e76\u4e2d\u65ad\u63a7\u5236\u6d41\u3002 \u65e5\u671f\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u4ee5\u4e0b\u8fd0\u7b97\u7b26\u8fd4\u56de\u65e5\u671f\u5bf9\u8c61\u6216\u65e5\u671f\u5bf9\u8c61\u7684\u7ec4\u4ef6 \u540d\u79f0 \u63cf\u8ff0 $dateFromParts \u7ed9\u5b9a\u65e5\u671f\u7684\u7ec4\u6210\u90e8\u5206\u6784\u9020BSON Date\u5bf9\u8c61\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToParts \u8fd4\u56de\u5305\u542b\u65e5\u671f\u7ec4\u6210\u90e8\u5206\u7684\u6587\u6863\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $dayOfMonth \u4ee51\u523031\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4e2d\u67d0\u5929\u3002 $dayOfWeek \u8fd4\u56de\u65e5\u671f\u7684\u661f\u671f\u51e0\uff0c\u4f5c\u4e3a1\uff08\u661f\u671f\u65e5\uff09\u548c7\uff08\u661f\u671f\u516d\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $dayOfYear \u4ee51\u5230366\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u65e5\u671f\u3002 $hour \u4ee50\u523023\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5c0f\u65f6\u3002 $isoDayOfWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5de5\u4f5c\u65e5\u7f16\u53f7\uff0c\u8303\u56f4\u4ece 1\uff08\u661f\u671f\u4e00\uff09\u52307\uff08\u661f\u671f\u65e5\uff09\u3002 $isoWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5468\u6570\uff0c\u4ece 1\u523053\u3002\u5468\u6570\u4ece1\u5305\u542b\u5e74\u4efd\u7b2c\u4e00\u4e2a\u661f\u671f\u56db\u7684\u4e00\u5468\uff08\u661f\u671f\u4e00\u5230\u661f\u671f\u65e5\uff09\u5f00\u59cb\u3002 $isoWeekYear \u4ee5ISO 8601\u683c\u5f0f\u8fd4\u56de\u5e74\u4efd\u7f16\u53f7\u3002\u5e74\u4efd\u4ece\u7b2c1\u5468\u7684\u661f\u671f\u4e00\uff08ISO 8601\uff09\u5f00\u59cb\uff0c\u5230\u4e0a\u5468\u7684\u661f\u671f\u65e5\uff08ISO 8601\uff09\u7ed3\u675f\u3002 $millisecond \u4ee50\u5230999\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6beb\u79d2\u6570\u3002 $minute \u4ee50\u523059\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5206\u949f\u3002 $month \u4ee51\uff081\u6708\uff09\u523012\uff0812\u6708\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4efd\u3002 $second \u4ee50\u523060\uff08\u95f0\u79d2\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u79d2\u6570\u3002 $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $week \u8fd4\u56de\u65e5\u671f\u7684\u5468\u6570\uff0c\u4f5c\u4e3a0\uff08\u5728\u4e00\u5e74\u7684\u7b2c\u4e00\u4e2a\u661f\u671f\u65e5\u4e4b\u524d\u7684\u90e8\u5206\u5468\uff09\u548c53\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $year \u4ee5\u6570\u5b57\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u5e74\u4efd\uff08\u4f8b\u59822014\u5e74\uff09\u3002 \u4ee5\u4e0b\u7b97\u672f\u8fd0\u7b97\u7b26\u53ef\u4ee5\u91c7\u7528\u65e5\u671f\u64cd\u4f5c\u6570 \u540d\u79f0 \u63cf\u8ff0 $add \u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\u4ee5\u8fd4\u56de\u65b0\u65e5\u671f\u3002\u5982\u679c\u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\uff0c\u8bf7\u5c06\u6570\u5b57\u89c6\u4e3a\u6beb\u79d2\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f\uff0c\u4f46\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u8868\u8fbe\u5f0f\u89e3\u6790\u4e3a\u65e5\u671f\u3002 $subtract \u8fd4\u56de\u4ece\u7b2c\u4e00\u4e2a\u503c\u4e2d\u51cf\u53bb\u7b2c\u4e8c\u4e2a\u503c\u7684\u7ed3\u679c\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\uff0c\u5219\u8fd4\u56de\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u5dee\u5f02\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u6570\u5b57\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\u65e5\u671f\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u6570\u5b57\uff0c\u8bf7\u9996\u5148\u6307\u5b9a\u65e5\u671f\u53c2\u6570\uff0c\u56e0\u4e3a\u4ece\u6570\u5b57\u4e2d\u51cf\u53bb\u65e5\u671f\u6ca1\u6709\u610f\u4e49\u3002 \u6587\u5b57\u8868\u8fbe\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $literal \u8fd4\u56de\u4e00\u4e2a\u6ca1\u6709\u89e3\u6790\u7684\u503c\u3002\u7528\u4e8e\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u5c06\u5176\u89e3\u91ca\u4e3a\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5c06 literal\u8868\u8fbe\u5f0f\u7528\u4e8e\u4ee5a\u5f00\u5934\u7684\u5b57\u7b26\u4e32\uff0c literal\u8868\u8fbe\u5f0f\u7528\u4e8e\u4ee5a\u5f00\u5934\u7684\u5b57\u7b26\u4e32\uff0c \u4ee5\u907f\u514d\u5c06\u5176\u89e3\u6790\u4e3a\u5b57\u6bb5\u8def\u5f84 \u5bf9\u8c61\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $mergeObjects \u5c06\u591a\u4e2a\u6587\u6863\u5408\u5e76\u4e3a\u4e00\u4e2a\u6587\u6863\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd) $objectToArray \u5c06\u6587\u6863\u8f6c\u6362\u4e3a\u8868\u793a\u952e\u503c\u5bf9\u7684\u6587\u6863\u6570\u7ec4\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd) Set\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 Set\u8868\u8fbe\u5f0f\u5bf9\u6570\u7ec4\u6267\u884cset\u64cd\u4f5c\uff0c\u5c06\u6570\u7ec4\u89c6\u4e3a\u96c6\u5408\u3002Set\u8868\u8fbe\u5f0f\u5ffd\u7565\u6bcf\u4e2a\u8f93\u5165\u6570\u7ec4\u4e2d\u7684\u91cd\u590d\u6761\u76ee\u4ee5\u53ca\u5143\u7d20\u7684\u987a\u5e8f\u3002\u5982\u679cset\u64cd\u4f5c\u8fd4\u56de\u4e00\u4e2aset\uff0c\u5219\u8be5\u64cd\u4f5c\u4f1a\u8fc7\u6ee4\u6389\u7ed3\u679c\u4e2d\u7684\u91cd\u590d\u9879\uff0c\u4ee5\u8f93\u51fa\u4ec5\u5305\u542b\u552f\u4e00\u6761\u76ee\u7684\u6570\u7ec4\u3002\u672a\u6307\u5b9a\u8f93\u51fa\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u987a\u5e8f \u540d\u79f0 \u63cf\u8ff0 $allElementsTrue \u5982\u679c\u96c6\u5408\u7684\u6ca1\u6709\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3afalse\uff0c\u5219\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $anyElementTrue \u5982\u679c\u96c6\u5408\u7684\u4efb\u4f55\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3atrue\uff0c \u5219\u8fd4\u56detrue; \u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setDifference \u8fd4\u56de\u4e00\u4e2a\u96c6\u5408\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e00\u4e2a\u96c6\u5408\u4e2d\u4f46\u4e0d\u5728\u7b2c\u4e8c\u4e2a\u96c6\u5408\u4e2d; \u5373\u6267\u884c\u7b2c\u4e8c\u7ec4\u76f8\u5bf9\u4e8e\u7b2c\u4e00\u7ec4\u7684\u76f8\u5bf9\u8865\u5145\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setEquals \u5982\u679c\u8f93\u5165\u96c6\u5408\u5177\u6709\u76f8\u540c\u7684\u4e0d\u540c\u5143\u7d20\u8fd4\u56detrue\u3002\u63a5\u53d7\u4e24\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setIntersection \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u6240\u6709\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $setIsSubset \u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e8c\u7ec4\u4e2d\u8fd4\u56detrue\uff0c\u5305\u62ec\u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u7b49\u4e8e\u7b2c\u4e8c\u7ec4\u65f6; \u5373\u4e0d\u662f\u4e25\u683c\u7684\u5b50\u96c6\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setUnion \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u4efb\u4f55\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408 String\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u65e0\u8bba\u4f7f\u7528\u4ec0\u4e48\u5b57\u7b26\uff0c$concat\u884c\u4e3a\u90fd\u662f\u660e\u786e\u5b9a\u4e49\u7684 \u540d\u79f0 \u63cf\u8ff0 $concat \u8fde\u63a5\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\u4e32\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $indexOfBytes \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u5b57\u8282\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1\u3002 $indexOfCP \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u4ee3\u7801\u70b9\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1 $ltrim \u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $rtrim \u4ece\u5b57\u7b26\u4e32\u672b\u5c3e\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $split \u6839\u636e\u5206\u9694\u7b26\u5c06\u5b57\u7b26\u4e32\u62c6\u5206\u4e3a\u5b50\u5b57\u7b26\u4e32\u3002\u8fd4\u56de\u4e00\u4e2a\u5b50\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u5982\u679c\u5728\u5b57\u7b26\u4e32\u4e2d\u627e\u4e0d\u5230\u5206\u9694\u7b26\uff0c\u5219\u8fd4\u56de\u5305\u542b\u539f\u59cb\u5b57\u7b26\u4e32\u7684\u6570\u7ec4\u3002 $strLenBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8\u7f16\u7801\u5b57\u8282\u7684\u6570\u91cf\u3002 $strLenCP \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8 \u4ee3\u7801\u70b9\u7684\u6570\u91cf\u3002 $strcasecmp \u6267\u884c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u5e76\u8fd4\u56de\uff1a 0\u5982\u679c\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u540c\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5927\u4e8e\u7b2c\u4e8c\u4e2a-1\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002 $substr \u5df2\u8fc7\u65f6\u3002\u4f7f\u7528$substrBytes\u6216 $substrCP\u3002 $substrBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ece\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8\u5b57\u8282\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u5b57\u8282\u6570\u3002 $substrCP \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ee5\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8 \u4ee3\u7801\u70b9\uff08CP\uff09\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5904\u7684\u5b57\u7b26\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u4ee3\u7801\u70b9\u6570\u3002 $toLower \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002 $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) \u6587\u672c\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $meta \u8bbf\u95ee\u6587\u672c\u641c\u7d22\u5143\u6570\u636e Type\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $convert \u5c06\u503c\u8f6c\u6362\u4e3a\u6307\u5b9a\u7684\u7c7b\u578b\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toBool \u5c06\u503c\u8f6c\u6362\u4e3a\u5e03\u5c14\u503c\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDecimal \u5c06\u503c\u8f6c\u6362\u4e3aDecimal128\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDouble \u5c06\u503c\u8f6c\u6362\u4e3adouble\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toInt \u5c06\u503c\u8f6c\u6362\u4e3a\u6574\u6570\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toLong \u5c06\u503c\u8f6c\u6362\u4e3along\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toObjectId \u5c06\u503c\u8f6c\u6362\u4e3aObjectId\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $type \u8fd4\u56de\u8be5\u5b57\u6bb5\u7684BSON\u6570\u636e\u7c7b\u578b(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) Accumulators(\u7d2f\u52a0\u5668)($group) \u00b6 \u53ef\u4ee5\u5728 group\u9636\u6bb5\u4f7f\u7528\uff0c\u5176\u662f\u5728\u6587\u6863\u901a\u8fc7\u7ba1\u9053\u65f6\u4fdd\u6301\u5176\u72b6\u6001(\u5982\uff1a\u603b\u6570\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u548c\u76f8\u5173\u6570\u636e)\u7684\u8fd0\u7b97\u7b26\u3002\u5f53\u5728 group\u9636\u6bb5\u4f7f\u7528\uff0c\u5176\u662f\u5728\u6587\u6863\u901a\u8fc7\u7ba1\u9053\u65f6\u4fdd\u6301\u5176\u72b6\u6001(\u5982\uff1a\u603b\u6570\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u548c\u76f8\u5173\u6570\u636e)\u7684\u8fd0\u7b97\u7b26\u3002\u5f53\u5728 group\u9636\u6bb5\u4e2d\u4f5c\u4e3a\u7d2f\u52a0\u5668\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5c06\u5355\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u8f93\u5165\uff0c\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u8ba1\u7b97\u4e00\u6b21\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e3a\u5171\u4eab\u76f8\u540c\u7ec4\u5bc6\u94a5\u7684\u6587\u6863\u7ec4\u4fdd\u6301\u5176\u9636\u6bb5 \u540d\u79f0 \u63cf\u8ff0 $addToSet \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u552f\u4e00\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4\u3002\u6570\u7ec4\u5143\u7d20\u7684\u987a\u5e8f\u672a\u5b9a\u4e49 $avg \u8fd4\u56de\u6570\u503c\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $first \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\u4e2d\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $last \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u6587\u6863\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $max \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u9ad8\u8868\u8fbe\u5f0f\u503c $mergeObjects \u8fd4\u56de\u901a\u8fc7\u7ec4\u5408\u6bcf\u4e2a\u7ec4\u7684\u8f93\u5165\u6587\u6863\u521b\u5efa\u7684\u6587\u6863 $min \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u4f4e\u8868\u8fbe\u5f0f\u503c $push \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4 $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c Accumulators(\u7d2f\u52a0\u5668)( project\u548c project\u548c addFields) \u00b6 \u4e00\u4e9b\u53ef\u7528\u7528\u4f5c group\u9636\u6bb5\u7684\u7d2f\u52a0\u5668\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u7528\u4e8e group\u9636\u6bb5\u7684\u7d2f\u52a0\u5668\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u7528\u4e8e project\u548c addFields\u9636\u6bb5\uff0c\u4f46\u4e0d\u80fd\u7528\u4f5c\u7d2f\u52a0\u5668\u3002\u5728 addFields\u9636\u6bb5\uff0c\u4f46\u4e0d\u80fd\u7528\u4f5c\u7d2f\u52a0\u5668\u3002\u5728 project\u548c$addFields\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u4e0d\u4f1a\u4fdd\u6301\u5176\u72b6\u6001\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5355\u4e2a\u53c2\u6570\u6216\u591a\u4e2a\u53c2\u6570\u4f5c\u4e3a\u8f93\u5165\u3002 \u540d\u79f0 \u63cf\u8ff0 $avg \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $max \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5927\u503c $min \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5c0f\u503c $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c \u53d8\u91cf\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26 \u00b6 \u540d\u79f0 \u63cf\u8ff0 $let \u5b9a\u4e49\u5728\u5b50\u8868\u8fbe\u5f0f\u8303\u56f4\u5185\u4f7f\u7528\u7684\u53d8\u91cf\uff0c\u5e76\u8fd4\u56de\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u63a5\u53d7\u547d\u540d\u53c2\u6570\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f \u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u7d22\u5f15 aggregation-commands(\u805a\u5408\u547d\u4ee4) \u00b6 \u805a\u5408\u547d\u4ee4 \u00b6 \u540d\u79f0 \u63cf\u8ff0 aggregate \u4f7f\u7528\u805a\u5408\u6846\u67b6\u6267\u884c\u805a\u5408\u4efb\u52a1\uff0c\u4f8b\u5982\u7ec4 count \u8ba1\u7b97\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6587\u6863\u6570 distinct \u663e\u793a\u4e3a\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6307\u5b9a\u952e\u627e\u5230\u7684\u4e0d\u540c\u503c group \u4e0d\u63a8\u8350\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 mapReduce \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408 \u805a\u5408\u65b9\u6cd5 \u00b6 \u540d\u79f0 \u63cf\u8ff0 \u540d\u79f0 \u63cf\u8ff0 db.collection.aggregate() \u63d0\u4f9b\u5bf9\u805a\u5408\u7ba1\u9053\u7684\u8bbf\u95ee db.collection.group() \u5df2\u8fc7\u65f6\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 db.collection.mapReduce() \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408 \u805a\u5408\u8868\u8fbe\u5f0f\u4e2d\u7684\u53d8\u91cf \u00b6 \u805a\u5408\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u53d8\u91cf\u53ef\u4ee5\u4fdd\u5b58\u4efb\u4f55BSON\u7c7b\u578b\u7684\u6570\u636e\u3002\u8981\u8bbf\u95ee\u53d8\u91cf\u7684\u503c\uff0c\u4f7f\u7528\u5e26\u6709\u524d\u7f00\u53ccdollar\u7b26( )\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" )\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" <span><span class=\"MathJax_Preview\">)\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\"</span><script type=\"math/tex\">)\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" . \"\u8868\u793a\u6cd5 \u7528\u6237\u53d8\u91cf \u00b6 \u7528\u6237\u53d8\u91cf\u540d\u79f0\u53ef\u4ee5\u5305\u542bASCII\u5b57\u7b26[_a-zA-Z0-9]\u548c\u4efb\u4f55\u975eASCII\u5b57\u7b26\uff0c\u7528\u6237\u53d8\u91cf\u540d\u5fc5\u987b\u4ee5\u5c0f\u5199\u7684ASCII\u5b57\u7b26[a-z]\u6216\u975eASCII\u5b57\u7b26\u5f00\u5934 \u7cfb\u7edf\u53d8\u91cf \u00b6 \u53d8\u91cf \u63cf\u8ff0 ROOT \u5f15\u7528\u5f53\u524d\u6b63\u5728\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u5904\u7406\u7684\u6839\u6587\u6863\uff0c\u5373\u9876\u7ea7\u6587\u6863 CURRENT \u5f15\u7528\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u4e2d\u6b63\u5728\u5904\u7406\u7684\u5b57\u6bb5\u8def\u5f84\u7684\u5f00\u59cb\u3002\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u6240\u6709\u9636\u6bb5\u90fd\u4ee5CURRENT\u76f8\u540c\u7684 \u65b9\u5f0f\u5f00\u5934ROOT CURRENT\u662f\u53ef\u4ee5\u4fee\u6539\u7684\u3002\u4f46\u662f\uff0c\u7531\u4e8e <field> \u7b49\u540c\u4e8e <field> \u7b49\u540c\u4e8e CURRENT.<field>\uff0c\u91cd\u65b0\u7ed1\u5b9a\u4f1aCURRENT\u6539\u53d8 CURRENT.<field>\uff0c\u91cd\u65b0\u7ed1\u5b9a\u4f1aCURRENT\u6539\u53d8 \u8bbf\u95ee\u7684\u542b\u4e49 REMOVE \u4e00\u4e2a\u8ba1\u7b97\u7f3a\u5931\u503c\u7684\u53d8\u91cf\u3002\u5141\u8bb8\u6761\u4ef6\u6392\u9664\u5b57\u6bb5\u3002\u5728a\u4e2d$projection\uff0cREMOVE\u4ece\u8f93\u51fa\u4e2d\u6392\u9664\u8bbe\u7f6e\u4e3a\u53d8\u91cf\u7684\u5b57\u6bb5 \u6709\u5173\u5176\u7528\u6cd5\u7684\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6709\u6761\u4ef6\u6392\u9664\u5b57\u6bb5 \u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd DESCEND $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 PRUNE $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 KEEP $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 SQL\u548caggregation(\u805a\u5408)\u7684\u6bd4\u8f83 \u00b6 sql-aggregation \u6570\u636e\u6a21\u578b \u00b6 \u521b\u5efa\u7d22\u5f15\u5e94\u8003\u8651\u4ee5\u4e0b\uff1a * \u6bcf\u4e2a\u7d22\u5f15\u81f3\u5c11\u5360\u75288kb\u7684\u6570\u636e\u7a7a\u95f4 * \u6dfb\u52a0\u7d22\u5f15\u4f1a\u5bf9\u5199\u5165\u64cd\u4f5c\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\uff0c\u56e0\u6bcf\u4e2a\u63d2\u5165\u4e5f\u5fc5\u987b\u66f4\u65b0\u7d22\u5f15 * \u5177\u6709\u9ad8\u8bfb\u5199\u6bd4\u7387\u7684\u96c6\u5408\u901a\u5e38\u53d7\u76ca\u4e8e\u5176\u4ed6\u7d22\u5f15\uff0c\u7d22\u5f15\u4e0d\u5f71\u54cd\u672a\u521b\u5efa\u7d22\u5f15\u7684\u64cd\u4f5c * \u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u5185\u5b58 Transactions \u00b6 \u53ef\u4ee5\u8de8\u591a\u4e2a\u64cd\u4f5c\u3001\u96c6\u5408\u3001\u6570\u636e\u5e93\u548c\u6587\u6863\u4f7f\u7528\u591a\u6587\u6863\u4e8b\u52a1 \u591a\u6587\u6863\u4e8b\u52a1\u662f\u539f\u5b50\u6027\u7684\uff1a * \u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u88ab\u4fdd\u5b58\u5e76\u5728\u4e8b\u52a1\u5916\u90e8\u53ef\u89c1\uff0c\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u524d\uff0c\u4e8b\u52a1\u4e2d\u53d1\u751f\u7684\u6570\u636e\u66f4\u6539\u4e8b\u52a1\u5916\u90e8\u4e0d\u53ef\u89c1\u3002 * \u4e8b\u52a1\u4e2d\u6b62\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u4f1a\u88ab\u4e22\u5f03\u4f46\u4e0d\u4f1a\u4e0d\u53ef\u89c1 \u7d22\u5f15 \u00b6 \u7d22\u5f15\u7684\u6392\u5e8f\u652f\u6301\u6709\u6548\u7684\u7b49\u5f0f\u5339\u914d\u548c\u57fa\u4e8e\u8303\u56f4\u7684\u67e5\u8be2\u64cd\u4f5c\uff0cmongodb\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u4e2d\u7684\u987a\u5e8f\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c \u5206\u7247\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u4e0d\u5c06_id\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u786e\u4fdd_id\u5b57\u6bb5\u503c\u7684\u552f\u4e00\u6027\u4ee5\u9632\u51fa\u9519 \u7d22\u5f15\u7c7b\u578b \u00b6 \u5355\u5b57\u6bb5\u7d22\u5f15\uff1a\u5bf9\u4e8e\u5355\u5b57\u6bb5\u7d22\u5f15\u548c\u6392\u5e8f\u64cd\u4f5c\uff0c\u7d22\u5f15\u952e\u7684\u6392\u5e8f\u987a\u5e8f\u65e0\u5173\u7d27\u8981 \u590d\u5408\u7d22\u5f15\uff1aMongoDB\u652f\u6301\u591a\u5b57\u6bb5\u7684\u7528\u6237\u5b9a\u4e49\u7d22\u5f15\uff0c\u590d\u5408\u7d22\u5f15\u4e2d\u5b57\u6bb5\u7684\u987a\u5e8f\u5177\u6709\u91cd\u8981\u610f\u4e49 \u591a\u952e\u7d22\u5f15\uff1aMongoDB\u4f7f\u7528\u591a\u952e\u7d22\u5f15\u6765\u7d22\u5f15\u5b58\u50a8\u5728\u6570\u7ec4\u4e2d\u7684\u5185\u5bb9\uff0c\u5982\u679c\u7d22\u5f15\u5305\u542b\u6570\u7ec4\u7684\u5b57\u6bb5\uff0c\u5219\u4f1a\u4e3a\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u521b\u5efa\u5355\u72ec\u7684\u7d22\u5f15\u6761\u76ee\u3002 \u5730\u7406\u7a7a\u95f4\u7d22\u5f15\uff1amongodb\u63d0\u4f9b\u4e24\u4e2a\u7279\u6b8a\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5730\u7406\u7a7a\u95f4\u5750\u6807\u6570\u636e\u7684\u67e5\u8be2\uff0c2d\u7d22\u5f15\u4f7f\u7528\u5e73\u9762\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c\uff1b2dsphere\u7d22\u5f15\u4f7f\u7528\u7403\u5f62\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c \u6587\u672c\u7d22\u5f15\uff1amongodb\u63d0\u4f9btext\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5b57\u7b26\u4e32\u67e5\u8be2 \u6563\u5217\u7d22\u5f15\uff1aMongoDB\u63d0\u4f9b\u6563\u5217\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u57fa\u4e8e\u6563\u5217\u7684\u5206\u7247\uff0c\u8be5\u7c7b\u578b\u7d22\u5f15\u662f\u4e00\u4e2a\u5b57\u6bb5\u503c\u7684hash\uff0c\u7d22\u5f15\u5728\u5176\u8303\u56f4\u5185\u6709\u76f8\u5f53\u591a\u968f\u673a\u503c\u5206\u914d\uff0c\u4ec5\u652f\u6301\u76f8\u7b49\u5339\u914d\u4e0d\u652f\u6301\u8303\u56f4\u67e5\u8be2 \u7d22\u5f15\u5c5e\u6027 \u00b6 \u7d22\u5f15\u5177\u6709\u552f\u4e00\u6027\uff0cMongoDB\u62d2\u7edd\u7d22\u5f15\u5b57\u6bb5\u7684\u91cd\u590d\u503c\uff0c\u552f\u4e00\u7d22\u5f15\u53ef\u4e0e\u5176\u4ed6MongoDB\u7d22\u5f15\u4e92\u6362 \u90e8\u5206\u7d22\u5f15\u4ec5\u7d22\u5f15\u7b26\u5408\u6307\u5b9a\u8fc7\u6ee4\u5668\u8868\u8fbe\u5f0f\u7684\u96c6\u5408\u4e2d\u7684\u6587\u6863 \u7d22\u5f15\u7684\u7a00\u758f\u5c5e\u6027\u53ef\u786e\u4fdd\u7d22\u5f15\u4ec5\u5305\u542b\u5177\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863\u7684\u6761\u76ee\u3002\u7d22\u5f15\u4f1a\u8df3\u8fc7\u6ca1\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863 TTL\u7d22\u5f15\u662fMongoDB\u53ef\u7528\u4e8e\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\u7684\u7279\u6b8a\u7d22\u5f15\u3002\u8fd9\u5bf9\u4e8e\u67d0\u4e9b\u7c7b\u578b\u7684\u4fe1\u606f\u975e\u5e38\u7406\u60f3\uff0c\u4f8b\u5982\u673a\u5668\u751f\u6210\u7684\u4e8b\u4ef6\u6570\u636e\uff0c\u65e5\u5fd7\u548c\u4f1a\u8bdd\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ea\u9700\u8981\u5728\u6570\u636e\u5e93\u4e2d\u6301\u7eed\u6709\u9650\u7684\u65f6\u95f4 \u6587\u672c\u7d22\u5f15 \u00b6 \u4e00\u4e2a\u96c6\u5408\u5bf9\u591a\u53ea\u80fd\u6709\u4e00\u4e2atext\u7d22\u5f15,\u5bf9\u4e8etext\u7d22\u5f15\uff0c\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\u8868\u793a\u5b57\u6bb5\u76f8\u5bf9\u4e8e\u5176\u4ed6\u7d22\u5f15\u5b57\u6bb5\u5728\u6587\u672c\u641c\u7d22\u5206\u6570\u65b9\u9762\u7684\u91cd\u8981\u6027\uff0c\u5bf9\u4e8e\u6587\u6863\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u5b57\u6bb5\uff0cMongoDB\u5c06\u5339\u914d\u6570\u4e58\u4ee5\u6743\u91cd\u5e76\u5c06\u7ed3\u679c\u76f8\u52a0\u3002\u4f7f\u7528\u6b64\u603b\u548c\uff0cMongoDB\u7136\u540e\u8ba1\u7b97\u6587\u6863\u7684\u5206\u6570\u3002\u7d22\u5f15\u5b57\u6bb5\u7684\u9ed8\u8ba4\u6743\u91cd\u4e3a1\u3002\u8981\u8c03\u6574\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\uff0c\u8bf7weights\u5728db.collection.createIndex()\u65b9\u6cd5\u4e2d\u5305\u542b\u8be5\u9009\u9879 db.collection.createIndex( { field: \"text\" } ) text\u5728\u591a\u4e2a\u5b57\u6bb5\u4e0a\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\uff08 **\uff09\u3002\u4f7f\u7528\u901a\u914d\u7b26\u6587\u672c\u7d22\u5f15\uff0cMongoDB\u4f1a\u4e3a\u5305\u542b\u96c6\u5408\u4e2d\u6bcf\u4e2a\u6587\u6863\u7684\u5b57\u7b26\u4e32\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7f16\u5236\u7d22\u5f15\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\u521b\u5efa\u6587\u672c\u7d22\u5f15 db.collection.createIndex( { \" **\uff09\u3002\u4f7f\u7528\u901a\u914d\u7b26\u6587\u672c\u7d22\u5f15\uff0cMongoDB\u4f1a\u4e3a\u5305\u542b\u96c6\u5408\u4e2d\u6bcf\u4e2a\u6587\u6863\u7684\u5b57\u7b26\u4e32\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7f16\u5236\u7d22\u5f15\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\u521b\u5efa\u6587\u672c\u7d22\u5f15 db.collection.createIndex( { \" **\": \"text\" } ) \u6307\u5b9atext\u7d22\u5f15\u540d\u79f0\uff1a\u7d22\u5f15\u7684\u9ed8\u8ba4\u540d\u79f0\u7531\u6bcf\u4e2a\u7d22\u5f15\u540d\u79f0\u52a0_text\u7ec4\u6210\uff0c\u53ef\u81ea\u5b9a\u4e49\u7d22\u5f15\u540d\u79f0;db.collection.createIndex( { content: \"text\", \"user.comments\": \"text\"}, { name: \"myTextName\"} ) \u7528\u6743\u91cd\u63a7\u5236\u641c\u7d22\u7ed3\u679c\uff1a\u4ee5\u4e0b\u4e3a\u8bbe\u7f6econtent\u548ckeywords\u7d22\u5f15\u6743\u91cd\u5206\u522b\u4e3a10\u548c5\uff0cabout\u9ed8\u8ba4\u4e3a1 db.blog.createIndex( content: \"text\", keywords: \"text\", about: \"text\" }, { weights: { content: 10, keywords: 5 }, name: \"TextIndex\" } ) \u9650\u5236\u6587\u6863\u626b\u63cf\u6570\u91cf\uff1a\u6587\u6863\u7ed3\u6784\u5982\u4e0b { _id : 1 , dept : \"tech\" , description : \"lime green computer\" } { _id : 2 , dept : \"tech\" , description : \"wireless red mouse\" } { _id : 3 , dept : \"kitchen\" , description : \"green placemat\" } { _id : 4 , dept : \"kitchen\" , description : \"red peeler\" } { _id : 5 , dept : \"food\" , description : \"green apple\" } { _id : 6 , dept : \"food\" , description : \"red potato\" } db.in \u5b89\u5168 \u00b6 Change Streams \u00b6 \u590d\u5236(Replication) \u00b6 \u5206\u7247(Sharding) \u00b6 \u7ba1\u7406(Administration) \u00b6 \u5b58\u50a8\u5f15\u64ce(Storage) \u00b6 MongoDB\u2192kafka \u00b6 Debezium\u7684MongoDB Connector\u53ef\u4ee5\u76d1\u89c6MongoDB\u526f\u672c\u96c6\u6216MongoDB\u5206\u7247\u96c6\u7fa4 \uff1b MongoDB\u590d\u5236\u7684\u5de5\u4f5c\u539f\u7406\u662f\u8ba9Master\u8bb0\u5f55\u5176oplog \uff08\u6216\u64cd\u4f5c\u65e5\u5fd7\uff09\u4e2d\u7684\u66f4\u6539\uff0c\u7136\u540e\u6bcf\u4e2a Slave\u8282\u70b9\u8bfb\u53d6\u4e3b\u8981\u7684oplog\u5e76\u6309\u987a\u5e8f\u5e94\u7528\u6240\u6709\u64cd\u4f5c\u5230\u4ed6\u4eec\u81ea\u5df1\u7684\u6587\u6863 \u3002\u5c06\u65b0\u670d\u52a1\u5668\u6dfb\u52a0\u5230\u526f\u672c\u96c6\u65f6\uff0c\u8be5\u670d\u52a1\u5668\u9996\u5148\u6267\u884c\u521d\u59cb\u540c\u6b65\u4e3b\u6570\u636e\u5e93\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93\u548c\u96c6\u5408\uff0c\u7136\u540e\u8bfb\u53d6\u4e3b\u6570\u636e\u5e93\u7684 oplog\u4ee5\u5e94\u7528\u81ea\u5f00\u59cb\u540c\u6b65\u4ee5\u6765\u53ef\u80fd\u5df2\u7ecf\u8fdb\u884c\u7684\u6240\u6709\u66f4\u6539 \u3002\u8fd9\u4e2a\u65b0\u670d\u52a1\u5668\u5728\u8d76\u4e0a Master\u8282\u70b9oplog\u7684\u5c3e\u90e8\u65f6\u6210\u4e3aSlave\u670d\u52a1\u5668 \uff08\u5e76\u4e14\u80fd\u591f\u5904\u7406\u67e5\u8be2\uff09 Debezium MongoDB Connector\u4f7f\u7528\u76f8\u540c\u7684\u590d\u5236\u673a\u5236 \uff0c\u4f46\u5b83\u5b9e\u9645\u4e0a\u5e76\u4e0d\u6210\u4e3a\u526f\u672c\u96c6\u7684\u6210\u5458\uff0c Connector\u59cb\u7ec8\u8fde\u63a5\u526f\u672c\u96c6\u7684\u4e3b\u8282\u70b9\u6765\u8ddf\u8e2aoplog \uff0c MongoDB\u91cd\u65b0\u9009\u4e3e\u4e3b\u8282\u70b9\u540e \uff0c Connector\u4f1a\u81ea\u52a8\u5207\u6362\u5230\u65b0\u7684\u4e3b\u8282\u70b9 \u3002 Connector\u4f1a\u8bb0\u5f55oplog\u7684\u4f4d\u7f6e \uff0c\u6765\u5b9e\u73b0\u589e\u91cf\u540c\u6b65\u3002 Debezium MongoDB Connector\u548c\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6 \uff0c\u53ea\u9700\u5c06\u526f\u672c\u96c6\u7684\u5730\u5740\u4f5c\u4e3a Connector\u7684seed\u5730\u5740mongodb . hosts\u5373\u53ef \u3002 Connector\u4f7f\u7528seed\u8fde\u63a5\u526f\u672c\u96c6 \uff0c\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u6210\u5458\u96c6\u53ca\u786e\u5b9a\u4e3b\u8282\u70b9\u540e\u3002 Connector\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u5e76\u4ece\u5176oplog\u6355\u83b7\u66f4\u6539 \u3002 Connector\u548c\u5206\u7247\u96c6\u7fa4\u4e00\u8d77\u4f7f\u7528\u65f6 \uff0c\u4f7f\u7528 config\u670d\u52a1\u5668\u7684\u5730\u5740\u914d\u7f6eConnector\u8fde\u63a5 \u3002\u9488\u5bf9\u5206\u7247\u7fa4\u96c6\u8fd0\u884c\u8fde\u63a5\u5668\u65f6\uff0c\u8bf7\u4f7f\u7528 tasks . max\u5927\u4e8e\u526f\u672c\u96c6\u6570\u91cf\u7684\u503c , \u8fd9\u5c06\u5141\u8bb8\u8fde\u63a5\u5668\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\uff0c\u5e76\u8ba9 Kafka Connect\u5728\u6240\u6709\u53ef\u7528\u7684\u5de5\u4f5c\u8fdb\u7a0b\u4e2d\u534f\u8c03 \uff0c\u5206\u53d1\u548c\u7ba1\u7406\u4efb\u52a1 mongodb . name \uff0c\u5b83\u5145\u5f53 MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u7684\u903b\u8f91\u540d\u79f0 , \u8fde\u63a5\u5668\u4ee5\u591a\u79cd\u65b9\u5f0f\u4f7f\u7528\u903b\u8f91\u540d\u79f0\uff1a\u4f5c\u4e3a\u6240\u6709\u4e3b\u9898\u540d\u79f0\u7684\u524d\u7f00\uff0c\u4ee5\u53ca\u8bb0\u5f55\u6bcf\u4e2a\u526f\u672c\u96c6\u7684 oplog\u4f4d\u7f6e\u65f6\u7684\u552f\u4e00\u6807\u8bc6\u7b26 \u3002 topics name \u00b6 Connector\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\u7684insert \u3001 update \u3001 delete\u6587\u6863\u64cd\u4f5c\u5199\u5165\u4e8b\u4ef6\u5230\u6bcf\u4e2akafka topic \u3002 kafka topic\u7684\u540d\u5b57\u89c4\u5219logicalName . databaseName . collectionName \uff0c logicalName\u662f\u914d\u7f6e\u5c5e\u6027mongodb . name\u6307\u5b9a\u7684\u8fde\u63a5\u5668\u7684\u540d\u79f0 , databaseName\u662f\u53d1\u751f\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u540d\u79f0 , collectionName\u662f\u53d7\u5f71\u54cd\u6587\u6863\u6240\u5728\u7684MongoDB\u96c6\u5408\u7684\u540d\u79f0 \u3002\u4f8b\u5982\uff1a MongoDB\u6570\u636e\u5e93inventory\u5305\u542b\u56db\u4e2a\u96c6\u5408 \uff1a products , product_on_hand , customers , orders \u3002\u5047\u8bbe\u76d1\u89c6\u6b64\u6570\u636e\u5e93\u7684\u8fde\u63a5\u5668\u903b\u8f91\u540d\u79f0\u662f fulfillment \uff0c\u5219\u8fde\u63a5\u5668\u751f\u6210\u7684\u56db\u4e2a kafka topic\u4e8b\u4ef6\u4e3a \uff1a fulfillment . inventory . products fulfillment . inventory . products_on_hand fulfillment . inventory . customers fulfillment . inventory . orders Partitions \u00b6 MongoDB\u8fde\u63a5\u5668\u4e0d\u4f1a\u660e\u786e\u786e\u5b9a\u4e8b\u4ef6\u7684topic\u5206\u533a , \u76f8\u53cd\uff0c\u5b83\u5141\u8bb8 Kafka\u6839\u636e\u5bc6\u94a5\u786e\u5b9a\u5206\u533a \u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 Kafka Connect\u5de5\u4f5c\u7a0b\u5e8f\u914d\u7f6e\u4e2d\u5b9a\u4e49Partitioner\u5b9e\u73b0\u7684\u540d\u79f0\u6765\u66f4\u6539Kafka\u7684\u5206\u533a\u903b\u8f91 \u3002 Events \u00b6 MongoDB\u8fde\u63a5\u5668\u751f\u6210\u7684\u6570\u636e\u66f4\u6539\u4e8b\u4ef6\u90fd\u6709\u4e00\u4e2akey\u548cvalue \u3002\u4e0b\u9762\u6982\u8ff0\u4e86\u8fd9\u4e9b key\u548cvalue\u7684\u7ed3\u6784 \u4ece kafka0 . 10 \u5f00\u59cb\uff0c\u53ef\u4ee5\u4f7f\u7528\u6d88\u606f\u5bc6\u94a5\u8fdb\u884c\u8bb0\u5f55\u5e76\u521b\u5efa\u6d88\u606f\u7684\u65f6\u95f4\u6233 ( \u7531\u751f\u4ea7\u8005\u8bb0\u5f55 ) \u6216\u7531 kafka\u5199\u5165\u65e5\u5fd7\u7684\u503c\u8fdb\u884c\u8bc4\u4f30 \u5982\u679c\u4e8b\u4ef6\u7684\u6765\u6e90\u5728\u7ed3\u6784\u4e0a\u53d1\u751f\u53d8\u5316\u6216\u8fde\u63a5\u5668\u6539\u53d8\uff0c\u4e8b\u4ef6\u7684\u7ed3\u6784\u53ef\u80fd\u4f1a\u968f\u7740\u65f6\u95f4\u63a8\u79fb\u800c\u53d1\u751f\u53d8\u5316\u3002\u5bf9\u4e8e\u6d88\u8d39\u8005\u53ef\u80fd\u5f88\u96be\u5904\u7406\u3002\u56e0\u6b64 kafka\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u81ea\u6210\u4e00\u4f53 \uff0c\u6bcf\u4e2a\u6d88\u606f\u952e\u503c\u90fd\u6709\u4e24\u90e8\u5206 : a schema\u548cpayload \u3002\u5f53 payload\u5305\u542b\u6570\u636e\u65f6 \uff0c schema\u63cf\u8ff0payload\u7684\u7ed3\u6784 \u3002 \u66f4\u6539\u4e8b\u4ef6\u7684 key \uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u96c6\u5408\uff0c\u66f4\u6539\u4e8b\u4ef6\u7684 key\u5c06\u662f\u5305\u542b\u5355\u4e2aid\u5b57\u6bb5\u7684\u7ed3\u6784 \u3002\u5b83\u7684\u503c\u662f\u6587\u6863\u7684\u6807\u8bc6\u7b26\u8868\u793a\u4e3a\u5b57\u7b26\u4e32\u3002 MongoDB\u4e0d\u53ef\u7528\u65f6\uff0c\u91cd\u65b0\u5c1d\u8bd5\u8fde\u63a5\u7531\u4e09\u4e2a\u5c5e\u6027\u63a7\u5236\uff1a connect.backoff.initial.delay.ms -- \u7b2c\u4e00\u6b21\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09 connect.backoff.max.delay.ms --- \u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u6700\u5927\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09 connect.max.attempts ------------ \u4ea7\u751f\u9519\u8bef\u4e4b\u524d\u7684\u6700\u5927\u5c1d\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a16 Connector\u5c5e\u6027 \u00b6 \u5c5e\u6027 \u9ed8\u8ba4 \u63cf\u8ff0 name \u8fde\u63a5\u5668\u7684\u552f\u4e00\u540d\u79f0\u3002\u5c1d\u8bd5\u518d\u6b21\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u6ce8\u518c\u5c06\u5931\u8d25\u3002\uff08\u6240\u6709Kafka Connect\u8fde\u63a5\u5668\u90fd\u9700\u8981\u6b64\u5c5e\u6027\u3002\uff09 connector.class \u8fde\u63a5\u5668\u7684Java\u7c7b\u7684\u540d\u79f0\u3002\u59cb\u7ec8\u4f7f\u7528io.debezium.connector.mongodb.MongoDbConnectorMongoDB\u8fde\u63a5\u5668\u7684\u503c\u3002 mongodb.hosts \u526f\u672c\u96c6\u4e2dMongoDB\u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\uff08\u683c\u5f0f\u4e3a\u201chost\u201d\u6216\u201chost\uff1aport\u201d\uff09\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u8be5\u5217\u8868\u53ef\u4ee5\u5305\u542b\u5355\u4e2a\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\u3002\u5982\u679cmongodb.members.auto.discover\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u4e3b\u673a\u548c\u7aef\u53e3\u5bf9\u5e94\u4ee5\u526f\u672c\u96c6\u540d\u79f0\u4e3a\u524d\u7f00\uff08\u4f8b\u5982\uff0crs0/localhost:27017\uff09\u3002 mongodb.name \u4e00\u4e2a\u552f\u4e00\u540d\u79f0\uff0c\u7528\u4e8e\u6807\u8bc6\u6b64\u8fde\u63a5\u5668\u76d1\u89c6\u7684\u8fde\u63a5\u5668\u548c/\u6216MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u3002\u6bcf\u4e2a\u670d\u52a1\u5668\u6700\u591a\u5e94\u7531\u4e00\u4e2aDebezium\u8fde\u63a5\u5668\u76d1\u63a7\uff0c\u56e0\u4e3a\u6b64\u670d\u52a1\u5668\u540d\u79f0\u524d\u7f00\u662fMongoDB\u526f\u672c\u96c6\u6216\u96c6\u7fa4\u53d1\u51fa\u7684\u6240\u6709\u6301\u4e45\u6027Kafka\u4e3b\u9898\u3002 mongodb.user \u8fde\u63a5\u5230MongoDB\u65f6\u8981\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7528\u6237\u7684\u540d\u79f0\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.password \u8fde\u63a5MongoDB\u65f6\u4f7f\u7528\u7684\u5bc6\u7801\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.ssl.enabled false Connector\u5c06\u4f7f\u7528SSL\u8fde\u63a5\u5230MongoDB\u5b9e\u4f8b\u3002 mongodb.ssl.invalid.hostname.allowed false \u542f\u7528S\u200b\u200bSL\u65f6\uff0c\u6b64\u8bbe\u7f6e\u63a7\u5236\u5728\u8fde\u63a5\u9636\u6bb5\u662f\u5426\u7981\u7528\u4e25\u683c\u4e3b\u673a\u540d\u68c0\u67e5\u3002\u5982\u679ctrue\u8fde\u63a5\u4e0d\u4f1a\u963b\u6b62\u4e2d\u95f4\u4eba\u653b\u51fb\u3002 database.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u76d1\u89c6\u7684\u6570\u636e\u5e93\u540d\u79f0; \u672a\u5217\u5165\u767d\u540d\u5355\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u90fd\u5c06\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5c06\u76d1\u89c6\u6240\u6709\u6570\u636e\u5e93\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.blacklist\u3002 database.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u7684\u6570\u636e\u5e93\u540d\u79f0; \u5c06\u76d1\u63a7\u9ed1\u540d\u5355\u4e2d\u672a\u5305\u542b\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.whitelist\u3002 collection.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914d\u8981\u76d1\u89c6\u7684MongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4; \u4efb\u4f55\u672a\u5305\u542b\u5728\u767d\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u88ab\u6392\u9664\u5728\u76d1\u63a7\u4e4b\u5916\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fde\u63a5\u5668\u5c06\u76d1\u89c6\u9664local\u548cadmin\u6570\u636e\u5e93\u4e2d\u7684\u96c6\u5408\u4e4b\u5916\u7684\u6240\u6709\u96c6\u5408\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.blacklist\u3002 collection.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914dMongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u4ece\u76d1\u89c6\u4e2d\u6392\u9664; \u4efb\u4f55\u672a\u5305\u542b\u5728\u9ed1\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u53d7\u5230\u76d1\u63a7\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.whitelist\u3002 \" snapshot.mode 0.9.2\u53ca\u66f4\u9ad8\u7248\u672c initial \u6307\u5b9a\u5728\u542f\u52a8\u8fde\u63a5\u5668\u65f6\u8fd0\u884c\u5feb\u7167\u7684\u6761\u4ef6\uff08\u4f8b\u5982\uff0c\u521d\u59cb\u540c\u6b65\uff09\u3002\u9ed8\u8ba4\u503c\u4e3ainitial\uff0c\u5e76\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u672a\u627e\u5230\u504f\u79fb\u91cf\u6216oplog\u4e0d\u518d\u5305\u542b\u5148\u524d\u504f\u79fb\u91cf\u65f6\u8bfb\u53d6\u5feb\u7167\u3002\u5728\u4ece\u4e0d\u9009\u9879\u6307\u5b9a\u8fde\u63a5\u5668\u4e0d\u5e94\u8be5\u4f7f\u7528\u5feb\u7167\uff0c\u800c\u4e0d\u662f\u8fde\u63a5\u5668\u5e94\u7740\u624b\u5c3e\u65e5\u5fd7\u3002 \" field.blacklist 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u5e94\u8be5\u4ece\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u6392\u9664\u7684\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u53ef\u9009\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\u3002 \" field.renames 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u5b8c\u6574\u9650\u5b9a\u5b57\u6bb5\u66ff\u6362\u5217\u8868\uff0c\u7528\u4e8e\u91cd\u547d\u540d\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u7684\u5b57\u6bb5\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u66ff\u6362\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff1anewNestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\uff0c\u5192\u53f7\u5b57\u7b26\uff08:)\u7528\u4e8e\u786e\u5b9a\u5b57\u6bb5\u7684\u91cd\u547d\u540d\u6620\u5c04\u3002\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u5c06\u5e94\u7528\u4e8e\u5217\u8868\u4e2d\u4e0a\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u5728\u91cd\u547d\u540d\u540c\u4e00\u8def\u5f84\u4e2d\u7684\u591a\u4e2a\u5b57\u6bb5\u65f6\u8bf7\u8bb0\u4f4f\u8fd9\u4e00\u70b9\u3002 tasks.max 1 \u5e94\u4e3a\u6b64\u8fde\u63a5\u5668\u521b\u5efa\u7684\u6700\u5927\u4efb\u52a1\u6570\u3002MongoDB\u8fde\u63a5\u5668\u5c06\u5c1d\u8bd5\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u4f7f\u7528\u5355\u72ec\u7684\u4efb\u52a1\uff0c\u56e0\u6b64\u5728\u5c06\u8fde\u63a5\u5668\u4e0e\u5355\u4e2aMongoDB\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u9ed8\u8ba4\u503c\u662f\u53ef\u63a5\u53d7\u7684\u3002\u5c06\u8fde\u63a5\u5668\u4e0eMongoDB\u5206\u7247\u7fa4\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u5efa\u8bae\u6307\u5b9a\u4e00\u4e2a\u7b49\u4e8e\u6216\u5927\u4e8e\u7fa4\u96c6\u4e2d\u5206\u7247\u6570\u7684\u503c\uff0c\u4ee5\u4fbfKafka Connect\u53ef\u4ee5\u5206\u914d\u6bcf\u4e2a\u526f\u672c\u96c6\u7684\u5de5\u4f5c\u3002 initial.sync.max.threads 1 \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u7528\u4e8e\u5728\u526f\u672c\u96c6\u4e2d\u6267\u884c\u96c6\u5408\u7684\u521d\u59cb\u540c\u6b65\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002\u9ed8\u8ba4\u4e3a1\u3002 \" tombstones.on.delete 0.7.3\u53ca\u4ee5\u540e true \u63a7\u5236\u662f\u5426\u5e94\u5728\u5220\u9664\u4e8b\u4ef6\u540e\u751f\u6210\u903b\u8f91\u5220\u9664\u4e8b\u4ef6\u3002 \u5f53true\u5220\u9664\u64cd\u4f5c\u662f\u901a\u8fc7\u5220\u9664\u4e8b\u4ef6\u548c\u968f\u540e\u7684\u5893\u7891\u4e8b\u4ef6\u8868\u793a\u3002\u5982\u679cfalse\u53ea\u53d1\u9001\u5220\u9664\u4e8b\u4ef6\u3002 \u53d1\u9001\u903b\u8f91\u5220\u9664\u4e8b\u4ef6\uff08\u9ed8\u8ba4\u884c\u4e3a\uff09\u5141\u8bb8Kafka\u5728\u5220\u9664\u6e90\u8bb0\u5f55\u540e\u5b8c\u5168\u5220\u9664\u4e0e\u7ed9\u5b9a\u5bc6\u94a5\u6709\u5173\u7684\u6240\u6709\u4e8b\u4ef6\u3002 \" snapshot.delay.ms0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u8fde\u63a5\u5668\u5728\u542f\u52a8\u540e\u62cd\u6444\u5feb\u7167\u4e4b\u524d\u5e94\u7b49\u5f85\u7684\u95f4\u9694\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09;\u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u542f\u52a8\u591a\u4e2a\u8fde\u63a5\u5668\u65f6\u907f\u514d\u5feb\u7167\u4e2d\u65ad\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fde\u63a5\u5668\u91cd\u65b0\u5e73\u8861 \u4ee5\u4e0b\u9ad8\u7ea7\u914d\u7f6e\u5c5e\u6027\u5177\u6709\u826f\u597d\u7684\u9ed8\u8ba4\u503c\uff0c\u53ef\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u56e0\u6b64\u5f88\u5c11\u9700\u8981\u5728\u8fde\u63a5\u5668\u7684\u914d\u7f6e\u4e2d\u6307\u5b9a\u3002 | \u5c5e\u6027 | \u9ed8\u8ba4 | \u63cf\u8ff0 | | :--: | :--: | :--: | | max.queue.size | 8192 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u5c06\u6570\u636e\u5e93\u65e5\u5fd7\u5199\u5165Kafka\u4e4b\u524d\u5c06\u66f4\u6539\u4e8b\u4ef6\u4ece\u6570\u636e\u5e93\u65e5\u5fd7\u4e2d\u8bfb\u53d6\u7684\u963b\u585e\u961f\u5217\u7684\u6700\u5927\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u5f53\u5199\u5165Kafka\u8f83\u6162\u6216\u8005Kafka\u4e0d\u53ef\u7528\u65f6\uff0c\u6b64\u961f\u5217\u53ef\u4ee5\u5411oplog\u8bfb\u53d6\u5668\u63d0\u4f9b\u53cd\u538b\u3002\u961f\u5217\u4e2d\u51fa\u73b0\u7684\u4e8b\u4ef6\u4e0d\u5305\u542b\u5728\u6b64\u8fde\u63a5\u5668\u5b9a\u671f\u8bb0\u5f55\u7684\u504f\u79fb\u4e2d\u3002\u9ed8\u8ba4\u4e3a8192\uff0c\u5e76\u4e14\u5e94\u59cb\u7ec8\u5927\u4e8emax.batch.size\u5c5e\u6027\u4e2d\u6307\u5b9a\u7684\u6700\u5927\u6279\u91cf\u5927\u5c0f\u3002 | | max.batch.size | 2048 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u6b64\u8fde\u63a5\u5668\u7684\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u5904\u7406\u7684\u6bcf\u6279\u4e8b\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u3002\u9ed8\u8ba4\u4e3a2048\u3002 | | poll.interval.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u51fa\u73b0\u7684\u6beb\u79d2\u6570\uff0c\u4ee5\u663e\u793a\u65b0\u7684\u66f4\u6539\u4e8b\u4ef6\u3002\u9ed8\u8ba4\u4e3a1000\u6beb\u79d2\u62161\u79d2\u3002 | | connect.backoff.initial.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u521d\u59cb\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09\u3002 | | connect.backoff.max.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u91cd\u590d\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u6700\u5927\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09\u3002 | | connect.max.attempts | 16 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u53d1\u751f\u5f02\u5e38\u5e76\u4e14\u4efb\u52a1\u4e2d\u6b62\u4e4b\u524d\uff0c\u5bf9\u526f\u672c\u96c6\u4e3b\u8981\u8fde\u63a5\u5c1d\u8bd5\u5931\u8d25\u7684\u6700\u5927\u6b21\u6570\u3002\u7f3a\u7701\u503c\u4e3a16\uff0c\u5176\u4e0e\u9ed8\u8ba4\u503cconnect.backoff.initial.delay.ms\u548cconnect.backoff.max.delay.ms\u5931\u6548\u4e4b\u524d\u5bfc\u81f4\u4ec5\u670920\u591a\u5206\u949f\u7684\u5c1d\u8bd5\u3002 | | mongodb.members.auto.discover | true | \u5e03\u5c14\u503c\uff0c\u6307\u5b9a'mongodb.hosts'\u4e2d\u7684\u5730\u5740\u662f\u5426\u5e94\u8be5\u7528\u4e8e\u53d1\u73b0\u96c6\u7fa4\u6216\u526f\u672c\u96c6\uff08true\uff09\u7684\u6240\u6709\u6210\u5458\u7684\u79cd\u5b50\uff0c\u6216\u8005\u662f\u5426mongodb.hosts\u5e94\u8be5\u6309\u539f\u6837\u4f7f\u7528\u5730\u5740\uff08false\uff09\u3002\u9ed8\u8ba4\u503c\u662ftrue\u5e76\u4e14\u5e94\u8be5\u5728\u6240\u6709\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u9664\u975eMongoDB \u7531\u4ee3\u7406\u63d0\u4f9b | \u5b89\u88c5debezium-connector-mongodb \u542f\u52a8zookeeper zookeeper-server-start zookeeper.properties \u542f\u52a8kafka kafka-server-start server.properties \u542f\u52a8schema-registry-start schema-registry.properties export CLASSPATH=/path/to/my/connectors/* \u542f\u52a8connect-standalone /schema-registry/ connect-avro-standalone.properties kafka/connect-mongo-source.properties \u542f\u52a8kafka consumer kafka-console-consumer --zookeeper localhost:2181 --topic test.test.test --from-beginning schema-registry/connect-avro-distributed.properties\u6dfb\u52a0debezium-connector-mongodb\u7684plugin.path= \u914d\u7f6eDebezium MongoDB connector connect.json { \"name\": \"inventory-connector\", (1) \"config\": { \"connector.class\": \"io.debezium.connector.mongodb.MongoDbConnector\", (2) \"mongodb.hosts\": \"rs0/192.168.99.100:27017\", (3) \"mongodb.name\": \"fullfillment\", (4) \"collection.whitelist\": \"inventory[.]*\", (5) } } 1 \u6211\u4eec\u4f7f\u7528Kafka Connect\u670d\u52a1\u6ce8\u518c\u65f6\u7684\u8fde\u63a5\u5668\u540d\u79f0\u3002 2 MongoDB\u8fde\u63a5\u5668\u7c7b\u7684\u540d\u79f0\u3002 3 \u7528\u4e8e\u8fde\u63a5MongoDB\u526f\u672c\u96c6\u7684\u4e3b\u673a\u5730\u5740 4 \u8be5MongoDB\u7684\u526f\u672c\u96c6\u903b\u8f91\u540d\u79f0\uff0c\u5f62\u6210\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u5e76\u5728kafka\u7684topics\uff0ckafka\u8fde\u63a5\u67b6\u6784\u540d\u79f0\u4e2d\u7684\u6240\u6709\u540d\u79f0\u4f7f\u7528\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684Avro\u67b6\u6784\u7684\u547d\u540d\u7a7a\u95f4\u65f6\u7684Avro\u4f7f\u7528\u3002 5 \u4e0e\u8981\u76d1\u89c6\u7684\u6240\u6709\u96c6\u5408\u7684\u96c6\u5408\u540d\u79f0\u7a7a\u95f4\uff08\u4f8b\u5982\uff0cdbName collectionName\uff09\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\u3002\u8fd9\u662f\u53ef\u9009\u7684\u3002 \u52a0\u8f7d\u8fde\u63a5\u5c31\u662f\u914d\u7f6econnect-mongo-source.properties curl -i -X POST -H \"Accept:application/json\" -H \"Content-Type:application/json\" http://localhost:8084/connectors/ -d @/etc/kafka/mongodb.json \u67e5\u770bkafka\u7684topics kafka-topics --zookeeper localhost:2181 --list db.getCollection(\"rent_houses\").find({ \"price\": { \" lte\": 2000 }, \"title\": { \" lte\": 2000 }, \"title\": { \" in\": [ /\u8f6c\u79df/,/\u6574\u79df/ ] } })","title":"MongoDB"},{"location":"MongoDB/#mongodb-4010","text":"","title":"MongoDB-4.0.10"},{"location":"MongoDB/#_1","text":"views\u662f\u53ea\u8bfb\u7684\u4e14\u65e0\u6cd5\u91cd\u65b0\u547d\u540d\uff0c\u5bf9\u89c6\u56fe\u6267\u884c\u5199\u64cd\u4f5c\u4f1a\u62a5\u9519\uff0c\u89c6\u56fe\u652f\u6301\u7684\u8bfb\u64cd\u4f5c\u6709\uff1a db . collection . find () db . collection . findOne () db . collection . aggregate () db . collection . countDocuments () db . collection . estimatedDocumentCount () db . collection . count () db . collection . distinct () \u89c6\u56fe\u4f7f\u7528\u57fa\u7840\u96c6\u5408\u7684\u7d22\u5f15\u3002\u7531\u4e8e\u7d22\u5f15\u4f4d\u4e8e\u57fa\u7840\u96c6\u5408\u4e0a\uff0c\u56e0\u6b64\u65e0\u6cd5\u76f4\u63a5\u5728\u89c6\u56fe\u4e0a\u521b\u5efa\uff0c\u5220\u9664\u6216\u91cd\u65b0\u6784\u5efa\u7d22\u5f15\uff0c\u4e5f\u65e0\u6cd5\u5728\u89c6\u56fe\u4e0a\u83b7\u53d6\u7d22\u5f15\u5217\u8868\u3002\u65e0\u6cd5\u5728\u89c6\u56fe\u4f7f\u7528 natural\u6392\u5e8f,\u5982\u679c\u89c6\u56fe\u662f\u57fa\u4e8e\u5206\u7247\u521b\u5efa\uff0c\u5219\u89c6\u56fe\u4e5f\u88ab\u89c6\u4e3a\u5206\u7247\uff0c\u65e0\u6cd5\u4e3afrom\u5b57\u6bb5 natural\u6392\u5e8f,\u5982\u679c\u89c6\u56fe\u662f\u57fa\u4e8e\u5206\u7247\u521b\u5efa\uff0c\u5219\u89c6\u56fe\u4e5f\u88ab\u89c6\u4e3a\u5206\u7247\uff0c\u65e0\u6cd5\u4e3afrom\u5b57\u6bb5 lookup\u548c$graphlookup\u64cd\u4f5c\u6307\u5b9a\u5206\u7247\u89c6\u56fe\u3002 \u521b\u5efa\u89c6\u56fe\u662f\u53ef\u4ee5\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\uff0c\u9ed8\u8ba4\u89c4\u5219\u662f\u201c\u7b80\u5355\u201d\u4e8c\u8fdb\u5236\u6bd4\u8f83\u6392\u5e8f\u89c4\u5219\uff0c\u591a\u4e2a\u89c6\u56fe\u505a\u805a\u5408\u64cd\u4f5c\uff0c\u6392\u5e8f\u89c4\u5219\u5fc5\u987b\u76f8\u540c find()\u5bf9\u89c6\u56fe\u7684\u64cd\u4f5c\u4e0d\u652f\u6301\u4ee5\u4e0bProjection\u64cd\u4f5c\u7b26\uff1a $ $elemMatch $slice $meta","title":"\u57fa\u7840"},{"location":"MongoDB/#capped-collections","text":"Capped Collections\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u96c6\u5408\uff0c\u652f\u6301\u57fa\u4e8e\u63d2\u5165\u987a\u5e8f\u63d2\u5165\u548c\u68c0\u7d22\u6587\u6863\u7684\u9ad8\u541e\u5410\u91cf\u64cd\u4f5c\u3002\u4ee5\u7c7b\u4f3c\u4e8e\u5faa\u73af\u7f13\u51b2\u533a\u7684\u65b9\u5f0f\u5de5\u4f5c\uff1a\u4e00\u65e6\u96c6\u5408\u586b\u5145\u5176\u5206\u914d\u7684\u7a7a\u95f4\uff0c\u5b83\u901a\u8fc7\u81ea\u52a8\u5220\u9664\u96c6\u5408\u4e2d\u6700\u65e7\u7684\u6587\u6863\u4e3a\u65b0\u6587\u6863\u817e\u51fa\u7a7a\u95f4 \u65e0\u6cd5\u4ececapped\u96c6\u5408\u5220\u9664\u6587\u6863\uff0c\u8981\u4ece\u96c6\u5408\u5220\u9664\u6587\u6863\u7684\u65b9\u6cd5\uff0c\u4f7f\u7528drop()\u65b9\u6cd5\u5220\u9664\u96c6\u5408\u5e76\u91cd\u65b0\u521b\u5efa\uff0ccapped\u96c6\u5408\u65e0\u6cd5\u5206\u7247\u3002\u521b\u5efacapped\u96c6\u5408\uff0c\u5fc5\u987b\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u6307\u5b9a\u96c6\u5408\u7684\u6700\u5927\u5927\u5c0f\u3002\u5982\u679csize\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e4096\uff0c\u5219\u96c6\u5408\u7684\u4e0a\u9650\u4e3a4096\u5b57\u8282\u3002\u5426\u5219\uff0cMongoDB\u5c06\u63d0\u9ad8\u63d0\u4f9b\u7684\u5927\u5c0f\uff0c\u4f7f\u5176\u6210\u4e3a256\u7684\u6574\u6570\u500d\uff1b\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8be5max\u5b57\u6bb5\u4e3a\u96c6\u5408\u6307\u5b9a\u6700\u5927\u6587\u6863\u6570\u3002\u8be5size\u53c2\u6570\u603b\u662f\u5fc5\u9700\u7684\uff0c\u5373\u4f7f\u4f60\u6307\u5b9amax\u7684\u6587\u4ef6\u6570\u91cf\u3002\u5982\u679c\u96c6\u5408\u5728\u8fbe\u5230\u6700\u5927\u6587\u6863\u8ba1\u6570\u4e4b\u524d\u8fbe\u5230\u6700\u5927\u5927\u5c0f\u9650\u5236\uff0cMongoDB\u5c06\u5220\u9664\u65e7\u6587\u6863 \u5c06\u96c6\u5408\u8f6c\u6362\u4e3acapped\u96c6\u5408:db.runCommand({\"convertToCapped\": \"collectionName\", size: 10000});\u5728\u64cd\u4f5c\u671f\u95f4\u4fdd\u5b58\u6570\u636e\u5e93\u72ec\u5360\u9501\u3002\u9501\u5b9a\u540c\u4e00\u6570\u636e\u5e93\u7684\u5176\u4ed6\u64cd\u4f5c\u5c06\u88ab\u963b\u6b62\uff0c\u76f4\u5230\u64cd\u4f5c\u5b8c\u6210 capped\u66ff\u4ee3\u65b9\u6848\uff1a\u4f7f\u7528TTL(\u751f\u5b58\u65f6\u95f4)\u7d22\u5f15\u4ece\u96c6\u5408\u5220\u9664\u8fc7\u671f\u6570\u636e\uff1b\u8fd9\u4e9b\u7d22\u5f15\u5141\u8bb8\u60a8\u6839\u636e\u65e5\u671f\u7c7b\u578b\u5b57\u6bb5\u7684\u503c\u548c\u7d22\u5f15\u7684TTL\u503c\u4f7f\u6b63\u5e38\u96c6\u5408\u4e2d\u7684\u6570\u636e\u5230\u671f\u548c\u5220\u9664\u3002TTL\u7d22\u5f15\u4e0ecapped\u96c6\u5408\u4e0d\u517c\u5bb9 \u6bcf\u79cdBSON\u7c7b\u578b\u90fd\u6709\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6807\u8bc6\u7b26\uff0c\u5982\u4e0b\u8868\u6240\u793a | Type | Number | Alias | Notes | | :------: | :------: | :------: | :------: | | Double | 1 | \u201cdouble\u201d | | String | 2 | \u201cstring\u201d | | Object | 3 | \u201cobject\u201d | | Array | 4 | \u201carray\u201d | | Binary data | 5 | \u201cbinData\u201d | | Undefined | 6 | \u201cundefined\u201d | \u5df2\u5e9f\u5f03 | | ObjectId | 7 | \u201cobjectId\u201d | | Boolean | 8 | \u201cbool\u201d | | Date | 9 | \u201cdate\u201d | | Null | 10 | \u201cnull\u201d | | Regular Expression | 11 | \u201cregex\u201d | | DBPointer | 12 | \u201cdbPointer\u201d | \u5df2\u5e9f\u5f03 | | JavaScript | 13 | \u201cjavascript\u201d | | Symbol | 14 | \u201csymbol\u201d | \u5df2\u5e9f\u5f03 | | JavaScript (with scope) | 15 | \u201cjavascriptWithScope\u201d | | 32-bit integer | 16 | \u201cint\u201d | | Timestamp | 17 | \u201ctimestamp\u201d | | 64-bit integer | 18 | \u201clong\u201d | | Decimal128 | 19 | \u201cdecimal\u201d | New in version 3.4. | | Min key | -1 | \u201cminKey\u201d | | Max key | 127 | \u201cmaxKey\u201d | ObjectId\u503c\u753112\u4e2a\u5b57\u8282\u7ec4\u6210\uff1a \u4e00\u4e2a4\u5b57\u8282\u7684\u503c\uff0c\u8868\u793aUnix\u7eaa\u5143\u4ee5\u6765\u7684\u79d2\u6570 \u4e00\u4e2a5\u5b57\u8282\u7684\u968f\u673a\u503c \u4e00\u4e2a3\u5b57\u8282\u7684\u8ba1\u6570\u5668\uff0c\u4ee5\u968f\u673a\u503c\u5f00\u59cb \u6bd4\u8f83\u4f1a\u5c06\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\u89c6\u4e3a\u7a7a\u7684BSON\u5bf9\u8c61\uff0c\u6bd4\u8f83\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u65f6\uff0cMongoDB\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1b\u7531\u4f4e\u5230\u9ad8\uff1a MinKey (internal type) Null Numbers (ints, longs, doubles, decimals) Symbol, String Object Array BinData ObjectId Boolean Date Timestamp Regular Expression MaxKey (internal type) Object\u6bd4\u8f83\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1a \u6309\u7167\u5b83\u4eec\u5728BSON\u5bf9\u8c61\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u9012\u5f52\u5730\u6bd4\u8f83\u952e\u503c\u5bf9\u3002 \u6bd4\u8f83\u5173\u952e\u5b57\u6bb5\u540d\u79f0\u3002 \u5982\u679c\u952e\u5b57\u6bb5\u540d\u79f0\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u5b57\u6bb5\u503c\u3002 \u5982\u679c\u5b57\u6bb5\u503c\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u4e0b\u4e00\u4e2a\u952e/\u503c\u5bf9\uff08\u8fd4\u56de\u6b65\u9aa41\uff09\u3002\u6ca1\u6709\u8fdb\u4e00\u6b65\u5bf9\u7684\u5bf9\u8c61\u5c0f\u4e8e\u5177\u6709\u66f4\u591a\u5bf9\u7684\u5bf9\u8c61\u3002 BinData\u6392\u5e8f\u987a\u5e8f\u4e3a\uff1a \u9996\u5148\uff0c\u6570\u636e\u7684\u957f\u5ea6\u6216\u5927\u5c0f\u3002 \u7136\u540e\uff0c\u901a\u8fc7BSON\u4e00\u5b57\u8282\u5b50\u7c7b\u578b\u3002 \u6700\u540e\uff0c\u901a\u8fc7\u6570\u636e\uff0c\u6267\u884c\u9010\u5b57\u8282\u6bd4\u8f83\u3002 # \u914d\u7f6e\u65e5\u5fd7 systemLog : verbosity : 5 #\u65e5\u5fd7\u7ea7\u522b : \u8303\u56f4\u662f 0 - 5 , 0 \u662f MongoDB\u7684\u9ed8\u8ba4\u65e5\u5fd7\u7ea7\u522b \uff0c 5 \u5305\u542b\u4e86 debug\u4fe1\u606f quiet : false #\u5b89\u9759\u6a21\u5f0f\uff0c\u662f\u5426\u8f93\u51fa\u65e5\u5fd7 traceAllExceptions : true #\u662f\u5426\u6253\u5370\u8be6\u7ec6\u7684\u65e5\u5fd7\u4fe1\u606f\uff0c\u5f00\u542f # syslogFacility: <string> #\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7\u4e2d\uff0c\u5982\u679c\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u5219systemLog.destination=syslog. # path: <string> # logAppend: <boolean> # logRotate: <string> # destination: <string> # timeStampFormat: <string> # component: # accessControl: # verbosity: <int> # command: # verbosity: <int> destination : file # mogodb\u65e5\u5fd7\u7684\u4ea7\u751f\u65b9\u5f0f : file = \u6307\u5b9a\u7684\u6587\u4ef6 , syslog\u7cfb\u7edf\u65e5\u5fd7 \uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u6307\u5411\u6807\u51c6\u8f93\u51fa\u6d41\u3002 logAppend : true #\u5728 mongodb\u91cd\u542f\u65f6 , \u7ee7\u7eed\u5f80\u5df2\u6709\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u8ffd\u52a0\u5185\u5bb9\uff0c\u800c\u4e0d\u662f\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6 . path : / data / mongodb / mongod . log #\u65e5\u5fd7\u6587\u4ef6\u7684\u8f93\u51fa\u8def\u5f84\uff0c mongo\u5c06\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6 . logRotate : reopen # 3.0.0 , \u4e24\u4e2a\u503c : rename = \u91cd\u547d\u540d\u65e5\u5fd7\u6587\u4ef6\uff0c reopen = \u5173\u95ed\u5e76\u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 . \u5982\u679c\u4f7f\u7528 reopen\u5219\u8981\u4f7fsystemLog . logAppend = true . timeStampFormat : iso8601 - utc #\u65e5\u5fd7\u4e2d\u65f6\u95f4\u6233\u7684\u683c\u5f0f : ctime = Wed Dec 31 18 : 17 : 54.811 , iso8601 - utc = 1970 - 01 - 01 T00 : 00 : 00.000 Z , # iso8601 - local = \u672c\u5730\u65f6\u95f4\u683c\u5f0f #\u65e5\u5fd7\u7ec4\u4ef6\u7684\u5177\u4f53\u9009\u9879 component : #\u7d22\u5f15\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 index : verbosity : 5 #\u67e5\u8be2\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 query : verbosity : 5 #\u590d\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 replication : verbosity : 5 #\u5fc3\u8df3\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6 #heartbeats: #verbosity: 5 #\u56de\u6eda\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6 #heartbeats: #verbosity: 5 #\u5199\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 write : verbosity : 5 #\u8bbf\u95ee\u63a7\u5236\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 accessControl : verbosity : 5 #\u547d\u4ee4\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 command : verbosity : 5 #\u63a7\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 control : verbosity : 5 #\u8bca\u65ad\u6d88\u606f\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.2 ftdc : verbosity : 5 #\u5730\u7406\u7a7a\u95f4\u89e3\u6790\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 geo : verbosity : 5 #\u7f51\u7edc\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 network : verbosity : 5 #\u5206\u7247\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 sharding : verbosity : 5 #\u5b58\u50a8\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 storage : verbosity : 5 #\u65e5\u5fd7\u7ec4\u4ef6\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0 journal : verbosity : 5 # \u8fdb\u7a0b\u7ba1\u7406\u914d\u7f6e processManagement : fork : true # \u4ee5\u5b88\u62a4\u7ebf\u7a0b\u6a21\u5f0f\u5728\u540e\u53f0\u8fd0\u884c pidFilePath : / data / mongodb / mongod . pid # \u6307\u5b9a\u4fdd\u5b58 PID\u7684\u6587\u4ef6 \u3002 #\u65f6\u533a\u6587\u4ef6:https: //downloads.mongodb.org/olson_tz_db/timezonedb-latest.zip #timeZoneInfo: #\u52a0\u8f7d\u6570\u636e\u5e93\u65f6\u533a\u7684\u5b8c\u6574\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u91c7\u7528\u9ed8\u8ba4\u65f6\u533a\u3002 # \u7f51\u7edc\u914d\u7f6e net : port : 27017 # mongodb\u76d1\u542c\u7684TCP\u7aef\u53e3 bindIp : 0.0.0.0 #\u5141\u8bb8\u8bbf\u95ee\u7684 IP\u5730\u5740\u96c6\u5408 \uff0c\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u662f 127.0.0.1 \uff0c\u5982\u679c\u9700\u8981\u8bbe\u7f6e\u591a\u4e2a\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7 [,] \u5206\u5272\uff0c\u4f8b\u5982 : A , B , C #bindIpAll: true #\u662f\u5426\u7ed1\u5b9a\u6240\u6709\u7684IP\uff0c\u5141\u8bb8\u8bbf\u95ee. version:3.6 maxIncomingConnections : 65536 #\u6700\u5927\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba4 65536 wireObjectCheck : true #\u9a8c\u8bc1\u5ba2\u6237\u7aef\u7684\u6240\u6709\u8bf7\u6c42\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u63d2\u5165\u6076\u610f\u6216\u8005\u65e0\u6548\u7684 BSON\u6570\u636e \uff0c\u5bf9\u4e8e\u9ad8\u5ea6\u5d4c\u5957\u7684\u81ea\u95ee\u5f53\u5bf9\u8c61\uff0c\u6027\u80fd\u5f71\u54cd\u5f88\u5c0f . ipv6 : false #\u542f\u7528\u6216\u7981\u7528 ipv6\u652f\u6301 . #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c. #unixDomainSocket: #enabled: true #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c. #pathPrefix: <string> #\u5957\u63a5\u5b57\u7684\u8def\u5f84 #filePermissions: <int> #\u5957\u63a5\u5b57\u6587\u4ef6\u6743\u9650 #3.6\u7248\u672c\u5220\u9664http\u9009\u9879\uff0c\u6539\u4e3a\u4e86ssl. # ssl: #sslOnNormalPorts: <boolean> # \u88ab2.6\u7248\u672c\u542f\u7528\uff0c\u6539\u7528mode: requireSSL. #\u542f\u7528TSL/SSL: # disabled=\u4e0d\u542f\u7528TLS/SSL, # allowSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl. # preferSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl. # requireSSL=\u670d\u52a1\u5668\u4ec5\u4f7f\u7528\u5e76\u63a5\u53d7TLS/SSL\u52a0\u5bc6\u94fe\u63a5. #mode: disabled #PEMKeyFile: <string> #.pem\u8bc1\u4e66\u5b58\u653e\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84. #PEMKeyPassword: <string> #\u7528\u4e8e\u89e3\u5bc6PEM\u7684\u5bc6\u94a5\u6587\u4ef6. #clusterFile: <string> #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u5185\u90e8\u8eab\u4efd\u9a8c\u8bc1\u7684PEM\u6587\u4ef6. #clusterPassword: <string> #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u7528\u4e8e\u89e3\u5bc6\u5185\u90e8\u9a8c\u8bc1PEM\u6587\u4ef6\u7684\u5bc6\u94a5. #CAFile: <string> #.pem\u5305\u542b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8ddf\u8bc1\u4e66\u94fe\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84. #CRLFile: <string> #.pem\u5305\u542b\u8bc1\u4e66\u540a\u9500\u5217\u8868\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84. #allowConnectionsWithoutCertificates: false #\u5f31\u8bc1\u4e66\u9a8c\u8bc1 #allowInvalidCertificates: <boolean> #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u8bc1\u4e66\uff0c\u5173\u95ed\u8bc1\u4e66\u68c0\u67e5 #allowInvalidHostnames: <boolean> #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u7684\u4e3b\u673a\u540d\uff0c\u7981\u7528\u4e3b\u673a\u540d\u6821\u9a8c #disabledProtocols: <string> #\u7981\u7528\u6307\u5b9a\u534f\u8bae #FIPSMode: <boolean> #\u542f\u7528\u6216\u7981\u7528\u4f7f\u7528\u5b89\u88c5OpenSSL\u5e93\u7684\u7684FIPS\u6a21\u5f0f #zlib\u538b\u7f29\u5668\u7684\u652f\u6301\uff0cadd to Version:3.4,version:3.6,\u9ed8\u8ba4\u4f7f\u7528snappy. #\u5982\u679c\u5404\u65b9\u4e0d\u5171\u7528\u81f3\u5c11\u4e00\u4e2a\u901a\u7528\u538b\u7f29\u5668\uff0c\u5219\u53cc\u65b9\u4e4b\u95f4\u7684\u6d88\u606f\u662f\u672a\u538b\u7f29\u7684. #compression: #compressors: snappy #\u6307\u5b9a\u4f20\u8f93\u5c42\u901a\u77e5\u65b9\u5f0f,\u9ed8\u8ba4asio\uff0cversion:3.6 #transportLayer: asio #\u6307\u5b9a\u7ebf\u7a0b\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6267\u884c\u6a21\u578b\uff1asynchronous=\u4f7f\u7528\u540c\u6b65\u7f51\u7edc\u5e76\u5728\u6bcf\u4e2a\u94fe\u63a5\u7684\u57fa\u7840\u4e0a\u7ba1\u7406\u5176\u7f51\u7edc\u7ebf\u7a0b\u6c60.adaptive:\u4f7f\u7528\u65b0\u7684\u5b9e\u9a8c\u6027\u7684\u5f02\u6b65\u7f51\u7edc\u6a21\u5f0f. #\u5176\u4e2d\u5f53\u503c\u4e3aadaptive\uff0c\u8981\u6c42#transportLayer\u7684\u503c\u4e3aasio. #serviceExecutor: <string> #\u5b89\u5168\u7ba1\u7406 #security: #keyFile: <string> #\u5b58\u50a8\u5171\u4eab\u5bc6\u94a5\u7684\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84 #\u7528\u4e8e\u96c6\u7fa4\u8eab\u4efd\u9a8c\u8bc1\u7684\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5f0f # - keyFile:\u4f7f\u7528\u5bc6\u94a5\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1. # - sendKeyFile: \u53d1\u9001\u5bc6\u94a5\u6587\u4ef6\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66. # - sendX509:\u53d1\u9001x.509\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66. # - x509:\u63a8\u8350\u4f7f\u7528\uff0c\u53d1\u9001x.509\u8bc1\u4e66\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4e14\u53ea\u63a5\u53d7x.509\u8bc1\u4e66. #clusterAuthMode: <string> #\u542f\u7528\u6216\u7981\u7528\u57fa\u4e8e\u89d2\u8272\u7684\u63a7\u5236\u8bbf\u95ee(RBAC)\u6765\u63a7\u5236\u6bcf\u4e2a\u7528\u6237\u5bf9\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c\u7684\u8bbf\u95ee\u3002 # - enabled:\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u88ab\u6388\u6743\u7684\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c. # - disabled:\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u4efb\u4f55\u8d44\u6e90\u548c\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c. #authorization: <string> #transitionToAuth: <boolean> #\u7528\u6237\u53ef\u4ee5\u5728\u6ca1\u6709\u4efb\u4f55\u8bbf\u95ee\u63a7\u5236\u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u673a\u5668\uff0c\u5e76\u8fdb\u884c\u8bfb\u5199\u548c\u7ba1\u7406\u64cd\u4f5c. version:3.4 #javascriptEnabled: <boolean> #\u542f\u7528\u6216\u7981\u7528\u670d\u52a1\u5668\u7aefjavascript\u7684\u6267\u884c. #redactClientLogData: <boolean> #\u8bb0\u5f55\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u4e5f\u8bb0\u5f55\u4e0b\u6765. version:3.4 AND ONLY MongoDB Enterprise #\u914d\u7f6eSASL #sasl: #hostName: <string> #\u7528\u4e8e\u914d\u7f6eSASL\u548cKerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u5b8c\u5168\u9650\u5b9a\u670d\u52a1\u5668\u57df\u540d. #serviceName: <string> #\u4f7f\u7528SASL\u7684\u670d\u52a1\u7684\u6ce8\u518c\u540d\u79f0. #saslauthdSocketPath: <string> #UNIX\u57df\u5957\u63a5\u5b57\u6587\u4ef6\u7684\u8def\u5f84. #enableEncryption: <boolean> #\u4e3aWiredTiger\u5b58\u50a8\u5f15\u64ce\u542f\u7528\u673a\u5bc6. #encryptionCipherMode: <string> #\u9759\u6001\u52a0\u5bc6\u7684\u5bc6\u7801\u6a21\u5f0f:AES256-CBC=\u5bc6\u7801\u5757\u94fe\u63a5\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6, #AES256-GCM=Galois / Counter\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6 #encryptionKeyFile: <string> #\u901a\u8fc7KMIP \u4ee5\u5916\u7684\u8fdb\u7a0b\u7ba1\u7406\u5bc6\u94a5\u65f6\uff0c\u672c\u5730\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84[MongoDB Enterprise] # #\u6ce8\u610f:security.kmip\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.2. # #kmip: #keyIdentifier: <string> #KMIP\u670d\u52a1\u5668\u4e2d\u73b0\u6709\u79d8\u94a5\u7684\u552f\u4e00KNIP\u6807\u8bc6\u7b26.version:3.2 #rotateMasterKey: <boolean> #\u65cb\u8f6c\u4e3b\u79d8\u94a5\u5e76\u91cd\u65b0\u52a0\u5bc6\u5185\u90e8\u79d8\u94a5\u5e93.version:3.2[MongoDB Enterprise] #serverName: <string> #\u8fd0\u884cKMIP\u670d\u52a1\u5668\u7684\u5bc6\u94a5\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\u7684\u4e3b\u673a\u540d\u6216IP\u5730\u5740.[MongoDB Enterprise] #port: <string> #KMIP\u670d\u52a1\u5668\u6b63\u5728\u76d1\u542c\u7684\u7aef\u53e3\u53f7\u3002 #clientCertificateFile: <string> #\u5305\u542b\u7528\u4e8e\u5411KMIP\u670d\u52a1\u5668\u9a8c\u8bc1MongoDB\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66\u8def\u5f84\u7684\u5b57\u7b26\u4e32\u3002 #clientCertificatePassword: <string> #\u7528\u4e8e\u89e3\u5bc6\u5ba2\u6237\u7aef\u8bc1\u4e66\uff08\u5373security.kmip.clientCertificateFile\uff09\u7684\u5bc6\u7801 #serverCAFile: <string> #CA\u6587\u4ef6\u7684\u8def\u5f84\u3002\u7528\u4e8e\u9a8c\u8bc1\u4e0eKMIP\u670d\u52a1\u5668\u7684\u5b89\u5168\u5ba2\u6237\u7aef\u8fde\u63a5\u3002 # #\u6ce8\u610f:security.ldap\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.4. # # ldap: # servers: <string> #\u901a\u8fc7LDAP\u786e\u5b9a\u6267\u884c\u64cd\u4f5c\u7684\u7528\u6237\u662f\u5426\u88ab\u6388\u6743\uff0c\u591a\u4e2a\u670d\u52a1\u5668\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7[,]\u5206\u5272. # bind: # method: <string> #\u8be5\u65b9\u6cd5mongod\u6216mongos\u7528\u4e8e\u5411LDAP\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002 # - simple- mongod\u6216mongos\u4f7f\u7528\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002 # - sasl- mongod\u6216mongos\u4f7f\u7528SASL\u534f\u8bae\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1 # saslMechanisms: <string> #\u4ee5\u9017\u53f7\u5206\u9694\u7684SASL\u673a\u5236\u5217\u8868. # queryUser: <string> #\u7ed1\u5b9aLADP\u67e5\u8be2\u7528\u6237. # queryPassword: <string> #\u7ed1\u5b9aLADP\u670d\u52a1\u5668\u7684\u5bc6\u7801. # useOSDefaults: <boolean> #\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668\u65f6\uff0c\u5141\u8bb8mongod\u6216mongos\u4f7f\u7528Windows\u767b\u5f55\u51ed\u636e\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u7ed1\u5b9a\u3002 # transportSecurity: <string> #\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cmongod\u6216mongos\u521b\u5efa\u4e00\u4e2a\u5230LDAP\u670d\u52a1\u5668\u7684TLS / SSL\u5b89\u5168\u8fde\u63a5. # timeoutMS: <int> #\u7b49\u5f85LDAP\u670d\u52a1\u5668\u54cd\u5e94\u8bf7\u6c42\u65f6\u95f4(\u6beb\u79d2). # userToDNMapping: <string> #\u7528\u4e8e\u9a8c\u8bc1\u7684\u7528\u6237\u540d\u6620\u5c04\u5230LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\u3002 # - match=ECMAScript\u683c\u5f0f\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u6b63\u5219\u8868\u8fbe\u5f0f\uff09\u4e0e\u63d0\u4f9b\u7684\u7528\u6237\u540d\u5339\u914d\u3002 # \u6bcf\u4e2a\u62ec\u53f7\u5305\u56f4\u7684\u90e8\u5206\u8868\u793a\u7531substitutionor \u4f7f\u7528\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6355\u83b7\u7ec4ldapQuery\u3002 # - substitution=LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\u683c\u5f0f\u5316\u6a21\u677f\u3002 # - ldapQuery=LDAP\u67e5\u8be2\u683c\u5f0f\u5316\u6a21\u677f. # authz: # queryTemplate: <string> #\u4e00\u4e2a\u76f8\u5bf9\u7684LDAP\u67e5\u8be2URL. # # \u5c5e\u6027\u8bbe\u7f6e\u9009\u9879 # #setParameter: # ldapUserCacheInvalidationInterval: <int> #\u7528\u4e8e\u4f7f\u7528LDAP\u6388\u6743mongod\u6216mongos\u4f7f\u7528LDAP\u6388\u6743\u7684\u670d\u52a1\u5668(\u79d2)\u3002 # <parameter1>: <value1> # <parameter2>: <value2> # \u5b58\u50a8\u8bbe\u7f6e storage : dbPath : / data / mongodb # mongod\u5b9e\u4f8b\u5b58\u50a8\u6570\u636e\u7684\u76ee\u5f55 , \u9ed8\u8ba4\u503c\uff1a / data / db . indexBuildRetry : true #\u6307\u5b9a mongodb\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u662f\u5426\u91cd\u5efa\u4e0d\u5b8c\u6574\u7684\u7d22\u5f15 , \u9ed8\u8ba4 : true . # repairPath: <string> # MongoDB\u5728--repair\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u5c06\u4f7f\u7528\u7684\u5de5\u4f5c\u76ee\u5f55 \u3002 # \u5f53--repair\u5b8c\u6210\u540e,storage.repairPath\u76ee\u5f55\u662f\u7a7a\u7684,\u5e76\u4e14 dbPath\u5305\u542b\u4e86\u4fee\u590d\u7684\u6587\u4ef6\u3002 # \u8be5storage.repairPath\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u4ec5\u9002\u7528\u4e8emongod\u4f7f\u7528MMAPv1\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b\u3002 journal : enabled : true #\u542f\u7528\u6216\u7981\u7528\u8010\u4e45\u6027\u65e5\u5fd7\u4ee5\u786e\u4fdd\u6570\u636e\u6587\u4ef6\u4fdd\u6301\u6709\u6548\u5e76\u53ef\u6062\u590d\u3002 64 bit\u9ed8\u8ba4\u5f00\u542f , 32 bit\u9ed8\u8ba4\u5173\u95ed . # \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b \u3002 commitIntervalMs : 100 # mongod\u65e5\u5fd7\u64cd\u4f5c\u4e4b\u95f4\u8fdb\u7a0b\u5141\u8bb8\u7684\u6700\u5927\u65f6\u95f4\u91cf ( \u6beb\u79d2 ), \u8303\u56f4\u662f 1 - 500 , \u9ed8\u8ba4\u503c\u662f 100 \uff0c # \u8be5\u503c\u592a\u4f4e\u4f1a\u589e\u52a0\u65e5\u5fd7\u7684\u6301\u4e45\u6027\uff0c\u4f46\u662f\u4f1a\u727a\u7272\u78c1\u76d8\u6027\u80fd. # \u8be5storage.journal.commitIntervalMs\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b \u3002 # directoryPerDB: <boolean> #MongoDB\u4f7f\u7528\u5355\u72ec\u7684\u76ee\u5f55\u6765\u5b58\u50a8\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\u3002 # \u76ee\u5f55\u4f4d\u4e8estorage.dbPath\u76ee\u5f55\u4e0b\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5b50\u76ee\u5f55\u540d\u79f0\u90fd\u4e0e\u6570\u636e\u5e93\u540d\u79f0\u76f8\u5bf9\u5e94\u3002 # 3.0\u7248\u672c\u6709\u53d8\u66f4. # syncPeriodSecs: <int> #\u5728MongoDB\u5c06\u6570\u636e\u901a\u8fc7sync\u64cd\u4f5c\u5237\u65b0\u5230\u6570\u636e\u6587\u4ef6\u4e4b\u524d\u53ef\u4ee5\u4f20\u9012\u7684\u65f6\u95f4\u91cf,\u9ed8\u8ba460s. # \u4e0d\u8981\u5728\u751f\u4ea7\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u6b64\u503c\u3002\u5728\u51e0\u4e4e\u6240\u6709\u60c5\u51b5\u4e0b\uff0c\u60a8\u90fd\u5e94\u8be5\u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u3002 # engine: <string> #mongod\u6570\u636e\u5e93\u7684\u5b58\u50a8\u5f15\u64ce\u3002 # \u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\uff0c3.0\u7248\u672c\u4e2d\u7684\u65b0\u529f\u80fd,\u4eceMongoDB 3.2\u5f00\u59cb\uff0cwiredTiger\u662f\u9ed8\u8ba4\u503c\u3002 # mmapv1=\u6307\u5b9aMMAPv1\u5b58\u50a8\u5f15\u64ce\u3002 # wiredTiger=\u6307\u5b9aWiredTiger\u5b58\u50a8\u5f15\u64ce\u3002 # inMemory=\u6307\u5b9a\u5185\u5b58\u4e2d\u5b58\u50a8\u5f15\u64ce\u3002 mmapv1 : preallocDataFiles : true #\u542f\u7528\u6216\u7981\u7528\u6570\u636e\u6587\u4ef6\u7684\u9884\u5206\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c MongoDB\u4e0d\u9884\u5148\u5206\u914d\u6570\u636e\u6587\u4ef6 \u3002 nsSize : 16 #\u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u9ed8\u8ba4\u5927\u5c0f\uff0c\u5b83\u662f\u4ee5\u6587\u4ef6\u7ed3\u5c3e\u7684\u6587\u4ef6 . ns \u3002\u6bcf\u4e2a\u96c6\u5408\u548c\u7d22\u5f15\u90fd\u88ab\u89c6\u4e3a\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\u3002 # \u4f7f\u7528\u6b64\u8bbe\u7f6e\u63a7\u5236\u65b0\u521b\u5efa\u7684\u540d\u79f0\u7a7a\u95f4\u6587\u4ef6\u7684\u5927\u5c0f\u3002\u8be5\u9009\u9879\u5bf9\u73b0\u6709\u6587\u4ef6\u6ca1\u6709\u5f71\u54cd\u3002 # \u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u662f2047\u5146\u5b57\u8282\u3002\u9ed8\u8ba4\u503c16\u5146\u5b57\u8282\u63d0\u4f9b\u4e86\u5927\u7ea624,000\u4e2a\u540d\u79f0\u7a7a\u95f4\u3002 quota : enforced : false #\u542f\u7528\u6216\u7981\u7528\u5f3a\u5236\u6bcf\u4e2a\u6570\u636e\u5e93\u53ef\u80fd\u5177\u6709\u7684\u6570\u5b57\u6570\u636e\u6587\u4ef6\u7684\u6700\u5927\u9650\u5236\u3002 # \u4f7f\u7528\u8be5storage.mmapv1.quota.enforced\u9009\u9879\u8fd0\u884c\u65f6\uff0cMongoDB\u6bcf\u4e2a\u6570\u636e\u5e93\u6700\u591a\u67098\u4e2a\u6570\u636e\u6587\u4ef6\u3002 # \u901a\u8fc7\u8c03\u6574storage.quota.maxFilesPerDB\u6765\u8c03\u6574\u8fd9\u4e2a\u9650\u5236\u3002 maxFilesPerDB : 8 #\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\u6587\u4ef6\u6570\u91cf\u9650\u5236\uff0c\u9ed8\u8ba4\u662f 8. \u8be5\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8e\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8e mongod . smallFiles : false #\u5982\u679c\u4f60\u6709\u5927\u91cf\u7684\u6570\u636e\u5e93\uff0c\u6bcf\u4e2a\u4fdd\u5b58\u5c11\u91cf\u6570\u636e\u3002 MongoDB\u4f7f\u7528\u8f83\u5c0f\u7684\u9ed8\u8ba4\u6587\u4ef6\u5927\u5c0f \u3002 # \u8be5storage.mmapv1.smallFiles\u9009\u9879\u53ef\u51cf\u5c11\u6570\u636e\u6587\u4ef6\u7684\u521d\u59cb\u5927\u5c0f\uff0c\u5e76\u5c06\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a512\u5146\u5b57\u8282\u3002 # storage.mmapv1.smallFiles\u4e5f\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ece1\u5343\u5146\u5b57\u8282\u51cf\u5c11\u5230128\u5146\u5b57\u8282\u3002 # journal: # debugFlags: <int> #\u63d0\u4f9b\u6d4b\u8bd5\u529f\u80fd\u3002\u4e0d\u7528\u4e8e\u4e00\u822c\u7528\u9014\uff0c\u5e76\u4e14\u4f1a\u5728\u7cfb\u7edf\u5f02\u5e38\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u5f71\u54cd\u6570\u636e\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u3002 # commitIntervalMs: <num> #MongoDB 3.2\u5f03\u7528\u8be5 torage.mmapv1.journal.commitIntervalMs\u8bbe\u7f6e\u3002 # \u6539\u4e3a\u4f7f\u7528storage.journal.commitIntervalMs\u3002 # wiredTiger: # engineConfig: # cacheSizeGB: <number> #WiredTiger\u5c06\u7528\u4e8e\u6240\u6709\u6570\u636e\u7684\u5185\u90e8\u7f13\u5b58\u7684\u6700\u5927\u5927\u5c0f,\u9ed8\u8ba4\u91c7\u7528RAB-1GB\u768450%\u548c256MB\u7684\u6700\u5927\u503c. # \u5c3d\u53ef\u80fd\u4e0d\u8981\u8d85\u8fc7\u6700\u5927\u503c. # journalCompressor: <string> #\u7528\u4e8e\u538b\u7f29WiredTiger\u65e5\u5fd7\u6570\u636e\u7684\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0 # directoryForIndexes: true #mongod\u5c06\u7d22\u5f15\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d index, # \u5e76\u5c06\u96c6\u5408\u6570\u636e\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d collection\u3002 # collectionConfig: # blockCompressor: <string> #\u7528\u4e8e\u538b\u7f29\u6536\u96c6\u6570\u636e\u7684\u9ed8\u8ba4\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0 indexConfig : prefixCompression : true #\u542f\u7528\u6216\u7981\u7528\u7d22\u5f15\u6570\u636e\u7684\u524d\u7f00\u538b\u7f29\u3002 # inMemory: #\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # engineConfig: # inMemorySizeGB: <number> #\u4e3a\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u6570\u636e\u5206\u914d\u7684\u6700\u5927\u5185\u5b58\u91cf\uff0c # \u5305\u62ec\u7d22\u5f15\uff0coplog\uff08\u5982\u679c mongod\u662f\u526f\u672c\u96c6\uff0c\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u5143\u6570\u636e\u7684\u4e00\u90e8\u5206\uff09\u7b49\u3002 # \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u4f7f\u752850\uff05\u7684\u7269\u7406RAM\u51cf1 GB\u3002 #\u8fd0\u884c\u5206\u6790\u914d\u7f6e operationProfiling : mode : slowOp #\u6307\u5b9a\u5e94\u8be5\u5206\u6790\u54ea\u4e9b\u64cd\u4f5c\uff0c\u5206\u6790\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6027\u80fd . # - off=\u5206\u6790\u5668\u5df2\u5173\u95ed\uff0c\u5e76\u4e14\u4e0d\u6536\u96c6\u4efb\u4f55\u6570\u636e\u3002\u8fd9\u662f\u9ed8\u8ba4\u7684\u5206\u6790\u5668\u7ea7\u522b\u3002 # - slowOp=\u5206\u6790\u5668\u6536\u96c6\u6bd4\u82b1\u8d39\u65f6\u95f4\u66f4\u957f\u7684\u64cd\u4f5c\u7684\u6570\u636eslowms\u3002 # - all=\u5206\u6790\u5668\u6536\u96c6\u6240\u6709\u64cd\u4f5c\u7684\u6570\u636e\u3002 slowOpThresholdMs : 100 #\u6162\u64cd\u4f5c\u65f6\u95f4\u9608\u503c\uff0c\u9ed8\u8ba4 100. # slowOpSampleRate: <double> #\u6162\u64cd\u4f5c\u91c7\u6837\u7387\uff0c0-1\u4e4b\u95f4\uff0c\u5305\u542b0,1. # #\u590d\u5236\u8bbe\u7f6e # #replication: # oplogSizeMB: <int> #\u590d\u5236\u64cd\u4f5c\u65e5\u5fd7\u7684\u6700\u5927\u5927\u5c0f\uff08MB\uff09 # replSetName: <string> #mongod\u4e00\u90e8\u5206\u7684\u526f\u672c\u96c6\u7684\u540d\u79f0\u3002\u526f\u672c\u96c6\u4e2d\u7684\u6240\u6709\u4e3b\u673a\u5fc5\u987b\u5177\u6709\u76f8\u540c\u7684\u96c6\u540d\u79f0\u3002\u4ec5\u9002\u7528\u4e8emongod. # secondaryIndexPrefetch: <string> #\u4ec5\u9002\u7528\u4e8emmapv1 \u5b58\u50a8\u5f15\u64ce. # \u5728\u5e94\u7528oplog\u4e2d\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u526f\u672c\u96c6\u7684\u6b21\u8981\u6210\u5458\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u7d22\u5f15\u3002 # - none=\u8f85\u52a9\u7a0b\u5e8f\u4e0d\u4f1a\u5c06\u7d22\u5f15\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002 # - all=\u8f85\u52a9\u7a0b\u5e8f\u52a0\u8f7d\u4e0e\u64cd\u4f5c\u76f8\u5173\u7684\u6240\u6709\u7d22\u5f15\u3002 # - _id_only=Secondaries\u4e0d\u4f1a\u5c06\u989d\u5916\u7684\u7d22\u5f15\u52a0\u8f7d\u5230\u5df2\u6709_id\u7d22\u5f15\u4e4b\u5916\u7684\u5185\u5b58\u4e2d\u3002 # enableMajorityReadConcern: <boolean> ## Deprecated in 3.6 # \u4eceMongoDB 3.6\u5f00\u59cb\uff0c\"majority\"\u59cb\u7ec8\u542f\u7528\u8bfb\u53d6\u5173\u6ce8\uff0c\u5e76\u4e14\u6b64\u8bbe\u7f6e\u4e0d\u8d77\u4f5c\u7528\u3002 # localPingThresholdMs: <int> #mongos\u7528\u4e8e\u786e\u5b9a\u54ea\u4e9b\u8f85\u52a9\u526f\u672c\u96c6\u6210\u5458\u4ece\u5ba2\u6237\u7aef\u4f20\u9012\u8bfb\u53d6\u64cd\u4f5c\u7684ping\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002 # \u9ed8\u8ba4\u503c15\u5bf9\u5e94\u4e8e\u6240\u6709\u5ba2\u6237\u7aef\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684\u9ed8\u8ba4\u503c\u3002 # # \u5206\u7247\u8bbe\u7f6e # #sharding: # clusterRole: <string> #mongod\u5b9e\u4f8b\u5728\u5206\u7247\u7fa4\u96c6\u4e2d\u626e\u6f14\u7684\u89d2\u8272 # - configsvr=\u5c06\u6b64\u5b9e\u4f8b\u4f5c\u4e3a\u914d\u7f6e\u670d\u52a1\u5668\u542f\u52a8\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827019\u7aef\u53e3\u4e0a\u542f\u52a8\u3002 # - shardsvr=\u542f\u52a8\u6b64\u5b9e\u4f8b\u4e3a\u788e\u7247\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827018\u7aef\u53e3\u4e0a\u542f\u52a8\u3002 # \u8bbe\u7f6esharding.clusterRole\u8981\u6c42mongod \u5b9e\u4f8b\u4e0e\u590d\u5236\u4e00\u8d77\u8fd0\u884c\u3002 # \u8981\u5c06\u5b9e\u4f8b\u90e8\u7f72\u4e3a\u526f\u672c\u96c6\u6210\u5458\uff0c\u8bf7\u4f7f\u7528\u8be5replSetName \u8bbe\u7f6e\u5e76\u6307\u5b9a\u526f\u672c\u96c6\u7684\u540d\u79f0\u3002 # archiveMovedChunks: false #\u4ece3.2\u5f00\u59cb\uff0cMongoDB false\u7528\u4f5c\u9ed8\u8ba4\u503c\u3002\u5728\u5757\u8fc1\u79fb\u671f\u95f4\uff0c\u5206\u7247\u4e0d\u4f1a\u4fdd\u5b58\u4ece\u5206\u7247\u8fc1\u79fb\u7684\u6587\u6863\u3002 # configDB: <configReplSetName>/cfg1.example.net:27017, cfg2.example.net:27017,... #\u8be5\u914d\u7f6e\u670d\u52a1\u5668\u7528\u4e8e \u5206\u7247\u7fa4\u96c6\u3002 # # \u5ba1\u8ba1\u65e5\u5fd7\u8bbe\u7f6e,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # #auditLog: # destination: file #\u8bbe\u7f6e\u540e\uff0cauditLog.destination\u542f\u7528\u4f7f\u7528\u6307\u5b9a\u683c\u5f0f\u5f80\u6307\u5b9a\u76ee\u6807\u53d1\u9001\u6240\u6709\u5ba1\u6838\u4e8b\u4ef6\u3002 ## - syslog=\u4ee5JSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\u5230\u7cfb\u7edf\u65e5\u5fd7. ## - console=\u4ee5stdoutJSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\u3002 ## - file=\u5c06\u5ba1\u6838\u4e8b\u4ef6\u8f93\u51fa\u5230\u4ee5\u4e2d\u6307\u5b9aauditLog.path\u683c\u5f0fauditLog.format\u6307\u5b9a\u7684\u6587\u4ef6 \u3002 # format: JSON #\u7528\u4e8e\u5ba1\u8ba1\u7684\u8f93\u51fa\u6587\u4ef6\u7684\u683c\u5f0f,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c(JSON/BSON). # path: <string> #\u8f93\u51fa\u6587\u4ef6\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c. # filter: <string> #\u8fc7\u6ee4\u6307\u5b9a\u7c7b\u578b\u7684\u64cd\u4f5c\u7684\u8bb0\u5f55\u3002 # # \u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\u914d\u7f6e # #snmp: # subagent: <boolean> #\u8be5snmp.subagent\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\u3002 # \u5982\u679csnmp.subagent\u662ftrue\uff0cSNMP\u8fd0\u884c\u7684\u5b50\u4ee3\u7406\u3002 # master: <boolean> #\u5f53snmp.master\u662ftrue\uff0cSNMP\u8fd0\u884c\u4f5c\u4e3a\u4e00\u4e2a\u4e3b\u7ad9\u3002\u00b7 # # \u6587\u672c\u641c\u7d22\u9009\u9879 ,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\u3002 # #basisTech: # rootDirectory:<string> #\u6307\u5b9aBasis Technology Rosette\u8bed\u8a00\u5b66\u5e73\u53f0\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u4ee5\u652f\u6301\u7528\u4e8e\u6587\u672c\u641c\u7d22\u64cd\u4f5c\u7684\u5176\u4ed6\u8bed\u8a00\u3002","title":"Capped Collections"},{"location":"MongoDB/#mongo-shell","text":"\u5e38\u89c1\u7684mongoshell\u5e2e\u52a9\u4e0eJavaScript\u7b49\u6548\u9879\u8868 Shell Helpers JavaScript Equivalents show dbs, show databases db.adminCommand('listDatabases') use <[db]> db = db.getSiblingDB('<[db]>') show collections db.getCollectionNames() show users db.getUsers() show roles db.getRoles({showBuiltinRoles: true}) show log <[logname]> db.adminCommand({ 'getLog' : '<[logname]>' }) show logs db.adminCommand({ 'getLog' : '*' }) it cursor = db.collection.find() if ( cursor.hasNext() ){ cursor.next(); }","title":"mongo shell"},{"location":"MongoDB/#mongodb-crud","text":"","title":"MongoDB CRUD \u64cd\u4f5c"},{"location":"MongoDB/#_2","text":"db . collection . insertOne () // \u63d2\u5165\u4e00\u4e2a\u6587\u6863 db . collection . insertMany () // \u63d2\u5165\u591a\u4e2a\u6587\u6863 db . collection . insert () // \u63d2\u5165\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u6863 db . collection . update () // when used with the ** upsert : true ** option db . collection . updateOne () // when used with the ** upsert : true ** option db . collection . updateMany () // when used with the ** upsert : true ** option db . collection . findAndModify () // when used with the ** upsert : true ** option db . collection . findOneAndUpdate () // when used with the ** upsert : true ** option db . collection . findOneAndReplace () // when used with the ** upsert : true ** option db . collection . save () db . collection . bulkWrite ()","title":"\u63d2\u5165\u6587\u4ef6"},{"location":"MongoDB/#_3","text":"db . collection . find ({ person : { age : 21 , sex : \"male\" }}); // \u67e5\u8be2\u5d4c\u5165/\u5d4c\u5957\u5f0f\u6587\u6863 db . collection . find ({ \"person.sex\" : \"male\" }); // \u5339\u914d\u5d4c\u5165\u5f0f\u6587\u6863\u67d0\u4e2a\u5b57\u6bb5 db . collection . find ({ tags : [ \"blue\" , \"red\" ]}); // \u5339\u914d\u6570\u7ec4 db . collection . find ({ tags : \"red\" , \"blank\" }); // \u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u7684\u4e24\u4e2a\u5143\u7d20 db . collection . find ({ tags : { $all : [ \"red\" , \"blank\" ]}}) // \u4e0d\u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u4e24\u4e2a\u5143\u7d20(\u67e5\u8be2\u53ea\u8981\u5305\u542b\u8fd9\u4e24\u4e2a\u5143\u7d20\u7684\u6240\u6709\u7ed3\u679c) db . collection . find ({ age : { $gt : 1 , $lt : 2 }}) // \u96c6\u5408\u4e2dage\u6570\u7ec4\u4e2d\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5927\u4e8e1\uff0c\u53e6\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5c0f\u4e8e2\uff0c\u6216\u8005\u5355\u4e2a\u5143\u7d20\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6 db . collection . find ({ age : { $elemMatch : { $gt : 1 , $lt : 2 }}}) // \u4f7f\u7528$elemMatch\u8fd0\u7b97\u7b26\u5728\u6570\u7ec4\u7684\u5143\u7d20\u4e0a\u6307\u5b9a\u591a\u4e2a\u6761\u4ef6\uff0c\u4ee5\u4fbf\u81f3\u5c11\u4e00\u4e2a\u6570\u7ec4\u5143\u7d20\u6ee1\u8db3\u6240\u6709\u6307\u5b9a\u7684\u6761\u4ef6\u3002\u6b64\u67e5\u8be2\u6761\u4ef6\u8868\u793aage\u6570\u7ec4\u5305\u542b\u81f3\u5c11\u4e00\u4e2a\u5927\u4e8e1\u4e14\u5c0f\u4e8e2\u7684\u5143\u7d20 db . collection . find ( { \"tags\" : { $size : 3 } } ) // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u957f\u5ea6\u4e3a3 db . collection . find ( { \"tags.2\" : { \"$exists\" : 1 } } ) // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u6570\u91cf\u5927\u4e8e2(\u5b9e\u9645\u5229\u7528\u6570\u7ec4\u7d22\u5f15\u6765\u5b9e\u73b0\u7684) \u67e5\u8be2\u5d4c\u5957\u5728\u6570\u7ec4\u4e2d\u7684\u6587\u6863\u793a\u4f8b \uff1a db . inventory . insertMany ( [ { item : \"journal\" , instock : [ { warehouse : \"A\" , qty : 5 }, { warehouse : \"C\" , qty : 15 } ] }, { item : \"notebook\" , instock : [ { warehouse : \"C\" , qty : 5 } ] }, { item : \"paper\" , instock : [ { warehouse : \"A\" , qty : 60 }, { warehouse : \"B\" , qty : 15 } ] }, { item : \"planner\" , instock : [ { warehouse : \"A\" , qty : 40 }, { warehouse : \"B\" , qty : 5 } ] }, { item : \"postcard\" , instock : [ { warehouse : \"B\" , qty : 15 }, { warehouse : \"C\" , qty : 35 } ] } ]); db . inventory . find ( { \"instock\" : { warehouse : \"A\" , qty : 5 } } ) // \u5339\u914d\u5728invertory\u96c6\u5408\u4e2dinstock\u6570\u7ec4\u5143\u7d20\u4e0e\u6307\u5b9a\u6587\u6863\u5339\u914d\u7684\u6587\u6863\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6587\u6863\u4f5c\u4e3a\u6570\u7ec4\u7684\u5143\u7d20\uff1b\u6ce8\u610f\uff1a\u6574\u4e2a\u5d4c\u5165/\u5d4c\u5957\u6587\u6863\u4e0a\u7684\u7b49\u5f0f\u5339\u914d\u9700\u8981\u6307\u5b9a\u6587\u6863\u7684\u5b8c\u5168\u5339\u914d db . inventory . find ( { \"instock\" : { $elemMatch : { qty : 5 , warehouse : \"A\" } } } ) // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863\u81f3\u5c11\u4e00\u4e2aqty\u503c\u4e3a5\uff0cwarehost\u503c\u4e3aA db . inventory . find ( { \"instock\" : { $elemMatch : { qty : { $gt : 10 , $lte : 20 } } } } ) // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863qty\u503c\u5927\u4e8e10\u4e14\u5c0f\u4e8e\u7b49\u4e8e20 db . inventory . find ( { \"instock.qty\" : { $gt : 10 , $lte : 20 } } ) // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\u7684qty\u5b57\u6bb5\u5927\u4e8e10\u5e76\u4e14\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\uff08\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5165\u6587\u6863\uff09\u7684qty\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e20 db . inventory . find ( { \"instock.qty\" : 5 , \"instock.warehouse\" : \"A\" } ) // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863\u5305\u542b\u5b57\u6bb5qty\u503c\u4e3a5\uff0c\u4e14\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863warehouse\u5b57\u6bb5\u503c\u4e3aA(\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5957\u6587\u6863) db . inventory . find ({ \"instock.qty\" : { $lte : 20 }}) // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863 db . inventory . find ({ \"instock.0.qty\" : { $lte : 20 }}) // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863\uff0c\u7d22\u5f15\u4e3a0\u4e14qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u53ea\u8fd4\u56deitem\u3001status\u53ca_id\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { status : 0 , instock : 0 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u6392\u9664status\u548cinstock\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 , \"size.uom\" : 1 } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u62ecitem\u3001status\u5b57\u6bb5\u53ca\u5d4c\u5165\u6587\u6863size\u7684uom\u5b57\u6bb5 db . inventory . find ( { status : \"A\" }, { item : 1 , status : 1 , instock : { $slice : - 1 } } ) // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u542bitem\u3001status\u5b57\u6bb5instock\uff0c$slice\u8fd0\u7b97\u7b26\u8fd4\u56deinstock\u6570\u7ec4\u6700\u540e\u4e00\u4e2a\u5143\u7d20 db . inventory . find ({ item : null }); // \u67e5\u8be2item\u5b57\u6bb5\u4e3anull\uff0c\u6216\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863 db . inventory . find ({ item : { $type : 10 }}); // \u53ea\u67e5\u8be2item\u5b57\u6bb5\u503c\u7c7b\u578b\u662f10(\u5373null\u7c7b\u578b)\u7684\u6587\u6863 db . inventory . find ({ item : { $exists : false }}) // \u53ea\u67e5\u8be2\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863","title":"\u67e5\u8be2\u6587\u6863"},{"location":"MongoDB/#_4","text":"db . inventory . updateOne ({ item : \"paper\" },{ $set : { \"size.uom\" : \"cm\" , status : \"P\" }, $currentDate : { lastModified : true }}); // \u66f4\u65b0\u4e00\u4e2a\u6587\u6863item\u5b57\u6bb5\u503c\u4e3apaper\uff0c\u5c06size\u6570\u7ec4\u4e2duom\u66f4\u65b0\u4e3acm\uff0cstatus\u66f4\u65b0\u4e3aP db . inventory . updateMany ({ \"qty\" : { $lt : 50 }},{ $set : { \"size.uom\" : \"in\" , status : \"Z\" }, $currentDate : { lastModified : true }}); // \u66f4\u65b0qty\u5b57\u6bb5\u503c\u5c0f\u4e8e50\uff0c\u66f4\u65b0size\u6570\u7ec4uom\u5b57\u6bb5\u503c\u4e3ain\uff0cstatus\u5b57\u6bb5\u503c\u4e3aZ\uff0c\u7528$currentDate\u64cd\u4f5c\u66f4\u65b0lastModified\u5b57\u6bb5\u4e3a\u5f53\u524d\u65f6\u95f4\uff0c\u6ca1\u6709\u6b64\u5b57\u6bb5 db . collection . update () // \u66f4\u65b0\u6216\u66ff\u6362\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u5355\u4e2a\u6587\u6863\uff0c\u6216\u66f4\u65b0\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863 // \u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u66f4\u65b0\u6587\u6863 db . collection . findOneAndReplace () db . collection . findOneAndUpdate () db . collection . findAndModify () db . collection . save () db . collection . bulkWrite ()","title":"\u66f4\u65b0\u6587\u6863"},{"location":"MongoDB/#_5","text":"db . collection . deleteMany ( {} ) // \u5220\u9664\u96c6\u5408\u6240\u6709\u6587\u6863 db . collection . deleteOne ( { status : \"D\" } ) // \u5220\u9664 status\u4e3aD\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . remove () // \u5220\u9664\u5355\u4e2a\u6587\u6863\u6216\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863 \u5220\u9664\u64cd\u4f5c\u4e0d\u4f1a\u5220\u9664\u7d22\u5f15\uff0c\u5373\u4f7f\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6240\u6709\u6587\u6863\uff01 MongoDB\u4e2d\u7684\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u662f\u5355\u4e2a\u6587\u6863\u7ea7\u522b\u7684\u539f\u5b50\u64cd\u4f5c \u4ee5\u4e0b\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\uff1a db . collection . findOneAndDelete () // findOneAndDelete () \u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879 . \u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . findAndModify () // findAndModify () \u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879 . \u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863 db . collection . bulkWrite ()","title":"\u5220\u9664\u6587\u6863"},{"location":"MongoDB/#_6","text":"db . collection . bulkWrite () // \u6b64\u65b9\u6cd5\u53ef\u4ee5\u6279\u91cf\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\u64cd\u4f5c\u3002\u6279\u91cf\u5199\u64cd\u4f5c\u53ef\u4ee5\u6709\u5e8f\u4e5f\u53ef\u65e0\u5e8f\u3002 // \u901a\u8fc7\u6709\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0c MongoDB\u4ee5\u4e32\u884c\u65b9\u5f0f\u6267\u884c\u64cd\u4f5c \u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0c MongoDB\u5c06\u8fd4\u56de\u800c\u4e0d\u5904\u7406\u5217\u8868\u4e2d\u7684\u4efb\u4f55\u5269\u4f59\u5199\u64cd\u4f5c // \u4f7f\u7528\u65e0\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0c MongoDB\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u64cd\u4f5c \uff0c\u4f46\u4e0d\u4fdd\u8bc1\u8fd9\u79cd\u884c\u4e3a\u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0c MongoDB\u5c06\u7ee7\u7eed\u5904\u7406\u5217\u8868\u4e2d\u7684\u5269\u4f59\u5199\u64cd\u4f5c // \u5206\u7247\u96c6\u5408\u4e0a\uff0c\u6709\u5e8f\u64cd\u4f5c\u901a\u5e38\u6bd4\u65e0\u5e8f\u8981\u6162\uff0c bulk . Write () \u9ed8\u8ba4\u662f\u6709\u5e8f\u64cd\u4f5c bulkWrite () \u652f\u6301\u4ee5\u4e0b\u5199\u64cd\u4f5c\uff1a insertOne updateOne updateMany replaceOne deleteOne deleteMany \u6279\u91cf\u63d2\u5165\u5230\u5206\u7247\u96c6\u5408\u7684\u7b56\u7565\uff1a 1 . \u9884\u5206\u5272\u96c6\u5408 2 . \u65e0\u5e8f\u5199\u5165 mongos 3 . \u907f\u514d\u5355\u8c03\u8282\u6d41 --Avoid Monotonic Throttling(\u6b64\u5904\u5b58\u7591)","title":"\u6279\u91cf\u5199\u5165\u64cd\u4f5c"},{"location":"MongoDB/#_7","text":"\u53ef\u91cd\u8bd5\u5199\u5165\u8981\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6\uff1a 1 . \u9700\u8981\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4 2 . \u652f\u6301\u6587\u6863\u9501\u5b9a\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u4f8b\u5982\uff1a WiredTiger\u6216inmemory\u5185\u5b58\u5b58\u50a8\u5f15\u64ce 3 . MongoDB 3 . 6 + \u7248\u672c\u9a71\u52a8\u7a0b\u5e8f 4 . \u96c6\u7fa4\u4e2d MongoDB\u7248\u672c\u5927\u4e8e\u7b49\u4e8e3 . 6 5 . \u5199\u64cd\u4f5c\u51fa\u9519\uff0c Write Concern\u4e3a0\u7684\u4e0d\u91cd\u8bd5 transaction commit\u548cabort operations \u5982\u679c\u63d0\u4ea4\u64cd\u4f5c\u6216\u4e2d\u6b62\u64cd\u4f5c\u9047\u5230\u9519\u8bef\uff0c MongoDB\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u91cd\u8bd5\u8be5\u64cd\u4f5c\u4e00\u6b21 \uff0c\u65e0\u8bba\u662f\u5426 retryWrites\u8bbe\u7f6e\u4e3atrue \u4e8b\u52a1\u5185\u7684\u5199\u64cd\u4f5c\u662f\u4e0d\u80fd\u5355\u72ec\u91cd\u8bd5\u5199\u5165\u7684\uff0c\u65e0\u8bba retryWrites\u662f\u5426\u8bbe\u7f6e\u4e3atrue \uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0d\u542f\u52a8\u91cd\u8bd5\u5199\u5165 \u4ee5\u4e0b\u4e3a\u53ef\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c ( Write Concern\u4e0d\u80fd\u662f { w : 0 } ) \uff1a // \u63d2\u5165\u64cd\u4f5c db . collection . insertOne () db . collection . insert () db . collection . insertMany () // \u5355\u6587\u6863\u66f4\u65b0\u64cd\u4f5c db . collection . updateOne () db . collection . replaceOne () db . collection . save () db . collection . update () \u8fd9\u91cc multi\u662ffalse // \u5355\u4e2a\u6587\u6863\u5220\u9664\u64cd\u4f5c db . collection . deleteOne () db . collection . remove () \u8fd9\u91cc justOne\u662ftrue // findAndModify\u64cd\u4f5c \u3002\u6240\u6709 findAndModify\u64cd\u4f5c\u90fd\u662f\u5355\u6587\u6863\u64cd\u4f5c db . collection . findAndModify () db . collection . findOneAndDelete () db . collection . findOneAndReplace () db . collection . findOneAndUpdate () // \u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982 updateMany db . collection . bulkWrite () \u4f7f\u7528\u4ee5\u4e0b\u5199\u64cd\u4f5c : insertOne updateOne replaceOne deleteOne // \u4ec5\u5305\u542b\u5355\u6587\u6863\u7684\u6279\u91cf\u5199\u5165\u64cd\u4f5c\uff0c\u4e00\u4e2a\u53ef\u91cd\u8bd5\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6307\u5b9a\u5199\u5165\u64cd\u4f5c\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982 update\u6307\u5b9amulti\u9009\u9879\u4e3atrue Bulk \u8fd0\u4f5c\uff1a\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e3a\u8be5\u9009\u9879 update\u6307\u5b9a\u7684\u64cd\u4f5c \u3002 truemulti Bulk . find . removeOne () Bulk . find . replaceOne () Bulk . find . replaceOne () \u53ef\u91cd\u8bd5\u5199\u5165\u6709\u52a9\u4e8e\u89e3\u51b3\u77ac\u65f6\u7f51\u7edc\u9519\u8bef\u548c\u526f\u672c\u96c6\u9009\u4e3e\uff0c\u5e76\u4e0d\u80fd\u89e3\u51b3\u6301\u4e45\u6027\u7f51\u7edc\u9519\u8bef\uff0c\u56e0\u4e3a\u53ea\u8fdb\u884c\u4e00\u6b21\u91cd\u8bd5\u5c1d\u8bd5 \u5982\u679c\u9a71\u52a8\u7a0b\u5e8f\u5728\u76ee\u6807\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u5206\u7247\u4e2d\u627e\u4e0d\u5230\u6b63\u5e38\u7684\u4e3b\u8282\u70b9\uff0c\u5219\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u5728 serverSelectionTimeoutMS\u5728\u91cd\u8bd5\u4e4b\u524d\u7b49\u5f85\u4ee5\u786e\u5b9a\u65b0\u7684\u4e3b\u8282\u70b9 \uff0c\u53ef\u91cd\u8bd5\u5199\u5165\u4e0d\u80fd\u89e3\u51b3\u6545\u969c\u8f6c\u79fb\u671f\u95f4\uff0c\u65f6\u95f4\u8d85\u8fc7 serverSelectionTimeoutMS\u7684\u5b9e\u4f8b \u6ce8\u610f\uff1a\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u51fa\u5199\u5165\u64cd\u4f5c\u5728\u8d85\u8fc7 serverSelectionTimeoutMS\u6ca1\u6709\u54cd\u5e94 \uff0c\u6709\u53ef\u80fd\u5728\u5ba2\u6237\u7aef\u91cd\u65b0\u54cd\u5e94\u65f6 ( \u6ca1\u6709\u91cd\u65b0\u542f\u52a8 ) \uff0c\u5219\u53ef\u80fd\u4f1a\u518d\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c\u3002 db . serverStatus () \u5305\u542b\u6709\u5173\u8be5 transactions\u90e8\u5206\u4e2d\u53ef\u91cd\u8bd5\u5199\u5165\u7684\u7edf\u8ba1\u4fe1\u606f","title":"\u53ef\u91cd\u8bd5\u7684\u5199\u5165"},{"location":"MongoDB/#_8","text":"\u793a\u4f8b\u6587\u6863\u5982\u4e0b\u6240\u793a\uff1a | _id | description | name | | :------: | :------: | :------: | | _id | description | name | | 1 | Coffee and cakes | Java Hut | | 2 | Gourmet hamburgers | Burger Buns | | 3 | Just coffee | Coffee Shop | | 4 | Discount clothing | Clothes Clothes Clothes | | 5 | Indonesian goods | Java Shopping | // \u89c6\u56fe\u4e0d\u652f\u6301\u6587\u672c\u641c\u7d22\uff1b\u6587\u672c\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5b57\u7b26\u4e32\u5185\u5bb9\u7684\u6587\u672c\u641c\u7d22\u67e5\u8be2\u3002 text\u7d22\u5f15\u53ef\u4ee5\u5305\u62ec\u5176\u503c\u4e3a\u5b57\u7b26\u4e32\u6216\u5b57\u7b26\u4e32\u5143\u7d20\u6570\u7ec4\u7684\u4efb\u4f55\u5b57\u6bb5 // \u8981\u6267\u884c\u6587\u672c\u641c\u7d22\u67e5\u8be2\uff0c\u60a8\u5fc5\u987b text\u5728\u96c6\u5408\u4e0a\u6709\u7d22\u5f15 \u3002\u96c6\u5408\u53ea\u80fd\u6709\u4e00\u4e2a\u6587\u672c\u641c\u7d22\u7d22\u5f15\uff0c\u4f46\u8be5\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u591a\u4e2a\u5b57\u6bb5 // \u4f7f\u7528$ text\u67e5\u8be2\u8fd0\u7b97\u7b26\u5bf9\u5177\u6709\u6587\u672c\u7d22\u5f15\u7684\u96c6\u5408\u6267\u884c\u6587\u672c\u641c\u7d22 \u3002$ text\u5c06\u4f7f\u7528\u7a7a\u683c\u548c\u5927\u591a\u6570\u6807\u70b9\u7b26\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u6765\u6807\u8bb0\u641c\u7d22\u5b57\u7b26\u4e32 \uff0c\u5e76 OR\u5728\u641c\u7d22\u5b57\u7b26\u4e32\u4e2d\u6267\u884c\u6240\u6709\u6b64\u7c7b\u6807\u8bb0\u7684\u903b\u8f91 db . stores . find ( { $ text : { $ search : \"java shop\" } } ) // \u67e5\u627e stores\u96c6\u5408\u5305\u542bjava shop\u7684\u4efb\u4f55\u6587\u6863 db . stores . find ( { $ text : { $ search : \"java -shop\" } } ) // \u67e5\u627e stores\u96c6\u5408\u5305\u542bjava\u6392\u9664shop\u7684\u4efb\u4f55\u6587\u6863 db . stores . find ( { $ text : { $ search : \"java coffee shop\" } } , { score : { $ meta : \"textScore\" } } ). sort ( { score : { $ meta : \"textScore\" } } ) // \u8981\u6309\u76f8\u5173\u6027\u5f97\u5206\u7684\u987a\u5e8f\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f aggregation pipeline\u4e5f\u53ef\u4ee5\u8fdb\u884ctext\u641c\u7d22 db . stores . createIndex ( { name : \"text\" , description : \"text\" } ) // \u521b\u5efa\u7d22\u5f15 , \u5141\u8bb8\u5728 name\u548cdescription\u5b57\u6bb5\u4e0a\u8fdb\u884c\u6587\u672c\u641c\u7d22 \u5728\u805a\u5408\u7ba1\u9053\u4e2d\u901a\u8fc7$ text\u5728$match\u9636\u6bb5\u4f7f\u7528\u67e5\u8be2\u8fd0\u7b97\u7b26\u8fdb\u884c\u6587\u672c\u641c\u7d22 \uff1b\u805a\u5408\u7ba1\u9053\u4e2d\u7684\u6587\u672c\u641c\u7d22\u5177\u6709\u4ee5\u4e0b\u9650\u5236\uff1a 1 . $ match\u9636\u6bb5\u5305\u542b\u7684$text\u5fc5\u987b\u5728\u6d41\u6c34\u7ebf\u7684\u7b2c\u4e00\u9636\u6bb5 2 . \u4e00\u4e2a text\u64cd\u4f5c\u53ea\u80fd\u5728\u6d41\u6c34\u9636\u6bb5\u51fa\u73b0\u4e00\u6b21 3 . text\u64cd\u4f5c\u4e0d\u80fd\u51fa\u73b0\u5728$or\u6216$not\u8868\u8fbe\u5f0f 4 . \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6587\u672c\u641c\u7d22\u4e0d\u4f1a\u6309\u5339\u914d\u5206\u6570\u7684\u987a\u5e8f\u8fd4\u56de\u5339\u914d\u7684\u6587\u6863\uff0c\u5728$ sort\u9636\u6bb5\u4f7f\u7528$meta\u805a\u5408\u8868\u8fbe\u5f0f","title":"\u6587\u672c\u641c\u7d22"},{"location":"MongoDB/#_9","text":"// \u6307\u5b9aGeoJSON\u6570\u636e , \u4f7f\u7528\u5d4c\u5165\u5f0f\u6587\u6863\uff1a 1. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5\u540d\u4e3atype\uff0c\u6307\u5b9aGeoJSON\u5bf9\u8c61\u7c7b\u578b 2. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5coordinates\uff0c\u7528\u4e8e\u6307\u5b9a\u5bf9\u8c61\u7684\u5750\u6807\uff0c\u6307\u5b9a\u7ecf\u7eac\u5ea6\u5750\u6807\uff0c\u6709\u6548\u7ecf\u5ea6 - 180 \u81f3180 ( \u5305\u62ec\u4e24\u8005 ) \uff0c\u6709\u6548\u7eac\u5ea6 - 90 \u523090 ( \u5305\u62ec\u4e24\u8005 ) location : { type : \"Point\" , coordinates : [ - 73.856077 , 40.848447 ] } MongoDB\u63d0\u4f9b\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5730\u7406\u7a7a\u95f4\u67e5\u8be2 \uff1a 2 dsphere\u7d22\u5f15\u652f\u6301\u5728\u7c7b\u4f3c\u5730\u7403\u7684\u7403\u4f53\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2 db . collection . createIndex ({ location field : \"2dsphere\" }) // \u521b\u5efa2dsphere\u7d22\u5f15 2 d\u7d22\u5f15\u652f\u6301\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2 , \u7d22\u5f15\u652f\u6301$nearSphere\u5728\u7403\u4f53\u4e0a\u8ba1\u7b97\u7684\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u8fd8\u662f\u4f7f\u75282dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2\uff0c2d\u5bf9\u7403\u5f62\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u7684\u7ed3\u679c\uff0c\u5982\uff1a\u4f7f\u75282d\u5305\u56f4\u6781\u70b9\u7684\u7403\u5f62\u67e5\u8be2\u7d22\u5f15 \u5206\u7247\u96c6\u5408\u65f6\uff0c\u4e0d\u80fd\u5c06\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u4f5c\u4e3a\u5206\u7247\u952e\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\u5728\u5206\u7247\u96c6\u5408\u4e0a\u521b\u5efa\u5730\u5740\u7a7a\u95f4\u7d22\u5f15 \u5206\u7247\u96c6\u5408\u652f\u6301\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\uff1a 1. $ geoNear \u805a\u5408\u9636\u6bb5 2. $ near\u548c$nearSphere\u67e5\u8be2\u8fd0\u7b97\u7b26 3. geoNear\u547d\u4ee4 \u5728\u5206\u7247\u96c6\u7fa4\uff0c\u53ef\u4ee5\u4f7f\u7528$geoWithin\u548c$geoIntersect\u6765\u67e5\u8be2\u5730\u7406\u7a7a\u95f4\u6570\u636e \u4ee5\u4e0b\u4e3a\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\uff1a $ geoIntersects // \u9009\u62e9\u548cGeoJSON\u51e0\u4f55\u4f53\u76f8\u4ea4\u7684\u51e0\u4f55\uff0c\u8be52dsphere\u7d22\u5f15\u652f\u6301$geoIntersects $ geoWithin // \u9009\u62e9\u8fb9\u754cGeoJSON\u51e0\u4f55\u4f53\u5185\u7684\u51e0\u4f55 , \u8be52dsphpere\u548c2d\u7d22\u5f15\u652f\u6301$geoWithin $ near // \u8fd4\u56de\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $ near $ nearSphere // \u8fd4\u56de\u7403\u4f53\u4e0a\u67d0\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $ nearSphere \u5730\u7406\u7a7a\u95f4\u547d\u4ee4\uff1a geoNear\uff08\u5728MongoDB 4.0 \u4e2d\u4e0d\u63a8\u8350\u4f7f\u7528\uff09 // \u6267\u884c\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\uff0c\u8fd4\u56de\u6700\u63a5\u8fd1\u7ed9\u5b9a\u70b9\u7684\u6587\u6863\u3002\u4e0d\u63a8\u8350\u4f7f\u7528\u7684geoNear\u547d\u4ee4\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15 \u5730\u7406\u7a7a\u95f4\u805a\u5408\u9636\u6bb5: $ geoNear // \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd $ match\uff0c$sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 $ geoNear\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15 \u5730\u7406\u7a7a\u95f4\u6a21\u578b: MongoDB\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u53ef\u4ee5\u89e3\u91ca\u5e73\u9762\u6216\u7403\u9762\u4e0a\u7684\u51e0\u4f55\u4f53 2 dsphere \u7d22\u5f15\u4ec5\u652f\u6301\u7403\u5f62\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u7403\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09 2 d\u7d22\u5f15\u652f\u6301\u5e73\u9762\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u5e73\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09\u548c\u4e00\u4e9b\u7403\u5f62\u67e5\u8be2\u3002\u867d\u71362d \u7d22\u5f15\u652f\u6301\u67d0\u4e9b\u7403\u5f62\u67e5\u8be2\uff0c\u4f46\u4f7f\u75282d\u8fd9\u4e9b\u7403\u5f62\u67e5\u8be2\u7684\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002\u5982\u679c\u53ef\u80fd\uff0c\u8bf7\u4f7f\u7528 2 dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2 \u4e0b\u8868\u5217\u51fa\u4e86\u6bcf\u4e2a\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\u4f7f\u7528\u7684\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\u652f\u6301\u7684\u67e5\u8be2\uff1a [ http : // docs . mongodb . com / manual / geospatial - queries/ ] | \u64cd\u4f5c | \u7403\u5f62/\u5e73\u9762\u67e5\u8be2 | \u5907\u6ce8 | | :- -----: | :- -----: | :- -----: | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | // write - concern { w : < value > , j : < boolean > , wtimeot : < number > } w\u9009\u9879 \uff1a\u786e\u8ba4\u5199\u5165\u8bf7\u6c42\u4f20\u9012\u7ed9 mongod\u5b9e\u4f8b\u7684\u6570\u91cf \uff0c 1 \u8868\u793a\u4f20\u9012\u5199\u5165\u64cd\u4f5c\u7ed9\u4e00\u4e2a standalone\u6216\u526f\u672c\u7684\u4e00\u4e2a\u4e3b\u8282\u70b9 \uff1b 0 \u5199\u5165\u64cd\u4f5c\u6ca1\u6709\u786e\u8ba4\uff0c w\u5927\u4e8e1\u662f\u56e0\u4e3a\u9700\u8981\u6765\u81ea\u5176\u4ed6\u8f85\u52a9\u6570\u636e\u8282\u70b9\u7684\u786e\u8ba4 j\u9009\u9879 \uff1a\u786e\u8ba4\u5199\u64cd\u4f5c\u5df2\u5199\u5165\u78c1\u76d8\u65e5\u5fd7 ( on - disk journal ) wtimeout : \u5199\u5165\u7684\u65f6\u95f4\u9650\u5236 ( \u6beb\u79d2\u4e3a\u5355\u4f4d ) \uff0c wtimeout\u4ec5\u9650\u4e8ew\u5927\u4e8e1\u7684\u60c5\u51b5","title":"\u5730\u7406\u7a7a\u95f4\u67e5\u8be2"},{"location":"MongoDB/#mongodbcrud","text":"// \u539f\u5b50\u6027\u548c\u4e8b\u52a1 \u5f53\u5355\u4e2a\u5199\u64cd\u4f5c ( \u5982\uff1a db . collection . updateMany ()) \u4fee\u6539\u591a\u4e2a\u6587\u4ef6\u65f6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u7684\u4fee\u6539\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u4f46\u662f\u6574\u4e2a\u64cd\u4f5c\u4e0d\u662f\uff01 // \u5e76\u53d1\u63a7\u5236 \u5e76\u53d1\u63a7\u5236\u5141\u8bb8\u591a\u4e2a\u7a0b\u5e8f\u540c\u65f6\u8fd0\u884c\uff0c\u800c\u4e0d\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\u6216\u51b2\u7a81 \u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u5b57\u6bb5\u4e0a\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u8be5\u7d22\u5f15\u53ea\u6709\u552f\u4e00\u503c\u3002\u53ef\u4ee5\u9632\u6b62\u63d2\u5165\u3001\u66f4\u65b0\u521b\u5efa\u91cd\u590d\u6570\u636e\u3002\u5728\u591a\u4e2a\u5b57\u6bb5\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u4ee5\u5f3a\u5236\u8be5\u5b57\u6bb5\u7ec4\u5408\u7684\u552f\u4e00\u6027\u3002 \u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u4e3a\u5199\u64cd\u4f5c\u7684\u67e5\u8be2\u8c13\u8bcd\u4e2d\u6307\u5b9a\u5b57\u6bb5\u9884\u671f\u7684\u5f53\u524d\u503c // \u8bfb\u53d6\u9694\u79bb , \u4e00\u81f4\u6027\u548c Recency","title":"MongoDBCRUD\u6982\u5ff5"},{"location":"MongoDB/#_10","text":"oplog \u662f\u5bf9\u6570\u636e\u96c6\u64cd\u4f5c\u7684\u53ef\u91cd\u73b0\u5e8f\u5217,\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u5d4c\u5165\u5f0f\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u67e5\u8be2\uff1b\u5982\u679c\u7d22\u5f15\u8ddf\u8e2a\u54ea\u4e2a\u6216\u54ea\u4e9b\u5b57\u6bb5\u5bfc\u81f4\u7d22\u5f15\u4e3a\u591a\u5efa\u7d22\u5f15\uff0c\u5219\u591a\u5efa\u7d22\u5f15\u53ef\u4ee5\u8986\u76d6\u975e\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2\u3002 ( \u591a\u5efa\u7d22\u5f15\u4e0d\u80fd\u8986\u76d6\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2 ) \uff1b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u65e0\u6cd5\u8986\u76d6\u7d22\u5f15\u3002\u8981\u786e\u5b9a\u4e00\u4e2a\u67e5\u8be2\u662f\u5426\u4e3a\u8986\u76d6\u67e5\u8be2\uff0c\u4f7f\u7528 db . collection . explain () \u6216 explain () \u4f7f\u7528 Database Profiler \u8bc4\u4f30\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\uff0c // \u4f18\u5316\u67e5\u8be2 1 . \u521b\u5efa\u652f\u6301\u67e5\u8be2\u7684\u7d22\u5f15 2 . \u5982\u7ecf\u5e38\u5bf9 timestamp \u5b57\u6bb5\u8fdb\u884c\u6392\u5e8f\u6027\u67e5\u8be2\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u5728 timestamp \u5b57\u6bb5\u521b\u5efa\u7d22\u5f15\uff0c\u67e5\u8be2\u65f6\u4f7f\u7528 db . collection . find () . sort ( { timestamp : - 1 } ) \u66f4\u5feb\u5f97\u5230\u7ed3\u679c\uff0c\u56e0\u4e3a MongoDB \u53ef\u4ee5\u6309\u7167\u5347\u5e8f\u6216\u964d\u5e8f\u8bfb\u53d6\u7d22\u5f15\u3002 3 . \u7d22\u5f15\u652f\u6301\u67e5\u8be2\u3001\u66f4\u65b0\u64cd\u4f5c\u548c\u805a\u5408\u7ba1\u9053\u7684\u67d0\u4e9b\u9636\u6bb5\uff1b\u5982\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\uff0c\u5219 BinData \u7c7b\u578b\u7684\u7d22\u5f15\u5efa\u53ef\u4ee5\u66f4\u6709\u6548\u7684\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\u3002 * \u4e8c\u8fdb\u5236\u5b50\u7c7b\u578b\u503c\u5f97\u8303\u56f4\u4e3a 0 - 7 \u6216 128 - 135 * \u5b57\u8282\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a\uff1a 0 , 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 10 , 12 , 14 , 16 , 20 , 24 \u6216 32 4 . \u9650\u5236\u67e5\u8be2\u7ed3\u679c\u6570\uff0c\u901a\u8fc7 limit () \u65b9\u6cd5\u51cf\u5c11\u67e5\u8be2\u5bf9\u7f51\u7edc\u8d44\u6e90\u7684\u6d88\u8017\u3002\u901a\u5e38\u548c sort () \u7ed3\u5408\u4f7f\u7528 5 . \u4f7f\u7528\u9884\u6d4b\u8fd4\u56de\u5fc5\u8981\u7684\u6570\u636e\uff1b\u53ea\u9700\u8981\u6587\u6863\u7684\u90e8\u5206\u5b57\u6bb5\u65f6\uff0c\u53ea\u8fd4\u56de\u6240\u9700\u7684\u5b57\u6bb5\u53ef\u4ee5\u83b7\u53d6\u66f4\u597d\u7684\u6027\u80fd\u3002 6 . \u4f7f\u7528$ hint \u9009\u62e9\u4e00\u4e2a\u7279\u5b9a\u7684\u6307\u6570\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u4e3a\u7279\u5b9a\u64cd\u4f5c\u9009\u62e9\u6700\u4f73\u7684\u7d22\u5f15\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528$ hint () \u65b9\u6cd5\u5f3a\u5236\u4f7f\u7528\u7279\u5b9a\u7d22\u5f15\u3002 hint () \u652f\u6301\u6027\u80fd\u6d4b\u8bd5\u6216\u5728\u67d0\u4e9b\u67e5\u8be2\uff0c\u5728\u4e00\u4e9b\u67e5\u8be2\u4e2d\uff0c\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5fc5\u987b\u5305\u542b\u5728\u591a\u4e2a\u7d22\u5f15\u4e2d\u3002 7 . \u4f7f\u7528\u589e\u91cf\u8fd0\u7b97\u7b26\u6267\u884c\u64cd\u4f5c\u670d\u52a1\u7aef\uff0c MongoDB \u7684$ inc \u8fd0\u7b97\u7b26\u6765\u589e\u52a0\u6216\u51cf\u5c11\u6587\u6863\u4e2d\u7684\u503c\uff0c\u8be5\u64cd\u4f5c\u589e\u52a0\u670d\u52a1\u7aef\u5b57\u6bb5\u7684\u503c\uff0c\u4f5c\u4e3a\u9009\u62e9\u6587\u6863\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0c\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u7b80\u5355\u4fee\u6539\uff0c\u7136\u540e\u5c06\u6574\u4e2a\u6587\u6863\u5199\u5165\u670d\u52a1\u5668\u3002$ inc \u64cd\u4f5c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u907f\u514d\u7ade\u4e89\u6761\u4ef6\uff0c\u8fd9\u5c06\u5bfc\u81f4\u4e24\u4e2a\u5e94\u7528\u5b9e\u4f8b\u5bf9\u540c\u4e00\u4e2a\u6587\u4ef6\u67e5\u8be2\u65f6\uff0c\u624b\u52a8\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5e76\u4fdd\u5b58\u6574\u4e2a\u6587\u4ef6\u56de\u5230\u540c\u4e00\u65f6\u95f4\u3002 // \u5199\u64cd\u4f5c\u6027\u80fd \u96c6\u5408\u4e2d\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u589e\u52a0\u6027\u80fd\u7684\u5f00\u9500\uff1b\u56e0\u96c6\u5408\u4e2d\u6bcf\u4e2a insert \u548c delete \u5199\u5165\u64cd\u4f5c\u3002 MongoDB \u90fd\u4f1a\u4ece\u76ee\u6807\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u4e2d\u63d2\u5165\u6216\u5220\u9664\u5bf9\u5e94\u7684\u6587\u6863\u952e\u3002 update \u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u65b0\u5728\u8fd9\u4e2a\u96c6\u5408\u4e2d\u7d22\u5f15\u7684\u5b50\u96c6\uff0c\u53d6\u51b3\u4e8e\u66f4\u65b0\u65f6\u8fd9\u4e2a\u952e\u7684\u5f71\u54cd\u3002 // \u6ce8\u610f\uff1a\u5982\u679c\u5199\u5165\u64cd\u4f5c\u4e2d\u6d89\u53ca\u7684\u6587\u6863\u5305\u542b\u5728\u7d22\u5f15\u4e2d\uff0c MongoDB \u5219\u4ec5\u66f4\u65b0 sparse \u6216 partial \u7d22\u5f15 ( sparse \u548c partial \u4e3a MongoDB \u7684\u7d22\u5f15\u7c7b\u578b ) \u67d0\u4e9b\u66f4\u65b0\u64cd\u4f5c\u53ef\u80fd\u589e\u52a0\u6587\u6863\u7684\u5927\u5c0f\u3002\u5982:\u5411\u6587\u6863\u589e\u52a0\u5b57\u6bb5\u3002\u5bf9\u4e8e MMAPv1 \u5f15\u64ce\uff0c\u5982\u679c\u66f4\u65b0\u64cd\u4f5c\u5bfc\u81f4\u6587\u6863\u8d85\u8fc7\u5f53\u524d\u5206\u914d\u7684\u8bb0\u5f55\u5927\u5c0f\u3002 MongoDB \u4f1a\u5c06\u6587\u6863\u91cd\u65b0\u5b9a\u4f4d\u5230\u78c1\u76d8\u4e0a\u3002\u5e76\u7559\u6709\u8db3\u591f\u7684\u8fde\u7eed\u7a7a\u95f4\u6765\u4fdd\u5b58\u6587\u6863\u3002\u9700\u8981\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u6bd4\u6ca1\u6709\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u82b1\u8d39\u7684\u65f6\u95f4\u66f4\u957f\uff0c\u7279\u522b\u662f\u5728\u96c6\u5408\u5177\u6709\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\u3002\u5982\u679c\u96c6\u5408\u5177\u6709\u7d22\u5f15\uff0c MongoDB \u5fc5\u987b\u66f4\u65b0\u6240\u6709\u7d22\u5f15\u6761\u76ee\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u7d22\u5f15\u7684\u96c6\u5408\uff0c\u6b64\u79fb\u52a8\u5c06\u5f71\u54cd\u5199\u5165\u541e\u5410\u91cf // explain \u7ed3\u679c Stages \u63cf\u8ff0\u4e86\u64cd\u4f5c -- \u5982\uff1a COLLSCAN \u7528\u4e8e\u96c6\u5408\u626b\u63cf IXSCAN \u7528\u4e8e\u626b\u63cf\u7d22\u5f15\u952e FETCH \u7528\u4e8e\u68c0\u7d22\u6587\u6863 SHARD_MERGE \u7528\u4e8e\u5408\u5e76\u5206\u7247\u7684\u7ed3\u679c SHARDING_FILTER \u7528\u4e8e\u4ece\u5206\u7247\u4e2d\u8fc7\u6ee4\u6389\u5b64\u7acb\u6587\u6863 // explain result explain . queryPlanner // \u5305\u542b\u67e5\u8be2\u4f18\u5316\u5668\u9009\u62e9\u67e5\u8be2\u8ba1\u5212\u7684\u4fe1\u606f explain . queryPlanner . namespace // // \u5206\u6790\u67e5\u8be2\u6027\u80fd \u5229\u7528 cursor . explain ( \" executionStats \" ) \u548c db . collection . explain ( \" executionStats \" ) \u65b9\u6cd5\u67e5\u770b\u6709\u5173\u67e5\u8be2\u6027\u80fd\u7684\u7edf\u8ba1\u4fe1\u606f 1 . queryPlanner . winningPlan . stage // COLLSCAN \u8868\u793a\u96c6\u5408\u626b\u63cf\uff0c\u4e5f\u5c31\u8868\u660e mongod \u5fc5\u987b\u626b\u63cf\u6574\u4e2a\u96c6\u5408\u6587\u6863\u6765\u8bc6\u522b\u7ed3\u679c\u3002 2 . executionStats . nReturned // \u663e\u793a 3 \uff0c\u8868\u660e\u67e5\u8be2\u5339\u914d\u5230\u4e09\u4e2a\u6587\u6863 3 . executionStats . totalKeysExamined // \u663e\u793a 0 \uff0c\u8868\u660e\u6b64\u67e5\u8be2\u672a\u7528\u5230\u7d22\u5f15 4 . executionStats . totalDocsExamined // \u663e\u793a 10 \uff0c\u8868\u660e MongoDB \u5fc5\u987b\u626b\u63cf\u7684\u6587\u6863\u6570\u91cf ( \u6b64\u5904\u4e3a 10 \u4e2a ) \u624d\u80fd\u67e5\u627e\u5230\u548c\u6761\u4ef6\u5339\u914d\u76f8\u7b26\u7684\u6587\u6863\u3002 5 . queryPlanner . winningPlan . inputStage . stage // \u663e\u793a IXSCAN \u8868\u793a\u6b64\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15 // \u6bd4\u8f83\u7d22\u5f15\u6027\u80fd \u624b\u52a8\u6bd4\u8f83\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15\u67e5\u8be2\u7684\u6027\u80fd\uff0c\u53ef\u4ee5 hint () \u548c explain () \u65b9\u6cd5\u7ed3\u5408\u4f7f\u7528\uff0c\u6dfb\u52a0\u590d\u5408\u7d22\u5f15\u65f6\uff0c\u5b57\u6bb5\u7684\u987a\u5e8f\u975e\u5e38\u91cd\u8981\uff1b\u987a\u5e8f\u4e0d\u540c\u53ef\u80fd\u4f1a\u5bf9\u67e5\u8be2\u9020\u6210\u7684\u5f71\u54cd\u4e0d\u540c\uff0c\u6027\u80fd\u4ea7\u751f\u5dee\u5f02\uff1b\u4f8b\u5982\uff1a db . collection . createIndex ( { quantity : 1 , type : 1 } ) // \u7d22\u5f15\u5148\u6309 quantity \u5b57\u6bb5\u6392\u5e8f\uff0c\u7136\u540e\u6309\u7167 type \u5b57\u6bb5\u6392\u5e8f db . collection . createIndex ( { type : 1 , quantity : 1 } ) // \u7d22\u5f15\u5148 type \u5b57\u6bb5\u6392\u5e8f\uff0c\u518d\u6309 quantity \u5b57\u6bb5\u6392\u5e8f // Tailable Cursors \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u67e5\u8be2\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u4f1a\u5173\u95ed\u8fd4\u56de\u7684\u6570\u636e cursor \uff0c Tailable Cursors \u7c7b\u4f3c\u4e8e tail - f \u547d\u4ee4\u3002\u4f5c\u7528\u5728 capped \u96c6\u5408\u4e0a\uff0c\u5f53\u5ba2\u6237\u7aef\u6709\u65b0\u7684\u6587\u6863\u63d2\u5165\u5230 capped \u96c6\u5408\u65f6\uff0c tailable \u6e38\u6807\u5c06\u7ee7\u7eed\u68c0\u7d22\u6587\u6863\u3002 MongoDB \u526f\u672c\u96c6\u5c31\u4f7f\u7528 tailable \u6e38\u6807\u6765\u8ddf\u8e2a\u4e3b\u8282\u70b9\u7684 oplog \u3002 \u6ce8\u610f\uff1a\u5982\u679c\u67e5\u8be2\u5b57\u6bb5\u4f4d\u4e8e\u7d22\u5f15\u5b57\u6bb5\uff0c\u4e0d\u8981\u4f7f\u7528 tailable \u6e38\u6807\uff0c\u4f7f\u7528\u5e38\u89c4\u6e38\u6807\u5373\u53ef\uff0c\u8ddf\u8e2a\u67e5\u8be2\u8fd4\u56de\u7684\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002\u8981\u68c0\u7d22\u65b0\u6dfb\u52a0\u7684\u6587\u6863\uff0c\u8bf7\u4f7f\u7528\u67e5\u8be2\u6761\u4ef6\u4e2d\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u518d\u6b21\u67e5\u8be2\u96c6\u5408\u3002\u4f8b\u5982\uff1a db . collection . find ( { indexedField : { $ gt : lastvalue } } ) \u8003\u8651\u4ee5\u4e0b\u4e0e tailable \u6e38\u6807\u76f8\u5173\u7684\u884c\u4e3a\uff1a 1 . Tailable \u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\u5e76\u6309\u81ea\u7136\u987a\u5e8f\u8fd4\u56de\u6587\u6863 2 . \u7531\u4e8e tailable \u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\uff0c\u56e0\u6b64\u67e5\u8be2\u7684\u521d\u59cb\u626b\u63cf\u5f00\u9500\u5f88\u5927\uff0c\u4f46\u5728\u540e\u7eed\u7684\u65b0\u6dfb\u52a0\u6587\u6863\u68c0\u7d22\u6d88\u8017\u5f88\u5c0f 3 . \u4ee5\u4e0b\u60c5\u51b5 Tailable \u6e38\u6807\u53ef\u80fd\u4f1a\u6b7b\u4ea1\u6216\u8005\u65e0\u6548\uff1a * \u67e5\u8be2\u8fd4\u56de\u4e0d\u5339\u914d * \u6e38\u6807\u8fd4\u56de\u96c6\u5408 \" end \" \u5904\u7684\u6587\u6863\uff0c\u7136\u540e\u5e94\u7528\u7a0b\u5e8f\u5220\u9664\u4e86\u8be5\u6587\u6863 \u4e00\u4e2a\u6b7b\u4ea1\u7684 cursor \u6709\u4e00\u4e2a id \u4e3a 0","title":"\u5206\u5e03\u5f0f\u67e5\u8be2\u3001\u67e5\u8be2\u4f18\u5316\u3001\u67e5\u8be2\u6027\u80fd\u3001\u4f18\u5316\u67e5\u8be2"},{"location":"MongoDB/#aggregation","text":"\u805a\u5408\u64cd\u4f5c\u5c06\u6765\u81ea\u591a\u4e2a\u6587\u6863\u7684\u503c\u7ec4\u5408\u4e00\u8d77\uff0c\u5e76\u4e14\u5bf9\u5206\u7ec4\u6570\u636e\u6267\u884c\u5404\u79cd\u64cd\u4f5c\u540e\u8fd4\u56de\u5355\u4e2a\u7ed3\u679c\u3002MongoDB\u4e09\u79cd\u6267\u884c\u805a\u5408\u7684\u65b9\u5f0f\uff1a\u805a\u5408\u7ba1\u9053\u3001map-reduce\u51fd\u6570\u548c\u5355\u7528\u9014(single purpose)\u805a\u5408\u65b9\u6cd5\u3002","title":"\u805a\u5408(Aggregation)"},{"location":"MongoDB/#_11","text":"\u6700\u57fa\u672c\u7684\u7ba1\u9053\u9636\u6bb5\u662f\u8fc7\u6ee4\u5668\uff0c\u64cd\u4f5c\u7c7b\u4f3c\u4e8e\u67e5\u8be2\u548c\u6587\u6863\u8f6c\u6362\u3002\u5176\u4ed6\u7ba1\u9053\u64cd\u4f5c\u63d0\u4f9b\u4e86\u6309\u7279\u5b9a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\u548c\u6392\u5e8f\u7684\u5de5\u5177\u4ee5\u53ca\u7528\u4e8e\u805a\u5408\u6570\u7ec4\u5185\u5bb9\u7684\u5de5\u5177\uff0c\u5305\u62ec\u6587\u6863\u4e2d\u7684\u6570\u7ec4\u3002\u6b64\u65b9\u5f0f\u662fMongoDB\u6570\u636e\u805a\u5408\u7684\u9996\u9009\u65b9\u6cd5 map-reduce\u51fd\u6570\uff1a\u901a\u5e38\uff0cmap-reduce\u64cd\u4f5c\u6709\u4e24\u4e2a\u9636\u6bb5\uff1a\u4e00\u4e2amap\u9636\u6bb5\uff0c\u5b83\u5904\u7406\u6bcf\u4e2a\u6587\u6863\u5e76\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u53d1\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\uff0c\u5e76\u51cf\u5c11\u7ec4\u5408map\u64cd\u4f5c\u8f93\u51fa\u7684\u9636\u6bb5\u3002\u53ef\u9009\u5730\uff0cmap-reduce\u53ef\u4ee5\u5177\u6709 \u6700\u7ec8\u5316\u9636\u6bb5\u4ee5\u5bf9\u7ed3\u679c\u8fdb\u884c\u6700\u7ec8\u4fee\u6539\u3002\u4e0e\u5176\u4ed6\u805a\u5408\u64cd\u4f5c\u4e00\u6837\uff0cmap-reduce\u53ef\u4ee5\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\u4ee5\u9009\u62e9\u8f93\u5165\u6587\u6863\u4ee5\u53ca\u6392\u5e8f\u548c\u9650\u5236\u7ed3\u679c\u3002Map-reduce\u4f7f\u7528\u81ea\u5b9a\u4e49JavaScript\u51fd\u6570\u6765\u6267\u884c\u6620\u5c04\u548c\u51cf\u5c11\u64cd\u4f5c\uff0c\u4ee5\u53ca\u53ef\u9009\u7684finalize\u64cd\u4f5c\u3002\u867d\u7136\u81ea\u5b9a\u4e49JavaScript\u4e0e\u805a\u5408\u7ba1\u9053\u76f8\u6bd4\u63d0\u4f9b\u4e86\u6781\u5927\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u901a\u5e38\uff0cmap-reduce\u6bd4\u805a\u5408\u7ba1\u9053\u6548\u7387\u66f4\u4f4e\uff0c\u66f4\u590d\u6742 map-reduce \u5355\u7528\u9014\u805a\u5408\u64cd\u4f5c\uff1aMongoDB\u6709db.collection.estimatedDocumentCount()\uff0cdb.collection.count()\u548cdb.collection.distinct(),\u8fd9\u4e9b\u64cd\u4f5c\u805a\u5408\u90fd\u53ea\u80fd\u805a\u5408\u6765\u81ea\u5355\u4e2a\u96c6\u5408\u7684\u6587\u6863 \u805a\u5408\u7ba1\u9053\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\uff1a\u67d0\u4e9b\u9636\u6bb5\u5c06\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u64cd\u4f5c\u6570\uff0c\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u6307\u5b9a\u8981\u5e94\u7528\u4e8e\u8f93\u5165\u6587\u6863\u7684\u8f6c\u6362\u3002\u8868\u8fbe\u5f0f\u5177\u6709\u6587\u6863\u7ed3\u6784\u4e14\u5305\u542b\u5176\u4ed6\u8868\u8fbe\u5f0f\u3002 \u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u53ea\u80fd\u64cd\u4f5c\u5728\u5f53\u524d\u6d41\u6c34\u7ebf\u7684\u6587\u6863\u5e76\u4e14\u4e0d\u80fd\u5f15\u7528\u5176\u4ed6\u6587\u6863\u4e2d\u7684\u6570\u636e\u3002\u8868\u8fbe\u5f0f\u63d0\u4f9b\u6587\u6863\u7684\u5185\u5b58\u4e2d\u8f6c\u6362\u64cd\u4f5c\u3002\u901a\u5e38\uff0c\u5f53\u805a\u5408\u8fc7\u7a0b\u5e26\u6709\u4e00\u4e2a\u4f8b\u5916\uff1a accumulator\u8868\u8fbe\u5f0f \uff0c\u8868\u8fbe\u5f0f\u662f\u65e0\u72b6\u6001\u7684\u3002\u4ec5\u8fdb\u884c\u8bc4\u4f30 \u8fd9\u4e2a\u7d2f\u52a0\u5668\u7528\u5728$ group\u9636\u6bb5 \uff0c\u4fdd\u6301\u5176\u72b6\u6001 ( \u4f8b\u5982\uff1a totals , maximums , minimums\u548crelated data ) \u901a\u8fc7\u6d41\u6c34\u7ebf\u4f5c\u4e3a\u6587\u6863\u5904\u7406\u8fdb\u7a0b \u5728$ project\u9636\u6bb5\u4f7f\u7528\u4e00\u4e9b\u7d2f\u52a0\u5668 \uff0c\u4f46\u5728\u6b64\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u7d2f\u52a0\u5668\u4e0d\u4f1a\u5728\u6587\u6863\u4e2d\u4fdd\u6301\u5176\u72b6\u6001\u3002 \u4f7f\u7528\u4ee5\u4e0b\u64cd\u4f5c\u53ef\u4ee5\u907f\u514d\u626b\u63cf\u6574\u4e2a\u96c6\u5408\uff1a \u6d41\u6c34\u7ebf\u64cd\u4f5c\u7b26\u548c\u7d22\u5f15\uff1a\u5f53$ match\u548c$sort\u51fa\u73b0\u5728\u7ba1\u9053\u6d41\u6c34\u7ebf\u8d77\u59cb\u4f4d\u7f6e\u53ef\u4ee5\u5229\u7528\u7d22\u5f15\u7684\u4f18\u52bf \u3002$ GeoNear\u7ba1\u9053\u5219\u53ef\u4ee5\u6709\u4e00\u4e2a\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7684\u4f18\u52bf \uff0c\u5f53\u4f7f\u7528$ geoNear\u65f6 \uff0c\u5176\u5fc5\u987b\u5728\u805a\u5408\u7ba1\u9053\u64cd\u4f5c\u4e2d\u7684\u7b2c\u4e00\u4e2a\u9636\u6bb5\u3002 \u9650\u5236\uff1a\u805a\u5408\u7ba1\u9053\u5bf9\u503c\u7c7b\u578b\u548c\u7ed3\u679c\u5927\u5c0f\u6709\u4e00\u5b9a\u7684\u9650\u5236 \u805a\u5408\u7ba1\u9053\u4f18\u5316\uff1a Projection\u4f18\u5316 \uff1a\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u786e\u5b9a\u5b83\u662f\u5426\u4ec5\u9700\u8981\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u5b50\u96c6\u6765\u83b7\u5f97\u7ed3\u679c\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u7ba1\u9053\u5c06\u53ea\u4f7f\u7528\u90a3\u4e9b\u5fc5\u9700\u7684\u5b57\u6bb5\uff0c\u51cf\u5c11\u901a\u8fc7\u7ba1\u9053\u7684\u6570\u636e\u91cf \u6d41\u6c34\u7ebf\u5e8f\u5217\u5316\u4f18\u5316\uff1a$ project\u6216$addFields + $ match\u5e8f\u5217\u4f18\u5316 \uff1b\u5bf9\u4e8e\u5305\u542b projection\u9636\u6bb5 ( $ project\u6216$addFields ) \u540e\u9762\u8ddf\u7740\u4e00\u4e2a$ match\u9636\u6bb5\u7684\u805a\u5408\u6d41\u6c34\u7ebf \uff0c\u5728 projection\u4e4b\u524dMongoDB\u79fb\u52a8$match\u9636\u6bb5\u4e2d\u4efb\u4f55\u8fc7\u6ee4\u5668\u4e0d\u9700\u8981\u5728projection\u9636\u6bb5\u8ba1\u7b97\u7684\u503c\u7ed9\u4e00\u4e2a\u65b0\u7684$match\u9636\u6bb5 \u805a\u5408\u7ba1\u9053\u9650\u5236\uff1a \u4f7f\u7528 aggregate\u547d\u4ee4\u7684\u805a\u5408\u64cd\u4f5c\u5177\u6709\u4ee5\u4e0b\u9650\u5236 \uff1a 1 . \u7ed3\u679c\u5927\u5c0f\u9650\u5236\uff1a\u6b64 aggregate\u547d\u4ee4\u53ef\u4ee5\u8fd4\u56de\u6e38\u6807\u6216\u5c06\u7ed3\u679c\u5b58\u50a8\u5728\u96c6\u5408\u4e2d \u3002\u76ee\u524d 16 M 2 . \u5185\u5b58\u9650\u5236\uff1a\u7ba1\u9053\u9636\u6bb5\u7684 RAM\u9650\u5236\u4e3a100M \uff0c\u5982\u679c\u67d0\u4e2a\u9636\u6bb5\u8d85\u8fc7\u6b64\u9650\u5236\uff0c\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u5141\u8bb8\u5904\u7406\u5927\u578b\u6570\u636e\u96c6\uff0c\u4f7f\u7528 allowDishUse\u9009\u9879\u5c06\u6570\u636e\u5199\u5165\u5230\u4e34\u65f6\u6587\u4ef6 $ groupLookkup\u9636\u6bb5\u5fc5\u987b\u4fdd\u6301\u5728100M\u7684\u5185\u5b58\u9650\u5236\u4e2d \uff0c\u5982\u679c allowDishUse : true\u6307\u5b9a\u5728aggregate () \u64cd\u4f5c\uff0c$ graphLookup\u9636\u6bb5\u4f1a\u5ffd\u7565\u6b64\u9009\u9879 \u3002\u5982\u679c\u6709\u5176\u4ed6\u9636\u6bb5\u5728 aggregate () \u64cd\u4f5c\u4e2d\uff0c allowDiskUse : true\u9009\u9879\u5c06\u5f71\u54cd\u8fd9\u4e9b\u9636\u6bb5 \u805a\u5408\u7ba1\u9053\u548c\u5206\u7247\u96c6\u5408\uff1a \u5982\u679c\u7ba1\u9053\u7684\u5f00\u59cb\u5728\u5206\u7247\u952e\u6709\u4e00\u4e2a\u786e\u5207\u7684$ match \uff0c\u5219\u6574\u4e2a\u7ba1\u9053\u4ec5\u5728\u5339\u914d\u7684\u5206\u7247\u4e0a\u8fd0\u884c\u3002\u5bf9\u4e8e\u5fc5\u987b\u5728\u591a\u4e2a\u5206\u7247\u4e0a\u8fd0\u884c\u7684\u805a\u5408\u64cd\u4f5c\u3002\u5982\u679c\u64cd\u4f5c\u4e0d\u9700\u8981\u5728\u6570\u636e\u5e93\u4e3b\u5206\u7247\u8fd0\u884c\uff0c\u5219\u8fd9\u4e9b\u64cd\u4f5c\u4f1a\u5c06\u7ed3\u679c\u8def\u7531\u5230\u968f\u673a\u7684\u5206\u7247\u4e0a\u6765\u5408\u5e76\u7ed3\u679c\uff0c\u907f\u514d\u4f7f\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u8d85\u8f7d\u3002$ out\u548c$lookup\u9636\u6bb5\u9700\u8981\u5728\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u4e0a\u8fd0\u884c \u5728\u5c06\u805a\u5408\u7ba1\u9053\u5206\u6210\u4e24\u90e8\u5206\u65f6\uff0c\u7ba1\u9053\u88ab\u62c6\u5206\u4ee5\u786e\u4fdd\u5206\u7247\u5728\u8003\u8651\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684\u9636\u6bb5\uff1b\u4f18\u5316\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7248\u672c\u4e4b\u95f4\u53d1\u751f\u53d8\u5316","title":"\u805a\u5408\u7ba1\u9053"},{"location":"MongoDB/#map-reduce","text":"","title":"Map-Reduce"},{"location":"MongoDB/#_12","text":"\u805a\u5408\u7ba1\u9053\u5feb\u901f\u53c2\u8003\uff1aStages(db.collection.aggregate)\u9664\u4e86 out\u548c out\u548c geoNear\u9636\u6bb5\u90fd\u53ef\u4ee5\u5728\u7ba1\u9053\u4e2d\u591a\u6b21\u51fa\u73b0","title":"\u805a\u5408\u53c2\u8003"},{"location":"MongoDB/#stagesdbcollectionaggregate","text":"\u9636\u6bb5 \u63cf\u8ff0 $addFields \u5411\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\u3002\u7c7b\u4f3c\u4e8e project\uff0c project\uff0c addFields\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863; \u5177\u4f53\u800c\u8a00\uff0c\u901a\u8fc7\u5411\u8f93\u51fa\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u8be5\u6587\u6863\u5305\u542b\u8f93\u5165\u6587\u6863\u7684\u73b0\u6709\u5b57\u6bb5\u548c\u65b0\u6dfb\u52a0\u5b57\u6bb5 $bucket \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u548c\u5b58\u50a8\u533a\u8fb9\u754c\uff0c\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7ec4\uff0c\u79f0\u4e3a\u5b58\u50a8\u6876 $bucketAuto \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7c7b\u4e3a\u7279\u5b9a\u6570\u91cf\u7684\u7ec4\uff08\u79f0\u4e3a\u5b58\u50a8\u6876\uff09\u3002\u81ea\u52a8\u786e\u5b9a\u5b58\u50a8\u6876\u8fb9\u754c\uff0c\u4ee5\u5c1d\u8bd5\u5c06\u6587\u6863\u5747\u5300\u5730\u5206\u914d\u5230\u6307\u5b9a\u6570\u91cf\u7684\u5b58\u50a8\u6876\u4e2d $collStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u6216\u89c6\u56fe\u7684\u7edf\u8ba1\u4fe1\u606f $count \u8fd4\u56de\u805a\u5408\u7ba1\u9053\u6b64\u9636\u6bb5\u7684\u6587\u6863\u6570\u91cf\u8ba1\u6570 $facet \u5728\u540c\u4e00\u7ec4\u8f93\u5165\u6587\u6863\u7684\u5355\u4e2a\u9636\u6bb5\u5185\u5904\u7406\u591a\u4e2a\u805a\u5408\u7ba1\u9053\u3002\u652f\u6301\u521b\u5efa\u80fd\u591f\u5728\u5355\u4e2a\u9636\u6bb5\u4e2d\u8de8\u591a\u4e2a\u7ef4\u5ea6\u6216\u65b9\u9762\u8868\u5f81\u6570\u636e\u7684\u591a\u9762\u805a\u5408 $geoNear \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd match\uff0c match\uff0c sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 $graphLookup \u5bf9\u96c6\u5408\u6267\u884c\u9012\u5f52\u641c\u7d22\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\uff0c\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\u5b57\u6bb5\uff0c\u5176\u4e2d\u5305\u542b\u8be5\u6587\u6863\u7684\u9012\u5f52\u641c\u7d22\u7684\u904d\u5386\u7ed3\u679c\u3002 $group \u6309\u6307\u5b9a\u7684\u6807\u8bc6\u7b26\u8868\u8fbe\u5f0f\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u5c06\u7d2f\u52a0\u5668\u8868\u8fbe\u5f0f\uff08\u5982\u679c\u5df2\u6307\u5b9a\uff09\u5e94\u7528\u4e8e\u6bcf\u4e2a\u7ec4\u3002\u6d88\u8017\u6240\u6709\u8f93\u5165\u6587\u6863\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u4e0d\u540c\u7684\u7ec4\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002\u8f93\u51fa\u6587\u6863\u4ec5\u5305\u542b\u6807\u8bc6\u7b26\u5b57\u6bb5\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u5305\u542b\u7d2f\u79ef\u5b57\u6bb5\u3002 $indexStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u7684\u4f7f\u7528\u7684\u7edf\u8ba1\u4fe1\u606f\u3002 $limit \u5c06\u672a\u4fee\u6539\u7684\u524dn\u4e2a\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u9650\u5236\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u96f6\u6587\u6863\uff08\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $listSessions \u5217\u51fa\u6d3b\u52a8\u65f6\u95f4\u8db3\u4ee5\u4f20\u64ad\u5230system.sessions\u96c6\u5408\u7684\u6240\u6709\u4f1a\u8bdd\u3002 $lookup \u5bf9\u540c\u4e00\u6570\u636e\u5e93\u4e2d\u7684\u53e6\u4e00\u4e2a\u96c6\u5408\u6267\u884c\u5de6\u5916\u8fde\u63a5\uff0c\u4ee5 \u4ece\u201c\u5df2\u8fde\u63a5\u201d\u96c6\u5408\u4e2d\u8fc7\u6ee4\u6587\u6863\u4ee5\u8fdb\u884c\u5904\u7406\u3002 $match \u8fc7\u6ee4\u6587\u6863\u6d41\u4ee5\u4ec5\u5141\u8bb8\u5339\u914d\u7684\u6587\u6863\u672a\u7ecf\u4fee\u6539\u5730\u4f20\u9012\u5230\u4e0b\u4e00\u4e2a\u7ba1\u9053\u9636\u6bb5\u3002 $match\u4f7f\u7528\u6807\u51c6\u7684MongoDB\u67e5\u8be2\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5339\u914d\uff09\u6216\u96f6\u6587\u6863\uff08\u4e0d\u5339\u914d\uff09\u3002 $out \u5c06\u805a\u5408\u7ba1\u9053\u7684\u7ed3\u679c\u6587\u6863\u5199\u5165\u96c6\u5408\u3002\u8981\u4f7f\u7528$out\u821e\u53f0\uff0c\u5b83\u5fc5\u987b\u662f\u7ba1\u9053\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\u3002 $project \u91cd\u65b0\u6574\u5f62\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\uff0c\u4f8b\u5982\u6dfb\u52a0\u65b0\u5b57\u6bb5\u6216\u5220\u9664\u73b0\u6709\u5b57\u6bb5\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $redact \u901a\u8fc7\u57fa\u4e8e\u6587\u6863\u672c\u8eab\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\u9650\u5236\u6bcf\u4e2a\u6587\u6863\u7684\u5185\u5bb9\u6765\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\u3002\u5305\u542b$project\u548c\u7684\u529f\u80fd $match\u3002\u53ef\u7528\u4e8e\u5b9e\u73b0\u5b57\u6bb5\u7ea7\u522b\u7684\u7f16\u8f91\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6216\u96f6\u4e2a\u6587\u6863\u3002 $replaceRoot \u7528\u6307\u5b9a\u7684\u5d4c\u5165\u6587\u6863\u66ff\u6362\u6587\u6863\u3002\u8be5\u64cd\u4f5c\u5c06\u66ff\u6362\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6240\u6709\u73b0\u6709\u5b57\u6bb5\uff0c\u5305\u62ec_id\u5b57\u6bb5\u3002\u6307\u5b9a\u5d4c\u5165\u5728\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6587\u6863\u4ee5\u5c06\u5d4c\u5165\u6587\u6863\u63d0\u5347\u5230\u9876\u5c42\u3002 $sample \u4ece\u8f93\u5165\u4e2d\u968f\u673a\u9009\u62e9\u6307\u5b9a\u6570\u91cf\u7684\u6587\u6863\u3002 $skip \u8df3\u8fc7\u524dn\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u8df3\u8fc7\u7f16\u53f7\uff0c\u5e76\u5c06\u672a\u4fee\u6539\u7684\u5176\u4f59\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u96f6\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u4e00\u4e2a\u6587\u6863\uff08\u5982\u679c\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $sort \u6309\u6307\u5b9a\u7684\u6392\u5e8f\u952e\u91cd\u65b0\u6392\u5e8f\u6587\u6863\u6d41\u3002\u53ea\u6709\u8ba2\u5355\u6539\u53d8; \u6587\u4ef6\u4fdd\u6301\u4e0d\u53d8\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $sortByCount \u6839\u636e\u6307\u5b9a\u8868\u8fbe\u5f0f\u7684\u503c\u5bf9\u4f20\u5165\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u8ba1\u7b97\u6bcf\u4e2a\u4e0d\u540c\u7ec4\u4e2d\u7684\u6587\u6863\u8ba1\u6570\u3002 $unwind \u4ece\u8f93\u5165\u6587\u6863\u89e3\u6784\u6570\u7ec4\u5b57\u6bb5\u4ee5\u8f93\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u6587\u6863\u3002\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\u90fd\u4f7f\u7528\u5143\u7d20\u503c\u66ff\u6362\u6570\u7ec4\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fan\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6570\u7ec4\u5143\u7d20\u7684\u6570\u91cf\uff0c\u5bf9\u4e8e\u7a7a\u6570\u7ec4\uff0c\u53ef\u4ee5\u4e3a\u96f6\u3002","title":"Stages(db.collection.aggregate)"},{"location":"MongoDB/#stagesdbaggregate","text":"MongoDB\u8fd8\u63d0\u4f9bdb.aggregate\u65b9\u6cd5\uff1a \u540d\u79f0 \u63cf\u8ff0 $currentOp \u8fd4\u56de\u6709\u5173MongoDB\u90e8\u7f72\u7684\u6d3b\u52a8 \u548c/\u6216 \u4f11\u7720\u64cd\u4f5c\u7684\u4fe1\u606f $listLocalSessions \u5217\u51fa\u6700\u8fd1\u5728\u5f53\u524d\u8fde\u63a5mongos\u6216mongod\u5b9e\u4f8b\u4e0a\u7684\u6240\u6709\u6d3b\u52a8\u56de\u8bdd\uff0c\u8fd9\u4e9b\u4f1a\u8bdd\u4e0d\u4e00\u5b9a\u90fd\u4f20\u5230system.sessions\u96c6\u5408\u4e2d \u8868\u8fbe\u5f0f\u53ef\u4ee5\u5305\u62ec\u5b57\u6bb5\u8def\u5f84\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u6587\u5b57\uff0c \u8868\u8fbe\u5f0f\u5bf9\u8c61\u548c \u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u3002\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5d4c\u5957","title":"Stages(db.aggregate)"},{"location":"MongoDB/#_13","text":"\u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\uff0c\u5e76\u8fd4\u56de\u5e03\u5c14\u503c\u4f5c\u4e3a\u7ed3\u679c\u3002\u9664\u4e86false\u5e03\u5c14\u503c\uff0c\u5e03\u5c14\u8868\u8fbe\u5f0f\u4e3afalse\u5982\u4e0b\uff1anull\uff0c0\uff0c\u548cundefined \u7684\u503c\u3002\u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u6240\u6709\u5176\u4ed6\u503c\u8ba1\u7b97\u4e3atrue\uff0c\u5305\u62ec\u975e\u96f6\u6570\u503c\u548c\u6570\u7ec4 \u540d\u79f0 \u63cf\u8ff0 $and \u4ec5\u5728\u5176\u6240\u6709\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue,\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $not \u8fd4\u56de\u4e0e\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u76f8\u53cd\u7684\u5e03\u5c14\u503c\uff0c\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $or \u5f53\u4efb\u4f55\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue\uff0c\u5141\u8bb8\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f","title":"\u5e03\u5c14\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_14","text":"\u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u9664\u4e86$cmp\u8fd4\u56de\u4e00\u4e2a\u6570\u5b57\u3002\u6bd4\u8f83\u8868\u8fbe\u5f0f\u91c7\u7528\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u5e76\u6bd4\u8f83\u503c\u548c\u7c7b\u578b\uff0c\u4f7f\u7528\u6307\u5b9a\u7684BSON\u6bd4\u8f83\u987a\u5e8f\u6765\u8868\u793a\u4e0d\u540c\u7c7b\u578b\u7684\u503c \u540d\u79f0 \u63cf\u8ff0 $cmp \u8fd4\u56de0\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u76f8\u7b49\u7684\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6240\u8ff0\u7b2c\u4e8c\u503c\uff0c\u4ee5\u53ca-1\u6bd4\u6240\u8ff0\u7b2c\u4e8c\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u662f\u4ee5\u4e0b\u3002 $eq \u8fd4\u56detrue\u503c\u662f\u5426\u76f8\u7b49\u3002 $gt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $gte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $ne true\u5982\u679c\u503c\u4e0d\u76f8\u7b49\u5219\u8fd4\u56de\u3002","title":"\u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_15","text":"\u540d\u79f0 \u63cf\u8ff0 $cond \u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\uff0c\u7528\u4e8e\u8ba1\u7b97\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u5176\u4ed6\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4e4b\u4e00\u7684\u503c\u3002\u63a5\u53d7\u6709\u5e8f\u5217\u8868\u4e2d\u7684\u4e09\u4e2a\u8868\u8fbe\u5f0f\u6216\u4e09\u4e2a\u547d\u540d\u53c2\u6570\u3002 $ifNull \u5982\u679c\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5bfc\u81f4null\u7ed3\u679c\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u975enull\u7ed3\u679c\u6216\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u7a7a\u7ed3\u679c\u5305\u542b\u672a\u5b9a\u4e49\u503c\u6216\u7f3a\u5c11\u5b57\u6bb5\u7684\u5b9e\u4f8b\u3002\u63a5\u53d7\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u53c2\u6570\u3002\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u53ef\u4ee5\u4e3anull\u3002 $switch \u8bc4\u4f30\u4e00\u7cfb\u5217\u6848\u4f8b\u8868\u8fbe\u3002\u5f53\u5b83\u627e\u5230\u4e00\u4e2a\u6c42\u503c\u7684\u8868\u8fbe\u5f0f\u65f6true\uff0c$switch\u6267\u884c\u4e00\u4e2a\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5e76\u4e2d\u65ad\u63a7\u5236\u6d41\u3002","title":"\u6761\u4ef6\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_16","text":"\u4ee5\u4e0b\u8fd0\u7b97\u7b26\u8fd4\u56de\u65e5\u671f\u5bf9\u8c61\u6216\u65e5\u671f\u5bf9\u8c61\u7684\u7ec4\u4ef6 \u540d\u79f0 \u63cf\u8ff0 $dateFromParts \u7ed9\u5b9a\u65e5\u671f\u7684\u7ec4\u6210\u90e8\u5206\u6784\u9020BSON Date\u5bf9\u8c61\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToParts \u8fd4\u56de\u5305\u542b\u65e5\u671f\u7ec4\u6210\u90e8\u5206\u7684\u6587\u6863\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $dayOfMonth \u4ee51\u523031\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4e2d\u67d0\u5929\u3002 $dayOfWeek \u8fd4\u56de\u65e5\u671f\u7684\u661f\u671f\u51e0\uff0c\u4f5c\u4e3a1\uff08\u661f\u671f\u65e5\uff09\u548c7\uff08\u661f\u671f\u516d\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $dayOfYear \u4ee51\u5230366\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u65e5\u671f\u3002 $hour \u4ee50\u523023\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5c0f\u65f6\u3002 $isoDayOfWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5de5\u4f5c\u65e5\u7f16\u53f7\uff0c\u8303\u56f4\u4ece 1\uff08\u661f\u671f\u4e00\uff09\u52307\uff08\u661f\u671f\u65e5\uff09\u3002 $isoWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5468\u6570\uff0c\u4ece 1\u523053\u3002\u5468\u6570\u4ece1\u5305\u542b\u5e74\u4efd\u7b2c\u4e00\u4e2a\u661f\u671f\u56db\u7684\u4e00\u5468\uff08\u661f\u671f\u4e00\u5230\u661f\u671f\u65e5\uff09\u5f00\u59cb\u3002 $isoWeekYear \u4ee5ISO 8601\u683c\u5f0f\u8fd4\u56de\u5e74\u4efd\u7f16\u53f7\u3002\u5e74\u4efd\u4ece\u7b2c1\u5468\u7684\u661f\u671f\u4e00\uff08ISO 8601\uff09\u5f00\u59cb\uff0c\u5230\u4e0a\u5468\u7684\u661f\u671f\u65e5\uff08ISO 8601\uff09\u7ed3\u675f\u3002 $millisecond \u4ee50\u5230999\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6beb\u79d2\u6570\u3002 $minute \u4ee50\u523059\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5206\u949f\u3002 $month \u4ee51\uff081\u6708\uff09\u523012\uff0812\u6708\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4efd\u3002 $second \u4ee50\u523060\uff08\u95f0\u79d2\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u79d2\u6570\u3002 $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $week \u8fd4\u56de\u65e5\u671f\u7684\u5468\u6570\uff0c\u4f5c\u4e3a0\uff08\u5728\u4e00\u5e74\u7684\u7b2c\u4e00\u4e2a\u661f\u671f\u65e5\u4e4b\u524d\u7684\u90e8\u5206\u5468\uff09\u548c53\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $year \u4ee5\u6570\u5b57\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u5e74\u4efd\uff08\u4f8b\u59822014\u5e74\uff09\u3002 \u4ee5\u4e0b\u7b97\u672f\u8fd0\u7b97\u7b26\u53ef\u4ee5\u91c7\u7528\u65e5\u671f\u64cd\u4f5c\u6570 \u540d\u79f0 \u63cf\u8ff0 $add \u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\u4ee5\u8fd4\u56de\u65b0\u65e5\u671f\u3002\u5982\u679c\u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\uff0c\u8bf7\u5c06\u6570\u5b57\u89c6\u4e3a\u6beb\u79d2\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f\uff0c\u4f46\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u8868\u8fbe\u5f0f\u89e3\u6790\u4e3a\u65e5\u671f\u3002 $subtract \u8fd4\u56de\u4ece\u7b2c\u4e00\u4e2a\u503c\u4e2d\u51cf\u53bb\u7b2c\u4e8c\u4e2a\u503c\u7684\u7ed3\u679c\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\uff0c\u5219\u8fd4\u56de\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u5dee\u5f02\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u6570\u5b57\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\u65e5\u671f\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u6570\u5b57\uff0c\u8bf7\u9996\u5148\u6307\u5b9a\u65e5\u671f\u53c2\u6570\uff0c\u56e0\u4e3a\u4ece\u6570\u5b57\u4e2d\u51cf\u53bb\u65e5\u671f\u6ca1\u6709\u610f\u4e49\u3002","title":"\u65e5\u671f\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_17","text":"\u540d\u79f0 \u63cf\u8ff0 $literal \u8fd4\u56de\u4e00\u4e2a\u6ca1\u6709\u89e3\u6790\u7684\u503c\u3002\u7528\u4e8e\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u5c06\u5176\u89e3\u91ca\u4e3a\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5c06 literal\u8868\u8fbe\u5f0f\u7528\u4e8e\u4ee5a\u5f00\u5934\u7684\u5b57\u7b26\u4e32\uff0c literal\u8868\u8fbe\u5f0f\u7528\u4e8e\u4ee5a\u5f00\u5934\u7684\u5b57\u7b26\u4e32\uff0c \u4ee5\u907f\u514d\u5c06\u5176\u89e3\u6790\u4e3a\u5b57\u6bb5\u8def\u5f84","title":"\u6587\u5b57\u8868\u8fbe\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_18","text":"\u540d\u79f0 \u63cf\u8ff0 $mergeObjects \u5c06\u591a\u4e2a\u6587\u6863\u5408\u5e76\u4e3a\u4e00\u4e2a\u6587\u6863\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd) $objectToArray \u5c06\u6587\u6863\u8f6c\u6362\u4e3a\u8868\u793a\u952e\u503c\u5bf9\u7684\u6587\u6863\u6570\u7ec4\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd)","title":"\u5bf9\u8c61\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#set","text":"Set\u8868\u8fbe\u5f0f\u5bf9\u6570\u7ec4\u6267\u884cset\u64cd\u4f5c\uff0c\u5c06\u6570\u7ec4\u89c6\u4e3a\u96c6\u5408\u3002Set\u8868\u8fbe\u5f0f\u5ffd\u7565\u6bcf\u4e2a\u8f93\u5165\u6570\u7ec4\u4e2d\u7684\u91cd\u590d\u6761\u76ee\u4ee5\u53ca\u5143\u7d20\u7684\u987a\u5e8f\u3002\u5982\u679cset\u64cd\u4f5c\u8fd4\u56de\u4e00\u4e2aset\uff0c\u5219\u8be5\u64cd\u4f5c\u4f1a\u8fc7\u6ee4\u6389\u7ed3\u679c\u4e2d\u7684\u91cd\u590d\u9879\uff0c\u4ee5\u8f93\u51fa\u4ec5\u5305\u542b\u552f\u4e00\u6761\u76ee\u7684\u6570\u7ec4\u3002\u672a\u6307\u5b9a\u8f93\u51fa\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u987a\u5e8f \u540d\u79f0 \u63cf\u8ff0 $allElementsTrue \u5982\u679c\u96c6\u5408\u7684\u6ca1\u6709\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3afalse\uff0c\u5219\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $anyElementTrue \u5982\u679c\u96c6\u5408\u7684\u4efb\u4f55\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3atrue\uff0c \u5219\u8fd4\u56detrue; \u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setDifference \u8fd4\u56de\u4e00\u4e2a\u96c6\u5408\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e00\u4e2a\u96c6\u5408\u4e2d\u4f46\u4e0d\u5728\u7b2c\u4e8c\u4e2a\u96c6\u5408\u4e2d; \u5373\u6267\u884c\u7b2c\u4e8c\u7ec4\u76f8\u5bf9\u4e8e\u7b2c\u4e00\u7ec4\u7684\u76f8\u5bf9\u8865\u5145\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setEquals \u5982\u679c\u8f93\u5165\u96c6\u5408\u5177\u6709\u76f8\u540c\u7684\u4e0d\u540c\u5143\u7d20\u8fd4\u56detrue\u3002\u63a5\u53d7\u4e24\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setIntersection \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u6240\u6709\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $setIsSubset \u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e8c\u7ec4\u4e2d\u8fd4\u56detrue\uff0c\u5305\u62ec\u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u7b49\u4e8e\u7b2c\u4e8c\u7ec4\u65f6; \u5373\u4e0d\u662f\u4e25\u683c\u7684\u5b50\u96c6\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setUnion \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u4efb\u4f55\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408","title":"Set\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#string","text":"\u65e0\u8bba\u4f7f\u7528\u4ec0\u4e48\u5b57\u7b26\uff0c$concat\u884c\u4e3a\u90fd\u662f\u660e\u786e\u5b9a\u4e49\u7684 \u540d\u79f0 \u63cf\u8ff0 $concat \u8fde\u63a5\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\u4e32\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $indexOfBytes \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u5b57\u8282\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1\u3002 $indexOfCP \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u4ee3\u7801\u70b9\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1 $ltrim \u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $rtrim \u4ece\u5b57\u7b26\u4e32\u672b\u5c3e\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $split \u6839\u636e\u5206\u9694\u7b26\u5c06\u5b57\u7b26\u4e32\u62c6\u5206\u4e3a\u5b50\u5b57\u7b26\u4e32\u3002\u8fd4\u56de\u4e00\u4e2a\u5b50\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u5982\u679c\u5728\u5b57\u7b26\u4e32\u4e2d\u627e\u4e0d\u5230\u5206\u9694\u7b26\uff0c\u5219\u8fd4\u56de\u5305\u542b\u539f\u59cb\u5b57\u7b26\u4e32\u7684\u6570\u7ec4\u3002 $strLenBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8\u7f16\u7801\u5b57\u8282\u7684\u6570\u91cf\u3002 $strLenCP \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8 \u4ee3\u7801\u70b9\u7684\u6570\u91cf\u3002 $strcasecmp \u6267\u884c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u5e76\u8fd4\u56de\uff1a 0\u5982\u679c\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u540c\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5927\u4e8e\u7b2c\u4e8c\u4e2a-1\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002 $substr \u5df2\u8fc7\u65f6\u3002\u4f7f\u7528$substrBytes\u6216 $substrCP\u3002 $substrBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ece\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8\u5b57\u8282\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u5b57\u8282\u6570\u3002 $substrCP \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ee5\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8 \u4ee3\u7801\u70b9\uff08CP\uff09\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5904\u7684\u5b57\u7b26\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u4ee3\u7801\u70b9\u6570\u3002 $toLower \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002 $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd)","title":"String\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#_19","text":"\u540d\u79f0 \u63cf\u8ff0 $meta \u8bbf\u95ee\u6587\u672c\u641c\u7d22\u5143\u6570\u636e","title":"\u6587\u672c\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#type","text":"\u540d\u79f0 \u63cf\u8ff0 $convert \u5c06\u503c\u8f6c\u6362\u4e3a\u6307\u5b9a\u7684\u7c7b\u578b\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toBool \u5c06\u503c\u8f6c\u6362\u4e3a\u5e03\u5c14\u503c\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDecimal \u5c06\u503c\u8f6c\u6362\u4e3aDecimal128\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDouble \u5c06\u503c\u8f6c\u6362\u4e3adouble\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toInt \u5c06\u503c\u8f6c\u6362\u4e3a\u6574\u6570\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toLong \u5c06\u503c\u8f6c\u6362\u4e3along\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toObjectId \u5c06\u503c\u8f6c\u6362\u4e3aObjectId\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $type \u8fd4\u56de\u8be5\u5b57\u6bb5\u7684BSON\u6570\u636e\u7c7b\u578b(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd)","title":"Type\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#accumulatorsgroup","text":"\u53ef\u4ee5\u5728 group\u9636\u6bb5\u4f7f\u7528\uff0c\u5176\u662f\u5728\u6587\u6863\u901a\u8fc7\u7ba1\u9053\u65f6\u4fdd\u6301\u5176\u72b6\u6001(\u5982\uff1a\u603b\u6570\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u548c\u76f8\u5173\u6570\u636e)\u7684\u8fd0\u7b97\u7b26\u3002\u5f53\u5728 group\u9636\u6bb5\u4f7f\u7528\uff0c\u5176\u662f\u5728\u6587\u6863\u901a\u8fc7\u7ba1\u9053\u65f6\u4fdd\u6301\u5176\u72b6\u6001(\u5982\uff1a\u603b\u6570\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u548c\u76f8\u5173\u6570\u636e)\u7684\u8fd0\u7b97\u7b26\u3002\u5f53\u5728 group\u9636\u6bb5\u4e2d\u4f5c\u4e3a\u7d2f\u52a0\u5668\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5c06\u5355\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u8f93\u5165\uff0c\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u8ba1\u7b97\u4e00\u6b21\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e3a\u5171\u4eab\u76f8\u540c\u7ec4\u5bc6\u94a5\u7684\u6587\u6863\u7ec4\u4fdd\u6301\u5176\u9636\u6bb5 \u540d\u79f0 \u63cf\u8ff0 $addToSet \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u552f\u4e00\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4\u3002\u6570\u7ec4\u5143\u7d20\u7684\u987a\u5e8f\u672a\u5b9a\u4e49 $avg \u8fd4\u56de\u6570\u503c\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $first \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\u4e2d\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $last \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u6587\u6863\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $max \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u9ad8\u8868\u8fbe\u5f0f\u503c $mergeObjects \u8fd4\u56de\u901a\u8fc7\u7ec4\u5408\u6bcf\u4e2a\u7ec4\u7684\u8f93\u5165\u6587\u6863\u521b\u5efa\u7684\u6587\u6863 $min \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u4f4e\u8868\u8fbe\u5f0f\u503c $push \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4 $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c","title":"Accumulators(\u7d2f\u52a0\u5668)($group)"},{"location":"MongoDB/#accumulatorsprojectprojectaddfields","text":"\u4e00\u4e9b\u53ef\u7528\u7528\u4f5c group\u9636\u6bb5\u7684\u7d2f\u52a0\u5668\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u7528\u4e8e group\u9636\u6bb5\u7684\u7d2f\u52a0\u5668\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u7528\u4e8e project\u548c addFields\u9636\u6bb5\uff0c\u4f46\u4e0d\u80fd\u7528\u4f5c\u7d2f\u52a0\u5668\u3002\u5728 addFields\u9636\u6bb5\uff0c\u4f46\u4e0d\u80fd\u7528\u4f5c\u7d2f\u52a0\u5668\u3002\u5728 project\u548c$addFields\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u4e0d\u4f1a\u4fdd\u6301\u5176\u72b6\u6001\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5355\u4e2a\u53c2\u6570\u6216\u591a\u4e2a\u53c2\u6570\u4f5c\u4e3a\u8f93\u5165\u3002 \u540d\u79f0 \u63cf\u8ff0 $avg \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $max \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5927\u503c $min \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5c0f\u503c $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c","title":"Accumulators(\u7d2f\u52a0\u5668)(project\u548cproject\u548caddFields)"},{"location":"MongoDB/#_20","text":"\u540d\u79f0 \u63cf\u8ff0 $let \u5b9a\u4e49\u5728\u5b50\u8868\u8fbe\u5f0f\u8303\u56f4\u5185\u4f7f\u7528\u7684\u53d8\u91cf\uff0c\u5e76\u8fd4\u56de\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u63a5\u53d7\u547d\u540d\u53c2\u6570\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f \u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u7d22\u5f15","title":"\u53d8\u91cf\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26"},{"location":"MongoDB/#aggregation-commands","text":"","title":"aggregation-commands(\u805a\u5408\u547d\u4ee4)"},{"location":"MongoDB/#_21","text":"\u540d\u79f0 \u63cf\u8ff0 aggregate \u4f7f\u7528\u805a\u5408\u6846\u67b6\u6267\u884c\u805a\u5408\u4efb\u52a1\uff0c\u4f8b\u5982\u7ec4 count \u8ba1\u7b97\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6587\u6863\u6570 distinct \u663e\u793a\u4e3a\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6307\u5b9a\u952e\u627e\u5230\u7684\u4e0d\u540c\u503c group \u4e0d\u63a8\u8350\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 mapReduce \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408","title":"\u805a\u5408\u547d\u4ee4"},{"location":"MongoDB/#_22","text":"\u540d\u79f0 \u63cf\u8ff0 \u540d\u79f0 \u63cf\u8ff0 db.collection.aggregate() \u63d0\u4f9b\u5bf9\u805a\u5408\u7ba1\u9053\u7684\u8bbf\u95ee db.collection.group() \u5df2\u8fc7\u65f6\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 db.collection.mapReduce() \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408","title":"\u805a\u5408\u65b9\u6cd5"},{"location":"MongoDB/#_23","text":"\u805a\u5408\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u53d8\u91cf\u53ef\u4ee5\u4fdd\u5b58\u4efb\u4f55BSON\u7c7b\u578b\u7684\u6570\u636e\u3002\u8981\u8bbf\u95ee\u53d8\u91cf\u7684\u503c\uff0c\u4f7f\u7528\u5e26\u6709\u524d\u7f00\u53ccdollar\u7b26( )\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" )\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" <span><span class=\"MathJax_Preview\">)\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\"</span><script type=\"math/tex\">)\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\" . \"\u8868\u793a\u6cd5","title":"\u805a\u5408\u8868\u8fbe\u5f0f\u4e2d\u7684\u53d8\u91cf"},{"location":"MongoDB/#_24","text":"\u7528\u6237\u53d8\u91cf\u540d\u79f0\u53ef\u4ee5\u5305\u542bASCII\u5b57\u7b26[_a-zA-Z0-9]\u548c\u4efb\u4f55\u975eASCII\u5b57\u7b26\uff0c\u7528\u6237\u53d8\u91cf\u540d\u5fc5\u987b\u4ee5\u5c0f\u5199\u7684ASCII\u5b57\u7b26[a-z]\u6216\u975eASCII\u5b57\u7b26\u5f00\u5934","title":"\u7528\u6237\u53d8\u91cf"},{"location":"MongoDB/#_25","text":"\u53d8\u91cf \u63cf\u8ff0 ROOT \u5f15\u7528\u5f53\u524d\u6b63\u5728\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u5904\u7406\u7684\u6839\u6587\u6863\uff0c\u5373\u9876\u7ea7\u6587\u6863 CURRENT \u5f15\u7528\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u4e2d\u6b63\u5728\u5904\u7406\u7684\u5b57\u6bb5\u8def\u5f84\u7684\u5f00\u59cb\u3002\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u6240\u6709\u9636\u6bb5\u90fd\u4ee5CURRENT\u76f8\u540c\u7684 \u65b9\u5f0f\u5f00\u5934ROOT CURRENT\u662f\u53ef\u4ee5\u4fee\u6539\u7684\u3002\u4f46\u662f\uff0c\u7531\u4e8e <field> \u7b49\u540c\u4e8e <field> \u7b49\u540c\u4e8e CURRENT.<field>\uff0c\u91cd\u65b0\u7ed1\u5b9a\u4f1aCURRENT\u6539\u53d8 CURRENT.<field>\uff0c\u91cd\u65b0\u7ed1\u5b9a\u4f1aCURRENT\u6539\u53d8 \u8bbf\u95ee\u7684\u542b\u4e49 REMOVE \u4e00\u4e2a\u8ba1\u7b97\u7f3a\u5931\u503c\u7684\u53d8\u91cf\u3002\u5141\u8bb8\u6761\u4ef6\u6392\u9664\u5b57\u6bb5\u3002\u5728a\u4e2d$projection\uff0cREMOVE\u4ece\u8f93\u51fa\u4e2d\u6392\u9664\u8bbe\u7f6e\u4e3a\u53d8\u91cf\u7684\u5b57\u6bb5 \u6709\u5173\u5176\u7528\u6cd5\u7684\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6709\u6761\u4ef6\u6392\u9664\u5b57\u6bb5 \u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd DESCEND $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 PRUNE $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 KEEP $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00","title":"\u7cfb\u7edf\u53d8\u91cf"},{"location":"MongoDB/#sqlaggregation","text":"sql-aggregation","title":"SQL\u548caggregation(\u805a\u5408)\u7684\u6bd4\u8f83"},{"location":"MongoDB/#_26","text":"\u521b\u5efa\u7d22\u5f15\u5e94\u8003\u8651\u4ee5\u4e0b\uff1a * \u6bcf\u4e2a\u7d22\u5f15\u81f3\u5c11\u5360\u75288kb\u7684\u6570\u636e\u7a7a\u95f4 * \u6dfb\u52a0\u7d22\u5f15\u4f1a\u5bf9\u5199\u5165\u64cd\u4f5c\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\uff0c\u56e0\u6bcf\u4e2a\u63d2\u5165\u4e5f\u5fc5\u987b\u66f4\u65b0\u7d22\u5f15 * \u5177\u6709\u9ad8\u8bfb\u5199\u6bd4\u7387\u7684\u96c6\u5408\u901a\u5e38\u53d7\u76ca\u4e8e\u5176\u4ed6\u7d22\u5f15\uff0c\u7d22\u5f15\u4e0d\u5f71\u54cd\u672a\u521b\u5efa\u7d22\u5f15\u7684\u64cd\u4f5c * \u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u5185\u5b58","title":"\u6570\u636e\u6a21\u578b"},{"location":"MongoDB/#transactions","text":"\u53ef\u4ee5\u8de8\u591a\u4e2a\u64cd\u4f5c\u3001\u96c6\u5408\u3001\u6570\u636e\u5e93\u548c\u6587\u6863\u4f7f\u7528\u591a\u6587\u6863\u4e8b\u52a1 \u591a\u6587\u6863\u4e8b\u52a1\u662f\u539f\u5b50\u6027\u7684\uff1a * \u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u88ab\u4fdd\u5b58\u5e76\u5728\u4e8b\u52a1\u5916\u90e8\u53ef\u89c1\uff0c\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u524d\uff0c\u4e8b\u52a1\u4e2d\u53d1\u751f\u7684\u6570\u636e\u66f4\u6539\u4e8b\u52a1\u5916\u90e8\u4e0d\u53ef\u89c1\u3002 * \u4e8b\u52a1\u4e2d\u6b62\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u4f1a\u88ab\u4e22\u5f03\u4f46\u4e0d\u4f1a\u4e0d\u53ef\u89c1","title":"Transactions"},{"location":"MongoDB/#_27","text":"\u7d22\u5f15\u7684\u6392\u5e8f\u652f\u6301\u6709\u6548\u7684\u7b49\u5f0f\u5339\u914d\u548c\u57fa\u4e8e\u8303\u56f4\u7684\u67e5\u8be2\u64cd\u4f5c\uff0cmongodb\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u4e2d\u7684\u987a\u5e8f\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c \u5206\u7247\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u4e0d\u5c06_id\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u786e\u4fdd_id\u5b57\u6bb5\u503c\u7684\u552f\u4e00\u6027\u4ee5\u9632\u51fa\u9519","title":"\u7d22\u5f15"},{"location":"MongoDB/#_28","text":"\u5355\u5b57\u6bb5\u7d22\u5f15\uff1a\u5bf9\u4e8e\u5355\u5b57\u6bb5\u7d22\u5f15\u548c\u6392\u5e8f\u64cd\u4f5c\uff0c\u7d22\u5f15\u952e\u7684\u6392\u5e8f\u987a\u5e8f\u65e0\u5173\u7d27\u8981 \u590d\u5408\u7d22\u5f15\uff1aMongoDB\u652f\u6301\u591a\u5b57\u6bb5\u7684\u7528\u6237\u5b9a\u4e49\u7d22\u5f15\uff0c\u590d\u5408\u7d22\u5f15\u4e2d\u5b57\u6bb5\u7684\u987a\u5e8f\u5177\u6709\u91cd\u8981\u610f\u4e49 \u591a\u952e\u7d22\u5f15\uff1aMongoDB\u4f7f\u7528\u591a\u952e\u7d22\u5f15\u6765\u7d22\u5f15\u5b58\u50a8\u5728\u6570\u7ec4\u4e2d\u7684\u5185\u5bb9\uff0c\u5982\u679c\u7d22\u5f15\u5305\u542b\u6570\u7ec4\u7684\u5b57\u6bb5\uff0c\u5219\u4f1a\u4e3a\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u521b\u5efa\u5355\u72ec\u7684\u7d22\u5f15\u6761\u76ee\u3002 \u5730\u7406\u7a7a\u95f4\u7d22\u5f15\uff1amongodb\u63d0\u4f9b\u4e24\u4e2a\u7279\u6b8a\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5730\u7406\u7a7a\u95f4\u5750\u6807\u6570\u636e\u7684\u67e5\u8be2\uff0c2d\u7d22\u5f15\u4f7f\u7528\u5e73\u9762\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c\uff1b2dsphere\u7d22\u5f15\u4f7f\u7528\u7403\u5f62\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c \u6587\u672c\u7d22\u5f15\uff1amongodb\u63d0\u4f9btext\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5b57\u7b26\u4e32\u67e5\u8be2 \u6563\u5217\u7d22\u5f15\uff1aMongoDB\u63d0\u4f9b\u6563\u5217\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u57fa\u4e8e\u6563\u5217\u7684\u5206\u7247\uff0c\u8be5\u7c7b\u578b\u7d22\u5f15\u662f\u4e00\u4e2a\u5b57\u6bb5\u503c\u7684hash\uff0c\u7d22\u5f15\u5728\u5176\u8303\u56f4\u5185\u6709\u76f8\u5f53\u591a\u968f\u673a\u503c\u5206\u914d\uff0c\u4ec5\u652f\u6301\u76f8\u7b49\u5339\u914d\u4e0d\u652f\u6301\u8303\u56f4\u67e5\u8be2","title":"\u7d22\u5f15\u7c7b\u578b"},{"location":"MongoDB/#_29","text":"\u7d22\u5f15\u5177\u6709\u552f\u4e00\u6027\uff0cMongoDB\u62d2\u7edd\u7d22\u5f15\u5b57\u6bb5\u7684\u91cd\u590d\u503c\uff0c\u552f\u4e00\u7d22\u5f15\u53ef\u4e0e\u5176\u4ed6MongoDB\u7d22\u5f15\u4e92\u6362 \u90e8\u5206\u7d22\u5f15\u4ec5\u7d22\u5f15\u7b26\u5408\u6307\u5b9a\u8fc7\u6ee4\u5668\u8868\u8fbe\u5f0f\u7684\u96c6\u5408\u4e2d\u7684\u6587\u6863 \u7d22\u5f15\u7684\u7a00\u758f\u5c5e\u6027\u53ef\u786e\u4fdd\u7d22\u5f15\u4ec5\u5305\u542b\u5177\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863\u7684\u6761\u76ee\u3002\u7d22\u5f15\u4f1a\u8df3\u8fc7\u6ca1\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863 TTL\u7d22\u5f15\u662fMongoDB\u53ef\u7528\u4e8e\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\u7684\u7279\u6b8a\u7d22\u5f15\u3002\u8fd9\u5bf9\u4e8e\u67d0\u4e9b\u7c7b\u578b\u7684\u4fe1\u606f\u975e\u5e38\u7406\u60f3\uff0c\u4f8b\u5982\u673a\u5668\u751f\u6210\u7684\u4e8b\u4ef6\u6570\u636e\uff0c\u65e5\u5fd7\u548c\u4f1a\u8bdd\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ea\u9700\u8981\u5728\u6570\u636e\u5e93\u4e2d\u6301\u7eed\u6709\u9650\u7684\u65f6\u95f4","title":"\u7d22\u5f15\u5c5e\u6027"},{"location":"MongoDB/#_30","text":"\u4e00\u4e2a\u96c6\u5408\u5bf9\u591a\u53ea\u80fd\u6709\u4e00\u4e2atext\u7d22\u5f15,\u5bf9\u4e8etext\u7d22\u5f15\uff0c\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\u8868\u793a\u5b57\u6bb5\u76f8\u5bf9\u4e8e\u5176\u4ed6\u7d22\u5f15\u5b57\u6bb5\u5728\u6587\u672c\u641c\u7d22\u5206\u6570\u65b9\u9762\u7684\u91cd\u8981\u6027\uff0c\u5bf9\u4e8e\u6587\u6863\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u5b57\u6bb5\uff0cMongoDB\u5c06\u5339\u914d\u6570\u4e58\u4ee5\u6743\u91cd\u5e76\u5c06\u7ed3\u679c\u76f8\u52a0\u3002\u4f7f\u7528\u6b64\u603b\u548c\uff0cMongoDB\u7136\u540e\u8ba1\u7b97\u6587\u6863\u7684\u5206\u6570\u3002\u7d22\u5f15\u5b57\u6bb5\u7684\u9ed8\u8ba4\u6743\u91cd\u4e3a1\u3002\u8981\u8c03\u6574\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\uff0c\u8bf7weights\u5728db.collection.createIndex()\u65b9\u6cd5\u4e2d\u5305\u542b\u8be5\u9009\u9879 db.collection.createIndex( { field: \"text\" } ) text\u5728\u591a\u4e2a\u5b57\u6bb5\u4e0a\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\uff08 **\uff09\u3002\u4f7f\u7528\u901a\u914d\u7b26\u6587\u672c\u7d22\u5f15\uff0cMongoDB\u4f1a\u4e3a\u5305\u542b\u96c6\u5408\u4e2d\u6bcf\u4e2a\u6587\u6863\u7684\u5b57\u7b26\u4e32\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7f16\u5236\u7d22\u5f15\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\u521b\u5efa\u6587\u672c\u7d22\u5f15 db.collection.createIndex( { \" **\uff09\u3002\u4f7f\u7528\u901a\u914d\u7b26\u6587\u672c\u7d22\u5f15\uff0cMongoDB\u4f1a\u4e3a\u5305\u542b\u96c6\u5408\u4e2d\u6bcf\u4e2a\u6587\u6863\u7684\u5b57\u7b26\u4e32\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7f16\u5236\u7d22\u5f15\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\u521b\u5efa\u6587\u672c\u7d22\u5f15 db.collection.createIndex( { \" **\": \"text\" } ) \u6307\u5b9atext\u7d22\u5f15\u540d\u79f0\uff1a\u7d22\u5f15\u7684\u9ed8\u8ba4\u540d\u79f0\u7531\u6bcf\u4e2a\u7d22\u5f15\u540d\u79f0\u52a0_text\u7ec4\u6210\uff0c\u53ef\u81ea\u5b9a\u4e49\u7d22\u5f15\u540d\u79f0;db.collection.createIndex( { content: \"text\", \"user.comments\": \"text\"}, { name: \"myTextName\"} ) \u7528\u6743\u91cd\u63a7\u5236\u641c\u7d22\u7ed3\u679c\uff1a\u4ee5\u4e0b\u4e3a\u8bbe\u7f6econtent\u548ckeywords\u7d22\u5f15\u6743\u91cd\u5206\u522b\u4e3a10\u548c5\uff0cabout\u9ed8\u8ba4\u4e3a1 db.blog.createIndex( content: \"text\", keywords: \"text\", about: \"text\" }, { weights: { content: 10, keywords: 5 }, name: \"TextIndex\" } ) \u9650\u5236\u6587\u6863\u626b\u63cf\u6570\u91cf\uff1a\u6587\u6863\u7ed3\u6784\u5982\u4e0b { _id : 1 , dept : \"tech\" , description : \"lime green computer\" } { _id : 2 , dept : \"tech\" , description : \"wireless red mouse\" } { _id : 3 , dept : \"kitchen\" , description : \"green placemat\" } { _id : 4 , dept : \"kitchen\" , description : \"red peeler\" } { _id : 5 , dept : \"food\" , description : \"green apple\" } { _id : 6 , dept : \"food\" , description : \"red potato\" } db.in","title":"\u6587\u672c\u7d22\u5f15"},{"location":"MongoDB/#_31","text":"","title":"\u5b89\u5168"},{"location":"MongoDB/#change-streams","text":"","title":"Change Streams"},{"location":"MongoDB/#replication","text":"","title":"\u590d\u5236(Replication)"},{"location":"MongoDB/#sharding","text":"","title":"\u5206\u7247(Sharding)"},{"location":"MongoDB/#administration","text":"","title":"\u7ba1\u7406(Administration)"},{"location":"MongoDB/#storage","text":"","title":"\u5b58\u50a8\u5f15\u64ce(Storage)"},{"location":"MongoDB/#mongodb-kafka","text":"Debezium\u7684MongoDB Connector\u53ef\u4ee5\u76d1\u89c6MongoDB\u526f\u672c\u96c6\u6216MongoDB\u5206\u7247\u96c6\u7fa4 \uff1b MongoDB\u590d\u5236\u7684\u5de5\u4f5c\u539f\u7406\u662f\u8ba9Master\u8bb0\u5f55\u5176oplog \uff08\u6216\u64cd\u4f5c\u65e5\u5fd7\uff09\u4e2d\u7684\u66f4\u6539\uff0c\u7136\u540e\u6bcf\u4e2a Slave\u8282\u70b9\u8bfb\u53d6\u4e3b\u8981\u7684oplog\u5e76\u6309\u987a\u5e8f\u5e94\u7528\u6240\u6709\u64cd\u4f5c\u5230\u4ed6\u4eec\u81ea\u5df1\u7684\u6587\u6863 \u3002\u5c06\u65b0\u670d\u52a1\u5668\u6dfb\u52a0\u5230\u526f\u672c\u96c6\u65f6\uff0c\u8be5\u670d\u52a1\u5668\u9996\u5148\u6267\u884c\u521d\u59cb\u540c\u6b65\u4e3b\u6570\u636e\u5e93\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93\u548c\u96c6\u5408\uff0c\u7136\u540e\u8bfb\u53d6\u4e3b\u6570\u636e\u5e93\u7684 oplog\u4ee5\u5e94\u7528\u81ea\u5f00\u59cb\u540c\u6b65\u4ee5\u6765\u53ef\u80fd\u5df2\u7ecf\u8fdb\u884c\u7684\u6240\u6709\u66f4\u6539 \u3002\u8fd9\u4e2a\u65b0\u670d\u52a1\u5668\u5728\u8d76\u4e0a Master\u8282\u70b9oplog\u7684\u5c3e\u90e8\u65f6\u6210\u4e3aSlave\u670d\u52a1\u5668 \uff08\u5e76\u4e14\u80fd\u591f\u5904\u7406\u67e5\u8be2\uff09 Debezium MongoDB Connector\u4f7f\u7528\u76f8\u540c\u7684\u590d\u5236\u673a\u5236 \uff0c\u4f46\u5b83\u5b9e\u9645\u4e0a\u5e76\u4e0d\u6210\u4e3a\u526f\u672c\u96c6\u7684\u6210\u5458\uff0c Connector\u59cb\u7ec8\u8fde\u63a5\u526f\u672c\u96c6\u7684\u4e3b\u8282\u70b9\u6765\u8ddf\u8e2aoplog \uff0c MongoDB\u91cd\u65b0\u9009\u4e3e\u4e3b\u8282\u70b9\u540e \uff0c Connector\u4f1a\u81ea\u52a8\u5207\u6362\u5230\u65b0\u7684\u4e3b\u8282\u70b9 \u3002 Connector\u4f1a\u8bb0\u5f55oplog\u7684\u4f4d\u7f6e \uff0c\u6765\u5b9e\u73b0\u589e\u91cf\u540c\u6b65\u3002 Debezium MongoDB Connector\u548c\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6 \uff0c\u53ea\u9700\u5c06\u526f\u672c\u96c6\u7684\u5730\u5740\u4f5c\u4e3a Connector\u7684seed\u5730\u5740mongodb . hosts\u5373\u53ef \u3002 Connector\u4f7f\u7528seed\u8fde\u63a5\u526f\u672c\u96c6 \uff0c\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u6210\u5458\u96c6\u53ca\u786e\u5b9a\u4e3b\u8282\u70b9\u540e\u3002 Connector\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u5e76\u4ece\u5176oplog\u6355\u83b7\u66f4\u6539 \u3002 Connector\u548c\u5206\u7247\u96c6\u7fa4\u4e00\u8d77\u4f7f\u7528\u65f6 \uff0c\u4f7f\u7528 config\u670d\u52a1\u5668\u7684\u5730\u5740\u914d\u7f6eConnector\u8fde\u63a5 \u3002\u9488\u5bf9\u5206\u7247\u7fa4\u96c6\u8fd0\u884c\u8fde\u63a5\u5668\u65f6\uff0c\u8bf7\u4f7f\u7528 tasks . max\u5927\u4e8e\u526f\u672c\u96c6\u6570\u91cf\u7684\u503c , \u8fd9\u5c06\u5141\u8bb8\u8fde\u63a5\u5668\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\uff0c\u5e76\u8ba9 Kafka Connect\u5728\u6240\u6709\u53ef\u7528\u7684\u5de5\u4f5c\u8fdb\u7a0b\u4e2d\u534f\u8c03 \uff0c\u5206\u53d1\u548c\u7ba1\u7406\u4efb\u52a1 mongodb . name \uff0c\u5b83\u5145\u5f53 MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u7684\u903b\u8f91\u540d\u79f0 , \u8fde\u63a5\u5668\u4ee5\u591a\u79cd\u65b9\u5f0f\u4f7f\u7528\u903b\u8f91\u540d\u79f0\uff1a\u4f5c\u4e3a\u6240\u6709\u4e3b\u9898\u540d\u79f0\u7684\u524d\u7f00\uff0c\u4ee5\u53ca\u8bb0\u5f55\u6bcf\u4e2a\u526f\u672c\u96c6\u7684 oplog\u4f4d\u7f6e\u65f6\u7684\u552f\u4e00\u6807\u8bc6\u7b26 \u3002","title":"MongoDB--&gt;kafka"},{"location":"MongoDB/#topics-name","text":"Connector\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\u7684insert \u3001 update \u3001 delete\u6587\u6863\u64cd\u4f5c\u5199\u5165\u4e8b\u4ef6\u5230\u6bcf\u4e2akafka topic \u3002 kafka topic\u7684\u540d\u5b57\u89c4\u5219logicalName . databaseName . collectionName \uff0c logicalName\u662f\u914d\u7f6e\u5c5e\u6027mongodb . name\u6307\u5b9a\u7684\u8fde\u63a5\u5668\u7684\u540d\u79f0 , databaseName\u662f\u53d1\u751f\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u540d\u79f0 , collectionName\u662f\u53d7\u5f71\u54cd\u6587\u6863\u6240\u5728\u7684MongoDB\u96c6\u5408\u7684\u540d\u79f0 \u3002\u4f8b\u5982\uff1a MongoDB\u6570\u636e\u5e93inventory\u5305\u542b\u56db\u4e2a\u96c6\u5408 \uff1a products , product_on_hand , customers , orders \u3002\u5047\u8bbe\u76d1\u89c6\u6b64\u6570\u636e\u5e93\u7684\u8fde\u63a5\u5668\u903b\u8f91\u540d\u79f0\u662f fulfillment \uff0c\u5219\u8fde\u63a5\u5668\u751f\u6210\u7684\u56db\u4e2a kafka topic\u4e8b\u4ef6\u4e3a \uff1a fulfillment . inventory . products fulfillment . inventory . products_on_hand fulfillment . inventory . customers fulfillment . inventory . orders","title":"topics name"},{"location":"MongoDB/#partitions","text":"MongoDB\u8fde\u63a5\u5668\u4e0d\u4f1a\u660e\u786e\u786e\u5b9a\u4e8b\u4ef6\u7684topic\u5206\u533a , \u76f8\u53cd\uff0c\u5b83\u5141\u8bb8 Kafka\u6839\u636e\u5bc6\u94a5\u786e\u5b9a\u5206\u533a \u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 Kafka Connect\u5de5\u4f5c\u7a0b\u5e8f\u914d\u7f6e\u4e2d\u5b9a\u4e49Partitioner\u5b9e\u73b0\u7684\u540d\u79f0\u6765\u66f4\u6539Kafka\u7684\u5206\u533a\u903b\u8f91 \u3002","title":"Partitions"},{"location":"MongoDB/#events","text":"MongoDB\u8fde\u63a5\u5668\u751f\u6210\u7684\u6570\u636e\u66f4\u6539\u4e8b\u4ef6\u90fd\u6709\u4e00\u4e2akey\u548cvalue \u3002\u4e0b\u9762\u6982\u8ff0\u4e86\u8fd9\u4e9b key\u548cvalue\u7684\u7ed3\u6784 \u4ece kafka0 . 10 \u5f00\u59cb\uff0c\u53ef\u4ee5\u4f7f\u7528\u6d88\u606f\u5bc6\u94a5\u8fdb\u884c\u8bb0\u5f55\u5e76\u521b\u5efa\u6d88\u606f\u7684\u65f6\u95f4\u6233 ( \u7531\u751f\u4ea7\u8005\u8bb0\u5f55 ) \u6216\u7531 kafka\u5199\u5165\u65e5\u5fd7\u7684\u503c\u8fdb\u884c\u8bc4\u4f30 \u5982\u679c\u4e8b\u4ef6\u7684\u6765\u6e90\u5728\u7ed3\u6784\u4e0a\u53d1\u751f\u53d8\u5316\u6216\u8fde\u63a5\u5668\u6539\u53d8\uff0c\u4e8b\u4ef6\u7684\u7ed3\u6784\u53ef\u80fd\u4f1a\u968f\u7740\u65f6\u95f4\u63a8\u79fb\u800c\u53d1\u751f\u53d8\u5316\u3002\u5bf9\u4e8e\u6d88\u8d39\u8005\u53ef\u80fd\u5f88\u96be\u5904\u7406\u3002\u56e0\u6b64 kafka\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u81ea\u6210\u4e00\u4f53 \uff0c\u6bcf\u4e2a\u6d88\u606f\u952e\u503c\u90fd\u6709\u4e24\u90e8\u5206 : a schema\u548cpayload \u3002\u5f53 payload\u5305\u542b\u6570\u636e\u65f6 \uff0c schema\u63cf\u8ff0payload\u7684\u7ed3\u6784 \u3002 \u66f4\u6539\u4e8b\u4ef6\u7684 key \uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u96c6\u5408\uff0c\u66f4\u6539\u4e8b\u4ef6\u7684 key\u5c06\u662f\u5305\u542b\u5355\u4e2aid\u5b57\u6bb5\u7684\u7ed3\u6784 \u3002\u5b83\u7684\u503c\u662f\u6587\u6863\u7684\u6807\u8bc6\u7b26\u8868\u793a\u4e3a\u5b57\u7b26\u4e32\u3002 MongoDB\u4e0d\u53ef\u7528\u65f6\uff0c\u91cd\u65b0\u5c1d\u8bd5\u8fde\u63a5\u7531\u4e09\u4e2a\u5c5e\u6027\u63a7\u5236\uff1a connect.backoff.initial.delay.ms -- \u7b2c\u4e00\u6b21\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09 connect.backoff.max.delay.ms --- \u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u6700\u5927\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09 connect.max.attempts ------------ \u4ea7\u751f\u9519\u8bef\u4e4b\u524d\u7684\u6700\u5927\u5c1d\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a16","title":"Events"},{"location":"MongoDB/#connector","text":"\u5c5e\u6027 \u9ed8\u8ba4 \u63cf\u8ff0 name \u8fde\u63a5\u5668\u7684\u552f\u4e00\u540d\u79f0\u3002\u5c1d\u8bd5\u518d\u6b21\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u6ce8\u518c\u5c06\u5931\u8d25\u3002\uff08\u6240\u6709Kafka Connect\u8fde\u63a5\u5668\u90fd\u9700\u8981\u6b64\u5c5e\u6027\u3002\uff09 connector.class \u8fde\u63a5\u5668\u7684Java\u7c7b\u7684\u540d\u79f0\u3002\u59cb\u7ec8\u4f7f\u7528io.debezium.connector.mongodb.MongoDbConnectorMongoDB\u8fde\u63a5\u5668\u7684\u503c\u3002 mongodb.hosts \u526f\u672c\u96c6\u4e2dMongoDB\u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\uff08\u683c\u5f0f\u4e3a\u201chost\u201d\u6216\u201chost\uff1aport\u201d\uff09\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u8be5\u5217\u8868\u53ef\u4ee5\u5305\u542b\u5355\u4e2a\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\u3002\u5982\u679cmongodb.members.auto.discover\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u4e3b\u673a\u548c\u7aef\u53e3\u5bf9\u5e94\u4ee5\u526f\u672c\u96c6\u540d\u79f0\u4e3a\u524d\u7f00\uff08\u4f8b\u5982\uff0crs0/localhost:27017\uff09\u3002 mongodb.name \u4e00\u4e2a\u552f\u4e00\u540d\u79f0\uff0c\u7528\u4e8e\u6807\u8bc6\u6b64\u8fde\u63a5\u5668\u76d1\u89c6\u7684\u8fde\u63a5\u5668\u548c/\u6216MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u3002\u6bcf\u4e2a\u670d\u52a1\u5668\u6700\u591a\u5e94\u7531\u4e00\u4e2aDebezium\u8fde\u63a5\u5668\u76d1\u63a7\uff0c\u56e0\u4e3a\u6b64\u670d\u52a1\u5668\u540d\u79f0\u524d\u7f00\u662fMongoDB\u526f\u672c\u96c6\u6216\u96c6\u7fa4\u53d1\u51fa\u7684\u6240\u6709\u6301\u4e45\u6027Kafka\u4e3b\u9898\u3002 mongodb.user \u8fde\u63a5\u5230MongoDB\u65f6\u8981\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7528\u6237\u7684\u540d\u79f0\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.password \u8fde\u63a5MongoDB\u65f6\u4f7f\u7528\u7684\u5bc6\u7801\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.ssl.enabled false Connector\u5c06\u4f7f\u7528SSL\u8fde\u63a5\u5230MongoDB\u5b9e\u4f8b\u3002 mongodb.ssl.invalid.hostname.allowed false \u542f\u7528S\u200b\u200bSL\u65f6\uff0c\u6b64\u8bbe\u7f6e\u63a7\u5236\u5728\u8fde\u63a5\u9636\u6bb5\u662f\u5426\u7981\u7528\u4e25\u683c\u4e3b\u673a\u540d\u68c0\u67e5\u3002\u5982\u679ctrue\u8fde\u63a5\u4e0d\u4f1a\u963b\u6b62\u4e2d\u95f4\u4eba\u653b\u51fb\u3002 database.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u76d1\u89c6\u7684\u6570\u636e\u5e93\u540d\u79f0; \u672a\u5217\u5165\u767d\u540d\u5355\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u90fd\u5c06\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5c06\u76d1\u89c6\u6240\u6709\u6570\u636e\u5e93\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.blacklist\u3002 database.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u7684\u6570\u636e\u5e93\u540d\u79f0; \u5c06\u76d1\u63a7\u9ed1\u540d\u5355\u4e2d\u672a\u5305\u542b\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.whitelist\u3002 collection.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914d\u8981\u76d1\u89c6\u7684MongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4; \u4efb\u4f55\u672a\u5305\u542b\u5728\u767d\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u88ab\u6392\u9664\u5728\u76d1\u63a7\u4e4b\u5916\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fde\u63a5\u5668\u5c06\u76d1\u89c6\u9664local\u548cadmin\u6570\u636e\u5e93\u4e2d\u7684\u96c6\u5408\u4e4b\u5916\u7684\u6240\u6709\u96c6\u5408\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.blacklist\u3002 collection.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914dMongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u4ece\u76d1\u89c6\u4e2d\u6392\u9664; \u4efb\u4f55\u672a\u5305\u542b\u5728\u9ed1\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u53d7\u5230\u76d1\u63a7\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.whitelist\u3002 \" snapshot.mode 0.9.2\u53ca\u66f4\u9ad8\u7248\u672c initial \u6307\u5b9a\u5728\u542f\u52a8\u8fde\u63a5\u5668\u65f6\u8fd0\u884c\u5feb\u7167\u7684\u6761\u4ef6\uff08\u4f8b\u5982\uff0c\u521d\u59cb\u540c\u6b65\uff09\u3002\u9ed8\u8ba4\u503c\u4e3ainitial\uff0c\u5e76\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u672a\u627e\u5230\u504f\u79fb\u91cf\u6216oplog\u4e0d\u518d\u5305\u542b\u5148\u524d\u504f\u79fb\u91cf\u65f6\u8bfb\u53d6\u5feb\u7167\u3002\u5728\u4ece\u4e0d\u9009\u9879\u6307\u5b9a\u8fde\u63a5\u5668\u4e0d\u5e94\u8be5\u4f7f\u7528\u5feb\u7167\uff0c\u800c\u4e0d\u662f\u8fde\u63a5\u5668\u5e94\u7740\u624b\u5c3e\u65e5\u5fd7\u3002 \" field.blacklist 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u5e94\u8be5\u4ece\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u6392\u9664\u7684\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u53ef\u9009\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\u3002 \" field.renames 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u5b8c\u6574\u9650\u5b9a\u5b57\u6bb5\u66ff\u6362\u5217\u8868\uff0c\u7528\u4e8e\u91cd\u547d\u540d\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u7684\u5b57\u6bb5\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u66ff\u6362\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff1anewNestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\uff0c\u5192\u53f7\u5b57\u7b26\uff08:)\u7528\u4e8e\u786e\u5b9a\u5b57\u6bb5\u7684\u91cd\u547d\u540d\u6620\u5c04\u3002\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u5c06\u5e94\u7528\u4e8e\u5217\u8868\u4e2d\u4e0a\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u5728\u91cd\u547d\u540d\u540c\u4e00\u8def\u5f84\u4e2d\u7684\u591a\u4e2a\u5b57\u6bb5\u65f6\u8bf7\u8bb0\u4f4f\u8fd9\u4e00\u70b9\u3002 tasks.max 1 \u5e94\u4e3a\u6b64\u8fde\u63a5\u5668\u521b\u5efa\u7684\u6700\u5927\u4efb\u52a1\u6570\u3002MongoDB\u8fde\u63a5\u5668\u5c06\u5c1d\u8bd5\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u4f7f\u7528\u5355\u72ec\u7684\u4efb\u52a1\uff0c\u56e0\u6b64\u5728\u5c06\u8fde\u63a5\u5668\u4e0e\u5355\u4e2aMongoDB\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u9ed8\u8ba4\u503c\u662f\u53ef\u63a5\u53d7\u7684\u3002\u5c06\u8fde\u63a5\u5668\u4e0eMongoDB\u5206\u7247\u7fa4\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u5efa\u8bae\u6307\u5b9a\u4e00\u4e2a\u7b49\u4e8e\u6216\u5927\u4e8e\u7fa4\u96c6\u4e2d\u5206\u7247\u6570\u7684\u503c\uff0c\u4ee5\u4fbfKafka Connect\u53ef\u4ee5\u5206\u914d\u6bcf\u4e2a\u526f\u672c\u96c6\u7684\u5de5\u4f5c\u3002 initial.sync.max.threads 1 \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u7528\u4e8e\u5728\u526f\u672c\u96c6\u4e2d\u6267\u884c\u96c6\u5408\u7684\u521d\u59cb\u540c\u6b65\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002\u9ed8\u8ba4\u4e3a1\u3002 \" tombstones.on.delete 0.7.3\u53ca\u4ee5\u540e true \u63a7\u5236\u662f\u5426\u5e94\u5728\u5220\u9664\u4e8b\u4ef6\u540e\u751f\u6210\u903b\u8f91\u5220\u9664\u4e8b\u4ef6\u3002 \u5f53true\u5220\u9664\u64cd\u4f5c\u662f\u901a\u8fc7\u5220\u9664\u4e8b\u4ef6\u548c\u968f\u540e\u7684\u5893\u7891\u4e8b\u4ef6\u8868\u793a\u3002\u5982\u679cfalse\u53ea\u53d1\u9001\u5220\u9664\u4e8b\u4ef6\u3002 \u53d1\u9001\u903b\u8f91\u5220\u9664\u4e8b\u4ef6\uff08\u9ed8\u8ba4\u884c\u4e3a\uff09\u5141\u8bb8Kafka\u5728\u5220\u9664\u6e90\u8bb0\u5f55\u540e\u5b8c\u5168\u5220\u9664\u4e0e\u7ed9\u5b9a\u5bc6\u94a5\u6709\u5173\u7684\u6240\u6709\u4e8b\u4ef6\u3002 \" snapshot.delay.ms0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u8fde\u63a5\u5668\u5728\u542f\u52a8\u540e\u62cd\u6444\u5feb\u7167\u4e4b\u524d\u5e94\u7b49\u5f85\u7684\u95f4\u9694\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09;\u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u542f\u52a8\u591a\u4e2a\u8fde\u63a5\u5668\u65f6\u907f\u514d\u5feb\u7167\u4e2d\u65ad\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fde\u63a5\u5668\u91cd\u65b0\u5e73\u8861 \u4ee5\u4e0b\u9ad8\u7ea7\u914d\u7f6e\u5c5e\u6027\u5177\u6709\u826f\u597d\u7684\u9ed8\u8ba4\u503c\uff0c\u53ef\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u56e0\u6b64\u5f88\u5c11\u9700\u8981\u5728\u8fde\u63a5\u5668\u7684\u914d\u7f6e\u4e2d\u6307\u5b9a\u3002 | \u5c5e\u6027 | \u9ed8\u8ba4 | \u63cf\u8ff0 | | :--: | :--: | :--: | | max.queue.size | 8192 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u5c06\u6570\u636e\u5e93\u65e5\u5fd7\u5199\u5165Kafka\u4e4b\u524d\u5c06\u66f4\u6539\u4e8b\u4ef6\u4ece\u6570\u636e\u5e93\u65e5\u5fd7\u4e2d\u8bfb\u53d6\u7684\u963b\u585e\u961f\u5217\u7684\u6700\u5927\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u5f53\u5199\u5165Kafka\u8f83\u6162\u6216\u8005Kafka\u4e0d\u53ef\u7528\u65f6\uff0c\u6b64\u961f\u5217\u53ef\u4ee5\u5411oplog\u8bfb\u53d6\u5668\u63d0\u4f9b\u53cd\u538b\u3002\u961f\u5217\u4e2d\u51fa\u73b0\u7684\u4e8b\u4ef6\u4e0d\u5305\u542b\u5728\u6b64\u8fde\u63a5\u5668\u5b9a\u671f\u8bb0\u5f55\u7684\u504f\u79fb\u4e2d\u3002\u9ed8\u8ba4\u4e3a8192\uff0c\u5e76\u4e14\u5e94\u59cb\u7ec8\u5927\u4e8emax.batch.size\u5c5e\u6027\u4e2d\u6307\u5b9a\u7684\u6700\u5927\u6279\u91cf\u5927\u5c0f\u3002 | | max.batch.size | 2048 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u6b64\u8fde\u63a5\u5668\u7684\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u5904\u7406\u7684\u6bcf\u6279\u4e8b\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u3002\u9ed8\u8ba4\u4e3a2048\u3002 | | poll.interval.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u51fa\u73b0\u7684\u6beb\u79d2\u6570\uff0c\u4ee5\u663e\u793a\u65b0\u7684\u66f4\u6539\u4e8b\u4ef6\u3002\u9ed8\u8ba4\u4e3a1000\u6beb\u79d2\u62161\u79d2\u3002 | | connect.backoff.initial.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u521d\u59cb\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09\u3002 | | connect.backoff.max.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u91cd\u590d\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u6700\u5927\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09\u3002 | | connect.max.attempts | 16 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u53d1\u751f\u5f02\u5e38\u5e76\u4e14\u4efb\u52a1\u4e2d\u6b62\u4e4b\u524d\uff0c\u5bf9\u526f\u672c\u96c6\u4e3b\u8981\u8fde\u63a5\u5c1d\u8bd5\u5931\u8d25\u7684\u6700\u5927\u6b21\u6570\u3002\u7f3a\u7701\u503c\u4e3a16\uff0c\u5176\u4e0e\u9ed8\u8ba4\u503cconnect.backoff.initial.delay.ms\u548cconnect.backoff.max.delay.ms\u5931\u6548\u4e4b\u524d\u5bfc\u81f4\u4ec5\u670920\u591a\u5206\u949f\u7684\u5c1d\u8bd5\u3002 | | mongodb.members.auto.discover | true | \u5e03\u5c14\u503c\uff0c\u6307\u5b9a'mongodb.hosts'\u4e2d\u7684\u5730\u5740\u662f\u5426\u5e94\u8be5\u7528\u4e8e\u53d1\u73b0\u96c6\u7fa4\u6216\u526f\u672c\u96c6\uff08true\uff09\u7684\u6240\u6709\u6210\u5458\u7684\u79cd\u5b50\uff0c\u6216\u8005\u662f\u5426mongodb.hosts\u5e94\u8be5\u6309\u539f\u6837\u4f7f\u7528\u5730\u5740\uff08false\uff09\u3002\u9ed8\u8ba4\u503c\u662ftrue\u5e76\u4e14\u5e94\u8be5\u5728\u6240\u6709\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u9664\u975eMongoDB \u7531\u4ee3\u7406\u63d0\u4f9b | \u5b89\u88c5debezium-connector-mongodb \u542f\u52a8zookeeper zookeeper-server-start zookeeper.properties \u542f\u52a8kafka kafka-server-start server.properties \u542f\u52a8schema-registry-start schema-registry.properties export CLASSPATH=/path/to/my/connectors/* \u542f\u52a8connect-standalone /schema-registry/ connect-avro-standalone.properties kafka/connect-mongo-source.properties \u542f\u52a8kafka consumer kafka-console-consumer --zookeeper localhost:2181 --topic test.test.test --from-beginning schema-registry/connect-avro-distributed.properties\u6dfb\u52a0debezium-connector-mongodb\u7684plugin.path= \u914d\u7f6eDebezium MongoDB connector connect.json { \"name\": \"inventory-connector\", (1) \"config\": { \"connector.class\": \"io.debezium.connector.mongodb.MongoDbConnector\", (2) \"mongodb.hosts\": \"rs0/192.168.99.100:27017\", (3) \"mongodb.name\": \"fullfillment\", (4) \"collection.whitelist\": \"inventory[.]*\", (5) } } 1 \u6211\u4eec\u4f7f\u7528Kafka Connect\u670d\u52a1\u6ce8\u518c\u65f6\u7684\u8fde\u63a5\u5668\u540d\u79f0\u3002 2 MongoDB\u8fde\u63a5\u5668\u7c7b\u7684\u540d\u79f0\u3002 3 \u7528\u4e8e\u8fde\u63a5MongoDB\u526f\u672c\u96c6\u7684\u4e3b\u673a\u5730\u5740 4 \u8be5MongoDB\u7684\u526f\u672c\u96c6\u903b\u8f91\u540d\u79f0\uff0c\u5f62\u6210\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u5e76\u5728kafka\u7684topics\uff0ckafka\u8fde\u63a5\u67b6\u6784\u540d\u79f0\u4e2d\u7684\u6240\u6709\u540d\u79f0\u4f7f\u7528\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684Avro\u67b6\u6784\u7684\u547d\u540d\u7a7a\u95f4\u65f6\u7684Avro\u4f7f\u7528\u3002 5 \u4e0e\u8981\u76d1\u89c6\u7684\u6240\u6709\u96c6\u5408\u7684\u96c6\u5408\u540d\u79f0\u7a7a\u95f4\uff08\u4f8b\u5982\uff0cdbName collectionName\uff09\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\u3002\u8fd9\u662f\u53ef\u9009\u7684\u3002 \u52a0\u8f7d\u8fde\u63a5\u5c31\u662f\u914d\u7f6econnect-mongo-source.properties curl -i -X POST -H \"Accept:application/json\" -H \"Content-Type:application/json\" http://localhost:8084/connectors/ -d @/etc/kafka/mongodb.json \u67e5\u770bkafka\u7684topics kafka-topics --zookeeper localhost:2181 --list db.getCollection(\"rent_houses\").find({ \"price\": { \" lte\": 2000 }, \"title\": { \" lte\": 2000 }, \"title\": { \" in\": [ /\u8f6c\u79df/,/\u6574\u79df/ ] } })","title":"Connector\u5c5e\u6027"},{"location":"Monitors/","text":"\u5176\u4ed6\u76d1\u63a7\u5de5\u5177 \u00b6 \u5c0f\u5de5\u5177\u96c6 \u00b6 htop--iftop--ntop OpenTSDB \u00b6 TICK \u00b6","title":"Monitors"},{"location":"Monitors/#_1","text":"","title":"\u5176\u4ed6\u76d1\u63a7\u5de5\u5177"},{"location":"Monitors/#_2","text":"htop--iftop--ntop","title":"\u5c0f\u5de5\u5177\u96c6"},{"location":"Monitors/#opentsdb","text":"","title":"OpenTSDB"},{"location":"Monitors/#tick","text":"","title":"TICK"},{"location":"MySQL/","text":"MySQL \u00b6 \u6570\u636e\u5b9a\u4e49\u8bed\u8a00 ( DDL \uff0c Data Defintion Language ) \u8bed\u53e5\uff1a\u6570\u636e\u5b9a\u4e49\u8bed\u53e5\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540c\u7684\u6570\u636e\u6bb5\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5217\u3001\u7d22\u5f15\u7b49\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62ec create \u3001 drop \u3001 alter\u7b49 \u6570\u636e\u64cd\u4f5c\u8bed\u8a00 ( DML \uff0c Data Manipulation Language ) \u8bed\u53e5\uff1a\u6570\u636e\u64cd\u7eb5\u8bed\u53e5\uff0c\u7528\u4e8e\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u65b0\u548c\u67e5\u8be2\u6570\u636e\u5e93\u8bb0\u5f55\uff0c\u5e76\u68c0\u67e5\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u4e3b\u8981\u5305\u62ec insert \u3001 delete \u3001 update\u548cselect\u7b49 \u6570\u636e\u63a7\u5236\u8bed\u8a00 ( DCL \uff0c Data Control Language ) \u8bed\u53e5\uff1a\u6570\u636e\u63a7\u5236\u8bed\u53e5\uff0c\u7528\u4e8e\u63a7\u5236\u4e0d\u540c\u6570\u636e\u6bb5\u76f4\u63a5\u7684\u8bb8\u53ef\u548c\u8bbf\u95ee\u7ea7\u522b\u7684\u8bed\u53e5\u3002\u8fd9\u4e9b\u8bed\u53e5\u5b9a\u4e49\u4e86\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u3001\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u548c\u5b89\u5168\u7ea7\u522b\u3002\u4e3b\u8981\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62ec grant \u3001 revoke\u7b49 \u5b89\u88c5mysql \u00b6 MySQL 5 . 7 . 6 and later : ALTER USER ' root ' @ ' localhost ' IDENTIFIED BY ' MyNewPass ' ; MySQL 5 . 7 . 5 and earlier : SET PASSWORD FOR ' root ' @ ' localhost ' = PASSWORD ( ' MyNewPass ' ) ; flush privileges \u4ece\u4efb\u4f55\u4e3b\u673a\u4e0a\u4f7f\u7528 root \u7528\u6237\uff0c\u5bc6\u7801\uff1a youpassword \uff08\u4f60\u7684 root \u5bc6\u7801\uff09\u8fde\u63a5\u5230 mysql \u670d\u52a1\u5668\uff1a GRANT ALL PRIVILEGES ON * . * TO ' root ' @ ' % ' IDENTIFIED BY ' youpassword ' WITH GRANT OPTION ; MySQL\u914d\u7f6e\u6587\u4ef6 \u00b6 [ client ] #password = your_password port = 3306 socket = / tmp / mysql . sock [ mysqld ] user = mysql port = 3306 socket = / tmp / mysql . sock datadir = / www / server / data #default_storage_engine = MyISAM default_storage_engine = InnoDB #skip - external - locking #loose - skip - innodb key_buffer_size = 8 M max_allowed_packet = 100 G table_open_cache = 32 sort_buffer_size = 256 K join_buffer_size = 256 k net_buffer_length = 4 K read_buffer_size = 128 K read_rnd_buffer_size = 256 K myisam_sort_buffer_size = 4 M thread_cache_size = 4 thread_concurrency = 2 thread_stack = 192 k query_cache_size = 4 M query_cache_limit = 1 M query_cache_min_res_unit = 2 k long_query_time = 1 tmp_table_size = 8 M max_head_table_size = 2 M binlog_cache_size = 1 M max_binlog_cache_size = 1 M max_binlog_size = 2 M external - locking = FALSE bulk_insert_buffer_size = 1 M lower_case_table_names = 1 slave - skip - errors = 1032 , 1062 replicate - ignore - db = mysql #skip - networking #skip - name - resolve max_connections = 500 max_connect_errors = 100 open_files_limit = 65535 back_log = 600 table_cache = 614 log - bin = mysql - bin # \u6ce8\u610f\u8981\u5728 [ mysqld ] \u4e2d\u914d\u7f6e binlog_format = mixed server - id = 1 # \u4e3b\u4ece\u590d\u5236\u591a\u5b9e\u4f8b\u4e2did\u5747\u4e0d\u80fd\u76f8\u540c\u4e5f\u8981\u5728 [ mysqld ] \u4e2d\u914d\u7f6e expire_logs_days = 10 default_storage_engine = InnoDB innodb_data_home_dir = / www / server / data innodb_data_file_path = ibdata1 : 10 M : autoextend innodb_log_group_home_dir = / www / server / data innodb_buffer_pool_size = 16 M innodb_additional_mem_pool_size = 2 M innodb_log_file_size = 5 M innodb_log_buffer_size = 8 M innodb_flush_log_at_trx_commit = 1 innodb_lock_wait_timeout = 50 innodb_file_io_threads = 4 innodb_thread_concurrency = 8 innodb_log_files_in_group = 3 innodb_max_dirty_pages_pct = 90 innodb_file_per_table = 0 [ mysqldump ] quick max_allowed_packet = 16 M [ mysql ] no - auto - rehash [ myisamchk ] key_buffer_size = 20 M sort_buffer_size = 20 M read_buffer = 2 M write_buffer = 2 M [ mysqlhotcopy ] interactive - timeout mysql\u76f8\u5173\u547d\u4ee4 \u00b6 mysql \u00b6 Usage : mysql [ OPTIONS ] [ database ] - ?, -- help Display this help and exit . - I , -- help Synonym for - ? -- auto - rehash Enable automatic rehashing . One doesn ' t need to use ' rehash ' to get table and field completion , but startup and reconnecting may take a longer time . Disable with -- disable - auto - rehash . ( Defaults to on ; use --skip-auto-rehash to disable.) - A , -- no - auto - rehash No automatic rehashing . One has to use ' rehash ' to get table and field completion . This gives a quicker start of mysql and disables rehashing on reconnect . -- auto - vertical - output Automatically switch to vertical output mode if the result is wider than the terminal width . - B , -- batch Don ' t use history file. Disable interactive behavior. ( Enables -- silent . ) -- bind - address = name IP address to bind to . -- binary - as - hex Print binary data as hex -- character - sets - dir = name Directory for character set files . -- column - type - info Display column type information . - c , -- comments Preserve comments . Send comments to the server . The default is -- skip - comments ( discard comments ) , enable with -- comments . - C , -- compress Use compression in server / client protocol . - #, -- debug [ = #] This is a non - debug version . Catch this and exit . -- debug - check This is a non - debug version . Catch this and exit . - T , -- debug - info This is a non - debug version . Catch this and exit . - D , -- database = name Database to use . -- default - character - set = name Set the default character set . -- delimiter = name Delimiter to be used . -- enable - cleartext - plugin Enable / disable the clear text authentication plugin . - e , -- execute = name Execute command and quit . ( Disables -- force and history file . ) - E , -- vertical Print the output of a query ( rows ) vertically . - f , -- force Continue even if we get an SQL error . -- histignore = name A colon - separated list of patterns to keep statements from getting logged into syslog and mysql history . - G , -- named - commands Enable named commands . Named commands mean this program ' s internal commands ; see mysql> help . When enabled, the named commands can be used from any line of the query , otherwise only from the first line , before an enter . Disable with -- disable - named - commands . This option is disabled by default . - i , -- ignore - spaces Ignore space after function names . -- init - command = name SQL Command to execute when connecting to MySQL server . Will automatically be re - executed when reconnecting . -- local - infile Enable / disable LOAD DATA LOCAL INFILE . - b , -- no - beep Turn off beep on error . - h , -- host = name Connect to host . - H , -- html Produce HTML output . - X , -- xml Produce XML output . -- line - numbers Write line numbers for errors . ( Defaults to on ; use --skip-line-numbers to disable.) - L , -- skip - line - numbers Don ' t write line number for errors. - n , -- unbuffered Flush buffer after each query . -- column - names Write column names in results . ( Defaults to on ; use --skip-column-names to disable.) - N , -- skip - column - names Don ' t write column names in results. -- sigint - ignore Ignore SIGINT ( CTRL - C ) . - o , -- one - database Ignore statements except those that occur while the default database is the one named at the command line . -- pager [ = name ] Pager to use to display results . If you don ' t supply an option , the default pager is taken from your ENV variable PAGER . Valid pagers are less , more , cat [ > filename ], etc . See interactive help ( \\ h ) also . This option does not work in batch mode . Disable with -- disable - pager . This option is disabled by default . - p , -- password [ = name ] Password to use when connecting to server . If password is not given it ' s asked from the tty. - P , -- port = # Port number to use for connection or 0 for default to , in order of preference , my . cnf , $ MYSQL_TCP_PORT , / etc / services , built - in default ( 3306 ) . -- prompt = name Set the mysql prompt to this value . -- protocol = name The protocol to use for connection ( tcp , socket , pipe , memory ) . - q , -- quick Don ' t cache result, print it row by row. This may slow down the server if the output is suspended . Doesn ' t use history file . - r , -- raw Write fields without conversion . Used with -- batch . -- reconnect Reconnect if the connection is lost . Disable with -- disable - reconnect . This option is enabled by default . ( Defaults to on ; use --skip-reconnect to disable.) - s , -- silent Be more silent . Print results with a tab as separator , each row on new line . - S , -- socket = name The socket file to use for connection . -- ssl - mode = name SSL connection mode . -- ssl Deprecated . Use -- ssl - mode instead . ( Defaults to on ; use --skip-ssl to disable.) -- ssl - verify - server - cert Deprecated . Use -- ssl - mode = VERIFY_IDENTITY instead . -- ssl - ca = name CA file in PEM format . -- ssl - capath = name CA directory . -- ssl - cert = name X509 cert in PEM format . -- ssl - cipher = name SSL cipher to use . -- ssl - key = name X509 key in PEM format . -- ssl - crl = name Certificate revocation list . -- ssl - crlpath = name Certificate revocation list path . -- tls - version = name TLS version to use , permitted values are : TLSv1 , TLSv1 . 1 - t , -- table Output in table format . -- tee = name Append everything into outfile . See interactive help ( \\ h ) also . Does not work in batch mode . Disable with -- disable - tee . This option is disabled by default . - u , -- user = name User for login if not current user . - U , -- safe - updates Only allow UPDATE and DELETE that uses keys . - U , -- i - am - a - dummy Synonym for option -- safe - updates , - U . - v , -- verbose Write more . ( - v - v - v gives the table output format ) . - w , -- wait Wait and retry if connection is down . -- connect - timeout = # Number of seconds before connection timeout . -- max - allowed - packet = # The maximum packet length to send to or receive from server . -- net - buffer - length = # The buffer size for TCP / IP and socket communication . -- select - limit = # Automatic limit for SELECT when using -- safe - updates . -- max - join - size = # Automatic limit for rows in a join when using -- safe - updates . -- secure - auth Refuse client connecting to server if it uses old ( pre - 4 . 1 . 1 ) protocol . Deprecated . Always TRUE -- server - arg = name Send embedded server this as a parameter . -- show - warnings Show warnings after every statement . - j , -- syslog Log filtered interactive commands to syslog . Filtering of commands depends on the patterns supplied via histignore option besides the default patterns . -- plugin - dir = name Directory for client - side plugins . -- default - auth = name Default authentication client - side plugin to use . -- binary - mode By default , ASCII ' \\0 ' is disallowed and ' \\r \\n ' is translated to ' \\n ' . This switch turns off both features , and also turns off parsing of all clientcommands except \\ C and DELIMITER , in non - interactive mode ( for input piped to mysql or loaded using the ' source ' command ) . This is necessary when processing output from mysqlbinlog that may contain blobs . -- connect - expired - password Notify the server that this client is prepared to handle expired password sandbox mode . Default options are read from the following files in the given order : / etc / my . cnf / etc / mysql / my . cnf ~/ . my . cnf The following groups are read : mysql client The following options may be given as the first argument : -- print - defaults Print the program argument list and exit . -- no - defaults Don ' t read default options from any option file, except for login file . -- defaults - file = # Only read default options from the given file #. -- defaults - extra - file = # Read this file after the global files are read . -- defaults - group - suffix = # Also read groups with concat ( group , suffix ) -- login - path = # Read this path from the login file . Variables ( -- variable - name = value ) and boolean options { FALSE | TRUE } Value ( after reading options ) --------------------------------- ---------------------------------------- auto - rehash FALSE auto - vertical - output FALSE bind - address ( No default value ) binary - as - hex FALSE character - sets - dir ( No default value ) column - type - info FALSE comments FALSE compress FALSE database ( No default value ) default - character - set utf8 delimiter ; enable - cleartext - plugin FALSE vertical FALSE force FALSE histignore ( No default value ) named - commands FALSE ignore - spaces FALSE init - command ( No default value ) local - infile FALSE no - beep FALSE host ( No default value ) html FALSE xml FALSE line - numbers TRUE unbuffered FALSE column - names TRUE sigint - ignore FALSE port 3306 prompt mysql > quick FALSE raw FALSE reconnect TRUE socket / var / run / mysqld / mysqld . sock ssl TRUE ssl - verify - server - cert FALSE ssl - ca ( No default value ) ssl - capath ( No default value ) ssl - cert ( No default value ) ssl - cipher ( No default value ) ssl - key ( No default value ) ssl - crl ( No default value ) ssl - crlpath ( No default value ) tls - version ( No default value ) table FALSE user ( No default value ) safe - updates FALSE i - am - a - dummy FALSE connect - timeout 0 max - allowed - packet 16777216 net - buffer - length 16384 select - limit 1000 max - join - size 1000000 secure - auth TRUE show - warnings FALSE plugin - dir ( No default value ) default - auth ( No default value ) binary - mode FALSE connect - expired - password FALSE mysqladmin \u00b6 create databasename \uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u636e\u5e93 drop databasename \uff1a\u5220\u9664\u4e00\u4e2a\u6570\u636e\u5e93\u53ca\u5176\u6240\u6709\u8868 extended - status \uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u4e00\u4e2a\u6269\u5c55\u72b6\u6001\u6d88\u606f flush - hosts \uff1a\u6e05\u7a7a\u6240\u6709\u7f13\u5b58\u7684\u4e3b\u673a flush - logs \uff1a\u6e05\u7a7a\u6240\u6709\u65e5\u5fd7 flush - tables \uff1a\u6e05\u7a7a\u6240\u6709\u8868 flush - privileges \uff1a\u518d\u6b21\u88c5\u8f7d\u6388\u6743\u8868 ( \u540c reload ) kill id , id ,... \uff1a\u6740\u6b7b mysql\u7ebf\u7a0b password \u65b0\u53e3\u4ee4\uff1a\u5c06\u8001\u5bc6\u7801\u6539\u4e3a\u65b0\u5bc6\u7801 ping \uff1a\u68c0\u67e5 mysqld\u662f\u5426\u6d3b\u7740 processlist \uff1a\u663e\u793a\u670d\u52a1\u5176\u4e2d\u6d3b\u8dc3\u7ebf\u7a0b\u5217\u8868 reload \uff1a\u91cd\u8f7d\u6388\u6743\u8868 refresh \uff1a\u6e05\u7a7a\u6240\u6709\u8868\u5e76\u5173\u95ed\u548c\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 shutdown \uff1a\u5173\u6389\u670d\u52a1\u5668 status \uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u7b80\u77ed\u72b6\u6001\u6d88\u606f variables \uff1a\u6253\u5370\u51fa\u53ef\u7528\u53d8\u91cf version \uff1a\u5f97\u5230\u670d\u52a1\u5668\u7684\u7248\u672c\u4fe1\u606f mysqlshow \u00b6 - h \uff1a MySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d - u \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d - p \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801 --count\uff1a\u663e\u793a\u6bcf\u4e2a\u6570\u636e\u8868\u4e2d\u6570\u636e\u7684\u884c\u6570 - k \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7d22\u5f15 - t \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7c7b\u578b - i \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u989d\u5916\u4fe1\u606f mysqlimport \u00b6 - D \uff1a\u5bfc\u5165\u6570\u636e\u524d\u6e05\u7a7a\u8868 - f \uff1a\u51fa\u73b0\u9519\u8bef\u65f6\u7ee7\u7eed\u5904\u7406\u5269\u4f59\u7684\u64cd\u4f5c - h \uff1a MySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d - u \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d - p \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801 mysqldump \u00b6 --add-drop-table\uff1a\u5728\u6bcf\u4e2a\u521b\u5efa\u6570\u636e\u5e93\u8868\u8bed\u53e5\u524d\u6dfb\u52a0\u5220\u9664\u6570\u636e\u5e93\u8868\u7684\u8bed\u53e5 --add-locks\uff1a\u5907\u4efd\u6570\u636e\u5e93\u8868\u65f6\u9501\u5b9a\u6570\u636e\u5e93\u8868 --all-databases\uff1a\u5907\u4efdMySQL\u670d\u52a1\u5668\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93 --comments\uff1a\u6dfb\u52a0\u6ce8\u91ca\u4fe1\u606f --compact\uff1a\u538b\u7f29\u6a21\u5f0f\uff0c\u4ea7\u751f\u66f4\u5c11\u7684\u8f93\u51fa --complete-insert\uff1a\u8f93\u51fa\u5b8c\u6210\u7684\u63d2\u5165\u8bed\u53e5 --databases\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93 --default-character-set\uff1a\u6307\u5b9a\u9ed8\u8ba4\u5b57\u7b26\u96c6 --force\uff1a\u5f53\u51fa\u73b0\u9519\u8bef\u65f6\u4ecd\u7136\u7ee7\u7eed\u5907\u4efd\u64cd\u4f5c --host\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u6570\u636e\u5e93\u7684\u670d\u52a1\u5668 --lock-tables\uff1a\u5907\u4efd\u524d\uff0c\u9501\u5b9a\u6240\u6709\u6570\u636e\u5e93\u8868 --no-create-db\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u8bed\u53e5 --no-create-info\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u5e93\u8868\u8bed\u53e5 --password\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801 --port\uff1aMySQL\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7 --user\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d mysqldump -u linuxde -p smgp_apps_linuxde > linuxde.sql # \u5bfc\u51fa\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d > \u5bfc\u51fa\u7684\u6587\u4ef6\u540d mysqldump -u linuxde -p smgp_apps_linuxde users > linuxde_users.sql # \u5bfc\u51fa\u4e00\u4e2a\u8868\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d \u8868\u540d> \u5bfc\u51fa\u7684\u6587\u4ef6\u540d mysqldump -u linuxde -p -d --add-drop-table smgp_apps_linuxde > linuxde_db.sql # \u5bfc\u51fa\u4e00\u4e2a\u6570\u636e\u5e93\u7ed3\u6784 MySQL\u6162\u65e5\u5fd7 \u00b6 \u6162\u65e5\u5fd7\u5f00\u542f\u65b9\u5f0f\u548c\u5b58\u50a8\u683c\u5f0f\uff1a \u524d\u671f\u51c6\u5907 - \u67e5\u8be2\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1a show variables like '%log_queri%' ; \u8bb0\u5f55\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1a set global log_queries_not_using_indexes = on ; \u67e5\u8be2\u6162\u65e5\u5fd7\u5f00\u542f\u72b6\u6001\uff1a show variables like 'slow_query_log' ; \u5f00\u542f\u6162\u65e5\u5fd7\uff1a set global slow_query_log = on ; \u628a\u5927\u4e8e 10 \u6beb\u79d2\u7684\u67e5\u8be2\u8bb0\u5f55\u5230\u65e5\u5fd7\u91cc\uff1a show variables like 'long_query_time' ; \u67e5\u770b\u6162\u65e5\u5fd7\u4f4d\u7f6e\uff1a show variables like 'slow_query_log_file%' ; \u67e5\u770b mysql\u5404\u5185\u5b58\u7684\u5206\u914d\u60c5\u51b5 \uff1a show variables like 'innodb_%_size' ; \u67e5\u770b innodb_buffer_pool\u7684\u8fd0\u884c\u72b6\u6001 \uff1a show engine innodb status ; \u901a\u8fc7\u8bed\u53e5\u67e5\u770b MySQL\u6570\u636e\u50a8\u5b58\u4f4d\u7f6e \uff1a show global variables like \"%datadir%\" ; \u4e3a\u4e86\u9632\u6b62\u67e5\u8be2\u7f13\u5b58\u7ecf\u5e38\u88ab\u638f\u7a7a ( Potentially Undersized ) \uff0c\u6700\u597d\u662f\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf\uff0c\u6539\u53d8\u53d8\u91cf\u4e4b\u524d\uff0c\u5148\u67e5\u770b\u53d8\u91cf\u58f0 \u660e\u7684\u5f53\u524d\u503c\uff1a show variables like 'query_cache%' ; \u6388\u6743\u7528\u6237\u4ece\u8fdc\u7a0b\u767b\u5f55 : 1 \u3001\u6539\u8868\u6cd5\u3002\u53ef\u80fd\u662f\u4f60\u7684\u5e10\u53f7\u4e0d\u5141\u8bb8\u4ece\u8fdc\u7a0b\u767b\u9646\uff0c\u53ea\u80fd\u5728 localhost \u3002\u8fd9\u4e2a\u65f6\u5019\u53ea\u8981\u5728 localhost\u7684\u90a3\u53f0\u7535\u8111 \uff0c\u767b \u5165 mysql\u540e \uff0c\u66f4\u6539 \"mysql\" \u6570\u636e\u5e93\u91cc\u7684 \"user\" \u8868\u91cc\u7684 \"host\" \u9879\uff0c\u4ece \"localhost\" \u6539\u79f0 \"%\" mysql - u root - pvmware ; mysql > use mysql ; mysql > update user set host = '%' where user = 'root' ; mysql > select host , user from user ; 2 \u3001\u6388\u6743\u6cd5\u3002\u4f8b\u5982\uff0c\u4f60\u60f3 myuser\u4f7f\u7528mypassword\u4ece\u4efb\u4f55\u4e3b\u673a\u8fde\u63a5\u5230mysql\u670d\u52a1\u5668\u7684\u8bdd \u3002 GRANT ALL PRIVILEGES ON * . * TO 'myuser' @ '%' IDENTIFIED BY 'mypassword' WITH GRANT OPTION ; \u5982\u679c\u4f60\u60f3\u5141\u8bb8\u7528\u6237 myuser\u4eceip\u4e3a192 . 168 . 1 . 3 \u7684\u4e3b\u673a\u8fde\u63a5\u5230 mysql\u670d\u52a1\u5668 \uff0c\u5e76\u4f7f\u7528 mypassword\u4f5c\u4e3a\u5bc6\u7801 GRANT ALL PRIVILEGES ON * . * TO 'myuser' @ '192.168.1.3' IDENTIFIED BY 'mypassword' WITH GRANT OPTION ; \u3010\u4e0b\u9762\u8fd9\u4e00\u53e5\u4e00\u5b9a\u8981\u6267\u884c\uff0c\u5426\u5219\u8fd8\u662f\u65e0\u6cd5\u767b\u9646\u3011 mysql > flush privileges ; \u5982\u679c root\u7528\u6237\u65e0\u6cd5\u4ece\u672c\u5730\u767b\u9646 \uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u6267\u884c\u5982\u4e0b GRANT ALL PRIVILEGES ON * . * TO 'root' @ 'localhost.localdomain' IDENTIFIED BY '\u5bc6\u7801' WITH GRANT OPTION ; \u67e5\u770b\u67e5\u8be2\u7f13\u5b58\u7cfb\u7edf\u5c5e\u6027\uff1a show variables like '%_cache_%' ; \u8bbe\u7f6e\u67e5\u8be2\u7f13\u5b58\u7c7b\u578b\uff1a query_cache_type 0 \u6216 OFF \uff1a\u4e0d\u542f\u52a8\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u3002 1 \u6216 ON \uff1a\u7f13\u5b58\u9664\u4e86\u4ee5 SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u6240\u6709\u67e5\u8be2\u7ed3\u679c \u3002 2 \u6216 DEMAND \uff1a\u53ea\u7f13\u5b58\u4ee5 SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u67e5\u8be2\u7ed3\u679c \u3002 \u4e0d\u7f13\u5b58\u5927\u4e8e\u8be5\u503c\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u503c\u662f 1048576 ( 1 MB ) \u3002\uff1a query_cache_limit \u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u5206\u914d\u7684\u5185\u5b58\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f 0 \uff0c\u5373\u7981\u7528\u67e5\u8be2\u7f13\u5b58\u3002\uff1a query_cache_size \u67e5\u8be2\u7f13\u5b58\u5206\u914d\u7684\u6700\u5c0f\u5757\u7684\u5927\u5c0f ( \u5b57\u8282 ) \u3002 \u9ed8\u8ba4\u503c\u662f 4096 ( 4 KB ) \u3002\uff1a query_cache_min_res_unit query_cache_wlock_invalidate 0 \u6216 OFF \uff1a\u5f53\u67e5\u8be2\u7ed3\u679c\u4f4d\u4e8e\u67e5\u8be2\u7f13\u5b58\u4e2d\uff0c\u5ba2\u6237\u7aef\u5bf9 MyISAM \uff08\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff09\u8868\u8fdb\u884c WRITE\u9501\u5b9a\u65f6 \uff0c\u5176\u4ed6\u5ba2 \u6237\u7aef\u53ef\u4ee5\u5bf9\u8be5\u8868\u67e5\u8be2\u3002 1 \u6216 ON \uff1a\u9501\u5b9a\u751f\u6548\u65f6\uff0c\u67e5\u8be2\u7f13\u5b58\u5185\u6240\u6709\u5bf9\u8be5\u8868\u8fdb\u884c\u7684\u67e5\u8be2\u53d8\u5f97\u975e\u6cd5\uff0c\u5f3a\u5236\u8bbf\u95ee\u8be5\u8868\u7684\u5176\u4ed6\u5ba2\u6237\u7aef\u8fdb\u884c\u7b49 \u5f85\u3002 \u67e5\u770b\u6700\u5927\u8fde\u63a5\u6570\uff1a show variables like '%CONNECTION%' ; MySQL\u5efa\u8868\u8bed\u53e5\u5927\u5168 1 . \u521b\u5efa\u8868\uff08\u542b\u6709\u7ea6\u675f\uff09 /**\u521b\u5efa\u7ec4\u8868**/ create table t_group ( id int ( 11 ) auto_increment primary key , name varchar ( 50 ), value varchar ( 255 ) ) engine = InnoDB default charset = utf8 ; /**\u521b\u5efa\u7528\u6237\u8868**/ create table t_user ( id int ( 11 ) auto_increment primary key , name varchar ( 50 ) unique , value varchar ( 255 ) default '0' , email varchar ( 100 ) not null , sex varchar ( 1 ) check ( user_sex = 1 or user_sex = 2 ), group_id int ( 11 ), create_time timestamp , constraint foreign key ( group_id ) references t_group ( id ) on delete cascade ) engine = InnoDB default charset = utf8 ; /**\u67e5\u770b\u8868\u4fe1\u606f**/ desc t_group ; show create table t_group ; desc t_user ; show create table t_user ; \u81ea\u52a8\u589e\u957f\uff1a auto_increment \u521b\u5efa\u4e3b\u952e\uff1a primary key \u552f\u4e00\u7ea6\u675f : unique \u975e\u7a7a\u7ea6\u675f\uff1a not null \u68c0\u67e5\u7ea6\u675f : check ( user_sex = 1 or user_sex = 2 ) \u521b\u5efa\u5916\u952e\uff1a constraint foreign key ( group_id ) references t_group ( id ) on delete cascade 2 \u3001\u521b\u5efa\u8868\uff08\u4e0d\u542b\u7ea6\u675f\uff09 /**\u521b\u5efa\u7ec4\u8868**/ create table t_group ( id int ( 11 ), name varchar ( 50 ), value varchar ( 255 ) ) engine = InnoDB default charset = utf8 ; /**\u521b\u5efa\u7528\u6237\u8868**/ create table t_user ( id int ( 11 ), name varchar ( 50 ), value varchar ( 255 ) default '0' , email varchar ( 100 ), sex varchar ( 1 ), group_id int ( 11 ), create_time timestamp ) engine = InnoDB default charset = utf8 ; /**\u67e5\u770b\u8868\u4fe1\u606f**/ desc t_group ; show create table t_group ; desc t_user ; show create table t_user ; 3 . \u521b\u5efa\u7ea6\u675f /**\u521b\u5efa\u4e3b\u952e\u7ea6\u675f**/ alter table t_group add constraint group_id_pk primary key ( id ); alter table t_user add constraint user_id_pk primary key ( id ); /**\u81ea\u52a8\u589e\u957f**/ alter table t_group modify id int ( 11 ) auto_increment ; alter table t_user modify id int ( 11 ) auto_increment ; /**\u521b\u5efa\u5916\u952e\u7ea6\u675f**/ alter table t_user add constraint user_group_id_fk foreign key ( group_id ) references t_group ( id ); /**\u521b\u5efa\u552f\u4e00\u7ea6\u675f**/ alter table t_group add constraint group_name_uk unique ( name ); alter table t_user add constraint user_name_uk unique ( name ); /**\u521b\u5efa\u975e\u7a7a\u7ea6\u675f**/ alter table t_user add constraint user_email_nk check ( email is not null ); /**\u521b\u5efa\u68c0\u67e5\u7ea6\u675f**/ alter table t_user add constraint user_gender_ck check ( user_sex = 1 or user_sex = 2 ); 4 . \u5220\u9664\u7ea6\u675f /**\u5220\u9664\u552f\u4e00\u7ea6\u675f**/ alter table t_user drop unique key user_name_uk ; /**\u5220\u9664\u5916\u952e\u7ea6\u675f**/ alter table t_user drop foreign key user_group_id_fk ; 5 . \u4fee\u6539\u8868\u5b57\u6bb5 /**\u589e\u52a0\u5b57\u6bb5**/ alter table t_group add description varchar ( 255 ); alter table t_user add description varchar ( 255 ); /**\u4fee\u6539\u5b57\u6bb5**/ alter table t_group modify description varchar ( 20 ); alter table t_user modify description varchar ( 20 ); /**\u5220\u9664\u5b57\u6bb5**/ alter table t_group drop description ; alter table t_user drop description ; 6 . \u5220\u9664\u8868 drop table t_user ; drop table t_group ; ``` bash MySQL\u6570\u636e\u5e93\u5907\u4efd\u548c\u8fd8\u539f\u7684\u5e38\u7528\u547d\u4ee4 \u5907\u4efd MySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4 mysqldump - hhostname - uusername - ppassword databasename > backupfile . sql \u5907\u4efd MySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f \u5907\u4efd MySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f \uff0c\u80fd\u591f\u8ba9\u8be5\u5907\u4efd\u8986\u76d6\u5df2\u6709\u6570\u636e\u5e93\u800c\u4e0d\u9700\u8981\u624b\u52a8\u5220\u9664\u539f\u6709\u6570\u636e\u5e93\u3002 mysqldump - \u2013 add - drop - table - uusername - ppassword databasename > backupfile . sql \u76f4\u63a5\u5c06 MySQL\u6570\u636e\u5e93\u538b\u7f29\u5907\u4efd mysqldump - hhostname - uusername - ppassword databasename | gzip > backupfile . sql . gz \u5907\u4efd MySQL\u6570\u636e\u5e93\u67d0\u4e2a ( \u4e9b ) \u8868 mysqldump - hhostname - uusername - ppassword databasename specific_table1 specific_table2 > backupfile . sql \u540c\u65f6\u5907\u4efd\u591a\u4e2a MySQL\u6570\u636e\u5e93 mysqldump - hhostname - uusername - ppassword \u2013 databases databasename1 databasename2 databasename3 > multibackupfile . sql \u4ec5\u4ec5\u5907\u4efd\u6570\u636e\u5e93\u7ed3\u6784 mysqldump \u2013 no - data \u2013 databases databasename1 databasename2 databasename3 > structurebackupfile . sql \u5907\u4efd\u670d\u52a1\u5668\u4e0a\u6240\u6709\u6570\u636e\u5e93 mysqldump \u2013 all - databases > allbackupfile . sql \u8fd8\u539f MySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4 mysql - hhostname - uusername - ppassword databasename < backupfile . sql \u8fd8\u539f\u538b\u7f29\u7684 MySQL\u6570\u636e\u5e93 gunzip < backupfile . sql . gz | mysql - uusername - ppassword databasename \u5c06\u6570\u636e\u5e93\u8f6c\u79fb\u5230\u65b0\u670d\u52a1\u5668 mysqldump - uusername - ppassword databasename | mysql \u2013 host =* . * . * . * - C databasename \u4e0b\u9762\u7b80\u5355\u63cf\u8ff0MySQL Repl ica tion\u7684\u590d\u5236\u539f\u7406\u8fc7\u7a0b 1)\u5728Slave\u670d\u52a1\u5668\u4e0a\u6267\u884cstartslave\u547d\u4ee4\u5f00\u542f\u4e3b\u4ece\u590d\u5236\u5f00\u5173\uff0c \u5f00\u59cb\u8fdb\u884c\u4e3b\u4ece\u590d\u5236\u3002 2)\u6b64\u65f6 Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u4f1a\u901a\u8fc7\u5728Master\u4e0a\u5df2\u7ecf\u6388\u6743\u7684\u590d\u5236\u7528\u6237\u6743\u9650\u8bf7\u6c42\u8fde\u63a5Master\u670d\u52a1\u5668\uff0c \u5e76\u8bf7\u6c42\u4ece\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u7684\u6307\u5b9a \u4f4d\u7f6e\uff08\u65e5\u5fd7\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u5c31\u662f\u5728\u914d\u7f6e\u4e3b\u4ece\u590d\u5236\u670d\u52a1\u65f6\u6267\u884cchangemaster\u547d\u4ee4\u6307\u5b9a\u7684\uff09\u4e4b\u540e\u5f00\u59cb\u53d1\u9001binlog\u65e5\u5fd7\u5185\u5bb9 3) Master\u670d\u52a1\u5668\u63a5\u6536\u5230\u6765\u81eaSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u7684\u8bf7\u6c42\u540e\uff0c \u5176\u4e0a\u8d1f\u8d23\u590d\u5236\u7684l/0\u7ebf\u7a0b\u4f1a\u6839\u636eSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u8bf7\u6c42\u7684\u4fe1\u606f\u5206\u6279\u8bfb \u53d6\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u6307\u5b9a\u4f4d\u767b\u4e4b\u540e\u7684binlog\u65e5\u5fd7\u4fe1\u606f\uff0c \u7136\u540e\u8fd4\u56de\u7ed9Slave\u7aef\u76841/0\u7ebf\u7a0b\u3002 \u8fd4\u56de\u7684\u4fe1\u606f\u4e2d\u9664\u4e86binlog\u65e5 \u5fd7\u5185\u5bb9\u5916\uff0c \u8fd8\u6709 \u5728Master\u670d\u52a1\u5668\u7aef\u8bb0\u5f55\u7684\u65b0\u7684binlog\u6587\u4ef6\u540d\u79f0\uff0c \u4ee5\u53ca\u5728\u65b0\u7684binlog\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6307\u5b9a\u66f4\u65b0\u4f4d\u7f6e 4)\u5f53Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u83b7\u53d6\u5230Master\u670d\u52a1\u5668\u4e0a1/0\u7ebf\u7a0b\u53d1\u9001\u7684\u65e5\u5fd7\u5185\u5bb9\u3001\u65e5\u5fd7\u6587\u4ef6\u53ca\u4f4d\u7f6e\u70b9\u540e\uff0c \u4f1a\u5c06binlog\u65e5\u5fd7\u5185\u5bb9\u4f9d\u6b21\u5199\u5230Slave \u7aef\u81ea\u8eab\u7684Relay Log (\u5373\u4e2d\u7ee7\u65e5\u5fd7\uff09\u6587\u4ef6(MySQL-relay-bin.xxxxxx)\u7684\u6700\u672b\u7aef\uff0c \u5e76\u5c06\u65b0\u7684binlog\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u8bb0\u5f55\u5230 master-info\u6587\u4ef6\u4e2d \u4ee5\u4fbf\u4e0b\u4e00\u6b21\u8bfb\u53d6Master\u7aef\u65b0biolog\u65e5\u5fd7\u65f6\u80fd\u591f\u544a\u8bc9Master\u670d\u52a1\u5668 \u4ece\u65b0binlog\u65e5\u5fd7\u7684\u6307\u5b9a\u6587\u4ef6\u53ca\u4f4d\u7f6e\u5f00\u59cb\u8bf7\u6c42\u65b0\u7684binlog\u65e5\u5fd7\u5185\u5bb9\u3002 5) Slave\u670d\u52a1\u5668\u7aef\u7684SQL\u7ebf\u7a0b\u4f1a\u5b9e\u65f6\u68c0\u6d4b\u672c\u5730RelayLog\u4e2d1/0\u7ebf\u7a0b\u65b0\u589e\u52a0\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c \u7136\u540e\u53ca\u65f6\u5730\u628aRelay Log\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\u6210SQL\u8bed\u53e5 \u5e76\u5728\u81ea\u8eabSlave\u670d\u52a1\u5668\u4e0a\u6309\u89e3\u6790SQL\u8bed\u53e5\u7684\u4f4d\u7f6e\u987a\u5e8f\u6267\u884c\u5e94\u7528\u8fd9\u4e9bSQL\u8bed\u53e5\uff0c \u5e76\u5728relay- log.info\u4e2d\u8bb0\u5f55\u5f53\u524d\u5e94\u7528\u4e2d\u7ee7\u65e5\u5fd7\u7684\u6587\u4ef6\u540d\u53ca\u4f4d\u7f6e\u70b9 \u7ecf\u8fc7\u4e86\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c \u5c31\u53ef\u4ee5\u786e\u4fdd\u5728Master\u7aef\u548cSlave\u7aef\u6267\u884c\u4e86\u540c\u6837\u7684SQL\u8bed\u53e5\u3002\u5f53\u590d\u5236\u72b6\u6001\u6b63\u5e38\u65f6\uff0c Master\u7aef\u548cSlave\u7aef\u7684\u6570\u636e\u662f\u5b8c\u5168\u4e00\u6837\u7684 \u5f53\u7136\uff0c MySQL\u7684\u590d\u5236\u673a\u5236\u4e5f\u6709\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c \u5177\u4f53\u8bf7\u53c2\u8003\u5b98\u65b9\u7684\u8bf4\u660e MySQL\u4e3b\u4ece\u590d\u5236\u539f\u7406\u91cd\u70b9\u5c0f\u7ed3 \u25a1 \u4e3b\u4ece\u590d\u5236\u662f\u5f02\u6b65\u7684\u903b\u8f91\u7684SQL\u8bed\u53e5\u7ea7\u7684\u590d\u5236\u3002 D\u590d\u5236\u65f6\uff0c \u4e3b\u5e93\u6709\u4e00\u4e2aVO\u7ebf\u7a0b\uff0c \u4ece\u5e93\u6709\u4e24\u4e2a\u7ebf\u7a0b\uff0c \u53731/0\u548cSQL\u7ebf\u7a0b\u3002 \u25a1 \u5b9e\u73b0\u4e3b\u4ece\u590d\u5236\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u4e3b\u5e93\u8981\u5f00\u542f\u8bb0\u5f55binlog\u529f\u80fd\u3002 D\u4f5c\u4e3a\u590d\u5236\u7684\u6240\u6709MySQL\u8282\u70b9\u7684server-id\u90fd\u4e0d\u80fd\u76f8\u540c\u3002 \u25a1 binlog\u6587\u4ef6\u53ea\u8bb0\u5f55\u5bf9\u6570\u636e\u5e93\u6709\u66f4\u6539\u7684SQL\u8bed\u53e5\uff08\u6765\u81ea\u4e3b\u6570\u636e\u5e93\u5185\u5bb9\u7684\u53d8\u66f4\uff09\uff0c \u4e0d\u8bb0\u5f55\u4efb\u4f55\u67e5\u8be2\uff08\u5982select\u3001show)\u8bed\u53e5","title":"MariaDB"},{"location":"MySQL/#mysql","text":"\u6570\u636e\u5b9a\u4e49\u8bed\u8a00 ( DDL \uff0c Data Defintion Language ) \u8bed\u53e5\uff1a\u6570\u636e\u5b9a\u4e49\u8bed\u53e5\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540c\u7684\u6570\u636e\u6bb5\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5217\u3001\u7d22\u5f15\u7b49\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62ec create \u3001 drop \u3001 alter\u7b49 \u6570\u636e\u64cd\u4f5c\u8bed\u8a00 ( DML \uff0c Data Manipulation Language ) \u8bed\u53e5\uff1a\u6570\u636e\u64cd\u7eb5\u8bed\u53e5\uff0c\u7528\u4e8e\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u65b0\u548c\u67e5\u8be2\u6570\u636e\u5e93\u8bb0\u5f55\uff0c\u5e76\u68c0\u67e5\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u4e3b\u8981\u5305\u62ec insert \u3001 delete \u3001 update\u548cselect\u7b49 \u6570\u636e\u63a7\u5236\u8bed\u8a00 ( DCL \uff0c Data Control Language ) \u8bed\u53e5\uff1a\u6570\u636e\u63a7\u5236\u8bed\u53e5\uff0c\u7528\u4e8e\u63a7\u5236\u4e0d\u540c\u6570\u636e\u6bb5\u76f4\u63a5\u7684\u8bb8\u53ef\u548c\u8bbf\u95ee\u7ea7\u522b\u7684\u8bed\u53e5\u3002\u8fd9\u4e9b\u8bed\u53e5\u5b9a\u4e49\u4e86\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u3001\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u548c\u5b89\u5168\u7ea7\u522b\u3002\u4e3b\u8981\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62ec grant \u3001 revoke\u7b49","title":"MySQL"},{"location":"MySQL/#mysql_1","text":"MySQL 5 . 7 . 6 and later : ALTER USER ' root ' @ ' localhost ' IDENTIFIED BY ' MyNewPass ' ; MySQL 5 . 7 . 5 and earlier : SET PASSWORD FOR ' root ' @ ' localhost ' = PASSWORD ( ' MyNewPass ' ) ; flush privileges \u4ece\u4efb\u4f55\u4e3b\u673a\u4e0a\u4f7f\u7528 root \u7528\u6237\uff0c\u5bc6\u7801\uff1a youpassword \uff08\u4f60\u7684 root \u5bc6\u7801\uff09\u8fde\u63a5\u5230 mysql \u670d\u52a1\u5668\uff1a GRANT ALL PRIVILEGES ON * . * TO ' root ' @ ' % ' IDENTIFIED BY ' youpassword ' WITH GRANT OPTION ;","title":"\u5b89\u88c5mysql"},{"location":"MySQL/#mysql_2","text":"[ client ] #password = your_password port = 3306 socket = / tmp / mysql . sock [ mysqld ] user = mysql port = 3306 socket = / tmp / mysql . sock datadir = / www / server / data #default_storage_engine = MyISAM default_storage_engine = InnoDB #skip - external - locking #loose - skip - innodb key_buffer_size = 8 M max_allowed_packet = 100 G table_open_cache = 32 sort_buffer_size = 256 K join_buffer_size = 256 k net_buffer_length = 4 K read_buffer_size = 128 K read_rnd_buffer_size = 256 K myisam_sort_buffer_size = 4 M thread_cache_size = 4 thread_concurrency = 2 thread_stack = 192 k query_cache_size = 4 M query_cache_limit = 1 M query_cache_min_res_unit = 2 k long_query_time = 1 tmp_table_size = 8 M max_head_table_size = 2 M binlog_cache_size = 1 M max_binlog_cache_size = 1 M max_binlog_size = 2 M external - locking = FALSE bulk_insert_buffer_size = 1 M lower_case_table_names = 1 slave - skip - errors = 1032 , 1062 replicate - ignore - db = mysql #skip - networking #skip - name - resolve max_connections = 500 max_connect_errors = 100 open_files_limit = 65535 back_log = 600 table_cache = 614 log - bin = mysql - bin # \u6ce8\u610f\u8981\u5728 [ mysqld ] \u4e2d\u914d\u7f6e binlog_format = mixed server - id = 1 # \u4e3b\u4ece\u590d\u5236\u591a\u5b9e\u4f8b\u4e2did\u5747\u4e0d\u80fd\u76f8\u540c\u4e5f\u8981\u5728 [ mysqld ] \u4e2d\u914d\u7f6e expire_logs_days = 10 default_storage_engine = InnoDB innodb_data_home_dir = / www / server / data innodb_data_file_path = ibdata1 : 10 M : autoextend innodb_log_group_home_dir = / www / server / data innodb_buffer_pool_size = 16 M innodb_additional_mem_pool_size = 2 M innodb_log_file_size = 5 M innodb_log_buffer_size = 8 M innodb_flush_log_at_trx_commit = 1 innodb_lock_wait_timeout = 50 innodb_file_io_threads = 4 innodb_thread_concurrency = 8 innodb_log_files_in_group = 3 innodb_max_dirty_pages_pct = 90 innodb_file_per_table = 0 [ mysqldump ] quick max_allowed_packet = 16 M [ mysql ] no - auto - rehash [ myisamchk ] key_buffer_size = 20 M sort_buffer_size = 20 M read_buffer = 2 M write_buffer = 2 M [ mysqlhotcopy ] interactive - timeout","title":"MySQL\u914d\u7f6e\u6587\u4ef6"},{"location":"MySQL/#mysql_3","text":"","title":"mysql\u76f8\u5173\u547d\u4ee4"},{"location":"MySQL/#mysql_4","text":"Usage : mysql [ OPTIONS ] [ database ] - ?, -- help Display this help and exit . - I , -- help Synonym for - ? -- auto - rehash Enable automatic rehashing . One doesn ' t need to use ' rehash ' to get table and field completion , but startup and reconnecting may take a longer time . Disable with -- disable - auto - rehash . ( Defaults to on ; use --skip-auto-rehash to disable.) - A , -- no - auto - rehash No automatic rehashing . One has to use ' rehash ' to get table and field completion . This gives a quicker start of mysql and disables rehashing on reconnect . -- auto - vertical - output Automatically switch to vertical output mode if the result is wider than the terminal width . - B , -- batch Don ' t use history file. Disable interactive behavior. ( Enables -- silent . ) -- bind - address = name IP address to bind to . -- binary - as - hex Print binary data as hex -- character - sets - dir = name Directory for character set files . -- column - type - info Display column type information . - c , -- comments Preserve comments . Send comments to the server . The default is -- skip - comments ( discard comments ) , enable with -- comments . - C , -- compress Use compression in server / client protocol . - #, -- debug [ = #] This is a non - debug version . Catch this and exit . -- debug - check This is a non - debug version . Catch this and exit . - T , -- debug - info This is a non - debug version . Catch this and exit . - D , -- database = name Database to use . -- default - character - set = name Set the default character set . -- delimiter = name Delimiter to be used . -- enable - cleartext - plugin Enable / disable the clear text authentication plugin . - e , -- execute = name Execute command and quit . ( Disables -- force and history file . ) - E , -- vertical Print the output of a query ( rows ) vertically . - f , -- force Continue even if we get an SQL error . -- histignore = name A colon - separated list of patterns to keep statements from getting logged into syslog and mysql history . - G , -- named - commands Enable named commands . Named commands mean this program ' s internal commands ; see mysql> help . When enabled, the named commands can be used from any line of the query , otherwise only from the first line , before an enter . Disable with -- disable - named - commands . This option is disabled by default . - i , -- ignore - spaces Ignore space after function names . -- init - command = name SQL Command to execute when connecting to MySQL server . Will automatically be re - executed when reconnecting . -- local - infile Enable / disable LOAD DATA LOCAL INFILE . - b , -- no - beep Turn off beep on error . - h , -- host = name Connect to host . - H , -- html Produce HTML output . - X , -- xml Produce XML output . -- line - numbers Write line numbers for errors . ( Defaults to on ; use --skip-line-numbers to disable.) - L , -- skip - line - numbers Don ' t write line number for errors. - n , -- unbuffered Flush buffer after each query . -- column - names Write column names in results . ( Defaults to on ; use --skip-column-names to disable.) - N , -- skip - column - names Don ' t write column names in results. -- sigint - ignore Ignore SIGINT ( CTRL - C ) . - o , -- one - database Ignore statements except those that occur while the default database is the one named at the command line . -- pager [ = name ] Pager to use to display results . If you don ' t supply an option , the default pager is taken from your ENV variable PAGER . Valid pagers are less , more , cat [ > filename ], etc . See interactive help ( \\ h ) also . This option does not work in batch mode . Disable with -- disable - pager . This option is disabled by default . - p , -- password [ = name ] Password to use when connecting to server . If password is not given it ' s asked from the tty. - P , -- port = # Port number to use for connection or 0 for default to , in order of preference , my . cnf , $ MYSQL_TCP_PORT , / etc / services , built - in default ( 3306 ) . -- prompt = name Set the mysql prompt to this value . -- protocol = name The protocol to use for connection ( tcp , socket , pipe , memory ) . - q , -- quick Don ' t cache result, print it row by row. This may slow down the server if the output is suspended . Doesn ' t use history file . - r , -- raw Write fields without conversion . Used with -- batch . -- reconnect Reconnect if the connection is lost . Disable with -- disable - reconnect . This option is enabled by default . ( Defaults to on ; use --skip-reconnect to disable.) - s , -- silent Be more silent . Print results with a tab as separator , each row on new line . - S , -- socket = name The socket file to use for connection . -- ssl - mode = name SSL connection mode . -- ssl Deprecated . Use -- ssl - mode instead . ( Defaults to on ; use --skip-ssl to disable.) -- ssl - verify - server - cert Deprecated . Use -- ssl - mode = VERIFY_IDENTITY instead . -- ssl - ca = name CA file in PEM format . -- ssl - capath = name CA directory . -- ssl - cert = name X509 cert in PEM format . -- ssl - cipher = name SSL cipher to use . -- ssl - key = name X509 key in PEM format . -- ssl - crl = name Certificate revocation list . -- ssl - crlpath = name Certificate revocation list path . -- tls - version = name TLS version to use , permitted values are : TLSv1 , TLSv1 . 1 - t , -- table Output in table format . -- tee = name Append everything into outfile . See interactive help ( \\ h ) also . Does not work in batch mode . Disable with -- disable - tee . This option is disabled by default . - u , -- user = name User for login if not current user . - U , -- safe - updates Only allow UPDATE and DELETE that uses keys . - U , -- i - am - a - dummy Synonym for option -- safe - updates , - U . - v , -- verbose Write more . ( - v - v - v gives the table output format ) . - w , -- wait Wait and retry if connection is down . -- connect - timeout = # Number of seconds before connection timeout . -- max - allowed - packet = # The maximum packet length to send to or receive from server . -- net - buffer - length = # The buffer size for TCP / IP and socket communication . -- select - limit = # Automatic limit for SELECT when using -- safe - updates . -- max - join - size = # Automatic limit for rows in a join when using -- safe - updates . -- secure - auth Refuse client connecting to server if it uses old ( pre - 4 . 1 . 1 ) protocol . Deprecated . Always TRUE -- server - arg = name Send embedded server this as a parameter . -- show - warnings Show warnings after every statement . - j , -- syslog Log filtered interactive commands to syslog . Filtering of commands depends on the patterns supplied via histignore option besides the default patterns . -- plugin - dir = name Directory for client - side plugins . -- default - auth = name Default authentication client - side plugin to use . -- binary - mode By default , ASCII ' \\0 ' is disallowed and ' \\r \\n ' is translated to ' \\n ' . This switch turns off both features , and also turns off parsing of all clientcommands except \\ C and DELIMITER , in non - interactive mode ( for input piped to mysql or loaded using the ' source ' command ) . This is necessary when processing output from mysqlbinlog that may contain blobs . -- connect - expired - password Notify the server that this client is prepared to handle expired password sandbox mode . Default options are read from the following files in the given order : / etc / my . cnf / etc / mysql / my . cnf ~/ . my . cnf The following groups are read : mysql client The following options may be given as the first argument : -- print - defaults Print the program argument list and exit . -- no - defaults Don ' t read default options from any option file, except for login file . -- defaults - file = # Only read default options from the given file #. -- defaults - extra - file = # Read this file after the global files are read . -- defaults - group - suffix = # Also read groups with concat ( group , suffix ) -- login - path = # Read this path from the login file . Variables ( -- variable - name = value ) and boolean options { FALSE | TRUE } Value ( after reading options ) --------------------------------- ---------------------------------------- auto - rehash FALSE auto - vertical - output FALSE bind - address ( No default value ) binary - as - hex FALSE character - sets - dir ( No default value ) column - type - info FALSE comments FALSE compress FALSE database ( No default value ) default - character - set utf8 delimiter ; enable - cleartext - plugin FALSE vertical FALSE force FALSE histignore ( No default value ) named - commands FALSE ignore - spaces FALSE init - command ( No default value ) local - infile FALSE no - beep FALSE host ( No default value ) html FALSE xml FALSE line - numbers TRUE unbuffered FALSE column - names TRUE sigint - ignore FALSE port 3306 prompt mysql > quick FALSE raw FALSE reconnect TRUE socket / var / run / mysqld / mysqld . sock ssl TRUE ssl - verify - server - cert FALSE ssl - ca ( No default value ) ssl - capath ( No default value ) ssl - cert ( No default value ) ssl - cipher ( No default value ) ssl - key ( No default value ) ssl - crl ( No default value ) ssl - crlpath ( No default value ) tls - version ( No default value ) table FALSE user ( No default value ) safe - updates FALSE i - am - a - dummy FALSE connect - timeout 0 max - allowed - packet 16777216 net - buffer - length 16384 select - limit 1000 max - join - size 1000000 secure - auth TRUE show - warnings FALSE plugin - dir ( No default value ) default - auth ( No default value ) binary - mode FALSE connect - expired - password FALSE","title":"mysql"},{"location":"MySQL/#mysqladmin","text":"create databasename \uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u636e\u5e93 drop databasename \uff1a\u5220\u9664\u4e00\u4e2a\u6570\u636e\u5e93\u53ca\u5176\u6240\u6709\u8868 extended - status \uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u4e00\u4e2a\u6269\u5c55\u72b6\u6001\u6d88\u606f flush - hosts \uff1a\u6e05\u7a7a\u6240\u6709\u7f13\u5b58\u7684\u4e3b\u673a flush - logs \uff1a\u6e05\u7a7a\u6240\u6709\u65e5\u5fd7 flush - tables \uff1a\u6e05\u7a7a\u6240\u6709\u8868 flush - privileges \uff1a\u518d\u6b21\u88c5\u8f7d\u6388\u6743\u8868 ( \u540c reload ) kill id , id ,... \uff1a\u6740\u6b7b mysql\u7ebf\u7a0b password \u65b0\u53e3\u4ee4\uff1a\u5c06\u8001\u5bc6\u7801\u6539\u4e3a\u65b0\u5bc6\u7801 ping \uff1a\u68c0\u67e5 mysqld\u662f\u5426\u6d3b\u7740 processlist \uff1a\u663e\u793a\u670d\u52a1\u5176\u4e2d\u6d3b\u8dc3\u7ebf\u7a0b\u5217\u8868 reload \uff1a\u91cd\u8f7d\u6388\u6743\u8868 refresh \uff1a\u6e05\u7a7a\u6240\u6709\u8868\u5e76\u5173\u95ed\u548c\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 shutdown \uff1a\u5173\u6389\u670d\u52a1\u5668 status \uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u7b80\u77ed\u72b6\u6001\u6d88\u606f variables \uff1a\u6253\u5370\u51fa\u53ef\u7528\u53d8\u91cf version \uff1a\u5f97\u5230\u670d\u52a1\u5668\u7684\u7248\u672c\u4fe1\u606f","title":"mysqladmin"},{"location":"MySQL/#mysqlshow","text":"- h \uff1a MySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d - u \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d - p \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801 --count\uff1a\u663e\u793a\u6bcf\u4e2a\u6570\u636e\u8868\u4e2d\u6570\u636e\u7684\u884c\u6570 - k \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7d22\u5f15 - t \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7c7b\u578b - i \uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u989d\u5916\u4fe1\u606f","title":"mysqlshow"},{"location":"MySQL/#mysqlimport","text":"- D \uff1a\u5bfc\u5165\u6570\u636e\u524d\u6e05\u7a7a\u8868 - f \uff1a\u51fa\u73b0\u9519\u8bef\u65f6\u7ee7\u7eed\u5904\u7406\u5269\u4f59\u7684\u64cd\u4f5c - h \uff1a MySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d - u \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d - p \uff1a\u8fde\u63a5 MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801","title":"mysqlimport"},{"location":"MySQL/#mysqldump","text":"--add-drop-table\uff1a\u5728\u6bcf\u4e2a\u521b\u5efa\u6570\u636e\u5e93\u8868\u8bed\u53e5\u524d\u6dfb\u52a0\u5220\u9664\u6570\u636e\u5e93\u8868\u7684\u8bed\u53e5 --add-locks\uff1a\u5907\u4efd\u6570\u636e\u5e93\u8868\u65f6\u9501\u5b9a\u6570\u636e\u5e93\u8868 --all-databases\uff1a\u5907\u4efdMySQL\u670d\u52a1\u5668\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93 --comments\uff1a\u6dfb\u52a0\u6ce8\u91ca\u4fe1\u606f --compact\uff1a\u538b\u7f29\u6a21\u5f0f\uff0c\u4ea7\u751f\u66f4\u5c11\u7684\u8f93\u51fa --complete-insert\uff1a\u8f93\u51fa\u5b8c\u6210\u7684\u63d2\u5165\u8bed\u53e5 --databases\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93 --default-character-set\uff1a\u6307\u5b9a\u9ed8\u8ba4\u5b57\u7b26\u96c6 --force\uff1a\u5f53\u51fa\u73b0\u9519\u8bef\u65f6\u4ecd\u7136\u7ee7\u7eed\u5907\u4efd\u64cd\u4f5c --host\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u6570\u636e\u5e93\u7684\u670d\u52a1\u5668 --lock-tables\uff1a\u5907\u4efd\u524d\uff0c\u9501\u5b9a\u6240\u6709\u6570\u636e\u5e93\u8868 --no-create-db\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u8bed\u53e5 --no-create-info\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u5e93\u8868\u8bed\u53e5 --password\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801 --port\uff1aMySQL\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7 --user\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d mysqldump -u linuxde -p smgp_apps_linuxde > linuxde.sql # \u5bfc\u51fa\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d > \u5bfc\u51fa\u7684\u6587\u4ef6\u540d mysqldump -u linuxde -p smgp_apps_linuxde users > linuxde_users.sql # \u5bfc\u51fa\u4e00\u4e2a\u8868\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d \u8868\u540d> \u5bfc\u51fa\u7684\u6587\u4ef6\u540d mysqldump -u linuxde -p -d --add-drop-table smgp_apps_linuxde > linuxde_db.sql # \u5bfc\u51fa\u4e00\u4e2a\u6570\u636e\u5e93\u7ed3\u6784","title":"mysqldump"},{"location":"MySQL/#mysql_5","text":"\u6162\u65e5\u5fd7\u5f00\u542f\u65b9\u5f0f\u548c\u5b58\u50a8\u683c\u5f0f\uff1a \u524d\u671f\u51c6\u5907 - \u67e5\u8be2\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1a show variables like '%log_queri%' ; \u8bb0\u5f55\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1a set global log_queries_not_using_indexes = on ; \u67e5\u8be2\u6162\u65e5\u5fd7\u5f00\u542f\u72b6\u6001\uff1a show variables like 'slow_query_log' ; \u5f00\u542f\u6162\u65e5\u5fd7\uff1a set global slow_query_log = on ; \u628a\u5927\u4e8e 10 \u6beb\u79d2\u7684\u67e5\u8be2\u8bb0\u5f55\u5230\u65e5\u5fd7\u91cc\uff1a show variables like 'long_query_time' ; \u67e5\u770b\u6162\u65e5\u5fd7\u4f4d\u7f6e\uff1a show variables like 'slow_query_log_file%' ; \u67e5\u770b mysql\u5404\u5185\u5b58\u7684\u5206\u914d\u60c5\u51b5 \uff1a show variables like 'innodb_%_size' ; \u67e5\u770b innodb_buffer_pool\u7684\u8fd0\u884c\u72b6\u6001 \uff1a show engine innodb status ; \u901a\u8fc7\u8bed\u53e5\u67e5\u770b MySQL\u6570\u636e\u50a8\u5b58\u4f4d\u7f6e \uff1a show global variables like \"%datadir%\" ; \u4e3a\u4e86\u9632\u6b62\u67e5\u8be2\u7f13\u5b58\u7ecf\u5e38\u88ab\u638f\u7a7a ( Potentially Undersized ) \uff0c\u6700\u597d\u662f\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf\uff0c\u6539\u53d8\u53d8\u91cf\u4e4b\u524d\uff0c\u5148\u67e5\u770b\u53d8\u91cf\u58f0 \u660e\u7684\u5f53\u524d\u503c\uff1a show variables like 'query_cache%' ; \u6388\u6743\u7528\u6237\u4ece\u8fdc\u7a0b\u767b\u5f55 : 1 \u3001\u6539\u8868\u6cd5\u3002\u53ef\u80fd\u662f\u4f60\u7684\u5e10\u53f7\u4e0d\u5141\u8bb8\u4ece\u8fdc\u7a0b\u767b\u9646\uff0c\u53ea\u80fd\u5728 localhost \u3002\u8fd9\u4e2a\u65f6\u5019\u53ea\u8981\u5728 localhost\u7684\u90a3\u53f0\u7535\u8111 \uff0c\u767b \u5165 mysql\u540e \uff0c\u66f4\u6539 \"mysql\" \u6570\u636e\u5e93\u91cc\u7684 \"user\" \u8868\u91cc\u7684 \"host\" \u9879\uff0c\u4ece \"localhost\" \u6539\u79f0 \"%\" mysql - u root - pvmware ; mysql > use mysql ; mysql > update user set host = '%' where user = 'root' ; mysql > select host , user from user ; 2 \u3001\u6388\u6743\u6cd5\u3002\u4f8b\u5982\uff0c\u4f60\u60f3 myuser\u4f7f\u7528mypassword\u4ece\u4efb\u4f55\u4e3b\u673a\u8fde\u63a5\u5230mysql\u670d\u52a1\u5668\u7684\u8bdd \u3002 GRANT ALL PRIVILEGES ON * . * TO 'myuser' @ '%' IDENTIFIED BY 'mypassword' WITH GRANT OPTION ; \u5982\u679c\u4f60\u60f3\u5141\u8bb8\u7528\u6237 myuser\u4eceip\u4e3a192 . 168 . 1 . 3 \u7684\u4e3b\u673a\u8fde\u63a5\u5230 mysql\u670d\u52a1\u5668 \uff0c\u5e76\u4f7f\u7528 mypassword\u4f5c\u4e3a\u5bc6\u7801 GRANT ALL PRIVILEGES ON * . * TO 'myuser' @ '192.168.1.3' IDENTIFIED BY 'mypassword' WITH GRANT OPTION ; \u3010\u4e0b\u9762\u8fd9\u4e00\u53e5\u4e00\u5b9a\u8981\u6267\u884c\uff0c\u5426\u5219\u8fd8\u662f\u65e0\u6cd5\u767b\u9646\u3011 mysql > flush privileges ; \u5982\u679c root\u7528\u6237\u65e0\u6cd5\u4ece\u672c\u5730\u767b\u9646 \uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u6267\u884c\u5982\u4e0b GRANT ALL PRIVILEGES ON * . * TO 'root' @ 'localhost.localdomain' IDENTIFIED BY '\u5bc6\u7801' WITH GRANT OPTION ; \u67e5\u770b\u67e5\u8be2\u7f13\u5b58\u7cfb\u7edf\u5c5e\u6027\uff1a show variables like '%_cache_%' ; \u8bbe\u7f6e\u67e5\u8be2\u7f13\u5b58\u7c7b\u578b\uff1a query_cache_type 0 \u6216 OFF \uff1a\u4e0d\u542f\u52a8\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u3002 1 \u6216 ON \uff1a\u7f13\u5b58\u9664\u4e86\u4ee5 SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u6240\u6709\u67e5\u8be2\u7ed3\u679c \u3002 2 \u6216 DEMAND \uff1a\u53ea\u7f13\u5b58\u4ee5 SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u67e5\u8be2\u7ed3\u679c \u3002 \u4e0d\u7f13\u5b58\u5927\u4e8e\u8be5\u503c\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u503c\u662f 1048576 ( 1 MB ) \u3002\uff1a query_cache_limit \u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u5206\u914d\u7684\u5185\u5b58\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f 0 \uff0c\u5373\u7981\u7528\u67e5\u8be2\u7f13\u5b58\u3002\uff1a query_cache_size \u67e5\u8be2\u7f13\u5b58\u5206\u914d\u7684\u6700\u5c0f\u5757\u7684\u5927\u5c0f ( \u5b57\u8282 ) \u3002 \u9ed8\u8ba4\u503c\u662f 4096 ( 4 KB ) \u3002\uff1a query_cache_min_res_unit query_cache_wlock_invalidate 0 \u6216 OFF \uff1a\u5f53\u67e5\u8be2\u7ed3\u679c\u4f4d\u4e8e\u67e5\u8be2\u7f13\u5b58\u4e2d\uff0c\u5ba2\u6237\u7aef\u5bf9 MyISAM \uff08\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff09\u8868\u8fdb\u884c WRITE\u9501\u5b9a\u65f6 \uff0c\u5176\u4ed6\u5ba2 \u6237\u7aef\u53ef\u4ee5\u5bf9\u8be5\u8868\u67e5\u8be2\u3002 1 \u6216 ON \uff1a\u9501\u5b9a\u751f\u6548\u65f6\uff0c\u67e5\u8be2\u7f13\u5b58\u5185\u6240\u6709\u5bf9\u8be5\u8868\u8fdb\u884c\u7684\u67e5\u8be2\u53d8\u5f97\u975e\u6cd5\uff0c\u5f3a\u5236\u8bbf\u95ee\u8be5\u8868\u7684\u5176\u4ed6\u5ba2\u6237\u7aef\u8fdb\u884c\u7b49 \u5f85\u3002 \u67e5\u770b\u6700\u5927\u8fde\u63a5\u6570\uff1a show variables like '%CONNECTION%' ; MySQL\u5efa\u8868\u8bed\u53e5\u5927\u5168 1 . \u521b\u5efa\u8868\uff08\u542b\u6709\u7ea6\u675f\uff09 /**\u521b\u5efa\u7ec4\u8868**/ create table t_group ( id int ( 11 ) auto_increment primary key , name varchar ( 50 ), value varchar ( 255 ) ) engine = InnoDB default charset = utf8 ; /**\u521b\u5efa\u7528\u6237\u8868**/ create table t_user ( id int ( 11 ) auto_increment primary key , name varchar ( 50 ) unique , value varchar ( 255 ) default '0' , email varchar ( 100 ) not null , sex varchar ( 1 ) check ( user_sex = 1 or user_sex = 2 ), group_id int ( 11 ), create_time timestamp , constraint foreign key ( group_id ) references t_group ( id ) on delete cascade ) engine = InnoDB default charset = utf8 ; /**\u67e5\u770b\u8868\u4fe1\u606f**/ desc t_group ; show create table t_group ; desc t_user ; show create table t_user ; \u81ea\u52a8\u589e\u957f\uff1a auto_increment \u521b\u5efa\u4e3b\u952e\uff1a primary key \u552f\u4e00\u7ea6\u675f : unique \u975e\u7a7a\u7ea6\u675f\uff1a not null \u68c0\u67e5\u7ea6\u675f : check ( user_sex = 1 or user_sex = 2 ) \u521b\u5efa\u5916\u952e\uff1a constraint foreign key ( group_id ) references t_group ( id ) on delete cascade 2 \u3001\u521b\u5efa\u8868\uff08\u4e0d\u542b\u7ea6\u675f\uff09 /**\u521b\u5efa\u7ec4\u8868**/ create table t_group ( id int ( 11 ), name varchar ( 50 ), value varchar ( 255 ) ) engine = InnoDB default charset = utf8 ; /**\u521b\u5efa\u7528\u6237\u8868**/ create table t_user ( id int ( 11 ), name varchar ( 50 ), value varchar ( 255 ) default '0' , email varchar ( 100 ), sex varchar ( 1 ), group_id int ( 11 ), create_time timestamp ) engine = InnoDB default charset = utf8 ; /**\u67e5\u770b\u8868\u4fe1\u606f**/ desc t_group ; show create table t_group ; desc t_user ; show create table t_user ; 3 . \u521b\u5efa\u7ea6\u675f /**\u521b\u5efa\u4e3b\u952e\u7ea6\u675f**/ alter table t_group add constraint group_id_pk primary key ( id ); alter table t_user add constraint user_id_pk primary key ( id ); /**\u81ea\u52a8\u589e\u957f**/ alter table t_group modify id int ( 11 ) auto_increment ; alter table t_user modify id int ( 11 ) auto_increment ; /**\u521b\u5efa\u5916\u952e\u7ea6\u675f**/ alter table t_user add constraint user_group_id_fk foreign key ( group_id ) references t_group ( id ); /**\u521b\u5efa\u552f\u4e00\u7ea6\u675f**/ alter table t_group add constraint group_name_uk unique ( name ); alter table t_user add constraint user_name_uk unique ( name ); /**\u521b\u5efa\u975e\u7a7a\u7ea6\u675f**/ alter table t_user add constraint user_email_nk check ( email is not null ); /**\u521b\u5efa\u68c0\u67e5\u7ea6\u675f**/ alter table t_user add constraint user_gender_ck check ( user_sex = 1 or user_sex = 2 ); 4 . \u5220\u9664\u7ea6\u675f /**\u5220\u9664\u552f\u4e00\u7ea6\u675f**/ alter table t_user drop unique key user_name_uk ; /**\u5220\u9664\u5916\u952e\u7ea6\u675f**/ alter table t_user drop foreign key user_group_id_fk ; 5 . \u4fee\u6539\u8868\u5b57\u6bb5 /**\u589e\u52a0\u5b57\u6bb5**/ alter table t_group add description varchar ( 255 ); alter table t_user add description varchar ( 255 ); /**\u4fee\u6539\u5b57\u6bb5**/ alter table t_group modify description varchar ( 20 ); alter table t_user modify description varchar ( 20 ); /**\u5220\u9664\u5b57\u6bb5**/ alter table t_group drop description ; alter table t_user drop description ; 6 . \u5220\u9664\u8868 drop table t_user ; drop table t_group ; ``` bash MySQL\u6570\u636e\u5e93\u5907\u4efd\u548c\u8fd8\u539f\u7684\u5e38\u7528\u547d\u4ee4 \u5907\u4efd MySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4 mysqldump - hhostname - uusername - ppassword databasename > backupfile . sql \u5907\u4efd MySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f \u5907\u4efd MySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f \uff0c\u80fd\u591f\u8ba9\u8be5\u5907\u4efd\u8986\u76d6\u5df2\u6709\u6570\u636e\u5e93\u800c\u4e0d\u9700\u8981\u624b\u52a8\u5220\u9664\u539f\u6709\u6570\u636e\u5e93\u3002 mysqldump - \u2013 add - drop - table - uusername - ppassword databasename > backupfile . sql \u76f4\u63a5\u5c06 MySQL\u6570\u636e\u5e93\u538b\u7f29\u5907\u4efd mysqldump - hhostname - uusername - ppassword databasename | gzip > backupfile . sql . gz \u5907\u4efd MySQL\u6570\u636e\u5e93\u67d0\u4e2a ( \u4e9b ) \u8868 mysqldump - hhostname - uusername - ppassword databasename specific_table1 specific_table2 > backupfile . sql \u540c\u65f6\u5907\u4efd\u591a\u4e2a MySQL\u6570\u636e\u5e93 mysqldump - hhostname - uusername - ppassword \u2013 databases databasename1 databasename2 databasename3 > multibackupfile . sql \u4ec5\u4ec5\u5907\u4efd\u6570\u636e\u5e93\u7ed3\u6784 mysqldump \u2013 no - data \u2013 databases databasename1 databasename2 databasename3 > structurebackupfile . sql \u5907\u4efd\u670d\u52a1\u5668\u4e0a\u6240\u6709\u6570\u636e\u5e93 mysqldump \u2013 all - databases > allbackupfile . sql \u8fd8\u539f MySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4 mysql - hhostname - uusername - ppassword databasename < backupfile . sql \u8fd8\u539f\u538b\u7f29\u7684 MySQL\u6570\u636e\u5e93 gunzip < backupfile . sql . gz | mysql - uusername - ppassword databasename \u5c06\u6570\u636e\u5e93\u8f6c\u79fb\u5230\u65b0\u670d\u52a1\u5668 mysqldump - uusername - ppassword databasename | mysql \u2013 host =* . * . * . * - C databasename \u4e0b\u9762\u7b80\u5355\u63cf\u8ff0MySQL Repl ica tion\u7684\u590d\u5236\u539f\u7406\u8fc7\u7a0b 1)\u5728Slave\u670d\u52a1\u5668\u4e0a\u6267\u884cstartslave\u547d\u4ee4\u5f00\u542f\u4e3b\u4ece\u590d\u5236\u5f00\u5173\uff0c \u5f00\u59cb\u8fdb\u884c\u4e3b\u4ece\u590d\u5236\u3002 2)\u6b64\u65f6 Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u4f1a\u901a\u8fc7\u5728Master\u4e0a\u5df2\u7ecf\u6388\u6743\u7684\u590d\u5236\u7528\u6237\u6743\u9650\u8bf7\u6c42\u8fde\u63a5Master\u670d\u52a1\u5668\uff0c \u5e76\u8bf7\u6c42\u4ece\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u7684\u6307\u5b9a \u4f4d\u7f6e\uff08\u65e5\u5fd7\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u5c31\u662f\u5728\u914d\u7f6e\u4e3b\u4ece\u590d\u5236\u670d\u52a1\u65f6\u6267\u884cchangemaster\u547d\u4ee4\u6307\u5b9a\u7684\uff09\u4e4b\u540e\u5f00\u59cb\u53d1\u9001binlog\u65e5\u5fd7\u5185\u5bb9 3) Master\u670d\u52a1\u5668\u63a5\u6536\u5230\u6765\u81eaSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u7684\u8bf7\u6c42\u540e\uff0c \u5176\u4e0a\u8d1f\u8d23\u590d\u5236\u7684l/0\u7ebf\u7a0b\u4f1a\u6839\u636eSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u8bf7\u6c42\u7684\u4fe1\u606f\u5206\u6279\u8bfb \u53d6\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u6307\u5b9a\u4f4d\u767b\u4e4b\u540e\u7684binlog\u65e5\u5fd7\u4fe1\u606f\uff0c \u7136\u540e\u8fd4\u56de\u7ed9Slave\u7aef\u76841/0\u7ebf\u7a0b\u3002 \u8fd4\u56de\u7684\u4fe1\u606f\u4e2d\u9664\u4e86binlog\u65e5 \u5fd7\u5185\u5bb9\u5916\uff0c \u8fd8\u6709 \u5728Master\u670d\u52a1\u5668\u7aef\u8bb0\u5f55\u7684\u65b0\u7684binlog\u6587\u4ef6\u540d\u79f0\uff0c \u4ee5\u53ca\u5728\u65b0\u7684binlog\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6307\u5b9a\u66f4\u65b0\u4f4d\u7f6e 4)\u5f53Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u83b7\u53d6\u5230Master\u670d\u52a1\u5668\u4e0a1/0\u7ebf\u7a0b\u53d1\u9001\u7684\u65e5\u5fd7\u5185\u5bb9\u3001\u65e5\u5fd7\u6587\u4ef6\u53ca\u4f4d\u7f6e\u70b9\u540e\uff0c \u4f1a\u5c06binlog\u65e5\u5fd7\u5185\u5bb9\u4f9d\u6b21\u5199\u5230Slave \u7aef\u81ea\u8eab\u7684Relay Log (\u5373\u4e2d\u7ee7\u65e5\u5fd7\uff09\u6587\u4ef6(MySQL-relay-bin.xxxxxx)\u7684\u6700\u672b\u7aef\uff0c \u5e76\u5c06\u65b0\u7684binlog\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u8bb0\u5f55\u5230 master-info\u6587\u4ef6\u4e2d \u4ee5\u4fbf\u4e0b\u4e00\u6b21\u8bfb\u53d6Master\u7aef\u65b0biolog\u65e5\u5fd7\u65f6\u80fd\u591f\u544a\u8bc9Master\u670d\u52a1\u5668 \u4ece\u65b0binlog\u65e5\u5fd7\u7684\u6307\u5b9a\u6587\u4ef6\u53ca\u4f4d\u7f6e\u5f00\u59cb\u8bf7\u6c42\u65b0\u7684binlog\u65e5\u5fd7\u5185\u5bb9\u3002 5) Slave\u670d\u52a1\u5668\u7aef\u7684SQL\u7ebf\u7a0b\u4f1a\u5b9e\u65f6\u68c0\u6d4b\u672c\u5730RelayLog\u4e2d1/0\u7ebf\u7a0b\u65b0\u589e\u52a0\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c \u7136\u540e\u53ca\u65f6\u5730\u628aRelay Log\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\u6210SQL\u8bed\u53e5 \u5e76\u5728\u81ea\u8eabSlave\u670d\u52a1\u5668\u4e0a\u6309\u89e3\u6790SQL\u8bed\u53e5\u7684\u4f4d\u7f6e\u987a\u5e8f\u6267\u884c\u5e94\u7528\u8fd9\u4e9bSQL\u8bed\u53e5\uff0c \u5e76\u5728relay- log.info\u4e2d\u8bb0\u5f55\u5f53\u524d\u5e94\u7528\u4e2d\u7ee7\u65e5\u5fd7\u7684\u6587\u4ef6\u540d\u53ca\u4f4d\u7f6e\u70b9 \u7ecf\u8fc7\u4e86\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c \u5c31\u53ef\u4ee5\u786e\u4fdd\u5728Master\u7aef\u548cSlave\u7aef\u6267\u884c\u4e86\u540c\u6837\u7684SQL\u8bed\u53e5\u3002\u5f53\u590d\u5236\u72b6\u6001\u6b63\u5e38\u65f6\uff0c Master\u7aef\u548cSlave\u7aef\u7684\u6570\u636e\u662f\u5b8c\u5168\u4e00\u6837\u7684 \u5f53\u7136\uff0c MySQL\u7684\u590d\u5236\u673a\u5236\u4e5f\u6709\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c \u5177\u4f53\u8bf7\u53c2\u8003\u5b98\u65b9\u7684\u8bf4\u660e MySQL\u4e3b\u4ece\u590d\u5236\u539f\u7406\u91cd\u70b9\u5c0f\u7ed3 \u25a1 \u4e3b\u4ece\u590d\u5236\u662f\u5f02\u6b65\u7684\u903b\u8f91\u7684SQL\u8bed\u53e5\u7ea7\u7684\u590d\u5236\u3002 D\u590d\u5236\u65f6\uff0c \u4e3b\u5e93\u6709\u4e00\u4e2aVO\u7ebf\u7a0b\uff0c \u4ece\u5e93\u6709\u4e24\u4e2a\u7ebf\u7a0b\uff0c \u53731/0\u548cSQL\u7ebf\u7a0b\u3002 \u25a1 \u5b9e\u73b0\u4e3b\u4ece\u590d\u5236\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u4e3b\u5e93\u8981\u5f00\u542f\u8bb0\u5f55binlog\u529f\u80fd\u3002 D\u4f5c\u4e3a\u590d\u5236\u7684\u6240\u6709MySQL\u8282\u70b9\u7684server-id\u90fd\u4e0d\u80fd\u76f8\u540c\u3002 \u25a1 binlog\u6587\u4ef6\u53ea\u8bb0\u5f55\u5bf9\u6570\u636e\u5e93\u6709\u66f4\u6539\u7684SQL\u8bed\u53e5\uff08\u6765\u81ea\u4e3b\u6570\u636e\u5e93\u5185\u5bb9\u7684\u53d8\u66f4\uff09\uff0c \u4e0d\u8bb0\u5f55\u4efb\u4f55\u67e5\u8be2\uff08\u5982select\u3001show)\u8bed\u53e5","title":"MySQL\u6162\u65e5\u5fd7"},{"location":"Nagios/","text":"","title":"Nagios"},{"location":"Nginx/","text":"Nginx&&Unit \u00b6 centos\u5b89\u88c5 \u00b6 # To set up the yum repository for RHEL/CentOS, create the file named /etc/yum.repos.d/nginx.repo with the following contents: # Replace \u201cOS\u201d with \u201crhel\u201d or \u201ccentos\u201d, depending on the distribution used, and \u201cOSRELEASE\u201d with \u201c6\u201d or \u201c7\u201d, for 6.x or 7.x versions, respectively. cat << EOF > /etc/yum.repos.d/nginx.repo [nginx-stable] name=nginx stable repo baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/ gpgcheck=1 enabled=1 gpgkey=https://nginx.org/keys/nginx_signing.key EOF # \u5bf9\u4e8eDebian / Ubuntu\uff0c\u4e3a\u4e86\u9a8c\u8bc1nginx\u5b58\u50a8\u5e93\u7b7e\u540d\u5e76\u5728\u5b89\u88c5nginx\u8f6f\u4ef6\u5305\u65f6\u6d88\u9664\u6709\u5173\u4e22\u5931PGP\u5bc6\u94a5\u7684\u8b66\u544a\uff0c\u6709\u5fc5\u8981\u5c06\u7528\u4e8e\u7b7e\u7f72nginx\u8f6f\u4ef6\u5305\u548c\u5b58\u50a8\u5e93\u7684\u5bc6\u94a5\u6dfb\u52a0\u5230apt\u7a0b\u5e8f\u5bc6\u94a5\u73af\u4e2d\u3002\u8bf7\u4ece\u6211\u4eec\u7684\u7f51\u7ad9\u4e0b\u8f7d\u6b64\u5bc6\u94a5\uff0c\u5e76apt \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5176\u6dfb\u52a0\u5230\u7a0b\u5e8f\u5bc6\u94a5\u73af\uff1a wget -c http://nginx.org/keys/nginx_signing.key sudo apt-key add nginx_signing.key # \u5bf9\u4e8eDebian\uff0c\u7528Debian\u5206\u53d1\u4ee3\u53f7\u53d6\u4ee3codename cat << EOF > /etc/apt/sources.list deb http://nginx.org/packages/debian/ codename nginx deb-src http://nginx.org/packages/debian/ codename nginx EOF apt-get update && apt-get install nginx # Mainline\u7248\u672c\u7684\u9884\u6784\u5efa\u5305;\u5229\u7528rpm\u5305\u5b89\u88c5 rpm --import nginx_signing.key wget http://nginx.org/packages/mainline/centos/7/x86_64/RPMS/nginx-1.13.9-1.el7_4.ngx.x86_64.rpm rpm -ivh nginx-1.13.9-1.el7_4.ngx.x86_64.rpm systemctl enable nginx && systemctl start nginx 2.\u4ece\u6e90\u4ee3\u7801\u6784\u5efanginx wget - c http : // nginx . org / download / nginx - 1 . 12 . 2 . tar . gz # \u6784\u5efa\u4f7f\u7528 configure \u547d\u4ee4\u8fdb\u884c\u914d\u7f6e\u3002\u5b83\u5b9a\u4e49\u4e86\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\uff0c\u5305\u62ec nginx \u5141\u8bb8\u7528\u4e8e\u8fde\u63a5\u5904\u7406\u7684\u65b9\u6cd5\u3002\u6700\u540e\u5b83\u521b\u5efa\u4e00\u4e2a Makefile \u3002\u8be5 configure \u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u53c2\u6570\uff1a -- prefix = path - \u5b9a\u4e49\u4e00\u4e2a\u5c06\u4fdd\u7559\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\u3002\u8fd9\u4e2a\u76f8\u540c\u7684\u76ee\u5f55\u4e5f\u5c06\u88ab\u7528\u4e8e\u6240\u6709\u76f8\u5173\u7684\u8def\u5f84 configure \uff08\u9664\u4e86\u6e90\u8d44\u6e90\u7684\u8def\u5f84\uff09\u548c nginx . conf \u914d\u7f6e\u6587\u4ef6\u3002\u5b83 / usr / local / nginx \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u76ee\u5f55\u3002 -- sbin - path = path - \u8bbe\u7f6e\u4e00\u4e2a nginx \u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u5b57\u3002\u8be5\u540d\u79f0\u4ec5\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / sbin / nginx \u3002 -- conf - path = path - \u8bbe\u7f6e nginx . conf \u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c nginx \u53ef\u4ee5\u59cb\u7ec8\u4f7f\u7528\u4e0d\u540c\u7684\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\uff0c\u53ea\u8981\u5728\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u6307\u5b9a\u5373\u53ef \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d \u3002 - c fileprefix / conf / nginx . conf -- pid - path = path - \u8bbe\u7f6e\u5c06\u5b58\u50a8\u4e3b\u8fdb\u7a0b\u7684\u8fdb\u7a0b ID \u7684 nginx . pid \u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 pid \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / nginx . pid \u3002 -- error - log - path = path - \u8bbe\u7f6e\u4e3b\u8981\u9519\u8bef\u7684\u540d\u79f0\uff0c\u8b66\u544a\u548c\u8bca\u65ad\u6587\u4ef6\u3002\u5b89\u88c5\u4e4b\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 error_log \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / error . log \u3002 -- http - log - path = path - \u8bbe\u7f6e HTTP \u670d\u52a1\u5668\u7684\u4e3b\u8981\u8bf7\u6c42\u65e5\u5fd7\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 access_log \u6307\u4ee4\u968f\u65f6\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / access . log \u3002 -- build = name - \u8bbe\u7f6e\u4e00\u4e2a\u53ef\u9009\u7684 nginx \u6784\u5efa\u540d\u79f0\u3002 -- user = name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 user \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u7684\u7528\u6237\u540d\u662f nobody \u3002 -- group = name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u7ec4\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 user \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7ec4\u540d\u79f0\u8bbe\u7f6e\u4e3a\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\u3002 -- with - select_module -- without - select_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5 select () \u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982 kqueue \uff0c epoll \u6216 / dev / poll \uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\u3002 -- with - poll_module -- without - poll_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5 poll () \u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982 kqueue \uff0c epoll \u6216 / dev / poll \uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\u3002 -- without - http_gzip_module - \u7981\u7528\u6784\u5efa\u538b\u7f29 HTTP \u670d\u52a1\u5668\u54cd\u5e94\u7684\u6a21\u5757\u3002 zlib \u5e93\u662f\u5efa\u7acb\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u6240\u5fc5\u9700\u7684\u3002 -- without - http_rewrite_module - \u7981\u7528\u6784\u5efa\u5141\u8bb8 HTTP \u670d\u52a1\u5668 \u91cd\u5b9a\u5411\u8bf7\u6c42\u5e76\u66f4\u6539\u8bf7\u6c42 URI \u7684\u6a21\u5757\u3002 PCRE \u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u3002 -- without - http_proxy_module - \u7981\u7528\u6784\u5efa HTTP \u670d\u52a1\u5668\u4ee3\u7406\u6a21\u5757\u3002 -- with - http_ssl_module - \u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c\u5c06 HTTPS \u534f\u8bae\u652f\u6301\u6dfb\u52a0\u5230 HTTP \u670d\u52a1\u5668\u3002\u8be5\u6a21\u5757\u4e0d\u662f\u9ed8\u8ba4\u751f\u6210\u7684\u3002 OpenSSL \u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u3002 -- with - pcre = path - \u8bbe\u7f6e PCRE \u5e93\u6e90\u7684\u8def\u5f84\u3002\u56fe\u4e66\u9986\u53d1\u884c\uff08\u7248\u672c 4 . 4 - 8 . 41 \uff09\u9700\u8981\u4ece PCRE \u7f51\u7ad9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531 nginx \u7684. / configure \u548c make \u3002\u5728\u4f4d\u7f6e\u6307\u4ee4\u548c ngx_http_rewrite_module \u6a21\u5757\u4e2d\uff0c\u8be5\u5e93\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u652f\u6301\u6240\u5fc5\u9700\u7684 \u3002 -- with - pcre - jit - \u7528\u201c\u5373\u65f6\u7f16\u8bd1\u201d\u652f\u6301\uff08 1 . 1 . 12 \uff0c pcre_jit \u6307\u4ee4\uff09\u6784\u5efa PCRE \u5e93 \u3002 -- with - zlib = path - \u8bbe\u7f6e zlib \u5e93\u7684\u6e90\u7684\u8def\u5f84\u3002\u5e93\u53d1\u884c\u7248\uff08\u7248\u672c 1 . 1 . 3 - 1 . 2 . 11 \uff09\u9700\u8981\u4ece zlib \u7ad9\u70b9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531 nginx \u7684. / configure \u548c make \u3002\u8be5\u5e93\u662f ngx_http_gzip_module \u6a21\u5757\u6240\u5fc5\u9700\u7684 \u3002 -- with - cc - opt = parameters - \u8bbe\u7f6e\u5c06\u88ab\u6dfb\u52a0\u5230 CFLAGS \u53d8\u91cf\u7684\u9644\u52a0\u53c2\u6570\u3002\u5728 FreeBSD \u4e0b\u4f7f\u7528\u7cfb\u7edf PCRE \u5e93\u65f6\uff0c -- with - cc - opt = \" -I /usr/local/include \" \u5e94\u8be5\u6307\u5b9a\u3002\u5982\u679c select () \u9700\u8981\u589e\u52a0\u652f\u6301\u7684\u6587\u4ef6\u6570\u91cf\uff0c\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u5982\u4e0b\uff1a -- with - cc - opt = \" -D FD_SETSIZE=2048 \" \u3002 -- with - ld - opt = parameters - \u8bbe\u7f6e\u5c06\u5728\u94fe\u63a5\u671f\u95f4\u4f7f\u7528\u7684\u5176\u4ed6\u53c2\u6570\u3002\u5728 FreeBSD \u4e0b\u4f7f\u7528\u7cfb\u7edf PCRE \u5e93\u65f6\uff0c -- with - ld - opt = \" -L /usr/local/lib \" \u5e94\u8be5\u6307\u5b9a\u3002 \u53c2\u6570\u4f7f\u7528\u793a\u4f8b\uff08\u6240\u6709\u8fd9\u4e9b\u90fd\u9700\u8981\u8f93\u5165\u4e00\u884c\uff09\uff1a . / configure -- sbin - path =/ usr / local / nginx / nginx -- conf - path =/ usr / local / nginx / nginx . conf -- pid - path =/ usr / local / nginx / nginx . pid -- with - http_ssl_module -- with - pcre = .. / pcre - 8 . 41 -- with - zlib = .. / zlib - 1 . 2 . 11 \u914d\u7f6e\u5b8c\u6210\u540e\uff0c make && make install \u5b89\u88c5 \u9a8c\u8bc1 nginx \u662f\u5426\u8fd0\u884c\uff1a curl - I 127 . 0 . 0 . 1 \u5173\u4e8e\u6784\u5efa\u6a21\u5757 \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u5305\u62ec\u7684\u6a21\u5757\u4ee5\u53ca\u7b2c\u4e09\u65b9\u6a21\u5757\u5fc5\u987b\u5728configure\u811a\u672c\u4e2d\u4e0e\u5176\u4ed6\u6784\u5efa\u9009\u9879\u4e00\u8d77\u663e\u5f0f\u6307\u5b9a\u3002\u8fd9\u4e9b\u6a21\u5757\u53ef\u4ee5\u9759\u6001\u94fe\u63a5\u5230NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u6bcf\u6b21NGINX\u542f\u52a8\u65f6\u52a0\u8f7d\u5b83\u4eec\uff09\u6216\u52a8\u6001\u52a0\u8f7d\uff08\u53ea\u6709\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u76f8\u5173\u6307\u4ee4\u65f6\u624d\u52a0\u8f7d\u5b83\u4eec\u3002 \u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757 \u5982\u679c\u60a8\u4e0d\u9700\u8981\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u811a\u672c--without-<MODULE-NAME>\u4e0a\u7684\u9009\u9879\u547d\u540d\u5b83\u6765\u7981\u7528\u5b83configure\uff0c\u5982\u6b64\u793a\u4f8b\u4e2d\u7981\u7528Empty GIF\u6a21\u5757\uff08\u5e94\u8be5\u952e\u5165\u4e3a\u5355\u884c\uff09\uff1a \u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\u5982\u4e0b\uff1a | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | http_access_module | \u63a5\u53d7\u6216\u62d2\u7edd\u6765\u81ea\u6307\u5b9a\u5ba2\u6237\u7aef\u5730\u5740\u7684\u8bf7\u6c42\u3002 | | http_auth_basic_module | \u901a\u8fc7\u4f7f\u7528HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u9650\u5236\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 | | http_autoindex_module | \u5904\u7406\u4ee5\u6b63\u659c\u6760\u5b57\u7b26\uff08/\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u751f\u6210\u76ee\u5f55\u5217\u8868\u3002 | | http_browser_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8eUser-Agent\u8bf7\u6c42\u6807\u5934\u503c\u7684\u53d8\u91cf\u3002 | | http_charset_module | \u5c06\u6307\u5b9a\u7684\u5b57\u7b26\u96c6\u6dfb\u52a0\u5230Content-Type\u54cd\u5e94\u6807\u5934\u3002\u53ef\u4ee5\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u5b57\u7b26\u96c6\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u96c6 | | http_empty_gif_module | \u53d1\u51fa\u5355\u50cf\u7d20\u900f\u660eGIF\u3002 | | http_fastcgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u3002 | | http_geo_module | \u4f7f\u7528\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u503c\u521b\u5efa\u53d8\u91cf\u3002 | | http_gzip_module | \u4f7f\u7528gzip\u538b\u7f29\u54cd\u5e94\uff0c\u5c06\u4f20\u8f93\u6570\u636e\u91cf\u51cf\u5c11\u4e00\u534a\u6216\u66f4\u591a\u3002 | | http_limit_conn_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8fde\u63a5\u6570\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8fde\u63a5\u6570\u3002 | | http_limit_req_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8bf7\u6c42\u5904\u7406\u901f\u7387\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8bf7\u6c42\u7684\u5904\u7406\u901f\u7387\u3002 | | http_map_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5176\u4ed6\u53d8\u91cf\u503c\u7684\u53d8\u91cf\u3002 | | http_memcached_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9memcached\u670d\u52a1\u5668\u3002 | | http_proxy_module | \u5c06HTTP\u8bf7\u6c42\u4f20\u9012\u7ed9\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u3002 | | http_referer_module | \u5728Referer\u6807\u5934\u4e2d\u963b\u6b62\u5177\u6709\u65e0\u6548\u503c\u7684\u8bf7\u6c42\u3002 | | http_rewrite_module | \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u66f4\u6539\u8bf7\u6c42URI\u5e76\u8fd4\u56de\u91cd\u5b9a\u5411; \u6709\u6761\u4ef6\u5730\u9009\u62e9\u914d\u7f6e\u3002\u9700\u8981PCRE\u5e93\u3002 | | http_scgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9SCGI\u670d\u52a1\u5668\u3002 | | http_ssi_module | \u5728\u901a\u8fc7\u5b83\u7684\u54cd\u5e94\u4e2d\u5904\u7406SSI\uff08\u670d\u52a1\u5668\u7aef\u5305\u542b\uff09\u547d\u4ee4\u3002 | | http_split_clients_module | \u521b\u5efa\u9002\u5408A / B\u6d4b\u8bd5\u7684\u53d8\u91cf\uff0c\u4e5f\u79f0\u4e3a\u62c6\u5206\u6d4b\u8bd5\u3002 | | http_upstream_hash_module | \u542f\u7528\u901a\u7528\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_ip_hash_module | \u542f\u7528IP\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_keepalive_module | \u542f\u7528keepalive\u8fde\u63a5\u3002 | | http_upstream_least_conn_module | \u542f\u7528\u6700\u5c11\u8fde\u63a5\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_zone_module | \u542f\u7528\u5171\u4eab\u5185\u5b58\u533a\u57df\u3002 | | http_userid_module | \u8bbe\u7f6e\u9002\u5408\u5ba2\u6237\u8bc6\u522b\u7684cookie\u3002 | | http_uwsgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9uwsgi\u670d\u52a1\u5668\u3002 | \u5305\u62ec\u975e\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757 \u00b6 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u6784\u5efa\u8bb8\u591aNGINX\u6a21\u5757\uff0c\u5fc5\u987b\u5728configure\u8981\u6784\u5efa\u7684\u547d\u4ee4\u884c\u4e2d\u5217\u51fa | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | --with-cpp_test_module | \u6d4b\u8bd5\u5934\u6587\u4ef6\u7684C ++\u517c\u5bb9\u6027\u3002 | | --with-debug | \u542f\u7528\u8c03\u8bd5\u65e5\u5fd7\u3002 | | --with-file-aio | \u542f\u7528\u5f02\u6b65I / O. | | --with-google_perftools_module | \u5141\u8bb8\u4f7f\u7528 Google Performance \u5de5\u5177\u5e93 | | -- \u4e0e-http_addition_module | \u5728\u54cd\u5e94\u4e4b\u524d\u548c\u4e4b\u540e\u6dfb\u52a0\u6587\u672c\u3002 | | -- \u4e0e-http_auth_request_module | \u6839\u636e\u5b50\u8bf7\u6c42\u7684\u7ed3\u679c\u5b9e\u73b0\u5ba2\u6237\u7aef\u6388\u6743\u3002 | | -- \u4e0e-http_dav_module | \u4f7f\u7528WebDAV\u534f\u8bae\u542f\u7528\u6587\u4ef6\u7ba1\u7406\u81ea\u52a8\u5316\u3002 | | --with-http_degradation_module | \u5141\u8bb8\u5728\u5185\u5b58\u5927\u5c0f\u8d85\u8fc7\u5b9a\u4e49\u7684\u503c\u65f6\u8fd4\u56de\u9519\u8bef\u3002 | | -- \u4e0e-http_flv_module | \u4e3aFlash Video\uff08FLV\uff09\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_geoip_module | \u5141\u8bb8\u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u53d8\u91cf\u3002\u8be5\u6a21\u5757\u4f7f\u7528MaxMind GeoIP\u6570\u636e\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a-with-http_geoip_module = dynamic\u3002 | | -- \u4e0e-http_gunzip_module | \u4f7f\u7528Content-Encoding\u89e3\u538b\u7f29\u54cd\u5e94\uff1agzip\u7528\u4e8e\u4e0d\u652f\u6301_zip_ encoding\u65b9\u6cd5\u7684\u5ba2\u6237\u7aef\u3002 | | -- \u4e0e-http_gzip_static_module | \u5141\u8bb8\u4f7f\u7528.gz\u6587\u4ef6\u6269\u5c55\u540d\u800c\u4e0d\u662f\u5e38\u89c4\u6587\u4ef6\u53d1\u9001\u9884\u538b\u7f29\u6587\u4ef6\u3002 | | -- \u4e0e-http_image_filter_module | \u4ee5JPEG\uff0cGIF\u548cPNG\u683c\u5f0f\u8f6c\u6362\u56fe\u50cf\u3002\u8be5\u6a21\u5757\u9700\u8981LibGD\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_image_filter_module=dynamic\u3002 | | -- \u4e0e-http_mp4_module | \u4e3aMP4\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_perl_module | \u7528\u4e8e\u5728Perl\u4e2d\u5b9e\u73b0\u4f4d\u7f6e\u548c\u53d8\u91cf\u5904\u7406\u7a0b\u5e8f\uff0c\u5e76\u5c06Perl\u8c03\u7528\u63d2\u5165SSI\u3002\u9700\u8981PERL\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_perl_module=dynamic\u3002 | | -- \u4e0e-http_random_index_module | \u5904\u7406\u4ee5\u659c\u6760\u5b57\u7b26\uff08'/'\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u4e2a\u968f\u673a\u6587\u4ef6\u4f5c\u4e3a\u7d22\u5f15\u6587\u4ef6\u3002 | | -- \u4e0e-http_realip_module | \u5c06\u5ba2\u6237\u7aef\u5730\u5740\u66f4\u6539\u4e3a\u5728\u6307\u5b9a\u7684\u6807\u5934\u5b57\u6bb5\u4e2d\u53d1\u9001\u7684\u5730\u5740\u3002 | | -- \u4e0e-http_secure_link_module | \u7528\u4e8e\u68c0\u67e5\u8bf7\u6c42\u7684\u94fe\u63a5\u7684\u771f\u5b9e\u6027\uff0c\u4fdd\u62a4\u8d44\u6e90\u514d\u53d7\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\uff0c\u5e76\u9650\u5236\u94fe\u63a5\u7684\u751f\u547d\u5468\u671f\u3002 | | -- \u4e0e-http_slice_module | \u5141\u8bb8\u5c06\u8bf7\u6c42\u62c6\u5206\u4e3a\u5b50\u8bf7\u6c42\uff0c\u6bcf\u4e2a\u5b50\u8bf7\u6c42\u8fd4\u56de\u4e00\u5b9a\u8303\u56f4\u7684\u54cd\u5e94\u3002\u63d0\u4f9b\u66f4\u6709\u6548\u7684\u5927\u6587\u4ef6\u7f13\u5b58\u3002 | | -- \u4e0e-http_ssl_module | \u542f\u7528HTTPS\u652f\u6301\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e-http_stub_status_module | \u63d0\u4f9b\u5bf9\u57fa\u672c\u72b6\u6001\u4fe1\u606f\u7684\u8bbf\u95ee\u3002\u8bf7\u6ce8\u610f\uff0cNGINX Plus\u5ba2\u6237\u4e0d\u9700\u8981\u6b64\u6a21\u5757\uff0c\u56e0\u4e3a\u5b83\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86\u6269\u5c55\u72b6\u6001\u6307\u6807\u548c\u4ea4\u4e92\u5f0f\u4eea\u8868\u677f\u3002 | | -- \u4e0e-http_sub_module | \u901a\u8fc7\u5c06\u4e00\u4e2a\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u6765\u4fee\u6539\u54cd\u5e94\u3002 | | -- \u4e0e-http_xslt_module | \u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aXSLT\u6837\u5f0f\u8868\u8f6c\u6362XML\u54cd\u5e94\u3002\u8be5\u6a21\u5757\u9700\u8981Libxml2\u548cXSLT\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_xslt_module=dynamic\u3002 | | -- \u4e0e-http_v2_module | \u542f\u7528\u5bf9HTTP / 2\u7684\u652f\u6301\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX\u535a\u5ba2\u4e0aNGINX\u4e2d\u7684HTTP / 2\u6a21\u5757\u3002 | | -- \u7528\u90ae\u4ef6 | \u542f\u7528\u90ae\u4ef6\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-mail=dynamic\u3002 | | -- \u4e0e-mail_ssl_module | \u4e3a\u90ae\u4ef6\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e\u6d41 | \u542f\u7528TCP\u548cUDP\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-stream=dynamic\u3002 | | -- \u4e0e-stream_ssl_module | \u4e3a\u6d41\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | --with-threads | \u4f7fNGINX\u80fd\u591f\u4f7f\u7528\u7ebf\u7a0b\u6c60\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX Boost Performance 9x\u4e2d\u7684\u7ebf\u7a0b\u6c60\uff01\u5728NGINX\u535a\u5ba2\u4e0a\u3002 | \u5176\u4ed6\u6a21\u5757 \u00b6 \u9759\u6001\u94fe\u63a5\u6a21\u5757 NGINX\u5f00\u6e90\u4e2d\u5185\u7f6e\u7684\u5927\u591a\u6570\u6a21\u5757\u90fd\u662f\u9759\u6001\u94fe\u63a5\u7684 \uff1a\u5b83\u4eec\u5728\u7f16\u8bd1\u65f6\u5185\u7f6e\u4e8e NGINX\u5f00\u6e90\u4e2d \uff0c\u5e76\u9759\u6001\u94fe\u63a5\u5230 NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6 \u3002 \u53ea\u80fd\u901a\u8fc7\u91cd\u65b0\u7f16\u8bd1 NGINX\u6765\u7981\u7528\u8fd9\u4e9b\u6a21\u5757 \u3002 [ NGINX Wiki ]( https : //nginx.com/resources/wiki/modules/)\u4e2d \u5217\u51fa\u4e86\u4e00\u4e9b\u7b2c\u4e09\u65b9\u6a21\u5757 \u8981\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1 NGINX Open Source \uff0c\u8bf7 -- add - module =< PATH > \u5728 configure\u547d\u4ee4\u4e2d\u5305\u542b\u9009\u9879 \uff0c \u5176\u4e2d < PATH > \u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff08\u6b64\u793a\u4f8b\u9002\u7528\u4e8e RTMP \u6a21\u5757\uff09\uff1a . / configure ... -- add - module = / usr / build / nginx - rtmp - module \u52a8\u6001\u94fe\u63a5\u6a21\u5757 NGINX\u6a21\u5757\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u4e3a\u5171\u4eab\u5bf9\u8c61 \uff08 * . so\u6587\u4ef6 \uff09\uff0c\u7136\u540e\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u5230 NGINX Open Source\u4e2d \u3002\u8fd9\u63d0\u4f9b\u4e86\u66f4\u5927\u7684 \u7075\u6d3b\u6027\uff0c\u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7 load_module\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6216\u5220\u9664\u5173\u8054\u6307\u4ee4\u5e76\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6765\u968f\u65f6\u52a0\u8f7d\u6216\u5378\u8f7d\u6a21\u5757 \u3002 \u8bf7\u6ce8\u610f\uff0c\u6a21\u5757\u672c\u8eab\u5fc5\u987b\u652f\u6301\u52a8\u6001\u94fe\u63a5\u3002 \u8981\u4f7f\u7528\u52a8\u6001\u52a0\u8f7d\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1 NGINX Open Source \uff0c\u8bf7 -- add - dynamic - module =< PATH > \u5728 configure\u547d\u4ee4\u4e2d \u5305\u542b\u9009\u9879\uff0c\u5176\u4e2d < PATH > \u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff1a . / configure ... -- add - dynamic - module = < PATH > \u751f\u6210\u7684 * . so\u6587\u4ef6\u5c06\u5199\u5165\u524d\u7f00 / modules / \u76ee\u5f55\uff0c\u5176\u4e2d\u524d\u7f00\u662f\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f8b\u5982 / usr / local / nginx / \u3002 \u8981\u52a0\u8f7d\u52a8\u6001\u6a21\u5757\uff0c\u8bf7 load_module\u5728\u5b89\u88c5\u540e\u5c06\u6307\u4ee4\u6dfb\u52a0\u5230NGINX\u914d\u7f6e \uff1a load_module modules / ngx_mail_module . so ; nginx\u5185\u6838\u76f8\u5173\u53c2\u6570 \u00b6 # / etc / sysctl . conf # Avoid a smurf attack net . ipv4 . icmp_echo_ignore_broadcasts = 1 # Turn on protection for bad icmp error messages net . ipv4 . icmp_ignore_bogus_error_responses = 1 # Turn on syncookies for SYN flood attack protection net . ipv4 . tcp_syncookies = 1 # Turn on and log spoofed , source routed , and redirect packets net . ipv4 . conf . all . log_martians = 1 net . ipv4 . conf . default . log_martians = 1 # No source routed packets here net . ipv4 . conf . all . accept_source_route = 0 net . ipv4 . conf . default . accept_source_route = 0 # Turn on reverse path filtering net . ipv4 . conf . all . rp_filter = 1 net . ipv4 . conf . default . rp_filter = 1 # Make sure no one can alter the routing tables net . ipv4 . conf . all . accept_redirects = 0 net . ipv4 . conf . default . accept_redirects = 0 net . ipv4 . conf . all . secure_redirects = 0 net . ipv4 . conf . default . secure_redirects = 0 # Don ' t act as a router net . ipv4 . ip_forward = 0 net . ipv4 . conf . all . send_redirects = 0 net . ipv4 . conf . default . send_redirects = 0 # Turn on execshild kernel . exec - shield = 1 kernel . randomize_va_space = 1 # Tuen IPv6 net . ipv6 . conf . default . router_solicitations = 0 net . ipv6 . conf . default . accept_ra_rtr_pref = 0 net . ipv6 . conf . default . accept_ra_pinfo = 0 net . ipv6 . conf . default . accept_ra_defrtr = 0 net . ipv6 . conf . default . autoconf = 0 net . ipv6 . conf . default . dad_transmits = 0 net . ipv6 . conf . default . max_addresses = 1 # Optimization for port usefor LBs # Increase system file descriptor limit fs . file - max = 65535 # Allow for more PIDs ( to reduce rollover problems ) ; may break some programs 32768 kernel . pid_max = 65536 # Increase system IP port limits net . ipv4 . ip_local_port_range = 2000 65000 # Increase TCP max buffer size setable using setsockopt () net . ipv4 . tcp_rmem = 4096 87380 8388608 net . ipv4 . tcp_wmem = 4096 87380 8388608 # Increase Linux auto tuning TCP buffer limits # min , default , and max number of bytes to use # set max to at least 4 MB , or higher if you use very high BDP paths # Tcp Windows etc net . core . rmem_max = 8388608 net . core . wmem_max = 8388608 net . core . netdev_max_backlog = 5000 net . ipv4 . tcp_window_scaling = 1 \u521d\u5b66\u8005\u6307\u5357 \u00b6 \u8981\u542f\u52a8nginx\uff0c\u8bf7\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u3002\u542f\u52a8nginx\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528-s\u53c2\u6570\u8c03\u7528\u53ef\u6267\u884c\u6587\u4ef6\u6765\u63a7\u5236\u5b83\u3002\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a nginx -s signal signal\u53ef\u4ee5\u662f\u4e0b\u5217\u4e4b\u4e00\uff1a stop - \u5feb\u901f\u5173\u673a quit - \u4f18\u96c5\u7684\u5173\u673a reload - \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6 reopen - \u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 \u4f8b\u5982\uff0c\u8981\u5728\u7b49\u5f85\u5de5\u4f5c\u8fdb\u7a0b\u5b8c\u6210\u5f53\u524d\u8bf7\u6c42\u7684\u670d\u52a1\u65f6\u505c\u6b62nginx\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a nginx -s quit \u6b64\u547d\u4ee4\u5e94\u5728\u542f\u52a8nginx\u7684\u540c\u4e00\u7528\u6237\u4e0b\u6267\u884c\u3002 nginx\u7531\u6a21\u5757\u7ec4\u6210\uff0c\u6a21\u5757\u7531\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u7684\u6307\u4ee4\u63a7\u5236\uff0c\u6307\u4ee4\u5206\u4e3a\u7b80\u5355\u6307\u4ee4\u548c\u5757\u6307\u4ee4\uff0c\u7b80\u5355\u6307\u4ee4\u5305\u62ec\u7531\u7a7a\u683c\u5206\u9694\u7684\u540d\u79f0\u548c\u53c2\u6570\uff0c\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u5757\u6307\u4ee4\u548c\u7b80\u5355\u6307\u4ee4\u76f8\u540c\u7ed3\u6784\uff0c\u4f46\u4e0d\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u800c\u662f\u4ee5\u5927\u62ec\u53f7 {} \u5305\u56f4\u7684\u4e00\u7ec4\u9644\u52a0\u6307\u4ee4\u7ed3\u675f\uff0c\u82e5\u5757\u6307\u4ee4\u53ef\u4ee5\u5728\u5927\u62ec\u53f7\u5305\u542b\u5176\u4ed6\u6307\u4ee4\uff0c\u5219\u79f0\u4e3a\u4e0a\u4e0b\u6587\u3002\u5982\uff1aevents,http,server\u548clocation \u653e\u7f6e\u5728\u4efb\u4f55\u4e0a\u4e0b\u6587\u4e4b\u5916\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u90fd\u88ab\u8ba4\u4e3a\u662f\u5728\u4e3b\u4e0a\u4e0b\u6587\u4e2d\u3002\u5728events\u548chttp\u6307\u4ee4\u9a7b\u7559\u5728main\u4e0a\u4e0b\u6587server\u4e2d\uff0chttp\u548clocation\u5728server\u4e2d \u9759\u6001\u5185\u5bb9 \u00b6 \u4ece/data/www\u76ee\u5f55\u63d0\u4f9b\u6587\u4ef6\uff0c\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\u5e76\u4f7f\u7528\u4e24\u4e2alocation\u5757\u5728http\u5757\u5185\u8bbe\u7f6eserver\u5757 \u5c06html\u7b49\u9759\u6001\u6587\u4ef6\u653e\u5165/data/www\uff0c\u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5df2\u5305\u542b\u51e0\u4e2aserver\u5757\u5b9e\u4f8b http { server { } } \u901a\u5e38\u914d\u7f6e\u6587\u4ef6\u5305\u62ec\u5b83\u76d1\u542c\u7684\u7aef\u53e3\u548c\u670d\u52a1\u5668\u540d\u79f0\u533a\u5206\u7684\u82e5\u5e72\u4e2aserver\u5757\uff0c\u4e00\u65e6nginx\u51b3\u5b9a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u5b83\u6839\u636e\u5757\u7684\u5b9a\u4e49\u7684\u6307\u4ee4\u53c2\u6570\u6d4b\u8bd5\u8bf7\u6c42\u5934\u4e2d\u6307\u5b9a\u7684URI \u5c06\u4ee5\u4e0blocation\u5757\u6dfb\u52a0\u5230server\u5757\u4e2d location / { root /data/ww ; } \u6b64location\u5757\u6307\u5b9a/\u4e0e\u8bf7\u6c42\u4e2d\u7684URI\u8fdb\u884c\u6bd4\u8f83\u7684\u201c/\u201d\u524d\u7f00\u3002\u5bf9\u4e8e\u5339\u914d\u8bf7\u6c42\uff0cURI\u5c06\u6dfb\u52a0\u5230root \u6307\u4ee4\u4e2d\u6307\u5b9a\u7684\u8def\u5f84 \uff0c\u5373to /data/www\uff0c\u4ee5\u5f62\u6210\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6240\u8bf7\u6c42\u6587\u4ef6\u7684\u8def\u5f84\u3002\u5982\u679c\u5b58\u5728\u591a\u4e2a\u5339\u914dlocation\u5757\uff0c\u5219nginx\u9009\u62e9\u5177\u6709\u6700\u957f\u524d\u7f00\u7684\u5757\u3002location\u4e0a\u9762\u7684\u5757\u63d0\u4f9b\u957f\u5ea6\u4e3a1\u7684\u6700\u77ed\u524d\u7f00\uff0c\u56e0\u6b64\u53ea\u6709\u5f53\u6240\u6709\u5176\u4ed6location \u5757\u90fd\u65e0\u6cd5\u63d0\u4f9b\u5339\u914d\u65f6\uff0c\u624d\u4f1a\u4f7f\u7528\u6b64\u5757\u3002 \u63a5\u7740\u6dfb\u52a0\u7b2c\u4e8c\u4e2alocation\u5757\uff1a location /images/ { root /data ; } \u5b83\u5c06\u5339\u914d\u4ee5/images/\u5f00\u5934\u7684\u8bf7\u6c42 ( location / \u4e5f\u5339\u914d\u6b64\u7c7b\u8bf7\u6c42\uff0c\u4f46\u524d\u7f00\u66f4\u77ed ) server\u5757 \u7684\u7ed3\u679c\u914d\u7f6e\u5e94\u5982\u4e0b\u6240\u793a\uff1a server { location / { root /data/www ; } location /images/ { root /data ; } } \u8bbe\u7f6e\u7b80\u5355\u7684\u4ee3\u7406\u670d\u52a1\u5668 \u00b6 nginx\u53ef\u4ee5\u7528\u4f5c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5373\u670d\u52a1\u5668\u63a5\u53d7\u8bf7\u6c42\uff0c\u5c06\u8fd9\u4e9b\u8bf7\u6c42\u4f20\u9012\u7ed9\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ece\u4e2d\u68c0\u7d22\u54cd\u5e94\uff0c\u7136\u540e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef \u6211\u4eec\u5c06\u914d\u7f6e\u4e00\u4e2a\u57fa\u672c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5b83\u4f7f\u7528\u6765\u81ea\u672c\u5730\u76ee\u5f55\u7684\u6587\u4ef6\u5904\u7406\u56fe\u50cf\u8bf7\u6c42\uff0c\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u53d1\u9001\u5230\u4ee3\u7406\u670d\u52a1\u5668\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u5c06\u5728\u5355\u4e2anginx\u5b9e\u4f8b\u4e0a\u5b9a\u4e49\u4e24\u4e2a\u670d\u52a1\u5668\u3002 \u5411server nginx\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u4ee5\u4e0a\u5185\u5bb9\u6765\u5b9a\u4e49\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a server { listen 8080 ; root /data/up1 ; location / { } } \u8fd9\u5c06\u662f\u4e00\u4e2a\u4fa6\u542c\u7aef\u53e38080\u7684\u7b80\u5355\u670d\u52a1\u5668\uff08\u4e4b\u524d\uff0clisten\u81ea\u4f7f\u7528\u6807\u51c6\u7aef\u53e380\u4ee5\u6765\u672a\u6307\u5b9a\u8be5\u6307\u4ee4\uff09\u5e76\u5c06\u6240\u6709\u8bf7\u6c42\u6620\u5c04\u5230/data/up1\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u76ee\u5f55\u3002\u521b\u5efa\u6b64\u76ee\u5f55\u5e76\u5c06index.html\u6587\u4ef6\u653e\u5165\u5176\u4e2d\u3002\u8bf7\u6ce8\u610f\uff0c\u8be5root\u6307\u4ee4\u653e\u5728 server\u4e0a\u4e0b\u6587\u4e2d\uff0c\u5f53location\u9009\u62e9\u7528\u4e8e\u63d0\u4f9b\u8bf7\u6c42\u7684\u5757\u4e0d\u5305\u62ec\u81ea\u5df1\u7684root\u6307\u4ee4\u65f6\uff0c\u4f7f\u7528\u8fd9\u6837\u7684\u6307\u4ee4 \u63a5\u4e0b\u6765\uff0c\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5e76\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u4ee5\u4f7f\u5176\u6210\u4e3a\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u3002\u5728\u7b2c\u4e00\u4e2alocation\u5757\u4e2d\uff0c\u5c06 proxy_pass \u6307\u4ee4\u4e0e\u53c2\u6570\u4e2d\u6307\u5b9a\u7684\u4ee3\u7406\u670d\u52a1\u5668\u7684\u534f\u8bae\uff0c\u540d\u79f0\u548c\u7aef\u53e3\u653e\u5728\u4e00\u8d77\uff08\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u5b83\u662fhttp://localhost:8080\uff09\uff1a server { location / { proxy_pass http\uff1a//localhost\uff1a8080 ; } location / images / { root / data ; } } \u6211\u4eec\u5c06\u4fee\u6539\u7b2c\u4e8c\u4e2alocation \u5757\uff0c\u8be5\u5757\u5f53\u524d\u5c06\u5e26\u6709/images/\u524d\u7f00\u7684\u8bf7\u6c42\u6620\u5c04\u5230\u76ee\u5f55\u4e0b\u7684/data/images\u6587\u4ef6\uff0c\u4ee5\u4f7f\u5176\u4e0e\u5177\u6709\u5178\u578b\u6587\u4ef6\u6269\u5c55\u540d\u7684\u56fe\u50cf\u8bf7\u6c42\u76f8\u5339\u914d\u3002\u4fee\u6539\u540e\u7684location\u5757\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } \u8be5\u53c2\u6570\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7ed3\u5c3e\u7684\u6240\u6709URI .gif\uff0c.jpg\u6216.png\u3002\u5e94\u8be5\u4ee5\u6b63\u5219\u8868\u8fbe\u5f0f\u5f00\u5934~\u3002\u76f8\u5e94\u7684\u8bf7\u6c42\u5c06\u6620\u5c04\u5230\u8be5/data/images \u76ee\u5f55\u3002 \u5f53nginx\u9009\u62e9\u4e00\u4e2alocation\u5757\u6765\u63d0\u4f9b\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u68c0\u67e5 \u6307\u5b9a\u524d\u7f00\u7684\u4f4d\u7f6e\u6307\u4ee4\uff0c\u8bb0\u4f4flocation \u6700\u957f\u7684\u524d\u7f00\uff0c\u7136\u540e\u68c0\u67e5\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219nginx\u9009\u62e9\u6b64\u9879 location\uff0c\u5426\u5219\uff0c\u5b83\u4f1a\u9009\u62e9\u4e4b\u524d\u8bb0\u4f4f\u7684\u90a3\u4e2a\u3002 \u751f\u6210\u7684\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff1a server { location / { proxy_pass http://localhost:8080/ ; } location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } } \u6b64\u670d\u52a1\u5668\u5c06\u8fc7\u6ee4\u4ee5.gif.jpg\u6216\u8005.png \u5c06\u5176\u6620\u5c04\u5230/data/images\u76ee\u5f55\u7684\u8bf7\u6c42\uff08\u901a\u8fc7\u5411root\u6307\u4ee4\u7684\u53c2\u6570\u6dfb\u52a0URI \uff09\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0a\u9762\u914d\u7f6e\u7684\u4ee3\u7406\u670d\u52a1\u5668 \u8bbe\u7f6eFastCGI\u4ee3\u7406 \u00b6 nginx\u53ef\u7528\u4e8e\u5c06\u8bf7\u6c42\u8def\u7531\u5230FastCGI\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u8fd0\u884c\u4f7f\u7528\u5404\u79cd\u6846\u67b6\u548c\u7f16\u7a0b\u8bed\u8a00\uff08\u5982PHP\uff09\u6784\u5efa\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u4f7f\u7528FastCGI\u670d\u52a1\u5668\u7684\u6700\u57fa\u672c\u7684nginx\u914d\u7f6e\u5305\u62ec\u4f7f\u7528 fastcgi_pass \u6307\u4ee4\u800c\u4e0d\u662fproxy_pass\u6307\u4ee4\uff0c\u4ee5\u53cafastcgi_param \u6307\u4ee4\u6765\u8bbe\u7f6e\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u7684\u53c2\u6570\u3002\u5047\u8bbe\u53ef\u4ee5\u8bbf\u95eeFastCGI\u670d\u52a1\u5668localhost:9000\u3002\u4ee5\u4e0a\u4e00\u8282\u4e2d\u7684\u4ee3\u7406\u914d\u7f6e\u4e3a\u57fa\u7840\uff0c\u5c06proxy_pass\u6307\u4ee4\u66ff\u6362\u4e3a\u6307\u4ee4 fastcgi_pass\u5e76\u5c06\u53c2\u6570\u66f4\u6539\u4e3a localhost:9000\u3002\u5728PHP\u4e2d\uff0c\u8be5SCRIPT_FILENAME\u53c2\u6570\u7528\u4e8e\u786e\u5b9a\u811a\u672c\u540d\u79f0\uff0c\u8be5QUERY_STRING \u53c2\u6570\u7528\u4e8e\u4f20\u9012\u8bf7\u6c42\u53c2\u6570\u3002\u7ed3\u679c\u914d\u7f6e\u4e3a\uff1a server { location / { fastcgi_pass localhost:9000 ; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name ; fastcgi_param QUERY_STRING $query_string ; } location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } } \u8fd9\u5c06\u8bbe\u7f6e\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u5c06\u9664\u9759\u6001\u56fe\u50cf\u8bf7\u6c42\u4e4b\u5916\u7684\u6240\u6709\u8bf7\u6c42\u8def\u7531\u5230localhost:9000\u901a\u8fc7FastCGI\u534f\u8bae\u64cd\u4f5c\u7684\u4ee3\u7406\u670d\u52a1\u5668 Nginx\u7684conf\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3 \u00b6 nginx\u53ca\u5176\u6a21\u5757\u7684\u5de5\u4f5c\u65b9\u5f0f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u786e\u5b9a\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u914d\u7f6e\u6587\u4ef6\u88ab\u547d\u540dnginx.conf \u5e76\u653e\u5728\u76ee\u5f55 /usr/local/nginx/conf\u4e2d /etc/nginx\uff0c\u6216 /usr/local/etc/nginx \u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u914d\u7f6e\u6587\u4ef6 \u4e3a\u4e86\u4f7f\u914d\u7f6e\u66f4\u6613\u4e8e\u7ef4\u62a4\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u5c06\u5176\u62c6\u5206\u4e3a\u4e00\u7ec4\u5b58\u50a8\u5728/etc/nginx/conf.d\u76ee\u5f55\u4e2d\u7684\u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528include\u4e3bnginx.conf\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u6765\u5f15\u7528\u5176\u4e2d\u7684\u5185\u5bb9 include conf.d/http ; include conf.d/stream ; include conf.d/exchange-enhanced ; \u4e00\u4e9b\u9876\u7ea7\u6307\u4ee4\uff08\u79f0\u4e3aContexts\uff09\u5c06\u9002\u7528\u4e8e\u4e0d\u540c\u6d41\u91cf\u7c7b\u578b\u7684\u6307\u4ee4\u7ec4\u5408\u5728\u4e00\u8d77 events - \u4e00\u822c\u8fde\u63a5\u5904\u7406 http - HTTP\u6d41\u91cf mail - \u90ae\u4ef6\u6d41\u91cf stream - TCP\u548cUDP\u6d41\u91cf \u5728\u6bcf\u4e2a\u6d41\u91cf\u5904\u7406\u4e0a\u4e0b\u6587\u4e2d\uff0c\u60a8\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aserver\u5757\u6765\u5b9a\u4e49\u63a7\u5236\u8bf7\u6c42\u5904\u7406\u7684\u865a\u62df\u670d\u52a1\u5668\u3002\u60a8\u53ef\u4ee5\u5728server\u4e0a\u4e0b\u6587\u4e2d\u5305\u542b\u7684\u6307\u4ee4\u56e0\u6d41\u91cf\u7c7b\u578b\u800c\u5f02\u3002 \u5bf9\u4e8eHTTP\u6d41\u91cf\uff08http\u4e0a\u4e0b\u6587\uff09\uff0c\u6bcf\u4e2aserver\u6307\u4ee4\u63a7\u5236\u5bf9\u7279\u5b9a\u57df\u6216IP\u5730\u5740\u7684\u8d44\u6e90\u8bf7\u6c42\u7684\u5904\u7406\u3002location\u4e0a\u4e0b\u6587\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2aserver\u4e0a\u4e0b\u6587\u5b9a\u4e49\u4e86\u5982\u4f55\u5904\u7406\u7279\u5b9a\u7684URI\u96c6\u3002 \u5bf9\u4e8e\u90ae\u4ef6\u548cTCP / UDP\u6d41\u91cf\uff08mail\u548cstream\u4e0a\u4e0b\u6587\uff09\uff0cserver\u6307\u4ee4\u5404\u81ea\u63a7\u5236\u5230\u8fbe\u7279\u5b9aTCP\u7aef\u53e3\u6216UNIX\u5957\u63a5\u5b57\u7684\u6d41\u91cf\u7684\u5904\u7406\u3002 \u4f8b\u5982\uff1a user nobody ; # a directive in the 'main' context events { # configuration of connection processing } http { # Configuration specific to HTTP and affecting all virtual servers server { # configuration of HTTP virtual server 1 location /one { # configuration for processing URIs starting with '/one' } location /two { # configuration for processing URIs starting with '/two' } } server { # configuration of HTTP virtual server 2 } } stream { # Configuration specific to TCP/UDP and affecting all virtual servers server { # configuration of TCP virtual server 1 } } #\u5b9a\u4e49 Nginx \u8fd0\u884c\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4 user www www ; # nginx \u8fdb\u7a0b\u6570\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a\u7b49\u4e8e CPU \u603b\u6838\u5fc3\u6570\u3002 worker_processes auto ; #\u5168\u5c40\u9519\u8bef\u65e5\u5fd7\u5b9a\u4e49\u7c7b\u578b\uff0c[ debug | info | notice | warn | error | crit ] error_log / var / log / nginx / error . log crit ; #\u8fdb\u7a0b\u6587\u4ef6 pid / var / run / nginx . pid ; #\u4e00\u4e2a nginx \u8fdb\u7a0b\u6253\u5f00\u7684\u6700\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee\uff0c\u7406\u8bba\u503c\u5e94\u8be5\u662f\u6700\u591a\u6253\u5f00\u6587\u4ef6\u6570\uff08\u7cfb\u7edf\u7684\u503c ulimit - n \uff09\u4e0e nginx \u8fdb\u7a0b\u6570\u76f8\u9664\uff0c\u4f46\u662f nginx \u5206\u914d\u8bf7\u6c42\u5e76\u4e0d\u5747\u5300\uff0c\u6240\u4ee5\u5efa\u8bae\u4e0e ulimit - n \u7684\u503c\u4fdd\u6301\u4e00\u81f4\u3002 worker_rlimit_nofile 65535 ; #\u5de5\u4f5c\u6a21\u5f0f\u4e0e\u8fde\u63a5\u6570\u4e0a\u9650 events { #\u53c2\u8003\u4e8b\u4ef6\u6a21\u578b\uff0c use [ kqueue | rtsig | epoll | / dev / poll | select | poll ] ; epoll\u6a21\u578b\u662fLinux 2.6\u4ee5\u4e0a\u7248\u672c\u5185\u6838\u4e2d\u7684\u591a\u8def\u590d\u7528\u9ad8\u6027\u80fd\u7f51\u7edcI/O\u6a21\u578b\uff0c\u5982\u679c\u8dd1\u5728FreeBSD\u4e0a\u9762\uff0c\u5c31\u7528kqueue\u6a21\u578b\u3002 use epoll ; #\u5355\u4e2a\u8fdb\u7a0b\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\uff08\u6700\u5927\u8fde\u63a5\u6570 = \u8fde\u63a5\u6570 * \u8fdb\u7a0b\u6570\uff09 worker_connections 65535 ; # \u5e76\u53d1\u603b\u6570\u662f worker_processes \u548c worker_connections \u7684\u4e58\u79ef,\u5373 max_clients = worker_processes * worker_connections # \u5728\u8bbe\u7f6e\u4e86\u53cd\u5411\u4ee3\u7406\u7684\u60c5\u51b5\u4e0b\uff0c max_clients = worker_processes * worker_connections / 4 # \u4e3a\u4ec0\u4e48\u4e0a\u9762\u53cd\u5411\u4ee3\u7406\u8981\u9664\u4ee5 4 \uff0c\u5e94\u8be5\u8bf4\u662f\u4e00\u4e2a\u7ecf\u9a8c\u503c # \u6839\u636e\u4ee5\u4e0a\u6761\u4ef6\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684 Nginx Server \u53ef\u4ee5\u5e94\u4ed8\u7684\u6700\u5927\u8fde\u63a5\u6570\u4e3a\uff1a 4 * 8000 = 32000 # worker_connections \u503c\u7684\u8bbe\u7f6e\u8ddf\u7269\u7406\u5185\u5b58\u5927\u5c0f\u6709\u5173 # \u56e0\u4e3a\u5e76\u53d1\u53d7 IO \u7ea6\u675f\uff0c max_clients \u7684\u503c\u987b\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570 # \u800c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u548c\u5185\u5b58\u5927\u5c0f\u6210\u6b63\u6bd4\uff0c\u4e00\u822c 1 GB \u5185\u5b58\u7684\u673a\u5668\u4e0a\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u6570\u5927\u7ea6\u662f 10 \u4e07\u5de6\u53f3 # \u6211\u4eec\u6765\u770b\u770b 360 M \u5185\u5b58\u7684 VPS \u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u6570\u662f\u591a\u5c11\uff1a # $ cat / proc / sys / fs / file - max # \u8f93\u51fa 34336 # 32000 < 34336 \uff0c\u5373\u5e76\u53d1\u8fde\u63a5\u603b\u6570\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u603b\u6570\uff0c\u6837\u5c31\u5728\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u627f\u53d7\u7684\u8303\u56f4\u4e4b\u5185 # \u6240\u4ee5\uff0c worker_connections \u7684\u503c\u9700\u6839\u636e worker_processes \u8fdb\u7a0b\u6570\u548c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u603b\u6570\u8fdb\u884c\u9002\u5f53\u5730\u8fdb\u884c\u8bbe\u7f6e # \u4f7f\u5f97\u5e76\u53d1\u603b\u6570\u5c0f\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u76ee # \u5176\u5b9e\u8d28\u4e5f\u5c31\u662f\u6839\u636e\u4e3b\u673a\u7684\u7269\u7406 CPU \u548c\u5185\u5b58\u8fdb\u884c\u914d\u7f6e # \u5f53\u7136\uff0c\u7406\u8bba\u4e0a\u7684\u5e76\u53d1\u603b\u6570\u53ef\u80fd\u4f1a\u548c\u5b9e\u9645\u6709\u6240\u504f\u5dee\uff0c\u56e0\u4e3a\u4e3b\u673a\u8fd8\u6709\u5176\u4ed6\u7684\u4f5c\u8fdb\u7a0b\u9700\u8981\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\u3002 # ulimit - SHn 65535 multi_accept on ; } #\u8bbe\u5b9a http \u670d\u52a1\u5668 http { include mime . types ; #\u6587\u4ef6\u6269\u5c55\u540d\u4e0e\u6587\u4ef6\u7c7b\u578b\u6620\u5c04\u8868 default_type application / octet - stream ; #\u9ed8\u8ba4\u6587\u4ef6\u7c7b\u578b # charset utf - 8 ; #\u9ed8\u8ba4\u7f16\u7801 server_names_hash_bucket_size 128 ; #\u670d\u52a1\u5668\u540d\u5b57\u7684hash\u8868\u5927\u5c0f client_header_buffer_size 32 k ; #\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u9650\u5236 large_client_header_buffers 4 64 k ; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58 client_max_body_size 8 m ; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58 sendfile on ; #\u5f00\u542f\u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\u6a21\u5f0f\uff0csendfile\u6307\u4ee4\u6307\u5b9anginx\u662f\u5426\u8c03\u7528sendfile\u51fd\u6570\uff08zero copy \u65b9\u5f0f\uff09\u6765\u8f93\u51fa\u6587\u4ef6\uff0c\u5bf9\u4e8e\u666e\u901a\u5e94\u7528\u8bbe\u4e3a on\uff0c\u5982\u679c\u7528\u6765\u8fdb\u884c\u4e0b\u8f7d\u7b49\u5e94\u7528\u78c1\u76d8IO\u91cd\u8d1f\u8f7d\u5e94\u7528\uff0c\u53ef\u8bbe\u7f6e\u4e3aoff\uff0c\u4ee5\u5e73\u8861\u78c1\u76d8\u4e0e\u7f51\u7edcI/O\u5904\u7406\u901f\u5ea6\uff0c\u964d\u4f4e\u7cfb\u7edf\u7684\u8d1f\u8f7d\u3002\u6ce8\u610f\uff1a\u5982\u679c\u56fe\u7247\u663e\u793a\u4e0d\u6b63\u5e38\u628a\u8fd9\u4e2a\u6539\u6210off\u3002 autoindex on ; #\u5f00\u542f\u76ee\u5f55\u5217\u8868\u8bbf\u95ee\uff0c\u5408\u9002\u4e0b\u8f7d\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u5173\u95ed\u3002 tcp_nopush on ; #\u9632\u6b62\u7f51\u7edc\u963b\u585e tcp_nodelay on ; #\u9632\u6b62\u7f51\u7edc\u963b\u585e keepalive_timeout 120 ; #\u957f\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2 # FastCGI \u76f8\u5173\u53c2\u6570\u662f\u4e3a\u4e86\u6539\u5584\u7f51\u7ad9\u7684\u6027\u80fd\uff1a\u51cf\u5c11\u8d44\u6e90\u5360\u7528\uff0c\u63d0\u9ad8\u8bbf\u95ee\u901f\u5ea6\u3002\u4e0b\u9762\u53c2\u6570\u770b\u5b57\u9762\u610f\u601d\u90fd\u80fd\u7406\u89e3\u3002 fastcgi_connect_timeout 60 ; # \u9ed8\u8ba460s\uff0c\u5efa\u7acb\u8fde\u63a5\u8d8a\u591a\u6d88\u8017\u8d44\u6e90\u8d8a\u591a fastcgi_send_timeout 60 ; fastcgi_read_timeout 60 ; fastcgi_buffer_size 64 k ; fastcgi_buffers 4 64 k ; fastcgi_busy_buffers_size 128 k ; fastcgi_temp_file_write_size 256 k ; fastcgi_intercept_errors on ; fastcgi_cache_valid 200 302 1 h ; # \u6307\u5b9a\u5e94\u7b54\u4ee3\u7801\u7f13\u5b58\u65f6\u95f4 fastcgi_cache_min_uses 1 ; # \u8bf7\u6c42\u51e0\u6b21\u54cd\u5e94\u540e\u5c06\u88ab\u7f13\u5b58\uff0c1\u8868\u793a\u4e00\u6b21\u5c31\u7f13\u5b58 fastcgi_cache_use_stale error timeout invalid_header http_500 ; # \u5b9a\u4e49\u90a3\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u8fc7\u671f\u7f13\u5b58 fastcgi_cache_key $ request_method : // $ host $ request_uri ; # \u6b64\u793a\u4f8b\u4ee5\u8bf7\u6c42\u7684uri\u4f5c\u4e3a\u7f13\u5b58\u7684key\u503c # gzip \u6a21\u5757\u8bbe\u7f6e gzip on ; #\u5f00\u542fgzip\u538b\u7f29\u8f93\u51fa gzip_min_length 1 k ; #\u6700\u5c0f\u538b\u7f29\u6587\u4ef6\u5927\u5c0f gzip_buffers 4 16 k ; #\u538b\u7f29\u7f13\u51b2\u533a gzip_http_version 1 . 1 ; #\u538b\u7f29\u7248\u672c\uff08\u9ed8\u8ba41.1\uff0c\u524d\u7aef\u5982\u679c\u662fsquid2.5\u8bf7\u4f7f\u75281.0\uff09 gzip_comp_level 2 ; #\u538b\u7f29\u7b49\u7ea7 gzip_types text / plain application / x - javascript text / javascript text / css application / xml ; #\u538b\u7f29\u7c7b\u578b\uff0c\u9ed8\u8ba4\u5c31\u5df2\u7ecf\u5305\u542b text / html \uff0c\u6240\u4ee5\u4e0b\u9762\u5c31\u4e0d\u7528\u518d\u5199\u4e86\uff0c\u5199\u4e0a\u53bb\u4e5f\u4e0d\u4f1a\u6709\u95ee\u9898\uff0c\u4f46\u662f\u4f1a\u6709\u4e00\u4e2a warn \u3002 gzip_vary on ; # limit_zone crawler $b inary_remote_addr 10 m ; #\u5f00\u542f\u9650\u5236IP\u8fde\u63a5\u6570\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528 gzip_proxied expired no - cache no - store private auth ; gzip_disable \" MSIE [1-6]\\. \" ; limit_conn_zone $b inary_remote_addr zone = perip : 10 m ; limit_conn_zone $ server_name zone = perserver : 10 m ; server_tokens off ; access_log off ; upstream www . 19950128 . com { # upstream \u7684\u8d1f\u8f7d\u5747\u8861\uff0c weight \u662f\u6743\u91cd\uff0c\u53ef\u4ee5\u6839\u636e\u673a\u5668\u914d\u7f6e\u5b9a\u4e49\u6743\u91cd\u3002 weigth \u53c2\u6570\u8868\u793a\u6743\u503c\uff0c\u6743\u503c\u8d8a\u9ad8\u88ab\u5206\u914d\u5230\u7684\u51e0\u7387\u8d8a\u5927\u3002 server 192 . 168 . 80 . 121 : 80 weight = 3 ; server 192 . 168 . 80 . 122 : 80 weight = 2 ; server 192 . 168 . 80 . 123 : 80 weight = 3 ; } #\u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e server { #\u76d1\u542c\u7aef\u53e3 listen 80 ; #\u57df\u540d\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u7528\u7a7a\u683c\u9694\u5f00 server_name www . 19950128 . com ; index index . html index . htm index . php ; root / data / www / ; # error_page 404 / 404 . html ; include enable - php . conf ; location ~ . * \\. ( php | php5 | ) ?$ { fastcgi_pass 127 . 0 . 0 . 1 : 9000 ; fastcgi_index index . php ; include fastcgi . conf ; } #\u56fe\u7247\u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e location ~ . * \\. ( gif | jpg | jpeg | png | bmp | swf ) $ { expires 10 d ; } # JS \u548c CSS \u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e location ~ . * \\. ( js | css ) ?$ { expires 1 h ; } # \u5b9a\u4e49\u9519\u8bef\u63d0\u793a\u9875\u9762 error_page 500 502 503 504 / 50 x . html ; location = / 50 x . html { } #\u65e5\u5fd7\u683c\u5f0f 1 log_format access ' $remote_addr - $remote_user [$time_local] \"$request\" ' ' $status $body_bytes_sent \"$http_referer\" ' ' \"$http_user_agent\" $http_x_forwarded_for ' ; # \u65e5\u5fd7\u683c\u5f0f 2 log_format custom ' $remote_addr - $remote_user [$time_local] ' ' \"$request\" $status $body_bytes_sent ' ' \"$http_referer\" \"$http_user_agent\" ' ' \"$http_x_forwarded_for\" $request_id ' ' $geoip_country_name $geoip_country_code ' ' $geoip_region_name $geoip_city ' ; #\u5b9a\u4e49\u672c\u865a\u62df\u4e3b\u673a\u7684\u8bbf\u95ee\u65e5\u5fd7 access_log / var / log / nginx / access . log ; #\u5bf9 \" / \" \u542f\u7528\u53cd\u5411\u4ee3\u7406 location / { proxy_pass http : // 127 . 0 . 0 . 1 : 88 ; proxy_redirect off ; proxy_set_header X - Real - IP $ remote_addr ; #\u540e\u7aef\u7684 Web \u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7 X - Forwarded - For \u83b7\u53d6\u7528\u6237\u771f\u5b9e IP proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; #\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53cd\u5411\u4ee3\u7406\u7684\u914d\u7f6e\uff0c\u53ef\u9009\u3002 proxy_set_header Host $ host ; client_max_body_size 10 m ; #\u5141\u8bb8\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5355\u6587\u4ef6\u5b57\u8282\u6570 client_body_buffer_size 128 k ; #\u7f13\u51b2\u533a\u4ee3\u7406\u7f13\u51b2\u7528\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c proxy_connect_timeout 90 ; #nginx\u8ddf\u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4(\u4ee3\u7406\u8fde\u63a5\u8d85\u65f6) proxy_send_timeout 90 ; #\u540e\u7aef\u670d\u52a1\u5668\u6570\u636e\u56de\u4f20\u65f6\u95f4(\u4ee3\u7406\u53d1\u9001\u8d85\u65f6) proxy_read_timeout 90 ; #\u8fde\u63a5\u6210\u529f\u540e\uff0c\u540e\u7aef\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4(\u4ee3\u7406\u63a5\u6536\u8d85\u65f6) proxy_buffer_size 4 k ; #\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\uff08nginx\uff09\u4fdd\u5b58\u7528\u6237\u5934\u4fe1\u606f\u7684\u7f13\u51b2\u533a\u5927\u5c0f proxy_buffers 4 32 k ; #proxy_buffers\u7f13\u51b2\u533a\uff0c\u7f51\u9875\u5e73\u5747\u572832k\u4ee5\u4e0b\u7684\u8bbe\u7f6e proxy_busy_buffers_size 64 k ; #\u9ad8\u8d1f\u8377\u4e0b\u7f13\u51b2\u5927\u5c0f\uff08proxy_buffers*2\uff09 proxy_temp_file_write_size 64 k ; #\u8bbe\u5b9a\u7f13\u5b58\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5927\u4e8e\u8fd9\u4e2a\u503c\uff0c\u5c06\u4ece upstream \u670d\u52a1\u5668\u4f20 } #\u8bbe\u5b9a\u67e5\u770b Nginx \u72b6\u6001\u7684\u5730\u5740 location / NginxStatus { stub_status on ; access_log on ; auth_basic \" NginxStatus \" ; auth_basic_user_file conf / htpasswd ; # htpasswd \u6587\u4ef6\u7684\u5185\u5bb9\u53ef\u4ee5\u7528 apache \u63d0\u4f9b\u7684 htpasswd \u5de5\u5177\u6765\u4ea7\u751f\u3002 } #\u672c\u5730\u52a8\u9759\u5206\u79bb\u53cd\u5411\u4ee3\u7406\u914d\u7f6e #\u6240\u6709 jsp \u7684\u9875\u9762\u5747\u4ea4\u7531 tomcat \u6216 resin \u5904\u7406 location ~ . ( jsp | jspx | do ) ?$ { proxy_set_header Host $ host ; proxy_set_header X - Real - IP $ remote_addr ; proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_pass http : // 127 . 0 . 0 . 1 : 8080 ; } #\u6240\u6709\u9759\u6001\u6587\u4ef6\u7531 nginx \u76f4\u63a5\u8bfb\u53d6\u4e0d\u7ecf\u8fc7 tomcat \u6216 resin location ~ . * . ( htm | html | gif | jpg | jpeg | png | bmp | swf | ioc | rar | zip | txt | flv | mid | doc | ppt | pdf | xls | mp3 | wma ) $ { expires 15 d ; } location ~ . * . ( js | css ) ?$ { expires 1 h ; } #\u7981\u6b62\u8bbf\u95ee . htxxx \u6587\u4ef6 location ~ / . ht { deny all ; } } } nginx.conf\u914d\u7f6e\u8865\u5145\u6269\u5c55\uff1a #\u9759\u6001\u6587\u4ef6\uff0c nginx \u81ea\u5df1\u5904\u7406 location ~ ^/ ( images | javascript | js | css | flash | media | static / { #\u8fc7\u671f 30 \u5929\uff0c\u9759\u6001\u6587\u4ef6\u4e0d\u600e\u4e48\u66f4\u65b0\uff0c\u8fc7\u671f\u53ef\u4ee5\u8bbe\u5927\u4e00\u70b9\uff0c #\u5982\u679c\u9891\u7e41\u66f4\u65b0\uff0c\u5219\u53ef\u4ee5\u8bbe\u7f6e\u5f97\u5c0f\u4e00\u70b9\u3002 expires 30 d ; } # PHP \u811a\u672c\u8bf7\u6c42\u5168\u90e8\u8f6c\u53d1\u5230 FastCGI \u5904\u7406. \u4f7f\u7528 FastCGI \u9ed8\u8ba4\u914d\u7f6e. location ~* \\. php $ { fastcgi_index index . php ; fastcgi_pass 127 . 0 . 0 . 1 : 9000 ; include fastcgi_params ; fastcgi_param SCRIPT_FILENAME $d ocument_root $fa stcgi_script_name ; fastcgi_param SCRIPT_NAME $fa stcgi_script_name ; } # \u62d2\u7edd\u56fe\u7247\u70ed\u94fe\u63a5 location / images / { valid_referers none blocked www . example . com example . com ; if ( $ invalid_referer ) { return 403 ; } } \u53e6\u5916\u4e00\u4e2a\u65b9\u6cd5\u53ef\u8df3\u8f6c\u5230\u4e00\u4e2a\u56fa\u5b9a\u7684\u56fe\u7247\u94fe\u63a5\u6216 url valid_referers blocked www . example . com example . com ; if ( $ invalid_referer ) { rewrite ^/ images / uploads . * \\. ( gif | jpg | jpeg | png ) $ http : // www . examples . com / banned . jpg last } ### Password Protect / personal - images / and / delta / directories ### location ~ / ( personal - images / . *| delta / . * ) { auth_basic \" Restricted \" ; auth_basic_user_file / usr / local / nginx / conf / . htpasswd / passwd ; } Create an SSL Certificate # cd / usr / local / nginx / conf # openssl genrsa - des3 - out server . key 1024 # openssl req - new - key server . key - out server . csr # cp server . key server . key . org # openssl rsa - in server . key . org - out server . key # openssl x509 - req - days 365 - in server . csr - signkey server . key - out server . crt nginx\u65e5\u5fd7\u76f8\u5173\u547d\u4ee4 \u00b6 nginx\u65e5\u5fd7\u6700\u597d\u5b9e\u73b0\u6bcf\u5929\u5b9a\u65f6\u5207\u5272\u4e0b\uff0c\u7279\u522b\u662f\u5728\u8bbf\u95ee\u91cf\u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u65b9\u4fbf\u67e5\u770b\u4e0e\u5904\u7406\uff0c\u5982\u679c\u6ca1\u5207\u5272\uff0c\u53ef\u4ee5\u7528sed\u76f4\u63a5\u5207\u5272\uff0c \u5207\u5272\u65e5\u5fd7 \u67e5\u627e7\u670817\u65e5\u8bbf\u95eelog\u5bfc\u51fa\u523017.log\u6587\u4ef6\u4e2d\uff1a cat gelin_web_access.log | egrep \"17/Jul/2017\" | sed -n '/00:00:00/,/23:59:59/p' > /tmp/17.log \u67e5\u770b\u8bbf\u95ee\u91cf\u524d10\u7684IP awk '{print $1}' 17 .log | sort | uniq -c | sort -nr | head -n 10 \u67e5\u770b\u8bbf\u95ee\u524d10\u7684URL awk '{print $11}' gelin_web_access.log | sort | uniq -c | sort -nr | head -n 10 \u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684URL awk '{print $7}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more \u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684IP awk '{print $1}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more \u6839\u636e\u8bbf\u95eeIP\u7edf\u8ba1UV awk '{print $1}' gelin_web_access.log | sort | uniq -c | wc -l \u7edf\u8ba1\u8bbf\u95eeURL\u7edf\u8ba1PV awk '{print $7}' gelin_web_access.log | wc -l \u6839\u636e\u65f6\u95f4\u6bb5\u7edf\u8ba1\u67e5\u770b\u65e5\u5fd7 cat gelin_web_access.log | sed -n '/17\\/Jul\\/2017:12/,/17\\/Jul\\/2017:13/p' | more Unit1.8.0 \u00b6 # Control socket\u4f4d\u7f6e\uff1a/var/run/control.unit.sock cat << EOF > /etc/yum.repos.d/unit.repo [unit] name=unit repo baseurl=https://packages.nginx.org/unit/centos/7/$basearch/ gpgcheck=0 enabled=1 EOF # \u8bbe\u7f6e\u4e00\u4e2aapplication\u5bf9\u8c61,\u5229\u7528json\u6587\u4ef6\uff0c\u5c06\u5bf9\u8c61\u653e\u5165\u5230config/applications\u4e0b\u7684blogs\u5757\u4e2d curl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/ # \u4ecelisteners\u5bf9\u8c61\u5f15\u7528application\u5bf9\u8c61\uff0c\u5176\u5305\u62ecIP(\u6216\u4efb\u4f55\u5339\u914dIP\u7684\u901a\u914d\u7b26)\u548c\u7aef\u53e3\u53f7config/listeners curl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/listeners/127.0.0.1:8300 # \u68c0\u67e5\u76ee\u524d\u7684\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u4e00\u6b21\u6027\u4e0a\u4f20\u4e0a\u9762\u7684\u4e24\u6b65\u7684\u5168\u90e8\u914d\u7f6e curl --unix-socket /var/run/control.unit.sock http://localhost/config/ # \u521b\u5efa\u5bf9\u8c61 curl -X PUT -d @/path/to/start.json --unix-socket /var/run/control.unit.sock http://localhost/config/ # \u4fee\u6539application\u5bf9\u8c61blogs,\u5c06\u5176listeners\u66f4\u6539\u4e3a*:8400 curl -X PUT -d '\"blogs\"' --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400/application' # \u5c06blogs\u7684application\u5bf9\u8c61\u4e2d\u7684root\u53c2\u6570\u66f4\u6539\u4e3a/www/blogs-dev curl -X PUT -d '\"/www/blogs-dev\"' --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/root # \u5220\u9664\u5bf9\u8c61\uff0c\u8981\u5220\u9664\u5bf9\u8c61\uff0c\u9700\u8981\u53d1\u51faDELETE\u8bf7\u6c42\u5e76\u5c06\u5bf9\u8c61\u7684\u8def\u5f84\u9644\u52a0\u5230curl URL\u3002\u5982\u4e0b\uff1a\u5220\u9664listener\u76d1\u542c*:8400 curl -X DELETE --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400' # listeners | \u9009\u9879 | \u63cf\u8ff0 | | :------: | :------: | | application ( \u5df2\u5e9f\u5f03 ) | \u5e94\u7528\u540d\u79f0,\u4e0epass\u4e92\u65a5 | | pass ( required ) | \u5e94\u7528\u6216\u8def\u7531\u540d\u79f0\uff1a \"pass\" : \"routers/route66\" , \"pass\" : \"applications/smart\" | | tls | SSL/TLS\u914d\u7f6e,\u6dfb\u52a0certificate\u5b9e\u73b0listener\u52a0\u5bc6\u901a\u4fe1 | # Routers,\u5229\u7528routers\u5bf9\u8c61\u5b9e\u73b0listeners\u548capps\u5185\u90e8\u8def\u7531\uff0clisteners\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9pass\u6216\u76f4\u63a5\u4f20\u9012\u7ed9\u5e94\u7528\u7a0b\u5e8f # routers\u5bf9\u8c61\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aroute\u53c2\u6570.\u4f8b\u5982\uff1a { \"listeners\" : { \"*:8300\" : { \"pass\" : \"routes\" } }, \"routes\" : [ \"simply referred to as routes\" ] } # \u591a\u4e2a { \"listeners\" : { \"*:8300\" : { \"pass\" : \"routes/main\" } }, \"routes\" : { \"main\" : [ \"named route, qualified name: routes/main\" ], \"route66\" : [ \"named route, qualified name: routes/route66\" ] } } route\u53c2\u6570\u5305\u542b\u533f\u540d\u5bf9\u8c61\u6216steps\u3002\u8bf7\u6c42\u901a\u8fc7route\u53bb\u904d\u5386\uff0csteps\u6709\u5982\u4e0b\u9009\u9879 | \u9009\u9879 | \u63cf\u8ff0 | | :------: | :------: | | match | \u5b9a\u4e49\u6b65\u9aa4\u6761\u4ef6\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u8bf7\u6c42\u548cmatch\u6761\u4ef6\u5339\u914d\uff0cpass\u6b65\u9aa4\u5c06\u751f\u6548\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u5c06\u7ee7\u7eed\u8fdb\u884croute\u7684\u4e0b\u4e00\u6b65\uff0c\u5982\u679c\u90fd\u4e0d\u5339\u914d\uff0c\u8fd4\u56de404\u9519\u8bef | | action/pass(required) | route\u7684\u76ee\u7684\u5730\uff0c\u5982\u679c\u5ffd\u7565\u4e86match\uff0c\u8bf7\u6c42\u76f4\u63a5\u901a\u8fc7\uff0c\u907f\u514d\u51fa\u9519\uff0c\u6bcf\u4e2aroute\u4f7f\u7528\u4e00\u4e2a\u8fd9\u6837\u7684\u6b65\u9aa4\u5e76\u653e\u5728\u6700\u540e | { \"routes\" : [ { \"match\" : { \"host\" : \"example.com\" , \"uri\" : \"/admin/*\" }, \"action\" : { \"pass\" : \"applications/php5_app\" } }, { \"action\" : { \"pass\" : \"applications/php7_app\" } } ] } # \u66f4\u8be6\u7ec6\u7684\u7684\u793a\u4f8b { \"routes\" : { \"main\" : [ { \"match\" : { \"host\" : [ \"www.example.com\" , \"example.com\" ] }, \"action\" : { \"pass\" : \"routes/site\" } }, { \"match\" : { \"host\" : \"blog.example.com\" }, \"action\" : { \"pass\" : \"applications/blog\" } } ], \"site\" : [ \"...\" ] } } # \u6761\u4ef6\u5339\u914d\uff1b\u6b65\u9aa4\u4e2d\u7684\u5339\u914d\u6761\u4ef6\u5305\u62ec\u8bf7\u6c42\u5c5e\u6027\u540d\u79f0\u548c\u76f8\u5e94\u7684pattern { \"match\" : { \"request_property1\" : \"pattern\" , \"request_property2\" : [ \"pattern\" , \"pattern\" , \"...\" ] }, \"action\" : { \"pass\" : \"...\" } } \u9009\u9879 \u63cf\u8ff0 host \u8bf7\u6c42\u4e3b\u673a\u4eceHost\u6ca1\u6709\u7aef\u53e3\u53f7\u7684header\u5b57\u6bb5\uff0c\u901a\u8fc7\u5220\u9664\u5c3e\u968f\u53e5\u70b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u8fdb\u884c\u89c4\u8303\u5316;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 method \u6765\u81ea\u8bf7\u6c42\u884c\u7684\u8bf7\u6c42\u65b9\u6cd5;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 uri \u8bf7\u6c42URI\u6ca1\u6709\u53c2\u6570\u7684\u8def\u5f84\uff0c\u901a\u8fc7\u89e3\u7801\u201c%XX\u201d\u5e8f\u5217\uff0c\u89e3\u6790\u76f8\u5bf9\u8def\u5f84\u5f15\u7528\uff08\u201c.\u201d\u548c\u201c..\u201d\uff09\uff0c\u5e76\u5c06\u76f8\u90bb\u659c\u6760\u538b\u7f29\u4e3a\u4e00\u4e2a;\u533a\u5206\u5927\u5c0f\u5199 pattern\u5fc5\u987b\u5b8c\u5168\u5339\u914d\uff0c\u652f\u6301*\u548c!","title":"Nginx"},{"location":"Nginx/#nginxunit","text":"","title":"Nginx&amp;&amp;Unit"},{"location":"Nginx/#centos","text":"# To set up the yum repository for RHEL/CentOS, create the file named /etc/yum.repos.d/nginx.repo with the following contents: # Replace \u201cOS\u201d with \u201crhel\u201d or \u201ccentos\u201d, depending on the distribution used, and \u201cOSRELEASE\u201d with \u201c6\u201d or \u201c7\u201d, for 6.x or 7.x versions, respectively. cat << EOF > /etc/yum.repos.d/nginx.repo [nginx-stable] name=nginx stable repo baseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/ gpgcheck=1 enabled=1 gpgkey=https://nginx.org/keys/nginx_signing.key EOF # \u5bf9\u4e8eDebian / Ubuntu\uff0c\u4e3a\u4e86\u9a8c\u8bc1nginx\u5b58\u50a8\u5e93\u7b7e\u540d\u5e76\u5728\u5b89\u88c5nginx\u8f6f\u4ef6\u5305\u65f6\u6d88\u9664\u6709\u5173\u4e22\u5931PGP\u5bc6\u94a5\u7684\u8b66\u544a\uff0c\u6709\u5fc5\u8981\u5c06\u7528\u4e8e\u7b7e\u7f72nginx\u8f6f\u4ef6\u5305\u548c\u5b58\u50a8\u5e93\u7684\u5bc6\u94a5\u6dfb\u52a0\u5230apt\u7a0b\u5e8f\u5bc6\u94a5\u73af\u4e2d\u3002\u8bf7\u4ece\u6211\u4eec\u7684\u7f51\u7ad9\u4e0b\u8f7d\u6b64\u5bc6\u94a5\uff0c\u5e76apt \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5176\u6dfb\u52a0\u5230\u7a0b\u5e8f\u5bc6\u94a5\u73af\uff1a wget -c http://nginx.org/keys/nginx_signing.key sudo apt-key add nginx_signing.key # \u5bf9\u4e8eDebian\uff0c\u7528Debian\u5206\u53d1\u4ee3\u53f7\u53d6\u4ee3codename cat << EOF > /etc/apt/sources.list deb http://nginx.org/packages/debian/ codename nginx deb-src http://nginx.org/packages/debian/ codename nginx EOF apt-get update && apt-get install nginx # Mainline\u7248\u672c\u7684\u9884\u6784\u5efa\u5305;\u5229\u7528rpm\u5305\u5b89\u88c5 rpm --import nginx_signing.key wget http://nginx.org/packages/mainline/centos/7/x86_64/RPMS/nginx-1.13.9-1.el7_4.ngx.x86_64.rpm rpm -ivh nginx-1.13.9-1.el7_4.ngx.x86_64.rpm systemctl enable nginx && systemctl start nginx 2.\u4ece\u6e90\u4ee3\u7801\u6784\u5efanginx wget - c http : // nginx . org / download / nginx - 1 . 12 . 2 . tar . gz # \u6784\u5efa\u4f7f\u7528 configure \u547d\u4ee4\u8fdb\u884c\u914d\u7f6e\u3002\u5b83\u5b9a\u4e49\u4e86\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\uff0c\u5305\u62ec nginx \u5141\u8bb8\u7528\u4e8e\u8fde\u63a5\u5904\u7406\u7684\u65b9\u6cd5\u3002\u6700\u540e\u5b83\u521b\u5efa\u4e00\u4e2a Makefile \u3002\u8be5 configure \u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u53c2\u6570\uff1a -- prefix = path - \u5b9a\u4e49\u4e00\u4e2a\u5c06\u4fdd\u7559\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\u3002\u8fd9\u4e2a\u76f8\u540c\u7684\u76ee\u5f55\u4e5f\u5c06\u88ab\u7528\u4e8e\u6240\u6709\u76f8\u5173\u7684\u8def\u5f84 configure \uff08\u9664\u4e86\u6e90\u8d44\u6e90\u7684\u8def\u5f84\uff09\u548c nginx . conf \u914d\u7f6e\u6587\u4ef6\u3002\u5b83 / usr / local / nginx \u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u76ee\u5f55\u3002 -- sbin - path = path - \u8bbe\u7f6e\u4e00\u4e2a nginx \u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u5b57\u3002\u8be5\u540d\u79f0\u4ec5\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / sbin / nginx \u3002 -- conf - path = path - \u8bbe\u7f6e nginx . conf \u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c nginx \u53ef\u4ee5\u59cb\u7ec8\u4f7f\u7528\u4e0d\u540c\u7684\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\uff0c\u53ea\u8981\u5728\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u6307\u5b9a\u5373\u53ef \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d \u3002 - c fileprefix / conf / nginx . conf -- pid - path = path - \u8bbe\u7f6e\u5c06\u5b58\u50a8\u4e3b\u8fdb\u7a0b\u7684\u8fdb\u7a0b ID \u7684 nginx . pid \u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 pid \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / nginx . pid \u3002 -- error - log - path = path - \u8bbe\u7f6e\u4e3b\u8981\u9519\u8bef\u7684\u540d\u79f0\uff0c\u8b66\u544a\u548c\u8bca\u65ad\u6587\u4ef6\u3002\u5b89\u88c5\u4e4b\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 error_log \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / error . log \u3002 -- http - log - path = path - \u8bbe\u7f6e HTTP \u670d\u52a1\u5668\u7684\u4e3b\u8981\u8bf7\u6c42\u65e5\u5fd7\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 access_log \u6307\u4ee4\u968f\u65f6\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix / logs / access . log \u3002 -- build = name - \u8bbe\u7f6e\u4e00\u4e2a\u53ef\u9009\u7684 nginx \u6784\u5efa\u540d\u79f0\u3002 -- user = name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 user \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u7684\u7528\u6237\u540d\u662f nobody \u3002 -- group = name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u7ec4\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5 nginx . conf \u4f7f\u7528 user \u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7ec4\u540d\u79f0\u8bbe\u7f6e\u4e3a\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\u3002 -- with - select_module -- without - select_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5 select () \u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982 kqueue \uff0c epoll \u6216 / dev / poll \uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\u3002 -- with - poll_module -- without - poll_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5 poll () \u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982 kqueue \uff0c epoll \u6216 / dev / poll \uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\u3002 -- without - http_gzip_module - \u7981\u7528\u6784\u5efa\u538b\u7f29 HTTP \u670d\u52a1\u5668\u54cd\u5e94\u7684\u6a21\u5757\u3002 zlib \u5e93\u662f\u5efa\u7acb\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u6240\u5fc5\u9700\u7684\u3002 -- without - http_rewrite_module - \u7981\u7528\u6784\u5efa\u5141\u8bb8 HTTP \u670d\u52a1\u5668 \u91cd\u5b9a\u5411\u8bf7\u6c42\u5e76\u66f4\u6539\u8bf7\u6c42 URI \u7684\u6a21\u5757\u3002 PCRE \u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u3002 -- without - http_proxy_module - \u7981\u7528\u6784\u5efa HTTP \u670d\u52a1\u5668\u4ee3\u7406\u6a21\u5757\u3002 -- with - http_ssl_module - \u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c\u5c06 HTTPS \u534f\u8bae\u652f\u6301\u6dfb\u52a0\u5230 HTTP \u670d\u52a1\u5668\u3002\u8be5\u6a21\u5757\u4e0d\u662f\u9ed8\u8ba4\u751f\u6210\u7684\u3002 OpenSSL \u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u3002 -- with - pcre = path - \u8bbe\u7f6e PCRE \u5e93\u6e90\u7684\u8def\u5f84\u3002\u56fe\u4e66\u9986\u53d1\u884c\uff08\u7248\u672c 4 . 4 - 8 . 41 \uff09\u9700\u8981\u4ece PCRE \u7f51\u7ad9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531 nginx \u7684. / configure \u548c make \u3002\u5728\u4f4d\u7f6e\u6307\u4ee4\u548c ngx_http_rewrite_module \u6a21\u5757\u4e2d\uff0c\u8be5\u5e93\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u652f\u6301\u6240\u5fc5\u9700\u7684 \u3002 -- with - pcre - jit - \u7528\u201c\u5373\u65f6\u7f16\u8bd1\u201d\u652f\u6301\uff08 1 . 1 . 12 \uff0c pcre_jit \u6307\u4ee4\uff09\u6784\u5efa PCRE \u5e93 \u3002 -- with - zlib = path - \u8bbe\u7f6e zlib \u5e93\u7684\u6e90\u7684\u8def\u5f84\u3002\u5e93\u53d1\u884c\u7248\uff08\u7248\u672c 1 . 1 . 3 - 1 . 2 . 11 \uff09\u9700\u8981\u4ece zlib \u7ad9\u70b9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531 nginx \u7684. / configure \u548c make \u3002\u8be5\u5e93\u662f ngx_http_gzip_module \u6a21\u5757\u6240\u5fc5\u9700\u7684 \u3002 -- with - cc - opt = parameters - \u8bbe\u7f6e\u5c06\u88ab\u6dfb\u52a0\u5230 CFLAGS \u53d8\u91cf\u7684\u9644\u52a0\u53c2\u6570\u3002\u5728 FreeBSD \u4e0b\u4f7f\u7528\u7cfb\u7edf PCRE \u5e93\u65f6\uff0c -- with - cc - opt = \" -I /usr/local/include \" \u5e94\u8be5\u6307\u5b9a\u3002\u5982\u679c select () \u9700\u8981\u589e\u52a0\u652f\u6301\u7684\u6587\u4ef6\u6570\u91cf\uff0c\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u5982\u4e0b\uff1a -- with - cc - opt = \" -D FD_SETSIZE=2048 \" \u3002 -- with - ld - opt = parameters - \u8bbe\u7f6e\u5c06\u5728\u94fe\u63a5\u671f\u95f4\u4f7f\u7528\u7684\u5176\u4ed6\u53c2\u6570\u3002\u5728 FreeBSD \u4e0b\u4f7f\u7528\u7cfb\u7edf PCRE \u5e93\u65f6\uff0c -- with - ld - opt = \" -L /usr/local/lib \" \u5e94\u8be5\u6307\u5b9a\u3002 \u53c2\u6570\u4f7f\u7528\u793a\u4f8b\uff08\u6240\u6709\u8fd9\u4e9b\u90fd\u9700\u8981\u8f93\u5165\u4e00\u884c\uff09\uff1a . / configure -- sbin - path =/ usr / local / nginx / nginx -- conf - path =/ usr / local / nginx / nginx . conf -- pid - path =/ usr / local / nginx / nginx . pid -- with - http_ssl_module -- with - pcre = .. / pcre - 8 . 41 -- with - zlib = .. / zlib - 1 . 2 . 11 \u914d\u7f6e\u5b8c\u6210\u540e\uff0c make && make install \u5b89\u88c5 \u9a8c\u8bc1 nginx \u662f\u5426\u8fd0\u884c\uff1a curl - I 127 . 0 . 0 . 1","title":"centos\u5b89\u88c5"},{"location":"Nginx/#_1","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u5305\u62ec\u7684\u6a21\u5757\u4ee5\u53ca\u7b2c\u4e09\u65b9\u6a21\u5757\u5fc5\u987b\u5728configure\u811a\u672c\u4e2d\u4e0e\u5176\u4ed6\u6784\u5efa\u9009\u9879\u4e00\u8d77\u663e\u5f0f\u6307\u5b9a\u3002\u8fd9\u4e9b\u6a21\u5757\u53ef\u4ee5\u9759\u6001\u94fe\u63a5\u5230NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u6bcf\u6b21NGINX\u542f\u52a8\u65f6\u52a0\u8f7d\u5b83\u4eec\uff09\u6216\u52a8\u6001\u52a0\u8f7d\uff08\u53ea\u6709\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u76f8\u5173\u6307\u4ee4\u65f6\u624d\u52a0\u8f7d\u5b83\u4eec\u3002 \u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757 \u5982\u679c\u60a8\u4e0d\u9700\u8981\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u811a\u672c--without-<MODULE-NAME>\u4e0a\u7684\u9009\u9879\u547d\u540d\u5b83\u6765\u7981\u7528\u5b83configure\uff0c\u5982\u6b64\u793a\u4f8b\u4e2d\u7981\u7528Empty GIF\u6a21\u5757\uff08\u5e94\u8be5\u952e\u5165\u4e3a\u5355\u884c\uff09\uff1a \u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\u5982\u4e0b\uff1a | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | http_access_module | \u63a5\u53d7\u6216\u62d2\u7edd\u6765\u81ea\u6307\u5b9a\u5ba2\u6237\u7aef\u5730\u5740\u7684\u8bf7\u6c42\u3002 | | http_auth_basic_module | \u901a\u8fc7\u4f7f\u7528HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u9650\u5236\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 | | http_autoindex_module | \u5904\u7406\u4ee5\u6b63\u659c\u6760\u5b57\u7b26\uff08/\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u751f\u6210\u76ee\u5f55\u5217\u8868\u3002 | | http_browser_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8eUser-Agent\u8bf7\u6c42\u6807\u5934\u503c\u7684\u53d8\u91cf\u3002 | | http_charset_module | \u5c06\u6307\u5b9a\u7684\u5b57\u7b26\u96c6\u6dfb\u52a0\u5230Content-Type\u54cd\u5e94\u6807\u5934\u3002\u53ef\u4ee5\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u5b57\u7b26\u96c6\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u96c6 | | http_empty_gif_module | \u53d1\u51fa\u5355\u50cf\u7d20\u900f\u660eGIF\u3002 | | http_fastcgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u3002 | | http_geo_module | \u4f7f\u7528\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u503c\u521b\u5efa\u53d8\u91cf\u3002 | | http_gzip_module | \u4f7f\u7528gzip\u538b\u7f29\u54cd\u5e94\uff0c\u5c06\u4f20\u8f93\u6570\u636e\u91cf\u51cf\u5c11\u4e00\u534a\u6216\u66f4\u591a\u3002 | | http_limit_conn_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8fde\u63a5\u6570\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8fde\u63a5\u6570\u3002 | | http_limit_req_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8bf7\u6c42\u5904\u7406\u901f\u7387\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8bf7\u6c42\u7684\u5904\u7406\u901f\u7387\u3002 | | http_map_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5176\u4ed6\u53d8\u91cf\u503c\u7684\u53d8\u91cf\u3002 | | http_memcached_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9memcached\u670d\u52a1\u5668\u3002 | | http_proxy_module | \u5c06HTTP\u8bf7\u6c42\u4f20\u9012\u7ed9\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u3002 | | http_referer_module | \u5728Referer\u6807\u5934\u4e2d\u963b\u6b62\u5177\u6709\u65e0\u6548\u503c\u7684\u8bf7\u6c42\u3002 | | http_rewrite_module | \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u66f4\u6539\u8bf7\u6c42URI\u5e76\u8fd4\u56de\u91cd\u5b9a\u5411; \u6709\u6761\u4ef6\u5730\u9009\u62e9\u914d\u7f6e\u3002\u9700\u8981PCRE\u5e93\u3002 | | http_scgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9SCGI\u670d\u52a1\u5668\u3002 | | http_ssi_module | \u5728\u901a\u8fc7\u5b83\u7684\u54cd\u5e94\u4e2d\u5904\u7406SSI\uff08\u670d\u52a1\u5668\u7aef\u5305\u542b\uff09\u547d\u4ee4\u3002 | | http_split_clients_module | \u521b\u5efa\u9002\u5408A / B\u6d4b\u8bd5\u7684\u53d8\u91cf\uff0c\u4e5f\u79f0\u4e3a\u62c6\u5206\u6d4b\u8bd5\u3002 | | http_upstream_hash_module | \u542f\u7528\u901a\u7528\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_ip_hash_module | \u542f\u7528IP\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_keepalive_module | \u542f\u7528keepalive\u8fde\u63a5\u3002 | | http_upstream_least_conn_module | \u542f\u7528\u6700\u5c11\u8fde\u63a5\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_zone_module | \u542f\u7528\u5171\u4eab\u5185\u5b58\u533a\u57df\u3002 | | http_userid_module | \u8bbe\u7f6e\u9002\u5408\u5ba2\u6237\u8bc6\u522b\u7684cookie\u3002 | | http_uwsgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9uwsgi\u670d\u52a1\u5668\u3002 |","title":"\u5173\u4e8e\u6784\u5efa\u6a21\u5757"},{"location":"Nginx/#_2","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u6784\u5efa\u8bb8\u591aNGINX\u6a21\u5757\uff0c\u5fc5\u987b\u5728configure\u8981\u6784\u5efa\u7684\u547d\u4ee4\u884c\u4e2d\u5217\u51fa | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | --with-cpp_test_module | \u6d4b\u8bd5\u5934\u6587\u4ef6\u7684C ++\u517c\u5bb9\u6027\u3002 | | --with-debug | \u542f\u7528\u8c03\u8bd5\u65e5\u5fd7\u3002 | | --with-file-aio | \u542f\u7528\u5f02\u6b65I / O. | | --with-google_perftools_module | \u5141\u8bb8\u4f7f\u7528 Google Performance \u5de5\u5177\u5e93 | | -- \u4e0e-http_addition_module | \u5728\u54cd\u5e94\u4e4b\u524d\u548c\u4e4b\u540e\u6dfb\u52a0\u6587\u672c\u3002 | | -- \u4e0e-http_auth_request_module | \u6839\u636e\u5b50\u8bf7\u6c42\u7684\u7ed3\u679c\u5b9e\u73b0\u5ba2\u6237\u7aef\u6388\u6743\u3002 | | -- \u4e0e-http_dav_module | \u4f7f\u7528WebDAV\u534f\u8bae\u542f\u7528\u6587\u4ef6\u7ba1\u7406\u81ea\u52a8\u5316\u3002 | | --with-http_degradation_module | \u5141\u8bb8\u5728\u5185\u5b58\u5927\u5c0f\u8d85\u8fc7\u5b9a\u4e49\u7684\u503c\u65f6\u8fd4\u56de\u9519\u8bef\u3002 | | -- \u4e0e-http_flv_module | \u4e3aFlash Video\uff08FLV\uff09\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_geoip_module | \u5141\u8bb8\u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u53d8\u91cf\u3002\u8be5\u6a21\u5757\u4f7f\u7528MaxMind GeoIP\u6570\u636e\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a-with-http_geoip_module = dynamic\u3002 | | -- \u4e0e-http_gunzip_module | \u4f7f\u7528Content-Encoding\u89e3\u538b\u7f29\u54cd\u5e94\uff1agzip\u7528\u4e8e\u4e0d\u652f\u6301_zip_ encoding\u65b9\u6cd5\u7684\u5ba2\u6237\u7aef\u3002 | | -- \u4e0e-http_gzip_static_module | \u5141\u8bb8\u4f7f\u7528.gz\u6587\u4ef6\u6269\u5c55\u540d\u800c\u4e0d\u662f\u5e38\u89c4\u6587\u4ef6\u53d1\u9001\u9884\u538b\u7f29\u6587\u4ef6\u3002 | | -- \u4e0e-http_image_filter_module | \u4ee5JPEG\uff0cGIF\u548cPNG\u683c\u5f0f\u8f6c\u6362\u56fe\u50cf\u3002\u8be5\u6a21\u5757\u9700\u8981LibGD\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_image_filter_module=dynamic\u3002 | | -- \u4e0e-http_mp4_module | \u4e3aMP4\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_perl_module | \u7528\u4e8e\u5728Perl\u4e2d\u5b9e\u73b0\u4f4d\u7f6e\u548c\u53d8\u91cf\u5904\u7406\u7a0b\u5e8f\uff0c\u5e76\u5c06Perl\u8c03\u7528\u63d2\u5165SSI\u3002\u9700\u8981PERL\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_perl_module=dynamic\u3002 | | -- \u4e0e-http_random_index_module | \u5904\u7406\u4ee5\u659c\u6760\u5b57\u7b26\uff08'/'\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u4e2a\u968f\u673a\u6587\u4ef6\u4f5c\u4e3a\u7d22\u5f15\u6587\u4ef6\u3002 | | -- \u4e0e-http_realip_module | \u5c06\u5ba2\u6237\u7aef\u5730\u5740\u66f4\u6539\u4e3a\u5728\u6307\u5b9a\u7684\u6807\u5934\u5b57\u6bb5\u4e2d\u53d1\u9001\u7684\u5730\u5740\u3002 | | -- \u4e0e-http_secure_link_module | \u7528\u4e8e\u68c0\u67e5\u8bf7\u6c42\u7684\u94fe\u63a5\u7684\u771f\u5b9e\u6027\uff0c\u4fdd\u62a4\u8d44\u6e90\u514d\u53d7\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\uff0c\u5e76\u9650\u5236\u94fe\u63a5\u7684\u751f\u547d\u5468\u671f\u3002 | | -- \u4e0e-http_slice_module | \u5141\u8bb8\u5c06\u8bf7\u6c42\u62c6\u5206\u4e3a\u5b50\u8bf7\u6c42\uff0c\u6bcf\u4e2a\u5b50\u8bf7\u6c42\u8fd4\u56de\u4e00\u5b9a\u8303\u56f4\u7684\u54cd\u5e94\u3002\u63d0\u4f9b\u66f4\u6709\u6548\u7684\u5927\u6587\u4ef6\u7f13\u5b58\u3002 | | -- \u4e0e-http_ssl_module | \u542f\u7528HTTPS\u652f\u6301\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e-http_stub_status_module | \u63d0\u4f9b\u5bf9\u57fa\u672c\u72b6\u6001\u4fe1\u606f\u7684\u8bbf\u95ee\u3002\u8bf7\u6ce8\u610f\uff0cNGINX Plus\u5ba2\u6237\u4e0d\u9700\u8981\u6b64\u6a21\u5757\uff0c\u56e0\u4e3a\u5b83\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86\u6269\u5c55\u72b6\u6001\u6307\u6807\u548c\u4ea4\u4e92\u5f0f\u4eea\u8868\u677f\u3002 | | -- \u4e0e-http_sub_module | \u901a\u8fc7\u5c06\u4e00\u4e2a\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u6765\u4fee\u6539\u54cd\u5e94\u3002 | | -- \u4e0e-http_xslt_module | \u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aXSLT\u6837\u5f0f\u8868\u8f6c\u6362XML\u54cd\u5e94\u3002\u8be5\u6a21\u5757\u9700\u8981Libxml2\u548cXSLT\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_xslt_module=dynamic\u3002 | | -- \u4e0e-http_v2_module | \u542f\u7528\u5bf9HTTP / 2\u7684\u652f\u6301\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX\u535a\u5ba2\u4e0aNGINX\u4e2d\u7684HTTP / 2\u6a21\u5757\u3002 | | -- \u7528\u90ae\u4ef6 | \u542f\u7528\u90ae\u4ef6\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-mail=dynamic\u3002 | | -- \u4e0e-mail_ssl_module | \u4e3a\u90ae\u4ef6\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e\u6d41 | \u542f\u7528TCP\u548cUDP\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-stream=dynamic\u3002 | | -- \u4e0e-stream_ssl_module | \u4e3a\u6d41\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | --with-threads | \u4f7fNGINX\u80fd\u591f\u4f7f\u7528\u7ebf\u7a0b\u6c60\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX Boost Performance 9x\u4e2d\u7684\u7ebf\u7a0b\u6c60\uff01\u5728NGINX\u535a\u5ba2\u4e0a\u3002 |","title":"\u5305\u62ec\u975e\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757"},{"location":"Nginx/#_3","text":"\u9759\u6001\u94fe\u63a5\u6a21\u5757 NGINX\u5f00\u6e90\u4e2d\u5185\u7f6e\u7684\u5927\u591a\u6570\u6a21\u5757\u90fd\u662f\u9759\u6001\u94fe\u63a5\u7684 \uff1a\u5b83\u4eec\u5728\u7f16\u8bd1\u65f6\u5185\u7f6e\u4e8e NGINX\u5f00\u6e90\u4e2d \uff0c\u5e76\u9759\u6001\u94fe\u63a5\u5230 NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6 \u3002 \u53ea\u80fd\u901a\u8fc7\u91cd\u65b0\u7f16\u8bd1 NGINX\u6765\u7981\u7528\u8fd9\u4e9b\u6a21\u5757 \u3002 [ NGINX Wiki ]( https : //nginx.com/resources/wiki/modules/)\u4e2d \u5217\u51fa\u4e86\u4e00\u4e9b\u7b2c\u4e09\u65b9\u6a21\u5757 \u8981\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1 NGINX Open Source \uff0c\u8bf7 -- add - module =< PATH > \u5728 configure\u547d\u4ee4\u4e2d\u5305\u542b\u9009\u9879 \uff0c \u5176\u4e2d < PATH > \u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff08\u6b64\u793a\u4f8b\u9002\u7528\u4e8e RTMP \u6a21\u5757\uff09\uff1a . / configure ... -- add - module = / usr / build / nginx - rtmp - module \u52a8\u6001\u94fe\u63a5\u6a21\u5757 NGINX\u6a21\u5757\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u4e3a\u5171\u4eab\u5bf9\u8c61 \uff08 * . so\u6587\u4ef6 \uff09\uff0c\u7136\u540e\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u5230 NGINX Open Source\u4e2d \u3002\u8fd9\u63d0\u4f9b\u4e86\u66f4\u5927\u7684 \u7075\u6d3b\u6027\uff0c\u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7 load_module\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6216\u5220\u9664\u5173\u8054\u6307\u4ee4\u5e76\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6765\u968f\u65f6\u52a0\u8f7d\u6216\u5378\u8f7d\u6a21\u5757 \u3002 \u8bf7\u6ce8\u610f\uff0c\u6a21\u5757\u672c\u8eab\u5fc5\u987b\u652f\u6301\u52a8\u6001\u94fe\u63a5\u3002 \u8981\u4f7f\u7528\u52a8\u6001\u52a0\u8f7d\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1 NGINX Open Source \uff0c\u8bf7 -- add - dynamic - module =< PATH > \u5728 configure\u547d\u4ee4\u4e2d \u5305\u542b\u9009\u9879\uff0c\u5176\u4e2d < PATH > \u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff1a . / configure ... -- add - dynamic - module = < PATH > \u751f\u6210\u7684 * . so\u6587\u4ef6\u5c06\u5199\u5165\u524d\u7f00 / modules / \u76ee\u5f55\uff0c\u5176\u4e2d\u524d\u7f00\u662f\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f8b\u5982 / usr / local / nginx / \u3002 \u8981\u52a0\u8f7d\u52a8\u6001\u6a21\u5757\uff0c\u8bf7 load_module\u5728\u5b89\u88c5\u540e\u5c06\u6307\u4ee4\u6dfb\u52a0\u5230NGINX\u914d\u7f6e \uff1a load_module modules / ngx_mail_module . so ;","title":"\u5176\u4ed6\u6a21\u5757"},{"location":"Nginx/#nginx","text":"# / etc / sysctl . conf # Avoid a smurf attack net . ipv4 . icmp_echo_ignore_broadcasts = 1 # Turn on protection for bad icmp error messages net . ipv4 . icmp_ignore_bogus_error_responses = 1 # Turn on syncookies for SYN flood attack protection net . ipv4 . tcp_syncookies = 1 # Turn on and log spoofed , source routed , and redirect packets net . ipv4 . conf . all . log_martians = 1 net . ipv4 . conf . default . log_martians = 1 # No source routed packets here net . ipv4 . conf . all . accept_source_route = 0 net . ipv4 . conf . default . accept_source_route = 0 # Turn on reverse path filtering net . ipv4 . conf . all . rp_filter = 1 net . ipv4 . conf . default . rp_filter = 1 # Make sure no one can alter the routing tables net . ipv4 . conf . all . accept_redirects = 0 net . ipv4 . conf . default . accept_redirects = 0 net . ipv4 . conf . all . secure_redirects = 0 net . ipv4 . conf . default . secure_redirects = 0 # Don ' t act as a router net . ipv4 . ip_forward = 0 net . ipv4 . conf . all . send_redirects = 0 net . ipv4 . conf . default . send_redirects = 0 # Turn on execshild kernel . exec - shield = 1 kernel . randomize_va_space = 1 # Tuen IPv6 net . ipv6 . conf . default . router_solicitations = 0 net . ipv6 . conf . default . accept_ra_rtr_pref = 0 net . ipv6 . conf . default . accept_ra_pinfo = 0 net . ipv6 . conf . default . accept_ra_defrtr = 0 net . ipv6 . conf . default . autoconf = 0 net . ipv6 . conf . default . dad_transmits = 0 net . ipv6 . conf . default . max_addresses = 1 # Optimization for port usefor LBs # Increase system file descriptor limit fs . file - max = 65535 # Allow for more PIDs ( to reduce rollover problems ) ; may break some programs 32768 kernel . pid_max = 65536 # Increase system IP port limits net . ipv4 . ip_local_port_range = 2000 65000 # Increase TCP max buffer size setable using setsockopt () net . ipv4 . tcp_rmem = 4096 87380 8388608 net . ipv4 . tcp_wmem = 4096 87380 8388608 # Increase Linux auto tuning TCP buffer limits # min , default , and max number of bytes to use # set max to at least 4 MB , or higher if you use very high BDP paths # Tcp Windows etc net . core . rmem_max = 8388608 net . core . wmem_max = 8388608 net . core . netdev_max_backlog = 5000 net . ipv4 . tcp_window_scaling = 1","title":"nginx\u5185\u6838\u76f8\u5173\u53c2\u6570"},{"location":"Nginx/#_4","text":"\u8981\u542f\u52a8nginx\uff0c\u8bf7\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u3002\u542f\u52a8nginx\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528-s\u53c2\u6570\u8c03\u7528\u53ef\u6267\u884c\u6587\u4ef6\u6765\u63a7\u5236\u5b83\u3002\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a nginx -s signal signal\u53ef\u4ee5\u662f\u4e0b\u5217\u4e4b\u4e00\uff1a stop - \u5feb\u901f\u5173\u673a quit - \u4f18\u96c5\u7684\u5173\u673a reload - \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6 reopen - \u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6 \u4f8b\u5982\uff0c\u8981\u5728\u7b49\u5f85\u5de5\u4f5c\u8fdb\u7a0b\u5b8c\u6210\u5f53\u524d\u8bf7\u6c42\u7684\u670d\u52a1\u65f6\u505c\u6b62nginx\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a nginx -s quit \u6b64\u547d\u4ee4\u5e94\u5728\u542f\u52a8nginx\u7684\u540c\u4e00\u7528\u6237\u4e0b\u6267\u884c\u3002 nginx\u7531\u6a21\u5757\u7ec4\u6210\uff0c\u6a21\u5757\u7531\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u7684\u6307\u4ee4\u63a7\u5236\uff0c\u6307\u4ee4\u5206\u4e3a\u7b80\u5355\u6307\u4ee4\u548c\u5757\u6307\u4ee4\uff0c\u7b80\u5355\u6307\u4ee4\u5305\u62ec\u7531\u7a7a\u683c\u5206\u9694\u7684\u540d\u79f0\u548c\u53c2\u6570\uff0c\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u5757\u6307\u4ee4\u548c\u7b80\u5355\u6307\u4ee4\u76f8\u540c\u7ed3\u6784\uff0c\u4f46\u4e0d\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u800c\u662f\u4ee5\u5927\u62ec\u53f7 {} \u5305\u56f4\u7684\u4e00\u7ec4\u9644\u52a0\u6307\u4ee4\u7ed3\u675f\uff0c\u82e5\u5757\u6307\u4ee4\u53ef\u4ee5\u5728\u5927\u62ec\u53f7\u5305\u542b\u5176\u4ed6\u6307\u4ee4\uff0c\u5219\u79f0\u4e3a\u4e0a\u4e0b\u6587\u3002\u5982\uff1aevents,http,server\u548clocation \u653e\u7f6e\u5728\u4efb\u4f55\u4e0a\u4e0b\u6587\u4e4b\u5916\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u90fd\u88ab\u8ba4\u4e3a\u662f\u5728\u4e3b\u4e0a\u4e0b\u6587\u4e2d\u3002\u5728events\u548chttp\u6307\u4ee4\u9a7b\u7559\u5728main\u4e0a\u4e0b\u6587server\u4e2d\uff0chttp\u548clocation\u5728server\u4e2d","title":"\u521d\u5b66\u8005\u6307\u5357"},{"location":"Nginx/#_5","text":"\u4ece/data/www\u76ee\u5f55\u63d0\u4f9b\u6587\u4ef6\uff0c\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\u5e76\u4f7f\u7528\u4e24\u4e2alocation\u5757\u5728http\u5757\u5185\u8bbe\u7f6eserver\u5757 \u5c06html\u7b49\u9759\u6001\u6587\u4ef6\u653e\u5165/data/www\uff0c\u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5df2\u5305\u542b\u51e0\u4e2aserver\u5757\u5b9e\u4f8b http { server { } } \u901a\u5e38\u914d\u7f6e\u6587\u4ef6\u5305\u62ec\u5b83\u76d1\u542c\u7684\u7aef\u53e3\u548c\u670d\u52a1\u5668\u540d\u79f0\u533a\u5206\u7684\u82e5\u5e72\u4e2aserver\u5757\uff0c\u4e00\u65e6nginx\u51b3\u5b9a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u5b83\u6839\u636e\u5757\u7684\u5b9a\u4e49\u7684\u6307\u4ee4\u53c2\u6570\u6d4b\u8bd5\u8bf7\u6c42\u5934\u4e2d\u6307\u5b9a\u7684URI \u5c06\u4ee5\u4e0blocation\u5757\u6dfb\u52a0\u5230server\u5757\u4e2d location / { root /data/ww ; } \u6b64location\u5757\u6307\u5b9a/\u4e0e\u8bf7\u6c42\u4e2d\u7684URI\u8fdb\u884c\u6bd4\u8f83\u7684\u201c/\u201d\u524d\u7f00\u3002\u5bf9\u4e8e\u5339\u914d\u8bf7\u6c42\uff0cURI\u5c06\u6dfb\u52a0\u5230root \u6307\u4ee4\u4e2d\u6307\u5b9a\u7684\u8def\u5f84 \uff0c\u5373to /data/www\uff0c\u4ee5\u5f62\u6210\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6240\u8bf7\u6c42\u6587\u4ef6\u7684\u8def\u5f84\u3002\u5982\u679c\u5b58\u5728\u591a\u4e2a\u5339\u914dlocation\u5757\uff0c\u5219nginx\u9009\u62e9\u5177\u6709\u6700\u957f\u524d\u7f00\u7684\u5757\u3002location\u4e0a\u9762\u7684\u5757\u63d0\u4f9b\u957f\u5ea6\u4e3a1\u7684\u6700\u77ed\u524d\u7f00\uff0c\u56e0\u6b64\u53ea\u6709\u5f53\u6240\u6709\u5176\u4ed6location \u5757\u90fd\u65e0\u6cd5\u63d0\u4f9b\u5339\u914d\u65f6\uff0c\u624d\u4f1a\u4f7f\u7528\u6b64\u5757\u3002 \u63a5\u7740\u6dfb\u52a0\u7b2c\u4e8c\u4e2alocation\u5757\uff1a location /images/ { root /data ; } \u5b83\u5c06\u5339\u914d\u4ee5/images/\u5f00\u5934\u7684\u8bf7\u6c42 ( location / \u4e5f\u5339\u914d\u6b64\u7c7b\u8bf7\u6c42\uff0c\u4f46\u524d\u7f00\u66f4\u77ed ) server\u5757 \u7684\u7ed3\u679c\u914d\u7f6e\u5e94\u5982\u4e0b\u6240\u793a\uff1a server { location / { root /data/www ; } location /images/ { root /data ; } }","title":"\u9759\u6001\u5185\u5bb9"},{"location":"Nginx/#_6","text":"nginx\u53ef\u4ee5\u7528\u4f5c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5373\u670d\u52a1\u5668\u63a5\u53d7\u8bf7\u6c42\uff0c\u5c06\u8fd9\u4e9b\u8bf7\u6c42\u4f20\u9012\u7ed9\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ece\u4e2d\u68c0\u7d22\u54cd\u5e94\uff0c\u7136\u540e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef \u6211\u4eec\u5c06\u914d\u7f6e\u4e00\u4e2a\u57fa\u672c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5b83\u4f7f\u7528\u6765\u81ea\u672c\u5730\u76ee\u5f55\u7684\u6587\u4ef6\u5904\u7406\u56fe\u50cf\u8bf7\u6c42\uff0c\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u53d1\u9001\u5230\u4ee3\u7406\u670d\u52a1\u5668\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u5c06\u5728\u5355\u4e2anginx\u5b9e\u4f8b\u4e0a\u5b9a\u4e49\u4e24\u4e2a\u670d\u52a1\u5668\u3002 \u5411server nginx\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u4ee5\u4e0a\u5185\u5bb9\u6765\u5b9a\u4e49\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a server { listen 8080 ; root /data/up1 ; location / { } } \u8fd9\u5c06\u662f\u4e00\u4e2a\u4fa6\u542c\u7aef\u53e38080\u7684\u7b80\u5355\u670d\u52a1\u5668\uff08\u4e4b\u524d\uff0clisten\u81ea\u4f7f\u7528\u6807\u51c6\u7aef\u53e380\u4ee5\u6765\u672a\u6307\u5b9a\u8be5\u6307\u4ee4\uff09\u5e76\u5c06\u6240\u6709\u8bf7\u6c42\u6620\u5c04\u5230/data/up1\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u76ee\u5f55\u3002\u521b\u5efa\u6b64\u76ee\u5f55\u5e76\u5c06index.html\u6587\u4ef6\u653e\u5165\u5176\u4e2d\u3002\u8bf7\u6ce8\u610f\uff0c\u8be5root\u6307\u4ee4\u653e\u5728 server\u4e0a\u4e0b\u6587\u4e2d\uff0c\u5f53location\u9009\u62e9\u7528\u4e8e\u63d0\u4f9b\u8bf7\u6c42\u7684\u5757\u4e0d\u5305\u62ec\u81ea\u5df1\u7684root\u6307\u4ee4\u65f6\uff0c\u4f7f\u7528\u8fd9\u6837\u7684\u6307\u4ee4 \u63a5\u4e0b\u6765\uff0c\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5e76\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u4ee5\u4f7f\u5176\u6210\u4e3a\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u3002\u5728\u7b2c\u4e00\u4e2alocation\u5757\u4e2d\uff0c\u5c06 proxy_pass \u6307\u4ee4\u4e0e\u53c2\u6570\u4e2d\u6307\u5b9a\u7684\u4ee3\u7406\u670d\u52a1\u5668\u7684\u534f\u8bae\uff0c\u540d\u79f0\u548c\u7aef\u53e3\u653e\u5728\u4e00\u8d77\uff08\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u5b83\u662fhttp://localhost:8080\uff09\uff1a server { location / { proxy_pass http\uff1a//localhost\uff1a8080 ; } location / images / { root / data ; } } \u6211\u4eec\u5c06\u4fee\u6539\u7b2c\u4e8c\u4e2alocation \u5757\uff0c\u8be5\u5757\u5f53\u524d\u5c06\u5e26\u6709/images/\u524d\u7f00\u7684\u8bf7\u6c42\u6620\u5c04\u5230\u76ee\u5f55\u4e0b\u7684/data/images\u6587\u4ef6\uff0c\u4ee5\u4f7f\u5176\u4e0e\u5177\u6709\u5178\u578b\u6587\u4ef6\u6269\u5c55\u540d\u7684\u56fe\u50cf\u8bf7\u6c42\u76f8\u5339\u914d\u3002\u4fee\u6539\u540e\u7684location\u5757\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } \u8be5\u53c2\u6570\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7ed3\u5c3e\u7684\u6240\u6709URI .gif\uff0c.jpg\u6216.png\u3002\u5e94\u8be5\u4ee5\u6b63\u5219\u8868\u8fbe\u5f0f\u5f00\u5934~\u3002\u76f8\u5e94\u7684\u8bf7\u6c42\u5c06\u6620\u5c04\u5230\u8be5/data/images \u76ee\u5f55\u3002 \u5f53nginx\u9009\u62e9\u4e00\u4e2alocation\u5757\u6765\u63d0\u4f9b\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u68c0\u67e5 \u6307\u5b9a\u524d\u7f00\u7684\u4f4d\u7f6e\u6307\u4ee4\uff0c\u8bb0\u4f4flocation \u6700\u957f\u7684\u524d\u7f00\uff0c\u7136\u540e\u68c0\u67e5\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219nginx\u9009\u62e9\u6b64\u9879 location\uff0c\u5426\u5219\uff0c\u5b83\u4f1a\u9009\u62e9\u4e4b\u524d\u8bb0\u4f4f\u7684\u90a3\u4e2a\u3002 \u751f\u6210\u7684\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff1a server { location / { proxy_pass http://localhost:8080/ ; } location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } } \u6b64\u670d\u52a1\u5668\u5c06\u8fc7\u6ee4\u4ee5.gif.jpg\u6216\u8005.png \u5c06\u5176\u6620\u5c04\u5230/data/images\u76ee\u5f55\u7684\u8bf7\u6c42\uff08\u901a\u8fc7\u5411root\u6307\u4ee4\u7684\u53c2\u6570\u6dfb\u52a0URI \uff09\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0a\u9762\u914d\u7f6e\u7684\u4ee3\u7406\u670d\u52a1\u5668","title":"\u8bbe\u7f6e\u7b80\u5355\u7684\u4ee3\u7406\u670d\u52a1\u5668"},{"location":"Nginx/#fastcgi","text":"nginx\u53ef\u7528\u4e8e\u5c06\u8bf7\u6c42\u8def\u7531\u5230FastCGI\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u8fd0\u884c\u4f7f\u7528\u5404\u79cd\u6846\u67b6\u548c\u7f16\u7a0b\u8bed\u8a00\uff08\u5982PHP\uff09\u6784\u5efa\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u4f7f\u7528FastCGI\u670d\u52a1\u5668\u7684\u6700\u57fa\u672c\u7684nginx\u914d\u7f6e\u5305\u62ec\u4f7f\u7528 fastcgi_pass \u6307\u4ee4\u800c\u4e0d\u662fproxy_pass\u6307\u4ee4\uff0c\u4ee5\u53cafastcgi_param \u6307\u4ee4\u6765\u8bbe\u7f6e\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u7684\u53c2\u6570\u3002\u5047\u8bbe\u53ef\u4ee5\u8bbf\u95eeFastCGI\u670d\u52a1\u5668localhost:9000\u3002\u4ee5\u4e0a\u4e00\u8282\u4e2d\u7684\u4ee3\u7406\u914d\u7f6e\u4e3a\u57fa\u7840\uff0c\u5c06proxy_pass\u6307\u4ee4\u66ff\u6362\u4e3a\u6307\u4ee4 fastcgi_pass\u5e76\u5c06\u53c2\u6570\u66f4\u6539\u4e3a localhost:9000\u3002\u5728PHP\u4e2d\uff0c\u8be5SCRIPT_FILENAME\u53c2\u6570\u7528\u4e8e\u786e\u5b9a\u811a\u672c\u540d\u79f0\uff0c\u8be5QUERY_STRING \u53c2\u6570\u7528\u4e8e\u4f20\u9012\u8bf7\u6c42\u53c2\u6570\u3002\u7ed3\u679c\u914d\u7f6e\u4e3a\uff1a server { location / { fastcgi_pass localhost:9000 ; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name ; fastcgi_param QUERY_STRING $query_string ; } location ~ \\. ( gif | jpg | png ) $ { root /data/images ; } } \u8fd9\u5c06\u8bbe\u7f6e\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u5c06\u9664\u9759\u6001\u56fe\u50cf\u8bf7\u6c42\u4e4b\u5916\u7684\u6240\u6709\u8bf7\u6c42\u8def\u7531\u5230localhost:9000\u901a\u8fc7FastCGI\u534f\u8bae\u64cd\u4f5c\u7684\u4ee3\u7406\u670d\u52a1\u5668","title":"\u8bbe\u7f6eFastCGI\u4ee3\u7406"},{"location":"Nginx/#nginxconf","text":"nginx\u53ca\u5176\u6a21\u5757\u7684\u5de5\u4f5c\u65b9\u5f0f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u786e\u5b9a\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u914d\u7f6e\u6587\u4ef6\u88ab\u547d\u540dnginx.conf \u5e76\u653e\u5728\u76ee\u5f55 /usr/local/nginx/conf\u4e2d /etc/nginx\uff0c\u6216 /usr/local/etc/nginx \u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u914d\u7f6e\u6587\u4ef6 \u4e3a\u4e86\u4f7f\u914d\u7f6e\u66f4\u6613\u4e8e\u7ef4\u62a4\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u5c06\u5176\u62c6\u5206\u4e3a\u4e00\u7ec4\u5b58\u50a8\u5728/etc/nginx/conf.d\u76ee\u5f55\u4e2d\u7684\u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528include\u4e3bnginx.conf\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u6765\u5f15\u7528\u5176\u4e2d\u7684\u5185\u5bb9 include conf.d/http ; include conf.d/stream ; include conf.d/exchange-enhanced ; \u4e00\u4e9b\u9876\u7ea7\u6307\u4ee4\uff08\u79f0\u4e3aContexts\uff09\u5c06\u9002\u7528\u4e8e\u4e0d\u540c\u6d41\u91cf\u7c7b\u578b\u7684\u6307\u4ee4\u7ec4\u5408\u5728\u4e00\u8d77 events - \u4e00\u822c\u8fde\u63a5\u5904\u7406 http - HTTP\u6d41\u91cf mail - \u90ae\u4ef6\u6d41\u91cf stream - TCP\u548cUDP\u6d41\u91cf \u5728\u6bcf\u4e2a\u6d41\u91cf\u5904\u7406\u4e0a\u4e0b\u6587\u4e2d\uff0c\u60a8\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aserver\u5757\u6765\u5b9a\u4e49\u63a7\u5236\u8bf7\u6c42\u5904\u7406\u7684\u865a\u62df\u670d\u52a1\u5668\u3002\u60a8\u53ef\u4ee5\u5728server\u4e0a\u4e0b\u6587\u4e2d\u5305\u542b\u7684\u6307\u4ee4\u56e0\u6d41\u91cf\u7c7b\u578b\u800c\u5f02\u3002 \u5bf9\u4e8eHTTP\u6d41\u91cf\uff08http\u4e0a\u4e0b\u6587\uff09\uff0c\u6bcf\u4e2aserver\u6307\u4ee4\u63a7\u5236\u5bf9\u7279\u5b9a\u57df\u6216IP\u5730\u5740\u7684\u8d44\u6e90\u8bf7\u6c42\u7684\u5904\u7406\u3002location\u4e0a\u4e0b\u6587\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2aserver\u4e0a\u4e0b\u6587\u5b9a\u4e49\u4e86\u5982\u4f55\u5904\u7406\u7279\u5b9a\u7684URI\u96c6\u3002 \u5bf9\u4e8e\u90ae\u4ef6\u548cTCP / UDP\u6d41\u91cf\uff08mail\u548cstream\u4e0a\u4e0b\u6587\uff09\uff0cserver\u6307\u4ee4\u5404\u81ea\u63a7\u5236\u5230\u8fbe\u7279\u5b9aTCP\u7aef\u53e3\u6216UNIX\u5957\u63a5\u5b57\u7684\u6d41\u91cf\u7684\u5904\u7406\u3002 \u4f8b\u5982\uff1a user nobody ; # a directive in the 'main' context events { # configuration of connection processing } http { # Configuration specific to HTTP and affecting all virtual servers server { # configuration of HTTP virtual server 1 location /one { # configuration for processing URIs starting with '/one' } location /two { # configuration for processing URIs starting with '/two' } } server { # configuration of HTTP virtual server 2 } } stream { # Configuration specific to TCP/UDP and affecting all virtual servers server { # configuration of TCP virtual server 1 } } #\u5b9a\u4e49 Nginx \u8fd0\u884c\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4 user www www ; # nginx \u8fdb\u7a0b\u6570\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a\u7b49\u4e8e CPU \u603b\u6838\u5fc3\u6570\u3002 worker_processes auto ; #\u5168\u5c40\u9519\u8bef\u65e5\u5fd7\u5b9a\u4e49\u7c7b\u578b\uff0c[ debug | info | notice | warn | error | crit ] error_log / var / log / nginx / error . log crit ; #\u8fdb\u7a0b\u6587\u4ef6 pid / var / run / nginx . pid ; #\u4e00\u4e2a nginx \u8fdb\u7a0b\u6253\u5f00\u7684\u6700\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee\uff0c\u7406\u8bba\u503c\u5e94\u8be5\u662f\u6700\u591a\u6253\u5f00\u6587\u4ef6\u6570\uff08\u7cfb\u7edf\u7684\u503c ulimit - n \uff09\u4e0e nginx \u8fdb\u7a0b\u6570\u76f8\u9664\uff0c\u4f46\u662f nginx \u5206\u914d\u8bf7\u6c42\u5e76\u4e0d\u5747\u5300\uff0c\u6240\u4ee5\u5efa\u8bae\u4e0e ulimit - n \u7684\u503c\u4fdd\u6301\u4e00\u81f4\u3002 worker_rlimit_nofile 65535 ; #\u5de5\u4f5c\u6a21\u5f0f\u4e0e\u8fde\u63a5\u6570\u4e0a\u9650 events { #\u53c2\u8003\u4e8b\u4ef6\u6a21\u578b\uff0c use [ kqueue | rtsig | epoll | / dev / poll | select | poll ] ; epoll\u6a21\u578b\u662fLinux 2.6\u4ee5\u4e0a\u7248\u672c\u5185\u6838\u4e2d\u7684\u591a\u8def\u590d\u7528\u9ad8\u6027\u80fd\u7f51\u7edcI/O\u6a21\u578b\uff0c\u5982\u679c\u8dd1\u5728FreeBSD\u4e0a\u9762\uff0c\u5c31\u7528kqueue\u6a21\u578b\u3002 use epoll ; #\u5355\u4e2a\u8fdb\u7a0b\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\uff08\u6700\u5927\u8fde\u63a5\u6570 = \u8fde\u63a5\u6570 * \u8fdb\u7a0b\u6570\uff09 worker_connections 65535 ; # \u5e76\u53d1\u603b\u6570\u662f worker_processes \u548c worker_connections \u7684\u4e58\u79ef,\u5373 max_clients = worker_processes * worker_connections # \u5728\u8bbe\u7f6e\u4e86\u53cd\u5411\u4ee3\u7406\u7684\u60c5\u51b5\u4e0b\uff0c max_clients = worker_processes * worker_connections / 4 # \u4e3a\u4ec0\u4e48\u4e0a\u9762\u53cd\u5411\u4ee3\u7406\u8981\u9664\u4ee5 4 \uff0c\u5e94\u8be5\u8bf4\u662f\u4e00\u4e2a\u7ecf\u9a8c\u503c # \u6839\u636e\u4ee5\u4e0a\u6761\u4ef6\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684 Nginx Server \u53ef\u4ee5\u5e94\u4ed8\u7684\u6700\u5927\u8fde\u63a5\u6570\u4e3a\uff1a 4 * 8000 = 32000 # worker_connections \u503c\u7684\u8bbe\u7f6e\u8ddf\u7269\u7406\u5185\u5b58\u5927\u5c0f\u6709\u5173 # \u56e0\u4e3a\u5e76\u53d1\u53d7 IO \u7ea6\u675f\uff0c max_clients \u7684\u503c\u987b\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570 # \u800c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u548c\u5185\u5b58\u5927\u5c0f\u6210\u6b63\u6bd4\uff0c\u4e00\u822c 1 GB \u5185\u5b58\u7684\u673a\u5668\u4e0a\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u6570\u5927\u7ea6\u662f 10 \u4e07\u5de6\u53f3 # \u6211\u4eec\u6765\u770b\u770b 360 M \u5185\u5b58\u7684 VPS \u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u6570\u662f\u591a\u5c11\uff1a # $ cat / proc / sys / fs / file - max # \u8f93\u51fa 34336 # 32000 < 34336 \uff0c\u5373\u5e76\u53d1\u8fde\u63a5\u603b\u6570\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u603b\u6570\uff0c\u6837\u5c31\u5728\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u627f\u53d7\u7684\u8303\u56f4\u4e4b\u5185 # \u6240\u4ee5\uff0c worker_connections \u7684\u503c\u9700\u6839\u636e worker_processes \u8fdb\u7a0b\u6570\u548c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u603b\u6570\u8fdb\u884c\u9002\u5f53\u5730\u8fdb\u884c\u8bbe\u7f6e # \u4f7f\u5f97\u5e76\u53d1\u603b\u6570\u5c0f\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u76ee # \u5176\u5b9e\u8d28\u4e5f\u5c31\u662f\u6839\u636e\u4e3b\u673a\u7684\u7269\u7406 CPU \u548c\u5185\u5b58\u8fdb\u884c\u914d\u7f6e # \u5f53\u7136\uff0c\u7406\u8bba\u4e0a\u7684\u5e76\u53d1\u603b\u6570\u53ef\u80fd\u4f1a\u548c\u5b9e\u9645\u6709\u6240\u504f\u5dee\uff0c\u56e0\u4e3a\u4e3b\u673a\u8fd8\u6709\u5176\u4ed6\u7684\u4f5c\u8fdb\u7a0b\u9700\u8981\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\u3002 # ulimit - SHn 65535 multi_accept on ; } #\u8bbe\u5b9a http \u670d\u52a1\u5668 http { include mime . types ; #\u6587\u4ef6\u6269\u5c55\u540d\u4e0e\u6587\u4ef6\u7c7b\u578b\u6620\u5c04\u8868 default_type application / octet - stream ; #\u9ed8\u8ba4\u6587\u4ef6\u7c7b\u578b # charset utf - 8 ; #\u9ed8\u8ba4\u7f16\u7801 server_names_hash_bucket_size 128 ; #\u670d\u52a1\u5668\u540d\u5b57\u7684hash\u8868\u5927\u5c0f client_header_buffer_size 32 k ; #\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u9650\u5236 large_client_header_buffers 4 64 k ; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58 client_max_body_size 8 m ; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58 sendfile on ; #\u5f00\u542f\u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\u6a21\u5f0f\uff0csendfile\u6307\u4ee4\u6307\u5b9anginx\u662f\u5426\u8c03\u7528sendfile\u51fd\u6570\uff08zero copy \u65b9\u5f0f\uff09\u6765\u8f93\u51fa\u6587\u4ef6\uff0c\u5bf9\u4e8e\u666e\u901a\u5e94\u7528\u8bbe\u4e3a on\uff0c\u5982\u679c\u7528\u6765\u8fdb\u884c\u4e0b\u8f7d\u7b49\u5e94\u7528\u78c1\u76d8IO\u91cd\u8d1f\u8f7d\u5e94\u7528\uff0c\u53ef\u8bbe\u7f6e\u4e3aoff\uff0c\u4ee5\u5e73\u8861\u78c1\u76d8\u4e0e\u7f51\u7edcI/O\u5904\u7406\u901f\u5ea6\uff0c\u964d\u4f4e\u7cfb\u7edf\u7684\u8d1f\u8f7d\u3002\u6ce8\u610f\uff1a\u5982\u679c\u56fe\u7247\u663e\u793a\u4e0d\u6b63\u5e38\u628a\u8fd9\u4e2a\u6539\u6210off\u3002 autoindex on ; #\u5f00\u542f\u76ee\u5f55\u5217\u8868\u8bbf\u95ee\uff0c\u5408\u9002\u4e0b\u8f7d\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u5173\u95ed\u3002 tcp_nopush on ; #\u9632\u6b62\u7f51\u7edc\u963b\u585e tcp_nodelay on ; #\u9632\u6b62\u7f51\u7edc\u963b\u585e keepalive_timeout 120 ; #\u957f\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2 # FastCGI \u76f8\u5173\u53c2\u6570\u662f\u4e3a\u4e86\u6539\u5584\u7f51\u7ad9\u7684\u6027\u80fd\uff1a\u51cf\u5c11\u8d44\u6e90\u5360\u7528\uff0c\u63d0\u9ad8\u8bbf\u95ee\u901f\u5ea6\u3002\u4e0b\u9762\u53c2\u6570\u770b\u5b57\u9762\u610f\u601d\u90fd\u80fd\u7406\u89e3\u3002 fastcgi_connect_timeout 60 ; # \u9ed8\u8ba460s\uff0c\u5efa\u7acb\u8fde\u63a5\u8d8a\u591a\u6d88\u8017\u8d44\u6e90\u8d8a\u591a fastcgi_send_timeout 60 ; fastcgi_read_timeout 60 ; fastcgi_buffer_size 64 k ; fastcgi_buffers 4 64 k ; fastcgi_busy_buffers_size 128 k ; fastcgi_temp_file_write_size 256 k ; fastcgi_intercept_errors on ; fastcgi_cache_valid 200 302 1 h ; # \u6307\u5b9a\u5e94\u7b54\u4ee3\u7801\u7f13\u5b58\u65f6\u95f4 fastcgi_cache_min_uses 1 ; # \u8bf7\u6c42\u51e0\u6b21\u54cd\u5e94\u540e\u5c06\u88ab\u7f13\u5b58\uff0c1\u8868\u793a\u4e00\u6b21\u5c31\u7f13\u5b58 fastcgi_cache_use_stale error timeout invalid_header http_500 ; # \u5b9a\u4e49\u90a3\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u8fc7\u671f\u7f13\u5b58 fastcgi_cache_key $ request_method : // $ host $ request_uri ; # \u6b64\u793a\u4f8b\u4ee5\u8bf7\u6c42\u7684uri\u4f5c\u4e3a\u7f13\u5b58\u7684key\u503c # gzip \u6a21\u5757\u8bbe\u7f6e gzip on ; #\u5f00\u542fgzip\u538b\u7f29\u8f93\u51fa gzip_min_length 1 k ; #\u6700\u5c0f\u538b\u7f29\u6587\u4ef6\u5927\u5c0f gzip_buffers 4 16 k ; #\u538b\u7f29\u7f13\u51b2\u533a gzip_http_version 1 . 1 ; #\u538b\u7f29\u7248\u672c\uff08\u9ed8\u8ba41.1\uff0c\u524d\u7aef\u5982\u679c\u662fsquid2.5\u8bf7\u4f7f\u75281.0\uff09 gzip_comp_level 2 ; #\u538b\u7f29\u7b49\u7ea7 gzip_types text / plain application / x - javascript text / javascript text / css application / xml ; #\u538b\u7f29\u7c7b\u578b\uff0c\u9ed8\u8ba4\u5c31\u5df2\u7ecf\u5305\u542b text / html \uff0c\u6240\u4ee5\u4e0b\u9762\u5c31\u4e0d\u7528\u518d\u5199\u4e86\uff0c\u5199\u4e0a\u53bb\u4e5f\u4e0d\u4f1a\u6709\u95ee\u9898\uff0c\u4f46\u662f\u4f1a\u6709\u4e00\u4e2a warn \u3002 gzip_vary on ; # limit_zone crawler $b inary_remote_addr 10 m ; #\u5f00\u542f\u9650\u5236IP\u8fde\u63a5\u6570\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528 gzip_proxied expired no - cache no - store private auth ; gzip_disable \" MSIE [1-6]\\. \" ; limit_conn_zone $b inary_remote_addr zone = perip : 10 m ; limit_conn_zone $ server_name zone = perserver : 10 m ; server_tokens off ; access_log off ; upstream www . 19950128 . com { # upstream \u7684\u8d1f\u8f7d\u5747\u8861\uff0c weight \u662f\u6743\u91cd\uff0c\u53ef\u4ee5\u6839\u636e\u673a\u5668\u914d\u7f6e\u5b9a\u4e49\u6743\u91cd\u3002 weigth \u53c2\u6570\u8868\u793a\u6743\u503c\uff0c\u6743\u503c\u8d8a\u9ad8\u88ab\u5206\u914d\u5230\u7684\u51e0\u7387\u8d8a\u5927\u3002 server 192 . 168 . 80 . 121 : 80 weight = 3 ; server 192 . 168 . 80 . 122 : 80 weight = 2 ; server 192 . 168 . 80 . 123 : 80 weight = 3 ; } #\u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e server { #\u76d1\u542c\u7aef\u53e3 listen 80 ; #\u57df\u540d\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u7528\u7a7a\u683c\u9694\u5f00 server_name www . 19950128 . com ; index index . html index . htm index . php ; root / data / www / ; # error_page 404 / 404 . html ; include enable - php . conf ; location ~ . * \\. ( php | php5 | ) ?$ { fastcgi_pass 127 . 0 . 0 . 1 : 9000 ; fastcgi_index index . php ; include fastcgi . conf ; } #\u56fe\u7247\u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e location ~ . * \\. ( gif | jpg | jpeg | png | bmp | swf ) $ { expires 10 d ; } # JS \u548c CSS \u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e location ~ . * \\. ( js | css ) ?$ { expires 1 h ; } # \u5b9a\u4e49\u9519\u8bef\u63d0\u793a\u9875\u9762 error_page 500 502 503 504 / 50 x . html ; location = / 50 x . html { } #\u65e5\u5fd7\u683c\u5f0f 1 log_format access ' $remote_addr - $remote_user [$time_local] \"$request\" ' ' $status $body_bytes_sent \"$http_referer\" ' ' \"$http_user_agent\" $http_x_forwarded_for ' ; # \u65e5\u5fd7\u683c\u5f0f 2 log_format custom ' $remote_addr - $remote_user [$time_local] ' ' \"$request\" $status $body_bytes_sent ' ' \"$http_referer\" \"$http_user_agent\" ' ' \"$http_x_forwarded_for\" $request_id ' ' $geoip_country_name $geoip_country_code ' ' $geoip_region_name $geoip_city ' ; #\u5b9a\u4e49\u672c\u865a\u62df\u4e3b\u673a\u7684\u8bbf\u95ee\u65e5\u5fd7 access_log / var / log / nginx / access . log ; #\u5bf9 \" / \" \u542f\u7528\u53cd\u5411\u4ee3\u7406 location / { proxy_pass http : // 127 . 0 . 0 . 1 : 88 ; proxy_redirect off ; proxy_set_header X - Real - IP $ remote_addr ; #\u540e\u7aef\u7684 Web \u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7 X - Forwarded - For \u83b7\u53d6\u7528\u6237\u771f\u5b9e IP proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; #\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53cd\u5411\u4ee3\u7406\u7684\u914d\u7f6e\uff0c\u53ef\u9009\u3002 proxy_set_header Host $ host ; client_max_body_size 10 m ; #\u5141\u8bb8\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5355\u6587\u4ef6\u5b57\u8282\u6570 client_body_buffer_size 128 k ; #\u7f13\u51b2\u533a\u4ee3\u7406\u7f13\u51b2\u7528\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5b57\u8282\u6570\uff0c proxy_connect_timeout 90 ; #nginx\u8ddf\u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4(\u4ee3\u7406\u8fde\u63a5\u8d85\u65f6) proxy_send_timeout 90 ; #\u540e\u7aef\u670d\u52a1\u5668\u6570\u636e\u56de\u4f20\u65f6\u95f4(\u4ee3\u7406\u53d1\u9001\u8d85\u65f6) proxy_read_timeout 90 ; #\u8fde\u63a5\u6210\u529f\u540e\uff0c\u540e\u7aef\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4(\u4ee3\u7406\u63a5\u6536\u8d85\u65f6) proxy_buffer_size 4 k ; #\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\uff08nginx\uff09\u4fdd\u5b58\u7528\u6237\u5934\u4fe1\u606f\u7684\u7f13\u51b2\u533a\u5927\u5c0f proxy_buffers 4 32 k ; #proxy_buffers\u7f13\u51b2\u533a\uff0c\u7f51\u9875\u5e73\u5747\u572832k\u4ee5\u4e0b\u7684\u8bbe\u7f6e proxy_busy_buffers_size 64 k ; #\u9ad8\u8d1f\u8377\u4e0b\u7f13\u51b2\u5927\u5c0f\uff08proxy_buffers*2\uff09 proxy_temp_file_write_size 64 k ; #\u8bbe\u5b9a\u7f13\u5b58\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5927\u4e8e\u8fd9\u4e2a\u503c\uff0c\u5c06\u4ece upstream \u670d\u52a1\u5668\u4f20 } #\u8bbe\u5b9a\u67e5\u770b Nginx \u72b6\u6001\u7684\u5730\u5740 location / NginxStatus { stub_status on ; access_log on ; auth_basic \" NginxStatus \" ; auth_basic_user_file conf / htpasswd ; # htpasswd \u6587\u4ef6\u7684\u5185\u5bb9\u53ef\u4ee5\u7528 apache \u63d0\u4f9b\u7684 htpasswd \u5de5\u5177\u6765\u4ea7\u751f\u3002 } #\u672c\u5730\u52a8\u9759\u5206\u79bb\u53cd\u5411\u4ee3\u7406\u914d\u7f6e #\u6240\u6709 jsp \u7684\u9875\u9762\u5747\u4ea4\u7531 tomcat \u6216 resin \u5904\u7406 location ~ . ( jsp | jspx | do ) ?$ { proxy_set_header Host $ host ; proxy_set_header X - Real - IP $ remote_addr ; proxy_set_header X - Forwarded - For $ proxy_add_x_forwarded_for ; proxy_pass http : // 127 . 0 . 0 . 1 : 8080 ; } #\u6240\u6709\u9759\u6001\u6587\u4ef6\u7531 nginx \u76f4\u63a5\u8bfb\u53d6\u4e0d\u7ecf\u8fc7 tomcat \u6216 resin location ~ . * . ( htm | html | gif | jpg | jpeg | png | bmp | swf | ioc | rar | zip | txt | flv | mid | doc | ppt | pdf | xls | mp3 | wma ) $ { expires 15 d ; } location ~ . * . ( js | css ) ?$ { expires 1 h ; } #\u7981\u6b62\u8bbf\u95ee . htxxx \u6587\u4ef6 location ~ / . ht { deny all ; } } } nginx.conf\u914d\u7f6e\u8865\u5145\u6269\u5c55\uff1a #\u9759\u6001\u6587\u4ef6\uff0c nginx \u81ea\u5df1\u5904\u7406 location ~ ^/ ( images | javascript | js | css | flash | media | static / { #\u8fc7\u671f 30 \u5929\uff0c\u9759\u6001\u6587\u4ef6\u4e0d\u600e\u4e48\u66f4\u65b0\uff0c\u8fc7\u671f\u53ef\u4ee5\u8bbe\u5927\u4e00\u70b9\uff0c #\u5982\u679c\u9891\u7e41\u66f4\u65b0\uff0c\u5219\u53ef\u4ee5\u8bbe\u7f6e\u5f97\u5c0f\u4e00\u70b9\u3002 expires 30 d ; } # PHP \u811a\u672c\u8bf7\u6c42\u5168\u90e8\u8f6c\u53d1\u5230 FastCGI \u5904\u7406. \u4f7f\u7528 FastCGI \u9ed8\u8ba4\u914d\u7f6e. location ~* \\. php $ { fastcgi_index index . php ; fastcgi_pass 127 . 0 . 0 . 1 : 9000 ; include fastcgi_params ; fastcgi_param SCRIPT_FILENAME $d ocument_root $fa stcgi_script_name ; fastcgi_param SCRIPT_NAME $fa stcgi_script_name ; } # \u62d2\u7edd\u56fe\u7247\u70ed\u94fe\u63a5 location / images / { valid_referers none blocked www . example . com example . com ; if ( $ invalid_referer ) { return 403 ; } } \u53e6\u5916\u4e00\u4e2a\u65b9\u6cd5\u53ef\u8df3\u8f6c\u5230\u4e00\u4e2a\u56fa\u5b9a\u7684\u56fe\u7247\u94fe\u63a5\u6216 url valid_referers blocked www . example . com example . com ; if ( $ invalid_referer ) { rewrite ^/ images / uploads . * \\. ( gif | jpg | jpeg | png ) $ http : // www . examples . com / banned . jpg last } ### Password Protect / personal - images / and / delta / directories ### location ~ / ( personal - images / . *| delta / . * ) { auth_basic \" Restricted \" ; auth_basic_user_file / usr / local / nginx / conf / . htpasswd / passwd ; } Create an SSL Certificate # cd / usr / local / nginx / conf # openssl genrsa - des3 - out server . key 1024 # openssl req - new - key server . key - out server . csr # cp server . key server . key . org # openssl rsa - in server . key . org - out server . key # openssl x509 - req - days 365 - in server . csr - signkey server . key - out server . crt","title":"Nginx\u7684conf\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3"},{"location":"Nginx/#nginx_1","text":"nginx\u65e5\u5fd7\u6700\u597d\u5b9e\u73b0\u6bcf\u5929\u5b9a\u65f6\u5207\u5272\u4e0b\uff0c\u7279\u522b\u662f\u5728\u8bbf\u95ee\u91cf\u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u65b9\u4fbf\u67e5\u770b\u4e0e\u5904\u7406\uff0c\u5982\u679c\u6ca1\u5207\u5272\uff0c\u53ef\u4ee5\u7528sed\u76f4\u63a5\u5207\u5272\uff0c \u5207\u5272\u65e5\u5fd7 \u67e5\u627e7\u670817\u65e5\u8bbf\u95eelog\u5bfc\u51fa\u523017.log\u6587\u4ef6\u4e2d\uff1a cat gelin_web_access.log | egrep \"17/Jul/2017\" | sed -n '/00:00:00/,/23:59:59/p' > /tmp/17.log \u67e5\u770b\u8bbf\u95ee\u91cf\u524d10\u7684IP awk '{print $1}' 17 .log | sort | uniq -c | sort -nr | head -n 10 \u67e5\u770b\u8bbf\u95ee\u524d10\u7684URL awk '{print $11}' gelin_web_access.log | sort | uniq -c | sort -nr | head -n 10 \u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684URL awk '{print $7}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more \u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684IP awk '{print $1}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more \u6839\u636e\u8bbf\u95eeIP\u7edf\u8ba1UV awk '{print $1}' gelin_web_access.log | sort | uniq -c | wc -l \u7edf\u8ba1\u8bbf\u95eeURL\u7edf\u8ba1PV awk '{print $7}' gelin_web_access.log | wc -l \u6839\u636e\u65f6\u95f4\u6bb5\u7edf\u8ba1\u67e5\u770b\u65e5\u5fd7 cat gelin_web_access.log | sed -n '/17\\/Jul\\/2017:12/,/17\\/Jul\\/2017:13/p' | more","title":"nginx\u65e5\u5fd7\u76f8\u5173\u547d\u4ee4"},{"location":"Nginx/#unit180","text":"# Control socket\u4f4d\u7f6e\uff1a/var/run/control.unit.sock cat << EOF > /etc/yum.repos.d/unit.repo [unit] name=unit repo baseurl=https://packages.nginx.org/unit/centos/7/$basearch/ gpgcheck=0 enabled=1 EOF # \u8bbe\u7f6e\u4e00\u4e2aapplication\u5bf9\u8c61,\u5229\u7528json\u6587\u4ef6\uff0c\u5c06\u5bf9\u8c61\u653e\u5165\u5230config/applications\u4e0b\u7684blogs\u5757\u4e2d curl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/ # \u4ecelisteners\u5bf9\u8c61\u5f15\u7528application\u5bf9\u8c61\uff0c\u5176\u5305\u62ecIP(\u6216\u4efb\u4f55\u5339\u914dIP\u7684\u901a\u914d\u7b26)\u548c\u7aef\u53e3\u53f7config/listeners curl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/listeners/127.0.0.1:8300 # \u68c0\u67e5\u76ee\u524d\u7684\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u4e00\u6b21\u6027\u4e0a\u4f20\u4e0a\u9762\u7684\u4e24\u6b65\u7684\u5168\u90e8\u914d\u7f6e curl --unix-socket /var/run/control.unit.sock http://localhost/config/ # \u521b\u5efa\u5bf9\u8c61 curl -X PUT -d @/path/to/start.json --unix-socket /var/run/control.unit.sock http://localhost/config/ # \u4fee\u6539application\u5bf9\u8c61blogs,\u5c06\u5176listeners\u66f4\u6539\u4e3a*:8400 curl -X PUT -d '\"blogs\"' --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400/application' # \u5c06blogs\u7684application\u5bf9\u8c61\u4e2d\u7684root\u53c2\u6570\u66f4\u6539\u4e3a/www/blogs-dev curl -X PUT -d '\"/www/blogs-dev\"' --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/root # \u5220\u9664\u5bf9\u8c61\uff0c\u8981\u5220\u9664\u5bf9\u8c61\uff0c\u9700\u8981\u53d1\u51faDELETE\u8bf7\u6c42\u5e76\u5c06\u5bf9\u8c61\u7684\u8def\u5f84\u9644\u52a0\u5230curl URL\u3002\u5982\u4e0b\uff1a\u5220\u9664listener\u76d1\u542c*:8400 curl -X DELETE --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400' # listeners | \u9009\u9879 | \u63cf\u8ff0 | | :------: | :------: | | application ( \u5df2\u5e9f\u5f03 ) | \u5e94\u7528\u540d\u79f0,\u4e0epass\u4e92\u65a5 | | pass ( required ) | \u5e94\u7528\u6216\u8def\u7531\u540d\u79f0\uff1a \"pass\" : \"routers/route66\" , \"pass\" : \"applications/smart\" | | tls | SSL/TLS\u914d\u7f6e,\u6dfb\u52a0certificate\u5b9e\u73b0listener\u52a0\u5bc6\u901a\u4fe1 | # Routers,\u5229\u7528routers\u5bf9\u8c61\u5b9e\u73b0listeners\u548capps\u5185\u90e8\u8def\u7531\uff0clisteners\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9pass\u6216\u76f4\u63a5\u4f20\u9012\u7ed9\u5e94\u7528\u7a0b\u5e8f # routers\u5bf9\u8c61\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aroute\u53c2\u6570.\u4f8b\u5982\uff1a { \"listeners\" : { \"*:8300\" : { \"pass\" : \"routes\" } }, \"routes\" : [ \"simply referred to as routes\" ] } # \u591a\u4e2a { \"listeners\" : { \"*:8300\" : { \"pass\" : \"routes/main\" } }, \"routes\" : { \"main\" : [ \"named route, qualified name: routes/main\" ], \"route66\" : [ \"named route, qualified name: routes/route66\" ] } } route\u53c2\u6570\u5305\u542b\u533f\u540d\u5bf9\u8c61\u6216steps\u3002\u8bf7\u6c42\u901a\u8fc7route\u53bb\u904d\u5386\uff0csteps\u6709\u5982\u4e0b\u9009\u9879 | \u9009\u9879 | \u63cf\u8ff0 | | :------: | :------: | | match | \u5b9a\u4e49\u6b65\u9aa4\u6761\u4ef6\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u8bf7\u6c42\u548cmatch\u6761\u4ef6\u5339\u914d\uff0cpass\u6b65\u9aa4\u5c06\u751f\u6548\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u5c06\u7ee7\u7eed\u8fdb\u884croute\u7684\u4e0b\u4e00\u6b65\uff0c\u5982\u679c\u90fd\u4e0d\u5339\u914d\uff0c\u8fd4\u56de404\u9519\u8bef | | action/pass(required) | route\u7684\u76ee\u7684\u5730\uff0c\u5982\u679c\u5ffd\u7565\u4e86match\uff0c\u8bf7\u6c42\u76f4\u63a5\u901a\u8fc7\uff0c\u907f\u514d\u51fa\u9519\uff0c\u6bcf\u4e2aroute\u4f7f\u7528\u4e00\u4e2a\u8fd9\u6837\u7684\u6b65\u9aa4\u5e76\u653e\u5728\u6700\u540e | { \"routes\" : [ { \"match\" : { \"host\" : \"example.com\" , \"uri\" : \"/admin/*\" }, \"action\" : { \"pass\" : \"applications/php5_app\" } }, { \"action\" : { \"pass\" : \"applications/php7_app\" } } ] } # \u66f4\u8be6\u7ec6\u7684\u7684\u793a\u4f8b { \"routes\" : { \"main\" : [ { \"match\" : { \"host\" : [ \"www.example.com\" , \"example.com\" ] }, \"action\" : { \"pass\" : \"routes/site\" } }, { \"match\" : { \"host\" : \"blog.example.com\" }, \"action\" : { \"pass\" : \"applications/blog\" } } ], \"site\" : [ \"...\" ] } } # \u6761\u4ef6\u5339\u914d\uff1b\u6b65\u9aa4\u4e2d\u7684\u5339\u914d\u6761\u4ef6\u5305\u62ec\u8bf7\u6c42\u5c5e\u6027\u540d\u79f0\u548c\u76f8\u5e94\u7684pattern { \"match\" : { \"request_property1\" : \"pattern\" , \"request_property2\" : [ \"pattern\" , \"pattern\" , \"...\" ] }, \"action\" : { \"pass\" : \"...\" } } \u9009\u9879 \u63cf\u8ff0 host \u8bf7\u6c42\u4e3b\u673a\u4eceHost\u6ca1\u6709\u7aef\u53e3\u53f7\u7684header\u5b57\u6bb5\uff0c\u901a\u8fc7\u5220\u9664\u5c3e\u968f\u53e5\u70b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u8fdb\u884c\u89c4\u8303\u5316;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 method \u6765\u81ea\u8bf7\u6c42\u884c\u7684\u8bf7\u6c42\u65b9\u6cd5;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 uri \u8bf7\u6c42URI\u6ca1\u6709\u53c2\u6570\u7684\u8def\u5f84\uff0c\u901a\u8fc7\u89e3\u7801\u201c%XX\u201d\u5e8f\u5217\uff0c\u89e3\u6790\u76f8\u5bf9\u8def\u5f84\u5f15\u7528\uff08\u201c.\u201d\u548c\u201c..\u201d\uff09\uff0c\u5e76\u5c06\u76f8\u90bb\u659c\u6760\u538b\u7f29\u4e3a\u4e00\u4e2a;\u533a\u5206\u5927\u5c0f\u5199 pattern\u5fc5\u987b\u5b8c\u5168\u5339\u914d\uff0c\u652f\u6301*\u548c!","title":"Unit1.8.0"},{"location":"Oracle/","text":"oracle \u5185\u5b58\u8c03\u4f18\u529e\u6cd5 \u00b6 \u5f53\u9879\u76ee\u7684\u751f\u4ea7\u73af\u5883\u51fa\u73b0\u6027\u80fd\u95ee\u9898\uff0c\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5224\u65ad\u90a3\u4e9b\u53c2\u6570\u9700\u8981\u8c03\u6574\u5462\uff1f 3 . 1 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Library Cache\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 99 \uff05 \u68c0\u67e5\u65b9\u5f0f : select 1 - ( sum ( reloads ) / sum ( pins )) \"Library cache Hit Ratio\" from v$librarycache ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Library cache Hit Ratio\u7684\u503c\u4f4e\u4e8e99 % \uff0c\u5e94\u8c03\u9ad8 shared_pool_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 shared_pool_size\u7684\u5927\u5c0f \uff1a SQL > alter system flush shared_pool ; SQL > alter system set shared_pool_size = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 2 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Data Buffer \uff08\u6570\u636e\u7f13\u51b2\u533a\uff09\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 90 % \u68c0\u67e5\u65b9\u5f0f : select 1 - ( phy . value / ( cur . value + con . value )) \"HIT RATIO\" from v$sysstat cur , v$sysstat con , v$sysstat phy where cur . name = 'db block gets' and con . name = 'consistent gets' and phy . name = 'physical reads' ; \u5904\u7406\u63aa\u65bd : \u5982\u679c HIT RATIO\u7684\u503c\u4f4e\u4e8e90 % \uff0c\u5e94\u8c03\u9ad8 db_cache_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c \u8c03\u6574 db_cache_size\u7684\u5927\u5c0f SQL > alter system set db_cache_size = \u8bbe\u5b9a\u503c scope = spfile 3 . 3 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Dictionary Cache\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 95 % \u68c0\u67e5\u65b9\u5f0f : select 1 - ( sum ( getmisses ) / sum ( gets )) \"Data Dictionary Hit Ratio\" from v$rowcache ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Data Dictionary Hit Ratio\u7684\u503c\u4f4e\u4e8e95 % \uff0c\u5e94\u8c03\u9ad8 shared_pool_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 shared_pool_size\u7684\u5927\u5c0f \uff1a SQL > alter system flush shared_pool ; SQL > alter system set shared_pool_size = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 4 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Log Buffer\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5c0f\u4e8e 1 % \u68c0\u67e5\u65b9\u5f0f : select ( req . value * 5000 ) / entries . value \"Ratio\" from v$sysstat req , v$sysstat entries where req . name = 'redo log space requests' and entries . name = 'redo entries' ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Ratio\u9ad8\u4e8e1 \uff05\uff0c\u5e94\u8c03\u9ad8 log_buffer\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 log_buffer\u7684\u5927\u5c0f \uff1a SQL > alter system set log_buffer = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 5 \u68c0\u67e5 undo_retention : \u6807\u51c6 : undo_retention \u7684\u503c\u5fc5\u987b\u5927\u4e8e max ( maxquerylen ) \u7684\u503c \u68c0\u67e5\u65b9\u5f0f : col undo_retention format a30 select value \"undo_retention\" from v$parameter where name = 'undo_retention' ; select max ( maxquerylen ) From v$undostat Where begin_time > sysdate - ( 1 / 4 ); \u5904\u7406\u63aa\u65bd : \u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u9700\u8981\u8c03\u9ad8 undo_retention \u7684\u503c\u3002\u901a\u8fc7 sqlplus \u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d \u4ee4\uff0c\u8c03\u6574 undo_retention \u7684\u5927\u5c0f\uff1a SQL > alter system set undo_retention = \u8bbe\u5b9a\u503c scope = spfile ;","title":"Oracle"},{"location":"Oracle/#oracle","text":"\u5f53\u9879\u76ee\u7684\u751f\u4ea7\u73af\u5883\u51fa\u73b0\u6027\u80fd\u95ee\u9898\uff0c\u6211\u4eec\u5982\u4f55\u901a\u8fc7\u5224\u65ad\u90a3\u4e9b\u53c2\u6570\u9700\u8981\u8c03\u6574\u5462\uff1f 3 . 1 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Library Cache\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 99 \uff05 \u68c0\u67e5\u65b9\u5f0f : select 1 - ( sum ( reloads ) / sum ( pins )) \"Library cache Hit Ratio\" from v$librarycache ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Library cache Hit Ratio\u7684\u503c\u4f4e\u4e8e99 % \uff0c\u5e94\u8c03\u9ad8 shared_pool_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 shared_pool_size\u7684\u5927\u5c0f \uff1a SQL > alter system flush shared_pool ; SQL > alter system set shared_pool_size = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 2 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Data Buffer \uff08\u6570\u636e\u7f13\u51b2\u533a\uff09\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 90 % \u68c0\u67e5\u65b9\u5f0f : select 1 - ( phy . value / ( cur . value + con . value )) \"HIT RATIO\" from v$sysstat cur , v$sysstat con , v$sysstat phy where cur . name = 'db block gets' and con . name = 'consistent gets' and phy . name = 'physical reads' ; \u5904\u7406\u63aa\u65bd : \u5982\u679c HIT RATIO\u7684\u503c\u4f4e\u4e8e90 % \uff0c\u5e94\u8c03\u9ad8 db_cache_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c \u8c03\u6574 db_cache_size\u7684\u5927\u5c0f SQL > alter system set db_cache_size = \u8bbe\u5b9a\u503c scope = spfile 3 . 3 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Dictionary Cache\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5927\u4e8e 95 % \u68c0\u67e5\u65b9\u5f0f : select 1 - ( sum ( getmisses ) / sum ( gets )) \"Data Dictionary Hit Ratio\" from v$rowcache ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Data Dictionary Hit Ratio\u7684\u503c\u4f4e\u4e8e95 % \uff0c\u5e94\u8c03\u9ad8 shared_pool_size\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 shared_pool_size\u7684\u5927\u5c0f \uff1a SQL > alter system flush shared_pool ; SQL > alter system set shared_pool_size = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 4 \u68c0\u67e5 ORACLE\u5b9e\u4f8b\u7684Log Buffer\u547d\u4e2d\u7387 : \u6807\u51c6 : \u4e00\u822c\u662f\u5c0f\u4e8e 1 % \u68c0\u67e5\u65b9\u5f0f : select ( req . value * 5000 ) / entries . value \"Ratio\" from v$sysstat req , v$sysstat entries where req . name = 'redo log space requests' and entries . name = 'redo entries' ; \u5904\u7406\u63aa\u65bd : \u5982\u679c Ratio\u9ad8\u4e8e1 \uff05\uff0c\u5e94\u8c03\u9ad8 log_buffer\u7684\u5927\u5c0f \u3002\u901a\u8fc7 sqlplus\u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d\u4ee4 \uff0c\u8c03\u6574 log_buffer\u7684\u5927\u5c0f \uff1a SQL > alter system set log_buffer = \u8bbe\u5b9a\u503c scope = spfile ; 3 . 5 \u68c0\u67e5 undo_retention : \u6807\u51c6 : undo_retention \u7684\u503c\u5fc5\u987b\u5927\u4e8e max ( maxquerylen ) \u7684\u503c \u68c0\u67e5\u65b9\u5f0f : col undo_retention format a30 select value \"undo_retention\" from v$parameter where name = 'undo_retention' ; select max ( maxquerylen ) From v$undostat Where begin_time > sysdate - ( 1 / 4 ); \u5904\u7406\u63aa\u65bd : \u5982\u679c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u9700\u8981\u8c03\u9ad8 undo_retention \u7684\u503c\u3002\u901a\u8fc7 sqlplus \u8fde\u63a5\u6570\u636e\u5e93\u6267\u884c\u5982\u4e0b\u547d \u4ee4\uff0c\u8c03\u6574 undo_retention \u7684\u5927\u5c0f\uff1a SQL > alter system set undo_retention = \u8bbe\u5b9a\u503c scope = spfile ;","title":"oracle \u5185\u5b58\u8c03\u4f18\u529e\u6cd5"},{"location":"Others/","text":"\u5176\u4ed6\u5174\u8da3\u7231\u597d \u00b6 GoogleTricks \u00b6 \"\" \u53cc\u5f15\u53f7 - \u6392\u9664\u5b57\u7b26 \u597d : baidu . com \u4f7f\u7528\u5192\u53f7\u641c\u7d22\u7279\u5b9a\u7684\u7f51\u7ad9 am * zing \u4f7f\u7528\u661f\u53f7\u901a\u914d\u7b26 related : amazon . com \u627e\u5230\u4e0e\u5176\u4ed6\u7f51\u7ad9\u7c7b\u4f3c\u7684\u7f51\u7ad9 Black or red \u5408\u5e76\u641c\u7d22 filetype : pdf \u627e\u5230\u7279\u5b9a\u6587\u4ef6 site : www . so . com \u5728360\u641c\u7d22\u5f15\u64ce\u4e2d\u5bfb\u627e allintitle : allinurl : @twitter \u641c\u7d22\u793e\u4ea4\u5a92\u4f53 info : \u83b7\u53d6\u6709\u5173\u7f51\u7ad9\u7684\u8be6\u7ec6\u4fe1\u606f cache : \u67e5\u770bGoogle\u7684\u7f51\u7ad9\u7f13\u5b58\u7248\u672c google . com / history \u641c\u7d22\u5386\u53f2 inurl : \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728url\u94fe\u63a5\u4e2d intitle : \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728\u7f51\u9875\u6807\u9898\u4e2d AND \uff1a \u8fd4\u56de\u67e5\u8be2\u4e24\u7aef\u7684\u7ed3\u679c \u3002 \u4f8b \uff1a growth hacks AND youtube NOT \uff1a \u8fd4\u56de\u9664NOT\u4e4b\u540e\u7684\u6240\u6709\u7ed3\u679c \u3002 \u4f8b \uff1a monty python NOT bbc \u4f7f\u7528 ~ \u641c\u7d22\u8bcd\u7684\u540c\u4e49\u8bcd \u4f7f\u7528in\u7684\u7ffb\u8bd1\u548c\u8f6c\u6362 process management inurl : forum | forums | discussion | viewthread | showthread | viewtopic | showtopic \u8bba\u575b google . com / ncr \u3002 NCR\u4ee3\u8868\u65e0\u56fd\u5bb6 / \u5730\u533a\u91cd\u5b9a\u5411 process automation filetype : pdf \u641c\u7d22ftp inurl : ftp : // - inurl : http : // - inurl : https : // - inurl ( html | htm | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( wmv | avi ) - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( jpg | gif ) - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( wma | mp3 ) [ -inurl:(htm|html|php) intitle:\" index of\" +\" last modified\" +\" parent directory\" +description +size +(jpg|gif) \u201cbritney spears\" ] Function Execution To search for an exact phrase, with the same words in the same order Place quotation marks (\u201c) around the phrase you\u2019d like to search for Ex: \u201cto be, or not to be\" To exclude results that include a particular word or site when searching words with multiple meanings Place a dash (-) before the word or site you want to omit Ex: phoenix -arizona To search for Google+ pages or blood types Place an addition sign (+) in front of the Google+ user or after the blood type Ex: +Chrome and AB+ To search for social tags Place the at symbol (@) before the social tag you\u2019d like to search Ex: @digitaltrends To search for prices Place a dollar sign ($) before the value Ex: canon $400 To search for a phrase with missing words Place an asterisk (*) within the search as a placeholder for any unknown terms Ex: if you give a * a * To search for a range of numbers, usually pertaining to prices and measurements Place two periods between the designated numbers you want to search between Ex: 75.. 75.. 200 To search popular hashtags for trending topics Place a hashtag in front of the desired topicEx: #throwbackthursday Function Execution To search for results from certain sites and domains Place \u201csite:\" in front of the site or domain from which you want to pull results Ex: apple watch site:digitaltrends.com To search for pages that link to a certain page Place \u201clink:\" in front of the site or domain you want to find pages linking to Ex: link:digitaltrends.com To search for sites that are similar to a designated site or domain Place \u201crelated:\" in front of the site or domain you want to find similar results of Ex: related:digitaltrends.com To search for pages that just have one of several words Place \u201cOR\" between the two words you are searching for Ex: world series 2013 OR 2014 To search for designated information about a specific site or domain, including cached pages, and those linking to the site Place \u201cinfo:\" in front of the site or domain you want information about Ex: info:digitaltrends.com To search what a page looked like the last time Google crawled the site Place \u201ccache:\" in front of the page housing the cache you\u2019d like to view Ex: cache:digitaltrends.com To search for a specific file type Place \u201cfiletype:\" in front of the specific file type you\u2019re looking for Ex: matthew mcconaughey filetype:gif Function Execution To search Google using voice commands Click the microphone icon in the search bar and begin talking To search Google for a specific image Click the camera icon in the search bar and paste the image URL To set a timer Enter \u201cset timer for\" followed by the desired amount of time To check the weather for a specific area Enter \u201cweather\" followed by a zipcode or city To search for the sunrise and sunset times for a specific area Enter \u201csunrise\" or \u201csunset\" followed by a zipcode or city To look up the definition for a given word Enter \u201cdefine\" followed by your desired term To look up the origins for a given word Enter \u201cetymology\" followed by your desired word To look up the time for a specific region Enter \u201ctime\" followed by the particular region To look up your IP address Enter \u201cip address\" in the search bar To check the status of a flight Enter the flight number in the search bar To look up stock quotes Enter the desired stock symbol in the search bar To look up the date for a specific holiday Enter the name of the holiday in the search bar To track a package Enter the tracking number in the search bar To use the calculator Enter the equation in the search bar To define a word Enter \u201cdefine\" followed by your desired word To convert currency or measurements Enter the first amount and unit, type \u201cto\", and then enter the second unit To look up film showings Enter \u201cmovies\" followed by your zipcode or city To look up sports scores Enter the sports team in the search bar To look up nutritional facts about an item, or compare nutritional facts Enter the name of the product, or enter \u201ccompare\" followed by the items you want to compare To look up a celebrity\u2019s Bacon Number Enter \u201cbacon number\" followed by the name of the celebrity To roll a six-sided die Enter [roll a dice] in the search bar Security \u00b6 Shadowsocks \u00b6 # Python,shadowsocks-python\u6700\u521d\u7684\u7248\u672c\u662f\u7531clowwindy\u5199\u7684. \u5b83\u7684\u76ee\u7684\u662f\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u6613\u7528\u548c\u6613\u4e8e\u90e8\u7f72\u7684\u5b9e\u73b0\uff0c\u5177\u6709\u57fa\u672c\u7684shadowsocks\u529f\u80fd PyPI \u9996\u5148\u786e\u5b9aPython\u662f2.6\u62162.7. $ python --version Python 2 .6.8 \u63a5\u7740\u7528pip\u5b89\u88c5 $ pip install shadowsocks GitHub Checkout\u6e90\u4ee3\u7801\u5e76\u76f4\u63a5\u8fd0\u884c\u811a\u672c $ git clone https://github.com/shadowsocks/shadowsocks.git $ cd shadowsocks $ python setup.py Go,shadowsocks-go\u662f\u7528Go\u8bed\u8a00\u7f16\u5199\u7684\u6700\u5148\u8fdb\u7684\u7aef\u53e3\uff0c\u4e13\u4e3a\u5927\u578b\u7cfb\u7edf\u8bbe\u8ba1\u3002\u5b83\u5b9e\u73b0\u4e86\u591a\u7aef\u53e3-\u591a\u5bc6\u7801\u7279\u6027\uff0c\u9002\u7528\u4e8e\u6709\u7528\u6237\u7ba1\u7406\u548c\u6d41\u91cf\u7edf\u8ba1\u652f\u6301\u7684\u4ed8\u8d39\u670d\u52a1\u63d0\u4f9b\u5546\u3002\u8be5\u7aef\u53e3\u7531cyfdecyf\u7ef4\u62a4\u3002 \u9884\u7f16\u8bd1\u4e8c\u8fdb\u5236\uff1a \u4ecehttp://dl.chenyufei.info/shadowsocks/\u4e0b\u8f7d GitHub Use go get to install the scripts. $ go get github.com/shadowsocks/shadowsocks-go/cmd/shadowsocks-server shadowsocks-go is licensed under the MIT license. C with libev [ shadowsocks-libev ] ,shadowsocks-libev\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u3001\u529f\u80fd\u9f50\u5168\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u53e3\u548c\u4f4e\u7aef\u7684\u7ec8\u7aef\u76d2\u3002\u8fd9\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684C\u5b9e\u73b0\uff0c\u5b83\u5360\u7528\u4e86\u6570\u5343\u4e2a\u8fde\u63a5\u7684\u5360\u7528\u7a7a\u95f4\u5f88\u5c0f ( \u51e0\u5146\u5b57\u8282 ) \u3002\u8fd9\u4e2a\u7aef\u53e3\u7531madeye\u7ef4\u62a4\u3002 Debian/Ubuntu: Shadowsocks-libev is available in the official repository for Debian 9 ( \"Stretch\" ) , unstable, Ubuntu 16 .10 and later derivatives: sudo apt update sudo apt install shadowsocks-libev For Debian Jessie users, please install it from jessie-backports: sudo sh -c 'printf \"deb http://httpredir.debian.org/debian jessie-backports main\" > /etc/apt/sources.list.d/jessie-backports.list' sudo apt-get update sudo apt-get -t jessie-backports install shadowsocks-libev GitHub Build and install the project from source codes. $ sudo apt-get install --no-install-recommends build-essential autoconf libtool \\ libssl-dev gawk debhelper dh-systemd init-system-helpers pkg-config asciidoc \\ xmlto apg libpcre3-dev zlib1g-dev libev-dev libudns-dev libsodium-dev libmbedtls-dev libc-ares-dev automake $ git clone https://github.com/shadowsocks/shadowsocks-libev.git $ cd shadowsocks-libev $ git submodule update --init $ ./autogen.sh && ./configure && make $ sudo make install C++ with Qt,libQtShadowsocks\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u3001\u8d85\u5feb\u7684shadowsocks\u5e93\uff0c\u5b83\u662f\u7528c++\u7f16\u5199\u7684qt5\u3002\u5ba2\u6237\u673ashadowsocks-libqss\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4f7f\u7528\u3002\u8be5\u7aef\u53e3\u7531librehat\u7ef4\u62a4\u3002 Prebuilt binaries Download pre-built binaries from https://github.com/shadowsocks/libQtShadowsocks/releases GitHub $ git clone https://github.com/shadowsocks/libQtShadowsocks.git $ cd libQtShadowsocks $ qmake $ make -j4 $ sudo make install libQtShadowsocks is licensed under the GNU Lesser General Public License, version 3 .0 Perl,Net::Shadowsocks is an asynchronous, non-blocking Shadowsocks client and server Perl module maintained by @zhou0. Setting up You need a Perl interpreter to execute Perl program. Any Unix like system , including Linux and Mac OS X, has Perl pre-installed. Windows does not have Perl installed by default, you need to install Strawberry Perl.The source code is available on CPAN and github. Download from CPAN https://metacpan.org/release/Net-Shadowsocks or download from github https://github.com/zhou0/shadowsocks-perl Installing On Unix like systems,either $ perl Build.PL $ ./Build $ ./Build test $ ./Build install or $ perl Makefile.PL $ make $ make test $ make install You might need to change make to dmake or nmake depending on the compiler toolchain used on Windows. If You have cpan, you can also install using this command $ cpan Net::Shadowsocks Running There is a server.pl script under the eg directory. Put your config.json in the same directory as server.pl and run the server.pl script there. shadowsocks\u914d\u7f6e \u00b6 Shadowsocks\u5141\u8bb8\u7684JSON\u914d\u7f6e\u683c\u5f0f: { \"server\" : \"my_server_ip\" , \"server_port\" :8388, \"local_port\" :1080, \"password\" : \"barfoo!\" , \"timeout\" :600, \"method\" : \"chacha20-ietf-poly1305\" } \u6bcf\u4e2a\u5b57\u6bb5\u7684\u89e3\u91ca: server: your hostname or server IP ( IPv4/IPv6 ) . server_port: server port number. local_port: local port number. password: a password used to encrypt transfer. timeout: connections timeout in seconds. method: encryption method. \u52a0\u5bc6\u65b9\u5f0f\uff1a \u6700\u5f3a\u7684\u9009\u9879\u662fAEAD\u5bc6\u7801\u3002\u63a8\u8350\u7684\u9009\u62e9\u662f\u201cchacha20-ietf-poly1305\u201d\u6216\u201caes-256-gcm\u201d\u3002\u5176\u4ed6\u6d41\u5bc6\u7801\u88ab\u5b9e\u73b0\uff0c\u4f46\u4e0d\u63d0\u4f9b\u5b8c\u6574\u6027\u548c\u771f\u5b9e\u6027\u3002\u9664\u975e\u53e6\u6709\u89c4\u5b9a\uff0c\u52a0\u5bc6\u65b9\u6cd5\u9ed8\u8ba4\u4e3a\u201ctable\u201d\uff0c\u8fd9\u662f\u4e0d\u5b89\u5168\u7684\u3002 shadowsocks\u4f18\u5316 \u00b6 \u7cfb\u7edf\u5c42\u9762 \u00b6 \u57fa\u4e8ekvm\u67b6\u6784vps\u7684\u4f18\u5316 \u8fd9\u65b9\u9762SS\u7ed9\u51fa\u4e86\u975e\u5e38\u8be6\u5c3d\u7684\u4f18\u5316\u6307\u5357\uff0c\u4e3b\u8981\u6709\uff1a\u4f18\u5316\u5185\u6838\u53c2\u6570\uff0c\u5f00\u542fTCP Fast Open ####1.1\u4f18\u5316\u5185\u6838\u53c2\u6570 \u7f16\u8f91vi /etc/sysctl.conf \u590d\u5236\u8fdb\u53bb # max open files fs.file-max = 51200 # max read buffer net.core.rmem_max = 67108864 # max write buffer net.core.wmem_max = 67108864 # default read buffer net.core.rmem_default = 65536 # default write buffer net.core.wmem_default = 65536 # max processor input queue net.core.netdev_max_backlog = 250000 # max backlog net.core.somaxconn = 4096 # resist SYN flood attacks net.ipv4.tcp_syncookies = 1 # reuse timewait sockets when safe net.ipv4.tcp_tw_reuse = 1 # turn off fast timewait sockets recycling net.ipv4.tcp_tw_recycle = 0 # short FIN timeout net.ipv4.tcp_fin_timeout = 30 # short keepalive time net.ipv4.tcp_keepalive_time = 1200 # outbound port range net.ipv4.ip_local_port_range = 10000 65000 # max SYN backlog net.ipv4.tcp_max_syn_backlog = 8192 # max timewait sockets held by system simultaneously net.ipv4.tcp_max_tw_buckets = 5000 net.ipv4.tcp_fastopen = 3 net.ipv4.tcp_mem = 25600 51200 102400 # TCP receive buffer net.ipv4.tcp_rmem = 4096 87380 67108864 # TCP write buffer net.ipv4.tcp_wmem = 4096 65536 67108864 # turn on path MTU discovery net.ipv4.tcp_mtu_probing = 1 # for high-latency network net.ipv4.tcp_congestion_control = hybla # forward ipv4 net.ipv4.ip_forward = 1 \u4fdd\u5b58\u751f\u6548 \u6267\u884csysctl -p\u547d\u4ee4reload\u914d\u7f6e\u6587\u4ef6 \u5176\u4e2d\u6700\u540e\u7684hybla\u662f\u4e3a\u9ad8\u5ef6\u8fdf\u7f51\u7edc\uff08\u5982\u7f8e\u56fd\uff0c\u6b27\u6d32\uff09\u51c6\u5907\u7684\u7b97\u6cd5\uff0c\u9700\u8981\u5185\u6838\u652f\u6301\uff0c\u6d4b\u8bd5\u5185\u6838\u662f\u5426\u652f\u6301\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\uff1a sysctl net.ipv4.tcp_available_congestion_control \u5982\u679c\u7ed3\u679c\u4e2d\u6709hybla\uff0c\u5219\u8bc1\u660e\u4f60\u7684\u5185\u6838\u5df2\u5f00\u542fhybla\uff0c\u5982\u679c\u6ca1\u6709hybla\uff0c\u53ef\u4ee5\u7528\u547d\u4ee4modprobe tcp_hybla\u5f00\u542f\u3002 \u5bf9\u4e8e\u4f4e\u5ef6\u8fdf\u7684\u7f51\u7edc\uff08\u5982\u65e5\u672c\uff0c\u9999\u6e2f\u7b49\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528htcp\uff0c\u53ef\u4ee5\u975e\u5e38\u663e\u8457\u7684\u63d0\u9ad8\u901f\u5ea6\uff0c\u9996\u5148\u4f7f\u7528modprobe tcp_htcp\u5f00\u542f\uff0c\u518d\u5c06net.ipv4.tcp_congestion_control = hybla\u6539\u4e3anet.ipv4.tcp_congestion_control = htcp\uff0c\u5efa\u8baeEC2\u65e5\u672c\u7528\u6237\u4f7f\u7528\u8fd9\u4e2a\u7b97\u6cd5\u3002 TCP\u4f18\u5316 \u00b6 1 .\u4fee\u6539\u6587\u4ef6\u53e5\u67c4\u6570\u9650\u5236 \u5982\u679c\u662fubuntu/centos\u5747\u53ef\u4fee\u6539/etc/sysctl.conf \u627e\u5230fs.file-max\u8fd9\u4e00\u884c\uff0c\u4fee\u6539\u5176\u503c\u4e3a1024000\uff0c\u5e76\u4fdd\u5b58\u9000\u51fa\u3002\u7136\u540e\u6267\u884csysctl -p\u4f7f\u5176\u751f\u6548 \u4fee\u6539vi /etc/security/limits.conf\u6587\u4ef6\uff0c\u52a0\u5165 * soft nofile 512000 * hard nofile 1024000 \u9488\u5bf9centos,\u8fd8\u9700\u8981\u4fee\u6539vi /etc/pam.d/common-session\u6587\u4ef6\uff0c\u52a0\u5165 session required pam_limits.so 2 .\u4fee\u6539vi /etc/profile\u6587\u4ef6\uff0c\u52a0\u5165 ulimit -SHn 1024000 \u7136\u540e\u91cd\u542f\u670d\u52a1\u5668\u6267\u884culimit -n\uff0c\u67e5\u8be2\u8fd4\u56de1024000\u5373\u53ef\u3002 sysctl.conf\u62a5\u9519\u89e3\u51b3\u65b9\u6cd5 \u4fee\u590dmodprobe\u7684\uff1a rm -f /sbin/modprobe ln -s /bin/true /sbin/modprobe \u4fee\u590dsysctl\u7684\uff1a rm -f /sbin/sysctl ln -s /bin/true /sbin/sysctl 1 .3 \u9510\u901f \u9510\u901f\u662fTCP\u5e95\u5c42\u52a0\u901f\u8f6f\u4ef6,\u5b98\u65b9\u5df2\u505c\u6b62\u63a8\u51fa\u6c38\u4e45\u514d\u8d39\u7248\u672c,\u4f46\u7f51\u4e0a\u6709\u7834\u89e3\u7248\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u3002\u9700\u8981\u8d2d\u4e70\u7684\u8bdd\u5148\u5230\u9510\u901f\u5b98\u7f51\u6ce8\u518c\u5e10\u53f7,\u5e76\u786e\u8ba4\u5185\u6838\u7248\u672c\u662f\u5426\u652f\u6301\u9510\u901f\u7684\u7248\u672c\u3002 \u4e00\u952e\u5b89\u88c5\u901f\u9510\u7834\u89e3\u7248 wget -N --no-check-certificate https://github.com/91yun/serverspeeder/raw/master/serverspeeder.sh && bash serverspeeder.sh \u4e00\u952e\u5378\u8f7d chattr -i /serverspeeder/etc/apx* && /serverspeeder/bin/serverSpeeder.sh uninstall -f \u8bbe\u7f6e Enter your accelerated interface ( s ) [ eth0 ] : eth0 Enter your outbound bandwidth [ 1000000 kbps ] : 1000000 Enter your inbound bandwidth [ 1000000 kbps ] : 1000000 Configure shortRtt-bypass [ 0 ms ] : 0 Auto load ServerSpeeder on linux start-up? [ n ] :y #\u662f\u5426\u5f00\u673a\u81ea\u542f Run ServerSpeeder now? [ y ] :y #\u662f\u5426\u73b0\u5728\u542f\u52a8 \u6267\u884clsmod\uff0c\u770b\u5230\u6709appex0\u6a21\u5757\u5373\u8bf4\u660e\u9510\u901f\u5df2\u6b63\u5e38\u5b89\u88c5\u5e76\u542f\u52a8\u3002 \u81f3\u6b64\uff0c\u5b89\u88c5\u5c31\u7ed3\u675f\u4e86\uff0c\u4f46\u8fd8\u6709\u540e\u7eed\u914d\u7f6e\u3002 \u4fee\u6539vi /serverspeeder/etc/config\u6587\u4ef6\u7684\u51e0\u4e2a\u53c2\u6570\u4ee5\u4f7f\u9510\u901f\u66f4\u597d\u7684\u5de5\u4f5c accppp = \"1\" #\u52a0\u901fPPTP\u3001L2TP V-P-N\uff1b\u8bbe\u4e3a1\u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a0\u8868\u793a\u5173\u95ed advinacc = \"1\" #\u9ad8\u7ea7\u5165\u5411\u52a0\u901f\u5f00\u5173\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5f00\u542f\u6b64\u529f\u80fd\u53ef\u4ee5\u5f97\u5230\u66f4\u597d\u7684\u6d41\u5165\u65b9\u5411\u6d41\u91cf\u52a0\u901f\u6548\u679c\uff1b maxmode = \"1\" #\u6700\u5927\u4f20\u8f93\u6a21\u5f0f\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff1b\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5f00\u542f\u540e\u4f1a\u8fdb\u4e00\u6b65\u63d0\u9ad8\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u964d\u4f4e\u6709\u6548\u6570\u636e\u7387\u3002 rsc = \"1\" #\u7f51\u5361\u63a5\u6536\u7aef\u5408\u5e76\u5f00\u5173\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5728\u6709\u4e9b\u8f83\u65b0\u7684\u7f51\u5361\u9a71\u52a8\u4e2d\uff0c\u5e26\u6709 RSC \u7b97\u6cd5\u7684\uff0c\u9700\u8981\u6253\u5f00\u8be5\u529f\u80fd\u3002 l2wQLimit = \"512 4096\" #\u4ece LAN \u5230 WAN \u52a0\u901f\u5f15\u64ce\u5728\u7f13\u51b2\u6c60\u5145\u6ee1\u548c\u7a7a\u95f2\u65f6\u5206\u522b\u80fd\u591f\u7f13\u5b58\u7684\u6570\u636e\u5305\u961f\u5217\u7684\u957f\u5ea6\u7684\u4e0a\u9650\uff1b\u8be5\u503c\u8bbe\u7f6e\u7684\u9ad8\u4f1a\u83b7\u5f97\u66f4\u597d\u7684\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58 w2lQLimit = \"512 4096\" #\u4ece WAN \u5230 LAN \u52a0\u901f\u5f15\u64ce\u5728\u7f13\u51b2\u6c60\u5145\u6ee1\u548c\u7a7a\u95f2\u65f6\u5206\u522b\u80fd\u591f\u7f13\u5b58\u7684\u6570\u636e\u5305\u961f\u5217\u7684\u957f\u5ea6\u7684\u4e0a\u9650\uff1b\u8be5\u503c\u8bbe\u7f6e\u7684\u9ad8\u4f1a\u83b7\u5f97\u66f4\u597d\u7684\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58 \u91cd\u8bfb\u914d\u7f6e\u4ee5\u4f7f\u914d\u7f6e\u751f\u6548/serverspeeder/bin/serverSpeeder.sh reload \u67e5\u770b\u9510\u901f\u5f53\u524d\u72b6\u6001/serverspeeder/bin/serverSpeeder.sh stats \u67e5\u770b\u6240\u6709\u547d\u4ee4/serverspeeder/bin/serverSpeeder.sh help \u505c\u6b62/serverspeeder/bin/serverSpeeder.sh stop \u542f\u52a8/serverspeeder/bin/serverSpeeder.sh start \u91cd\u542f\u9510\u901f/serverspeeder/bin/serverSpeeder.sh restart 1 .4 \u5f00\u542fTCP Fast Open \u8fd9\u4e2a\u9700\u8981\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u90fd\u662fLinux 3 .7+\u7684\u5185\u6838\uff0c\u4e00\u822cLinux\u7684\u670d\u52a1\u5668\u53d1\u884c\u7248\u53ea\u6709debian jessie\u67093.7+\u7684\uff0c\u5ba2\u6237\u7aef\u7528Linux\u66f4\u662f\u73cd\u7a00\u52a8\u7269\uff0c\u6240\u4ee5\u8fd9\u4e2a\u4e0d\u591a\u8bf4\uff0c\u5982\u679c\u4f60\u7684\u670d\u52a1\u5668\u7aef\u548c\u5ba2\u6237\u7aef\u90fd\u662fLinux 3 .7+\u7684\u5185\u6838\uff0c\u90a3\u5c31\u5728\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684vi /etc/sysctl.conf\u6587\u4ef6\u4e2d\u518d\u52a0\u4e0a\u4e00\u884c\u3002 # turn on TCP Fast Open on both client and server side net.ipv4.tcp_fastopen = 3 \u7136\u540e\u628avi /etc/shadowsocks.json\u914d\u7f6e\u6587\u4ef6\u4e2d \"fast_open\" : false\u6539\u4e3a \"fast_open\" : true\u3002\u8fd9\u6837\u901f\u5ea6\u4e5f\u5c06\u4f1a\u6709\u975e\u5e38\u663e\u8457\u7684\u63d0\u5347\u3002 1 . \u52a0\u5bc6\u5c42\u9762 ####2.1 \u5b89\u88c5M2Crypto \u8fd9\u4e2a\u53ef\u4ee5\u63d0\u9ad8SS\u7684\u52a0\u5bc6\u901f\u5ea6\uff0c\u5b89\u88c5\u529e\u6cd5\uff1a Debian/Ubuntu apt-get install python-m2crypto \u5b89\u88c5\u4e4b\u540e\u91cd\u542fSS\uff0c\u901f\u5ea6\u5c06\u4f1a\u6709\u4e00\u5b9a\u7684\u63d0\u5347 CentOS \u5148\u5b89\u88c5\u4f9d\u8d56\u5305\uff1a yum install -y openssl-devel gcc swig python-devel autoconf libtool \u5b89\u88c5setuptools\uff1a wget --no-check-certificate https://raw.githubusercontent.com/iMeiji/shadowsocks_install/master/ez_setup.py python ez_setup.py install \u518d\u901a\u8fc7pip\u5b89\u88c5M2Crypto\uff1a pip install M2Crypto \u6216\u8005pip install M2Crypto --upgrade 2 .3 \u4f7f\u7528CHACHA20\u52a0\u5bc6\u7b97\u6cd5 \u9996\u5148\uff0c\u5b89\u88c5libsodium\uff0c\u8ba9\u7cfb\u7edf\u652f\u6301chacha20\u7b97\u6cd5\u3002 Debian/Ubuntu apt-get install build-essential wget https://download.libsodium.org/libsodium/releases/LATEST.tar.gz tar xf LATEST.tar.gz && cd libsodium* ./configure && make && make install \u8fd0\u884c\u547d\u4ee4:ldconfig CentOS yum groupinstall \"Development Tools\" wget https://download.libsodium.org/libsodium/releases/LATEST.tar.gz tar zxf LATEST.tar.gz cd libsodium* ./configure make make install vi /etc/ld.so.conf \u6dfb\u52a0\u4e00\u884c\uff1a /usr/local/lib \u4fdd\u5b58\u9000\u51fa\u540e\uff0c\u8fd0\u884c\u547d\u4ee4\uff1a ldconfig \u7136\u540e\u4fee\u6539ss\u52a0\u5bc6\u65b9\u5f0f\uff1a vi /etc/shadowsocks.json \"method\" : \"aes-256-cfb\" \u6539\u6210 \"method\" : \"chacha20\" ,\u91cd\u542fSS\u5373\u53ef/etc/init.d/shadowsocks restart 3 .\u7f51\u7edc\u5c42\u9762 \u6b64\u5916\uff0c\u9009\u62e9\u5408\u9002\u7684\u7aef\u53e3\u4e5f\u80fd\u4f18\u5316\u68af\u5b50\u7684\u901f\u5ea6\uff0c\u5e7f\u5927SS\u7528\u6237\u7684\u5b9e\u8df5\u7ecf\u9a8c\u8868\u660e\uff0c\u68c0\u67e5\u7ad9\uff08GFW\uff09\u5b58\u5728\u4e00\u79cd\u673a\u5236\u6765\u964d\u4f4e\u81ea\u8eab\u7684\u8fd0\u7b97\u538b\u529b\uff0c\u5373\u5e38\u7528\u7684\u534f\u8bae\u7aef\u53e3\uff08\u5982http\uff0csmtp\uff0cssh\uff0chttps\uff0cftp\u7b49\uff09\u7684\u68c0\u67e5\u8f83\u5c11\uff0c\u6240\u4ee5\u5efa\u8baeSS\u7ed1\u5b9a\u8fd9\u4e9b\u5e38\u7528\u7684\u7aef\u53e3\uff08\u5982\uff1a21\uff0c22\uff0c25\uff0c80\uff0c443\uff09\uff0c\u901f\u5ea6\u4e5f\u4f1a\u6709\u663e\u8457\u63d0\u5347\u3002 \u5982\u679c\u4f60\u8fd8\u8981\u7ed9\u5c0f\u4f19\u4f34\u722c\uff0c\u90a3\u6211\u5efa\u8bae\u5f00\u542f\u591a\u4e2a\u7aef\u53e3\u800c\u4e0d\u662f\u5171\u7528\uff0c\u8fd9\u6837\u7f51\u7edc\u4f1a\u66f4\u52a0\u987a\u7545\u3002 3 .1 \u9632\u706b\u5899\u8bbe\u7f6e\uff08\u5982\u6709\uff09 \u81ea\u52a8\u8c03\u6574MTU iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \u5f00\u542f NAT \uff08\u8bb0\u5f97\u628a eth0 \u6539\u6210\u81ea\u5df1\u7684\u7f51\u5361\u540d\uff0copenvz \u7684\u57fa\u672c\u662f venet0 \uff09 iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE \u5f00\u542f IPv4 \u7684\u8f6c\u53d1 sysctl -w net.ipv4.ip_forward = 1 \u6253\u5f00 443 \u7aef\u53e3 iptables -I INPUT -p tcp --dport 443 -j ACCEPT iptables -I INPUT -p udp --dport 443 -j ACCEPT \u91cd\u542f\u9632\u706b\u5899iptables\uff1a service iptables restart shadowsocks\u5b9a\u65f6\u811a\u672c \u00b6 #!/usr/bin/env bash #=================================================================# # System Required: CentOS, Debian, Ubuntu # # Description: Check Shadowsocks Server is running or not # # Author: Teddysun <i@teddysun.com> # # Visit: https://shadowsocks.be/6.html # #=================================================================# name =( Shadowsocks Shadowsocks-Python ShadowsocksR Shadowsocks-Go Shadowsocks-libev ) path = /var/log [[ ! -d ${ path } ]] && mkdir -p ${ path } log = ${ path } /shadowsocks-crond.log shadowsocks_init [ 0 ]= /etc/init.d/shadowsocks shadowsocks_init [ 1 ]= /etc/init.d/shadowsocks-python shadowsocks_init [ 2 ]= /etc/init.d/shadowsocks-r shadowsocks_init [ 3 ]= /etc/init.d/shadowsocks-go shadowsocks_init [ 4 ]= /etc/init.d/shadowsocks-libev i = 0 for init in ${ shadowsocks_init [@] } ; do pid = \"\" if [ -f ${ init } ] ; then ss_status = ` ${ init } status ` if [ $? -eq 0 ] ; then pid = ` echo $ss_status | sed 's/[^0-9]*//g' ` fi if [ -z ${ pid } ] ; then echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } is not running\" >> ${ log } echo \"`date +\" %Y-%m-%d %H:%M:%S \"` Starting ${ name [ $i ] } \" >> ${ log } ${ init } start & >/dev/null if [ $? -eq 0 ] ; then echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } start success\" >> ${ log } else echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } start failed\" >> ${ log } fi else echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } is running with pid $pid \" >> ${ log } fi fi (( i++ )) done PPTPD VPN\u670d\u52a1\u5668\u67b6\u8bbe \u00b6 \u4e00\u3001pptpd\u5b89\u88c5 1 .\u67e5\u770b\u662f\u5426\u5b89\u88c5\u4e86dkms: rpm -q dkms \u82e5\u672a\u5b89\u88c5\uff0c\u5219\uff1a rpm -ivh dkms-2.0.17.5-1.noarch.rpm, 2 .\u67e5\u770b\u662f\u5426\u652f\u6301ppp rpm -q ppp \u67e5\u770b\u5df2\u5b89\u88c5\u7684ppp\uff0c\u662f\u5426\u652f\u6301MPPE strings '/usr/sbin/pppd' | grep -i mppe | wc -l \u82e5\u7ed3\u679c\u663e\u793a\u4e3a0\u8868\u793a\u4e0d\u652f\u6301\uff0c\u663e\u793a\u4e00\u8f83\u5927\u7684\u6570\u8868\u793a\u652f\u6301 \u4e0d\u652f\u6301\u7684\u8bdd\uff0c\u4e0b\u9ad8\u7248\u672c\u5b89\u88c5 3 .\u67e5\u770bpptpd\u7248\u672c rpm -q pptpd \u82e5\u672a\u5b89\u88c5\uff0c\u5219\u5b89\u88c5 rpm -ivh pptpd-1.*.**.rpm 4 .\u786e\u4fddlinux\u5185\u6838\u652f\u6301MPPE\u52a0\u5bc6\u534f\u8bae \u5185\u6838\u7248\u672c\u4f4e\u4e8e2.6.14\u8981\u5b89\u88c5\u4e00MPPE\u5185\u6838\u8865\u4e01 rpm -ivh kernel-mppe-2.4.20-8.i686.rpm \u5b89\u88c5\u540e\u68c0\u67e5kernel MPPE\u662f\u5426\u5b89\u88c5\u6210\u529f # modprobe ppp-compress-18 && echo \"OK\" i386\u7248\u672c\u572864\u4f4d\u673a\u5668\u4e0a\u53ef\u4ee5\u88c5\uff0c\u4f46\u88c5\u5b8c\u540e\u62e8\u53f7\u4e0d\u80fd\u4f7f\u7528 \u914d\u7f6e /etc/pptpd.conf\u3001/ETC/PPP/OPTIONS.PPTPD ,/etc/ppp/chap-secrets\u4e09\u4e2a\u6587\u4ef6\u542b\u6709\u914d\u7f6e\u4fe1\u606f /etc/pptpd.conf\u4e2d\u914d\u7f6edebug\u4fe1\u606f\u3001ppp\u7ec4\u4ef6\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6\u3001localip\u548cremoteip localip\u662fVPN\u670d\u52a1\u5668\u7684\u5730\u5740\uff0cremoteip\u662fVPN\u670d\u52a1\u5668\u5206\u7ed9\u5ba2\u6237\u7aef\u7684IP ( \u53ef\u4ee5\u662f\u4e00\u4e2a\u7f51\u6bb5 ) debug------\u628a\u6240\u6709debug\u4fe1\u606f\u8bb0\u5165\u7cfb\u7edf\u65e5\u5fd7/var/log/messages option /etc/ppp/options.pptpd------------PPP\u7ec4\u4ef6\u5c06\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6 localip 221 .6.15.150--------------\u5206\u914d\u7ed9VPN\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u4efb\u610f\u8d77 remoteip 192 .168.1.1-100--VPN\u670d\u52a1\u5668\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684IP\u6bb5\uff0c\u53ef\u4ee5\u4efb\u610f\u8d77 /etc/ppp/options.pptpd \u914d\u7f6edns\u7b49 \u914d\u7f6e/etc/ppp/chap-secrets\u6587\u4ef6 chap-secrets\u6587\u4ef6\u4e2d\u89c4\u5b9a\u4e86\u5ba2\u6237\u7aef\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3001\u670d\u52a1\u7a0b\u5e8f\u3001IP\u5730\u5740 \u5982\uff1axyz * 123456 * \u201cxyx\u201d\u662fClient\u7aef\u7684VPN\u7528\u6237\u540d\uff1b\u201cserver\u201d\u5bf9\u5e94\u7684\u662fVPN\u670d\u52a1\u5668\u7684\u540d\u5b57\uff0c\u8be5\u540d\u5b57\u5fc5\u987b\u548c/etc/ppp/options.pptpd\u6587\u4ef6\u4e2d\u6307\u660e\u7684\u4e00\u6837\uff0c\u6216\u8005\u8bbe \u7f6e\u6210\u201c*\u201d\u53f7\u6765\u8868\u793a\u81ea\u52a8\u8bc6\u522b\u670d\u52a1\u5668\uff1b\u201csecret\u201d\u5bf9\u5e94\u7684\u662f\u767b\u5f55\u5bc6\u7801\uff1b\u201cIP addresses\u201d\u5bf9\u7684\u662f\u53ef\u4ee5\u62e8\u5165\u7684\u5ba2\u6237\u7aefIP\u5730\u5740\uff0c\u5982\u679c\u4e0d\u9700\u8981\u505a\u7279\u522b\u9650 \u5236\uff0c\u53ef\u4ee5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201c*\u201d\u53f7 \u8fde\u63a5\u6d4b\u8bd5 OPENVPN \u670d\u52a1\u5668\u67b6\u8bbe \u5b89\u88c5 \u5728\u7ebf\u5b89\u88c5. Yum \u2013y install openvpn* lzo* libpcap* \u914d\u7f6e \u590d\u5236\u6837\u672c\u6587\u4ef6\u5230\u4e3b\u76ee\u5f55 /etc/openvpn cp -a /usr/share/openvpn/easy-rsa/2.0/ /etc/openvpn/ \u590d\u5236\u6837\u672c\u914d\u7f6e\u6587\u4ef6\u5230\u4e3b\u76ee\u5f55 /etc/openvpn/ cp /usr/share/doc/openvpn-2.1/sample-config-files/server.conf /etc/openvpn source ./vars ./clean-all ./build-ca ./build-key-server server ./build-key client ./build-dh \u590d\u5236server keys cp /etc/openvpn/easy-rsa/2.0/keys/ca.* /etc/openvpn/ cp /etc/openvpn/easy-rsa/2.0/keys/server.* /etc/openvpn/ \u590d\u5236dh cp /etc/openvpn/easy-rsa/2.0/keys/dh1024.pem /etc/openvpn/ vi /etc/openvpn/server.conf ## http\u72b6\u6001\u7801 ``` markdown 1xx\uff08\u4e34\u65f6\u54cd\u5e94\uff09\u8868\u793a\u4e34\u65f6\u54cd\u5e94\u5e76\u9700\u8981\u8bf7\u6c42\u8005\u7ee7\u7eed\u6267\u884c\u64cd\u4f5c\u7684\u72b6\u6001\u4ee3\u7801\u3002 100 \uff08\u7ee7\u7eed\uff09\u8bf7\u6c42\u8005\u5e94\u5f53\u7ee7\u7eed\u63d0\u51fa\u8bf7\u6c42\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u8868\u793a\u5df2\u6536\u5230\u8bf7\u6c42\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u6b63\u5728\u7b49\u5f85\u5176\u4f59\u90e8\u5206\u3002 101 \uff08\u5207\u6362\u534f\u8bae\uff09\u8bf7\u6c42\u8005\u5df2\u8981\u6c42\u670d\u52a1\u5668\u5207\u6362\u534f\u8bae\uff0c\u670d\u52a1\u5668\u5df2\u786e\u8ba4\u5e76\u51c6\u5907\u5207\u6362\u3002 2xx \uff08\u6210\u529f\uff09\u8868\u793a\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\u7684\u72b6\u6001\u4ee3\u7801\u3002 200 \uff08\u6210\u529f\uff09\u670d\u52a1\u5668\u5df2\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\u3002\u901a\u5e38\uff0c\u8fd9\u8868\u793a\u670d\u52a1\u5668\u63d0\u4f9b\u4e86\u8bf7\u6c42\u7684\u7f51\u9875\u3002 201 \uff08\u5df2\u521b\u5efa\uff09\u8bf7\u6c42\u6210\u529f\u5e76\u4e14\u670d\u52a1\u5668\u521b\u5efa\u4e86\u65b0\u7684\u8d44\u6e90\u3002 202 \uff08\u5df2\u63a5\u53d7\uff09 \u670d\u52a1\u5668\u5df2\u63a5\u53d7\u8bf7\u6c42\uff0c\u4f46\u5c1a\u672a\u5904\u7406\u3002 203 \uff08\u975e\u6388\u6743\u4fe1\u606f\uff09\u670d\u52a1\u5668\u5df2\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u8fd4\u56de\u7684\u4fe1\u606f\u53ef\u80fd\u6765\u81ea\u53e6\u4e00\u6765\u6e90\u3002 204 \uff08\u65e0\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 205 \uff08\u91cd\u7f6e\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 206 \uff08\u90e8\u5206\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u90e8\u5206 GET \u8bf7\u6c42\u3002 3xx \uff08\u91cd\u5b9a\u5411\uff09\u8868\u793a\u8981\u5b8c\u6210\u8bf7\u6c42\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u64cd\u4f5c\u3002 \u901a\u5e38\uff0c\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u7528\u6765\u91cd\u5b9a\u5411\u3002 300 \uff08\u591a\u79cd\u9009\u62e9\uff09\u9488\u5bf9\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u53ef\u6267\u884c\u591a\u79cd\u64cd\u4f5c\u3002 \u670d\u52a1\u5668\u53ef\u6839\u636e\u8bf7\u6c42\u8005 ( user agent ) \u9009\u62e9\u4e00\u9879\u64cd\u4f5c\uff0c\u6216\u63d0\u4f9b\u64cd\u4f5c\u5217\u8868\u4f9b\u8bf7\u6c42\u8005\u9009\u62e9\u3002 301 \uff08\u6c38\u4e45\u79fb\u52a8\uff09\u8bf7\u6c42\u7684\u7f51\u9875\u5df2\u6c38\u4e45\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff08\u5bf9 GET \u6216 HEAD \u8bf7\u6c42\u7684\u54cd\u5e94\uff09\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u8bf7\u6c42\u8005\u8f6c\u5230\u65b0\u4f4d\u7f6e\u3002 302 \uff08\u4e34\u65f6\u79fb\u52a8\uff09\u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002 303 \uff08\u67e5\u770b\u5176\u4ed6\u4f4d\u7f6e\uff09\u8bf7\u6c42\u8005\u5e94\u5f53\u5bf9\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528\u5355\u72ec\u7684 GET \u8bf7\u6c42\u6765\u68c0\u7d22\u54cd\u5e94\u65f6\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 304 \uff08\u672a\u4fee\u6539\uff09\u81ea\u4ece\u4e0a\u6b21\u8bf7\u6c42\u540e\uff0c\u8bf7\u6c42\u7684\u7f51\u9875\u672a\u4fee\u6539\u8fc7\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\u65f6\uff0c\u4e0d\u4f1a\u8fd4\u56de\u7f51\u9875\u5185\u5bb9\u3002 305 \uff08\u4f7f\u7528\u4ee3\u7406\uff09\u8bf7\u6c42\u8005\u53ea\u80fd\u4f7f\u7528\u4ee3\u7406\u8bbf\u95ee\u8bf7\u6c42\u7684\u7f51\u9875\u3002 \u5982\u679c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff0c\u8fd8\u8868\u793a\u8bf7\u6c42\u8005\u5e94\u4f7f\u7528\u4ee3\u7406\u3002 307 \uff08\u4e34\u65f6\u91cd\u5b9a\u5411\uff09\u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002 4xx\uff08\u8bf7\u6c42\u9519\u8bef\uff09\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u8868\u793a\u8bf7\u6c42\u53ef\u80fd\u51fa\u9519\uff0c\u59a8\u788d\u4e86\u670d\u52a1\u5668\u7684\u5904\u7406\u3002 400 \uff08\u9519\u8bef\u8bf7\u6c42\uff09\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u8bf7\u6c42\u7684\u8bed\u6cd5\u3002 401 \uff08\u672a\u6388\u6743\uff09\u8bf7\u6c42\u8981\u6c42\u8eab\u4efd\u9a8c\u8bc1\u3002 \u5bf9\u4e8e\u9700\u8981\u767b\u5f55\u7684\u7f51\u9875\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 403 \uff08\u7981\u6b62\uff09\u670d\u52a1\u5668\u62d2\u7edd\u8bf7\u6c42\u3002 404 \uff08\u672a\u627e\u5230\uff09\u670d\u52a1\u5668\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u7f51\u9875\u3002 405 \uff08\u65b9\u6cd5\u7981\u7528\uff09\u7981\u7528\u8bf7\u6c42\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u3002 406 \uff08\u4e0d\u63a5\u53d7\uff09\u65e0\u6cd5\u4f7f\u7528\u8bf7\u6c42\u7684\u5185\u5bb9\u7279\u6027\u54cd\u5e94\u8bf7\u6c42\u7684\u7f51\u9875\u3002 407 \uff08\u9700\u8981\u4ee3\u7406\u6388\u6743\uff09\u6b64\u72b6\u6001\u4ee3\u7801\u4e0e 401 \uff08\u672a\u6388\u6743\uff09\u7c7b\u4f3c\uff0c\u4f46\u6307\u5b9a\u8bf7\u6c42\u8005\u5e94\u5f53\u6388\u6743\u4f7f\u7528\u4ee3\u7406\u3002 408 \uff08\u8bf7\u6c42\u8d85\u65f6\uff09\u670d\u52a1\u5668\u7b49\u5019\u8bf7\u6c42\u65f6\u53d1\u751f\u8d85\u65f6\u3002 409 \uff08\u51b2\u7a81\uff09\u670d\u52a1\u5668\u5728\u5b8c\u6210\u8bf7\u6c42\u65f6\u53d1\u751f\u51b2\u7a81\u3002 \u670d\u52a1\u5668\u5fc5\u987b\u5728\u54cd\u5e94\u4e2d\u5305\u542b\u6709\u5173\u51b2\u7a81\u7684\u4fe1\u606f\u3002 410 \uff08\u5df2\u5220\u9664\uff09\u5982\u679c\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u6c38\u4e45\u5220\u9664\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 411 \uff08\u9700\u8981\u6709\u6548\u957f\u5ea6\uff09\u670d\u52a1\u5668\u4e0d\u63a5\u53d7\u4e0d\u542b\u6709\u6548\u5185\u5bb9\u957f\u5ea6\u6807\u5934\u5b57\u6bb5\u7684\u8bf7\u6c42\u3002 412 \uff08\u672a\u6ee1\u8db3\u524d\u63d0\u6761\u4ef6\uff09\u670d\u52a1\u5668\u672a\u6ee1\u8db3\u8bf7\u6c42\u8005\u5728\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u7684\u5176\u4e2d\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\u3002 413 \uff08\u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\uff09\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\uff0c\u8d85\u51fa\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u3002 414 \uff08\u8bf7\u6c42\u7684 URI \u8fc7\u957f\uff09\u8bf7\u6c42\u7684 URI\uff08\u901a\u5e38\u4e3a\u7f51\u5740\uff09\u8fc7\u957f\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u3002 415 \uff08\u4e0d\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b\uff09\u8bf7\u6c42\u7684\u683c\u5f0f\u4e0d\u53d7\u8bf7\u6c42\u9875\u9762\u7684\u652f\u6301\u3002 416 \uff08\u8bf7\u6c42\u8303\u56f4\u4e0d\u7b26\u5408\u8981\u6c42\uff09\u5982\u679c\u9875\u9762\u65e0\u6cd5\u63d0\u4f9b\u8bf7\u6c42\u7684\u8303\u56f4\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u8fd4\u56de\u6b64\u72b6\u6001\u4ee3\u7801\u3002 417 \uff08\u672a\u6ee1\u8db3\u671f\u671b\u503c\uff09\u670d\u52a1\u5668\u672a\u6ee1\u8db3\u201d\u671f\u671b\u201d\u8bf7\u6c42\u6807\u5934\u5b57\u6bb5\u7684\u8981\u6c42\u3002 5xx\uff08\u670d\u52a1\u5668\u9519\u8bef\uff09\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u8868\u793a\u670d\u52a1\u5668\u5728\u5c1d\u8bd5\u5904\u7406\u8bf7\u6c42\u65f6\u53d1\u751f\u5185\u90e8\u9519\u8bef\u3002 \u8fd9\u4e9b\u9519\u8bef\u53ef\u80fd\u662f\u670d\u52a1\u5668\u672c\u8eab\u7684\u9519\u8bef\uff0c\u800c\u4e0d\u662f\u8bf7\u6c42\u51fa\u9519\u3002 500 \uff08\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\uff09\u670d\u52a1\u5668\u9047\u5230\u9519\u8bef\uff0c\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42\u3002 501 \uff08\u5c1a\u672a\u5b9e\u65bd\uff09\u670d\u52a1\u5668\u4e0d\u5177\u5907\u5b8c\u6210\u8bf7\u6c42\u7684\u529f\u80fd\u3002 \u4f8b\u5982\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u8bc6\u522b\u8bf7\u6c42\u65b9\u6cd5\u65f6\u53ef\u80fd\u4f1a\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 502 \uff08\u9519\u8bef\u7f51\u5173\uff09\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u65e0\u6548\u54cd\u5e94\u3002 503 \uff08\u670d\u52a1\u4e0d\u53ef\u7528\uff09\u670d\u52a1\u5668\u76ee\u524d\u65e0\u6cd5\u4f7f\u7528\uff08\u7531\u4e8e\u8d85\u8f7d\u6216\u505c\u673a\u7ef4\u62a4\uff09\u3002 \u901a\u5e38\uff0c\u8fd9\u53ea\u662f\u6682\u65f6\u72b6\u6001\u3002 504 \uff08\u7f51\u5173\u8d85\u65f6\uff09\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4f46\u662f\u6ca1\u6709\u53ca\u65f6\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u3002 505 \uff08HTTP \u7248\u672c\u4e0d\u53d7\u652f\u6301\uff09\u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u4e2d\u6240\u7528\u7684 HTTP \u534f\u8bae\u7248\u672c\u3002 RFC 6585 \u6700\u8fd1\u521a\u521a\u53d1\u5e03\uff0c\u8be5\u6587\u6863\u63cf\u8ff0\u4e86 4 \u4e2a\u65b0\u7684 HTTP \u72b6\u6001\u7801\u3002 HTTP \u534f\u8bae\u4e00\u76f4\u5728\u6f14\u53d8\uff0c\u65b0\u7684\u72b6\u6001\u7801\u5bf9\u4e8e\u5f00\u53d1 REST \u670d\u52a1\u6216\u8005\u8bf4\u662f\u57fa\u4e8e HTTP \u7684\u670d\u52a1\u975e\u5e38\u6709\u7528\uff0c\u4e0b\u9762\u8fd9\u56db\u4e2a\u65b0\u7684\u72b6\u6001\u7801\u4ee5\u53ca\u662f\u5426\u5e94\u8be5\u4f7f\u7528\u3002 428 Precondition Required ( \u8981\u6c42\u5148\u51b3\u6761\u4ef6 ) \u5148\u51b3\u6761\u4ef6\u662f\u5ba2\u6237\u7aef\u53d1\u9001 HTTP \u8bf7\u6c42\u65f6\uff0c\u5982\u679c\u60f3\u8981\u8bf7\u6c42\u80fd\u6210\u529f\u5fc5\u987b\u6ee1\u8db3\u4e00\u4e9b\u9884\u8bbe\u7684\u6761\u4ef6\u3002 \u4e00\u4e2a\u597d\u7684\u4f8b\u5b50\u5c31\u662f If-None-Match \u5934\uff0c\u7ecf\u5e38\u5728 GET \u8bf7\u6c42\u4e2d\u4f7f\u7528\uff0c\u5982\u679c\u6307\u5b9a\u4e86 If-None-Match \uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u53ea\u5728\u54cd\u5e94\u4e2d\u7684 ETag \u6539\u53d8\u540e\u624d\u4f1a\u91cd\u65b0\u63a5\u6536\u56de\u5e94\u3002 \u5148\u51b3\u6761\u4ef6\u7684\u53e6\u5916\u4e00\u4e2a\u4f8b\u5b50\u5c31\u662f If-Match \u5934\uff0c\u8fd9\u4e2a\u4e00\u822c\u7528\u5728 PUT \u8bf7\u6c42\u4e0a\u7528\u4e8e\u6307\u793a\u53ea\u66f4\u65b0\u6ca1\u88ab\u6539\u53d8\u7684\u8d44\u6e90\uff0c\u8fd9\u5728\u591a\u4e2a\u5ba2\u6237\u7aef\u4f7f\u7528 HTTP \u670d\u52a1\u65f6\u7528\u6765\u9632\u6b62\u5f7c\u6b64\u95f4\u4e0d\u4f1a\u8986\u76d6\u76f8\u540c\u5185\u5bb9\u3002 \u5f53\u670d\u52a1\u5668\u7aef\u4f7f\u7528 428 Precondition Required \u72b6\u6001\u7801\u65f6\uff0c\u8868\u793a\u5ba2\u6237\u7aef\u5fc5\u987b\u53d1\u9001\u4e0a\u8ff0\u7684\u8bf7\u6c42\u5934\u624d\u80fd\u6267\u884c\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u4e00\u79cd\u6709\u6548\u7684\u65b9\u6cd5\u6765\u963b\u6b62 'lost update' \u95ee\u9898\u3002 429 Too Many Requests ( \u592a\u591a\u8bf7\u6c42 ) \u5f53\u4f60\u9700\u8981\u9650\u5236\u5ba2\u6237\u7aef\u8bf7\u6c42\u67d0\u4e2a\u670d\u52a1\u6570\u91cf\u65f6\uff0c\u8be5\u72b6\u6001\u7801\u5c31\u5f88\u6709\u7528\uff0c\u4e5f\u5c31\u662f\u8bf7\u6c42\u901f\u5ea6\u9650\u5236\u3002 \u5728\u6b64\u4e4b\u524d\uff0c\u6709\u4e00\u4e9b\u7c7b\u4f3c\u7684\u72b6\u6001\u7801\uff0c\u4f8b\u5982 '509 Bandwidth Limit Exceeded' . Twitter \u4f7f\u7528 420 \uff08\u8fd9\u4e0d\u662fHTTP\u5b9a\u4e49\u7684\u72b6\u6001\u7801\uff09 \u5982\u679c\u4f60\u5e0c\u671b\u9650\u5236\u5ba2\u6237\u7aef\u5bf9\u670d\u52a1\u7684\u8bf7\u6c42\u6570\uff0c\u53ef\u4f7f\u7528 429 \u72b6\u6001\u7801\uff0c\u540c\u65f6\u5305\u542b\u4e00\u4e2a Retry-After \u54cd\u5e94\u5934\u7528\u4e8e\u544a\u8bc9\u5ba2\u6237\u7aef\u591a\u957f\u65f6\u95f4\u540e\u53ef\u4ee5\u518d\u6b21\u8bf7\u6c42\u670d\u52a1\u3002 431 Request Header Fields Too Large ( \u8bf7\u6c42\u5934\u5b57\u6bb5\u592a\u5927 ) \u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u53d1\u9001 HTTP \u8bf7\u6c42\u5934\u4f1a\u53d8\u5f97\u5f88\u5927\uff0c\u90a3\u4e48\u670d\u52a1\u5668\u53ef\u53d1\u9001 431 Request Header Fields Too Large \u6765\u6307\u660e\u8be5\u95ee\u9898\u3002 511 Network Authentication Required ( \u8981\u6c42\u7f51\u7edc\u8ba4\u8bc1 ) \u5bf9\u6211\u6765\u8bf4\u8fd9\u4e2a\u72b6\u6001\u7801\u5f88\u6709\u8da3\uff0c\u5982\u679c\u4f60\u5728\u5f00\u53d1\u4e00\u4e2a HTTP \u670d\u52a1\u5668\uff0c\u4f60\u4e0d\u4e00\u5b9a\u9700\u8981\u5904\u7406\u8be5\u72b6\u6001\u7801\uff0c\u4f46\u5982\u679c\u4f60\u5728\u7f16\u5199 HTTP \u5ba2\u6237\u7aef\uff0c\u90a3\u8fd9\u4e2a\u72b6\u6001\u7801\u5c31\u975e\u5e38\u91cd\u8981 SipCode \u00b6 1 xx = \u901a\u77e5\u6027\u5e94\u7b54 100 \u6b63\u5728\u5c1d\u8bd5 180 \u6b63\u5728\u62e8\u6253 181 \u6b63\u88ab\u8f6c\u63a5 182 \u6b63\u5728\u6392\u961f 183 \u901a\u8bdd\u8fdb\u5c55 2 xx = \u6210\u529f\u5e94\u7b54 200 OK 202 \u88ab\u63a5\u53d7\uff1a\u7528\u4e8e\u8f6c\u4ecb 3 xx = \u8f6c\u63a5\u5e94\u7b54 300 \u591a\u9879\u9009\u62e9 301 \u88ab\u6c38\u4e45\u8fc1\u79fb 302 \u88ab\u6682\u65f6\u8fc1\u79fb 305 \u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668 380 \u66ff\u4ee3\u670d\u52a1 4 xx = \u547c\u53eb\u5931\u8d25 400 \u547c\u53eb\u4e0d\u5f53 401 \u672a\u7ecf\u6388\u6743\uff1a\u53ea\u4f9b\u6ce8\u518c\u673a\u6784\u4f7f\u7528\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u5e94\u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668\u6388\u6743 407 402 \u8981\u6c42\u4ed8\u8d39\uff08\u9884\u8ba2\u4e3a\u5c06\u6765\u4f7f\u7528 ) 403 \u88ab\u7981\u6b62\u7684 404 \u672a\u53d1\u73b0\uff1a\u672a\u53d1\u73b0\u7528\u6237 405 \u4e0d\u5141\u8bb8\u7684\u65b9\u6cd5 406 \u4e0d\u53ef\u63a5\u53d7 407 \u9700\u8981\u4ee3\u7406\u670d\u52a1\u5668\u6388\u6743 408 \u547c\u53eb\u8d85\u65f6\uff1a\u5728\u9884\u5b9a\u65f6\u95f4\u5185\u65e0\u6cd5\u627e\u5230\u7528\u6237 410 \u5df2\u6d88\u5931\uff1a\u7528\u6237\u66fe\u7ecf\u5b58\u5728\uff0c\u4f46\u5df2\u4ece\u6b64\u5904\u6d88\u5931 413 \u547c\u53eb\u5b9e\u4f53\u8fc7\u5927 414 \u547c\u53eb URI\u8fc7\u957f 415 \u4e0d\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b 416 \u4e0d\u652f\u6301\u7684 URI\u65b9\u6848 420 \u4e0d\u5f53\u6269\u5c55\uff1a\u4f7f\u7528\u4e86\u4e0d\u5f53 SIP\u534f\u8bae\u6269\u5c55 \uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u7406\u89e3\u8be5\u6269\u5c55 421 \u9700\u8981\u6269\u5c55 423 \u65f6\u95f4\u95f4\u9694\u8fc7\u77ed 480 \u6682\u65f6\u4e0d\u53ef\u4f7f\u7528 481 \u901a\u8bdd / \u4e8b\u52a1\u4e0d\u5b58\u5728 482 \u68c0\u6d4b\u5230\u5faa\u73af 483 \u8df3\u6570\u8fc7\u591a 484 \u5730\u5740\u4e0d\u5168 485 \u6a21\u7cca\u4e0d\u6e05 486 \u6b64\u5904\u592a\u5fd9 487 \u547c\u53eb\u88ab\u7ec8\u6b62 488 \u6b64\u5904\u4e0d\u53ef\u63a5\u53d7 491 \u547c\u53eb\u5f85\u6279 493 \u65e0\u6cd5\u89e3\u8bfb\uff1a\u65e0\u6cd5\u89e3\u8bfb S / MIME\u6587\u4f53\u90e8\u5206 5 xx = \u670d\u52a1\u5668\u5931\u8d25 500 \u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef 501 \u65e0\u6cd5\u5b9e\u65bd\uff1a SIP\u547c\u53eb\u65b9\u6cd5\u5728\u6b64\u5904\u65e0\u6cd5\u5b9e\u65bd 502 \u4e0d\u5f53\u7f51\u5173 503 \u670d\u52a1\u4e0d\u53ef\u4f7f\u7528 504 \u670d\u52a1\u5668\u8d85\u65f6 505 \u4e0d\u652f\u6301\u8be5\u7248\u672c\uff1a\u670d\u52a1\u5668\u4e0d\u652f\u6301 SIP\u534f\u8bae\u7684\u8fd9\u4e2a\u7248\u672c 513 \u6d88\u606f\u8fc7\u957f 6 xx = \u5168\u5c40\u5931\u8d25 600 \u5404\u5904\u5747\u5fd9 603 \u62d2\u7edd 604 \u65e0\u5904\u5b58\u5728 606 \u4e0d\u53ef\u4f7f\u7528 SIP\u534f\u8bae\u5e94\u7b54\u7801 \u00b6 \u5e94\u7b54\u7801\u662f\u5305\u542b\u4e86\uff0c\u5e76\u4e14\u6269\u5c55\u4e86 HTTP / 1 . 1 \u5e94\u7b54\u7801\u3002\u5e76\u4e0d\u662f\u6240\u6709\u7684 HTTP / 1 . 1 \u5e94\u7b54\u7801\u90fd\u9002\u5f53\u5e94\u7528\uff0c\u53ea\u6709\u5728\u6298\u91cc\u6307\u51fa\u7684\u662f\u9002\u5f53\u7684\u3002\u5176\u4ed6 HTTP / 1 . 1 \u5e94\u7b54\u7801\u4e0d\u5e94\u5f53\u4f7f\u7528\u3002\u5e76\u4e14\uff0c SIP \u4e5f\u5b9a\u4e49\u4e86\u65b0\u7684\u5e94\u7b54\u7801\u7cfb\u5217\uff0c 6 xx \u3002 1 \u4e34\u65f6\u5e94\u7b54 1 xx \u4e34\u65f6\u5e94\u7b54\uff0c\u4e5f\u5c31\u662f\u6d88\u606f\u6027\u8d28\u7684\u5e94\u7b54\uff0c\u6807\u5fd7\u4e86\u5bf9\u65b9\u670d\u52a1\u5668\u6b63\u5728\u5904\u7406\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd8\u6ca1\u6709\u51b3\u5b9a\u6700\u540e\u7684\u5e94\u7b54\u3002\u5982\u679c\u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\u9700\u8981\u82b1 200 ms \u4ee5\u4e0a\u624d\u80fd\u4ea7\u751f\u7ec8\u7ed3\u5e94\u7b54\u7684\u65f6\u5019\uff0c\u5b83\u5e94\u5f53\u53d1\u9001\u4e00\u4e2a 1 xx \u5e94\u7b54\u3002 \u6ce8\u610f 1 xx \u5e94\u7b54\u5e76\u4e0d\u662f\u53ef\u9760\u4f20\u8f93\u7684\u3002\u4ed6\u4eec\u4e0d\u4f1a\u5bfc\u81f4\u5ba2\u6237\u7aef\u4f20\u9001\u4e00\u4e2a ACK \u5e94\u7b54\u3002\u4e34\u65f6\u6027\u8d28\u7684\uff08 1 xx \uff09\u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u6d88\u606f\u4f53\uff0c\u5305\u542b\u4f1a\u8bdd\u63cf\u8ff0\u3002 1 . 1 100 Trying \u8fd9\u4e2a\u5e94\u7b54\u8868\u793a\u4e0b\u4e00\u4e2a\u8282\u70b9\u7684\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u8fd9\u4e2a\u8bf7\u6c42\u5e76\u4e14\u8fd8\u6ca1\u6709\u6267\u884c\u8fd9\u4e2a\u8bf7\u6c42\u7684\u7279\u5b9a\u52a8\u4f5c\uff08\u6bd4\u5982\uff0c\u6b63\u5728\u6253\u5f00\u6570\u636e\u5e93\u7684\u65f6\u5019\uff09\u3002\u8fd9\u4e2a\u5e94\u7b54\uff0c\u5c31\u50cf\u5176\u4ed6\u4e34\u65f6\u5e94\u7b54\u4e00\u6837\uff0c\u79cd\u690d\u4e86 UAC \u91cd\u65b0\u4f20\u9001 INVITE \u8bf7\u6c42\u3002 100 ( Trying ) \u5e94\u7b54\u548c\u5176\u4ed6\u4e34\u65f6\u5e94\u7b54\u4e0d\u540c\u7684\u662f\uff0c\u5728\u8fd9\u91cc\uff0c\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6709\u72b6\u6001 proxy \u8f6c\u53d1\u5230\u4e0a\u884c\u6d41\u4e2d\u3002 1 . 2 180 Ringing UA \u6536\u5230 INVITE \u8bf7\u6c42\u5e76\u4e14\u8bd5\u56fe\u63d0\u793a\u7ed9\u7528\u6237\u3002\u8fd9\u4e2a\u5e94\u7b54\u5e94\u5f53\u51fa\u4e16\u5316\u4e00\u4e2a\u672c\u5730\u56de\u94c3\u3002 1 . 3 818 Call is Being Forwarded ( \u547c\u53eb\u88ab\u8f6c\u53d1 ) \u670d\u52a1\u5668\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5e94\u7b54\u4ee3\u7801\u6765\u8868\u793a\u547c\u53eb\u6b63\u5728\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2a\u76ee\u7684\u5730\u96c6\u5408\u3002 1 . 4 182 Queued \u5f53\u547c\u53eb\u7684\u5bf9\u65b9\u6682\u65f6\u4e0d\u80fd\u63a5\u6536\u547c\u53eb\u7684\u65f6\u5019\uff0c\u5e76\u4e14\u670d\u52a1\u5668\u51b3\u5b9a\u5c06\u547c\u53eb\u6392\u961f\u7b49\u5019\uff0c\u800c\u4e0d\u662f\u62d2\u7edd\u547c\u53eb\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u5c31\u5e94\u5f53\u53d1\u51fa\u8fd9\u4e2a\u5e94\u7b54\u3002\u5f53\u88ab\u53eb\u65b9\u4e00\u65e6\u6062\u590d\u63a5\u6536\u547c\u53eb\uff0c\u4ed6\u4f1a\u8fd4\u56de\u5408\u9002\u7684\u7ec8\u7ed3\u5e94\u7b54\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u547c\u53eb\u72b6\u6001\uff0c\u53ef\u4ee5\u6709\u4e00\u4e2a\u8868\u793a\u539f\u56e0\u7684\u77ed\u8bed\uff0c\u6bd4\u5982\uff1a\u201d 5 calls queued ;expected waiting time is 15minutes\u201d\u3002\u670d\u52a1\u5668\u53ef\u4ee5\u7ed9\u51fa\u597d\u51e0\u4e2a182\uff08Queued\uff09\u5e94\u7b54\u544a\u8bc9\u547c\u53eb\u65b9\u6392\u961f\u7684\u60c5\u51b5\uff08\u6bd4\u5982\u6392\u961f\u9760\u524d\u4e86\u7b49\u7b49\uff09\u3002 1 . 5 183 \u4f1a\u8bdd\u8fdb\u5ea6 183 \uff08 Session Progress \uff09\u5e94\u7b54\u7528\u4e8e\u63d0\u793a\u5efa\u7acb\u5bf9\u8bdd\u7684\u8fdb\u5ea6\u4fe1\u606f\u3002 Reason - Phrase \uff08\u8868\u8fbe\u539f\u56e0\u7684\u53e5\u5b50\uff09\u3001\u5934\u57df\u6216\u8005\u6d88\u606f\u4f53\u53ef\u4ee5\u7528\u4e8e\u63d0\u793a\u547c\u53eb\u8fdb\u5ea6\u7684\u66f4\u6d88\u606f\u7684\u4fe1\u606f\u3002 2 \u6210\u529f\u4fe1\u606f 2 xx \u8fd9\u4e2a\u5e94\u7b54\u8868\u793a\u8bf7\u6c42\u662f\u6210\u529f\u7684\u3002 2 . 1 200 OK \u8bf7\u6c42\u5df2\u7ecf\u5904\u7406\u6210\u529f\u3002\u8fd9\u4e2a\u4fe1\u606f\u53d6\u51b3\u4e8e\u4e0d\u540c\u65b9\u6cd5\u7684\u8bf7\u6c42\u7684\u5e94\u7b54\u3002 3 \u8f6c\u53d1\u8bf7\u6c42 3 XX 3 xx \u7cfb\u5217\u7684\u5e94\u7b54\u662f\u7528\u4e8e\u63d0\u793a\u7528\u6237\u7684\u65b0\u4f4d\u7f6e\u4fe1\u606f\u7684\uff0c\u6216\u8005\u4e3a\u4e86\u6ee1\u8db3\u547c\u53eb\u800c\u8f6c\u53d1\u7684\u989d\u5916\u670d\u52a1\u5730\u70b9\u3002 3 . 1 300 Multiple Choices \u8bf7\u6c42\u7684\u5730\u5740\u6709\u591a\u4e2a\u9009\u62e9\uff0c\u6bcf\u4e2a\u9009\u62e9\u90fd\u6709\u81ea\u5df1\u7684\u5730\u5740\uff0c\u7528\u6237\u6216\u8005\uff08 UA \uff09\u53ef\u4ee5\u9009\u62e9\u5408\u9002\u7684\u901a\u8baf\u7ec8\u7aef\uff0c\u5e76\u4e14\u8f6c\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u5230\u8fd9\u4e2a\u5730\u5740\u3002 \u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u5177\u6709\u6bcf\u4e00\u4e2a\u5730\u70b9\u7684\u5728 Accept \u8bf7\u6c42\u5934\u57df\u4e2d\u5141\u8bb8\u7684\u8d44\u6e90\u7279\u6027\uff0c\u8fd9\u6837\u7528\u6237\u6216\u8005 UA \u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u6700\u5408\u9002\u7684\u5730\u5740\u6765\u8f6c\u53d1\u8bf7\u6c42\u3002\u6ca1\u6709\u672a\u8fd9\u4e2a\u5e94\u7b54\u7684\u6d88\u606f\u4f53\u5b9a\u4e49 MIME \u7c7b\u578b\u3002 \u8fd9\u4e9b\u5730\u5740\u9009\u62e9\u4e5f\u5e94\u5f53\u5728 Contact \u5934\u57df\u4e2d\u5217\u51fa\uff08 20 . 10 \u8282\uff09\u3002\u4e0d\u540c\u4e8e HTTP \uff0c SIP \u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u591a\u4e2a Contact \u5934\u57df\u6216\u8005\u4e00\u4e2a Contact \u5934\u57df\u4e2d\u5177\u6709\u4e00\u4e2a\u5730\u5740\u5217\u8868\u3002 UA \u53ef\u4ee5\u4f7f\u7528 Contact \u5934\u57df\u6765\u81ea\u52a8\u8f6c\u53d1\u6216\u8005\u8981\u6c42\u7528\u6237\u786e\u8ba4\u8f6c\u53d1\u3002\u4e0d\u8fc7\uff0c\u672c\u89c4\u8303\u6ca1\u6709\u5b9a\u4e49\u81ea\u52a8\u8f6c\u53d1\u7684\u6807\u51c6\u3002 \u5982\u679c\u88ab\u53eb\u65b9\u53ef\u4ee5\u5728\u591a\u4e2a\u5730\u5740\u88ab\u627e\u5230\uff0c\u5e76\u4e14\u670d\u52a1\u5668\u4e0d\u80fd\u6216\u8005\u4e0d\u613f\u610f\u8f6c\u53d1\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u6765\u7ed9\u547c\u53eb\u65b9\u3002 3 . 2 301 Moved Permently \u5f53\u4e0d\u80fd\u5728 Request - URI \u6307\u5b9a\u7684\u5730\u5740\u627e\u5230\u7528\u6237\u7684\u65f6\u5019\uff0c\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u5e94\u5f53\u4f7f\u7528 Contact \u5934\u57df ( 20 . 10 ) \u6240\u6307\u51fa\u7684\u65b0\u7684\u5730\u5740\u91cd\u65b0\u5c1d\u8bd5\u3002\u8bf7\u6c42\u8005\u5e94\u5f53\u7528\u8fd9\u4e2a\u65b0\u7684\u503c\u6765\u66f4\u65b0\u672c\u5730\u7684\u76ee\u5f55\uff0c\u5730\u5740\u672c\uff0c\u548c\u7528\u6237\u5730\u5740 cache \uff0c\u5e76\u4e14\u5728\u540e\u7eed\u8bf7\u6c42\u4e2d\uff0c\u53d1\u9001\u5230\u8fd9\u4e2a / \u8fd9\u4e9b\u5217\u51fa\u7684\u5730\u5740\u3002 3 . 3 302 Moved Temporarily \u8bf7\u6c42\u65b9\u5e94\u5f53\u628a\u8bf7\u6c42\u91cd\u65b0\u53d1\u5230\u8fd9\u4e2a Contact \u5934\u57df\u6240\u6307\u51fa\u7684\u65b0\u5730\u5740 ( 20 . 10 ) \u3002\u65b0\u8bf7\u6c42\u7684 Request - URI \u5e94\u5f53\u7528\u8fd9\u4e2a\u5e94\u7b54\u7684 Contact \u5934\u57df\u6240\u6307\u51fa\u7684\u503c\u3002 \u5728\u5e94\u7b54\u4e2d\u7684 Expires ( 20 . 19 \u8282 ) \u6216\u8005 Contact \u5934\u57df\u7684 expires \u53c2\u6570\u5b9a\u4e49\u4e86\u8fd9\u4e2a Contact URI \u7684\u751f\u5b58\u5468\u671f\u3002 UA \u6216\u8005 proxy \u5728\u8fd9\u4e2a\u751f\u5b58\u5468\u671f\u5185 cache \u8fd9\u4e2a URI \u3002\u5982\u679c\u6ca1\u6709\u4e25\u683c\u7684\u6709\u6548\u65f6\u89c1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5730\u5740\u4ec5\u4ec5\u672c\u6b21\u6709\u6548\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u4ee5\u540e\u7684\u4e8b\u52a1\u4e2d\u4fdd\u5b58\u3002 \u5982\u679c cache \u7684 Contact \u5934\u57df\u7684\u503c\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u88ab\u8f6c\u53d1\u8bf7\u6c42\u7684 Request - URI \u5e94\u5f53\u518d\u6b21\u5c1d\u8bd5\u4e00\u6b21\u3002\u4e34\u65f6 URI \u53ef\u4ee5\u6bd4\u8d85\u65f6\u65f6\u95f4\u66f4\u5feb\u7684\u5931\u6548\uff0c\u5e76\u4e14\u53ef\u4ee5\u6709\u4e00\u4e2a\u65b0\u7684\u4e34\u65f6 URI \u3002 3 . 4 305 Use Proxy \u8bf7\u6c42\u7684\u8d44\u6e90\u5fc5\u987b\u901a\u8fc7 Contact \u5934\u57df\u4e2d\u6307\u51fa\u7684 proxy \u6765\u8bbf\u95ee\u3002 Contact \u5934\u57df\u6307\u5b9a\u4e86\u4e00\u4e2a proxy \u7684 URI \u3002\u63a5\u6536\u5230\u8fd9\u4e2a\u5e94\u7b54\u7684\u5bf9\u8c61\u5e94\u5f53\u901a\u8fc7\u8fd9\u4e2a proxy \u91cd\u65b0\u53d1\u9001\u8fd9\u4e2a\u5355\u4e2a\u8bf7\u6c42\u3002 305 \uff08 UseProxy \uff09\u5fc5\u987b\u662f UAS \u4ea7\u751f\u7684\u3002 3 . 5 380 Alternative Service \u547c\u53eb\u4e0d\u6210\u5de5\uff0c\u4f46\u662f\u53ef\u4ee5\u5c1d\u8bd5\u53e6\u5916\u7684\u670d\u52a1\u3002\u53e6\u5916\u7684\u670d\u52a1\u5728\u5e94\u7b54\u7684\u6d88\u606f\u4f53\u4e2d\u5b9a\u4e49\u3002\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u5728\u8fd9\u91cc\u6ca1\u6709\u5b9a\u4e49\uff0c\u53ef\u80fd\u5728\u4ee5\u540e\u7684\u89c4\u8303\u4e2d\u5b9a\u4e49\u3002 4 \u8bf7\u6c42\u5931\u8d25 4 xx 4 xx \u5e94\u7b54\u5b9a\u4e49\u4e86\u7279\u5b9a\u670d\u52a1\u5668\u54cd\u5e94\u7684\u8bf7\u6c42\u5931\u8d25\u7684\u60c5\u51b5\u3002\u5ba2\u6237\u7aef\u4e0d\u5e94\u5f53\u5728\u4e0d\u66f4\u6539\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\u91cd\u65b0\u5c1d\u8bd5\u540c\u4e00\u4e2a\u8bf7\u6c42\u3002\uff08\u4f8b\u5982\uff0c\u589e\u52a0\u5408\u9002\u7684\u8ba4\u8bc1\u4fe1\u606f\uff09\u3002\u4e0d\u8fc7\uff0c\u540c\u4e00\u4e2a\u8bf7\u6c42\u4ea4\u7ed9\u4e0d\u540c\u670d\u52a1\u5668\u4e5f\u8bb8\u5c31\u4f1a\u6210\u529f\u3002 4 . 1 400 Bad Request \u8bf7\u6c42\u4e2d\u7684\u8bed\u6cd5\u9519\u8bef\u3002 Reason - Phrase \u5e94\u5f53\u6807\u5fd7\u8fd9\u4e2a\u8be6\u7ec6\u7684\u8bed\u6cd5\u9519\u8bef\uff0c\u6bd4\u5982\u201d Missing Call - ID header field \u201d\u3002 4 . 2 401 Unauthorized \u8bf7\u6c42\u9700\u8981\u7528\u6237\u8ba4\u8bc1\u3002\u8fd9\u4e2a\u5e94\u7b54\u662f\u7531 UAS \u548c\u6ce8\u518c\u670d\u52a1\u5668\u4ea7\u751f\u7684\uff0c\u5f53 407 \uff08 Proxy Authentication Required \uff09\u662f proxy \u670d\u52a1\u5668\u4ea7\u751f\u7684\u3002 4 . 3 402 Payment Required \u4fdd\u7559 / \u4ee5\u540e\u4f7f\u7528 4 . 4 403 Forbidden \u670d\u52a1\u7aef\u652f\u6301\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u62d2\u7edd\u6267\u884c\u8bf7\u6c42\u3002\u589e\u52a0\u9a8c\u8bc1\u4fe1\u606f\u662f\u6ca1\u6709\u5fc5\u8981\u7684\uff0c\u5e76\u4e14\u8bf7\u6c42\u5e94\u5f53\u4e0d\u88ab\u91cd\u8bd5\u3002 4 . 5 404 Not Found \u670d\u52a1\u5668\u8fd4\u56de\u6700\u7ec8\u4fe1\u606f\uff1a\u7528\u6237\u5728 Request - URI \u6307\u5b9a\u7684\u57df\u4e0a\u4e0d\u5b58\u5728\u3002\u5f53 Request - URI \u7684 domain \u548c\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u7684 domain \u4e0d\u5339\u914d\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u4f1a\u4ea7\u751f\u8fd9\u4e2a\u5e94\u7b54\u3002 4 . 6 405 Method Not Allowed \u670d\u52a1\u5668\u652f\u6301 Request - Line \u4e2d\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5bf9\u4e8e\u8fd9\u4e2a Request - URI \u4e2d\u7684\u5730\u5740\u6765\u8bf4\uff0c\u662f\u4e0d\u5141\u8bb8\u5e94\u7528\u8fd9\u4e2a\u65b9\u6cd5\u7684\u3002 \u5e94\u7b54\u5fc5\u987b\u5305\u62ec\u4e00\u4e2a Allow \u5934\u57df\uff0c\u8fd9\u4e2a\u5934\u57df\u5305\u542b\u4e86\u6307\u5b9a\u5730\u5740\u5141\u8bb8\u7684\u65b9\u6cd5\u5217\u8868\u3002 4 . 7 Not Acceptable \u8bf7\u6c42\u4e2d\u7684\u8d44\u6e90\u53ea\u4f1a\u5bfc\u81f4\u4ea7\u751f\u4e00\u4e2a\u5728\u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u5916\u7684\uff0c\u5185\u5bb9\u65e0\u6cd5\u63a5\u6536\u7684\u9519\u8bef\u3002 4 . 8 407 Proxy Authentication Required \u8fd9\u4e2a\u8fd4\u56de\u7801\u548c 401 \uff08 Unauthorized \uff09\u5f88\u7c7b\u56db\uff0c\u4f46\u662f\u6807\u5fd7\u4e86\u5ba2\u6237\u7aef\u5e94\u5f53\u9996\u5148\u5728 proxy \u4e0a\u901a\u8fc7\u8ba4\u8bc1\u3002 SIP \u5bf9\u8ba4\u8bc1\u7684\u8bbf\u95ee\u8bf7\u53c2\u89c1 26 \u8282\u548c 22 . 3 \u8282\u3002 \u8fd9\u4e2a\u8fd4\u56de\u7801\u7528\u4e8e\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u901a\u8baf\u7f51\u5173\uff08\u6bd4\u5982\uff0c\u7535\u8bdd\u7f51\u5173\uff09\uff0c\u800c\u5f88\u5c11\u7528\u4e8e\u88ab\u53eb\u65b9\u8981\u6c42\u8ba4\u8bc1\u3002 4 . 9 408 Request Timeout \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u670d\u52a1\u5668\u4e0d\u80fd\u4ea7\u751f\u4e00\u4e2a\u7ec8\u7ed3\u5e94\u7b54\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u65e0\u6cd5\u53ca\u65f6\u51b3\u5b9a\u7528\u6237\u7684\u4f4d\u7f6e\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u7a0d\u540e\u4e0d\u66f4\u6539\u8bf7\u6c42\u7684\u5185\u5bb9\u7136\u540e\u91cd\u65b0\u5c1d\u8bd5\u8bf7\u6c42\u3002 4 . 10 410 Gone \u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u672c\u670d\u52a1\u5668\u4e0a\u5df2\u7ecf\u4e0d\u5b58\u5728\u4e86\uff0c\u5e76\u4e14\u4e0d\u77e5\u9053\u5e94\u5f53\u628a\u8bf7\u6c42\u8f6c\u53d1\u5230\u54ea\u91cc\u3002\u8fd9\u4e2a\u95ee\u9898\u5c06\u4f1a\u4f7f\u6c38\u4e45\u6027\u7684\u3002\u5982\u679c\u670d\u52a1\u5668\u4e0d\u77e5\u9053\uff0c\u6216\u8005\u4e0d\u5bb9\u6613\u68c0\u6d4b\uff0c\u8fd9\u4e2a\u8d44\u6e90\u6d88\u5931\u662f\u4e34\u65f6\u6027\u8d28\u7684\u8fd8\u662f\u6c38\u4e45\u6027\u8d28\u7684\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 404 \uff08 Not Found \uff09 4 . 11 413 \u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\u3002 \u670d\u52a1\u5668\u62d2\u7edd\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5b9e\u4f53\u8d85\u8fc7\u4e86\u670d\u52a1\u5668\u5e0c\u671b\u6216\u8005\u80fd\u591f\u5904\u7406\u7684\u5927\u5c0f\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u5e94\u5f53\u5173\u95ed\u8fde\u63a5\u907f\u514d\u5ba2\u6237\u7aef\u91cd\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u3002 \u5982\u679c\u8fd9\u4e2a\u60c5\u51b5\u662f\u6682\u65f6\u7684\uff0c\u90a3\u4e48\u670d\u52a1\u7aef\u5e94\u5f53\u5305\u542b\u4e00\u4e2a Retry - After \u5934\u57df\u6765\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u6682\u65f6\u7684\u6545\u969c\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u53ef\u4ee5\u8fc7\u4e00\u6bb5\u65f6\u95f4\u518d\u6b21\u5c1d\u8bd5\u3002 4 . 12 414 Request - URI Too Long \u670d\u52a1\u5668\u62d2\u7edd\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u56e0\u4e3a Request - URI \u8d85\u8fc7\u4e86\u670d\u52a1\u5668\u80fd\u591f\u5904\u7406\u7684\u957f\u5ea6\u3002 4 . 13 415 Unsupported Media Type \u670d\u52a1\u5668\u7531\u4e8e\u8bf7\u6c42\u7684\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u672c\u670d\u52a1\u5668\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u62d2\u7edd\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u5fc5\u987b\u6839\u636e\u5185\u5bb9\u7684\u6545\u969c\u7c7b\u578b\uff0c\u8fd4\u56de\u4e00\u4e2a Accept \uff0c Accpet - Encoding ,\u6216\u8005 Accept - Language \u5934\u57df\u5217\u8868\u3002 UAC \u6839\u636e 8 . 1 . 3 . 5 \u8282\u5b9a\u4e49\u7684\u65b9\u6cd5\u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u3002 4 . 14 416 Unsupported URI Scheme \u670d\u52a1\u5668\u7531\u4e8e\u4e0d\u652f\u6301 Request - URI \u4e2d\u7684 URI \u65b9\u6848\u800c\u7ec8\u6b62\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u3002\u5ba2\u6237\u7aef\u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u53c2\u7167 8 . 1 . 3 . 5 \u3002 4 . 15 Bad Extension \u670d\u52a1\u5668\u4e0d\u77e5\u9053\u5728\u8bf7\u6c42\u4e2d\u7684 Proxy - Require ( 20 . 29 ) \u6216\u8005 Require ( 20 . 32 ) \u5934\u57df\u6240\u6307\u51fa\u7684\u534f\u8bae\u6269\u5c55\u3002\u670d\u52a1\u5668\u5fc5\u987b\u5728 Unsupported \u5934\u57df\u4e2d\u5217\u51fa\u4e0d\u652f\u6301\u7684\u6269\u5c55\u3002 UAC \u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u8bf7\u53c2\u89c1 8 . 1 . 3 . 5 4 . 16 421 Extension Required UAS \u9700\u8981\u7279\u5b9a\u7684\u6269\u5c55\u6765\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u8fd9\u4e2a\u6269\u5c55\u5e76\u6ca1\u6709\u5728\u8bf7\u6c42\u7684 Supported \u5934\u57df\u4e2d\u5217\u51fa\u3002\u5177\u6709\u8fd9\u4e2a\u5e94\u7b54\u7801\u7684\u5e94\u7b54\u5fc5\u987b\u5305\u542b\u4e00\u4e2a Require \u5934\u57df\u5217\u51fa\u6240\u9700\u8981\u7684\u6269\u5c55\u3002 UAS \u4e0d\u5e94\u5f53\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u9664\u975e\u5b83\u771f\u7684\u4e0d\u80fd\u7ed9\u5ba2\u6237\u7aef\u63d0\u4f9b\u6709\u6548\u7684\u670d\u52a1\u3002\u76f8\u53cd\uff0c\u5982\u679c\u5728 Support \u5934\u57df\u4e2d\u6ca1\u6709\u5217\u51fa\u9700\u8981\u7684\u6269\u5c55\uff0c\u670d\u52a1\u5668\u5e94\u5f53\u6839\u636e\u57fa\u51c6\u7684 SIP \u517c\u5bb9\u7684\u65b9\u6cd5\u548c\u5ba2\u6237\u7aef\u652f\u6301\u7684\u6269\u5c55\u6765\u8fdb\u884c\u5904\u7406\u3002 4 . 17 423 Interval Too Brief \u670d\u52a1\u5668\u56e0\u4e3a\u5728\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u7684\u8d44\u6e90\u5237\u65b0\u65f6\u95f4\uff08\u6216\u8005\u6709\u6548\u65f6\u95f4\uff09\u8fc7\u77ed\u800c\u62d2\u7edd\u8bf7\u6c42\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u7528\u4e8e\u6ce8\u518c\u670d\u52a1\u5668\u6765\u62d2\u7edd\u90a3\u4e9b Contact \u5934\u57df\u6709\u6548\u671f\u8fc7\u77ed\u7684\u6ce8\u518c\u8bf7\u6c42\u3002\u8fd9\u4e2a\u5e94\u7b54\u7684\u7528\u6cd5\u548c\u76f8\u5173\u7684 Min - Expires \u5934\u57df\u5728 10 . 2 . 8 , 10 . 3 , 20 . 23 \u8282\u4e2d\u4ecb\u7ecd\u548c\u8bf4\u660e\u3002 4 . 18 480 Temporarily Unavailable \u8bf7\u6c42\u6210\u529f\u5230\u8fbe\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5f53\u524d\u4e0d\u53ef\u7528\uff08\u4f8b\u5982\uff0c\u6ca1\u6709\u767b\u9646\uff0c\u6216\u8005\u767b\u9646\u4e86\u4f46\u662f\u72b6\u6001\u662f\u4e0d\u80fd\u901a\u8baf\uff0c\u6216\u8005\u6709\u201d\u8bf7\u52ff\u6253\u6270\u201d\u7684\u6807\u8bb0\uff09\u3002\u5e94\u7b54\u5e94\u5f53\u5728 Retry - After \u4e2d\u6807\u5fd7\u4e00\u4e2a\u5408\u9002\u7684\u91cd\u53d1\u65f6\u95f4\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u6709\u53ef\u80fd\u5728\u5176\u4ed6\u5730\u65b9\u662f\u6709\u6548\u7684\uff08\u5728\u672c\u670d\u52a1\u5668\u4e2d\u4e0d\u77e5\u9053\uff09\u3002 Reason - Phrase ( \u539f\u56e0\u77ed\u53e5 ) \u5e94\u5f53\u63d0\u793a\u66f4\u8be6\u7ec6\u7684\u539f\u56e0\uff0c\u4e3a\u4ec0\u4e48\u88ab\u53eb\u65b9\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u8fd9\u4e2a\u503c\u5e94\u5f53\u662f\u53ef\u4ee5\u88ab UA \u8bbe\u7f6e\u7684\u3002\u72b6\u6001\u7801 486 \uff08 Busy Here \uff09\u53ef\u4ee5\u7528\u6765\u66f4\u7cbe\u786e\u7684\u8868\u793a\u672c\u8bf7\u6c42\u5931\u8d25\u7684\u7279\u5b9a\u539f\u56e0\u3002 \u8fd9\u4e2a\u72b6\u6001\u7801\u4e5f\u53ef\u4ee5\u662f\u8f6c\u53d1\u670d\u52a1\u6216\u8005 proxy \u670d\u52a1\u5668\u8fd4\u56de\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53d1\u73b0 Request - URI \u6307\u5b9a\u7684\u7528\u6237\u5b58\u5728\uff0c\u4f46\u662f\u6ca1\u6709\u4e00\u4e2a\u7ed9\u8fd9\u4e2a\u7528\u6237\u7684\u5408\u9002\u7684\u5f53\u524d\u8f6c\u53d1\u7684\u5730\u5740\u3002 4 . 19 481 Call / Transaction Does Not Exist \u8fd9\u4e2a\u72b6\u6001\u8868\u793a\u4e86 UAS \u63a5\u6536\u5230\u8bf7\u6c42\uff0c\u4f46\u662f\u6ca1\u6709\u548c\u73b0\u5b58\u7684\u5bf9\u8bdd\u6216\u8005\u4e8b\u52a1\u5339\u914d\u3002 4 . 20 482 Loop Detected \u670d\u52a1\u5668\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2a\u5faa\u73af ( 16 . 3 / 4 ) 4 . 21 483 Too Many Hops \u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\u5305\u542b\u7684 Max - Forwards ( 20 . 22 ) \u5934\u57df\u662f 0 4 . 22 484 Address InComplete \u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5b83\u7684 Request - URI \u662f\u4e0d\u5b8c\u6574\u7684\u3002\u5728\u539f\u56e0\u77ed\u8bed\u4e2d\u5e94\u5f53\u6709\u9644\u52a0\u7684\u4fe1\u606f\u8bf4\u660e\u3002\u8fd9\u4e2a\u72b6\u6001\u7801\u53ef\u4ee5\u548c\u62e8\u53f7\u4ea4\u53e0\u3002\u5728\u548c\u62e8\u53f7\u4ea4\u53e0\u4e2d\uff0c\u5ba2\u6237\u7aef\u4e0d\u77e5\u9053\u62e8\u53f7\u4e32\u7684\u957f\u5ea6\u3002\u5b83\u53d1\u9001\u589e\u52a0\u957f\u5ea6\u7684\u5b57\u4e32\uff0c\u5e76\u4e14\u63d0\u793a\u7528\u6237\u8f93\u5165\u66f4\u591a\u7684\u5b57\u4e32\uff0c\u76f4\u5230\u4e0d\u5728\u51fa\u73b0 484 \uff08 Address Incomplete \uff09\u5e94\u7b54\u4e3a\u6b62\u3002 4 . 23 485 Ambiguous Request - URI \u662f\u4e0d\u660e\u786e\u7684\u3002\u5e94\u7b54\u53ef\u4ee5\u5728 Contact \u5934\u57df\u4e2d\u5305\u542b\u4e00\u4e2a\u53ef\u80fd\u7684\u660e\u786e\u7684\u5730\u5740\u5217\u8868\u3002\u8fd9\u4e2a\u63d0\u793a\u5217\u8868\u80af\u56ca\u4e2a\u5728\u5b89\u5168\u6027\u548c\u9690\u79c1\u6027\u5bf9\u7528\u6237\u6216\u8005\u7ec4\u7ec7\u9020\u6210\u7834\u574f\u3002\u5fc5\u987b\u80fd\u591f\u7531\u914d\u7f6e\u51b3\u5b9a\u662f\u5426\u4ee5 404 \uff08 NotFound \uff09\u4ee3\u66ff\u8fd9\u4e2a\u5e94\u7b54\uff0c\u53c8\u6216\u8005\u7981\u6b62\u5bf9\u4e0d\u660e\u786e\u7684\u5730\u5740\u4f7f\u7528\u53ef\u80fd\u7684\u9009\u62e9\u5217\u8868\u3002 \u7ed9\u5e26\u6709 Request - URI \u7684\u8bf7\u6c42\u7684\u4e00\u4e2a\u5e94\u7b54\u4f8b\u5b50\uff1a sip : lee @ example . com : SIP / 2 . 0 485 Ambiguous Contact : Carol Lee Contact : Ping Lee Contact : Lee M . Foote \u90e8\u5206 email \u548c\u8bed\u97f3\u90ae\u7bb1\u7cfb\u7edf\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\u8fd9\u4e2a\u72b6\u6001\u7801\u548c 3 xx \u72b6\u6001\u7801\u4e0d\u540c\uff1a\u5bf9\u4e8e 300 \u6765\u8bf4\uff0c\u5b83\u662f\u5047\u5b9a\u540c\u4e00\u4e2a\u4eba\u6216\u8005\u670d\u52a1\u6709\u4e0d\u540c\u7684\u5730\u5740\u9009\u62e9\u3002\u6240\u4ee5\u5bf9 3 xx \u6765\u8bf4\uff0c\u81ea\u52a8\u9009\u62e9\u7cfb\u7edf\u6216\u8005\u8fde\u7eed\u67e5\u627e\u5c31\u6709\u6548\uff0c\u4f46\u662f\u5bf9 485 \uff08 Ambiguous \uff09\u5e94\u7b54\u6765\u8bf4\uff0c\u4e00\u5b9a\u8981\u7528\u6237\u7684\u5e72\u9884\u3002 4 . 24 486 Busy Here \u5f53\u6210\u529f\u8054\u7cfb\u5230\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5f53\u524d\u5728\u8fd9\u4e2a\u7ec8\u7aef\u7cfb\u7edf\u4e0a\u4e0d\u80fd\u63a5\u542c\u8fd9\u4e2a\u7535\u8bdd\uff0c\u90a3\u4e48\u5e94\u7b54\u5e94\u5f53\u56de\u7ed9\u547c\u53eb\u65b9\u4e00\u4e2a\u66f4\u5408\u9002\u7684\u65f6\u95f4\u5728 Retry - After \u5934\u57df\u91cd\u8bd5\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u8bb8\u5728\u5176\u4ed6\u5730\u65b9\u6709\u6548\uff0c\u6bd4\u5982\u7535\u8bdd\u90ae\u7bb1\u7cfb\u7edf\u7b49\u7b49\u3002\u5982\u679c\u6211\u4eec\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u7cfb\u7edf\u80fd\u591f\u63a5\u542c\u8fd9\u4e2a\u547c\u53eb\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u72b6\u6001\u7801 600 \uff08 Busy Everywhere \uff09\u3002 4 . 25 487 Request Terminated \u8bf7\u6c42\u88ab BYE \u6216\u8005 CANCEL \u6240\u7ec8\u6b62\u3002\u8fd9\u4e2a\u5e94\u7b54\u6c38\u8fdc\u4e0d\u4f1a\u7ed9 CANCEL \u8bf7\u6c42\u672c\u8eab\u56de\u590d\u3002 4 . 26 488 Not Acceptable Here \u8fd9\u4e2a\u5e94\u7b54\u548c 606 \uff08 Not Acceptable \uff09\u6709\u76f8\u540c\u7684\u542b\u4e49\uff0c\u4f46\u662f\u53ea\u662f\u5e94\u7528\u4e8e Request - URI \u6240\u6307\u51fa\u7684\u7279\u5b9a\u8d44\u6e90\u4e0d\u80fd\u63a5\u53d7\uff0c\u5728\u5176\u4ed6\u5730\u65b9\u8bf7\u6c42\u53ef\u80fd\u53ef\u4ee5\u63a5\u53d7\u3002 \u5305\u542b\u4e86\u5a92\u4f53\u517c\u5bb9\u6027\u63cf\u8ff0\u7684\u6d88\u606f\u4f53\u53ef\u4ee5\u51fa\u73b0\u5728\u5e94\u7b54\u4e2d\uff0c\u5e76\u4e14\u6839\u636e INVITE \u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u8fdb\u884c\u89c4\u683c\u5316\uff08\u5982\u679c\u6ca1\u6709 Accept \u5934\u57df\uff0c\u90a3\u4e48\u5c31\u662f application / sdp \uff09\u3002\u8fd9\u4e2a\u5e94\u7b54\u5c31\u50cf\u7ed9 OPTIONS \u8bf7\u6c42\u7684 200 ( OK ) \u5e94\u7b54\u7684\u6d88\u606f\u4f53\u4e00\u6837\u3002 4 . 27 491 Request Pending \u5728\u540c\u4e00\u4e2a\u5bf9\u8bdd\u4e2d\uff0c UAS \u63a5\u6536\u5230\u7684\u8bf7\u6c42\u6709\u4e00\u4e2a\u4f9d\u8d56\u7684\u8bf7\u6c42\u6b63\u5728\u5904\u7406\u3002 14 . 2 \u63cf\u8ff0\u4e86\u8fd9\u79cd\u60c5\u51b5\u5e94\u5f53\u600e\u6837\u89e3\u51b3\u3002 4 . 28 493 Undecipherable UAS \u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5305\u542b\u4e86\u4e00\u4e2a\u52a0\u5bc6\u7684 MIME ,\u5e76\u4e14\u4e0d\u77e5\u9053\u6216\u8005\u6ca1\u6709\u63d0\u4f9b\u5408\u9002\u7684\u89e3\u5bc6\u5bc6\u94a5\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u5355\u4e2a\u5305\u4f53\uff0c\u8fd9\u4e2a\u5305\u4f53\u5305\u542b\u4e86\u5408\u9002\u7684\u516c\u94a5\uff0c\u8fd9\u4e2a\u516c\u94a5\u7528\u4e8e\u7ed9\u8fd9\u4e2a UAS \u901a\u8baf\u4e2d\u52a0\u5bc6\u5305\u4f53\u4f7f\u7528\u7684\u3002\u7ec6\u8282\u63cf\u8ff0\u5728 23 . 2 \u8282\u3002 5 Server Failure 5 xx 5 xx \u5e94\u7b54\u662f\u5f53\u670d\u52a1\u5668\u672c\u8eab\u6545\u969c\u7684\u65f6\u5019\u7ed9\u51fa\u7684\u5931\u8d25\u5e94\u7b54\u3002 5 . 1 500 Server Internal Error \u670d\u52a1\u5668\u9047\u5230\u4e86\u672a\u77e5\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u4e0d\u80fd\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u663e\u793a\u7279\u5b9a\u7684\u9519\u8bef\u60c5\u51b5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u51e0\u79d2\u79cd\u4ee5\u540e\u91cd\u65b0\u5c1d\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002 \u5982\u679c\u8fd9\u4e2a\u60c5\u51b5\u662f\u4e34\u65f6\u7684\uff0c\u670d\u52a1\u5668\u5e94\u5f53\u5728 Retry - After \u5934\u57df\u6807\u5fd7\u5ba2\u6237\u7aef\u8fc7\u591a\u5c11\u79d2\u949f\u4e4b\u540e\u91cd\u65b0\u5c1d\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002 5 . 2 501 Not Implemented \u670d\u52a1\u5668\u6ca1\u6709\u5b9e\u73b0\u76f8\u5173\u7684\u8bf7\u6c42\u529f\u80fd\u3002\u5f53 UAS \u4e0d\u8ba4\u8bc6\u8bf7\u6c42\u7684\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5e76\u4e14\u5bf9\u6bcf\u4e00\u4e2a\u7528\u6237\u90fd\u65e0\u6cd5\u652f\u6301\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5e94\u5f53\u8fd4\u56de\u8fd9\u4e2a\u5e94\u7b54\u3002\uff08 proxy \u4e0d\u8003\u8651\u8bf7\u6c42\u7684\u65b9\u6cd5\u800c\u8f6c\u53d1\u8bf7\u6c42\uff09\u3002 \u6ce8\u610f 405 \uff08 Method Not Allowed \uff09\u662f\u56e0\u4e3a\u670d\u52a1\u5668\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u8bf7\u6c42\u65b9\u6cd5\uff0c\u4f46\u662f\u8fd9\u4e2a\u8bf7\u6c42\u65b9\u6cd5\u5728\u7279\u5b9a\u8bf7\u6c42\u4e2d\u4e0d\u88ab\u652f\u6301\u3002 5 . 3 502 Bad Gateway \u5982\u679c\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a gateway \u6216\u8005 proxy \u5b58\u5728\uff0c\u4ece\u4e0b\u884c\u670d\u52a1\u5668\u4e0a\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u975e\u6cd5\u7684\u5e94\u7b54\uff08\u8fd9\u4e2a\u5e94\u7b54\u5bf9\u5e94\u7684\u8bf7\u6c42\u662f\u672c\u670d\u52a1\u5668\u4e3a\u4e86\u5b8c\u6210\u8bf7\u6c42\u800c\u8f6c\u53d1\u7ed9\u4e0b\u884c\u670d\u52a1\u5668\u7684\uff09\u3002 5 . 4 503 Service Unavailable \u7531\u4e8e\u4e34\u65f6\u7684\u8fc7\u8f7d\u6216\u8005\u670d\u52a1\u5668\u7ba1\u7406\u5bfc\u81f4\u7684\u670d\u52a1\u5668\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u5e94\u7b54\u4e2d\u589e\u52a0\u4e00\u4e2a Retry - After \u6765\u8ba9\u5ba2\u6237\u7aef\u91cd\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002\u5982\u679c\u6ca1\u6709 Retry - After \u6307\u51fa\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5c31\u50cf\u6536\u5230\u4e86\u4e00\u4e2a 500 \uff08 Server Internal Error \uff09\u5e94\u7b54\u4e00\u6837\u5904\u7406\u3002 \u5ba2\u6237\u7aef\uff08 proxy \u6216\u8005 UAC \uff09\u6536\u5230 503 \uff08 Service Unavailable \uff09\u5e94\u5f53\u5c1d\u8bd5\u8f6c\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u5230\u53e6\u5916\u4e00\u4e2a\u670d\u52a1\u5668\u5904\u7406\u3002\u5e76\u4e14\u5728 Retry - After \u5934\u57df\u4e2d\u6307\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u4e0d\u5e94\u5f53\u8f6c\u53d1\u5176\u4ed6\u8bf7\u6c42\u5230\u8fd9\u4e2a\u670d\u52a1\u5668\u3002 \u4f5c\u4e3a 503 ( Service Unavaliable ) \u7684\u66ff\u4ee3\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u62d2\u7edd\u8fde\u63a5\u6216\u8005\u628a\u8bf7\u6c42\u6254\u6389\u3002 5 . 5 504 Server Time - out \u670d\u52a1\u5668\u5728\u4e00\u4e2a\u5916\u90e8\u670d\u52a1\u5668\u4e0a\u6ca1\u6709\u6536\u5230\u4e00\u4e2a\u53ca\u65f6\u7684\u5e94\u7b54\u3002\u8fd9\u4e2a\u5916\u90e8\u670d\u52a1\u5668\u662f\u672c\u670d\u52a1\u5668\u7528\u6765\u8bbf\u95ee\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u6240\u9700\u8981\u7684\u3002\u5982\u679c\u4ece\u4e0a\u884c\u670d\u52a1\u5668\u4e0a\u6536\u5230\u7684\u8bf7\u6c42\u4e2d\u7684 Expires \u5934\u57df\u8d85\u65f6\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 408 \uff08 Request TimeOut \uff09\u9519\u8bef\u3002 5 . 6 505 Version Not Supported \u670d\u52a1\u5668\u4e0d\u652f\u6301\u5bf9\u5e94\u7684 SIP \u7248\u672c\u3002\u670d\u52a1\u5668\u662f\u65e0\u6cd5\u5904\u7406\u5177\u6709\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u76f8\u540c\u4e3b\u7248\u672c\u53f7\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u5bfc\u81f4\u8fd9\u6837\u7684\u9519\u8bef\u4fe1\u606f\u3002 5 . 7 Message To Large \u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u6d88\u606f\u957f\u5ea6\u8d85\u8fc7\u4e86\u5904\u7406\u7684\u957f\u5ea6\u3002 6 Global Failures 6 xx 6 xx \u5e94\u7b54\u610f\u5473\u8fd9\u670d\u52a1\u5668\u7ed9\u7279\u5b9a\u7528\u6237\u6709\u4e00\u4e2a\u6700\u7ec8\u7684\u4fe1\u606f\uff0c\u5e76\u4e0d\u53ea\u662f\u5728 Request - URI \u7684\u7279\u5b9a\u5b9e\u4f8b\u6709\u6700\u7ec8\u4fe1\u606f\u3002 6 . 1 600 Busy Everywhere \u6210\u529f\u8054\u7cfb\u5230\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5904\u4e8e\u5fd9\u7684\u72b6\u6001\uff0c\u5e76\u4e0d\u6253\u7b97\u63a5\u542c\u7535\u8bdd\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u4e00\u4e2a Retry - After \u5934\u57df\u66f4\u660e\u786e\u7684\u544a\u8bc9\u547c\u53eb\u65b9\u591a\u4e45\u4ee5\u540e\u53ef\u4ee5\u7ee7\u7eed\u547c\u53eb\u3002\u5982\u679c\u88ab\u53eb\u65b9\u4e0d\u5e0c\u671b\u63d0\u793a\u62d2\u7edd\u7684\u539f\u56e0\uff0c\u88ab\u53eb\u65b9\u5e94\u5f53\u4f7f\u7528 603 \uff08 Decline \uff09\u3002\u53ea\u6709\u5f53\u7ec8\u7aef\u7cfb\u7edf\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u8282\u70b9\uff08\u6bd4\u5982\u8bed\u97f3\u90ae\u7bb1\u7cfb\u7edf\uff09\u80fd\u591f\u8bbf\u95ee\u5230\u8fd9\u4e2a\u7528\u6237\u7684\u65f6\u5019\u624d\u80fd\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u3002\u5426\u5219\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 486 \uff08 Busy Here \uff09\u7684\u5e94\u7b54\u3002 6 . 2 603 Decline \u5f53\u6210\u529f\u8bbf\u95ee\u5230\u88ab\u53eb\u65b9\u7684\u8bbe\u5907\uff0c\u4f46\u662f\u7528\u6237\u660e\u786e\u7684\u4e0d\u60f3\u5e94\u7b54\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u4e00\u4e2a Retry - After \u5934\u57df\u66f4\u660e\u786e\u7684\u544a\u8bc9\u547c\u53eb\u65b9\u591a\u4e45\u4ee5\u540e\u53ef\u4ee5\u7ee7\u7eed\u547c\u53eb\u3002\u53ea\u6709\u5f53\u7ec8\u7aef\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u4efb\u4f55\u7ec8\u7aef\u8bbe\u5907\u80fd\u591f\u54cd\u5e94\u8fd9\u4e2a\u547c\u53eb\u7684\u52bf\u80fd\u624d\u80fd\u7ed9\u51fa\u8fd9\u4e2a\u5e94\u7b54\u3002 6 . 3 604 Does Not Exists Anywhere \u670d\u52a1\u5668\u9a8c\u8bc1\u4e86\u5728\u8bf7\u6c42\u4e2d Request - URI \u7684\u7528\u6237\u4fe1\u606f\uff0c\u54ea\u91cc\u90fd\u4e0d\u5b58\u5728 6 . 4 606 Not Acceptable \u5f53\u6210\u529f\u8054\u7cfb\u5230\u4e00\u4e2a UA ,\u4f46\u662f\u4f1a\u8bdd\u63cf\u8ff0\u7684\u4e00\u4e9b\u90e8\u5206\u6bd4\u5982\u8bf7\u6c42\u7684\u5a92\u4f53\uff0c\u5e26\u5bbd\uff0c\u6216\u8005\u5730\u5740\u7c7b\u578b\u4e0d\u88ab\u63a5\u6536\u3002 606 \uff08 NotAcceptable \uff09\u5e94\u7b54\u610f\u5473\u7740\u7528\u6237\u5e0c\u671b\u901a\u8baf\uff0c\u4f46\u662f\u4e0d\u80fd\u5145\u5206\u652f\u6301\u4f1a\u8bdd\u63cf\u8ff0\u3002 606 \uff08 Not Acceptable \uff09\u5e94\u7b54\u53ef\u4ee5\u5728 Warning \u5934\u57df\u4e2d\u5305\u542b\u4e00\u4e2a\u539f\u56e0\u5217\u8868\uff0c\u7528\u4e8e\u89e3\u91ca\u4e3a\u4f55\u4f1a\u8bdd\u63cf\u8ff0\u4e0d\u80fd\u88ab\u652f\u6301\u3002\u8b66\u544a\u539f\u56e0\u4ee3\u7801\u5728 20 . 43 \u8282\u4e2d\u5217\u51fa\u3002 \u5728\u5e94\u7b54\u4e2d\uff0c\u53ef\u4ee5\u51fa\u73b0\u4e00\u4e2a\u5305\u542b\u5a92\u4f53\u517c\u5bb9\u6027\u63cf\u8ff0\u7684\u6d88\u606f\u4f53\uff0c\u8fd9\u4e2a\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u6839\u636e INVITE \u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u6307\u51fa\u7684\u683c\u5f0f\u8fdb\u884c\u89c4\u683c\u5316\uff08\u5982\u679c\u6ca1\u6709 Accept \u5934\u57df\uff0c\u90a3\u4e48\u5c31\u662f application / sdp \uff09\uff0c\u5c31\u50cf\u7ed9 OPTIONS \u4eb2\u6c42\u7684 200 ( OK ) \u5e94\u7b54\u4e2d\u7684\u6d88\u606f\u4e00\u6837\u3002 \u6211\u4eec\u5e0c\u671b\u8fd9\u4e9b\u5a92\u4f53\u534f\u5546\u4e0d\u8981\u7ecf\u5e38\u9700\u8981\uff0c\u5e76\u4e14\u5f53\u4e00\u4e2a\u65b0\u7528\u6237\u88ab\u9080\u8bf7\u52a0\u5165\u5df2\u7ecf\u5b58\u5728\u7684\u4f1a\u8bdd\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u5a92\u4f53\u534f\u5546\u53ef\u80fd\u4e0d\u9700\u8981\u3002\u8fd9\u53d6\u51b3\u4e8e\u9080\u8bf7\u7684\u521d\u59cb\u5316\u8005\u662f\u5426\u9700\u8981\u5bf9 606 \uff08 Not Acceptable \uff09\u8fdb\u884c\u5904\u7406\u3002 \u8fd9\u4e2a\u5e94\u7b54\u53ea\u6709\u5f53\u5ba2\u6237\u7aef\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u80fd\u591f\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u7684\u65f6\u5019\u624d\u80fd\u53d1\u51fa Freeswitch \u00b6 \u5b66\u4e60freeswitch\u9700\u8981\u638c\u63e1\u7684\u5185\u5bb9\uff1ac/c++\u7f16\u7a0b, socket\u7f16\u7a0b \uff0csip ,sdp\uff0crtp ,tcp/ip \u534f\u8bae\uff0cXML\uff0c\u811a\u672c\u8bed\u8a00JavaScript\uff0clua\uff0cerlang,perl\u3002\u6570\u636e\u5e93sqlite\uff0cmysql\u3002\u7cfb\u7edf\u7f16\u7a0b\u77e5\u8bc6\uff1a\u591a\u8fdb\u7a0b\u7ebf\u7a0b\u540c\u6b65\uff08\u4e34\u754c\u533a\uff0c\u4e92\u65a5\u91cf\uff0c\u4fe1\u53f7\u706f\uff0c\u4e8b\u4ef6\uff09\uff0cAPR\uff0c\u6a21\u5757\u52a8\u6001\u5171\u4eab\u673a\u5236\u3002 \u4fee\u6539freeswitch\u7684systemd\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6 \uff0c \u4fee\u6539\u540e\u7684\u914d\u7f6e\u5982\u4e0b \uff1a [ Unit ] Description = FreeSWITCH After = syslog . target network . target After = postgresql . service postgresql - 9.3 . service postgresql - 9.4 . service mysqld . service httpd . service [ Service ] User = freeswitch EnvironmentFile =-/ etc / sysconfig / freeswitch LimitNOFILE = 65000 LimitNPROC = 40960 # RuntimeDirectory is not yet supported in CentOS 7. A workaround is to use / etc / tmpfiles . d / freeswitch . conf # RuntimeDirectory =/ run / freeswitch # RuntimeDirectoryMode = 0750 WorkingDirectory =/ opt / app / freeswitch / var / run / freeswitch / ExecStart =/ opt / app / freeswitch / bin / freeswitch - nc - nf $ FREESWITCH_PARAMS ExecReload =/ usr / bin / kill - HUP $ MAINPID [ Install ] WantedBy = multi - user . target \u9ed8\u8ba4\u7684\u914d\u7f6e\u6ca1\u6709 LimitNOFILE \u548c LimitNPROC \u8fd9 2 \u4e2a\u914d\u7f6e \uff0c \u91cd\u65b0\u52a0\u8f7d systemd \u7684\u914d\u7f6e \uff0c \u91cd\u542f\u670d\u52a1\u5373\u53ef \uff1a systemctl daemon - reload systemctl restart freeswitch . service \u9519\u8bef\u5904\u7406 \u00b6 \u666e\u901a\u7528\u6237\u8fd0\u884c FreeSWITCH \u4e0d\u80fd\u8c03\u6574\u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1a Systemd \u662f\u4ee5 freeswitch \u7528\u6237\u8fd0\u884c FreeSWITCH \u7684\uff0c\u53ef\u80fd\u662f\u4ee5 root \u542f\u52a8\u4ee5\u540e\u518d\u5bf9\u8fdb\u7a0b\u964d\u7ea7\uff0c\u53d8\u6210 freeswitch \u7528\u6237\uff08\u8fd9\u4e2a\u662f\u6211\u731c\u7684\uff09\uff0c\u4e0d\u77e5\u9053 systemd \u7684\u542f\u52a8\u65b9\u5f0f\u548c root \u7528\u6237\u8fd0\u884c /opt/app/freeswitch/bin/freeswitch -nc -nf -u freeswitch -g freeswitch \u6709\u4ec0\u4e48\u533a\u522b\uff0c\u53cd\u6b63\u542f\u52a8\u4ee5\u540e\u662f\u6ca1\u6709 nice \u7684\u6743\u9650\u4e86\uff0c\u5bfc\u81f4\u65e5\u5fd7\u6709\u5982\u4e0b\u62a5\u9519\uff1a freeswitch[31890]: ERROR: Failed to set SCHED_FIFO scheduler (Operation not permitted) freeswitch[31890]: ERROR: Could not set nice level \u4e0d\u60f3 set uid\uff0c\u7ed9\u6587\u4ef6\u52a0\u4e0a nice \u7684\u80fd\u529b\u5373\u53ef\uff1a(\u5982\u4e0b\u547d\u4ee4) setcap CAP_SYS_NICE+ep /opt/app/freeswitch/bin/freeswitch Asterisk \u00b6 Raspberrypi \u00b6 \u5173\u4e8eHDMI\u8bbe\u7f6e /opt/vc/bin/tvservice tvservice [ OPTION ] ... -p, --preferred Power on HDMI with preferred settings -e, --explicit = \"GROUP MODE DRIVE\" Power on HDMI with explicit GROUP ( CEA, DMT, CEA_3D_SBS, CEA_3D_TB, CEA_3D_FP, CEA_3D_FS ) MODE ( see --modes ) and DRIVE ( HDMI, DVI ) -t, --ntsc Use NTSC frequency for HDMI mode ( e.g. 59 .94Hz rather than 60Hz ) -c, --sdtvon = \"MODE ASPECT [P]\" Power on SDTV with MODE ( PAL or NTSC ) and ASPECT ( 4 :3 14 :9 or 16 :9 ) Add P for progressive -o, --off Power off the display -m, --modes = GROUP Get supported modes for GROUP ( CEA, DMT ) -M, --monitor Monitor HDMI events -s, --status Get HDMI status -a, --audio Get supported audio information -d, --dumpedid <filename> Dump EDID information to file -j, --json Use JSON format for --modes output -n, --name Print the device ID from EDID \u67e5\u627e\u5f53\u524d\u6811\u8393\u6d3eCPU\u6a21\u5757\u540d cat /lib/modules/ $( uname -r ) /modules.builtin | grep wdt \u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5185\u5b58\u8017\u5c3d\u5c31\u91cd\u542f\uff0c\u5982min-memory = 1 \u524d\u7684\u6ce8\u91ca#\u53f7\u53bb\u6389 \u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u76d1\u63a7\u7684\u95f4\u9694\uff0c\u5982 interval = 1 \u524d\u7684\u6ce8\u91ca#\u53f7\u53bb\u6389\uff0c\u8be51\u4e3a\u4efb\u610f\u6570\u5b57\uff0c\u5355\u4f4d\u662f\u79d2\uff0c\u9ed8\u8ba4\u662f10\u79d2\u4e00\u6b21\u5065\u5eb7\u68c0\u67e5 /etc/init.d/watchdog start chkconfig watchdog on /etc/sysctl.conf kernel.panic = 10 sysctl -P 1 \u3001\u901a\u8fc7shell\u7f16\u7a0b\u83b7\u5f97cup\u6e29\u5ea6\u503c \u8fdb\u5165\u6811\u8393\u6d3e\u4e2d\u65ad\u63a7\u5236\u53f0\uff0c\u4f9d\u6b21\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\u83b7\u53d6\u5b9e\u65f6\u6e29\u5ea6\u503c\uff1a #\u8fdb\u5165\u6839\u76ee\u5f55 cd / #\u8bfb\u53d6temp\u6587\u4ef6\uff0c\u83b7\u5f97\u6e29\u5ea6\u503c cat sys/class/thermal/thermal_zone0/temp #\u7cfb\u7edf\u8fd4\u56de\u5b9e\u65f6\u503c 40622 [ \u8bf4\u660e ] 1 \uff09\u901a\u8fc7cat\u547d\u4ee4\u8bfb\u53d6\u5b58\u653e\u5728sys/class/thermal/thermal_zone0\u76ee\u5f55\u4e0b\u7684\u6e29\u5ea6\u6587\u4ef6temp\u83b7\u5f97\u8fd4\u56de\u503c 2 \uff09\u8fd4\u56de\u503c\u4e3a\u4e00\u4e2a5\u4f4d\u6570\u7684\u6570\u503c\uff0c\u5b9e\u9645\u6e29\u5ea6\u4e3a\u5c06\u8be5\u503c\u9664\u4ee51000\u5373\u53ef\uff01\u5355\u4f4d\u4e3a\u6444\u6c0f\u5ea6\uff01 2 \u3001\u901a\u8fc7C\u8bed\u8a00\u7f16\u7a0b\u83b7\u5f97cpu\u6e29\u5ea6\u503c #\u9009\u5b9a\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u521b\u5efacpu_temp.c\u6587\u4ef6\uff0c\u5c06\u4ee5\u4e0b\u4ee3\u7801\u8f93\u5165\uff1a #include <stdio.h> #include <stdlib.h> //\u5bfc\u5165\u6587\u4ef6\u63a7\u5236\u51fd\u6570\u5e93 #include <sys/types.h> #include <sys/stat.h> #include <fcntl.h> #define TEMP_PATH \"/sys/class/thermal/thermal_zone0/temp\" #define MAX_SIZE 20 int main ( void ) { int fd ; double temp = 0 ; char buf [ MAX_SIZE ] ; // \u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00/sys/class/thermal/thermal_zone0/temp fd = open ( TEMP_PATH, O_RDONLY ) ; //\u5224\u65ad\u6587\u4ef6\u662f\u5426\u6b63\u5e38\u88ab\u6253\u5f00 if ( fd < 0 ) { fprintf ( stderr, \"failed to open thermal_zone0/temp\\n\" ) ; return -1 ; } // \u8bfb\u53d6\u5185\u5bb9 if ( read ( fd, buf, MAX_SIZE ) < 0 ) { fprintf ( stderr, \"failed to read temp\\n\" ) ; return -1 ; } // \u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\u6253\u5370 temp = atoi ( buf ) / 1000 .0 ; printf ( \"temp: %.3f\\n\" , temp ) ; // \u5173\u95ed\u6587\u4ef6 close ( fd ) ; } #\u7f16\u8bd1C\u4ee3\u7801\uff0c\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a gcc -o cpu_temp cpu_temp.c #\u8fd0\u884c\u7a0b\u5e8f ./cpu_temp #\u7cfb\u7edf\u8fd4\u56de\u5b9e\u65f6\u503c temp : 40 .622 \u7a0b\u5e8f\u89e3\u8bfb\uff1a 1 ) \u5173\u4e8eopen () \u3001read () \u3001close () \u51fd\u6570\u4f7f\u7528\uff0c\u53ef\u770b\uff1a\u3010fcntl.h\u51fd\u6570\u5e93\u7684\u5e38\u7528\u51fd\u6570\u4f7f\u7528\u3011\u3002 2 ) atoi ( buf ) \u51fd\u6570\u662f\u5c06buf\u4e2d\u7684\u5b57\u7b26\u4e32\u6570\u636e\u8f6c\u6362\u5c42\u6574\u5f62\u6570\u3002 3 ) gcc -o cpu_temp cpu_temp.c \uff1agcc\u4e3a\u7f16\u8bd1\u5668\u3001 -o\u53c2\u6570\u8868\u793a\u5c06cpu_temp.c\u6587\u4ef6\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u5b58\u653e\u5230 cpu_temp\u6587\u4ef6\u5939\u4e2d\u3002 2 \u3001\u901a\u8fc7python\u8bed\u8a00\u7f16\u7a0b\u83b7\u5f97cpu\u6e29\u5ea6\u503c #\u9009\u5b9a\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u521b\u5efacpu_temp.py\u6587\u4ef6\uff0c\u5c06\u4ee5\u4e0b\u4ee3\u7801\u8f93\u5165\uff1a # -*- coding: utf-8 -*- # \u6253\u5f00\u6587\u4ef6 file = open ( \"/sys/class/thermal/thermal_zone0/temp\" ) # \u8bfb\u53d6\u7ed3\u679c\uff0c\u5e76\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 temp = float ( file.read ()) / 1000 # \u5173\u95ed\u6587\u4ef6 file.close () # \u5411\u7ec8\u7aef\u63a7\u5236\u53f0\u6253\u5370 print \"temp : %.3f\" %temp #\u6267\u884c\u811a\u672c Python cpu_temp.py cpu\u6e29\u5ea6\u83b7\u53d6\u8fd9\u6837\u5199\u4f1a\u4e0d\u4f1a\u66f4\u8f7b\u5de7\u4e9b def getCPUtemperature () : return os.popen ( \u2018/opt/vc/bin/vcgencmd measure_temp\u2019 ) .read ()[ 5 :9 ] \u6216\u8005\u76f4\u63a5\u8bfb\u53d6\u7cfb\u7edf\u81ea\u5df1\u7684\u72b6\u6001\u66f4\u65b0\uff0c\u7701\u53bb\u6a21\u62dfshell def getCPUtemperature () : with open ( \u201c/sys/class/thermal/thermal_zone0/temp\u201d ) as tempFile: res = tempFile.read () res = str ( float ( res ) /1000 ) return res \u540c\u7406\uff0cgetRaminfo () \u53ef\u4ee5\u5199\u6210\uff1a return os.popen ( \u2018free | tail -n +2\u2019 ) .readline () .split ()[ 1 :4 ] getDiskSpace () \u53ef\u4ee5\u5199\u6210\uff1areturn os.popen ( \u2018df -h / | tail -n +2\u2019 ) .readline () .split ()[ 1 :5 ] popen\u7684\u6548\u7387\u4e0d\u9ad8\uff0c\u4f46\u662f\u914d\u5408shell\u76f8\u5f53\u7075\u6d3b\uff5e\uff5e \u63a5\u53e3 \u00b6 \u83b7\u53d6\u7a7a\u95f4\u97f3\u4e50 http : // qzone - music . qq . com / fcg - bin / cgi_playlist_xml . fcg ? uin = QQ \u53f7 & json = 1 & g_tk = 1916754934 CF \u6218\u7ee9\u67e5\u8be2 http : // apps . game . qq . com / cf / a20131114fhcx_mobile / getUserAct . php ? action = getuseract & iUin = 1376081701 & sArea = 325 & r = 1564199514663 & _ = 1564199514663 \" http://apps.game.qq.com/cf/a20131114fhcx_mobile/getUserAct.php?action=getuseract&iUin= \" + iUin + \" &sArea= \" + sArea + \" &r= \" + new Date () . getTime () ; http : // q2 . qlogo . cn / headimg_dl ? dst_uin = 1376081701 & spec = 100 http : // www . sse . com . cn / market / price / trends / http : // yunhq . sse . com . cn : 32041 / v1 / sh1 / snap / 600666 ? callback = jQuery11120579301615033067_1489046781341 & select = name % 2 Clast % 2 Cchg_rate % 2 Cchange % 2 Camount % 2 Cvolume % 2 Copen % 2 Cprev_close % 2 Cask % 2 Cbid % 2 Chigh % 2 Clow % 2 Ctradephase & _ = 1489046781349 https : // xueqiu . com / stock / forchartk / stocklist . json ? symbol = YHOO & period = 1 day & type = normal & end = 1457539200000 & _ = 1489048060047 http : // tushare . org https : // xueqiu . com / hq / screener http : // baostock . com https : // tushare . pro kickasstorrent thepiratebay https://www.canva.com/ https://www.pexels.com/ http://alpha.wallhaven.cc/ http://www.swsindex.com/ # \u83b7\u53d6\u516c\u7f51ip # \u666e\u901a\u6587\u672c\u683c\u5f0f curl icanhazip.com curl http://members.3322.org/dyndns/getip curl ip.6655.com/ip.aspx curl ident.me curl ipecho.net/plain curl whatismyip.akamai.com curl ifconfig.me curl myip.dnsomatic.com curl ifconfig.co # json\u683c\u5f0f curl ipinfo.io # \u8fd4\u56deip\u548c\u5730\u533a curl ip.6655.com/ip.aspx?area = 1 curl cip.cc /usr/bin/wget -q -O - http://icanhazip.com/ | /usr/bin/tail \u805a\u5408\u7684\u514d\u8d39API\u63a5\u53e3\u6570\u636e\uff1a \u624b\u673a\u53f7\u7801\u5f52\u5c5e\u5730API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/11 \u5386\u53f2\u4e0a\u7684\u4eca\u5929API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/63 \u80a1\u7968\u6570\u636eAPI\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/21 \u5168\u56fdWIFI\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/18 \u661f\u5ea7\u8fd0\u52bf\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/58 \u9ec4\u91d1\u6570\u636e\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/29 \u8bed\u97f3\u8bc6\u522b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/134 \u5468\u516c\u89e3\u68a6\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/64 \u5929\u6c14\u9884\u62a5API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/73 \u8eab\u4efd\u8bc1\u67e5\u8be2API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/38 \u7b11\u8bdd\u5927\u5168API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/95 \u90ae\u7f16\u67e5\u8be2\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/66 \u8001\u9ec4\u5386\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/65 \u7f51\u7ad9\u5b89\u5168\u68c0\u6d4b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/19 \u624b\u673a\u56fa\u8bdd\u6765\u7535\u663e\u793a\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/72 \u57fa\u91d1\u8d22\u52a1\u6570\u636e\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/28 \u6210\u8bed\u8bcd\u5178\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/157 \u65b0\u95fb\u5934\u6761\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/235 IP\u5730\u5740\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/1 \u95ee\u7b54\u673a\u5668\u4eba\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/112 \u6c47\u7387API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/80 \u7535\u5f71\u7968\u623f\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/44 \u4e07\u5e74\u5386API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/177 NBA\u8d5b\u4e8b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/92 \u767e\u5ea6 api\u96c6\u5e02\u514d\u8d39\u63a5\u53e3 IP\u5730\u5740\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/114.html \u9891\u9053\u65b0\u95fbAPI_\u6613\u6e90 http://apistore.baidu.com/apiworks/servicedetail/688.html \u5fae\u4fe1\u70ed\u95e8\u7cbe\u9009 http://apistore.baidu.com/apiworks/servicedetail/632.html \u5929\u6c14\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/112.html \u4e2d\u56fd\u548c\u4e16\u754c\u5929\u6c14\u9884\u62a5 http://apistore.baidu.com/apiworks/servicedetail/478.html \u80a1\u7968\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/115.html \u8eab\u4efd\u8bc1\u67e5\u8be2http://apistore.baidu.com/apiworks/servicedetail/113.html \u7f8e\u5973\u56fe\u7247 http://apistore.baidu.com/apiworks/servicedetail/720.html \u97f3\u4e50\u641c\u7d22 http://apistore.baidu.com/apiworks/servicedetail/1020.html \u56fe\u7075\u673a\u5668\u4eba http://apistore.baidu.com/apiworks/servicedetail/736.html \u6c47\u7387\u8f6c\u6362 http://apistore.baidu.com/apiworks/servicedetail/119.html \u8282\u5047\u65e5 http://apistore.baidu.com/apiworks/servicedetail/1116.html pullword\u5728\u7ebf\u5206\u8bcd\u670d\u52a1 http://apistore.baidu.com/apiworks/servicedetail/143.html \u53bb\u54ea\u513f\u7f51\u706b\u8f66\u7968 http://apistore.baidu.com/apiworks/servicedetail/697.html \u7b11\u8bdd\u5927\u5168 http://apistore.baidu.com/apiworks/servicedetail/864.html \u94f6\u884c\u5361\u67e5\u8be2\u670d\u52a1http://apistore.baidu.com/apiworks/servicedetail/735.html \u8bed\u97f3\u5408\u6210 http://apistore.baidu.com/apiworks/servicedetail/867.html \u5b85\u8a00API-\u52a8\u6f2b\u53f0\u8bcd\u63a5\u53e3 http://apistore.baidu.com/apiworks/servicedetail/446.html \u53bb\u54ea\u513f\u666f\u70b9\u95e8\u7968\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/140.html \u624b\u673a\u53f7\u7801\u5f52\u5c5e\u5730 http://apistore.baidu.com/apiworks/servicedetail/794.html \u4f53\u80b2\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/711.html \u624b\u673a\u5f52\u5c5e\u5730\u67e5\u8be2http://apistore.baidu.com/apiworks/servicedetail/709.html \u79d1\u6280\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/1061.html \u7a7a\u6c14\u8d28\u91cf\u6307\u6570 http://apistore.baidu.com/apiworks/servicedetail/116.html \u5929\u72d7\u5065\u5eb7\u83dc\u8c31 http://apistore.baidu.com/apiworks/servicedetail/987.html \u70ed\u95e8\u6e38\u8bb0\u5217\u8868 http://apistore.baidu.com/apiworks/servicedetail/520.html \u5929\u72d7\u836f\u54c1\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/916.html \u6c49\u5b57\u8f6c\u62fc\u97f3 http://apistore.baidu.com/apiworks/servicedetail/1124.html \u56fd\u9645\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/823.html \u5f69\u7968 http://apistore.baidu.com/apiworks/servicedetail/164.html \u5fae\u4fe1\u7cbe\u9009 http://apistore.baidu.com/apiworks/servicedetail/863.html \u5929\u72d7\u5065\u5eb7\u8d44\u8baf http://apistore.baidu.com/apiworks/servicedetail/888.html \u5174\u8da3\u70b9\u68c0\u7d22 http://apistore.baidu.com/apiworks/servicedetail/182.html \u7528\u836f\u53c2\u8003 http://apistore.baidu.com/apiworks/servicedetail/754.html \u5929\u72d7\u5065\u5eb7\u77e5\u8bc6 http://apistore.baidu.com/apiworks/servicedetail/899.html \u5947\u95fb\u8da3\u4e8b http://apistore.baidu.com/apiworks/servicedetail/633.html \u82b1\u8fb9\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/768.html \u5929\u72d7\u533b\u9662\u5927\u5168 http://apistore.baidu.com/apiworks/servicedetail/988.html \u751f\u6d3b\u5065\u5eb7 http://apistore.baidu.com/apiworks/servicedetail/989.html \u4e00\u4e9b\u5176\u4ed6\u7684API\u63a5\u53e3\uff1a \u8c46\u74e3\u5f00\u653e https://developers.douban.com/wiki/?title=guide \u6dd8\u5b9d\u5f00\u653e\u5e73\u53f0 http://open.taobao.com/?spm=a219a.7395905.1.1.YdFDV6 \u56fe\u7075\u8bed\u97f3 http://www.tuling123.com/help/h_cent_andriodsdk.jhtml?nav=doc \u8baf\u98de\u8bed\u97f3http:// www.xfyun.cn/robots/solution \u9a6c\u5316\u817e\u7684\u5fae\u4fe1\u5f00\u653e\u5e73\u53f0\uff08\u5bf9\u5e94\u7684\u8fd8\u6709\u817e\u8baf\u5f00\u653e\u5e73\u53f0\uff09 https://open.weixin.qq.com/ \u878d\u4e91IMhttps://developer.rongcloud.cn/signin?returnUrl=%2Fapp%2Fappkey%2FPv4vYQwaxSZdfpLX5AI%3D \u767e\u5ea6\u5f00\u53d1\u8005\u4e2d\u5fc3http://developer.baidu.com/ \u4eba\u8138\u8bc6\u522bhttp:// www.faceplusplus.com.cn/ \u9ad8\u5fb7\u5730\u56fehttp://lbs.amap.com/ \u873b\u8713FMhttp://open.qingting.fm https://www.yesapi.cn/ https://www.tianqiapi.com https://www.free-api.com/ https://www.mumble.info/","title":"Others"},{"location":"Others/#_1","text":"","title":"\u5176\u4ed6\u5174\u8da3\u7231\u597d"},{"location":"Others/#googletricks","text":"\"\" \u53cc\u5f15\u53f7 - \u6392\u9664\u5b57\u7b26 \u597d : baidu . com \u4f7f\u7528\u5192\u53f7\u641c\u7d22\u7279\u5b9a\u7684\u7f51\u7ad9 am * zing \u4f7f\u7528\u661f\u53f7\u901a\u914d\u7b26 related : amazon . com \u627e\u5230\u4e0e\u5176\u4ed6\u7f51\u7ad9\u7c7b\u4f3c\u7684\u7f51\u7ad9 Black or red \u5408\u5e76\u641c\u7d22 filetype : pdf \u627e\u5230\u7279\u5b9a\u6587\u4ef6 site : www . so . com \u5728360\u641c\u7d22\u5f15\u64ce\u4e2d\u5bfb\u627e allintitle : allinurl : @twitter \u641c\u7d22\u793e\u4ea4\u5a92\u4f53 info : \u83b7\u53d6\u6709\u5173\u7f51\u7ad9\u7684\u8be6\u7ec6\u4fe1\u606f cache : \u67e5\u770bGoogle\u7684\u7f51\u7ad9\u7f13\u5b58\u7248\u672c google . com / history \u641c\u7d22\u5386\u53f2 inurl : \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728url\u94fe\u63a5\u4e2d intitle : \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728\u7f51\u9875\u6807\u9898\u4e2d AND \uff1a \u8fd4\u56de\u67e5\u8be2\u4e24\u7aef\u7684\u7ed3\u679c \u3002 \u4f8b \uff1a growth hacks AND youtube NOT \uff1a \u8fd4\u56de\u9664NOT\u4e4b\u540e\u7684\u6240\u6709\u7ed3\u679c \u3002 \u4f8b \uff1a monty python NOT bbc \u4f7f\u7528 ~ \u641c\u7d22\u8bcd\u7684\u540c\u4e49\u8bcd \u4f7f\u7528in\u7684\u7ffb\u8bd1\u548c\u8f6c\u6362 process management inurl : forum | forums | discussion | viewthread | showthread | viewtopic | showtopic \u8bba\u575b google . com / ncr \u3002 NCR\u4ee3\u8868\u65e0\u56fd\u5bb6 / \u5730\u533a\u91cd\u5b9a\u5411 process automation filetype : pdf \u641c\u7d22ftp inurl : ftp : // - inurl : http : // - inurl : https : // - inurl ( html | htm | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( wmv | avi ) - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( jpg | gif ) - inurl :( htm | html | php ) intitle : \"index of\" + \"last modified\" + \"parent directory\" + description + size + ( wma | mp3 ) [ -inurl:(htm|html|php) intitle:\" index of\" +\" last modified\" +\" parent directory\" +description +size +(jpg|gif) \u201cbritney spears\" ] Function Execution To search for an exact phrase, with the same words in the same order Place quotation marks (\u201c) around the phrase you\u2019d like to search for Ex: \u201cto be, or not to be\" To exclude results that include a particular word or site when searching words with multiple meanings Place a dash (-) before the word or site you want to omit Ex: phoenix -arizona To search for Google+ pages or blood types Place an addition sign (+) in front of the Google+ user or after the blood type Ex: +Chrome and AB+ To search for social tags Place the at symbol (@) before the social tag you\u2019d like to search Ex: @digitaltrends To search for prices Place a dollar sign ($) before the value Ex: canon $400 To search for a phrase with missing words Place an asterisk (*) within the search as a placeholder for any unknown terms Ex: if you give a * a * To search for a range of numbers, usually pertaining to prices and measurements Place two periods between the designated numbers you want to search between Ex: 75.. 75.. 200 To search popular hashtags for trending topics Place a hashtag in front of the desired topicEx: #throwbackthursday Function Execution To search for results from certain sites and domains Place \u201csite:\" in front of the site or domain from which you want to pull results Ex: apple watch site:digitaltrends.com To search for pages that link to a certain page Place \u201clink:\" in front of the site or domain you want to find pages linking to Ex: link:digitaltrends.com To search for sites that are similar to a designated site or domain Place \u201crelated:\" in front of the site or domain you want to find similar results of Ex: related:digitaltrends.com To search for pages that just have one of several words Place \u201cOR\" between the two words you are searching for Ex: world series 2013 OR 2014 To search for designated information about a specific site or domain, including cached pages, and those linking to the site Place \u201cinfo:\" in front of the site or domain you want information about Ex: info:digitaltrends.com To search what a page looked like the last time Google crawled the site Place \u201ccache:\" in front of the page housing the cache you\u2019d like to view Ex: cache:digitaltrends.com To search for a specific file type Place \u201cfiletype:\" in front of the specific file type you\u2019re looking for Ex: matthew mcconaughey filetype:gif Function Execution To search Google using voice commands Click the microphone icon in the search bar and begin talking To search Google for a specific image Click the camera icon in the search bar and paste the image URL To set a timer Enter \u201cset timer for\" followed by the desired amount of time To check the weather for a specific area Enter \u201cweather\" followed by a zipcode or city To search for the sunrise and sunset times for a specific area Enter \u201csunrise\" or \u201csunset\" followed by a zipcode or city To look up the definition for a given word Enter \u201cdefine\" followed by your desired term To look up the origins for a given word Enter \u201cetymology\" followed by your desired word To look up the time for a specific region Enter \u201ctime\" followed by the particular region To look up your IP address Enter \u201cip address\" in the search bar To check the status of a flight Enter the flight number in the search bar To look up stock quotes Enter the desired stock symbol in the search bar To look up the date for a specific holiday Enter the name of the holiday in the search bar To track a package Enter the tracking number in the search bar To use the calculator Enter the equation in the search bar To define a word Enter \u201cdefine\" followed by your desired word To convert currency or measurements Enter the first amount and unit, type \u201cto\", and then enter the second unit To look up film showings Enter \u201cmovies\" followed by your zipcode or city To look up sports scores Enter the sports team in the search bar To look up nutritional facts about an item, or compare nutritional facts Enter the name of the product, or enter \u201ccompare\" followed by the items you want to compare To look up a celebrity\u2019s Bacon Number Enter \u201cbacon number\" followed by the name of the celebrity To roll a six-sided die Enter [roll a dice] in the search bar","title":"GoogleTricks"},{"location":"Others/#security","text":"","title":"Security"},{"location":"Others/#shadowsocks","text":"# Python,shadowsocks-python\u6700\u521d\u7684\u7248\u672c\u662f\u7531clowwindy\u5199\u7684. \u5b83\u7684\u76ee\u7684\u662f\u63d0\u4f9b\u4e00\u4e2a\u7b80\u5355\u6613\u7528\u548c\u6613\u4e8e\u90e8\u7f72\u7684\u5b9e\u73b0\uff0c\u5177\u6709\u57fa\u672c\u7684shadowsocks\u529f\u80fd PyPI \u9996\u5148\u786e\u5b9aPython\u662f2.6\u62162.7. $ python --version Python 2 .6.8 \u63a5\u7740\u7528pip\u5b89\u88c5 $ pip install shadowsocks GitHub Checkout\u6e90\u4ee3\u7801\u5e76\u76f4\u63a5\u8fd0\u884c\u811a\u672c $ git clone https://github.com/shadowsocks/shadowsocks.git $ cd shadowsocks $ python setup.py Go,shadowsocks-go\u662f\u7528Go\u8bed\u8a00\u7f16\u5199\u7684\u6700\u5148\u8fdb\u7684\u7aef\u53e3\uff0c\u4e13\u4e3a\u5927\u578b\u7cfb\u7edf\u8bbe\u8ba1\u3002\u5b83\u5b9e\u73b0\u4e86\u591a\u7aef\u53e3-\u591a\u5bc6\u7801\u7279\u6027\uff0c\u9002\u7528\u4e8e\u6709\u7528\u6237\u7ba1\u7406\u548c\u6d41\u91cf\u7edf\u8ba1\u652f\u6301\u7684\u4ed8\u8d39\u670d\u52a1\u63d0\u4f9b\u5546\u3002\u8be5\u7aef\u53e3\u7531cyfdecyf\u7ef4\u62a4\u3002 \u9884\u7f16\u8bd1\u4e8c\u8fdb\u5236\uff1a \u4ecehttp://dl.chenyufei.info/shadowsocks/\u4e0b\u8f7d GitHub Use go get to install the scripts. $ go get github.com/shadowsocks/shadowsocks-go/cmd/shadowsocks-server shadowsocks-go is licensed under the MIT license. C with libev [ shadowsocks-libev ] ,shadowsocks-libev\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u3001\u529f\u80fd\u9f50\u5168\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907\u7aef\u53e3\u548c\u4f4e\u7aef\u7684\u7ec8\u7aef\u76d2\u3002\u8fd9\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684C\u5b9e\u73b0\uff0c\u5b83\u5360\u7528\u4e86\u6570\u5343\u4e2a\u8fde\u63a5\u7684\u5360\u7528\u7a7a\u95f4\u5f88\u5c0f ( \u51e0\u5146\u5b57\u8282 ) \u3002\u8fd9\u4e2a\u7aef\u53e3\u7531madeye\u7ef4\u62a4\u3002 Debian/Ubuntu: Shadowsocks-libev is available in the official repository for Debian 9 ( \"Stretch\" ) , unstable, Ubuntu 16 .10 and later derivatives: sudo apt update sudo apt install shadowsocks-libev For Debian Jessie users, please install it from jessie-backports: sudo sh -c 'printf \"deb http://httpredir.debian.org/debian jessie-backports main\" > /etc/apt/sources.list.d/jessie-backports.list' sudo apt-get update sudo apt-get -t jessie-backports install shadowsocks-libev GitHub Build and install the project from source codes. $ sudo apt-get install --no-install-recommends build-essential autoconf libtool \\ libssl-dev gawk debhelper dh-systemd init-system-helpers pkg-config asciidoc \\ xmlto apg libpcre3-dev zlib1g-dev libev-dev libudns-dev libsodium-dev libmbedtls-dev libc-ares-dev automake $ git clone https://github.com/shadowsocks/shadowsocks-libev.git $ cd shadowsocks-libev $ git submodule update --init $ ./autogen.sh && ./configure && make $ sudo make install C++ with Qt,libQtShadowsocks\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u3001\u8d85\u5feb\u7684shadowsocks\u5e93\uff0c\u5b83\u662f\u7528c++\u7f16\u5199\u7684qt5\u3002\u5ba2\u6237\u673ashadowsocks-libqss\u53ef\u4ee5\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u4f7f\u7528\u3002\u8be5\u7aef\u53e3\u7531librehat\u7ef4\u62a4\u3002 Prebuilt binaries Download pre-built binaries from https://github.com/shadowsocks/libQtShadowsocks/releases GitHub $ git clone https://github.com/shadowsocks/libQtShadowsocks.git $ cd libQtShadowsocks $ qmake $ make -j4 $ sudo make install libQtShadowsocks is licensed under the GNU Lesser General Public License, version 3 .0 Perl,Net::Shadowsocks is an asynchronous, non-blocking Shadowsocks client and server Perl module maintained by @zhou0. Setting up You need a Perl interpreter to execute Perl program. Any Unix like system , including Linux and Mac OS X, has Perl pre-installed. Windows does not have Perl installed by default, you need to install Strawberry Perl.The source code is available on CPAN and github. Download from CPAN https://metacpan.org/release/Net-Shadowsocks or download from github https://github.com/zhou0/shadowsocks-perl Installing On Unix like systems,either $ perl Build.PL $ ./Build $ ./Build test $ ./Build install or $ perl Makefile.PL $ make $ make test $ make install You might need to change make to dmake or nmake depending on the compiler toolchain used on Windows. If You have cpan, you can also install using this command $ cpan Net::Shadowsocks Running There is a server.pl script under the eg directory. Put your config.json in the same directory as server.pl and run the server.pl script there.","title":"Shadowsocks"},{"location":"Others/#shadowsocks_1","text":"Shadowsocks\u5141\u8bb8\u7684JSON\u914d\u7f6e\u683c\u5f0f: { \"server\" : \"my_server_ip\" , \"server_port\" :8388, \"local_port\" :1080, \"password\" : \"barfoo!\" , \"timeout\" :600, \"method\" : \"chacha20-ietf-poly1305\" } \u6bcf\u4e2a\u5b57\u6bb5\u7684\u89e3\u91ca: server: your hostname or server IP ( IPv4/IPv6 ) . server_port: server port number. local_port: local port number. password: a password used to encrypt transfer. timeout: connections timeout in seconds. method: encryption method. \u52a0\u5bc6\u65b9\u5f0f\uff1a \u6700\u5f3a\u7684\u9009\u9879\u662fAEAD\u5bc6\u7801\u3002\u63a8\u8350\u7684\u9009\u62e9\u662f\u201cchacha20-ietf-poly1305\u201d\u6216\u201caes-256-gcm\u201d\u3002\u5176\u4ed6\u6d41\u5bc6\u7801\u88ab\u5b9e\u73b0\uff0c\u4f46\u4e0d\u63d0\u4f9b\u5b8c\u6574\u6027\u548c\u771f\u5b9e\u6027\u3002\u9664\u975e\u53e6\u6709\u89c4\u5b9a\uff0c\u52a0\u5bc6\u65b9\u6cd5\u9ed8\u8ba4\u4e3a\u201ctable\u201d\uff0c\u8fd9\u662f\u4e0d\u5b89\u5168\u7684\u3002","title":"shadowsocks\u914d\u7f6e"},{"location":"Others/#shadowsocks_2","text":"","title":"shadowsocks\u4f18\u5316"},{"location":"Others/#_2","text":"\u57fa\u4e8ekvm\u67b6\u6784vps\u7684\u4f18\u5316 \u8fd9\u65b9\u9762SS\u7ed9\u51fa\u4e86\u975e\u5e38\u8be6\u5c3d\u7684\u4f18\u5316\u6307\u5357\uff0c\u4e3b\u8981\u6709\uff1a\u4f18\u5316\u5185\u6838\u53c2\u6570\uff0c\u5f00\u542fTCP Fast Open ####1.1\u4f18\u5316\u5185\u6838\u53c2\u6570 \u7f16\u8f91vi /etc/sysctl.conf \u590d\u5236\u8fdb\u53bb # max open files fs.file-max = 51200 # max read buffer net.core.rmem_max = 67108864 # max write buffer net.core.wmem_max = 67108864 # default read buffer net.core.rmem_default = 65536 # default write buffer net.core.wmem_default = 65536 # max processor input queue net.core.netdev_max_backlog = 250000 # max backlog net.core.somaxconn = 4096 # resist SYN flood attacks net.ipv4.tcp_syncookies = 1 # reuse timewait sockets when safe net.ipv4.tcp_tw_reuse = 1 # turn off fast timewait sockets recycling net.ipv4.tcp_tw_recycle = 0 # short FIN timeout net.ipv4.tcp_fin_timeout = 30 # short keepalive time net.ipv4.tcp_keepalive_time = 1200 # outbound port range net.ipv4.ip_local_port_range = 10000 65000 # max SYN backlog net.ipv4.tcp_max_syn_backlog = 8192 # max timewait sockets held by system simultaneously net.ipv4.tcp_max_tw_buckets = 5000 net.ipv4.tcp_fastopen = 3 net.ipv4.tcp_mem = 25600 51200 102400 # TCP receive buffer net.ipv4.tcp_rmem = 4096 87380 67108864 # TCP write buffer net.ipv4.tcp_wmem = 4096 65536 67108864 # turn on path MTU discovery net.ipv4.tcp_mtu_probing = 1 # for high-latency network net.ipv4.tcp_congestion_control = hybla # forward ipv4 net.ipv4.ip_forward = 1 \u4fdd\u5b58\u751f\u6548 \u6267\u884csysctl -p\u547d\u4ee4reload\u914d\u7f6e\u6587\u4ef6 \u5176\u4e2d\u6700\u540e\u7684hybla\u662f\u4e3a\u9ad8\u5ef6\u8fdf\u7f51\u7edc\uff08\u5982\u7f8e\u56fd\uff0c\u6b27\u6d32\uff09\u51c6\u5907\u7684\u7b97\u6cd5\uff0c\u9700\u8981\u5185\u6838\u652f\u6301\uff0c\u6d4b\u8bd5\u5185\u6838\u662f\u5426\u652f\u6301\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\uff1a sysctl net.ipv4.tcp_available_congestion_control \u5982\u679c\u7ed3\u679c\u4e2d\u6709hybla\uff0c\u5219\u8bc1\u660e\u4f60\u7684\u5185\u6838\u5df2\u5f00\u542fhybla\uff0c\u5982\u679c\u6ca1\u6709hybla\uff0c\u53ef\u4ee5\u7528\u547d\u4ee4modprobe tcp_hybla\u5f00\u542f\u3002 \u5bf9\u4e8e\u4f4e\u5ef6\u8fdf\u7684\u7f51\u7edc\uff08\u5982\u65e5\u672c\uff0c\u9999\u6e2f\u7b49\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528htcp\uff0c\u53ef\u4ee5\u975e\u5e38\u663e\u8457\u7684\u63d0\u9ad8\u901f\u5ea6\uff0c\u9996\u5148\u4f7f\u7528modprobe tcp_htcp\u5f00\u542f\uff0c\u518d\u5c06net.ipv4.tcp_congestion_control = hybla\u6539\u4e3anet.ipv4.tcp_congestion_control = htcp\uff0c\u5efa\u8baeEC2\u65e5\u672c\u7528\u6237\u4f7f\u7528\u8fd9\u4e2a\u7b97\u6cd5\u3002","title":"\u7cfb\u7edf\u5c42\u9762"},{"location":"Others/#tcp","text":"1 .\u4fee\u6539\u6587\u4ef6\u53e5\u67c4\u6570\u9650\u5236 \u5982\u679c\u662fubuntu/centos\u5747\u53ef\u4fee\u6539/etc/sysctl.conf \u627e\u5230fs.file-max\u8fd9\u4e00\u884c\uff0c\u4fee\u6539\u5176\u503c\u4e3a1024000\uff0c\u5e76\u4fdd\u5b58\u9000\u51fa\u3002\u7136\u540e\u6267\u884csysctl -p\u4f7f\u5176\u751f\u6548 \u4fee\u6539vi /etc/security/limits.conf\u6587\u4ef6\uff0c\u52a0\u5165 * soft nofile 512000 * hard nofile 1024000 \u9488\u5bf9centos,\u8fd8\u9700\u8981\u4fee\u6539vi /etc/pam.d/common-session\u6587\u4ef6\uff0c\u52a0\u5165 session required pam_limits.so 2 .\u4fee\u6539vi /etc/profile\u6587\u4ef6\uff0c\u52a0\u5165 ulimit -SHn 1024000 \u7136\u540e\u91cd\u542f\u670d\u52a1\u5668\u6267\u884culimit -n\uff0c\u67e5\u8be2\u8fd4\u56de1024000\u5373\u53ef\u3002 sysctl.conf\u62a5\u9519\u89e3\u51b3\u65b9\u6cd5 \u4fee\u590dmodprobe\u7684\uff1a rm -f /sbin/modprobe ln -s /bin/true /sbin/modprobe \u4fee\u590dsysctl\u7684\uff1a rm -f /sbin/sysctl ln -s /bin/true /sbin/sysctl 1 .3 \u9510\u901f \u9510\u901f\u662fTCP\u5e95\u5c42\u52a0\u901f\u8f6f\u4ef6,\u5b98\u65b9\u5df2\u505c\u6b62\u63a8\u51fa\u6c38\u4e45\u514d\u8d39\u7248\u672c,\u4f46\u7f51\u4e0a\u6709\u7834\u89e3\u7248\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u3002\u9700\u8981\u8d2d\u4e70\u7684\u8bdd\u5148\u5230\u9510\u901f\u5b98\u7f51\u6ce8\u518c\u5e10\u53f7,\u5e76\u786e\u8ba4\u5185\u6838\u7248\u672c\u662f\u5426\u652f\u6301\u9510\u901f\u7684\u7248\u672c\u3002 \u4e00\u952e\u5b89\u88c5\u901f\u9510\u7834\u89e3\u7248 wget -N --no-check-certificate https://github.com/91yun/serverspeeder/raw/master/serverspeeder.sh && bash serverspeeder.sh \u4e00\u952e\u5378\u8f7d chattr -i /serverspeeder/etc/apx* && /serverspeeder/bin/serverSpeeder.sh uninstall -f \u8bbe\u7f6e Enter your accelerated interface ( s ) [ eth0 ] : eth0 Enter your outbound bandwidth [ 1000000 kbps ] : 1000000 Enter your inbound bandwidth [ 1000000 kbps ] : 1000000 Configure shortRtt-bypass [ 0 ms ] : 0 Auto load ServerSpeeder on linux start-up? [ n ] :y #\u662f\u5426\u5f00\u673a\u81ea\u542f Run ServerSpeeder now? [ y ] :y #\u662f\u5426\u73b0\u5728\u542f\u52a8 \u6267\u884clsmod\uff0c\u770b\u5230\u6709appex0\u6a21\u5757\u5373\u8bf4\u660e\u9510\u901f\u5df2\u6b63\u5e38\u5b89\u88c5\u5e76\u542f\u52a8\u3002 \u81f3\u6b64\uff0c\u5b89\u88c5\u5c31\u7ed3\u675f\u4e86\uff0c\u4f46\u8fd8\u6709\u540e\u7eed\u914d\u7f6e\u3002 \u4fee\u6539vi /serverspeeder/etc/config\u6587\u4ef6\u7684\u51e0\u4e2a\u53c2\u6570\u4ee5\u4f7f\u9510\u901f\u66f4\u597d\u7684\u5de5\u4f5c accppp = \"1\" #\u52a0\u901fPPTP\u3001L2TP V-P-N\uff1b\u8bbe\u4e3a1\u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a0\u8868\u793a\u5173\u95ed advinacc = \"1\" #\u9ad8\u7ea7\u5165\u5411\u52a0\u901f\u5f00\u5173\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5f00\u542f\u6b64\u529f\u80fd\u53ef\u4ee5\u5f97\u5230\u66f4\u597d\u7684\u6d41\u5165\u65b9\u5411\u6d41\u91cf\u52a0\u901f\u6548\u679c\uff1b maxmode = \"1\" #\u6700\u5927\u4f20\u8f93\u6a21\u5f0f\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff1b\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5f00\u542f\u540e\u4f1a\u8fdb\u4e00\u6b65\u63d0\u9ad8\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u964d\u4f4e\u6709\u6548\u6570\u636e\u7387\u3002 rsc = \"1\" #\u7f51\u5361\u63a5\u6536\u7aef\u5408\u5e76\u5f00\u5173\uff1b\u8bbe\u4e3a 1 \u8868\u793a\u5f00\u542f\uff0c\u8bbe\u4e3a 0 \u8868\u793a\u5173\u95ed\uff1b\u5728\u6709\u4e9b\u8f83\u65b0\u7684\u7f51\u5361\u9a71\u52a8\u4e2d\uff0c\u5e26\u6709 RSC \u7b97\u6cd5\u7684\uff0c\u9700\u8981\u6253\u5f00\u8be5\u529f\u80fd\u3002 l2wQLimit = \"512 4096\" #\u4ece LAN \u5230 WAN \u52a0\u901f\u5f15\u64ce\u5728\u7f13\u51b2\u6c60\u5145\u6ee1\u548c\u7a7a\u95f2\u65f6\u5206\u522b\u80fd\u591f\u7f13\u5b58\u7684\u6570\u636e\u5305\u961f\u5217\u7684\u957f\u5ea6\u7684\u4e0a\u9650\uff1b\u8be5\u503c\u8bbe\u7f6e\u7684\u9ad8\u4f1a\u83b7\u5f97\u66f4\u597d\u7684\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58 w2lQLimit = \"512 4096\" #\u4ece WAN \u5230 LAN \u52a0\u901f\u5f15\u64ce\u5728\u7f13\u51b2\u6c60\u5145\u6ee1\u548c\u7a7a\u95f2\u65f6\u5206\u522b\u80fd\u591f\u7f13\u5b58\u7684\u6570\u636e\u5305\u961f\u5217\u7684\u957f\u5ea6\u7684\u4e0a\u9650\uff1b\u8be5\u503c\u8bbe\u7f6e\u7684\u9ad8\u4f1a\u83b7\u5f97\u66f4\u597d\u7684\u52a0\u901f\u6548\u679c\uff0c\u4f46\u662f\u4f1a\u6d88\u8017\u66f4\u591a\u7684\u5185\u5b58 \u91cd\u8bfb\u914d\u7f6e\u4ee5\u4f7f\u914d\u7f6e\u751f\u6548/serverspeeder/bin/serverSpeeder.sh reload \u67e5\u770b\u9510\u901f\u5f53\u524d\u72b6\u6001/serverspeeder/bin/serverSpeeder.sh stats \u67e5\u770b\u6240\u6709\u547d\u4ee4/serverspeeder/bin/serverSpeeder.sh help \u505c\u6b62/serverspeeder/bin/serverSpeeder.sh stop \u542f\u52a8/serverspeeder/bin/serverSpeeder.sh start \u91cd\u542f\u9510\u901f/serverspeeder/bin/serverSpeeder.sh restart 1 .4 \u5f00\u542fTCP Fast Open \u8fd9\u4e2a\u9700\u8981\u670d\u52a1\u5668\u548c\u5ba2\u6237\u7aef\u90fd\u662fLinux 3 .7+\u7684\u5185\u6838\uff0c\u4e00\u822cLinux\u7684\u670d\u52a1\u5668\u53d1\u884c\u7248\u53ea\u6709debian jessie\u67093.7+\u7684\uff0c\u5ba2\u6237\u7aef\u7528Linux\u66f4\u662f\u73cd\u7a00\u52a8\u7269\uff0c\u6240\u4ee5\u8fd9\u4e2a\u4e0d\u591a\u8bf4\uff0c\u5982\u679c\u4f60\u7684\u670d\u52a1\u5668\u7aef\u548c\u5ba2\u6237\u7aef\u90fd\u662fLinux 3 .7+\u7684\u5185\u6838\uff0c\u90a3\u5c31\u5728\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u7684vi /etc/sysctl.conf\u6587\u4ef6\u4e2d\u518d\u52a0\u4e0a\u4e00\u884c\u3002 # turn on TCP Fast Open on both client and server side net.ipv4.tcp_fastopen = 3 \u7136\u540e\u628avi /etc/shadowsocks.json\u914d\u7f6e\u6587\u4ef6\u4e2d \"fast_open\" : false\u6539\u4e3a \"fast_open\" : true\u3002\u8fd9\u6837\u901f\u5ea6\u4e5f\u5c06\u4f1a\u6709\u975e\u5e38\u663e\u8457\u7684\u63d0\u5347\u3002 1 . \u52a0\u5bc6\u5c42\u9762 ####2.1 \u5b89\u88c5M2Crypto \u8fd9\u4e2a\u53ef\u4ee5\u63d0\u9ad8SS\u7684\u52a0\u5bc6\u901f\u5ea6\uff0c\u5b89\u88c5\u529e\u6cd5\uff1a Debian/Ubuntu apt-get install python-m2crypto \u5b89\u88c5\u4e4b\u540e\u91cd\u542fSS\uff0c\u901f\u5ea6\u5c06\u4f1a\u6709\u4e00\u5b9a\u7684\u63d0\u5347 CentOS \u5148\u5b89\u88c5\u4f9d\u8d56\u5305\uff1a yum install -y openssl-devel gcc swig python-devel autoconf libtool \u5b89\u88c5setuptools\uff1a wget --no-check-certificate https://raw.githubusercontent.com/iMeiji/shadowsocks_install/master/ez_setup.py python ez_setup.py install \u518d\u901a\u8fc7pip\u5b89\u88c5M2Crypto\uff1a pip install M2Crypto \u6216\u8005pip install M2Crypto --upgrade 2 .3 \u4f7f\u7528CHACHA20\u52a0\u5bc6\u7b97\u6cd5 \u9996\u5148\uff0c\u5b89\u88c5libsodium\uff0c\u8ba9\u7cfb\u7edf\u652f\u6301chacha20\u7b97\u6cd5\u3002 Debian/Ubuntu apt-get install build-essential wget https://download.libsodium.org/libsodium/releases/LATEST.tar.gz tar xf LATEST.tar.gz && cd libsodium* ./configure && make && make install \u8fd0\u884c\u547d\u4ee4:ldconfig CentOS yum groupinstall \"Development Tools\" wget https://download.libsodium.org/libsodium/releases/LATEST.tar.gz tar zxf LATEST.tar.gz cd libsodium* ./configure make make install vi /etc/ld.so.conf \u6dfb\u52a0\u4e00\u884c\uff1a /usr/local/lib \u4fdd\u5b58\u9000\u51fa\u540e\uff0c\u8fd0\u884c\u547d\u4ee4\uff1a ldconfig \u7136\u540e\u4fee\u6539ss\u52a0\u5bc6\u65b9\u5f0f\uff1a vi /etc/shadowsocks.json \"method\" : \"aes-256-cfb\" \u6539\u6210 \"method\" : \"chacha20\" ,\u91cd\u542fSS\u5373\u53ef/etc/init.d/shadowsocks restart 3 .\u7f51\u7edc\u5c42\u9762 \u6b64\u5916\uff0c\u9009\u62e9\u5408\u9002\u7684\u7aef\u53e3\u4e5f\u80fd\u4f18\u5316\u68af\u5b50\u7684\u901f\u5ea6\uff0c\u5e7f\u5927SS\u7528\u6237\u7684\u5b9e\u8df5\u7ecf\u9a8c\u8868\u660e\uff0c\u68c0\u67e5\u7ad9\uff08GFW\uff09\u5b58\u5728\u4e00\u79cd\u673a\u5236\u6765\u964d\u4f4e\u81ea\u8eab\u7684\u8fd0\u7b97\u538b\u529b\uff0c\u5373\u5e38\u7528\u7684\u534f\u8bae\u7aef\u53e3\uff08\u5982http\uff0csmtp\uff0cssh\uff0chttps\uff0cftp\u7b49\uff09\u7684\u68c0\u67e5\u8f83\u5c11\uff0c\u6240\u4ee5\u5efa\u8baeSS\u7ed1\u5b9a\u8fd9\u4e9b\u5e38\u7528\u7684\u7aef\u53e3\uff08\u5982\uff1a21\uff0c22\uff0c25\uff0c80\uff0c443\uff09\uff0c\u901f\u5ea6\u4e5f\u4f1a\u6709\u663e\u8457\u63d0\u5347\u3002 \u5982\u679c\u4f60\u8fd8\u8981\u7ed9\u5c0f\u4f19\u4f34\u722c\uff0c\u90a3\u6211\u5efa\u8bae\u5f00\u542f\u591a\u4e2a\u7aef\u53e3\u800c\u4e0d\u662f\u5171\u7528\uff0c\u8fd9\u6837\u7f51\u7edc\u4f1a\u66f4\u52a0\u987a\u7545\u3002 3 .1 \u9632\u706b\u5899\u8bbe\u7f6e\uff08\u5982\u6709\uff09 \u81ea\u52a8\u8c03\u6574MTU iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu \u5f00\u542f NAT \uff08\u8bb0\u5f97\u628a eth0 \u6539\u6210\u81ea\u5df1\u7684\u7f51\u5361\u540d\uff0copenvz \u7684\u57fa\u672c\u662f venet0 \uff09 iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE \u5f00\u542f IPv4 \u7684\u8f6c\u53d1 sysctl -w net.ipv4.ip_forward = 1 \u6253\u5f00 443 \u7aef\u53e3 iptables -I INPUT -p tcp --dport 443 -j ACCEPT iptables -I INPUT -p udp --dport 443 -j ACCEPT \u91cd\u542f\u9632\u706b\u5899iptables\uff1a service iptables restart","title":"TCP\u4f18\u5316"},{"location":"Others/#shadowsocks_3","text":"#!/usr/bin/env bash #=================================================================# # System Required: CentOS, Debian, Ubuntu # # Description: Check Shadowsocks Server is running or not # # Author: Teddysun <i@teddysun.com> # # Visit: https://shadowsocks.be/6.html # #=================================================================# name =( Shadowsocks Shadowsocks-Python ShadowsocksR Shadowsocks-Go Shadowsocks-libev ) path = /var/log [[ ! -d ${ path } ]] && mkdir -p ${ path } log = ${ path } /shadowsocks-crond.log shadowsocks_init [ 0 ]= /etc/init.d/shadowsocks shadowsocks_init [ 1 ]= /etc/init.d/shadowsocks-python shadowsocks_init [ 2 ]= /etc/init.d/shadowsocks-r shadowsocks_init [ 3 ]= /etc/init.d/shadowsocks-go shadowsocks_init [ 4 ]= /etc/init.d/shadowsocks-libev i = 0 for init in ${ shadowsocks_init [@] } ; do pid = \"\" if [ -f ${ init } ] ; then ss_status = ` ${ init } status ` if [ $? -eq 0 ] ; then pid = ` echo $ss_status | sed 's/[^0-9]*//g' ` fi if [ -z ${ pid } ] ; then echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } is not running\" >> ${ log } echo \"`date +\" %Y-%m-%d %H:%M:%S \"` Starting ${ name [ $i ] } \" >> ${ log } ${ init } start & >/dev/null if [ $? -eq 0 ] ; then echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } start success\" >> ${ log } else echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } start failed\" >> ${ log } fi else echo \"`date +\" %Y-%m-%d %H:%M:%S \"` ${ name [ $i ] } is running with pid $pid \" >> ${ log } fi fi (( i++ )) done","title":"shadowsocks\u5b9a\u65f6\u811a\u672c"},{"location":"Others/#pptpd-vpn","text":"\u4e00\u3001pptpd\u5b89\u88c5 1 .\u67e5\u770b\u662f\u5426\u5b89\u88c5\u4e86dkms: rpm -q dkms \u82e5\u672a\u5b89\u88c5\uff0c\u5219\uff1a rpm -ivh dkms-2.0.17.5-1.noarch.rpm, 2 .\u67e5\u770b\u662f\u5426\u652f\u6301ppp rpm -q ppp \u67e5\u770b\u5df2\u5b89\u88c5\u7684ppp\uff0c\u662f\u5426\u652f\u6301MPPE strings '/usr/sbin/pppd' | grep -i mppe | wc -l \u82e5\u7ed3\u679c\u663e\u793a\u4e3a0\u8868\u793a\u4e0d\u652f\u6301\uff0c\u663e\u793a\u4e00\u8f83\u5927\u7684\u6570\u8868\u793a\u652f\u6301 \u4e0d\u652f\u6301\u7684\u8bdd\uff0c\u4e0b\u9ad8\u7248\u672c\u5b89\u88c5 3 .\u67e5\u770bpptpd\u7248\u672c rpm -q pptpd \u82e5\u672a\u5b89\u88c5\uff0c\u5219\u5b89\u88c5 rpm -ivh pptpd-1.*.**.rpm 4 .\u786e\u4fddlinux\u5185\u6838\u652f\u6301MPPE\u52a0\u5bc6\u534f\u8bae \u5185\u6838\u7248\u672c\u4f4e\u4e8e2.6.14\u8981\u5b89\u88c5\u4e00MPPE\u5185\u6838\u8865\u4e01 rpm -ivh kernel-mppe-2.4.20-8.i686.rpm \u5b89\u88c5\u540e\u68c0\u67e5kernel MPPE\u662f\u5426\u5b89\u88c5\u6210\u529f # modprobe ppp-compress-18 && echo \"OK\" i386\u7248\u672c\u572864\u4f4d\u673a\u5668\u4e0a\u53ef\u4ee5\u88c5\uff0c\u4f46\u88c5\u5b8c\u540e\u62e8\u53f7\u4e0d\u80fd\u4f7f\u7528 \u914d\u7f6e /etc/pptpd.conf\u3001/ETC/PPP/OPTIONS.PPTPD ,/etc/ppp/chap-secrets\u4e09\u4e2a\u6587\u4ef6\u542b\u6709\u914d\u7f6e\u4fe1\u606f /etc/pptpd.conf\u4e2d\u914d\u7f6edebug\u4fe1\u606f\u3001ppp\u7ec4\u4ef6\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6\u3001localip\u548cremoteip localip\u662fVPN\u670d\u52a1\u5668\u7684\u5730\u5740\uff0cremoteip\u662fVPN\u670d\u52a1\u5668\u5206\u7ed9\u5ba2\u6237\u7aef\u7684IP ( \u53ef\u4ee5\u662f\u4e00\u4e2a\u7f51\u6bb5 ) debug------\u628a\u6240\u6709debug\u4fe1\u606f\u8bb0\u5165\u7cfb\u7edf\u65e5\u5fd7/var/log/messages option /etc/ppp/options.pptpd------------PPP\u7ec4\u4ef6\u5c06\u4f7f\u7528\u7684\u914d\u7f6e\u6587\u4ef6 localip 221 .6.15.150--------------\u5206\u914d\u7ed9VPN\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u4efb\u610f\u8d77 remoteip 192 .168.1.1-100--VPN\u670d\u52a1\u5668\u5206\u914d\u7ed9\u5ba2\u6237\u7aef\u7684IP\u6bb5\uff0c\u53ef\u4ee5\u4efb\u610f\u8d77 /etc/ppp/options.pptpd \u914d\u7f6edns\u7b49 \u914d\u7f6e/etc/ppp/chap-secrets\u6587\u4ef6 chap-secrets\u6587\u4ef6\u4e2d\u89c4\u5b9a\u4e86\u5ba2\u6237\u7aef\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u3001\u670d\u52a1\u7a0b\u5e8f\u3001IP\u5730\u5740 \u5982\uff1axyz * 123456 * \u201cxyx\u201d\u662fClient\u7aef\u7684VPN\u7528\u6237\u540d\uff1b\u201cserver\u201d\u5bf9\u5e94\u7684\u662fVPN\u670d\u52a1\u5668\u7684\u540d\u5b57\uff0c\u8be5\u540d\u5b57\u5fc5\u987b\u548c/etc/ppp/options.pptpd\u6587\u4ef6\u4e2d\u6307\u660e\u7684\u4e00\u6837\uff0c\u6216\u8005\u8bbe \u7f6e\u6210\u201c*\u201d\u53f7\u6765\u8868\u793a\u81ea\u52a8\u8bc6\u522b\u670d\u52a1\u5668\uff1b\u201csecret\u201d\u5bf9\u5e94\u7684\u662f\u767b\u5f55\u5bc6\u7801\uff1b\u201cIP addresses\u201d\u5bf9\u7684\u662f\u53ef\u4ee5\u62e8\u5165\u7684\u5ba2\u6237\u7aefIP\u5730\u5740\uff0c\u5982\u679c\u4e0d\u9700\u8981\u505a\u7279\u522b\u9650 \u5236\uff0c\u53ef\u4ee5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u201c*\u201d\u53f7 \u8fde\u63a5\u6d4b\u8bd5 OPENVPN \u670d\u52a1\u5668\u67b6\u8bbe \u5b89\u88c5 \u5728\u7ebf\u5b89\u88c5. Yum \u2013y install openvpn* lzo* libpcap* \u914d\u7f6e \u590d\u5236\u6837\u672c\u6587\u4ef6\u5230\u4e3b\u76ee\u5f55 /etc/openvpn cp -a /usr/share/openvpn/easy-rsa/2.0/ /etc/openvpn/ \u590d\u5236\u6837\u672c\u914d\u7f6e\u6587\u4ef6\u5230\u4e3b\u76ee\u5f55 /etc/openvpn/ cp /usr/share/doc/openvpn-2.1/sample-config-files/server.conf /etc/openvpn source ./vars ./clean-all ./build-ca ./build-key-server server ./build-key client ./build-dh \u590d\u5236server keys cp /etc/openvpn/easy-rsa/2.0/keys/ca.* /etc/openvpn/ cp /etc/openvpn/easy-rsa/2.0/keys/server.* /etc/openvpn/ \u590d\u5236dh cp /etc/openvpn/easy-rsa/2.0/keys/dh1024.pem /etc/openvpn/ vi /etc/openvpn/server.conf ## http\u72b6\u6001\u7801 ``` markdown 1xx\uff08\u4e34\u65f6\u54cd\u5e94\uff09\u8868\u793a\u4e34\u65f6\u54cd\u5e94\u5e76\u9700\u8981\u8bf7\u6c42\u8005\u7ee7\u7eed\u6267\u884c\u64cd\u4f5c\u7684\u72b6\u6001\u4ee3\u7801\u3002 100 \uff08\u7ee7\u7eed\uff09\u8bf7\u6c42\u8005\u5e94\u5f53\u7ee7\u7eed\u63d0\u51fa\u8bf7\u6c42\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u8868\u793a\u5df2\u6536\u5230\u8bf7\u6c42\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u6b63\u5728\u7b49\u5f85\u5176\u4f59\u90e8\u5206\u3002 101 \uff08\u5207\u6362\u534f\u8bae\uff09\u8bf7\u6c42\u8005\u5df2\u8981\u6c42\u670d\u52a1\u5668\u5207\u6362\u534f\u8bae\uff0c\u670d\u52a1\u5668\u5df2\u786e\u8ba4\u5e76\u51c6\u5907\u5207\u6362\u3002 2xx \uff08\u6210\u529f\uff09\u8868\u793a\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\u7684\u72b6\u6001\u4ee3\u7801\u3002 200 \uff08\u6210\u529f\uff09\u670d\u52a1\u5668\u5df2\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\u3002\u901a\u5e38\uff0c\u8fd9\u8868\u793a\u670d\u52a1\u5668\u63d0\u4f9b\u4e86\u8bf7\u6c42\u7684\u7f51\u9875\u3002 201 \uff08\u5df2\u521b\u5efa\uff09\u8bf7\u6c42\u6210\u529f\u5e76\u4e14\u670d\u52a1\u5668\u521b\u5efa\u4e86\u65b0\u7684\u8d44\u6e90\u3002 202 \uff08\u5df2\u63a5\u53d7\uff09 \u670d\u52a1\u5668\u5df2\u63a5\u53d7\u8bf7\u6c42\uff0c\u4f46\u5c1a\u672a\u5904\u7406\u3002 203 \uff08\u975e\u6388\u6743\u4fe1\u606f\uff09\u670d\u52a1\u5668\u5df2\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u8fd4\u56de\u7684\u4fe1\u606f\u53ef\u80fd\u6765\u81ea\u53e6\u4e00\u6765\u6e90\u3002 204 \uff08\u65e0\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 205 \uff08\u91cd\u7f6e\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\u3002 206 \uff08\u90e8\u5206\u5185\u5bb9\uff09\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u90e8\u5206 GET \u8bf7\u6c42\u3002 3xx \uff08\u91cd\u5b9a\u5411\uff09\u8868\u793a\u8981\u5b8c\u6210\u8bf7\u6c42\uff0c\u9700\u8981\u8fdb\u4e00\u6b65\u64cd\u4f5c\u3002 \u901a\u5e38\uff0c\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u7528\u6765\u91cd\u5b9a\u5411\u3002 300 \uff08\u591a\u79cd\u9009\u62e9\uff09\u9488\u5bf9\u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u53ef\u6267\u884c\u591a\u79cd\u64cd\u4f5c\u3002 \u670d\u52a1\u5668\u53ef\u6839\u636e\u8bf7\u6c42\u8005 ( user agent ) \u9009\u62e9\u4e00\u9879\u64cd\u4f5c\uff0c\u6216\u63d0\u4f9b\u64cd\u4f5c\u5217\u8868\u4f9b\u8bf7\u6c42\u8005\u9009\u62e9\u3002 301 \uff08\u6c38\u4e45\u79fb\u52a8\uff09\u8bf7\u6c42\u7684\u7f51\u9875\u5df2\u6c38\u4e45\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff08\u5bf9 GET \u6216 HEAD \u8bf7\u6c42\u7684\u54cd\u5e94\uff09\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u8bf7\u6c42\u8005\u8f6c\u5230\u65b0\u4f4d\u7f6e\u3002 302 \uff08\u4e34\u65f6\u79fb\u52a8\uff09\u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002 303 \uff08\u67e5\u770b\u5176\u4ed6\u4f4d\u7f6e\uff09\u8bf7\u6c42\u8005\u5e94\u5f53\u5bf9\u4e0d\u540c\u7684\u4f4d\u7f6e\u4f7f\u7528\u5355\u72ec\u7684 GET \u8bf7\u6c42\u6765\u68c0\u7d22\u54cd\u5e94\u65f6\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 304 \uff08\u672a\u4fee\u6539\uff09\u81ea\u4ece\u4e0a\u6b21\u8bf7\u6c42\u540e\uff0c\u8bf7\u6c42\u7684\u7f51\u9875\u672a\u4fee\u6539\u8fc7\u3002 \u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\u65f6\uff0c\u4e0d\u4f1a\u8fd4\u56de\u7f51\u9875\u5185\u5bb9\u3002 305 \uff08\u4f7f\u7528\u4ee3\u7406\uff09\u8bf7\u6c42\u8005\u53ea\u80fd\u4f7f\u7528\u4ee3\u7406\u8bbf\u95ee\u8bf7\u6c42\u7684\u7f51\u9875\u3002 \u5982\u679c\u670d\u52a1\u5668\u8fd4\u56de\u6b64\u54cd\u5e94\uff0c\u8fd8\u8868\u793a\u8bf7\u6c42\u8005\u5e94\u4f7f\u7528\u4ee3\u7406\u3002 307 \uff08\u4e34\u65f6\u91cd\u5b9a\u5411\uff09\u670d\u52a1\u5668\u76ee\u524d\u4ece\u4e0d\u540c\u4f4d\u7f6e\u7684\u7f51\u9875\u54cd\u5e94\u8bf7\u6c42\uff0c\u4f46\u8bf7\u6c42\u8005\u5e94\u7ee7\u7eed\u4f7f\u7528\u539f\u6709\u4f4d\u7f6e\u6765\u8fdb\u884c\u4ee5\u540e\u7684\u8bf7\u6c42\u3002 4xx\uff08\u8bf7\u6c42\u9519\u8bef\uff09\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u8868\u793a\u8bf7\u6c42\u53ef\u80fd\u51fa\u9519\uff0c\u59a8\u788d\u4e86\u670d\u52a1\u5668\u7684\u5904\u7406\u3002 400 \uff08\u9519\u8bef\u8bf7\u6c42\uff09\u670d\u52a1\u5668\u4e0d\u7406\u89e3\u8bf7\u6c42\u7684\u8bed\u6cd5\u3002 401 \uff08\u672a\u6388\u6743\uff09\u8bf7\u6c42\u8981\u6c42\u8eab\u4efd\u9a8c\u8bc1\u3002 \u5bf9\u4e8e\u9700\u8981\u767b\u5f55\u7684\u7f51\u9875\uff0c\u670d\u52a1\u5668\u53ef\u80fd\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 403 \uff08\u7981\u6b62\uff09\u670d\u52a1\u5668\u62d2\u7edd\u8bf7\u6c42\u3002 404 \uff08\u672a\u627e\u5230\uff09\u670d\u52a1\u5668\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u7f51\u9875\u3002 405 \uff08\u65b9\u6cd5\u7981\u7528\uff09\u7981\u7528\u8bf7\u6c42\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u3002 406 \uff08\u4e0d\u63a5\u53d7\uff09\u65e0\u6cd5\u4f7f\u7528\u8bf7\u6c42\u7684\u5185\u5bb9\u7279\u6027\u54cd\u5e94\u8bf7\u6c42\u7684\u7f51\u9875\u3002 407 \uff08\u9700\u8981\u4ee3\u7406\u6388\u6743\uff09\u6b64\u72b6\u6001\u4ee3\u7801\u4e0e 401 \uff08\u672a\u6388\u6743\uff09\u7c7b\u4f3c\uff0c\u4f46\u6307\u5b9a\u8bf7\u6c42\u8005\u5e94\u5f53\u6388\u6743\u4f7f\u7528\u4ee3\u7406\u3002 408 \uff08\u8bf7\u6c42\u8d85\u65f6\uff09\u670d\u52a1\u5668\u7b49\u5019\u8bf7\u6c42\u65f6\u53d1\u751f\u8d85\u65f6\u3002 409 \uff08\u51b2\u7a81\uff09\u670d\u52a1\u5668\u5728\u5b8c\u6210\u8bf7\u6c42\u65f6\u53d1\u751f\u51b2\u7a81\u3002 \u670d\u52a1\u5668\u5fc5\u987b\u5728\u54cd\u5e94\u4e2d\u5305\u542b\u6709\u5173\u51b2\u7a81\u7684\u4fe1\u606f\u3002 410 \uff08\u5df2\u5220\u9664\uff09\u5982\u679c\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u6c38\u4e45\u5220\u9664\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u8fd4\u56de\u6b64\u54cd\u5e94\u3002 411 \uff08\u9700\u8981\u6709\u6548\u957f\u5ea6\uff09\u670d\u52a1\u5668\u4e0d\u63a5\u53d7\u4e0d\u542b\u6709\u6548\u5185\u5bb9\u957f\u5ea6\u6807\u5934\u5b57\u6bb5\u7684\u8bf7\u6c42\u3002 412 \uff08\u672a\u6ee1\u8db3\u524d\u63d0\u6761\u4ef6\uff09\u670d\u52a1\u5668\u672a\u6ee1\u8db3\u8bf7\u6c42\u8005\u5728\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u7684\u5176\u4e2d\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\u3002 413 \uff08\u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\uff09\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\uff0c\u8d85\u51fa\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u3002 414 \uff08\u8bf7\u6c42\u7684 URI \u8fc7\u957f\uff09\u8bf7\u6c42\u7684 URI\uff08\u901a\u5e38\u4e3a\u7f51\u5740\uff09\u8fc7\u957f\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u3002 415 \uff08\u4e0d\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b\uff09\u8bf7\u6c42\u7684\u683c\u5f0f\u4e0d\u53d7\u8bf7\u6c42\u9875\u9762\u7684\u652f\u6301\u3002 416 \uff08\u8bf7\u6c42\u8303\u56f4\u4e0d\u7b26\u5408\u8981\u6c42\uff09\u5982\u679c\u9875\u9762\u65e0\u6cd5\u63d0\u4f9b\u8bf7\u6c42\u7684\u8303\u56f4\uff0c\u5219\u670d\u52a1\u5668\u4f1a\u8fd4\u56de\u6b64\u72b6\u6001\u4ee3\u7801\u3002 417 \uff08\u672a\u6ee1\u8db3\u671f\u671b\u503c\uff09\u670d\u52a1\u5668\u672a\u6ee1\u8db3\u201d\u671f\u671b\u201d\u8bf7\u6c42\u6807\u5934\u5b57\u6bb5\u7684\u8981\u6c42\u3002 5xx\uff08\u670d\u52a1\u5668\u9519\u8bef\uff09\u8fd9\u4e9b\u72b6\u6001\u4ee3\u7801\u8868\u793a\u670d\u52a1\u5668\u5728\u5c1d\u8bd5\u5904\u7406\u8bf7\u6c42\u65f6\u53d1\u751f\u5185\u90e8\u9519\u8bef\u3002 \u8fd9\u4e9b\u9519\u8bef\u53ef\u80fd\u662f\u670d\u52a1\u5668\u672c\u8eab\u7684\u9519\u8bef\uff0c\u800c\u4e0d\u662f\u8bf7\u6c42\u51fa\u9519\u3002 500 \uff08\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\uff09\u670d\u52a1\u5668\u9047\u5230\u9519\u8bef\uff0c\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42\u3002 501 \uff08\u5c1a\u672a\u5b9e\u65bd\uff09\u670d\u52a1\u5668\u4e0d\u5177\u5907\u5b8c\u6210\u8bf7\u6c42\u7684\u529f\u80fd\u3002 \u4f8b\u5982\uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u8bc6\u522b\u8bf7\u6c42\u65b9\u6cd5\u65f6\u53ef\u80fd\u4f1a\u8fd4\u56de\u6b64\u4ee3\u7801\u3002 502 \uff08\u9519\u8bef\u7f51\u5173\uff09\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u65e0\u6548\u54cd\u5e94\u3002 503 \uff08\u670d\u52a1\u4e0d\u53ef\u7528\uff09\u670d\u52a1\u5668\u76ee\u524d\u65e0\u6cd5\u4f7f\u7528\uff08\u7531\u4e8e\u8d85\u8f7d\u6216\u505c\u673a\u7ef4\u62a4\uff09\u3002 \u901a\u5e38\uff0c\u8fd9\u53ea\u662f\u6682\u65f6\u72b6\u6001\u3002 504 \uff08\u7f51\u5173\u8d85\u65f6\uff09\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4f46\u662f\u6ca1\u6709\u53ca\u65f6\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u3002 505 \uff08HTTP \u7248\u672c\u4e0d\u53d7\u652f\u6301\uff09\u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u4e2d\u6240\u7528\u7684 HTTP \u534f\u8bae\u7248\u672c\u3002 RFC 6585 \u6700\u8fd1\u521a\u521a\u53d1\u5e03\uff0c\u8be5\u6587\u6863\u63cf\u8ff0\u4e86 4 \u4e2a\u65b0\u7684 HTTP \u72b6\u6001\u7801\u3002 HTTP \u534f\u8bae\u4e00\u76f4\u5728\u6f14\u53d8\uff0c\u65b0\u7684\u72b6\u6001\u7801\u5bf9\u4e8e\u5f00\u53d1 REST \u670d\u52a1\u6216\u8005\u8bf4\u662f\u57fa\u4e8e HTTP \u7684\u670d\u52a1\u975e\u5e38\u6709\u7528\uff0c\u4e0b\u9762\u8fd9\u56db\u4e2a\u65b0\u7684\u72b6\u6001\u7801\u4ee5\u53ca\u662f\u5426\u5e94\u8be5\u4f7f\u7528\u3002 428 Precondition Required ( \u8981\u6c42\u5148\u51b3\u6761\u4ef6 ) \u5148\u51b3\u6761\u4ef6\u662f\u5ba2\u6237\u7aef\u53d1\u9001 HTTP \u8bf7\u6c42\u65f6\uff0c\u5982\u679c\u60f3\u8981\u8bf7\u6c42\u80fd\u6210\u529f\u5fc5\u987b\u6ee1\u8db3\u4e00\u4e9b\u9884\u8bbe\u7684\u6761\u4ef6\u3002 \u4e00\u4e2a\u597d\u7684\u4f8b\u5b50\u5c31\u662f If-None-Match \u5934\uff0c\u7ecf\u5e38\u5728 GET \u8bf7\u6c42\u4e2d\u4f7f\u7528\uff0c\u5982\u679c\u6307\u5b9a\u4e86 If-None-Match \uff0c\u90a3\u4e48\u5ba2\u6237\u7aef\u53ea\u5728\u54cd\u5e94\u4e2d\u7684 ETag \u6539\u53d8\u540e\u624d\u4f1a\u91cd\u65b0\u63a5\u6536\u56de\u5e94\u3002 \u5148\u51b3\u6761\u4ef6\u7684\u53e6\u5916\u4e00\u4e2a\u4f8b\u5b50\u5c31\u662f If-Match \u5934\uff0c\u8fd9\u4e2a\u4e00\u822c\u7528\u5728 PUT \u8bf7\u6c42\u4e0a\u7528\u4e8e\u6307\u793a\u53ea\u66f4\u65b0\u6ca1\u88ab\u6539\u53d8\u7684\u8d44\u6e90\uff0c\u8fd9\u5728\u591a\u4e2a\u5ba2\u6237\u7aef\u4f7f\u7528 HTTP \u670d\u52a1\u65f6\u7528\u6765\u9632\u6b62\u5f7c\u6b64\u95f4\u4e0d\u4f1a\u8986\u76d6\u76f8\u540c\u5185\u5bb9\u3002 \u5f53\u670d\u52a1\u5668\u7aef\u4f7f\u7528 428 Precondition Required \u72b6\u6001\u7801\u65f6\uff0c\u8868\u793a\u5ba2\u6237\u7aef\u5fc5\u987b\u53d1\u9001\u4e0a\u8ff0\u7684\u8bf7\u6c42\u5934\u624d\u80fd\u6267\u884c\u8bf7\u6c42\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u4e00\u79cd\u6709\u6548\u7684\u65b9\u6cd5\u6765\u963b\u6b62 'lost update' \u95ee\u9898\u3002 429 Too Many Requests ( \u592a\u591a\u8bf7\u6c42 ) \u5f53\u4f60\u9700\u8981\u9650\u5236\u5ba2\u6237\u7aef\u8bf7\u6c42\u67d0\u4e2a\u670d\u52a1\u6570\u91cf\u65f6\uff0c\u8be5\u72b6\u6001\u7801\u5c31\u5f88\u6709\u7528\uff0c\u4e5f\u5c31\u662f\u8bf7\u6c42\u901f\u5ea6\u9650\u5236\u3002 \u5728\u6b64\u4e4b\u524d\uff0c\u6709\u4e00\u4e9b\u7c7b\u4f3c\u7684\u72b6\u6001\u7801\uff0c\u4f8b\u5982 '509 Bandwidth Limit Exceeded' . Twitter \u4f7f\u7528 420 \uff08\u8fd9\u4e0d\u662fHTTP\u5b9a\u4e49\u7684\u72b6\u6001\u7801\uff09 \u5982\u679c\u4f60\u5e0c\u671b\u9650\u5236\u5ba2\u6237\u7aef\u5bf9\u670d\u52a1\u7684\u8bf7\u6c42\u6570\uff0c\u53ef\u4f7f\u7528 429 \u72b6\u6001\u7801\uff0c\u540c\u65f6\u5305\u542b\u4e00\u4e2a Retry-After \u54cd\u5e94\u5934\u7528\u4e8e\u544a\u8bc9\u5ba2\u6237\u7aef\u591a\u957f\u65f6\u95f4\u540e\u53ef\u4ee5\u518d\u6b21\u8bf7\u6c42\u670d\u52a1\u3002 431 Request Header Fields Too Large ( \u8bf7\u6c42\u5934\u5b57\u6bb5\u592a\u5927 ) \u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u53d1\u9001 HTTP \u8bf7\u6c42\u5934\u4f1a\u53d8\u5f97\u5f88\u5927\uff0c\u90a3\u4e48\u670d\u52a1\u5668\u53ef\u53d1\u9001 431 Request Header Fields Too Large \u6765\u6307\u660e\u8be5\u95ee\u9898\u3002 511 Network Authentication Required ( \u8981\u6c42\u7f51\u7edc\u8ba4\u8bc1 ) \u5bf9\u6211\u6765\u8bf4\u8fd9\u4e2a\u72b6\u6001\u7801\u5f88\u6709\u8da3\uff0c\u5982\u679c\u4f60\u5728\u5f00\u53d1\u4e00\u4e2a HTTP \u670d\u52a1\u5668\uff0c\u4f60\u4e0d\u4e00\u5b9a\u9700\u8981\u5904\u7406\u8be5\u72b6\u6001\u7801\uff0c\u4f46\u5982\u679c\u4f60\u5728\u7f16\u5199 HTTP \u5ba2\u6237\u7aef\uff0c\u90a3\u8fd9\u4e2a\u72b6\u6001\u7801\u5c31\u975e\u5e38\u91cd\u8981","title":"PPTPD VPN\u670d\u52a1\u5668\u67b6\u8bbe"},{"location":"Others/#sipcode","text":"1 xx = \u901a\u77e5\u6027\u5e94\u7b54 100 \u6b63\u5728\u5c1d\u8bd5 180 \u6b63\u5728\u62e8\u6253 181 \u6b63\u88ab\u8f6c\u63a5 182 \u6b63\u5728\u6392\u961f 183 \u901a\u8bdd\u8fdb\u5c55 2 xx = \u6210\u529f\u5e94\u7b54 200 OK 202 \u88ab\u63a5\u53d7\uff1a\u7528\u4e8e\u8f6c\u4ecb 3 xx = \u8f6c\u63a5\u5e94\u7b54 300 \u591a\u9879\u9009\u62e9 301 \u88ab\u6c38\u4e45\u8fc1\u79fb 302 \u88ab\u6682\u65f6\u8fc1\u79fb 305 \u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668 380 \u66ff\u4ee3\u670d\u52a1 4 xx = \u547c\u53eb\u5931\u8d25 400 \u547c\u53eb\u4e0d\u5f53 401 \u672a\u7ecf\u6388\u6743\uff1a\u53ea\u4f9b\u6ce8\u518c\u673a\u6784\u4f7f\u7528\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u5e94\u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u5668\u6388\u6743 407 402 \u8981\u6c42\u4ed8\u8d39\uff08\u9884\u8ba2\u4e3a\u5c06\u6765\u4f7f\u7528 ) 403 \u88ab\u7981\u6b62\u7684 404 \u672a\u53d1\u73b0\uff1a\u672a\u53d1\u73b0\u7528\u6237 405 \u4e0d\u5141\u8bb8\u7684\u65b9\u6cd5 406 \u4e0d\u53ef\u63a5\u53d7 407 \u9700\u8981\u4ee3\u7406\u670d\u52a1\u5668\u6388\u6743 408 \u547c\u53eb\u8d85\u65f6\uff1a\u5728\u9884\u5b9a\u65f6\u95f4\u5185\u65e0\u6cd5\u627e\u5230\u7528\u6237 410 \u5df2\u6d88\u5931\uff1a\u7528\u6237\u66fe\u7ecf\u5b58\u5728\uff0c\u4f46\u5df2\u4ece\u6b64\u5904\u6d88\u5931 413 \u547c\u53eb\u5b9e\u4f53\u8fc7\u5927 414 \u547c\u53eb URI\u8fc7\u957f 415 \u4e0d\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b 416 \u4e0d\u652f\u6301\u7684 URI\u65b9\u6848 420 \u4e0d\u5f53\u6269\u5c55\uff1a\u4f7f\u7528\u4e86\u4e0d\u5f53 SIP\u534f\u8bae\u6269\u5c55 \uff0c\u670d\u52a1\u5668\u65e0\u6cd5\u7406\u89e3\u8be5\u6269\u5c55 421 \u9700\u8981\u6269\u5c55 423 \u65f6\u95f4\u95f4\u9694\u8fc7\u77ed 480 \u6682\u65f6\u4e0d\u53ef\u4f7f\u7528 481 \u901a\u8bdd / \u4e8b\u52a1\u4e0d\u5b58\u5728 482 \u68c0\u6d4b\u5230\u5faa\u73af 483 \u8df3\u6570\u8fc7\u591a 484 \u5730\u5740\u4e0d\u5168 485 \u6a21\u7cca\u4e0d\u6e05 486 \u6b64\u5904\u592a\u5fd9 487 \u547c\u53eb\u88ab\u7ec8\u6b62 488 \u6b64\u5904\u4e0d\u53ef\u63a5\u53d7 491 \u547c\u53eb\u5f85\u6279 493 \u65e0\u6cd5\u89e3\u8bfb\uff1a\u65e0\u6cd5\u89e3\u8bfb S / MIME\u6587\u4f53\u90e8\u5206 5 xx = \u670d\u52a1\u5668\u5931\u8d25 500 \u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef 501 \u65e0\u6cd5\u5b9e\u65bd\uff1a SIP\u547c\u53eb\u65b9\u6cd5\u5728\u6b64\u5904\u65e0\u6cd5\u5b9e\u65bd 502 \u4e0d\u5f53\u7f51\u5173 503 \u670d\u52a1\u4e0d\u53ef\u4f7f\u7528 504 \u670d\u52a1\u5668\u8d85\u65f6 505 \u4e0d\u652f\u6301\u8be5\u7248\u672c\uff1a\u670d\u52a1\u5668\u4e0d\u652f\u6301 SIP\u534f\u8bae\u7684\u8fd9\u4e2a\u7248\u672c 513 \u6d88\u606f\u8fc7\u957f 6 xx = \u5168\u5c40\u5931\u8d25 600 \u5404\u5904\u5747\u5fd9 603 \u62d2\u7edd 604 \u65e0\u5904\u5b58\u5728 606 \u4e0d\u53ef\u4f7f\u7528","title":"SipCode"},{"location":"Others/#sip","text":"\u5e94\u7b54\u7801\u662f\u5305\u542b\u4e86\uff0c\u5e76\u4e14\u6269\u5c55\u4e86 HTTP / 1 . 1 \u5e94\u7b54\u7801\u3002\u5e76\u4e0d\u662f\u6240\u6709\u7684 HTTP / 1 . 1 \u5e94\u7b54\u7801\u90fd\u9002\u5f53\u5e94\u7528\uff0c\u53ea\u6709\u5728\u6298\u91cc\u6307\u51fa\u7684\u662f\u9002\u5f53\u7684\u3002\u5176\u4ed6 HTTP / 1 . 1 \u5e94\u7b54\u7801\u4e0d\u5e94\u5f53\u4f7f\u7528\u3002\u5e76\u4e14\uff0c SIP \u4e5f\u5b9a\u4e49\u4e86\u65b0\u7684\u5e94\u7b54\u7801\u7cfb\u5217\uff0c 6 xx \u3002 1 \u4e34\u65f6\u5e94\u7b54 1 xx \u4e34\u65f6\u5e94\u7b54\uff0c\u4e5f\u5c31\u662f\u6d88\u606f\u6027\u8d28\u7684\u5e94\u7b54\uff0c\u6807\u5fd7\u4e86\u5bf9\u65b9\u670d\u52a1\u5668\u6b63\u5728\u5904\u7406\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd8\u6ca1\u6709\u51b3\u5b9a\u6700\u540e\u7684\u5e94\u7b54\u3002\u5982\u679c\u670d\u52a1\u5668\u5904\u7406\u8bf7\u6c42\u9700\u8981\u82b1 200 ms \u4ee5\u4e0a\u624d\u80fd\u4ea7\u751f\u7ec8\u7ed3\u5e94\u7b54\u7684\u65f6\u5019\uff0c\u5b83\u5e94\u5f53\u53d1\u9001\u4e00\u4e2a 1 xx \u5e94\u7b54\u3002 \u6ce8\u610f 1 xx \u5e94\u7b54\u5e76\u4e0d\u662f\u53ef\u9760\u4f20\u8f93\u7684\u3002\u4ed6\u4eec\u4e0d\u4f1a\u5bfc\u81f4\u5ba2\u6237\u7aef\u4f20\u9001\u4e00\u4e2a ACK \u5e94\u7b54\u3002\u4e34\u65f6\u6027\u8d28\u7684\uff08 1 xx \uff09\u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u6d88\u606f\u4f53\uff0c\u5305\u542b\u4f1a\u8bdd\u63cf\u8ff0\u3002 1 . 1 100 Trying \u8fd9\u4e2a\u5e94\u7b54\u8868\u793a\u4e0b\u4e00\u4e2a\u8282\u70b9\u7684\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u8fd9\u4e2a\u8bf7\u6c42\u5e76\u4e14\u8fd8\u6ca1\u6709\u6267\u884c\u8fd9\u4e2a\u8bf7\u6c42\u7684\u7279\u5b9a\u52a8\u4f5c\uff08\u6bd4\u5982\uff0c\u6b63\u5728\u6253\u5f00\u6570\u636e\u5e93\u7684\u65f6\u5019\uff09\u3002\u8fd9\u4e2a\u5e94\u7b54\uff0c\u5c31\u50cf\u5176\u4ed6\u4e34\u65f6\u5e94\u7b54\u4e00\u6837\uff0c\u79cd\u690d\u4e86 UAC \u91cd\u65b0\u4f20\u9001 INVITE \u8bf7\u6c42\u3002 100 ( Trying ) \u5e94\u7b54\u548c\u5176\u4ed6\u4e34\u65f6\u5e94\u7b54\u4e0d\u540c\u7684\u662f\uff0c\u5728\u8fd9\u91cc\uff0c\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6709\u72b6\u6001 proxy \u8f6c\u53d1\u5230\u4e0a\u884c\u6d41\u4e2d\u3002 1 . 2 180 Ringing UA \u6536\u5230 INVITE \u8bf7\u6c42\u5e76\u4e14\u8bd5\u56fe\u63d0\u793a\u7ed9\u7528\u6237\u3002\u8fd9\u4e2a\u5e94\u7b54\u5e94\u5f53\u51fa\u4e16\u5316\u4e00\u4e2a\u672c\u5730\u56de\u94c3\u3002 1 . 3 818 Call is Being Forwarded ( \u547c\u53eb\u88ab\u8f6c\u53d1 ) \u670d\u52a1\u5668\u53ef\u4ee5\u7528\u8fd9\u4e2a\u5e94\u7b54\u4ee3\u7801\u6765\u8868\u793a\u547c\u53eb\u6b63\u5728\u8f6c\u53d1\u5230\u53e6\u4e00\u4e2a\u76ee\u7684\u5730\u96c6\u5408\u3002 1 . 4 182 Queued \u5f53\u547c\u53eb\u7684\u5bf9\u65b9\u6682\u65f6\u4e0d\u80fd\u63a5\u6536\u547c\u53eb\u7684\u65f6\u5019\uff0c\u5e76\u4e14\u670d\u52a1\u5668\u51b3\u5b9a\u5c06\u547c\u53eb\u6392\u961f\u7b49\u5019\uff0c\u800c\u4e0d\u662f\u62d2\u7edd\u547c\u53eb\u7684\u65f6\u5019\uff0c\u90a3\u4e48\u5c31\u5e94\u5f53\u53d1\u51fa\u8fd9\u4e2a\u5e94\u7b54\u3002\u5f53\u88ab\u53eb\u65b9\u4e00\u65e6\u6062\u590d\u63a5\u6536\u547c\u53eb\uff0c\u4ed6\u4f1a\u8fd4\u56de\u5408\u9002\u7684\u7ec8\u7ed3\u5e94\u7b54\u3002\u5bf9\u4e8e\u8fd9\u4e2a\u547c\u53eb\u72b6\u6001\uff0c\u53ef\u4ee5\u6709\u4e00\u4e2a\u8868\u793a\u539f\u56e0\u7684\u77ed\u8bed\uff0c\u6bd4\u5982\uff1a\u201d 5 calls queued ;expected waiting time is 15minutes\u201d\u3002\u670d\u52a1\u5668\u53ef\u4ee5\u7ed9\u51fa\u597d\u51e0\u4e2a182\uff08Queued\uff09\u5e94\u7b54\u544a\u8bc9\u547c\u53eb\u65b9\u6392\u961f\u7684\u60c5\u51b5\uff08\u6bd4\u5982\u6392\u961f\u9760\u524d\u4e86\u7b49\u7b49\uff09\u3002 1 . 5 183 \u4f1a\u8bdd\u8fdb\u5ea6 183 \uff08 Session Progress \uff09\u5e94\u7b54\u7528\u4e8e\u63d0\u793a\u5efa\u7acb\u5bf9\u8bdd\u7684\u8fdb\u5ea6\u4fe1\u606f\u3002 Reason - Phrase \uff08\u8868\u8fbe\u539f\u56e0\u7684\u53e5\u5b50\uff09\u3001\u5934\u57df\u6216\u8005\u6d88\u606f\u4f53\u53ef\u4ee5\u7528\u4e8e\u63d0\u793a\u547c\u53eb\u8fdb\u5ea6\u7684\u66f4\u6d88\u606f\u7684\u4fe1\u606f\u3002 2 \u6210\u529f\u4fe1\u606f 2 xx \u8fd9\u4e2a\u5e94\u7b54\u8868\u793a\u8bf7\u6c42\u662f\u6210\u529f\u7684\u3002 2 . 1 200 OK \u8bf7\u6c42\u5df2\u7ecf\u5904\u7406\u6210\u529f\u3002\u8fd9\u4e2a\u4fe1\u606f\u53d6\u51b3\u4e8e\u4e0d\u540c\u65b9\u6cd5\u7684\u8bf7\u6c42\u7684\u5e94\u7b54\u3002 3 \u8f6c\u53d1\u8bf7\u6c42 3 XX 3 xx \u7cfb\u5217\u7684\u5e94\u7b54\u662f\u7528\u4e8e\u63d0\u793a\u7528\u6237\u7684\u65b0\u4f4d\u7f6e\u4fe1\u606f\u7684\uff0c\u6216\u8005\u4e3a\u4e86\u6ee1\u8db3\u547c\u53eb\u800c\u8f6c\u53d1\u7684\u989d\u5916\u670d\u52a1\u5730\u70b9\u3002 3 . 1 300 Multiple Choices \u8bf7\u6c42\u7684\u5730\u5740\u6709\u591a\u4e2a\u9009\u62e9\uff0c\u6bcf\u4e2a\u9009\u62e9\u90fd\u6709\u81ea\u5df1\u7684\u5730\u5740\uff0c\u7528\u6237\u6216\u8005\uff08 UA \uff09\u53ef\u4ee5\u9009\u62e9\u5408\u9002\u7684\u901a\u8baf\u7ec8\u7aef\uff0c\u5e76\u4e14\u8f6c\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u5230\u8fd9\u4e2a\u5730\u5740\u3002 \u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u4e00\u4e2a\u5177\u6709\u6bcf\u4e00\u4e2a\u5730\u70b9\u7684\u5728 Accept \u8bf7\u6c42\u5934\u57df\u4e2d\u5141\u8bb8\u7684\u8d44\u6e90\u7279\u6027\uff0c\u8fd9\u6837\u7528\u6237\u6216\u8005 UA \u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a\u6700\u5408\u9002\u7684\u5730\u5740\u6765\u8f6c\u53d1\u8bf7\u6c42\u3002\u6ca1\u6709\u672a\u8fd9\u4e2a\u5e94\u7b54\u7684\u6d88\u606f\u4f53\u5b9a\u4e49 MIME \u7c7b\u578b\u3002 \u8fd9\u4e9b\u5730\u5740\u9009\u62e9\u4e5f\u5e94\u5f53\u5728 Contact \u5934\u57df\u4e2d\u5217\u51fa\uff08 20 . 10 \u8282\uff09\u3002\u4e0d\u540c\u4e8e HTTP \uff0c SIP \u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u591a\u4e2a Contact \u5934\u57df\u6216\u8005\u4e00\u4e2a Contact \u5934\u57df\u4e2d\u5177\u6709\u4e00\u4e2a\u5730\u5740\u5217\u8868\u3002 UA \u53ef\u4ee5\u4f7f\u7528 Contact \u5934\u57df\u6765\u81ea\u52a8\u8f6c\u53d1\u6216\u8005\u8981\u6c42\u7528\u6237\u786e\u8ba4\u8f6c\u53d1\u3002\u4e0d\u8fc7\uff0c\u672c\u89c4\u8303\u6ca1\u6709\u5b9a\u4e49\u81ea\u52a8\u8f6c\u53d1\u7684\u6807\u51c6\u3002 \u5982\u679c\u88ab\u53eb\u65b9\u53ef\u4ee5\u5728\u591a\u4e2a\u5730\u5740\u88ab\u627e\u5230\uff0c\u5e76\u4e14\u670d\u52a1\u5668\u4e0d\u80fd\u6216\u8005\u4e0d\u613f\u610f\u8f6c\u53d1\u8bf7\u6c42\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u6765\u7ed9\u547c\u53eb\u65b9\u3002 3 . 2 301 Moved Permently \u5f53\u4e0d\u80fd\u5728 Request - URI \u6307\u5b9a\u7684\u5730\u5740\u627e\u5230\u7528\u6237\u7684\u65f6\u5019\uff0c\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u5e94\u5f53\u4f7f\u7528 Contact \u5934\u57df ( 20 . 10 ) \u6240\u6307\u51fa\u7684\u65b0\u7684\u5730\u5740\u91cd\u65b0\u5c1d\u8bd5\u3002\u8bf7\u6c42\u8005\u5e94\u5f53\u7528\u8fd9\u4e2a\u65b0\u7684\u503c\u6765\u66f4\u65b0\u672c\u5730\u7684\u76ee\u5f55\uff0c\u5730\u5740\u672c\uff0c\u548c\u7528\u6237\u5730\u5740 cache \uff0c\u5e76\u4e14\u5728\u540e\u7eed\u8bf7\u6c42\u4e2d\uff0c\u53d1\u9001\u5230\u8fd9\u4e2a / \u8fd9\u4e9b\u5217\u51fa\u7684\u5730\u5740\u3002 3 . 3 302 Moved Temporarily \u8bf7\u6c42\u65b9\u5e94\u5f53\u628a\u8bf7\u6c42\u91cd\u65b0\u53d1\u5230\u8fd9\u4e2a Contact \u5934\u57df\u6240\u6307\u51fa\u7684\u65b0\u5730\u5740 ( 20 . 10 ) \u3002\u65b0\u8bf7\u6c42\u7684 Request - URI \u5e94\u5f53\u7528\u8fd9\u4e2a\u5e94\u7b54\u7684 Contact \u5934\u57df\u6240\u6307\u51fa\u7684\u503c\u3002 \u5728\u5e94\u7b54\u4e2d\u7684 Expires ( 20 . 19 \u8282 ) \u6216\u8005 Contact \u5934\u57df\u7684 expires \u53c2\u6570\u5b9a\u4e49\u4e86\u8fd9\u4e2a Contact URI \u7684\u751f\u5b58\u5468\u671f\u3002 UA \u6216\u8005 proxy \u5728\u8fd9\u4e2a\u751f\u5b58\u5468\u671f\u5185 cache \u8fd9\u4e2a URI \u3002\u5982\u679c\u6ca1\u6709\u4e25\u683c\u7684\u6709\u6548\u65f6\u89c1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5730\u5740\u4ec5\u4ec5\u672c\u6b21\u6709\u6548\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u4ee5\u540e\u7684\u4e8b\u52a1\u4e2d\u4fdd\u5b58\u3002 \u5982\u679c cache \u7684 Contact \u5934\u57df\u7684\u503c\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u88ab\u8f6c\u53d1\u8bf7\u6c42\u7684 Request - URI \u5e94\u5f53\u518d\u6b21\u5c1d\u8bd5\u4e00\u6b21\u3002\u4e34\u65f6 URI \u53ef\u4ee5\u6bd4\u8d85\u65f6\u65f6\u95f4\u66f4\u5feb\u7684\u5931\u6548\uff0c\u5e76\u4e14\u53ef\u4ee5\u6709\u4e00\u4e2a\u65b0\u7684\u4e34\u65f6 URI \u3002 3 . 4 305 Use Proxy \u8bf7\u6c42\u7684\u8d44\u6e90\u5fc5\u987b\u901a\u8fc7 Contact \u5934\u57df\u4e2d\u6307\u51fa\u7684 proxy \u6765\u8bbf\u95ee\u3002 Contact \u5934\u57df\u6307\u5b9a\u4e86\u4e00\u4e2a proxy \u7684 URI \u3002\u63a5\u6536\u5230\u8fd9\u4e2a\u5e94\u7b54\u7684\u5bf9\u8c61\u5e94\u5f53\u901a\u8fc7\u8fd9\u4e2a proxy \u91cd\u65b0\u53d1\u9001\u8fd9\u4e2a\u5355\u4e2a\u8bf7\u6c42\u3002 305 \uff08 UseProxy \uff09\u5fc5\u987b\u662f UAS \u4ea7\u751f\u7684\u3002 3 . 5 380 Alternative Service \u547c\u53eb\u4e0d\u6210\u5de5\uff0c\u4f46\u662f\u53ef\u4ee5\u5c1d\u8bd5\u53e6\u5916\u7684\u670d\u52a1\u3002\u53e6\u5916\u7684\u670d\u52a1\u5728\u5e94\u7b54\u7684\u6d88\u606f\u4f53\u4e2d\u5b9a\u4e49\u3002\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u5728\u8fd9\u91cc\u6ca1\u6709\u5b9a\u4e49\uff0c\u53ef\u80fd\u5728\u4ee5\u540e\u7684\u89c4\u8303\u4e2d\u5b9a\u4e49\u3002 4 \u8bf7\u6c42\u5931\u8d25 4 xx 4 xx \u5e94\u7b54\u5b9a\u4e49\u4e86\u7279\u5b9a\u670d\u52a1\u5668\u54cd\u5e94\u7684\u8bf7\u6c42\u5931\u8d25\u7684\u60c5\u51b5\u3002\u5ba2\u6237\u7aef\u4e0d\u5e94\u5f53\u5728\u4e0d\u66f4\u6539\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\u91cd\u65b0\u5c1d\u8bd5\u540c\u4e00\u4e2a\u8bf7\u6c42\u3002\uff08\u4f8b\u5982\uff0c\u589e\u52a0\u5408\u9002\u7684\u8ba4\u8bc1\u4fe1\u606f\uff09\u3002\u4e0d\u8fc7\uff0c\u540c\u4e00\u4e2a\u8bf7\u6c42\u4ea4\u7ed9\u4e0d\u540c\u670d\u52a1\u5668\u4e5f\u8bb8\u5c31\u4f1a\u6210\u529f\u3002 4 . 1 400 Bad Request \u8bf7\u6c42\u4e2d\u7684\u8bed\u6cd5\u9519\u8bef\u3002 Reason - Phrase \u5e94\u5f53\u6807\u5fd7\u8fd9\u4e2a\u8be6\u7ec6\u7684\u8bed\u6cd5\u9519\u8bef\uff0c\u6bd4\u5982\u201d Missing Call - ID header field \u201d\u3002 4 . 2 401 Unauthorized \u8bf7\u6c42\u9700\u8981\u7528\u6237\u8ba4\u8bc1\u3002\u8fd9\u4e2a\u5e94\u7b54\u662f\u7531 UAS \u548c\u6ce8\u518c\u670d\u52a1\u5668\u4ea7\u751f\u7684\uff0c\u5f53 407 \uff08 Proxy Authentication Required \uff09\u662f proxy \u670d\u52a1\u5668\u4ea7\u751f\u7684\u3002 4 . 3 402 Payment Required \u4fdd\u7559 / \u4ee5\u540e\u4f7f\u7528 4 . 4 403 Forbidden \u670d\u52a1\u7aef\u652f\u6301\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u62d2\u7edd\u6267\u884c\u8bf7\u6c42\u3002\u589e\u52a0\u9a8c\u8bc1\u4fe1\u606f\u662f\u6ca1\u6709\u5fc5\u8981\u7684\uff0c\u5e76\u4e14\u8bf7\u6c42\u5e94\u5f53\u4e0d\u88ab\u91cd\u8bd5\u3002 4 . 5 404 Not Found \u670d\u52a1\u5668\u8fd4\u56de\u6700\u7ec8\u4fe1\u606f\uff1a\u7528\u6237\u5728 Request - URI \u6307\u5b9a\u7684\u57df\u4e0a\u4e0d\u5b58\u5728\u3002\u5f53 Request - URI \u7684 domain \u548c\u63a5\u6536\u8fd9\u4e2a\u8bf7\u6c42\u7684 domain \u4e0d\u5339\u914d\u7684\u60c5\u51b5\u4e0b\uff0c\u4e5f\u4f1a\u4ea7\u751f\u8fd9\u4e2a\u5e94\u7b54\u3002 4 . 6 405 Method Not Allowed \u670d\u52a1\u5668\u652f\u6301 Request - Line \u4e2d\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5bf9\u4e8e\u8fd9\u4e2a Request - URI \u4e2d\u7684\u5730\u5740\u6765\u8bf4\uff0c\u662f\u4e0d\u5141\u8bb8\u5e94\u7528\u8fd9\u4e2a\u65b9\u6cd5\u7684\u3002 \u5e94\u7b54\u5fc5\u987b\u5305\u62ec\u4e00\u4e2a Allow \u5934\u57df\uff0c\u8fd9\u4e2a\u5934\u57df\u5305\u542b\u4e86\u6307\u5b9a\u5730\u5740\u5141\u8bb8\u7684\u65b9\u6cd5\u5217\u8868\u3002 4 . 7 Not Acceptable \u8bf7\u6c42\u4e2d\u7684\u8d44\u6e90\u53ea\u4f1a\u5bfc\u81f4\u4ea7\u751f\u4e00\u4e2a\u5728\u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u5916\u7684\uff0c\u5185\u5bb9\u65e0\u6cd5\u63a5\u6536\u7684\u9519\u8bef\u3002 4 . 8 407 Proxy Authentication Required \u8fd9\u4e2a\u8fd4\u56de\u7801\u548c 401 \uff08 Unauthorized \uff09\u5f88\u7c7b\u56db\uff0c\u4f46\u662f\u6807\u5fd7\u4e86\u5ba2\u6237\u7aef\u5e94\u5f53\u9996\u5148\u5728 proxy \u4e0a\u901a\u8fc7\u8ba4\u8bc1\u3002 SIP \u5bf9\u8ba4\u8bc1\u7684\u8bbf\u95ee\u8bf7\u53c2\u89c1 26 \u8282\u548c 22 . 3 \u8282\u3002 \u8fd9\u4e2a\u8fd4\u56de\u7801\u7528\u4e8e\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u901a\u8baf\u7f51\u5173\uff08\u6bd4\u5982\uff0c\u7535\u8bdd\u7f51\u5173\uff09\uff0c\u800c\u5f88\u5c11\u7528\u4e8e\u88ab\u53eb\u65b9\u8981\u6c42\u8ba4\u8bc1\u3002 4 . 9 408 Request Timeout \u5728\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u670d\u52a1\u5668\u4e0d\u80fd\u4ea7\u751f\u4e00\u4e2a\u7ec8\u7ed3\u5e94\u7b54\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u5b83\u65e0\u6cd5\u53ca\u65f6\u51b3\u5b9a\u7528\u6237\u7684\u4f4d\u7f6e\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u7a0d\u540e\u4e0d\u66f4\u6539\u8bf7\u6c42\u7684\u5185\u5bb9\u7136\u540e\u91cd\u65b0\u5c1d\u8bd5\u8bf7\u6c42\u3002 4 . 10 410 Gone \u8bf7\u6c42\u7684\u8d44\u6e90\u5728\u672c\u670d\u52a1\u5668\u4e0a\u5df2\u7ecf\u4e0d\u5b58\u5728\u4e86\uff0c\u5e76\u4e14\u4e0d\u77e5\u9053\u5e94\u5f53\u628a\u8bf7\u6c42\u8f6c\u53d1\u5230\u54ea\u91cc\u3002\u8fd9\u4e2a\u95ee\u9898\u5c06\u4f1a\u4f7f\u6c38\u4e45\u6027\u7684\u3002\u5982\u679c\u670d\u52a1\u5668\u4e0d\u77e5\u9053\uff0c\u6216\u8005\u4e0d\u5bb9\u6613\u68c0\u6d4b\uff0c\u8fd9\u4e2a\u8d44\u6e90\u6d88\u5931\u662f\u4e34\u65f6\u6027\u8d28\u7684\u8fd8\u662f\u6c38\u4e45\u6027\u8d28\u7684\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 404 \uff08 Not Found \uff09 4 . 11 413 \u8bf7\u6c42\u5b9e\u4f53\u8fc7\u5927\u3002 \u670d\u52a1\u5668\u62d2\u7edd\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8bf7\u6c42\u7684\u5b9e\u4f53\u8d85\u8fc7\u4e86\u670d\u52a1\u5668\u5e0c\u671b\u6216\u8005\u80fd\u591f\u5904\u7406\u7684\u5927\u5c0f\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u5e94\u5f53\u5173\u95ed\u8fde\u63a5\u907f\u514d\u5ba2\u6237\u7aef\u91cd\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u3002 \u5982\u679c\u8fd9\u4e2a\u60c5\u51b5\u662f\u6682\u65f6\u7684\uff0c\u90a3\u4e48\u670d\u52a1\u7aef\u5e94\u5f53\u5305\u542b\u4e00\u4e2a Retry - After \u5934\u57df\u6765\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u6682\u65f6\u7684\u6545\u969c\uff0c\u5e76\u4e14\u5ba2\u6237\u7aef\u53ef\u4ee5\u8fc7\u4e00\u6bb5\u65f6\u95f4\u518d\u6b21\u5c1d\u8bd5\u3002 4 . 12 414 Request - URI Too Long \u670d\u52a1\u5668\u62d2\u7edd\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u56e0\u4e3a Request - URI \u8d85\u8fc7\u4e86\u670d\u52a1\u5668\u80fd\u591f\u5904\u7406\u7684\u957f\u5ea6\u3002 4 . 13 415 Unsupported Media Type \u670d\u52a1\u5668\u7531\u4e8e\u8bf7\u6c42\u7684\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u672c\u670d\u52a1\u5668\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u62d2\u7edd\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u5fc5\u987b\u6839\u636e\u5185\u5bb9\u7684\u6545\u969c\u7c7b\u578b\uff0c\u8fd4\u56de\u4e00\u4e2a Accept \uff0c Accpet - Encoding ,\u6216\u8005 Accept - Language \u5934\u57df\u5217\u8868\u3002 UAC \u6839\u636e 8 . 1 . 3 . 5 \u8282\u5b9a\u4e49\u7684\u65b9\u6cd5\u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u3002 4 . 14 416 Unsupported URI Scheme \u670d\u52a1\u5668\u7531\u4e8e\u4e0d\u652f\u6301 Request - URI \u4e2d\u7684 URI \u65b9\u6848\u800c\u7ec8\u6b62\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u3002\u5ba2\u6237\u7aef\u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u53c2\u7167 8 . 1 . 3 . 5 \u3002 4 . 15 Bad Extension \u670d\u52a1\u5668\u4e0d\u77e5\u9053\u5728\u8bf7\u6c42\u4e2d\u7684 Proxy - Require ( 20 . 29 ) \u6216\u8005 Require ( 20 . 32 ) \u5934\u57df\u6240\u6307\u51fa\u7684\u534f\u8bae\u6269\u5c55\u3002\u670d\u52a1\u5668\u5fc5\u987b\u5728 Unsupported \u5934\u57df\u4e2d\u5217\u51fa\u4e0d\u652f\u6301\u7684\u6269\u5c55\u3002 UAC \u5904\u7406\u8fd9\u4e2a\u5e94\u7b54\u8bf7\u53c2\u89c1 8 . 1 . 3 . 5 4 . 16 421 Extension Required UAS \u9700\u8981\u7279\u5b9a\u7684\u6269\u5c55\u6765\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u8fd9\u4e2a\u6269\u5c55\u5e76\u6ca1\u6709\u5728\u8bf7\u6c42\u7684 Supported \u5934\u57df\u4e2d\u5217\u51fa\u3002\u5177\u6709\u8fd9\u4e2a\u5e94\u7b54\u7801\u7684\u5e94\u7b54\u5fc5\u987b\u5305\u542b\u4e00\u4e2a Require \u5934\u57df\u5217\u51fa\u6240\u9700\u8981\u7684\u6269\u5c55\u3002 UAS \u4e0d\u5e94\u5f53\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u9664\u975e\u5b83\u771f\u7684\u4e0d\u80fd\u7ed9\u5ba2\u6237\u7aef\u63d0\u4f9b\u6709\u6548\u7684\u670d\u52a1\u3002\u76f8\u53cd\uff0c\u5982\u679c\u5728 Support \u5934\u57df\u4e2d\u6ca1\u6709\u5217\u51fa\u9700\u8981\u7684\u6269\u5c55\uff0c\u670d\u52a1\u5668\u5e94\u5f53\u6839\u636e\u57fa\u51c6\u7684 SIP \u517c\u5bb9\u7684\u65b9\u6cd5\u548c\u5ba2\u6237\u7aef\u652f\u6301\u7684\u6269\u5c55\u6765\u8fdb\u884c\u5904\u7406\u3002 4 . 17 423 Interval Too Brief \u670d\u52a1\u5668\u56e0\u4e3a\u5728\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u7684\u8d44\u6e90\u5237\u65b0\u65f6\u95f4\uff08\u6216\u8005\u6709\u6548\u65f6\u95f4\uff09\u8fc7\u77ed\u800c\u62d2\u7edd\u8bf7\u6c42\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u7528\u4e8e\u6ce8\u518c\u670d\u52a1\u5668\u6765\u62d2\u7edd\u90a3\u4e9b Contact \u5934\u57df\u6709\u6548\u671f\u8fc7\u77ed\u7684\u6ce8\u518c\u8bf7\u6c42\u3002\u8fd9\u4e2a\u5e94\u7b54\u7684\u7528\u6cd5\u548c\u76f8\u5173\u7684 Min - Expires \u5934\u57df\u5728 10 . 2 . 8 , 10 . 3 , 20 . 23 \u8282\u4e2d\u4ecb\u7ecd\u548c\u8bf4\u660e\u3002 4 . 18 480 Temporarily Unavailable \u8bf7\u6c42\u6210\u529f\u5230\u8fbe\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5f53\u524d\u4e0d\u53ef\u7528\uff08\u4f8b\u5982\uff0c\u6ca1\u6709\u767b\u9646\uff0c\u6216\u8005\u767b\u9646\u4e86\u4f46\u662f\u72b6\u6001\u662f\u4e0d\u80fd\u901a\u8baf\uff0c\u6216\u8005\u6709\u201d\u8bf7\u52ff\u6253\u6270\u201d\u7684\u6807\u8bb0\uff09\u3002\u5e94\u7b54\u5e94\u5f53\u5728 Retry - After \u4e2d\u6807\u5fd7\u4e00\u4e2a\u5408\u9002\u7684\u91cd\u53d1\u65f6\u95f4\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u6709\u53ef\u80fd\u5728\u5176\u4ed6\u5730\u65b9\u662f\u6709\u6548\u7684\uff08\u5728\u672c\u670d\u52a1\u5668\u4e2d\u4e0d\u77e5\u9053\uff09\u3002 Reason - Phrase ( \u539f\u56e0\u77ed\u53e5 ) \u5e94\u5f53\u63d0\u793a\u66f4\u8be6\u7ec6\u7684\u539f\u56e0\uff0c\u4e3a\u4ec0\u4e48\u88ab\u53eb\u65b9\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u8fd9\u4e2a\u503c\u5e94\u5f53\u662f\u53ef\u4ee5\u88ab UA \u8bbe\u7f6e\u7684\u3002\u72b6\u6001\u7801 486 \uff08 Busy Here \uff09\u53ef\u4ee5\u7528\u6765\u66f4\u7cbe\u786e\u7684\u8868\u793a\u672c\u8bf7\u6c42\u5931\u8d25\u7684\u7279\u5b9a\u539f\u56e0\u3002 \u8fd9\u4e2a\u72b6\u6001\u7801\u4e5f\u53ef\u4ee5\u662f\u8f6c\u53d1\u670d\u52a1\u6216\u8005 proxy \u670d\u52a1\u5668\u8fd4\u56de\u7684\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53d1\u73b0 Request - URI \u6307\u5b9a\u7684\u7528\u6237\u5b58\u5728\uff0c\u4f46\u662f\u6ca1\u6709\u4e00\u4e2a\u7ed9\u8fd9\u4e2a\u7528\u6237\u7684\u5408\u9002\u7684\u5f53\u524d\u8f6c\u53d1\u7684\u5730\u5740\u3002 4 . 19 481 Call / Transaction Does Not Exist \u8fd9\u4e2a\u72b6\u6001\u8868\u793a\u4e86 UAS \u63a5\u6536\u5230\u8bf7\u6c42\uff0c\u4f46\u662f\u6ca1\u6709\u548c\u73b0\u5b58\u7684\u5bf9\u8bdd\u6216\u8005\u4e8b\u52a1\u5339\u914d\u3002 4 . 20 482 Loop Detected \u670d\u52a1\u5668\u68c0\u6d4b\u5230\u4e86\u4e00\u4e2a\u5faa\u73af ( 16 . 3 / 4 ) 4 . 21 483 Too Many Hops \u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\u5305\u542b\u7684 Max - Forwards ( 20 . 22 ) \u5934\u57df\u662f 0 4 . 22 484 Address InComplete \u670d\u52a1\u5668\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5b83\u7684 Request - URI \u662f\u4e0d\u5b8c\u6574\u7684\u3002\u5728\u539f\u56e0\u77ed\u8bed\u4e2d\u5e94\u5f53\u6709\u9644\u52a0\u7684\u4fe1\u606f\u8bf4\u660e\u3002\u8fd9\u4e2a\u72b6\u6001\u7801\u53ef\u4ee5\u548c\u62e8\u53f7\u4ea4\u53e0\u3002\u5728\u548c\u62e8\u53f7\u4ea4\u53e0\u4e2d\uff0c\u5ba2\u6237\u7aef\u4e0d\u77e5\u9053\u62e8\u53f7\u4e32\u7684\u957f\u5ea6\u3002\u5b83\u53d1\u9001\u589e\u52a0\u957f\u5ea6\u7684\u5b57\u4e32\uff0c\u5e76\u4e14\u63d0\u793a\u7528\u6237\u8f93\u5165\u66f4\u591a\u7684\u5b57\u4e32\uff0c\u76f4\u5230\u4e0d\u5728\u51fa\u73b0 484 \uff08 Address Incomplete \uff09\u5e94\u7b54\u4e3a\u6b62\u3002 4 . 23 485 Ambiguous Request - URI \u662f\u4e0d\u660e\u786e\u7684\u3002\u5e94\u7b54\u53ef\u4ee5\u5728 Contact \u5934\u57df\u4e2d\u5305\u542b\u4e00\u4e2a\u53ef\u80fd\u7684\u660e\u786e\u7684\u5730\u5740\u5217\u8868\u3002\u8fd9\u4e2a\u63d0\u793a\u5217\u8868\u80af\u56ca\u4e2a\u5728\u5b89\u5168\u6027\u548c\u9690\u79c1\u6027\u5bf9\u7528\u6237\u6216\u8005\u7ec4\u7ec7\u9020\u6210\u7834\u574f\u3002\u5fc5\u987b\u80fd\u591f\u7531\u914d\u7f6e\u51b3\u5b9a\u662f\u5426\u4ee5 404 \uff08 NotFound \uff09\u4ee3\u66ff\u8fd9\u4e2a\u5e94\u7b54\uff0c\u53c8\u6216\u8005\u7981\u6b62\u5bf9\u4e0d\u660e\u786e\u7684\u5730\u5740\u4f7f\u7528\u53ef\u80fd\u7684\u9009\u62e9\u5217\u8868\u3002 \u7ed9\u5e26\u6709 Request - URI \u7684\u8bf7\u6c42\u7684\u4e00\u4e2a\u5e94\u7b54\u4f8b\u5b50\uff1a sip : lee @ example . com : SIP / 2 . 0 485 Ambiguous Contact : Carol Lee Contact : Ping Lee Contact : Lee M . Foote \u90e8\u5206 email \u548c\u8bed\u97f3\u90ae\u7bb1\u7cfb\u7edf\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u529f\u80fd\u3002\u8fd9\u4e2a\u72b6\u6001\u7801\u548c 3 xx \u72b6\u6001\u7801\u4e0d\u540c\uff1a\u5bf9\u4e8e 300 \u6765\u8bf4\uff0c\u5b83\u662f\u5047\u5b9a\u540c\u4e00\u4e2a\u4eba\u6216\u8005\u670d\u52a1\u6709\u4e0d\u540c\u7684\u5730\u5740\u9009\u62e9\u3002\u6240\u4ee5\u5bf9 3 xx \u6765\u8bf4\uff0c\u81ea\u52a8\u9009\u62e9\u7cfb\u7edf\u6216\u8005\u8fde\u7eed\u67e5\u627e\u5c31\u6709\u6548\uff0c\u4f46\u662f\u5bf9 485 \uff08 Ambiguous \uff09\u5e94\u7b54\u6765\u8bf4\uff0c\u4e00\u5b9a\u8981\u7528\u6237\u7684\u5e72\u9884\u3002 4 . 24 486 Busy Here \u5f53\u6210\u529f\u8054\u7cfb\u5230\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5f53\u524d\u5728\u8fd9\u4e2a\u7ec8\u7aef\u7cfb\u7edf\u4e0a\u4e0d\u80fd\u63a5\u542c\u8fd9\u4e2a\u7535\u8bdd\uff0c\u90a3\u4e48\u5e94\u7b54\u5e94\u5f53\u56de\u7ed9\u547c\u53eb\u65b9\u4e00\u4e2a\u66f4\u5408\u9002\u7684\u65f6\u95f4\u5728 Retry - After \u5934\u57df\u91cd\u8bd5\u3002\u8fd9\u4e2a\u7528\u6237\u4e5f\u8bb8\u5728\u5176\u4ed6\u5730\u65b9\u6709\u6548\uff0c\u6bd4\u5982\u7535\u8bdd\u90ae\u7bb1\u7cfb\u7edf\u7b49\u7b49\u3002\u5982\u679c\u6211\u4eec\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u7cfb\u7edf\u80fd\u591f\u63a5\u542c\u8fd9\u4e2a\u547c\u53eb\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u72b6\u6001\u7801 600 \uff08 Busy Everywhere \uff09\u3002 4 . 25 487 Request Terminated \u8bf7\u6c42\u88ab BYE \u6216\u8005 CANCEL \u6240\u7ec8\u6b62\u3002\u8fd9\u4e2a\u5e94\u7b54\u6c38\u8fdc\u4e0d\u4f1a\u7ed9 CANCEL \u8bf7\u6c42\u672c\u8eab\u56de\u590d\u3002 4 . 26 488 Not Acceptable Here \u8fd9\u4e2a\u5e94\u7b54\u548c 606 \uff08 Not Acceptable \uff09\u6709\u76f8\u540c\u7684\u542b\u4e49\uff0c\u4f46\u662f\u53ea\u662f\u5e94\u7528\u4e8e Request - URI \u6240\u6307\u51fa\u7684\u7279\u5b9a\u8d44\u6e90\u4e0d\u80fd\u63a5\u53d7\uff0c\u5728\u5176\u4ed6\u5730\u65b9\u8bf7\u6c42\u53ef\u80fd\u53ef\u4ee5\u63a5\u53d7\u3002 \u5305\u542b\u4e86\u5a92\u4f53\u517c\u5bb9\u6027\u63cf\u8ff0\u7684\u6d88\u606f\u4f53\u53ef\u4ee5\u51fa\u73b0\u5728\u5e94\u7b54\u4e2d\uff0c\u5e76\u4e14\u6839\u636e INVITE \u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u8fdb\u884c\u89c4\u683c\u5316\uff08\u5982\u679c\u6ca1\u6709 Accept \u5934\u57df\uff0c\u90a3\u4e48\u5c31\u662f application / sdp \uff09\u3002\u8fd9\u4e2a\u5e94\u7b54\u5c31\u50cf\u7ed9 OPTIONS \u8bf7\u6c42\u7684 200 ( OK ) \u5e94\u7b54\u7684\u6d88\u606f\u4f53\u4e00\u6837\u3002 4 . 27 491 Request Pending \u5728\u540c\u4e00\u4e2a\u5bf9\u8bdd\u4e2d\uff0c UAS \u63a5\u6536\u5230\u7684\u8bf7\u6c42\u6709\u4e00\u4e2a\u4f9d\u8d56\u7684\u8bf7\u6c42\u6b63\u5728\u5904\u7406\u3002 14 . 2 \u63cf\u8ff0\u4e86\u8fd9\u79cd\u60c5\u51b5\u5e94\u5f53\u600e\u6837\u89e3\u51b3\u3002 4 . 28 493 Undecipherable UAS \u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5305\u542b\u4e86\u4e00\u4e2a\u52a0\u5bc6\u7684 MIME ,\u5e76\u4e14\u4e0d\u77e5\u9053\u6216\u8005\u6ca1\u6709\u63d0\u4f9b\u5408\u9002\u7684\u89e3\u5bc6\u5bc6\u94a5\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u5305\u542b\u5355\u4e2a\u5305\u4f53\uff0c\u8fd9\u4e2a\u5305\u4f53\u5305\u542b\u4e86\u5408\u9002\u7684\u516c\u94a5\uff0c\u8fd9\u4e2a\u516c\u94a5\u7528\u4e8e\u7ed9\u8fd9\u4e2a UAS \u901a\u8baf\u4e2d\u52a0\u5bc6\u5305\u4f53\u4f7f\u7528\u7684\u3002\u7ec6\u8282\u63cf\u8ff0\u5728 23 . 2 \u8282\u3002 5 Server Failure 5 xx 5 xx \u5e94\u7b54\u662f\u5f53\u670d\u52a1\u5668\u672c\u8eab\u6545\u969c\u7684\u65f6\u5019\u7ed9\u51fa\u7684\u5931\u8d25\u5e94\u7b54\u3002 5 . 1 500 Server Internal Error \u670d\u52a1\u5668\u9047\u5230\u4e86\u672a\u77e5\u7684\u60c5\u51b5\uff0c\u5e76\u4e14\u4e0d\u80fd\u7ee7\u7eed\u5904\u7406\u8bf7\u6c42\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u663e\u793a\u7279\u5b9a\u7684\u9519\u8bef\u60c5\u51b5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u51e0\u79d2\u79cd\u4ee5\u540e\u91cd\u65b0\u5c1d\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002 \u5982\u679c\u8fd9\u4e2a\u60c5\u51b5\u662f\u4e34\u65f6\u7684\uff0c\u670d\u52a1\u5668\u5e94\u5f53\u5728 Retry - After \u5934\u57df\u6807\u5fd7\u5ba2\u6237\u7aef\u8fc7\u591a\u5c11\u79d2\u949f\u4e4b\u540e\u91cd\u65b0\u5c1d\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002 5 . 2 501 Not Implemented \u670d\u52a1\u5668\u6ca1\u6709\u5b9e\u73b0\u76f8\u5173\u7684\u8bf7\u6c42\u529f\u80fd\u3002\u5f53 UAS \u4e0d\u8ba4\u8bc6\u8bf7\u6c42\u7684\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5e76\u4e14\u5bf9\u6bcf\u4e00\u4e2a\u7528\u6237\u90fd\u65e0\u6cd5\u652f\u6301\u8fd9\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u5e94\u5f53\u8fd4\u56de\u8fd9\u4e2a\u5e94\u7b54\u3002\uff08 proxy \u4e0d\u8003\u8651\u8bf7\u6c42\u7684\u65b9\u6cd5\u800c\u8f6c\u53d1\u8bf7\u6c42\uff09\u3002 \u6ce8\u610f 405 \uff08 Method Not Allowed \uff09\u662f\u56e0\u4e3a\u670d\u52a1\u5668\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u8bf7\u6c42\u65b9\u6cd5\uff0c\u4f46\u662f\u8fd9\u4e2a\u8bf7\u6c42\u65b9\u6cd5\u5728\u7279\u5b9a\u8bf7\u6c42\u4e2d\u4e0d\u88ab\u652f\u6301\u3002 5 . 3 502 Bad Gateway \u5982\u679c\u670d\u52a1\u5668\uff0c\u4f5c\u4e3a gateway \u6216\u8005 proxy \u5b58\u5728\uff0c\u4ece\u4e0b\u884c\u670d\u52a1\u5668\u4e0a\u63a5\u6536\u5230\u4e86\u4e00\u4e2a\u975e\u6cd5\u7684\u5e94\u7b54\uff08\u8fd9\u4e2a\u5e94\u7b54\u5bf9\u5e94\u7684\u8bf7\u6c42\u662f\u672c\u670d\u52a1\u5668\u4e3a\u4e86\u5b8c\u6210\u8bf7\u6c42\u800c\u8f6c\u53d1\u7ed9\u4e0b\u884c\u670d\u52a1\u5668\u7684\uff09\u3002 5 . 4 503 Service Unavailable \u7531\u4e8e\u4e34\u65f6\u7684\u8fc7\u8f7d\u6216\u8005\u670d\u52a1\u5668\u7ba1\u7406\u5bfc\u81f4\u7684\u670d\u52a1\u5668\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u8fd9\u4e2a\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u5e94\u7b54\u4e2d\u589e\u52a0\u4e00\u4e2a Retry - After \u6765\u8ba9\u5ba2\u6237\u7aef\u91cd\u8bd5\u8fd9\u4e2a\u8bf7\u6c42\u3002\u5982\u679c\u6ca1\u6709 Retry - After \u6307\u51fa\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5c31\u50cf\u6536\u5230\u4e86\u4e00\u4e2a 500 \uff08 Server Internal Error \uff09\u5e94\u7b54\u4e00\u6837\u5904\u7406\u3002 \u5ba2\u6237\u7aef\uff08 proxy \u6216\u8005 UAC \uff09\u6536\u5230 503 \uff08 Service Unavailable \uff09\u5e94\u5f53\u5c1d\u8bd5\u8f6c\u53d1\u8fd9\u4e2a\u8bf7\u6c42\u5230\u53e6\u5916\u4e00\u4e2a\u670d\u52a1\u5668\u5904\u7406\u3002\u5e76\u4e14\u5728 Retry - After \u5934\u57df\u4e2d\u6307\u5b9a\u7684\u65f6\u95f4\u5185\uff0c\u4e0d\u5e94\u5f53\u8f6c\u53d1\u5176\u4ed6\u8bf7\u6c42\u5230\u8fd9\u4e2a\u670d\u52a1\u5668\u3002 \u4f5c\u4e3a 503 ( Service Unavaliable ) \u7684\u66ff\u4ee3\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u62d2\u7edd\u8fde\u63a5\u6216\u8005\u628a\u8bf7\u6c42\u6254\u6389\u3002 5 . 5 504 Server Time - out \u670d\u52a1\u5668\u5728\u4e00\u4e2a\u5916\u90e8\u670d\u52a1\u5668\u4e0a\u6ca1\u6709\u6536\u5230\u4e00\u4e2a\u53ca\u65f6\u7684\u5e94\u7b54\u3002\u8fd9\u4e2a\u5916\u90e8\u670d\u52a1\u5668\u662f\u672c\u670d\u52a1\u5668\u7528\u6765\u8bbf\u95ee\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u6240\u9700\u8981\u7684\u3002\u5982\u679c\u4ece\u4e0a\u884c\u670d\u52a1\u5668\u4e0a\u6536\u5230\u7684\u8bf7\u6c42\u4e2d\u7684 Expires \u5934\u57df\u8d85\u65f6\uff0c\u90a3\u4e48\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 408 \uff08 Request TimeOut \uff09\u9519\u8bef\u3002 5 . 6 505 Version Not Supported \u670d\u52a1\u5668\u4e0d\u652f\u6301\u5bf9\u5e94\u7684 SIP \u7248\u672c\u3002\u670d\u52a1\u5668\u662f\u65e0\u6cd5\u5904\u7406\u5177\u6709\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u76f8\u540c\u4e3b\u7248\u672c\u53f7\u7684\u8bf7\u6c42\uff0c\u5c31\u4f1a\u5bfc\u81f4\u8fd9\u6837\u7684\u9519\u8bef\u4fe1\u606f\u3002 5 . 7 Message To Large \u670d\u52a1\u5668\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u6d88\u606f\u957f\u5ea6\u8d85\u8fc7\u4e86\u5904\u7406\u7684\u957f\u5ea6\u3002 6 Global Failures 6 xx 6 xx \u5e94\u7b54\u610f\u5473\u8fd9\u670d\u52a1\u5668\u7ed9\u7279\u5b9a\u7528\u6237\u6709\u4e00\u4e2a\u6700\u7ec8\u7684\u4fe1\u606f\uff0c\u5e76\u4e0d\u53ea\u662f\u5728 Request - URI \u7684\u7279\u5b9a\u5b9e\u4f8b\u6709\u6700\u7ec8\u4fe1\u606f\u3002 6 . 1 600 Busy Everywhere \u6210\u529f\u8054\u7cfb\u5230\u88ab\u53eb\u65b9\u7684\u7ec8\u7aef\u7cfb\u7edf\uff0c\u4f46\u662f\u88ab\u53eb\u65b9\u5904\u4e8e\u5fd9\u7684\u72b6\u6001\uff0c\u5e76\u4e0d\u6253\u7b97\u63a5\u542c\u7535\u8bdd\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u4e00\u4e2a Retry - After \u5934\u57df\u66f4\u660e\u786e\u7684\u544a\u8bc9\u547c\u53eb\u65b9\u591a\u4e45\u4ee5\u540e\u53ef\u4ee5\u7ee7\u7eed\u547c\u53eb\u3002\u5982\u679c\u88ab\u53eb\u65b9\u4e0d\u5e0c\u671b\u63d0\u793a\u62d2\u7edd\u7684\u539f\u56e0\uff0c\u88ab\u53eb\u65b9\u5e94\u5f53\u4f7f\u7528 603 \uff08 Decline \uff09\u3002\u53ea\u6709\u5f53\u7ec8\u7aef\u7cfb\u7edf\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u8282\u70b9\uff08\u6bd4\u5982\u8bed\u97f3\u90ae\u7bb1\u7cfb\u7edf\uff09\u80fd\u591f\u8bbf\u95ee\u5230\u8fd9\u4e2a\u7528\u6237\u7684\u65f6\u5019\u624d\u80fd\u4f7f\u7528\u8fd9\u4e2a\u5e94\u7b54\u3002\u5426\u5219\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a 486 \uff08 Busy Here \uff09\u7684\u5e94\u7b54\u3002 6 . 2 603 Decline \u5f53\u6210\u529f\u8bbf\u95ee\u5230\u88ab\u53eb\u65b9\u7684\u8bbe\u5907\uff0c\u4f46\u662f\u7528\u6237\u660e\u786e\u7684\u4e0d\u60f3\u5e94\u7b54\u3002\u8fd9\u4e2a\u5e94\u7b54\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u4e00\u4e2a Retry - After \u5934\u57df\u66f4\u660e\u786e\u7684\u544a\u8bc9\u547c\u53eb\u65b9\u591a\u4e45\u4ee5\u540e\u53ef\u4ee5\u7ee7\u7eed\u547c\u53eb\u3002\u53ea\u6709\u5f53\u7ec8\u7aef\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u4efb\u4f55\u7ec8\u7aef\u8bbe\u5907\u80fd\u591f\u54cd\u5e94\u8fd9\u4e2a\u547c\u53eb\u7684\u52bf\u80fd\u624d\u80fd\u7ed9\u51fa\u8fd9\u4e2a\u5e94\u7b54\u3002 6 . 3 604 Does Not Exists Anywhere \u670d\u52a1\u5668\u9a8c\u8bc1\u4e86\u5728\u8bf7\u6c42\u4e2d Request - URI \u7684\u7528\u6237\u4fe1\u606f\uff0c\u54ea\u91cc\u90fd\u4e0d\u5b58\u5728 6 . 4 606 Not Acceptable \u5f53\u6210\u529f\u8054\u7cfb\u5230\u4e00\u4e2a UA ,\u4f46\u662f\u4f1a\u8bdd\u63cf\u8ff0\u7684\u4e00\u4e9b\u90e8\u5206\u6bd4\u5982\u8bf7\u6c42\u7684\u5a92\u4f53\uff0c\u5e26\u5bbd\uff0c\u6216\u8005\u5730\u5740\u7c7b\u578b\u4e0d\u88ab\u63a5\u6536\u3002 606 \uff08 NotAcceptable \uff09\u5e94\u7b54\u610f\u5473\u7740\u7528\u6237\u5e0c\u671b\u901a\u8baf\uff0c\u4f46\u662f\u4e0d\u80fd\u5145\u5206\u652f\u6301\u4f1a\u8bdd\u63cf\u8ff0\u3002 606 \uff08 Not Acceptable \uff09\u5e94\u7b54\u53ef\u4ee5\u5728 Warning \u5934\u57df\u4e2d\u5305\u542b\u4e00\u4e2a\u539f\u56e0\u5217\u8868\uff0c\u7528\u4e8e\u89e3\u91ca\u4e3a\u4f55\u4f1a\u8bdd\u63cf\u8ff0\u4e0d\u80fd\u88ab\u652f\u6301\u3002\u8b66\u544a\u539f\u56e0\u4ee3\u7801\u5728 20 . 43 \u8282\u4e2d\u5217\u51fa\u3002 \u5728\u5e94\u7b54\u4e2d\uff0c\u53ef\u4ee5\u51fa\u73b0\u4e00\u4e2a\u5305\u542b\u5a92\u4f53\u517c\u5bb9\u6027\u63cf\u8ff0\u7684\u6d88\u606f\u4f53\uff0c\u8fd9\u4e2a\u6d88\u606f\u4f53\u7684\u683c\u5f0f\u6839\u636e INVITE \u8bf7\u6c42\u4e2d\u7684 Accept \u5934\u57df\u6307\u51fa\u7684\u683c\u5f0f\u8fdb\u884c\u89c4\u683c\u5316\uff08\u5982\u679c\u6ca1\u6709 Accept \u5934\u57df\uff0c\u90a3\u4e48\u5c31\u662f application / sdp \uff09\uff0c\u5c31\u50cf\u7ed9 OPTIONS \u4eb2\u6c42\u7684 200 ( OK ) \u5e94\u7b54\u4e2d\u7684\u6d88\u606f\u4e00\u6837\u3002 \u6211\u4eec\u5e0c\u671b\u8fd9\u4e9b\u5a92\u4f53\u534f\u5546\u4e0d\u8981\u7ecf\u5e38\u9700\u8981\uff0c\u5e76\u4e14\u5f53\u4e00\u4e2a\u65b0\u7528\u6237\u88ab\u9080\u8bf7\u52a0\u5165\u5df2\u7ecf\u5b58\u5728\u7684\u4f1a\u8bdd\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u5a92\u4f53\u534f\u5546\u53ef\u80fd\u4e0d\u9700\u8981\u3002\u8fd9\u53d6\u51b3\u4e8e\u9080\u8bf7\u7684\u521d\u59cb\u5316\u8005\u662f\u5426\u9700\u8981\u5bf9 606 \uff08 Not Acceptable \uff09\u8fdb\u884c\u5904\u7406\u3002 \u8fd9\u4e2a\u5e94\u7b54\u53ea\u6709\u5f53\u5ba2\u6237\u7aef\u77e5\u9053\u6ca1\u6709\u5176\u4ed6\u7ec8\u7aef\u80fd\u591f\u5904\u7406\u8fd9\u4e2a\u8bf7\u6c42\u7684\u65f6\u5019\u624d\u80fd\u53d1\u51fa","title":"SIP\u534f\u8bae\u5e94\u7b54\u7801"},{"location":"Others/#freeswitch","text":"\u5b66\u4e60freeswitch\u9700\u8981\u638c\u63e1\u7684\u5185\u5bb9\uff1ac/c++\u7f16\u7a0b, socket\u7f16\u7a0b \uff0csip ,sdp\uff0crtp ,tcp/ip \u534f\u8bae\uff0cXML\uff0c\u811a\u672c\u8bed\u8a00JavaScript\uff0clua\uff0cerlang,perl\u3002\u6570\u636e\u5e93sqlite\uff0cmysql\u3002\u7cfb\u7edf\u7f16\u7a0b\u77e5\u8bc6\uff1a\u591a\u8fdb\u7a0b\u7ebf\u7a0b\u540c\u6b65\uff08\u4e34\u754c\u533a\uff0c\u4e92\u65a5\u91cf\uff0c\u4fe1\u53f7\u706f\uff0c\u4e8b\u4ef6\uff09\uff0cAPR\uff0c\u6a21\u5757\u52a8\u6001\u5171\u4eab\u673a\u5236\u3002 \u4fee\u6539freeswitch\u7684systemd\u7684\u670d\u52a1\u914d\u7f6e\u6587\u4ef6 \uff0c \u4fee\u6539\u540e\u7684\u914d\u7f6e\u5982\u4e0b \uff1a [ Unit ] Description = FreeSWITCH After = syslog . target network . target After = postgresql . service postgresql - 9.3 . service postgresql - 9.4 . service mysqld . service httpd . service [ Service ] User = freeswitch EnvironmentFile =-/ etc / sysconfig / freeswitch LimitNOFILE = 65000 LimitNPROC = 40960 # RuntimeDirectory is not yet supported in CentOS 7. A workaround is to use / etc / tmpfiles . d / freeswitch . conf # RuntimeDirectory =/ run / freeswitch # RuntimeDirectoryMode = 0750 WorkingDirectory =/ opt / app / freeswitch / var / run / freeswitch / ExecStart =/ opt / app / freeswitch / bin / freeswitch - nc - nf $ FREESWITCH_PARAMS ExecReload =/ usr / bin / kill - HUP $ MAINPID [ Install ] WantedBy = multi - user . target \u9ed8\u8ba4\u7684\u914d\u7f6e\u6ca1\u6709 LimitNOFILE \u548c LimitNPROC \u8fd9 2 \u4e2a\u914d\u7f6e \uff0c \u91cd\u65b0\u52a0\u8f7d systemd \u7684\u914d\u7f6e \uff0c \u91cd\u542f\u670d\u52a1\u5373\u53ef \uff1a systemctl daemon - reload systemctl restart freeswitch . service","title":"Freeswitch"},{"location":"Others/#_3","text":"\u666e\u901a\u7528\u6237\u8fd0\u884c FreeSWITCH \u4e0d\u80fd\u8c03\u6574\u8fdb\u7a0b\u4f18\u5148\u7ea7\uff1a Systemd \u662f\u4ee5 freeswitch \u7528\u6237\u8fd0\u884c FreeSWITCH \u7684\uff0c\u53ef\u80fd\u662f\u4ee5 root \u542f\u52a8\u4ee5\u540e\u518d\u5bf9\u8fdb\u7a0b\u964d\u7ea7\uff0c\u53d8\u6210 freeswitch \u7528\u6237\uff08\u8fd9\u4e2a\u662f\u6211\u731c\u7684\uff09\uff0c\u4e0d\u77e5\u9053 systemd \u7684\u542f\u52a8\u65b9\u5f0f\u548c root \u7528\u6237\u8fd0\u884c /opt/app/freeswitch/bin/freeswitch -nc -nf -u freeswitch -g freeswitch \u6709\u4ec0\u4e48\u533a\u522b\uff0c\u53cd\u6b63\u542f\u52a8\u4ee5\u540e\u662f\u6ca1\u6709 nice \u7684\u6743\u9650\u4e86\uff0c\u5bfc\u81f4\u65e5\u5fd7\u6709\u5982\u4e0b\u62a5\u9519\uff1a freeswitch[31890]: ERROR: Failed to set SCHED_FIFO scheduler (Operation not permitted) freeswitch[31890]: ERROR: Could not set nice level \u4e0d\u60f3 set uid\uff0c\u7ed9\u6587\u4ef6\u52a0\u4e0a nice \u7684\u80fd\u529b\u5373\u53ef\uff1a(\u5982\u4e0b\u547d\u4ee4) setcap CAP_SYS_NICE+ep /opt/app/freeswitch/bin/freeswitch","title":"\u9519\u8bef\u5904\u7406"},{"location":"Others/#asterisk","text":"","title":"Asterisk"},{"location":"Others/#raspberrypi","text":"\u5173\u4e8eHDMI\u8bbe\u7f6e /opt/vc/bin/tvservice tvservice [ OPTION ] ... -p, --preferred Power on HDMI with preferred settings -e, --explicit = \"GROUP MODE DRIVE\" Power on HDMI with explicit GROUP ( CEA, DMT, CEA_3D_SBS, CEA_3D_TB, CEA_3D_FP, CEA_3D_FS ) MODE ( see --modes ) and DRIVE ( HDMI, DVI ) -t, --ntsc Use NTSC frequency for HDMI mode ( e.g. 59 .94Hz rather than 60Hz ) -c, --sdtvon = \"MODE ASPECT [P]\" Power on SDTV with MODE ( PAL or NTSC ) and ASPECT ( 4 :3 14 :9 or 16 :9 ) Add P for progressive -o, --off Power off the display -m, --modes = GROUP Get supported modes for GROUP ( CEA, DMT ) -M, --monitor Monitor HDMI events -s, --status Get HDMI status -a, --audio Get supported audio information -d, --dumpedid <filename> Dump EDID information to file -j, --json Use JSON format for --modes output -n, --name Print the device ID from EDID \u67e5\u627e\u5f53\u524d\u6811\u8393\u6d3eCPU\u6a21\u5757\u540d cat /lib/modules/ $( uname -r ) /modules.builtin | grep wdt \u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u5185\u5b58\u8017\u5c3d\u5c31\u91cd\u542f\uff0c\u5982min-memory = 1 \u524d\u7684\u6ce8\u91ca#\u53f7\u53bb\u6389 \u8fd8\u53ef\u4ee5\u8bbe\u7f6e\u76d1\u63a7\u7684\u95f4\u9694\uff0c\u5982 interval = 1 \u524d\u7684\u6ce8\u91ca#\u53f7\u53bb\u6389\uff0c\u8be51\u4e3a\u4efb\u610f\u6570\u5b57\uff0c\u5355\u4f4d\u662f\u79d2\uff0c\u9ed8\u8ba4\u662f10\u79d2\u4e00\u6b21\u5065\u5eb7\u68c0\u67e5 /etc/init.d/watchdog start chkconfig watchdog on /etc/sysctl.conf kernel.panic = 10 sysctl -P 1 \u3001\u901a\u8fc7shell\u7f16\u7a0b\u83b7\u5f97cup\u6e29\u5ea6\u503c \u8fdb\u5165\u6811\u8393\u6d3e\u4e2d\u65ad\u63a7\u5236\u53f0\uff0c\u4f9d\u6b21\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\u83b7\u53d6\u5b9e\u65f6\u6e29\u5ea6\u503c\uff1a #\u8fdb\u5165\u6839\u76ee\u5f55 cd / #\u8bfb\u53d6temp\u6587\u4ef6\uff0c\u83b7\u5f97\u6e29\u5ea6\u503c cat sys/class/thermal/thermal_zone0/temp #\u7cfb\u7edf\u8fd4\u56de\u5b9e\u65f6\u503c 40622 [ \u8bf4\u660e ] 1 \uff09\u901a\u8fc7cat\u547d\u4ee4\u8bfb\u53d6\u5b58\u653e\u5728sys/class/thermal/thermal_zone0\u76ee\u5f55\u4e0b\u7684\u6e29\u5ea6\u6587\u4ef6temp\u83b7\u5f97\u8fd4\u56de\u503c 2 \uff09\u8fd4\u56de\u503c\u4e3a\u4e00\u4e2a5\u4f4d\u6570\u7684\u6570\u503c\uff0c\u5b9e\u9645\u6e29\u5ea6\u4e3a\u5c06\u8be5\u503c\u9664\u4ee51000\u5373\u53ef\uff01\u5355\u4f4d\u4e3a\u6444\u6c0f\u5ea6\uff01 2 \u3001\u901a\u8fc7C\u8bed\u8a00\u7f16\u7a0b\u83b7\u5f97cpu\u6e29\u5ea6\u503c #\u9009\u5b9a\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u521b\u5efacpu_temp.c\u6587\u4ef6\uff0c\u5c06\u4ee5\u4e0b\u4ee3\u7801\u8f93\u5165\uff1a #include <stdio.h> #include <stdlib.h> //\u5bfc\u5165\u6587\u4ef6\u63a7\u5236\u51fd\u6570\u5e93 #include <sys/types.h> #include <sys/stat.h> #include <fcntl.h> #define TEMP_PATH \"/sys/class/thermal/thermal_zone0/temp\" #define MAX_SIZE 20 int main ( void ) { int fd ; double temp = 0 ; char buf [ MAX_SIZE ] ; // \u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00/sys/class/thermal/thermal_zone0/temp fd = open ( TEMP_PATH, O_RDONLY ) ; //\u5224\u65ad\u6587\u4ef6\u662f\u5426\u6b63\u5e38\u88ab\u6253\u5f00 if ( fd < 0 ) { fprintf ( stderr, \"failed to open thermal_zone0/temp\\n\" ) ; return -1 ; } // \u8bfb\u53d6\u5185\u5bb9 if ( read ( fd, buf, MAX_SIZE ) < 0 ) { fprintf ( stderr, \"failed to read temp\\n\" ) ; return -1 ; } // \u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\u6253\u5370 temp = atoi ( buf ) / 1000 .0 ; printf ( \"temp: %.3f\\n\" , temp ) ; // \u5173\u95ed\u6587\u4ef6 close ( fd ) ; } #\u7f16\u8bd1C\u4ee3\u7801\uff0c\u8f93\u5165\u4ee5\u4e0b\u6307\u4ee4\uff1a gcc -o cpu_temp cpu_temp.c #\u8fd0\u884c\u7a0b\u5e8f ./cpu_temp #\u7cfb\u7edf\u8fd4\u56de\u5b9e\u65f6\u503c temp : 40 .622 \u7a0b\u5e8f\u89e3\u8bfb\uff1a 1 ) \u5173\u4e8eopen () \u3001read () \u3001close () \u51fd\u6570\u4f7f\u7528\uff0c\u53ef\u770b\uff1a\u3010fcntl.h\u51fd\u6570\u5e93\u7684\u5e38\u7528\u51fd\u6570\u4f7f\u7528\u3011\u3002 2 ) atoi ( buf ) \u51fd\u6570\u662f\u5c06buf\u4e2d\u7684\u5b57\u7b26\u4e32\u6570\u636e\u8f6c\u6362\u5c42\u6574\u5f62\u6570\u3002 3 ) gcc -o cpu_temp cpu_temp.c \uff1agcc\u4e3a\u7f16\u8bd1\u5668\u3001 -o\u53c2\u6570\u8868\u793a\u5c06cpu_temp.c\u6587\u4ef6\u7f16\u8bd1\u6210\u53ef\u6267\u884c\u6587\u4ef6\u5e76\u5b58\u653e\u5230 cpu_temp\u6587\u4ef6\u5939\u4e2d\u3002 2 \u3001\u901a\u8fc7python\u8bed\u8a00\u7f16\u7a0b\u83b7\u5f97cpu\u6e29\u5ea6\u503c #\u9009\u5b9a\u4e00\u4e2a\u76ee\u5f55\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u521b\u5efacpu_temp.py\u6587\u4ef6\uff0c\u5c06\u4ee5\u4e0b\u4ee3\u7801\u8f93\u5165\uff1a # -*- coding: utf-8 -*- # \u6253\u5f00\u6587\u4ef6 file = open ( \"/sys/class/thermal/thermal_zone0/temp\" ) # \u8bfb\u53d6\u7ed3\u679c\uff0c\u5e76\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 temp = float ( file.read ()) / 1000 # \u5173\u95ed\u6587\u4ef6 file.close () # \u5411\u7ec8\u7aef\u63a7\u5236\u53f0\u6253\u5370 print \"temp : %.3f\" %temp #\u6267\u884c\u811a\u672c Python cpu_temp.py cpu\u6e29\u5ea6\u83b7\u53d6\u8fd9\u6837\u5199\u4f1a\u4e0d\u4f1a\u66f4\u8f7b\u5de7\u4e9b def getCPUtemperature () : return os.popen ( \u2018/opt/vc/bin/vcgencmd measure_temp\u2019 ) .read ()[ 5 :9 ] \u6216\u8005\u76f4\u63a5\u8bfb\u53d6\u7cfb\u7edf\u81ea\u5df1\u7684\u72b6\u6001\u66f4\u65b0\uff0c\u7701\u53bb\u6a21\u62dfshell def getCPUtemperature () : with open ( \u201c/sys/class/thermal/thermal_zone0/temp\u201d ) as tempFile: res = tempFile.read () res = str ( float ( res ) /1000 ) return res \u540c\u7406\uff0cgetRaminfo () \u53ef\u4ee5\u5199\u6210\uff1a return os.popen ( \u2018free | tail -n +2\u2019 ) .readline () .split ()[ 1 :4 ] getDiskSpace () \u53ef\u4ee5\u5199\u6210\uff1areturn os.popen ( \u2018df -h / | tail -n +2\u2019 ) .readline () .split ()[ 1 :5 ] popen\u7684\u6548\u7387\u4e0d\u9ad8\uff0c\u4f46\u662f\u914d\u5408shell\u76f8\u5f53\u7075\u6d3b\uff5e\uff5e","title":"Raspberrypi"},{"location":"Others/#_4","text":"\u83b7\u53d6\u7a7a\u95f4\u97f3\u4e50 http : // qzone - music . qq . com / fcg - bin / cgi_playlist_xml . fcg ? uin = QQ \u53f7 & json = 1 & g_tk = 1916754934 CF \u6218\u7ee9\u67e5\u8be2 http : // apps . game . qq . com / cf / a20131114fhcx_mobile / getUserAct . php ? action = getuseract & iUin = 1376081701 & sArea = 325 & r = 1564199514663 & _ = 1564199514663 \" http://apps.game.qq.com/cf/a20131114fhcx_mobile/getUserAct.php?action=getuseract&iUin= \" + iUin + \" &sArea= \" + sArea + \" &r= \" + new Date () . getTime () ; http : // q2 . qlogo . cn / headimg_dl ? dst_uin = 1376081701 & spec = 100 http : // www . sse . com . cn / market / price / trends / http : // yunhq . sse . com . cn : 32041 / v1 / sh1 / snap / 600666 ? callback = jQuery11120579301615033067_1489046781341 & select = name % 2 Clast % 2 Cchg_rate % 2 Cchange % 2 Camount % 2 Cvolume % 2 Copen % 2 Cprev_close % 2 Cask % 2 Cbid % 2 Chigh % 2 Clow % 2 Ctradephase & _ = 1489046781349 https : // xueqiu . com / stock / forchartk / stocklist . json ? symbol = YHOO & period = 1 day & type = normal & end = 1457539200000 & _ = 1489048060047 http : // tushare . org https : // xueqiu . com / hq / screener http : // baostock . com https : // tushare . pro kickasstorrent thepiratebay https://www.canva.com/ https://www.pexels.com/ http://alpha.wallhaven.cc/ http://www.swsindex.com/ # \u83b7\u53d6\u516c\u7f51ip # \u666e\u901a\u6587\u672c\u683c\u5f0f curl icanhazip.com curl http://members.3322.org/dyndns/getip curl ip.6655.com/ip.aspx curl ident.me curl ipecho.net/plain curl whatismyip.akamai.com curl ifconfig.me curl myip.dnsomatic.com curl ifconfig.co # json\u683c\u5f0f curl ipinfo.io # \u8fd4\u56deip\u548c\u5730\u533a curl ip.6655.com/ip.aspx?area = 1 curl cip.cc /usr/bin/wget -q -O - http://icanhazip.com/ | /usr/bin/tail \u805a\u5408\u7684\u514d\u8d39API\u63a5\u53e3\u6570\u636e\uff1a \u624b\u673a\u53f7\u7801\u5f52\u5c5e\u5730API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/11 \u5386\u53f2\u4e0a\u7684\u4eca\u5929API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/63 \u80a1\u7968\u6570\u636eAPI\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/21 \u5168\u56fdWIFI\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/18 \u661f\u5ea7\u8fd0\u52bf\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/58 \u9ec4\u91d1\u6570\u636e\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/29 \u8bed\u97f3\u8bc6\u522b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/134 \u5468\u516c\u89e3\u68a6\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/64 \u5929\u6c14\u9884\u62a5API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/73 \u8eab\u4efd\u8bc1\u67e5\u8be2API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/38 \u7b11\u8bdd\u5927\u5168API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/95 \u90ae\u7f16\u67e5\u8be2\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/66 \u8001\u9ec4\u5386\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/65 \u7f51\u7ad9\u5b89\u5168\u68c0\u6d4b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/19 \u624b\u673a\u56fa\u8bdd\u6765\u7535\u663e\u793a\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/72 \u57fa\u91d1\u8d22\u52a1\u6570\u636e\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/28 \u6210\u8bed\u8bcd\u5178\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/157 \u65b0\u95fb\u5934\u6761\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/235 IP\u5730\u5740\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/1 \u95ee\u7b54\u673a\u5668\u4eba\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/112 \u6c47\u7387API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/80 \u7535\u5f71\u7968\u623f\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/44 \u4e07\u5e74\u5386API\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/177 NBA\u8d5b\u4e8b\u63a5\u53e3\uff1a https://www.juhe.cn/docs/api/id/92 \u767e\u5ea6 api\u96c6\u5e02\u514d\u8d39\u63a5\u53e3 IP\u5730\u5740\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/114.html \u9891\u9053\u65b0\u95fbAPI_\u6613\u6e90 http://apistore.baidu.com/apiworks/servicedetail/688.html \u5fae\u4fe1\u70ed\u95e8\u7cbe\u9009 http://apistore.baidu.com/apiworks/servicedetail/632.html \u5929\u6c14\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/112.html \u4e2d\u56fd\u548c\u4e16\u754c\u5929\u6c14\u9884\u62a5 http://apistore.baidu.com/apiworks/servicedetail/478.html \u80a1\u7968\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/115.html \u8eab\u4efd\u8bc1\u67e5\u8be2http://apistore.baidu.com/apiworks/servicedetail/113.html \u7f8e\u5973\u56fe\u7247 http://apistore.baidu.com/apiworks/servicedetail/720.html \u97f3\u4e50\u641c\u7d22 http://apistore.baidu.com/apiworks/servicedetail/1020.html \u56fe\u7075\u673a\u5668\u4eba http://apistore.baidu.com/apiworks/servicedetail/736.html \u6c47\u7387\u8f6c\u6362 http://apistore.baidu.com/apiworks/servicedetail/119.html \u8282\u5047\u65e5 http://apistore.baidu.com/apiworks/servicedetail/1116.html pullword\u5728\u7ebf\u5206\u8bcd\u670d\u52a1 http://apistore.baidu.com/apiworks/servicedetail/143.html \u53bb\u54ea\u513f\u7f51\u706b\u8f66\u7968 http://apistore.baidu.com/apiworks/servicedetail/697.html \u7b11\u8bdd\u5927\u5168 http://apistore.baidu.com/apiworks/servicedetail/864.html \u94f6\u884c\u5361\u67e5\u8be2\u670d\u52a1http://apistore.baidu.com/apiworks/servicedetail/735.html \u8bed\u97f3\u5408\u6210 http://apistore.baidu.com/apiworks/servicedetail/867.html \u5b85\u8a00API-\u52a8\u6f2b\u53f0\u8bcd\u63a5\u53e3 http://apistore.baidu.com/apiworks/servicedetail/446.html \u53bb\u54ea\u513f\u666f\u70b9\u95e8\u7968\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/140.html \u624b\u673a\u53f7\u7801\u5f52\u5c5e\u5730 http://apistore.baidu.com/apiworks/servicedetail/794.html \u4f53\u80b2\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/711.html \u624b\u673a\u5f52\u5c5e\u5730\u67e5\u8be2http://apistore.baidu.com/apiworks/servicedetail/709.html \u79d1\u6280\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/1061.html \u7a7a\u6c14\u8d28\u91cf\u6307\u6570 http://apistore.baidu.com/apiworks/servicedetail/116.html \u5929\u72d7\u5065\u5eb7\u83dc\u8c31 http://apistore.baidu.com/apiworks/servicedetail/987.html \u70ed\u95e8\u6e38\u8bb0\u5217\u8868 http://apistore.baidu.com/apiworks/servicedetail/520.html \u5929\u72d7\u836f\u54c1\u67e5\u8be2 http://apistore.baidu.com/apiworks/servicedetail/916.html \u6c49\u5b57\u8f6c\u62fc\u97f3 http://apistore.baidu.com/apiworks/servicedetail/1124.html \u56fd\u9645\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/823.html \u5f69\u7968 http://apistore.baidu.com/apiworks/servicedetail/164.html \u5fae\u4fe1\u7cbe\u9009 http://apistore.baidu.com/apiworks/servicedetail/863.html \u5929\u72d7\u5065\u5eb7\u8d44\u8baf http://apistore.baidu.com/apiworks/servicedetail/888.html \u5174\u8da3\u70b9\u68c0\u7d22 http://apistore.baidu.com/apiworks/servicedetail/182.html \u7528\u836f\u53c2\u8003 http://apistore.baidu.com/apiworks/servicedetail/754.html \u5929\u72d7\u5065\u5eb7\u77e5\u8bc6 http://apistore.baidu.com/apiworks/servicedetail/899.html \u5947\u95fb\u8da3\u4e8b http://apistore.baidu.com/apiworks/servicedetail/633.html \u82b1\u8fb9\u65b0\u95fb http://apistore.baidu.com/apiworks/servicedetail/768.html \u5929\u72d7\u533b\u9662\u5927\u5168 http://apistore.baidu.com/apiworks/servicedetail/988.html \u751f\u6d3b\u5065\u5eb7 http://apistore.baidu.com/apiworks/servicedetail/989.html \u4e00\u4e9b\u5176\u4ed6\u7684API\u63a5\u53e3\uff1a \u8c46\u74e3\u5f00\u653e https://developers.douban.com/wiki/?title=guide \u6dd8\u5b9d\u5f00\u653e\u5e73\u53f0 http://open.taobao.com/?spm=a219a.7395905.1.1.YdFDV6 \u56fe\u7075\u8bed\u97f3 http://www.tuling123.com/help/h_cent_andriodsdk.jhtml?nav=doc \u8baf\u98de\u8bed\u97f3http:// www.xfyun.cn/robots/solution \u9a6c\u5316\u817e\u7684\u5fae\u4fe1\u5f00\u653e\u5e73\u53f0\uff08\u5bf9\u5e94\u7684\u8fd8\u6709\u817e\u8baf\u5f00\u653e\u5e73\u53f0\uff09 https://open.weixin.qq.com/ \u878d\u4e91IMhttps://developer.rongcloud.cn/signin?returnUrl=%2Fapp%2Fappkey%2FPv4vYQwaxSZdfpLX5AI%3D \u767e\u5ea6\u5f00\u53d1\u8005\u4e2d\u5fc3http://developer.baidu.com/ \u4eba\u8138\u8bc6\u522bhttp:// www.faceplusplus.com.cn/ \u9ad8\u5fb7\u5730\u56fehttp://lbs.amap.com/ \u873b\u8713FMhttp://open.qingting.fm https://www.yesapi.cn/ https://www.tianqiapi.com https://www.free-api.com/ https://www.mumble.info/","title":"\u63a5\u53e3"},{"location":"Prometheus/","text":"","title":"Prometheus"},{"location":"Python3/","text":"python3\u624b\u518c \u00b6 Python\u76f8\u5173\u8bf4\u660e \u00b6 # \u5e93\uff1a\u76f8\u5173\u529f\u80fd\u7684\u5408\u96c6 \u51fd\u6570\uff1a \u5b9a\u4e49\uff1a def \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09\uff1a \u8bed\u53e5\u5757 return \u8fd4\u56de\u503c \u8c03\u7528\uff1a \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09 \u53d8\u91cf\u540d = \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09 # \u7c7b\uff1a \u7528\u6765\u63cf\u8ff0\u5177\u6709\u76f8\u540c\u5c5e\u6027\u548c\u65b9\u6cd5\u7684\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u5b9a\u4e49\u4e86\u8be5\u96c6\u5408\u4e2d\u6bcf\u4e2a\u5bf9\u8c61\u6240\u5171\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5bf9\u8c61\u662f\u7c7b\u7684\u5b9e\u4f8b\u3002 \u65b9\u6cd5\uff1a\u7c7b\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570 \u7c7b\u53d8\u91cf\uff1a\u7c7b\u53d8\u91cf\u5728\u6574\u4e2a\u5b9e\u4f8b\u5316\u7684\u5bf9\u8c61\u4e2d\u662f\u516c\u7528\u7684\u3002\u7c7b\u53d8\u91cf\u5b9a\u4e49\u5728\u7c7b\u4e2d\u4e14\u5728\u51fd\u6570\u4f53\u4e4b\u5916\u3002\u7c7b\u53d8\u91cf\u901a\u5e38\u4e0d\u4f5c\u4e3a\u5b9e\u4f8b\u53d8\u91cf\u4f7f\u7528\u3002 \u6570\u636e\u6210\u5458\uff1a\u7c7b\u53d8\u91cf\u6216\u8005\u5b9e\u4f8b\u53d8\u91cf\u7528\u4e8e\u5904\u7406\u7c7b\u53ca\u5176\u5b9e\u4f8b\u5bf9\u8c61\u7684\u76f8\u5173\u7684\u6570\u636e\u3002 \u65b9\u6cd5\u91cd\u5199\uff1a\u5982\u679c\u4ece\u7236\u7c7b\u7ee7\u627f\u7684\u65b9\u6cd5\u4e0d\u80fd\u6ee1\u8db3\u5b50\u7c7b\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u6539\u5199\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u65b9\u6cd5\u7684\u8986\u76d6\uff08 override \uff09\uff0c\u4e5f\u79f0\u4e3a\u65b9\u6cd5\u7684\u91cd\u5199\u3002 \u5b9e\u4f8b\u53d8\u91cf\uff1a\u5b9a\u4e49\u5728\u65b9\u6cd5\u4e2d\u7684\u53d8\u91cf\uff0c\u53ea\u4f5c\u7528\u4e8e\u5f53\u524d\u5b9e\u4f8b\u7684\u7c7b\u3002 \u7ee7\u627f\uff1a\u5373\u4e00\u4e2a\u6d3e\u751f\u7c7b\uff08 derived class \uff09\u7ee7\u627f\u57fa\u7c7b\uff08 base class \uff09\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5\u3002\u7ee7\u627f\u4e5f\u5141\u8bb8\u628a\u4e00\u4e2a\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\u4f5c\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u5bf9\u5f85 \u4f8b\u5982\uff0c\u6709\u8fd9\u6837\u4e00\u4e2a\u8bbe\u8ba1\uff1a\u4e00\u4e2a Dog \u7c7b\u578b\u7684\u5bf9\u8c61\u6d3e\u751f\u81ea Animal \u7c7b\uff0c\u8fd9\u662f\u6a21\u62df \" \u662f\u4e00\u4e2a\uff08is-a\uff09 \" \u5173\u7cfb\uff08\u4f8b\u56fe\uff0c Dog \u662f\u4e00\u4e2a Animal \uff09\u3002 \u5b9e\u4f8b\u5316\uff1a\u521b\u5efa\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\uff0c\u7c7b\u7684\u5177\u4f53\u5bf9\u8c61\u3002 \u5bf9\u8c61\uff1a\u901a\u8fc7\u7c7b\u5b9a\u4e49\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u4f8b\u3002\u5bf9\u8c61\u5305\u62ec\u4e24\u4e2a\u6570\u636e\u6210\u5458\uff08\u7c7b\u53d8\u91cf\u548c\u5b9e\u4f8b\u53d8\u91cf\uff09\u548c\u65b9\u6cd5\u3002\u4f7f\u7528 is \u68c0\u67e5\u5bf9\u8c61\u6807\u8bc6\u662f\u5426\u76f8\u540c \u7c7b\u7684\u4e13\u6709\u65b9\u6cd5\uff1a __init__ : \u6784\u9020\u51fd\u6570\uff0c\u5728\u751f\u6210\u5bf9\u8c61\u65f6\u8c03\u7528 __del__ : \u6790\u6784\u51fd\u6570\uff0c\u91ca\u653e\u5bf9\u8c61\u65f6\u4f7f\u7528 __repr__ : \u6253\u5370\uff0c\u8f6c\u6362 __setitem__ : \u6309\u7167\u7d22\u5f15\u8d4b\u503c __getitem__ : \u6309\u7167\u7d22\u5f15\u83b7\u53d6\u503c __len__ : \u83b7\u5f97\u957f\u5ea6 __cmp__ : \u6bd4\u8f83\u8fd0\u7b97 __call__ : \u51fd\u6570\u8c03\u7528 __add__ : \u52a0\u8fd0\u7b97 __sub__ : \u51cf\u8fd0\u7b97 __mul__ : \u4e58\u8fd0\u7b97 __div__ : \u9664\u8fd0\u7b97 __mod__ : \u6c42\u4f59\u8fd0\u7b97 __pow__ : \u4e58\u65b9 \u63d0\u4f9b\u4e86\u4e00\u79cd\u7ec4\u5408\u6570\u636e\u548c\u529f\u80fd\u7684\u65b9\u6cd5\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u7c7b\u610f\u5473\u7740\u521b\u5efa\u4e00\u4e2a\u65b0 \u7c7b\u578b \u7684\u5bf9\u8c61\uff0c\u4ece\u800c\u5141\u8bb8\u521b\u5efa\u4e00\u4e2a\u8be5\u7c7b\u578b\u7684\u65b0\u5b9e\u4f8b \u3002\u6bcf\u4e2a\u7c7b\u7684\u5b9e \u4f8b\u53ef\u4ee5\u62e5\u6709\u4fdd\u5b58\u81ea\u5df1\u72b6\u6001\u7684\u5c5e\u6027\u3002\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u6709\u6539\u53d8\u81ea\u5df1\u72b6\u6001\u7684\uff08\u5b9a\u4e49\u5728\u7c7b\u4e2d\u7684\uff09\u65b9\u6cd5\u3002 Python \u7684\u7c7b\u63d0\u4f9b\u4e86\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u6240\u6709 \u6807\u51c6\u7279\u6027\uff1a\u7c7b\u7ee7\u627f\u673a\u5236\u5141\u8bb8\u591a\u4e2a\u57fa\u7c7b\uff0c\u6d3e\u751f\u7c7b\u53ef\u4ee5\u8986\u76d6\u5b83\u57fa\u7c7b\u7684\u4efb\u4f55\u65b9\u6cd5\uff0c\u4e00\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8c03\u7528\u57fa\u7c7b\u4e2d\u76f8\u540c\u540d\u79f0\u7684\u7684\u65b9\u6cd5\u3002\u5bf9\u8c61\u53ef\u4ee5\u5305\u542b\u4efb \u610f\u6570\u91cf\u548c\u7c7b\u578b\u7684\u6570\u636e\u3002\u548c\u6a21\u5757\u4e00\u6837\uff0c\u7c7b\u4e5f\u62e5\u6709 Python \u7684\u52a8\u6001\u7279\u6027\uff1a\u5b83\u4eec\u5728\u8fd0\u884c\u65f6\u521b\u5efa\uff0c\u53ef\u4ee5\u5728\u521b\u5efa\u540e\u4fee\u6539 \u7c7b\uff1a \u5b9a\u4e49\uff1a class \u7c7b\u540d () \uff1a def __init__ ( self ,\u53c2\u6570\u2026\u2026 ) : def \u51fd\u6570\u540d 1 ( self ,\u53c2\u6570\u2026\u2026 ) : def \u51fd\u6570\u540d 2 ( self ,\u53c2\u6570\u2026\u2026 ) : \u8c03\u7528\uff1a \u5b9e\u4f8b\u540d = \u7c7b\u540d () \u5b9e\u4f8b\u540d.\u65b9\u6cd5\u540d ( \u53c2\u6570 ) # \u6846\u67b6\uff1a\u63a7\u5236\u53cd\u8f6c # \u6a21\u5757\uff1a \u6a21\u5757\u5373\u666e\u901a\u7684 python \u6587\u4ef6\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5e76\u5bfc\u5165\uff0c\u6a21\u5757\u540d\u79f0\u5373\u6587\u4ef6\u540d\u79f0\uff0c\u5177\u6709\u663e\u5f0f\u5bfc\u51fa\u548c\u5bfc\u5165\u7684\u62bd\u8c61\u63a5\u53e3\uff0c\u5b9e\u73b0\u548c\u63a5\u53e3\u662f\u5206\u5f00\u7684 \u53ef\u80fd\u6709\u591a\u4e2a\u5b9e\u73b0\u5e76\u4e14\u5b9e\u73b0\u662f\u9690\u85cf\u7684\u3002\u901a\u4fd7\u7684\u8bb2\uff0c\u5c06\u81ea\u884c\u5b9a\u4e49\u6216\u5df2\u7ecf\u5b58\u5728\u7684\u65b9\u6cd5\u548c\u53d8\u91cf\u5b58\u653e\u5728\u6587\u4ef6\u4e2d\uff0c\u4e3a\u4e00\u4e9b\u811a\u672c\u6216\u4ea4\u4e92\u5f0f\u89e3\u91ca\u5668\u5b9e\u4f8b\u4f7f\u7528 \u8fd9\u6837\u7684\u6587\u4ef6\u88ab\u79f0\u4e4b\u4e3a\u6a21\u5757\uff1b\u6a21\u5757\u662f\u4e00\u4e2a\u5305\u542b Python \u5b9a\u4e49\u51fd\u6570\u3001\u53d8\u91cf\u548c\u8bed\u53e5\u7684\u6587\u4ef6\u3002\u6a21\u5757\u53ef\u4ee5\u88ab\u522b\u7684\u7a0b\u5e8f\u5f15\u5165\uff0c\u4ee5\u4f7f\u7528\u8be5\u6a21\u5757\u4e2d\u7684\u51fd\u6570\u7684 \u529f\u80fd\u548c\u5c5e\u6027\uff0c\u8fd9\u4e5f\u662f\u4f7f\u7528 python \u6807\u51c6\u5e93\u7684\u65b9\u6cd5,\u5982\u679c\u81ea\u5b9a\u4e49\u7684\u6709\u548c\u6807\u51c6\u5e93\u76f8\u540c\u7684\u6a21\u5757\uff0c\u5219\u4f1a\u8986\u76d6\u6807\u51c6\u5e93 \u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u6807\u8bc6\u7b26\u662f\u6709\u7279\u6b8a\u610f\u4e49\u7684\u3002 \u2022 \u4ee5\u5355\u4e0b\u5212\u7ebf\u5f00\u5934\uff08 _foo \uff09\u7684\u4ee3\u8868\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u7684\u7c7b\u5c5e\u6027\uff0c\u9700\u901a\u8fc7\u7c7b\u63d0\u4f9b\u7684\u63a5\u53e3\u8fdb\u884c\u8bbf\u95ee\uff1b \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\uff08 __foo \uff09\u4ee3\u8868\u7c7b\u7684\u79c1\u6709\u6210\u5458\uff1b \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\uff08 __foo__ \uff09\u4ee3\u8868 python \u91cc\u7279\u6b8a\u65b9\u6cd5\u4e13\u7528\u7684\u6807\u8bc6\uff0c\u5982 __init__ \uff08\uff09\u4ee3\u8868\u7c7b\u7684\u6784\u9020\u51fd\u6570\u3002 # \u6a21\u5757\uff08 modules \uff09\uff1a \u6a21\u5757 ( module ) \u662f python \u6700\u9ad8\u7ea7\u522b\u7684\u7a0b\u5e8f\u7ec4\u7ec7\u5355\u4f4d\u3002\u5b83\u53ef\u4ee5\u6253\u5305\u7a0b\u5e8f\u4ee3\u7801\u548c\u6570\u636e\u4ee5\u5907\u91cd\u7528 \u6a21\u5757\u91c7\u7528 python \u7a0b\u5e8f\u7684\u6587\u4ef6\u5f62\u5f0f\uff08\u6216\u8005 C \u6269\u5c55\u7a0b\u5e8f\u7684\u5f62\u5f0f\uff09\u5b58\u50a8\uff0c\u5ba2\u6237\u5bfc\u5165\u6a21\u5757\u5e76\u5bf9\u4f7f\u7528\u4ed6\u4eec\u5b9a\u4e49\u7684\u540d\u5b57 ## \u6807\u51c6\u6a21\u5757 Python \u9644\u5e26\u4e00\u4e2a\u6807\u51c6\u6a21\u5757\u5e93\uff0c\u53d8\u91cf sys . ps1 \u548c sys . ps2 \u5b9a\u4e49\u7528\u4f5c\u4e3b\u8981\u548c\u8f85\u52a9\u63d0\u793a\u7684\u5b57\u7b26\u4e32\uff1b\u8fd9\u4e24\u4e2a\u53d8\u91cf\u53ea\u6709\u5728\u7f16\u8bd1\u5668\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u624d\u88ab\u5b9a\u4e49 sys . path \u53d8\u91cf\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868\uff0c\u7528\u4e8e\u786e\u5b9a\u89e3\u91ca\u5668\u7684\u6a21\u5757\u641c\u7d22\uff0c\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6\u5217\u8868\u64cd\u4f5c\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u3002 ## \u5305 ( packages ) \u5305\u662f\u4e00\u79cd\u901a\u8fc7\u7528 \" \u5e26\u70b9\u53f7\u7684\u6a21\u5757\u540d \" \u6765\u6784\u9020 Python \u6a21\u5757\u547d\u540d\u7a7a\u95f4\u7684\u5f62\u5f0f\u3002 \u8bf7\u6ce8\u610f\uff0c\u5f53\u4f7f\u7528 from package import item \u65f6\uff0c item \u53ef\u4ee5\u662f\u5305\u7684\u5b50\u6a21\u5757\uff08\u6216\u5b50\u5305\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u5305\u4e2d\u5b9a\u4e49\u7684\u5176\u4ed6\u540d\u79f0\uff0c\u5982\u51fd\u6570\uff0c\u7c7b\u6216\u53d8\u91cf import \u8bed\u53e5\u9996\u5148\u6d4b\u8bd5\u662f\u5426\u5728\u5305\u4e2d\u5b9a\u4e49\u4e86 item \uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5b83\u5047\u5b9a\u5b83\u662f\u4e00\u4e2a\u6a21\u5757\u5e76\u5c1d\u8bd5\u52a0\u8f7d\u5b83\u3002\u5982\u679c\u627e\u4e0d\u5230\u5b83\uff0c\u5219\u5f15\u53d1 ImportError \u5f02\u5e38 \u76f8\u53cd\uff0c\u5f53\u4f7f\u7528 import item . subitem . subsubitem \u8fd9\u6837\u7684\u8bed\u6cd5\u65f6\uff0c\u9664\u4e86\u6700\u540e\u4e00\u9879\u4e4b\u5916\u7684\u6bcf\u4e00\u9879\u90fd\u5fc5\u987b\u662f\u4e00\u4e2a\u5305\uff1b\u6700\u540e\u4e00\u9879\u53ef\u4ee5\u662f\u6a21\u5757\u6216\u5305 \u4f46\u4e0d\u80fd\u662f\u524d\u4e00\u9879\u4e2d\u5b9a\u4e49\u7684\u7c7b\u6216\u51fd\u6570\u6216\u53d8\u91cf * \u8981\u4f7f\u7528\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5b57\u9762\u503c\uff0c\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5f15\u53f7\u6216\u4e09\u5f15\u53f7\u4e4b\u524d\u52a0\u4e0a\u4e00\u4e2a f \u6216 F \uff0c\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\uff0c\u53ef\u4ee5\u5728{}\u5b57\u7b26\u4e4b\u95f4\u5f15\u7528\u53d8\u91cf\u6216\u5b57\u9762\u503c\u7684 Python \u8868\u8fbe\u5f0f * \u5b57\u7b26\u4e32\u7684 str . format () \u65b9\u6cd5 * \u4f7f\u7528\u5b57\u7b26\u4e32\u5207\u7247\u548c\u8fde\u63a5\u64cd\u4f5c\u81ea\u884c\u5b8c\u6210\u5bf9\u6240\u6709\u5b57\u7b26\u4e32\u7684\u5904\u7406 # import \u8bed\u53e5: \u51fa\u4e8e\u6548\u7387\u7684\u8003\u8651\uff0c\u6bcf\u4e2a\u6a21\u5757\u5728\u6bcf\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u53ea\u88ab\u5bfc\u5165\u4e00\u6b21\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u66f4\u6539\u4e86\u4f60\u7684\u6a21\u5757\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u542f\u52a8\u89e3\u91ca\u5668\uff0c \u6216\u8005\uff0c\u5982\u679c\u5b83\u53ea \u662f\u4e00\u4e2a\u8981\u4ea4\u4e92\u5f0f\u5730\u6d4b\u8bd5\u7684\u6a21\u5757\uff0c\u8bf7\u4f7f\u7528 importlib . reload () \uff0c\u4f8b\u5982 import importlib ; importlib.reload(modulename) \u6a21\u5757\u641c\u7d22\u8def\u5f84\uff1a\u89e3\u91ca\u5668\u9996\u5148\u5bfb\u627e\u5177\u6709\u8be5\u5bfc\u5165\u540d\u79f0\u7684\u5185\u7f6e\u6a21\u5757\uff0c\u82e5\u6ca1\u6709\u5219\u4f1a\u4ece sys . path \u53d8\u91cf\u6240\u7ed9\u51fa\u7684\u76ee\u5f55\u5217\u8868\u5bfb\u627e\uff0c\u652f\u6301\u7b26\u53f7\u94fe\u63a5\u7684\u6587\u4ef6\u7cfb \u7edf\u4e0a\uff0c\u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55\u662f\u5728\u8ffd\u52a0\u7b26\u53f7\u94fe\u63a5\u540e\u624d\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5305\u542b\u7b26\u53f7\u94fe\u63a5\u7684\u76ee\u5f55\u5e76\u6ca1\u6709\u88ab\u6dfb\u52a0\u5230\u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84\u4e0a sys . path \u7684\u521d\u59cb\u76ee\u5f55\u5730\u5740\uff1a * \u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55 ( \u6216\u8005\u672a\u6307\u5b9a\u6587\u4ef6\u65f6\u7684\u5f53\u671f\u76ee\u5f55 ) * PYTHONPATH ( \u4e00\u4e2a\u5305\u542b\u76ee\u5f55\u540d\u79f0\u7684\u5217\u8868\uff0c\u5176\u548c shell \u53d8\u91cf PATH \u5177\u6709\u76f8\u540c\u7684\u8bed\u6cd5 ) * \u53d6\u51b3\u4e8e Python \u5b89\u88c5\u7684\u9ed8\u8ba4\u8bbe\u7f6e \u4e86\u89e3\u4e86\u641c\u7d22\u8def\u5f84\u7684\u6982\u5ff5\uff0c\u5c31\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4fee\u6539 sys . path \u6765\u5f15\u5165\u4e00\u4e9b\u4e0d\u5728\u641c\u7d22\u8def\u5f84\u4e2d\u7684\u6a21\u5757 ** __name__ \u5c5e\u6027 ** \u4e00\u4e2a\u6a21\u5757\u88ab\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u7b2c\u4e00\u6b21\u5f15\u5165\u65f6\uff0c\u5176\u4e3b\u7a0b\u5e8f\u5c06\u8fd0\u884c\u3002\u5982\u679c\u6211\u4eec\u60f3\u5728\u6a21\u5757\u88ab\u5f15\u5165\u65f6\uff0c\u6a21\u5757\u4e2d\u7684\u67d0\u4e00\u7a0b\u5e8f\u5757\u4e0d\u6267\u884c \u6211\u4eec\u53ef\u4ee5\u7528 __name__ \u5c5e\u6027\u6765\u4f7f\u8be5\u7a0b\u5e8f\u5757\u4ec5\u5728\u8be5\u6a21\u5757\u81ea\u8eab\u8fd0\u884c\u65f6\u6267\u884c if __name__ == ' __main__ ' : print ( ' \u7a0b\u5e8f\u81ea\u8eab\u5728\u8fd0\u884c ' ) else : print ( ' \u6211\u6765\u81ea\u53e6\u4e00\u6a21\u5757 ' ) \u6bcf\u4e2a\u6a21\u5757\u90fd\u6709\u4e00\u4e2a __name__ \u5c5e\u6027\uff0c\u5f53\u5176\u503c\u662f ' __main__ ' \u65f6\uff0c\u8868\u660e\u8be5\u6a21\u5757\u81ea\u8eab\u5728\u8fd0\u884c\uff0c\u5426\u5219\u662f\u88ab\u5f15\u5165 \u53ef\u4ee5\u5728 Python \u547d\u4ee4\u4e2d\u4f7f\u7528 - O \u6216 - OO \u5f00\u5173,\u4ee5\u51cf\u5c0f\u7f16\u8bd1\u540e\u6a21\u5757\u7684\u5927\u5c0f\u3002 - O \u5f00\u5173\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\uff0c - OO \u5f00\u5173\u540c\u65f6\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\u548c __doc__ \u5b57\u7b26\u4e32\uff1b \u4e00\u4e2a\u4ece. pyc \u6587\u4ef6\u8bfb\u51fa\u7684\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u6bd4\u5b83\u4ece. py \u8bfb\u51fa\u65f6\u8fd0\u884c\u7684\u66f4\u5feb\u3002\u533a\u522b\u5728\u4e8e. pyc \u6587\u4ef6\u8f7d\u5165\u901f\u5ea6\u66f4\u5feb compileall \u6a21\u5757\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6a21\u5757\u521b\u5efa. pyc \u6587\u4ef6 # \u5bfc\u5165\u6a21\u5757 import math # \u4ece\u4e00\u4e2a\u6a21\u5757\u5bfc\u5165\u7279\u5b9a\u7684\u51fd\u6570 ceil , floor from math import ceil , floor # \u5bfc\u5165\u5e76\u7b80\u5316\u4e00\u4e2a\u6a21\u5757\u7684\u540d\u79f0 import math as m Python\u5f00\u53d1\u73af\u5883\u6700\u4f73\u5b9e\u8df5 \u00b6 # \u8bbe\u7f6epip\u914d\u7f6e\u6587\u4ef6 : << comment Linux\uff1a$HOME/.pip/pip.conf Windows\uff1a%APPDATA%\\pip\\pip.ini virtualenv\uff1a%VIRTUAL_ENV%\\pip.ini \u5168\u5c40\u751f\u6548\u8bbe\u7f6e\u5982\u4e0b\uff1a(\u4e0d\u652f\u6301Windows Vista) Linux\uff1a/etc/pip.conf Windows XP\uff1aC:\\Documents and Settings\\All Users\\Application Data\\pip\\pip.ini Windows7\u6216\u4e4b\u540e\u7248\u672c\uff1aC:\\ProgramData\\pip\\pip.ini comment # pip\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a [ global ] timeout = 120 no-cache-dir = true index-url = https://mirrors.aliyun.com/pypi/simple/ extra-index-url = https://mirrors.huaweicloud.com/repository/pypi/simple [ freeze ] timeout = 10 [ install ] ignore-installed = true trusted-host = mirrors.aliyun.com mirrors.huaweicloud.com python -m SimpleHTTPServer | Serve current directory tree at http:// $HOSTNAME :8000/ # \u5229\u7528python\u7b80\u5355\u5efa\u7acbwebserver # yum -y install epel-release # yum -y install python2-pip # yum -y install python3-pip python -m pip install -U pip setuptools # python -m site --user-base \u627e\u5230 \u7528\u6237\u57fa\u7840\u76ee\u5f55,\u5c06\u57fa\u7840\u76ee\u5f55\u6dfb\u52a0\u5230PATH # \u5728 Windows \u4e0a\uff0c\u60a8\u901a\u8fc7\u8fd0\u884c py -m site --user-site \u627e\u5230\u7528\u6237\u57fa\u7840\u76ee\u5f55\uff0c\u5c06 site-packages \u66ff\u6362\u4e3a Scripts # \u81ea\u5b9a\u4e49pipenv\u865a\u62df\u73af\u5883\u521b\u5efa\u76ee\u5f55\uff0cwindows\u901a\u8fc7\u8bbe\u7f6e\u53d8\u91cfWORKON_HOME\uff0c\u5176\u503c\u8bbe\u7f6e\u4e3aPIPENV_VENV_IN_PROJECT\u65f6\u8868\u793a\u5f53\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa # linux\u5728.bashrc\u6587\u4ef6\u6dfb\u52a0export PIPENV_VENV_IN_PROJECT=1\u6216export PIPENV_VENV_IN_PROJECT=\"enabled\" pip install --user pipenv # \u5728Windows\u5b89\u88c5virtualenv\u548cvirtualenvwrapper-win\u7528\u4e8e\u521b\u5efa\u591a\u4e2aPython\u7248\u672c\u5f00\u53d1\u73af\u5883\uff0cLinux\u4e2d\u6700\u597d\u4f7f\u7528pyenv\u4ee3\u66ff # \u5b89\u88c5pipenv\u548cautoenv\uff0c\u81ea\u52a8\u6fc0\u6d3b\u73af\u5883 # \u5728Linux\u4e0a: git clone git://github.com/kennethreitz/autoenv.git ~/.autoenv echo 'source ~/.autoenv/activate.sh' >> ~/.bashrc # pipes\uff1aPipenv\u865a\u62df\u73af\u5883\u5207\u6362\u5de5\u5177 # MacOs + Ubuntu: pip3 install pipenv-pipes --user # Windows: pip3 install pipenv-pipes pip3 install curses --find-links = https://github.com/gtalarico/curses-win/releases \u7b80\u4ecb \u00b6 #!/usr/bin/python3 # -*- coding: UTF-8 -*- # Python\u4e2d\u5355\u884c\u6ce8\u91ca\u4ee5#\u5f00\u5934\uff0c\u591a\u884c\u6ce8\u91ca\u7528\u4e09\u4e2a\u5355\u5f15\u53f7\uff08```\uff09\u6216\u8005\u4e09\u4e2a\u53cc\u5f15\u53f7\uff08\"\"\"\uff09\u5c06\u6ce8\u91ca\u62ec\u8d77\u6765\u3002 # \u7279\u6b8a\u5b57\u7b26\u6bd4\u5982\\n\u5728\u5355\u53cc\u5f15\u53f7\u6709\u540c\u6837\u7684\u610f\u4e49\uff0c\u4e0d\u540c\u4e4b\u5904\u662f\u5728\u5355\u5f15\u53f7\u4e2d\u65e0\u9700\u8f6c\u4e49\u53cc\u5f15\u53f7\uff0c\u4e5f\u5c31\u662f\u8868\u793a\u5176\u5b9e\u9645\u610f\u4e49\u3002\u53cd\u4e4b\u4ea6\u7136 help ( len ) # \u5185\u5efalen()\u51fd\u6570\u5e2e\u52a9 help ( sys ) # sys\u6a21\u5757\u5e2e\u52a9,\u5fc5\u987b\u5148import sys help ( sys . exit ) # exit()\u51fd\u6570\u5728sys\u6a21\u5757\u7684\u5e2e\u52a9 help ( 'xyz' . split ) # \u5bf9\u4e8estring\u5bf9\u8c61splist()\u65b9\u6cd5\u7684\u5e2e\u52a9\uff0c\u548chelp(str.split)\u4e00\u6837 help ( list ) # list\u5bf9\u8c61\u5e2e\u52a9 help ( list . append ) # list\u5bf9\u8c61append()\u65b9\u6cd5\u5e2e\u52a9 dir ( list ) # \u663e\u793alist\u5bf9\u8c61\u5c5e\u6027\uff0c\u5305\u62ec\u5176\u65b9\u6cd5 dir ( sys ) # \u7c7b\u4f3chelp() python\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u6709\u56db\u79cd \uff1a \u6574\u6570int \u3001 \u957f\u6574\u6570 \u3001 \u6d6e\u70b9\u6570float \u3001 \u590d\u6570complex python\u4e2d\u53d8\u91cf\u65e0\u9700\u58f0\u660e \uff0c \u6bcf\u4e2a\u53d8\u91cf\u5728\u4f7f\u7528\u524d\u5fc5\u987b\u8d4b\u503c \uff0c \u53d8\u91cf\u8d4b\u503c\u540e\u8be5\u53d8\u91cf\u624d\u4f1a\u88ab\u521b\u5efa \u3002 \u53d8\u91cf\u6ca1\u6709\u7c7b\u578b \uff0c \u800c\u901a\u5e38\u6240\u8bf4\u7684 \u201c \u7c7b\u578b \u201d \u6307\u5185\u5b58\u4e2d\u5bf9\u8c61\u7684\u7c7b\u578b python3\u4e2d\u5e38\u7528\u7684\u5185\u7f6e\u6570\u636e\u7c7b\u578b \uff1a * Boolean ( \u5e03\u5c14\u503c ) * Numbers ( \u6570\u5b57 ) * String ( \u5b57\u7b26\u4e32 ) * Bytes ( \u5b57\u8282 ) * List ( \u5217\u8868 ) * \u793a\u4f8b \uff1a list1 = [ 'Google' , 'aws' , 1997 , 2000 ] * \u7a7a\u5217\u8868 : list2 = [] * Tuple ( \u5143\u7ec4 ) * \u793a\u4f8b \uff1a tuple1 = ( 'Google' , 'aws' , 1997 , 2000 ) * \u7a7a\u5143\u7ec4 : tuple2 = () ======>> \u7b49\u4ef7\u4e8etuple1 = tuple () * Sets ( \u96c6\u5408 ) * \u793a\u4f8b \uff1a set1 = { 'apple' , 234 , 'apple' , 'banana' } * \u7a7a\u96c6\u5408 \uff1a set2 = set () * Dictionaries ( \u5b57\u5178 ) * \u793a\u4f8b \uff1a dict1 = { 'Alice' : '21' , 'Beth' : '12' , 'Cecil' : '19' } * \u7a7a\u5b57\u5178 : dict1 = {} python\u53ef\u53d8\u6570\u636e\u7c7b\u578b \uff1a list \u3001 dict python\u4e0d\u53ef\u53d8\u6570\u636e\u7c7b\u578b \uff1a int \u3001 str \u3001 tuple \u5185\u7f6e\u6807\u51c6\u5e93 \u00b6 python\u5185\u7f6e\u51fd\u6570\u5217\u8868\uff1a\u5177\u4f53\u7528\u6cd5\u89c1help(\u51fd\u6570) \u5185\u7f6e\u51fd\u6570 abs() delattr() hash() memoryview() set() all() dict() help() min() setattr() any() dir() hex() next() slice() ascii() divmod() id() object() sorted() bin() enumerate() input() oct() staticmethod() bool() eval() int() open() str() breakpoint() exec() isinstance() ord() sum() bytearray() filter() issubclass() pow() super() bytes() float() iter() print() tuple() callable() format() len() property() type() chr() frozenset() list() range() vars() classmethod() getattr() locals() repr() zip() compile() globals() map() reversed() __import__() complex() hasattr() max() round() \u5185\u7f6e\u5e38\u91cf \u00b6 \u5c11\u6570\u7684\u5e38\u91cf\u5b58\u5728\u4e8e\u5185\u7f6e\u547d\u540d\u7a7a\u95f4\u4e2d\uff1a \u5185\u7f6e\u7c7b\u578b \u00b6 \u903b\u8f91\u503c\u68c0\u6d4b\uff1a\u4efb\u4f55\u5bf9\u8c61\u90fd\u53ef\u4ee5\u8fdb\u884c\u903b\u8f91\u503c\u68c0\u6d4b \u00b6 \u4e0b\u9762\u57fa\u672c\u5b8c\u6574\u7f57\u5217\u51fa\u4f1a\u88ab\u89c6\u4e3a\u5047\u503c\u7684\u5185\u7f6e\u5bf9\u8c61\uff1a * \u88ab\u5b9a\u4e49\u4e3a\u5047\u503c\u7684\u5e38\u91cf: None \u548c False * \u4efb\u4f55\u6570\u503c\u7c7b\u578b\u7684\u96f6: 0, 0.0, 0j, Decimal(0), Fraction(0, 1) * \u7a7a\u7684\u5e8f\u5217\u548c\u591a\u9879\u96c6: '', (), [], {}, set(), range(0) \u5e03\u5c14\u7c7b\u578b\u8fd0\u7b97\uff1aand\u3001or\u3001not \u00b6 \u8fd0\u7b97 \u7ed3\u679c \u6ce8\u91ca x or y if x is false, then y, else x \u8fd9\u662f\u4e2a\u77ed\u8def\u8fd0\u7b97\u7b26\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u771f\u503c\u65f6\u624d\u4f1a\u5bf9\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6c42\u503c x and y if x is false, then x, else y not \u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64 not a == b \u4f1a\u88ab\u89e3\u8bfb\u4e3a not (a == b) \u800c a == not b \u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef not x if x is false, then True, else False not \u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64 not a == b \u4f1a\u88ab\u89e3\u8bfb\u4e3a not (a == b) \u800c a == not b \u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef \u6bd4\u8f83\u8fd0\u7b97\uff1a \u00b6 \u516b\u79cd\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u4f18\u5148\u7ea7\u76f8\u540c(\u6bd4\u5e03\u5c14\u8fd0\u7b97\u4f18\u5148\u7ea7\u9ad8)\u3002\u6bd4\u8f83\u8fd0\u7b97\u53ef\u4ee5\u4efb\u610f\u4e32\u8fde\u3002is\u548cis not\u8fd0\u7b97\u7b26\u65e0\u6cd5\u81ea\u5b9a\u4e49\u5e76\u4e14\u53ef\u4ee5\u88ab\u5e94\u7528\u4e8e\u4efb\u610f\u4e24\u4e2a \u5bf9\u8c61\u800c\u4e0d\u4f1a\u5f15\u53d1\u5f02\u5e38\uff1b\u8fd8\u6709\u4e24\u79cd\u5177\u6709\u76f8\u540c\u8bed\u6cd5\u4f18\u5148\u7ea7\u7684\u8fd0\u7b97in\u548cnot in\uff0c\u5b83\u4eec\u88abiterable\u6216\u5b9e\u73b0\u4e86__contains__()\u65b9\u6cd5\u7684\u7c7b\u578b\u6240\u652f\u6301 \u8fd0\u7b97\u7b26 \u542b\u4e49 < \u5c0f\u4e8e <= \u5c0f\u4e8e\u6216\u7b49\u4e8e > \u5927\u4e8e >= \u5927\u4e8e\u6216\u7b49\u4e8e == \u7b49\u4e8e != \u4e0d\u7b49\u4e8e is \u5bf9\u8c61\u6807\u8bc6 is not \u5426\u5b9a\u5bf9\u8c61\u6807\u8bc6 \u6570\u5b57\u7c7b\u578b\u8fd0\u7b97\uff1aint\u3001float\u3001complex \u00b6 Python\u6709\u4e09\u79cd\u4e0d\u540c\u7684\u6570\u5b57\u7c7b\u578b\uff1a\u6574\u6570\u3001\u6d6e\u70b9\u6570\u548c\u590d\u6570\u3002\u5e03\u5c14\u503c\u5c5e\u4e8e\u6574\u6570\u7684\u5b50\u7c7b\u578b\u3002\u6574\u6570\u6709\u65e0\u9650\u7cbe\u5ea6\uff0c\u6d6e\u70b9\u6570\u901a\u5e38\u4ee5C\u8bed\u8a00\u4e2ddouble\u5b9e\u73b0 \u590d\u6570\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\uff0c\u6bcf\u4e2a\u90fd\u662f\u6d6e\u70b9\u6570 \u6570\u5b57\u662f\u7531\u6570\u5b57\u5b57\u9762\u503c\u6216\u5185\u7f6e\u51fd\u6570\u4e0e\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u6765\u521b\u5efa\u3002\u672a\u4fee\u9970\u7684\u6574\u6570\u5b57\u9762\u503c(\u5305\u62ec\u5341\u516d\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u548c\u4e8c\u8fdb\u5236\u6570)\u4f1a\u751f\u6210\u6574\u6570\uff0c\u5305\u542b\u5c0f\u6570\u70b9\u6216\u5e42\u8fd0\u7b97\u7b26\u7684 \u6570\u5b57\u5b57\u9762\u503c\u4f1a\u751f\u6210\u6d6e\u70b9\u6570\uff0c\u5728\u6570\u5b57\u5b57\u9762\u503c\u672b\u5c3e\u52a0\u4e0a 'j' \u6216 'J' \u4f1a\u751f\u6210\u865a\u6570(\u5b9e\u90e8\u4e3a\u96f6\u7684\u590d\u6570)\u5c06\u5176\u4e0e\u6574\u6570\u6216\u6d6e\u70b9\u6570\u76f8\u52a0\u6765\u5f97\u5230\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\u7684\u590d\u6570 Numbers(\u6570\u5b57) \u00b6 python3\u652f\u6301int ( \u6574\u6570 ) \u3001 float ( \u6d6e\u70b9 ) \u3001 bool ( \u5e03\u5c14 ) \u3001 complex ( \u590d\u6570 ) \u6ce8\u610f\uff1a python\u53ef\u4ee5\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8d4b\u503c \uff0c\u5982\uff1a a , b = 1 , 2 \u4e00\u4e2a\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8d4b\u503c\u6307\u5411\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61 \u6570\u503c\u7684\u9664\u6cd5\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6d6e\u70b9\u6570\uff0c\u8981\u83b7\u53d6\u6574\u6570\u4f7f\u7528 // \u64cd\u4f5c\u7b26 \u5728\u6df7\u5408\u8ba1\u7b97\u65f6\uff0c Python\u4f1a\u628a\u6574\u6570\u7c7b\u578b\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 \u6240\u6709\u6570\u5b57\u7c7b\u578b\uff08\u590d\u6570\u9664\u5916\uff09\u90fd\u652f\u6301\u4e0b\u5217\u8fd0\u7b97\uff0c\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f(\u6240\u6709\u6570\u5b57\u8fd0\u7b97\u7684\u4f18\u5148\u7ea7\u90fd\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97) \u5411\u4e0a\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u524d\u9762\u7684\u6574\u6570\u5c31\u52a01 \u5411\u4e0b\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u5ffd\u7565\u5c0f\u6570 \u8fd0\u7b97\u7b26 \u63cf\u8ff0 \u6ce8\u91ca + \u52a0 - \u51cf * \u4e58 / \u9664 // \u53d6\u6574\u6570--\u8fd4\u56de\u5546\u7684\u6574\u6570\u90e8\u5206(\u5411\u4e0b\u53d6\u6574) \u7ed3\u679c\u662f\u4e2a\u6574\u6570\uff0c\u4f46\u7c7b\u578b\u4e0d\u4e00\u5b9a\u662fint\uff0c\u8fd0\u7b97\u7ed3\u679c\u603b\u662f\u5411\u8d1f\u65e0\u7a77\u65b9\u5411\u820d\u5165\u3002\u5982\uff1a1//2\u4e3a0\uff0c(-1)//2\u4e3a-1 % \u53d6\u6a21--\u8fd4\u56de\u9664\u6cd5\u7684\u4f59\u6570 \u4e0d\u53ef\u7528\u4e8e\u590d\u6570\uff0c\u800c\u5e94\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\u4f7f\u7528abs()\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 -x x \u53d6\u53cd +x x \u4e0d\u53d8 abs(x) x \u7684\u7edd\u5bf9\u503c\u6216\u5927\u5c0f int(x) \u5c06 x \u8f6c\u6362\u4e3a\u6574\u6570 float(x) \u5c06 x \u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 complex(re, im) \u4e00\u4e2a\u5e26\u6709\u5b9e\u90e8 re \u548c\u865a\u90e8 im \u7684\u590d\u6570\u3002im \u9ed8\u8ba4\u4e3a0 c.conjugate() \u590d\u6570 c \u7684\u7ed3\u5408(\u5171\u8f6d) divmod(x, y) (x // y, x % y) \u4e0d\u53ef\u7528\u4e8e\u590d\u6570 pow(x, y) x \u7684 y \u6b21\u5e42 Python\u5c06pow(0, 0)\u548c0**0\u5b9a\u4e49\u4e3a1\uff0c\u8fd9\u662f\u7f16\u7a0b\u8bed\u8a00\u666e\u904d\u505a\u6cd5 ** \u5e42 \u6240\u6709\u7684numbers.Real\u7c7b\u578b(int\u548cfloat)\u8fd8\u5305\u62ec\u4ee5\u4e0b\u8fd0\u7b97(\u66f4\u591a\u6570\u5b57\u8fd0\u7b97\u53c2\u8003math\u548ccmath\u6a21\u5757): \u8fd0\u7b97\u7b26 \u7ed3\u679c math.trunc(x) x \u622a\u65ad\u4e3aIntegral round(x[, n]) x \u820d\u5165\u5230n\u4f4d\u5c0f\u6570\uff0c\u534a\u6570\u503c\u4f1a\u820d\u5165\u5230\u5076\u6570\uff0c\u5982\u679c\u7701\u7565n\uff0c\u5219\u9ed8\u8ba4\u4e3a0 math.floor(x) <= x \u7684\u6700\u5927 Integral math.ceil(x) >= x \u7684\u6700\u5c0f Integral \u6574\u6570\u7c7b\u578b\u7684\u6309\u4f4d\u8fd0\u7b97 \u00b6 \u6309\u4f4d\u8fd0\u7b97\u53ea\u5bf9\u6574\u6570\u6709\u610f\u4e49\uff0c\u6309\u4f4d\u8fd0\u7b97\u7b26\u662f\u628a\u6570\u5b57\u770b\u4f5c\u4e8c\u8fdb\u5236\u6765\u8fdb\u884c\u8ba1\u7b97\u7684\u3002\u4e8c\u8fdb\u5236\u6309\u4f4d\u8fd0\u7b97\u4f18\u5148\u7ea7\u5168\u90fd\u4f4e\u4e8e\u6570\u5b57\u8fd0\u7b97\uff0c\u4f46\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97 \u4e00\u5143\u8fd0\u7b97 ~ \u548c\u5176\u4ed6\u4e00\u5143\u7b97\u672f\u8fd0\u7b97 + \u548c - \u5177\u6709\u76f8\u540c\u7684\u4f18\u5148\u7ea7\u3002 \u4ee5\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f\u7684\u6309\u4f4d\u8fd0\u7b97\u5217\u8868\uff1a \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca | \u6309\u4f4d\u6216\u8fd0\u7b97\u7b26\uff1a\u53ea\u8981\u5bf9\u5e94\u7684\u4e8c\u4e2a\u4e8c\u8fdb\u4f4d\u6709\u4e00\u4e2a\u4e3a1\u65f6\uff0c\u7ed3\u679c\u4f4d\u5c31\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6 \u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c ^ \u6309\u4f4d\u5f02\u6216\u8fd0\u7b97\u7b26\uff1a\u5f53\u4e24\u5bf9\u5e94\u7684\u4e8c\u8fdb\u4f4d\u76f8\u5f02\u65f6\uff0c\u7ed3\u679c\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c & \u6309\u4f4d\u4e0e\u8fd0\u7b97\u7b26\uff1a\u53c2\u4e0e\u8fd0\u7b97\u7684\u4e24\u4e2a\u503c,\u5982\u679c\u4e24\u4e2a\u76f8\u5e94\u4f4d\u90fd\u4e3a1,\u5219\u8be5\u4f4d\u7684\u7ed3\u679c\u4e3a1,\u5426\u5219\u4e3a0 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801 \u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c x << n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u5de6\u79fbn\u4f4d\uff0c\u9ad8\u4f4d\u4e22\u5f03\uff0c\u4f4e\u4f4d\u88650 \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\u4f1a\u5bfc\u81f4\u5f15\u53d1ValueError,\u5de6\u79fbn\u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u4e58\u4ee5pow(2, n) x >> n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u53f3\u79fbn\u4f4d \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\uff0c\u4f1a\u5bfc\u81f4\u5f15\u53d1 ValueError\uff1b\u53f3\u79fb n \u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u5730\u9664\u4ee5 pow(2, n) ~x x \u9010\u4f4d\u53d6\u53cd \u8fed\u4ee3\u5668\u7c7b\u578b \u00b6 Python\u652f\u6301\u8fed\u4ee3\u5bb9\u5668\u7684\u6982\u5ff5\u3002\u8fd9\u662f\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u5b9e\u73b0\u7684; \u8fd9\u4e9b\u7528\u4e8e\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u652f\u6301\u8fed\u4ee3 \u751f\u6210\u5668\u7c7b\u578b \u00b6 Python\u7684\u751f\u6210\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fed\u4ee3\u5668\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u5bb9\u5668\u5bf9\u8c61\u7684__iter__()\u65b9\u6cd5\u88ab\u5b9e\u73b0\u4e3a\u751f\u6210\u5668\uff0c\u5b83\u5c06\u81ea\u52a8\u8fd4\u56de\u63d0\u4f9b__iter__() \u548c__next__()\u65b9\u6cd5\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff08\u6280\u672f\u4e0a\uff0c\u751f\u6210\u5668\u5bf9\u8c61\uff09 \u5e8f\u5217\u7c7b\u578b -- list\u3001tuple\u3001range \u00b6 \u901a\u7528\u5e8f\u5217\u7c7b\u578b\u64cd\u4f5c\uff1a\u5927\u591a\u6570\u5e8f\u5217\u7c7b\u578b\u5305\u62ec\u53ef\u53d8\u7c7b\u578b\u548c\u4e0d\u53ef\u53d8\u7c7b\u578b\u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u64cd\u4f5c\uff0ccollections.abc.Sequence ABC \u7528\u6765\u66f4\u5bb9\u6613\u7684\u5728\u81ea\u5b9a \u4e49\u5e8f\u5217\u7c7b\u578b\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u3002\u6b64\u8868\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u7f57\u5217\u5e8f\u5217\u64cd\u4f5c\uff0c\u8868\u683c\u4e2d\uff0cs \u548c t \u662f\u5177\u6709\u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\uff0cn, i, j \u548c k \u662f\u6574\u6570\u800c x \u662f \u4efb\u4f55\u6ee1\u8db3 s \u6240\u89c4\u5b9a\u7684\u7c7b\u578b\u548c\u503c\u9650\u5236\u7684\u4efb\u610f\u5bf9\u8c61 \u4efb\u4f55\u7684\u5e8f\u5217(\u6216\u8005\u53ef\u8fed\u4ee3\u5bf9\u8c61)\u90fd\u53ef\u901a\u8fc7\u4e00\u4e2a\u8d4b\u503c\u8bed\u53e5\u89e3\u538b\u5e76\u8d4b\u503c\u7ed9\u591a\u4e2a\u53d8\u91cf\uff0c\u552f\u4e00\u7684\u524d\u63d0\u5c31\u662f\u53d8\u91cf\u7684\u6570\u91cf\u5fc5\u987b\u4e0e\u5e8f\u5217\u5143\u7d20\u6570\u76f8\u540c \u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\u4e5f\u652f\u6301\u6bd4\u8f83\u3002 \u7279\u522b\u5730\uff0ctuple \u548c list \u7684\u6bd4\u8f83\u662f\u901a\u8fc7\u6bd4\u8f83\u5bf9\u5e94\u5143\u7d20\u7684\u5b57\u5178\u987a\u5e8f\u3002 \u8fd9\u610f\u5473\u7740\u60f3\u8981\u6bd4\u8f83\u7ed3\u679c\u76f8\u7b49\uff0c\u5219\u6bcf\u4e2a\u5143 \u7d20\u6bd4\u8f83\u7ed3\u679c\u90fd\u5fc5\u987b\u76f8\u7b49\uff0c\u5e76\u4e14\u4e24\u4e2a\u5e8f\u5217\u957f\u5ea6\u5fc5\u987b\u76f8\u540c \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca x in s \u5982\u679c s \u4e2d\u7684\u67d0\u9879\u7b49\u4e8e x \u5219\u7ed3\u679c\u4e3a True\uff0c\u5426\u5219\u4e3a False 1 x not in s \u5982\u679c s \u4e2d\u7684\u67d0\u9879\u7b49\u4e8e x \u5219\u7ed3\u679c\u4e3a False\uff0c\u5426\u5219\u4e3a True 1 s + t s \u4e0e t \u76f8\u62fc\u63a5 67 s * n \u6216 n * s \u76f8\u5f53\u4e8e s \u4e0e\u81ea\u8eab\u8fdb\u884c n \u6b21\u62fc\u63a5 27 s[i] s \u7684\u7b2c i \u9879\uff0c\u8d77\u59cb\u4e3a 0 3 s[i:j] s \u4ece i \u5230 j \u7684\u5207\u7247 34 s[i:j:k] s \u4ece i \u5230 j \u6b65\u957f\u4e3a k \u7684\u5207\u7247 35 len(s) s \u7684\u957f\u5ea6 min(s) s \u7684\u6700\u5c0f\u9879 max(s) s \u7684\u6700\u5927\u9879 s.index(x[, i[, j]]) x \u5728 s \u4e2d\u9996\u6b21\u51fa\u73b0\u9879\u7684\u7d22\u5f15\u53f7\uff08\u7d22\u5f15\u53f7\u5728 i \u6216\u5176\u540e\u4e14\u5728 j \u4e4b\u524d\uff09 8 s.count(x) x \u5728 s \u4e2d\u51fa\u73b0\u7684\u603b\u6b21\u6570 \u6ce8\u91ca: \u867d\u7136 in \u548c not in \u64cd\u4f5c\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\u4ec5\u88ab\u7528\u4e8e\u7b80\u5355\u7684\u6210\u5458\u68c0\u6d4b\uff0c\u67d0\u4e9b\u4e13\u95e8\u5316\u5e8f\u5217 (\u4f8b\u5982 str, bytes \u548c bytearray) \u4e5f\u4f7f\u7528\u5b83\u4eec\u8fdb\u884c\u5b50\u5e8f\u5217\u68c0\u6d4b \u5c0f\u4e8e 0 \u7684 n \u503c\u4f1a\u88ab\u5f53\u4f5c 0 \u6765\u5904\u7406 (\u751f\u6210\u4e00\u4e2a\u4e0e s \u540c\u7c7b\u578b\u7684\u7a7a\u5e8f\u5217)\u3002 \u8bf7\u6ce8\u610f\u5e8f\u5217 s \u4e2d\u7684\u9879\u5e76\u4e0d\u4f1a\u88ab\u62f7\u8d1d\uff1b\u5b83\u4eec\u4f1a\u88ab\u591a\u6b21\u5f15\u7528 \u5982\u679c i \u6216 j \u4e3a\u8d1f\u503c\uff0c\u5219\u7d22\u5f15\u987a\u5e8f\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217 s \u7684\u672b\u5c3e: \u7d22\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u4e3a len(s) + i \u6216 len(s) + j\u3002 \u4f46\u8981\u6ce8\u610f -0 \u4ecd\u7136\u4e3a 0 s \u4ece i \u5230 j \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 i <= k < j \u7684\u7d22\u5f15\u53f7 k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u5982\u679c i \u6216 j \u5927\u4e8e len(s)\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u88ab\u7701\u7565 \u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 0\u3002 \u5982\u679c j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u5927\u4e8e\u7b49\u4e8e j\uff0c\u5219\u5207\u7247\u4e3a\u7a7a s \u4ece i \u5230 j \u6b65\u957f\u4e3a k \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 0 <= n < (j-i)/k \u7684\u7d22\u5f15\u53f7 x = i + n*k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u7d22\u5f15\u53f7\u4e3a i, i+k, i+2*k, i+3*k\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5f53\u8fbe\u5230 j \u65f6\u505c\u6b62 (\u4f46\u4e00\u5b9a\u4e0d\u5305\u62ec j)\u3002 \u5f53 k \u4e3a\u6b63\u503c\u65f6\uff0ci \u548c j \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s)\u3002 \u5f53 k \u4e3a\u8d1f\u503c\u65f6\uff0ci \u548c j \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s) - 1\u3002 \u5982\u679c i \u6216 j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5b83\u4eec\u4f1a\u6210\u4e3a\u201c\u7ec8\u6b62\u201d\u503c (\u662f\u54ea\u4e00\u7aef\u7684\u7ec8\u6b62\u503c\u5219\u53d6\u51b3\u4e8e k \u7684\u7b26\u53f7)\u3002 \u8bf7\u6ce8\u610f\uff0ck \u4e0d\u53ef \u4e3a\u96f6\u3002 \u5982\u679c k \u4e3a None\uff0c\u5219\u5f53\u4f5c 1 \u5904\u7406 \u62fc\u63a5\u4e0d\u53ef\u53d8\u5e8f\u5217\u603b\u662f\u4f1a\u751f\u6210\u65b0\u7684\u5bf9\u8c61\u3002 \u8fd9\u610f\u5473\u7740\u901a\u8fc7\u91cd\u590d\u62fc\u63a5\u6765\u6784\u5efa\u5e8f\u5217\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u5c06\u4f1a\u57fa\u4e8e\u5e8f\u5217\u603b\u957f\u5ea6\u7684\u4e58\u65b9\u3002 \u60f3\u8981\u83b7\u5f97\u7ebf\u6027\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u5fc5\u987b \u6539\u7528\u4e0b\u5217\u66ff\u4ee3\u65b9\u6848\u4e4b\u4e00\uff1a \u5982\u679c\u62fc\u63a5 str \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u5217\u8868\u5e76\u5728\u6700\u540e\u4f7f\u7528 str.join() \u6216\u662f\u5199\u5165\u4e00\u4e2a io.StringIO \u5b9e\u4f8b\u5e76\u5728\u7ed3\u675f\u65f6\u83b7\u53d6\u5b83\u7684\u503c \u5982\u679c\u62fc\u63a5 bytes \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u7c7b\u4f3c\u5730\u4f7f\u7528 bytes.join() \u6216 io.BytesIO\uff0c\u6216\u8005\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 bytearray \u5bf9\u8c61\u8fdb\u884c\u539f\u5730\u62fc\u63a5\u3002 bytearray \u5bf9\u8c61\u662f\u53ef\u53d8\u7684\uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u6548\u7684\u91cd\u5206\u914d\u673a\u5236 \u5982\u679c\u62fc\u63a5 tuple \u5bf9\u8c61\uff0c\u8bf7\u6539\u4e3a\u6269\u5c55 list \u7c7b \u5bf9\u4e8e\u5176\u5b83\u7c7b\u578b\uff0c\u8bf7\u67e5\u770b\u76f8\u5e94\u7684\u6587\u6863 \u67d0\u4e9b\u5e8f\u5217\u7c7b\u578b (\u4f8b\u5982 range) \u4ec5\u652f\u6301\u9075\u5faa\u7279\u5b9a\u6a21\u5f0f\u7684\u9879\u5e8f\u5217\uff0c\u56e0\u6b64\u5e76\u4e0d\u652f\u6301\u5e8f\u5217\u62fc\u63a5\u6216\u91cd\u590d \u5f53 x \u5728 s \u4e2d\u627e\u4e0d\u5230\u65f6 index \u4f1a\u5f15\u53d1 ValueError\u3002 \u4e0d\u662f\u6240\u6709\u5b9e\u73b0\u90fd\u652f\u6301\u4f20\u5165\u989d\u5916\u53c2\u6570 i \u548c j\u3002 \u8fd9\u4e24\u4e2a\u53c2\u6570\u5141\u8bb8\u9ad8\u6548\u5730\u641c\u7d22\u5e8f\u5217\u7684\u5b50\u5e8f\u5217\u3002 \u4f20\u5165\u8fd9\u4e24\u4e2a\u989d\u5916\u53c2\u6570\u5927\u81f4\u76f8\u5f53\u4e8e\u4f7f\u7528 s[i:j].index(x)\uff0c\u4f46\u662f\u4e0d\u4f1a\u590d\u5236\u4efb\u4f55\u6570\u636e\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u7d22\u5f15\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217\u7684\u5f00\u5934\u800c\u975e\u5207\u7247\u7684\u5f00\u5934 \u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b \u00b6 \u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u901a\u5e38\u5b9e\u73b0\u7684\u552f\u4e00\u64cd\u4f5c\u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u672a\u5b9e\u73b0\u5bf9hash()\u5185\u7f6e\u51fd\u6570\u7684\u652f\u6301\uff0c\u4f8b\u5982\uff1atuple\u5b9e\u4f8b\u88ab\u7528\u4f5cdict\u952e\u4ee5\u53ca\u5b58\u50a8\u5728set\u548cfrozenset\u5b9e\u4f8b\u4e2d \u53ef\u53d8\u5e8f\u5217\u7c7b\u578b \u00b6 \u4ee5\u4e0b\u64cd\u4f5c\u662f\u5728\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u5b9a\u4e49\uff0ccollections.abc.MutableSequence ABC\u88ab\u63d0\u4f9b\u7528\u6765\u66f4\u5bb9\u6613\u5728\u81ea\u5b9a\u4e49\u5e8f\u5217\u7c7b\u578b\u4e0a\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c \u8868\u683c\u4e2d\u7684 s \u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u7684\u5b9e\u4f8b\uff0ct \u662f\u4efb\u610f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u800c x \u662f\u7b26\u5408\u5bf9 s \u6240\u89c4\u5b9a\u7c7b\u578b\u4e0e\u503c\u9650\u5236\u7684\u4efb\u4f55\u5bf9\u8c61 (\u4f8b\u5982\uff0cbytearray \u4ec5\u63a5\u53d7\u6ee1\u8db3 0 <= x <= 255 \u503c\u9650\u5236\u7684\u6574\u6570) \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca s[i] = x \u5c06 s \u7684\u7b2c i \u9879\u66ff\u6362\u4e3a x s[i:j] = t \u5c06 s \u4ece i \u5230 j \u7684\u5207\u7247\u66ff\u6362\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61 t\u7684\u5185\u5bb9 del s[i:j] \u7b49\u540c\u4e8e s[i:j] = [] s[i:j:k] = t \u5c06 s[i:j:k] \u7684\u5143\u7d20\u66ff\u6362\u4e3a t \u7684\u5143\u7d20 t\u5fc5\u987b\u548c\u5b83\u6240\u66ff\u6362\u7684\u5207\u7247\u5177\u6709\u76f8\u540c\u957f\u5ea6 del s[i:j:k] \u4ece\u5217\u8868\u4e2d\u79fb\u9664 s[i:j:k] \u7684\u5143\u7d20 s.append(x) \u5c06 x \u6dfb\u52a0\u5230\u5e8f\u5217\u7684\u672b\u5c3e (\u7b49\u540c\u4e8e s[len(s):len(s)] = [x]) s.clear() \u4ece s \u4e2d\u79fb\u9664\u6240\u6709\u9879 (\u7b49\u540c\u4e8e del s[:]) clear()\u548ccopy()\u5747\u662f\u4e3a\u4e86\u4e0e\u4e0d\u652f\u6301\u5207\u7247\u64cd\u4f5c\u7684\u53ef\u53d8\u5bb9\u5668(\u5982:dict\u3001set)\u7684\u63a5\u53e3\u4fdd\u6301\u4e00\u81f4 s.copy() \u521b\u5efa s \u7684\u6d45\u62f7\u8d1d (\u7b49\u540c\u4e8e s[:]) \u540c\u4e0a s.extend(t) \u6216 s += t \u7528 t \u7684\u5185\u5bb9\u6269\u5c55 s (\u57fa\u672c\u4e0a\u7b49\u540c\u4e8e s[len(s):len(s)] = t) s *= n \u4f7f\u7528 s \u7684\u5185\u5bb9\u91cd\u590d n \u6b21\u6765\u5bf9\u5176\u8fdb\u884c\u66f4\u65b0 n\u503c\u4e3a\u4e00\u4e2a\u6574\u6570\u6216\u4e00\u4e2a\u5b9e\u73b0\u4e86__index__()\u7684\u5bf9\u8c61\uff0cn\u503c\u4e3a0\u6216\u8d1f\u6570\u5c06\u6e05\u7a7a\u5e8f\u5217\u3002\u5e8f\u5217\u4e2d\u7684\u9879\u4e0d\u80fd \u88ab\u62f7\u8d1d\uff0c\u4f1a\u88ab\u591a\u6b21\u5f15\u7528 s.insert(i, x) \u5728\u7531 i \u7ed9\u51fa\u7684\u7d22\u5f15\u4f4d\u7f6e\u5c06 x \u63d2\u5165 s (\u7b49\u540c\u4e8e s[i:i] = [x]) s.pop([i]) \u63d0\u53d6\u5728 i \u4f4d\u7f6e\u4e0a\u7684\u9879\uff0c\u5e76\u5c06\u5176\u4ece s \u4e2d\u79fb\u9664 \u53ef\u9009\u53c2\u6570\u9ed8\u8ba4\u4e3a-1\uff0c\u56e0\u6b64\u9ed8\u8ba4\u60c5\u51b5\u4f1a\u79fb\u9664\u5e76\u8fd4\u56de\u6700\u540e\u4e00\u9879 s.remove(x) \u5220\u9664 s \u4e2d\u7b2c\u4e00\u4e2a s[i] \u7b49\u4e8e x \u7684\u9879\u76ee\u3002 \u5f53s\u627e\u4e0d\u5230x\u65f6\uff0cremove\u64cd\u4f5c\u4f1a\u5f15\u53d1ValueError s.reverse() \u5c06\u5217\u8868\u4e2d\u7684\u5143\u7d20\u9006\u5e8f \u5f53\u53cd\u8f6c\u6bd4\u8f83\u5927\u7684\u5e8f\u5217\u65f6\uff0creverse()\u65b9\u6cd5\u4f1a\u539f\u5730\u4fee\u6539\u6b64\u5e8f\u5217\u6765\u4fdd\u8bc1\u7a7a\u95f4\u7ecf\u6d4e\u6027\uff0c\u4e3a\u63d0\u9192\u7528\u6237\u6b64\u64cd\u4f5c\u662f\u901a\u8fc7\u95f4\u63a5 \u5f71\u54cd\u8fdb\u884c\u7684\uff0c\u5b83\u5e76\u4e0d\u4f1a\u8fd4\u56de\u53cd\u8f6c\u540e\u7684\u5e8f\u5217 Python\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7 \u00b6 \u4ee5\u4e0b\u8868\u683c\u5217\u51fa\u4e86\u4ece\u6700\u9ad8\u5230\u6700\u4f4e\u4f18\u5148\u7ea7\u7684\u6240\u6709\u8fd0\u7b97\u7b26\uff1a \u8fd0\u7b97\u7b26 \u63cf\u8ff0 ** \u6307\u6570 (\u6700\u9ad8\u4f18\u5148\u7ea7) ~ + - \u6309\u4f4d\u7ffb\u8f6c, \u4e00\u5143\u52a0\u53f7\u548c\u51cf\u53f7 (\u6700\u540e\u4e24\u4e2a\u7684\u65b9\u6cd5\u540d\u4e3a +@ \u548c -@) * / % // \u4e58\uff0c\u9664\uff0c\u53d6\u6a21\u548c\u53d6\u6574\u9664 + - \u52a0\u6cd5\u51cf\u6cd5 >> << \u53f3\u79fb\uff0c\u5de6\u79fb\u4f4d\u8fd0\u7b97\u7b26 & AND | ^ \u6216 \u5f02\u6216--\u4f4d\u8fd0\u7b97 <= < > >= \u6bd4\u8f83\u8fd0\u7b97\u7b26 <> == != \u7b49\u4e8e\u8fd0\u7b97\u7b26 = %= /= //= -= += = * = \u8d4b\u503c\u8fd0\u7b97\u7b26 is is not \u8eab\u4efd\u8fd0\u7b97\u7b26 in not in \u6210\u5458\u8fd0\u7b97\u7b26 not or and \u903b\u8f91\u8fd0\u7b97\u7b26 List(\u5217\u8868) \u00b6 \u5217\u8868list\u662fPython\u4e2d\u4f7f\u7528\u6700\u9891\u7e41\u7684\u6570\u636e\u7c7b\u578b;\u5217\u8868\u662f\u5199\u5728 [] \u65b9\u62ec\u53f7\u4e4b\u95f4\uff0c\u7528\u9017\u53f7\u9694\u5f00\u7684\u5143\u7d20\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5143\u7d20\u7684\u7c7b\u578b\u53ef\u4ee5\u4e0d\u540c\uff0c\u548c\u5b57\u7b26\u4e32 \u4e00\u6837\uff0c\u5217\u8868\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\u3002\u5217\u8868\u88ab\u5207\u7247\u540e\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u6240\u9700\u5143\u7d20\u7684\u65b0\u5217\u8868\uff0c\u5217\u8868\u8fd8\u652f\u6301\u4e32\u8054\u64cd\u4f5c\uff0c\u4f7f\u7528+\u7b26\u53f7\u3002 # \u6ce8\u610f\uff1a 1 \u3001 List\u5199\u5728\u65b9\u62ec\u53f7\u4e4b\u95f4 \uff0c\u5143\u7d20\u7528\u9017\u53f7\u9694\u5f00 , \u5217\u8868\u89e3\u6790\u53ef\u4ee5\u751f\u6210\u5e38\u89c4\u5217\u8868 2 \u3001\u548c\u5b57\u7b26\u4e32\u4e00\u6837\uff0c list\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247 3 \u3001 List\u53ef\u4ee5\u4f7f\u7528 + \u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5 4 \u3001 List\u4e2d\u7684\u5143\u7d20\u662f\u53ef\u4ee5\u6539\u53d8\u7684 \u793a\u4f8b\u5217\u8868\u7684\u5927\u90e8\u5206\u65b9\u6cd5 \u00b6 \u4ee5\u4e0b\u65b9\u6cd5\u662f\u4f5c\u7528\u5728list\u5bf9\u8c61\u4e0a\u7684\u3002\u800clen()\u662f\u5c06list\u3001string\u6216\u5176\u4ed6\u7c7b\u578b\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570 | \u65b9\u6cd5 | \u63cf\u8ff0 | | :------: | :------: | | list.append(elem) | (elem\u8868\u793aelement)\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5217\u8868\u7684\u7ed3\u5c3e\uff0c\u76f8\u5f53\u4e8e a[len(a):] = [elem]| | list.insert(index, elem) | \u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u51c6\u5907\u63d2\u5165\u5230\u5176\u524d\u9762\u7684\u90a3\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f8b\u5982 a.insert(0, x) \u4f1a\u63d2\u5165\u5230\u6574\u4e2a\u5217\u8868\u4e4b\u524d\uff0c\u800c a.insert(len(a), x) \u76f8\u5f53\u4e8e a.append(x) | | list.extend(list2) | \u5728\u5217\u8868list2\u6700\u540e\u6dfb\u52a0\u5143\u7d20\uff0c\u76f8\u5f53\u4e8e a[len(a):] = list2;\u5728\u4e00\u4e2a\u5217\u8868\u4f7f\u7528+\u6216+=\u548cextend()\u7c7b\u4f3c;extend()\u65b9\u6cd5\u53ea\u63a5\u53d7\u4e00\u4e2a\u5217\u8868\u4f5c\u4e3a\u53c2\u6570 | | list.index(elem) | \u4ece\u5217\u8868\u7684\u5f00\u5934\u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u5e76\u8fd4\u56de\u5176\u7d22\u5f15\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u5143\u7d20\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef | | list.remove(elem) | \u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u7684\u7b2c\u4e00\u4e2a\u5b9e\u4f8b\u5e76\u5c06\u5176\u5220\u9664,\u5982\u679c\u4e0d\u5b58\u5728\u5219\u629b\u51faValueError | | list.sort() | \u5bf9\u5217\u8868\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u6c38\u4e45\u6392\u5e8f,\u4e0d\u8981\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c,\u540e\u9762\u4f7f\u7528sorted()\u51fd\u6570\u4e34\u65f6\u6392\u5e8f\u663e\u793a\u66f4\u597d | | list.reverse() | \u5012\u5e8f\u6392\u5217\u5217\u8868\u4e2d\u7684\u5143\u7d20 | | list.pop([i]) | \u4ece\u5217\u8868\u7684\u6307\u5b9a\u4f4d\u7f6e\u5220\u9664\u5143\u7d20\uff0c\u5e76\u5c06\u5176\u8fd4\u56de\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7d22\u5f15\uff0ca.pop()\u8fd4\u56de\u6700\u53f3\u8fb9\u4e00\u4e2a\u5143\u7d20,\u5e76\u8fd4\u56de\u6240\u5220\u9664\u7684\u503c\u3002\u65b9\u6cd5\u4e2d i \u4e24\u8fb9\u7684\u65b9\u62ec\u53f7\u8868\u793a\u8fd9\u4e2a\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u800c\u4e0d\u662f\u8981\u6c42\u4f60\u8f93\u5165\u4e00\u5bf9\u65b9\u62ec\u53f7\uff0c\u4f60\u4f1a\u7ecf\u5e38\u5728Python\u5e93\u53c2\u8003\u624b\u518c\u4e2d\u9047\u5230\u8fd9\u6837\u7684\u6807\u8bb0 | | list.clear() | \u79fb\u9664\u5217\u8868\u4e2d\u7684\u6240\u6709\u9879\uff0c\u7b49\u4e8edel a[:] | | list.count(x) | \u8fd4\u56de x \u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570 | | list.copy() | \u8fd4\u56de\u5217\u8868\u7684\u6d45\u590d\u5236\uff0c\u7b49\u4e8ea[:] | \u5c06\u5217\u8868\u5f53\u505a\u5806\u6808\u4f7f\u7528 \u00b6 \u5217\u8868\u65b9\u6cd5\u4f7f\u5f97\u5217\u8868\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4f5c\u4e3a\u4e00\u4e2a\u5806\u6808\u6765\u4f7f\u7528\uff0c\u5806\u6808\u4f5c\u4e3a\u7279\u5b9a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6700\u540e\u4e00\u4e2a\u63d2\u5165\uff0c\u6700\u5148\u53d6\u51fa\uff08\u540e\u8fdb\u5148\u51fa\uff09\u3002\u7528 append() \u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5806\u6808\u9876\u3002\u7528\u4e0d\u6307\u5b9a\u7d22\u5f15\u7684 pop() \u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u4ece\u5806\u6808\u9876\u53d6\u51fa\u6765 \u5c06\u5217\u8868\u5f53\u4f5c\u961f\u5217\u4f7f\u7528 \u00b6 \u4e5f\u53ef\u4ee5\u628a\u5217\u8868\u5f53\u505a\u961f\u5217\u7528\uff0c\u5176\u4e2d\u5148\u6dfb\u52a0\u7684\u5143\u7d20\u88ab\u6700\u5148\u53d6\u51fa (\u201c\u5148\u8fdb\u5148\u51fa\u201d)\uff1b\u4f46\u662f\u5217\u8868\u7528\u4f5c\u8fd9\u6837\u7684\u76ee\u7684\u76f8\u5f53\u4f4e\u6548\u3002\u5728\u5217\u8868\u7684\u6700\u540e\u6dfb\u52a0\u6216\u8005 \u5f39\u51fa\u5143\u7d20\u901f\u5ea6\u5feb\uff0c\u7136\u800c\u5728\u5217\u8868\u91cc\u63d2\u5165\u6216\u8005\u4ece\u5934\u90e8\u5f39\u51fa\u901f\u5ea6\u5374\u5f88\u6162\uff08\u56e0\u4e3a\u6240\u6709\u5176\u4ed6\u7684\u5143\u7d20\u90fd\u5fc5\u987b\u79fb\u52a8\u4e00\u4f4d\uff09;\u8981\u5b9e\u73b0\u4e00\u4e2a\u961f\u5217\uff0ccollections. deque\u88ab\u8bbe\u8ba1\u7528\u4e8e\u5feb\u901f\u4ece\u4e24\u7aef\u64cd\u4f5c \u5217\u8868\u63a8\u5bfc\u5f0f \u00b6 \u5217\u8868\u63a8\u5bfc\u5f0f\u63d0\u4f9b\u4e86\u4ece\u5e8f\u5217\u521b\u5efa\u5217\u8868\u7684\u7b80\u5355\u9014\u5f84\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u628a\u67d0\u79cd\u64cd\u4f5c\u5e94\u7528\u4e8e\u5e8f\u5217\u6216\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u6bcf\u4e2a\u5143\u7d20\u4e0a\uff0c\u7136\u540e\u4f7f\u7528\u5176\u7ed3\u679c\u6765\u521b\u5efa \u5217\u8868\uff0c\u6216\u8005\u901a\u8fc7\u6ee1\u8db3\u67d0\u4e9b\u7279\u5b9a\u6761\u4ef6\u5143\u7d20\u6765\u521b\u5efa\u5b50\u5e8f\u5217\u3002 \u6bcf\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f\u90fd\u5728 for \u4e4b\u540e\u8ddf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u7136\u540e\u6709\u96f6\u5230\u591a\u4e2a for \u6216 if \u5b50\u53e5\u3002\u8fd4\u56de\u7ed3\u679c\u662f\u4e00\u4e2a\u6839\u636e\u8868\u8fbe\u4ece\u5176\u540e\u7684 for \u548c if \u4e0a\u4e0b\u6587\u73af \u5883\u4e2d\u751f\u6210\u51fa\u6765\u7684\u5217\u8868\u3002\u5982\u679c\u5e0c\u671b\u8868\u8fbe\u5f0f\u63a8\u5bfc\u51fa\u4e00\u4e2a\u5143\u7ec4\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u62ec\u53f7\u3002 \u5d4c\u5957\u5217\u8868\u63a8\u5bfc\u5f0f\u548cdel\u8bed\u53e5 \u00b6 \u5217\u8868\u63a8\u5bfc\u5f0f\u4e2d\u7684\u521d\u59cb\u8868\u8fbe\u5f0f\u53ef\u4ee5\u662f\u4efb\u4f55\u8868\u8fbe\u5f0f\uff0c\u5305\u62ec\u53e6\u4e00\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f\u3002 del\u8bed\u53e5 \uff1a\u4f7f\u7528del\u8bed\u53e5\u53ef\u4ee5\u4ece\u4e00\u4e2a\u5217\u8868\u4e2d\u4f9d\u7d22\u5f15\u800c\u4e0d\u662f\u503c\u6765\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u4e0e\u4f7f\u7528 pop() \u8fd4\u56de\u4e00\u4e2a\u503c\u4e0d\u540c\u3002\u53ef\u4ee5\u7528 del \u8bed\u53e5\u4ece\u5217\u8868 \u4e2d\u79fb\u9664\u5207\u7247\uff0c\u6216\u6e05\u7a7a\u6574\u4e2a\u5217\u8868\uff08\u6211\u4eec\u4ee5\u524d\u4ecb\u7ecd\u7684\u65b9\u6cd5\u662f\u7a7a\u5217\u8868\u8d4b\u503c\u7ed9\u4e00\u4e2a\u6307\u5b9a\u7684\u5207\u7247)\uff0cdel\u4e5f\u53ef\u4ee5\u7528\u6765\u5220\u9664\u6574\u4e2a\u53d8\u91cf Tuple\uff08\u5143\u7ec4\uff09 \u00b6 \u5143\u7ec4\uff08tuple\uff09\u4e0e\u5217\u8868\u7c7b\u4f3c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539\u3002\u5143\u7ec4\u5199\u5728 () \u5c0f\u62ec\u53f7\u91cc\uff0c\u5143\u7d20\u4e4b\u95f4\u7528\u9017\u53f7\u9694\u5f00\u3002\u5143\u7ec4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u4e5f\u53ef \u4ee5\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u901a\u8fc7\u89e3\u5305\u6216\u7d22\u5f15\u6765\u8bbf\u95ee\uff0c\u800c\u5217\u8868\u901a\u8fc7\u8fed\u4ee3\u8bbf\u95ee \u5143\u7ec4\u662f\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7ed9\u5143\u7956\u7684\u5355\u72ec\u4e00\u4e2a\u5143\u7d20\u8d4b\u503c\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u7a7a\u5143\u7956\u7531\u4e00\u5bf9\u7a7a\u5706\u62ec\u53f7\u521b\u5efa\uff0c\u542b\u6709\u4e00\u4e2a\u5143\u7d20\u7684\u5143\u7956\u53ef\u4ee5\u901a\u8fc7\u518d\u6b64\u5143\u7956\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\u9017\u53f7\u521b\u5efa # \u5143\u7ec4\u4e0e\u5b57\u7b26\u4e32\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u88ab\u7d22\u5f15\u4e14\u4e0b\u6807\u7d22\u5f15\u4ece 0 \u5f00\u59cb\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u622a\u53d6 / \u5207\u7247\u3002\u5176\u5b9e\uff0c\u53ef\u4ee5\u628a\u5b57\u7b26\u4e32\u770b\u4f5c\u4e00\u79cd\u7279\u6b8a\u7684\u5143\u7ec4\u3002\u6539\u5143\u7ec4\u5143\u7d20\u7684\u64cd\u4f5c\u662f\u975e\u6cd5\u7684 , \u5143\u7ec4 \u4e5f\u652f\u6301\u7528 + \u64cd\u4f5c\u7b26 # \u867d\u7136 tuple\u7684\u5143\u7d20\u4e0d\u53ef\u6539\u53d8 \uff0c\u4f46\u5b83\u53ef\u4ee5\u5305\u542b\u53ef\u53d8\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982 list\u5217\u8868 \u3002\u6784\u9020\u5305\u542b 0 \u4e2a\u6216 1 \u4e2a\u5143\u7d20\u7684 tuple\u662f\u4e2a\u7279\u6b8a\u7684\u95ee\u9898 \uff0c\u6240\u4ee5\u6709\u4e00\u4e9b\u989d\u5916\u7684\u8bed\u6cd5\u89c4\u5219\uff1a tup1 = () # \u7a7a\u5143\u7ec4 tup2 = ( 20 ,) # \u5355\u5143\u7ec4\uff0c\u9700\u8981\u5728\u5143\u7d20\u540e\u6dfb\u52a0\u9017\u53f7 # string \u3001 list\u548ctuple\u90fd\u5c5e\u4e8esequence \uff08\u5e8f\u5217\uff09 # \u6ce8\u610f\uff1a 1 \u3001\u4e0e\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539 ; \u521b\u5efa\u5355\u5143\u7d20\u5143\u7ec4\uff0c\u9700\u8981\u5728\u503c\u4e4b\u540e\u52a0\u4e0a\u4e00\u4e2a\u9017\u53f7\u3002\u6ca1\u6709\u9017\u53f7\uff0c Python \u4f1a\u5047\u5b9a\u8fd9\u53ea\u662f\u4e00\u5bf9\u989d\u5916\u7684\u5706\u62ec\u53f7\uff0c\u5e76\u4e0d\u521b\u5efa\u5143\u7ec4 2 \u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\uff0c\u65b9\u6cd5\u4e00\u6837 3 \u3001\u6ce8\u610f\u6784\u9020\u5305\u542b 0 \u6216 1 \u4e2a\u5143\u7d20\u7684\u5143\u7ec4\u7684\u7279\u6b8a\u8bed\u6cd5\u89c4\u5219 4 \u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f7f\u7528 + \u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5 \u5143\u7ec4\u5185\u7f6e\u51fd\u6570 \u00b6 \u65b9\u6cd5 \u63cf\u8ff0 len(tuple) \u8ba1\u7b97\u5143\u7ec4\u5143\u7d20\u4e2a\u6570 max(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5927\u503c min(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5c0f\u503c tuple(seq) \u5c06\u5217\u8868\u8f6c\u6362\u4e3a\u5143\u7ec4 range(\u8303\u56f4) \u00b6 range\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u6570\u5b57\u5e8f\u5217\uff0c\u901a\u5e38\u7528\u4e8e\u5728for\u5faa\u73af\u4e2d\u5faa\u73af\u7279\u5b9a\u7684\u6b21\u6570 \u6587\u672c\u5e8f\u5217\u7c7b\u578b \u00b6 Python\u4e2d\u7684\u6587\u672c\u6570\u636e\u7531str\u5bf9\u8c61\u6216\u5b57\u7b26\u4e32\u5904\u7406\uff0c\u5b57\u7b26\u4e32\u662fUnicode\u7684\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u7531\u591a\u79cd\u65b9\u5f0f\u7f16\u5199 String(\u5b57\u7b26\u4e32) \u00b6 # \u201c str \u201d\u4e3a\u5185\u7f6e\u5b57\u7b26\u4e32\u7c7b ; \u7528\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u681d\u8d77\u6765\uff0c\u540c\u65f6\u4f7f\u7528\u53cd\u659c\u6760\\\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\uff0c\u82e5\u4e0d\u60f3\u8ba9\u53cd\u659c\u6760\u4ea7\u751f\u8f6c\u4e49\u6548\u679c\uff0c\u5728\u5b57\u7b26\u4e32\u524d\u6dfb\u52a0\u4e00 # \u4e2a r \uff0c\u8868\u793a\u539f\u59cb\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u53ef\u4ee5\u8de8\u8d8a\u591a\u884c\uff0c\u4f46\u6bcf\u884c\u672b\u5c3e\u5fc5\u987b\u6709\u4e00\u4e2a\u53cd\u659c\u6760\\\u6765\u8f6c\u4e49\u6362\u884c\u7b26\u3002\u4e09\u5f15\u53f7\u5185\u7684\u5b57\u7b26\u4e32\u6587\u5b57 \"\" \"\u6216\u201d '' \u53ef\u4ee5 # \u8de8\u8d8a\u591a\u884c\u7684\u6587\u5b57\uff1b python\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f \uff0c\u7b2c\u4e00\u79cd\u662f\u4ece\u5de6\u5f80\u53f3\u4f9d\u6b21\u4ece 0 \u5f00\u59cb\u9012\u589e\uff0c\u7b2c\u4e8c\u79cd\u662f\u4ece\u53f3\u5f80\u5de6\u4f9d\u6b21\u4ece - 1 \u5f00\u59cb\u9012\u51cf # \u6ce8\u610f\uff1a\u6ca1\u6709\u5355\u72ec\u7684\u5b57\u7b26\u7c7b\u578b\uff0c\u4e00\u4e2a\u5b57\u7b26\u5c31\u662f\u957f\u5ea6\u4e3a 1 \u7684\u5b57\u7b26\u4e32\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5207\u7247\uff0c\u83b7\u53d6\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c\u5f62\u5f0f\u4e3a\u53d8\u91cf [ \u5934\u4e0b\u6807 : \u5c3e\u4e0b\u6807 ] # \u622a\u53d6\u8303\u56f4\u662f\u524d\u95ed\u540e\u5f00 [ 2 :] \uff0c\u5e76\u4e14\u4e24\u4e2a\u7d22\u5f15\u90fd\u53ef\u4ee5\u7701\u7565\uff1b python\u5b57\u7b26\u4e32\u4e0d\u80fd\u88ab\u6539\u53d8 \uff0c\u5982\u5411\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u8d4b\u503c\uff0c word [ 0 ] = 'm' \u4f1a\u5bfc\u81f4\u9519\u8bef # \u6ce8\u610f\uff1a 1 \u3001\u53cd\u659c\u6760\u53ef\u4ee5\u7528\u6765\u8f6c\u4e49\uff0c\u4f7f\u7528 r\u53ef\u4ee5\u8ba9\u53cd\u659c\u6760\u4e0d\u53d1\u751f\u8f6c\u4e49 \u3002 2 \u3001\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528 + \u8fd0\u7b97\u7b26\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u7528 * \u8fd0\u7b97\u7b26\u91cd\u590d\u3002 3 \u3001 Python\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f \uff0c\u4ece\u5de6\u5f80\u53f3\u4ee5 0 \u5f00\u59cb\uff0c\u4ece\u53f3\u5f80\u5de6\u4ee5 - 1 \u5f00\u59cb\u3002 4 \u3001 Python\u4e2d\u7684\u5b57\u7b26\u4e32\u4e0d\u80fd\u6539\u53d8 \u3002\u56e0\u6b64\u6784\u9020 * new * \u5b57\u7b26\u4e32\u6765\u8868\u793a\u8ba1\u7b97\u503c\uff1b\u4f8b\u5982\u8868\u8fbe\u5f0f ( 'hello' + 'there' ) \u6784\u5efa\u65b0\u7684 hellothere\u5b57\u7b26\u4e32 \u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u65b9\u6cd5 \u00b6 \u5b57\u7b26\u4e32\u5b9e\u73b0\u5e38\u89c1\u7684\u5e8f\u5217\u64cd\u4f5c,\u4ee5\u53ca\u4ee5\u4e0b\u7684\u63cf\u8ff0\u7684\u4e00\u4e9b\u65b9\u6cd5 \u65b9\u6cd5 \u63cf\u8ff0 str.capitalize() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u9996\u5b57\u7b26\u5927\u5199\uff0c\u5176\u4f59\u5b57\u7b26\u5c0f\u5199 str.lower(),str.upper() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5e76\u5c06\u6240\u6709\u5957\u63a5\u5b57\u7b26\u8f6c\u6362\u4e3a\u5c0f\u5199\u6216\u5927\u5199 str.strip([chars]) \u8fd4\u56de\u5220\u9664\u4e86\u5f00\u5934\u548c\u7ed3\u5c3e\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u526f\u672c\u3002 chars\u53c2\u6570\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u8981\u5220\u9664\u7684\u5b57\u7b26\u96c6\u3002\u5982\u679c\u7701\u7565\u6216None\uff0c\u5219chars\u53c2\u6570 \u9ed8\u8ba4\u4e3a\u5220\u9664\u7a7a\u683c str.isalpha()/str.isdigit()/str.isspace()... \u6d4b\u8bd5\u6240\u6709\u5b57\u7b26\u4e32\u5b57\u7b26\u662f\u5426\u5728\u5404\u79cd\u5b57\u7b26\u7c7b\u4e2d str.find() \u68c0\u6d4b\u5b57\u7b26\u4e32\u4e2d\u662f\u5426\u5305\u542b\u5b50\u5b57\u7b26\u4e32str\uff0c\u5982\u679c\u6307\u5b9astart\u548cend\u8303\u56f4\uff0c\u5219\u68c0\u67e5\u662f\u5426\u5305\u542b\u5728\u6307\u5b9a\u8303\u56f4\u5185\uff0c\u5982\u679c\u5305\u542b\u5b50\u5b57\u7b26\u4e32\u8fd4\u56de\u6700\u4f4e\u7684\u7d22\u5f15\u503c\uff0c \u5426\u5219\u8fd4\u56de-1 str.format(*args, **kwargs) \u6267\u884c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u64cd\u4f5c\u3002\u8c03\u7528\u6b64\u65b9\u6cd5\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u5305\u542b\u7531\u5927\u62ec\u53f7{}\u5206\u9694\u7684\u6587\u5b57\u6587\u672c\u6216\u66ff\u6362\u5b57\u6bb5\u3002\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd \u5305\u542b\u4f4d\u7f6e\u53c2\u6570\u7684\u6570\u5b57\u7d22\u5f15\u6216\u5173\u952e\u5b57\u53c2\u6570\u7684\u540d\u79f0\u3002\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u4e2d\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd\u66ff\u6362\u4e3a\u76f8\u5e94\u53c2\u6570\u7684\u5b57\u7b26\u4e32\u503c str.split(sep=None, maxsplit=-1) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u5355\u8bcd\u7ec4\u6210\u7684\u5217\u8868\uff0c\u4f7f\u7528sep\u4f5c\u4e3a\u5206\u5272\u7684\u5b57\u7b26\uff0c\u82e5\u7ed9\u51fasep\uff0c\u5219\u8fde\u7eed\u7684\u5206\u9694\u5b57\u7b26\u4e0d\u4f1a\u7ec4\u5408\u5728\u4e00\u8d77\uff0c \u5e76\u88ab\u89c6\u4e3a\u5212\u5206\u7a7a\u5b57\u7b26\u4e32,\u5982\u679c\u7ed9\u51famaxsplit\uff0c\u5217\u8868\u6700\u591a\u53ea\u6709maxsplit + 1\u4e2a\u5143\u7d20,\u5982\u679cmaxsplit\u6ca1\u6709\u7ed9\u51fa\u6216\u8005\u662f-1\uff0c\u5219\u6ca1\u6709\u5206\u5272\u6570\u91cf\u9650\u5236 str.splitlines([keepends]) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u884c\u4f5c\u4e3a\u5217\u8868\uff0c\u5728\u884c\u8fb9\u754c\u5904\u65ad\u5f00\u3002\u9664\u975e\u7ed9\u51fakeepends\u4e14\u4e3atrue\uff0c\u5426\u5219\u6362\u884c\u7b26\u4e0d\u5305\u62ec\u5728\u7ed3\u679c\u5217\u8868\u4e2d;\u6b64\u65b9\u6cd5 \u5728\u4ee5\u4e0b\u8fb9\u754c\u5904\u8fdb\u884c\u5206\u5272 \u8868\u793a \u63cf\u8ff0 \\n \u6362\u884c \\r \u56de\u8f66 \\r\\n \u56de\u8f66+\u6362\u884c \\v or \\x0b \u884c\u5217\u8868 \\f or \\x0c \u6362\u9875 \\x1c \u6587\u4ef6\u5206\u9694\u7b26 \\x1d \u7ec4\u5206\u9694\u7b26 \\x1e \u8bb0\u5f55\u5206\u9694\u7b26 \\x85 \u4e0b\u4e00\u884c\uff08C1\u63a7\u5236\u4ee3\u7801\uff09 \\u2028 \u884c\u5206\u9694\u7b26 \\u2029 \u6bb5\u843d\u5206\u9694\u7b26 printf\u98ce\u683c\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316 \u00b6 \u5b57\u7b26\u4e32\u5177\u6709\u4e00\u79cd\u7279\u6b8a\u5185\u7f6e\u64cd\u4f5c\uff1a\u4f7f\u7528%(\u53d6\u6a21)\u8fd0\u7b97\u7b26\uff0c\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u7684sprintf() \u8f6c\u6362\u6807\u8bb0\u7b26\u5305\u542b\u4e24\u4e2a\u6216\u66f4\u591a\u5b57\u7b26\u5e76\u5177\u6709\u4ee5\u4e0b\u7ec4\u6210\uff0c\u4e14\u5fc5\u987b\u9075\u5faa\u6b64\u5904\u89c4\u5b9a\u7684\u987a\u5e8f\uff1a '%' \u5b57\u7b26\uff0c\u7528\u4e8e\u6807\u8bb0\u8f6c\u6362\u7b26\u7684\u8d77\u59cb \u6620\u5c04\u952e\uff08\u53ef\u9009\uff09\uff0c\u7531\u52a0\u5706\u62ec\u53f7\u7684\u5b57\u7b26\u5e8f\u5217\u7ec4\u6210 (\u4f8b\u5982 (somename)) \u8f6c\u6362\u6807\u5fd7\uff08\u53ef\u9009\uff09\uff0c\u7528\u4e8e\u5f71\u54cd\u67d0\u4e9b\u8f6c\u6362\u7c7b\u578b\u7684\u7ed3\u679c \u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\uff08\u53ef\u9009\uff09\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u5bbd\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\u548c\u53ef\u9009\u7684\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20 \u7cbe\u5ea6\uff08\u53ef\u9009\uff09\uff0c\u4ee5\u5728 '.' (\u70b9\u53f7) \u4e4b\u540e\u52a0\u7cbe\u5ea6\u503c\u7684\u5f62\u5f0f\u7ed9\u51fa\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u7cbe\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20 \u957f\u5ea6\u4fee\u9970\u7b26\uff08\u53ef\u9009\uff09 \u8f6c\u6362\u7c7b\u578b \u8f6c\u6362\u6807\u5fd7\u5b57\u7b26\u4e3a\uff1a \u6807\u5fd7 \u542b\u4e49 '#' \u503c\u7684\u8f6c\u6362\u5c06\u4f7f\u7528\u201c\u66ff\u4ee3\u5f62\u5f0f\u201d(\u5177\u4f53\u5b9a\u4e49\u89c1\u4e0b\u6587) '0' \u8f6c\u6362\u5c06\u4e3a\u6570\u5b57\u503c\u586b\u5145\u96f6\u5b57\u7b26 '-' \u8f6c\u6362\u503c\u5c06\u9760\u5de6\u5bf9\u9f50\uff08\u5982\u679c\u540c\u65f6\u7ed9\u51fa '0' \u8f6c\u6362\uff0c\u5219\u4f1a\u8986\u76d6\u540e\u8005\uff09 ' ' (\u7a7a\u683c) \u7b26\u53f7\u4f4d\u8f6c\u6362\u4ea7\u751f\u7684\u6b63\u6570\uff08\u6216\u7a7a\u5b57\u7b26\u4e32\uff09\u524d\u5c06\u7559\u51fa\u4e00\u4e2a\u7a7a\u683c '+' \u7b26\u53f7\u5b57\u7b26 ('+' \u6216 '-') \u5c06\u663e\u793a\u4e8e\u8f6c\u6362\u7ed3\u679c\u7684\u5f00\u5934(\u4f1a\u8986\u76d6 \"\u7a7a\u683c\" \u6807\u5fd7) \u8f6c\u6362\u7c7b\u578b\u4e3a\uff1a \u8f6c\u6362\u7b26 \u542b\u4e49 \u6ce8\u91ca d \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 i \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 o \u6709\u7b26\u53f7\u516b\u8fdb\u5236\u6570 1 u \u8fc7\u65f6\u7c7b\u578b \u7b49\u4ef7\u4e8e 'd' 6 x \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5c0f\u5199\uff09 2 X \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5927\u5199\uff09 2 e \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5c0f\u5199\uff09 3 E \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5927\u5199\uff09 3 f \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 F \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 g \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5c0f\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 G \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5927\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 c \u5355\u4e2a\u5b57\u7b26\uff08\u63a5\u53d7\u6574\u6570\u6216\u5355\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff09 r \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 repr() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 s \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 str() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 a \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 ascii() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 % \u4e0d\u8f6c\u6362\u53c2\u6570\uff0c\u5728\u7ed3\u679c\u4e2d\u8f93\u51fa\u4e00\u4e2a '%' \u5b57\u7b26 \u6ce8\u91ca: \u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165\u6807\u793a\u516b\u8fdb\u5236\u6570\u7684\u524d\u7f00 ('0o') \u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165 '0x' \u6216 '0X' \u524d\u7f00\uff08\u53d6\u51b3\u4e8e\u662f\u4f7f\u7528 'x' \u8fd8\u662f 'X' \u683c\u5f0f\uff09 \u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u5373\u4f7f\u5176\u540e\u5e76\u6ca1\u6709\u6570\u5b57,\u5c0f\u6570\u70b9\u540e\u7684\u6570\u5b57\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6 \u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u672b\u5c3e\u5404\u4f4d\u7684\u96f6\u4e0d\u4f1a\u5982\u5176\u4ed6\u60c5\u51b5\u4e0b\u90a3\u6837\u88ab\u79fb\u9664,\u5c0f\u6570\u70b9\u524d\u540e\u7684\u6709\u6548\u6570\u7801\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6 \u5982\u679c\u7cbe\u5ea6\u4e3a N\uff0c\u8f93\u51fa\u5c06\u622a\u77ed\u4e3a N \u4e2a\u5b57\u7b26 \u53c2\u89c1 PEP 237 \u4e8c\u8fdb\u5236\u5e8f\u5217\u7c7b\u578b -- bytes\u3001bytearray\u3001memoryview \u00b6 \u7528\u4e8e\u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e\u7684\u6838\u5fc3\u5185\u7f6e\u7c7b\u578b\u662fbytes\u548cbytearray\uff0c\u5b83\u4eec\u652f\u6301memoryview\u4f7f\u7528buffer protocol\u534f\u8bae\u6765\u8bbf\u95ee\u5176\u4ed6\u4e8c\u8fdb\u5236\u5bf9\u8c61\u7684\u5185\u5b58\u800c\u65e0\u9700\u505a\u4e00\u4e2a\u590d\u5236 \u8be5array\u6a21\u5757\u652f\u6301\u6709\u6548\u5b58\u50a8\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u598232\u4f4d\u6574\u6570\u548cIEEE754\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u503c bytes\u5bf9\u8c61 \u00b6 \u5b57\u8282\u5bf9\u8c61\u662f\u5355\u4e2a\u5b57\u8282\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7531\u4e8e\u4e3b\u8981\u7684\u4e8c\u8fdb\u5236\u534f\u8bae\u5927\u591a\u57fa\u4e8e ASCII\u6587\u672c\u7f16\u7801 \uff0c\u56e0\u6b64\u5b57\u8282\u5bf9\u8c61\u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4ec5\u5728\u5904\u7406 ASCII \u517c\u5bb9\u6570\u636e\u65f6\u6709\u6548\uff0c\u5e76\u4e14\u4ee5\u5404\u79cd\u5176\u4ed6\u65b9\u5f0f\u4e0e\u5b57\u7b26\u4e32\u5bf9\u8c61\u5bc6\u5207\u76f8\u5173 \u5b57\u8282\u6587\u5b57\u7684\u8bed\u6cd5\u548c\u5b57\u7b26\u4e32\u6587\u5b57\u7684\u8bed\u6cd5\u7c7b\u4f3c\uff0c\u53ea\u662f\u6dfb\u52a0\u4e86\u524d\u7f00 b \u5b57\u8282\u6587\u5b57\u4e2d\u53ea\u5141\u8bb8\u4f7f\u7528 ASCII\u5b57\u7b26 \uff08\u65e0\u8bba\u58f0\u660e\u7684\u6e90\u4ee3\u7801\u7f16\u7801\u5982\u4f55\uff09\u3002\u5fc5\u987b\u4f7f\u7528\u9002\u5f53\u7684\u8f6c\u4e49\u5e8f\u5217\u5c06\u8d85\u8fc7 127 \u7684\u4efb\u4f55\u4e8c\u8fdb\u5236\u503c\u8f93\u5165\u5230\u5b57\u8282\u6587\u5b57\u4e2d \u4e0e\u5b57\u7b26\u4e32\u6587\u5b57\u4e00\u6837\uff0c\u5b57\u8282\u6587\u5b57\u4e5f\u53ef\u4ee5\u4f7f\u7528 r\u524d\u7f00\u6765\u7981\u7528\u8f6c\u4e49\u5e8f\u5217\u7684\u5904\u7406 \u867d\u7136\u5b57\u8282\u6587\u5b57\u548c\u8868\u793a\u57fa\u4e8e ASCII\u6587\u672c \uff0c\u4f46\u5b57\u8282\u5bf9\u8c61\u5b9e\u9645\u4e0a\u8868\u73b0\u4e3a\u4e0d\u53ef\u53d8\u7684\u6574\u6570\u5e8f\u5217\uff0c\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u503c\u90fd\u53d7\u5230\u9650\u5236\uff0c\u4ee5\u81f4 0 <= x < 256 \uff08\u8bd5\u56fe \u8fdd\u53cd\u6b64\u9650\u5236\u5c06\u89e6\u53d1 ValueError \uff09\u3002\u8fd9\u662f\u6545\u610f\u5f3a\u8c03\u7684\uff0c\u867d\u7136\u8bb8\u591a\u4e8c\u8fdb\u5236\u683c\u5f0f\u5305\u62ec\u57fa\u4e8e ASCII\u7684\u5143\u7d20 \uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u9762\u5411\u6587\u672c\u7684\u7b97\u6cd5\u8fdb\u884c\u6709 \u7528\u7684\u64cd\u4f5c\uff0c\u4f46\u5bf9\u4e8e\u4efb\u610f\u4e8c\u8fdb\u5236\u6570\u636e\u901a\u5e38\u4e0d\u662f\u8fd9\u79cd\u60c5\u51b5\uff08\u76f2\u76ee\u5730\u5c06\u6587\u672c\u5904\u7406\u7b97\u6cd5\u5e94\u7528\u4e8e\u975e\u4e8c\u8fdb\u5236\u6570\u636e\u683c\u5f0f\uff09 ASCII\u517c\u5bb9\u901a\u5e38\u4f1a\u5bfc\u81f4\u6570\u636e\u635f\u574f \uff09 \u9664\u4e86\u6587\u5b57\u5f62\u5f0f\u4e4b\u5916\uff0c\u8fd8\u53ef\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u521b\u5efa\u5b57\u8282\u5bf9\u8c61\uff1a * \u6307\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b57\u8282\u5bf9\u8c61\uff1atypes(10) * \u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytes(range(10)) * \u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytes(obj) bytearray\u5bf9\u8c61 \u00b6 bytearray\u5bf9\u8c61\u662fbytes\u5bf9\u8c61\u7684\u53ef\u53d8\u526f\u672c\uff0c\u7531\u4e8ebytearray\u662f\u53ef\u53d8\u7684\uff0c\u8fd8\u652f\u6301\u53ef\u53d8\u5e8f\u5217\u64cd\u4f5c bytearray\u5bf9\u8c61\u6ca1\u6709\u4e13\u7528\u7684\u6587\u5b57\u8bed\u6cd5\uff0c\u800c\u662f\u59cb\u7ec8\u901a\u8fc7\u8c03\u7528\u6784\u9020\u51fd\u6570\u6765\u521b\u5efa\uff1a * \u521b\u5efa\u4e00\u4e2a\u7a7a\u5b9e\u4f8b\uff1abytearray() * \u521b\u5efa\u5177\u6709\u7ed9\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b9e\u4f8b\uff1abytearray(10) * \u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytearray(range(10)) * \u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytearray(b'Hello') bytes\u548cbytearray\u5bf9\u8c61\u90fd\u652f\u6301\u516c\u5171\u5e8f\u5217\u64cd\u4f5c\uff0c\u5b83\u4eec\u4e0d\u4ec5\u4e0e\u76f8\u540c\u7c7b\u578b\u7684\u64cd\u4f5c\u6570\u4e92\u64cd\u4f5c\uff0c\u800c\u4e14\u4e0e\u4efb\u4f55\u7c7b\u4f3c\u5b57\u8282\u7684\u5bf9\u8c61\u4e92\u64cd\u4f5c\uff1b\u7531\u4e8e\u6b64\u7075\u6d3b\u6027 \u5b83\u4eec\u53ef\u4ee5\u5728\u64cd\u4f5c\u4e2d\u81ea\u7531\u6df7\u5408\u800c\u4e0d\u4f1a\u5bfc\u81f4\u9519\u8bef\uff0c\u4f46\u7ed3\u679c\u7684\u8fd4\u56de\u7c7b\u578b\u53ef\u80fd\u53d6\u51b3\u4e8e\u64cd\u4f5c\u6570\u7684\u987a\u5e8f printf\u98ce\u683c\u5b57\u8282\u683c\u5f0f\u5316 \u00b6 \u5b57\u8282\u5bf9\u8c61(bytes/bytearray)\u6709\u4e00\u4e2a\u72ec\u7279\u7684\u5185\u7f6e\u64cd\u4f5c\uff1a%\u8fd0\u7b97\u7b26(\u6a21\u6570)\u4e5f\u6210\u4e3a\u5b57\u8282\u683c\u5f0f\u5316\u6216\u63d2\u503c\u8fd0\u7b97\u7b26\uff0c\u5982\u679cformat\u9700\u8981\u5355\u4e2a\u53c2\u6570\uff0c\u5219\u503c\u53ef \u4ee5\u662f\u5355\u4e2a\u975e\u5143\u7ec4\u5bf9\u8c61\uff0c\u5426\u5219\u503c\u5fc5\u987b\u662f\u5177\u6709\u683c\u5f0f\u5b57\u8282\u5bf9\u8c61\u6216\u5355\u4e2a\u6620\u5c04\u5bf9\u8c61(\u5b57\u5178)\u6307\u5b9a\u7684\u9879\u76ee\u6570\u7684\u5143\u7ec4 \u5176\u4ed6\u548c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u76f8\u540c memory views \u00b6 memoryview\u5bf9\u8c61\u5141\u8bb8Python\u4ee3\u7801\u8bbf\u95ee\u652f\u6301buffer protocol\u7684\u5bf9\u8c61\u7684\u5185\u90e8\u6570\u636e\u800c\u65e0\u9700\u590d\u5236 Set\u7c7b\u578b -- set\u3001frozenset \u00b6 Set\uff08\u96c6\u5408\uff09 \u00b6 \u96c6\u5408\u662f\u4e00\u4e2a\u65e0\u5e8f\u4e0d\u91cd\u590d\u5143\u7d20\u7684\u96c6\u3002set\u5bf9\u8c61\u662f\u7531\u5177\u6709\u552f\u4e00\u6027\u7684hashable\u5bf9\u8c61\u7ec4\u6210\u7684\u65e0\u5e8f\u591a\u9879\u96c6\u5408\u3002\u57fa\u672c\u529f\u80fd\u5305\u62ec\u6210\u5458\u5173\u7cfb\u68c0\u6d4b\u548c\u6d88\u9664\u91cd\u590d \u5143\u7d20\u3002\u96c6\u5408\u5bf9\u8c61\u8fd8\u652f\u6301\u6570\u5b66\u96c6\u5408\u7c7b\u8fd0\u7b97\uff0c\u5982\u5e76\u96c6\uff0c\u4ea4\u96c6\uff0c\u5dee\u96c6\u548c\u5bf9\u79f0\u5dee\u96c6\u7b49;\u4f5c\u4e3a\u65e0\u5e8f\u96c6\u5408\uff0c\u4e0d\u8bb0\u5f55\u5143\u7d20\u4f4d\u7f6e\u548c\u63d2\u5165\u987a\u5e8f\uff0c\u96c6\u5408\u4e0d\u652f\u6301 \u7d22\u5f15\u3001\u5207\u7247\u6216\u5176\u4ed6\u7c7b\u4f3c\u5e8f\u5217\u7684\u884c\u4e3a \u76ee\u524d\u6709\u4e24\u79cd\u5185\u7f6e\u96c6\u5408\u7c7b\u578b\uff0cset\u548cfrozenset\uff0cset\u7c7b\u578b\u662f\u53ef\u53d8\u7684\uff0c\u5176\u5143\u7d20\u53ef\u4ee5\u7528add()\u548cremove()\u65b9\u6cd5\u6539\u53d8\uff0c\u6240\u4ee5\u4e0d\u5177\u6709\u54c8\u5e0c\u503c\u4e14\u4e0d\u80fd\u88ab\u7528 \u4f5c\u5b57\u5178\u7684\u952e\u6216\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20\u3002frozenset\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u5e76\u4e14\u4e3ahashable\uff0c\u5176\u5185\u5bb9\u5728\u88ab\u521b\u5efa\u540e\u4e0d\u80fd\u518d\u6539\u53d8\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4f5c\u5b57\u5178\u7684\u952e\u548c\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20 \u53ef\u4ee5\u7528\u5927\u62ec\u53f7 {} \u521b\u5efa\u96c6\u5408\u3002\u6ce8\u610f\uff1a\u5982\u679c\u8981\u521b\u5efa\u4e00\u4e2a\u7a7a\u96c6\u5408\uff0c\u4f60\u5fc5\u987b\u7528 set() \u800c\u4e0d\u662f {} \uff1b\u540e\u8005\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u5b57\u5178\uff0c\u96c6\u5408\u4e5f\u652f\u6301\u63a8\u5bfc\u5f0f\u5f62\u5f0f # \u6ce8\u610f\uff1a 1 \u3001\u4ece\u5217\u8868\u521b\u5efa\u96c6\u5408 , \u53ef\u4f7f\u7528 set () \u51fd\u6570 2 \u3001\u96c6\u5408\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u503c ; \u4f46\u5982\u679c\u6dfb\u52a0\u96c6\u5408\u5df2\u6709\u7684\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u4efb\u4f55\u4e8b\u60c5\uff0c\u4e5f\u4e0d\u4f1a\u62a5\u9519 \u96c6\u5408\u5185\u7f6e\u65b9\u6cd5 \u00b6 \u65b9\u6cd5 \u63cf\u8ff0 add() add() \u65b9\u6cd5\u63a5\u53d7\u5355\u4e2a\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u5c06\u8be5\u503c\u6dfb\u52a0\u5230\u96c6\u5408\u4e4b\u4e2d update() update() \u65b9\u6cd5\u4ec5\u63a5\u53d7\u4e00\u4e2a\u96c6\u5408\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u5c06\u5176\u6240\u6709\u6210\u5458\u6dfb\u52a0\u5230\u521d\u59cb\u5217\u8868\u4e2d;\u5982\u679c\u6709\u91cd\u590d\u503c\uff0c\u5c06\u4f1a\u88ab\u5ffd\u7565 discard() discard() \u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u8be5\u503c;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 discard()\u65b9\u6cd5\uff0c\u5b83\u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u4e0d\u4ea7\u751f\u9519\u8bef remove() remove() \u65b9\u6cd5\u4e5f\u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u4e5f\u4ece\u96c6\u5408\u4e2d\u5c06\u5176\u5220\u9664;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 remove()\u65b9\u6cd5\u5c06\u4f1a\u5f15\u53d1KeyError\u9519\u8bef pop() \u4ece\u96c6\u5408\u5220\u9664\u67d0\u4e2a\u503c\u5e76\u8fd4\u56de\u8be5\u503c \u6620\u5c04\u7c7b\u578b -- \u5b57\u5178 \u00b6 Dict\uff08\u5b57\u5178\uff09 \u00b6 \u4e00\u4e2amapping\u5bf9\u8c61\u6620\u5c04\u53ef\u54c8\u5e0c\u503c\u5230\u4efb\u610f\u5bf9\u8c61\uff0cmapping\u662f\u53ef\u53d8\u5bf9\u8c61\uff1b\u76ee\u524d\u53ea\u6709\u4e00\u79cd\u6807\u51c6\u7684mapping\u7c7b\u578b,\u5373\u5b57\u5178\u3002\u5b57\u5178\u4ee5\u5173\u952e\u5b57\u4f5c\u4e3a\u7d22\u5f15 \u5173\u952e\u5b57\u53ef\u4ee5\u662f\u4efb\u610f\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u3002\u5982\u679c\u4e00\u4e2a\u5143\u7ec4\u4e2d\u53ea\u5305\u542b\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u548c\u5143\u7ec4\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5173\u952e\u5b57 \u5982\u679c\u5143\u7ec4\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5305\u542b\u4e86\u53ef\u53d8\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f5c\u4e3a\u5173\u952e\u5b57\u3002\u5173\u952e\u5b57\u5fc5\u987b\u4f7f\u7528\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f\u8bf4list\u548c\u5305\u542b\u53ef\u53d8\u7c7b\u578b\u7684tuple \u4e0d\u80fd\u505a\u5173\u952e\u5b57\u3002\u5728\u540c\u4e00\u4e2a\u5b57\u5178\u4e2d\uff0c\u5173\u952e\u5b57\u8fd8\u5fc5\u987b\u4e92\u4e0d\u76f8\u540c\u3002\u53ef\u4ee5\u5c06\u5b57\u5178\u770b\u4f5c\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u7684\u96c6\u5408\uff0c\u5728\u4e00\u4e2a\u5b57\u5178\u4e2d\u952e\u5fc5\u987b\u662f\u552f\u4e00\u7684 \u5b57\u5178\u4e3b\u8981\u64cd\u4f5c\u662f\u5173\u952e\u5b57\u5b58\u50a8\u548c\u89e3\u6790\u503c\u3002 # \u6ce8\u610f\uff1a 1 \u3001\u5b57\u5178\u662f\u4e00\u79cd\u6620\u5c04\u7c7b\u578b\uff0c\u5b83\u7684\u5143\u7d20\u662f\u952e\u503c\u5bf9\u3002\u6784\u9020\u51fd\u6570 dict () \u76f4\u63a5\u4ece\u952e\u503c\u5bf9 sequence\u4e2d\u6784\u5efa\u5b57\u5178 \uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u63a8\u5bfc 2 \u3001\u5b57\u5178\u7684\u5173\u952e\u5b57\u5fc5\u987b\u4e3a\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e14\u4e0d\u80fd\u91cd\u590d\u3002 3 \u3001\u521b\u5efa\u7a7a\u5b57\u5178\u4f7f\u7528{} # \u5b57\u5178\u904d\u5386\u6280\u5de7\uff0c\u5728\u5b57\u5178\u4e2d\u904d\u5386\u65f6\uff0c\u5173\u952e\u5b57\u548c\u5bf9\u5e94\u7684\u503c\u53ef\u4ee5\u4f7f\u7528 items () \u65b9\u6cd5\u540c\u65f6\u89e3\u8bfb\u51fa\u6765\u3002\u5728\u5e8f\u5217\u4e2d\u904d\u5386\u65f6\uff0c\u7d22\u5f15\u4f4d\u7f6e\u548c\u5bf9\u5e94\u503c\u53ef\u4ee5 # \u4f7f\u7528 enumerate () \u51fd\u6570\u540c\u65f6\u5f97\u5230\u3002\u540c\u65f6\u904d\u5386\u4e24\u4e2a\u6216\u66f4\u591a\u7684\u5e8f\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528 zip () \u7ec4\u5408\u3002\u8981\u53cd\u5411\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u9996\u5148\u6307\u5b9a\u8fd9\u4e2a\u5e8f\u5217 # \u7136\u540e\u8c03\u7528 reversesd () \u51fd\u6570\u3002\u8981\u6309\u987a\u5e8f\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u4f7f\u7528 sorted () \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5df2\u6392\u5e8f\u7684\u5e8f\u5217\uff0c\u5e76\u4e0d\u4fee\u6539\u539f\u503c\u3002 python\u5b57\u5178\u5e38\u7528\u65b9\u6cd5\uff1a \u00b6 \u65b9\u6cd5 \u63cf\u8ff0 dict.clear() \u5220\u9664\u5b57\u5178\u5185\u6240\u6709\u5143\u7d20 dict.copy() \u8fd4\u56de\u539f\u5b57\u5178\u7684\u6d45\u62f7\u8d1d dict.fromkeys() \u521b\u5efa\u4e00\u4e2a\u65b0\u5b57\u5178\uff0c\u4ee5\u5e8f\u5217seq\u4e2d\u5143\u7d20\u505a\u5b57\u5178\u7684\u952e\uff0cval\u4e3a\u5b57\u5178\u6240\u6709\u952e\u5bf9\u5e94\u7684\u521d\u59cb\u503c dict.get(key, default=None) \u8fd4\u56de\u6307\u5b9a\u952e\u7684\u503c\uff0c\u5982\u679c\u503c\u4e0d\u5728\u5b57\u5178\u4e2d\u8fd4\u56dedefault\u503c key in dict \u5982\u679c\u952e\u5728\u5b57\u5178dict\u91cc\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse dict.items() \u4ee5\u5217\u8868\u8fd4\u56de\u53ef\u904d\u5386\u7684(\u952e, \u503c) \u5143\u7ec4\u6570\u7ec4 dict.keys() \u4ee5\u5217\u8868\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u6240\u6709\u7684\u952e dict.setdefault(key, default=None) \u548cget()\u7c7b\u4f3c, \u4f46\u5982\u679c\u952e\u4e0d\u5b58\u5728\u4e8e\u5b57\u5178\u4e2d\uff0c\u5c06\u4f1a\u6dfb\u52a0\u952e\u5e76\u5c06\u503c\u8bbe\u4e3adefault dict.update(dict2) \u628a\u5b57\u5178dict2\u7684\u952e/\u503c\u5bf9\u66f4\u65b0\u5230dict\u91cc dict.values() \u4ee5\u5217\u8868\u8fd4\u56de\u5b57\u5178\u4e2d\u7684\u6240\u6709\u503c \u5b57\u5178\u89c6\u56fe\u5bf9\u8c61(dictionary view objects) \u00b6 \u8fd9\u4e9b\u5bf9\u8c61\u901a\u8fc7dict.keys()\u3001dict.values()\u3001dict.items()\u8fd4\u56de\u7684\u662f\u89c6\u56fe\u5bf9\u8c61\uff0c\u5b83\u4eec\u63d0\u4f9b\u5b57\u5178\u6761\u76ee\u7684\u52a8\u6001\u89c6\u56fe\uff0c\u610f\u5473\u7740\u5f53\u5b57\u5178\u66f4\u6539\u65f6\uff0c\u89c6\u56fe\u5219\u4f1a\u53cd\u5e94\u8fd9\u4e9b\u66f4\u6539 \u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7c7b\u578b(Context Manager Types) \u00b6 python\u7684with\u8bed\u53e5\u652f\u6301\u7531\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5b9a\u4e49\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u6982\u5ff5\uff0c\u8fd9\u662f\u4f7f\u7528\u4e00\u5bf9\u65b9\u6cd5\u5b9e\u73b0\u7684\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u5b9a\u4e49\u5728\u8bed\u53e5\u4f53 \u6267\u884c\u4e4b\u524d\u8f93\u5165\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\uff0c\u5e76\u5728\u8bed\u53e5\u7ed3\u675f\u65f6\u9000\u51fa ython\u5b9a\u4e49\u4e86\u51e0\u4e2a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u4ee5\u652f\u6301\u7b80\u5355\u7684\u7ebf\u7a0b\u540c\u6b65\uff0c\u6587\u4ef6\u6216\u5176\u4ed6\u5bf9\u8c61\u7684\u5feb\u901f\u5173\u95ed\uff0c\u4ee5\u53ca\u5bf9\u6d3b\u52a8\u5341\u8fdb\u5236\u7b97\u672f\u4e0a\u4e0b\u6587\u7684\u7b80\u5355\u64cd\u4f5c\u3002\u9664\u4e86 \u5b9e\u73b0\u4e0a\u4e0b\u6587\u7ba1\u7406\u534f\u8bae\u4e4b\u5916\uff0c\u7279\u5b9a\u7c7b\u578b\u4e0d\u4f1a\u88ab\u7279\u522b\u5904\u7406\u3002 Python\u7684\u751f\u6210\u5668\u548ccontextlib.contextmanager\u88c5\u9970\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fd9\u4e9b\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u4f7f\u7528contextlib.contextmanager\u88c5\u9970\u5668 \u4fee\u9970\u751f\u6210\u5668\u51fd\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u5b9e\u73b0\u5fc5\u8981__enter__()\u548c__exit__()\u65b9\u6cd5\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u800c\u4e0d\u662f\u7531\u672a\u4fee\u9970\u7684\u751f\u6210\u5668\u51fd\u6570\u751f\u6210\u7684\u8fed\u4ee3\u5668\u3002 \u8bf7\u6ce8\u610f\uff0cPython / C API\u4e2dPython\u5bf9\u8c61\u7684\u7c7b\u578b\u7ed3\u6784\u4e2d\u6ca1\u6709\u9488\u5bf9\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7279\u5b9a\u63d2\u69fd\u3002\u60f3\u8981\u5b9a\u4e49\u8fd9\u4e9b\u65b9\u6cd5\u7684\u6269\u5c55\u7c7b\u578b\u5fc5\u987b\u5c06\u5b83\u4eec\u4f5c\u4e3a\u666e\u901a\u7684 Python\u53ef\u8bbf\u95ee\u65b9\u6cd5\u63d0\u4f9b\u3002\u4e0e\u8bbe\u7f6e\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u5f00\u9500\u76f8\u6bd4\uff0c\u5355\u4e2a\u7c7b\u5b57\u5178\u67e5\u627e\u7684\u5f00\u9500\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1 \u5faa\u73af \u00b6 # python\u5faa\u73af\u8bed\u53e5\u6709for\u548cwhile,while\u4f7f\u7528\u4e0e\u63d0\u524d\u77e5\u9053\u6761\u4ef6\u7684\u60c5\u51b5\u3002 # \u4f7f\u7528while\u5faa\u73af\u8ba1\u7b971-100\u548c count = 1 num_sum = 0 while count <= 100 : num_sum += count count += 1 print ( \"1~100\u548c\u662f:\" , num_sum ) # for\u5faa\u73af\u53ef\u4ee5\u904d\u5386\u4efb\u4f55\u5e8f\u5217\u7684\u9879\u76ee\uff0c\u5982\u5217\u8868\u6216\u5b57\u7b26\u4e32,for\u5b9e\u4f8b\u4f7f\u7528break\u8bed\u53e5\uff0cbreak\u8bed\u53e5\u7528\u4e8e\u8df3\u51fa\u5f53\u524d\u5faa\u73af\u4f53 foods = [ \"apple\" , \"beef\" , \"fish\" ] for egg in foods : if egg == \"beef\" : print ( \"\u4e24\u4e2a\u4e0d\u540c\u7684\" ) break # \u6b64\u5904\u8df3\u51fa\u5faa\u73af\uff0c\u4e0b\u4e00\u53e5\u4e0d\u518d\u8f93\u51fa print ( \"\u597d\u5403\u7684\" + egg ) else : print ( \"\u6ca1\u6709beef\u4e86\" ) print ( \"\u7ed3\u675f\u9009\u9910\" ) # range\u53ef\u4ee5\u904d\u5386\u6570\u5b57\u5e8f\u5217\u6765\u81ea\u52a8\u751f\u6210\u6570\u5217\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e00\u533a\u95f4 # \u53ef\u4f7frange\u4ece\u6307\u5b9a\u6570\u5b57\u5f00\u59cb\u5e76\u6307\u5b9a\u589e\u91cf\u3002(\u53ef\u4ee5\u662f\u8d1f\u6570\uff0c\u6709\u65f6\u53eb\u505a\u6b65\u957f) for i in range ( 1 , 9 , 2 ): # \u4ece1\u52309\u6b65\u957f\u4e3a2 print ( i ) # \u7ed3\u5408range()\u548clen()\u51fd\u6570\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\u7684\u7d22\u5f15 a = [ 'lee' , 'bob' , 'bruce' ] for i in range ( len ( a )): print ( i , a [ i ]) Python\u6761\u4ef6\u5224\u65ad\u8bed\u53e5 \u00b6 # if \u8bed\u53e5\u57fa\u672c\u683c\u5f0f if condition_1 : statement_block_1 elif condition_2 : statement_block_2 else : statement_block_3 \u6ce8\u610f 1 \u3001\u6bcf\u4e2a\u6761\u4ef6\u540e\u9762\u8981\u4f7f\u7528\u5192\u53f7\uff08:\uff09\uff0c\u8868\u793a\u63a5\u4e0b\u6765\u662f\u6ee1\u8db3\u6761\u4ef6\u540e\u8981\u6267\u884c\u7684\u8bed\u53e5\u5757 3 \u3001\u5728 Python \u4e2d\u6ca1\u6709 switch \u2013 case \u8bed\u53e5 # \u6f14\u793a\u731c\u6570\u5b57 #!/usr/local/bin/python3 # -*- coding: UTF-8 -*- number = 1 guess = 0 print ( \"\u731c\u6570\u5b57\" ) while guess != number : guess = int ( input ( \"\u8f93\u5165\u8981\u731c\u7684\u6570\u5b57\uff1a\" )) if guess == number : print ( \"holly shit,\u4f60\u731c\u5bf9\u4e86!\" ) elif guess < number : print ( \"\u731c\u7684\u592a\u5c0f\u4e86\" ) elif guess > number : print ( \"\u731c\u7684\u592a\u5927\u4e86\" ) \u51fd\u6570 \u00b6 \u51fd\u6570\u5bf9\u8c61\u662f\u901a\u8fc7\u51fd\u6570\u5b9a\u4e49\u521b\u5efa\uff0c\u5bf9\u51fd\u6570\u552f\u4e00\u7684\u64cd\u4f5c\u5c31\u662f\u8c03\u7528\u5b83\u3002 \u51fd\u6570\u7684\u53c2\u6570 \u00b6 \u9ed8\u8ba4\u53c2\u6570\uff1a \u00b6 # \u65b0\u7684power(x, n)\u51fd\u6570\u5b9a\u4e49\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\uff0c\u65e7\u7684\u8c03\u7528\u4ee3\u7801\u5931\u8d25\u4e86\uff0c\u539f\u56e0\u662f\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u5bfc\u81f4\u65e7\u7684\u4ee3\u7801\u56e0\u4e3a\u7f3a\u5c11\u4e00\u4e2a\u53c2\u6570\u800c\u65e0\u6cd5 # \u6b63\u5e38\u8c03\u7528\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u9ed8\u8ba4\u53c2\u6570 def power ( x , n = 2 ): s = 1 while n > 0 : n = n - 1 s = s * x return s # \u6ce8\u610f\uff1a\u4e00\u662f\u5fc5\u9009\u53c2\u6570\u5728\u524d\uff0c\u9ed8\u8ba4\u53c2\u6570\u5728\u540e\uff0c\u5426\u5219Python\u7684\u89e3\u91ca\u5668\u4f1a\u62a5\u9519\u3002\u8bbe\u7f6e\u9ed8\u8ba4\u53c2\u6570\u6280\u5de7--\u5f53\u51fd\u6570\u6709\u591a\u4e2a\u53c2\u6570\u65f6\uff0c\u628a\u53d8\u5316\u5927\u7684\u53c2\u6570\u653e # \u524d\u9762\uff0c\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u653e\u540e\u9762\u3002\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u9ed8\u8ba4\u53c2\u6570 # \u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61,x\u662f\u5f62\u53c2\uff0c\u8c03\u7528power(3, n=2),3\u5c31\u662f\u5b9e\u53c2 \u4f4d\u7f6e\u53c2\u6570\uff1a \u00b6 def power ( x , n ): # x\u5c31\u662f\u4e00\u4e2a\u4f4d\u7f6e\u53c2\u6570 s = 1 while n > 0 : n = n - 1 s = s * x return s \u53ef\u53d8\u53c2\u6570 \u00b6 # \u53ef\u53d8\u53c2\u6570\u5c31\u662f\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\uff0c\u53ef\u4ee5\u662f0\u4e2a\u5230\u4efb\u610f\u4e2a # \u4f8b\uff1a\u7ed9\u5b9a\u4e00\u7ec4\u6570\u5b57a\uff0cb\uff0cc\u2026\u2026\uff0c\u8bf7\u8ba1\u7b97a2 + b2 + c2 + \u2026\u2026 # \u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570 def calc ( numbers ): sum = 0 for n in numbers : sum = sum + n * n return sum # \u5b9a\u4e49\u53ef\u53d8\u53c2\u6570\u548c\u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570\u76f8\u6bd4\uff0c\u4ec5\u4ec5\u5728\u53c2\u6570\u524d\u9762\u52a0\u4e86\u4e00\u4e2a* \u53f7\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0c\u53c2\u6570numbers\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff0c\u56e0\u6b64 # \u51fd\u6570\u4ee3\u7801\u5b8c\u5168\u4e0d\u53d8\u3002\u4f46\u662f\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u65f6\uff0c\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e2a\u53c2\u6570\uff0c\u5305\u62ec0\u4e2a\u53c2\u6570\u3002Python\u5141\u8bb8\u4f60\u5728list\u6216tuple\u524d\u9762\u52a0\u4e00\u4e2a*\u53f7\uff0c\u628alist\u6216 # tuple\u7684\u5143\u7d20\u53d8\u6210\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb\u3002*numbers\u8868\u793a\u628anumbers\u8fd9\u4e2alist\u6216tuple\u7684\u6240\u6709\u5143\u7d20\u4f5c\u4e3a\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb def calc ( * numbers ): sum = 0 for n in numbers : sum = sum + n * n return sum \"\"\" python\u4e2d*\u548c**\u542b\u4e49: \u5f53\u5176\u5728\u51fd\u6570\u5934\u5185(function header)\u65f6 * \u6536\u96c6\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u53c2\u6570 ** \u6536\u96c6\u5b57\u5178\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u53c2\u6570 \"\"\" def function_1 ( * a , ** kw ): print ( a , kw ) function_1 ( 1 , 2 , 3 , x = 1 , y = 2 , z = 3 ) # \u4f20\u53c2\u7ed9\u51fd\u6570function_1\uff0c\u8fd4\u56de\u503c\u4e3a(1, 2, 3) {'x': 1, 'y': 2, 'z': 3} \"\"\" \u5f53\u5176\u5728\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u4e2d \u5f53\u53c2\u6570\u5df2\u7ecf\u5728\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u4f46\u9700\u8981\u4e3a\u9700\u8981\u5355\u72ec\u4f4d\u7f6e\u53c2\u6570\u7684\u51fd\u6570\u8c03\u7528\u89e3\u5305\u65f6,\u4e0e*\u8fd0\u7b97\u7b26\u4e00\u8d77\u7f16\u5199\u51fd\u6570\u8c03\u7528\u4ee5\u4ece\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u89e3\u538b\u7f29\u53c2\u6570 * \u5c06\u5217\u8868\u6216\u5143\u7ec4\u89e3\u5305\u5230\u4f4d\u7f6e\u53c2\u6570\u4e2d ** \u5c06\u5b57\u5178\u89e3\u538b\u7f29\u4e3a\u5173\u952e\u5b57\u53c2\u6570 \"\"\" list = [ 1 , 2 , 3 ] dic = { 'x' : 1 , 'y' : 2 , 'z' : 3 } function_1 ( * list , ** dic ) \u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u4e5f\u53ef\u4ee5\u4f7f\u7528kwarg=value\u7684\u5173\u952e\u5b57\u53c2\u6570\u5f62\u5f0f\u88ab\u8c03\u7528\u3002 \u00b6 # \u53ef\u53d8\u53c2\u6570\u5217\u8868\uff1a\u4e00\u4e2a\u6700\u4e0d\u5e38\u7528\u7684\u9009\u62e9\u662f\u53ef\u4ee5\u8ba9\u51fd\u6570\u8c03\u7528\u53ef\u53d8\u4e2a\u6570\u7684\u53c2\u6570.\u8fd9\u4e9b\u53c2\u6570\u88ab\u5305\u88c5\u8fdb\u4e00\u4e2a\u5143\u7ec4tuple(\u67e5\u770b\u5143\u7ec4\u548c\u5e8f\u5217).\u5728\u8fd9\u4e9b\u53ef # \u53d8\u4e2a\u6570\u7684\u53c2\u6570\u4e4b\u524d,\u53ef\u4ee5\u6709\u96f6\u5230\u591a\u4e2a\u542b\u53c2\u6570\u540d\u7684\u53c2\u6570: def arithmetic_mean ( * args ): sum = 0 for x in args : sum += x return sum print ( arithmetic_mean ( 45 , 32 , 89 , 78 )) print ( arithmetic_mean ( 8989.8 , 78787.78 , 3453 , 78778.73 )) print ( arithmetic_mean ( 45 , 32 )) print ( arithmetic_mean ( 45 )) print ( arithmetic_mean ()) # \u5173\u952e\u5b57\u53c2\u6570\u6709\u4ec0\u4e48\u7528\uff1f\u5b83\u53ef\u4ee5\u6269\u5c55\u51fd\u6570\u7684\u529f\u80fd\u3002\u6bd4\u5982\uff0c\u5728person\u51fd\u6570\u91cc\uff0c\u6211\u4eec\u4fdd\u8bc1\u80fd\u63a5\u6536\u5230name\u548cage\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u4f46\u662f\uff0c\u5982\u679c\u8c03\u7528\u8005 # \u613f\u610f\u63d0\u4f9b\u66f4\u591a\u7684\u53c2\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u6536\u5230\u3002\u8bd5\u60f3\u4f60\u6b63\u5728\u505a\u4e00\u4e2a\u7528\u6237\u6ce8\u518c\u7684\u529f\u80fd\uff0c\u9664\u4e86\u7528\u6237\u540d\u548c\u5e74\u9f84\u662f\u5fc5\u586b\u9879\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u53ef\u9009\u9879\uff0c\u5229\u7528\u5173\u952e\u5b57 # \u53c2\u6570\u6765\u5b9a\u4e49\u8fd9\u4e2a\u51fd\u6570\u5c31\u80fd\u6ee1\u8db3\u6ce8\u518c\u7684\u9700\u6c42 \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570 \u00b6 # \u5bf9\u4e8e\u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u7684\u8c03\u7528\u8005\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e0d\u53d7\u9650\u5236\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u81f3\u4e8e\u5230\u5e95\u4f20\u5165\u4e86\u54ea\u4e9b\uff0c\u5c31\u9700\u8981\u5728\u51fd\u6570\u5185\u90e8\u901a\u8fc7kw\u68c0\u67e5\u3002 # \u4ee5person()\u51fd\u6570\u4e3a\u4f8b\uff0c\u6211\u4eec\u5e0c\u671b\u68c0\u67e5\u662f\u5426\u6709city\u548cjob\u53c2\u6570 def person ( name , age , ** kw ): if 'city' in kw : # \u6709city\u53c2\u6570 pass if 'job' in kw : # \u6709job\u53c2\u6570 pass print ( 'name:' , name , 'age:' , age , 'other:' , kw ) # \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5fc5\u987b\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8fd9\u548c\u4f4d\u7f6e\u53c2\u6570\u4e0d\u540c\u3002\u5982\u679c\u6ca1\u6709\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8c03\u7528\u5c06\u62a5\u9519 # \u4f7f\u7528\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u65f6\uff0c\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u53d8\u53c2\u6570\uff0c\u5c31\u5fc5\u987b\u52a0\u4e00\u4e2a*\u4f5c\u4e3a\u7279\u6b8a\u5206\u9694\u7b26\u3002\u5982\u679c\u7f3a\u5c11*\uff0cPython\u89e3\u91ca\u5668\u5c06\u65e0\u6cd5\u8bc6\u522b\u4f4d\u7f6e\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff1a def person ( name , age , city , job ): # \u7f3a\u5c11 *\uff0ccity\u548cjob\u88ab\u89c6\u4e3a\u4f4d\u7f6e\u53c2\u6570 pass Lambda\u8868\u8fbe\u5f0f \u00b6 \u53ef\u4ee5\u4f7f\u7528lambda\u5173\u952e\u5b57\u521b\u5efa\u5c0f\u7684\u533f\u540d\u51fd\u6570\u3002\u6b64\u51fd\u6570\u8fd4\u56de\u5176\u4e24\u4e2a\u53c2\u6570\u7684\u603b\u548c\uff1a\u3002Lambda\u51fd\u6570\u53ef\u4ee5\u5728\u9700\u8981\u51fd\u6570\u5bf9\u8c61\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u3002\u5b83\u4eec\u5728\u8bed \u6cd5\u4e0a\u9650\u4e8e\u5355\u4e2a\u8868\u8fbe\u5f0f\u3002\u4ece\u8bed\u4e49\u4e0a\u8bb2\uff0c\u5b83\u4eec\u53ea\u662f\u6b63\u5e38\u51fd\u6570\u5b9a\u4e49\u7684\u8bed\u6cd5\u7cd6\u3002\u4e0e\u5d4c\u5957\u51fd\u6570\u5b9a\u4e49\u4e00\u6837\uff0clambda\u51fd\u6570\u53ef\u4ee5\u5f15\u7528\u5305\u542b\u8303\u56f4\u7684\u53d8\u91cf\uff1alamb da a, b: a+b # \u7528\u9014\u4e00\uff1a\u4f7f\u7528lambda\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570 def make_incrementor ( n ): return lambda x : x + n # \u7528\u9014\u4e8c\uff1a\u4f20\u9012\u4e00\u4e2a\u5c0f\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570 pairs = [( 1 , 'one' ), ( 2 , 'two' ), ( 3 , 'three' ), ( 4 , 'four' )] pairs . sort ( key = lambda pair : pair [ 1 ]) print ( pairs ) \u53c2\u6570\u7ec4\u5408 \u00b6 # Python\u4e2d\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff0c\u8fd95\u79cd\u53c2\u6570\u90fd\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\u3002\u4f46\u662f\u8bf7\u6ce8\u610f # \u53c2\u6570\u5b9a\u4e49\u7684\u987a\u5e8f\u5fc5\u987b\u662f\uff1a\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u5173\u952e\u5b57\u53c2\u6570 # \u5982\u679c\u51fd\u6570\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u7684\u5b9e\u53c2\uff0c\u5fc5\u987b\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u5c06\u63a5\u7eb3\u4efb\u610f\u6570\u91cf\u5b9e\u53c2\u7684\u5f62\u53c2\u653e\u5728\u6700\u540e # \u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u5305\u542b\u4e0a\u8ff0\u82e5\u5e72\u79cd\u53c2\u6570\uff1a\u5728\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cPython\u89e3\u91ca\u5668\u81ea\u52a8\u6309\u7167\u53c2\u6570\u4f4d\u7f6e\u548c\u53c2\u6570\u540d\u628a\u5bf9\u5e94\u7684\u53c2\u6570\u4f20\u8fdb\u53bb def f1 ( a , b , c = 0 , * args , ** kw ): print ( 'a =' , a , 'b =' , b , 'c =' , c , 'args =' , args , 'kw =' , kw ) def f2 ( a , b , c = 0 , * , d , ** kw ): print ( 'a =' , a , 'b =' , b , 'c =' , c , 'd =' , d , 'kw =' , kw ) # \u6240\u4ee5\uff0c\u5bf9\u4e8e\u4efb\u610f\u51fd\u6570\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3cfunc(*args, **kw)\u7684\u5f62\u5f0f\u8c03\u7528\u5b83\uff0c\u65e0\u8bba\u5b83\u7684\u53c2\u6570\u662f\u5982\u4f55\u5b9a\u4e49\u7684\u3002 \u9012\u5f52\u51fd\u6570 \u00b6 \"\"\" \u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5728\u5185\u90e8\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u9012\u5f52\u51fd\u6570.\u7406\u8bba\u4e0a\uff0c\u6240\u6709\u7684\u9012\u5f52\u51fd\u6570\u90fd\u53ef\u4ee5\u5199\u6210\u5faa\u73af\u7684\u65b9\u5f0f\uff0c\u4f46\u5faa\u73af\u7684\u903b\u8f91\u4e0d\u5982\u9012\u5f52\u6e05\u6670 \u4f7f\u7528\u9012\u5f52\u51fd\u6570\u9700\u8981\u6ce8\u610f\u9632\u6b62\u6808\u6ea2\u51fa\u3002\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u51fd\u6570\u8c03\u7528\u662f\u901a\u8fc7\u6808\uff08stack\uff09\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u5b9e\u73b0\u7684\uff0c\u6bcf\u5f53\u8fdb\u5165\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u6808\u5c31\u4f1a\u52a0\u4e00\u5c42\u6808\u5e27\uff0c\u6bcf\u5f53\u51fd\u6570\u8fd4\u56de\uff0c\u6808\u5c31\u4f1a\u51cf\u4e00\u5c42\u6808\u5e27\u3002\u7531\u4e8e\u6808\u7684\u5927\u5c0f\u4e0d\u662f\u65e0\u9650\u7684\uff0c\u6240\u4ee5\uff0c\u9012\u5f52\u8c03\u7528\u7684\u6b21\u6570\u8fc7\u591a\uff0c\u4f1a\u5bfc\u81f4\u6808\u6ea2\u51fa\u3002 \u89e3\u51b3\u9012\u5f52\u8c03\u7528\u6808\u6ea2\u51fa\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u5c3e\u9012\u5f52\u4f18\u5316\uff0c\u4e8b\u5b9e\u4e0a\u5c3e\u9012\u5f52\u548c\u5faa\u73af\u7684\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\uff0c\u628a\u5faa\u73af\u770b\u6210\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c3e\u9012\u5f52\u51fd\u6570\u4e5f\u662f\u53ef\u4ee5\u7684 \u5c3e\u9012\u5f52\u662f\u6307\uff0c\u5728\u51fd\u6570\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u5e76\u4e14\uff0creturn\u8bed\u53e5\u4e0d\u80fd\u5305\u542b\u8868\u8fbe\u5f0f\u3002\u8fd9\u6837\uff0c\u7f16\u8bd1\u5668\u6216\u8005\u89e3\u91ca\u5668\u5c31\u53ef\u4ee5\u628a\u5c3e\u9012\u5f52\u505a\u4f18\u5316\uff0c\u4f7f\u9012\u5f52\u672c\u8eab\u65e0\u8bba\u8c03\u7528\u591a\u5c11\u6b21\uff0c\u90fd\u53ea\u5360\u7528\u4e00\u4e2a\u6808\u5e27\uff0c\u4e0d\u4f1a\u51fa\u73b0\u6808\u6ea2\u51fa\u7684\u60c5\u51b5\u3002 \"\"\" python\u9ad8\u7ea7\u7279\u6027\uff1a\u5207\u7247\u3001\u8fed\u4ee3\u3001\u5217\u8868\u63a8\u5bfc\u5f0f\u3001\u751f\u6210\u5668\u3001\u8fed\u4ee3\u5668 \u00b6 \"\"\" \u5207\u7247\u5728\u5217\u8868\u4e0a\u5c31\u50cf\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u5217\u8868\u7684\u5b50\u90e8\u5206 \u7ed9\u5b9a\u4e00\u4e2alist\u6216tuple\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7for\u5faa\u73af\u6765\u904d\u5386\u8fd9\u4e2alist\u6216tuple\uff0c\u8fd9\u79cd\u904d\u5386\u6211\u4eec\u79f0\u4e3a\u8fed\u4ee3(Iteration) \u8fed\u4ee3\u662f\u8bbf\u95ee\u96c6\u5408\u5143\u7d20\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u8fed\u4ee3\u5668\u53ef\u4ee5\u8bb0\u4f4f\u904d\u5386\u4f4d\u7f6e\u7684\u5bf9\u8c61\u3002\u8fed\u4ee3\u5668\u5bf9\u8c61\u4ece\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\u8bbf\u95ee\uff0c\u77e5\u9053\u6240\u6709\u5143\u7d20\u7ed3\u675f\uff0c\u8fed\u4ee3 \u5668\u53ea\u80fd\u5f80\u524d\uff0c\u8fed\u4ee3\u5668\u6709\u4e24\u4e2a\u65b9\u6cd5iter()\u548cnext()\u3002\u5b57\u7b26\u4e32\u3001\u5217\u8868\u548c\u5143\u7ec4\u5bf9\u8c61\u90fd\u53ef\u7528\u4e8e\u521b\u5efa\u8fed\u4ee3\u5668 \"\"\" list = [ 1 , 2 , 3 , 4 ] # \u521b\u5efa\u5217\u8868list it = iter ( list ) # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it print ( next ( it )) # \u8f93\u51fa\u8fed\u4ee3\u5668\u4e0b\u4e00\u4e2a\u5143\u7d20 # \u8fed\u4ee3\u5668\u5bf9\u8c61\u53ef\u4ee5\u7528for\u8bed\u53e5\u8fdb\u884c\u904d\u5386 list = [ 1 , 2 , 3 , 4 ] # \u521b\u5efa\u5217\u8868list it = iter ( list ) # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it for x in it : print ( x , end = \" \" ) # \u5217\u8868\u63a8\u5bfc\u5f0f\u5373List Comprehensions\uff0c\u662fPython\u5185\u7f6e\u7684\u975e\u5e38\u7b80\u5355\u5374\u5f3a\u5927\u7684\u53ef\u4ee5\u7528\u6765\u521b\u5efalist\u7684\u751f\u6210\u5f0f # for\u5faa\u73af\u540e\u9762\u8fd8\u53ef\u4ee5\u52a0\u4e0aif\u5224\u65ad\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7b5b\u9009\u51fa\u4ec5\u5076\u6570\u7684\u5e73\u65b9\uff1a print ([ x * x for x in range ( 1 , 11 ) if x % 2 == 0 ]) # \u8fd0\u7528\u5217\u8868\u63a8\u5bfc\u5f0f\uff0c\u53ef\u4ee5\u5199\u51fa\u975e\u5e38\u7b80\u6d01\u7684\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0 import os # \u5bfc\u5165os\u6a21\u5757 print ([ dir for dir in os . listdir ( '.' )]) # \u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u548c\u76ee\u5f55\u540d(\u5305\u542b\u9690\u85cf\u6587\u4ef6\u6216\u76ee\u5f55) \"\"\" \u4f7f\u7528\u4e86yield\u7684\u51fd\u6570\u79f0\u4e3a\u751f\u6210\u5668(generator)\uff0c\u751f\u6210\u5668\u662f\u4e00\u4e2a\u8fd4\u56de\u8fed\u4ee3\u5668\u7684\u51fd\u6570\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u751f\u6210\u5668\u5c31\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002\u5728\u8c03\u7528\u751f\u6210\u5668 \u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u6b21\u9047\u5230yield\u51fd\u6570\u4f1a\u6682\u505c\u5e76\u4fdd\u5b58\u5f53\u524d\u6240\u6709\u7684\u8fd0\u884c\u4fe1\u606f\uff0c\u8fd4\u56deyield\u7684\u503c\uff0c\u5e76\u5728\u4e0b\u4e00\u6b21next()\u65b9\u6cd5\u4ece\u5f53\u524d\u4f4d\u7f6e\u7ee7\u7eed\u8fd0\u884c\u3002 \"\"\" # \u4f7f\u7528\u751f\u6210\u5668\u751f\u6210\u6590\u6ce2\u90a3\u5951\u6570\u5217,\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff1a\u5373\u4e24\u4e2a\u5143\u7d20\u7684\u548c\u786e\u5b9a\u4e0b\u4e00\u4e2a\u6570 import sys def fibonacci ( x ): a , b , count = 0 , 1 , 0 while True : if ( count > x ): return yield a # \u5c06fibonacci\u51fd\u6570\u53d8\u6210generator\uff0cprint(a)\u6539\u6210yield a a , b = b , a + b count += 1 f = fibonacci ( 21 ) # f\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u7531\u751f\u6210\u5668\u8fd4\u56de\u751f\u6210 while True : try : print ( next ( f ), end = \"\" ) except StopIteration : sys . exit () # \u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u6570\u636e\u7c7b\u578b\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a # \u4e00\u662f\u96c6\u5408\u6570\u636e\u7c7b\u578b\uff0c\u5982list\u3001tuple\u3001dict\u3001set\u3001str\u7b49\uff1b # \u4e8c\u662fgenerator\uff0c\u5305\u62ec\u751f\u6210\u5668\u548c\u5e26yield\u7684generator function\u3002 # \u8fd9\u4e9b\u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u7edf\u79f0\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1aIterable # \u53ef\u4ee5\u4f7f\u7528isinstance()\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662fIterable\u5bf9\u8c61 # \u751f\u6210\u5668\u90fd\u662fIterator\u5bf9\u8c61\uff0c\u4f46list\u3001dict\u3001str\u867d\u7136\u662fIterable\uff0c\u5374\u4e0d\u662fIterator\u3002\u628alist\u3001dict\u3001str\u7b49Iterable\u53d8\u6210Iterator\u53ef\u4ee5\u4f7f\u7528iter()\u51fd\u6570 \"\"\" \u4e3a\u4ec0\u4e48list\u3001dict\u3001str\u7b49\u6570\u636e\u7c7b\u578b\u4e0d\u662fIterator? \u8fd9\u662f\u56e0\u4e3aPython\u7684Iterator\u5bf9\u8c61\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u636e\u6d41\uff0cIterator\u5bf9\u8c61\u53ef\u4ee5\u88abnext()\u51fd\u6570\u8c03\u7528\u5e76\u4e0d\u65ad\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u76f4\u5230\u6ca1\u6709\u6570\u636e\u65f6\u629b\u51fa StopIteration\u9519\u8bef\u3002\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u636e\u6d41\u770b\u505a\u662f\u4e00\u4e2a\u6709\u5e8f\u5e8f\u5217\uff0c\u4f46\u6211\u4eec\u5374\u4e0d\u80fd\u63d0\u524d\u77e5\u9053\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u53ea\u80fd\u4e0d\u65ad\u901a\u8fc7next()\u51fd\u6570\u5b9e\u73b0\u6309\u9700\u8ba1\u7b97 \u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u6240\u4ee5Iterator\u7684\u8ba1\u7b97\u662f\u60f0\u6027\u7684\uff0c\u53ea\u6709\u5728\u9700\u8981\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\u65f6\u5b83\u624d\u4f1a\u8ba1\u7b97\u3002 \"\"\" # Iterator\u751a\u81f3\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u65e0\u9650\u5927\u7684\u6570\u636e\u6d41\uff0c\u4f8b\u5982\u5168\u4f53\u81ea\u7136\u6570\u3002\u800c\u4f7f\u7528list\u662f\u6c38\u8fdc\u4e0d\u53ef\u80fd\u5b58\u50a8\u5168\u4f53\u81ea\u7136\u6570\u7684 # \u603b\u7ed3\uff1a # \u51e1\u662f\u53ef\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u90fd\u662fIterable\u7c7b\u578b\uff1b # \u51e1\u662f\u53ef\u4f5c\u7528\u4e8enext()\u51fd\u6570\u7684\u5bf9\u8c61\u90fd\u662fIterator\u7c7b\u578b\uff0c\u5b83\u4eec\u8868\u793a\u4e00\u4e2a\u60f0\u6027\u8ba1\u7b97\u7684\u5e8f\u5217\uff1b # \u96c6\u5408\u6570\u636e\u7c7b\u578b\u5982list\u3001dict\u3001str\u7b49\u662fIterable\u4f46\u4e0d\u662fIterator\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u901a\u8fc7iter()\u51fd\u6570\u83b7\u5f97\u4e00\u4e2aIterator\u5bf9\u8c61\u3002 # Python\u7684for\u5faa\u73af\u672c\u8d28\u4e0a\u5c31\u662f\u901a\u8fc7\u4e0d\u65ad\u8c03\u7528next()\u51fd\u6570\u5b9e\u73b0\u7684\uff0c\u4f8b\u5982\uff1a for x in [ 1 , 2 , 3 , 4 , 5 ]: pass # \u5b9e\u9645\u4e0a\u5b8c\u5168\u7b49\u4ef7\u4e8e\uff1a # \u9996\u5148\u83b7\u5f97Iterator\u5bf9\u8c61: it = iter ([ 1 , 2 , 3 , 4 , 5 ]) # \u5faa\u73af: while True : try : # \u83b7\u5f97\u4e0b\u4e00\u4e2a\u503c: x = next ( it ) except StopIteration : # \u9047\u5230StopIteration\u5c31\u9000\u51fa\u5faa\u73af break \u9762\u5411\u5bf9\u8c61 \u00b6 \u7c7b(Class) \u00b6 \u5f53Python\u89e3\u91ca\u5668\u8bfb\u53d6\u6e90\u6587\u4ef6\u65f6\uff0c\u5b83\u4f1a\u6267\u884c\u6240\u6709\u4ee3\u7801\u3002\u6b64__name__\u68c0\u67e5\u786e\u4fdd\u4ec5\u5728\u6b64\u6a21\u5757\u662f\u4e3b\u7a0b\u5e8f(main)\u65f6\u624d\u6267\u884c\u6b64\u4ee3\u7801\u5757\u3002 \u7ee7\u627f(Inheritance) \u00b6 \u591a\u91cd\u7ee7\u627f(Multiple Inheritance) \u00b6 \u5185\u7f6e\u5f02\u5e38 \u00b6 Python\u4e2d\u6240\u6709\u5f02\u5e38\u5fc5\u987b\u4e3a\u4e00\u4e2a\u6d3e\u751f\u81eaBaseException\u7c7b\u7684\u5b9e\u4f8b\u3002\u5728try\u5e26\u6709except\u63d0\u53ca\u7279\u5b9a\u7c7b\u7684\u5b50\u53e5\u7684\u8bed\u53e5\u4e2d\uff0c\u8be5\u5b50\u53e5\u4e5f\u4f1a\u5904\u7406\u4efb\u4f55\u6d3e\u751f\u81ea \u8be5\u7c7b\u7684\u5f02\u5e38\u7c7b,(\u4f46\u4e0d\u5904\u7406\u5b83\u6240\u6d3e\u751f\u51fa\u7684\u5f02\u5e38\u7c7b)\u901a\u8fc7\u5b50\u7c7b\u5316\u521b\u5efa\u7684\u4e24\u4e2a\u4e0d\u76f8\u5173\u5f02\u5e38\u7c7b\u6c38\u8fdc\u662f\u4e0d\u7b49\u6548\u7684\uff0c\u65e2\u4f7f\u5b83\u4eec\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002 try...except\u8bed\u53e5\u6709\u4e00\u4e2a\u53ef\u9009\u7684else\u5b57\u53e5\uff0c\u4f7f\u7528\u65f6\u5fc5\u987b\u653e\u5728\u6240\u6709except\u5b57\u53e5\u540e\u9762\uff0craise\u8bed\u53e5\u5141\u8bb8\u7a0b\u5e8f\u5f3a\u5236\u53d1\u751f\u6307\u5b9a\u7684\u5f02\u5e38\uff0craise\u552f\u4e00\u7684 \u53c2\u6570\u5c31\u662f\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u8fd9\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u5f02\u5e38\u5b9e\u4f8b\u6216\u4e00\u4e2a\u5f02\u5e38\u7c7b(\u6d3e\u751f\u81eaException\u7684\u7c7b) \u57fa\u7c7b(Base classes) \u00b6 \u4ee5\u4e0b\u5f02\u5e38\u4e3b\u8981\u88ab\u7528\u4f5c\u5176\u4ed6\u5f02\u5e38\u7684\u57fa\u7c7b \u8be6\u60c5\u8bf7\u70b9\u51fb\u6b64\u5904\u67e5\u770b Concrete exceptions \u00b6 \u70b9\u51fb\u6b64\u5904\u67e5\u770b OS \u5f02\u5e38 \u00b6 \u70b9\u51fb\u6b64\u5904\u67e5\u770b \u8b66\u544a \u00b6 \u8be6\u60c5\u70b9\u51fb\u6b64\u5904\u67e5\u770b \u5f02\u5e38\u5c42\u6b21\u7ed3\u6784 \u00b6 BaseException + -- SystemExit + -- KeyboardInterrupt + -- GeneratorExit + -- Exception + -- StopIteration + -- StopAsyncIteration + -- ArithmeticError | + -- FloatingPointError | + -- OverflowError | + -- ZeroDivisionError + -- AssertionError + -- AttributeError + -- BufferError + -- EOFError + -- ImportError | + -- ModuleNotFoundError + -- LookupError | + -- IndexError | + -- KeyError + -- MemoryError + -- NameError | + -- UnboundLocalError + -- OSError | + -- BlockingIOError | + -- ChildProcessError | + -- ConnectionError | | + -- BrokenPipeError | | + -- ConnectionAbortedError | | + -- ConnectionRefusedError | | + -- ConnectionResetError | + -- FileExistsError | + -- FileNotFoundError | + -- InterruptedError | + -- IsADirectoryError | + -- NotADirectoryError | + -- PermissionError | + -- ProcessLookupError | + -- TimeoutError + -- ReferenceError + -- RuntimeError | + -- NotImplementedError | + -- RecursionError + -- SyntaxError | + -- IndentationError | + -- TabError + -- SystemError + -- TypeError + -- ValueError | + -- UnicodeError | + -- UnicodeDecodeError | + -- UnicodeEncodeError | + -- UnicodeTranslateError + -- Warning + -- DeprecationWarning + -- PendingDeprecationWarning + -- RuntimeWarning + -- SyntaxWarning + -- UserWarning + -- FutureWarning + -- ImportWarning + -- UnicodeWarning + -- BytesWarning + -- ResourceWarning \u6587\u672c\u5904\u7406\u670d\u52a1 \u00b6 \u5e38\u89c1\u5b57\u7b26\u4e32\u64cd\u4f5c \u00b6 \u5b57\u7b26\u4e32 \u63cf\u8ff0 string.capwords(s, sep) \u5c06\u4ee5sep\u5206\u5272\u7684\u5b57\u7b26\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u6ca1\u6709sep\u9ed8\u8ba4\u662f\u9996\u5b57\u6bcd string.ascii_letters \u4ee5\u4e0blowercase\u548cuppercase\u4e24\u4e2a\u5e38\u91cf\u7684\u4e32\u8054 string.ascii_lowercase \u5c0f\u5199\u5b57\u6bcdabcdefghijklmnopqrstuvwxyz string.ascii_uppercase \u5927\u5199\u5b57\u6bcdABCDEFGHIJKLMNOPQRSTUVWXYZ string.digits \u5b57\u7b26\u4e320123456789 string.hexdigits \u5b57\u7b26\u4e320123456789abcdefABCDEF string.octdigits \u5b57\u7b26\u4e3201234567 string.punctuation ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32,\u5728C\u8bed\u8a00\u73af\u5883\u4e2d\u88ab\u89c6\u4e3a\u6807\u70b9\u5b57\u7b26 string.printable \u88ab\u89c6\u4e3a\u53ef\u6253\u5370\u7684ASCII\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ec4\u5408digits\u3001ascii_letters\u3001punctuation\u3001whitespace string.whitespace \u5305\u542b\u6240\u6709\u88ab\u89c6\u4e3a\u7a7a\u683c\u7684ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff0c\u5305\u62ec\u5b57\u7b26\u95f4\u9694,tab, linefeed, return, formfeed, and vertical tab \u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u8bed\u6cd5 \u00b6 str.format()\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528{}\u62ec\u8d77\u6765\u8981\u66ff\u6362\u7684\u5b57\u6bb5\uff0c\u4e0d\u5728\u82b1\u62ec\u53f7\u4e4b\u5185\u7684\u5185\u5bb9\u4f1a\u4e0d\u52a0\u4fee\u6539\u7684\u6253\u5370\u5230\u8f93\u51fa\u4e2d\u3002\u5b83\u5c06\u4e0d\u52a0\u6539\u53d8\u5730\u590d\u5236\u5230 \u8f93\u51fa\u4e2d\u3002\u5982\u679c\u4f60\u9700\u8981\u5728\u6587\u5b57\u6587\u672c\u4e2d\u5305\u542b\u4e00\u4e2a\u5927\u62ec\u53f7\u5b57\u7b26\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0\u500d\u6765\u8f6c\u4e49\uff1a{{ }} \u66ff\u6362\u5b57\u6bb5\u8bed\u6cd5\u5982\u4e0b\uff1a replacement_field :: = \" { \" [ field_name ] [ \" ! \" conversion ] [ \" : \" format_spec ] \" } \" field_name :: = arg_name ( \" . \" attribute_name | \" [ \" element_index \" ] \" ) * arg_name :: = [ identifier | digit + ] attribute_name :: = identifier element_index :: = digit + | index_string index_string :: = < any source character except \" ] \" > + conversion :: = \" r \" | \" s \" | \" a \" format_spec :: = < described in the next section > # \u793a\u4f8b\uff1a >>> \" {} can be {} \" . format ( \" Strings \" , \" interpolated \" ) >>> \" {0} be nimble, {0} be quick, {0} jump over the {1} \" . format ( \" Jack \" , \" candle stick \" ) >>> \" {name} wants to eat {food} \" . format ( name = \" Bob \" , food = \" lasagna \" ) >>> \" %s can be %s the %s way \" % ( \" Strings \" , \" interpolated \" , \" old \" ) Mini-Language\u683c\u5f0f\u5316 \u00b6 # \u683c\u5f0f\u5316\u6574\u6570\u548c\u6d6e\u70b9\u6570\u8fd8\u53ef\u4ee5\u6307\u5b9a\u662f\u5426\u88650\u548c\u6574\u6570\u4e0e\u5c0f\u6570\u7684\u4f4d\u6570\uff1a print ( ' %2d - %02d ' % ( 3 , 1 )) print ( ' %.2f ' % 3.1415926 ) # \u5b57\u7b26\u4e32\u91cc\u9762\u7684%\u662f\u4e00\u4e2a\u666e\u901a\u5b57\u7b26\u600e\u4e48\u529e\uff1f\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u8f6c\u4e49\uff0c\u7528%%\u6765\u8868\u793a\u4e00\u4e2a% # \u5229\u7528format()\u65b9\u6cd5\u8fdb\u884c\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u5b83\u4f1a\u7528\u4f20\u5165\u7684\u53c2\u6570\u4f9d\u6b21\u66ff\u6362\u5b57\u7b26\u4e32\u5185\u7684\u5360\u4f4d\u7b26{0},{1}......,\u4f46\u8981\u6bd4\u5360\u4f4d\u7b26\u9ebb\u70e6\u3002 'Hello, {0}, \u6210\u7ee9\u63d0\u5347\u4e86 {1:.1f}%' . format ( '\u5c0f\u660e' , 17.125 ) \u5b57\u7b26\u4e32 % \u64cd\u4f5c\uff0cpython\u6709\u4e00\u4e2aprintf\u683c\u5f0f\u5c06\u5b57\u7b26\u4e32\u653e\u5728\u4e00\u8d77\uff0c%\u64cd\u4f5c\u7b26\u5c06\u5de6\u8fb9(%d int, %s string, %f\u6216%g floating point)\u4ee5printf-type\u683c\u5f0f\u5316\uff0c\u5339\u914d\u5728\u53f3\u8fb9\u7684\u5143\u7ec4\u91cc\u7684\u503c \u683c\u5f0f\u5316\u7b26\u53f7 \u66ff\u6362\u5185\u5bb9\u7c7b\u578b %s \u5b57\u7b26\u4e32 %d \u5341\u8fdb\u5236\u6574\u6570 %x \u5341\u516d\u8fdb\u5236\u6574\u6570 %f \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d %g \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d,\u4e0d\u5c3e\u968f0 re--\u6b63\u5219\u8868\u8fbe\u5f0f \u00b6 re\u6a21\u5757\u4e0ePerl\u8bed\u8a00\u7c7b\u4f3c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u64cd\u4f5c\uff0c\u6a21\u5f0f\u548c\u88ab\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u4f7fUnicode\u5b57\u7b26\u4e32\u4e5f\u53ef\u4ee5\u662f8\u4e3a\u5b57\u8282\u4e32(bytes)\uff0c\u4f46Unicode\u548c 8\u4f4d\u5b57\u8282\u4e32\u4e0d\u80fd\u6df7\u7528\u3002\u56e0\u53cd\u659c\u6760\\\u5728Python\u4e2d\u548c\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\uff0c\u90fd\u5177\u6709\u5c06\u628a\u7279\u6b8a\u5b57\u7b26\u8f6c\u6362\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\u7684\u4f5c\u7528\u3002\u6240\u4ee5\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f \u8981\u5199\u6210 \\\\\\\\ \u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5bf9\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u6837\u5f0f\u7528\u5e26\u6709r\u524d\u7f00\u7684\u8868\u793aPython\u539f\u59cb\u5b57\u7b26\u7684\u65b9\u6cd5 \u5e38\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff1a \u8be6\u7ec6\u70b9\u51fb\u6b64\u5904\u4e86\u89e3 re.search(pattern, string, flags=0) \u67e5\u627e\u5728string\u4e2d\u4e0epattern\u5339\u914d\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u5b57\u7b26\uff0c\u5e76\u8fd4\u56de\u5339\u914d\u5bf9\u8c61\u548c\u4f4d\u7f6e\u3002\u5982\u679cstring\u4e2d\u6ca1\u6709 \u4e0e\u6a21\u5f0f\u5339\u914d\uff0c\u5219\u8fd4\u56deNone difflib -- helpers for computing deltas \u00b6 | :------: | :------: | \u8be6\u7ec6\u70b9\u51fb\u6b64\u5904\u4e86\u89e3 textwrap \u00b6 \u901a\u8fc7\u8c03\u6574\u6bb5\u843d\u4e2d\u51fa\u73b0\u6362\u884c\u7b26\u7684\u4f4d\u7f6e\u6765\u683c\u5f0f\u5316\u6587\u672c\u3002TextWrapper\u6784\u9020\u51fd\u6570\u63a5\u53d7\u8bb8\u591a\u53ef\u9009\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u6bcf\u4e2a\u5173\u952e\u5b57\u53c2\u6570\u5bf9\u5e94\u4e00\u4e2a\u5b9e\u4f8b\u5c5e\u6027 textwrap.wrap(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u6bb5\u843d\uff0c\u8f93\u51fa\u4ee5\u957f\u5ea6\u5212\u5206\u7684\u884c\u5217\u8868 textwrap.fill(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u4e3a\u65b0\u7684\u4e00\u884c textwrap.shorten(text, width, **kwargs) \u622a\u65ad\u7ed9\u5b9a\u6587\u672c\u4ee5\u9002\u5408\u7ed9\u5b9a\u5bbd\u5ea6\u5e76\u4ee5[...]\u6298\u53e0\u88ab\u622a\u65ad\u7684\u6587\u672c textwrap.dedent(text) \u4ece\u6587\u672c\u7684\u6bcf\u4e00\u884c\u4e2d\u5220\u9664\u4efb\u4f55\u5e38\u89c1\u7684\u524d\u5bfc\u7a7a\u683c\u3001\u5236\u8868\u7b26 textwrap.indent(text, prefix, predicate=None) \u5728\u6587\u672c\u4e2d\u9009\u5b9a\u884c\u7684\u5f00\u5934\u6dfb\u52a0\u524d\u7f00 unicodedata stringprep readline rlcompleter Binary Data Services \u00b6 struct \u2014 Interpret bytes as packed binary data codecs \u2014 Codec registry and base classes \u5f00\u53d1\u8005\u5de5\u5177 \u00b6 unittest \u00b6 unittest.TestCase\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u65ad\u8a00\u65b9\u6cd5\uff0c\u65ad\u8a00\u65b9\u6cd5\u7528\u4e8e\u68c0\u9a8c\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\u671f\u671b\u7684\u7ed3\u679c unittest\u7c7b\u7684\u65ad\u8a00\u65b9\u6cd5 \u65b9\u6cd5 \u7528\u9014 assertEqual(a, b) \u6838\u5b9ea == b assertNotEqual(a, b) \u6838\u5b9ea != b assertTrue(x) \u6838\u5b9ex\u4e3aTrue assertFalse(x) \u6838\u5b9ex\u4e3aFalse assertIn(item, list) \u6838\u5b9eitem\u5728list\u4e2d assertNotIn(item, list) \u6838\u5b9eitem\u4e0d\u5728list\u4e2d","title":"Python3"},{"location":"Python3/#python3","text":"","title":"python3\u624b\u518c"},{"location":"Python3/#python","text":"# \u5e93\uff1a\u76f8\u5173\u529f\u80fd\u7684\u5408\u96c6 \u51fd\u6570\uff1a \u5b9a\u4e49\uff1a def \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09\uff1a \u8bed\u53e5\u5757 return \u8fd4\u56de\u503c \u8c03\u7528\uff1a \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09 \u53d8\u91cf\u540d = \u51fd\u6570\u540d\uff08\u53c2\u6570 1 \uff0c\u53c2\u6570 2 \u2026\u2026\uff09 # \u7c7b\uff1a \u7528\u6765\u63cf\u8ff0\u5177\u6709\u76f8\u540c\u5c5e\u6027\u548c\u65b9\u6cd5\u7684\u5bf9\u8c61\u7684\u96c6\u5408\uff0c\u5b9a\u4e49\u4e86\u8be5\u96c6\u5408\u4e2d\u6bcf\u4e2a\u5bf9\u8c61\u6240\u5171\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5bf9\u8c61\u662f\u7c7b\u7684\u5b9e\u4f8b\u3002 \u65b9\u6cd5\uff1a\u7c7b\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570 \u7c7b\u53d8\u91cf\uff1a\u7c7b\u53d8\u91cf\u5728\u6574\u4e2a\u5b9e\u4f8b\u5316\u7684\u5bf9\u8c61\u4e2d\u662f\u516c\u7528\u7684\u3002\u7c7b\u53d8\u91cf\u5b9a\u4e49\u5728\u7c7b\u4e2d\u4e14\u5728\u51fd\u6570\u4f53\u4e4b\u5916\u3002\u7c7b\u53d8\u91cf\u901a\u5e38\u4e0d\u4f5c\u4e3a\u5b9e\u4f8b\u53d8\u91cf\u4f7f\u7528\u3002 \u6570\u636e\u6210\u5458\uff1a\u7c7b\u53d8\u91cf\u6216\u8005\u5b9e\u4f8b\u53d8\u91cf\u7528\u4e8e\u5904\u7406\u7c7b\u53ca\u5176\u5b9e\u4f8b\u5bf9\u8c61\u7684\u76f8\u5173\u7684\u6570\u636e\u3002 \u65b9\u6cd5\u91cd\u5199\uff1a\u5982\u679c\u4ece\u7236\u7c7b\u7ee7\u627f\u7684\u65b9\u6cd5\u4e0d\u80fd\u6ee1\u8db3\u5b50\u7c7b\u7684\u9700\u6c42\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u6539\u5199\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u65b9\u6cd5\u7684\u8986\u76d6\uff08 override \uff09\uff0c\u4e5f\u79f0\u4e3a\u65b9\u6cd5\u7684\u91cd\u5199\u3002 \u5b9e\u4f8b\u53d8\u91cf\uff1a\u5b9a\u4e49\u5728\u65b9\u6cd5\u4e2d\u7684\u53d8\u91cf\uff0c\u53ea\u4f5c\u7528\u4e8e\u5f53\u524d\u5b9e\u4f8b\u7684\u7c7b\u3002 \u7ee7\u627f\uff1a\u5373\u4e00\u4e2a\u6d3e\u751f\u7c7b\uff08 derived class \uff09\u7ee7\u627f\u57fa\u7c7b\uff08 base class \uff09\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5\u3002\u7ee7\u627f\u4e5f\u5141\u8bb8\u628a\u4e00\u4e2a\u6d3e\u751f\u7c7b\u7684\u5bf9\u8c61\u4f5c\u4e3a\u4e00\u4e2a\u57fa\u7c7b\u5bf9\u8c61\u5bf9\u5f85 \u4f8b\u5982\uff0c\u6709\u8fd9\u6837\u4e00\u4e2a\u8bbe\u8ba1\uff1a\u4e00\u4e2a Dog \u7c7b\u578b\u7684\u5bf9\u8c61\u6d3e\u751f\u81ea Animal \u7c7b\uff0c\u8fd9\u662f\u6a21\u62df \" \u662f\u4e00\u4e2a\uff08is-a\uff09 \" \u5173\u7cfb\uff08\u4f8b\u56fe\uff0c Dog \u662f\u4e00\u4e2a Animal \uff09\u3002 \u5b9e\u4f8b\u5316\uff1a\u521b\u5efa\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\uff0c\u7c7b\u7684\u5177\u4f53\u5bf9\u8c61\u3002 \u5bf9\u8c61\uff1a\u901a\u8fc7\u7c7b\u5b9a\u4e49\u7684\u6570\u636e\u7ed3\u6784\u5b9e\u4f8b\u3002\u5bf9\u8c61\u5305\u62ec\u4e24\u4e2a\u6570\u636e\u6210\u5458\uff08\u7c7b\u53d8\u91cf\u548c\u5b9e\u4f8b\u53d8\u91cf\uff09\u548c\u65b9\u6cd5\u3002\u4f7f\u7528 is \u68c0\u67e5\u5bf9\u8c61\u6807\u8bc6\u662f\u5426\u76f8\u540c \u7c7b\u7684\u4e13\u6709\u65b9\u6cd5\uff1a __init__ : \u6784\u9020\u51fd\u6570\uff0c\u5728\u751f\u6210\u5bf9\u8c61\u65f6\u8c03\u7528 __del__ : \u6790\u6784\u51fd\u6570\uff0c\u91ca\u653e\u5bf9\u8c61\u65f6\u4f7f\u7528 __repr__ : \u6253\u5370\uff0c\u8f6c\u6362 __setitem__ : \u6309\u7167\u7d22\u5f15\u8d4b\u503c __getitem__ : \u6309\u7167\u7d22\u5f15\u83b7\u53d6\u503c __len__ : \u83b7\u5f97\u957f\u5ea6 __cmp__ : \u6bd4\u8f83\u8fd0\u7b97 __call__ : \u51fd\u6570\u8c03\u7528 __add__ : \u52a0\u8fd0\u7b97 __sub__ : \u51cf\u8fd0\u7b97 __mul__ : \u4e58\u8fd0\u7b97 __div__ : \u9664\u8fd0\u7b97 __mod__ : \u6c42\u4f59\u8fd0\u7b97 __pow__ : \u4e58\u65b9 \u63d0\u4f9b\u4e86\u4e00\u79cd\u7ec4\u5408\u6570\u636e\u548c\u529f\u80fd\u7684\u65b9\u6cd5\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u7c7b\u610f\u5473\u7740\u521b\u5efa\u4e00\u4e2a\u65b0 \u7c7b\u578b \u7684\u5bf9\u8c61\uff0c\u4ece\u800c\u5141\u8bb8\u521b\u5efa\u4e00\u4e2a\u8be5\u7c7b\u578b\u7684\u65b0\u5b9e\u4f8b \u3002\u6bcf\u4e2a\u7c7b\u7684\u5b9e \u4f8b\u53ef\u4ee5\u62e5\u6709\u4fdd\u5b58\u81ea\u5df1\u72b6\u6001\u7684\u5c5e\u6027\u3002\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u6709\u6539\u53d8\u81ea\u5df1\u72b6\u6001\u7684\uff08\u5b9a\u4e49\u5728\u7c7b\u4e2d\u7684\uff09\u65b9\u6cd5\u3002 Python \u7684\u7c7b\u63d0\u4f9b\u4e86\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u6240\u6709 \u6807\u51c6\u7279\u6027\uff1a\u7c7b\u7ee7\u627f\u673a\u5236\u5141\u8bb8\u591a\u4e2a\u57fa\u7c7b\uff0c\u6d3e\u751f\u7c7b\u53ef\u4ee5\u8986\u76d6\u5b83\u57fa\u7c7b\u7684\u4efb\u4f55\u65b9\u6cd5\uff0c\u4e00\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8c03\u7528\u57fa\u7c7b\u4e2d\u76f8\u540c\u540d\u79f0\u7684\u7684\u65b9\u6cd5\u3002\u5bf9\u8c61\u53ef\u4ee5\u5305\u542b\u4efb \u610f\u6570\u91cf\u548c\u7c7b\u578b\u7684\u6570\u636e\u3002\u548c\u6a21\u5757\u4e00\u6837\uff0c\u7c7b\u4e5f\u62e5\u6709 Python \u7684\u52a8\u6001\u7279\u6027\uff1a\u5b83\u4eec\u5728\u8fd0\u884c\u65f6\u521b\u5efa\uff0c\u53ef\u4ee5\u5728\u521b\u5efa\u540e\u4fee\u6539 \u7c7b\uff1a \u5b9a\u4e49\uff1a class \u7c7b\u540d () \uff1a def __init__ ( self ,\u53c2\u6570\u2026\u2026 ) : def \u51fd\u6570\u540d 1 ( self ,\u53c2\u6570\u2026\u2026 ) : def \u51fd\u6570\u540d 2 ( self ,\u53c2\u6570\u2026\u2026 ) : \u8c03\u7528\uff1a \u5b9e\u4f8b\u540d = \u7c7b\u540d () \u5b9e\u4f8b\u540d.\u65b9\u6cd5\u540d ( \u53c2\u6570 ) # \u6846\u67b6\uff1a\u63a7\u5236\u53cd\u8f6c # \u6a21\u5757\uff1a \u6a21\u5757\u5373\u666e\u901a\u7684 python \u6587\u4ef6\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5e76\u5bfc\u5165\uff0c\u6a21\u5757\u540d\u79f0\u5373\u6587\u4ef6\u540d\u79f0\uff0c\u5177\u6709\u663e\u5f0f\u5bfc\u51fa\u548c\u5bfc\u5165\u7684\u62bd\u8c61\u63a5\u53e3\uff0c\u5b9e\u73b0\u548c\u63a5\u53e3\u662f\u5206\u5f00\u7684 \u53ef\u80fd\u6709\u591a\u4e2a\u5b9e\u73b0\u5e76\u4e14\u5b9e\u73b0\u662f\u9690\u85cf\u7684\u3002\u901a\u4fd7\u7684\u8bb2\uff0c\u5c06\u81ea\u884c\u5b9a\u4e49\u6216\u5df2\u7ecf\u5b58\u5728\u7684\u65b9\u6cd5\u548c\u53d8\u91cf\u5b58\u653e\u5728\u6587\u4ef6\u4e2d\uff0c\u4e3a\u4e00\u4e9b\u811a\u672c\u6216\u4ea4\u4e92\u5f0f\u89e3\u91ca\u5668\u5b9e\u4f8b\u4f7f\u7528 \u8fd9\u6837\u7684\u6587\u4ef6\u88ab\u79f0\u4e4b\u4e3a\u6a21\u5757\uff1b\u6a21\u5757\u662f\u4e00\u4e2a\u5305\u542b Python \u5b9a\u4e49\u51fd\u6570\u3001\u53d8\u91cf\u548c\u8bed\u53e5\u7684\u6587\u4ef6\u3002\u6a21\u5757\u53ef\u4ee5\u88ab\u522b\u7684\u7a0b\u5e8f\u5f15\u5165\uff0c\u4ee5\u4f7f\u7528\u8be5\u6a21\u5757\u4e2d\u7684\u51fd\u6570\u7684 \u529f\u80fd\u548c\u5c5e\u6027\uff0c\u8fd9\u4e5f\u662f\u4f7f\u7528 python \u6807\u51c6\u5e93\u7684\u65b9\u6cd5,\u5982\u679c\u81ea\u5b9a\u4e49\u7684\u6709\u548c\u6807\u51c6\u5e93\u76f8\u540c\u7684\u6a21\u5757\uff0c\u5219\u4f1a\u8986\u76d6\u6807\u51c6\u5e93 \u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u6807\u8bc6\u7b26\u662f\u6709\u7279\u6b8a\u610f\u4e49\u7684\u3002 \u2022 \u4ee5\u5355\u4e0b\u5212\u7ebf\u5f00\u5934\uff08 _foo \uff09\u7684\u4ee3\u8868\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u7684\u7c7b\u5c5e\u6027\uff0c\u9700\u901a\u8fc7\u7c7b\u63d0\u4f9b\u7684\u63a5\u53e3\u8fdb\u884c\u8bbf\u95ee\uff1b \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\uff08 __foo \uff09\u4ee3\u8868\u7c7b\u7684\u79c1\u6709\u6210\u5458\uff1b \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\uff08 __foo__ \uff09\u4ee3\u8868 python \u91cc\u7279\u6b8a\u65b9\u6cd5\u4e13\u7528\u7684\u6807\u8bc6\uff0c\u5982 __init__ \uff08\uff09\u4ee3\u8868\u7c7b\u7684\u6784\u9020\u51fd\u6570\u3002 # \u6a21\u5757\uff08 modules \uff09\uff1a \u6a21\u5757 ( module ) \u662f python \u6700\u9ad8\u7ea7\u522b\u7684\u7a0b\u5e8f\u7ec4\u7ec7\u5355\u4f4d\u3002\u5b83\u53ef\u4ee5\u6253\u5305\u7a0b\u5e8f\u4ee3\u7801\u548c\u6570\u636e\u4ee5\u5907\u91cd\u7528 \u6a21\u5757\u91c7\u7528 python \u7a0b\u5e8f\u7684\u6587\u4ef6\u5f62\u5f0f\uff08\u6216\u8005 C \u6269\u5c55\u7a0b\u5e8f\u7684\u5f62\u5f0f\uff09\u5b58\u50a8\uff0c\u5ba2\u6237\u5bfc\u5165\u6a21\u5757\u5e76\u5bf9\u4f7f\u7528\u4ed6\u4eec\u5b9a\u4e49\u7684\u540d\u5b57 ## \u6807\u51c6\u6a21\u5757 Python \u9644\u5e26\u4e00\u4e2a\u6807\u51c6\u6a21\u5757\u5e93\uff0c\u53d8\u91cf sys . ps1 \u548c sys . ps2 \u5b9a\u4e49\u7528\u4f5c\u4e3b\u8981\u548c\u8f85\u52a9\u63d0\u793a\u7684\u5b57\u7b26\u4e32\uff1b\u8fd9\u4e24\u4e2a\u53d8\u91cf\u53ea\u6709\u5728\u7f16\u8bd1\u5668\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u624d\u88ab\u5b9a\u4e49 sys . path \u53d8\u91cf\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868\uff0c\u7528\u4e8e\u786e\u5b9a\u89e3\u91ca\u5668\u7684\u6a21\u5757\u641c\u7d22\uff0c\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6\u5217\u8868\u64cd\u4f5c\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u3002 ## \u5305 ( packages ) \u5305\u662f\u4e00\u79cd\u901a\u8fc7\u7528 \" \u5e26\u70b9\u53f7\u7684\u6a21\u5757\u540d \" \u6765\u6784\u9020 Python \u6a21\u5757\u547d\u540d\u7a7a\u95f4\u7684\u5f62\u5f0f\u3002 \u8bf7\u6ce8\u610f\uff0c\u5f53\u4f7f\u7528 from package import item \u65f6\uff0c item \u53ef\u4ee5\u662f\u5305\u7684\u5b50\u6a21\u5757\uff08\u6216\u5b50\u5305\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u5305\u4e2d\u5b9a\u4e49\u7684\u5176\u4ed6\u540d\u79f0\uff0c\u5982\u51fd\u6570\uff0c\u7c7b\u6216\u53d8\u91cf import \u8bed\u53e5\u9996\u5148\u6d4b\u8bd5\u662f\u5426\u5728\u5305\u4e2d\u5b9a\u4e49\u4e86 item \uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5b83\u5047\u5b9a\u5b83\u662f\u4e00\u4e2a\u6a21\u5757\u5e76\u5c1d\u8bd5\u52a0\u8f7d\u5b83\u3002\u5982\u679c\u627e\u4e0d\u5230\u5b83\uff0c\u5219\u5f15\u53d1 ImportError \u5f02\u5e38 \u76f8\u53cd\uff0c\u5f53\u4f7f\u7528 import item . subitem . subsubitem \u8fd9\u6837\u7684\u8bed\u6cd5\u65f6\uff0c\u9664\u4e86\u6700\u540e\u4e00\u9879\u4e4b\u5916\u7684\u6bcf\u4e00\u9879\u90fd\u5fc5\u987b\u662f\u4e00\u4e2a\u5305\uff1b\u6700\u540e\u4e00\u9879\u53ef\u4ee5\u662f\u6a21\u5757\u6216\u5305 \u4f46\u4e0d\u80fd\u662f\u524d\u4e00\u9879\u4e2d\u5b9a\u4e49\u7684\u7c7b\u6216\u51fd\u6570\u6216\u53d8\u91cf * \u8981\u4f7f\u7528\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5b57\u9762\u503c\uff0c\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5f15\u53f7\u6216\u4e09\u5f15\u53f7\u4e4b\u524d\u52a0\u4e0a\u4e00\u4e2a f \u6216 F \uff0c\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\uff0c\u53ef\u4ee5\u5728{}\u5b57\u7b26\u4e4b\u95f4\u5f15\u7528\u53d8\u91cf\u6216\u5b57\u9762\u503c\u7684 Python \u8868\u8fbe\u5f0f * \u5b57\u7b26\u4e32\u7684 str . format () \u65b9\u6cd5 * \u4f7f\u7528\u5b57\u7b26\u4e32\u5207\u7247\u548c\u8fde\u63a5\u64cd\u4f5c\u81ea\u884c\u5b8c\u6210\u5bf9\u6240\u6709\u5b57\u7b26\u4e32\u7684\u5904\u7406 # import \u8bed\u53e5: \u51fa\u4e8e\u6548\u7387\u7684\u8003\u8651\uff0c\u6bcf\u4e2a\u6a21\u5757\u5728\u6bcf\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u53ea\u88ab\u5bfc\u5165\u4e00\u6b21\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u66f4\u6539\u4e86\u4f60\u7684\u6a21\u5757\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u542f\u52a8\u89e3\u91ca\u5668\uff0c \u6216\u8005\uff0c\u5982\u679c\u5b83\u53ea \u662f\u4e00\u4e2a\u8981\u4ea4\u4e92\u5f0f\u5730\u6d4b\u8bd5\u7684\u6a21\u5757\uff0c\u8bf7\u4f7f\u7528 importlib . reload () \uff0c\u4f8b\u5982 import importlib ; importlib.reload(modulename) \u6a21\u5757\u641c\u7d22\u8def\u5f84\uff1a\u89e3\u91ca\u5668\u9996\u5148\u5bfb\u627e\u5177\u6709\u8be5\u5bfc\u5165\u540d\u79f0\u7684\u5185\u7f6e\u6a21\u5757\uff0c\u82e5\u6ca1\u6709\u5219\u4f1a\u4ece sys . path \u53d8\u91cf\u6240\u7ed9\u51fa\u7684\u76ee\u5f55\u5217\u8868\u5bfb\u627e\uff0c\u652f\u6301\u7b26\u53f7\u94fe\u63a5\u7684\u6587\u4ef6\u7cfb \u7edf\u4e0a\uff0c\u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55\u662f\u5728\u8ffd\u52a0\u7b26\u53f7\u94fe\u63a5\u540e\u624d\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5305\u542b\u7b26\u53f7\u94fe\u63a5\u7684\u76ee\u5f55\u5e76\u6ca1\u6709\u88ab\u6dfb\u52a0\u5230\u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84\u4e0a sys . path \u7684\u521d\u59cb\u76ee\u5f55\u5730\u5740\uff1a * \u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55 ( \u6216\u8005\u672a\u6307\u5b9a\u6587\u4ef6\u65f6\u7684\u5f53\u671f\u76ee\u5f55 ) * PYTHONPATH ( \u4e00\u4e2a\u5305\u542b\u76ee\u5f55\u540d\u79f0\u7684\u5217\u8868\uff0c\u5176\u548c shell \u53d8\u91cf PATH \u5177\u6709\u76f8\u540c\u7684\u8bed\u6cd5 ) * \u53d6\u51b3\u4e8e Python \u5b89\u88c5\u7684\u9ed8\u8ba4\u8bbe\u7f6e \u4e86\u89e3\u4e86\u641c\u7d22\u8def\u5f84\u7684\u6982\u5ff5\uff0c\u5c31\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4fee\u6539 sys . path \u6765\u5f15\u5165\u4e00\u4e9b\u4e0d\u5728\u641c\u7d22\u8def\u5f84\u4e2d\u7684\u6a21\u5757 ** __name__ \u5c5e\u6027 ** \u4e00\u4e2a\u6a21\u5757\u88ab\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u7b2c\u4e00\u6b21\u5f15\u5165\u65f6\uff0c\u5176\u4e3b\u7a0b\u5e8f\u5c06\u8fd0\u884c\u3002\u5982\u679c\u6211\u4eec\u60f3\u5728\u6a21\u5757\u88ab\u5f15\u5165\u65f6\uff0c\u6a21\u5757\u4e2d\u7684\u67d0\u4e00\u7a0b\u5e8f\u5757\u4e0d\u6267\u884c \u6211\u4eec\u53ef\u4ee5\u7528 __name__ \u5c5e\u6027\u6765\u4f7f\u8be5\u7a0b\u5e8f\u5757\u4ec5\u5728\u8be5\u6a21\u5757\u81ea\u8eab\u8fd0\u884c\u65f6\u6267\u884c if __name__ == ' __main__ ' : print ( ' \u7a0b\u5e8f\u81ea\u8eab\u5728\u8fd0\u884c ' ) else : print ( ' \u6211\u6765\u81ea\u53e6\u4e00\u6a21\u5757 ' ) \u6bcf\u4e2a\u6a21\u5757\u90fd\u6709\u4e00\u4e2a __name__ \u5c5e\u6027\uff0c\u5f53\u5176\u503c\u662f ' __main__ ' \u65f6\uff0c\u8868\u660e\u8be5\u6a21\u5757\u81ea\u8eab\u5728\u8fd0\u884c\uff0c\u5426\u5219\u662f\u88ab\u5f15\u5165 \u53ef\u4ee5\u5728 Python \u547d\u4ee4\u4e2d\u4f7f\u7528 - O \u6216 - OO \u5f00\u5173,\u4ee5\u51cf\u5c0f\u7f16\u8bd1\u540e\u6a21\u5757\u7684\u5927\u5c0f\u3002 - O \u5f00\u5173\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\uff0c - OO \u5f00\u5173\u540c\u65f6\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\u548c __doc__ \u5b57\u7b26\u4e32\uff1b \u4e00\u4e2a\u4ece. pyc \u6587\u4ef6\u8bfb\u51fa\u7684\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u6bd4\u5b83\u4ece. py \u8bfb\u51fa\u65f6\u8fd0\u884c\u7684\u66f4\u5feb\u3002\u533a\u522b\u5728\u4e8e. pyc \u6587\u4ef6\u8f7d\u5165\u901f\u5ea6\u66f4\u5feb compileall \u6a21\u5757\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6a21\u5757\u521b\u5efa. pyc \u6587\u4ef6 # \u5bfc\u5165\u6a21\u5757 import math # \u4ece\u4e00\u4e2a\u6a21\u5757\u5bfc\u5165\u7279\u5b9a\u7684\u51fd\u6570 ceil , floor from math import ceil , floor # \u5bfc\u5165\u5e76\u7b80\u5316\u4e00\u4e2a\u6a21\u5757\u7684\u540d\u79f0 import math as m","title":"Python\u76f8\u5173\u8bf4\u660e"},{"location":"Python3/#python_1","text":"# \u8bbe\u7f6epip\u914d\u7f6e\u6587\u4ef6 : << comment Linux\uff1a$HOME/.pip/pip.conf Windows\uff1a%APPDATA%\\pip\\pip.ini virtualenv\uff1a%VIRTUAL_ENV%\\pip.ini \u5168\u5c40\u751f\u6548\u8bbe\u7f6e\u5982\u4e0b\uff1a(\u4e0d\u652f\u6301Windows Vista) Linux\uff1a/etc/pip.conf Windows XP\uff1aC:\\Documents and Settings\\All Users\\Application Data\\pip\\pip.ini Windows7\u6216\u4e4b\u540e\u7248\u672c\uff1aC:\\ProgramData\\pip\\pip.ini comment # pip\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a [ global ] timeout = 120 no-cache-dir = true index-url = https://mirrors.aliyun.com/pypi/simple/ extra-index-url = https://mirrors.huaweicloud.com/repository/pypi/simple [ freeze ] timeout = 10 [ install ] ignore-installed = true trusted-host = mirrors.aliyun.com mirrors.huaweicloud.com python -m SimpleHTTPServer | Serve current directory tree at http:// $HOSTNAME :8000/ # \u5229\u7528python\u7b80\u5355\u5efa\u7acbwebserver # yum -y install epel-release # yum -y install python2-pip # yum -y install python3-pip python -m pip install -U pip setuptools # python -m site --user-base \u627e\u5230 \u7528\u6237\u57fa\u7840\u76ee\u5f55,\u5c06\u57fa\u7840\u76ee\u5f55\u6dfb\u52a0\u5230PATH # \u5728 Windows \u4e0a\uff0c\u60a8\u901a\u8fc7\u8fd0\u884c py -m site --user-site \u627e\u5230\u7528\u6237\u57fa\u7840\u76ee\u5f55\uff0c\u5c06 site-packages \u66ff\u6362\u4e3a Scripts # \u81ea\u5b9a\u4e49pipenv\u865a\u62df\u73af\u5883\u521b\u5efa\u76ee\u5f55\uff0cwindows\u901a\u8fc7\u8bbe\u7f6e\u53d8\u91cfWORKON_HOME\uff0c\u5176\u503c\u8bbe\u7f6e\u4e3aPIPENV_VENV_IN_PROJECT\u65f6\u8868\u793a\u5f53\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa # linux\u5728.bashrc\u6587\u4ef6\u6dfb\u52a0export PIPENV_VENV_IN_PROJECT=1\u6216export PIPENV_VENV_IN_PROJECT=\"enabled\" pip install --user pipenv # \u5728Windows\u5b89\u88c5virtualenv\u548cvirtualenvwrapper-win\u7528\u4e8e\u521b\u5efa\u591a\u4e2aPython\u7248\u672c\u5f00\u53d1\u73af\u5883\uff0cLinux\u4e2d\u6700\u597d\u4f7f\u7528pyenv\u4ee3\u66ff # \u5b89\u88c5pipenv\u548cautoenv\uff0c\u81ea\u52a8\u6fc0\u6d3b\u73af\u5883 # \u5728Linux\u4e0a: git clone git://github.com/kennethreitz/autoenv.git ~/.autoenv echo 'source ~/.autoenv/activate.sh' >> ~/.bashrc # pipes\uff1aPipenv\u865a\u62df\u73af\u5883\u5207\u6362\u5de5\u5177 # MacOs + Ubuntu: pip3 install pipenv-pipes --user # Windows: pip3 install pipenv-pipes pip3 install curses --find-links = https://github.com/gtalarico/curses-win/releases","title":"Python\u5f00\u53d1\u73af\u5883\u6700\u4f73\u5b9e\u8df5"},{"location":"Python3/#_1","text":"#!/usr/bin/python3 # -*- coding: UTF-8 -*- # Python\u4e2d\u5355\u884c\u6ce8\u91ca\u4ee5#\u5f00\u5934\uff0c\u591a\u884c\u6ce8\u91ca\u7528\u4e09\u4e2a\u5355\u5f15\u53f7\uff08```\uff09\u6216\u8005\u4e09\u4e2a\u53cc\u5f15\u53f7\uff08\"\"\"\uff09\u5c06\u6ce8\u91ca\u62ec\u8d77\u6765\u3002 # \u7279\u6b8a\u5b57\u7b26\u6bd4\u5982\\n\u5728\u5355\u53cc\u5f15\u53f7\u6709\u540c\u6837\u7684\u610f\u4e49\uff0c\u4e0d\u540c\u4e4b\u5904\u662f\u5728\u5355\u5f15\u53f7\u4e2d\u65e0\u9700\u8f6c\u4e49\u53cc\u5f15\u53f7\uff0c\u4e5f\u5c31\u662f\u8868\u793a\u5176\u5b9e\u9645\u610f\u4e49\u3002\u53cd\u4e4b\u4ea6\u7136 help ( len ) # \u5185\u5efalen()\u51fd\u6570\u5e2e\u52a9 help ( sys ) # sys\u6a21\u5757\u5e2e\u52a9,\u5fc5\u987b\u5148import sys help ( sys . exit ) # exit()\u51fd\u6570\u5728sys\u6a21\u5757\u7684\u5e2e\u52a9 help ( 'xyz' . split ) # \u5bf9\u4e8estring\u5bf9\u8c61splist()\u65b9\u6cd5\u7684\u5e2e\u52a9\uff0c\u548chelp(str.split)\u4e00\u6837 help ( list ) # list\u5bf9\u8c61\u5e2e\u52a9 help ( list . append ) # list\u5bf9\u8c61append()\u65b9\u6cd5\u5e2e\u52a9 dir ( list ) # \u663e\u793alist\u5bf9\u8c61\u5c5e\u6027\uff0c\u5305\u62ec\u5176\u65b9\u6cd5 dir ( sys ) # \u7c7b\u4f3chelp() python\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u6709\u56db\u79cd \uff1a \u6574\u6570int \u3001 \u957f\u6574\u6570 \u3001 \u6d6e\u70b9\u6570float \u3001 \u590d\u6570complex python\u4e2d\u53d8\u91cf\u65e0\u9700\u58f0\u660e \uff0c \u6bcf\u4e2a\u53d8\u91cf\u5728\u4f7f\u7528\u524d\u5fc5\u987b\u8d4b\u503c \uff0c \u53d8\u91cf\u8d4b\u503c\u540e\u8be5\u53d8\u91cf\u624d\u4f1a\u88ab\u521b\u5efa \u3002 \u53d8\u91cf\u6ca1\u6709\u7c7b\u578b \uff0c \u800c\u901a\u5e38\u6240\u8bf4\u7684 \u201c \u7c7b\u578b \u201d \u6307\u5185\u5b58\u4e2d\u5bf9\u8c61\u7684\u7c7b\u578b python3\u4e2d\u5e38\u7528\u7684\u5185\u7f6e\u6570\u636e\u7c7b\u578b \uff1a * Boolean ( \u5e03\u5c14\u503c ) * Numbers ( \u6570\u5b57 ) * String ( \u5b57\u7b26\u4e32 ) * Bytes ( \u5b57\u8282 ) * List ( \u5217\u8868 ) * \u793a\u4f8b \uff1a list1 = [ 'Google' , 'aws' , 1997 , 2000 ] * \u7a7a\u5217\u8868 : list2 = [] * Tuple ( \u5143\u7ec4 ) * \u793a\u4f8b \uff1a tuple1 = ( 'Google' , 'aws' , 1997 , 2000 ) * \u7a7a\u5143\u7ec4 : tuple2 = () ======>> \u7b49\u4ef7\u4e8etuple1 = tuple () * Sets ( \u96c6\u5408 ) * \u793a\u4f8b \uff1a set1 = { 'apple' , 234 , 'apple' , 'banana' } * \u7a7a\u96c6\u5408 \uff1a set2 = set () * Dictionaries ( \u5b57\u5178 ) * \u793a\u4f8b \uff1a dict1 = { 'Alice' : '21' , 'Beth' : '12' , 'Cecil' : '19' } * \u7a7a\u5b57\u5178 : dict1 = {} python\u53ef\u53d8\u6570\u636e\u7c7b\u578b \uff1a list \u3001 dict python\u4e0d\u53ef\u53d8\u6570\u636e\u7c7b\u578b \uff1a int \u3001 str \u3001 tuple","title":"\u7b80\u4ecb"},{"location":"Python3/#_2","text":"python\u5185\u7f6e\u51fd\u6570\u5217\u8868\uff1a\u5177\u4f53\u7528\u6cd5\u89c1help(\u51fd\u6570) \u5185\u7f6e\u51fd\u6570 abs() delattr() hash() memoryview() set() all() dict() help() min() setattr() any() dir() hex() next() slice() ascii() divmod() id() object() sorted() bin() enumerate() input() oct() staticmethod() bool() eval() int() open() str() breakpoint() exec() isinstance() ord() sum() bytearray() filter() issubclass() pow() super() bytes() float() iter() print() tuple() callable() format() len() property() type() chr() frozenset() list() range() vars() classmethod() getattr() locals() repr() zip() compile() globals() map() reversed() __import__() complex() hasattr() max() round()","title":"\u5185\u7f6e\u6807\u51c6\u5e93"},{"location":"Python3/#_3","text":"\u5c11\u6570\u7684\u5e38\u91cf\u5b58\u5728\u4e8e\u5185\u7f6e\u547d\u540d\u7a7a\u95f4\u4e2d\uff1a","title":"\u5185\u7f6e\u5e38\u91cf"},{"location":"Python3/#_4","text":"","title":"\u5185\u7f6e\u7c7b\u578b"},{"location":"Python3/#_5","text":"\u4e0b\u9762\u57fa\u672c\u5b8c\u6574\u7f57\u5217\u51fa\u4f1a\u88ab\u89c6\u4e3a\u5047\u503c\u7684\u5185\u7f6e\u5bf9\u8c61\uff1a * \u88ab\u5b9a\u4e49\u4e3a\u5047\u503c\u7684\u5e38\u91cf: None \u548c False * \u4efb\u4f55\u6570\u503c\u7c7b\u578b\u7684\u96f6: 0, 0.0, 0j, Decimal(0), Fraction(0, 1) * \u7a7a\u7684\u5e8f\u5217\u548c\u591a\u9879\u96c6: '', (), [], {}, set(), range(0)","title":"\u903b\u8f91\u503c\u68c0\u6d4b\uff1a\u4efb\u4f55\u5bf9\u8c61\u90fd\u53ef\u4ee5\u8fdb\u884c\u903b\u8f91\u503c\u68c0\u6d4b"},{"location":"Python3/#andornot","text":"\u8fd0\u7b97 \u7ed3\u679c \u6ce8\u91ca x or y if x is false, then y, else x \u8fd9\u662f\u4e2a\u77ed\u8def\u8fd0\u7b97\u7b26\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u771f\u503c\u65f6\u624d\u4f1a\u5bf9\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6c42\u503c x and y if x is false, then x, else y not \u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64 not a == b \u4f1a\u88ab\u89e3\u8bfb\u4e3a not (a == b) \u800c a == not b \u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef not x if x is false, then True, else False not \u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64 not a == b \u4f1a\u88ab\u89e3\u8bfb\u4e3a not (a == b) \u800c a == not b \u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef","title":"\u5e03\u5c14\u7c7b\u578b\u8fd0\u7b97\uff1aand\u3001or\u3001not"},{"location":"Python3/#_6","text":"\u516b\u79cd\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u4f18\u5148\u7ea7\u76f8\u540c(\u6bd4\u5e03\u5c14\u8fd0\u7b97\u4f18\u5148\u7ea7\u9ad8)\u3002\u6bd4\u8f83\u8fd0\u7b97\u53ef\u4ee5\u4efb\u610f\u4e32\u8fde\u3002is\u548cis not\u8fd0\u7b97\u7b26\u65e0\u6cd5\u81ea\u5b9a\u4e49\u5e76\u4e14\u53ef\u4ee5\u88ab\u5e94\u7528\u4e8e\u4efb\u610f\u4e24\u4e2a \u5bf9\u8c61\u800c\u4e0d\u4f1a\u5f15\u53d1\u5f02\u5e38\uff1b\u8fd8\u6709\u4e24\u79cd\u5177\u6709\u76f8\u540c\u8bed\u6cd5\u4f18\u5148\u7ea7\u7684\u8fd0\u7b97in\u548cnot in\uff0c\u5b83\u4eec\u88abiterable\u6216\u5b9e\u73b0\u4e86__contains__()\u65b9\u6cd5\u7684\u7c7b\u578b\u6240\u652f\u6301 \u8fd0\u7b97\u7b26 \u542b\u4e49 < \u5c0f\u4e8e <= \u5c0f\u4e8e\u6216\u7b49\u4e8e > \u5927\u4e8e >= \u5927\u4e8e\u6216\u7b49\u4e8e == \u7b49\u4e8e != \u4e0d\u7b49\u4e8e is \u5bf9\u8c61\u6807\u8bc6 is not \u5426\u5b9a\u5bf9\u8c61\u6807\u8bc6","title":"\u6bd4\u8f83\u8fd0\u7b97\uff1a"},{"location":"Python3/#intfloatcomplex","text":"Python\u6709\u4e09\u79cd\u4e0d\u540c\u7684\u6570\u5b57\u7c7b\u578b\uff1a\u6574\u6570\u3001\u6d6e\u70b9\u6570\u548c\u590d\u6570\u3002\u5e03\u5c14\u503c\u5c5e\u4e8e\u6574\u6570\u7684\u5b50\u7c7b\u578b\u3002\u6574\u6570\u6709\u65e0\u9650\u7cbe\u5ea6\uff0c\u6d6e\u70b9\u6570\u901a\u5e38\u4ee5C\u8bed\u8a00\u4e2ddouble\u5b9e\u73b0 \u590d\u6570\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\uff0c\u6bcf\u4e2a\u90fd\u662f\u6d6e\u70b9\u6570 \u6570\u5b57\u662f\u7531\u6570\u5b57\u5b57\u9762\u503c\u6216\u5185\u7f6e\u51fd\u6570\u4e0e\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u6765\u521b\u5efa\u3002\u672a\u4fee\u9970\u7684\u6574\u6570\u5b57\u9762\u503c(\u5305\u62ec\u5341\u516d\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u548c\u4e8c\u8fdb\u5236\u6570)\u4f1a\u751f\u6210\u6574\u6570\uff0c\u5305\u542b\u5c0f\u6570\u70b9\u6216\u5e42\u8fd0\u7b97\u7b26\u7684 \u6570\u5b57\u5b57\u9762\u503c\u4f1a\u751f\u6210\u6d6e\u70b9\u6570\uff0c\u5728\u6570\u5b57\u5b57\u9762\u503c\u672b\u5c3e\u52a0\u4e0a 'j' \u6216 'J' \u4f1a\u751f\u6210\u865a\u6570(\u5b9e\u90e8\u4e3a\u96f6\u7684\u590d\u6570)\u5c06\u5176\u4e0e\u6574\u6570\u6216\u6d6e\u70b9\u6570\u76f8\u52a0\u6765\u5f97\u5230\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\u7684\u590d\u6570","title":"\u6570\u5b57\u7c7b\u578b\u8fd0\u7b97\uff1aint\u3001float\u3001complex"},{"location":"Python3/#numbers","text":"python3\u652f\u6301int ( \u6574\u6570 ) \u3001 float ( \u6d6e\u70b9 ) \u3001 bool ( \u5e03\u5c14 ) \u3001 complex ( \u590d\u6570 ) \u6ce8\u610f\uff1a python\u53ef\u4ee5\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8d4b\u503c \uff0c\u5982\uff1a a , b = 1 , 2 \u4e00\u4e2a\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8d4b\u503c\u6307\u5411\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61 \u6570\u503c\u7684\u9664\u6cd5\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6d6e\u70b9\u6570\uff0c\u8981\u83b7\u53d6\u6574\u6570\u4f7f\u7528 // \u64cd\u4f5c\u7b26 \u5728\u6df7\u5408\u8ba1\u7b97\u65f6\uff0c Python\u4f1a\u628a\u6574\u6570\u7c7b\u578b\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 \u6240\u6709\u6570\u5b57\u7c7b\u578b\uff08\u590d\u6570\u9664\u5916\uff09\u90fd\u652f\u6301\u4e0b\u5217\u8fd0\u7b97\uff0c\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f(\u6240\u6709\u6570\u5b57\u8fd0\u7b97\u7684\u4f18\u5148\u7ea7\u90fd\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97) \u5411\u4e0a\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u524d\u9762\u7684\u6574\u6570\u5c31\u52a01 \u5411\u4e0b\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u5ffd\u7565\u5c0f\u6570 \u8fd0\u7b97\u7b26 \u63cf\u8ff0 \u6ce8\u91ca + \u52a0 - \u51cf * \u4e58 / \u9664 // \u53d6\u6574\u6570--\u8fd4\u56de\u5546\u7684\u6574\u6570\u90e8\u5206(\u5411\u4e0b\u53d6\u6574) \u7ed3\u679c\u662f\u4e2a\u6574\u6570\uff0c\u4f46\u7c7b\u578b\u4e0d\u4e00\u5b9a\u662fint\uff0c\u8fd0\u7b97\u7ed3\u679c\u603b\u662f\u5411\u8d1f\u65e0\u7a77\u65b9\u5411\u820d\u5165\u3002\u5982\uff1a1//2\u4e3a0\uff0c(-1)//2\u4e3a-1 % \u53d6\u6a21--\u8fd4\u56de\u9664\u6cd5\u7684\u4f59\u6570 \u4e0d\u53ef\u7528\u4e8e\u590d\u6570\uff0c\u800c\u5e94\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\u4f7f\u7528abs()\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 -x x \u53d6\u53cd +x x \u4e0d\u53d8 abs(x) x \u7684\u7edd\u5bf9\u503c\u6216\u5927\u5c0f int(x) \u5c06 x \u8f6c\u6362\u4e3a\u6574\u6570 float(x) \u5c06 x \u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 complex(re, im) \u4e00\u4e2a\u5e26\u6709\u5b9e\u90e8 re \u548c\u865a\u90e8 im \u7684\u590d\u6570\u3002im \u9ed8\u8ba4\u4e3a0 c.conjugate() \u590d\u6570 c \u7684\u7ed3\u5408(\u5171\u8f6d) divmod(x, y) (x // y, x % y) \u4e0d\u53ef\u7528\u4e8e\u590d\u6570 pow(x, y) x \u7684 y \u6b21\u5e42 Python\u5c06pow(0, 0)\u548c0**0\u5b9a\u4e49\u4e3a1\uff0c\u8fd9\u662f\u7f16\u7a0b\u8bed\u8a00\u666e\u904d\u505a\u6cd5 ** \u5e42 \u6240\u6709\u7684numbers.Real\u7c7b\u578b(int\u548cfloat)\u8fd8\u5305\u62ec\u4ee5\u4e0b\u8fd0\u7b97(\u66f4\u591a\u6570\u5b57\u8fd0\u7b97\u53c2\u8003math\u548ccmath\u6a21\u5757): \u8fd0\u7b97\u7b26 \u7ed3\u679c math.trunc(x) x \u622a\u65ad\u4e3aIntegral round(x[, n]) x \u820d\u5165\u5230n\u4f4d\u5c0f\u6570\uff0c\u534a\u6570\u503c\u4f1a\u820d\u5165\u5230\u5076\u6570\uff0c\u5982\u679c\u7701\u7565n\uff0c\u5219\u9ed8\u8ba4\u4e3a0 math.floor(x) <= x \u7684\u6700\u5927 Integral math.ceil(x) >= x \u7684\u6700\u5c0f Integral","title":"Numbers(\u6570\u5b57)"},{"location":"Python3/#_7","text":"\u6309\u4f4d\u8fd0\u7b97\u53ea\u5bf9\u6574\u6570\u6709\u610f\u4e49\uff0c\u6309\u4f4d\u8fd0\u7b97\u7b26\u662f\u628a\u6570\u5b57\u770b\u4f5c\u4e8c\u8fdb\u5236\u6765\u8fdb\u884c\u8ba1\u7b97\u7684\u3002\u4e8c\u8fdb\u5236\u6309\u4f4d\u8fd0\u7b97\u4f18\u5148\u7ea7\u5168\u90fd\u4f4e\u4e8e\u6570\u5b57\u8fd0\u7b97\uff0c\u4f46\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97 \u4e00\u5143\u8fd0\u7b97 ~ \u548c\u5176\u4ed6\u4e00\u5143\u7b97\u672f\u8fd0\u7b97 + \u548c - \u5177\u6709\u76f8\u540c\u7684\u4f18\u5148\u7ea7\u3002 \u4ee5\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f\u7684\u6309\u4f4d\u8fd0\u7b97\u5217\u8868\uff1a \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca | \u6309\u4f4d\u6216\u8fd0\u7b97\u7b26\uff1a\u53ea\u8981\u5bf9\u5e94\u7684\u4e8c\u4e2a\u4e8c\u8fdb\u4f4d\u6709\u4e00\u4e2a\u4e3a1\u65f6\uff0c\u7ed3\u679c\u4f4d\u5c31\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6 \u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c ^ \u6309\u4f4d\u5f02\u6216\u8fd0\u7b97\u7b26\uff1a\u5f53\u4e24\u5bf9\u5e94\u7684\u4e8c\u8fdb\u4f4d\u76f8\u5f02\u65f6\uff0c\u7ed3\u679c\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c & \u6309\u4f4d\u4e0e\u8fd0\u7b97\u7b26\uff1a\u53c2\u4e0e\u8fd0\u7b97\u7684\u4e24\u4e2a\u503c,\u5982\u679c\u4e24\u4e2a\u76f8\u5e94\u4f4d\u90fd\u4e3a1,\u5219\u8be5\u4f4d\u7684\u7ed3\u679c\u4e3a1,\u5426\u5219\u4e3a0 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801 \u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c x << n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u5de6\u79fbn\u4f4d\uff0c\u9ad8\u4f4d\u4e22\u5f03\uff0c\u4f4e\u4f4d\u88650 \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\u4f1a\u5bfc\u81f4\u5f15\u53d1ValueError,\u5de6\u79fbn\u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u4e58\u4ee5pow(2, n) x >> n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u53f3\u79fbn\u4f4d \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\uff0c\u4f1a\u5bfc\u81f4\u5f15\u53d1 ValueError\uff1b\u53f3\u79fb n \u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u5730\u9664\u4ee5 pow(2, n) ~x x \u9010\u4f4d\u53d6\u53cd","title":"\u6574\u6570\u7c7b\u578b\u7684\u6309\u4f4d\u8fd0\u7b97"},{"location":"Python3/#_8","text":"Python\u652f\u6301\u8fed\u4ee3\u5bb9\u5668\u7684\u6982\u5ff5\u3002\u8fd9\u662f\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u5b9e\u73b0\u7684; \u8fd9\u4e9b\u7528\u4e8e\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u652f\u6301\u8fed\u4ee3","title":"\u8fed\u4ee3\u5668\u7c7b\u578b"},{"location":"Python3/#_9","text":"Python\u7684\u751f\u6210\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fed\u4ee3\u5668\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u5bb9\u5668\u5bf9\u8c61\u7684__iter__()\u65b9\u6cd5\u88ab\u5b9e\u73b0\u4e3a\u751f\u6210\u5668\uff0c\u5b83\u5c06\u81ea\u52a8\u8fd4\u56de\u63d0\u4f9b__iter__() \u548c__next__()\u65b9\u6cd5\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff08\u6280\u672f\u4e0a\uff0c\u751f\u6210\u5668\u5bf9\u8c61\uff09","title":"\u751f\u6210\u5668\u7c7b\u578b"},{"location":"Python3/#-listtuplerange","text":"\u901a\u7528\u5e8f\u5217\u7c7b\u578b\u64cd\u4f5c\uff1a\u5927\u591a\u6570\u5e8f\u5217\u7c7b\u578b\u5305\u62ec\u53ef\u53d8\u7c7b\u578b\u548c\u4e0d\u53ef\u53d8\u7c7b\u578b\u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u64cd\u4f5c\uff0ccollections.abc.Sequence ABC \u7528\u6765\u66f4\u5bb9\u6613\u7684\u5728\u81ea\u5b9a \u4e49\u5e8f\u5217\u7c7b\u578b\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u3002\u6b64\u8868\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u7f57\u5217\u5e8f\u5217\u64cd\u4f5c\uff0c\u8868\u683c\u4e2d\uff0cs \u548c t \u662f\u5177\u6709\u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\uff0cn, i, j \u548c k \u662f\u6574\u6570\u800c x \u662f \u4efb\u4f55\u6ee1\u8db3 s \u6240\u89c4\u5b9a\u7684\u7c7b\u578b\u548c\u503c\u9650\u5236\u7684\u4efb\u610f\u5bf9\u8c61 \u4efb\u4f55\u7684\u5e8f\u5217(\u6216\u8005\u53ef\u8fed\u4ee3\u5bf9\u8c61)\u90fd\u53ef\u901a\u8fc7\u4e00\u4e2a\u8d4b\u503c\u8bed\u53e5\u89e3\u538b\u5e76\u8d4b\u503c\u7ed9\u591a\u4e2a\u53d8\u91cf\uff0c\u552f\u4e00\u7684\u524d\u63d0\u5c31\u662f\u53d8\u91cf\u7684\u6570\u91cf\u5fc5\u987b\u4e0e\u5e8f\u5217\u5143\u7d20\u6570\u76f8\u540c \u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\u4e5f\u652f\u6301\u6bd4\u8f83\u3002 \u7279\u522b\u5730\uff0ctuple \u548c list \u7684\u6bd4\u8f83\u662f\u901a\u8fc7\u6bd4\u8f83\u5bf9\u5e94\u5143\u7d20\u7684\u5b57\u5178\u987a\u5e8f\u3002 \u8fd9\u610f\u5473\u7740\u60f3\u8981\u6bd4\u8f83\u7ed3\u679c\u76f8\u7b49\uff0c\u5219\u6bcf\u4e2a\u5143 \u7d20\u6bd4\u8f83\u7ed3\u679c\u90fd\u5fc5\u987b\u76f8\u7b49\uff0c\u5e76\u4e14\u4e24\u4e2a\u5e8f\u5217\u957f\u5ea6\u5fc5\u987b\u76f8\u540c \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca x in s \u5982\u679c s \u4e2d\u7684\u67d0\u9879\u7b49\u4e8e x \u5219\u7ed3\u679c\u4e3a True\uff0c\u5426\u5219\u4e3a False 1 x not in s \u5982\u679c s \u4e2d\u7684\u67d0\u9879\u7b49\u4e8e x \u5219\u7ed3\u679c\u4e3a False\uff0c\u5426\u5219\u4e3a True 1 s + t s \u4e0e t \u76f8\u62fc\u63a5 67 s * n \u6216 n * s \u76f8\u5f53\u4e8e s \u4e0e\u81ea\u8eab\u8fdb\u884c n \u6b21\u62fc\u63a5 27 s[i] s \u7684\u7b2c i \u9879\uff0c\u8d77\u59cb\u4e3a 0 3 s[i:j] s \u4ece i \u5230 j \u7684\u5207\u7247 34 s[i:j:k] s \u4ece i \u5230 j \u6b65\u957f\u4e3a k \u7684\u5207\u7247 35 len(s) s \u7684\u957f\u5ea6 min(s) s \u7684\u6700\u5c0f\u9879 max(s) s \u7684\u6700\u5927\u9879 s.index(x[, i[, j]]) x \u5728 s \u4e2d\u9996\u6b21\u51fa\u73b0\u9879\u7684\u7d22\u5f15\u53f7\uff08\u7d22\u5f15\u53f7\u5728 i \u6216\u5176\u540e\u4e14\u5728 j \u4e4b\u524d\uff09 8 s.count(x) x \u5728 s \u4e2d\u51fa\u73b0\u7684\u603b\u6b21\u6570 \u6ce8\u91ca: \u867d\u7136 in \u548c not in \u64cd\u4f5c\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\u4ec5\u88ab\u7528\u4e8e\u7b80\u5355\u7684\u6210\u5458\u68c0\u6d4b\uff0c\u67d0\u4e9b\u4e13\u95e8\u5316\u5e8f\u5217 (\u4f8b\u5982 str, bytes \u548c bytearray) \u4e5f\u4f7f\u7528\u5b83\u4eec\u8fdb\u884c\u5b50\u5e8f\u5217\u68c0\u6d4b \u5c0f\u4e8e 0 \u7684 n \u503c\u4f1a\u88ab\u5f53\u4f5c 0 \u6765\u5904\u7406 (\u751f\u6210\u4e00\u4e2a\u4e0e s \u540c\u7c7b\u578b\u7684\u7a7a\u5e8f\u5217)\u3002 \u8bf7\u6ce8\u610f\u5e8f\u5217 s \u4e2d\u7684\u9879\u5e76\u4e0d\u4f1a\u88ab\u62f7\u8d1d\uff1b\u5b83\u4eec\u4f1a\u88ab\u591a\u6b21\u5f15\u7528 \u5982\u679c i \u6216 j \u4e3a\u8d1f\u503c\uff0c\u5219\u7d22\u5f15\u987a\u5e8f\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217 s \u7684\u672b\u5c3e: \u7d22\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u4e3a len(s) + i \u6216 len(s) + j\u3002 \u4f46\u8981\u6ce8\u610f -0 \u4ecd\u7136\u4e3a 0 s \u4ece i \u5230 j \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 i <= k < j \u7684\u7d22\u5f15\u53f7 k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u5982\u679c i \u6216 j \u5927\u4e8e len(s)\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u88ab\u7701\u7565 \u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 0\u3002 \u5982\u679c j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u5927\u4e8e\u7b49\u4e8e j\uff0c\u5219\u5207\u7247\u4e3a\u7a7a s \u4ece i \u5230 j \u6b65\u957f\u4e3a k \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 0 <= n < (j-i)/k \u7684\u7d22\u5f15\u53f7 x = i + n*k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u7d22\u5f15\u53f7\u4e3a i, i+k, i+2*k, i+3*k\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5f53\u8fbe\u5230 j \u65f6\u505c\u6b62 (\u4f46\u4e00\u5b9a\u4e0d\u5305\u62ec j)\u3002 \u5f53 k \u4e3a\u6b63\u503c\u65f6\uff0ci \u548c j \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s)\u3002 \u5f53 k \u4e3a\u8d1f\u503c\u65f6\uff0ci \u548c j \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s) - 1\u3002 \u5982\u679c i \u6216 j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5b83\u4eec\u4f1a\u6210\u4e3a\u201c\u7ec8\u6b62\u201d\u503c (\u662f\u54ea\u4e00\u7aef\u7684\u7ec8\u6b62\u503c\u5219\u53d6\u51b3\u4e8e k \u7684\u7b26\u53f7)\u3002 \u8bf7\u6ce8\u610f\uff0ck \u4e0d\u53ef \u4e3a\u96f6\u3002 \u5982\u679c k \u4e3a None\uff0c\u5219\u5f53\u4f5c 1 \u5904\u7406 \u62fc\u63a5\u4e0d\u53ef\u53d8\u5e8f\u5217\u603b\u662f\u4f1a\u751f\u6210\u65b0\u7684\u5bf9\u8c61\u3002 \u8fd9\u610f\u5473\u7740\u901a\u8fc7\u91cd\u590d\u62fc\u63a5\u6765\u6784\u5efa\u5e8f\u5217\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u5c06\u4f1a\u57fa\u4e8e\u5e8f\u5217\u603b\u957f\u5ea6\u7684\u4e58\u65b9\u3002 \u60f3\u8981\u83b7\u5f97\u7ebf\u6027\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u5fc5\u987b \u6539\u7528\u4e0b\u5217\u66ff\u4ee3\u65b9\u6848\u4e4b\u4e00\uff1a \u5982\u679c\u62fc\u63a5 str \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u5217\u8868\u5e76\u5728\u6700\u540e\u4f7f\u7528 str.join() \u6216\u662f\u5199\u5165\u4e00\u4e2a io.StringIO \u5b9e\u4f8b\u5e76\u5728\u7ed3\u675f\u65f6\u83b7\u53d6\u5b83\u7684\u503c \u5982\u679c\u62fc\u63a5 bytes \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u7c7b\u4f3c\u5730\u4f7f\u7528 bytes.join() \u6216 io.BytesIO\uff0c\u6216\u8005\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 bytearray \u5bf9\u8c61\u8fdb\u884c\u539f\u5730\u62fc\u63a5\u3002 bytearray \u5bf9\u8c61\u662f\u53ef\u53d8\u7684\uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u6548\u7684\u91cd\u5206\u914d\u673a\u5236 \u5982\u679c\u62fc\u63a5 tuple \u5bf9\u8c61\uff0c\u8bf7\u6539\u4e3a\u6269\u5c55 list \u7c7b \u5bf9\u4e8e\u5176\u5b83\u7c7b\u578b\uff0c\u8bf7\u67e5\u770b\u76f8\u5e94\u7684\u6587\u6863 \u67d0\u4e9b\u5e8f\u5217\u7c7b\u578b (\u4f8b\u5982 range) \u4ec5\u652f\u6301\u9075\u5faa\u7279\u5b9a\u6a21\u5f0f\u7684\u9879\u5e8f\u5217\uff0c\u56e0\u6b64\u5e76\u4e0d\u652f\u6301\u5e8f\u5217\u62fc\u63a5\u6216\u91cd\u590d \u5f53 x \u5728 s \u4e2d\u627e\u4e0d\u5230\u65f6 index \u4f1a\u5f15\u53d1 ValueError\u3002 \u4e0d\u662f\u6240\u6709\u5b9e\u73b0\u90fd\u652f\u6301\u4f20\u5165\u989d\u5916\u53c2\u6570 i \u548c j\u3002 \u8fd9\u4e24\u4e2a\u53c2\u6570\u5141\u8bb8\u9ad8\u6548\u5730\u641c\u7d22\u5e8f\u5217\u7684\u5b50\u5e8f\u5217\u3002 \u4f20\u5165\u8fd9\u4e24\u4e2a\u989d\u5916\u53c2\u6570\u5927\u81f4\u76f8\u5f53\u4e8e\u4f7f\u7528 s[i:j].index(x)\uff0c\u4f46\u662f\u4e0d\u4f1a\u590d\u5236\u4efb\u4f55\u6570\u636e\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u7d22\u5f15\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217\u7684\u5f00\u5934\u800c\u975e\u5207\u7247\u7684\u5f00\u5934","title":"\u5e8f\u5217\u7c7b\u578b -- list\u3001tuple\u3001range"},{"location":"Python3/#_10","text":"\u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u901a\u5e38\u5b9e\u73b0\u7684\u552f\u4e00\u64cd\u4f5c\u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u672a\u5b9e\u73b0\u5bf9hash()\u5185\u7f6e\u51fd\u6570\u7684\u652f\u6301\uff0c\u4f8b\u5982\uff1atuple\u5b9e\u4f8b\u88ab\u7528\u4f5cdict\u952e\u4ee5\u53ca\u5b58\u50a8\u5728set\u548cfrozenset\u5b9e\u4f8b\u4e2d","title":"\u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b"},{"location":"Python3/#_11","text":"\u4ee5\u4e0b\u64cd\u4f5c\u662f\u5728\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u5b9a\u4e49\uff0ccollections.abc.MutableSequence ABC\u88ab\u63d0\u4f9b\u7528\u6765\u66f4\u5bb9\u6613\u5728\u81ea\u5b9a\u4e49\u5e8f\u5217\u7c7b\u578b\u4e0a\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c \u8868\u683c\u4e2d\u7684 s \u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u7684\u5b9e\u4f8b\uff0ct \u662f\u4efb\u610f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u800c x \u662f\u7b26\u5408\u5bf9 s \u6240\u89c4\u5b9a\u7c7b\u578b\u4e0e\u503c\u9650\u5236\u7684\u4efb\u4f55\u5bf9\u8c61 (\u4f8b\u5982\uff0cbytearray \u4ec5\u63a5\u53d7\u6ee1\u8db3 0 <= x <= 255 \u503c\u9650\u5236\u7684\u6574\u6570) \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca s[i] = x \u5c06 s \u7684\u7b2c i \u9879\u66ff\u6362\u4e3a x s[i:j] = t \u5c06 s \u4ece i \u5230 j \u7684\u5207\u7247\u66ff\u6362\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61 t\u7684\u5185\u5bb9 del s[i:j] \u7b49\u540c\u4e8e s[i:j] = [] s[i:j:k] = t \u5c06 s[i:j:k] \u7684\u5143\u7d20\u66ff\u6362\u4e3a t \u7684\u5143\u7d20 t\u5fc5\u987b\u548c\u5b83\u6240\u66ff\u6362\u7684\u5207\u7247\u5177\u6709\u76f8\u540c\u957f\u5ea6 del s[i:j:k] \u4ece\u5217\u8868\u4e2d\u79fb\u9664 s[i:j:k] \u7684\u5143\u7d20 s.append(x) \u5c06 x \u6dfb\u52a0\u5230\u5e8f\u5217\u7684\u672b\u5c3e (\u7b49\u540c\u4e8e s[len(s):len(s)] = [x]) s.clear() \u4ece s \u4e2d\u79fb\u9664\u6240\u6709\u9879 (\u7b49\u540c\u4e8e del s[:]) clear()\u548ccopy()\u5747\u662f\u4e3a\u4e86\u4e0e\u4e0d\u652f\u6301\u5207\u7247\u64cd\u4f5c\u7684\u53ef\u53d8\u5bb9\u5668(\u5982:dict\u3001set)\u7684\u63a5\u53e3\u4fdd\u6301\u4e00\u81f4 s.copy() \u521b\u5efa s \u7684\u6d45\u62f7\u8d1d (\u7b49\u540c\u4e8e s[:]) \u540c\u4e0a s.extend(t) \u6216 s += t \u7528 t \u7684\u5185\u5bb9\u6269\u5c55 s (\u57fa\u672c\u4e0a\u7b49\u540c\u4e8e s[len(s):len(s)] = t) s *= n \u4f7f\u7528 s \u7684\u5185\u5bb9\u91cd\u590d n \u6b21\u6765\u5bf9\u5176\u8fdb\u884c\u66f4\u65b0 n\u503c\u4e3a\u4e00\u4e2a\u6574\u6570\u6216\u4e00\u4e2a\u5b9e\u73b0\u4e86__index__()\u7684\u5bf9\u8c61\uff0cn\u503c\u4e3a0\u6216\u8d1f\u6570\u5c06\u6e05\u7a7a\u5e8f\u5217\u3002\u5e8f\u5217\u4e2d\u7684\u9879\u4e0d\u80fd \u88ab\u62f7\u8d1d\uff0c\u4f1a\u88ab\u591a\u6b21\u5f15\u7528 s.insert(i, x) \u5728\u7531 i \u7ed9\u51fa\u7684\u7d22\u5f15\u4f4d\u7f6e\u5c06 x \u63d2\u5165 s (\u7b49\u540c\u4e8e s[i:i] = [x]) s.pop([i]) \u63d0\u53d6\u5728 i \u4f4d\u7f6e\u4e0a\u7684\u9879\uff0c\u5e76\u5c06\u5176\u4ece s \u4e2d\u79fb\u9664 \u53ef\u9009\u53c2\u6570\u9ed8\u8ba4\u4e3a-1\uff0c\u56e0\u6b64\u9ed8\u8ba4\u60c5\u51b5\u4f1a\u79fb\u9664\u5e76\u8fd4\u56de\u6700\u540e\u4e00\u9879 s.remove(x) \u5220\u9664 s \u4e2d\u7b2c\u4e00\u4e2a s[i] \u7b49\u4e8e x \u7684\u9879\u76ee\u3002 \u5f53s\u627e\u4e0d\u5230x\u65f6\uff0cremove\u64cd\u4f5c\u4f1a\u5f15\u53d1ValueError s.reverse() \u5c06\u5217\u8868\u4e2d\u7684\u5143\u7d20\u9006\u5e8f \u5f53\u53cd\u8f6c\u6bd4\u8f83\u5927\u7684\u5e8f\u5217\u65f6\uff0creverse()\u65b9\u6cd5\u4f1a\u539f\u5730\u4fee\u6539\u6b64\u5e8f\u5217\u6765\u4fdd\u8bc1\u7a7a\u95f4\u7ecf\u6d4e\u6027\uff0c\u4e3a\u63d0\u9192\u7528\u6237\u6b64\u64cd\u4f5c\u662f\u901a\u8fc7\u95f4\u63a5 \u5f71\u54cd\u8fdb\u884c\u7684\uff0c\u5b83\u5e76\u4e0d\u4f1a\u8fd4\u56de\u53cd\u8f6c\u540e\u7684\u5e8f\u5217","title":"\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b"},{"location":"Python3/#python_2","text":"\u4ee5\u4e0b\u8868\u683c\u5217\u51fa\u4e86\u4ece\u6700\u9ad8\u5230\u6700\u4f4e\u4f18\u5148\u7ea7\u7684\u6240\u6709\u8fd0\u7b97\u7b26\uff1a \u8fd0\u7b97\u7b26 \u63cf\u8ff0 ** \u6307\u6570 (\u6700\u9ad8\u4f18\u5148\u7ea7) ~ + - \u6309\u4f4d\u7ffb\u8f6c, \u4e00\u5143\u52a0\u53f7\u548c\u51cf\u53f7 (\u6700\u540e\u4e24\u4e2a\u7684\u65b9\u6cd5\u540d\u4e3a +@ \u548c -@) * / % // \u4e58\uff0c\u9664\uff0c\u53d6\u6a21\u548c\u53d6\u6574\u9664 + - \u52a0\u6cd5\u51cf\u6cd5 >> << \u53f3\u79fb\uff0c\u5de6\u79fb\u4f4d\u8fd0\u7b97\u7b26 & AND | ^ \u6216 \u5f02\u6216--\u4f4d\u8fd0\u7b97 <= < > >= \u6bd4\u8f83\u8fd0\u7b97\u7b26 <> == != \u7b49\u4e8e\u8fd0\u7b97\u7b26 = %= /= //= -= += = * = \u8d4b\u503c\u8fd0\u7b97\u7b26 is is not \u8eab\u4efd\u8fd0\u7b97\u7b26 in not in \u6210\u5458\u8fd0\u7b97\u7b26 not or and \u903b\u8f91\u8fd0\u7b97\u7b26","title":"Python\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7"},{"location":"Python3/#list","text":"\u5217\u8868list\u662fPython\u4e2d\u4f7f\u7528\u6700\u9891\u7e41\u7684\u6570\u636e\u7c7b\u578b;\u5217\u8868\u662f\u5199\u5728 [] \u65b9\u62ec\u53f7\u4e4b\u95f4\uff0c\u7528\u9017\u53f7\u9694\u5f00\u7684\u5143\u7d20\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5143\u7d20\u7684\u7c7b\u578b\u53ef\u4ee5\u4e0d\u540c\uff0c\u548c\u5b57\u7b26\u4e32 \u4e00\u6837\uff0c\u5217\u8868\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\u3002\u5217\u8868\u88ab\u5207\u7247\u540e\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u6240\u9700\u5143\u7d20\u7684\u65b0\u5217\u8868\uff0c\u5217\u8868\u8fd8\u652f\u6301\u4e32\u8054\u64cd\u4f5c\uff0c\u4f7f\u7528+\u7b26\u53f7\u3002 # \u6ce8\u610f\uff1a 1 \u3001 List\u5199\u5728\u65b9\u62ec\u53f7\u4e4b\u95f4 \uff0c\u5143\u7d20\u7528\u9017\u53f7\u9694\u5f00 , \u5217\u8868\u89e3\u6790\u53ef\u4ee5\u751f\u6210\u5e38\u89c4\u5217\u8868 2 \u3001\u548c\u5b57\u7b26\u4e32\u4e00\u6837\uff0c list\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247 3 \u3001 List\u53ef\u4ee5\u4f7f\u7528 + \u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5 4 \u3001 List\u4e2d\u7684\u5143\u7d20\u662f\u53ef\u4ee5\u6539\u53d8\u7684","title":"List(\u5217\u8868)"},{"location":"Python3/#_12","text":"\u4ee5\u4e0b\u65b9\u6cd5\u662f\u4f5c\u7528\u5728list\u5bf9\u8c61\u4e0a\u7684\u3002\u800clen()\u662f\u5c06list\u3001string\u6216\u5176\u4ed6\u7c7b\u578b\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570 | \u65b9\u6cd5 | \u63cf\u8ff0 | | :------: | :------: | | list.append(elem) | (elem\u8868\u793aelement)\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5217\u8868\u7684\u7ed3\u5c3e\uff0c\u76f8\u5f53\u4e8e a[len(a):] = [elem]| | list.insert(index, elem) | \u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u51c6\u5907\u63d2\u5165\u5230\u5176\u524d\u9762\u7684\u90a3\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f8b\u5982 a.insert(0, x) \u4f1a\u63d2\u5165\u5230\u6574\u4e2a\u5217\u8868\u4e4b\u524d\uff0c\u800c a.insert(len(a), x) \u76f8\u5f53\u4e8e a.append(x) | | list.extend(list2) | \u5728\u5217\u8868list2\u6700\u540e\u6dfb\u52a0\u5143\u7d20\uff0c\u76f8\u5f53\u4e8e a[len(a):] = list2;\u5728\u4e00\u4e2a\u5217\u8868\u4f7f\u7528+\u6216+=\u548cextend()\u7c7b\u4f3c;extend()\u65b9\u6cd5\u53ea\u63a5\u53d7\u4e00\u4e2a\u5217\u8868\u4f5c\u4e3a\u53c2\u6570 | | list.index(elem) | \u4ece\u5217\u8868\u7684\u5f00\u5934\u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u5e76\u8fd4\u56de\u5176\u7d22\u5f15\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u5143\u7d20\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef | | list.remove(elem) | \u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u7684\u7b2c\u4e00\u4e2a\u5b9e\u4f8b\u5e76\u5c06\u5176\u5220\u9664,\u5982\u679c\u4e0d\u5b58\u5728\u5219\u629b\u51faValueError | | list.sort() | \u5bf9\u5217\u8868\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u6c38\u4e45\u6392\u5e8f,\u4e0d\u8981\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c,\u540e\u9762\u4f7f\u7528sorted()\u51fd\u6570\u4e34\u65f6\u6392\u5e8f\u663e\u793a\u66f4\u597d | | list.reverse() | \u5012\u5e8f\u6392\u5217\u5217\u8868\u4e2d\u7684\u5143\u7d20 | | list.pop([i]) | \u4ece\u5217\u8868\u7684\u6307\u5b9a\u4f4d\u7f6e\u5220\u9664\u5143\u7d20\uff0c\u5e76\u5c06\u5176\u8fd4\u56de\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7d22\u5f15\uff0ca.pop()\u8fd4\u56de\u6700\u53f3\u8fb9\u4e00\u4e2a\u5143\u7d20,\u5e76\u8fd4\u56de\u6240\u5220\u9664\u7684\u503c\u3002\u65b9\u6cd5\u4e2d i \u4e24\u8fb9\u7684\u65b9\u62ec\u53f7\u8868\u793a\u8fd9\u4e2a\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u800c\u4e0d\u662f\u8981\u6c42\u4f60\u8f93\u5165\u4e00\u5bf9\u65b9\u62ec\u53f7\uff0c\u4f60\u4f1a\u7ecf\u5e38\u5728Python\u5e93\u53c2\u8003\u624b\u518c\u4e2d\u9047\u5230\u8fd9\u6837\u7684\u6807\u8bb0 | | list.clear() | \u79fb\u9664\u5217\u8868\u4e2d\u7684\u6240\u6709\u9879\uff0c\u7b49\u4e8edel a[:] | | list.count(x) | \u8fd4\u56de x \u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570 | | list.copy() | \u8fd4\u56de\u5217\u8868\u7684\u6d45\u590d\u5236\uff0c\u7b49\u4e8ea[:] |","title":"\u793a\u4f8b\u5217\u8868\u7684\u5927\u90e8\u5206\u65b9\u6cd5"},{"location":"Python3/#_13","text":"\u5217\u8868\u65b9\u6cd5\u4f7f\u5f97\u5217\u8868\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4f5c\u4e3a\u4e00\u4e2a\u5806\u6808\u6765\u4f7f\u7528\uff0c\u5806\u6808\u4f5c\u4e3a\u7279\u5b9a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6700\u540e\u4e00\u4e2a\u63d2\u5165\uff0c\u6700\u5148\u53d6\u51fa\uff08\u540e\u8fdb\u5148\u51fa\uff09\u3002\u7528 append() \u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5806\u6808\u9876\u3002\u7528\u4e0d\u6307\u5b9a\u7d22\u5f15\u7684 pop() \u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u4ece\u5806\u6808\u9876\u53d6\u51fa\u6765","title":"\u5c06\u5217\u8868\u5f53\u505a\u5806\u6808\u4f7f\u7528"},{"location":"Python3/#_14","text":"\u4e5f\u53ef\u4ee5\u628a\u5217\u8868\u5f53\u505a\u961f\u5217\u7528\uff0c\u5176\u4e2d\u5148\u6dfb\u52a0\u7684\u5143\u7d20\u88ab\u6700\u5148\u53d6\u51fa (\u201c\u5148\u8fdb\u5148\u51fa\u201d)\uff1b\u4f46\u662f\u5217\u8868\u7528\u4f5c\u8fd9\u6837\u7684\u76ee\u7684\u76f8\u5f53\u4f4e\u6548\u3002\u5728\u5217\u8868\u7684\u6700\u540e\u6dfb\u52a0\u6216\u8005 \u5f39\u51fa\u5143\u7d20\u901f\u5ea6\u5feb\uff0c\u7136\u800c\u5728\u5217\u8868\u91cc\u63d2\u5165\u6216\u8005\u4ece\u5934\u90e8\u5f39\u51fa\u901f\u5ea6\u5374\u5f88\u6162\uff08\u56e0\u4e3a\u6240\u6709\u5176\u4ed6\u7684\u5143\u7d20\u90fd\u5fc5\u987b\u79fb\u52a8\u4e00\u4f4d\uff09;\u8981\u5b9e\u73b0\u4e00\u4e2a\u961f\u5217\uff0ccollections. deque\u88ab\u8bbe\u8ba1\u7528\u4e8e\u5feb\u901f\u4ece\u4e24\u7aef\u64cd\u4f5c","title":"\u5c06\u5217\u8868\u5f53\u4f5c\u961f\u5217\u4f7f\u7528"},{"location":"Python3/#_15","text":"\u5217\u8868\u63a8\u5bfc\u5f0f\u63d0\u4f9b\u4e86\u4ece\u5e8f\u5217\u521b\u5efa\u5217\u8868\u7684\u7b80\u5355\u9014\u5f84\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u628a\u67d0\u79cd\u64cd\u4f5c\u5e94\u7528\u4e8e\u5e8f\u5217\u6216\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u6bcf\u4e2a\u5143\u7d20\u4e0a\uff0c\u7136\u540e\u4f7f\u7528\u5176\u7ed3\u679c\u6765\u521b\u5efa \u5217\u8868\uff0c\u6216\u8005\u901a\u8fc7\u6ee1\u8db3\u67d0\u4e9b\u7279\u5b9a\u6761\u4ef6\u5143\u7d20\u6765\u521b\u5efa\u5b50\u5e8f\u5217\u3002 \u6bcf\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f\u90fd\u5728 for \u4e4b\u540e\u8ddf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u7136\u540e\u6709\u96f6\u5230\u591a\u4e2a for \u6216 if \u5b50\u53e5\u3002\u8fd4\u56de\u7ed3\u679c\u662f\u4e00\u4e2a\u6839\u636e\u8868\u8fbe\u4ece\u5176\u540e\u7684 for \u548c if \u4e0a\u4e0b\u6587\u73af \u5883\u4e2d\u751f\u6210\u51fa\u6765\u7684\u5217\u8868\u3002\u5982\u679c\u5e0c\u671b\u8868\u8fbe\u5f0f\u63a8\u5bfc\u51fa\u4e00\u4e2a\u5143\u7ec4\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u62ec\u53f7\u3002","title":"\u5217\u8868\u63a8\u5bfc\u5f0f"},{"location":"Python3/#del","text":"\u5217\u8868\u63a8\u5bfc\u5f0f\u4e2d\u7684\u521d\u59cb\u8868\u8fbe\u5f0f\u53ef\u4ee5\u662f\u4efb\u4f55\u8868\u8fbe\u5f0f\uff0c\u5305\u62ec\u53e6\u4e00\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f\u3002 del\u8bed\u53e5 \uff1a\u4f7f\u7528del\u8bed\u53e5\u53ef\u4ee5\u4ece\u4e00\u4e2a\u5217\u8868\u4e2d\u4f9d\u7d22\u5f15\u800c\u4e0d\u662f\u503c\u6765\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u4e0e\u4f7f\u7528 pop() \u8fd4\u56de\u4e00\u4e2a\u503c\u4e0d\u540c\u3002\u53ef\u4ee5\u7528 del \u8bed\u53e5\u4ece\u5217\u8868 \u4e2d\u79fb\u9664\u5207\u7247\uff0c\u6216\u6e05\u7a7a\u6574\u4e2a\u5217\u8868\uff08\u6211\u4eec\u4ee5\u524d\u4ecb\u7ecd\u7684\u65b9\u6cd5\u662f\u7a7a\u5217\u8868\u8d4b\u503c\u7ed9\u4e00\u4e2a\u6307\u5b9a\u7684\u5207\u7247)\uff0cdel\u4e5f\u53ef\u4ee5\u7528\u6765\u5220\u9664\u6574\u4e2a\u53d8\u91cf","title":"\u5d4c\u5957\u5217\u8868\u63a8\u5bfc\u5f0f\u548cdel\u8bed\u53e5"},{"location":"Python3/#tuple","text":"\u5143\u7ec4\uff08tuple\uff09\u4e0e\u5217\u8868\u7c7b\u4f3c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539\u3002\u5143\u7ec4\u5199\u5728 () \u5c0f\u62ec\u53f7\u91cc\uff0c\u5143\u7d20\u4e4b\u95f4\u7528\u9017\u53f7\u9694\u5f00\u3002\u5143\u7ec4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u4e5f\u53ef \u4ee5\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u901a\u8fc7\u89e3\u5305\u6216\u7d22\u5f15\u6765\u8bbf\u95ee\uff0c\u800c\u5217\u8868\u901a\u8fc7\u8fed\u4ee3\u8bbf\u95ee \u5143\u7ec4\u662f\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7ed9\u5143\u7956\u7684\u5355\u72ec\u4e00\u4e2a\u5143\u7d20\u8d4b\u503c\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u7a7a\u5143\u7956\u7531\u4e00\u5bf9\u7a7a\u5706\u62ec\u53f7\u521b\u5efa\uff0c\u542b\u6709\u4e00\u4e2a\u5143\u7d20\u7684\u5143\u7956\u53ef\u4ee5\u901a\u8fc7\u518d\u6b64\u5143\u7956\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\u9017\u53f7\u521b\u5efa # \u5143\u7ec4\u4e0e\u5b57\u7b26\u4e32\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u88ab\u7d22\u5f15\u4e14\u4e0b\u6807\u7d22\u5f15\u4ece 0 \u5f00\u59cb\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u622a\u53d6 / \u5207\u7247\u3002\u5176\u5b9e\uff0c\u53ef\u4ee5\u628a\u5b57\u7b26\u4e32\u770b\u4f5c\u4e00\u79cd\u7279\u6b8a\u7684\u5143\u7ec4\u3002\u6539\u5143\u7ec4\u5143\u7d20\u7684\u64cd\u4f5c\u662f\u975e\u6cd5\u7684 , \u5143\u7ec4 \u4e5f\u652f\u6301\u7528 + \u64cd\u4f5c\u7b26 # \u867d\u7136 tuple\u7684\u5143\u7d20\u4e0d\u53ef\u6539\u53d8 \uff0c\u4f46\u5b83\u53ef\u4ee5\u5305\u542b\u53ef\u53d8\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982 list\u5217\u8868 \u3002\u6784\u9020\u5305\u542b 0 \u4e2a\u6216 1 \u4e2a\u5143\u7d20\u7684 tuple\u662f\u4e2a\u7279\u6b8a\u7684\u95ee\u9898 \uff0c\u6240\u4ee5\u6709\u4e00\u4e9b\u989d\u5916\u7684\u8bed\u6cd5\u89c4\u5219\uff1a tup1 = () # \u7a7a\u5143\u7ec4 tup2 = ( 20 ,) # \u5355\u5143\u7ec4\uff0c\u9700\u8981\u5728\u5143\u7d20\u540e\u6dfb\u52a0\u9017\u53f7 # string \u3001 list\u548ctuple\u90fd\u5c5e\u4e8esequence \uff08\u5e8f\u5217\uff09 # \u6ce8\u610f\uff1a 1 \u3001\u4e0e\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539 ; \u521b\u5efa\u5355\u5143\u7d20\u5143\u7ec4\uff0c\u9700\u8981\u5728\u503c\u4e4b\u540e\u52a0\u4e0a\u4e00\u4e2a\u9017\u53f7\u3002\u6ca1\u6709\u9017\u53f7\uff0c Python \u4f1a\u5047\u5b9a\u8fd9\u53ea\u662f\u4e00\u5bf9\u989d\u5916\u7684\u5706\u62ec\u53f7\uff0c\u5e76\u4e0d\u521b\u5efa\u5143\u7ec4 2 \u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\uff0c\u65b9\u6cd5\u4e00\u6837 3 \u3001\u6ce8\u610f\u6784\u9020\u5305\u542b 0 \u6216 1 \u4e2a\u5143\u7d20\u7684\u5143\u7ec4\u7684\u7279\u6b8a\u8bed\u6cd5\u89c4\u5219 4 \u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f7f\u7528 + \u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5","title":"Tuple\uff08\u5143\u7ec4\uff09"},{"location":"Python3/#_16","text":"\u65b9\u6cd5 \u63cf\u8ff0 len(tuple) \u8ba1\u7b97\u5143\u7ec4\u5143\u7d20\u4e2a\u6570 max(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5927\u503c min(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5c0f\u503c tuple(seq) \u5c06\u5217\u8868\u8f6c\u6362\u4e3a\u5143\u7ec4","title":"\u5143\u7ec4\u5185\u7f6e\u51fd\u6570"},{"location":"Python3/#range","text":"range\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u6570\u5b57\u5e8f\u5217\uff0c\u901a\u5e38\u7528\u4e8e\u5728for\u5faa\u73af\u4e2d\u5faa\u73af\u7279\u5b9a\u7684\u6b21\u6570","title":"range(\u8303\u56f4)"},{"location":"Python3/#_17","text":"Python\u4e2d\u7684\u6587\u672c\u6570\u636e\u7531str\u5bf9\u8c61\u6216\u5b57\u7b26\u4e32\u5904\u7406\uff0c\u5b57\u7b26\u4e32\u662fUnicode\u7684\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u7531\u591a\u79cd\u65b9\u5f0f\u7f16\u5199","title":"\u6587\u672c\u5e8f\u5217\u7c7b\u578b"},{"location":"Python3/#string","text":"# \u201c str \u201d\u4e3a\u5185\u7f6e\u5b57\u7b26\u4e32\u7c7b ; \u7528\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u681d\u8d77\u6765\uff0c\u540c\u65f6\u4f7f\u7528\u53cd\u659c\u6760\\\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\uff0c\u82e5\u4e0d\u60f3\u8ba9\u53cd\u659c\u6760\u4ea7\u751f\u8f6c\u4e49\u6548\u679c\uff0c\u5728\u5b57\u7b26\u4e32\u524d\u6dfb\u52a0\u4e00 # \u4e2a r \uff0c\u8868\u793a\u539f\u59cb\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u53ef\u4ee5\u8de8\u8d8a\u591a\u884c\uff0c\u4f46\u6bcf\u884c\u672b\u5c3e\u5fc5\u987b\u6709\u4e00\u4e2a\u53cd\u659c\u6760\\\u6765\u8f6c\u4e49\u6362\u884c\u7b26\u3002\u4e09\u5f15\u53f7\u5185\u7684\u5b57\u7b26\u4e32\u6587\u5b57 \"\" \"\u6216\u201d '' \u53ef\u4ee5 # \u8de8\u8d8a\u591a\u884c\u7684\u6587\u5b57\uff1b python\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f \uff0c\u7b2c\u4e00\u79cd\u662f\u4ece\u5de6\u5f80\u53f3\u4f9d\u6b21\u4ece 0 \u5f00\u59cb\u9012\u589e\uff0c\u7b2c\u4e8c\u79cd\u662f\u4ece\u53f3\u5f80\u5de6\u4f9d\u6b21\u4ece - 1 \u5f00\u59cb\u9012\u51cf # \u6ce8\u610f\uff1a\u6ca1\u6709\u5355\u72ec\u7684\u5b57\u7b26\u7c7b\u578b\uff0c\u4e00\u4e2a\u5b57\u7b26\u5c31\u662f\u957f\u5ea6\u4e3a 1 \u7684\u5b57\u7b26\u4e32\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5207\u7247\uff0c\u83b7\u53d6\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c\u5f62\u5f0f\u4e3a\u53d8\u91cf [ \u5934\u4e0b\u6807 : \u5c3e\u4e0b\u6807 ] # \u622a\u53d6\u8303\u56f4\u662f\u524d\u95ed\u540e\u5f00 [ 2 :] \uff0c\u5e76\u4e14\u4e24\u4e2a\u7d22\u5f15\u90fd\u53ef\u4ee5\u7701\u7565\uff1b python\u5b57\u7b26\u4e32\u4e0d\u80fd\u88ab\u6539\u53d8 \uff0c\u5982\u5411\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u8d4b\u503c\uff0c word [ 0 ] = 'm' \u4f1a\u5bfc\u81f4\u9519\u8bef # \u6ce8\u610f\uff1a 1 \u3001\u53cd\u659c\u6760\u53ef\u4ee5\u7528\u6765\u8f6c\u4e49\uff0c\u4f7f\u7528 r\u53ef\u4ee5\u8ba9\u53cd\u659c\u6760\u4e0d\u53d1\u751f\u8f6c\u4e49 \u3002 2 \u3001\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528 + \u8fd0\u7b97\u7b26\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u7528 * \u8fd0\u7b97\u7b26\u91cd\u590d\u3002 3 \u3001 Python\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f \uff0c\u4ece\u5de6\u5f80\u53f3\u4ee5 0 \u5f00\u59cb\uff0c\u4ece\u53f3\u5f80\u5de6\u4ee5 - 1 \u5f00\u59cb\u3002 4 \u3001 Python\u4e2d\u7684\u5b57\u7b26\u4e32\u4e0d\u80fd\u6539\u53d8 \u3002\u56e0\u6b64\u6784\u9020 * new * \u5b57\u7b26\u4e32\u6765\u8868\u793a\u8ba1\u7b97\u503c\uff1b\u4f8b\u5982\u8868\u8fbe\u5f0f ( 'hello' + 'there' ) \u6784\u5efa\u65b0\u7684 hellothere\u5b57\u7b26\u4e32","title":"String(\u5b57\u7b26\u4e32)"},{"location":"Python3/#_18","text":"\u5b57\u7b26\u4e32\u5b9e\u73b0\u5e38\u89c1\u7684\u5e8f\u5217\u64cd\u4f5c,\u4ee5\u53ca\u4ee5\u4e0b\u7684\u63cf\u8ff0\u7684\u4e00\u4e9b\u65b9\u6cd5 \u65b9\u6cd5 \u63cf\u8ff0 str.capitalize() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u9996\u5b57\u7b26\u5927\u5199\uff0c\u5176\u4f59\u5b57\u7b26\u5c0f\u5199 str.lower(),str.upper() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5e76\u5c06\u6240\u6709\u5957\u63a5\u5b57\u7b26\u8f6c\u6362\u4e3a\u5c0f\u5199\u6216\u5927\u5199 str.strip([chars]) \u8fd4\u56de\u5220\u9664\u4e86\u5f00\u5934\u548c\u7ed3\u5c3e\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u526f\u672c\u3002 chars\u53c2\u6570\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u8981\u5220\u9664\u7684\u5b57\u7b26\u96c6\u3002\u5982\u679c\u7701\u7565\u6216None\uff0c\u5219chars\u53c2\u6570 \u9ed8\u8ba4\u4e3a\u5220\u9664\u7a7a\u683c str.isalpha()/str.isdigit()/str.isspace()... \u6d4b\u8bd5\u6240\u6709\u5b57\u7b26\u4e32\u5b57\u7b26\u662f\u5426\u5728\u5404\u79cd\u5b57\u7b26\u7c7b\u4e2d str.find() \u68c0\u6d4b\u5b57\u7b26\u4e32\u4e2d\u662f\u5426\u5305\u542b\u5b50\u5b57\u7b26\u4e32str\uff0c\u5982\u679c\u6307\u5b9astart\u548cend\u8303\u56f4\uff0c\u5219\u68c0\u67e5\u662f\u5426\u5305\u542b\u5728\u6307\u5b9a\u8303\u56f4\u5185\uff0c\u5982\u679c\u5305\u542b\u5b50\u5b57\u7b26\u4e32\u8fd4\u56de\u6700\u4f4e\u7684\u7d22\u5f15\u503c\uff0c \u5426\u5219\u8fd4\u56de-1 str.format(*args, **kwargs) \u6267\u884c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u64cd\u4f5c\u3002\u8c03\u7528\u6b64\u65b9\u6cd5\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u5305\u542b\u7531\u5927\u62ec\u53f7{}\u5206\u9694\u7684\u6587\u5b57\u6587\u672c\u6216\u66ff\u6362\u5b57\u6bb5\u3002\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd \u5305\u542b\u4f4d\u7f6e\u53c2\u6570\u7684\u6570\u5b57\u7d22\u5f15\u6216\u5173\u952e\u5b57\u53c2\u6570\u7684\u540d\u79f0\u3002\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u4e2d\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd\u66ff\u6362\u4e3a\u76f8\u5e94\u53c2\u6570\u7684\u5b57\u7b26\u4e32\u503c str.split(sep=None, maxsplit=-1) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u5355\u8bcd\u7ec4\u6210\u7684\u5217\u8868\uff0c\u4f7f\u7528sep\u4f5c\u4e3a\u5206\u5272\u7684\u5b57\u7b26\uff0c\u82e5\u7ed9\u51fasep\uff0c\u5219\u8fde\u7eed\u7684\u5206\u9694\u5b57\u7b26\u4e0d\u4f1a\u7ec4\u5408\u5728\u4e00\u8d77\uff0c \u5e76\u88ab\u89c6\u4e3a\u5212\u5206\u7a7a\u5b57\u7b26\u4e32,\u5982\u679c\u7ed9\u51famaxsplit\uff0c\u5217\u8868\u6700\u591a\u53ea\u6709maxsplit + 1\u4e2a\u5143\u7d20,\u5982\u679cmaxsplit\u6ca1\u6709\u7ed9\u51fa\u6216\u8005\u662f-1\uff0c\u5219\u6ca1\u6709\u5206\u5272\u6570\u91cf\u9650\u5236 str.splitlines([keepends]) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u884c\u4f5c\u4e3a\u5217\u8868\uff0c\u5728\u884c\u8fb9\u754c\u5904\u65ad\u5f00\u3002\u9664\u975e\u7ed9\u51fakeepends\u4e14\u4e3atrue\uff0c\u5426\u5219\u6362\u884c\u7b26\u4e0d\u5305\u62ec\u5728\u7ed3\u679c\u5217\u8868\u4e2d;\u6b64\u65b9\u6cd5 \u5728\u4ee5\u4e0b\u8fb9\u754c\u5904\u8fdb\u884c\u5206\u5272 \u8868\u793a \u63cf\u8ff0 \\n \u6362\u884c \\r \u56de\u8f66 \\r\\n \u56de\u8f66+\u6362\u884c \\v or \\x0b \u884c\u5217\u8868 \\f or \\x0c \u6362\u9875 \\x1c \u6587\u4ef6\u5206\u9694\u7b26 \\x1d \u7ec4\u5206\u9694\u7b26 \\x1e \u8bb0\u5f55\u5206\u9694\u7b26 \\x85 \u4e0b\u4e00\u884c\uff08C1\u63a7\u5236\u4ee3\u7801\uff09 \\u2028 \u884c\u5206\u9694\u7b26 \\u2029 \u6bb5\u843d\u5206\u9694\u7b26","title":"\u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u65b9\u6cd5"},{"location":"Python3/#printf","text":"\u5b57\u7b26\u4e32\u5177\u6709\u4e00\u79cd\u7279\u6b8a\u5185\u7f6e\u64cd\u4f5c\uff1a\u4f7f\u7528%(\u53d6\u6a21)\u8fd0\u7b97\u7b26\uff0c\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u7684sprintf() \u8f6c\u6362\u6807\u8bb0\u7b26\u5305\u542b\u4e24\u4e2a\u6216\u66f4\u591a\u5b57\u7b26\u5e76\u5177\u6709\u4ee5\u4e0b\u7ec4\u6210\uff0c\u4e14\u5fc5\u987b\u9075\u5faa\u6b64\u5904\u89c4\u5b9a\u7684\u987a\u5e8f\uff1a '%' \u5b57\u7b26\uff0c\u7528\u4e8e\u6807\u8bb0\u8f6c\u6362\u7b26\u7684\u8d77\u59cb \u6620\u5c04\u952e\uff08\u53ef\u9009\uff09\uff0c\u7531\u52a0\u5706\u62ec\u53f7\u7684\u5b57\u7b26\u5e8f\u5217\u7ec4\u6210 (\u4f8b\u5982 (somename)) \u8f6c\u6362\u6807\u5fd7\uff08\u53ef\u9009\uff09\uff0c\u7528\u4e8e\u5f71\u54cd\u67d0\u4e9b\u8f6c\u6362\u7c7b\u578b\u7684\u7ed3\u679c \u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\uff08\u53ef\u9009\uff09\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u5bbd\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\u548c\u53ef\u9009\u7684\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20 \u7cbe\u5ea6\uff08\u53ef\u9009\uff09\uff0c\u4ee5\u5728 '.' (\u70b9\u53f7) \u4e4b\u540e\u52a0\u7cbe\u5ea6\u503c\u7684\u5f62\u5f0f\u7ed9\u51fa\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u7cbe\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20 \u957f\u5ea6\u4fee\u9970\u7b26\uff08\u53ef\u9009\uff09 \u8f6c\u6362\u7c7b\u578b \u8f6c\u6362\u6807\u5fd7\u5b57\u7b26\u4e3a\uff1a \u6807\u5fd7 \u542b\u4e49 '#' \u503c\u7684\u8f6c\u6362\u5c06\u4f7f\u7528\u201c\u66ff\u4ee3\u5f62\u5f0f\u201d(\u5177\u4f53\u5b9a\u4e49\u89c1\u4e0b\u6587) '0' \u8f6c\u6362\u5c06\u4e3a\u6570\u5b57\u503c\u586b\u5145\u96f6\u5b57\u7b26 '-' \u8f6c\u6362\u503c\u5c06\u9760\u5de6\u5bf9\u9f50\uff08\u5982\u679c\u540c\u65f6\u7ed9\u51fa '0' \u8f6c\u6362\uff0c\u5219\u4f1a\u8986\u76d6\u540e\u8005\uff09 ' ' (\u7a7a\u683c) \u7b26\u53f7\u4f4d\u8f6c\u6362\u4ea7\u751f\u7684\u6b63\u6570\uff08\u6216\u7a7a\u5b57\u7b26\u4e32\uff09\u524d\u5c06\u7559\u51fa\u4e00\u4e2a\u7a7a\u683c '+' \u7b26\u53f7\u5b57\u7b26 ('+' \u6216 '-') \u5c06\u663e\u793a\u4e8e\u8f6c\u6362\u7ed3\u679c\u7684\u5f00\u5934(\u4f1a\u8986\u76d6 \"\u7a7a\u683c\" \u6807\u5fd7) \u8f6c\u6362\u7c7b\u578b\u4e3a\uff1a \u8f6c\u6362\u7b26 \u542b\u4e49 \u6ce8\u91ca d \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 i \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 o \u6709\u7b26\u53f7\u516b\u8fdb\u5236\u6570 1 u \u8fc7\u65f6\u7c7b\u578b \u7b49\u4ef7\u4e8e 'd' 6 x \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5c0f\u5199\uff09 2 X \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5927\u5199\uff09 2 e \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5c0f\u5199\uff09 3 E \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5927\u5199\uff09 3 f \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 F \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 g \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5c0f\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 G \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5927\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 c \u5355\u4e2a\u5b57\u7b26\uff08\u63a5\u53d7\u6574\u6570\u6216\u5355\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff09 r \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 repr() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 s \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 str() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 a \u5b57\u7b26\u4e32\uff08\u4f7f\u7528 ascii() \u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 % \u4e0d\u8f6c\u6362\u53c2\u6570\uff0c\u5728\u7ed3\u679c\u4e2d\u8f93\u51fa\u4e00\u4e2a '%' \u5b57\u7b26 \u6ce8\u91ca: \u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165\u6807\u793a\u516b\u8fdb\u5236\u6570\u7684\u524d\u7f00 ('0o') \u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165 '0x' \u6216 '0X' \u524d\u7f00\uff08\u53d6\u51b3\u4e8e\u662f\u4f7f\u7528 'x' \u8fd8\u662f 'X' \u683c\u5f0f\uff09 \u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u5373\u4f7f\u5176\u540e\u5e76\u6ca1\u6709\u6570\u5b57,\u5c0f\u6570\u70b9\u540e\u7684\u6570\u5b57\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6 \u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u672b\u5c3e\u5404\u4f4d\u7684\u96f6\u4e0d\u4f1a\u5982\u5176\u4ed6\u60c5\u51b5\u4e0b\u90a3\u6837\u88ab\u79fb\u9664,\u5c0f\u6570\u70b9\u524d\u540e\u7684\u6709\u6548\u6570\u7801\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6 \u5982\u679c\u7cbe\u5ea6\u4e3a N\uff0c\u8f93\u51fa\u5c06\u622a\u77ed\u4e3a N \u4e2a\u5b57\u7b26 \u53c2\u89c1 PEP 237","title":"printf\u98ce\u683c\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316"},{"location":"Python3/#-bytesbytearraymemoryview","text":"\u7528\u4e8e\u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e\u7684\u6838\u5fc3\u5185\u7f6e\u7c7b\u578b\u662fbytes\u548cbytearray\uff0c\u5b83\u4eec\u652f\u6301memoryview\u4f7f\u7528buffer protocol\u534f\u8bae\u6765\u8bbf\u95ee\u5176\u4ed6\u4e8c\u8fdb\u5236\u5bf9\u8c61\u7684\u5185\u5b58\u800c\u65e0\u9700\u505a\u4e00\u4e2a\u590d\u5236 \u8be5array\u6a21\u5757\u652f\u6301\u6709\u6548\u5b58\u50a8\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u598232\u4f4d\u6574\u6570\u548cIEEE754\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u503c","title":"\u4e8c\u8fdb\u5236\u5e8f\u5217\u7c7b\u578b -- bytes\u3001bytearray\u3001memoryview"},{"location":"Python3/#bytes","text":"\u5b57\u8282\u5bf9\u8c61\u662f\u5355\u4e2a\u5b57\u8282\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7531\u4e8e\u4e3b\u8981\u7684\u4e8c\u8fdb\u5236\u534f\u8bae\u5927\u591a\u57fa\u4e8e ASCII\u6587\u672c\u7f16\u7801 \uff0c\u56e0\u6b64\u5b57\u8282\u5bf9\u8c61\u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4ec5\u5728\u5904\u7406 ASCII \u517c\u5bb9\u6570\u636e\u65f6\u6709\u6548\uff0c\u5e76\u4e14\u4ee5\u5404\u79cd\u5176\u4ed6\u65b9\u5f0f\u4e0e\u5b57\u7b26\u4e32\u5bf9\u8c61\u5bc6\u5207\u76f8\u5173 \u5b57\u8282\u6587\u5b57\u7684\u8bed\u6cd5\u548c\u5b57\u7b26\u4e32\u6587\u5b57\u7684\u8bed\u6cd5\u7c7b\u4f3c\uff0c\u53ea\u662f\u6dfb\u52a0\u4e86\u524d\u7f00 b \u5b57\u8282\u6587\u5b57\u4e2d\u53ea\u5141\u8bb8\u4f7f\u7528 ASCII\u5b57\u7b26 \uff08\u65e0\u8bba\u58f0\u660e\u7684\u6e90\u4ee3\u7801\u7f16\u7801\u5982\u4f55\uff09\u3002\u5fc5\u987b\u4f7f\u7528\u9002\u5f53\u7684\u8f6c\u4e49\u5e8f\u5217\u5c06\u8d85\u8fc7 127 \u7684\u4efb\u4f55\u4e8c\u8fdb\u5236\u503c\u8f93\u5165\u5230\u5b57\u8282\u6587\u5b57\u4e2d \u4e0e\u5b57\u7b26\u4e32\u6587\u5b57\u4e00\u6837\uff0c\u5b57\u8282\u6587\u5b57\u4e5f\u53ef\u4ee5\u4f7f\u7528 r\u524d\u7f00\u6765\u7981\u7528\u8f6c\u4e49\u5e8f\u5217\u7684\u5904\u7406 \u867d\u7136\u5b57\u8282\u6587\u5b57\u548c\u8868\u793a\u57fa\u4e8e ASCII\u6587\u672c \uff0c\u4f46\u5b57\u8282\u5bf9\u8c61\u5b9e\u9645\u4e0a\u8868\u73b0\u4e3a\u4e0d\u53ef\u53d8\u7684\u6574\u6570\u5e8f\u5217\uff0c\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u503c\u90fd\u53d7\u5230\u9650\u5236\uff0c\u4ee5\u81f4 0 <= x < 256 \uff08\u8bd5\u56fe \u8fdd\u53cd\u6b64\u9650\u5236\u5c06\u89e6\u53d1 ValueError \uff09\u3002\u8fd9\u662f\u6545\u610f\u5f3a\u8c03\u7684\uff0c\u867d\u7136\u8bb8\u591a\u4e8c\u8fdb\u5236\u683c\u5f0f\u5305\u62ec\u57fa\u4e8e ASCII\u7684\u5143\u7d20 \uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u9762\u5411\u6587\u672c\u7684\u7b97\u6cd5\u8fdb\u884c\u6709 \u7528\u7684\u64cd\u4f5c\uff0c\u4f46\u5bf9\u4e8e\u4efb\u610f\u4e8c\u8fdb\u5236\u6570\u636e\u901a\u5e38\u4e0d\u662f\u8fd9\u79cd\u60c5\u51b5\uff08\u76f2\u76ee\u5730\u5c06\u6587\u672c\u5904\u7406\u7b97\u6cd5\u5e94\u7528\u4e8e\u975e\u4e8c\u8fdb\u5236\u6570\u636e\u683c\u5f0f\uff09 ASCII\u517c\u5bb9\u901a\u5e38\u4f1a\u5bfc\u81f4\u6570\u636e\u635f\u574f \uff09 \u9664\u4e86\u6587\u5b57\u5f62\u5f0f\u4e4b\u5916\uff0c\u8fd8\u53ef\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u521b\u5efa\u5b57\u8282\u5bf9\u8c61\uff1a * \u6307\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b57\u8282\u5bf9\u8c61\uff1atypes(10) * \u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytes(range(10)) * \u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytes(obj)","title":"bytes\u5bf9\u8c61"},{"location":"Python3/#bytearray","text":"bytearray\u5bf9\u8c61\u662fbytes\u5bf9\u8c61\u7684\u53ef\u53d8\u526f\u672c\uff0c\u7531\u4e8ebytearray\u662f\u53ef\u53d8\u7684\uff0c\u8fd8\u652f\u6301\u53ef\u53d8\u5e8f\u5217\u64cd\u4f5c bytearray\u5bf9\u8c61\u6ca1\u6709\u4e13\u7528\u7684\u6587\u5b57\u8bed\u6cd5\uff0c\u800c\u662f\u59cb\u7ec8\u901a\u8fc7\u8c03\u7528\u6784\u9020\u51fd\u6570\u6765\u521b\u5efa\uff1a * \u521b\u5efa\u4e00\u4e2a\u7a7a\u5b9e\u4f8b\uff1abytearray() * \u521b\u5efa\u5177\u6709\u7ed9\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b9e\u4f8b\uff1abytearray(10) * \u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytearray(range(10)) * \u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytearray(b'Hello') bytes\u548cbytearray\u5bf9\u8c61\u90fd\u652f\u6301\u516c\u5171\u5e8f\u5217\u64cd\u4f5c\uff0c\u5b83\u4eec\u4e0d\u4ec5\u4e0e\u76f8\u540c\u7c7b\u578b\u7684\u64cd\u4f5c\u6570\u4e92\u64cd\u4f5c\uff0c\u800c\u4e14\u4e0e\u4efb\u4f55\u7c7b\u4f3c\u5b57\u8282\u7684\u5bf9\u8c61\u4e92\u64cd\u4f5c\uff1b\u7531\u4e8e\u6b64\u7075\u6d3b\u6027 \u5b83\u4eec\u53ef\u4ee5\u5728\u64cd\u4f5c\u4e2d\u81ea\u7531\u6df7\u5408\u800c\u4e0d\u4f1a\u5bfc\u81f4\u9519\u8bef\uff0c\u4f46\u7ed3\u679c\u7684\u8fd4\u56de\u7c7b\u578b\u53ef\u80fd\u53d6\u51b3\u4e8e\u64cd\u4f5c\u6570\u7684\u987a\u5e8f","title":"bytearray\u5bf9\u8c61"},{"location":"Python3/#printf_1","text":"\u5b57\u8282\u5bf9\u8c61(bytes/bytearray)\u6709\u4e00\u4e2a\u72ec\u7279\u7684\u5185\u7f6e\u64cd\u4f5c\uff1a%\u8fd0\u7b97\u7b26(\u6a21\u6570)\u4e5f\u6210\u4e3a\u5b57\u8282\u683c\u5f0f\u5316\u6216\u63d2\u503c\u8fd0\u7b97\u7b26\uff0c\u5982\u679cformat\u9700\u8981\u5355\u4e2a\u53c2\u6570\uff0c\u5219\u503c\u53ef \u4ee5\u662f\u5355\u4e2a\u975e\u5143\u7ec4\u5bf9\u8c61\uff0c\u5426\u5219\u503c\u5fc5\u987b\u662f\u5177\u6709\u683c\u5f0f\u5b57\u8282\u5bf9\u8c61\u6216\u5355\u4e2a\u6620\u5c04\u5bf9\u8c61(\u5b57\u5178)\u6307\u5b9a\u7684\u9879\u76ee\u6570\u7684\u5143\u7ec4 \u5176\u4ed6\u548c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u76f8\u540c","title":"printf\u98ce\u683c\u5b57\u8282\u683c\u5f0f\u5316"},{"location":"Python3/#memory-views","text":"memoryview\u5bf9\u8c61\u5141\u8bb8Python\u4ee3\u7801\u8bbf\u95ee\u652f\u6301buffer protocol\u7684\u5bf9\u8c61\u7684\u5185\u90e8\u6570\u636e\u800c\u65e0\u9700\u590d\u5236","title":"memory views"},{"location":"Python3/#set-setfrozenset","text":"","title":"Set\u7c7b\u578b -- set\u3001frozenset"},{"location":"Python3/#set","text":"\u96c6\u5408\u662f\u4e00\u4e2a\u65e0\u5e8f\u4e0d\u91cd\u590d\u5143\u7d20\u7684\u96c6\u3002set\u5bf9\u8c61\u662f\u7531\u5177\u6709\u552f\u4e00\u6027\u7684hashable\u5bf9\u8c61\u7ec4\u6210\u7684\u65e0\u5e8f\u591a\u9879\u96c6\u5408\u3002\u57fa\u672c\u529f\u80fd\u5305\u62ec\u6210\u5458\u5173\u7cfb\u68c0\u6d4b\u548c\u6d88\u9664\u91cd\u590d \u5143\u7d20\u3002\u96c6\u5408\u5bf9\u8c61\u8fd8\u652f\u6301\u6570\u5b66\u96c6\u5408\u7c7b\u8fd0\u7b97\uff0c\u5982\u5e76\u96c6\uff0c\u4ea4\u96c6\uff0c\u5dee\u96c6\u548c\u5bf9\u79f0\u5dee\u96c6\u7b49;\u4f5c\u4e3a\u65e0\u5e8f\u96c6\u5408\uff0c\u4e0d\u8bb0\u5f55\u5143\u7d20\u4f4d\u7f6e\u548c\u63d2\u5165\u987a\u5e8f\uff0c\u96c6\u5408\u4e0d\u652f\u6301 \u7d22\u5f15\u3001\u5207\u7247\u6216\u5176\u4ed6\u7c7b\u4f3c\u5e8f\u5217\u7684\u884c\u4e3a \u76ee\u524d\u6709\u4e24\u79cd\u5185\u7f6e\u96c6\u5408\u7c7b\u578b\uff0cset\u548cfrozenset\uff0cset\u7c7b\u578b\u662f\u53ef\u53d8\u7684\uff0c\u5176\u5143\u7d20\u53ef\u4ee5\u7528add()\u548cremove()\u65b9\u6cd5\u6539\u53d8\uff0c\u6240\u4ee5\u4e0d\u5177\u6709\u54c8\u5e0c\u503c\u4e14\u4e0d\u80fd\u88ab\u7528 \u4f5c\u5b57\u5178\u7684\u952e\u6216\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20\u3002frozenset\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u5e76\u4e14\u4e3ahashable\uff0c\u5176\u5185\u5bb9\u5728\u88ab\u521b\u5efa\u540e\u4e0d\u80fd\u518d\u6539\u53d8\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4f5c\u5b57\u5178\u7684\u952e\u548c\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20 \u53ef\u4ee5\u7528\u5927\u62ec\u53f7 {} \u521b\u5efa\u96c6\u5408\u3002\u6ce8\u610f\uff1a\u5982\u679c\u8981\u521b\u5efa\u4e00\u4e2a\u7a7a\u96c6\u5408\uff0c\u4f60\u5fc5\u987b\u7528 set() \u800c\u4e0d\u662f {} \uff1b\u540e\u8005\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u5b57\u5178\uff0c\u96c6\u5408\u4e5f\u652f\u6301\u63a8\u5bfc\u5f0f\u5f62\u5f0f # \u6ce8\u610f\uff1a 1 \u3001\u4ece\u5217\u8868\u521b\u5efa\u96c6\u5408 , \u53ef\u4f7f\u7528 set () \u51fd\u6570 2 \u3001\u96c6\u5408\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u503c ; \u4f46\u5982\u679c\u6dfb\u52a0\u96c6\u5408\u5df2\u6709\u7684\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u4efb\u4f55\u4e8b\u60c5\uff0c\u4e5f\u4e0d\u4f1a\u62a5\u9519","title":"Set\uff08\u96c6\u5408\uff09"},{"location":"Python3/#_19","text":"\u65b9\u6cd5 \u63cf\u8ff0 add() add() \u65b9\u6cd5\u63a5\u53d7\u5355\u4e2a\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u5c06\u8be5\u503c\u6dfb\u52a0\u5230\u96c6\u5408\u4e4b\u4e2d update() update() \u65b9\u6cd5\u4ec5\u63a5\u53d7\u4e00\u4e2a\u96c6\u5408\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u5c06\u5176\u6240\u6709\u6210\u5458\u6dfb\u52a0\u5230\u521d\u59cb\u5217\u8868\u4e2d;\u5982\u679c\u6709\u91cd\u590d\u503c\uff0c\u5c06\u4f1a\u88ab\u5ffd\u7565 discard() discard() \u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u8be5\u503c;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 discard()\u65b9\u6cd5\uff0c\u5b83\u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u4e0d\u4ea7\u751f\u9519\u8bef remove() remove() \u65b9\u6cd5\u4e5f\u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u4e5f\u4ece\u96c6\u5408\u4e2d\u5c06\u5176\u5220\u9664;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 remove()\u65b9\u6cd5\u5c06\u4f1a\u5f15\u53d1KeyError\u9519\u8bef pop() \u4ece\u96c6\u5408\u5220\u9664\u67d0\u4e2a\u503c\u5e76\u8fd4\u56de\u8be5\u503c","title":"\u96c6\u5408\u5185\u7f6e\u65b9\u6cd5"},{"location":"Python3/#-","text":"","title":"\u6620\u5c04\u7c7b\u578b -- \u5b57\u5178"},{"location":"Python3/#dict","text":"\u4e00\u4e2amapping\u5bf9\u8c61\u6620\u5c04\u53ef\u54c8\u5e0c\u503c\u5230\u4efb\u610f\u5bf9\u8c61\uff0cmapping\u662f\u53ef\u53d8\u5bf9\u8c61\uff1b\u76ee\u524d\u53ea\u6709\u4e00\u79cd\u6807\u51c6\u7684mapping\u7c7b\u578b,\u5373\u5b57\u5178\u3002\u5b57\u5178\u4ee5\u5173\u952e\u5b57\u4f5c\u4e3a\u7d22\u5f15 \u5173\u952e\u5b57\u53ef\u4ee5\u662f\u4efb\u610f\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u3002\u5982\u679c\u4e00\u4e2a\u5143\u7ec4\u4e2d\u53ea\u5305\u542b\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u548c\u5143\u7ec4\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5173\u952e\u5b57 \u5982\u679c\u5143\u7ec4\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5305\u542b\u4e86\u53ef\u53d8\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f5c\u4e3a\u5173\u952e\u5b57\u3002\u5173\u952e\u5b57\u5fc5\u987b\u4f7f\u7528\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f\u8bf4list\u548c\u5305\u542b\u53ef\u53d8\u7c7b\u578b\u7684tuple \u4e0d\u80fd\u505a\u5173\u952e\u5b57\u3002\u5728\u540c\u4e00\u4e2a\u5b57\u5178\u4e2d\uff0c\u5173\u952e\u5b57\u8fd8\u5fc5\u987b\u4e92\u4e0d\u76f8\u540c\u3002\u53ef\u4ee5\u5c06\u5b57\u5178\u770b\u4f5c\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u7684\u96c6\u5408\uff0c\u5728\u4e00\u4e2a\u5b57\u5178\u4e2d\u952e\u5fc5\u987b\u662f\u552f\u4e00\u7684 \u5b57\u5178\u4e3b\u8981\u64cd\u4f5c\u662f\u5173\u952e\u5b57\u5b58\u50a8\u548c\u89e3\u6790\u503c\u3002 # \u6ce8\u610f\uff1a 1 \u3001\u5b57\u5178\u662f\u4e00\u79cd\u6620\u5c04\u7c7b\u578b\uff0c\u5b83\u7684\u5143\u7d20\u662f\u952e\u503c\u5bf9\u3002\u6784\u9020\u51fd\u6570 dict () \u76f4\u63a5\u4ece\u952e\u503c\u5bf9 sequence\u4e2d\u6784\u5efa\u5b57\u5178 \uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u63a8\u5bfc 2 \u3001\u5b57\u5178\u7684\u5173\u952e\u5b57\u5fc5\u987b\u4e3a\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e14\u4e0d\u80fd\u91cd\u590d\u3002 3 \u3001\u521b\u5efa\u7a7a\u5b57\u5178\u4f7f\u7528{} # \u5b57\u5178\u904d\u5386\u6280\u5de7\uff0c\u5728\u5b57\u5178\u4e2d\u904d\u5386\u65f6\uff0c\u5173\u952e\u5b57\u548c\u5bf9\u5e94\u7684\u503c\u53ef\u4ee5\u4f7f\u7528 items () \u65b9\u6cd5\u540c\u65f6\u89e3\u8bfb\u51fa\u6765\u3002\u5728\u5e8f\u5217\u4e2d\u904d\u5386\u65f6\uff0c\u7d22\u5f15\u4f4d\u7f6e\u548c\u5bf9\u5e94\u503c\u53ef\u4ee5 # \u4f7f\u7528 enumerate () \u51fd\u6570\u540c\u65f6\u5f97\u5230\u3002\u540c\u65f6\u904d\u5386\u4e24\u4e2a\u6216\u66f4\u591a\u7684\u5e8f\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528 zip () \u7ec4\u5408\u3002\u8981\u53cd\u5411\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u9996\u5148\u6307\u5b9a\u8fd9\u4e2a\u5e8f\u5217 # \u7136\u540e\u8c03\u7528 reversesd () \u51fd\u6570\u3002\u8981\u6309\u987a\u5e8f\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u4f7f\u7528 sorted () \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5df2\u6392\u5e8f\u7684\u5e8f\u5217\uff0c\u5e76\u4e0d\u4fee\u6539\u539f\u503c\u3002","title":"Dict\uff08\u5b57\u5178\uff09"},{"location":"Python3/#python_3","text":"\u65b9\u6cd5 \u63cf\u8ff0 dict.clear() \u5220\u9664\u5b57\u5178\u5185\u6240\u6709\u5143\u7d20 dict.copy() \u8fd4\u56de\u539f\u5b57\u5178\u7684\u6d45\u62f7\u8d1d dict.fromkeys() \u521b\u5efa\u4e00\u4e2a\u65b0\u5b57\u5178\uff0c\u4ee5\u5e8f\u5217seq\u4e2d\u5143\u7d20\u505a\u5b57\u5178\u7684\u952e\uff0cval\u4e3a\u5b57\u5178\u6240\u6709\u952e\u5bf9\u5e94\u7684\u521d\u59cb\u503c dict.get(key, default=None) \u8fd4\u56de\u6307\u5b9a\u952e\u7684\u503c\uff0c\u5982\u679c\u503c\u4e0d\u5728\u5b57\u5178\u4e2d\u8fd4\u56dedefault\u503c key in dict \u5982\u679c\u952e\u5728\u5b57\u5178dict\u91cc\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse dict.items() \u4ee5\u5217\u8868\u8fd4\u56de\u53ef\u904d\u5386\u7684(\u952e, \u503c) \u5143\u7ec4\u6570\u7ec4 dict.keys() \u4ee5\u5217\u8868\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u6240\u6709\u7684\u952e dict.setdefault(key, default=None) \u548cget()\u7c7b\u4f3c, \u4f46\u5982\u679c\u952e\u4e0d\u5b58\u5728\u4e8e\u5b57\u5178\u4e2d\uff0c\u5c06\u4f1a\u6dfb\u52a0\u952e\u5e76\u5c06\u503c\u8bbe\u4e3adefault dict.update(dict2) \u628a\u5b57\u5178dict2\u7684\u952e/\u503c\u5bf9\u66f4\u65b0\u5230dict\u91cc dict.values() \u4ee5\u5217\u8868\u8fd4\u56de\u5b57\u5178\u4e2d\u7684\u6240\u6709\u503c","title":"python\u5b57\u5178\u5e38\u7528\u65b9\u6cd5\uff1a"},{"location":"Python3/#dictionary-view-objects","text":"\u8fd9\u4e9b\u5bf9\u8c61\u901a\u8fc7dict.keys()\u3001dict.values()\u3001dict.items()\u8fd4\u56de\u7684\u662f\u89c6\u56fe\u5bf9\u8c61\uff0c\u5b83\u4eec\u63d0\u4f9b\u5b57\u5178\u6761\u76ee\u7684\u52a8\u6001\u89c6\u56fe\uff0c\u610f\u5473\u7740\u5f53\u5b57\u5178\u66f4\u6539\u65f6\uff0c\u89c6\u56fe\u5219\u4f1a\u53cd\u5e94\u8fd9\u4e9b\u66f4\u6539","title":"\u5b57\u5178\u89c6\u56fe\u5bf9\u8c61(dictionary view objects)"},{"location":"Python3/#context-manager-types","text":"python\u7684with\u8bed\u53e5\u652f\u6301\u7531\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5b9a\u4e49\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u6982\u5ff5\uff0c\u8fd9\u662f\u4f7f\u7528\u4e00\u5bf9\u65b9\u6cd5\u5b9e\u73b0\u7684\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u5b9a\u4e49\u5728\u8bed\u53e5\u4f53 \u6267\u884c\u4e4b\u524d\u8f93\u5165\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\uff0c\u5e76\u5728\u8bed\u53e5\u7ed3\u675f\u65f6\u9000\u51fa ython\u5b9a\u4e49\u4e86\u51e0\u4e2a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u4ee5\u652f\u6301\u7b80\u5355\u7684\u7ebf\u7a0b\u540c\u6b65\uff0c\u6587\u4ef6\u6216\u5176\u4ed6\u5bf9\u8c61\u7684\u5feb\u901f\u5173\u95ed\uff0c\u4ee5\u53ca\u5bf9\u6d3b\u52a8\u5341\u8fdb\u5236\u7b97\u672f\u4e0a\u4e0b\u6587\u7684\u7b80\u5355\u64cd\u4f5c\u3002\u9664\u4e86 \u5b9e\u73b0\u4e0a\u4e0b\u6587\u7ba1\u7406\u534f\u8bae\u4e4b\u5916\uff0c\u7279\u5b9a\u7c7b\u578b\u4e0d\u4f1a\u88ab\u7279\u522b\u5904\u7406\u3002 Python\u7684\u751f\u6210\u5668\u548ccontextlib.contextmanager\u88c5\u9970\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fd9\u4e9b\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u4f7f\u7528contextlib.contextmanager\u88c5\u9970\u5668 \u4fee\u9970\u751f\u6210\u5668\u51fd\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u5b9e\u73b0\u5fc5\u8981__enter__()\u548c__exit__()\u65b9\u6cd5\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u800c\u4e0d\u662f\u7531\u672a\u4fee\u9970\u7684\u751f\u6210\u5668\u51fd\u6570\u751f\u6210\u7684\u8fed\u4ee3\u5668\u3002 \u8bf7\u6ce8\u610f\uff0cPython / C API\u4e2dPython\u5bf9\u8c61\u7684\u7c7b\u578b\u7ed3\u6784\u4e2d\u6ca1\u6709\u9488\u5bf9\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7279\u5b9a\u63d2\u69fd\u3002\u60f3\u8981\u5b9a\u4e49\u8fd9\u4e9b\u65b9\u6cd5\u7684\u6269\u5c55\u7c7b\u578b\u5fc5\u987b\u5c06\u5b83\u4eec\u4f5c\u4e3a\u666e\u901a\u7684 Python\u53ef\u8bbf\u95ee\u65b9\u6cd5\u63d0\u4f9b\u3002\u4e0e\u8bbe\u7f6e\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u5f00\u9500\u76f8\u6bd4\uff0c\u5355\u4e2a\u7c7b\u5b57\u5178\u67e5\u627e\u7684\u5f00\u9500\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1","title":"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7c7b\u578b(Context Manager Types)"},{"location":"Python3/#_20","text":"# python\u5faa\u73af\u8bed\u53e5\u6709for\u548cwhile,while\u4f7f\u7528\u4e0e\u63d0\u524d\u77e5\u9053\u6761\u4ef6\u7684\u60c5\u51b5\u3002 # \u4f7f\u7528while\u5faa\u73af\u8ba1\u7b971-100\u548c count = 1 num_sum = 0 while count <= 100 : num_sum += count count += 1 print ( \"1~100\u548c\u662f:\" , num_sum ) # for\u5faa\u73af\u53ef\u4ee5\u904d\u5386\u4efb\u4f55\u5e8f\u5217\u7684\u9879\u76ee\uff0c\u5982\u5217\u8868\u6216\u5b57\u7b26\u4e32,for\u5b9e\u4f8b\u4f7f\u7528break\u8bed\u53e5\uff0cbreak\u8bed\u53e5\u7528\u4e8e\u8df3\u51fa\u5f53\u524d\u5faa\u73af\u4f53 foods = [ \"apple\" , \"beef\" , \"fish\" ] for egg in foods : if egg == \"beef\" : print ( \"\u4e24\u4e2a\u4e0d\u540c\u7684\" ) break # \u6b64\u5904\u8df3\u51fa\u5faa\u73af\uff0c\u4e0b\u4e00\u53e5\u4e0d\u518d\u8f93\u51fa print ( \"\u597d\u5403\u7684\" + egg ) else : print ( \"\u6ca1\u6709beef\u4e86\" ) print ( \"\u7ed3\u675f\u9009\u9910\" ) # range\u53ef\u4ee5\u904d\u5386\u6570\u5b57\u5e8f\u5217\u6765\u81ea\u52a8\u751f\u6210\u6570\u5217\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e00\u533a\u95f4 # \u53ef\u4f7frange\u4ece\u6307\u5b9a\u6570\u5b57\u5f00\u59cb\u5e76\u6307\u5b9a\u589e\u91cf\u3002(\u53ef\u4ee5\u662f\u8d1f\u6570\uff0c\u6709\u65f6\u53eb\u505a\u6b65\u957f) for i in range ( 1 , 9 , 2 ): # \u4ece1\u52309\u6b65\u957f\u4e3a2 print ( i ) # \u7ed3\u5408range()\u548clen()\u51fd\u6570\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\u7684\u7d22\u5f15 a = [ 'lee' , 'bob' , 'bruce' ] for i in range ( len ( a )): print ( i , a [ i ])","title":"\u5faa\u73af"},{"location":"Python3/#python_4","text":"# if \u8bed\u53e5\u57fa\u672c\u683c\u5f0f if condition_1 : statement_block_1 elif condition_2 : statement_block_2 else : statement_block_3 \u6ce8\u610f 1 \u3001\u6bcf\u4e2a\u6761\u4ef6\u540e\u9762\u8981\u4f7f\u7528\u5192\u53f7\uff08:\uff09\uff0c\u8868\u793a\u63a5\u4e0b\u6765\u662f\u6ee1\u8db3\u6761\u4ef6\u540e\u8981\u6267\u884c\u7684\u8bed\u53e5\u5757 3 \u3001\u5728 Python \u4e2d\u6ca1\u6709 switch \u2013 case \u8bed\u53e5 # \u6f14\u793a\u731c\u6570\u5b57 #!/usr/local/bin/python3 # -*- coding: UTF-8 -*- number = 1 guess = 0 print ( \"\u731c\u6570\u5b57\" ) while guess != number : guess = int ( input ( \"\u8f93\u5165\u8981\u731c\u7684\u6570\u5b57\uff1a\" )) if guess == number : print ( \"holly shit,\u4f60\u731c\u5bf9\u4e86!\" ) elif guess < number : print ( \"\u731c\u7684\u592a\u5c0f\u4e86\" ) elif guess > number : print ( \"\u731c\u7684\u592a\u5927\u4e86\" )","title":"Python\u6761\u4ef6\u5224\u65ad\u8bed\u53e5"},{"location":"Python3/#_21","text":"\u51fd\u6570\u5bf9\u8c61\u662f\u901a\u8fc7\u51fd\u6570\u5b9a\u4e49\u521b\u5efa\uff0c\u5bf9\u51fd\u6570\u552f\u4e00\u7684\u64cd\u4f5c\u5c31\u662f\u8c03\u7528\u5b83\u3002","title":"\u51fd\u6570"},{"location":"Python3/#_22","text":"","title":"\u51fd\u6570\u7684\u53c2\u6570"},{"location":"Python3/#_23","text":"# \u65b0\u7684power(x, n)\u51fd\u6570\u5b9a\u4e49\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\uff0c\u65e7\u7684\u8c03\u7528\u4ee3\u7801\u5931\u8d25\u4e86\uff0c\u539f\u56e0\u662f\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u5bfc\u81f4\u65e7\u7684\u4ee3\u7801\u56e0\u4e3a\u7f3a\u5c11\u4e00\u4e2a\u53c2\u6570\u800c\u65e0\u6cd5 # \u6b63\u5e38\u8c03\u7528\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u9ed8\u8ba4\u53c2\u6570 def power ( x , n = 2 ): s = 1 while n > 0 : n = n - 1 s = s * x return s # \u6ce8\u610f\uff1a\u4e00\u662f\u5fc5\u9009\u53c2\u6570\u5728\u524d\uff0c\u9ed8\u8ba4\u53c2\u6570\u5728\u540e\uff0c\u5426\u5219Python\u7684\u89e3\u91ca\u5668\u4f1a\u62a5\u9519\u3002\u8bbe\u7f6e\u9ed8\u8ba4\u53c2\u6570\u6280\u5de7--\u5f53\u51fd\u6570\u6709\u591a\u4e2a\u53c2\u6570\u65f6\uff0c\u628a\u53d8\u5316\u5927\u7684\u53c2\u6570\u653e # \u524d\u9762\uff0c\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u653e\u540e\u9762\u3002\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u9ed8\u8ba4\u53c2\u6570 # \u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61,x\u662f\u5f62\u53c2\uff0c\u8c03\u7528power(3, n=2),3\u5c31\u662f\u5b9e\u53c2","title":"\u9ed8\u8ba4\u53c2\u6570\uff1a"},{"location":"Python3/#_24","text":"def power ( x , n ): # x\u5c31\u662f\u4e00\u4e2a\u4f4d\u7f6e\u53c2\u6570 s = 1 while n > 0 : n = n - 1 s = s * x return s","title":"\u4f4d\u7f6e\u53c2\u6570\uff1a"},{"location":"Python3/#_25","text":"# \u53ef\u53d8\u53c2\u6570\u5c31\u662f\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\uff0c\u53ef\u4ee5\u662f0\u4e2a\u5230\u4efb\u610f\u4e2a # \u4f8b\uff1a\u7ed9\u5b9a\u4e00\u7ec4\u6570\u5b57a\uff0cb\uff0cc\u2026\u2026\uff0c\u8bf7\u8ba1\u7b97a2 + b2 + c2 + \u2026\u2026 # \u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570 def calc ( numbers ): sum = 0 for n in numbers : sum = sum + n * n return sum # \u5b9a\u4e49\u53ef\u53d8\u53c2\u6570\u548c\u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570\u76f8\u6bd4\uff0c\u4ec5\u4ec5\u5728\u53c2\u6570\u524d\u9762\u52a0\u4e86\u4e00\u4e2a* \u53f7\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0c\u53c2\u6570numbers\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff0c\u56e0\u6b64 # \u51fd\u6570\u4ee3\u7801\u5b8c\u5168\u4e0d\u53d8\u3002\u4f46\u662f\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u65f6\uff0c\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e2a\u53c2\u6570\uff0c\u5305\u62ec0\u4e2a\u53c2\u6570\u3002Python\u5141\u8bb8\u4f60\u5728list\u6216tuple\u524d\u9762\u52a0\u4e00\u4e2a*\u53f7\uff0c\u628alist\u6216 # tuple\u7684\u5143\u7d20\u53d8\u6210\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb\u3002*numbers\u8868\u793a\u628anumbers\u8fd9\u4e2alist\u6216tuple\u7684\u6240\u6709\u5143\u7d20\u4f5c\u4e3a\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb def calc ( * numbers ): sum = 0 for n in numbers : sum = sum + n * n return sum \"\"\" python\u4e2d*\u548c**\u542b\u4e49: \u5f53\u5176\u5728\u51fd\u6570\u5934\u5185(function header)\u65f6 * \u6536\u96c6\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u53c2\u6570 ** \u6536\u96c6\u5b57\u5178\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u53c2\u6570 \"\"\" def function_1 ( * a , ** kw ): print ( a , kw ) function_1 ( 1 , 2 , 3 , x = 1 , y = 2 , z = 3 ) # \u4f20\u53c2\u7ed9\u51fd\u6570function_1\uff0c\u8fd4\u56de\u503c\u4e3a(1, 2, 3) {'x': 1, 'y': 2, 'z': 3} \"\"\" \u5f53\u5176\u5728\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u4e2d \u5f53\u53c2\u6570\u5df2\u7ecf\u5728\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u4f46\u9700\u8981\u4e3a\u9700\u8981\u5355\u72ec\u4f4d\u7f6e\u53c2\u6570\u7684\u51fd\u6570\u8c03\u7528\u89e3\u5305\u65f6,\u4e0e*\u8fd0\u7b97\u7b26\u4e00\u8d77\u7f16\u5199\u51fd\u6570\u8c03\u7528\u4ee5\u4ece\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u89e3\u538b\u7f29\u53c2\u6570 * \u5c06\u5217\u8868\u6216\u5143\u7ec4\u89e3\u5305\u5230\u4f4d\u7f6e\u53c2\u6570\u4e2d ** \u5c06\u5b57\u5178\u89e3\u538b\u7f29\u4e3a\u5173\u952e\u5b57\u53c2\u6570 \"\"\" list = [ 1 , 2 , 3 ] dic = { 'x' : 1 , 'y' : 2 , 'z' : 3 } function_1 ( * list , ** dic )","title":"\u53ef\u53d8\u53c2\u6570"},{"location":"Python3/#kwargvalue","text":"# \u53ef\u53d8\u53c2\u6570\u5217\u8868\uff1a\u4e00\u4e2a\u6700\u4e0d\u5e38\u7528\u7684\u9009\u62e9\u662f\u53ef\u4ee5\u8ba9\u51fd\u6570\u8c03\u7528\u53ef\u53d8\u4e2a\u6570\u7684\u53c2\u6570.\u8fd9\u4e9b\u53c2\u6570\u88ab\u5305\u88c5\u8fdb\u4e00\u4e2a\u5143\u7ec4tuple(\u67e5\u770b\u5143\u7ec4\u548c\u5e8f\u5217).\u5728\u8fd9\u4e9b\u53ef # \u53d8\u4e2a\u6570\u7684\u53c2\u6570\u4e4b\u524d,\u53ef\u4ee5\u6709\u96f6\u5230\u591a\u4e2a\u542b\u53c2\u6570\u540d\u7684\u53c2\u6570: def arithmetic_mean ( * args ): sum = 0 for x in args : sum += x return sum print ( arithmetic_mean ( 45 , 32 , 89 , 78 )) print ( arithmetic_mean ( 8989.8 , 78787.78 , 3453 , 78778.73 )) print ( arithmetic_mean ( 45 , 32 )) print ( arithmetic_mean ( 45 )) print ( arithmetic_mean ()) # \u5173\u952e\u5b57\u53c2\u6570\u6709\u4ec0\u4e48\u7528\uff1f\u5b83\u53ef\u4ee5\u6269\u5c55\u51fd\u6570\u7684\u529f\u80fd\u3002\u6bd4\u5982\uff0c\u5728person\u51fd\u6570\u91cc\uff0c\u6211\u4eec\u4fdd\u8bc1\u80fd\u63a5\u6536\u5230name\u548cage\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u4f46\u662f\uff0c\u5982\u679c\u8c03\u7528\u8005 # \u613f\u610f\u63d0\u4f9b\u66f4\u591a\u7684\u53c2\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u6536\u5230\u3002\u8bd5\u60f3\u4f60\u6b63\u5728\u505a\u4e00\u4e2a\u7528\u6237\u6ce8\u518c\u7684\u529f\u80fd\uff0c\u9664\u4e86\u7528\u6237\u540d\u548c\u5e74\u9f84\u662f\u5fc5\u586b\u9879\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u53ef\u9009\u9879\uff0c\u5229\u7528\u5173\u952e\u5b57 # \u53c2\u6570\u6765\u5b9a\u4e49\u8fd9\u4e2a\u51fd\u6570\u5c31\u80fd\u6ee1\u8db3\u6ce8\u518c\u7684\u9700\u6c42","title":"\u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u4e5f\u53ef\u4ee5\u4f7f\u7528kwarg=value\u7684\u5173\u952e\u5b57\u53c2\u6570\u5f62\u5f0f\u88ab\u8c03\u7528\u3002"},{"location":"Python3/#_26","text":"# \u5bf9\u4e8e\u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u7684\u8c03\u7528\u8005\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e0d\u53d7\u9650\u5236\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u81f3\u4e8e\u5230\u5e95\u4f20\u5165\u4e86\u54ea\u4e9b\uff0c\u5c31\u9700\u8981\u5728\u51fd\u6570\u5185\u90e8\u901a\u8fc7kw\u68c0\u67e5\u3002 # \u4ee5person()\u51fd\u6570\u4e3a\u4f8b\uff0c\u6211\u4eec\u5e0c\u671b\u68c0\u67e5\u662f\u5426\u6709city\u548cjob\u53c2\u6570 def person ( name , age , ** kw ): if 'city' in kw : # \u6709city\u53c2\u6570 pass if 'job' in kw : # \u6709job\u53c2\u6570 pass print ( 'name:' , name , 'age:' , age , 'other:' , kw ) # \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5fc5\u987b\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8fd9\u548c\u4f4d\u7f6e\u53c2\u6570\u4e0d\u540c\u3002\u5982\u679c\u6ca1\u6709\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8c03\u7528\u5c06\u62a5\u9519 # \u4f7f\u7528\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u65f6\uff0c\u8981\u7279\u522b\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u53d8\u53c2\u6570\uff0c\u5c31\u5fc5\u987b\u52a0\u4e00\u4e2a*\u4f5c\u4e3a\u7279\u6b8a\u5206\u9694\u7b26\u3002\u5982\u679c\u7f3a\u5c11*\uff0cPython\u89e3\u91ca\u5668\u5c06\u65e0\u6cd5\u8bc6\u522b\u4f4d\u7f6e\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff1a def person ( name , age , city , job ): # \u7f3a\u5c11 *\uff0ccity\u548cjob\u88ab\u89c6\u4e3a\u4f4d\u7f6e\u53c2\u6570 pass","title":"\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570"},{"location":"Python3/#lambda","text":"\u53ef\u4ee5\u4f7f\u7528lambda\u5173\u952e\u5b57\u521b\u5efa\u5c0f\u7684\u533f\u540d\u51fd\u6570\u3002\u6b64\u51fd\u6570\u8fd4\u56de\u5176\u4e24\u4e2a\u53c2\u6570\u7684\u603b\u548c\uff1a\u3002Lambda\u51fd\u6570\u53ef\u4ee5\u5728\u9700\u8981\u51fd\u6570\u5bf9\u8c61\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u3002\u5b83\u4eec\u5728\u8bed \u6cd5\u4e0a\u9650\u4e8e\u5355\u4e2a\u8868\u8fbe\u5f0f\u3002\u4ece\u8bed\u4e49\u4e0a\u8bb2\uff0c\u5b83\u4eec\u53ea\u662f\u6b63\u5e38\u51fd\u6570\u5b9a\u4e49\u7684\u8bed\u6cd5\u7cd6\u3002\u4e0e\u5d4c\u5957\u51fd\u6570\u5b9a\u4e49\u4e00\u6837\uff0clambda\u51fd\u6570\u53ef\u4ee5\u5f15\u7528\u5305\u542b\u8303\u56f4\u7684\u53d8\u91cf\uff1alamb da a, b: a+b # \u7528\u9014\u4e00\uff1a\u4f7f\u7528lambda\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570 def make_incrementor ( n ): return lambda x : x + n # \u7528\u9014\u4e8c\uff1a\u4f20\u9012\u4e00\u4e2a\u5c0f\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570 pairs = [( 1 , 'one' ), ( 2 , 'two' ), ( 3 , 'three' ), ( 4 , 'four' )] pairs . sort ( key = lambda pair : pair [ 1 ]) print ( pairs )","title":"Lambda\u8868\u8fbe\u5f0f"},{"location":"Python3/#_27","text":"# Python\u4e2d\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff0c\u8fd95\u79cd\u53c2\u6570\u90fd\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\u3002\u4f46\u662f\u8bf7\u6ce8\u610f # \u53c2\u6570\u5b9a\u4e49\u7684\u987a\u5e8f\u5fc5\u987b\u662f\uff1a\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u5173\u952e\u5b57\u53c2\u6570 # \u5982\u679c\u51fd\u6570\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u7684\u5b9e\u53c2\uff0c\u5fc5\u987b\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u5c06\u63a5\u7eb3\u4efb\u610f\u6570\u91cf\u5b9e\u53c2\u7684\u5f62\u53c2\u653e\u5728\u6700\u540e # \u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u5305\u542b\u4e0a\u8ff0\u82e5\u5e72\u79cd\u53c2\u6570\uff1a\u5728\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cPython\u89e3\u91ca\u5668\u81ea\u52a8\u6309\u7167\u53c2\u6570\u4f4d\u7f6e\u548c\u53c2\u6570\u540d\u628a\u5bf9\u5e94\u7684\u53c2\u6570\u4f20\u8fdb\u53bb def f1 ( a , b , c = 0 , * args , ** kw ): print ( 'a =' , a , 'b =' , b , 'c =' , c , 'args =' , args , 'kw =' , kw ) def f2 ( a , b , c = 0 , * , d , ** kw ): print ( 'a =' , a , 'b =' , b , 'c =' , c , 'd =' , d , 'kw =' , kw ) # \u6240\u4ee5\uff0c\u5bf9\u4e8e\u4efb\u610f\u51fd\u6570\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3cfunc(*args, **kw)\u7684\u5f62\u5f0f\u8c03\u7528\u5b83\uff0c\u65e0\u8bba\u5b83\u7684\u53c2\u6570\u662f\u5982\u4f55\u5b9a\u4e49\u7684\u3002","title":"\u53c2\u6570\u7ec4\u5408"},{"location":"Python3/#_28","text":"\"\"\" \u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5728\u5185\u90e8\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u9012\u5f52\u51fd\u6570.\u7406\u8bba\u4e0a\uff0c\u6240\u6709\u7684\u9012\u5f52\u51fd\u6570\u90fd\u53ef\u4ee5\u5199\u6210\u5faa\u73af\u7684\u65b9\u5f0f\uff0c\u4f46\u5faa\u73af\u7684\u903b\u8f91\u4e0d\u5982\u9012\u5f52\u6e05\u6670 \u4f7f\u7528\u9012\u5f52\u51fd\u6570\u9700\u8981\u6ce8\u610f\u9632\u6b62\u6808\u6ea2\u51fa\u3002\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u51fd\u6570\u8c03\u7528\u662f\u901a\u8fc7\u6808\uff08stack\uff09\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u5b9e\u73b0\u7684\uff0c\u6bcf\u5f53\u8fdb\u5165\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u6808\u5c31\u4f1a\u52a0\u4e00\u5c42\u6808\u5e27\uff0c\u6bcf\u5f53\u51fd\u6570\u8fd4\u56de\uff0c\u6808\u5c31\u4f1a\u51cf\u4e00\u5c42\u6808\u5e27\u3002\u7531\u4e8e\u6808\u7684\u5927\u5c0f\u4e0d\u662f\u65e0\u9650\u7684\uff0c\u6240\u4ee5\uff0c\u9012\u5f52\u8c03\u7528\u7684\u6b21\u6570\u8fc7\u591a\uff0c\u4f1a\u5bfc\u81f4\u6808\u6ea2\u51fa\u3002 \u89e3\u51b3\u9012\u5f52\u8c03\u7528\u6808\u6ea2\u51fa\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u5c3e\u9012\u5f52\u4f18\u5316\uff0c\u4e8b\u5b9e\u4e0a\u5c3e\u9012\u5f52\u548c\u5faa\u73af\u7684\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\uff0c\u628a\u5faa\u73af\u770b\u6210\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c3e\u9012\u5f52\u51fd\u6570\u4e5f\u662f\u53ef\u4ee5\u7684 \u5c3e\u9012\u5f52\u662f\u6307\uff0c\u5728\u51fd\u6570\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u5e76\u4e14\uff0creturn\u8bed\u53e5\u4e0d\u80fd\u5305\u542b\u8868\u8fbe\u5f0f\u3002\u8fd9\u6837\uff0c\u7f16\u8bd1\u5668\u6216\u8005\u89e3\u91ca\u5668\u5c31\u53ef\u4ee5\u628a\u5c3e\u9012\u5f52\u505a\u4f18\u5316\uff0c\u4f7f\u9012\u5f52\u672c\u8eab\u65e0\u8bba\u8c03\u7528\u591a\u5c11\u6b21\uff0c\u90fd\u53ea\u5360\u7528\u4e00\u4e2a\u6808\u5e27\uff0c\u4e0d\u4f1a\u51fa\u73b0\u6808\u6ea2\u51fa\u7684\u60c5\u51b5\u3002 \"\"\"","title":"\u9012\u5f52\u51fd\u6570"},{"location":"Python3/#python_5","text":"\"\"\" \u5207\u7247\u5728\u5217\u8868\u4e0a\u5c31\u50cf\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u5217\u8868\u7684\u5b50\u90e8\u5206 \u7ed9\u5b9a\u4e00\u4e2alist\u6216tuple\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7for\u5faa\u73af\u6765\u904d\u5386\u8fd9\u4e2alist\u6216tuple\uff0c\u8fd9\u79cd\u904d\u5386\u6211\u4eec\u79f0\u4e3a\u8fed\u4ee3(Iteration) \u8fed\u4ee3\u662f\u8bbf\u95ee\u96c6\u5408\u5143\u7d20\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u8fed\u4ee3\u5668\u53ef\u4ee5\u8bb0\u4f4f\u904d\u5386\u4f4d\u7f6e\u7684\u5bf9\u8c61\u3002\u8fed\u4ee3\u5668\u5bf9\u8c61\u4ece\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\u8bbf\u95ee\uff0c\u77e5\u9053\u6240\u6709\u5143\u7d20\u7ed3\u675f\uff0c\u8fed\u4ee3 \u5668\u53ea\u80fd\u5f80\u524d\uff0c\u8fed\u4ee3\u5668\u6709\u4e24\u4e2a\u65b9\u6cd5iter()\u548cnext()\u3002\u5b57\u7b26\u4e32\u3001\u5217\u8868\u548c\u5143\u7ec4\u5bf9\u8c61\u90fd\u53ef\u7528\u4e8e\u521b\u5efa\u8fed\u4ee3\u5668 \"\"\" list = [ 1 , 2 , 3 , 4 ] # \u521b\u5efa\u5217\u8868list it = iter ( list ) # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it print ( next ( it )) # \u8f93\u51fa\u8fed\u4ee3\u5668\u4e0b\u4e00\u4e2a\u5143\u7d20 # \u8fed\u4ee3\u5668\u5bf9\u8c61\u53ef\u4ee5\u7528for\u8bed\u53e5\u8fdb\u884c\u904d\u5386 list = [ 1 , 2 , 3 , 4 ] # \u521b\u5efa\u5217\u8868list it = iter ( list ) # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it for x in it : print ( x , end = \" \" ) # \u5217\u8868\u63a8\u5bfc\u5f0f\u5373List Comprehensions\uff0c\u662fPython\u5185\u7f6e\u7684\u975e\u5e38\u7b80\u5355\u5374\u5f3a\u5927\u7684\u53ef\u4ee5\u7528\u6765\u521b\u5efalist\u7684\u751f\u6210\u5f0f # for\u5faa\u73af\u540e\u9762\u8fd8\u53ef\u4ee5\u52a0\u4e0aif\u5224\u65ad\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7b5b\u9009\u51fa\u4ec5\u5076\u6570\u7684\u5e73\u65b9\uff1a print ([ x * x for x in range ( 1 , 11 ) if x % 2 == 0 ]) # \u8fd0\u7528\u5217\u8868\u63a8\u5bfc\u5f0f\uff0c\u53ef\u4ee5\u5199\u51fa\u975e\u5e38\u7b80\u6d01\u7684\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0 import os # \u5bfc\u5165os\u6a21\u5757 print ([ dir for dir in os . listdir ( '.' )]) # \u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u548c\u76ee\u5f55\u540d(\u5305\u542b\u9690\u85cf\u6587\u4ef6\u6216\u76ee\u5f55) \"\"\" \u4f7f\u7528\u4e86yield\u7684\u51fd\u6570\u79f0\u4e3a\u751f\u6210\u5668(generator)\uff0c\u751f\u6210\u5668\u662f\u4e00\u4e2a\u8fd4\u56de\u8fed\u4ee3\u5668\u7684\u51fd\u6570\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u751f\u6210\u5668\u5c31\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002\u5728\u8c03\u7528\u751f\u6210\u5668 \u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u6b21\u9047\u5230yield\u51fd\u6570\u4f1a\u6682\u505c\u5e76\u4fdd\u5b58\u5f53\u524d\u6240\u6709\u7684\u8fd0\u884c\u4fe1\u606f\uff0c\u8fd4\u56deyield\u7684\u503c\uff0c\u5e76\u5728\u4e0b\u4e00\u6b21next()\u65b9\u6cd5\u4ece\u5f53\u524d\u4f4d\u7f6e\u7ee7\u7eed\u8fd0\u884c\u3002 \"\"\" # \u4f7f\u7528\u751f\u6210\u5668\u751f\u6210\u6590\u6ce2\u90a3\u5951\u6570\u5217,\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff1a\u5373\u4e24\u4e2a\u5143\u7d20\u7684\u548c\u786e\u5b9a\u4e0b\u4e00\u4e2a\u6570 import sys def fibonacci ( x ): a , b , count = 0 , 1 , 0 while True : if ( count > x ): return yield a # \u5c06fibonacci\u51fd\u6570\u53d8\u6210generator\uff0cprint(a)\u6539\u6210yield a a , b = b , a + b count += 1 f = fibonacci ( 21 ) # f\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u7531\u751f\u6210\u5668\u8fd4\u56de\u751f\u6210 while True : try : print ( next ( f ), end = \"\" ) except StopIteration : sys . exit () # \u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u6570\u636e\u7c7b\u578b\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a # \u4e00\u662f\u96c6\u5408\u6570\u636e\u7c7b\u578b\uff0c\u5982list\u3001tuple\u3001dict\u3001set\u3001str\u7b49\uff1b # \u4e8c\u662fgenerator\uff0c\u5305\u62ec\u751f\u6210\u5668\u548c\u5e26yield\u7684generator function\u3002 # \u8fd9\u4e9b\u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u7edf\u79f0\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1aIterable # \u53ef\u4ee5\u4f7f\u7528isinstance()\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662fIterable\u5bf9\u8c61 # \u751f\u6210\u5668\u90fd\u662fIterator\u5bf9\u8c61\uff0c\u4f46list\u3001dict\u3001str\u867d\u7136\u662fIterable\uff0c\u5374\u4e0d\u662fIterator\u3002\u628alist\u3001dict\u3001str\u7b49Iterable\u53d8\u6210Iterator\u53ef\u4ee5\u4f7f\u7528iter()\u51fd\u6570 \"\"\" \u4e3a\u4ec0\u4e48list\u3001dict\u3001str\u7b49\u6570\u636e\u7c7b\u578b\u4e0d\u662fIterator? \u8fd9\u662f\u56e0\u4e3aPython\u7684Iterator\u5bf9\u8c61\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u636e\u6d41\uff0cIterator\u5bf9\u8c61\u53ef\u4ee5\u88abnext()\u51fd\u6570\u8c03\u7528\u5e76\u4e0d\u65ad\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u76f4\u5230\u6ca1\u6709\u6570\u636e\u65f6\u629b\u51fa StopIteration\u9519\u8bef\u3002\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u636e\u6d41\u770b\u505a\u662f\u4e00\u4e2a\u6709\u5e8f\u5e8f\u5217\uff0c\u4f46\u6211\u4eec\u5374\u4e0d\u80fd\u63d0\u524d\u77e5\u9053\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u53ea\u80fd\u4e0d\u65ad\u901a\u8fc7next()\u51fd\u6570\u5b9e\u73b0\u6309\u9700\u8ba1\u7b97 \u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u6240\u4ee5Iterator\u7684\u8ba1\u7b97\u662f\u60f0\u6027\u7684\uff0c\u53ea\u6709\u5728\u9700\u8981\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\u65f6\u5b83\u624d\u4f1a\u8ba1\u7b97\u3002 \"\"\" # Iterator\u751a\u81f3\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u65e0\u9650\u5927\u7684\u6570\u636e\u6d41\uff0c\u4f8b\u5982\u5168\u4f53\u81ea\u7136\u6570\u3002\u800c\u4f7f\u7528list\u662f\u6c38\u8fdc\u4e0d\u53ef\u80fd\u5b58\u50a8\u5168\u4f53\u81ea\u7136\u6570\u7684 # \u603b\u7ed3\uff1a # \u51e1\u662f\u53ef\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u90fd\u662fIterable\u7c7b\u578b\uff1b # \u51e1\u662f\u53ef\u4f5c\u7528\u4e8enext()\u51fd\u6570\u7684\u5bf9\u8c61\u90fd\u662fIterator\u7c7b\u578b\uff0c\u5b83\u4eec\u8868\u793a\u4e00\u4e2a\u60f0\u6027\u8ba1\u7b97\u7684\u5e8f\u5217\uff1b # \u96c6\u5408\u6570\u636e\u7c7b\u578b\u5982list\u3001dict\u3001str\u7b49\u662fIterable\u4f46\u4e0d\u662fIterator\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u901a\u8fc7iter()\u51fd\u6570\u83b7\u5f97\u4e00\u4e2aIterator\u5bf9\u8c61\u3002 # Python\u7684for\u5faa\u73af\u672c\u8d28\u4e0a\u5c31\u662f\u901a\u8fc7\u4e0d\u65ad\u8c03\u7528next()\u51fd\u6570\u5b9e\u73b0\u7684\uff0c\u4f8b\u5982\uff1a for x in [ 1 , 2 , 3 , 4 , 5 ]: pass # \u5b9e\u9645\u4e0a\u5b8c\u5168\u7b49\u4ef7\u4e8e\uff1a # \u9996\u5148\u83b7\u5f97Iterator\u5bf9\u8c61: it = iter ([ 1 , 2 , 3 , 4 , 5 ]) # \u5faa\u73af: while True : try : # \u83b7\u5f97\u4e0b\u4e00\u4e2a\u503c: x = next ( it ) except StopIteration : # \u9047\u5230StopIteration\u5c31\u9000\u51fa\u5faa\u73af break","title":"python\u9ad8\u7ea7\u7279\u6027\uff1a\u5207\u7247\u3001\u8fed\u4ee3\u3001\u5217\u8868\u63a8\u5bfc\u5f0f\u3001\u751f\u6210\u5668\u3001\u8fed\u4ee3\u5668"},{"location":"Python3/#_29","text":"","title":"\u9762\u5411\u5bf9\u8c61"},{"location":"Python3/#class","text":"\u5f53Python\u89e3\u91ca\u5668\u8bfb\u53d6\u6e90\u6587\u4ef6\u65f6\uff0c\u5b83\u4f1a\u6267\u884c\u6240\u6709\u4ee3\u7801\u3002\u6b64__name__\u68c0\u67e5\u786e\u4fdd\u4ec5\u5728\u6b64\u6a21\u5757\u662f\u4e3b\u7a0b\u5e8f(main)\u65f6\u624d\u6267\u884c\u6b64\u4ee3\u7801\u5757\u3002","title":"\u7c7b(Class)"},{"location":"Python3/#inheritance","text":"","title":"\u7ee7\u627f(Inheritance)"},{"location":"Python3/#multiple-inheritance","text":"","title":"\u591a\u91cd\u7ee7\u627f(Multiple Inheritance)"},{"location":"Python3/#_30","text":"Python\u4e2d\u6240\u6709\u5f02\u5e38\u5fc5\u987b\u4e3a\u4e00\u4e2a\u6d3e\u751f\u81eaBaseException\u7c7b\u7684\u5b9e\u4f8b\u3002\u5728try\u5e26\u6709except\u63d0\u53ca\u7279\u5b9a\u7c7b\u7684\u5b50\u53e5\u7684\u8bed\u53e5\u4e2d\uff0c\u8be5\u5b50\u53e5\u4e5f\u4f1a\u5904\u7406\u4efb\u4f55\u6d3e\u751f\u81ea \u8be5\u7c7b\u7684\u5f02\u5e38\u7c7b,(\u4f46\u4e0d\u5904\u7406\u5b83\u6240\u6d3e\u751f\u51fa\u7684\u5f02\u5e38\u7c7b)\u901a\u8fc7\u5b50\u7c7b\u5316\u521b\u5efa\u7684\u4e24\u4e2a\u4e0d\u76f8\u5173\u5f02\u5e38\u7c7b\u6c38\u8fdc\u662f\u4e0d\u7b49\u6548\u7684\uff0c\u65e2\u4f7f\u5b83\u4eec\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002 try...except\u8bed\u53e5\u6709\u4e00\u4e2a\u53ef\u9009\u7684else\u5b57\u53e5\uff0c\u4f7f\u7528\u65f6\u5fc5\u987b\u653e\u5728\u6240\u6709except\u5b57\u53e5\u540e\u9762\uff0craise\u8bed\u53e5\u5141\u8bb8\u7a0b\u5e8f\u5f3a\u5236\u53d1\u751f\u6307\u5b9a\u7684\u5f02\u5e38\uff0craise\u552f\u4e00\u7684 \u53c2\u6570\u5c31\u662f\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u8fd9\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u5f02\u5e38\u5b9e\u4f8b\u6216\u4e00\u4e2a\u5f02\u5e38\u7c7b(\u6d3e\u751f\u81eaException\u7684\u7c7b)","title":"\u5185\u7f6e\u5f02\u5e38"},{"location":"Python3/#base-classes","text":"\u4ee5\u4e0b\u5f02\u5e38\u4e3b\u8981\u88ab\u7528\u4f5c\u5176\u4ed6\u5f02\u5e38\u7684\u57fa\u7c7b \u8be6\u60c5\u8bf7\u70b9\u51fb\u6b64\u5904\u67e5\u770b","title":"\u57fa\u7c7b(Base classes)"},{"location":"Python3/#concrete-exceptions","text":"\u70b9\u51fb\u6b64\u5904\u67e5\u770b","title":"Concrete exceptions"},{"location":"Python3/#os","text":"\u70b9\u51fb\u6b64\u5904\u67e5\u770b","title":"OS \u5f02\u5e38"},{"location":"Python3/#_31","text":"\u8be6\u60c5\u70b9\u51fb\u6b64\u5904\u67e5\u770b","title":"\u8b66\u544a"},{"location":"Python3/#_32","text":"BaseException + -- SystemExit + -- KeyboardInterrupt + -- GeneratorExit + -- Exception + -- StopIteration + -- StopAsyncIteration + -- ArithmeticError | + -- FloatingPointError | + -- OverflowError | + -- ZeroDivisionError + -- AssertionError + -- AttributeError + -- BufferError + -- EOFError + -- ImportError | + -- ModuleNotFoundError + -- LookupError | + -- IndexError | + -- KeyError + -- MemoryError + -- NameError | + -- UnboundLocalError + -- OSError | + -- BlockingIOError | + -- ChildProcessError | + -- ConnectionError | | + -- BrokenPipeError | | + -- ConnectionAbortedError | | + -- ConnectionRefusedError | | + -- ConnectionResetError | + -- FileExistsError | + -- FileNotFoundError | + -- InterruptedError | + -- IsADirectoryError | + -- NotADirectoryError | + -- PermissionError | + -- ProcessLookupError | + -- TimeoutError + -- ReferenceError + -- RuntimeError | + -- NotImplementedError | + -- RecursionError + -- SyntaxError | + -- IndentationError | + -- TabError + -- SystemError + -- TypeError + -- ValueError | + -- UnicodeError | + -- UnicodeDecodeError | + -- UnicodeEncodeError | + -- UnicodeTranslateError + -- Warning + -- DeprecationWarning + -- PendingDeprecationWarning + -- RuntimeWarning + -- SyntaxWarning + -- UserWarning + -- FutureWarning + -- ImportWarning + -- UnicodeWarning + -- BytesWarning + -- ResourceWarning","title":"\u5f02\u5e38\u5c42\u6b21\u7ed3\u6784"},{"location":"Python3/#_33","text":"","title":"\u6587\u672c\u5904\u7406\u670d\u52a1"},{"location":"Python3/#_34","text":"\u5b57\u7b26\u4e32 \u63cf\u8ff0 string.capwords(s, sep) \u5c06\u4ee5sep\u5206\u5272\u7684\u5b57\u7b26\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u6ca1\u6709sep\u9ed8\u8ba4\u662f\u9996\u5b57\u6bcd string.ascii_letters \u4ee5\u4e0blowercase\u548cuppercase\u4e24\u4e2a\u5e38\u91cf\u7684\u4e32\u8054 string.ascii_lowercase \u5c0f\u5199\u5b57\u6bcdabcdefghijklmnopqrstuvwxyz string.ascii_uppercase \u5927\u5199\u5b57\u6bcdABCDEFGHIJKLMNOPQRSTUVWXYZ string.digits \u5b57\u7b26\u4e320123456789 string.hexdigits \u5b57\u7b26\u4e320123456789abcdefABCDEF string.octdigits \u5b57\u7b26\u4e3201234567 string.punctuation ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32,\u5728C\u8bed\u8a00\u73af\u5883\u4e2d\u88ab\u89c6\u4e3a\u6807\u70b9\u5b57\u7b26 string.printable \u88ab\u89c6\u4e3a\u53ef\u6253\u5370\u7684ASCII\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ec4\u5408digits\u3001ascii_letters\u3001punctuation\u3001whitespace string.whitespace \u5305\u542b\u6240\u6709\u88ab\u89c6\u4e3a\u7a7a\u683c\u7684ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff0c\u5305\u62ec\u5b57\u7b26\u95f4\u9694,tab, linefeed, return, formfeed, and vertical tab","title":"\u5e38\u89c1\u5b57\u7b26\u4e32\u64cd\u4f5c"},{"location":"Python3/#_35","text":"str.format()\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528{}\u62ec\u8d77\u6765\u8981\u66ff\u6362\u7684\u5b57\u6bb5\uff0c\u4e0d\u5728\u82b1\u62ec\u53f7\u4e4b\u5185\u7684\u5185\u5bb9\u4f1a\u4e0d\u52a0\u4fee\u6539\u7684\u6253\u5370\u5230\u8f93\u51fa\u4e2d\u3002\u5b83\u5c06\u4e0d\u52a0\u6539\u53d8\u5730\u590d\u5236\u5230 \u8f93\u51fa\u4e2d\u3002\u5982\u679c\u4f60\u9700\u8981\u5728\u6587\u5b57\u6587\u672c\u4e2d\u5305\u542b\u4e00\u4e2a\u5927\u62ec\u53f7\u5b57\u7b26\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0\u500d\u6765\u8f6c\u4e49\uff1a{{ }} \u66ff\u6362\u5b57\u6bb5\u8bed\u6cd5\u5982\u4e0b\uff1a replacement_field :: = \" { \" [ field_name ] [ \" ! \" conversion ] [ \" : \" format_spec ] \" } \" field_name :: = arg_name ( \" . \" attribute_name | \" [ \" element_index \" ] \" ) * arg_name :: = [ identifier | digit + ] attribute_name :: = identifier element_index :: = digit + | index_string index_string :: = < any source character except \" ] \" > + conversion :: = \" r \" | \" s \" | \" a \" format_spec :: = < described in the next section > # \u793a\u4f8b\uff1a >>> \" {} can be {} \" . format ( \" Strings \" , \" interpolated \" ) >>> \" {0} be nimble, {0} be quick, {0} jump over the {1} \" . format ( \" Jack \" , \" candle stick \" ) >>> \" {name} wants to eat {food} \" . format ( name = \" Bob \" , food = \" lasagna \" ) >>> \" %s can be %s the %s way \" % ( \" Strings \" , \" interpolated \" , \" old \" )","title":"\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u8bed\u6cd5"},{"location":"Python3/#mini-language","text":"# \u683c\u5f0f\u5316\u6574\u6570\u548c\u6d6e\u70b9\u6570\u8fd8\u53ef\u4ee5\u6307\u5b9a\u662f\u5426\u88650\u548c\u6574\u6570\u4e0e\u5c0f\u6570\u7684\u4f4d\u6570\uff1a print ( ' %2d - %02d ' % ( 3 , 1 )) print ( ' %.2f ' % 3.1415926 ) # \u5b57\u7b26\u4e32\u91cc\u9762\u7684%\u662f\u4e00\u4e2a\u666e\u901a\u5b57\u7b26\u600e\u4e48\u529e\uff1f\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u8f6c\u4e49\uff0c\u7528%%\u6765\u8868\u793a\u4e00\u4e2a% # \u5229\u7528format()\u65b9\u6cd5\u8fdb\u884c\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u5b83\u4f1a\u7528\u4f20\u5165\u7684\u53c2\u6570\u4f9d\u6b21\u66ff\u6362\u5b57\u7b26\u4e32\u5185\u7684\u5360\u4f4d\u7b26{0},{1}......,\u4f46\u8981\u6bd4\u5360\u4f4d\u7b26\u9ebb\u70e6\u3002 'Hello, {0}, \u6210\u7ee9\u63d0\u5347\u4e86 {1:.1f}%' . format ( '\u5c0f\u660e' , 17.125 ) \u5b57\u7b26\u4e32 % \u64cd\u4f5c\uff0cpython\u6709\u4e00\u4e2aprintf\u683c\u5f0f\u5c06\u5b57\u7b26\u4e32\u653e\u5728\u4e00\u8d77\uff0c%\u64cd\u4f5c\u7b26\u5c06\u5de6\u8fb9(%d int, %s string, %f\u6216%g floating point)\u4ee5printf-type\u683c\u5f0f\u5316\uff0c\u5339\u914d\u5728\u53f3\u8fb9\u7684\u5143\u7ec4\u91cc\u7684\u503c \u683c\u5f0f\u5316\u7b26\u53f7 \u66ff\u6362\u5185\u5bb9\u7c7b\u578b %s \u5b57\u7b26\u4e32 %d \u5341\u8fdb\u5236\u6574\u6570 %x \u5341\u516d\u8fdb\u5236\u6574\u6570 %f \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d %g \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d,\u4e0d\u5c3e\u968f0","title":"Mini-Language\u683c\u5f0f\u5316"},{"location":"Python3/#re-","text":"re\u6a21\u5757\u4e0ePerl\u8bed\u8a00\u7c7b\u4f3c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u64cd\u4f5c\uff0c\u6a21\u5f0f\u548c\u88ab\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u4f7fUnicode\u5b57\u7b26\u4e32\u4e5f\u53ef\u4ee5\u662f8\u4e3a\u5b57\u8282\u4e32(bytes)\uff0c\u4f46Unicode\u548c 8\u4f4d\u5b57\u8282\u4e32\u4e0d\u80fd\u6df7\u7528\u3002\u56e0\u53cd\u659c\u6760\\\u5728Python\u4e2d\u548c\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\uff0c\u90fd\u5177\u6709\u5c06\u628a\u7279\u6b8a\u5b57\u7b26\u8f6c\u6362\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\u7684\u4f5c\u7528\u3002\u6240\u4ee5\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f \u8981\u5199\u6210 \\\\\\\\ \u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5bf9\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u6837\u5f0f\u7528\u5e26\u6709r\u524d\u7f00\u7684\u8868\u793aPython\u539f\u59cb\u5b57\u7b26\u7684\u65b9\u6cd5 \u5e38\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff1a \u8be6\u7ec6\u70b9\u51fb\u6b64\u5904\u4e86\u89e3 re.search(pattern, string, flags=0) \u67e5\u627e\u5728string\u4e2d\u4e0epattern\u5339\u914d\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u5b57\u7b26\uff0c\u5e76\u8fd4\u56de\u5339\u914d\u5bf9\u8c61\u548c\u4f4d\u7f6e\u3002\u5982\u679cstring\u4e2d\u6ca1\u6709 \u4e0e\u6a21\u5f0f\u5339\u914d\uff0c\u5219\u8fd4\u56deNone","title":"re--\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Python3/#difflib-helpers-for-computing-deltas","text":"| :------: | :------: | \u8be6\u7ec6\u70b9\u51fb\u6b64\u5904\u4e86\u89e3","title":"difflib -- helpers for computing deltas"},{"location":"Python3/#textwrap","text":"\u901a\u8fc7\u8c03\u6574\u6bb5\u843d\u4e2d\u51fa\u73b0\u6362\u884c\u7b26\u7684\u4f4d\u7f6e\u6765\u683c\u5f0f\u5316\u6587\u672c\u3002TextWrapper\u6784\u9020\u51fd\u6570\u63a5\u53d7\u8bb8\u591a\u53ef\u9009\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u6bcf\u4e2a\u5173\u952e\u5b57\u53c2\u6570\u5bf9\u5e94\u4e00\u4e2a\u5b9e\u4f8b\u5c5e\u6027 textwrap.wrap(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u6bb5\u843d\uff0c\u8f93\u51fa\u4ee5\u957f\u5ea6\u5212\u5206\u7684\u884c\u5217\u8868 textwrap.fill(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u4e3a\u65b0\u7684\u4e00\u884c textwrap.shorten(text, width, **kwargs) \u622a\u65ad\u7ed9\u5b9a\u6587\u672c\u4ee5\u9002\u5408\u7ed9\u5b9a\u5bbd\u5ea6\u5e76\u4ee5[...]\u6298\u53e0\u88ab\u622a\u65ad\u7684\u6587\u672c textwrap.dedent(text) \u4ece\u6587\u672c\u7684\u6bcf\u4e00\u884c\u4e2d\u5220\u9664\u4efb\u4f55\u5e38\u89c1\u7684\u524d\u5bfc\u7a7a\u683c\u3001\u5236\u8868\u7b26 textwrap.indent(text, prefix, predicate=None) \u5728\u6587\u672c\u4e2d\u9009\u5b9a\u884c\u7684\u5f00\u5934\u6dfb\u52a0\u524d\u7f00 unicodedata stringprep readline rlcompleter","title":"textwrap"},{"location":"Python3/#binary-data-services","text":"struct \u2014 Interpret bytes as packed binary data codecs \u2014 Codec registry and base classes","title":"Binary Data Services"},{"location":"Python3/#_36","text":"","title":"\u5f00\u53d1\u8005\u5de5\u5177"},{"location":"Python3/#unittest","text":"unittest.TestCase\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u65ad\u8a00\u65b9\u6cd5\uff0c\u65ad\u8a00\u65b9\u6cd5\u7528\u4e8e\u68c0\u9a8c\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\u671f\u671b\u7684\u7ed3\u679c unittest\u7c7b\u7684\u65ad\u8a00\u65b9\u6cd5 \u65b9\u6cd5 \u7528\u9014 assertEqual(a, b) \u6838\u5b9ea == b assertNotEqual(a, b) \u6838\u5b9ea != b assertTrue(x) \u6838\u5b9ex\u4e3aTrue assertFalse(x) \u6838\u5b9ex\u4e3aFalse assertIn(item, list) \u6838\u5b9eitem\u5728list\u4e2d assertNotIn(item, list) \u6838\u5b9eitem\u4e0d\u5728list\u4e2d","title":"unittest"},{"location":"RabbitMQ/","text":"","title":"RabbitMQ"},{"location":"Redis/","text":"redis\u914d\u7f6e\u6587\u4ef6 # Redis configuration file example. # # Note that in order to read the configuration file, Redis must be # started with the file path as first argument: # # ./redis-server /path/to/redis.conf # Note on units: when memory size is needed, it is possible to specify # it in the usual form of 1k 5GB 4M and so forth: # # 1k => 1000 bytes # 1kb => 1024 bytes # 1m => 1000000 bytes # 1mb => 1024*1024 bytes # 1g => 1000000000 bytes # 1gb => 1024*1024*1024 bytes # # units are case insensitive so 1GB 1Gb 1gB are all the same. ################################## INCLUDES ################################### # Include one or more other config files here. This is useful if you # have a standard template that goes to all Redis servers but also need # to customize a few per-server settings. Include files can include # other files, so use this wisely. # # Notice option \"include\" won't be rewritten by command \"CONFIG REWRITE\" # from admin or Redis Sentinel. Since Redis always uses the last processed # line as value of a configuration directive, you'd better put includes # at the beginning of this file to avoid overwriting config change at runtime. # # If instead you are interested in using includes to override configuration # options, it is better to use include as the last line. # # include /path/to/local.conf # include /path/to/other.conf ################################## MODULES ##################################### # Load modules at startup. If the server is not able to load modules # it will abort. It is possible to use multiple loadmodule directives. # # loadmodule /path/to/my_module.so # loadmodule /path/to/other_module.so ################################## NETWORK ##################################### # By default, if no \"bind\" configuration directive is specified, Redis listens # for connections from all the network interfaces available on the server. # It is possible to listen to just one or multiple selected interfaces using # the \"bind\" configuration directive, followed by one or more IP addresses. # # Examples: # # bind 192.168.1.100 10.0.0.1 # bind 127.0.0.1 ::1 # # ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the # internet, binding to all the interfaces is dangerous and will expose the # instance to everybody on the internet. So by default we uncomment the # following bind directive, that will force Redis to listen only into # the IPv4 lookback interface address (this means Redis will be able to # accept connections only from clients running into the same computer it # is running). # # IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES # JUST COMMENT THE FOLLOWING LINE. # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ bind 127.0.0.1 # Protected mode is a layer of security protection, in order to avoid that # Redis instances left open on the internet are accessed and exploited. # # When protected mode is on and if: # # 1) The server is not binding explicitly to a set of addresses using the # \"bind\" directive. # 2) No password is configured. # # The server only accepts connections from clients connecting from the # IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain # sockets. # # By default protected mode is enabled. You should disable it only if # you are sure you want clients from other hosts to connect to Redis # even if no authentication is configured, nor a specific set of interfaces # are explicitly listed using the \"bind\" directive. protected-mode yes # Accept connections on the specified port, default is 6379 (IANA #815344). # If port 0 is specified Redis will not listen on a TCP socket. port 6379 # TCP listen() backlog. # # In high requests-per-second environments you need an high backlog in order # to avoid slow clients connections issues. Note that the Linux kernel # will silently truncate it to the value of /proc/sys/net/core/somaxconn so # make sure to raise both the value of somaxconn and tcp_max_syn_backlog # in order to get the desired effect. tcp-backlog 511 # Unix socket. # # Specify the path for the Unix socket that will be used to listen for # incoming connections. There is no default, so Redis will not listen # on a unix socket when not specified. # # unixsocket /tmp/redis.sock # unixsocketperm 700 # Close the connection after a client is idle for N seconds (0 to disable) timeout 0 # TCP keepalive. # # If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence # of communication. This is useful for two reasons: # # 1) Detect dead peers. # 2) Take the connection alive from the point of view of network # equipment in the middle. # # On Linux, the specified value (in seconds) is the period used to send ACKs. # Note that to close the connection the double of the time is needed. # On other kernels the period depends on the kernel configuration. # # A reasonable value for this option is 300 seconds, which is the new # Redis default starting with Redis 3.2.1. tcp-keepalive 300 ################################# GENERAL ##################################### # By default Redis does not run as a daemon. Use 'yes' if you need it. # Note that Redis will write a pid file in /var/run/redis.pid when daemonized. daemonize no # If you run Redis from upstart or systemd, Redis can interact with your # supervision tree. Options: # supervised no - no supervision interaction # supervised upstart - signal upstart by putting Redis into SIGSTOP mode # supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET # supervised auto - detect upstart or systemd method based on # UPSTART_JOB or NOTIFY_SOCKET environment variables # Note: these supervision methods only signal \"process is ready.\" # They do not enable continuous liveness pings back to your supervisor. supervised no # If a pid file is specified, Redis writes it where specified at startup # and removes it at exit. # # When the server runs non daemonized, no pid file is created if none is # specified in the configuration. When the server is daemonized, the pid file # is used even if not specified, defaulting to \"/var/run/redis.pid\". # # Creating a pid file is best effort: if Redis is not able to create it # nothing bad happens, the server will start and run normally. pidfile /var/run/redis_6379.pid # Specify the server verbosity level. # This can be one of: # debug (a lot of information, useful for development/testing) # verbose (many rarely useful info, but not a mess like the debug level) # notice (moderately verbose, what you want in production probably) # warning (only very important / critical messages are logged) loglevel notice # Specify the log file name. Also the empty string can be used to force # Redis to log on the standard output. Note that if you use standard # output for logging but daemonize, logs will be sent to /dev/null logfile \"\" # To enable logging to the system logger, just set 'syslog-enabled' to yes, # and optionally update the other syslog parameters to suit your needs. # syslog-enabled no # Specify the syslog identity. # syslog-ident redis # Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7. # syslog-facility local0 # Set the number of databases. The default database is DB 0, you can select # a different one on a per-connection basis using SELECT <dbid> where # dbid is a number between 0 and 'databases'-1 databases 16 # By default Redis shows an ASCII art logo only when started to log to the # standard output and if the standard output is a TTY. Basically this means # that normally a logo is displayed only in interactive sessions. # # However it is possible to force the pre-4.0 behavior and always show a # ASCII art logo in startup logs by setting the following option to yes. always-show-logo yes ################################ SNAPSHOTTING ################################ # # Save the DB on disk: # # save <seconds> <changes> # # Will save the DB if both the given number of seconds and the given # number of write operations against the DB occurred. # # In the example below the behaviour will be to save: # after 900 sec (15 min) if at least 1 key changed # after 300 sec (5 min) if at least 10 keys changed # after 60 sec if at least 10000 keys changed # # Note: you can disable saving completely by commenting out all \"save\" lines. # # It is also possible to remove all the previously configured save # points by adding a save directive with a single empty string argument # like in the following example: # # save \"\" save 900 1 save 300 10 save 60 10000 # By default Redis will stop accepting writes if RDB snapshots are enabled # (at least one save point) and the latest background save failed. # This will make the user aware (in a hard way) that data is not persisting # on disk properly, otherwise chances are that no one will notice and some # disaster will happen. # # If the background saving process will start working again Redis will # automatically allow writes again. # # However if you have setup your proper monitoring of the Redis server # and persistence, you may want to disable this feature so that Redis will # continue to work as usual even if there are problems with disk, # permissions, and so forth. stop-writes-on-bgsave-error yes # Compress string objects using LZF when dump .rdb databases? # For default that's set to 'yes' as it's almost always a win. # If you want to save some CPU in the saving child set it to 'no' but # the dataset will likely be bigger if you have compressible values or keys. rdbcompression yes # Since version 5 of RDB a CRC64 checksum is placed at the end of the file. # This makes the format more resistant to corruption but there is a performance # hit to pay (around 10%) when saving and loading RDB files, so you can disable it # for maximum performances. # # RDB files created with checksum disabled have a checksum of zero that will # tell the loading code to skip the check. rdbchecksum yes # The filename where to dump the DB dbfilename dump.rdb # The working directory. # # The DB will be written inside this directory, with the filename specified # above using the 'dbfilename' configuration directive. # # The Append Only File will also be created inside this directory. # # Note that you must specify a directory here, not a file name. dir ./ ################################# REPLICATION ################################# # Master-Slave replication. Use slaveof to make a Redis instance a copy of # another Redis server. A few things to understand ASAP about Redis replication. # # 1) Redis replication is asynchronous, but you can configure a master to # stop accepting writes if it appears to be not connected with at least # a given number of slaves. # 2) Redis slaves are able to perform a partial resynchronization with the # master if the replication link is lost for a relatively small amount of # time. You may want to configure the replication backlog size (see the next # sections of this file) with a sensible value depending on your needs. # 3) Replication is automatic and does not need user intervention. After a # network partition slaves automatically try to reconnect to masters # and resynchronize with them. # # slaveof <masterip> <masterport> # If the master is password protected (using the \"requirepass\" configuration # directive below) it is possible to tell the slave to authenticate before # starting the replication synchronization process, otherwise the master will # refuse the slave request. # # masterauth <master-password> # When a slave loses its connection with the master, or when the replication # is still in progress, the slave can act in two different ways: # # 1) if slave-serve-stale-data is set to 'yes' (the default) the slave will # still reply to client requests, possibly with out of date data, or the # data set may just be empty if this is the first synchronization. # # 2) if slave-serve-stale-data is set to 'no' the slave will reply with # an error \"SYNC with master in progress\" to all the kind of commands # but to INFO and SLAVEOF. # slave-serve-stale-data yes # You can configure a slave instance to accept writes or not. Writing against # a slave instance may be useful to store some ephemeral data (because data # written on a slave will be easily deleted after resync with the master) but # may also cause problems if clients are writing to it because of a # misconfiguration. # # Since Redis 2.6 by default slaves are read-only. # # Note: read only slaves are not designed to be exposed to untrusted clients # on the internet. It's just a protection layer against misuse of the instance. # Still a read only slave exports by default all the administrative commands # such as CONFIG, DEBUG, and so forth. To a limited extent you can improve # security of read only slaves using 'rename-command' to shadow all the # administrative / dangerous commands. slave-read-only yes # Replication SYNC strategy: disk or socket. # # ------------------------------------------------------- # WARNING: DISKLESS REPLICATION IS EXPERIMENTAL CURRENTLY # ------------------------------------------------------- # # New slaves and reconnecting slaves that are not able to continue the replication # process just receiving differences, need to do what is called a \"full # synchronization\". An RDB file is transmitted from the master to the slaves. # The transmission can happen in two different ways: # # 1) Disk-backed: The Redis master creates a new process that writes the RDB # file on disk. Later the file is transferred by the parent # process to the slaves incrementally. # 2) Diskless: The Redis master creates a new process that directly writes the # RDB file to slave sockets, without touching the disk at all. # # With disk-backed replication, while the RDB file is generated, more slaves # can be queued and served with the RDB file as soon as the current child producing # the RDB file finishes its work. With diskless replication instead once # the transfer starts, new slaves arriving will be queued and a new transfer # will start when the current one terminates. # # When diskless replication is used, the master waits a configurable amount of # time (in seconds) before starting the transfer in the hope that multiple slaves # will arrive and the transfer can be parallelized. # # With slow disks and fast (large bandwidth) networks, diskless replication # works better. repl-diskless-sync no # When diskless replication is enabled, it is possible to configure the delay # the server waits in order to spawn the child that transfers the RDB via socket # to the slaves. # # This is important since once the transfer starts, it is not possible to serve # new slaves arriving, that will be queued for the next RDB transfer, so the server # waits a delay in order to let more slaves arrive. # # The delay is specified in seconds, and by default is 5 seconds. To disable # it entirely just set it to 0 seconds and the transfer will start ASAP. repl-diskless-sync-delay 5 # Slaves send PINGs to server in a predefined interval. It's possible to change # this interval with the repl_ping_slave_period option. The default value is 10 # seconds. # # repl-ping-slave-period 10 # The following option sets the replication timeout for: # # 1) Bulk transfer I/O during SYNC, from the point of view of slave. # 2) Master timeout from the point of view of slaves (data, pings). # 3) Slave timeout from the point of view of masters (REPLCONF ACK pings). # # It is important to make sure that this value is greater than the value # specified for repl-ping-slave-period otherwise a timeout will be detected # every time there is low traffic between the master and the slave. # # repl-timeout 60 # Disable TCP_NODELAY on the slave socket after SYNC? # # If you select \"yes\" Redis will use a smaller number of TCP packets and # less bandwidth to send data to slaves. But this can add a delay for # the data to appear on the slave side, up to 40 milliseconds with # Linux kernels using a default configuration. # # If you select \"no\" the delay for data to appear on the slave side will # be reduced but more bandwidth will be used for replication. # # By default we optimize for low latency, but in very high traffic conditions # or when the master and slaves are many hops away, turning this to \"yes\" may # be a good idea. repl-disable-tcp-nodelay no # Set the replication backlog size. The backlog is a buffer that accumulates # slave data when slaves are disconnected for some time, so that when a slave # wants to reconnect again, often a full resync is not needed, but a partial # resync is enough, just passing the portion of data the slave missed while # disconnected. # # The bigger the replication backlog, the longer the time the slave can be # disconnected and later be able to perform a partial resynchronization. # # The backlog is only allocated once there is at least a slave connected. # # repl-backlog-size 1mb # After a master has no longer connected slaves for some time, the backlog # will be freed. The following option configures the amount of seconds that # need to elapse, starting from the time the last slave disconnected, for # the backlog buffer to be freed. # # Note that slaves never free the backlog for timeout, since they may be # promoted to masters later, and should be able to correctly \"partially # resynchronize\" with the slaves: hence they should always accumulate backlog. # # A value of 0 means to never release the backlog. # # repl-backlog-ttl 3600 # The slave priority is an integer number published by Redis in the INFO output. # It is used by Redis Sentinel in order to select a slave to promote into a # master if the master is no longer working correctly. # # A slave with a low priority number is considered better for promotion, so # for instance if there are three slaves with priority 10, 100, 25 Sentinel will # pick the one with priority 10, that is the lowest. # # However a special priority of 0 marks the slave as not able to perform the # role of master, so a slave with priority of 0 will never be selected by # Redis Sentinel for promotion. # # By default the priority is 100. slave-priority 100 # It is possible for a master to stop accepting writes if there are less than # N slaves connected, having a lag less or equal than M seconds. # # The N slaves need to be in \"online\" state. # # The lag in seconds, that must be <= the specified value, is calculated from # the last ping received from the slave, that is usually sent every second. # # This option does not GUARANTEE that N replicas will accept the write, but # will limit the window of exposure for lost writes in case not enough slaves # are available, to the specified number of seconds. # # For example to require at least 3 slaves with a lag <= 10 seconds use: # # min-slaves-to-write 3 # min-slaves-max-lag 10 # # Setting one or the other to 0 disables the feature. # # By default min-slaves-to-write is set to 0 (feature disabled) and # min-slaves-max-lag is set to 10. # A Redis master is able to list the address and port of the attached # slaves in different ways. For example the \"INFO replication\" section # offers this information, which is used, among other tools, by # Redis Sentinel in order to discover slave instances. # Another place where this info is available is in the output of the # \"ROLE\" command of a master. # # The listed IP and address normally reported by a slave is obtained # in the following way: # # IP: The address is auto detected by checking the peer address # of the socket used by the slave to connect with the master. # # Port: The port is communicated by the slave during the replication # handshake, and is normally the port that the slave is using to # list for connections. # # However when port forwarding or Network Address Translation (NAT) is # used, the slave may be actually reachable via different IP and port # pairs. The following two options can be used by a slave in order to # report to its master a specific set of IP and port, so that both INFO # and ROLE will report those values. # # There is no need to use both the options if you need to override just # the port or the IP address. # # slave-announce-ip 5.5.5.5 # slave-announce-port 1234 ################################## SECURITY ################################### # Require clients to issue AUTH <PASSWORD> before processing any other # commands. This might be useful in environments in which you do not trust # others with access to the host running redis-server. # # This should stay commented out for backward compatibility and because most # people do not need auth (e.g. they run their own servers). # # Warning: since Redis is pretty fast an outside user can try up to # 150k passwords per second against a good box. This means that you should # use a very strong password otherwise it will be very easy to break. # # requirepass foobared # Command renaming. # # It is possible to change the name of dangerous commands in a shared # environment. For instance the CONFIG command may be renamed into something # hard to guess so that it will still be available for internal-use tools # but not available for general clients. # # Example: # # rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52 # # It is also possible to completely kill a command by renaming it into # an empty string: # # rename-command CONFIG \"\" # # Please note that changing the name of commands that are logged into the # AOF file or transmitted to slaves may cause problems. ################################### CLIENTS #################################### # Set the max number of connected clients at the same time. By default # this limit is set to 10000 clients, however if the Redis server is not # able to configure the process file limit to allow for the specified limit # the max number of allowed clients is set to the current file limit # minus 32 (as Redis reserves a few file descriptors for internal uses). # # Once the limit is reached Redis will close all the new connections sending # an error 'max number of clients reached'. # # maxclients 10000 ############################## MEMORY MANAGEMENT ################################ # Set a memory usage limit to the specified amount of bytes. # When the memory limit is reached Redis will try to remove keys # according to the eviction policy selected (see maxmemory-policy). # # If Redis can't remove keys according to the policy, or if the policy is # set to 'noeviction', Redis will start to reply with errors to commands # that would use more memory, like SET, LPUSH, and so on, and will continue # to reply to read-only commands like GET. # # This option is usually useful when using Redis as an LRU or LFU cache, or to # set a hard memory limit for an instance (using the 'noeviction' policy). # # WARNING: If you have slaves attached to an instance with maxmemory on, # the size of the output buffers needed to feed the slaves are subtracted # from the used memory count, so that network problems / resyncs will # not trigger a loop where keys are evicted, and in turn the output # buffer of slaves is full with DELs of keys evicted triggering the deletion # of more keys, and so forth until the database is completely emptied. # # In short... if you have slaves attached it is suggested that you set a lower # limit for maxmemory so that there is some free RAM on the system for slave # output buffers (but this is not needed if the policy is 'noeviction'). # # maxmemory <bytes> # MAXMEMORY POLICY: how Redis will select what to remove when maxmemory # is reached. You can select among five behaviors: # # volatile-lru -> Evict using approximated LRU among the keys with an expire set. # allkeys-lru -> Evict any key using approximated LRU. # volatile-lfu -> Evict using approximated LFU among the keys with an expire set. # allkeys-lfu -> Evict any key using approximated LFU. # volatile-random -> Remove a random key among the ones with an expire set. # allkeys-random -> Remove a random key, any key. # volatile-ttl -> Remove the key with the nearest expire time (minor TTL) # noeviction -> Don't evict anything, just return an error on write operations. # # LRU means Least Recently Used # LFU means Least Frequently Used # # Both LRU, LFU and volatile-ttl are implemented using approximated # randomized algorithms. # # Note: with any of the above policies, Redis will return an error on write # operations, when there are no suitable keys for eviction. # # At the date of writing these commands are: set setnx setex append # incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd # sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby # zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby # getset mset msetnx exec sort # # The default is: # # maxmemory-policy noeviction # LRU, LFU and minimal TTL algorithms are not precise algorithms but approximated # algorithms (in order to save memory), so you can tune it for speed or # accuracy. For default Redis will check five keys and pick the one that was # used less recently, you can change the sample size using the following # configuration directive. # # The default of 5 produces good enough results. 10 Approximates very closely # true LRU but costs more CPU. 3 is faster but not very accurate. # # maxmemory-samples 5 ############################# LAZY FREEING #################################### # Redis has two primitives to delete keys. One is called DEL and is a blocking # deletion of the object. It means that the server stops processing new commands # in order to reclaim all the memory associated with an object in a synchronous # way. If the key deleted is associated with a small object, the time needed # in order to execute th DEL command is very small and comparable to most other # O(1) or O(log_N) commands in Redis. However if the key is associated with an # aggregated value containing millions of elements, the server can block for # a long time (even seconds) in order to complete the operation. # # For the above reasons Redis also offers non blocking deletion primitives # such as UNLINK (non blocking DEL) and the ASYNC option of FLUSHALL and # FLUSHDB commands, in order to reclaim memory in background. Those commands # are executed in constant time. Another thread will incrementally free the # object in the background as fast as possible. # # DEL, UNLINK and ASYNC option of FLUSHALL and FLUSHDB are user-controlled. # It's up to the design of the application to understand when it is a good # idea to use one or the other. However the Redis server sometimes has to # delete keys or flush the whole database as a side effect of other operations. # Specifically Redis deletes objects independently of an user call in the # following scenarios: # # 1) On eviction, because of the maxmemory and maxmemory policy configurations, # in order to make room for new data, without going over the specified # memory limit. # 2) Because of expire: when a key with an associated time to live (see the # EXPIRE command) must be deleted from memory. # 3) Because of a side effect of a command that stores data on a key that may # already exist. For example the RENAME command may delete the old key # content when it is replaced with another one. Similarly SUNIONSTORE # or SORT with STORE option may delete existing keys. The SET command # itself removes any old content of the specified key in order to replace # it with the specified string. # 4) During replication, when a slave performs a full resynchronization with # its master, the content of the whole database is removed in order to # load the RDB file just transfered. # # In all the above cases the default is to delete objects in a blocking way, # like if DEL was called. However you can configure each case specifically # in order to instead release memory in a non-blocking way like if UNLINK # was called, using the following configuration directives: lazyfree-lazy-eviction no lazyfree-lazy-expire no lazyfree-lazy-server-del no slave-lazy-flush no ############################## APPEND ONLY MODE ############################### # By default Redis asynchronously dumps the dataset on disk. This mode is # good enough in many applications, but an issue with the Redis process or # a power outage may result into a few minutes of writes lost (depending on # the configured save points). # # The Append Only File is an alternative persistence mode that provides # much better durability. For instance using the default data fsync policy # (see later in the config file) Redis can lose just one second of writes in a # dramatic event like a server power outage, or a single write if something # wrong with the Redis process itself happens, but the operating system is # still running correctly. # # AOF and RDB persistence can be enabled at the same time without problems. # If the AOF is enabled on startup Redis will load the AOF, that is the file # with the better durability guarantees. # # Please check http://redis.io/topics/persistence for more information. appendonly no # The name of the append only file (default: \"appendonly.aof\") appendfilename \"appendonly.aof\" # The fsync() call tells the Operating System to actually write data on disk # instead of waiting for more data in the output buffer. Some OS will really flush # data on disk, some other OS will just try to do it ASAP. # # Redis supports three different modes: # # no: don't fsync, just let the OS flush the data when it wants. Faster. # always: fsync after every write to the append only log. Slow, Safest. # everysec: fsync only one time every second. Compromise. # # The default is \"everysec\", as that's usually the right compromise between # speed and data safety. It's up to you to understand if you can relax this to # \"no\" that will let the operating system flush the output buffer when # it wants, for better performances (but if you can live with the idea of # some data loss consider the default persistence mode that's snapshotting), # or on the contrary, use \"always\" that's very slow but a bit safer than # everysec. # # More details please check the following article: # http://antirez.com/post/redis-persistence-demystified.html # # If unsure, use \"everysec\". # appendfsync always appendfsync everysec # appendfsync no # When the AOF fsync policy is set to always or everysec, and a background # saving process (a background save or AOF log background rewriting) is # performing a lot of I/O against the disk, in some Linux configurations # Redis may block too long on the fsync() call. Note that there is no fix for # this currently, as even performing fsync in a different thread will block # our synchronous write(2) call. # # In order to mitigate this problem it's possible to use the following option # that will prevent fsync() from being called in the main process while a # BGSAVE or BGREWRITEAOF is in progress. # # This means that while another child is saving, the durability of Redis is # the same as \"appendfsync none\". In practical terms, this means that it is # possible to lose up to 30 seconds of log in the worst scenario (with the # default Linux settings). # # If you have latency problems turn this to \"yes\". Otherwise leave it as # \"no\" that is the safest pick from the point of view of durability. no-appendfsync-on-rewrite no # Automatic rewrite of the append only file. # Redis is able to automatically rewrite the log file implicitly calling # BGREWRITEAOF when the AOF log size grows by the specified percentage. # # This is how it works: Redis remembers the size of the AOF file after the # latest rewrite (if no rewrite has happened since the restart, the size of # the AOF at startup is used). # # This base size is compared to the current size. If the current size is # bigger than the specified percentage, the rewrite is triggered. Also # you need to specify a minimal size for the AOF file to be rewritten, this # is useful to avoid rewriting the AOF file even if the percentage increase # is reached but it is still pretty small. # # Specify a percentage of zero in order to disable the automatic AOF # rewrite feature. auto-aof-rewrite-percentage 100 auto-aof-rewrite-min-size 64mb # An AOF file may be found to be truncated at the end during the Redis # startup process, when the AOF data gets loaded back into memory. # This may happen when the system where Redis is running # crashes, especially when an ext4 filesystem is mounted without the # data=ordered option (however this can't happen when Redis itself # crashes or aborts but the operating system still works correctly). # # Redis can either exit with an error when this happens, or load as much # data as possible (the default now) and start if the AOF file is found # to be truncated at the end. The following option controls this behavior. # # If aof-load-truncated is set to yes, a truncated AOF file is loaded and # the Redis server starts emitting a log to inform the user of the event. # Otherwise if the option is set to no, the server aborts with an error # and refuses to start. When the option is set to no, the user requires # to fix the AOF file using the \"redis-check-aof\" utility before to restart # the server. # # Note that if the AOF file will be found to be corrupted in the middle # the server will still exit with an error. This option only applies when # Redis will try to read more data from the AOF file but not enough bytes # will be found. aof-load-truncated yes # When rewriting the AOF file, Redis is able to use an RDB preamble in the # AOF file for faster rewrites and recoveries. When this option is turned # on the rewritten AOF file is composed of two different stanzas: # # [RDB file][AOF tail] # # When loading Redis recognizes that the AOF file starts with the \"REDIS\" # string and loads the prefixed RDB file, and continues loading the AOF # tail. # # This is currently turned off by default in order to avoid the surprise # of a format change, but will at some point be used as the default. aof-use-rdb-preamble no ################################ LUA SCRIPTING ############################### # Max execution time of a Lua script in milliseconds. # # If the maximum execution time is reached Redis will log that a script is # still in execution after the maximum allowed time and will start to # reply to queries with an error. # # When a long running script exceeds the maximum execution time only the # SCRIPT KILL and SHUTDOWN NOSAVE commands are available. The first can be # used to stop a script that did not yet called write commands. The second # is the only way to shut down the server in the case a write command was # already issued by the script but the user doesn't want to wait for the natural # termination of the script. # # Set it to 0 or a negative value for unlimited execution without warnings. lua-time-limit 5000 ################################ REDIS CLUSTER ############################### # # ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # WARNING EXPERIMENTAL: Redis Cluster is considered to be stable code, however # in order to mark it as \"mature\" we need to wait for a non trivial percentage # of users to deploy it in production. # ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ # # Normal Redis instances can't be part of a Redis Cluster; only nodes that are # started as cluster nodes can. In order to start a Redis instance as a # cluster node enable the cluster support uncommenting the following: # # cluster-enabled yes # Every cluster node has a cluster configuration file. This file is not # intended to be edited by hand. It is created and updated by Redis nodes. # Every Redis Cluster node requires a different cluster configuration file. # Make sure that instances running in the same system do not have # overlapping cluster configuration file names. # # cluster-config-file nodes-6379.conf # Cluster node timeout is the amount of milliseconds a node must be unreachable # for it to be considered in failure state. # Most other internal time limits are multiple of the node timeout. # # cluster-node-timeout 15000 # A slave of a failing master will avoid to start a failover if its data # looks too old. # # There is no simple way for a slave to actually have an exact measure of # its \"data age\", so the following two checks are performed: # # 1) If there are multiple slaves able to failover, they exchange messages # in order to try to give an advantage to the slave with the best # replication offset (more data from the master processed). # Slaves will try to get their rank by offset, and apply to the start # of the failover a delay proportional to their rank. # # 2) Every single slave computes the time of the last interaction with # its master. This can be the last ping or command received (if the master # is still in the \"connected\" state), or the time that elapsed since the # disconnection with the master (if the replication link is currently down). # If the last interaction is too old, the slave will not try to failover # at all. # # The point \"2\" can be tuned by user. Specifically a slave will not perform # the failover if, since the last interaction with the master, the time # elapsed is greater than: # # (node-timeout * slave-validity-factor) + repl-ping-slave-period # # So for example if node-timeout is 30 seconds, and the slave-validity-factor # is 10, and assuming a default repl-ping-slave-period of 10 seconds, the # slave will not try to failover if it was not able to talk with the master # for longer than 310 seconds. # # A large slave-validity-factor may allow slaves with too old data to failover # a master, while a too small value may prevent the cluster from being able to # elect a slave at all. # # For maximum availability, it is possible to set the slave-validity-factor # to a value of 0, which means, that slaves will always try to failover the # master regardless of the last time they interacted with the master. # (However they'll always try to apply a delay proportional to their # offset rank). # # Zero is the only value able to guarantee that when all the partitions heal # the cluster will always be able to continue. # # cluster-slave-validity-factor 10 # Cluster slaves are able to migrate to orphaned masters, that are masters # that are left without working slaves. This improves the cluster ability # to resist to failures as otherwise an orphaned master can't be failed over # in case of failure if it has no working slaves. # # Slaves migrate to orphaned masters only if there are still at least a # given number of other working slaves for their old master. This number # is the \"migration barrier\". A migration barrier of 1 means that a slave # will migrate only if there is at least 1 other working slave for its master # and so forth. It usually reflects the number of slaves you want for every # master in your cluster. # # Default is 1 (slaves migrate only if their masters remain with at least # one slave). To disable migration just set it to a very large value. # A value of 0 can be set but is useful only for debugging and dangerous # in production. # # cluster-migration-barrier 1 # By default Redis Cluster nodes stop accepting queries if they detect there # is at least an hash slot uncovered (no available node is serving it). # This way if the cluster is partially down (for example a range of hash slots # are no longer covered) all the cluster becomes, eventually, unavailable. # It automatically returns available as soon as all the slots are covered again. # # However sometimes you want the subset of the cluster which is working, # to continue to accept queries for the part of the key space that is still # covered. In order to do so, just set the cluster-require-full-coverage # option to no. # # cluster-require-full-coverage yes # In order to setup your cluster make sure to read the documentation # available at http://redis.io web site. ########################## CLUSTER DOCKER/NAT support ######################## # In certain deployments, Redis Cluster nodes address discovery fails, because # addresses are NAT-ted or because ports are forwarded (the typical case is # Docker and other containers). # # In order to make Redis Cluster working in such environments, a static # configuration where each node known its public address is needed. The # following two options are used for this scope, and are: # # * cluster-announce-ip # * cluster-announce-port # * cluster-announce-bus-port # # Each instruct the node about its address, client port, and cluster message # bus port. The information is then published in the header of the bus packets # so that other nodes will be able to correctly map the address of the node # publishing the information. # # If the above options are not used, the normal Redis Cluster auto-detection # will be used instead. # # Note that when remapped, the bus port may not be at the fixed offset of # clients port + 10000, so you can specify any port and bus-port depending # on how they get remapped. If the bus-port is not set, a fixed offset of # 10000 will be used as usually. # # Example: # # cluster-announce-ip 10.1.1.5 # cluster-announce-port 6379 # cluster-announce-bus-port 6380 ################################## SLOW LOG ################################### # The Redis Slow Log is a system to log queries that exceeded a specified # execution time. The execution time does not include the I/O operations # like talking with the client, sending the reply and so forth, # but just the time needed to actually execute the command (this is the only # stage of command execution where the thread is blocked and can not serve # other requests in the meantime). # # You can configure the slow log with two parameters: one tells Redis # what is the execution time, in microseconds, to exceed in order for the # command to get logged, and the other parameter is the length of the # slow log. When a new command is logged the oldest one is removed from the # queue of logged commands. # The following time is expressed in microseconds, so 1000000 is equivalent # to one second. Note that a negative number disables the slow log, while # a value of zero forces the logging of every command. slowlog-log-slower-than 10000 # There is no limit to this length. Just be aware that it will consume memory. # You can reclaim memory used by the slow log with SLOWLOG RESET. slowlog-max-len 128 ################################ LATENCY MONITOR ############################## # The Redis latency monitoring subsystem samples different operations # at runtime in order to collect data related to possible sources of # latency of a Redis instance. # # Via the LATENCY command this information is available to the user that can # print graphs and obtain reports. # # The system only logs operations that were performed in a time equal or # greater than the amount of milliseconds specified via the # latency-monitor-threshold configuration directive. When its value is set # to zero, the latency monitor is turned off. # # By default latency monitoring is disabled since it is mostly not needed # if you don't have latency issues, and collecting data has a performance # impact, that while very small, can be measured under big load. Latency # monitoring can easily be enabled at runtime using the command # \"CONFIG SET latency-monitor-threshold <milliseconds>\" if needed. latency-monitor-threshold 0 ############################# EVENT NOTIFICATION ############################## # Redis can notify Pub/Sub clients about events happening in the key space. # This feature is documented at http://redis.io/topics/notifications # # For instance if keyspace events notification is enabled, and a client # performs a DEL operation on key \"foo\" stored in the Database 0, two # messages will be published via Pub/Sub: # # PUBLISH __keyspace@0__:foo del # PUBLISH __keyevent@0__:del foo # # It is possible to select the events that Redis will notify among a set # of classes. Every class is identified by a single character: # # K Keyspace events, published with __keyspace@<db>__ prefix. # E Keyevent events, published with __keyevent@<db>__ prefix. # g Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ... # $ String commands # l List commands # s Set commands # h Hash commands # z Sorted set commands # x Expired events (events generated every time a key expires) # e Evicted events (events generated when a key is evicted for maxmemory) # A Alias for g$lshzxe, so that the \"AKE\" string means all the events. # # The \"notify-keyspace-events\" takes as argument a string that is composed # of zero or multiple characters. The empty string means that notifications # are disabled. # # Example: to enable list and generic events, from the point of view of the # event name, use: # # notify-keyspace-events Elg # # Example 2: to get the stream of the expired keys subscribing to channel # name __keyevent@0__:expired use: # # notify-keyspace-events Ex # # By default all notifications are disabled because most users don't need # this feature and the feature has some overhead. Note that if you don't # specify at least one of K or E, no events will be delivered. notify-keyspace-events \"\" ############################### ADVANCED CONFIG ############################### # Hashes are encoded using a memory efficient data structure when they have a # small number of entries, and the biggest entry does not exceed a given # threshold. These thresholds can be configured using the following directives. hash-max-ziplist-entries 512 hash-max-ziplist-value 64 # Lists are also encoded in a special way to save a lot of space. # The number of entries allowed per internal list node can be specified # as a fixed maximum size or a maximum number of elements. # For a fixed maximum size, use -5 through -1, meaning: # -5: max size: 64 Kb <-- not recommended for normal workloads # -4: max size: 32 Kb <-- not recommended # -3: max size: 16 Kb <-- probably not recommended # -2: max size: 8 Kb <-- good # -1: max size: 4 Kb <-- good # Positive numbers mean store up to _exactly_ that number of elements # per list node. # The highest performing option is usually -2 (8 Kb size) or -1 (4 Kb size), # but if your use case is unique, adjust the settings as necessary. list-max-ziplist-size -2 # Lists may also be compressed. # Compress depth is the number of quicklist ziplist nodes from *each* side of # the list to *exclude* from compression. The head and tail of the list # are always uncompressed for fast push/pop operations. Settings are: # 0: disable all list compression # 1: depth 1 means \"don't start compressing until after 1 node into the list, # going from either the head or tail\" # So: [head]->node->node->...->node->[tail] # [head], [tail] will always be uncompressed; inner nodes will compress. # 2: [head]->[next]->node->node->...->node->[prev]->[tail] # 2 here means: don't compress head or head->next or tail->prev or tail, # but compress all nodes between them. # 3: [head]->[next]->[next]->node->node->...->node->[prev]->[prev]->[tail] # etc. list-compress-depth 0 # Sets have a special encoding in just one case: when a set is composed # of just strings that happen to be integers in radix 10 in the range # of 64 bit signed integers. # The following configuration setting sets the limit in the size of the # set in order to use this special memory saving encoding. set-max-intset-entries 512 # Similarly to hashes and lists, sorted sets are also specially encoded in # order to save a lot of space. This encoding is only used when the length and # elements of a sorted set are below the following limits: zset-max-ziplist-entries 128 zset-max-ziplist-value 64 # HyperLogLog sparse representation bytes limit. The limit includes the # 16 bytes header. When an HyperLogLog using the sparse representation crosses # this limit, it is converted into the dense representation. # # A value greater than 16000 is totally useless, since at that point the # dense representation is more memory efficient. # # The suggested value is ~ 3000 in order to have the benefits of # the space efficient encoding without slowing down too much PFADD, # which is O(N) with the sparse encoding. The value can be raised to # ~ 10000 when CPU is not a concern, but space is, and the data set is # composed of many HyperLogLogs with cardinality in the 0 - 15000 range. hll-sparse-max-bytes 3000 # Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in # order to help rehashing the main Redis hash table (the one mapping top-level # keys to values). The hash table implementation Redis uses (see dict.c) # performs a lazy rehashing: the more operation you run into a hash table # that is rehashing, the more rehashing \"steps\" are performed, so if the # server is idle the rehashing is never complete and some more memory is used # by the hash table. # # The default is to use this millisecond 10 times every second in order to # actively rehash the main dictionaries, freeing memory when possible. # # If unsure: # use \"activerehashing no\" if you have hard latency requirements and it is # not a good thing in your environment that Redis can reply from time to time # to queries with 2 milliseconds delay. # # use \"activerehashing yes\" if you don't have such hard requirements but # want to free memory asap when possible. activerehashing yes # The client output buffer limits can be used to force disconnection of clients # that are not reading data from the server fast enough for some reason (a # common reason is that a Pub/Sub client can't consume messages as fast as the # publisher can produce them). # # The limit can be set differently for the three different classes of clients: # # normal -> normal clients including MONITOR clients # slave -> slave clients # pubsub -> clients subscribed to at least one pubsub channel or pattern # # The syntax of every client-output-buffer-limit directive is the following: # # client-output-buffer-limit <class> <hard limit> <soft limit> <soft seconds> # # A client is immediately disconnected once the hard limit is reached, or if # the soft limit is reached and remains reached for the specified number of # seconds (continuously). # So for instance if the hard limit is 32 megabytes and the soft limit is # 16 megabytes / 10 seconds, the client will get disconnected immediately # if the size of the output buffers reach 32 megabytes, but will also get # disconnected if the client reaches 16 megabytes and continuously overcomes # the limit for 10 seconds. # # By default normal clients are not limited because they don't receive data # without asking (in a push way), but just after a request, so only # asynchronous clients may create a scenario where data is requested faster # than it can read. # # Instead there is a default limit for pubsub and slave clients, since # subscribers and slaves receive data in a push fashion. # # Both the hard or the soft limit can be disabled by setting them to zero. client-output-buffer-limit normal 0 0 0 client-output-buffer-limit slave 256mb 64mb 60 client-output-buffer-limit pubsub 32mb 8mb 60 # Redis calls an internal function to perform many background tasks, like # closing connections of clients in timeout, purging expired keys that are # never requested, and so forth. # # Not all tasks are performed with the same frequency, but Redis checks for # tasks to perform according to the specified \"hz\" value. # # By default \"hz\" is set to 10. Raising the value will use more CPU when # Redis is idle, but at the same time will make Redis more responsive when # there are many keys expiring at the same time, and timeouts may be # handled with more precision. # # The range is between 1 and 500, however a value over 100 is usually not # a good idea. Most users should use the default of 10 and raise this up to # 100 only in environments where very low latency is required. hz 10 # When a child rewrites the AOF file, if the following option is enabled # the file will be fsync-ed every 32 MB of data generated. This is useful # in order to commit the file to the disk more incrementally and avoid # big latency spikes. aof-rewrite-incremental-fsync yes # Redis LFU eviction (see maxmemory setting) can be tuned. However it is a good # idea to start with the default settings and only change them after investigating # how to improve the performances and how the keys LFU change over time, which # is possible to inspect via the OBJECT FREQ command. # # There are two tunable parameters in the Redis LFU implementation: the # counter logarithm factor and the counter decay time. It is important to # understand what the two parameters mean before changing them. # # The LFU counter is just 8 bits per key, it's maximum value is 255, so Redis # uses a probabilistic increment with logarithmic behavior. Given the value # of the old counter, when a key is accessed, the counter is incremented in # this way: # # 1. A random number R between 0 and 1 is extracted. # 2. A probability P is calculated as 1/(old_value*lfu_log_factor+1). # 3. The counter is incremented only if R < P. # # The default lfu-log-factor is 10. This is a table of how the frequency # counter changes with a different number of accesses with different # logarithmic factors: # # +--------+------------+------------+------------+------------+------------+ # | factor | 100 hits | 1000 hits | 100K hits | 1M hits | 10M hits | # +--------+------------+------------+------------+------------+------------+ # | 0 | 104 | 255 | 255 | 255 | 255 | # +--------+------------+------------+------------+------------+------------+ # | 1 | 18 | 49 | 255 | 255 | 255 | # +--------+------------+------------+------------+------------+------------+ # | 10 | 10 | 18 | 142 | 255 | 255 | # +--------+------------+------------+------------+------------+------------+ # | 100 | 8 | 11 | 49 | 143 | 255 | # +--------+------------+------------+------------+------------+------------+ # # NOTE: The above table was obtained by running the following commands: # # redis-benchmark -n 1000000 incr foo # redis-cli object freq foo # # NOTE 2: The counter initial value is 5 in order to give new objects a chance # to accumulate hits. # # The counter decay time is the time, in minutes, that must elapse in order # for the key counter to be divided by two (or decremented if it has a value # less <= 10). # # The default value for the lfu-decay-time is 1. A Special value of 0 means to # decay the counter every time it happens to be scanned. # # lfu-log-factor 10 # lfu-decay-time 1 ########################### ACTIVE DEFRAGMENTATION ####################### # # WARNING THIS FEATURE IS EXPERIMENTAL. However it was stress tested # even in production and manually tested by multiple engineers for some # time. # # What is active defragmentation? # ------------------------------- # # Active (online) defragmentation allows a Redis server to compact the # spaces left between small allocations and deallocations of data in memory, # thus allowing to reclaim back memory. # # Fragmentation is a natural process that happens with every allocator (but # less so with Jemalloc, fortunately) and certain workloads. Normally a server # restart is needed in order to lower the fragmentation, or at least to flush # away all the data and create it again. However thanks to this feature # implemented by Oran Agra for Redis 4.0 this process can happen at runtime # in an \"hot\" way, while the server is running. # # Basically when the fragmentation is over a certain level (see the # configuration options below) Redis will start to create new copies of the # values in contiguous memory regions by exploiting certain specific Jemalloc # features (in order to understand if an allocation is causing fragmentation # and to allocate it in a better place), and at the same time, will release the # old copies of the data. This process, repeated incrementally for all the keys # will cause the fragmentation to drop back to normal values. # # Important things to understand: # # 1. This feature is disabled by default, and only works if you compiled Redis # to use the copy of Jemalloc we ship with the source code of Redis. # This is the default with Linux builds. # # 2. You never need to enable this feature if you don't have fragmentation # issues. # # 3. Once you experience fragmentation, you can enable this feature when # needed with the command \"CONFIG SET activedefrag yes\". # # The configuration parameters are able to fine tune the behavior of the # defragmentation process. If you are not sure about what they mean it is # a good idea to leave the defaults untouched. # Enabled active defragmentation # activedefrag yes # Minimum amount of fragmentation waste to start active defrag # active-defrag-ignore-bytes 100mb # Minimum percentage of fragmentation to start active defrag # active-defrag-threshold-lower 10 # Maximum percentage of fragmentation at which we use maximum effort # active-defrag-threshold-upper 100 # Minimal effort for defrag in CPU percentage # active-defrag-cycle-min 25 # Maximal effort for defrag in CPU percentage # active-defrag-cycle-max 75","title":"Redis"},{"location":"Regex/","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5206\u7c7b \u00b6 \u57fa\u672c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Basic Regular Expression \u53c8\u53ebBasic RegEx \u7b80\u79f0BREs\uff09 \u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Extended Regular Expression \u53c8\u53ebExtended RegEx \u7b80\u79f0EREs\uff09 Perl\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Perl Regular Expression \u53c8\u53ebPerl RegEx \u7b80\u79f0PREs\uff09 []\u7b26\u53f7\u5339\u914d\u5b57\u7b26\u96c6\u5408\uff0c\u652f\u6301\u7a77\u4e3e\u65b9\u6cd5\u5339\u914d\u5b57\u7b26\u96c6\u5408\u7684\u6240\u6709\u5143\u7d20\u4e5f\u652f\u6301\u4f7f\u7528-\u7b26\u53f7\u8868\u793a\u96c6\u5408\u8303\u56f4\uff0c^\u7b26\u53f7\u5728[]\u4e2d\u8868\u793a\u53d6\u53cd \u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\ \u8f6c\u4e49\u7b26\uff0c\u5c06\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\uff0c\u5ffd\u7565\u5176\u7279\u6b8a\u610f\u4e49 a.b\u5339\u914da.b\uff0c\u4f46\u4e0d\u80fd\u5339\u914dajb\uff0c.\u88ab\u8f6c\u4e49\u4e3a\u7279\u6b8a\u610f\u4e49 \\ \\ \\ ^ \u5339\u914d\u884c\u9996\uff0cawk\u4e2d\uff0c^\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u5f00\u59cb ^tux\u5339\u914d\u4ee5tux\u5f00\u5934\u7684\u884c ^ ^ ^ $ \u5339\u914d\u884c\u5c3e\uff0cawk\u4e2d\uff0c$\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e tux$\u5339\u914d\u4ee5tux\u7ed3\u5c3e\u7684\u884c $ $ $ . \u5339\u914d\u9664\u6362\u884c\u7b26\\n\u4e4b\u5916\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff0cawk\u5219\u4e2d\u53ef\u4ee5 ab.\u5339\u914dabc\u6216bad\uff0c\u4e0d\u53ef\u5339\u914dabcd\u6216abde\uff0c\u53ea\u80fd\u5339\u914d\u5355\u5b57\u7b26,\u4f46\u540c\u4e00\u4e2a\u6b63\u5219\u53ef\u4f7f\u7528\u591a\u4e2a\u6765\u5339\u914d\u591a\u4e2a\u5b57\u7b26 . . . [] \u5339\u914d\u5305\u542b\u5728[\u5b57\u7b26]\u4e4b\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 coo[kl]\u53ef\u4ee5\u5339\u914dcook\u6216cool [] [] [] [^] \u5339\u914d[^\u5b57\u7b26]\u4e4b\u5916\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 123[^45]\u4e0d\u53ef\u4ee5\u5339\u914d1234\u62161235\uff0c1236\u30011237\u90fd\u53ef\u4ee5 [^] [^] [^] [-] \u5339\u914d[]\u4e2d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u8981\u5199\u6210\u9012\u589e [0-9]\u53ef\u4ee5\u5339\u914d1\u30012\u62163\u7b49\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 [-] [-] [-] ? \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u80050\u6b21 colou?r\u53ef\u4ee5\u5339\u914dcolor\u6216\u8005colour\uff0c\u4e0d\u80fd\u5339\u914dcolouur \u4e0d\u652f\u6301 ? ? + \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u8005\u591a\u6b21 sa-6+\u5339\u914dsa-6\u3001sa-666\uff0c\u4e0d\u80fd\u5339\u914dsa- \u4e0d\u652f\u6301 + + * \u5339\u914d\u4e4b\u524d\u7684\u98790\u6b21\u6216\u8005\u591a\u6b21 co*l\u5339\u914dcl\u3001col\u3001cool\u3001coool\u7b49 * * * () \u5339\u914d\u8868\u8fbe\u5f0f\uff0c\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u5339\u914d\u7684\u5b50\u4e32 matri?\u5339\u914dmax\u6216maxtrix \u4e0d\u652f\u6301 {n} \u5339\u914d\u4e4b\u524d\u7684\u9879n\u6b21\uff0cn\u662f\u53ef\u4ee5\u4e3a0\u7684\u6b63\u6574\u6570 [0-9]{3}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e09\u4f4d\u6570\uff0c\u53ef\u4ee5\u6269\u5c55\u4e3a[0-9][0-9][0-9] \u4e0d\u652f\u6301 {n} {n} {n,} \u4e4b\u524d\u7684\u9879\u81f3\u5c11\u9700\u8981\u5339\u914dn\u6b21 [0-9]{2,}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e24\u4f4d\u6570\u6216\u66f4\u591a\u4f4d\u6570 \u4e0d\u652f\u6301 {n,} {n,} {n,m} \u6307\u5b9a\u4e4b\u524d\u7684\u9879\u81f3\u5c11\u5339\u914dn\u6b21\uff0c\u6700\u591a\u5339\u914dm\u6b21\uff0cn<=m [0-9]{2,5}\u5339\u914d\u4ece\u4e24\u4f4d\u6570\u5230\u4e94\u4f4d\u6570\u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 \u4e0d\u652f\u6301 {n,m} {n,m} | \u4ea4\u66ff\u5339\u914d|\u4e24\u8fb9\u7684\u4efb\u610f\u4e00\u9879 abc d\u5339\u914dabc\u6216abd \u4e0d\u652f\u6301 **POSIX\u5b57\u7b26\u7c7b**\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5[\uff1aCLASS\uff1a]\u5728\u65b9\u62ec\u53f7\u5185\u6307\u5b9a\u5b57\u7b26\u7c7b\uff0c\u5176\u4e2dCLASS\u5728POSIX\u6807\u51c6\u4e2d\u5b9a\u4e49\u5e76\u5177\u6709\u5176\u4e2d\u4e00\u4e2a\u503c \u4f8b\u5982\uff1als -ld [[:digit:]]* # \u5339\u914d\u4ee5\u6570\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg [:alnum:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57\u5b57\u7b26 [[:alnum:]]+ [:alnum:] [:alnum:] [:alnum:] [:alpha:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u5b57\u7b26\uff08\u5305\u62ec\u5927\u5c0f\u5199\u5b57\u6bcd\uff09 [[:alpha:]]{4} [:alpha:] [:alpha:] [:alpha:] [:blank:] \u7a7a\u683c\u4e0e\u5236\u8868\u7b26\uff08\u6a2a\u5411\u548c\u7eb5\u5411\uff09 [[:blank:]]* [:blank:] [:blank:] [:blank:] [:digit:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26 [[:digit:]]? [:digit:] [:digit:] [:digit:] [:lower:] \u5339\u914d\u5c0f\u5199\u5b57\u6bcd [[:lower:]]{5,} [:lower:] [:lower:] [:lower:] [:upper:] \u5339\u914d\u5927\u5199\u5b57\u6bcd [[:upper:]]+? [:upper:] [:upper:] [:upper:] [:punct:] \u5339\u914d\u6807\u70b9\u7b26\u53f7 [[:punct:]] [:punct:] [:punct:] [:punct:] [:space:] \u5339\u914d\u4e00\u4e2a\u5305\u62ec\u6362\u884c\u7b26\u3001\u56de\u8f66\u7b49\u5728\u5185\u7684\u6240\u6709\u7a7a\u767d\u7b26 [[:space:]]+ [:space:] [:space:] [:space:] [:graph:] \u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u770b\u5f97\u89c1\u7684\u4e14\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:graph:]] [:graph:] [:graph:] [:graph:] [:xdigit:] \u4efb\u4f55\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u6570\uff08\u5373\uff1a0-9\uff0ca-f\uff0cA-F\uff09 [[:xdigit:]]+ [:xdigit:] [:xdigit:] [:xdigit: [:cntrl:] \u4efb\u4f55\u4e00\u4e2a\u63a7\u5236\u5b57\u7b26\uff08ASCII\u5b57\u7b26\u96c6\u4e2d\u7684\u524d32\u4e2a\u5b57\u7b26 [[:cntrl:]] [:cntrl:] [:cntrl:] [:cntrl:] [:print:] \u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:print:]] [:print:] [:print:] [:print:] \u5143\u5b57\u7b26 \uff08meta character\uff09\u662f\u4e00\u79cdPerl\u98ce\u683c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709\u4e00\u90e8\u5206\u6587\u672c\u5904\u7406\u5de5\u5177\u652f\u6301\u5b83\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6587\u672c\u5904\u7406\u5de5\u5177\u90fd\u652f\u6301\u3002 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\b \u5355\u8bcd\u8fb9\u754c \\bcool\\b \u5339\u914dcool\uff0c\u4e0d\u5339\u914dcoolant \\b \\b \\b \\B \u975e\u5355\u8bcd\u8fb9\u754c cool\\B \u5339\u914dcoolant\uff0c\u4e0d\u5339\u914dcool \\B \\B \\B \\d \u5355\u4e2a\u6216\u66f4\u591a\u8fde\u7eed\u7684\u6570\u5b57 b\\db \u5339\u914db2b\uff0c\u4e0d\u5339\u914dbcb \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\d \\D \u5355\u4e2a\u975e\u6570\u5b57\u5b57\u7b26 b\\Db \u5339\u914dbcb\uff0c\u4e0d\u5339\u914db2b \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\D \\w \u5355\u4e2a\u5355\u8bcd\u5b57\u7b26\uff08\u5b57\u6bcd\u3001\u6570\u5b57\u4e0e_\uff09 \\w \u5339\u914d1\u6216a\uff0c\u4e0d\u5339\u914d& \\w \\w \\w \\W \u5339\u914d\u4efb\u610f\u4e0d\u662f\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf\uff0c\u6c49\u5b57\u7684\u5b57\u7b26 \\W \u5339\u914d&\uff0c\u4e0d\u5339\u914d1\u6216a \\W \\W \\W \\n \u6362\u884c\u7b26 \\n \u5339\u914d\u4e00\u4e2a\u65b0\u884c \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\n \\s \u5355\u4e2a\u7a7a\u767d\u5b57\u7b26 x\\sx \u5339\u914dx x\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\s \\S \u5355\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 x\\S\\x \u5339\u914dxkx\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\S \\r \u56de\u8f66 \\r \u5339\u914d\u56de\u8f66 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\r \\t \u6a2a\u5411\u5236\u8868\u7b26 \\t \u5339\u914d\u4e00\u4e2a\u6a2a\u5411\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\t \\v \u5782\u76f4\u5236\u8868\u7b26 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\v \\f \u6362\u9875\u7b26 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\f **\u540e\u5411\u5f15\u7528**\u7528\u4e8e\u91cd\u590d\u641c\u7d22\u524d\u9762\u67d0\u4e2a\u5206\u7ec4\u5339\u914d\u7684\u6587\u672c\uff0cexp(expression)\u4ee3\u8868\u8868\u8fbe\u5f0f,\u5e38\u7528\u5206\u7ec4\u8bed\u6cd5\u5982\u4e0b\uff1a | \u4ee3\u7801/\u8bed\u6cd5 | \u8bf4\u660e | | :------: | :------: | | [^x] | \u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 | | [^aeiou] | \u5339\u914d\u9664\u4e86aeiou\u8fd9\u51e0\u4e2a\u5b57\u6bcd\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 | \u5e38\u7528\u6b63\u5e38\u8868\u8fbe\u5f0f \u00b6 \u4ee5\u6c49\u5b57\u5f00\u5934\u7684\u884c \uff1a ^[ \\u4e00-\\u9fa5 ] \u8be6\u89e3 \uff1a [ \\u4e00-\\u9fa5 ] \u4ee3\u8868\u4efb\u4f55\u4e00\u4e2a\u6c49\u5b57 --\u539f\u7406\uff1aU4300-U9fa5\u4ee3\u8868\u4e86\u7b26\u5408\u6c49\u5b57GB18030\u89c4\u8303\u7684\u5b57\u7b26\u96c6 \u5339\u914d\u81f3\u5c11\u4e00\u4e2a\u6c49\u5b57 \uff1a [ \\u4E00-\\u9FA5 ]+ \u7a7a\u884c\u7684\u8868\u793a\u65b9\u6cd5 : ^ $ \u6216 \uff1a\\ n [ \\s| ]* \\ r \u5339\u914d\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c \uff1a ^ . $ \u5339\u914d\u4e0d\u5728b ~ d\u8303\u56f4\u7684\u5b57\u7b26 \uff1a [ ^b-d ] \u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 \uff1a [ ^x ] \u5339\u914d\u6240\u6709\u82f1\u6587\u5355\u8bcd \uff1a [ A-Za-z ][ A-Za-z ]* \u7cbe\u786e\u5339\u914d\u5b57\u7b26 \uff08 \u4f8b\u5982\u7cbe\u786e\u5339\u914d\u5355\u8bcdthe \uff0c \u4e0d\u5339\u914d\u5305\u542bthe\u7684\u5355\u8bcd \uff0c \u5982them \uff0c they\u7b49 \uff09\uff1a\\ < the \\ > \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u91cd\u590dn\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n \\} \u4f8b\u5982\u5339\u914d\u503cjooob \uff1a jo \\{ 3 \\} b \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u81f3\u5c11\u51fa\u73b0n\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n , \\} \u4f8b\u5982 \uff1a jo \\{ 3 , \\} b #jooob \u3001 joooob\u7b49\u5b57\u7b26\u90fd\u7531\u6b64\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u51fa\u73b0n ~ m\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n , m \\} \u4f8b\u5982 \uff1a jo { 3 , 6 \\} #\u5339\u914djooob \u3001 joooooob\u7b49\u5b57\u7b26 \uff0c \u81f3\u5c113\u6b21 \uff0c \u6700\u591a6\u6b21 \u7cbe\u786e\u5339\u914d5\u4e2a\u5c0f\u5199\u5b57\u7b26 \uff1a [ a-z ] \\{ 5 \\} #\u5982hello \u3001 house\u7b495\u4e2a\u5c0f\u5199\u5355\u8bcd\u6216\u5b57\u7b26 \u5339\u914djob\u6216joob \uff1a jo ? b + \u7b26\u53f7\u548c \u00d7 \u7b26\u53f7\u7c7b\u4f3c \uff0c \u5339\u914d\u5176\u524d\u9762\u7684\u5b57\u7b26\u591a\u6b21 \uff0c \u4f46\u662f \u00d7 \u53ef\u4ee5\u5339\u914d0\u6b21 \uff0c \u800c + \u81f3\u5c11\u8981\u5339\u914d1\u6b21 \uff1a jo + b\u8868\u793a \uff1a joob \u3001 jooob\u7b49\u5b57\u7b26 \uff0c job\u4e0d\u80fd\u7528\u6b64\u6765\u5339\u914d () \u548c | \u7b26\u53f7\u7ec4\u5408\u4f7f\u7528 \uff0c \u8868\u793a\u4e00\u7ec4\u53ef\u9009\u5b57\u7b26\u7684\u96c6\u5408 \uff1a re ( a | e | o ) d\u8868\u8fbe\u5f0f\u4e2d\u7684 ( a | e | o ) \u8868\u793a \uff1a \u5728\u5b57\u7b26a \u3001 e \u3001 o\u4e2d\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\u5b57\u7b26 \uff0c \u5373read \u3001 reed \u3001 reod\u90fd\u53ef\u4ee5\u7531\u6b64\u8868\u8fbe\u5f0f\u5339\u914d () \u5f88\u5c11\u4f7f\u7528 \uff0c \u56e0\u4e3a [] \u7b26\u53f7\u53ef\u4ee5\u5b8c\u5168\u66ff\u4ee3 \uff0c re ( a | e | o ) d\u7b49\u4ef7\u4e8ere [ aeo ] d \u975e\u8d1f\u6574\u6570 \uff1a ^ \\ d + $ \u6b63\u6574\u6570 \uff1a ^[ 0-9 ]*[ 1-9 ][ 0-9 ]* $ \u975e\u6b63\u6574\u6570 \uff1a ^ (( - \\ d + ) | ( 0 + )) $ \u8d1f\u6574\u6570 \uff1a ^-[ 0-9 ]*[ 1-9 ][ 0-9 ]* $ \u6574\u6570 \uff1a ^- ? \\ d + $ \u975e\u8d1f\u6d6e\u70b9\u6570 \uff1a ^ \\ d + ( \\ . \\ d + ) ? $ \u6b63\u6d6e\u70b9\u6570 : ^ (( 0 - 9 ) + \\ . [ 0-9 ]*[ 1-9 ][ 0-9 ]* ) | ( [ 0-9 ]*[ 1-9 ][ 0-9 ]* \\ . [ 0-9 ]+ ) | ( [ 0-9 ]*[ 1-9 ][ 0-9 ]* ) $ \u975e\u6b63\u6d6e\u70b9\u6570 \uff1a ^ (( - \\ d + \\ . \\ d + ) ? ) | ( 0 + ( \\ .0 + ) ? )) $ \u8d1f\u6d6e\u70b9\u6570 \uff1a ^ ( - (( \u6b63\u6d6e\u70b9\u6570\u6b63\u5219\u5f0f ))) $ \u82f1\u6587\u5b57\u7b26\u4e32 \uff1a ^[ A-Za-z ]+ $ \u82f1\u6587\u5927\u5199\u4e32 \uff1a ^[ A-Z ]+ $ \u82f1\u6587\u5c0f\u5199\u4e32 \uff1a ^[ a-z ]+ $ \u82f1\u6587\u5b57\u7b26\u6570\u5b57\u4e32 \uff1a ^[ A-Za-z0-9 ]+ $ \u82f1\u6570\u5b57\u52a0\u4e0b\u5212\u7ebf\u4e32 \uff1a ^ \\ w + $ E - mail\u5730\u5740 \uff1a ^[ \\w- ]+ ( \\ . [ \\w- ]+ ) * @ [ \\w- ]+ ( \\ . [ \\w- ]+ ) + $ \u6216 \uff1a\\ w + ( [ -+. ] \\ w + ) * @\\ w + ( [ -. ] \\ w + ) * \\ . \\ w + ( [ -. ] \\ w + ) * URL \uff1a ^[ a-zA-Z ]+ : // ( \\ w + ( - \\ w + ) * )( \\ .( \\ w + ( - \\ w + ) * )) * ( \\ ? \\ s * ) ? $ \u6216 \uff1a ^ http : \\ / \\ /[ A-Za-z0-9 ]+ \\ . [ A-Za-z0-9 ]+[ \\/=\\?%\\-&_~`@[\\ ] \\ ':+!]*([^<>\\\"\\\"])*$ \u90ae\u653f\u7f16\u7801\uff1a^[1-9]\\d{5}$ \u4e2d\u6587\u5b57\u7b26\uff1a^[\\u0391-\\uFFE5]+$ \u7535\u8bdd\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?(\\(0\\d{2,3}\\)|0\\d{2,3}-)?[1-9]\\d{6,7}(\\-\\d{1,4})?$ \u624b\u673a\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?13\\d{9}$ \u53cc\u5b57\u8282\u5b57\u7b26(\u5305\u62ec\u6c49\u5b57\u5728\u5185)\uff1a^\\x00-\\xff \u5339\u914d\u9996\u5c3e\u7a7a\u683c\uff1a(^\\s*)|(\\s*$)\uff08\u50cfvbscript\u90a3\u6837\u7684trim\u51fd\u6570\uff09 \u5339\u914dHTML\u6807\u8bb0\uff1a<(.*)>.*<\\/\\1>|<(.*)\\/> \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u7f51\u7edc\u94fe\u63a5\uff1a(h|H)(r|R)(e|E)(f|F)*=*(' | \")?(\\w|\\\\|\\/|\\.)+('|\" |*|> ) ? \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u90ae\u4ef6\u5730\u5740 \uff1a\\ w + ( [ -+. ] \\ w + ) * @\\ w + ( [ -. ] \\ w + ) * \\ . \\ w + ( [ -. ] \\ w + ) * \u6216 [ a-zA-Z0-9\\-_+ ]+ @ [ A-Za-z ]+ \\ .( com | cn | net ) \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u56fe\u7247\u94fe\u63a5 \uff1a ( s | S )( r | R )( c | C ) *=* ( '|\")?(\\w|\\\\|\\/|\\.)+(' | \" |*|> ) ? \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684IP\u5730\u5740 \uff1a ( \\ d + ) \\ .( \\ d + ) \\ .( \\ d + ) \\ .( \\ d + ) \u6216 \uff1a (( 2 [ 0-4 ] \\ d | 25 [ 0-5 ]|[ 01 ] ? \\ d \\ d ? ) \\ .) { 3 } ( 2 [ 0-4 ] \\ d | 25 [ 0-5 ]|[ 01 ] ? \\ d \\ d ? ) \u6216 \uff1a ^ (( [ 0-9 ]|[ 1-9 ][ 0-9 ]| 1 [ 0-9 ] { 2 } | 2 [ 0-4 ][ 0-9 ]| 25 [ 0-5 ] ) \\ .) { 3 } ( [ 0-9 ]|[ 1-9 ][ 0-9 ]| 1 [ 0-9 ] { 2 } | 2 [ 0-4 ][ 0-9 ]| 25 [ 0-5 ] ) $ \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u624b\u673a\u53f7\u7801 \uff1a ( 86 ) * 0 * 13 \\ d { 9 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u56fa\u5b9a\u7535\u8bdd\u53f7\u7801 \uff1a ( \\ ( \\ d { 3 , 4 }\\ ) | \\ d { 3 , 4 } -| \\ s ) ? \\ d { 8 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u7535\u8bdd\u53f7\u7801 \uff08 \u5305\u62ec\u79fb\u52a8\u548c\u56fa\u5b9a\u7535\u8bdd \uff09\uff1a ( \\ ( \\ d { 3 , 4 }\\ ) | \\ d { 3 , 4 } -| \\ s ) ? \\ d { 7 , 14 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u90ae\u653f\u7f16\u7801 \uff1a [ 1-9 ] { 1 } ( \\ d + ) { 5 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u6d6e\u70b9\u6570 \uff08 \u5373\u5c0f\u6570 \uff09\uff1a ( - ? \\ d * ) \\ . ? \\ d + \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4efb\u4f55\u6570\u5b57 \uff1a ( - ? \\ d * )( \\ . \\ d + ) ? \u7535\u8bdd\u533a\u53f7 \uff1a /^ 0 \\ d { 2 , 3 }$ / \u817e\u8bafQQ\u53f7 \uff1a ^[ 1-9 ]*[ 1-9 ][ 0-9 ]* $ \u5e10\u53f7 ( \u5b57\u6bcd\u5f00\u5934 \uff0c \u5141\u8bb85 - 16 \u5b57\u8282 \uff0c \u5141\u8bb8\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf ) \uff1a ^[ a-zA-Z ][ a-zA-Z0-9_ ] { 4 , 15 }$ \u4e2d\u6587 \u3001 \u82f1\u6587 \u3001 \u6570\u5b57\u53ca\u4e0b\u5212\u7ebf \uff1a ^[ \\u4e00-\\u9fa5_a-zA-Z0-9 ]+ $ sql\u8bed\u53e5 \uff1a ^ ( select | drop | delete | create | update | insert ). * $ \u5339\u914d\u884c\u9996\u7a7a\u683c \uff1a ^ \\ s * \u5339\u914d\u884c\u5c3e\u7a7a\u683c \uff1a\\ s * $ \\< \u5339\u914d\u8bcd\u9996 > \u5339\u914d\u8bcd\u5c3e \\b \u5339\u914d\u5355\u8bcd\u8fb9\u754c \u5bf9\u6bd4\u5982\u4e0b\uff1a line = \"cat dog sky\" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo line = \"cat dog sky\" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo line = \"cat dog sky \" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo # \u8f93\u51fa\u5206\u522b\u662f\uff1a # |cat dog |sky| # |cat dog| sky| # |cat dog |sky| # |cat dog |sky| # |cat dog| sky| # |cat dog |sky| # |cat dog sky| | # |cat dog sky| | # |cat dog |sky |","title":"Regex"},{"location":"Regex/#_1","text":"\u57fa\u672c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Basic Regular Expression \u53c8\u53ebBasic RegEx \u7b80\u79f0BREs\uff09 \u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Extended Regular Expression \u53c8\u53ebExtended RegEx \u7b80\u79f0EREs\uff09 Perl\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Perl Regular Expression \u53c8\u53ebPerl RegEx \u7b80\u79f0PREs\uff09 []\u7b26\u53f7\u5339\u914d\u5b57\u7b26\u96c6\u5408\uff0c\u652f\u6301\u7a77\u4e3e\u65b9\u6cd5\u5339\u914d\u5b57\u7b26\u96c6\u5408\u7684\u6240\u6709\u5143\u7d20\u4e5f\u652f\u6301\u4f7f\u7528-\u7b26\u53f7\u8868\u793a\u96c6\u5408\u8303\u56f4\uff0c^\u7b26\u53f7\u5728[]\u4e2d\u8868\u793a\u53d6\u53cd \u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\ \u8f6c\u4e49\u7b26\uff0c\u5c06\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\uff0c\u5ffd\u7565\u5176\u7279\u6b8a\u610f\u4e49 a.b\u5339\u914da.b\uff0c\u4f46\u4e0d\u80fd\u5339\u914dajb\uff0c.\u88ab\u8f6c\u4e49\u4e3a\u7279\u6b8a\u610f\u4e49 \\ \\ \\ ^ \u5339\u914d\u884c\u9996\uff0cawk\u4e2d\uff0c^\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u5f00\u59cb ^tux\u5339\u914d\u4ee5tux\u5f00\u5934\u7684\u884c ^ ^ ^ $ \u5339\u914d\u884c\u5c3e\uff0cawk\u4e2d\uff0c$\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e tux$\u5339\u914d\u4ee5tux\u7ed3\u5c3e\u7684\u884c $ $ $ . \u5339\u914d\u9664\u6362\u884c\u7b26\\n\u4e4b\u5916\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff0cawk\u5219\u4e2d\u53ef\u4ee5 ab.\u5339\u914dabc\u6216bad\uff0c\u4e0d\u53ef\u5339\u914dabcd\u6216abde\uff0c\u53ea\u80fd\u5339\u914d\u5355\u5b57\u7b26,\u4f46\u540c\u4e00\u4e2a\u6b63\u5219\u53ef\u4f7f\u7528\u591a\u4e2a\u6765\u5339\u914d\u591a\u4e2a\u5b57\u7b26 . . . [] \u5339\u914d\u5305\u542b\u5728[\u5b57\u7b26]\u4e4b\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 coo[kl]\u53ef\u4ee5\u5339\u914dcook\u6216cool [] [] [] [^] \u5339\u914d[^\u5b57\u7b26]\u4e4b\u5916\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 123[^45]\u4e0d\u53ef\u4ee5\u5339\u914d1234\u62161235\uff0c1236\u30011237\u90fd\u53ef\u4ee5 [^] [^] [^] [-] \u5339\u914d[]\u4e2d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u8981\u5199\u6210\u9012\u589e [0-9]\u53ef\u4ee5\u5339\u914d1\u30012\u62163\u7b49\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 [-] [-] [-] ? \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u80050\u6b21 colou?r\u53ef\u4ee5\u5339\u914dcolor\u6216\u8005colour\uff0c\u4e0d\u80fd\u5339\u914dcolouur \u4e0d\u652f\u6301 ? ? + \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u8005\u591a\u6b21 sa-6+\u5339\u914dsa-6\u3001sa-666\uff0c\u4e0d\u80fd\u5339\u914dsa- \u4e0d\u652f\u6301 + + * \u5339\u914d\u4e4b\u524d\u7684\u98790\u6b21\u6216\u8005\u591a\u6b21 co*l\u5339\u914dcl\u3001col\u3001cool\u3001coool\u7b49 * * * () \u5339\u914d\u8868\u8fbe\u5f0f\uff0c\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u5339\u914d\u7684\u5b50\u4e32 matri?\u5339\u914dmax\u6216maxtrix \u4e0d\u652f\u6301 {n} \u5339\u914d\u4e4b\u524d\u7684\u9879n\u6b21\uff0cn\u662f\u53ef\u4ee5\u4e3a0\u7684\u6b63\u6574\u6570 [0-9]{3}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e09\u4f4d\u6570\uff0c\u53ef\u4ee5\u6269\u5c55\u4e3a[0-9][0-9][0-9] \u4e0d\u652f\u6301 {n} {n} {n,} \u4e4b\u524d\u7684\u9879\u81f3\u5c11\u9700\u8981\u5339\u914dn\u6b21 [0-9]{2,}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e24\u4f4d\u6570\u6216\u66f4\u591a\u4f4d\u6570 \u4e0d\u652f\u6301 {n,} {n,} {n,m} \u6307\u5b9a\u4e4b\u524d\u7684\u9879\u81f3\u5c11\u5339\u914dn\u6b21\uff0c\u6700\u591a\u5339\u914dm\u6b21\uff0cn<=m [0-9]{2,5}\u5339\u914d\u4ece\u4e24\u4f4d\u6570\u5230\u4e94\u4f4d\u6570\u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 \u4e0d\u652f\u6301 {n,m} {n,m} | \u4ea4\u66ff\u5339\u914d|\u4e24\u8fb9\u7684\u4efb\u610f\u4e00\u9879 abc d\u5339\u914dabc\u6216abd \u4e0d\u652f\u6301 **POSIX\u5b57\u7b26\u7c7b**\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5[\uff1aCLASS\uff1a]\u5728\u65b9\u62ec\u53f7\u5185\u6307\u5b9a\u5b57\u7b26\u7c7b\uff0c\u5176\u4e2dCLASS\u5728POSIX\u6807\u51c6\u4e2d\u5b9a\u4e49\u5e76\u5177\u6709\u5176\u4e2d\u4e00\u4e2a\u503c \u4f8b\u5982\uff1als -ld [[:digit:]]* # \u5339\u914d\u4ee5\u6570\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg [:alnum:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57\u5b57\u7b26 [[:alnum:]]+ [:alnum:] [:alnum:] [:alnum:] [:alpha:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u5b57\u7b26\uff08\u5305\u62ec\u5927\u5c0f\u5199\u5b57\u6bcd\uff09 [[:alpha:]]{4} [:alpha:] [:alpha:] [:alpha:] [:blank:] \u7a7a\u683c\u4e0e\u5236\u8868\u7b26\uff08\u6a2a\u5411\u548c\u7eb5\u5411\uff09 [[:blank:]]* [:blank:] [:blank:] [:blank:] [:digit:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26 [[:digit:]]? [:digit:] [:digit:] [:digit:] [:lower:] \u5339\u914d\u5c0f\u5199\u5b57\u6bcd [[:lower:]]{5,} [:lower:] [:lower:] [:lower:] [:upper:] \u5339\u914d\u5927\u5199\u5b57\u6bcd [[:upper:]]+? [:upper:] [:upper:] [:upper:] [:punct:] \u5339\u914d\u6807\u70b9\u7b26\u53f7 [[:punct:]] [:punct:] [:punct:] [:punct:] [:space:] \u5339\u914d\u4e00\u4e2a\u5305\u62ec\u6362\u884c\u7b26\u3001\u56de\u8f66\u7b49\u5728\u5185\u7684\u6240\u6709\u7a7a\u767d\u7b26 [[:space:]]+ [:space:] [:space:] [:space:] [:graph:] \u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u770b\u5f97\u89c1\u7684\u4e14\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:graph:]] [:graph:] [:graph:] [:graph:] [:xdigit:] \u4efb\u4f55\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u6570\uff08\u5373\uff1a0-9\uff0ca-f\uff0cA-F\uff09 [[:xdigit:]]+ [:xdigit:] [:xdigit:] [:xdigit: [:cntrl:] \u4efb\u4f55\u4e00\u4e2a\u63a7\u5236\u5b57\u7b26\uff08ASCII\u5b57\u7b26\u96c6\u4e2d\u7684\u524d32\u4e2a\u5b57\u7b26 [[:cntrl:]] [:cntrl:] [:cntrl:] [:cntrl:] [:print:] \u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:print:]] [:print:] [:print:] [:print:] \u5143\u5b57\u7b26 \uff08meta character\uff09\u662f\u4e00\u79cdPerl\u98ce\u683c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709\u4e00\u90e8\u5206\u6587\u672c\u5904\u7406\u5de5\u5177\u652f\u6301\u5b83\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6587\u672c\u5904\u7406\u5de5\u5177\u90fd\u652f\u6301\u3002 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\b \u5355\u8bcd\u8fb9\u754c \\bcool\\b \u5339\u914dcool\uff0c\u4e0d\u5339\u914dcoolant \\b \\b \\b \\B \u975e\u5355\u8bcd\u8fb9\u754c cool\\B \u5339\u914dcoolant\uff0c\u4e0d\u5339\u914dcool \\B \\B \\B \\d \u5355\u4e2a\u6216\u66f4\u591a\u8fde\u7eed\u7684\u6570\u5b57 b\\db \u5339\u914db2b\uff0c\u4e0d\u5339\u914dbcb \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\d \\D \u5355\u4e2a\u975e\u6570\u5b57\u5b57\u7b26 b\\Db \u5339\u914dbcb\uff0c\u4e0d\u5339\u914db2b \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\D \\w \u5355\u4e2a\u5355\u8bcd\u5b57\u7b26\uff08\u5b57\u6bcd\u3001\u6570\u5b57\u4e0e_\uff09 \\w \u5339\u914d1\u6216a\uff0c\u4e0d\u5339\u914d& \\w \\w \\w \\W \u5339\u914d\u4efb\u610f\u4e0d\u662f\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf\uff0c\u6c49\u5b57\u7684\u5b57\u7b26 \\W \u5339\u914d&\uff0c\u4e0d\u5339\u914d1\u6216a \\W \\W \\W \\n \u6362\u884c\u7b26 \\n \u5339\u914d\u4e00\u4e2a\u65b0\u884c \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\n \\s \u5355\u4e2a\u7a7a\u767d\u5b57\u7b26 x\\sx \u5339\u914dx x\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\s \\S \u5355\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 x\\S\\x \u5339\u914dxkx\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\S \\r \u56de\u8f66 \\r \u5339\u914d\u56de\u8f66 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\r \\t \u6a2a\u5411\u5236\u8868\u7b26 \\t \u5339\u914d\u4e00\u4e2a\u6a2a\u5411\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\t \\v \u5782\u76f4\u5236\u8868\u7b26 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\v \\f \u6362\u9875\u7b26 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\f **\u540e\u5411\u5f15\u7528**\u7528\u4e8e\u91cd\u590d\u641c\u7d22\u524d\u9762\u67d0\u4e2a\u5206\u7ec4\u5339\u914d\u7684\u6587\u672c\uff0cexp(expression)\u4ee3\u8868\u8868\u8fbe\u5f0f,\u5e38\u7528\u5206\u7ec4\u8bed\u6cd5\u5982\u4e0b\uff1a | \u4ee3\u7801/\u8bed\u6cd5 | \u8bf4\u660e | | :------: | :------: | | [^x] | \u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 | | [^aeiou] | \u5339\u914d\u9664\u4e86aeiou\u8fd9\u51e0\u4e2a\u5b57\u6bcd\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 |","title":"\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5206\u7c7b"},{"location":"Regex/#_2","text":"\u4ee5\u6c49\u5b57\u5f00\u5934\u7684\u884c \uff1a ^[ \\u4e00-\\u9fa5 ] \u8be6\u89e3 \uff1a [ \\u4e00-\\u9fa5 ] \u4ee3\u8868\u4efb\u4f55\u4e00\u4e2a\u6c49\u5b57 --\u539f\u7406\uff1aU4300-U9fa5\u4ee3\u8868\u4e86\u7b26\u5408\u6c49\u5b57GB18030\u89c4\u8303\u7684\u5b57\u7b26\u96c6 \u5339\u914d\u81f3\u5c11\u4e00\u4e2a\u6c49\u5b57 \uff1a [ \\u4E00-\\u9FA5 ]+ \u7a7a\u884c\u7684\u8868\u793a\u65b9\u6cd5 : ^ $ \u6216 \uff1a\\ n [ \\s| ]* \\ r \u5339\u914d\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c \uff1a ^ . $ \u5339\u914d\u4e0d\u5728b ~ d\u8303\u56f4\u7684\u5b57\u7b26 \uff1a [ ^b-d ] \u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 \uff1a [ ^x ] \u5339\u914d\u6240\u6709\u82f1\u6587\u5355\u8bcd \uff1a [ A-Za-z ][ A-Za-z ]* \u7cbe\u786e\u5339\u914d\u5b57\u7b26 \uff08 \u4f8b\u5982\u7cbe\u786e\u5339\u914d\u5355\u8bcdthe \uff0c \u4e0d\u5339\u914d\u5305\u542bthe\u7684\u5355\u8bcd \uff0c \u5982them \uff0c they\u7b49 \uff09\uff1a\\ < the \\ > \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u91cd\u590dn\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n \\} \u4f8b\u5982\u5339\u914d\u503cjooob \uff1a jo \\{ 3 \\} b \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u81f3\u5c11\u51fa\u73b0n\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n , \\} \u4f8b\u5982 \uff1a jo \\{ 3 , \\} b #jooob \u3001 joooob\u7b49\u5b57\u7b26\u90fd\u7531\u6b64\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d \u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u51fa\u73b0n ~ m\u6b21\u7684\u5b57\u7b26 \uff1a\\{ n , m \\} \u4f8b\u5982 \uff1a jo { 3 , 6 \\} #\u5339\u914djooob \u3001 joooooob\u7b49\u5b57\u7b26 \uff0c \u81f3\u5c113\u6b21 \uff0c \u6700\u591a6\u6b21 \u7cbe\u786e\u5339\u914d5\u4e2a\u5c0f\u5199\u5b57\u7b26 \uff1a [ a-z ] \\{ 5 \\} #\u5982hello \u3001 house\u7b495\u4e2a\u5c0f\u5199\u5355\u8bcd\u6216\u5b57\u7b26 \u5339\u914djob\u6216joob \uff1a jo ? b + \u7b26\u53f7\u548c \u00d7 \u7b26\u53f7\u7c7b\u4f3c \uff0c \u5339\u914d\u5176\u524d\u9762\u7684\u5b57\u7b26\u591a\u6b21 \uff0c \u4f46\u662f \u00d7 \u53ef\u4ee5\u5339\u914d0\u6b21 \uff0c \u800c + \u81f3\u5c11\u8981\u5339\u914d1\u6b21 \uff1a jo + b\u8868\u793a \uff1a joob \u3001 jooob\u7b49\u5b57\u7b26 \uff0c job\u4e0d\u80fd\u7528\u6b64\u6765\u5339\u914d () \u548c | \u7b26\u53f7\u7ec4\u5408\u4f7f\u7528 \uff0c \u8868\u793a\u4e00\u7ec4\u53ef\u9009\u5b57\u7b26\u7684\u96c6\u5408 \uff1a re ( a | e | o ) d\u8868\u8fbe\u5f0f\u4e2d\u7684 ( a | e | o ) \u8868\u793a \uff1a \u5728\u5b57\u7b26a \u3001 e \u3001 o\u4e2d\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\u5b57\u7b26 \uff0c \u5373read \u3001 reed \u3001 reod\u90fd\u53ef\u4ee5\u7531\u6b64\u8868\u8fbe\u5f0f\u5339\u914d () \u5f88\u5c11\u4f7f\u7528 \uff0c \u56e0\u4e3a [] \u7b26\u53f7\u53ef\u4ee5\u5b8c\u5168\u66ff\u4ee3 \uff0c re ( a | e | o ) d\u7b49\u4ef7\u4e8ere [ aeo ] d \u975e\u8d1f\u6574\u6570 \uff1a ^ \\ d + $ \u6b63\u6574\u6570 \uff1a ^[ 0-9 ]*[ 1-9 ][ 0-9 ]* $ \u975e\u6b63\u6574\u6570 \uff1a ^ (( - \\ d + ) | ( 0 + )) $ \u8d1f\u6574\u6570 \uff1a ^-[ 0-9 ]*[ 1-9 ][ 0-9 ]* $ \u6574\u6570 \uff1a ^- ? \\ d + $ \u975e\u8d1f\u6d6e\u70b9\u6570 \uff1a ^ \\ d + ( \\ . \\ d + ) ? $ \u6b63\u6d6e\u70b9\u6570 : ^ (( 0 - 9 ) + \\ . [ 0-9 ]*[ 1-9 ][ 0-9 ]* ) | ( [ 0-9 ]*[ 1-9 ][ 0-9 ]* \\ . [ 0-9 ]+ ) | ( [ 0-9 ]*[ 1-9 ][ 0-9 ]* ) $ \u975e\u6b63\u6d6e\u70b9\u6570 \uff1a ^ (( - \\ d + \\ . \\ d + ) ? ) | ( 0 + ( \\ .0 + ) ? )) $ \u8d1f\u6d6e\u70b9\u6570 \uff1a ^ ( - (( \u6b63\u6d6e\u70b9\u6570\u6b63\u5219\u5f0f ))) $ \u82f1\u6587\u5b57\u7b26\u4e32 \uff1a ^[ A-Za-z ]+ $ \u82f1\u6587\u5927\u5199\u4e32 \uff1a ^[ A-Z ]+ $ \u82f1\u6587\u5c0f\u5199\u4e32 \uff1a ^[ a-z ]+ $ \u82f1\u6587\u5b57\u7b26\u6570\u5b57\u4e32 \uff1a ^[ A-Za-z0-9 ]+ $ \u82f1\u6570\u5b57\u52a0\u4e0b\u5212\u7ebf\u4e32 \uff1a ^ \\ w + $ E - mail\u5730\u5740 \uff1a ^[ \\w- ]+ ( \\ . [ \\w- ]+ ) * @ [ \\w- ]+ ( \\ . [ \\w- ]+ ) + $ \u6216 \uff1a\\ w + ( [ -+. ] \\ w + ) * @\\ w + ( [ -. ] \\ w + ) * \\ . \\ w + ( [ -. ] \\ w + ) * URL \uff1a ^[ a-zA-Z ]+ : // ( \\ w + ( - \\ w + ) * )( \\ .( \\ w + ( - \\ w + ) * )) * ( \\ ? \\ s * ) ? $ \u6216 \uff1a ^ http : \\ / \\ /[ A-Za-z0-9 ]+ \\ . [ A-Za-z0-9 ]+[ \\/=\\?%\\-&_~`@[\\ ] \\ ':+!]*([^<>\\\"\\\"])*$ \u90ae\u653f\u7f16\u7801\uff1a^[1-9]\\d{5}$ \u4e2d\u6587\u5b57\u7b26\uff1a^[\\u0391-\\uFFE5]+$ \u7535\u8bdd\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?(\\(0\\d{2,3}\\)|0\\d{2,3}-)?[1-9]\\d{6,7}(\\-\\d{1,4})?$ \u624b\u673a\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?13\\d{9}$ \u53cc\u5b57\u8282\u5b57\u7b26(\u5305\u62ec\u6c49\u5b57\u5728\u5185)\uff1a^\\x00-\\xff \u5339\u914d\u9996\u5c3e\u7a7a\u683c\uff1a(^\\s*)|(\\s*$)\uff08\u50cfvbscript\u90a3\u6837\u7684trim\u51fd\u6570\uff09 \u5339\u914dHTML\u6807\u8bb0\uff1a<(.*)>.*<\\/\\1>|<(.*)\\/> \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u7f51\u7edc\u94fe\u63a5\uff1a(h|H)(r|R)(e|E)(f|F)*=*(' | \")?(\\w|\\\\|\\/|\\.)+('|\" |*|> ) ? \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u90ae\u4ef6\u5730\u5740 \uff1a\\ w + ( [ -+. ] \\ w + ) * @\\ w + ( [ -. ] \\ w + ) * \\ . \\ w + ( [ -. ] \\ w + ) * \u6216 [ a-zA-Z0-9\\-_+ ]+ @ [ A-Za-z ]+ \\ .( com | cn | net ) \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u56fe\u7247\u94fe\u63a5 \uff1a ( s | S )( r | R )( c | C ) *=* ( '|\")?(\\w|\\\\|\\/|\\.)+(' | \" |*|> ) ? \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684IP\u5730\u5740 \uff1a ( \\ d + ) \\ .( \\ d + ) \\ .( \\ d + ) \\ .( \\ d + ) \u6216 \uff1a (( 2 [ 0-4 ] \\ d | 25 [ 0-5 ]|[ 01 ] ? \\ d \\ d ? ) \\ .) { 3 } ( 2 [ 0-4 ] \\ d | 25 [ 0-5 ]|[ 01 ] ? \\ d \\ d ? ) \u6216 \uff1a ^ (( [ 0-9 ]|[ 1-9 ][ 0-9 ]| 1 [ 0-9 ] { 2 } | 2 [ 0-4 ][ 0-9 ]| 25 [ 0-5 ] ) \\ .) { 3 } ( [ 0-9 ]|[ 1-9 ][ 0-9 ]| 1 [ 0-9 ] { 2 } | 2 [ 0-4 ][ 0-9 ]| 25 [ 0-5 ] ) $ \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u624b\u673a\u53f7\u7801 \uff1a ( 86 ) * 0 * 13 \\ d { 9 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u56fa\u5b9a\u7535\u8bdd\u53f7\u7801 \uff1a ( \\ ( \\ d { 3 , 4 }\\ ) | \\ d { 3 , 4 } -| \\ s ) ? \\ d { 8 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u7535\u8bdd\u53f7\u7801 \uff08 \u5305\u62ec\u79fb\u52a8\u548c\u56fa\u5b9a\u7535\u8bdd \uff09\uff1a ( \\ ( \\ d { 3 , 4 }\\ ) | \\ d { 3 , 4 } -| \\ s ) ? \\ d { 7 , 14 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u90ae\u653f\u7f16\u7801 \uff1a [ 1-9 ] { 1 } ( \\ d + ) { 5 } \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u6d6e\u70b9\u6570 \uff08 \u5373\u5c0f\u6570 \uff09\uff1a ( - ? \\ d * ) \\ . ? \\ d + \u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4efb\u4f55\u6570\u5b57 \uff1a ( - ? \\ d * )( \\ . \\ d + ) ? \u7535\u8bdd\u533a\u53f7 \uff1a /^ 0 \\ d { 2 , 3 }$ / \u817e\u8bafQQ\u53f7 \uff1a ^[ 1-9 ]*[ 1-9 ][ 0-9 ]* $ \u5e10\u53f7 ( \u5b57\u6bcd\u5f00\u5934 \uff0c \u5141\u8bb85 - 16 \u5b57\u8282 \uff0c \u5141\u8bb8\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf ) \uff1a ^[ a-zA-Z ][ a-zA-Z0-9_ ] { 4 , 15 }$ \u4e2d\u6587 \u3001 \u82f1\u6587 \u3001 \u6570\u5b57\u53ca\u4e0b\u5212\u7ebf \uff1a ^[ \\u4e00-\\u9fa5_a-zA-Z0-9 ]+ $ sql\u8bed\u53e5 \uff1a ^ ( select | drop | delete | create | update | insert ). * $ \u5339\u914d\u884c\u9996\u7a7a\u683c \uff1a ^ \\ s * \u5339\u914d\u884c\u5c3e\u7a7a\u683c \uff1a\\ s * $ \\< \u5339\u914d\u8bcd\u9996 > \u5339\u914d\u8bcd\u5c3e \\b \u5339\u914d\u5355\u8bcd\u8fb9\u754c \u5bf9\u6bd4\u5982\u4e0b\uff1a line = \"cat dog sky\" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo line = \"cat dog sky\" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo line = \"cat dog sky \" echo \" $line \" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\>\\(.*\\)/# |\\1|\\2|/p\" echo \" $line \" | sed -n \"s/\\(.*\\)\\<\\(.*\\)/# |\\1|\\2|/p\" echo # \u8f93\u51fa\u5206\u522b\u662f\uff1a # |cat dog |sky| # |cat dog| sky| # |cat dog |sky| # |cat dog |sky| # |cat dog| sky| # |cat dog |sky| # |cat dog sky| | # |cat dog sky| | # |cat dog |sky |","title":"\u5e38\u7528\u6b63\u5e38\u8868\u8fbe\u5f0f"},{"location":"Shell/","text":"shell\u7b14\u8bb0 \u00b6 bash shell\u672c\u8eab\u4e0d\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4f7f\u7528\u6b63\u5219\u7684\u662fshell\u547d\u4ee4\u548c\u5de5\u5177\uff0c\u5982grep\u3001sed\u7b49\u3002bash shell\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7684\u4e00\u4e9b\u5143\u5b57\u7b26\u5b9e \u73b0\u901a\u914d(Globbing)\u529f\u80fd\u3002\u901a\u914d\u5c31\u662f\u628a\u4e00\u4e2a\u5305\u542b\u901a\u914d\u7b26\u7684\u975e\u5177\u4f53\u6587\u4ef6\u540d\u6269\u5c55\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u7684\u4e00\u6279\u5177\u4f53\u6587\u4ef6\u540d\u7684\u8fc7\u7a0b Reference List Bash Guide for Beginners Advanced Bash-Scripting Guide shell\u591a\u884c\u6ce8\u91ca\u5b9e\u73b0\u65b9\u5f0f \u00b6 \u65b9\u6cd5\u4e00\uff1a : << \u5b57\u7b26(\u4e00\u822c\u4f7f\u7528comment\u4fbf\u4e8e\u8bc6\u522b) \u8bed\u53e5 \u5b57\u7b26 \u65b9\u6cd5\u4e8c\uff1a : ' \u8bed\u53e5 ' EOF\u5e38\u89c1\u7528\u6cd5 \u00b6 # \u7f16\u5199SHELL\u663e\u793a\u591a\u4e2a\u4fe1\u606f cat <<EOF +--------------------------------------------------------------+ | === Welcome to Tunoff services === | +--------------------------------------------------------------+ EOF # \u5c06mongodbrepo\u5199\u5165\u5230mongodb.repo\u6587\u4ef6 cat << EOF > /etc/yum.repos.d/mongodb.repo [mongodb-org-3.4] name=MongoDB 3.4 Repository baseurl=https://mirrors.aliyun.com/mongodb/yum/redhat/\\$releasever/mongodb-org/3.4/\\$basearch/ gpgcheck=0 enabled=1 EOF shell\u7279\u6b8a\u53d8\u91cf\u57fa\u672c\u89e3\u91ca \u00b6 $* # \u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $@ # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\uff0c\u548c$*\u7c7b\u4f3c\uff0c\u4f46\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77\uff0c\u4e14\u4ecd\u4fdd\u7559\u6bcf\u4e2a\u5f15\u7528\u53d8\u91cf\u7684\u533a\u6bb5\u542b\u4e49 $# # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u603b\u7684\u53c2\u6570\u6570\u76ee $* # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $_ # \u83b7\u53d6\u5728\u6b64\u4e4b\u524d\u6267\u884c\u7684\u547d\u4ee4\u6216\u811a\u672c\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570 $? # (\u5e38\u7528)\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u503c;\u6210\u529f\u8fd4\u56de0,\u5931\u8d25\u8fd4\u56de1 # \u8fd4\u56de\u503c\u53c2\u8003\uff1a 0 # \u8868\u793a\u8fd0\u884c\u6210\u529f 2 # \u6743\u9650\u62d2\u7edd 1~125 # \u8fd0\u884c\u5931\u8d25\u3001\u811a\u672c\u547d\u4ee4\u3001\u7cfb\u7edf\u547d\u4ee4\u9519\u8bef\u6216\u53c2\u6570\u4f20\u9012\u9519\u8bef 126 # \u627e\u5230\u8be5\u547d\u4ee4\u4f46\u65e0\u6cd5\u6267\u884c 127 # \u672a\u627e\u5230\u8981\u8fd0\u884c\u7684\u547d\u4ee4 >128 # \u547d\u4ee4\u88ab\u7cfb\u7edf\u5f3a\u5236\u7ed3\u675f $$ # \u5f53\u524dshell\u8fd0\u884c\u65f6\u7684\u8fdb\u7a0bID $! # \u4e0a\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7 $@ # \u6240\u6709\u7684\u53c2\u6570\uff0c\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77 $n # (\u5e38\u7528)\u4f4d\u7f6e\u53c2\u6570\u503c\uff0cn\u8868\u793a\u4f4d\u7f6e\uff0c\u83b7\u53d6\u5f53\u524d\u811a\u672c\u7b2cn\u4e2a\u53c2\u6570\u503c\uff0cn\u5927\u4e8e9\u65f6\u8981\u7528\u5927\u62ec\u53f7\uff0c\u4f8b ${ 10 } \uff0c\u63a5\u7684\u53c2\u6570\u4ee5\u7a7a\u683c\u9694\u5f00 $0 # (\u5e38\u7528)\u5f53\u524dshell\u540d(\u5f53\u524d\u6267\u884c\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u6267\u884c\u811a\u672c\u5305\u542b\u8def\u5f84\u5219\u8fd4\u56de\u4e5f\u5305\u542b\u811a\u672c\u8def\u5f84) # \u6570\u503c\u6bd4\u8f83\uff1a -eq # \u7b49\u4e8e -ne # \u4e0d\u7b49\u4e8e -gt # \u5927\u4e8e -ge # \u5927\u4e8e\u6216\u7b49\u4e8e -lt # \u5c0f\u4e8e -le # \u5c0f\u4e8e\u6216\u7b49\u4e8e # \u903b\u8f91\u6d4b\u8bd5\uff1a && # \u903b\u8f91\u4e0e || # \u903b\u8f91\u6216 ! # \u903b\u8f91\u5426 \u5728shell\u4e2d\u5e38\u7528\u7684\u7b26\u53f7\u4e00\u822c\u7528\u6cd5\uff1a \u00b6 # ;(Command separator)\u5206\u53f7 \u5728 shell \u4e2d\u62c5\u4efb \" \u8fde\u7eed\u6307\u4ee4 \" \u529f\u80fd\u7684\u7b26\u53f7\u5c31\u662f\u5206\u53f7 \u4f8b\u5982\uff1a cd ~/ backup ;mkdir startup;cp ~/.* startup/. # \u8fdb\u5165\u5bb6\u76ee\u5f55\u4e0bbackup\u5e76\u521b\u5efa\u76ee\u5f55startup\uff0c\u590d\u5236\u5bb6\u76ee\u5f55\u4e0b\u6240\u6709\u5230startup\u4e0b # ;;(Terminator)\u8fde\u7eed\u5206\u53f7 \u4e13\u7528\u5728 case \u6d41\u7a0b\u63a7\u5236\u9009\u9879\uff0c\u62c5\u4efb Terminator \u89d2\u8272\u3002\u4f8b\u5982\uff1a case \\ \" $fop\\ \" in help ) echo \\ \" Usage: Command -help -version filename\\ \" ;;version) echo \\\"version 0.1\\\" ;;esac # . ( dot ) \u82f1\u6587\u53e5\u53f7 shell \u4e2d\u4e00\u4e2a dot \u4ee3\u8868\u5f53\u524d\u76ee\u5f55\uff0c\u4e24\u4e2a\u4ee3\u8868\u4e0a\u5c42\u76ee\u5f55\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u5219\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26 # ' string ' ( single quote ) \u5355\u5f15\u53f7 \u5355\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u4e14$\u7b26\u53f7\u4e5f\u88ab\u5f53\u505a\u4e00\u822c\u5b57\u7b26\u5904\u7406 # \" string \" ( double quote ) \u53cc\u5f15\u53f7 \u53cc\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u9632\u6b62\u901a\u914d\u7b26\u6269\u5c55\uff0c\u4f46\u662f\u5141\u8bb8\u53d8\u91cf\u6269\u5c55\u3002\u6b64\u5904\u548c\u5355\u5f15\u53f7\u4e0d\u540c # ` command ` ( backticks ) \u5012\u5f15\u53f7 \u5012\u5f15\u53f7\u5185\u7684 command \u4f1a\u88ab\u5f53\u505a\u547d\u4ee4\u6765\u6267\u884c # , ( comma ) \u82f1\u6587\u9017\u53f7 \u6b64\u7b26\u53f7\u5e38\u7528\u5728\u8fd0\u7b97\u4e2d\uff0c\u7528\u4f5c\u533a\u57df\u9694\u79bb\u3002\u4f8b\u5982\uff1a let \" t1 = ((a = 5 + 3, b = 7 - 1, c = 15 - 4)) \" ;echo \"t1 = $t1, a = $a, b = $b\" # / ( forward slash ) \u659c\u7ebf \u8def\u5f84\u4e2d\u8868\u793a\u76ee\u5f55\uff0c\u56db\u5219\u8fd0\u7b97\u4e2d\u4ee3\u8868\u9664\u6cd5\u7b26\u53f7\u3002\u4f8b\u5982\uff1a let \" num1 = ((a = 10 / 2, b = 25 / 5)) \" ;echo $num1,$a,$b # \\\\ \u5012\u659c\u7ebf \u4ea4\u4e92\u6a21\u5f0f\u4e0b\u7684 escape \u5b57\u7b26 \u4f5c\u7528\uff1a\u653e\u5728\u6307\u4ee4\u524d\u53d6\u6d88 aliases \uff1b\u653e\u5728\u7279\u6b8a\u7b26\u53f7\u524d\u5219\u8be5\u7279\u6b8a\u7b26\u53f7\u4e0d\u518d\u6709\u7279\u6b8a\u610f\u4e49\uff1b\u653e\u5728\u6307\u4ee4\u6700\u672b\u7aef\u8868\u793a\u8fde\u63a5\u4e0b\u4e00\u884c # | ( pipeline ) \u7ba1\u9053 pipeline \u7528\u6765\u8fde\u63a5\u4e0a\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u5165 # ! ( negate or reverse ) \u82f1\u6587\u611f\u53f9\u53f7 \u901a\u5e38\u4f5c\u4e3a\u53cd\u903b\u8f91\u4f7f\u7528\uff0c\u5982\u6761\u4ef6\u6d4b\u8bd5\u4e2d != \u8868\u793a\u4e0d\u7b49\u4e8e,\u4f8b\u5982\u5224\u65ad\u4e0a\u4e2a\u6307\u4ee4\u662f\u5426\u6267\u884c\u6210\u529f if [ \" $? \" != 0 ] ; then echo \"Executes error\"; fi # : \u82f1\u6587\u5192\u53f7 bash \u4e2d\u4f5c\u4e3a\u5185\u5efa\u6307\u4ee4\u8868\u793a\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u4f46\u8fd4\u56de\u72b6\u6001\u503c 0 \u4f8b\u5982\uff1a : ${ HOSTNAME }${ USER } # \u68c0\u67e5\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u662f\u5426\u5df2\u8bbe\u7f6e\uff0c\u6ca1\u6709\u8bbe\u7f6e\u5219\u4ee5\u6807\u51c6\u9519\u8bef\u663e\u793a\u9519\u8bef\u4fe1\u606f # ? ( wild card ) \u95ee\u53f7 \u6b63\u5219\u8868\u793a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u4e0d\u5305\u542b null # * ( wild card ) \u661f\u53f7 \u6b63\u5219\u4e2d\u8868\u793a\u4efb\u4f55\u5b57\u7b26\uff0c\u5305\u542b null \uff1b\u56db\u5219\u8fd0\u7b97\u4e2d\u8868\u793a\u4e58\u6cd5 # ** \u5e42\u8fd0\u7b97 let sum = 2 ** 3 ;echo $sum # \u8f93\u51fa8 # $ ( dollar sign ) dollar \u7b26\u53f7 \u53d8\u91cf\u66ff\u6362\u4ee3\u8868\u7b26\u53f7\uff1b\u6b63\u5219\u4e2d\u8868\u793a\u5339\u914d\u884c\u5c3e # ${} \u53d8\u91cf\u7684\u6b63\u5219\u8868\u8fbe\u5f0f bash \u4e2d\u5f88\u591a\u7528\u6cd5\uff0c\u8be6\u60c5\u89c1\u4e0b\u6587 # () ( command group ) \u6307\u4ee4\u7fa4\u7ec4 \u7528\u62ec\u53f7\u5c06\u4e00\u4e32\u8fde\u7eed\u6307\u4ee4\u62ec\u8d77\u6765\uff0c\u79f0\u4f5c\u6307\u4ee4\u7fa4\u7ec4\uff0c\u4f8b\u5982\uff1a ( cd ~ ; var=`pwd` ;echo $var) # (()) \u4f5c\u7528\u548c let \u547d\u4ee4\u76f8\u4f3c\uff0c\u7528\u5728\u7b97\u6570\u8fd0\u7b97\u4e2d\uff0c\u4f46\u6267\u884c\u6548\u7387\u7565\u9ad8.\u4f8b\u5982\uff1a (( a = 10 )) ;echo -e \"\u521d\u59cb\u503c: a = $a \\n\";((a++));echo \"a++ \u540e\u7ed3\u679c: a=$a\" # { } \u5927\u62ec\u53f7 ( block of code ) \u7528\u6cd5\u4e00\uff1a\u662f\u4f5c\u4e3a\u4ee3\u7801\u5757\uff0c\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u4e0e\u5c0f\u62ec\u53f7\u4e0d\u540c\u7684\u662f\u4e0d\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a sub shell \u8fd0\u884c\u3002\u811a\u672c\u4f59\u4e0b\u90e8\u5206\u4ecd\u53ef\u4f7f\u7528\u62ec\u53f7\u5185 \u53d8\u91cf\uff0c\u62ec\u53f7\u5185\u547d\u4ee4\u4e4b\u95f4\u7528\u5206\u53f7\u9694\u5f00\uff0c\u6700\u540e\u4e00\u4e2a\u4e5f\u5fc5\u987b\u6709\u5206\u53f7\uff0c{}\u7b2c\u4e00\u4e2a\u547d\u4ee4\u548c\u5de6\u8fb9\u7684\u5927\u62ec\u53f7\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\u3002\u4f8b\u5982\uff1a a = one ; { a=two; echo -e \"\\n$a \\n\";}; echo $a \u7528\u6cd5\u4e8c\uff1a\u5927\u62ec\u53f7\u62d3\u5c55\u3002 ( \u901a\u914d ( globbing )) \u5c06\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u6587\u4ef6\u540d\u505a\u6269\u5c55\u3002\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u4e0d\u5141\u8bb8\u6709\u7a7a\u767d\uff0c\u9664\u975e\u8fd9\u4e2a\u7a7a\u767d\u88ab\u5f15\u7528\u6216\u8f6c\u4e49\u3002 \u7b2c\u4e00\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u4ee5\u9017\u53f7\u5206\u5272\u7684\u6587\u4ef6\u5217\u8868\u8fdb\u884c\u62d3\u5c55\u3002\u5982 touch { a , b }. txt \u7ed3\u679c\u4e3a a . txt b . txt \u3002\u7b2c\u4e8c\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u4ee5\u70b9\u70b9\uff08..\uff09 \u5206\u5272\u7684\u987a\u5e8f\u6587\u4ef6\u5217\u8868\u8d77\u62d3\u5c55\u4f5c\u7528\uff0c\u5982\uff1a touch { a .. d }. txt \u7ed3\u679c\u4e3a a . txt b . txt c . txt d . txt \u8fd8\u53ef\u4ee5\u7528\u5728\u5b57\u7b26\u4e32\u7ec4\u5408\u4e0a\uff0c\u5982\uff1a mkdir { a , b } - { 1 , 2 } \u7ed3\u679c\u4e3a\uff1a a - 1 a - 2 b - 1 b - 2 # [] \u4e2d\u62ec\u53f7 \u4e0e test \u7b49\u540c\uff0c\u901a\u5e38\u7528\u4f5c\u6761\u4ef6\u5224\u65ad\uff0c\u53c2\u6570\u4f5c\u4e3a\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u6587\u4ef6\u6d4b\u8bd5\uff0c\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u72b6\u6001\u7801 test \u548c[]\u4e2d\u6bd4\u8f83\u8fd0\u7b97\u7b26\u53ea\u6709 == \u548c != \uff0c\u7528\u4e8e\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u6574\u6570\u6bd4\u8f83\u53ea\u80fd - gt , - eq \u7b49 \u6b63\u5219\u4e2d\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u8303\u56f4 \u5728\u4e00\u4e2a array \u7ed3\u6784\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4e2d\u62ec\u53f7\u7528\u4e8e\u5f15\u7528\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u7f16\u53f7 # [[]] \u6b64\u62ec\u53f7\u4e4b\u95f4\u4efb\u4f55\u5b57\u7b26\u90fd\u4e0d\u4f1a\u53d1\u751f\u6587\u4ef6\u6269\u5c55\u540d\u6216\u8005\u5355\u8bcd\u7684\u5206\u5272\uff0c\u4f46\u4f1a\u6709\u53c2\u6570\u6269\u5c55\u548c\u547d\u4ee4\u66ff\u6362 \u652f\u6301\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f\u5339\u914d\uff0c\u5b57\u7b26\u4e32\u6bd4\u8f83\u65f6\u53ef\u4ee5\u628a\u53f3\u8fb9\u5f53\u505a\u4e00\u4e2a\u6a21\u5f0f \u4f7f\u7528[[]]\u4f5c\u4e3a\u6761\u4ef6\u5224\u65ad\u53ef\u9632\u6b62\u811a\u672c\u4e2d\u903b\u8f91\u9519\u8bef\uff0c && , || , < , > \u64cd\u4f5c\u7b26\u53ef\u5728[[]]\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u5728[]\u4e2d\u4f1a\u62a5\u9519 \u4f8b\u5982\uff1a read ak ; if [[ $ak > 5 || $ak < 2 ]]; then echo \"$ak\"; fi # \u8f93\u51fa / \u8f93\u5165\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff1a > >> < << &> 2 &> 2 <>>& >& 2 \u6587\u4ef6\u63cf\u8ff0\u7b26 ( file descriptor \uff09\u901a\u5e38\u7528\u4e00\u4e2a\u6570\u5b57 ( 0 - 9 ) \u8868\u793a\u6587\u4ef6 \u5e38\u89c1\u63cf\u8ff0\u7b26\u5982\u4e0b\uff1a \u6587\u4ef6\u63cf\u8ff0\u7b26 \u540d\u79f0 \u7f29\u5199 \u9ed8\u8ba4\u503c 0 \u6807\u51c6\u8f93\u5165 stdin \u952e\u76d8 1 \u6807\u51c6\u8f93\u51fa stdout \u5c4f\u5e55 2 \u6807\u51c6\u9519\u8bef\u8f93\u51fa stderr \u5c4f\u5e55 \u7b80\u5355\u4f7f\u7528 < \u6216 > \u65f6\uff0c\u76f8\u5f53\u4e8e 0 < \u6216 1 > command > file # command \u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u5230 file command >> file # command \u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u8ffd\u52a0\u5230 file command < file # command \u547d\u4ee4\u4ece file \u8bfb\u53d6 command << file # \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6\u8f93\u5165\uff0c\u77e5\u9053\u4e0e file \u5339\u914d\u7684\u884c\u7ed3\u675f\uff0c\u9664\u975e\u4f7f\u7528\u5f15\u53f7\u5c06\u8f93\u5165\u62ec\u8d77\u6765\uff0c\u6b64\u6a21\u5f0f\u5c06\u5bf9\u8f93\u5165\u5185\u5bb9\u8fdb\u884c shell \u53d8\u91cf \u66ff\u6362\u5982\u679c\u4f7f\u7528 <<- \u5219\u5ffd\u7565\u63a5\u4e0b\u6765\u8f93\u5165\u884c\u9996\u7684 tab command <<< word # \u628a\u5b57\u7b26 word \u548c\u540e\u9762\u7684\u6362\u884c\u4f5c\u4e3a\u8f93\u5165\u63d0\u4f9b\u7ed9 command command <> file # \u4ee5\u8bfb\u5199\u6a21\u5f0f\u5c06 file \u91cd\u5b9a\u5411\u5230\u8f93\u5165\uff0c file \u4e0d\u4f1a\u88ab\u7834\u574f command >| file # \u548c > \u529f\u80fd\u76f8\u540c : > file # \u5c06 file \u622a\u65ad\u4e3a 0 \u957f\u5ea6 command >& n # \u628a\u8f93\u51fa\u9001\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26 n \uff0c\u6ce8\u610f\uff1a >& \u5b9e\u9645\u4e0a\u590d\u5236\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4f7f cmd > file 2 >& 1 \u4e0e cmd 2 >& 1 > file \u7684\u6548\u679c\u4e0d\u4e00\u6837 command m >& n # \u628a\u8f93\u51fa\u5230\u6587\u4ef6\u7b26 m \u7684\u4fe1\u606f\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26 n command >&- # \u5173\u95ed\u6807\u51c6\u8f93\u51fa command <& n # \u8f93\u5165\u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u7b26 n command m <& n # m \u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u5404\u4e2a n command <&- # \u5173\u95ed\u6807\u51c6\u8f93\u5165 command <& n - # \u79fb\u52a8\u8f93\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26 n \u800c\u975e\u590d\u5236\u5b83\uff08\u9700\u8981\u89e3\u91ca\uff09 &> file \u548c > file 2 >& 1 \u76f8\u540c # ~+ \u8868\u793a\u5f53\u524d\u5de5\u4f5c\u8def\u5f84\uff0c\u4e0e\u53d8\u91cf$ PWD \u4e00\u81f4 shell\u53d8\u91cf\u5b50\u4e32\u8bf4\u660e \u00b6 \u8868\u8fbe\u5f0f \u8bf4\u660e ${parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u7684\u5185\u5bb9 ${#parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u5185\u5bb9\u7684\u5b57\u7b26\u957f\u5ea6 ${parameter:offset} \u5728\u53d8\u91cf$parameter\u4e2d\uff0c\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u5230\u7ed3\u5c3e ${parameter:offset:length} \u5728\u53d8\u91cf$parameter\u4e2d\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3alength\u7684\u5b50\u4e32 ${parameter#word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter##word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter/pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u7b2c\u4e00\u4e2a\u5339\u914d\u7684pattern ${parameter//pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u6240\u6709\u5339\u914d\u7684pattern ${parameter:-word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c ${parameter:=word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c,\u4f4d\u7f6e\u53d8\u91cf\u548c\u7279\u6b8a\u53d8\u91cf\u4e0d\u9002\u7528 ${parameter:?word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219word\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff0c\u5426\u5219\u8f93\u51fa\u53d8\u91cf\u7684\u503c ${parameter:+word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u5426\u5219word\u5b57\u7b26\u4e32\u66ff\u4ee3\u53d8\u91cf\u7684\u503c word\u53ef\u4ee5\u8868\u793a\u4e3a\u4e00\u4e32\u5b57\u7b26\uff0c\u6bd4\u5982a*c\u8868\u793a\u5220\u9664\u4ece\u5b57\u7b26a\u5230c\u7684\u6240\u6709\u5b57\u7b26 bash\u9000\u51fa\u548c\u9000\u51fa\u72b6\u6001 \u00b6 : << comment exit\u547d\u4ee4\u4e00\u822c\u7528\u4e8e\u7ed3\u675f\u4e00\u4e2a\u811a\u672c\uff0c\u5b83\u4e5f\u80fd\u8fd4\u56de\u4e00\u4e2a\u503c\u7ed9\u7236\u8fdb\u7a0b,\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u80fd\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\uff08\u6709\u65f6\u4e5f\u770b\u505a\u8fd4\u56de\u72b6\u6001).\u4e00\u4e2a\u547d\u4ee4\u6267\u884c \u6210\u529f\u8fd4\u56de0\uff0c\u4e00\u4e2a\u6267\u884c\u4e0d\u6210\u529f\u7684\u547d\u4ee4\u5219\u8fd4\u56de\u4e00\u4e2a\u975e\u96f6\u503c\uff0c\u6b64\u503c\u901a\u5e38\u53ef\u4ee5\u88ab\u89e3\u91ca\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684\u9519\u8bef\u503c\u3002\u9664\u4e86\u4e00\u4e9b\u4f8b\u5916\u7684\u60c5\u51b5\uff0cUNIX\u547d\u4ee4\uff0c\u7a0b \u5e8f\u6216\u662f\u8f6f\u4ef6\u5305\u6267\u884c\u6210\u529f\u90fd\u662f\u4ee5\u8fd4\u56de0\u7684\u4f5c\u4e3a\u9000\u51fa\u7801 \u540c\u6837\u7684\uff0c\u5728\u811a\u672c\u91cc\u7684\u51fd\u6570\u548c\u811a\u672c\u81ea\u8eab\u90fd\u4f1a\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u811a\u672c\u6216\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u5c06\u51b3\u5b9a\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u4e00\u4e2a\u811a\u672c\u91cc\uff0cexit n\u547d\u4ee4 \u5c06\u4f1a\u8fd4\u56deshell\u4e00\u4e2annn\u7684\u9000\u51fa\u72b6\u6001\u7801\u3002\uff08nnn\u5fc5\u987b\u662f\u4e00\u4e2a\u57280-255\u8303\u56f4\u7684\u5341\u8fdb\u5236\u6574\u6570\uff09 \u5982\u679c\u4e00\u4e2a\u811a\u672c\u4ee5\u4e0d\u5e26\u53c2\u6570\u7684exit\u547d\u4ee4\u7ed3\u675f\uff0c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u5c06\u4f1a\u662f\u6267\u884cexit\u547d\u4ee4\u524d\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u7801\uff0c\u811a\u672c\u7ed3\u675f\u6ca1\u6709exit,\u4e0d\u5e26 \u53c2\u6570\u7684exit\u548cexit $?\u4e09\u8005\u7b49\u4ef7\uff0c$?\u53d8\u91cf\u4fdd\u5b58\u4e86\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u540e\u7684\u9000\u51fa\u72b6\u6001\uff0c\u5f53\u4e00\u4e2a\u51fd\u6570\u8fd4\u56de\u65f6\uff0c$?\u4fdd\u5b58\u4e86\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000 \u51fa\u72b6\u6001\u7801\u3002\u8fd9\u5c31\u662fBash\u91cc\u51fd\u6570\u8fd4\u56de\u503c\u7684\u5904\u7406\u529e\u6cd5\u3002\u5f53\u4e00\u4e2a\u811a\u672c\u8fd0\u884c\u7ed3\u675f\uff0c$? \u53d8\u91cf\u4fdd\u5b58\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\uff0c\u800c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u5219\u662f\u811a\u672c\u4e2d\u6700 \u540e\u4e00\u4e2a\u5df2\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u3002\u5e76\u4e14\u4f9d\u7167\u60ef\u4f8b\uff0c0\u8868\u793a\u6267\u884c\u6210\u529f\uff0c1-255\u7684\u6574\u6570\u8303\u56f4\u8868\u793a\u9519\u8bef\u6216\u53cd\u5e38\u7684\u6761\u4ef6 \u903b\u8f91\u975e\u64cd\u4f5c\u7b26!\uff0c\u53cd\u8f6c\u4e00\u4e2a\u547d\u4ee4\u6216\u4e00\u4e2a\u6d4b\u8bd5\u7684\u7ed3\u679c\u3002\u4e5f\u80fd\u53cd\u8f6c\u9000\u51fa\u72b6\u6001 comment \u53d8\u91cf\u7c7b\u578b \u00b6 # \u5c40\u90e8\u53d8\u91cf\uff1a\u53ea\u5728\u4ee3\u7801\u5757\u6216\u4e00\u4e2a\u51fd\u6570\u4e2d\u6709\u6548 # \u73af\u5883\u53d8\u91cf\uff1a\u5176\u4f1a\u5f71\u54cdshell\u7684\u884c\u4e3a\u548c\u7528\u6237\u63a5\u53e3\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u73af\u5883\uff0c\u5176\u7531\u8fdb\u7a0b\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u7ec4\u6210 # \u5206\u914d\u7ed9\u73af\u5883\u53d8\u91cf\u7684\u603b\u7a7a\u95f4\u6709\u9650\uff0c\u82e5\u521b\u5efa\u592a\u591a\u73af\u5883\u53d8\u91cf\u6216\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u7684\u503c\u592a\u957f\u800c\u5360\u7528\u8fc7\u591a\u7a7a\u95f4\u5219\u4f1a\u51fa\u9519 # \u4f8b\u5982\uff1a : <<comment eval \"`seq 10000 | sed -e 's/.*/export var&=ZZZZZZZZZZZZZZ/'`\" du /usr/bin/du:Argument list too long comment # \u5982\u679c\u4e00\u4e2a\u811a\u6b65\u8981\u8bbe\u7f6e\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5219\u9700\u8981\u5c06\u5176\u5bfc\u51fa(export)\uff0c\u4e5f\u5c31\u662f\u8bb2\u9700\u901a\u77e5\u5230\u811a\u672c\u7684\u73af\u5883\u8868\uff0c\u8fd9\u662fexport\u547d\u4ee4\u529f\u80fd # \u4e00\u4e2a\u811a\u672c\u53ea\u80fd\u5bfc\u51fa\uff08export\uff09\u53d8\u91cf\u5230\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u80fd\u5bfc\u51fa\u5230\u7531\u6b64\u811a\u672c\u751f\u6210\u7684\u547d\u4ee4\u6216\u8fdb\u7a0b\u4e2d\u3002\u5728\u4e00\u4e2a\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u7684\u811a\u672c\u4e0d\u80fd\u5bfc\u51fa # \u4e00\u4e2a\u53d8\u91cf\u5f71\u54cd\u5230\u547d\u4ee4\u884c\u7684\u73af\u5883\u3002\u5b50\u8fdb\u7a0b\u4e0d\u80fd\u5bfc\u51fa\u53d8\u91cf\u5230\u751f\u6210\u5b83\u7684\u7236\u8fdb\u7a0b\u4e2d\u3002 # \u4f4d\u7f6e\u53c2\u6570 : <<comment \u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u662f$0,$1,$2.... $0\u662f\u811a\u672c\u7684\u540d\u5b57\uff0c$1\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c$2\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570......\u5728\u4f4d\u7f6e\u53c2\u6570$9\u4e4b\u540e\u7684\u53c2\u6570\u5fc5\u987b\u7528\u5927\u62ec\u53f7\u62ec\u8d77\u6765\u3002\u5982\uff1a${10} \u7279\u6b8a\u53d8\u91cf$*\u548c$@\u8868\u793a\u6240\u6709\u7684\u4f4d\u7f6e\u53c2\u6570 comment : <<comment #!/bin/bash # \u4f4d\u7f6e\u53c2\u6570\u4f8b\u5b50\uff1a # \u81f3\u5c11\u4ee510\u4e2a\u53c2\u6570\u8fd0\u884c\u6b64\u811a\u672c\u3002\u4f8b\u5982\uff1a./script.sh 1 2 3 4 5 6 7 8 9 10 min_params=10 echo \"\u811a\u672c\u540d\u5b57\u662f\\\"$0\\\".\" # \u7528./\u8868\u793a\u5f53\u524d\u76ee\u5f55 echo \"\u811a\u672c\u540d\u5b57\u662f\\\"`basename $0`\\\".\" comment if\u4f7f\u7528\u7684\u4e3b\u8981\u8868\u8fbe\u5f0f \u00b6 \u4e3b\u8981\u7684\u8868\u8fbe\u5f0f \u542b\u4e49 [ -a FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue [ -b FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u5757\u8bbe\u5907\u8fd4\u56deTrue(\u8f6f\u76d8,\u5149\u9a71\u7b49) [ -c FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u65f6\u5b57\u7b26\u8bbe\u5907\u8fd4\u56deTrue(\u952e\u76d8,\u8c03\u5236\u89e3\u8c03\u5668,\u58f0\u5361\u7b49) [ -d FILE ] \u5982\u679c\u662f\u76ee\u5f55\u8fd4\u56deTrue [ -e FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue [ -f FILE ] \u6587\u4ef6\u662f\u666e\u901a\u6587\u4ef6\u5e76\u4e14\u4e0d\u662f\u4e00\u4e2a\u76ee\u5f55\u6216\u662f\u4e00\u4e2a\u8bbe\u5907\u6587\u4ef6\u8fd4\u56deTrue [ -g FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8bbe\u7f6e-\u7ec4-ID(sgid)\u6807\u8bb0\u88ab\u8bbe\u7f6e\u8fd4\u56deTrue\uff0c\u5982\u679c\u4e00\u4e2a\u76ee\u5f55\u7684sgid\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u5728\u8fd9\u4e2a \u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5c5e\u4e8e\u62e5\u6709\u6b64\u76ee\u5f55\u7684\u7528\u6237\u7ec4\uff0c\u800c\u4e0d\u5fc5\u662f\u521b\u5efa\u6587\u4ef6\u7684\u7528\u6237\u6240\u5c5e\u7684\u7ec4\u3002\u8fd9\u4e2a\u7279\u6027\u5bf9\u5728\u4e00\u4e2a\u5de5\u4f5c\u7ec4\u91cc\u7684\u540c\u4eab\u76ee\u5f55\u5f88\u6709\u7528\u5904 [ -h FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -k FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue and \u7c98\u4f4f\u4f4d\u8bbe\u7f6e\u3002\u4fd7\u79f0\u201c\u7c98\u6027\u4f4d\u201d\uff0c\u4fdd\u5b58\u6587\u672c\u6a21\u5f0f\u6807\u5fd7\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u6587\u4ef6\u6743\u9650\u3002\u5982\u679c \u4e00\u4e2a\u6587\u4ef6\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u6807\u5fd7\uff0c\u8be5\u6587\u4ef6\u5c06\u88ab\u4fdd\u5b58\u5728\u7f13\u5b58\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u66f4\u5feb\u5730\u8bbf\u95ee\u3002\u30142\u3015\u5982\u679c\u8bbe\u7f6e\u5728\u76ee\u5f55\u4e0a\uff0c\u5219\u9650\u5236\u5199\u5165\u6743\u9650\u3002\u8bbe\u7f6e\u7c98\u6027 \u4f4d\u5c06T\u6dfb\u52a0\u5230\u6587\u4ef6\u6216\u76ee\u5f55\u5217\u8868\u7684\u6743\u9650(drwxrwxrw**t**)\uff0c\u5982\u679c\u7528\u6237\u4e0d\u62e5\u6709\u8bbe\u7f6e\u4e86\u7c98\u6027\u4f4d\u7684\u76ee\u5f55\uff0c\u4f46\u5728\u8be5\u76ee\u5f55\u4e2d\u5177\u6709\u5199\u6743\u9650\uff0c\u5219\u4ed6\u53ea\u80fd \u5220\u9664\u5176\u62e5\u6709\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u5728\u516c\u5171\u53ef\u8bbf\u95ee\u76ee\u5f55\uff08\u5982/tMP\uff09\u4e2d\u65e0\u610f\u4e2d\u8986\u76d6\u6216\u5220\u9664\u5f7c\u6b64\u7684\u6587\u4ef6 [ -p FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u662f\u4e00\u4e2a\u7ba1\u9053\u8fd4\u56deTrue [ -r FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u662f\u5426\u53ef\u8bfb\u8fd4\u56deTrue(\u6307\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u8bfb\u6743\u9650) [ -s FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e0\u8fd4\u56deTrue [ -t FD ] \u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26FD(\u5bf9\u5e94\u51fd\u6570\u7684\u8fd4\u56de\u503c)\u6253\u5f00\u5e76\u5f15\u7528\u4e86\u7ec8\u7aef\u5219\u4e3aTrue\uff0c\u6587\u4ef6(\u63cf\u8ff0\u7b26)\u4e0e\u4e00\u4e2a\u7ec8\u7aef\u8bbe\u5907\u76f8\u5173\uff0c\u8fd9\u4e2a\u6d4b \u8bd5\u9009\u9879\u53ef\u4ee5\u7528\u4e8e\u68c0\u67e5\u811a\u672c\u4e2d\u662f\u5426\u6807\u51c6\u8f93\u5165 ([ -t 0 ])\u6216\u6807\u51c6\u8f93\u51fa([ -t 1 ])\u662f\u4e00\u4e2a\u7ec8\u7aef [ -u FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue\uff0c\u6587\u4ef6\u7684\u8bbe\u7f6e-\u7528\u6237-ID(suid)\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u4e00\u4e2aroot\u7528\u6237\u62e5\u6709\u7684\u4e8c\u8fdb\u5236\u6267\u884c\u6587\u4ef6\u5982\u679c\u8bbe\u7f6e\u4e86 \u8bbe\u7f6e-\u7528\u6237-ID\u4f4d(suid)\u6807\u5fd7\u666e\u901a\u7528\u6237\u53ef\u4ee5\u4ee5root\u6743\u9650\u8fd0\u884c\u3002[1] \u8fd9\u5bf9\u9700\u8981\u5b58\u53d6\u7cfb\u7edf\u786c\u4ef6\u7684\u6267\u884c\u7a0b\u5e8f\uff08\u6bd4\u5982\u8bf4pppd\u548ccdrecord\uff09\u5f88\u6709\u7528 \u5982\u679c\u6ca1\u6709\u8bbe\u7f6esuid\u4f4d\uff0c\u5219\u8fd9\u4e9b\u4e8c\u8fdb\u5236\u6267\u884c\u7a0b\u5e8f\u4e0d\u80fd\u7531\u975eroot\u8c03\u7528\u3002\u88ab\u8bbe\u7f6e\u4e86suid\u6807\u5fd7\u7684\u6587\u4ef6\u5728\u6743\u9650\u5217\u4e2d\u4ee5s\u6807\u5fd7\u8868\u793a(-rw**s**r-xr-t) [ -w FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u53ef\u5199\u7684\u8fd4\u56deTrue(\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u5199\u6743\u9650) [ -x FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u53ef\u6267\u884c\u7684\u8fd4\u56de(\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u6267\u884c\u6743\u9650) [ -O FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u7531\u6709\u6548\u7528\u6237ID\u6240\u62e5\u6709\u7684\u8fd4\u56deTrue(\u4f60\u662f\u6587\u4ef6\u62e5\u6709\u8005) [ -G FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u7531\u7528\u6237\u7ec4ID\u6240\u62e5\u6709\u7684\u8fd4\u56deTrue(\u4f60\u6240\u5728\u7684\u7ec4\u548c\u6587\u4ef6\u7684groupID\u4e00\u81f4) [ -L FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -N FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6700\u540e\u4e00\u6b21\u8bfb\u540e\u88ab\u4fee\u6539\u8fd4\u56deTrue [ -S FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2asocket\u8fd4\u56deTrue [ FILE1 -nt FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u66f4\u65b0\uff0c\u6216\u8005FILE1\u5b58\u5728\u4e14FILE2\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ot FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u65e7\uff0c\u6216\u8005FILE2\u5b58\u5728\u4e14FILE1\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ef FILE2 ] \u5982\u679cFILE1\u548cFILE2\u5f15\u7528\u76f8\u540c\u7684\u8bbe\u5907\u548cinode\u7f16\u53f7(\u76f8\u540c\u7684\u6587\u4ef6\u786c\u94fe\u63a5)\uff0c\u5219\u4e3aTrue [ -o OPTIONNAME ] \u5982\u679c\u542f\u7528\u4e86shell\u9009\u9879\u201cOPTIONNAME\u201d(\u9009\u9879\u540d\u79f0)\uff0c\u5219\u4e3aTrue [ -z STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e3a0\u5219\u4e3aTrue [ -n STRING ] or [ STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u4e3a0\u5219\u4e3aTrue [ STRING1 == STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u76f8\u7b49\u5219\u4e3aTrue\uff0c\u5bf9\u4e8e\u4e25\u683c\u7684POSIX\u5408\u89c4\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528\u201c=\u201d\u4ee3\u66ff\u201c==\u201d [ STRING1 != STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u76f8\u7b49\u5219\u4e3aTrue [ STRING1 < STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u524d\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ STRING1 > STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u540e\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ ARG1 OP ARG2 ] \u201cOP\u201d\u662f-eq\uff0c-ne\uff0c-lt\uff0c-le\uff0c-gt\u6216-ge\u4e4b\u4e00\u3002 \u5982\u679c\u201cARG1\u201d\u5206\u522b\u7b49\u4e8e\uff0c\u4e0d\u7b49\u4e8e\uff0c\u5c0f\u4e8e\uff0c\u5c0f\u4e8e\u6216\u7b49\u4e8e\uff0c\u5927\u4e8e \u6216\u5927\u4e8e\u6216\u7b49\u4e8e\u201cARG2\u201d\uff0c\u5219\u8fd9\u4e9b\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26\u8fd4\u56detrue\u3002 \u201cARG1\u201d\u548c\u201cARG2\u201d\u662f\u6574\u6570 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u8fd0\u7b97\u7b26\u7ec4\u5408\u8868\u8fbe\u5f0f\uff0c\u6309\u4f18\u5148\u7ea7\u9012\u51cf\u987a\u5e8f\u5217\u51fa\uff1a \u7c7b\u522b \u4f8b\u5b50 [ ! EXPR ] \"\u975e\" -- \u53cd\u8f6c\u4e0a\u9762\u6240\u6709\u6d4b\u8bd5\u7684\u7ed3\u679c(\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6761\u4ef6\u5219\u8fd4\u56de\u771f),\u5982\u679cEXPR\u662ffalse\u5219\u4e3a\u771f [ ( EXPR ) ] \u8fd4\u56deEXPR\u7684\u503c\u3002 \u8fd9\u53ef\u4ee5\u7528\u4e8e\u8986\u76d6\u8fd0\u7b97\u7b26\u7684\u6b63\u5e38\u4f18\u5148\u7ea7 [ EXPR1 -a EXPR2 ] \u5982\u679cEXPR1\u548cEXPR2\u90fd\u4e3a\u771f\uff0c\u5219\u4e3a\u771f [ EXPR1 -o EXPR2 ] \u5982\u679cEXPR1\u6216EXPR2\u4e3a\u771f\uff0c\u5219\u4e3a\u771f # \u5927\u591a\u6570\u7a0b\u5e8f\u5458\u66f4\u559c\u6b22\u4f7f\u7528test\u5185\u7f6e\u547d\u4ee4\uff0c\u8fd9\u76f8\u5f53\u4e8e\u4f7f\u7528\u65b9\u62ec\u53f7\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u4e0b\u6240\u793a test \" $( whoami ) \" ! = 'root' && ( echo you are using a non-privileged account ; exit 1 ) # \u5982\u679c\u5728\u5b50shell\u4e2d\u8c03\u7528exit\uff0c\u5219\u4e0d\u4f1a\u5c06\u53d8\u91cf\u4f20\u9012\u7ed9\u7236\u7ea7\u3002\u5982\u679c\u60a8\u4e0d\u5e0c\u671bBash\u6d3e\u751f\u5b50shell\uff0c\u8bf7\u4f7f\u7528{ }\u4ee3\u66ff() if\u8bed\u53e5[ ] [[ ]]\u6bd4\u8f83 \u00b6 \u6d4b\u8bd5\u7c7b\u578b [ ] [[ ]] \u6570\u5b57\u6d4b\u8bd5 -eq -ne -lt -le -gt -ge \u540c[ ] \u6587\u4ef6\u6d4b\u8bd5 -r -l -w -x -f -d -s -nt -ot \u540c[ ] \u5b57\u7b26\u6d4b\u8bd5 = != -n -z ==(\u540c=) \u4e0d\u53ef\u4f7f\u7528<= >= \u540c[ ] \u903b\u8f91\u6d4b\u8bd5 -a -o ! && || ! \u6570\u5b66\u8fd0\u7b97 \u4e0d\u53ef\u4ee5\u4f7f\u7528 + - * / % \u7ec4\u5408 \u7528\u5404\u81ea\u903b\u8f91\u7b26\u53f7\u8fde\u63a5\u7684\u6570\u5b57(\u8fd0\u7b97)\u6d4b\u8bd5\u3001\u6587\u4ef6\u6d4b\u8bd5\u3001\u5b57\u7b26\u6d4b\u8bd5 \u540c[ ] \u60c5\u51b5\u590d\u6742\u7684\u5b57\u7b26\u6d4b\u8bd5 [ ] [[ ]] < > \u6bd4\u8f83\u7ed3\u679c\u5f02\u5e38\uff0c\u5982: [ 12 > 21 ]\u4e0e [ 12 > 21 ]\u4e0e [ 21 > 12 ]\u3001 [ a > b ]\u4e0e [ a > b ]\u4e0e [ b > a ]\u7684\u8fd4\u56de\u503c\u4e00\u6837 \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83 (\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \\> \\< \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83(\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \u4e0d\u53ef\u4ee5\u4f7f\u7528 # if then else\u7ed3\u6784\u6d4b\u8bd5\u65ad\u6389\u7684\u8fde\u63a5 #!/bin/bash # broken-link.sh # \u7531Lee bigelow\u6240\u5199<ligelowbee@yahoo.com> # \u4e00\u4e2a\u7528\u4e8e\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u5e76\u4e14\u8f93\u51fa\u5b83\u4eec\u7684\u94fe\u63a5\u6587\u4ef6\u7684\u7eafshell\u7684\u811a\u672c\u3002 # \u6240\u4ee5\u5b83\u4eec\u80fd\u628a\u8f93\u51fa\u63d0\u4f9b\u7ed9xargs\u5e76\u5904\u7406 :) # \u4f8b\u5982\uff1a broken-link.sh /somedir /someotherdir|xargs rm # \u4e0b\u9762\u662f\u66f4\u597d\u7684\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5: # find \"somedir\" -type l -print0|\\ # xargs -r0 file|\\ # grep \"broken symbolic\"| # sed -e 's/^\\|: *broken symbolic.*$/\"/g' # \u4f46\u8fd9\u4e0d\u662f\u7eafbash\u811a\u672c\uff0c\u4e0b\u9762\u7684\u5219\u662f. # \u6ce8\u610f: \u8c28\u9632\u5728/proc\u6587\u4ef6\u7cfb\u7edf\u548c\u6b7b\u5faa\u73af\u94fe\u63a5\u4e2d\u4f7f\u7528! # \u5982\u679c\u6ca1\u6709\u53c2\u6570\u88ab\u4f20\u9012\u7ed9\u811a\u672c\u4f5c\u4e3a\u641c\u7d22\u76ee\u5f55\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55 [[ $# -eq 0 ]] && directories = ` pwd ` || directories = $@ #Setup the function link_chk to check the directory it is passed #for files that are links and don't exist, then print them quoted. #If one of the elements in the directory is a subdirectory then #send that send that subdirectory to the link_check function. ######## link_chk () { for element in $1 /* ; do [[ -h \" $element \" -a ! -e \" $element \" ]] && echo \\\" $element \\\" [[ -d \" $element \" ]] && linkchk $element # Of course, '-h' tests for symbolic link, '-d' for directory. done } #Send each arg that was passed to the script to the link_chk function #if it is a valid directory. If not, then print the error message #and usage info. ############ for directory in $directories ; do if [[ -d $directories ]] then link_chk $directories else echo \" $directories is not a directory\" echo \"Usage: $0 dir1 dir2 ...\" fi done # [1] \u4e00\u5b9a\u8981\u610f\u8bc6\u5230suid\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u80fd\u5f15\u8d77\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u5e76\u4e14\u5728shell\u811a\u672c\u4e2dsuid\u6807\u5fd7\u5df2\u7ecf\u4e0d\u8d77\u4f5c\u7528\u4e86 # [2] \u5728\u73b0\u4ee3UNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7c98\u4f4f\u4f4d\u5df2\u7ecf\u4e0d\u5728\u6587\u4ef6\u4e2d\u518d\u4f7f\u7528\uff0c\u53ea\u7528\u5728\u76ee\u5f55\u4e2d then\u8bed\u53e5\u540e\u9762\u7684\u547d\u4ee4 \u00b6 # then\u8bed\u53e5\u540e\u9762\u7684CONSEQUENT-COMMANDS\u5217\u8868\u53ef\u4ee5\u662f\u4efb\u4f55\u6709\u6548\u7684UNIX\u547d\u4ee4\uff0c\u4efb\u4f55\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4efb\u4f55\u53ef\u6267\u884cshell\u811a\u672c\u6216\u4efb\u4f55shell\u8bed\u53e5\uff0c\u4f46\u7ed3 # \u675ffi\u9664\u5916\u3002\u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0cthen\u548cfi\u88ab\u8ba4\u4e3a\u662fshell\u4e2d\u7684\u5206\u9694\u8bed\u53e5\u3002\u56e0\u6b64\uff0c\u5728\u547d\u4ee4\u884c\u4e0a\u53d1\u51fa\u65f6\uff0c\u5b83\u4eec\u7528\u5206\u53f7\u5206\u9694 #\u7b2c\u4e00\u4e2a\u793a\u4f8b\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728 #!/bin/bash echo \"This scripts checks the existence of the messages file.\" echo \"Checking...\" if [[ -f /var/log/messages ]] then echo \"/var/log/messages exists.\" fi echo echo \"...done.\" : << comment \u4e00\u4e2aif/then\u7ed3\u6784\u6d4b\u8bd5\u4e00\u5217\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u662f\u5426\u4e3a0\uff08\u56e0\u4e3a\u4f9d\u7167\u60ef\u4f8b\uff0c0\u610f\u5473\u7740\u547d\u4ee4\u6267\u884c\u6210\u529f\uff09\uff0c\u5982\u679c\u662f0\u5219\u4f1a\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u547d\u4ee4 \u6709\u4e00\u4e2a\u547d\u4ee4 [ (\u5de6\u65b9\u62ec\u662f\u7279\u6b8a\u5b57\u7b26). \u5b83\u548ctest\u662f\u540c\u4e49\u8bcd,\u56e0\u4e3a\u6548\u7387\u7684\u539f\u56e0\uff0c\u5b83\u88ab\u5185\u5efa\u5728shell\u91cc\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u53c2\u6570\u662f\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u8005 \u6587\u4ef6\u6d4b\u8bd5\uff0c\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\u6307\u793a\u6bd4\u8f83\u7684\u7ed3\u679c(0\u8868\u793a\u771f\uff0c1\u8868\u793a\u5047) comment #\u4e00\u4e2aif/then\u7ed3\u6784\u80fd\u5305\u542b\u5d4c\u5957\u7684\u6bd4\u8f83\u548c\u6d4b\u8bd5 if echo \"Next *if* is part of the comparison for the first *if*.\" if [[ $comparison = \"integer\" ]] then (( a < b )) else [[ $a < $b ]] fi then echo '$a is less than $b' fi # \u5f53if\u548cthen\u5728\u540c\u4e00\u884c\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5206\u53f7\uff08;\uff09\u5fc5\u987b\u7528\u5728if\u8bed\u53e5\u7684\u7ed3\u5c3e\u3002if\u548cthen\u90fd\u662f\u5173\u952e\u5b57.\u5173\u952e\u5b57\uff08\u6216\u547d\u4ee4\uff09\u5f00\u59cb\u4e00\u4e2a\u8bed\u53e5\uff0c\u5982\u679c\u5728\u540c # \u4e00\u884c\u5f00\u59cb\u53e6\u4e00\u4e2a\u65b0\u8bed\u53e5\u65f6\uff0c\u524d\u9762\u4e00\u4e2a\u8bed\u53e5\u5fc5\u987b\u7528\u5206\u53f7\uff08;\uff09\u7ed3\u675f if [ -x \" $filename \" ] ; then #\u7b49\u4ef7\u7684\u6d4b\u8bd5\u547d\u4ee4\uff1atest,/usr/bin/test,[]\u548c/usr/bin/[ #!/bin/bash if test -z \" $1 \" then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if /usr/bin/test -z \" $1 \" # \u548c\u5185\u5efa\u7684\"test\"\u547d\u4ee4\u4e00\u6837. then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if [ -z \" $1 \" ] # \u548c\u4e0a\u9762\u4ee3\u7801\u5757\u7684\u529f\u80fd\u4e00\u6837 then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if /usr/bin/ [ -z \" $1 \" ] # \u540c\u6837\u548c\u4e0a\u9762\u7684\u4ee3\u7801\u5757\u4e00\u6837. # if /usr/bin/[ -z \"$1\" # \u5de5\u4f5c, \u4f46\u8fd8\u662f\u7ed9\u51fa\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f.\u6ce8\u610f:\u8fd9\u4e2a\u5df2\u7ecf\u5728bash 3.x\u7248\u672c\u88ab\u4fee\u8865\u597d\u4e86\u3002 then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi # \u5728[[\u548c]]\u4e4b\u95f4\u7684\u6240\u6709\u7684\u5b57\u7b26\u90fd\u4e0d\u4f1a\u88ab\u6587\u4ef6\u6269\u5c55\u6216\u662f\u6807\u8bb0\u5206\u5272\uff0c\u4f46\u662f\u4f1a\u6709\u53c2\u6570\u5f15\u7528\u548c\u547d\u4ee4\u66ff\u6362 file = /etc/passwd if [[ -e $file ]] then echo \"Password file exists.\" fi # \u7528[[ .. ]]\u6d4b\u8bd5\u7ed3\u6784\u6bd4\u7528[ .. ]\u66f4\u80fd\u9632\u6b62\u811a\u672c\u903b\u8f91\u9519\u8bef\u3002\u4f8b\u5982\uff1a&&,||,<\u548c>\u64cd\u4f5c\u7b26\u80fd\u5728\u4e00\u4e2a[[]]\u6d4b\u8bd5\u91cc\u901a\u8fc7\uff0c\u4f46\u5728[]\u7ed3\u6784\u4f1a\u53d1\u751f\u9519\u8bef # \u5728\u4e00\u4e2aif\u7684\u540e\u9762\uff0c\u4e0d\u5fc5\u4e00\u5b9a\u662ftest\u547d\u4ee4\u6216\u662ftest\u7ed3\u6784\uff08[]\u6216\u662f[[]]\uff09 dir = /home/bozo if cd \" $dir \" 2 >/dev/null ; then # \"2>/dev/null\"\u4f1a\u9690\u85cf\u9519\u8bef\u7684\u4fe1\u606f. echo \"Now in $dir .\" else echo \"Can't change to $dir .\" fi # \"if COMMAND\"\u7ed3\u6784\u4f1a\u8fd4\u56deCOMMAND\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801 # \u540c\u6837\u7684\uff0c\u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u53f7\u91cc\u9762\u7684\u6761\u4ef6\u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u7528\u5217\u8868\u7ed3\u6784(list construct)\u800c\u4e0d\u5fc5\u7528if\u3002 var1 = 20 var2 = 22 [ \" $var1 \" -ne \" $var2 \" ] && echo \" $var1 is not equal to $var2 \" home = /home/bozo [ -d \" $home \" ] || echo \" $home directory does not exist.\" \u7b97\u672f\u8fd0\u7b97\u7b26 \u00b6 \u7b97\u672f\u8fd0\u7b97\u7b26 \u63cf\u8ff0 + - \u52a0\u6cd5 \u51cf\u6cd5(\u5e38\u7528) * / % \u4e58\u6cd5 \u9664\u6cd5 \u53d6\u6a21(\u5e38\u7528) ** \u5e42\u8fd0\u7b97(\u5e38\u7528) ++ -- \u81ea\u52a0 \u81ea\u51cf\uff0c\u53ef\u653e\u5728\u53d8\u91cf\u524d\u53d8\u91cf\u540e,\u53d8\u91cf\u4e4b\u524d\u8868\u793a\u5148\u81ea\u589e\u6216\u81ea\u51cf\u518d\u8d4b\u503c\u7ed9\u53d8\u91cf\uff0c\u4e4b\u540e\u8868\u793a\u5148\u8d4b\u503c\u518d\u81ea\u589e\u6216\u81ea\u51cf(\u5e38\u7528) ! && || \u903b\u8f91\u975e\uff08\u53d6\u53cd\uff09 \u903b\u8f91\u4e0e\uff08and\uff09 \u903b\u8f91\u6216\uff08or\uff09 (\u5e38\u7528) < <= > >= \u6bd4\u8f83\u7b26\u53f7 == != = \u6bd4\u8f83\u7b26\u53f7 << >> \u5411\u5de6\u4f4d\u79fb \u5411\u53f3\u4f4d\u79fb ~ & ^ = += -= *= /= %= \u8d4b\u503c\u8fd0\u7b97\u7b26 \u7b97\u672f\u8fd0\u7b97\u8868\u8fbe\u5f0f\u548c\u8fd0\u7b97\u547d\u4ee4 \u63cf\u8ff0 (()) \u6574\u6570\u8fd0\u7b97\u7684\u5e38\u7528\u64cd\u4f5c\u7b26 let \u7528\u4e8e\u6574\u6570\u8fd0\u7b97\u548c(())\u7c7b\u4f3c expr \u901a\u5e38\u7528\u4e8e\u6574\u6570\u8ba1\u7b97\u4e5f\u6709\u5176\u4ed6\u989d\u5916\u529f\u80fd bc \u9002\u5408\u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 $[] \u7528\u4e8e\u6574\u6570\u8fd0\u7b97 awk \u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 declare \u5b9a\u4e49\u53d8\u91cf\u503c\u548c\u5c5e\u6027,-i\u53c2\u6570\u7528\u4e8e\u5b9a\u4e49\u6574\u578b\u53d8\u91cf \u7b97\u672f\u6d4b\u8bd5 \u00b6 # (( ))\u7ed3\u6784\u6269\u5c55\u5e76\u8ba1\u7b97\u4e00\u4e2a\u7b97\u672f\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u5982\u679c\u8868\u8fbe\u5f0f\u503c\u4e3a0\uff0c\u4f1a\u8fd4\u56de1\u6216\u5047\u4f5c\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u3002\u4e00\u4e2a\u975e\u96f6\u503c\u7684\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a0\u6216\u771f\u4f5c\u4e3a # \u9000\u51fa\u72b6\u6001\u7801\u3002\u8fd9\u4e2a\u7ed3\u6784\u548c\u5148\u524dtest\u547d\u4ee4\u53ca[]\u7ed3\u6784\u7684\u8ba8\u8bba\u521a\u597d\u76f8\u53cd #\u7528(( ))\u8fdb\u884c\u7b97\u672f\u6d4b\u8bd5 #!/bin/bash # \u7b97\u672f\u6d4b\u8bd5.(( ... ))\u7ed3\u6784\u4f1a\u6c42\u503c\u5e76\u6d4b\u8bd5\u8be5\u503c\u3002\u9000\u51fa\u72b6\u6001\u7801\u4e0e[ ... ]\u7ed3\u6784\u6b63\u597d\u76f8\u53cd!\u8fd4\u56de0\u4ee3\u8868\u771f\uff0c1\u4ee3\u8868\u5047 (( 0 )) ; echo \"Exit status of \\\"(( 0 ))\\\" is $? .\" # 1 (( 1 )) ; echo \"Exit status of \\\"(( 1 ))\\\" is $? .\" # 0 (( 5 > 4 )) ; echo \"Exit status of \\\"(( 5 > 4 ))\\\" is $? .\" # 0 (( 5 > 9 )) ; echo \"Exit status of \\\"(( 5 > 9 ))\\\" is $? .\" # 1 (( 5 - 5 )) ; echo \"Exit status of \\\"(( 5 - 5 ))\\\" is $? .\" # 1 (( 5 / 4 )) ; echo \"Exit status of \\\"(( 5 / 4 ))\\\" is $? .\" # 0 (( 1 / 2 )) ; echo \"Exit status of \\\"(( 1 / 2 ))\\\" is $? .\" # 1 (( 1 / 0 )) 2 > /dev/null ; echo \"Exit status of \\\"(( 1 / 0 ))\\\" is $? .\" # 1 \u5176\u4ed6\u6bd4\u8f83\u64cd\u4f5c\u7b26 \u00b6 \u4e8c\u5143\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6bd4\u8f83\u4e24\u4e2a\u53d8\u91cf\u6216\u662f\u6570\u503c\u3002\u6ce8\u610f\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83\u7684\u5206\u522b \u6574\u6570\u6bd4\u8f83 \u00b6 \u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b -eq \u7b49\u4e8e if [ \" a\" -eq \" a\" -eq \" b\" ] -ne \u4e0d\u7b49\u4e8e if [ \" a\" -ne \" a\" -ne \" b\" ] -gt \u5927\u4e8e if [ \" a\" -gt \" a\" -gt \" b\" ] -ge \u5927\u4e8e\u7b49\u4e8e if [ \" a\" -ge \" a\" -ge \" b\" ] -lt \u5c0f\u4e8e if [ \" a\" -lt \" a\" -lt \" b\" ] -le \u5c0f\u4e8e\u7b49\u4e8e if [ \" a\" -le \" a\" -le \" b\" ] > \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u5185\u4f7f\u7528) ((\" a\" > \" a\" > \" b\")) >= \u5927\u4e8e\u7b49\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" >= \" a\" >= \" b\")) < \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" < \" a\" < \" b\")) <= \u5c0f\u4e8e\u7b49\u4e8e (\u5728\u53cc\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" <= \" a\" <= \" b\")) \u5b57\u7b26\u4e32\u6bd4\u8f83 \u00b6 \u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b = \u7b49\u4e8e if [ \" a\" = \" a\" = \" b\" ] == \u7b49\u4e8e\u2460 if [ \" a\" == \" a\" == \" b\" ] != \u4e0d\u7b49\u4e8e if [ \" a\" != \" a\" != \" b\" ] < \u5c0f\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \" a\" < \" a\" < \" b\" ]]\u6216if [ \" a\" \\< \" a\" \\< \" b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26< > \u5927\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \" a\" > \" a\" > \" b\" ]]\u6216if [ \" a\" \\> \" a\" \\> \" b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26> -z \u5b57\u7b26\u4e32\u4e3anull,\u5373\u6307\u5b9a\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a\u96f6 -n \u5b57\u7b26\u4e32\u4e0d\u4e3anull,\u5373\u957f\u5ea6\u4e0d\u4e3a\u96f6 -a \u903b\u8f91\u4e0e \u5982\u679cexp1\u548cexp2\u90fd\u4e3a\u771f\uff0c\u5219exp1 -a exp2\u8fd4\u56de\u771f -o \u903b\u8f91\u6216 \u53ea\u8981exp1\u548cexp2\u4efb\u4f55\u4e00\u4e2a\u4e3a\u771f\uff0c\u5219exp1 -o exp2\u8fd4\u56de\u771f \u2460\u533a\u522b\u89e3\u6790\uff1a * ==\u548c=\u540c\u4e49\u8bcd\uff0c\u4f46==\u6bd4\u8f83\u64cd\u4f5c\u7b26\u5728\u4e00\u4e2a\u53cc\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u548c\u4e00\u4e2a\u5355\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u610f\u601d\u4e0d\u540c * [[ a == z* ]] # \u5982\u679c\u53d8\u91cf a == z* ]] # \u5982\u679c\u53d8\u91cf a\u4ee5\u5b57\u7b26\"z\"\u5f00\u59cb(\u6a21\u5f0f\u5339\u914d)\u5219\u4e3a\u771f * [[ a == \"z*\" ]] # \u5982\u679c\u53d8\u91cf a == \"z*\" ]] # \u5982\u679c\u53d8\u91cf a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f * [ a == z* ] # \u6587\u4ef6\u6269\u5c55\u548c\u5355\u5143\u5206\u5272\u6709\u6548 * [ \" a == z* ] # \u6587\u4ef6\u6269\u5c55\u548c\u5355\u5143\u5206\u5272\u6709\u6548 * [ \" a\" == \"z*\" ] # \u5982\u679c\u53d8\u91cf$a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f \u6ce8\u610f\u4e8b\u9879\uff1a \u5728\u65b9\u62ec\u53f7\u6d4b\u8bd5\u91cc\uff0c\u8fdb\u884c-n\u6d4b\u8bd5\u65f6\u5fc5\u987b\u628a\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff0c-z\u4e00\u822c\u4e0d\u5f15\u8d77\u6765\u90fd\u80fd\u5de5\u4f5c\uff0c\u4f46\u6700\u597d\u628a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u62ec\u8d77\u6765\u3002\u5982\u679c$string \u53d8\u91cf\u4e3a\u7a7a\uff0c\u6b64\u5b57\u7b26\u4e32\u53d8\u91cf\u5f15\u8d77\u6765\u4f9d\u7136\u4f1a\u62a5\u9519\uff0c\u5b89\u5168\u7684\u65b9\u6cd5\u662f\u9644\u52a0\u4e00\u4e2a\u5916\u90e8\u5b57\u7b26\u4e32\u7ed9\u53ef\u80fd\u6709\u7a7a\u5b57\u7b26\u53d8\u91cf\u3002\u5982\uff1a [ \"x string\" != x -o \"x string\" != x -o \"x a\" = \"x$b\" ]\uff08x\u5b57\u7b26\u53ef\u4ee5\u4e92\u76f8\u62b5\u6d88\uff09 \u7b97\u672f\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83 \u00b6 # a\u548cb\u65e2\u80fd\u88ab\u770b\u6210\u662f\u6574\u6570\u4e5f\u80fd\u88ab\u770b\u7740\u662f\u5b57\u7b26\u4e32\u3002\u5728\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u4e4b\u95f4\u4e0d\u662f\u4e25\u683c\u754c\u5b9a\u7684\uff0cbash\u53d8\u91cf\u662f\u65e0\u7c7b\u578b\u7684\uff0cBash\u53d8\u91cf\u4e0d\u662f\u5f3a\u7c7b\u578b\u7684 # Bash\u5141\u8bb8\u53d8\u91cf\u7684\u6574\u6570\u64cd\u4f5c\u548c\u6bd4\u8f83\uff0c\u4f46\u8fd9\u4e9b\u53d8\u91cf\u5fc5\u987b\u53ea\u5305\u62ec\u6570\u5b57\u5b57\u7b26,\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5e94\u8be5\u5c0f\u5fc3\u8003\u8651\u3002\u4f8b\u5982\uff1a #!/bin/bash # \u6b64\u4f8b\u5b50\u4e2d-ne\u548c!=\u5747\u80fd\u5de5\u4f5c\uff0c\u4ee5\u4e0b\u662f\u5177\u4f53\u6bd4\u8f83 a = 4 b = 5 if [ \" $a \" -ne \" $b \" ] ; then echo \" $a\u4e0d\u7b49\u4e8e$b \" ; echo \"(\u6574\u6570\u6bd4\u8f83)\" ; fi # ab\u4f5c\u4e3a\u6574\u6570\u6bd4\u8f83 if [ \" $a \" ! = \" $b \" ] ; then echo \" $a\u4e0d\u7b49\u4e8e$b \" ; echo \"(\u5b57\u7b26\u4e32\u6bd4\u8f83)\" ; fi # ab\u4f5c\u4e3a\u5b57\u7b26\u4e32\u6bd4\u8f83 # \u6d4b\u8bd5\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u662fnull\u503c #!/bin/bash # \u7528if [ ... ]\u7ed3\u6784,\u6d4b\u8bd5null\u5b57\u7b26\u4e32\u548c\u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u7684\u5b57\u7b26\u4e32 # \u5982\u679c\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u5b83\u91cc\u9762\u7684\u503c\u672a\u5b9a\u4e49\u3002\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a\"null\"\u503c(\u4e0d\u540c\u4e8e\u96f6) # \u7b2c\u4e00\u6b21\uff0c$string1\u6ca1\u6709\u88ab\u58f0\u660e\u6216\u521d\u59cb\u5316 if [ -n $string1 ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u9519\u8bef\u7ed3\u679c. # Shows $string1 as not null, although it was not initialized. # \u7b2c\u4e8c\u6b21, $string1\u53d8\u91cf\u88ab\u5f15\u53f7\u5f15\u8d77 if [ -n \" $string1 \" ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u91cc\u7528\u5f15\u53f7\u5f15\u8d77\u53d8\u91cf! # \u7b2c\u4e09\u6b21,\u53d8\u91cf$string1\u4ec0\u4e48\u4e5f\u4e0d\u52a0 if [ $string1 ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u4ee5\u4e0a\u6b63\u5e38\u6267\u884c,[]\u6d4b\u8bd5\u8fd0\u7b97\u7b26\u5355\u72ec\u68c0\u6d4b\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a,\u4f46\u7528\u5f15\u53f7\u62ec\u8d77\u6765\"$string1\"\u624d\u662f\u66f4\u597d\u4e60\u60ef string1 = initialized if [ $string1 ] # Again, $string1 stands naked. then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u518d\u6b21\u663e\u793a\u6b63\u786e\u7ed3\u679c\uff0c\u7136\u800c\u66f4\u597d\u4ecd\u7136\u662f\u7528\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u4e14\u770b\u4ee5\u4e0b\u7684\u5217\u5b50 string1 = \"a = b\" if [ $string1 ] # \u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u6765 then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # $string1\u6ca1\u6709\u5f15\u53f7\u663e\u793a\u51fa\u9519\u8bef\u7684\u7ed3\u679c #!/bin/bash # \u7528more\u547d\u4ee4\u67e5\u770b\u88ab\u538b\u7f29\u8fc7\u7684\u6587\u4ef6 NOARGS = 65 NOTFOUND = 66 NOTGZIP = 67 if [ $# -eq 0 ] # \u7b49\u540c\u4e8e: if [ -z \"$1\" ] # $1\u53ef\u4ee5\u5b58\u5728,\u4f46\u4e3a\u7a7a: zmore \"\" arg2 arg3 then echo \"Usage: `basename $0 ` filename\" > & 2 # \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef. exit $NOARGS # \u8fd4\u56de65\u4f5c\u4e3a\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001(\u9519\u8bef\u7801). fi filename = $1 if [ ! -f \" $filename \" ] # Quoting $filename allows for possible ces. then echo \"File $filename not found!\" > & 2 # \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef. exit $NOTFOUND fi if [ ${ filename ##*. } ! = \"gz\" ] # \u5728\u65b9\u62ec\u53f7\u91cc\u4f7f\u7528\u53d8\u91cf\u66ff\u6362. then echo \"File $1 is not a gzipped file!\" exit $NOTGZIP fi zcat $1 | more # \u7528\u8fc7\u6ee4\u7a0b\u5e8fmore,\u4e5f\u53ef\u4ee5\u7528less\u4ee3\u66ff exit $? # \u811a\u672c\u8fd4\u56de\u7ba1\u9053\u7684\u9000\u51fa\u72b6\u6001,\u5b9e\u9645\u4e0a\"exit $?\"\u662f\u591a\u4f59\u7684,\u56e0\u4e3a\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u4f1a\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u7801 \u6df7\u5408\u6bd4\u8f83 \u00b6 # -a \u903b\u8f91\u4e0e\u3001-o \u903b\u8f91\u6216\u64cd\u4f5c\u7b26\u548cBash\u4e2d\u7528\u4e8e\u53cc\u65b9\u62ec\u53f7\u7ed3\u6784\u7684\u6bd4\u8f83\u64cd\u4f5c\u7b26&&\u548c||\u5f88\u76f8\u4f3c # -o\u548c-a\u64cd\u4f5c\u7b26\u548ctest\u547d\u4ee4\u6216\u5355\u65b9\u62ec\u53f7\u4e00\u8d77\u4f7f\u7528 # \u68c0\u6d4b\u4f60\u5bf9\u6d4b\u8bd5\u547d\u4ee4\u638c\u63e1 # \u4e00\u4e2axinitrc\u7cfb\u7edf\u6587\u4ef6\u80fd\u7528\u6765\u542f\u52a8\u4e00\u4e2aX\u670d\u52a1\u5668\u3002\u8fd9\u4e2a\u6587\u4ef6\u5305\u542b\u4e86\u76f8\u5f53\u591a\u7684if/then\u6d4b\u8bd5\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6458\u5f55\u5c55\u793a\u7684\u4e00\u6837 if [ -f $HOME /.Xclients ] ; then exec $HOME /.Xclients elif [ -f /etc/X11/xinit/Xclients ] ; then exec /etc/X11/xinit/Xclients else # \u5931\u8d25\u540e\u7684\u5b89\u5168\u8bbe\u7f6e\u3002\u867d\u7136\u6211\u4eec\u51b3\u4e0d\u8be5\u6267\u884c\u5230\u8fd9\u513f,(\u6211\u4eec\u4e5f\u5728X\u5ba2\u6237\u63d0\u4f9b\u53ef\u9760\u4fdd\u8bc1) \u5b83\u4e0d\u80fd\u88ab\u7834\u574f xclock -geometry 100x100-5+5 & xterm -geometry 80x50-50+150 & if [ -f /usr/bin/netscape -a -f /usr/share/doc/HTML/index.html ] ; then netscape /usr/share/doc/HTML/index.html & fi fi \u6570\u5b57\u5e38\u91cf \u00b6 \u9664\u975e\u4e00\u4e2a\u6570\u5b57\u6709\u7279\u522b\u7684\u524d\u7f00\u6216\u7b26\u53f7\uff0c\u5426\u5219shell\u811a\u672c\u628a\u5b83\u5f53\u6210\u5341\u8fdb\u5236\u7684\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0\u7684\u6570\u5b57\u662f\u516b\u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0x\u7684\u6570\u5b57\u662f\u5341\u516d \u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u6570\u7528\u5185\u5d4c\u7684#\u6765\u6c42\u503c\u5219\u770b\u6210BASE#NUMBER(\u6709\u8303\u56f4\u548c\u7b26\u53f7\u9650\u5236)(\u8bd1\u8005\u6ce8\uff1aBASE#NUMBER\u5373\uff1a\u57fa\u6570#\u6570\u503c\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u4f8b\u5b50) #\u6570\u5b57\u5e38\u91cf\u7684\u8868\u793a\u6cd5 #!/bin/bash # numbers.sh: \u4e0d\u540c\u57fa\u6570\u7684\u6570\u5b57\u8868\u793a\u6cd5. # \u5341\u8fdb\u5236\u6570: \u5b83\u662f\u9ed8\u8ba4\u7684 let \"dec = 32\" ; echo \"decimal number = $dec \" # 32 # \u516b\u8fdb\u5236\u6570: \u4ee5'0'(\u96f6)\u4e3a\u524d\u7f00 let \"oct = 032\" ; echo \"octal number = $oct \" # 26,\u7ed3\u679c\u8868\u793a\u4e3a\u5341\u8fdb\u5236. # \u5341\u516d\u8fdb\u5236: \u4ee5'0x'\u6216'0X'\u4e3a\u524d\u7f00 let \"hex = 0x32\" ; echo \"hexadecimal number = $hex \" # 50,\u4ee5\u5341\u8fdb\u5236\u7684\u5f62\u5f0f\u8868\u793a. # \u5176\u4ed6\u7684\u8fdb\u5236\u7684\u8868\u793a\u5f62\u5f0f: BASE#NUMBER # BASE\u503c\u57282\u548c64\u4e4b\u95f4. # NUMBER\u5fc5\u987b\u4f7f\u7528\u5728BASE\u8303\u56f4\u5185\u7684\u7b26\u53f7,\u770b\u4e0b\u9762\u7684\u793a\u4f8b. let \"bin = 2#111100111001101\" ; echo \"binary number = $bin \" # 31181 let \"b32 = 32#77\" ; echo \"base-32 number = $b32 \" # 231 let \"b64 = 64#@_\" ; echo \"base-64 number = $b64 \" # 4031 # \u8fd9\u4e2a\u7b26\u53f7\u53ea\u80fd\u5de5\u4f5c\u5728ASCII\u7801\u503c\u4e3a2-64\u7684\u8303\u56f4\u9650\u5236. # 10\u4e2a\u6570\u5b57+26\u4e2a\u5c0f\u5199\u5b57\u6bcd+26\u4e2a\u5927\u5199\u5b57\u6bcd+ @ + _ echo $(( 36# zz )) $(( 2#10101010 )) $(( 16# AF16 )) $(( 53#1 aA )) # 1295 170 44822 3375 # \u63d0\u793a\uff1a\u4f7f\u7528\u4e00\u4e2a\u8d85\u51fa\u7ed9\u5b9a\u8fdb\u5236\u7684\u6570\u5b57\u5c06\u4f1a\u5f15\u8d77\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a let \"bad_oct = 081\" # \u6b64\u4f8b\u5b50\u4f1a\u53d1\u751f\u9519\u8bef\uff0c\u56e0\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\u53ea\u80fd\u4f7f\u7528\u6570\u5b570-7. \u5b9a\u4e49\u4e00\u4e2a\u989c\u8272\u8f93\u51fa\u5b57\u7b26\u4e32\u51fd\u6570 \u00b6 # function\u5173\u952e\u5b57\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u52a0\u6216\u4e0d\u52a0 \u65b9\u6cd5\u4e00\uff1a function echo_color (){ if [ $1 == \"green\" ] ; then echo -e \"\\033[32;40m $2 \\033[0m\" elif [ $1 == \"red\" 0 ] ; then echo -e \"\\\\033[31;40m $2 \\033[0m\" fi } \u65b9\u6cd5\u4e8c\uff1a function echo_color (){ case $1 in green ) echo -e \"\\033[32;40m $2 \\033[0m\" ;; red ) echo -e \"\\033[31;40m $2 \\033[0m\" ;; * ) echo \"Example:echo_color red string\" esac } \u6279\u91cf\u521b\u5efa\u7528\u6237 \u00b6 #!/bin/bash DATE = $( date+%F_%T ) USER_FILE = user.txt echo_color (){ if [ $1 == \"green\" ] ; then echo -e \"\\033[32;40m $2 \\033[0m\" elif [ $1 == \"red\" 0 ] ; then echo -e \"\\\\033[31;40m $2 \\033[0m\" fi } # \u5982\u679c\u7528\u6237\u6587\u4ef6\u5b58\u5728\u5e76\u5927\u4e8e0\u5c31\u5907\u4efd if [ -s $USER_FILE ] ; then mv $USER_FILE ${ USER_FILE } - ${ DATE } .bak echo_color green \" $USER_FILE exist,rename ${ USER_FILE } - ${ DATE } .bak\" fi echo shell\u91c7\u96c6\u7cfb\u7edfcpu \u5185\u5b58 \u78c1\u76d8 \u7f51\u7edc\u4fe1\u606f \u00b6 cpu\u4fe1\u606f\u91c7\u96c6 \u00b6 # cpu\u4f7f\u7528\u7387\u91c7\u96c6\u7b97\u6cd5;\u901a\u8fc7/proc/stat\u6587\u4ef6\u91c7\u96c6\u5e76\u8ba1\u7b97CPU\u603b\u4f7f\u7528\u7387\u6216\u8005\u5355\u4e2a\u6838\u4f7f\u7528\u7387\u3002\u4ee5cpu0\u4e3a\u4f8b\uff0c\u7b97\u6cd5\u5982\u4e0b\uff1a : << comment cat /proc/stat | grep \u2018cpu0\u2019 # \u5f97\u5230cpu0\u7684\u4fe1\u606f cpuTotal1=user+nice+system+idle+iowait+irq+softirq cpuUsed1=user+nice+system+irq+softirq sleep 30\u79d2 # \u518d\u6b21cat /proc/stat | grep \u2018cpu0\u2019 \u5f97\u5230cpu\u7684\u4fe1\u606f cpuTotal2=user+nice+system+idle+iowait+irq+softirq cpuUsed2=user+nice+system+irq+softirq # \u5f97\u5230cpu0 \u572830\u79d2\u5185\u7684\u5355\u6838\u5229\u7528\u7387\uff1a(cpuUsed2 \u2013 cpuUsed1) * 100 / (cpuTotal2 \u2013 cpuTotal1) # \u76f8\u5f53\u4e8e\u4f7f\u7528top \u2013d 30\u547d\u4ee4\uff0c\u628auser\u3001nice\u3001system\u3001irq\u3001softirq\u4e94\u9879\u7684\u4f7f\u7528\u7387\u76f8\u52a0 comment a =( ` cat /proc/stat | grep -E \"cpu\\b\" | awk -v total = 0 \\ '{$1=\"\";for(i=2;i<=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }END{print total,used}' ` ) sleep 30 b =( ` cat /proc/stat | grep -E \"cpu\\b\" | awk -v total = 0 '{$1=\"\";for(i=2;i<=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }\\ END{print total,used}' ` ) cpu_usage =((( ${ b [1] } - ${ a [1] } ) *100 ) / ( ${ b [0] } - ${ a [0] } ))) # \u6b64\u5904\u8bed\u6cd5\u6709\u95ee\u9898\uff0c\u6682\u672a\u4fee\u590d # cpu\u8d1f\u8f7d\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/loadavg\u5f97\u5230\u673a\u5668\u76841/5/15\u5206\u949f\u5e73\u5747\u8d1f\u8f7d\uff0c\u518d\u4e58\u4ee5100 cpuload =( ` cat /proc/loadavg | awk '{print $1,$2,$3}' ` ) load1 = ${ cpuload [0] } load5 = ${ cpuload [1] } load15 = ${ cpuload [2] } \u5185\u5b58\u91c7\u96c6 \u00b6 # \u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0c(MemTotal \u2013 MemFree \u2013 Buffers \u2013 Cached)/1024\u5f97\u5230\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u6570 awk '/MemTotal/{total=$2}/MemFree/{free=$2}/Buffers/{buffers=$2}/^Cached/{cached=$2}END\\ {print (total-free-buffers-cached)/1024}' /proc/meminfo # MEM\u4f7f\u7528\u91cf\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0cMemTotal \u2013 MemFree\u5f97\u5230MEM\u4f7f\u7528\u91cf awk '/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/1024}' /proc/meminfo # SWAP\u4f7f\u7528\u5927\u5c0f\u91c7\u96c6\u7b97\u6cd5\uff1a\u901a\u8fc7/proc/meminfo\u6587\u4ef6\uff0cSwapTotal \u2013 SwapFree\u5f97\u5230SWAP\u4f7f\u7528\u5927\u5c0f awk '/SwapTotal/{total=$2}/SwapFree/{free=$2}END{print (total-free)/1024}' /proc/meminfo \u78c1\u76d8\u4fe1\u606f\u91c7\u96c6 \u00b6 # \u78c1\u76d8I/O # IN\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u786c\u76d8\u8bfb\u5230\u7269\u7406\u5185\u5b58\u7684\u6570\u636e\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgin\u7684\u589e\u91cf\uff0c\u628apgpgin\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf # \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bi\u4e00\u5217\u7684\u8f93\u51fa a = ` awk '/pgpgin/{print $2}' /proc/vmstat ` #sleep 240 b = ` awk '/pgpgin/{print $2}' /proc/vmstat ` ioin = $(( b-a )/ 240 )) # OUT\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u7269\u7406\u5185\u5b58\u5199\u5230\u786c\u76d8\u7684\u6570\u636e\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgout\u7684\u589e\u91cf\uff0c\u628apgpgout\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf # \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bo\u4e00\u5217\u7684\u8f93\u51fa a = ` awk '/pgpgout/{print $2}' /proc/vmstat ` sleep 240 b = ` awk '/pgpgout/{print $2}' /proc/vmstat ` ioout = $(( ( b-a )/ 240 )) \u7f51\u7edc\u4fe1\u606f\u91c7\u96c6 \u00b6 # \u6d41\u91cf:\u4ee5https://www.centos.bz/\u4e3a\u4f8b\uff0ceth0\u662f\u5185\u7f51\uff0ceth1\u5916\u7f51\uff0c\u83b7\u53d660\u79d2\u7684\u6d41\u91cf # \u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u6d41\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5b57\u8282\u6570\uff08KB\uff09\uff0c\u7136\u540e\u4e58\u4ee58\uff0c\u518d\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u6d41\u91cf traffic_be =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev ` ) sleep 60 traffic_af =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev ` ) eth0_in = $(( ( ${ traffic_af [0] } - ${ traffic_be [0] } )/ 60 )) eth0_out = $(( ( ${ traffic_af [1] } - ${ traffic_be [1] } )/ 60 )) eth1_in = $(( ( ${ traffic_af [2] } - ${ traffic_be [2] } )/ 60 )) eth1_out = $(( ( ${ traffic_af [3] } - ${ traffic_be [3] } )/ 60 )) # \u6570\u636e\u5305\u91cf\uff1a\u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u5305\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5305\u91cf\uff0c\u7136\u540e\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u5305\u91cf packet_be =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev ` ) sleep 60 packet_af =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev ` ) eth0_in = $(( ( ${ packet_af [0] } - ${ packet_be [0] } )/ 60 )) eth0_out = $(( ( ${ packet_af [1] } - ${ packet_be [1] } )/ 60 )) eth1_in = $(( ( ${ packet_af [2] } - ${ packet_be [2] } )/ 60 )) eth1_out = $(( ( ${ packet_af [3] } - ${ packet_be [3] } )/ 60 ))","title":"Shell"},{"location":"Shell/#shell","text":"bash shell\u672c\u8eab\u4e0d\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4f7f\u7528\u6b63\u5219\u7684\u662fshell\u547d\u4ee4\u548c\u5de5\u5177\uff0c\u5982grep\u3001sed\u7b49\u3002bash shell\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7684\u4e00\u4e9b\u5143\u5b57\u7b26\u5b9e \u73b0\u901a\u914d(Globbing)\u529f\u80fd\u3002\u901a\u914d\u5c31\u662f\u628a\u4e00\u4e2a\u5305\u542b\u901a\u914d\u7b26\u7684\u975e\u5177\u4f53\u6587\u4ef6\u540d\u6269\u5c55\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u7684\u4e00\u6279\u5177\u4f53\u6587\u4ef6\u540d\u7684\u8fc7\u7a0b Reference List Bash Guide for Beginners Advanced Bash-Scripting Guide","title":"shell\u7b14\u8bb0"},{"location":"Shell/#shell_1","text":"\u65b9\u6cd5\u4e00\uff1a : << \u5b57\u7b26(\u4e00\u822c\u4f7f\u7528comment\u4fbf\u4e8e\u8bc6\u522b) \u8bed\u53e5 \u5b57\u7b26 \u65b9\u6cd5\u4e8c\uff1a : ' \u8bed\u53e5 '","title":"shell\u591a\u884c\u6ce8\u91ca\u5b9e\u73b0\u65b9\u5f0f"},{"location":"Shell/#eof","text":"# \u7f16\u5199SHELL\u663e\u793a\u591a\u4e2a\u4fe1\u606f cat <<EOF +--------------------------------------------------------------+ | === Welcome to Tunoff services === | +--------------------------------------------------------------+ EOF # \u5c06mongodbrepo\u5199\u5165\u5230mongodb.repo\u6587\u4ef6 cat << EOF > /etc/yum.repos.d/mongodb.repo [mongodb-org-3.4] name=MongoDB 3.4 Repository baseurl=https://mirrors.aliyun.com/mongodb/yum/redhat/\\$releasever/mongodb-org/3.4/\\$basearch/ gpgcheck=0 enabled=1 EOF","title":"EOF\u5e38\u89c1\u7528\u6cd5"},{"location":"Shell/#shell_2","text":"$* # \u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $@ # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\uff0c\u548c$*\u7c7b\u4f3c\uff0c\u4f46\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77\uff0c\u4e14\u4ecd\u4fdd\u7559\u6bcf\u4e2a\u5f15\u7528\u53d8\u91cf\u7684\u533a\u6bb5\u542b\u4e49 $# # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u603b\u7684\u53c2\u6570\u6570\u76ee $* # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $_ # \u83b7\u53d6\u5728\u6b64\u4e4b\u524d\u6267\u884c\u7684\u547d\u4ee4\u6216\u811a\u672c\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570 $? # (\u5e38\u7528)\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u503c;\u6210\u529f\u8fd4\u56de0,\u5931\u8d25\u8fd4\u56de1 # \u8fd4\u56de\u503c\u53c2\u8003\uff1a 0 # \u8868\u793a\u8fd0\u884c\u6210\u529f 2 # \u6743\u9650\u62d2\u7edd 1~125 # \u8fd0\u884c\u5931\u8d25\u3001\u811a\u672c\u547d\u4ee4\u3001\u7cfb\u7edf\u547d\u4ee4\u9519\u8bef\u6216\u53c2\u6570\u4f20\u9012\u9519\u8bef 126 # \u627e\u5230\u8be5\u547d\u4ee4\u4f46\u65e0\u6cd5\u6267\u884c 127 # \u672a\u627e\u5230\u8981\u8fd0\u884c\u7684\u547d\u4ee4 >128 # \u547d\u4ee4\u88ab\u7cfb\u7edf\u5f3a\u5236\u7ed3\u675f $$ # \u5f53\u524dshell\u8fd0\u884c\u65f6\u7684\u8fdb\u7a0bID $! # \u4e0a\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7 $@ # \u6240\u6709\u7684\u53c2\u6570\uff0c\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77 $n # (\u5e38\u7528)\u4f4d\u7f6e\u53c2\u6570\u503c\uff0cn\u8868\u793a\u4f4d\u7f6e\uff0c\u83b7\u53d6\u5f53\u524d\u811a\u672c\u7b2cn\u4e2a\u53c2\u6570\u503c\uff0cn\u5927\u4e8e9\u65f6\u8981\u7528\u5927\u62ec\u53f7\uff0c\u4f8b ${ 10 } \uff0c\u63a5\u7684\u53c2\u6570\u4ee5\u7a7a\u683c\u9694\u5f00 $0 # (\u5e38\u7528)\u5f53\u524dshell\u540d(\u5f53\u524d\u6267\u884c\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u6267\u884c\u811a\u672c\u5305\u542b\u8def\u5f84\u5219\u8fd4\u56de\u4e5f\u5305\u542b\u811a\u672c\u8def\u5f84) # \u6570\u503c\u6bd4\u8f83\uff1a -eq # \u7b49\u4e8e -ne # \u4e0d\u7b49\u4e8e -gt # \u5927\u4e8e -ge # \u5927\u4e8e\u6216\u7b49\u4e8e -lt # \u5c0f\u4e8e -le # \u5c0f\u4e8e\u6216\u7b49\u4e8e # \u903b\u8f91\u6d4b\u8bd5\uff1a && # \u903b\u8f91\u4e0e || # \u903b\u8f91\u6216 ! # \u903b\u8f91\u5426","title":"shell\u7279\u6b8a\u53d8\u91cf\u57fa\u672c\u89e3\u91ca"},{"location":"Shell/#shell_3","text":"# ;(Command separator)\u5206\u53f7 \u5728 shell \u4e2d\u62c5\u4efb \" \u8fde\u7eed\u6307\u4ee4 \" \u529f\u80fd\u7684\u7b26\u53f7\u5c31\u662f\u5206\u53f7 \u4f8b\u5982\uff1a cd ~/ backup ;mkdir startup;cp ~/.* startup/. # \u8fdb\u5165\u5bb6\u76ee\u5f55\u4e0bbackup\u5e76\u521b\u5efa\u76ee\u5f55startup\uff0c\u590d\u5236\u5bb6\u76ee\u5f55\u4e0b\u6240\u6709\u5230startup\u4e0b # ;;(Terminator)\u8fde\u7eed\u5206\u53f7 \u4e13\u7528\u5728 case \u6d41\u7a0b\u63a7\u5236\u9009\u9879\uff0c\u62c5\u4efb Terminator \u89d2\u8272\u3002\u4f8b\u5982\uff1a case \\ \" $fop\\ \" in help ) echo \\ \" Usage: Command -help -version filename\\ \" ;;version) echo \\\"version 0.1\\\" ;;esac # . ( dot ) \u82f1\u6587\u53e5\u53f7 shell \u4e2d\u4e00\u4e2a dot \u4ee3\u8868\u5f53\u524d\u76ee\u5f55\uff0c\u4e24\u4e2a\u4ee3\u8868\u4e0a\u5c42\u76ee\u5f55\uff0c\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u5219\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26 # ' string ' ( single quote ) \u5355\u5f15\u53f7 \u5355\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u4e14$\u7b26\u53f7\u4e5f\u88ab\u5f53\u505a\u4e00\u822c\u5b57\u7b26\u5904\u7406 # \" string \" ( double quote ) \u53cc\u5f15\u53f7 \u53cc\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u9632\u6b62\u901a\u914d\u7b26\u6269\u5c55\uff0c\u4f46\u662f\u5141\u8bb8\u53d8\u91cf\u6269\u5c55\u3002\u6b64\u5904\u548c\u5355\u5f15\u53f7\u4e0d\u540c # ` command ` ( backticks ) \u5012\u5f15\u53f7 \u5012\u5f15\u53f7\u5185\u7684 command \u4f1a\u88ab\u5f53\u505a\u547d\u4ee4\u6765\u6267\u884c # , ( comma ) \u82f1\u6587\u9017\u53f7 \u6b64\u7b26\u53f7\u5e38\u7528\u5728\u8fd0\u7b97\u4e2d\uff0c\u7528\u4f5c\u533a\u57df\u9694\u79bb\u3002\u4f8b\u5982\uff1a let \" t1 = ((a = 5 + 3, b = 7 - 1, c = 15 - 4)) \" ;echo \"t1 = $t1, a = $a, b = $b\" # / ( forward slash ) \u659c\u7ebf \u8def\u5f84\u4e2d\u8868\u793a\u76ee\u5f55\uff0c\u56db\u5219\u8fd0\u7b97\u4e2d\u4ee3\u8868\u9664\u6cd5\u7b26\u53f7\u3002\u4f8b\u5982\uff1a let \" num1 = ((a = 10 / 2, b = 25 / 5)) \" ;echo $num1,$a,$b # \\\\ \u5012\u659c\u7ebf \u4ea4\u4e92\u6a21\u5f0f\u4e0b\u7684 escape \u5b57\u7b26 \u4f5c\u7528\uff1a\u653e\u5728\u6307\u4ee4\u524d\u53d6\u6d88 aliases \uff1b\u653e\u5728\u7279\u6b8a\u7b26\u53f7\u524d\u5219\u8be5\u7279\u6b8a\u7b26\u53f7\u4e0d\u518d\u6709\u7279\u6b8a\u610f\u4e49\uff1b\u653e\u5728\u6307\u4ee4\u6700\u672b\u7aef\u8868\u793a\u8fde\u63a5\u4e0b\u4e00\u884c # | ( pipeline ) \u7ba1\u9053 pipeline \u7528\u6765\u8fde\u63a5\u4e0a\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u5165 # ! ( negate or reverse ) \u82f1\u6587\u611f\u53f9\u53f7 \u901a\u5e38\u4f5c\u4e3a\u53cd\u903b\u8f91\u4f7f\u7528\uff0c\u5982\u6761\u4ef6\u6d4b\u8bd5\u4e2d != \u8868\u793a\u4e0d\u7b49\u4e8e,\u4f8b\u5982\u5224\u65ad\u4e0a\u4e2a\u6307\u4ee4\u662f\u5426\u6267\u884c\u6210\u529f if [ \" $? \" != 0 ] ; then echo \"Executes error\"; fi # : \u82f1\u6587\u5192\u53f7 bash \u4e2d\u4f5c\u4e3a\u5185\u5efa\u6307\u4ee4\u8868\u793a\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u4f46\u8fd4\u56de\u72b6\u6001\u503c 0 \u4f8b\u5982\uff1a : ${ HOSTNAME }${ USER } # \u68c0\u67e5\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u662f\u5426\u5df2\u8bbe\u7f6e\uff0c\u6ca1\u6709\u8bbe\u7f6e\u5219\u4ee5\u6807\u51c6\u9519\u8bef\u663e\u793a\u9519\u8bef\u4fe1\u606f # ? ( wild card ) \u95ee\u53f7 \u6b63\u5219\u8868\u793a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u4e0d\u5305\u542b null # * ( wild card ) \u661f\u53f7 \u6b63\u5219\u4e2d\u8868\u793a\u4efb\u4f55\u5b57\u7b26\uff0c\u5305\u542b null \uff1b\u56db\u5219\u8fd0\u7b97\u4e2d\u8868\u793a\u4e58\u6cd5 # ** \u5e42\u8fd0\u7b97 let sum = 2 ** 3 ;echo $sum # \u8f93\u51fa8 # $ ( dollar sign ) dollar \u7b26\u53f7 \u53d8\u91cf\u66ff\u6362\u4ee3\u8868\u7b26\u53f7\uff1b\u6b63\u5219\u4e2d\u8868\u793a\u5339\u914d\u884c\u5c3e # ${} \u53d8\u91cf\u7684\u6b63\u5219\u8868\u8fbe\u5f0f bash \u4e2d\u5f88\u591a\u7528\u6cd5\uff0c\u8be6\u60c5\u89c1\u4e0b\u6587 # () ( command group ) \u6307\u4ee4\u7fa4\u7ec4 \u7528\u62ec\u53f7\u5c06\u4e00\u4e32\u8fde\u7eed\u6307\u4ee4\u62ec\u8d77\u6765\uff0c\u79f0\u4f5c\u6307\u4ee4\u7fa4\u7ec4\uff0c\u4f8b\u5982\uff1a ( cd ~ ; var=`pwd` ;echo $var) # (()) \u4f5c\u7528\u548c let \u547d\u4ee4\u76f8\u4f3c\uff0c\u7528\u5728\u7b97\u6570\u8fd0\u7b97\u4e2d\uff0c\u4f46\u6267\u884c\u6548\u7387\u7565\u9ad8.\u4f8b\u5982\uff1a (( a = 10 )) ;echo -e \"\u521d\u59cb\u503c: a = $a \\n\";((a++));echo \"a++ \u540e\u7ed3\u679c: a=$a\" # { } \u5927\u62ec\u53f7 ( block of code ) \u7528\u6cd5\u4e00\uff1a\u662f\u4f5c\u4e3a\u4ee3\u7801\u5757\uff0c\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u4e0e\u5c0f\u62ec\u53f7\u4e0d\u540c\u7684\u662f\u4e0d\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2a sub shell \u8fd0\u884c\u3002\u811a\u672c\u4f59\u4e0b\u90e8\u5206\u4ecd\u53ef\u4f7f\u7528\u62ec\u53f7\u5185 \u53d8\u91cf\uff0c\u62ec\u53f7\u5185\u547d\u4ee4\u4e4b\u95f4\u7528\u5206\u53f7\u9694\u5f00\uff0c\u6700\u540e\u4e00\u4e2a\u4e5f\u5fc5\u987b\u6709\u5206\u53f7\uff0c{}\u7b2c\u4e00\u4e2a\u547d\u4ee4\u548c\u5de6\u8fb9\u7684\u5927\u62ec\u53f7\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\u3002\u4f8b\u5982\uff1a a = one ; { a=two; echo -e \"\\n$a \\n\";}; echo $a \u7528\u6cd5\u4e8c\uff1a\u5927\u62ec\u53f7\u62d3\u5c55\u3002 ( \u901a\u914d ( globbing )) \u5c06\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u6587\u4ef6\u540d\u505a\u6269\u5c55\u3002\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u4e0d\u5141\u8bb8\u6709\u7a7a\u767d\uff0c\u9664\u975e\u8fd9\u4e2a\u7a7a\u767d\u88ab\u5f15\u7528\u6216\u8f6c\u4e49\u3002 \u7b2c\u4e00\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u4ee5\u9017\u53f7\u5206\u5272\u7684\u6587\u4ef6\u5217\u8868\u8fdb\u884c\u62d3\u5c55\u3002\u5982 touch { a , b }. txt \u7ed3\u679c\u4e3a a . txt b . txt \u3002\u7b2c\u4e8c\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u4ee5\u70b9\u70b9\uff08..\uff09 \u5206\u5272\u7684\u987a\u5e8f\u6587\u4ef6\u5217\u8868\u8d77\u62d3\u5c55\u4f5c\u7528\uff0c\u5982\uff1a touch { a .. d }. txt \u7ed3\u679c\u4e3a a . txt b . txt c . txt d . txt \u8fd8\u53ef\u4ee5\u7528\u5728\u5b57\u7b26\u4e32\u7ec4\u5408\u4e0a\uff0c\u5982\uff1a mkdir { a , b } - { 1 , 2 } \u7ed3\u679c\u4e3a\uff1a a - 1 a - 2 b - 1 b - 2 # [] \u4e2d\u62ec\u53f7 \u4e0e test \u7b49\u540c\uff0c\u901a\u5e38\u7528\u4f5c\u6761\u4ef6\u5224\u65ad\uff0c\u53c2\u6570\u4f5c\u4e3a\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u6587\u4ef6\u6d4b\u8bd5\uff0c\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u72b6\u6001\u7801 test \u548c[]\u4e2d\u6bd4\u8f83\u8fd0\u7b97\u7b26\u53ea\u6709 == \u548c != \uff0c\u7528\u4e8e\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u6574\u6570\u6bd4\u8f83\u53ea\u80fd - gt , - eq \u7b49 \u6b63\u5219\u4e2d\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u8303\u56f4 \u5728\u4e00\u4e2a array \u7ed3\u6784\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4e2d\u62ec\u53f7\u7528\u4e8e\u5f15\u7528\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u7f16\u53f7 # [[]] \u6b64\u62ec\u53f7\u4e4b\u95f4\u4efb\u4f55\u5b57\u7b26\u90fd\u4e0d\u4f1a\u53d1\u751f\u6587\u4ef6\u6269\u5c55\u540d\u6216\u8005\u5355\u8bcd\u7684\u5206\u5272\uff0c\u4f46\u4f1a\u6709\u53c2\u6570\u6269\u5c55\u548c\u547d\u4ee4\u66ff\u6362 \u652f\u6301\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f\u5339\u914d\uff0c\u5b57\u7b26\u4e32\u6bd4\u8f83\u65f6\u53ef\u4ee5\u628a\u53f3\u8fb9\u5f53\u505a\u4e00\u4e2a\u6a21\u5f0f \u4f7f\u7528[[]]\u4f5c\u4e3a\u6761\u4ef6\u5224\u65ad\u53ef\u9632\u6b62\u811a\u672c\u4e2d\u903b\u8f91\u9519\u8bef\uff0c && , || , < , > \u64cd\u4f5c\u7b26\u53ef\u5728[[]]\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u5728[]\u4e2d\u4f1a\u62a5\u9519 \u4f8b\u5982\uff1a read ak ; if [[ $ak > 5 || $ak < 2 ]]; then echo \"$ak\"; fi # \u8f93\u51fa / \u8f93\u5165\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff1a > >> < << &> 2 &> 2 <>>& >& 2 \u6587\u4ef6\u63cf\u8ff0\u7b26 ( file descriptor \uff09\u901a\u5e38\u7528\u4e00\u4e2a\u6570\u5b57 ( 0 - 9 ) \u8868\u793a\u6587\u4ef6 \u5e38\u89c1\u63cf\u8ff0\u7b26\u5982\u4e0b\uff1a \u6587\u4ef6\u63cf\u8ff0\u7b26 \u540d\u79f0 \u7f29\u5199 \u9ed8\u8ba4\u503c 0 \u6807\u51c6\u8f93\u5165 stdin \u952e\u76d8 1 \u6807\u51c6\u8f93\u51fa stdout \u5c4f\u5e55 2 \u6807\u51c6\u9519\u8bef\u8f93\u51fa stderr \u5c4f\u5e55 \u7b80\u5355\u4f7f\u7528 < \u6216 > \u65f6\uff0c\u76f8\u5f53\u4e8e 0 < \u6216 1 > command > file # command \u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u5230 file command >> file # command \u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u8ffd\u52a0\u5230 file command < file # command \u547d\u4ee4\u4ece file \u8bfb\u53d6 command << file # \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6\u8f93\u5165\uff0c\u77e5\u9053\u4e0e file \u5339\u914d\u7684\u884c\u7ed3\u675f\uff0c\u9664\u975e\u4f7f\u7528\u5f15\u53f7\u5c06\u8f93\u5165\u62ec\u8d77\u6765\uff0c\u6b64\u6a21\u5f0f\u5c06\u5bf9\u8f93\u5165\u5185\u5bb9\u8fdb\u884c shell \u53d8\u91cf \u66ff\u6362\u5982\u679c\u4f7f\u7528 <<- \u5219\u5ffd\u7565\u63a5\u4e0b\u6765\u8f93\u5165\u884c\u9996\u7684 tab command <<< word # \u628a\u5b57\u7b26 word \u548c\u540e\u9762\u7684\u6362\u884c\u4f5c\u4e3a\u8f93\u5165\u63d0\u4f9b\u7ed9 command command <> file # \u4ee5\u8bfb\u5199\u6a21\u5f0f\u5c06 file \u91cd\u5b9a\u5411\u5230\u8f93\u5165\uff0c file \u4e0d\u4f1a\u88ab\u7834\u574f command >| file # \u548c > \u529f\u80fd\u76f8\u540c : > file # \u5c06 file \u622a\u65ad\u4e3a 0 \u957f\u5ea6 command >& n # \u628a\u8f93\u51fa\u9001\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26 n \uff0c\u6ce8\u610f\uff1a >& \u5b9e\u9645\u4e0a\u590d\u5236\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4f7f cmd > file 2 >& 1 \u4e0e cmd 2 >& 1 > file \u7684\u6548\u679c\u4e0d\u4e00\u6837 command m >& n # \u628a\u8f93\u51fa\u5230\u6587\u4ef6\u7b26 m \u7684\u4fe1\u606f\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26 n command >&- # \u5173\u95ed\u6807\u51c6\u8f93\u51fa command <& n # \u8f93\u5165\u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u7b26 n command m <& n # m \u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u5404\u4e2a n command <&- # \u5173\u95ed\u6807\u51c6\u8f93\u5165 command <& n - # \u79fb\u52a8\u8f93\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26 n \u800c\u975e\u590d\u5236\u5b83\uff08\u9700\u8981\u89e3\u91ca\uff09 &> file \u548c > file 2 >& 1 \u76f8\u540c # ~+ \u8868\u793a\u5f53\u524d\u5de5\u4f5c\u8def\u5f84\uff0c\u4e0e\u53d8\u91cf$ PWD \u4e00\u81f4","title":"\u5728shell\u4e2d\u5e38\u7528\u7684\u7b26\u53f7\u4e00\u822c\u7528\u6cd5\uff1a"},{"location":"Shell/#shell_4","text":"\u8868\u8fbe\u5f0f \u8bf4\u660e ${parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u7684\u5185\u5bb9 ${#parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u5185\u5bb9\u7684\u5b57\u7b26\u957f\u5ea6 ${parameter:offset} \u5728\u53d8\u91cf$parameter\u4e2d\uff0c\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u5230\u7ed3\u5c3e ${parameter:offset:length} \u5728\u53d8\u91cf$parameter\u4e2d\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3alength\u7684\u5b50\u4e32 ${parameter#word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter##word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter/pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u7b2c\u4e00\u4e2a\u5339\u914d\u7684pattern ${parameter//pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u6240\u6709\u5339\u914d\u7684pattern ${parameter:-word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c ${parameter:=word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c,\u4f4d\u7f6e\u53d8\u91cf\u548c\u7279\u6b8a\u53d8\u91cf\u4e0d\u9002\u7528 ${parameter:?word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219word\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff0c\u5426\u5219\u8f93\u51fa\u53d8\u91cf\u7684\u503c ${parameter:+word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u5426\u5219word\u5b57\u7b26\u4e32\u66ff\u4ee3\u53d8\u91cf\u7684\u503c word\u53ef\u4ee5\u8868\u793a\u4e3a\u4e00\u4e32\u5b57\u7b26\uff0c\u6bd4\u5982a*c\u8868\u793a\u5220\u9664\u4ece\u5b57\u7b26a\u5230c\u7684\u6240\u6709\u5b57\u7b26","title":"shell\u53d8\u91cf\u5b50\u4e32\u8bf4\u660e"},{"location":"Shell/#bash","text":": << comment exit\u547d\u4ee4\u4e00\u822c\u7528\u4e8e\u7ed3\u675f\u4e00\u4e2a\u811a\u672c\uff0c\u5b83\u4e5f\u80fd\u8fd4\u56de\u4e00\u4e2a\u503c\u7ed9\u7236\u8fdb\u7a0b,\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u80fd\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\uff08\u6709\u65f6\u4e5f\u770b\u505a\u8fd4\u56de\u72b6\u6001).\u4e00\u4e2a\u547d\u4ee4\u6267\u884c \u6210\u529f\u8fd4\u56de0\uff0c\u4e00\u4e2a\u6267\u884c\u4e0d\u6210\u529f\u7684\u547d\u4ee4\u5219\u8fd4\u56de\u4e00\u4e2a\u975e\u96f6\u503c\uff0c\u6b64\u503c\u901a\u5e38\u53ef\u4ee5\u88ab\u89e3\u91ca\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684\u9519\u8bef\u503c\u3002\u9664\u4e86\u4e00\u4e9b\u4f8b\u5916\u7684\u60c5\u51b5\uff0cUNIX\u547d\u4ee4\uff0c\u7a0b \u5e8f\u6216\u662f\u8f6f\u4ef6\u5305\u6267\u884c\u6210\u529f\u90fd\u662f\u4ee5\u8fd4\u56de0\u7684\u4f5c\u4e3a\u9000\u51fa\u7801 \u540c\u6837\u7684\uff0c\u5728\u811a\u672c\u91cc\u7684\u51fd\u6570\u548c\u811a\u672c\u81ea\u8eab\u90fd\u4f1a\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u811a\u672c\u6216\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u5c06\u51b3\u5b9a\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u4e00\u4e2a\u811a\u672c\u91cc\uff0cexit n\u547d\u4ee4 \u5c06\u4f1a\u8fd4\u56deshell\u4e00\u4e2annn\u7684\u9000\u51fa\u72b6\u6001\u7801\u3002\uff08nnn\u5fc5\u987b\u662f\u4e00\u4e2a\u57280-255\u8303\u56f4\u7684\u5341\u8fdb\u5236\u6574\u6570\uff09 \u5982\u679c\u4e00\u4e2a\u811a\u672c\u4ee5\u4e0d\u5e26\u53c2\u6570\u7684exit\u547d\u4ee4\u7ed3\u675f\uff0c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u5c06\u4f1a\u662f\u6267\u884cexit\u547d\u4ee4\u524d\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u7801\uff0c\u811a\u672c\u7ed3\u675f\u6ca1\u6709exit,\u4e0d\u5e26 \u53c2\u6570\u7684exit\u548cexit $?\u4e09\u8005\u7b49\u4ef7\uff0c$?\u53d8\u91cf\u4fdd\u5b58\u4e86\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u540e\u7684\u9000\u51fa\u72b6\u6001\uff0c\u5f53\u4e00\u4e2a\u51fd\u6570\u8fd4\u56de\u65f6\uff0c$?\u4fdd\u5b58\u4e86\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000 \u51fa\u72b6\u6001\u7801\u3002\u8fd9\u5c31\u662fBash\u91cc\u51fd\u6570\u8fd4\u56de\u503c\u7684\u5904\u7406\u529e\u6cd5\u3002\u5f53\u4e00\u4e2a\u811a\u672c\u8fd0\u884c\u7ed3\u675f\uff0c$? \u53d8\u91cf\u4fdd\u5b58\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\uff0c\u800c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u5219\u662f\u811a\u672c\u4e2d\u6700 \u540e\u4e00\u4e2a\u5df2\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u3002\u5e76\u4e14\u4f9d\u7167\u60ef\u4f8b\uff0c0\u8868\u793a\u6267\u884c\u6210\u529f\uff0c1-255\u7684\u6574\u6570\u8303\u56f4\u8868\u793a\u9519\u8bef\u6216\u53cd\u5e38\u7684\u6761\u4ef6 \u903b\u8f91\u975e\u64cd\u4f5c\u7b26!\uff0c\u53cd\u8f6c\u4e00\u4e2a\u547d\u4ee4\u6216\u4e00\u4e2a\u6d4b\u8bd5\u7684\u7ed3\u679c\u3002\u4e5f\u80fd\u53cd\u8f6c\u9000\u51fa\u72b6\u6001 comment","title":"bash\u9000\u51fa\u548c\u9000\u51fa\u72b6\u6001"},{"location":"Shell/#_1","text":"# \u5c40\u90e8\u53d8\u91cf\uff1a\u53ea\u5728\u4ee3\u7801\u5757\u6216\u4e00\u4e2a\u51fd\u6570\u4e2d\u6709\u6548 # \u73af\u5883\u53d8\u91cf\uff1a\u5176\u4f1a\u5f71\u54cdshell\u7684\u884c\u4e3a\u548c\u7528\u6237\u63a5\u53e3\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u73af\u5883\uff0c\u5176\u7531\u8fdb\u7a0b\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u7ec4\u6210 # \u5206\u914d\u7ed9\u73af\u5883\u53d8\u91cf\u7684\u603b\u7a7a\u95f4\u6709\u9650\uff0c\u82e5\u521b\u5efa\u592a\u591a\u73af\u5883\u53d8\u91cf\u6216\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u7684\u503c\u592a\u957f\u800c\u5360\u7528\u8fc7\u591a\u7a7a\u95f4\u5219\u4f1a\u51fa\u9519 # \u4f8b\u5982\uff1a : <<comment eval \"`seq 10000 | sed -e 's/.*/export var&=ZZZZZZZZZZZZZZ/'`\" du /usr/bin/du:Argument list too long comment # \u5982\u679c\u4e00\u4e2a\u811a\u6b65\u8981\u8bbe\u7f6e\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5219\u9700\u8981\u5c06\u5176\u5bfc\u51fa(export)\uff0c\u4e5f\u5c31\u662f\u8bb2\u9700\u901a\u77e5\u5230\u811a\u672c\u7684\u73af\u5883\u8868\uff0c\u8fd9\u662fexport\u547d\u4ee4\u529f\u80fd # \u4e00\u4e2a\u811a\u672c\u53ea\u80fd\u5bfc\u51fa\uff08export\uff09\u53d8\u91cf\u5230\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u80fd\u5bfc\u51fa\u5230\u7531\u6b64\u811a\u672c\u751f\u6210\u7684\u547d\u4ee4\u6216\u8fdb\u7a0b\u4e2d\u3002\u5728\u4e00\u4e2a\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u7684\u811a\u672c\u4e0d\u80fd\u5bfc\u51fa # \u4e00\u4e2a\u53d8\u91cf\u5f71\u54cd\u5230\u547d\u4ee4\u884c\u7684\u73af\u5883\u3002\u5b50\u8fdb\u7a0b\u4e0d\u80fd\u5bfc\u51fa\u53d8\u91cf\u5230\u751f\u6210\u5b83\u7684\u7236\u8fdb\u7a0b\u4e2d\u3002 # \u4f4d\u7f6e\u53c2\u6570 : <<comment \u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u662f$0,$1,$2.... $0\u662f\u811a\u672c\u7684\u540d\u5b57\uff0c$1\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c$2\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570......\u5728\u4f4d\u7f6e\u53c2\u6570$9\u4e4b\u540e\u7684\u53c2\u6570\u5fc5\u987b\u7528\u5927\u62ec\u53f7\u62ec\u8d77\u6765\u3002\u5982\uff1a${10} \u7279\u6b8a\u53d8\u91cf$*\u548c$@\u8868\u793a\u6240\u6709\u7684\u4f4d\u7f6e\u53c2\u6570 comment : <<comment #!/bin/bash # \u4f4d\u7f6e\u53c2\u6570\u4f8b\u5b50\uff1a # \u81f3\u5c11\u4ee510\u4e2a\u53c2\u6570\u8fd0\u884c\u6b64\u811a\u672c\u3002\u4f8b\u5982\uff1a./script.sh 1 2 3 4 5 6 7 8 9 10 min_params=10 echo \"\u811a\u672c\u540d\u5b57\u662f\\\"$0\\\".\" # \u7528./\u8868\u793a\u5f53\u524d\u76ee\u5f55 echo \"\u811a\u672c\u540d\u5b57\u662f\\\"`basename $0`\\\".\" comment","title":"\u53d8\u91cf\u7c7b\u578b"},{"location":"Shell/#if","text":"\u4e3b\u8981\u7684\u8868\u8fbe\u5f0f \u542b\u4e49 [ -a FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue [ -b FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u5757\u8bbe\u5907\u8fd4\u56deTrue(\u8f6f\u76d8,\u5149\u9a71\u7b49) [ -c FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u65f6\u5b57\u7b26\u8bbe\u5907\u8fd4\u56deTrue(\u952e\u76d8,\u8c03\u5236\u89e3\u8c03\u5668,\u58f0\u5361\u7b49) [ -d FILE ] \u5982\u679c\u662f\u76ee\u5f55\u8fd4\u56deTrue [ -e FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue [ -f FILE ] \u6587\u4ef6\u662f\u666e\u901a\u6587\u4ef6\u5e76\u4e14\u4e0d\u662f\u4e00\u4e2a\u76ee\u5f55\u6216\u662f\u4e00\u4e2a\u8bbe\u5907\u6587\u4ef6\u8fd4\u56deTrue [ -g FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8bbe\u7f6e-\u7ec4-ID(sgid)\u6807\u8bb0\u88ab\u8bbe\u7f6e\u8fd4\u56deTrue\uff0c\u5982\u679c\u4e00\u4e2a\u76ee\u5f55\u7684sgid\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u5728\u8fd9\u4e2a \u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5c5e\u4e8e\u62e5\u6709\u6b64\u76ee\u5f55\u7684\u7528\u6237\u7ec4\uff0c\u800c\u4e0d\u5fc5\u662f\u521b\u5efa\u6587\u4ef6\u7684\u7528\u6237\u6240\u5c5e\u7684\u7ec4\u3002\u8fd9\u4e2a\u7279\u6027\u5bf9\u5728\u4e00\u4e2a\u5de5\u4f5c\u7ec4\u91cc\u7684\u540c\u4eab\u76ee\u5f55\u5f88\u6709\u7528\u5904 [ -h FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -k FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue and \u7c98\u4f4f\u4f4d\u8bbe\u7f6e\u3002\u4fd7\u79f0\u201c\u7c98\u6027\u4f4d\u201d\uff0c\u4fdd\u5b58\u6587\u672c\u6a21\u5f0f\u6807\u5fd7\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u6587\u4ef6\u6743\u9650\u3002\u5982\u679c \u4e00\u4e2a\u6587\u4ef6\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u6807\u5fd7\uff0c\u8be5\u6587\u4ef6\u5c06\u88ab\u4fdd\u5b58\u5728\u7f13\u5b58\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u66f4\u5feb\u5730\u8bbf\u95ee\u3002\u30142\u3015\u5982\u679c\u8bbe\u7f6e\u5728\u76ee\u5f55\u4e0a\uff0c\u5219\u9650\u5236\u5199\u5165\u6743\u9650\u3002\u8bbe\u7f6e\u7c98\u6027 \u4f4d\u5c06T\u6dfb\u52a0\u5230\u6587\u4ef6\u6216\u76ee\u5f55\u5217\u8868\u7684\u6743\u9650(drwxrwxrw**t**)\uff0c\u5982\u679c\u7528\u6237\u4e0d\u62e5\u6709\u8bbe\u7f6e\u4e86\u7c98\u6027\u4f4d\u7684\u76ee\u5f55\uff0c\u4f46\u5728\u8be5\u76ee\u5f55\u4e2d\u5177\u6709\u5199\u6743\u9650\uff0c\u5219\u4ed6\u53ea\u80fd \u5220\u9664\u5176\u62e5\u6709\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u5728\u516c\u5171\u53ef\u8bbf\u95ee\u76ee\u5f55\uff08\u5982/tMP\uff09\u4e2d\u65e0\u610f\u4e2d\u8986\u76d6\u6216\u5220\u9664\u5f7c\u6b64\u7684\u6587\u4ef6 [ -p FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u662f\u4e00\u4e2a\u7ba1\u9053\u8fd4\u56deTrue [ -r FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u662f\u5426\u53ef\u8bfb\u8fd4\u56deTrue(\u6307\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u8bfb\u6743\u9650) [ -s FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e0\u8fd4\u56deTrue [ -t FD ] \u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26FD(\u5bf9\u5e94\u51fd\u6570\u7684\u8fd4\u56de\u503c)\u6253\u5f00\u5e76\u5f15\u7528\u4e86\u7ec8\u7aef\u5219\u4e3aTrue\uff0c\u6587\u4ef6(\u63cf\u8ff0\u7b26)\u4e0e\u4e00\u4e2a\u7ec8\u7aef\u8bbe\u5907\u76f8\u5173\uff0c\u8fd9\u4e2a\u6d4b \u8bd5\u9009\u9879\u53ef\u4ee5\u7528\u4e8e\u68c0\u67e5\u811a\u672c\u4e2d\u662f\u5426\u6807\u51c6\u8f93\u5165 ([ -t 0 ])\u6216\u6807\u51c6\u8f93\u51fa([ -t 1 ])\u662f\u4e00\u4e2a\u7ec8\u7aef [ -u FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue\uff0c\u6587\u4ef6\u7684\u8bbe\u7f6e-\u7528\u6237-ID(suid)\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u4e00\u4e2aroot\u7528\u6237\u62e5\u6709\u7684\u4e8c\u8fdb\u5236\u6267\u884c\u6587\u4ef6\u5982\u679c\u8bbe\u7f6e\u4e86 \u8bbe\u7f6e-\u7528\u6237-ID\u4f4d(suid)\u6807\u5fd7\u666e\u901a\u7528\u6237\u53ef\u4ee5\u4ee5root\u6743\u9650\u8fd0\u884c\u3002[1] \u8fd9\u5bf9\u9700\u8981\u5b58\u53d6\u7cfb\u7edf\u786c\u4ef6\u7684\u6267\u884c\u7a0b\u5e8f\uff08\u6bd4\u5982\u8bf4pppd\u548ccdrecord\uff09\u5f88\u6709\u7528 \u5982\u679c\u6ca1\u6709\u8bbe\u7f6esuid\u4f4d\uff0c\u5219\u8fd9\u4e9b\u4e8c\u8fdb\u5236\u6267\u884c\u7a0b\u5e8f\u4e0d\u80fd\u7531\u975eroot\u8c03\u7528\u3002\u88ab\u8bbe\u7f6e\u4e86suid\u6807\u5fd7\u7684\u6587\u4ef6\u5728\u6743\u9650\u5217\u4e2d\u4ee5s\u6807\u5fd7\u8868\u793a(-rw**s**r-xr-t) [ -w FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u53ef\u5199\u7684\u8fd4\u56deTrue(\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u5199\u6743\u9650) [ -x FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u53ef\u6267\u884c\u7684\u8fd4\u56de(\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u6267\u884c\u6743\u9650) [ -O FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u7531\u6709\u6548\u7528\u6237ID\u6240\u62e5\u6709\u7684\u8fd4\u56deTrue(\u4f60\u662f\u6587\u4ef6\u62e5\u6709\u8005) [ -G FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u7531\u7528\u6237\u7ec4ID\u6240\u62e5\u6709\u7684\u8fd4\u56deTrue(\u4f60\u6240\u5728\u7684\u7ec4\u548c\u6587\u4ef6\u7684groupID\u4e00\u81f4) [ -L FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -N FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6700\u540e\u4e00\u6b21\u8bfb\u540e\u88ab\u4fee\u6539\u8fd4\u56deTrue [ -S FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2asocket\u8fd4\u56deTrue [ FILE1 -nt FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u66f4\u65b0\uff0c\u6216\u8005FILE1\u5b58\u5728\u4e14FILE2\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ot FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u65e7\uff0c\u6216\u8005FILE2\u5b58\u5728\u4e14FILE1\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ef FILE2 ] \u5982\u679cFILE1\u548cFILE2\u5f15\u7528\u76f8\u540c\u7684\u8bbe\u5907\u548cinode\u7f16\u53f7(\u76f8\u540c\u7684\u6587\u4ef6\u786c\u94fe\u63a5)\uff0c\u5219\u4e3aTrue [ -o OPTIONNAME ] \u5982\u679c\u542f\u7528\u4e86shell\u9009\u9879\u201cOPTIONNAME\u201d(\u9009\u9879\u540d\u79f0)\uff0c\u5219\u4e3aTrue [ -z STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e3a0\u5219\u4e3aTrue [ -n STRING ] or [ STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u4e3a0\u5219\u4e3aTrue [ STRING1 == STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u76f8\u7b49\u5219\u4e3aTrue\uff0c\u5bf9\u4e8e\u4e25\u683c\u7684POSIX\u5408\u89c4\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528\u201c=\u201d\u4ee3\u66ff\u201c==\u201d [ STRING1 != STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u76f8\u7b49\u5219\u4e3aTrue [ STRING1 < STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u524d\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ STRING1 > STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u540e\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ ARG1 OP ARG2 ] \u201cOP\u201d\u662f-eq\uff0c-ne\uff0c-lt\uff0c-le\uff0c-gt\u6216-ge\u4e4b\u4e00\u3002 \u5982\u679c\u201cARG1\u201d\u5206\u522b\u7b49\u4e8e\uff0c\u4e0d\u7b49\u4e8e\uff0c\u5c0f\u4e8e\uff0c\u5c0f\u4e8e\u6216\u7b49\u4e8e\uff0c\u5927\u4e8e \u6216\u5927\u4e8e\u6216\u7b49\u4e8e\u201cARG2\u201d\uff0c\u5219\u8fd9\u4e9b\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26\u8fd4\u56detrue\u3002 \u201cARG1\u201d\u548c\u201cARG2\u201d\u662f\u6574\u6570 \u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u8fd0\u7b97\u7b26\u7ec4\u5408\u8868\u8fbe\u5f0f\uff0c\u6309\u4f18\u5148\u7ea7\u9012\u51cf\u987a\u5e8f\u5217\u51fa\uff1a \u7c7b\u522b \u4f8b\u5b50 [ ! EXPR ] \"\u975e\" -- \u53cd\u8f6c\u4e0a\u9762\u6240\u6709\u6d4b\u8bd5\u7684\u7ed3\u679c(\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6761\u4ef6\u5219\u8fd4\u56de\u771f),\u5982\u679cEXPR\u662ffalse\u5219\u4e3a\u771f [ ( EXPR ) ] \u8fd4\u56deEXPR\u7684\u503c\u3002 \u8fd9\u53ef\u4ee5\u7528\u4e8e\u8986\u76d6\u8fd0\u7b97\u7b26\u7684\u6b63\u5e38\u4f18\u5148\u7ea7 [ EXPR1 -a EXPR2 ] \u5982\u679cEXPR1\u548cEXPR2\u90fd\u4e3a\u771f\uff0c\u5219\u4e3a\u771f [ EXPR1 -o EXPR2 ] \u5982\u679cEXPR1\u6216EXPR2\u4e3a\u771f\uff0c\u5219\u4e3a\u771f # \u5927\u591a\u6570\u7a0b\u5e8f\u5458\u66f4\u559c\u6b22\u4f7f\u7528test\u5185\u7f6e\u547d\u4ee4\uff0c\u8fd9\u76f8\u5f53\u4e8e\u4f7f\u7528\u65b9\u62ec\u53f7\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u4e0b\u6240\u793a test \" $( whoami ) \" ! = 'root' && ( echo you are using a non-privileged account ; exit 1 ) # \u5982\u679c\u5728\u5b50shell\u4e2d\u8c03\u7528exit\uff0c\u5219\u4e0d\u4f1a\u5c06\u53d8\u91cf\u4f20\u9012\u7ed9\u7236\u7ea7\u3002\u5982\u679c\u60a8\u4e0d\u5e0c\u671bBash\u6d3e\u751f\u5b50shell\uff0c\u8bf7\u4f7f\u7528{ }\u4ee3\u66ff()","title":"if\u4f7f\u7528\u7684\u4e3b\u8981\u8868\u8fbe\u5f0f"},{"location":"Shell/#if_1","text":"\u6d4b\u8bd5\u7c7b\u578b [ ] [[ ]] \u6570\u5b57\u6d4b\u8bd5 -eq -ne -lt -le -gt -ge \u540c[ ] \u6587\u4ef6\u6d4b\u8bd5 -r -l -w -x -f -d -s -nt -ot \u540c[ ] \u5b57\u7b26\u6d4b\u8bd5 = != -n -z ==(\u540c=) \u4e0d\u53ef\u4f7f\u7528<= >= \u540c[ ] \u903b\u8f91\u6d4b\u8bd5 -a -o ! && || ! \u6570\u5b66\u8fd0\u7b97 \u4e0d\u53ef\u4ee5\u4f7f\u7528 + - * / % \u7ec4\u5408 \u7528\u5404\u81ea\u903b\u8f91\u7b26\u53f7\u8fde\u63a5\u7684\u6570\u5b57(\u8fd0\u7b97)\u6d4b\u8bd5\u3001\u6587\u4ef6\u6d4b\u8bd5\u3001\u5b57\u7b26\u6d4b\u8bd5 \u540c[ ] \u60c5\u51b5\u590d\u6742\u7684\u5b57\u7b26\u6d4b\u8bd5 [ ] [[ ]] < > \u6bd4\u8f83\u7ed3\u679c\u5f02\u5e38\uff0c\u5982: [ 12 > 21 ]\u4e0e [ 12 > 21 ]\u4e0e [ 21 > 12 ]\u3001 [ a > b ]\u4e0e [ a > b ]\u4e0e [ b > a ]\u7684\u8fd4\u56de\u503c\u4e00\u6837 \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83 (\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \\> \\< \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83(\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \u4e0d\u53ef\u4ee5\u4f7f\u7528 # if then else\u7ed3\u6784\u6d4b\u8bd5\u65ad\u6389\u7684\u8fde\u63a5 #!/bin/bash # broken-link.sh # \u7531Lee bigelow\u6240\u5199<ligelowbee@yahoo.com> # \u4e00\u4e2a\u7528\u4e8e\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u5e76\u4e14\u8f93\u51fa\u5b83\u4eec\u7684\u94fe\u63a5\u6587\u4ef6\u7684\u7eafshell\u7684\u811a\u672c\u3002 # \u6240\u4ee5\u5b83\u4eec\u80fd\u628a\u8f93\u51fa\u63d0\u4f9b\u7ed9xargs\u5e76\u5904\u7406 :) # \u4f8b\u5982\uff1a broken-link.sh /somedir /someotherdir|xargs rm # \u4e0b\u9762\u662f\u66f4\u597d\u7684\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5: # find \"somedir\" -type l -print0|\\ # xargs -r0 file|\\ # grep \"broken symbolic\"| # sed -e 's/^\\|: *broken symbolic.*$/\"/g' # \u4f46\u8fd9\u4e0d\u662f\u7eafbash\u811a\u672c\uff0c\u4e0b\u9762\u7684\u5219\u662f. # \u6ce8\u610f: \u8c28\u9632\u5728/proc\u6587\u4ef6\u7cfb\u7edf\u548c\u6b7b\u5faa\u73af\u94fe\u63a5\u4e2d\u4f7f\u7528! # \u5982\u679c\u6ca1\u6709\u53c2\u6570\u88ab\u4f20\u9012\u7ed9\u811a\u672c\u4f5c\u4e3a\u641c\u7d22\u76ee\u5f55\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55 [[ $# -eq 0 ]] && directories = ` pwd ` || directories = $@ #Setup the function link_chk to check the directory it is passed #for files that are links and don't exist, then print them quoted. #If one of the elements in the directory is a subdirectory then #send that send that subdirectory to the link_check function. ######## link_chk () { for element in $1 /* ; do [[ -h \" $element \" -a ! -e \" $element \" ]] && echo \\\" $element \\\" [[ -d \" $element \" ]] && linkchk $element # Of course, '-h' tests for symbolic link, '-d' for directory. done } #Send each arg that was passed to the script to the link_chk function #if it is a valid directory. If not, then print the error message #and usage info. ############ for directory in $directories ; do if [[ -d $directories ]] then link_chk $directories else echo \" $directories is not a directory\" echo \"Usage: $0 dir1 dir2 ...\" fi done # [1] \u4e00\u5b9a\u8981\u610f\u8bc6\u5230suid\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u80fd\u5f15\u8d77\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u5e76\u4e14\u5728shell\u811a\u672c\u4e2dsuid\u6807\u5fd7\u5df2\u7ecf\u4e0d\u8d77\u4f5c\u7528\u4e86 # [2] \u5728\u73b0\u4ee3UNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7c98\u4f4f\u4f4d\u5df2\u7ecf\u4e0d\u5728\u6587\u4ef6\u4e2d\u518d\u4f7f\u7528\uff0c\u53ea\u7528\u5728\u76ee\u5f55\u4e2d","title":"if\u8bed\u53e5[ ] [[ ]]\u6bd4\u8f83"},{"location":"Shell/#then","text":"# then\u8bed\u53e5\u540e\u9762\u7684CONSEQUENT-COMMANDS\u5217\u8868\u53ef\u4ee5\u662f\u4efb\u4f55\u6709\u6548\u7684UNIX\u547d\u4ee4\uff0c\u4efb\u4f55\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4efb\u4f55\u53ef\u6267\u884cshell\u811a\u672c\u6216\u4efb\u4f55shell\u8bed\u53e5\uff0c\u4f46\u7ed3 # \u675ffi\u9664\u5916\u3002\u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0cthen\u548cfi\u88ab\u8ba4\u4e3a\u662fshell\u4e2d\u7684\u5206\u9694\u8bed\u53e5\u3002\u56e0\u6b64\uff0c\u5728\u547d\u4ee4\u884c\u4e0a\u53d1\u51fa\u65f6\uff0c\u5b83\u4eec\u7528\u5206\u53f7\u5206\u9694 #\u7b2c\u4e00\u4e2a\u793a\u4f8b\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728 #!/bin/bash echo \"This scripts checks the existence of the messages file.\" echo \"Checking...\" if [[ -f /var/log/messages ]] then echo \"/var/log/messages exists.\" fi echo echo \"...done.\" : << comment \u4e00\u4e2aif/then\u7ed3\u6784\u6d4b\u8bd5\u4e00\u5217\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u662f\u5426\u4e3a0\uff08\u56e0\u4e3a\u4f9d\u7167\u60ef\u4f8b\uff0c0\u610f\u5473\u7740\u547d\u4ee4\u6267\u884c\u6210\u529f\uff09\uff0c\u5982\u679c\u662f0\u5219\u4f1a\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u547d\u4ee4 \u6709\u4e00\u4e2a\u547d\u4ee4 [ (\u5de6\u65b9\u62ec\u662f\u7279\u6b8a\u5b57\u7b26). \u5b83\u548ctest\u662f\u540c\u4e49\u8bcd,\u56e0\u4e3a\u6548\u7387\u7684\u539f\u56e0\uff0c\u5b83\u88ab\u5185\u5efa\u5728shell\u91cc\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u53c2\u6570\u662f\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u8005 \u6587\u4ef6\u6d4b\u8bd5\uff0c\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\u6307\u793a\u6bd4\u8f83\u7684\u7ed3\u679c(0\u8868\u793a\u771f\uff0c1\u8868\u793a\u5047) comment #\u4e00\u4e2aif/then\u7ed3\u6784\u80fd\u5305\u542b\u5d4c\u5957\u7684\u6bd4\u8f83\u548c\u6d4b\u8bd5 if echo \"Next *if* is part of the comparison for the first *if*.\" if [[ $comparison = \"integer\" ]] then (( a < b )) else [[ $a < $b ]] fi then echo '$a is less than $b' fi # \u5f53if\u548cthen\u5728\u540c\u4e00\u884c\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5206\u53f7\uff08;\uff09\u5fc5\u987b\u7528\u5728if\u8bed\u53e5\u7684\u7ed3\u5c3e\u3002if\u548cthen\u90fd\u662f\u5173\u952e\u5b57.\u5173\u952e\u5b57\uff08\u6216\u547d\u4ee4\uff09\u5f00\u59cb\u4e00\u4e2a\u8bed\u53e5\uff0c\u5982\u679c\u5728\u540c # \u4e00\u884c\u5f00\u59cb\u53e6\u4e00\u4e2a\u65b0\u8bed\u53e5\u65f6\uff0c\u524d\u9762\u4e00\u4e2a\u8bed\u53e5\u5fc5\u987b\u7528\u5206\u53f7\uff08;\uff09\u7ed3\u675f if [ -x \" $filename \" ] ; then #\u7b49\u4ef7\u7684\u6d4b\u8bd5\u547d\u4ee4\uff1atest,/usr/bin/test,[]\u548c/usr/bin/[ #!/bin/bash if test -z \" $1 \" then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if /usr/bin/test -z \" $1 \" # \u548c\u5185\u5efa\u7684\"test\"\u547d\u4ee4\u4e00\u6837. then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if [ -z \" $1 \" ] # \u548c\u4e0a\u9762\u4ee3\u7801\u5757\u7684\u529f\u80fd\u4e00\u6837 then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi if /usr/bin/ [ -z \" $1 \" ] # \u540c\u6837\u548c\u4e0a\u9762\u7684\u4ee3\u7801\u5757\u4e00\u6837. # if /usr/bin/[ -z \"$1\" # \u5de5\u4f5c, \u4f46\u8fd8\u662f\u7ed9\u51fa\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f.\u6ce8\u610f:\u8fd9\u4e2a\u5df2\u7ecf\u5728bash 3.x\u7248\u672c\u88ab\u4fee\u8865\u597d\u4e86\u3002 then echo \"No command-line arguments.\" else echo \"First command-line argument is $1 .\" fi # \u5728[[\u548c]]\u4e4b\u95f4\u7684\u6240\u6709\u7684\u5b57\u7b26\u90fd\u4e0d\u4f1a\u88ab\u6587\u4ef6\u6269\u5c55\u6216\u662f\u6807\u8bb0\u5206\u5272\uff0c\u4f46\u662f\u4f1a\u6709\u53c2\u6570\u5f15\u7528\u548c\u547d\u4ee4\u66ff\u6362 file = /etc/passwd if [[ -e $file ]] then echo \"Password file exists.\" fi # \u7528[[ .. ]]\u6d4b\u8bd5\u7ed3\u6784\u6bd4\u7528[ .. ]\u66f4\u80fd\u9632\u6b62\u811a\u672c\u903b\u8f91\u9519\u8bef\u3002\u4f8b\u5982\uff1a&&,||,<\u548c>\u64cd\u4f5c\u7b26\u80fd\u5728\u4e00\u4e2a[[]]\u6d4b\u8bd5\u91cc\u901a\u8fc7\uff0c\u4f46\u5728[]\u7ed3\u6784\u4f1a\u53d1\u751f\u9519\u8bef # \u5728\u4e00\u4e2aif\u7684\u540e\u9762\uff0c\u4e0d\u5fc5\u4e00\u5b9a\u662ftest\u547d\u4ee4\u6216\u662ftest\u7ed3\u6784\uff08[]\u6216\u662f[[]]\uff09 dir = /home/bozo if cd \" $dir \" 2 >/dev/null ; then # \"2>/dev/null\"\u4f1a\u9690\u85cf\u9519\u8bef\u7684\u4fe1\u606f. echo \"Now in $dir .\" else echo \"Can't change to $dir .\" fi # \"if COMMAND\"\u7ed3\u6784\u4f1a\u8fd4\u56deCOMMAND\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801 # \u540c\u6837\u7684\uff0c\u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u53f7\u91cc\u9762\u7684\u6761\u4ef6\u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u7528\u5217\u8868\u7ed3\u6784(list construct)\u800c\u4e0d\u5fc5\u7528if\u3002 var1 = 20 var2 = 22 [ \" $var1 \" -ne \" $var2 \" ] && echo \" $var1 is not equal to $var2 \" home = /home/bozo [ -d \" $home \" ] || echo \" $home directory does not exist.\"","title":"then\u8bed\u53e5\u540e\u9762\u7684\u547d\u4ee4"},{"location":"Shell/#_2","text":"\u7b97\u672f\u8fd0\u7b97\u7b26 \u63cf\u8ff0 + - \u52a0\u6cd5 \u51cf\u6cd5(\u5e38\u7528) * / % \u4e58\u6cd5 \u9664\u6cd5 \u53d6\u6a21(\u5e38\u7528) ** \u5e42\u8fd0\u7b97(\u5e38\u7528) ++ -- \u81ea\u52a0 \u81ea\u51cf\uff0c\u53ef\u653e\u5728\u53d8\u91cf\u524d\u53d8\u91cf\u540e,\u53d8\u91cf\u4e4b\u524d\u8868\u793a\u5148\u81ea\u589e\u6216\u81ea\u51cf\u518d\u8d4b\u503c\u7ed9\u53d8\u91cf\uff0c\u4e4b\u540e\u8868\u793a\u5148\u8d4b\u503c\u518d\u81ea\u589e\u6216\u81ea\u51cf(\u5e38\u7528) ! && || \u903b\u8f91\u975e\uff08\u53d6\u53cd\uff09 \u903b\u8f91\u4e0e\uff08and\uff09 \u903b\u8f91\u6216\uff08or\uff09 (\u5e38\u7528) < <= > >= \u6bd4\u8f83\u7b26\u53f7 == != = \u6bd4\u8f83\u7b26\u53f7 << >> \u5411\u5de6\u4f4d\u79fb \u5411\u53f3\u4f4d\u79fb ~ & ^ = += -= *= /= %= \u8d4b\u503c\u8fd0\u7b97\u7b26 \u7b97\u672f\u8fd0\u7b97\u8868\u8fbe\u5f0f\u548c\u8fd0\u7b97\u547d\u4ee4 \u63cf\u8ff0 (()) \u6574\u6570\u8fd0\u7b97\u7684\u5e38\u7528\u64cd\u4f5c\u7b26 let \u7528\u4e8e\u6574\u6570\u8fd0\u7b97\u548c(())\u7c7b\u4f3c expr \u901a\u5e38\u7528\u4e8e\u6574\u6570\u8ba1\u7b97\u4e5f\u6709\u5176\u4ed6\u989d\u5916\u529f\u80fd bc \u9002\u5408\u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 $[] \u7528\u4e8e\u6574\u6570\u8fd0\u7b97 awk \u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 declare \u5b9a\u4e49\u53d8\u91cf\u503c\u548c\u5c5e\u6027,-i\u53c2\u6570\u7528\u4e8e\u5b9a\u4e49\u6574\u578b\u53d8\u91cf","title":"\u7b97\u672f\u8fd0\u7b97\u7b26"},{"location":"Shell/#_3","text":"# (( ))\u7ed3\u6784\u6269\u5c55\u5e76\u8ba1\u7b97\u4e00\u4e2a\u7b97\u672f\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u5982\u679c\u8868\u8fbe\u5f0f\u503c\u4e3a0\uff0c\u4f1a\u8fd4\u56de1\u6216\u5047\u4f5c\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u3002\u4e00\u4e2a\u975e\u96f6\u503c\u7684\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a0\u6216\u771f\u4f5c\u4e3a # \u9000\u51fa\u72b6\u6001\u7801\u3002\u8fd9\u4e2a\u7ed3\u6784\u548c\u5148\u524dtest\u547d\u4ee4\u53ca[]\u7ed3\u6784\u7684\u8ba8\u8bba\u521a\u597d\u76f8\u53cd #\u7528(( ))\u8fdb\u884c\u7b97\u672f\u6d4b\u8bd5 #!/bin/bash # \u7b97\u672f\u6d4b\u8bd5.(( ... ))\u7ed3\u6784\u4f1a\u6c42\u503c\u5e76\u6d4b\u8bd5\u8be5\u503c\u3002\u9000\u51fa\u72b6\u6001\u7801\u4e0e[ ... ]\u7ed3\u6784\u6b63\u597d\u76f8\u53cd!\u8fd4\u56de0\u4ee3\u8868\u771f\uff0c1\u4ee3\u8868\u5047 (( 0 )) ; echo \"Exit status of \\\"(( 0 ))\\\" is $? .\" # 1 (( 1 )) ; echo \"Exit status of \\\"(( 1 ))\\\" is $? .\" # 0 (( 5 > 4 )) ; echo \"Exit status of \\\"(( 5 > 4 ))\\\" is $? .\" # 0 (( 5 > 9 )) ; echo \"Exit status of \\\"(( 5 > 9 ))\\\" is $? .\" # 1 (( 5 - 5 )) ; echo \"Exit status of \\\"(( 5 - 5 ))\\\" is $? .\" # 1 (( 5 / 4 )) ; echo \"Exit status of \\\"(( 5 / 4 ))\\\" is $? .\" # 0 (( 1 / 2 )) ; echo \"Exit status of \\\"(( 1 / 2 ))\\\" is $? .\" # 1 (( 1 / 0 )) 2 > /dev/null ; echo \"Exit status of \\\"(( 1 / 0 ))\\\" is $? .\" # 1","title":"\u7b97\u672f\u6d4b\u8bd5"},{"location":"Shell/#_4","text":"\u4e8c\u5143\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6bd4\u8f83\u4e24\u4e2a\u53d8\u91cf\u6216\u662f\u6570\u503c\u3002\u6ce8\u610f\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83\u7684\u5206\u522b","title":"\u5176\u4ed6\u6bd4\u8f83\u64cd\u4f5c\u7b26"},{"location":"Shell/#_5","text":"\u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b -eq \u7b49\u4e8e if [ \" a\" -eq \" a\" -eq \" b\" ] -ne \u4e0d\u7b49\u4e8e if [ \" a\" -ne \" a\" -ne \" b\" ] -gt \u5927\u4e8e if [ \" a\" -gt \" a\" -gt \" b\" ] -ge \u5927\u4e8e\u7b49\u4e8e if [ \" a\" -ge \" a\" -ge \" b\" ] -lt \u5c0f\u4e8e if [ \" a\" -lt \" a\" -lt \" b\" ] -le \u5c0f\u4e8e\u7b49\u4e8e if [ \" a\" -le \" a\" -le \" b\" ] > \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u5185\u4f7f\u7528) ((\" a\" > \" a\" > \" b\")) >= \u5927\u4e8e\u7b49\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" >= \" a\" >= \" b\")) < \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" < \" a\" < \" b\")) <= \u5c0f\u4e8e\u7b49\u4e8e (\u5728\u53cc\u62ec\u53f7\u91cc\u4f7f\u7528) ((\" a\" <= \" a\" <= \" b\"))","title":"\u6574\u6570\u6bd4\u8f83"},{"location":"Shell/#_6","text":"\u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b = \u7b49\u4e8e if [ \" a\" = \" a\" = \" b\" ] == \u7b49\u4e8e\u2460 if [ \" a\" == \" a\" == \" b\" ] != \u4e0d\u7b49\u4e8e if [ \" a\" != \" a\" != \" b\" ] < \u5c0f\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \" a\" < \" a\" < \" b\" ]]\u6216if [ \" a\" \\< \" a\" \\< \" b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26< > \u5927\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \" a\" > \" a\" > \" b\" ]]\u6216if [ \" a\" \\> \" a\" \\> \" b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26> -z \u5b57\u7b26\u4e32\u4e3anull,\u5373\u6307\u5b9a\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a\u96f6 -n \u5b57\u7b26\u4e32\u4e0d\u4e3anull,\u5373\u957f\u5ea6\u4e0d\u4e3a\u96f6 -a \u903b\u8f91\u4e0e \u5982\u679cexp1\u548cexp2\u90fd\u4e3a\u771f\uff0c\u5219exp1 -a exp2\u8fd4\u56de\u771f -o \u903b\u8f91\u6216 \u53ea\u8981exp1\u548cexp2\u4efb\u4f55\u4e00\u4e2a\u4e3a\u771f\uff0c\u5219exp1 -o exp2\u8fd4\u56de\u771f \u2460\u533a\u522b\u89e3\u6790\uff1a * ==\u548c=\u540c\u4e49\u8bcd\uff0c\u4f46==\u6bd4\u8f83\u64cd\u4f5c\u7b26\u5728\u4e00\u4e2a\u53cc\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u548c\u4e00\u4e2a\u5355\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u610f\u601d\u4e0d\u540c * [[ a == z* ]] # \u5982\u679c\u53d8\u91cf a == z* ]] # \u5982\u679c\u53d8\u91cf a\u4ee5\u5b57\u7b26\"z\"\u5f00\u59cb(\u6a21\u5f0f\u5339\u914d)\u5219\u4e3a\u771f * [[ a == \"z*\" ]] # \u5982\u679c\u53d8\u91cf a == \"z*\" ]] # \u5982\u679c\u53d8\u91cf a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f * [ a == z* ] # \u6587\u4ef6\u6269\u5c55\u548c\u5355\u5143\u5206\u5272\u6709\u6548 * [ \" a == z* ] # \u6587\u4ef6\u6269\u5c55\u548c\u5355\u5143\u5206\u5272\u6709\u6548 * [ \" a\" == \"z*\" ] # \u5982\u679c\u53d8\u91cf$a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f \u6ce8\u610f\u4e8b\u9879\uff1a \u5728\u65b9\u62ec\u53f7\u6d4b\u8bd5\u91cc\uff0c\u8fdb\u884c-n\u6d4b\u8bd5\u65f6\u5fc5\u987b\u628a\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff0c-z\u4e00\u822c\u4e0d\u5f15\u8d77\u6765\u90fd\u80fd\u5de5\u4f5c\uff0c\u4f46\u6700\u597d\u628a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u62ec\u8d77\u6765\u3002\u5982\u679c$string \u53d8\u91cf\u4e3a\u7a7a\uff0c\u6b64\u5b57\u7b26\u4e32\u53d8\u91cf\u5f15\u8d77\u6765\u4f9d\u7136\u4f1a\u62a5\u9519\uff0c\u5b89\u5168\u7684\u65b9\u6cd5\u662f\u9644\u52a0\u4e00\u4e2a\u5916\u90e8\u5b57\u7b26\u4e32\u7ed9\u53ef\u80fd\u6709\u7a7a\u5b57\u7b26\u53d8\u91cf\u3002\u5982\uff1a [ \"x string\" != x -o \"x string\" != x -o \"x a\" = \"x$b\" ]\uff08x\u5b57\u7b26\u53ef\u4ee5\u4e92\u76f8\u62b5\u6d88\uff09","title":"\u5b57\u7b26\u4e32\u6bd4\u8f83"},{"location":"Shell/#_7","text":"# a\u548cb\u65e2\u80fd\u88ab\u770b\u6210\u662f\u6574\u6570\u4e5f\u80fd\u88ab\u770b\u7740\u662f\u5b57\u7b26\u4e32\u3002\u5728\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u4e4b\u95f4\u4e0d\u662f\u4e25\u683c\u754c\u5b9a\u7684\uff0cbash\u53d8\u91cf\u662f\u65e0\u7c7b\u578b\u7684\uff0cBash\u53d8\u91cf\u4e0d\u662f\u5f3a\u7c7b\u578b\u7684 # Bash\u5141\u8bb8\u53d8\u91cf\u7684\u6574\u6570\u64cd\u4f5c\u548c\u6bd4\u8f83\uff0c\u4f46\u8fd9\u4e9b\u53d8\u91cf\u5fc5\u987b\u53ea\u5305\u62ec\u6570\u5b57\u5b57\u7b26,\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5e94\u8be5\u5c0f\u5fc3\u8003\u8651\u3002\u4f8b\u5982\uff1a #!/bin/bash # \u6b64\u4f8b\u5b50\u4e2d-ne\u548c!=\u5747\u80fd\u5de5\u4f5c\uff0c\u4ee5\u4e0b\u662f\u5177\u4f53\u6bd4\u8f83 a = 4 b = 5 if [ \" $a \" -ne \" $b \" ] ; then echo \" $a\u4e0d\u7b49\u4e8e$b \" ; echo \"(\u6574\u6570\u6bd4\u8f83)\" ; fi # ab\u4f5c\u4e3a\u6574\u6570\u6bd4\u8f83 if [ \" $a \" ! = \" $b \" ] ; then echo \" $a\u4e0d\u7b49\u4e8e$b \" ; echo \"(\u5b57\u7b26\u4e32\u6bd4\u8f83)\" ; fi # ab\u4f5c\u4e3a\u5b57\u7b26\u4e32\u6bd4\u8f83 # \u6d4b\u8bd5\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u662fnull\u503c #!/bin/bash # \u7528if [ ... ]\u7ed3\u6784,\u6d4b\u8bd5null\u5b57\u7b26\u4e32\u548c\u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u7684\u5b57\u7b26\u4e32 # \u5982\u679c\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u5b83\u91cc\u9762\u7684\u503c\u672a\u5b9a\u4e49\u3002\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a\"null\"\u503c(\u4e0d\u540c\u4e8e\u96f6) # \u7b2c\u4e00\u6b21\uff0c$string1\u6ca1\u6709\u88ab\u58f0\u660e\u6216\u521d\u59cb\u5316 if [ -n $string1 ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u9519\u8bef\u7ed3\u679c. # Shows $string1 as not null, although it was not initialized. # \u7b2c\u4e8c\u6b21, $string1\u53d8\u91cf\u88ab\u5f15\u53f7\u5f15\u8d77 if [ -n \" $string1 \" ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u91cc\u7528\u5f15\u53f7\u5f15\u8d77\u53d8\u91cf! # \u7b2c\u4e09\u6b21,\u53d8\u91cf$string1\u4ec0\u4e48\u4e5f\u4e0d\u52a0 if [ $string1 ] then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u4ee5\u4e0a\u6b63\u5e38\u6267\u884c,[]\u6d4b\u8bd5\u8fd0\u7b97\u7b26\u5355\u72ec\u68c0\u6d4b\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a,\u4f46\u7528\u5f15\u53f7\u62ec\u8d77\u6765\"$string1\"\u624d\u662f\u66f4\u597d\u4e60\u60ef string1 = initialized if [ $string1 ] # Again, $string1 stands naked. then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # \u518d\u6b21\u663e\u793a\u6b63\u786e\u7ed3\u679c\uff0c\u7136\u800c\u66f4\u597d\u4ecd\u7136\u662f\u7528\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u4e14\u770b\u4ee5\u4e0b\u7684\u5217\u5b50 string1 = \"a = b\" if [ $string1 ] # \u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u6765 then echo \"String \\\"string1\\\" is not null.\" else echo \"String \\\"string1\\\" is null.\" fi # $string1\u6ca1\u6709\u5f15\u53f7\u663e\u793a\u51fa\u9519\u8bef\u7684\u7ed3\u679c #!/bin/bash # \u7528more\u547d\u4ee4\u67e5\u770b\u88ab\u538b\u7f29\u8fc7\u7684\u6587\u4ef6 NOARGS = 65 NOTFOUND = 66 NOTGZIP = 67 if [ $# -eq 0 ] # \u7b49\u540c\u4e8e: if [ -z \"$1\" ] # $1\u53ef\u4ee5\u5b58\u5728,\u4f46\u4e3a\u7a7a: zmore \"\" arg2 arg3 then echo \"Usage: `basename $0 ` filename\" > & 2 # \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef. exit $NOARGS # \u8fd4\u56de65\u4f5c\u4e3a\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001(\u9519\u8bef\u7801). fi filename = $1 if [ ! -f \" $filename \" ] # Quoting $filename allows for possible ces. then echo \"File $filename not found!\" > & 2 # \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef. exit $NOTFOUND fi if [ ${ filename ##*. } ! = \"gz\" ] # \u5728\u65b9\u62ec\u53f7\u91cc\u4f7f\u7528\u53d8\u91cf\u66ff\u6362. then echo \"File $1 is not a gzipped file!\" exit $NOTGZIP fi zcat $1 | more # \u7528\u8fc7\u6ee4\u7a0b\u5e8fmore,\u4e5f\u53ef\u4ee5\u7528less\u4ee3\u66ff exit $? # \u811a\u672c\u8fd4\u56de\u7ba1\u9053\u7684\u9000\u51fa\u72b6\u6001,\u5b9e\u9645\u4e0a\"exit $?\"\u662f\u591a\u4f59\u7684,\u56e0\u4e3a\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u4f1a\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u7801","title":"\u7b97\u672f\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83"},{"location":"Shell/#_8","text":"# -a \u903b\u8f91\u4e0e\u3001-o \u903b\u8f91\u6216\u64cd\u4f5c\u7b26\u548cBash\u4e2d\u7528\u4e8e\u53cc\u65b9\u62ec\u53f7\u7ed3\u6784\u7684\u6bd4\u8f83\u64cd\u4f5c\u7b26&&\u548c||\u5f88\u76f8\u4f3c # -o\u548c-a\u64cd\u4f5c\u7b26\u548ctest\u547d\u4ee4\u6216\u5355\u65b9\u62ec\u53f7\u4e00\u8d77\u4f7f\u7528 # \u68c0\u6d4b\u4f60\u5bf9\u6d4b\u8bd5\u547d\u4ee4\u638c\u63e1 # \u4e00\u4e2axinitrc\u7cfb\u7edf\u6587\u4ef6\u80fd\u7528\u6765\u542f\u52a8\u4e00\u4e2aX\u670d\u52a1\u5668\u3002\u8fd9\u4e2a\u6587\u4ef6\u5305\u542b\u4e86\u76f8\u5f53\u591a\u7684if/then\u6d4b\u8bd5\uff0c\u5c31\u50cf\u4e0b\u9762\u8fd9\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6458\u5f55\u5c55\u793a\u7684\u4e00\u6837 if [ -f $HOME /.Xclients ] ; then exec $HOME /.Xclients elif [ -f /etc/X11/xinit/Xclients ] ; then exec /etc/X11/xinit/Xclients else # \u5931\u8d25\u540e\u7684\u5b89\u5168\u8bbe\u7f6e\u3002\u867d\u7136\u6211\u4eec\u51b3\u4e0d\u8be5\u6267\u884c\u5230\u8fd9\u513f,(\u6211\u4eec\u4e5f\u5728X\u5ba2\u6237\u63d0\u4f9b\u53ef\u9760\u4fdd\u8bc1) \u5b83\u4e0d\u80fd\u88ab\u7834\u574f xclock -geometry 100x100-5+5 & xterm -geometry 80x50-50+150 & if [ -f /usr/bin/netscape -a -f /usr/share/doc/HTML/index.html ] ; then netscape /usr/share/doc/HTML/index.html & fi fi","title":"\u6df7\u5408\u6bd4\u8f83"},{"location":"Shell/#_9","text":"\u9664\u975e\u4e00\u4e2a\u6570\u5b57\u6709\u7279\u522b\u7684\u524d\u7f00\u6216\u7b26\u53f7\uff0c\u5426\u5219shell\u811a\u672c\u628a\u5b83\u5f53\u6210\u5341\u8fdb\u5236\u7684\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0\u7684\u6570\u5b57\u662f\u516b\u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0x\u7684\u6570\u5b57\u662f\u5341\u516d \u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u6570\u7528\u5185\u5d4c\u7684#\u6765\u6c42\u503c\u5219\u770b\u6210BASE#NUMBER(\u6709\u8303\u56f4\u548c\u7b26\u53f7\u9650\u5236)(\u8bd1\u8005\u6ce8\uff1aBASE#NUMBER\u5373\uff1a\u57fa\u6570#\u6570\u503c\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u4f8b\u5b50) #\u6570\u5b57\u5e38\u91cf\u7684\u8868\u793a\u6cd5 #!/bin/bash # numbers.sh: \u4e0d\u540c\u57fa\u6570\u7684\u6570\u5b57\u8868\u793a\u6cd5. # \u5341\u8fdb\u5236\u6570: \u5b83\u662f\u9ed8\u8ba4\u7684 let \"dec = 32\" ; echo \"decimal number = $dec \" # 32 # \u516b\u8fdb\u5236\u6570: \u4ee5'0'(\u96f6)\u4e3a\u524d\u7f00 let \"oct = 032\" ; echo \"octal number = $oct \" # 26,\u7ed3\u679c\u8868\u793a\u4e3a\u5341\u8fdb\u5236. # \u5341\u516d\u8fdb\u5236: \u4ee5'0x'\u6216'0X'\u4e3a\u524d\u7f00 let \"hex = 0x32\" ; echo \"hexadecimal number = $hex \" # 50,\u4ee5\u5341\u8fdb\u5236\u7684\u5f62\u5f0f\u8868\u793a. # \u5176\u4ed6\u7684\u8fdb\u5236\u7684\u8868\u793a\u5f62\u5f0f: BASE#NUMBER # BASE\u503c\u57282\u548c64\u4e4b\u95f4. # NUMBER\u5fc5\u987b\u4f7f\u7528\u5728BASE\u8303\u56f4\u5185\u7684\u7b26\u53f7,\u770b\u4e0b\u9762\u7684\u793a\u4f8b. let \"bin = 2#111100111001101\" ; echo \"binary number = $bin \" # 31181 let \"b32 = 32#77\" ; echo \"base-32 number = $b32 \" # 231 let \"b64 = 64#@_\" ; echo \"base-64 number = $b64 \" # 4031 # \u8fd9\u4e2a\u7b26\u53f7\u53ea\u80fd\u5de5\u4f5c\u5728ASCII\u7801\u503c\u4e3a2-64\u7684\u8303\u56f4\u9650\u5236. # 10\u4e2a\u6570\u5b57+26\u4e2a\u5c0f\u5199\u5b57\u6bcd+26\u4e2a\u5927\u5199\u5b57\u6bcd+ @ + _ echo $(( 36# zz )) $(( 2#10101010 )) $(( 16# AF16 )) $(( 53#1 aA )) # 1295 170 44822 3375 # \u63d0\u793a\uff1a\u4f7f\u7528\u4e00\u4e2a\u8d85\u51fa\u7ed9\u5b9a\u8fdb\u5236\u7684\u6570\u5b57\u5c06\u4f1a\u5f15\u8d77\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a let \"bad_oct = 081\" # \u6b64\u4f8b\u5b50\u4f1a\u53d1\u751f\u9519\u8bef\uff0c\u56e0\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\u53ea\u80fd\u4f7f\u7528\u6570\u5b570-7.","title":"\u6570\u5b57\u5e38\u91cf"},{"location":"Shell/#_10","text":"# function\u5173\u952e\u5b57\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u52a0\u6216\u4e0d\u52a0 \u65b9\u6cd5\u4e00\uff1a function echo_color (){ if [ $1 == \"green\" ] ; then echo -e \"\\033[32;40m $2 \\033[0m\" elif [ $1 == \"red\" 0 ] ; then echo -e \"\\\\033[31;40m $2 \\033[0m\" fi } \u65b9\u6cd5\u4e8c\uff1a function echo_color (){ case $1 in green ) echo -e \"\\033[32;40m $2 \\033[0m\" ;; red ) echo -e \"\\033[31;40m $2 \\033[0m\" ;; * ) echo \"Example:echo_color red string\" esac }","title":"\u5b9a\u4e49\u4e00\u4e2a\u989c\u8272\u8f93\u51fa\u5b57\u7b26\u4e32\u51fd\u6570"},{"location":"Shell/#_11","text":"#!/bin/bash DATE = $( date+%F_%T ) USER_FILE = user.txt echo_color (){ if [ $1 == \"green\" ] ; then echo -e \"\\033[32;40m $2 \\033[0m\" elif [ $1 == \"red\" 0 ] ; then echo -e \"\\\\033[31;40m $2 \\033[0m\" fi } # \u5982\u679c\u7528\u6237\u6587\u4ef6\u5b58\u5728\u5e76\u5927\u4e8e0\u5c31\u5907\u4efd if [ -s $USER_FILE ] ; then mv $USER_FILE ${ USER_FILE } - ${ DATE } .bak echo_color green \" $USER_FILE exist,rename ${ USER_FILE } - ${ DATE } .bak\" fi echo","title":"\u6279\u91cf\u521b\u5efa\u7528\u6237"},{"location":"Shell/#shellcpu","text":"","title":"shell\u91c7\u96c6\u7cfb\u7edfcpu \u5185\u5b58 \u78c1\u76d8 \u7f51\u7edc\u4fe1\u606f"},{"location":"Shell/#cpu","text":"# cpu\u4f7f\u7528\u7387\u91c7\u96c6\u7b97\u6cd5;\u901a\u8fc7/proc/stat\u6587\u4ef6\u91c7\u96c6\u5e76\u8ba1\u7b97CPU\u603b\u4f7f\u7528\u7387\u6216\u8005\u5355\u4e2a\u6838\u4f7f\u7528\u7387\u3002\u4ee5cpu0\u4e3a\u4f8b\uff0c\u7b97\u6cd5\u5982\u4e0b\uff1a : << comment cat /proc/stat | grep \u2018cpu0\u2019 # \u5f97\u5230cpu0\u7684\u4fe1\u606f cpuTotal1=user+nice+system+idle+iowait+irq+softirq cpuUsed1=user+nice+system+irq+softirq sleep 30\u79d2 # \u518d\u6b21cat /proc/stat | grep \u2018cpu0\u2019 \u5f97\u5230cpu\u7684\u4fe1\u606f cpuTotal2=user+nice+system+idle+iowait+irq+softirq cpuUsed2=user+nice+system+irq+softirq # \u5f97\u5230cpu0 \u572830\u79d2\u5185\u7684\u5355\u6838\u5229\u7528\u7387\uff1a(cpuUsed2 \u2013 cpuUsed1) * 100 / (cpuTotal2 \u2013 cpuTotal1) # \u76f8\u5f53\u4e8e\u4f7f\u7528top \u2013d 30\u547d\u4ee4\uff0c\u628auser\u3001nice\u3001system\u3001irq\u3001softirq\u4e94\u9879\u7684\u4f7f\u7528\u7387\u76f8\u52a0 comment a =( ` cat /proc/stat | grep -E \"cpu\\b\" | awk -v total = 0 \\ '{$1=\"\";for(i=2;i<=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }END{print total,used}' ` ) sleep 30 b =( ` cat /proc/stat | grep -E \"cpu\\b\" | awk -v total = 0 '{$1=\"\";for(i=2;i<=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }\\ END{print total,used}' ` ) cpu_usage =((( ${ b [1] } - ${ a [1] } ) *100 ) / ( ${ b [0] } - ${ a [0] } ))) # \u6b64\u5904\u8bed\u6cd5\u6709\u95ee\u9898\uff0c\u6682\u672a\u4fee\u590d # cpu\u8d1f\u8f7d\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/loadavg\u5f97\u5230\u673a\u5668\u76841/5/15\u5206\u949f\u5e73\u5747\u8d1f\u8f7d\uff0c\u518d\u4e58\u4ee5100 cpuload =( ` cat /proc/loadavg | awk '{print $1,$2,$3}' ` ) load1 = ${ cpuload [0] } load5 = ${ cpuload [1] } load15 = ${ cpuload [2] }","title":"cpu\u4fe1\u606f\u91c7\u96c6"},{"location":"Shell/#_12","text":"# \u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0c(MemTotal \u2013 MemFree \u2013 Buffers \u2013 Cached)/1024\u5f97\u5230\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u6570 awk '/MemTotal/{total=$2}/MemFree/{free=$2}/Buffers/{buffers=$2}/^Cached/{cached=$2}END\\ {print (total-free-buffers-cached)/1024}' /proc/meminfo # MEM\u4f7f\u7528\u91cf\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0cMemTotal \u2013 MemFree\u5f97\u5230MEM\u4f7f\u7528\u91cf awk '/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/1024}' /proc/meminfo # SWAP\u4f7f\u7528\u5927\u5c0f\u91c7\u96c6\u7b97\u6cd5\uff1a\u901a\u8fc7/proc/meminfo\u6587\u4ef6\uff0cSwapTotal \u2013 SwapFree\u5f97\u5230SWAP\u4f7f\u7528\u5927\u5c0f awk '/SwapTotal/{total=$2}/SwapFree/{free=$2}END{print (total-free)/1024}' /proc/meminfo","title":"\u5185\u5b58\u91c7\u96c6"},{"location":"Shell/#_13","text":"# \u78c1\u76d8I/O # IN\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u786c\u76d8\u8bfb\u5230\u7269\u7406\u5185\u5b58\u7684\u6570\u636e\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgin\u7684\u589e\u91cf\uff0c\u628apgpgin\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf # \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bi\u4e00\u5217\u7684\u8f93\u51fa a = ` awk '/pgpgin/{print $2}' /proc/vmstat ` #sleep 240 b = ` awk '/pgpgin/{print $2}' /proc/vmstat ` ioin = $(( b-a )/ 240 )) # OUT\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u7269\u7406\u5185\u5b58\u5199\u5230\u786c\u76d8\u7684\u6570\u636e\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgout\u7684\u589e\u91cf\uff0c\u628apgpgout\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf # \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bo\u4e00\u5217\u7684\u8f93\u51fa a = ` awk '/pgpgout/{print $2}' /proc/vmstat ` sleep 240 b = ` awk '/pgpgout/{print $2}' /proc/vmstat ` ioout = $(( ( b-a )/ 240 ))","title":"\u78c1\u76d8\u4fe1\u606f\u91c7\u96c6"},{"location":"Shell/#_14","text":"# \u6d41\u91cf:\u4ee5https://www.centos.bz/\u4e3a\u4f8b\uff0ceth0\u662f\u5185\u7f51\uff0ceth1\u5916\u7f51\uff0c\u83b7\u53d660\u79d2\u7684\u6d41\u91cf # \u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u6d41\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5b57\u8282\u6570\uff08KB\uff09\uff0c\u7136\u540e\u4e58\u4ee58\uff0c\u518d\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u6d41\u91cf traffic_be =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev ` ) sleep 60 traffic_af =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev ` ) eth0_in = $(( ( ${ traffic_af [0] } - ${ traffic_be [0] } )/ 60 )) eth0_out = $(( ( ${ traffic_af [1] } - ${ traffic_be [1] } )/ 60 )) eth1_in = $(( ( ${ traffic_af [2] } - ${ traffic_be [2] } )/ 60 )) eth1_out = $(( ( ${ traffic_af [3] } - ${ traffic_be [3] } )/ 60 )) # \u6570\u636e\u5305\u91cf\uff1a\u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u5305\u91cf # \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5305\u91cf\uff0c\u7136\u540e\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u5305\u91cf packet_be =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev ` ) sleep 60 packet_af =( ` awk -F '[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev ` ) eth0_in = $(( ( ${ packet_af [0] } - ${ packet_be [0] } )/ 60 )) eth0_out = $(( ( ${ packet_af [1] } - ${ packet_be [1] } )/ 60 )) eth1_in = $(( ( ${ packet_af [2] } - ${ packet_be [2] } )/ 60 )) eth1_out = $(( ( ${ packet_af [3] } - ${ packet_be [3] } )/ 60 ))","title":"\u7f51\u7edc\u4fe1\u606f\u91c7\u96c6"},{"location":"Squid/","text":"caching proxy \u00b6","title":"Squid"},{"location":"Squid/#caching-proxy","text":"","title":"caching proxy"},{"location":"Stunnel/","text":"proxy designed to add TLS encryption functionality \u00b6","title":"Stunnel"},{"location":"Stunnel/#proxy-designed-to-add-tls-encryption-functionality","text":"","title":"proxy designed to add TLS encryption functionality"},{"location":"Tomcat/","text":"Tomcat \u00b6 J2EE Tomcat\u5f00\u53d1\u73af\u5883\u914d\u7f6e \u00b6 1.\u4e0b\u8f7dtomcat,\u7f51\u5740\uff1a www.tomcat.apache.org \u9009\u62e9core\u4e2d\u7684.tar.gz\u6216\u8005.zip\u4e0b\u8f7d\u5373\u53ef 2.\u89e3\u538b\u5b89\u88c5\u5305\u3002\u8fdb\u5165\u5b89\u88c5\u5305\u6240\u5728\u8def\u5f84 \u89e3\u538b\u5b89\u88c5\u5305\uff1a 3.\u89e3\u538b\u5b8c\u6210\u4e4b\u540e\uff0c\u5c06\u6587\u4ef6\u5939\u79fb\u52a8\u5230\u4f60\u7684\u76ee\u6807\u4f4d\u7f6e 4.\u8fdb\u5165tomcat\u6587\u4ef6\u5939\u4e0b\u7684bin\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230 5.\u4f7f\u7528gedit\u6253\u5f00startup.sh\u6587\u4ef6\uff0c\u5728esac\u90a3\u884c\u540e\u9762\u6dfb\u52a0JAVA_HOME\u7b49\u4fe1\u606f\uff0c\u5176\u4e2d\uff1a JAVA_HOME:\u5b83\u6307\u5411jdk\u7684\u5b89\u88c5\u76ee\u5f55\uff0cEclipse/NetBeans/Tomcat\u7b49\u8f6f\u4ef6\u5c31\u662f\u901a\u8fc7\u641c\u7d22JAVA_HOME\u53d8\u91cf\u6765\u627e\u5230\u5e76\u4f7f\u7528\u5b89\u88c5\u597d\u7684jdk\u3002 JRE_HOME\uff1a\u5b83\u6307\u5411jre\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u901a\u5e38\u60c5\u51b5\u4e0bjdk\u8def\u5f84\u4e0b\u90fd\u4f1a\u6709jre PATH\uff1a\u6240\u6709\u7684\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u90fd\u5728\u8fd9\u91cc CLASSPATH\uff1a\u4f5c\u7528\u662f\u6307\u5b9a\u7c7b\u641c\u7d22\u8def\u5f84\uff0c\u8981\u4f7f\u7528\u5df2\u7ecf\u7f16\u5199\u597d\u7684\u7c7b\uff0c\u524d\u63d0\u5f53\u7136\u662f\u80fd\u591f\u627e\u5230\u5b83\u4eec\u4e86\uff0cJVM\u5c31\u662f\u901a\u8fc7CLASSPTH\u6765\u5bfb\u627e\u7c7b\u7684\u3002\u6211\u4eec\u9700\u8981\u628ajdk\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684lib\u5b50\u76ee\u5f55\u4e2d\u7684dt.jar\u548ctools.jar\u8bbe\u7f6e\u5230CLASSPATH\u4e2d\uff0c\u5f53\u7136\uff0c\u5f53\u524d\u76ee\u5f55\u201c.\u201d\u4e5f\u5fc5\u987b\u52a0\u5165\u5230\u8be5\u53d8\u91cf\u4e2d\u3002 TOMCAT_HOME\uff1atomcat\u7684\u5b89\u88c5\u76ee\u5f55 6.\u901a\u8fc7bin\u76ee\u5f55\u4e0b\u7684startup\u6216\u8005shutdown\u5b8c\u6210 \u5176\u4ed6\u76f8\u5173\u6536\u96c6 \u00b6 WildFly","title":"Tomcat"},{"location":"Tomcat/#tomcat","text":"","title":"Tomcat"},{"location":"Tomcat/#j2ee-tomcat","text":"1.\u4e0b\u8f7dtomcat,\u7f51\u5740\uff1a www.tomcat.apache.org \u9009\u62e9core\u4e2d\u7684.tar.gz\u6216\u8005.zip\u4e0b\u8f7d\u5373\u53ef 2.\u89e3\u538b\u5b89\u88c5\u5305\u3002\u8fdb\u5165\u5b89\u88c5\u5305\u6240\u5728\u8def\u5f84 \u89e3\u538b\u5b89\u88c5\u5305\uff1a 3.\u89e3\u538b\u5b8c\u6210\u4e4b\u540e\uff0c\u5c06\u6587\u4ef6\u5939\u79fb\u52a8\u5230\u4f60\u7684\u76ee\u6807\u4f4d\u7f6e 4.\u8fdb\u5165tomcat\u6587\u4ef6\u5939\u4e0b\u7684bin\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230 5.\u4f7f\u7528gedit\u6253\u5f00startup.sh\u6587\u4ef6\uff0c\u5728esac\u90a3\u884c\u540e\u9762\u6dfb\u52a0JAVA_HOME\u7b49\u4fe1\u606f\uff0c\u5176\u4e2d\uff1a JAVA_HOME:\u5b83\u6307\u5411jdk\u7684\u5b89\u88c5\u76ee\u5f55\uff0cEclipse/NetBeans/Tomcat\u7b49\u8f6f\u4ef6\u5c31\u662f\u901a\u8fc7\u641c\u7d22JAVA_HOME\u53d8\u91cf\u6765\u627e\u5230\u5e76\u4f7f\u7528\u5b89\u88c5\u597d\u7684jdk\u3002 JRE_HOME\uff1a\u5b83\u6307\u5411jre\u7684\u5b89\u88c5\u8def\u5f84\uff0c\u901a\u5e38\u60c5\u51b5\u4e0bjdk\u8def\u5f84\u4e0b\u90fd\u4f1a\u6709jre PATH\uff1a\u6240\u6709\u7684\u7cfb\u7edf\u73af\u5883\u53d8\u91cf\u90fd\u5728\u8fd9\u91cc CLASSPATH\uff1a\u4f5c\u7528\u662f\u6307\u5b9a\u7c7b\u641c\u7d22\u8def\u5f84\uff0c\u8981\u4f7f\u7528\u5df2\u7ecf\u7f16\u5199\u597d\u7684\u7c7b\uff0c\u524d\u63d0\u5f53\u7136\u662f\u80fd\u591f\u627e\u5230\u5b83\u4eec\u4e86\uff0cJVM\u5c31\u662f\u901a\u8fc7CLASSPTH\u6765\u5bfb\u627e\u7c7b\u7684\u3002\u6211\u4eec\u9700\u8981\u628ajdk\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684lib\u5b50\u76ee\u5f55\u4e2d\u7684dt.jar\u548ctools.jar\u8bbe\u7f6e\u5230CLASSPATH\u4e2d\uff0c\u5f53\u7136\uff0c\u5f53\u524d\u76ee\u5f55\u201c.\u201d\u4e5f\u5fc5\u987b\u52a0\u5165\u5230\u8be5\u53d8\u91cf\u4e2d\u3002 TOMCAT_HOME\uff1atomcat\u7684\u5b89\u88c5\u76ee\u5f55 6.\u901a\u8fc7bin\u76ee\u5f55\u4e0b\u7684startup\u6216\u8005shutdown\u5b8c\u6210","title":"J2EE Tomcat\u5f00\u53d1\u73af\u5883\u914d\u7f6e"},{"location":"Tomcat/#_1","text":"WildFly","title":"\u5176\u4ed6\u76f8\u5173\u6536\u96c6"},{"location":"TrafficServer/","text":"","title":"ApacheTraffic"},{"location":"Utilities/","text":"Iproute2&Net-tools \u00b6 NET-TOOLS VS IPROUTE\u5bf9\u7167 NET-TOOLS COMMANDS IPROUTE COMMANDS arp -a ip neigh arp -v ip -s neigh arp -s 192.168.1.1 1:2:3:4:5:6 ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev eth1 arp -i eth1 -d 192.168.1.1 ip neigh del 192.168.1.1 dev eth1 ifconfig -a ip addr ifconfig eth0 down ip link set eth0 down ifconfig eth0 up ip link set eth0 up ifconfig eth0 192.168.1.1 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 netmask 255.255.255.0 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 mtu 9000 ip link set eth0 mtu 9000 ifconfig eth0:0 192.168.1.2 ip addr add 192.168.1.2/24 dev eth0 netstat ss netstat -neopa ss -neopa netstat -g ip maddr route ip route route add -net 192.168.1.0 netmask 255.255.255.0 dev eth0 ip route add 192.168.1.0/24 dev eth0 route add default gw 192.168.1.1 ip route add default via 192.168.1.1 Iproute2 \u00b6 \u9009\u578b \u00b6 ip [ OPTIONS ] OBJECT { COMMAND | help } ip [ -force ] - batch filename where OBJECT : = { link | address | addrlabel | route | rule | neigh | ntable | tunnel | tuntap | maddress | mroute | mrule | monitor | xfrm | netns | l2tp | fou | macsec | tcp_metrics | token | netconf | ila } OPTIONS : = { - V [ ersion ] | - s [ tatistics ] | - d [ etails ] | - r [ esolve ] | - h [ uman-readable ] | - iec | - f [ amily ] { inet | inet6 | ipx | dnet | mpls | bridge | link } | - 4 | - 6 | - I | - D | - B | - 0 | - l [ oops ] { maximum - addr - flush - attempts } | - br [ ief ] | - o [ neline ] | - t [ imestamp ] | - ts [ hort ] | - b [ atch ] [ filename ] | - rc [ vbuf ] [ size ] | - n [ etns ] name | - a [ ll ] | ? - c [ olor ] } - s \uff1a \u8f93\u51fa\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f - f \uff1a \u5f3a\u5236\u4f7f\u7528\u6307\u5b9a\u7684\u534f\u8bae\u65cf - 4 \uff1a \u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv4\u534f\u8bae - 6 \uff1a \u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv6\u534f\u8bae - 0 \uff1a \u8f93\u51fa\u4fe1\u606f\u6bcf\u6761\u8bb0\u5f55\u8f93\u51fa\u4e00\u884c \uff0c \u5373\u4f7f\u5185\u5bb9\u8f83\u591a\u4e5f\u4e0d\u6362\u884c\u663e\u793a - r \uff1a \u663e\u793a\u4e3b\u673a\u65f6 \uff0c \u4e0d\u4f7f\u7528IP\u5730\u5740 \uff0c \u800c\u4f7f\u7528\u4e3b\u673a\u7684\u57df\u540d OBJECT # \u7f51\u7edc\u5bf9\u8c61 link # \u6307\u7f51\u7edc\u8bbe\u5907\uff0c\u901a\u8fc7\u6b64\u5bf9\u8c61\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u53ca\u66f4\u6539\u7f51\u7edc\u8bbe\u5907\u7684\u5c5e\u6027\u3002 addr # \u5730\u5740\u7ba1\u7406 neigh # arp\u8868\u7ba1\u7406 route # \u8def\u7531\u7ba1\u7406 rule # \u8def\u7531\u7b56\u7565 maddr # \u591a\u5740\u5e7f\u64ad\u5730\u5740 mroute # \u591a\u64ad\u8def\u7531\u7f13\u5b58\u7ba1\u7406 tunnel # \u901a\u9053\u7ba1\u7406 ip link # \u663e\u793a\u94fe\u8def\u4fe1\u606f ip link show dev eth0 # \u663e\u793aeth0\u63a5\u53e3\u94fe\u8def\u4fe1\u606f # \u663e\u793a\u8def\u7531ip route [\u7c7b\u4f3croute -n] ip route | column -t ip route del 192 .168.0.0/24 dev eth1 ip route add 192 .168.0.0/24 dev eth1 ip route del via 10 .2.255.254 # \u5220\u9664\u9ed8\u8ba4\u8def\u7531 ip route add via 10 .2.255.254 # \u589e\u52a0\u9ed8\u8ba4\u8def\u7531 ip route add 192 .168.1.0/24 via 192 .168.0.1 # \u589e\u52a0\u9759\u6001\u8def\u7531\uff0c192.168.0.1\u4e3a\u4e0b\u4e00\u8df3\u5730\u5740 ip route del 192 .168.1.0/24 via 192 .168.0.1 # \u5220\u9664\u9759\u6001\u8def\u7531 \u663e\u793aarp\u4fe1\u606fip neigh [ \u53ef\u4ee5\u53d6\u4ee3arp -n ] \u5220\u9664\u5219\u662fip neigh del IP\u5730\u5740 dev \u8bbe\u5907\u540d \u8def\u7531\u7b56\u7565\u6570\u636e\u5e93:\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u5927\u89c4\u6a21\u7684\u8def\u7531\u5668\uff0c\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u5bf9\u4e8e\u8def\u7531\u7684\u4e0d\u901a\u9700\u6c42\uff0c\u8def\u7531\u7b56\u7565\u6570\u636e\u5e93\u53ef\u4ee5\u5e2e\u4f60\u901a\u8fc7\u591a\u8def\u7531\u8868\u6280\u672f\u6765\u5b9e\u73b0\u3002\u5f53\u5185\u6838\u9700\u8981\u505a\u51fa\u8def\u7531\u9009\u62e9\u65f6\uff0c\u5b83\u4f1a\u627e\u51fa\u5e94\u8be5\u53c2\u8003\u54ea\u4e00\u5f20\u8def\u7531\u8868\u3002\u9664\u4e86ip\u5916,route\u4e5f\u53ef\u4ee5\u4fee\u6539main\u548clocal\u8868\u3002 \u9ed8\u8ba4\u89c4\u5219 # ip rule \u4e0a\u9762\u5217\u51fa\u4e86\u89c4\u5219\u7684\u4f18\u5148\u987a\u5e8f\u3002ip route\u547d\u4ee4\u9ed8\u8ba4\u663e\u793a\u7684\u5c31\u662fmain\u8868\u3002ip route show table all\u663e\u793a\u6240\u6709\u89c4\u5219\u4e2d\u7684\u8868 # ip route list table local broadcast 192 .168.0.255 dev eth0 proto kernel scope link src 192 .168.0.10 broadcast 10 .2.0.0 dev eth1 proto kernel scope link src 10 .2.0.217 broadcast 127 .255.255.255 dev lo proto kernel scope link src 127 .0.0.1 ... ... default\u8868\u4e3a\u7a7a \u4f8b \u7b80\u5355\u7b56\u7565\u8def\u7531\u6dfb\u52a0 [ \u5f15\u7528\u81eaLinux\u9ad8\u7ea7\u8def\u7531\u4e2d\u6587HOWTO ] \u8ba9\u6211\u4eec\u518d\u6765\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50\u3002\u6211\u6709\u4e24\u4e2aCable Modem\uff0c\u8fde\u63a5\u5230\u4e86\u4e00\u4e2a Linux\u7684NAT ( \u201c\u4f2a\u88c5\u201d ) \u8def\u7531\u5668\u4e0a\u3002\u8fd9\u91cc\u7684\u5ba4\u53cb\u4eec\u5411\u6211\u4ed8\u8d39\u4f7f\u7528Internet\u3002\u5047\u5982\u6211\u5176\u4e2d\u7684\u4e00\u4e2a\u5ba4\u53cb\u56e0\u4e3a\u53ea\u60f3\u8bbf\u95ee hotmail \u800c\u5e0c\u671b\u5c11\u4ed8\u4e00\u4e9b\u94b1\u3002\u5bf9\u6211\u6765\u8bf4\u8fd9\u6ca1\u6709\u95ee\u9898,\u4ed6\u4eec\u80af\u5b9a\u53ea\u80fd\u4f7f\u7528\u90a3\u4e2a\u6bd4\u8f83\u6b21\u7684Cable Modem\u3002 \u90a3\u4e2a\u6bd4\u8f83\u5feb\u7684cable modem \u7684IP\u5730\u5740\u662f 212 .64.94.251\uff0cPPP \u94fe\u8def\uff0c\u5bf9\u7aefIP\u662f212.64.94.1\u3002\u800c\u90a3\u4e2a\u6bd4\u8f83\u6162\u7684cable modem\u7684IP\u5730\u5740\u662f212.64.78.148\uff0c\u5bf9\u7aef\u662f195.96.98.253\u3002 local \u8868\uff1a #ip route list table local \u67e5\u770b\u201cmain\u201d\u8def\u7531\u8868\uff1a #ip route list table main \u6211\u4eec\u73b0\u5728\u4e3a\u6211\u4eec\u7684\u670b\u53cb\u521b\u5efa\u4e86\u4e00\u4e2a\u53eb\u505a\u201cJohn\u201d\u7684\u89c4\u5219\u3002\u5176\u5b9e\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u7eaf\u6570\u5b57\u8868\u793a\u89c4\u5219\uff0c\u4f46\u662f\u4e0d\u65b9\u4fbf\u3002\u6211\u4eec\u53ef\u4ee5\u5411/etc/iproute2/rt_tables\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6570\u5b57\u4e0e\u540d\u5b57\u7684\u5173\u8054\uff1a # echo 200 John >> /etc/iproute2/rt_tables # ip rule add from 10.0.0.10 table John # ip rule \u73b0\u5728\uff0c\u5269\u4e0b\u7684\u4e8b\u60c5\u5c31\u662f\u4e3a John \u7684\u8def\u7531\u8868\u521b\u5efa\u8def\u7531\u9879\u4e86\u3002\u522b\u5fd8\u4e86\u5237\u65b0\u8def\u7531\u7f13\u5b58\uff1a # ip route add default via 195.96.98.253 dev ppp2 table John # ip route flush cache \u603b\u7ed3\u4e3b\u8981\u662f\u4ee5\u4e0b\u51e0\u6b65\uff1a echo 200 John >> /etc/iproute2/rt_tables #\u65b9\u4fbf\u8868\u793a\uff0c\u628a\u89c4\u5219\u540d\u5b57\u548c\u6570\u5b57\u5bf9\u5e94\u52a0\u5165\u5230/etc/iproute2/rt_tables\u6587\u4ef6 ip rule add from 10 .0.0.10 table John #\u65b0\u589e\u89c4\u5219 ip route add default via 195 .96.98.253 dev ppp2 table John #\u89c4\u5219\u4e2d\u6dfb\u52a0\u8def\u7531\u8868 ip route flush cache #\u5237\u65b0\u8def\u7531\u8868 iproute2 ip \u5e38\u7528\u547d\u4ee4\u5907\u5fd8 1 .\u663e\u793aip\u5730\u5740 ip a ip address show ip addr show dev eth0 ip a sh eth0 2 .\u589e\u52a0\u5220\u9664\u5730\u5740 ip address add 192 .0.2.1/24 dev eth0 ip addr del 192 .0.2.2/24 dev eth0 3 .\u663e\u793a\u63a5\u53e3\u7edf\u8ba1 ip -s link ls eth0 \u7f51\u5361\u548c\u94fe\u8def\u914d\u7f6e 4 .\u663e\u793a\u94fe\u8def ip link show ip link sh eth0 4 .\u4fee\u6539\u63a5\u53e3\u72b6\u6001 ip link set eth0 up ip link s gre01 down \u8def\u7531\u8868\u7ba1\u7406 5 .\u663e\u793a\u8def\u7531\u8868 ip route ip ro show dev gre01 6 .\u589e\u52a0\u65b0\u8def\u7531 ip route add 10 .2.2.128/27 dev gre01 7 .\u589e\u52a0\u9ed8\u8ba4\u8def\u7531 ip route add default via 192 .168.1.1 8 .\u4fee\u6539\u9ed8\u8ba4\u8def\u7531 ip route chg default via 192 .168.1.2 9 .\u5220\u9664\u9ed8\u8ba4\u8def\u7531 ip route del default \u96a7\u9053\u914d\u7f6e 10 .\u589e\u52a0\u5220\u9664GRE\u96a7\u9053 ip tunnel add gre01 mode gre local 10 .1.1.1 remote 20 .2.2.1 ttl 255 ip tunnel del gre01 11 .IPIP\u96a7\u9053 ip tunl a ipip01 mode ipip local 10 .1.1.1 remote 20 .2.2.1 ttl 255 12 .\u663e\u793a\u96a7\u9053 ip tunnel show 13 .\u663e\u793a\u96a7\u9053\u7edf\u8ba1 ip -s tunl ls gre01 \u90bb\u5c45\u548carp\u8868\u7ba1\u7406 13 .\u67e5\u770barp\u8868 ip neigh show 14 .\u624b\u5de5\u589e\u52a0\u5220\u9664arp\u9879 ip neighbor add 10 .2.2.2 dev eth0 ip neigh del 10 .2.2.1 dev eth0 socket\u7edf\u8ba1 15 .\u663e\u793a\u5f53\u524d\u76d1\u542c ss -l 16 .\u663e\u793a\u5f53\u524d\u76d1\u542c\u7684\u8fdb\u7a0b ss -p \u5730\u5740\u7ba1\u7406 \u5728\u672c\u8282\u4e2d\uff0c$ {address}\u503c\u5e94\u8be5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u683c\u5f0f\u7684\u4e3b\u673a\u5730\u5740\uff0c$ {mask}\u53ef\u4ee5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u6216\u524d\u7f00\u957f\u5ea6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.10/24\u548c192.0.2.10/255.255.255.0\u540c\u6837\u53ef\u4ee5\u63a5\u53d7\u3002 \u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u67d0\u4e9b\u4e1c\u897f\u662f\u5426\u4e3a\u6b63\u786e\u7684\u4e3b\u673a\u5730\u5740\uff0c\u8bf7\u4f7f\u7528ipcalc\u6216\u7c7b\u4f3c\u7a0b\u5e8f\u8fdb\u884c\u68c0\u67e5\u3002 \u663e\u793a\u6240\u6709\u5730\u5740 ip\u5730\u5740\u663e\u793a \u6240\u6709show\u547d\u4ee4\u90fd\u53ef\u4ee5\u4e0e-4\u6216-6\u9009\u9879\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u4ec5\u663e\u793aIPv4\u6216IPv6\u5730\u5740\u3002 \u663e\u793a\u5355\u4e2a\u754c\u9762\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u663e\u793aeth0 \u4ec5\u663e\u793a\u6b63\u5728\u8fd0\u884c\u7684\u63a5\u53e3\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a \u4ec5\u663e\u793a\u9759\u6001\u6216\u52a8\u6001IPv6\u5730\u5740 \u4ec5\u663e\u793a\u9759\u6001\u914d\u7f6e\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}]\u6c38\u4e45 \u4ec5\u663e\u793a\u901a\u8fc7\u81ea\u52a8\u914d\u7f6e\u5b66\u4e60\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}] dynamic \u5411\u63a5\u53e3\u6dfb\u52a0\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} \u4f8b\u5b50\uff1a ip address add 192.0.2.10/27 dev eth0 ip address add 2001\uff1adb8\uff1a1 :: / 48 dev tun10 \u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u5730\u5740\u3002 \u5982\u679c\u60a8\u6dfb\u52a0\u591a\u4e2a\u5730\u5740\uff0c\u5219\u60a8\u7684\u673a\u5668\u5c06\u63a5\u53d7\u6240\u6709\u6570\u636e\u5305\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u60a8\u6dfb\u52a0\u7684\u7b2c\u4e00\u4e2a\u5730\u5740\u5c06\u7528\u4f5c\u4f20\u51fa\u6d41\u91cf\u7684\u6e90\u5730\u5740\uff0c\u5b83\u88ab\u79f0\u4e3a\u4e3b\u5730\u5740\u3002 \u60a8\u8bbe\u7f6e\u7684\u6240\u6709\u5176\u4ed6\u5730\u5740\u90fd\u5c06\u6210\u4e3a\u6b21\u8981\u5730\u5740\u3002 \u6dfb\u52a0\u5177\u6709\u4eba\u7c7b\u53ef\u8bfb\u63cf\u8ff0\u7684\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} label $ {interface name}\uff1a$ {description} \u4f8b\u5b50\uff1a ip address add 192.0.2.1/24 dev eth0 label eth0\uff1aWANaddress \u7531\u4e8e\u4e00\u4e9b\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u6807\u7b7e\u5fc5\u987b\u4ee5\u63a5\u53e3\u540d\u79f0\u5f00\u5934\uff0c\u540e\u8ddf\u5192\u53f7\uff0c\u5426\u5219\u4f1a\u51fa\u9519\u3002 \u4fdd\u6301\u6807\u7b7e\u77ed\u4e8e\u5341\u516d\u4e2a\u5b57\u7b26\uff0c\u5426\u5219\u4f60\u4f1a\u5f97\u5230\u8fd9\u4e2a\u9519\u8bef\uff1a RTNETLINK\u56de\u7b54\uff1a\u6570\u5b57\u7ed3\u679c\u8d85\u51fa\u8303\u56f4 \u7b14\u8bb0 \u5bf9\u4e8eIPv6\u5730\u5740\uff0c\u6b64\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\uff08\u5c06\u6dfb\u52a0\u5730\u5740\uff0c\u4f46\u6ca1\u6709\u6807\u7b7e\uff09\u3002 \u5220\u9664\u5730\u5740 ip address delete $ {address} / $ {prefix} dev $ {interface name} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5220\u9664192.0.2.1/24 dev eth0 ip address delete 2001\uff1adb8 :: 1/64 dev tun1 \u63a5\u53e3\u540d\u79f0\u662f\u5fc5\u9700\u7684\u3002Linux\u786e\u5b9e\u5141\u8bb8\u5728\u591a\u4e2a\u63a5\u53e3\u4e0a\u914d\u7f6e\u76f8\u540c\u7684\u5730\u5740\uff0c\u5e76\u4e14\u5b83\u5177\u6709\u6709\u6548\u7684\u7528\u4f8b\u3002 \u4ece\u63a5\u53e3\u4e2d\u5220\u9664\u6240\u6709\u5730\u5740 IP\u5730\u5740\u5237\u65b0\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5237\u65b0dev eth1 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u547d\u4ee4\u5220\u9664IPv4\u548cIPv6\u5730\u5740\u3002\u5982\u679c\u60a8\u53ea\u60f3\u79fb\u9664IPv4\u6216IPv6\u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u201cip-4\u5730\u5740\u5237\u65b0\u201d\u6216\u201cip-6\u5730\u5740\u5237\u65b0\u201d\u3002 \u7b14\u8bb0 \u65e0\u6cd5\u4ea4\u6362\u4e3b\u5730\u5740\u548c\u8f85\u52a9\u5730\u5740\uff0c\u4e5f\u65e0\u6cd5\u663e\u5f0f\u8bbe\u7f6e\u65b0\u7684\u4e3b\u5730\u5740\u3002\u5c1d\u8bd5\u59cb\u7ec8\u9996\u5148\u8bbe\u7f6e\u4e3b\u5730\u5740\u3002 \u4f46\u662f\uff0c\u5982\u679csysctl\u53d8\u91cfnet.ipv4.conf\u3002$ {interface} .promote_secondaries\u8bbe\u7f6e\u4e3a1\uff0c\u90a3\u4e48\u5f53\u60a8\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u7b2c\u4e00\u4e2a\u8f85\u52a9\u5730\u5740\u5c06\u6210\u4e3a\u65b0\u7684\u4e3b\u5730\u5740\u3002 \u8bf7\u6ce8\u610f\uff0cnet.ipv4.conf.default.promote_secondaries = 1 \u4e0d\u662f\u6240\u6709Linux\u53d1\u884c\u7248\u4e2d\u7684\u901a\u7528\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u56e0\u6b64\u8bf7\u5728\u5c1d\u8bd5\u4e4b\u524d\u68c0\u67e5\u60a8\u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5b83\u8bbe\u7f6e\u4e3a0\uff0c\u90a3\u4e48\u5f53\u4f60\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u6240\u6709\u7684\u5730\u5740\u90fd\u5c06\u4ece\u63a5\u53e3\u4e2d\u5220\u9664\u3002 \u5982\u679c\u4e3b\u5730\u5740\u88ab\u5220\u9664\uff0c\u5219\u8f85\u52a9IPv6\u5730\u5740\u603b\u662f\u88ab\u63d0\u5347\u4e3a\u4e3b\u5730\u5740\uff0c\u56e0\u6b64\u60a8\u4e0d\u5fc5\u62c5\u5fc3sysctl\u8bbe\u7f6e\u3002 \u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u7ba1\u7406 \u5bf9\u4e8e\u559c\u6b22\u82f1\u56fd\u62fc\u5199\u7684\u5973\u58eb\u4eec\uff0c\u5148\u751f\u4eec\uff0c\u8fd9\u4e2a\u6307\u6325\u5bb6\u5ead\u4e5f\u652f\u6301\u201c\u90bb\u5c45\u201d\u62fc\u5199\u3002 \u67e5\u770b\u90bb\u5c45\u8868 IP\u90bb\u5c45\u79c0 \u6240\u6709\u201cshow\u201d\u547d\u4ee4\u90fd\u652f\u6301-4\u548c-6\u9009\u9879\uff0c\u4ee5\u4ec5\u67e5\u770bIPv4\uff08ARP\uff09\u6216IPv6\uff08NDP\uff09\u90bb\u5c45\u3002\u9ed8\u8ba4\u663e\u793a\u6240\u6709\u7684\u90bb\u5c45\u3002 \u67e5\u770b\u5355\u4e2a\u754c\u9762\u7684\u90bb\u5c45 ip neighbor show dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor show dev eth0 \u5237\u65b0\u63a5\u53e3\u7684\u8868\u683c ip neighbor flush dev $ {interface name} \u4f8b\u5b50\uff1a IP\u90bb\u5c45\u5237\u65b0\u5f00\u53d1eth1 \u6dfb\u52a0\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip neighbor add $ {\u7f51\u7edc\u5730\u5740} lladdr $ {link layer address} dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor add 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5176\u4e2d\u4e00\u4e2a\u7528\u4f8b\u662f\u4e3a\u5177\u6709\u7981\u7528ARP\u7684\u63a5\u53e3\u6dfb\u52a0\u9759\u6001\u6761\u76ee\uff0c\u4ee5\u9650\u5236\u5177\u6709\u7279\u5b9aMAC\u5730\u5740\u7684\u4e3b\u673a\u7684\u63a5\u53e3\u4f7f\u7528\u60c5\u51b5\u3002 \u5220\u9664\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip\u90bb\u5c45\u5220\u9664$ {\u7f51\u7edc\u5730\u5740} lladdr $ {\u94fe\u63a5\u5c42\u5730\u5740}\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip neighbor delete 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5141\u8bb8\u5220\u9664\u9759\u6001\u6761\u76ee\uff0c\u6216\u8005\u5728\u4e0d\u5237\u65b0\u8868\u683c\u7684\u60c5\u51b5\u4e0b\u6446\u8131\u81ea\u52a8\u5b66\u4e60\u7684\u6761\u76ee\u3002 \u94fe\u63a5\u7ba1\u7406 \u94fe\u63a5\u662f\u7f51\u7edc\u754c\u9762\u7684\u53e6\u4e00\u4e2a\u672f\u8bed\u3002\u6765\u81ea\u201cip link\u201d\u7cfb\u5217\u7684\u547d\u4ee4\u6267\u884c\u6240\u6709\u63a5\u53e3\u7c7b\u578b\u901a\u7528\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u67e5\u770b\u94fe\u63a5\u4fe1\u606f\u6216\u66f4\u6539MTU\u3002 \u4ece\u5386\u53f2\u4e0a\u770b\uff0c\u201cip link\u201d\u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u9664\u96a7\u9053\uff08IPIP\uff0cGRE\u7b49\uff09\uff0cL2TPv3\u548cVXLAN\u63a5\u53e3\uff08\u5b83\u4eec\u5404\u81ea\u5177\u6709\u547d\u4ee4\uff09\u4e4b\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\u3002\u5728\u8f83\u65b0\u7684iproute2\u7248\u672c\u4e2d\uff08\u81f3\u5c113.16\uff09\uff0c\u5b83\u4eec\u53ef\u4ee5\u521b\u5efa\u9664L2TPv3\u4ee5\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\uff0c\u5c3d\u7ba1\u4f7f\u7528\u7279\u6b8a\u547d\u4ee4\u7cfb\u5217\u5bf9\u5176\u4e2d\u7684\u4e00\u4e9b\u66f4\u52a0\u65b9\u4fbf\u3002 \u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528\u201cip link add\u201d\u548c\u201cip link set\u201d\u547d\u4ee4\u7684\u201cname $ {name}\u201d\u53c2\u6570\u8bbe\u7f6e\u7684\u63a5\u53e3\u540d\u79f0\u53ef\u80fd\u662f\u4efb\u610f\u7684\uff0c\u751a\u81f3\u53ef\u80fd\u5305\u542bunicode\u5b57\u7b26\u3002\u4f46\u662f\uff0c\u6700\u597d\u575a\u6301\u4f7f\u7528ASCII\uff0c\u56e0\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u5904\u7406unicode\u3002 \u53e6\u8bf7\u6ce8\u610f\uff0c\u5176\u4ed6\u7a0b\u5e8f\uff08\u5982iptables\uff09\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u94fe\u63a5\u540d\u79f0\u683c\u5f0f\u548c\u957f\u5ea6\u9650\u5236\uff0c\u6240\u4ee5\u6700\u597d\u4f7f\u7528\u77ed\u7684\u5b57\u6bcd\u6570\u5b57\u540d\u79f0\uff0c\u5e76\u5728\u94fe\u63a5\u522b\u540d\u4e2d\u63d0\u4f9b\u5176\u4ed6\u4fe1\u606f \u3002 \u663e\u793a\u6709\u5173\u6240\u6709\u94fe\u63a5\u7684\u4fe1\u606f IP\u94fe\u63a5\u663e\u793a IP\u94fe\u63a5\u5217\u8868 \u8fd9\u4e9b\u547d\u4ee4\u662f\u7b49\u4ef7\u7684\uff0c\u53ef\u4ee5\u7528\u4e8e\u76f8\u540c\u7684\u53c2\u6570\u3002 \u663e\u793a\u6709\u5173\u7279\u5b9a\u94fe\u63a5\u7684\u4fe1\u606f ip link show dev $ {interface name} \u4f8b\u5b50\uff1a ip link show dev eth0 ip link show dev tun10 \u5355\u8bcd\u201cdev\u201d\u53ef\u4ee5\u7701\u7565\u3002 \u4e0a\u4e0b\u94fe\u63a5 ip link set dev $ {interface name} up ip link set dev $ {interface name} down \u4f8b\u5b50\uff1a ip link set dev eth0 down ip\u94fe\u8def\u8bbe\u7f6edev br0 up \u6ce8\u610f\uff1a\u4e0b\u9762\u63cf\u8ff0\u7684\u865a\u62df\u94fe\u8def\uff0c\u5982VLAN\u548c\u7f51\u6865\u5728\u521b\u5efa\u540e\u7acb\u5373\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u4f60\u9700\u8981\u63d0\u9192\u4ed6\u4eec\u5f00\u59cb\u4f7f\u7528\u5b83\u4eec\u3002 \u8bbe\u7f6e\u4eba\u7c7b\u53ef\u8bfb\u7684\u94fe\u63a5\u63cf\u8ff0 ip link set dev $ {interface name}\u522b\u540d\u201c$ {description}\u201d \u4f8b\u5b50\uff1a ip link set dev eth0\u522b\u540d\u201cLAN\u63a5\u53e3\u201d \u94fe\u63a5\u522b\u540d\u663e\u793a\u5728\u201cip link show\u201d\u8f93\u51fa\u4e2d\uff0c\u5982\uff1a 2\uff1aeth0\uff1a mtu 1500 qdisc mq\u72b6\u6001UP\u6a21\u5f0fDEFAULT qlen 1000 link / ether 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f brd ff\uff1aff\uff1aff\uff1aff\uff1aff\uff1aff \u522b\u540dLAN\u63a5\u53e3 \u91cd\u547d\u540d\u4e00\u4e2a\u63a5\u53e3 ip link set dev $ {old interface name} name $ {new interface name} \u4f8b\u5b50\uff1a ip link set dev eth0 name lan \u8bf7\u6ce8\u610f\uff0c\u60a8\u4e0d\u80fd\u91cd\u547d\u540d\u6d3b\u52a8\u754c\u9762\u3002\u5728\u505a\u4e4b\u524d\u4f60\u9700\u8981\u628a\u5b83\u653e\u4e0b\u3002 \u66f4\u6539\u94fe\u8def\u5c42\u5730\u5740\uff08\u901a\u5e38\u662fMAC\u5730\u5740\uff09 ip link set dev $ {interface name} address $ {address} \u94fe\u8def\u5c42\u5730\u5740\u662f\u4e00\u4e2a\u76f8\u5f53\u5e7f\u6cdb\u7684\u6982\u5ff5\u3002\u6700\u7740\u540d\u7684\u4f8b\u5b50\u662f\u4ee5\u592a\u7f51\u8bbe\u5907\u7684MAC\u5730\u5740\u3002\u8981\u6539\u53d8MAC\u5730\u5740\uff0c\u4f60\u9700\u8981\u8fd9\u6837\u7684\u4e1c\u897f\uff1a ip link set dev eth0 address 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f \u66f4\u6539\u94fe\u63a5MTU ip link set dev $ {interface name} mtu $ {MTU value} \u4f8b\u5b50\uff1a ip link set dev tun0 mtu 1480 MTU\u4ee3\u8868\u201c\u6700\u5927\u4f20\u8f93\u5355\u4f4d\u201d\uff0c\u5373\u63a5\u53e3\u4e00\u6b21\u53ef\u4ee5\u4f20\u8f93\u7684\u6700\u5927\u5e27\u6570\u3002 \u9664\u4e86\u50cf\u4e0a\u9762\u4f8b\u5b50\u90a3\u6837\u51cf\u5c11\u96a7\u9053\u4e2d\u7684\u5206\u6bb5\u4e4b\u5916\uff0c\u8fd9\u4e5f\u7528\u4e8e\u63d0\u9ad8\u652f\u6301\u6240\u8c13\u7684\u201c\u5de8\u578b\u5e27\u201d\uff08\u6700\u591a9000\u4e2a\u5b57\u8282\u7684\u5e27\uff09\u7684\u5343\u5146\u4ee5\u592a\u7f51\u94fe\u8def\u7684\u6027\u80fd\u3002\u5982\u679c\u4f60\u6240\u6709\u7684\u8bbe\u5907\u90fd\u652f\u6301\u5343\u5146\u4ee5\u592a\u7f51\uff0c\u4f60\u53ef\u80fd\u60f3\u8981\u505a\u7c7b\u4f3c\u7684\u4e8b\u60c5 ip link set dev eth0 mtu 9000 \u8bf7\u6ce8\u610f\uff0c\u60a8\u53ef\u80fd\u8fd8\u9700\u8981\u5728L2\u4ea4\u6362\u673a\u4e0a\u914d\u7f6e\u5b83\uff0c\u5176\u4e2d\u4e00\u4e9b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5df2\u5c06\u5176\u7981\u7528\u3002 \u5220\u9664\u94fe\u63a5 ip link delete dev $ {interface name} \u663e\u7136\uff0c\u53ea\u80fd\u5220\u9664\u50cfVLAN\u6216\u7f51\u6865\u8fd9\u6837\u7684\u865a\u62df\u94fe\u8def\u3002 \u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u7ec4\u64ad\u5173\u95ed \u9664\u975e\u4f60\u771f\u7684\u660e\u767d\u4f60\u5728\u505a\u4ec0\u4e48\uff0c\u6700\u597d\u4e0d\u8981\u78b0\u8fd9\u4e2a\u3002 \u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528ARP ip link\u8bbe\u7f6e$ {interface name} arp ip link\u8bbe\u7f6e$ {interface name} arp off \u4eba\u4eec\u53ef\u80fd\u5e0c\u671b\u7981\u7528ARP\u6765\u5f3a\u5236\u6267\u884c\u5b89\u5168\u7b56\u7565\uff0c\u5e76\u53ea\u5141\u8bb8\u7279\u5b9a\u7684MAC\u4e0e\u63a5\u53e3\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u767d\u540d\u5355MAC\u7684\u90bb\u5c45\u8868\u6761\u76ee\u5e94\u624b\u52a8\u521b\u5efa\uff08\u8bf7\u53c2\u89c1\u90bb\u5c45\u8868\u7ba1\u7406 \u90e8\u5206\uff09\uff0c\u5426\u5219\u4ec0\u4e48\u90fd\u4e0d\u80fd\u4e0e\u8be5\u63a5\u53e3\u901a\u4fe1\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u5728\u63a5\u5165\u5c42\u4ea4\u6362\u673a\u4e0a\u914d\u7f6eMAC\u7b56\u7565\u3002\u9664\u975e\u4f60\u786e\u5b9a\u4f60\u8981\u505a\u4ec0\u4e48\u4ee5\u53ca\u4e3a\u4ec0\u4e48\uff0c\u5426\u5219\u4e0d\u8981\u6539\u53d8\u8fd9\u4e2a\u6807\u5fd7\u3002 \u521b\u5efa\u4e00\u4e2aVLAN\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {VLAN\u63a5\u53e3\u540d\u79f0}\u94fe\u63a5$ {\u7236\u63a5\u53e3\u540d\u79f0}\u952e\u5165vlan id $ {tag} \u4f8b\u5b50\uff1a ip link add name eth0.110 link eth0 type vlan id 110 Linux\u652f\u6301\u7684\u552f\u4e00VLAN\u7c7b\u578b\u662fIEEE 802.1q VLAN\uff0c\u4e0d\u652f\u6301ISL\u7b49\u4f20\u7edf\u5b9e\u73b0\u3002 \u4e00\u65e6\u521b\u5efa\u4e86\u4e00\u4e2aVLAN\u63a5\u53e3\uff0c\u6240\u6709\u7531$ {parent interface}\u63a5\u6536\u7684id\u9009\u9879\u4e2d\u6307\u5b9a\u7684$ {tag}\u6807\u8bb0\u7684\u5e27\u5c06\u7531\u8be5VLAN\u63a5\u53e3\u5904\u7406\u3002 eth0.100\u540d\u79f0\u683c\u5f0f\u662f\u4f20\u7edf\u7684\uff0c\u4f46\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u547d\u540d\u8be5\u63a5\u53e3\uff0c\u5c31\u50cf\u4f7f\u7528\u5176\u4ed6\u63a5\u53e3\u7c7b\u578b\u4e00\u6837\u3002 VLAN\u53ef\u4ee5\u901a\u8fc7\u7f51\u6865\uff0c\u7ed1\u5b9a\u548c\u5176\u4ed6\u80fd\u591f\u5904\u7406\u4ee5\u592a\u7f51\u5e27\u7684\u63a5\u53e3\u6765\u521b\u5efa\u3002 \u521b\u5efaQinQ\u63a5\u53e3\uff08VLAN\u5806\u53e0\uff09 ip link add name $ {service interface} link $ {physical interface} type vlan proto 802.1ad id $ {service tag} ip link add name $ {client interface} link $ {service interface}\u8f93\u5165vlan proto 802.1q id $ {client tag} \u4f8b\uff1a ip link add name eth0.100 link eth0 type vlan proto 802.1ad id 100\uff03\u521b\u5efa\u670d\u52a1\u6807\u7b7e\u63a5\u53e3 ip link add name eth0.100.200 link eth0.100 type vlan proto 802.1q id 200\uff03\u521b\u5efa\u5ba2\u6237\u7aef\u6807\u7b7e\u63a5\u53e3 VLAN\u5806\u53e0\uff08\u53c8\u540d802.1ad QinQ\uff09\u662f\u4e00\u79cd\u5728\u53e6\u4e00\u4e2aVLAN\u4e0a\u4f20\u8f93\u5e26VLAN\u6807\u8bb0\u7684\u6d41\u91cf\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u7528\u4f8b\u5982\u4e0b\u6240\u793a\uff1a\u5047\u8bbe\u60a8\u662f\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u5e76\u4e14\u60a8\u6709\u4e00\u4f4d\u5ba2\u6237\u60f3\u8981\u4f7f\u7528\u60a8\u7684\u7f51\u7edc\u57fa\u7840\u67b6\u6784\u5c06\u5176\u7f51\u7edc\u7684\u90e8\u5206\u8fde\u63a5\u5230\u5f7c\u6b64\u3002\u4ed6\u4eec\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528\u591a\u4e2aVLAN\uff0c\u56e0\u6b64\u666e\u901a\u7684\u79df\u7528VLAN\u4e0d\u662f\u4e00\u79cd\u9009\u62e9\u3002\u901a\u8fc7\u4f7f\u7528QinQ\uff0c\u60a8\u53ef\u4ee5\u5728\u5ba2\u6237\u6d41\u91cf\u8fdb\u5165\u7f51\u7edc\u65f6\u6dfb\u52a0\u7b2c\u4e8c\u4e2a\u6807\u7b7e\uff0c\u5e76\u5728\u9000\u51fa\u65f6\u5220\u9664\u8be5\u6807\u7b7e\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u51b2\u7a81\uff0c\u60a8\u4e0d\u9700\u8981\u6d6a\u8d39VLAN\u7f16\u53f7\u3002 \u670d\u52a1\u6807\u7b7e\u662f\u63d0\u4f9b\u5546\u7528\u6765\u901a\u8fc7\u7f51\u7edc\u627f\u8f7d\u5ba2\u6237\u7aef\u6d41\u91cf\u7684VLAN\u6807\u7b7e\u3002\u5ba2\u6237\u6807\u7b7e\u662f\u5ba2\u6237\u8bbe\u5b9a\u7684\u6807\u7b7e\u3002 \u8bf7\u6ce8\u610f\uff0c\u5ba2\u6237\u7aefVLAN\u63a5\u53e3\u7684\u94fe\u8defMTU\u4e0d\u4f1a\u81ea\u52a8\u8c03\u6574\uff0c\u60a8\u9700\u8981\u4eb2\u81ea\u5904\u7406\uff0c\u5e76\u5c06\u5ba2\u6237\u7aef\u63a5\u53e3MTU\u51cf\u5c11\u81f3\u5c114\u4e2a\u5b57\u8282\uff0c\u6216\u76f8\u5e94\u5730\u589e\u52a0\u7236\u6bcdMTU\u3002 \u7b26\u5408\u6807\u51c6\u7684QinQ\u81eaLinux 3.10\u8d77\u53ef\u7528\u3002 \u521b\u5efa\u4f2a\u4ee5\u592a\u7f51\uff08aka macvlan\uff09\u63a5\u53e3 ip link add name $ {macvlan interface name} link $ {parent interface}\u952e\u5165macvlan \u4f8b\u5b50\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0peth0\u94fe\u63a5eth0\u7c7b\u578bmacvlan \u60a8\u53ef\u4ee5\u5c06macvlan\u63a5\u53e3\u89c6\u4e3a\u7236\u63a5\u53e3\u4e0a\u7684\u9644\u52a0\u865a\u62dfMAC\u5730\u5740\u3002\u4ece\u7528\u6237\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u4eec\u770b\u8d77\u6765\u50cf\u666e\u901a\u7684\u4ee5\u592a\u7f51\u63a5\u53e3\uff0c\u5e76\u5904\u7406\u6240\u6709\u901a\u4fe1\u7684MAC\u5730\u5740\uff0c\u8fd9\u4e9bMAC\u5730\u5740\u662f\u901a\u8fc7\u5176\u7236\u63a5\u53e3\u5206\u914d\u7684\u3002 \u8fd9\u901a\u5e38\u7528\u4e8e\u6d4b\u8bd5\uff0c\u6216\u8005\u5f53\u53ea\u6709\u4e00\u4e2a\u7269\u7406\u63a5\u53e3\u53ef\u7528\u65f6\uff0c\u4f7f\u7528\u7531MAC\u6807\u8bc6\u7684\u591a\u4e2a\u670d\u52a1\u5b9e\u4f8b\u3002 \u5b83\u4eec\u4e5f\u53ef\u4ee5\u7528\u4e8eIP\u5730\u5740\u5206\u9694\uff0c\u800c\u4e0d\u662f\u5c06\u591a\u4e2a\u5730\u5740\u5206\u914d\u7ed9\u76f8\u540c\u7684\u7269\u7406\u63a5\u53e3\uff0c\u7279\u522b\u662f\u5982\u679c\u67d0\u4e9b\u670d\u52a1\u65e0\u6cd5\u6b63\u786e\u64cd\u4f5c\u8f85\u52a9\u5730\u5740\u3002 \u521b\u5efa\u4e00\u4e2a\u865a\u62df\u63a5\u53e3 ip link add name $ {dummy interface name} type dummy \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0dummy0\u7c7b\u578b\u865a\u62df Dummy\u63a5\u53e3\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0eLoopback\u63a5\u53e3\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u9700\u8981\u5c3d\u53ef\u80fd\u591a\u7684\u63a5\u53e3\u5373\u53ef\u3002 \u5b83\u4eec\u7684\u7b2c\u4e00\u4e2a\u76ee\u7684\u662f\u5728\u4e3b\u673a\u5185\u90e8\u8fdb\u884c\u7a0b\u5e8f\u7684\u901a\u4fe1\u3002 \u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\u5229\u7528\u4ed6\u4eec\u603b\u662f\u8d77\u6765\u7684\u4e8b\u5b9e\uff08\u9664\u975e\u5728\u884c\u653f\u4e0a\u88ab\u5265\u593a\uff09\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5728\u5177\u6709\u591a\u4e2a\u7269\u7406\u63a5\u53e3\u7684\u8def\u7531\u5668\u4e0a\u4e3a\u5b83\u4eec\u5206\u914d\u670d\u52a1\u5730\u5740\u3002\u53ea\u8981\u5206\u914d\u7ed9\u56de\u9001\u6216\u4f2a\u63a5\u53e3\u7684\u5730\u5740\u7684\u6d41\u91cf\u8def\u7531\u5230\u62e5\u6709\u5b83\u7684\u673a\u5668\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u7684\u4efb\u4f55\u63a5\u53e3\u8bbf\u95ee\u5b83\u3002 \u521b\u5efa\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u6865\u540d\u79f0}\u7c7b\u578b\u6865 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0br0\u7c7b\u578b\u6865 \u7f51\u6865\u63a5\u53e3\u662f\u865a\u62df\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u3002\u5b83\u4eec\u53ef\u4ee5\u7528\u4e8e\u5728\u4ee5\u592a\u7f51\u63a5\u53e3\u4e4b\u95f4\u900f\u660e\u5730\u4e2d\u7ee7\u6d41\u91cf\uff0c\u5e76\u4e14\u8d8a\u6765\u8d8a\u666e\u904d\u5730\u7528\u4f5c\u8fd0\u884c\u5728\u7ba1\u7406\u7a0b\u5e8f\u5185\u90e8\u7684\u865a\u62df\u673a\u7684\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u3002 \u60a8\u53ef\u4ee5\u5c06\u4e00\u4e2aIP\u5730\u5740\u5206\u914d\u7ed9\u4e00\u4e2a\u7f51\u6865\uff0c\u5e76\u4e14\u5b83\u5c06\u4ece\u6240\u6709\u7f51\u6865\u7aef\u53e3\u53ef\u89c1\u3002 \u5982\u679c\u6b64\u547d\u4ee4\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u52a0\u8f7d\u4e86\u201c\u7f51\u6865\u201d\u6a21\u5757\u3002 \u6dfb\u52a0\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 ip link set dev $ {interface name} master $ {bridge name} \u4f8b\u5b50\uff1a ip link set dev eth0 master br0 \u60a8\u6dfb\u52a0\u5230\u7f51\u6865\u7684\u63a5\u53e3\u5c06\u6210\u4e3a\u865a\u62df\u4ea4\u6362\u673a\u7aef\u53e3\u3002\u5b83\u4ec5\u5728\u6570\u636e\u94fe\u8def\u5c42\u4e0a\u8fd0\u884c\u5e76\u505c\u6b62\u6240\u6709\u7f51\u7edc\u5c42\u7684\u64cd\u4f5c\u3002 \u4ece\u6865\u4e0a\u5220\u9664\u63a5\u53e3 ip link set dev $ {interface name} nomaster \u4f8b\u5b50\uff1a ip link set dev eth0 nomaster \u521b\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u754c\u9762 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u540d\u79f0}\u952e\u5165\u503a\u5238 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0bond1\u7c7b\u578b\u7684\u503a\u5238 \u6ce8\u610f\uff1a\u8fd9\u4e0d\u8db3\u4ee5\u4ee5\u4efb\u4f55\u6709\u610f\u4e49\u7684\u65b9\u5f0f\u914d\u7f6e\u7ed1\u5b9a\uff08\u94fe\u63a5\u805a\u5408\uff09\u3002\u60a8\u9700\u8981\u6839\u636e\u60a8\u7684\u60c5\u51b5\u8bbe\u7f6e\u7c98\u5408\u53c2\u6570\u3002\u8fd9\u8fdc\u8fdc\u8d85\u51fa\u4e86\u5907\u5fd8\u5355\u8303\u56f4\uff0c\u56e0\u6b64\u8bf7\u67e5\u9605\u6587\u6863\u3002 \u63a5\u53e3\u4ee5\u4e0e\u6865\u63a5\u7ec4\u76f8\u540c\u7684\u65b9\u5f0f\u6dfb\u52a0\u5230\u7ed1\u5b9a\u7ec4\uff0c\u8bf7\u6ce8\u610f\uff0c\u9664\u975e\u60a8\u5c06\u5176\u5173\u95ed\uff0c\u5426\u5219\u65e0\u6cd5\u6dfb\u52a0\u5b83\u3002 \u521b\u5efa\u4e00\u4e2a\u4e2d\u95f4\u529f\u80fd\u5757\u63a5\u53e3 ip link add $ {interface name}\u952e\u5165ifb \u4f8b\uff1a ip\u94fe\u63a5\u6dfb\u52a0ifb10\u7c7b\u578bifb \u4e2d\u95f4\u529f\u80fd\u5757\u8bbe\u5907\u4e0etc\u4e00\u8d77\u7528\u4e8e\u6d41\u91cf\u91cd\u5b9a\u5411\u548c\u955c\u50cf\u3002\u8fd9\u4e5f\u8d85\u51fa\u4e86\u672c\u6587\u6863\u7684\u8303\u56f4\uff0c\u8bf7\u53c2\u9605tc\u6587\u6863\u3002 \u521b\u5efa\u4e00\u5bf9\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907 \u865a\u62df\u4ee5\u592a\u7f51\uff08veth\uff09\u8bbe\u5907\u603b\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u5e76\u4e14\u4f5c\u4e3a\u53cc\u5411\u7ba1\u9053\u5de5\u4f5c\uff0c\u4e0d\u7ba1\u8fdb\u5165\u5176\u4e2d\u7684\u54ea\u4e00\u4e2a\uff0c\u90fd\u4f1a\u4ece\u53e6\u4e00\u4e2a\u7ba1\u9053\u51fa\u6765\u3002\u5b83\u4eec\u4e0e\u7cfb\u7edf\u5206\u533a\u529f\u80fd\uff08\u5982\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u548c\u5bb9\u5668\uff08OpenVZ\u548cLXC\uff09\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u4e00\u4e2a\u5206\u533a\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u5206\u533a\u3002 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u7b2c\u4e00\u4e2a\u8bbe\u5907\u540d\u79f0}\u7c7b\u578bveth peer name $ {\u7b2c\u4e8c\u4e2a\u8bbe\u5907\u540d\u79f0} \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth-host\u7c7b\u578bveth\u5bf9\u7b49\u540d\u79f0veth-guest \u6ce8\u610f\uff1a\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907\u662f\u5728UP\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u4e0d\u9700\u8981\u5728\u521b\u5efa\u540e\u624b\u52a8\u542f\u52a8\u5b83\u4eec\u3002 \u94fe\u63a5\u7ec4\u7ba1\u7406 \u94fe\u63a5\u7ec4\u4e0e\u7ba1\u7406\u578b\u4ea4\u6362\u673a\u4e2d\u7684\u7aef\u53e3\u8303\u56f4\u7c7b\u4f3c\u3002\u60a8\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u6dfb\u52a0\u5230\u7f16\u53f7\u7ec4\uff0c\u5e76\u7acb\u5373\u5728\u8be5\u7ec4\u7684\u6240\u6709\u63a5\u53e3\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 \u672a\u5206\u914d\u7ed9\u4efb\u4f55\u7ec4\u7684\u94fe\u63a5\u5c5e\u4e8e\u7ec40\uff0c\u4e5f\u79f0\u4e3a\u201c\u9ed8\u8ba4\u201d\u3002 \u5c06\u754c\u9762\u6dfb\u52a0\u5230\u7ec4 ip link set dev $ {interface name} group $ {group number} \u4f8b\u5b50\uff1a ip link set dev eth0 group 42 ip link set dev eth1 group 42 \u4ece\u7ec4\u4e2d\u5220\u9664\u4e00\u4e2a\u63a5\u53e3 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176\u5206\u914d\u7ed9\u9ed8\u8ba4\u7ec4\u6765\u5b8c\u6210\u3002 ip link set dev $ {interface name} group 0 ip link set dev $ {interface}\u7ec4\u9ed8\u8ba4\u503c \u4f8b\u5b50\uff1a ip link set dev tun10 group 0 \u4e3a\u7ec4\u5206\u914d\u4e00\u4e2a\u7b26\u53f7\u540d\u79f0 \u7ec4\u540d\u5b58\u50a8\u5728/ etc / iproute2 / group\u6587\u4ef6\u4e2d\u3002\u7ec40\u7684\u7b26\u53f7\u540d\u79f0\u201cdefault\u201d\u6070\u597d\u6765\u81ea\u90a3\u91cc\u3002\u60a8\u53ef\u4ee5\u6309\u7167\u76f8\u540c\u7684\u201c$ {number} $ {name}\u201d\u683c\u5f0f\u6dfb\u52a0\u60a8\u81ea\u5df1\u7684\uff0c\u6bcf\u884c\u4e00\u4e2a\u3002\u60a8\u6700\u591a\u53ef\u4ee5\u6709255\u4e2a\u547d\u540d\u7ec4\u3002 \u4e00\u65e6\u914d\u7f6e\u4e86\u7ec4\u540d\uff0c\u5728ip\u547d\u4ee4\u4e2d\u53ef\u4ee5\u4ea4\u6362\u4f7f\u7528\u6570\u5b57\u548c\u540d\u79f0\u3002 \u4f8b\uff1a echo\u201c10 customer-vlans\u201d>> / etc / iproute2 / group \u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u6240\u6709\u64cd\u4f5c\u4e2d\u4f7f\u7528\u8be5\u540d\u79f0\uff0c\u4f8b\u5982 ip link set dev eth0.100 group customer-vlans \u5bf9\u7ec4\u6267\u884c\u64cd\u4f5c ip link set group $ {group number} $ {operation and arguments} \u4f8b\u5b50\uff1a IP\u94fe\u8def\u8bbe\u7f6e\u7ec442\u5411\u4e0b ip\u94fe\u8def\u8bbe\u7f6e\u7ec4\u4e0a\u884c\u94fe\u8defmtu 1200 \u67e5\u770b\u6765\u81ea\u7279\u5b9a\u7ec4\u7684\u94fe\u63a5\u7684\u4fe1\u606f \u4f7f\u7528\u901a\u5e38\u7684\u4fe1\u606f\u67e5\u770b\u547d\u4ee4\u548c\u201cgroup $ {group}\u201d\u4fee\u9970\u7b26\u3002 \u4f8b\u5b50\uff1a IP\u94fe\u8def\u5217\u8868\u7ec442 IP\u5730\u5740\u663e\u793a\u7ec4\u5ba2\u6237 Tun\u548cTap\u8bbe\u5907 Tun\u548ctap\u8bbe\u5907\u5141\u8bb8\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6a21\u62df\u7f51\u7edc\u8bbe\u5907\u3002\u5f53\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6253\u5f00\u5b83\u4eec\u65f6\uff0c\u5b83\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4ece\u5185\u6838\u7f51\u7edc\u5806\u6808\u8def\u7531\u5230\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u8bfb\u53d6\uff0c\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5199\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u636e\u5c06\u4f5c\u4e3a\u672c\u5730\u4f20\u51fa\u6570\u636e\u5305\u6ce8\u5165\u5230\u7f51\u7edc\u5806\u6808\u4e2d\u3002\u4e24\u8005\u7684\u533a\u522b\u5728\u4e8e\uff1a \u70b9\u51fb\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cb\u4ee5\u592a\u7f51\u5e27\u3002 tun\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cbIP\u6570\u636e\u5305\u3002 \u6709\u4e24\u79cd\u7c7b\u578b\u7684tun / tap\u8bbe\u5907\uff1apersistent\u548ctransient\u3002\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5728\u6253\u5f00\u7279\u6b8a\u8bbe\u5907\u65f6\u521b\u5efa\u77ac\u65f6tun / tap\u8bbe\u5907\uff0c\u5e76\u5728\u5173\u8054\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5173\u95ed\u65f6\u81ea\u52a8\u9500\u6bc1\u3002\u8fd9\u91cc\u5217\u51fa\u7684\u547d\u4ee4\u64cd\u7eb5\u6301\u4e45\u6027\u8bbe\u5907\u3002 \u67e5\u770btun / tap\u8bbe\u5907 ip tuntap\u663e\u793a \u6ce8\u610f\uff1a\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7f29\u5199\u4e3a\u201cip tuntap\u201d\u3002 \u8be5\u547d\u4ee4\u662f\u67e5\u660e\u67d0\u4e2a\u8bbe\u5907\u662f\u5904\u4e8etun\u8fd8\u662ftap\u6a21\u5f0f\u7684\u552f\u4e00\u65b9\u6cd5\u3002 \u6dfb\u52a0\u53ef\u4f9broot\u7528\u6237\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} \u4f8b\u5b50\uff1a ip tuntap add dev tun0\u6a21\u5f0f ip tuntap add dev tap9\u6a21\u5f0f\u70b9\u51fb \u6dfb\u52a0\u666e\u901a\u7528\u6237\u53ef\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} user $ {user} group $ {group} \u4f8b\uff1a ip tuntap add dev tun1\u6a21\u5f0ftun\u7528\u6237\u6211\u7ec4mygroup ip tuntap add dev tun2 mode tun user 1000 group 1001 \u4f7f\u7528\u5907\u7528\u6570\u636e\u5305\u683c\u5f0f\u6dfb\u52a0tun / tap\u8bbe\u5907 \u5c06\u5143\u4fe1\u606f\u6dfb\u52a0\u5230\u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u63a5\u6536\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u3002\u5f88\u5c11\u6709\u7a0b\u5e8f\u671f\u671b\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5305\u62ec\u5b83\u5728\u4e0d\u671f\u671b\u7684\u60c5\u51b5\u4e0b\u4f1a\u7834\u574f\u4e8b\u60c5\u3002 ip tuntap add dev $ {interface name} mode $ {mode} pi \u4f8b\uff1a ip tuntap add dev tun1 mode tun pi \u6dfb\u52a0\u5ffd\u7565\u6d41\u91cf\u63a7\u5236\u7684tun / tap \u901a\u5e38\uff0c\u53d1\u9001\u5230tun / tap\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ee5\u4e0e\u53d1\u9001\u5230\u4efb\u4f55\u5176\u4ed6\u8bbe\u5907\u7684\u6570\u636e\u5305\u76f8\u540c\u7684\u65b9\u5f0f\u4f20\u64ad\uff1a\u5b83\u4eec\u88ab\u7f6e\u4e8e\u7531\u6d41\u91cf\u63a7\u5236\u5f15\u64ce\uff08\u7531tc\u547d\u4ee4\u914d\u7f6e\uff09\u5904\u7406\u7684\u961f\u5217\u4e2d\u3002\u8fd9\u53ef\u4ee5\u88ab\u7ed5\u8fc7\uff0c\u4ece\u800c\u7981\u7528\u8be5tun / tap\u8bbe\u5907\u7684\u6d41\u91cf\u63a7\u5236\u5f15\u64ce\u3002 ip tuntap add dev $ {interface name} mode $ {mode} one_queue \u4f8b\uff1a ip tuntap add dev tun1 mode tun one_queue \u5220\u9664tun / tap\u8bbe\u5907 ip tuntap del dev $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0f$ {mode} \u4f8b\u5b50\uff1a ip tuntap\u5220\u9664dev tun0\u6a21\u5f0ftun ip tuntap\u5220\u9664dev tap1\u6a21\u5f0f\u70b9\u51fb \u6ce8\u610f\uff1a\u60a8\u5fc5\u987b\u6307\u5b9a\u6a21\u5f0f\u3002\u8be5\u6a21\u5f0f\u4e0d\u4f1a\u663e\u793a\u5728\u201cip link show\u201d\u4e2d\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u5b83\u662fTUN\u8fd8\u662fTAP\uff0c\u8bf7\u53c2\u9605\u201cip tuntap show\u201d\u7684\u8f93\u51fa\u3002 \u96a7\u9053\u7ba1\u7406 \u96a7\u9053\u662f\u770b\u8d77\u6765\u50cf\u666e\u901a\u63a5\u53e3\u7684\u201c\u7f51\u7edc\u866b\u6d1e\u201d\uff0c\u4f46\u901a\u8fc7\u5b83\u4eec\u53d1\u9001\u7684\u6570\u636e\u5305\u88ab\u5c01\u88c5\u5230\u53e6\u4e00\u4e2a\u534f\u8bae\u4e2d\uff0c\u5e76\u901a\u8fc7\u591a\u4e2a\u4e3b\u673a\u53d1\u9001\u5230\u96a7\u9053\u7684\u53e6\u4e00\u7aef\uff0c\u7136\u540e\u6309\u7167\u901a\u5e38\u7684\u65b9\u5f0f\u8fdb\u884c\u89e3\u5c01\u88c5\u548c\u5904\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5047\u88c5\u4e24\u53f0\u673a\u5668\u6709\u76f4\u63a5\u7684\u8fde\u901a\u6027\uff0c\u800c\u4ed6\u4eec\u5b9e\u9645\u4e0a\u6ca1\u6709\u3002 \u8fd9\u901a\u5e38\u7528\u4e8e\u865a\u62df\u4e13\u7528\u7f51\u7edc\uff08\u4e0eIPsec\u4e4b\u7c7b\u7684\u52a0\u5bc6\u4f20\u8f93\u534f\u8bae\u7ed3\u5408\u4f7f\u7528\uff09\uff0c\u6216\u901a\u8fc7\u4e0d\u4f7f\u7528\u5b83\u7684\u4e2d\u95f4\u7f51\u7edc\u8fde\u63a5\u4f7f\u7528\u67d0\u79cd\u534f\u8bae\u7684\u7f51\u7edc\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4ec5\u652f\u6301IPv4\u7684\u7f51\u6bb5\u5206\u9694\u7684IPv6\u7f51\u7edc\uff09\u3002 \u6ce8\u610f\uff1a\u96a7\u9053\u81ea\u5df1\u63d0\u4f9b\u96f6\u5b89\u5168\u6027\u3002\u5b83\u4eec\u4e0e\u5176\u5e95\u5c42\u7f51\u7edc\u4e00\u6837\u5b89\u5168\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u9700\u8981\u5b89\u5168\u6027\uff0c\u8bf7\u901a\u8fc7\u52a0\u5bc6\u4f20\u8f93\uff08\u4f8b\u5982IPsec\uff09\u4f7f\u7528\u5b83\u4eec\u3002 Linux\u76ee\u524d\u652f\u6301IPIP\uff08IPv4\u4e2d\u7684IPv4\uff09\uff0cSIT\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cIP6IP6\uff08IPv6\u4e2d\u7684IPv6\uff09\uff0cIPIP6\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cGRE\uff08\u51e0\u4e4e\u4efb\u4f55\u4e1c\u897f\uff09\u4ee5\u53ca\u6700\u8fd1\u7684\u7248\u672c\u4e2d\u7684VTI IPsec\uff09\u7684\u3002 \u8bf7\u6ce8\u610f\uff0c\u96a7\u9053\u662f\u5728DOWN\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u60a8\u9700\u8981\u5c06\u5b83\u4eec\u63d0\u8d77\u3002 \u5728\u672c\u8282\u4e2d\uff0c$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u548c$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u662f\u6307\u5206\u914d\u7ed9\u7aef\u70b9\u7269\u7406\u63a5\u53e3\u7684\u5730\u5740\u3002$ {address}\u662f\u6307\u5206\u914d\u7ed9tunnel\u63a5\u53e3\u7684\u5730\u5740\u3002 \u521b\u5efa\u4e00\u4e2aIPIP\u96a7\u9053 ip tunnel add $ {interface name}\u6a21\u5f0fipip local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun0 mode ipip local 192.0.2.1 remote 198.51.100.3 ip link set dev tun0 up ip address add 10.0.0.1/30 dev tun0 \u521b\u5efa\u4e00\u4e2aSIT\u96a7\u9053 sudo ip tunnel add $ {interface name}\u6a21\u5f0f\u5750\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun9\u6a21\u5f0f\u5750\u672c\u5730192.0.2.1\u8fdc\u7a0b198.51.100.3 ip link set dev tun9 up ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun9 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u901a\u5e38\u7528\u4e8e\u4e3aIPv4\u8fde\u63a5\u7684\u7f51\u7edc\u63d0\u4f9bIPv6\u8fde\u63a5\u3002\u6709\u6240\u8c13\u7684\u201c\u96a7\u9053\u7ecf\u7eaa\u4eba\u201d\u63d0\u4f9b\u7ed9\u6240\u6709\u611f\u5174\u8da3\u7684\u4eba\uff0c\u5982Hurricane Electric tunnelbroker.net\u3002 \u521b\u5efa\u4e00\u4e2aIPIP6\u96a7\u9053 ip -6 tunnel add $ {interface name}\u6a21\u5f0fipip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun8 mode ipip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u5728\u4e2d\u8f6c\u8fd0\u8425\u5546\u5206\u9636\u6bb5IPv4\uff08\u5373\u4e0d\u4f1a\u5f88\u5feb\uff09\u65f6\u5e7f\u6cdb\u4f7f\u7528\u3002 \u521b\u5efa\u4e00\u4e2aIP6IP6\u96a7\u9053 ip -6 tunnel add $ {interface name}\u6a21\u5f0fip6ip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun3 mode ip6ip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 ip\u94fe\u63a5\u8bbe\u7f6edev tun3 up ip address add 2001\uff1adb8\uff1a2\uff1a2 :: 1/64 dev tun3 \u5c31\u50cfIPIP6\u4e00\u6837\uff0c\u8fd9\u4e9b\u4e0d\u4f1a\u5f88\u5feb\u6709\u7528\u3002 \u521b\u5efa\u4e00\u4e2agretap\uff08\u4ee5\u592a\u7f51over GRE\uff09\u8bbe\u5907 IP\u94fe\u63a5\u6dfb\u52a0$ {\u63a5\u53e3\u540d\u79f0}\u7c7b\u578bgretap\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip link add gretap0 type gretap local 192.0.2.1 remote 203.0.113.3 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u4ee5\u592a\u7f51\u5e27\u5c01\u88c5\u4e3aIPv4\u6570\u636e\u5305\u3002 \u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u4e5f\u652f\u6301IPv6\u4e0a\u7684gretap\uff0c\u4f60\u9700\u8981\u7528\u201cip6gretap\u201d\u66ff\u6362\u6a21\u5f0f\u6765\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8eIPv6\u7684\u94fe\u63a5\u3002 \u8fd9\u53ef\u80fd\u5e94\u8be5\u662f\u5728\u201c\u94fe\u63a5\u7ba1\u7406\u201d\u90e8\u5206\uff0c\u4f46\u7531\u4e8e\u5b83\u6d89\u53ca\u5c01\u88c5\uff0c\u5b83\u5728\u8fd9\u91cc\u3002\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u7684\u96a7\u9053\u63a5\u53e3\u770b\u8d77\u6765\u50cf\u4e00\u4e2aL2\u94fe\u8def\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5176\u6dfb\u52a0\u5230\u6865\u7ec4\u3002\u8fd9\u7528\u4e8e\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u8fde\u63a5L2\u6bb5\u3002 \u521b\u5efa\u4e00\u4e2aGRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun6 mode gre local 192.0.2.1 remote 203.0.113.3 ip\u94fe\u63a5\u8bbe\u7f6edev tun6 up ip address add 192.168.0.1/30 dev tun6 ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun6 GRE\u53ef\u4ee5\u540c\u65f6\u5c01\u88c5IPv4\u548cIPv6\u3002\u4f46\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f7f\u7528IPv4\u8fdb\u884c\u4f20\u8f93\uff0c\u5bf9\u4e8e\u57fa\u4e8eIPv6\u7684GRE\uff0c\u5b58\u5728\u5355\u72ec\u7684\u96a7\u9053\u6a21\u5f0f\u201cip6gre\u201d\u3002 \u521b\u5efa\u591a\u4e2aGRE\u96a7\u9053\u5230\u540c\u4e00\u4e2a\u7aef\u70b9 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u952e$ {\u952e\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun4 mode gre local 192.0.2.1 remote 203.0.113.6 key 123 ip tunnel add tun5 mode gre local 192.0.2.1 remote 203.0.113.6 key 124 \u952e\u63a7\u96a7\u9053\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u6765\u89e3\u9664\u5bc6\u7801\u3002\u5bc6\u94a5\u53ef\u80fd\u91c7\u7528\u70b9\u5206\u5341\u8fdb\u5236IPv4\u7c7b\u683c\u5f0f\u3002 \u8bf7\u6ce8\u610f\uff0c\u5bc6\u94a5\u4e0d\u4f1a\u4e3a\u96a7\u9053\u6dfb\u52a0\u4efb\u4f55\u5b89\u5168\u6027\u3002\u8fd9\u53ea\u662f\u4e00\u4e2a\u7528\u6765\u533a\u5206\u4e00\u6761\u96a7\u9053\u548c\u53e6\u4e00\u6761\u96a7\u9053\u7684\u6807\u8bc6\u7b26\u3002 \u521b\u5efa\u4e00\u4e2a\u70b9\u5bf9\u591a\u70b9\u7684GRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u5bc6\u94a5$ {\u5bc6\u94a5\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun8 mode gre local 192.0.2.1 key 1234 ip\u94fe\u63a5\u8bbe\u7f6edev tun8 up ip address add 10.0.0.1/27 dev tun8 \u8bf7\u6ce8\u610f\u7f3a\u5c11$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u3002\u8fd9\u4e0eCisco IOS\u4e2d\u6240\u8c13\u7684\u201cmode gre multipoint\u201d\u76f8\u540c\u3002 \u5728\u6ca1\u6709\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\u7684\u60c5\u51b5\u4e0b\uff0c\u5bc6\u94a5\u662f\u8bc6\u522b\u96a7\u9053\u6d41\u91cf\u7684\u552f\u4e00\u65b9\u6cd5\uff0c\u56e0\u6b64\u9700\u8981$ {key value}\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5141\u8bb8\u60a8\u901a\u8fc7\u4f7f\u7528\u76f8\u540c\u7684\u96a7\u9053\u63a5\u53e3\u4e0e\u591a\u4e2a\u7aef\u70b9\u8fdb\u884c\u901a\u4fe1\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5177\u6709\u591a\u4e2a\u7aef\u70b9\u7684\u590d\u6742VPN\u8bbe\u7f6e\uff08\u5728\u601d\u79d1\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u52a8\u6001\u591a\u70b9VPN\u201d\uff09\u3002 \u7531\u4e8e\u6ca1\u6709\u660e\u786e\u7684\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\uff0c\u663e\u7136\u4ec5\u4ec5\u521b\u5efa\u96a7\u9053\u662f\u4e0d\u591f\u7684\u3002\u4f60\u7684\u7cfb\u7edf\u9700\u8981\u77e5\u9053\u5176\u4ed6\u7aef\u70b9\u5728\u54ea\u91cc\u3002 \u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u4f7f\u7528NHRP\uff08\u4e0b\u4e00\u8df3\u89e3\u6790\u534f\u8bae\uff09\u3002\u5bf9\u4e8e\u6d4b\u8bd5\uff0c\u60a8\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u5bf9\u7b49\u7aef\uff08\u7ed9\u5b9a\u8fdc\u7a0b\u7aef\u70b9\u5728\u5176\u7269\u7406\u63a5\u53e3\u4e0a\u4f7f\u7528203.0.113.6\u5730\u5740\uff0c\u5728\u96a7\u9053\u4e0a\u4f7f\u752810.0.0.2\uff09\uff1a ip neighbor add 10.0.0.2 lladdr 203.0.113.6 dev tun8 \u60a8\u4e5f\u5fc5\u987b\u5728\u8fdc\u7a0b\u7aef\u70b9\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a ip neighbor add 10.0.0.1 lladdr 192.0.2.1 dev tun8 \u8bf7\u6ce8\u610f\uff0c\u94fe\u8def\u5c42\u5730\u5740\u548c\u90bb\u5c45\u5730\u5740\u90fd\u662fIP\u5730\u5740\uff0c\u56e0\u6b64\u5b83\u4eec\u4f4d\u4e8e\u540c\u4e00\u4e2aOSI\u5c42\u3002\u94fe\u8def\u5c42\u5730\u5740\u6982\u5ff5\u53d8\u5f97\u6709\u8da3\u7684\u60c5\u51b5\u4e4b\u4e00\u3002 \u901a\u8fc7IPv6\u521b\u5efaGRE\u96a7\u9053 \u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u652f\u6301GRE over IPv6\u3002\u6ca1\u6709\u5bc6\u94a5\u7684\u70b9\u5bf9\u70b9\uff1a ip-6\u96a7\u9053\u6dfb\u52a0\u540d\u79f0$ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fip6gre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9} \u5b83\u5e94\u8be5\u652f\u6301\u4e0a\u8ff0IPv4 GRE\u652f\u6301\u7684\u6240\u6709\u9009\u9879\u548c\u529f\u80fd\u3002 \u5220\u9664\u96a7\u9053 ip tunnel del $ {interface name} \u4f8b\u5b50\uff1a ip tunnel del gre1 \u8bf7\u6ce8\u610f\uff0c\u5728\u8f83\u65e7\u7684iproute2\u7248\u672c\u4e2d\uff0c\u6b64\u547d\u4ee4\u4e0d\u652f\u6301\u5b8c\u6574\u7684\u201c\u5220\u9664\u201d\u5b57\uff0c\u53ea\u6709\u201cdel\u201d\u3002\u6700\u8fd1\u7684\u7248\u672c\u5141\u8bb8\u5168\u90e8\u548c\u7f29\u5199\u5f62\u5f0f\uff08\u5728iproute2-ss131122\u4e2d\u6d4b\u8bd5\uff09\u3002 \u4fee\u6539\u96a7\u9053 IP\u96a7\u9053\u66f4\u6539$ {\u63a5\u53e3\u540d\u79f0} $ {\u9009\u9879} \u4f8b\u5b50\uff1a ip tunnel change tun0 remote 203.0.113.89 ip\u96a7\u9053\u66f4\u6539tun10\u5bc6\u94a523456 \u6ce8\u610f\uff1a\u663e\u7136\uff0c\u60a8\u65e0\u6cd5\u5c06\u5bc6\u94a5\u6dfb\u52a0\u5230\u4e4b\u524d\u672a\u52a0\u5bc6\u7684\u96a7\u9053\u3002\u4e0d\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u9519\u8bef\u8fd8\u662f\u4e00\u4e2a\u529f\u80fd\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u663e\u800c\u6613\u89c1\u7684\u539f\u56e0\uff0c\u60a8\u65e0\u6cd5\u5373\u65f6\u66f4\u6539\u96a7\u9053\u6a21\u5f0f\u3002 \u67e5\u770b\u96a7\u9053\u4fe1\u606f IP\u96a7\u9053\u8868\u6f14 ip tunnel show $ {interface name} \u4f8b\u5b50\uff1a $ ip tun show tun99 tun99\uff1agre / ip remote 10.46.1.20 local 10.91.19.110 ttl inherit L2TPv3\u4f2a\u7ebf\u7ba1\u7406 L2TPv3\u662fL2\u4f2a\u7ebf\u901a\u5e38\u4f7f\u7528\u7684\u96a7\u9053\u534f\u8bae\u3002 \u5728\u8bb8\u591a\u53d1\u884c\u7248\u4e2d\uff0cL2TPv3\u88ab\u7f16\u8bd1\u4e3a\u6a21\u5757\uff0c\u5e76\u4e14\u53ef\u80fd\u4e0d\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u3002\u5982\u679c\u4f60\u5f97\u5230\u4e00\u4e2a\u201cRTNETLINK\u7b54\u6848\uff1a\u6ca1\u6709\u8fd9\u6837\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u201d\u548c\u201c\u9519\u8bef\u7684\u5bf9\u5185\u6838\u201d\u6d88\u606f\u7ed9\u4efb\u4f55\u201cip l2tp\u201d\u547d\u4ee4\uff0c\u60c5\u51b5\u53ef\u80fd\u5982\u6b64\u3002\u52a0\u8f7dl2tp_netlink\u548c l2tp_eth\u6a21\u5757\u3002\u5982\u679c\u4f60\u60f3\u901a\u8fc7IP\u800c\u4e0d\u662fUDP\u4f7f\u7528L2TPv3\uff0c\u8fd8\u9700\u8981\u52a0\u8f7d l2tp_ip\u3002 \u4e0eLinux\u4e2d\u7684\u5176\u4ed6\u96a7\u9053\u534f\u8bae\u5b9e\u73b0\u76f8\u6bd4\uff0cL2TPv3\u672f\u8bed\u6709\u6240\u9006\u8f6c\u3002\u60a8\u521b\u5efa\u4e00\u4e2a\u96a7\u9053\uff0c\u7136\u540e\u7ed1\u5b9a\u4f1a\u8bdd\u5427\u3002\u60a8\u53ef\u4ee5\u5c06\u5177\u6709\u4e0d\u540c\u6807\u8bc6\u7b26\u7684\u591a\u4e2a\u4f1a\u8bdd\u7ed1\u5b9a\u5230\u76f8\u540c\u7684\u96a7\u9053\u3002\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff08\u9ed8\u8ba4\u540d\u79f0\u4e3al2tpethX\uff09\u4e0e\u4f1a\u8bdd\u76f8\u5173\u8054\u3002 \u6ce8\u610f\uff1a Linux\u5185\u6838\u4ec5\u5b9e\u73b0\u6570\u636e\u5e27\u7684\u5904\u7406\uff0c\u56e0\u6b64\u60a8\u53ea\u80fd\u521b\u5efa\u5e26\u6709iproute2\u7684\u975e\u6258\u7ba1\u96a7\u9053\uff0c\u5e76\u4e14\u53cc\u65b9\u90fd\u624b\u52a8\u914d\u7f6e\u6240\u6709\u8bbe\u7f6e\u3002\u5982\u679c\u60a8\u60f3\u8981\u4f7f\u7528L2TP\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95eeVPN\u6216\u5176\u4ed6\u975e\u56fa\u5b9a\u4f2a\u7ebf\uff0c\u5219\u9700\u8981\u7528\u6237\u7a7a\u95f4\u5b88\u62a4\u7a0b\u5e8f\u6765\u5904\u7406\u5b83\u3002\u8fd9\u8d85\u51fa\u4e86\u672c\u6587\u6863\u8303\u56f4\u3002 \u901a\u8fc7UDP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id $ {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ udp_sport $ {\u6e90\u7aef\u53e3} \\ udp_dport $ {\u76ee\u6807\u7aef\u53e3} \\ encap udp \\ \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} \\ \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id 1 \\ peer_tunnel_id 1 \\ udp_sport 5000 \\ udp_dport 5000 encap udp \\ \u672c\u5730192.0.2.1 \u8fdc\u7a0b203.0.113.2 \u6ce8\u610f\uff1a\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u96a7\u9053\u6807\u8bc6\u7b26\u548c\u5176\u4ed6\u8bbe\u7f6e\u5fc5\u987b\u5339\u914d\u3002 \u901a\u8fc7IP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ encap ip \\ \u672c\u5730192.0.2.1 \\ \u8fdc\u7a0b203.0.113.2 \u76f4\u63a5\u5c01\u88c5\u6210IP\u7684L2TPv3\u63d0\u4f9b\u8f83\u5c11\u7684\u5f00\u9500\uff0c\u4e00\u822c\u65e0\u6cd5\u901a\u8fc7NAT\u3002 \u521b\u5efa\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp add session tunnel_id $ {local tunnel identifier} \\ session_id $ {\u672c\u5730\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_session_id $ {\u8fdc\u7a0b\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26} \u4f8b\u5b50\uff1a ip l2tp add session tunnel_id 1 session_id 10 \\ peer_session_id 10 \u6ce8\u610f\uff1a tunnel_id\u503c\u5fc5\u987b\u5339\u914d\u5148\u524d\u521b\u5efa\u7684\u96a7\u9053\u7684\u503c\u3002\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u4f1a\u8bdd\u6807\u8bc6\u7b26\u5fc5\u987b\u5339\u914d\u3002 \u4e00\u65e6\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a\u96a7\u9053\u548c\u4e00\u4e2a\u4f1a\u8bdd\uff0cl2tpethX\u754c\u9762\u5c31\u4f1a\u51fa\u73b0\uff0c\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u5c06\u72b6\u6001\u66f4\u6539\u4e3a\u542f\u52a8\u5e76\u5c06\u5176\u4e0e\u53e6\u4e00\u4e2a\u754c\u9762\u6865\u63a5\u6216\u5206\u914d\u5730\u5740\u3002 \u5220\u9664\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp del session tunnel_id $ {tunnel identifier} \\ session_id $ {\u4f1a\u8bdd\u6807\u8bc6\u7b26} \u4f8b\u5b50 ip l2tp del session tunnel_id 1 session_id 1 \u5220\u9664L2TPv3\u96a7\u9053 ip l2tp del tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50 ip l2tp del tunnel tunnel_id 1 \u6ce8\u610f\uff1a\u5220\u9664\u4e4b\u524d\uff0c\u60a8\u9700\u8981\u5220\u9664\u4e0e\u96a7\u9053\u76f8\u5173\u7684\u6240\u6709\u4f1a\u8bdd\u3002 \u67e5\u770bL2TPv3\u96a7\u9053\u4fe1\u606f ip l2tp\u663e\u793a\u96a7\u9053 ip l2tp show tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50\uff1a ip l2tp show tunnel tunnel_id 12 \u67e5\u770bL2TPv3\u4f1a\u8bdd\u4fe1\u606f ip l2tp\u663e\u793a\u4f1a\u8bdd ip l2tp show session session_id $ {session identifier} \\ tunnel_id $ {\u96a7\u9053\u6807\u8bc6\u7b26} \u4f8b\u5b50\uff1a ip l2tp show session session_id 1 tunnel_id 12 VXLAN\u7ba1\u7406 VXLAN\u662f\u7b2c2\u5c42\u96a7\u9053\u534f\u8bae\uff0c\u901a\u5e38\u4e0e\u865a\u62df\u5316\u7cfb\u7edf\uff08\u5982KVM\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u8fd0\u884c\u5728\u4e0d\u540c\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u8282\u70b9\u4e0a\u7684\u865a\u62df\u673a\u5f7c\u6b64\u8fde\u63a5\u5e76\u8fde\u63a5\u5230\u5916\u90e8\u4e16\u754c\u3002 \u4e0e\u70b9\u5bf9\u70b9\u7684GRE\u6216L2TPv3\u4e0d\u540c\uff0cVXLAN\u901a\u8fc7\u4f7f\u7528IP\u591a\u64ad\u6765\u590d\u5236\u591a\u8def\u8bbf\u95ee\u4ea4\u6362\u7f51\u7edc\u7684\u4e00\u4e9b\u5c5e\u6027\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u901a\u8fc7\u4e0e\u5e27\u4e00\u8d77\u53d1\u9001\u7f51\u7edc\u6807\u8bc6\u7b26\u6765\u652f\u6301\u865a\u62df\u7f51\u7edc\u5206\u79bb\u3002 \u7f3a\u70b9\u662f\u60a8\u9700\u8981\u4f7f\u7528\u591a\u64ad\u8def\u7531\u534f\u8bae\uff08\u901a\u5e38\u662fPIM-SM\uff09\u624d\u80fd\u4f7f\u5176\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u5de5\u4f5c\u3002 VXLAN\u7684\u5e95\u5c42\u5c01\u88c5\u534f\u8bae\u662fUDP\u3002 \u521b\u5efa\u5355\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan id <0-16777215> dev $ {source interface} \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan ID 42 dev eth0\u8fdc\u7a0b203.0.113.6\u672c\u5730192.0.2.1 dstport 4789 \u6ce8\u610f\uff1a id\u9009\u9879\u8868\u793aVXLAN\u7f51\u7edc\u6807\u8bc6\u7b26\uff08VNI\uff09\u3002 \u521b\u5efa\u7ec4\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan id <0-16777215> dev $ {source interface} \u7ec4$ {\u591a\u64ad\u5730\u5740} dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan id 42 dev eth0\u7ec4239.0.0.1 dstport 4789 \u4e4b\u540e\uff0c\u60a8\u9700\u8981\u5c06\u94fe\u63a5\u4e0e\u5176\u4ed6\u63a5\u53e3\u6865\u63a5\u6216\u5206\u914d\u5730\u5740\u3002 \u8def\u7531\u7ba1\u7406 \u5bf9\u4e8eIPv4\u8def\u7531\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u524d\u7f00\u957f\u5ea6\u6216\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.0/24\u548c192.0.2.0/255.255.255.0\u90fd\u53ef\u4ee5\u63a5\u53d7\u3002 \u6ce8\u610f\uff1a\u6839\u636e\u4e0b\u9762\u7684\u90e8\u5206\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u9759\u6001\u8def\u7531\uff0c\u5e76\u4e14\u7531\u4e8e\u94fe\u63a5\u5173\u95ed\u800c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5b83\u5c06\u88ab\u5220\u9664\uff0c\u5e76\u4e14 \u6c38\u8fdc\u4e0d\u4f1a\u81ea\u884c\u6062\u590d\u3002\u60a8\u53ef\u80fd\u6ca1\u6709\u6ce8\u610f\u5230\u8fd9\u79cd\u884c\u4e3a\uff0c\u56e0\u4e3a\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u9644\u52a0\u8f6f\u4ef6\uff08\u4f8b\u5982NetworkManager\u6216rp-pppoe\uff09\u8d1f\u8d23\u5728\u94fe\u63a5\u4e0a\u4e0b\u65f6\u6062\u590d\u8def\u7531\u3002 \u5982\u679c\u60a8\u6253\u7b97\u5c06\u60a8\u7684Linux\u673a\u5668\u7528\u4f5c\u8def\u7531\u5668\uff0c\u8bf7\u8003\u8651\u5b89\u88c5\u8bf8\u5982Quagga \u6216BIRD\u4e4b\u7c7b\u7684\u8def\u7531\u534f\u8bae\u5957\u4ef6\u3002\u5b83\u4eec\u8ddf\u8e2a\u63a5\u53e3\u72b6\u6001\u5e76\u5728\u8def\u7531\u5668\u65ad\u5f00\u540e\u6062\u590d\u8def\u7531\u65f6\u6062\u590d\u8def\u7531\u3002\u5f53\u7136\uff0c\u4ed6\u4eec\u4e5f\u5141\u8bb8\u4f60\u4f7f\u7528\u52a8\u6001\u8def\u7531\u534f\u8bae\uff0c\u5982OSPF\u548cBGP\u3002 \u8fde\u63a5\u7684\u8def\u7ebf \u67d0\u4e9b\u8def\u7ebf\u5728\u7cfb\u7edf\u4e2d\u663e\u793a\uff0c\u6ca1\u6709\u660e\u786e\u7684\u914d\u7f6e\uff08\u8fdd\u80cc\u60a8\u7684\u610f\u613f\uff09\u3002 \u4e00\u65e6\u4e3a\u63a5\u53e3\u5206\u914d\u5730\u5740\uff0c\u7cfb\u7edf\u5c06\u8ba1\u7b97\u5176\u7f51\u7edc\u5730\u5740\u5e76\u4e3a\u5176\u521b\u5efa\u8def\u7531\uff08\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u5b50\u7f51\u63a9\u7801\uff09\u3002\u8fd9\u4e9b\u8def\u7531\u88ab\u79f0\u4e3a\u8fde\u63a5\u8def\u7531\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u5c06203.0.113.25/24\u5206\u914d\u7ed9eth0\uff0c\u5219\u4f1a\u521b\u5efa\u5230203.0.113.0/24\u7f51\u7edc\u7684\u5df2\u8fde\u63a5\u8def\u7531\uff0c\u5e76\u4e14\u7cfb\u7edf\u5c06\u77e5\u9053\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u8be5\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u3002 \u5f53\u63a5\u53e3\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u4e0e\u5176\u5173\u8054\u7684\u8fde\u63a5\u8def\u7531\u5c06\u88ab\u5220\u9664\u3002\u8fd9\u7528\u4e8e\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u68c0\u6d4b\uff0c\u56e0\u6b64\u901a\u8fc7\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u7684\u8def\u7531\u88ab\u5220\u9664\u3002\u76f8\u540c\u7684\u673a\u5236\u963b\u6b62\u60a8\u901a\u8fc7\u65e0\u6cd5\u8bbf\u95ee\u7684\u7f51\u5173\u521b\u5efa\u8def\u7531\u3002 \u67e5\u770b\u6240\u6709\u8def\u7ebf ip\u8def\u7531 ip\u8def\u7531\u663e\u793a \u60a8\u53ef\u4ee5\u4f7f\u7528-4\u548c-6\u9009\u9879\u4ec5\u67e5\u770bIPv4\u6216IPv6\u8def\u7531\u3002\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u9009\u9879\uff0c\u5219\u663e\u793aIPv4\u8def\u7531\u3002\u8981\u67e5\u770bIPv6\u8def\u7531\uff0c\u8bf7\u4f7f\u7528\uff1a ip-6\u8def\u7531 \u67e5\u770b\u5230\u7f51\u7edc\u53ca\u5176\u6240\u6709\u5b50\u7f51\u7684\u8def\u7531 ip route show to root $ {address} / $ {mask} \u4f8b\u5982\uff0c\u5982\u679c\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528192.168.0.0/24\u5b50\u7f51\uff0c\u5e76\u4e14\u8be5\u5b50\u7f51\u5206\u4e3a192.168.0.0/25\u548c192.168.0.128/25\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u6240\u6709\u8fd9\u4e9b\u8def\u7531\uff1a ip route\u663e\u793a\u4e3a\u6839192.168.0.0/24 \u6ce8\u610f\uff1a\u8fd9\u4e2a\u548c\u5176\u4ed6show\u547d\u4ee4\u4e2d\u7684\u201cto\u201d\u662f\u53ef\u9009\u7684\u3002 \u67e5\u770b\u5230\u7f51\u7edc\u548c\u6240\u6709\u8d85\u7f51\u7684\u8def\u7531 ip route show to match $ {address} / $ {mask} \u5982\u679c\u8981\u67e5\u770b\u8def\u7531\u5230192.168.0.0/24\u548c\u6240\u6709\u66f4\u5927\u7684\u5b50\u7f51\uff0c\u8bf7\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u5339\u914d192.168.0.0/24 \u7531\u4e8e\u8def\u7531\u5668\u66f4\u504f\u5411\u4e8e\u66f4\u5177\u4f53\u7684\u8def\u7531\uff0c\u56e0\u6b64\u901a\u5e38\u7528\u4e8e\u8c03\u8bd5\u7279\u5b9a\u5b50\u7f51\u7684\u6d41\u91cf\u53d1\u9001\u9519\u8bef\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u7f3a\u5c11\u8def\u7531\u4f46\u5b58\u5728\u5230\u8f83\u5927\u5b50\u7f51\u7684\u8def\u7531\u3002 \u67e5\u770b\u8def\u7531\u5230\u786e\u5207\u7684\u5b50\u7f51 ip route\u663e\u793a\u7cbe\u786e$ {address} / $ {mask} \u5982\u679c\u60a8\u60f3\u67e5\u770b192.168.0.0/24\u7684\u8def\u7531\uff0c\u4f46\u4e0d\u60f3\u67e5\u770b\u8def\u7531192.168.0.0/25\u548c192.168.0.0/16\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u786e\u5207\u7684192.168.0.0/24 \u4ec5\u67e5\u770b\u5185\u6838\u5b9e\u9645\u4f7f\u7528\u7684\u8def\u7ebf ip route get $ {address} / $ {mask} \u4f8b\uff1a ip route\u83b7\u5f97192.168.0.0/24 \u8bf7\u6ce8\u610f\uff0c\u5728\u590d\u6742\u8def\u7531\u573a\u666f\uff08\u5982\u591a\u8def\u5f84\u8def\u7531\uff09\u4e2d\uff0c\u7ed3\u679c\u53ef\u80fd\u201c\u6b63\u786e\u4f46\u4e0d\u5b8c\u6574\u201d\uff0c\u56e0\u4e3a\u5b83\u603b\u662f\u663e\u793a\u9996\u5148\u4f7f\u7528\u7684\u4e00\u6761\u8def\u7531\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e0d\u662f\u95ee\u9898\uff0c\u4f46\u4e0d\u8981\u5fd8\u8bb0\u67e5\u770b\u76f8\u5e94\u7684\u201cshow\u201d\u547d\u4ee4\u8f93\u51fa\u3002 \u67e5\u770b\u8def\u7531\u7f13\u5b58\uff08\u4ec5\u9650\u4e8e3.6\u5185\u6838\u4e4b\u524d\uff09 IP\u8def\u7531\u663e\u793a\u7f13\u5b58 \u5728\u7248\u672c3.6\u4e4b\u524d\uff0cLinux\u4f7f\u7528\u8def\u7531\u7f13\u5b58\u3002\u5728\u8f83\u65e9\u7684\u5185\u6838\u4e2d\uff0c\u6b64\u547d\u4ee4\u663e\u793a\u8def\u7531\u7f13\u5b58\u7684\u5185\u5bb9\u3002\u5b83\u53ef\u4ee5\u4e0e\u4e0a\u8ff0\u7684\u4fee\u9970\u7b26\u4e00\u8d77\u4f7f\u7528\u3002\u5728\u8f83\u65b0\u7684\u5185\u6838\u4e2d\uff0c\u5b83\u4ec0\u4e48\u90fd\u4e0d\u505a\u3002 \u901a\u8fc7\u7f51\u5173\u6dfb\u52a0\u8def\u7531 ip route\u901a\u8fc7$ {next hop}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7192.0.2.1\u6dfb\u52a0192.0.2.128/25 ip route add 2001\uff1adb8\uff1a1 :: / 48 via 2001\uff1adb8\uff1a1 :: 1 \u901a\u8fc7\u754c\u9762\u6dfb\u52a0\u8def\u7ebf ip route add $ {address} / $ {mask} dev $ {interface name} \u4f8b\uff1a ip route add 192.0.2.0/25 dev ppp0 \u63a5\u53e3\u8def\u7531\u901a\u5e38\u7528\u4e8e\u70b9\u5bf9\u70b9\u63a5\u53e3\uff0c\u5982PPP\u96a7\u9053\uff0c\u5176\u4e2d\u4e0d\u9700\u8981\u4e0b\u4e00\u8df3\u5730\u5740\u3002 \u66f4\u6539\u6216\u66ff\u6362\u8def\u7ebf \u60a8\u53ef\u4ee5\u4f7f\u7528\u201c\u66f4\u6539\u201d\u547d\u4ee4\u6765\u66f4\u6539\u73b0\u6709\u8def\u7ebf\u7684\u53c2\u6570\u3002\u201c\u66ff\u6362\u201d\u547d\u4ee4\u53ef\u7528\u4e8e\u6dfb\u52a0\u65b0\u8def\u7531\u6216\u4fee\u6539\u73b0\u6709\u8def\u7531\uff08\u5982\u679c\u4e0d\u5b58\u5728\uff09\u3002\u4f8b\u5b50\uff1a IP\u8def\u7531\u901a\u8fc710.0.0.1\u66f4\u6539192.168.2.0/24 ip route\u66ff\u6362192.0.2.1/27 dev tun0 \u5220\u9664\u8def\u7ebf ip route delete $ {\u8def\u7531\u8bed\u53e5\u7684\u5176\u4f59\u90e8\u5206} \u4f8b\u5b50\uff1a IP\u8def\u7531\u901a\u8fc710.0.0.1\u5220\u966410.0.1.0/25 ip route\u5220\u9664\u9ed8\u8ba4dev ppp0 \u9ed8\u8ba4\u8def\u7531 \u6709\u4e00\u4e2a\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\u7684\u5feb\u6377\u65b9\u5f0f\u3002 ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a0\u9ed8\u8ba4\u503c ip route add default dev $ {interface name} \u8fd9\u4e9b\u76f8\u5f53\u4e8e\uff1a ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a00.0.0.0/0 ip route add 0.0.0.0/0 dev $ {interface name} \u5bf9\u4e8eIPv6\u8def\u7531\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5de5\u4f5c\uff0c\u76f8\u5f53\u4e8e:: / 0 ip-6\u8def\u7531\u901a\u8fc72001\uff1adb8 :: 1\u6dfb\u52a0\u9ed8\u8ba4\u503c \u9ed1\u6d1e\u8def\u7ebf ip route add blackhole $ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route add blackhole 192.0.2.1/32 \u4e0e\u9ed1\u6d1e\u8def\u7ebf\u76f8\u5339\u914d\u7684\u76ee\u7684\u5730\u7684\u4ea4\u901a\u6d41\u88ab\u65e0\u58f0\u5730\u4e22\u5f03\u3002 \u9ed1\u6d1e\u8def\u7ebf\u6709\u53cc\u91cd\u76ee\u7684\u3002\u9996\u5148\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4e22\u5f03\u53d1\u9001\u5230\u4e0d\u60f3\u8981\u7684\u76ee\u7684\u5730\u7684\u6d41\u91cf\uff0c\u4f8b\u5982\u5df2\u77e5\u7684\u6076\u610f\u4e3b\u673a\u3002 \u7b2c\u4e8c\u4e2a\u4e0d\u592a\u660e\u663e\uff0c\u6309\u7167RFC1812\u4f7f\u7528\u201c\u6700\u957f\u5339\u914d\u89c4\u5219\u201d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u8def\u7531\u5668\u8ba4\u4e3a\u5b83\u5177\u6709\u901a\u5f80\u66f4\u5927\u5b50\u7f51\u7684\u8def\u7531\uff0c\u800c\u4e0d\u662f\u6574\u4f53\u4f7f\u7528\u5b83\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u52a8\u6001\u8def\u7531\u534f\u8bae\u901a\u544a\u6574\u4e2a\u5b50\u7f51\u65f6\u3002\u5927\u578b\u5b50\u7f51\u901a\u5e38\u4f1a\u5206\u6210\u8f83\u5c0f\u7684\u90e8\u5206\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u7684\u5b50\u7f51\u662f192.0.2.0/24\uff0c\u5e76\u4e14\u60a8\u5df2\u5c06192.0.2.1/25\u548c192.0.2.129/25\u5206\u914d\u7ed9\u60a8\u7684\u63a5\u53e3\uff0c\u5219\u7cfb\u7edf\u4f1a\u521b\u5efa\u8fde\u63a5\u5230/ 25\u7684\u8fde\u63a5\u8def\u7531\uff0c\u4f46\u4e0d\u662f\u6574\u4e2a/ 24\uff0c\u5e76\u4e14\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u53ef\u80fd\u4e0d\u60f3\u901a\u544a/ 24\uff0c\u56e0\u4e3a\u60a8\u6ca1\u6709\u8def\u7531\u5230\u8be5\u786e\u5207\u7684\u5b50\u7f51\u3002\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u9ed1\u6d1e\u8def\u7531\u8bbe\u7f6e\u4e3a192.0.2.0/24\u3002 \u5176\u4ed6\u7279\u6b8a\u8def\u7ebf ip route add unreachable $ {address} / $ {mask} ip route add prohibit $ {address} / $ {mask} ip route add throw $ {address} / $ {mask} \u8fd9\u4e9b\u8def\u7531\u4f7f\u7cfb\u7edf\u4e22\u5f03\u6570\u636e\u5305\uff0c\u5e76\u5411\u53d1\u4ef6\u4eba\u56de\u590dICMP\u9519\u8bef\u6d88\u606f\u3002 \u65e0\u6cd5\u8bbf\u95ee \u53d1\u9001ICMP\u201c\u4e3b\u673a\u4e0d\u53ef\u8fbe\u201d\u3002 \u7981\u6b62 \u53d1\u9001ICMP\u201c\u7ba1\u7406\u7981\u6b62\u201d\u3002 \u6254 \u53d1\u9001\u201c\u7f51\u7edc\u4e0d\u53ef\u8fbe\u201d\u3002 \u4e0e\u9ed1\u6d1e\u8def\u7531\u4e0d\u540c\uff0c\u8fd9\u4e9b\u4e0d\u80fd\u7528\u4e8e\u963b\u6b62\u4e0d\u9700\u8981\u7684\u6d41\u91cf\uff08\u4f8b\u5982DDoS\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f1a\u4e3a\u6bcf\u4e2a\u4e22\u5f03\u7684\u6570\u636e\u5305\u751f\u6210\u4e00\u4e2a\u56de\u590d\u6570\u636e\u5305\uff0c\u4ece\u800c\u521b\u5efa\u66f4\u5927\u7684\u6d41\u91cf\u3002\u5b83\u4eec\u53ef\u4ee5\u5f88\u597d\u5730\u5b9e\u65bd\u5185\u90e8\u8bbf\u95ee\u7b56\u7565\uff0c\u4f46\u9996\u5148\u8003\u8651\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u9632\u706b\u5899\u3002 \u201c\u629b\u51fa\u201d\u8def\u7531\u53ef\u7528\u4e8e\u5b9e\u65bd\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff0c\u5728\u975e\u9ed8\u8ba4\u8868\u4e2d\u5b83\u4eec\u4f1a\u505c\u6b62\u5f53\u524d\u8868\u67e5\u627e\uff0c\u4f46\u4e0d\u53d1\u9001ICMP\u9519\u8bef\u6d88\u606f\u3002 \u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u7684\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u516c\u5236$ {number}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc710.0.1.1 metric\u6dfb\u52a0192.168.2.0/24 ip route add 192.168.2.0 dev ppp0 metric 10 \u5982\u679c\u6709\u591a\u6761\u8def\u7531\u901a\u5411\u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u503c\u7684\u540c\u4e00\u4e2a\u7f51\u7edc\uff0c\u5219\u5177\u6709\u6700\u4f4e\u5ea6\u91cf\u503c\u7684\u8def\u7531\u5c06\u662f\u9996\u9009\u3002 \u8fd9\u4e2a\u6982\u5ff5\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u662f\uff0c\u5f53\u4e00\u4e2a\u63a5\u53e3\u5173\u95ed\u65f6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u65e0\u7528\u7684\u8def\u7531\u4ece\u8def\u7531\u8868\u4e2d\u6d88\u5931\uff08\u53c2\u89c1\u8fde\u63a5\u8def\u7531\u90e8\u5206\uff09\uff0c\u7cfb\u7edf\u5c06\u56de\u9000\u5230\u66f4\u9ad8\u7684\u5ea6\u91cf\u8def\u7531\u3002 \u6b64\u529f\u80fd\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u5230\u91cd\u8981\u76ee\u7684\u5730\u7684\u5907\u4efd\u8fde\u63a5\u3002 \u591a\u8def\u5f84\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u6dfb\u52a0$ {addresss} / $ {mask} nexthop\u901a\u8fc7$ {number} nexthop\u901a\u8fc7$ {gateway 2}\u52a0\u6743$ {number} \u591a\u8def\u5f84\u8def\u7531\u4f7f\u5f97\u7cfb\u7edf\u6839\u636e\u6743\u91cd\u5728\u591a\u4e2a\u94fe\u8def\u4e0a\u5e73\u8861\u6570\u636e\u5305\uff08\u8f83\u9ad8\u7684\u6743\u91cd\u662f\u9996\u9009\uff0c\u6240\u4ee5\u6743\u91cd\u4e3a2\u7684\u7f51\u5173/\u63a5\u53e3\u5c06\u6bd4\u53e6\u4e00\u4e2a\u6743\u91cd\u4e3a1\u7684\u7f51\u5173/\u63a5\u53e3\u5927\u7ea6\u591a\u4e24\u500d\uff09\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u914d\u7f6e\u5c3d\u53ef\u80fd\u591a\u7684\u7f51\u5173\uff0c\u5e76\u6df7\u5408\u7f51\u5173\u548c\u63a5\u53e3\u8def\u7531\uff0c\u5982\uff1a ip route\u6dfb\u52a0\u9ed8\u8ba4nexthop\u901a\u8fc7192.168.1.1\u6743\u91cd1 nexthop dev ppp0\u6743\u91cd10 \u8b66\u544a\uff1a\u8fd9\u79cd\u5e73\u8861\u7684\u7f3a\u70b9\u662f\u6570\u636e\u5305\u4e0d\u80fd\u4fdd\u8bc1\u901a\u8fc7\u5b83\u4eec\u8fdb\u5165\u7684\u76f8\u540c\u94fe\u8def\u53d1\u56de\u3002\u8fd9\u79f0\u4e3a\u201c\u4e0d\u5bf9\u79f0\u8def\u7531\u201d\u3002\u5bf9\u4e8e\u7b80\u5355\u5730\u8f6c\u53d1\u6570\u636e\u5305\u800c\u4e0d\u505a\u4efb\u4f55\u672c\u5730\u6d41\u91cf\u5904\u7406\uff08\u5982NAT\uff09\u7684\u8def\u7531\u5668\uff0c\u8fd9\u901a\u5e38\u662f\u6b63\u5e38\u7684\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u751a\u81f3\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002 \u5982\u679c\u60a8\u7684\u7cfb\u7edf\u9664\u4e86\u5728\u63a5\u53e3\u4e4b\u95f4\u8f6c\u53d1\u6570\u636e\u5305\u4e4b\u5916\u4ec0\u4e48\u90fd\u505a\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f20\u5165\u8fde\u63a5\u51fa\u73b0\u95ee\u9898\uff0c\u5e94\u91c7\u53d6\u4e00\u4e9b\u63aa\u65bd\u6765\u9632\u6b62\u5b83\u4eec\u3002 \u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531 Linux\u4e2d\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff08PBR\uff09\u7684\u8bbe\u8ba1\u65b9\u5f0f\u5982\u4e0b\uff1a\u9996\u5148\u521b\u5efa\u81ea\u5b9a\u4e49\u8def\u7531\u8868\uff0c\u7136\u540e\u521b\u5efa\u89c4\u5219\u4ee5\u544a\u77e5\u5185\u6838\u5e94\u8be5\u4f7f\u7528\u8fd9\u4e9b\u8868\u800c\u4e0d\u662f\u9ed8\u8ba4\u8868\u8fdb\u884c\u7279\u5b9a\u6d41\u91cf\u3002 \u4e00\u4e9b\u8868\u683c\u662f\u9884\u5b9a\u4e49\u7684\uff1a \u672c\u5730\uff08\u8868255\uff09 \u5305\u542b\u63a7\u5236\u8def\u7531\u672c\u5730\u548c\u5e7f\u64ad\u5730\u5740\u3002 \u4e3b\u8981\uff08\u8868254\uff09 \u5305\u542b\u6240\u6709\u975ePBR\u8def\u7531\u3002\u5982\u679c\u60a8\u5728\u6dfb\u52a0\u8def\u7ebf\u65f6\u672a\u6307\u5b9a\u8868\u683c\uff0c\u5219\u4f1a\u663e\u793a\u5728\u6b64\u5904\u3002 \u9ed8\u8ba4\uff08\u8868253\uff09 \u4fdd\u7559\u7528\u4e8e\u540e\u671f\u5904\u7406\uff0c\u901a\u5e38\u672a\u4f7f\u7528\u3002 \u7528\u6237\u5b9a\u4e49\u7684\u8868\u683c\u4f1a\u5728\u60a8\u5411\u5176\u6dfb\u52a0\u7b2c\u4e00\u6761\u8def\u7ebf\u65f6\u81ea\u52a8\u521b\u5efa\u3002 \u521b\u5efa\u4e00\u4e2a\u7b56\u7565\u8def\u7531 ip route add $ {route options} table $ {table id or name} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7203.0.113.1\u886810\u6dfb\u52a0192.0.2.0/27 ip route\u901a\u8fc7192.168.0.1\u8868ISP2\u6dfb\u52a00.0.0.0/0 ip route add 2001\uff1adb8 :: / 48 dev eth1 table 100 \u6ce8\u610f\uff1a\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7b56\u7565\u8def\u7531\u4e2d\u7684\u201c\u8def\u7531\u7ba1\u7406\u201d\u90e8\u5206\u4e2d\u63cf\u8ff0\u7684\u4efb\u4f55\u8def\u7531\u9009\u9879\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u6700\u540e\u7684\u201c\u8868$ {\u8868id /\u540d\u79f0}\u201d\u90e8\u5206\u3002 \u6570\u5b57\u8868\u683c\u6807\u8bc6\u7b26\u548c\u540d\u79f0\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\u8981\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u7b26\u53f7\u540d\u79f0\uff0c\u8bf7\u7f16\u8f91/ etc / iproute2 / rt_tables\u914d\u7f6e\u6587\u4ef6\u3002 \u201c\u5220\u9664\u201d\uff0c\u201c\u66f4\u6539\u201d\uff0c\u201c\u66ff\u6362\u201d\u6216\u4efb\u4f55\u5176\u4ed6\u8def\u7531\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u4e0e\u4efb\u4f55\u8868\u4e00\u8d77\u4f7f\u7528\u3002 \u201cip route ... table main\u201d\u6216\u201cip route ... table 254\u201d\u5bf9\u6ca1\u6709\u8868\u683c\u90e8\u5206\u7684\u547d\u4ee4\u5177\u6709\u5b8c\u5168\u76f8\u540c\u7684\u6548\u679c\u3002 \u67e5\u770b\u7b56\u7565\u8def\u7531 ip route show table $ {\u8868ID\u6216\u540d\u79f0} \u4f8b\u5b50\uff1a ip route show table 100 ip route show table test \u6ce8\u610f\uff1a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u9700\u8981\u201c\u663e\u793a\u201d\u5b57\uff0c\u50cf\u201cip route table 120\u201d\u8fd9\u6837\u7684\u7b80\u5199\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u8be5\u547d\u4ee4\u4e0d\u660e\u786e\u3002 \u4e00\u822c\u89c4\u5219\u8bed\u6cd5 ip rule add $ {options} \u5982\u679c\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\uff0c\u5339\u914d$ {options}\uff08\u5982\u4e0b\u6240\u8ff0\uff09\u7684\u6d41\u91cf\u5c06\u6839\u636e\u5177\u6709\u6307\u5b9a\u540d\u79f0/ id\u7684\u8868\u8fdb\u884c\u8def\u7531\uff0c\u800c\u4e0d\u662f\u201c\u4e3b\u201d/ 254\u8868\u3002 \u201c\u9ed1\u6d1e\u201d\uff0c\u201c\u7981\u6b62\u201d\u548c\u201c\u65e0\u6cd5\u8bbf\u95ee\u201d\u7684\u52a8\u4f5c\uff0c\u5176\u5de5\u4f5c\u65b9\u5f0f\u4e0e\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u7684\u7c7b\u578b\u76f8\u540c\u3002\u5728\u5927\u591a\u6570\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\u4f5c\u4e3a\u6700\u5e38\u89c1\u7684\u64cd\u4f5c\u3002 \u5bf9\u4e8eIPv6\u89c4\u5219\uff0c\u4f7f\u7528\u201cip -6\u201d\uff0c\u5176\u4f59\u8bed\u6cd5\u662f\u76f8\u540c\u7684\u3002 \u201ctable $ {table id or name}\u201d\u53ef\u4ee5\u7528\u4f5c\u201c\u67e5\u627e$ {\u8868id\u6216\u540d\u79f0}\u201d\u7684\u522b\u540d\u3002 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u6e90\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u4ece$ {\u6e90\u7f51\u7edc} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e10 \u4ece2001\u5e74ip-6\u89c4\u5219\u6dfb\u52a0\uff1adb8 :: / 32\u7981\u6b62 \u6ce8\u610f\uff1a \u201call\u201d\u53ef\u4ee5\u7528\u4f5c0.0.0.0/0\u6216\u8005:: / 0\u7684\u7b80\u5199 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u76ee\u6807\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u5230$ {\u76ee\u6807\u7f51\u7edc} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u5230192.0.2.0/24\u9ed1\u6d1e ip -6\u89c4\u5219\u6dfb\u52a0\u52302001\uff1adb8 :: / 32\u67e5\u627e100 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914dToS\u5b57\u6bb5\u503c ip rule add tos $ {ToS value} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0tos 0x10\u67e5\u627e110 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u9632\u706b\u5899\u6807\u8bb0\u503c\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0fwmark $ {mark} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0fwmark 0x11\u67e5\u627e100 \u6ce8\u610f\uff1a\u8bf7\u53c2\u9605iptables\u6587\u6863\u4ee5\u4e86\u89e3\u5982\u4f55\u8bbe\u7f6e\u6807\u8bb0\u3002 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u5165\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0IIF $ {\u63a5\u53e3\u540d\u79f0} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0iif eth0\u67e5\u627e10 ip\u89c4\u5219\u6dfb\u52a0iif\u67e5\u627e20 \u201ciif lo\u201d\uff08\u56de\u9001\uff09\u89c4\u5219\u5c06\u5339\u914d\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf\u3002 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u51fa\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip rule add oif $ {interface name} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0oif eth0\u67e5\u627e10 \u6ce8\u610f\uff1a\u8fd9\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf\u3002 \u8bbe\u7f6e\u89c4\u5219\u4f18\u5148\u7ea7 ip\u89c4\u5219\u6dfb\u52a0$ {options} $ {action}\u4f18\u5148\u7ea7$ {value} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/25\u67e5\u627e10\u4f18\u5148\u7ea710 ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e20\u4f18\u5148\u7ea720 \u6ce8\u610f\uff1a\u7531\u4e8e\u89c4\u5219\u4ece\u6700\u4f4e\u4f18\u5148\u7ea7\u5230\u6700\u9ad8\u4f18\u5148\u7ea7\u8fdb\u884c\u904d\u5386\uff0c\u5e76\u4e14\u5904\u7406\u5728\u7b2c\u4e00\u6b21\u5339\u914d\u65f6\u505c\u6b62\uff0c\u6240\u4ee5\u60a8\u9700\u8981\u5728\u4e0d\u592a\u5177\u4f53\u7684\u60c5\u51b5\u4e0b\u653e\u7f6e\u66f4\u5177\u4f53\u7684\u89c4\u5219\u3002\u4ee5\u4e0a\u793a\u4f8b\u6f14\u793a\u4e86192.0.2.0/24\u53ca\u5176\u5b50\u7f51192.0.2.0/25\u7684\u89c4\u5219\u3002\u5982\u679c\u4f18\u5148\u987a\u5e8f\u88ab\u98a0\u5012\u8fc7\u6765\uff0c\u800c\u4e14/ 25\u7684\u89c4\u5219\u88ab\u7f6e\u4e8e24\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u90a3\u6c38\u8fdc\u4e0d\u4f1a\u8fbe\u5230\u3002 \u663e\u793a\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u663e\u793a ip-6\u89c4\u5219\u663e\u793a \u5220\u9664\u89c4\u5219 ip rule del $ {options} $ {action} \u4f8b\u5b50\uff1a ip rule del 192.0.2.0/24\u67e5\u627e10 \u6ce8\u610f\uff1a\u60a8\u53ef\u4ee5\u4ece\u201cip rule show\u201d/\u201cip -6 rule show\u201d\u7684\u8f93\u51fa\u590d\u5236/\u7c98\u8d34\u3002 \u5220\u9664\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u5237\u65b0 ip-6\u89c4\u5219\u5237\u65b0 \u6ce8\uff1a\u6b64\u64cd\u4f5c\u5177\u6709\u9ad8\u5ea6\u7834\u574f\u6027\u3002\u5373\u4f7f\u60a8\u6ca1\u6709\u914d\u7f6e\u4efb\u4f55\u89c4\u5219\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u521d\u59cb\u5316\u201c\u4ece\u6240\u6709\u4e3b\u67e5\u627e\u201d\u89c4\u5219\u3002\u5728\u672a\u914d\u7f6e\u7684\u673a\u5668\u4e0a\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\uff1a $ ip\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 32767\uff1a\u4ece\u6240\u6709\u67e5\u627e\u9ed8\u8ba4 $ ip -6\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 \u201c\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730\u201d\u89c4\u5219\u662f\u7279\u6b8a\u7684\uff0c\u4e0d\u80fd\u88ab\u5220\u9664\u3002\u201c\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981\u201d\u4e0d\u662f\uff0c\u53ef\u80fd\u6709\u6ca1\u6709\u5b83\u7684\u6b63\u5f53\u7406\u7531\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u60f3\u8def\u7531\u4f60\u521b\u5efa\u663e\u5f0f\u89c4\u5219\u7684\u6d41\u91cf\u3002\u4f5c\u4e3a\u4e00\u4e2a\u526f\u4f5c\u7528\uff0c\u5982\u679c\u4f60\u505a\u201cip rule flush\u201d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5c06\u88ab\u5220\u9664\uff0c\u8fd9\u5c06\u4f7f\u7cfb\u7edf\u505c\u6b62\u8def\u7531\u4efb\u4f55\u6d41\u91cf\uff0c\u76f4\u5230\u4f60\u6062\u590d\u4f60\u7684\u89c4\u5219\u3002 \u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u7ba1\u7406 \u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u662f\u5355\u4e2a\u673a\u5668\u4e2d\u9694\u79bb\u7684\u7f51\u7edc\u5806\u6808\u5b9e\u4f8b\u3002\u5b83\u4eec\u53ef\u7528\u4e8e\u5b89\u5168\u57df\u5206\u79bb\uff0c\u7ba1\u7406\u865a\u62df\u673a\u4e4b\u95f4\u7684\u6d41\u91cf\u7b49\u3002 \u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u90fd\u662f\u5177\u6709\u81ea\u5df1\u7684\u63a5\u53e3\uff0c\u5730\u5740\uff0c\u8def\u7531\u7b49\u7684\u7f51\u7edc\u5806\u6808\u7684\u5b8c\u6574\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u8fd0\u884c\u8fdb\u7a0b\uff0c\u5e76\u5c06\u547d\u540d\u7a7a\u95f4\u6865\u63a5\u5230\u7269\u7406\u63a5\u53e3\u3002 \u521b\u5efa\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4 ip netns\u6dfb\u52a0$ {\u547d\u540d\u7a7a\u95f4\u540d\u79f0} \u4f8b\u5b50\uff1a ip netns\u6dfb\u52a0foo \u5217\u51fa\u73b0\u6709\u7684\u547d\u540d\u7a7a\u95f4 ip netns\u5217\u8868 \u5220\u9664\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4 ip netns\u5220\u9664$ {namespace name} \u4f8b\u5b50\uff1a ip netns\u5220\u9664foo \u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4e00\u4e2a\u8fdb\u7a0b ip netns exec $ {namespace name} $ {command} \u4f8b\u5b50\uff1a ip netns exec foo / bin / sh \u6ce8\u610f\uff1a\u5c06\u8fdb\u7a0b\u5206\u914d\u7ed9\u975e\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u9700\u8981root\u6743\u9650\u3002 \u4f60\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4efb\u4f55\u8fdb\u7a0b\uff0c\u7279\u522b\u662f\u4f60\u53ef\u4ee5\u8fd0\u884c\u201cip\u201d\u672c\u8eab\uff0c\u672c\u8282\u4e2d\u7684\u547d\u4ee4\u201cip netns exec foo ip link list\u201d\u4e0d\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u8bed\u6cd5\uff0c\u800c\u662f\u7b80\u5355\u5730\u6267\u884c\u53e6\u4e00\u4e2a\u201cip\u201d\u526f\u672c\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4\u3002\u60a8\u4e5f\u53ef\u4ee5\u5728\u540d\u79f0\u7a7a\u95f4\u5185\u8fd0\u884c\u4ea4\u4e92\u5f0fshell\u3002 \u5217\u51fa\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4\u7684\u6240\u6709\u8fdb\u7a0b ip netns pids $ {namespace name} \u8f93\u51fa\u5c06\u662f\u4e00\u4e2aPID\u5217\u8868\u3002 \u786e\u5b9a\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4 ip netns\u6807\u8bc6$ {pid} \u4f8b\u5b50\uff1a ip netns\u8bc6\u522b9000 \u5c06\u7f51\u7edc\u63a5\u53e3\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4 ip link set dev $ {interface name} netns $ {namespace name} ip link set dev $ {interface name} netns $ {pid} \u4f8b\u5b50\uff1a ip link set dev eth0.100 netns foo \u6ce8\u610f\uff1a\u4e00\u65e6\u4f60\u7ed9\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u5206\u914d\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c\u5b83\u5c06\u4ece\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u6d88\u5931\uff0c\u4f60\u5c06\u4e0d\u5f97\u4e0d\u901a\u8fc7\u201cip netns exec $ {netspace name}\u201d\u6267\u884c\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u5982\u201cip netns exec $ {netspace name} ip link set dev dummy0 down\u201c\u3002 \u800c\u4e14\uff0c\u5f53\u60a8\u5c06\u63a5\u53e3\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\u65f6\uff0c\u5b83\u4f1a\u4e22\u5931\u6240\u6709\u5df2\u914d\u7f6e\u7684\u914d\u7f6e\uff0c\u4f8b\u5982\u914d\u7f6e\u7684IP\u5730\u5740\u5e76\u8fdb\u5165DOWN\u72b6\u6001\u3002\u60a8\u9700\u8981\u5c06\u5176\u6062\u590d\u5e76\u91cd\u65b0\u914d\u7f6e\u3002 \u5982\u679c\u60a8\u6307\u5b9a\u4e00\u4e2aPID\u800c\u4e0d\u662f\u547d\u540d\u7a7a\u95f4\u540d\u79f0\uff0c\u5219\u8be5\u63a5\u53e3\u5c06\u88ab\u5206\u914d\u5230\u5177\u6709\u8be5PID\u7684\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4f8b\u5982\u201cip netns exec $ {namespace name} ip link set dev $ {intf} netns 1\u201d\u5c06\u63a5\u53e3\u91cd\u65b0\u5206\u914d\u56de\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\uff08\u56e0\u4e3a\u521d\u59cb\u5316\u6216\u5176\u4ed6PID 1\u7684\u8fdb\u7a0b\u51e0\u4e4e\u53ef\u4ee5\u4fdd\u8bc1\u5904\u4e8e\u9ed8\u8ba4\u72b6\u6001\u547d\u540d\u7a7a\u95f4\uff09\u3002 \u5c06\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a \u8fd9\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u4e24\u4e2aveth\u94fe\u63a5\u5e76\u4e3a\u5b83\u4eec\u5206\u914d\u4e24\u4e2a\u4e0d\u540c\u7684\u540d\u79f0\u7a7a\u95f4\u6765\u5b8c\u6210\u3002\u5047\u8bbe\u4f60\u60f3\u5c06\u547d\u540d\u7a7a\u95f4\u201cfoo\u201d\u8fde\u63a5\u5230\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u521b\u5efa\u4e00\u5bf9veth\u8bbe\u5907\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth1\u7c7b\u578bveth peer name veth2 \u5c06veth2\u79fb\u52a8\u5230\u540d\u79f0\u7a7a\u95f4foo\uff1a ip link set dev veth2 netns foo \u5e26\u4e0aveth2\u5e76\u5728\u201cfoo\u201d\u547d\u540d\u7a7a\u95f4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff1a ip netns exec foo ip link set dev veth2 up ip netns exec foo ip address add 10.1.1.1/24 dev veth2 \u5411veth1\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff0c\u8be5\u5730\u5740\u4fdd\u7559\u5728\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u4e2d\uff1a ip address add 10.1.1.2/24 dev veth1 \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5ping 10.1.1.1\uff0c\u5982\u679c\u5728foo\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5e76\u4e14\u8bbe\u7f6e\u8def\u7531\u5230\u5728\u8be5\u547d\u540d\u7a7a\u95f4\u7684\u5176\u4ed6\u63a5\u53e3\u4e2d\u914d\u7f6e\u7684\u5b50\u7f51\u7684\u8def\u7531\u3002 \u5982\u679c\u60a8\u60f3\u8981\u5207\u6362\u800c\u4e0d\u662f\u8def\u7531\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bveth\u63a5\u53e3\u4e0e\u76f8\u5e94\u540d\u79f0\u7a7a\u95f4\u4e2d\u7684\u5176\u4ed6\u63a5\u53e3\u8fdb\u884c\u6865\u63a5\u3002\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6280\u672f\u5c06\u540d\u79f0\u7a7a\u95f4\u8fde\u63a5\u5230\u7269\u7406\u7f51\u7edc\u3002 \u76d1\u89c6\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u5b50\u7cfb\u7edf\u4e8b\u4ef6 ip netns\u76d1\u89c6\u5668 \u663e\u793a\u4e8b\u4ef6\uff0c\u4f8b\u5982\u521b\u5efa\u548c\u5220\u9664\u540d\u79f0\u7a7a\u95f4\u3002 \u591a\u64ad\u7ba1\u7406 \u591a\u64ad\u4e3b\u8981\u7531\u5e94\u7528\u7a0b\u5e8f\u548c\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u5904\u7406\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u505a\u7684\u5e76\u4e0d\u591a\uff0c\u800c\u4e14\u5e94\u8be5\u5728\u8fd9\u91cc\u624b\u52a8\u5b8c\u6210\u3002\u591a\u64ad\u76f8\u5173\u7684ip\u547d\u4ee4\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5\u3002 \u67e5\u770b\u591a\u64ad\u7ec4 ip maddress\u8282\u76ee ip maddress show $ {interface name} \u4f8b\uff1a $ ip maddress show dev lo 1\uff1alo inet 224.0.0.1 inet6 ff02 :: 1 inet6 ff01 :: 1 \u6dfb\u52a0\u94fe\u8def\u5c42\u591a\u64ad\u5730\u5740 \u60a8\u4e0d\u80fd\u624b\u52a8\u52a0\u5165IP\u591a\u64ad\u7ec4\uff0c\u4f46\u53ef\u4ee5\u6dfb\u52a0\u591a\u64adMAC\u5730\u5740\uff08\u5c3d\u7ba1\u5f88\u5c11\u9700\u8981\uff09\u3002 ip maddress add $ {MAC\u5730\u5740} dev $ {\u63a5\u53e3\u540d\u79f0} \u4f8b\uff1a ip maddress\u6dfb\u52a001\uff1a00\uff1a5e\uff1a00\uff1a00\uff1aab dev eth0 \u67e5\u770b\u7ec4\u64ad\u8def\u7531 \u7ec4\u64ad\u8def\u7531\u65e0\u6cd5\u624b\u52a8\u6dfb\u52a0\uff0c\u56e0\u6b64\u6b64\u547d\u4ee4\u53ea\u80fd\u663e\u793a\u7531\u8def\u7531\u5b88\u62a4\u7a0b\u5e8f\u5b89\u88c5\u7684\u7ec4\u64ad\u8def\u7531\u3002\u5b83\u652f\u6301\u76f8\u540c\u7684\u4fee\u9970\u7b26\u6765\u5355\u64ad\u8def\u7531\u67e5\u770b\u547d\u4ee4\uff08iif\uff0ctable\uff0cfrom\u7b49\uff09\u3002 ip mroute\u663e\u793a \u7f51\u7edc\u4e8b\u4ef6\u76d1\u63a7 \u60a8\u53ef\u4ee5\u4f7f\u7528iproute2\u76d1\u89c6\u67d0\u4e9b\u7f51\u7edc\u4e8b\u4ef6\uff0c\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\uff0c\u8def\u7531\u8868\u548cARP / NDP\u8868\u4e2d\u7684\u66f4\u6539\u3002 \u76d1\u63a7\u6240\u6709\u4e8b\u4ef6 \u60a8\u53ef\u4ee5\u4e0d\u5e26\u53c2\u6570\u5730\u8c03\u7528\u8be5\u547d\u4ee4\uff0c\u6216\u8005\u660e\u786e\u6307\u5b9a\u201c\u5168\u90e8\u201d\u3002 IP\u76d1\u89c6\u5668 ip\u76d1\u89c6\u6240\u6709 \u76d1\u89c6\u7279\u5b9a\u4e8b\u4ef6 ip monitor $ {event type} \u4e8b\u4ef6\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a \u94fe\u63a5 \u94fe\u8def\u72b6\u6001\uff1a\u63a5\u53e3\u4e0a\u4e0b\uff0c\u865a\u62df\u63a5\u53e3\u88ab\u521b\u5efa\u6216\u9500\u6bc1\u7b49\u3002 \u5730\u5740 \u94fe\u63a5\u5730\u5740\u66f4\u6539\u3002 \u8def\u7ebf \u8def\u7531\u8868\u66f4\u6539\u3002 mroute \u7ec4\u64ad\u8def\u7531\u66f4\u6539\u3002 \u5636 \u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u4e2d\u7684\u66f4\u6539\u3002 \u5f53\u5b58\u5728\u4e0d\u540c\u7684IPv4\u548cIPv6\u5b50\u7cfb\u7edf\u65f6\uff0c\u901a\u5e38\u7684\u201c-4\u201d\u548c\u201c-6\u201d\u9009\u9879\u5141\u8bb8\u60a8\u4ec5\u663e\u793a\u6307\u5b9a\u534f\u8bae\u7684\u4e8b\u4ef6\u3002\u5982\uff1a ip -4\u76d1\u63a7\u8def\u7531 ip-6\u76d1\u89c6\u5668\u90bb\u5c45 ip -4\u76d1\u89c6\u5668\u5730\u5740 \u9605\u8bfbrtmon\u751f\u6210\u7684\u65e5\u5fd7\u6587\u4ef6 iproute2\u5305\u542b\u4e00\u4e2a\u540d\u4e3a\u201crtmon\u201d\u7684\u7a0b\u5e8f\uff0c\u5176\u529f\u80fd\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u5c06\u4e8b\u4ef6\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6\u800c\u4e0d\u662f\u663e\u793a\u5b83\u4eec\u3002\u201cip monitor\u201d\u547d\u4ee4\u5141\u8bb8\u60a8\u8bfb\u53d6\u7531\u7a0b\u5e8f\u521b\u5efa\u7684\u6587\u4ef6\u201c\u3002 ip monitor $ {event type}\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84} rtmon\u8bed\u6cd5\u4e0e\u201cip monitor\u201d\u7c7b\u4f3c\uff0c\u9664\u4e86\u4e8b\u4ef6\u7c7b\u578b\u4ec5\u9650\u4e8e\u94fe\u63a5\uff0c\u5730\u5740\uff0c\u8def\u7531\u548c\u5168\u90e8; \u548c\u5730\u5740\u65cf\u5728\u201c-family\u201d\u9009\u9879\u4e2d\u6307\u5b9a\u3002 rtmon [-family ] [<\u8def\u7531|\u94fe\u63a5|\u5730\u5740|\u6240\u6709>]\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84} netconf\uff08sysctl\u914d\u7f6e\u67e5\u770b\uff09 \u67e5\u770b\u6240\u6709\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf\u663e\u793a \u67e5\u770b\u7279\u5b9a\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf show dev $ {interface} \u4f8b\u5b50\uff1a ip netconf show dev eth0 Net-tools \u00b6 netstat \u00b6 netstat [ - vWeenNcCF ] [ < Af > ] - r netstat [ - vWnNcaeol ] [ < Socket > ...] netstat { [ - vWeenNac ] - i | [ - cnNe ] - M | - s [ - 6 tuw ] } < Socket >= { - t | --tcp} {-u|--udp} {-U|--udplite} {-S|--sctp} {-w|--raw} { - x | --unix} --ax25 --ipx --netrom < AF >= Use '-6|-4' or '-A <af>' or '--<af>' \uff1b\u9ed8\u8ba4\uff1a inet \u5217\u51fa\u6240\u6709\u652f\u6301\u7684\u534f\u8bae\uff1a inet ( DARPA Internet ) inet6 ( IPv6 ) ax25 ( AMPR AX . 25 ) netrom ( AMPR NET / ROM ) ipx ( Novell IPX ) ddp ( Appletalk DDP ) x25 ( CCITT X . 25 ) - r , --route \u663e\u793a\u8def\u7531\u8868 - i , --interfaces \u663e\u793a\u7f51\u7edc\u63a5\u53e3\u8868 - g , --groups \u663e\u793a\u7ec4\u64ad\u7ec4\u6210\u5458\u5173\u7cfb - s , --statistics display networking statistics (like SNMP) - t , --tcp \u663e\u793aTCP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - u , --udp \u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - M , --masquerade \u663e\u793a\u4f2a\u88c5\u7684\u7f51\u7edc\u8fde\u63a5 - v , --verbose \u663e\u793a\u8be6\u7ec6\u4fe1\u606f - w , --raw \u663e\u793aRAW\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - W , --wide don't truncate IP addresses - n , --numeric \u4e0d\u89e3\u6790\u540d\u79f0,\u76f4\u63a5\u4f7f\u7528IP --numeric-hosts \u4e0d\u89e3\u6790\u4e3b\u673a\u540d --numeric-ports \u5ffd\u7565\u7aef\u53e3\u540d\u79f0 --numeric-users \u5ffd\u7565\u7528\u6237\u540d - A , --protocol=family \u5217\u51fa\u5bf9\u5e94\u534f\u8bae\u7c7b\u578b\u8fde\u7ebf\u4e2d\u7684\u76f8\u5173\u5730\u5740(family\uff1ainet\uff0cinet6\uff0cunix\uff0cipx\uff0cax25\uff0cnetrom\uff0ceconet\uff0cddp\u548cbluetooth) - x , --unix \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A unix\"\u53c2\u6570\u76f8\u540c --ip,--inet \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A inet\"\u53c2\u6570\u76f8\u540c - N , --symbolic \u89e3\u6790\u786c\u4ef6\u3001\u5916\u56f4\u8bbe\u5907\u7684\u7b26\u53f7\u8fde\u63a5\u540d\u79f0 - e , --extend \u663e\u793a\u7f51\u7edc\u4e2d\u5176\u4ed6\u66f4\u591a\u4fe1\u606f - p , --programs \u663e\u793a\u6b63\u5728\u4f7f\u7528Socket\u7684\u8fdb\u7a0bPID\u548c\u7a0b\u5e8f\u540d\u79f0 - o , --timers display timers(\u663e\u793a\u8ba1\u65f6\u5668) - c , --continuous \u6301\u7eed\u5217\u51fa\u7f51\u7edc\u72b6\u6001(\u9ed8\u8ba41s) - l , --listening \u663e\u793a\u4fa6\u542c\u670d\u52a1\u5668sockets - a , --all \u663e\u793a\u6240\u6709\u8fde\u7ebf\u4e2d\u7684Socket(default: connected) - F , --fib \u4eceFIB(forwarding information base)\u6253\u5370\u8def\u7531\u4fe1\u606f(default) - C , --cache \u4ece\u8def\u7531\u7f13\u5b58\u4e2d\u6253\u5370\u8def\u7531\u4fe1\u606f - Z , --context \u663e\u793asockets\u7684SELinux security context netstat\u5b9e\u4f8b \u00b6 # \u5217\u51fa\u6240\u6709\u7aef\u53e3 (\u5305\u62ec\u76d1\u542c\u548c\u672a\u76d1\u542c\u7684) netstat -a #\u5217\u51fa\u6240\u6709\u7aef\u53e3 netstat -at #\u5217\u51fa\u6240\u6709tcp\u7aef\u53e3 netstat -au #\u5217\u51fa\u6240\u6709udp\u7aef\u53e3 netstat -ng #\u67e5\u770b\u7ec4\u64ad\u60c5\u51b5 # \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684 Sockets netstat -l #\u53ea\u663e\u793a\u76d1\u542c\u7aef\u53e3 netstat -lt #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c tcp \u7aef\u53e3 netstat -lu #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c udp \u7aef\u53e3 netstat -lx #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c UNIX \u7aef\u53e3 # \u663e\u793a\u6bcf\u4e2a\u534f\u8bae\u7684\u7edf\u8ba1\u4fe1\u606f netstat -s \u663e\u793a\u6240\u6709\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -st \u663e\u793aTCP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -su \u663e\u793aUDP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -pt # \u5728netstat\u8f93\u51fa\u4e2d\u663e\u793a PID \u548c\u8fdb\u7a0b\u540d\u79f0 netstat - p \u53ef\u4ee5\u4e0e\u5176\u5b83\u5f00\u5173\u4e00\u8d77\u4f7f\u7528\uff0c\u5c31\u53ef\u4ee5\u6dfb\u52a0\u201cPID/\u8fdb\u7a0b\u540d\u79f0\u201d\u5230netstat\u8f93\u51fa\u4e2d\uff0c\u8fd9\u6837debugging\u7684\u65f6\u5019\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u53d1\u73b0\u7279\u5b9a\u7aef\u53e3\u8fd0\u884c\u7684\u7a0b\u5e8f\u3002 \u5728netstat\u8f93\u51fa\u4e2d\u4e0d\u663e\u793a\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d(host, port or user) \u00b6 # \u5f53\u4f60\u4e0d\u60f3\u8ba9\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d\u663e\u793a\uff0c\u4f7f\u7528`netstat -n`\u3002\u5c06\u4f1a\u4f7f\u7528\u6570\u5b57\u4ee3\u66ff\u90a3\u4e9b\u540d\u79f0\u3002\u540c\u6837\u53ef\u4ee5\u52a0\u901f\u8f93\u51fa\uff0c\u56e0\u4e3a\u4e0d\u7528\u8fdb\u884c\u6bd4\u5bf9\u67e5\u8be2\u3002 netstat -an # \u5982\u679c\u53ea\u662f\u4e0d\u60f3\u8ba9\u8fd9\u4e09\u4e2a\u540d\u79f0\u4e2d\u7684\u4e00\u4e2a\u88ab\u663e\u793a\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4: netsat -a --numeric-ports netsat -a --numeric-hosts netsat -a --numeric-users # \u627e\u51fa\u7a0b\u5e8f\u8fd0\u884c\u7684\u7aef\u53e3,\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8fdb\u7a0b\u90fd\u80fd\u627e\u5230\uff0c\u6ca1\u6709\u6743\u9650\u7684\u4f1a\u4e0d\u663e\u793a\uff0c\u4f7f\u7528 root \u6743\u9650\u67e5\u770b\u6240\u6709\u7684\u4fe1\u606f netstat -ap | grep ssh # \u627e\u51fa\u8fd0\u884c\u5728\u6307\u5b9a\u7aef\u53e3\u7684\u8fdb\u7a0b netstat -an | grep ':80' \u547d\u4ee4\u62c6\u5206 \u8be6\u89e3 /^tcp/ \u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\uff0c\u201c^\u201d\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u7528\u6cd5\uff0c\u4ee5...\u5f00\u5934\uff0c\u8fd9\u91cc\u662f\u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\u3002 S[] \u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u53ebS\u7684\u6570\u7ec4\uff0c\u5728awk\u4e2d\uff0c\u6570\u7ec4\u4e0b\u6807\u901a\u5e38\u4ece 1 \u5f00\u59cb\uff0c\u800c\u4e0d\u662f 0\u3002 NF \u5f53\u524d\u8bb0\u5f55\u91cc\u57df\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4ee5\u7a7a\u683c\u5206\u9694\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0cNF\u57df\u4e2a\u6570\u7b49\u4e8e6 $NF \u8868\u793a\u4e00\u884c\u7684\u6700\u540e\u4e00\u4e2a\u57df\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c NF\u4e5f\u5c31\u662f NF\u4e5f\u5c31\u662f 6\uff0c\u8868\u793a\u7b2c6\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u4e5f\u5c31\u662fSYN_RECV\u6216TIME_WAIT\u7b49\u3002 S[$NF] \u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662fS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570 ++S[$NF] \u8868\u793a\u628a\u67d0\u4e2a\u6570\u52a0\u4e00\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662f\u628aS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570\u52a0\u4e00 END \u7ed3\u675f forkey in S \u904d\u5386S[]\u6570\u7ec4 print key,\u201d\\t\u201d,S[key] \u6253\u5370\u6570\u7ec4\u7684\u952e\u548c\u503c\uff0c\u4e2d\u95f4\u7528\\t\u5236\u8868\u7b26\u5206\u5272\uff0c\u663e\u793a\u597d\u4e00\u4e9b\u3002 IP\u548cTCP\u5206\u6790 \u00b6 #\u67e5\u770b\u8fde\u63a5\u67d0\u670d\u52a1\u7aef\u53e3\u524d20\u4e2aIP\u5730\u5740\u53ca\u8fde\u63a5\u6570\uff1a netstat -ntu | grep :80 | awk '{print $5}' | cut -d: -f1 | awk '{++ip[$1]} END {for(i in ip) print ip[i],\"\\t\",i}' | sort -nr | head -n 20 netstat -anlp | grep 80 | grep tcp | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | head -n 20 netstat -nat | awk '/:80/{split($5,ip,\":\");++A[ip[1]]}END{for(i in A) print A[i],i}' | sort -rn | head -n 20 netstat -nat | grep \":80\" | grep ESTABLISHED | awk '{printf \"%s %s\\n\",$5,$6}' | sort -rn | head -n 20 # \u6839\u636e\u7aef\u53e3\u5217\u51fa\u8fdb\u7a0b netstat -ntlp | grep 80 | awk '{print $7}' | cut -d: -f1 # \u7528tcpdump\u55c5\u63a280\u7aef\u53e3\u524d\u7684\u8bbf\u95ee\u91cf tcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F \".\" '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -nr | head -20 # \u67e5\u770bphpcgi\u8fdb\u7a0b\u6570\uff0c\u5982\u679c\u63a5\u8fd1\u9884\u8bbe\u503c\uff0c\u8bf4\u660e\u4e0d\u591f\u7528\uff0c\u9700\u8981\u589e\u52a0 netstat -anpo | grep \"php-cgi\" | wc -l # \u67e5\u770bTCP\u8fde\u63a5\u72b6\u6001\u3001\u5e76\u53d1\u53ca\u8fde\u63a5\u6570\u7684\u547d\u4ee4 netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' netstat -nat | awk '{print $NF}' | grep -v '[a-z]' | sort | uniq -c | sort -rn netstat -n | awk '/^tcp/ {++state[$NF]}; END {for(key in state) print key,\"\\t\",state[key]}' netstat -n | awk '/^tcp/ {++arr[$NF]};END {for(k in arr) print k,\"\\t\",arr[k]}' netstat -nt | grep -e 127 .0.0.1 -e 0 .0.0.0 -e ::: -v | awk '/^tcp/ {++state[$NF]} END {for(i in state) print i,\"\\t\",state[i]}' # \u67e5\u627e\u524d20\u7684time_wait\u8fde\u63a5 netstat -n | grep TIME_WAIT | awk '{print $5}' | sort | uniq -c | sort -rn | head -n 20 # \u67e5\u627e\u67e5\u524d20\u7684SYN\u8fde\u63a5 netstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | head -n 20 # \u7edf\u8ba1\u670d\u52a1\u5668\u5f53\u524d\u5355IP\u8fde\u63a5\u6570\u6700\u5927\u7684IP\u5730\u5740\u524d\u5341 netstat -an | grep EST | awk -F '[ :]+' '{++S[$6]} END {for (key in S) print \"ip:\"key\"----->\",S[key]}' | sort -rn -k2 TCP\u72b6\u6001\u8bf4\u660e \u00b6 \u72b6\u6001 \u63cf\u8ff0 CLOSED \u65e0\u8fde\u63a5\u662f\u6d3b\u52a8\u7684\u6216\u6b63\u5728\u8fdb\u884c LISTEN \u670d\u52a1\u5668\u5728\u7b49\u5f85\u8fdb\u5165\u547c\u53eb SYN_RECV \u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u5df2\u7ecf\u5230\u8fbe SYN_SENT \u5e94\u7528\u5df2\u7ecf\u5f00\u59cb ESTABLISHED \u6b63\u5e38\u6570\u636e\u4f20\u8f93\u72b6\u6001 FIN_WAIT1 \u5e94\u7528\u8bf4\u5b83\u5df2\u7ecf\u5b8c\u6210 FIN_WAIT2 \u53e6\u4e00\u8fb9\u5df2\u540c\u610f\u91ca\u653e ITMED_WAIT \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389 CLOSING \u4e24\u8fb9\u540c\u65f6\u5c1d\u8bd5\u5173\u95ed TIME_WAIT \u53e6\u4e00\u8fb9\u5df2\u521d\u59cb\u5316\u4e00\u4e2a\u91ca\u653e LAST_ACK \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389 tcp\u8fde\u63a5\u72b6\u6001\u7684\u63cf\u8ff0\u8bf4\u660e(netstat\u8f93\u51fa) \u00b6 Active Internet connections (w/o servers) Proto Recv-Q Send-Q Local AddressForeign AddressState Proto The protocol (tcp, udp, raw) used by the socket. \u7b2c\u4e00\u5217\u4e3asocket\u4f7f\u7528\u7684\u534f\u8bae\u3002 Recv-Q The count of bytes not copied by the user program connected to this socket. \u7b2c\u4e8c\u5217\u4e3a\u63a5\u5230\u7684\u4f46\u662f\u8fd8\u6ca1\u5904\u7406\u7684\u5b57\u8282\u6570\u3002 Send-Q The count of bytes not acknowledged by the remote host. \u7b2c\u4e09\u5217\u4e3a\u5df2\u7ecf\u53d1\u9001\u7684\u4f46\u662f\u6ca1\u6709\u88ab\u8fdc\u7a0b\u4e3b\u673a\u786e\u8ba4\u6536\u5230\u7684\u5b57\u8282\u6570\u3002 Local Address Address and port number of the local end of the socket.Unless the --numeric(-n) optionisspecified,thesocketaddress is resolved to its canonical host name (FQDN), and the port number is translated into the corresponding service name. \u7b2c\u56db\u5217\u4e3a \u672c\u5730\u7684\u5730\u5740\u53ca\u7aef\u53e3\u3002 Foreign Address Address and port number of the remote endofthesocket.Analogousto\"Local Address.\" \u7b2c\u4e94\u5217\u4e3a\u5916\u90e8\u7684\u5730\u5740\u53ca\u7aef\u53e3\u3002 State Thestateofthesocket.Sincethere are no states in raw mode and usually no states used in UDP, this column may be left blank. Normally this can be one of sev- eral values: \u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217\u3002 netstat\u7b2c\u516d\u5217State\u7684\u72b6\u6001\u4fe1\u606f State Thestateofthesocket.Sincethere are no states in raw mode and usually no states used in UDP, this column may be left blank. Normally this can be one of sev- eral values: \u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217\u3002 ESTABLISHED The socket has an established connection. socket\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\uff0c\u8868\u793a\u5904\u4e8e\u8fde\u63a5\u7684\u72b6\u6001\uff0c\u4e00\u822c\u8ba4\u4e3a\u6709\u4e00\u4e2aESTABLISHED\u8ba4\u4e3a\u662f\u4e00\u4e2a\u670d\u52a1\u7684\u5e76\u53d1\u8fde\u63a5\u3002\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8\u3002 SYN_SENT The socket is actively attempting to establish a connection. socket\u6b63\u5728\u79ef\u6781\u5c1d\u8bd5\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u5373\u5904\u4e8e\u53d1\u9001\u540e\u8fde\u63a5\u524d\u7684\u4e00\u4e2a\u7b49\u5f85\u4f46\u672a\u5339\u914d\u8fdb\u5165\u8fde\u63a5\u7684\u72b6\u6001\u3002 SYN_RECV A connection request has been received from the network. \u5df2\u7ecf\u4ece\u7f51\u7edc\u4e0a\u6536\u5230\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u3002 FIN_WAIT1 The socket is closed, and the connection is shutting down. socket\u5df2\u5173\u95ed\uff0c\u8fde\u63a5\u6b63\u5728\u6216\u6b63\u8981\u5173\u95ed\u3002 FIN_WAIT2 Connectionisclosed,andthesocket is waiting for a shutdown from the remote end. \u8fde\u63a5\u5df2\u5173\u95ed\uff0c\u5e76\u4e14socket\u6b63\u5728\u7b49\u5f85\u8fdc\u7aef\u7ed3\u675f\u3002 TIME_WAIT The socket is waiting after close to handle packets still in the network. socket\u6b63\u5728\u7b49\u5f85\u5173\u95ed\u5904\u7406\u4ecd\u5728\u7f51\u7edc\u4e0a\u7684\u6570\u636e\u5305\uff0c\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8\u3002 CLOSED The socket is not being used.| socket\u4e0d\u5728\u88ab\u5360\u7528\u4e86\u3002 CLOSE_WAIT The remote end has shutdown, waiting for the socket to close. \u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u7b49\u5f85socket\u5173\u95ed\u3002 LAST_ACK The remote end has shut down, and the socket is closed. Waiting for acknowl-edgement.| \u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u5e76\u4e14socket\u4e5f\u5df2\u5173\u95ed\uff0c\u7b49\u5f85acknowl-edgement\u3002 LISTEN Thesocketislisteningforincoming connections.Such sockets are not included in the output unless you specify the --listening (-l) or --all (-a) option. socket\u6b63\u5728\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\u3002 CLOSING Both sockets are shut down but we still don\u2019t have all our data sent. sockets\u5173\u95ed\uff0c\u4f46\u662f\u6211\u4eec\u4ecd\u65e7\u6ca1\u6709\u53d1\u9001\u6570\u636e\u3002 UNKNOWN The state of the socket is unknown \u672a\u77e5\u7684\u72b6\u6001\u3002 # \u65e5\u5fd7\u5206\u6790\u7bc7(Apache)\uff1a # \u5f97\u8bbf\u95ee\u524d10\u4f4d\u7684ip\u5730\u5740 cat access.log | awk '{print $1}' | sort | uniq -c | sort -nr | head -10 cat access.log | awk '{counts[$(11)]+=1}; END {for(url in counts) print counts[url], url}' # \u95ee\u6b21\u6570\u6700\u591a\u7684\u6587\u4ef6\u6216\u9875\u9762,\u53d6\u524d20 cat access.log | awk '{print $11}' | sort | uniq -c | sort -nr | head -20 # \u51fa\u4f20\u8f93\u6700\u5927\u7684\u51e0\u4e2aexe\u6587\u4ef6\uff08\u5206\u6790\u4e0b\u8f7d\u7ad9\u7684\u65f6\u5019\u5e38\u7528\uff09 cat access.log | awk '($7~/\\.exe/){print $10 \" \" $1 \" \" $4 \" \" $7}' | sort -nr | head -20 # \u51fa\u8f93\u51fa\u5927\u4e8e200000byte(\u7ea6200kb)\u7684exe\u6587\u4ef6\u4ee5\u53ca\u5bf9\u5e94\u6587\u4ef6\u53d1\u751f\u6b21\u6570 cat access.log | awk '($10 > 200000 && $7~/\\.exe/){print $7}' | sort -n | uniq -c | sort -nr | head -100 # \u679c\u65e5\u5fd7\u6700\u540e\u4e00\u5217\u8bb0\u5f55\u7684\u662f\u9875\u9762\u6587\u4ef6\u4f20\u8f93\u65f6\u95f4\uff0c\u5219\u6709\u5217\u51fa\u5230\u5ba2\u6237\u7aef\u6700\u8017\u65f6\u7684\u9875\u9762 cat access.log | awk '($7~/\\.php/){print $NF \" \" $1 \" \" $4 \" \" $7}' | sort -nr | head -100 # \u51fa\u6700\u6700\u8017\u65f6\u7684\u9875\u9762(\u8d85\u8fc760\u79d2\u7684)\u7684\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570 cat access.log | awk '($NF > 60 && $7~/\\.php/){print $7}' | sort -n | uniq -c | sort -nr | head -100 # \u51fa\u4f20\u8f93\u65f6\u95f4\u8d85\u8fc7 30 \u79d2\u7684\u6587\u4ef6 cat access.log | awk '($NF > 30){print $7}' | sort -n | uniq -c | sort -nr | head -20 # \u8ba1\u7f51\u7ad9\u6d41\u91cf\uff08G) cat access.log | awk '{sum+=$10} END {print sum/1024/1024/1024}' # \u8ba1404\u7684\u8fde\u63a5 awk '($9 ~/404/)' access.log | awk '{print $9,$7}' | sort # \u8ba1http status. cat access.log | awk '{counts[$(9)]+=1}; END {for(code in counts) print code, counts[code]}' cat access.log | awk '{print $9}' | sort | uniq -c | sort -rn # \u86db\u5206\u6790--\u67e5\u770b\u662f\u54ea\u4e9b\u8718\u86db\u5728\u6293\u53d6\u5185\u5bb9\u3002 /usr/sbin/tcpdump -i eth0 -l -s 0 -w - dst port 80 | strings | grep -i user-agent | grep -i -E 'bot|crawler|slurp|spider' # \u65e5\u5fd7\u5206\u6790\u7bc7(Squid) # \u6309\u57df\u7edf\u8ba1\u6d41\u91cf zcat squid_access.log.tar.gz | awk '{print $10,$7}' | awk 'BEGIN{FS=\"[ /]\"}{trfc[$4]+=$1}END{for(domain in trfc){printf \"%s\\t%d\\n\",domain,trfc[domain]}}' # \u6570\u636e\u5e93\u7bc7 # \u67e5\u770b\u6570\u636e\u5e93\u6267\u884c\u7684sql /usr/sbin/tcpdump -i eth0 -s 0 -l -w - dst port 3306 | strings | egrep -i 'SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER|CALL'","title":"Iproute2&Net-tools"},{"location":"Utilities/#iproute2net-tools","text":"NET-TOOLS VS IPROUTE\u5bf9\u7167 NET-TOOLS COMMANDS IPROUTE COMMANDS arp -a ip neigh arp -v ip -s neigh arp -s 192.168.1.1 1:2:3:4:5:6 ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev eth1 arp -i eth1 -d 192.168.1.1 ip neigh del 192.168.1.1 dev eth1 ifconfig -a ip addr ifconfig eth0 down ip link set eth0 down ifconfig eth0 up ip link set eth0 up ifconfig eth0 192.168.1.1 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 netmask 255.255.255.0 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 mtu 9000 ip link set eth0 mtu 9000 ifconfig eth0:0 192.168.1.2 ip addr add 192.168.1.2/24 dev eth0 netstat ss netstat -neopa ss -neopa netstat -g ip maddr route ip route route add -net 192.168.1.0 netmask 255.255.255.0 dev eth0 ip route add 192.168.1.0/24 dev eth0 route add default gw 192.168.1.1 ip route add default via 192.168.1.1","title":"Iproute2&amp;Net-tools"},{"location":"Utilities/#iproute2","text":"","title":"Iproute2"},{"location":"Utilities/#_1","text":"ip [ OPTIONS ] OBJECT { COMMAND | help } ip [ -force ] - batch filename where OBJECT : = { link | address | addrlabel | route | rule | neigh | ntable | tunnel | tuntap | maddress | mroute | mrule | monitor | xfrm | netns | l2tp | fou | macsec | tcp_metrics | token | netconf | ila } OPTIONS : = { - V [ ersion ] | - s [ tatistics ] | - d [ etails ] | - r [ esolve ] | - h [ uman-readable ] | - iec | - f [ amily ] { inet | inet6 | ipx | dnet | mpls | bridge | link } | - 4 | - 6 | - I | - D | - B | - 0 | - l [ oops ] { maximum - addr - flush - attempts } | - br [ ief ] | - o [ neline ] | - t [ imestamp ] | - ts [ hort ] | - b [ atch ] [ filename ] | - rc [ vbuf ] [ size ] | - n [ etns ] name | - a [ ll ] | ? - c [ olor ] } - s \uff1a \u8f93\u51fa\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f - f \uff1a \u5f3a\u5236\u4f7f\u7528\u6307\u5b9a\u7684\u534f\u8bae\u65cf - 4 \uff1a \u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv4\u534f\u8bae - 6 \uff1a \u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv6\u534f\u8bae - 0 \uff1a \u8f93\u51fa\u4fe1\u606f\u6bcf\u6761\u8bb0\u5f55\u8f93\u51fa\u4e00\u884c \uff0c \u5373\u4f7f\u5185\u5bb9\u8f83\u591a\u4e5f\u4e0d\u6362\u884c\u663e\u793a - r \uff1a \u663e\u793a\u4e3b\u673a\u65f6 \uff0c \u4e0d\u4f7f\u7528IP\u5730\u5740 \uff0c \u800c\u4f7f\u7528\u4e3b\u673a\u7684\u57df\u540d OBJECT # \u7f51\u7edc\u5bf9\u8c61 link # \u6307\u7f51\u7edc\u8bbe\u5907\uff0c\u901a\u8fc7\u6b64\u5bf9\u8c61\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u53ca\u66f4\u6539\u7f51\u7edc\u8bbe\u5907\u7684\u5c5e\u6027\u3002 addr # \u5730\u5740\u7ba1\u7406 neigh # arp\u8868\u7ba1\u7406 route # \u8def\u7531\u7ba1\u7406 rule # \u8def\u7531\u7b56\u7565 maddr # \u591a\u5740\u5e7f\u64ad\u5730\u5740 mroute # \u591a\u64ad\u8def\u7531\u7f13\u5b58\u7ba1\u7406 tunnel # \u901a\u9053\u7ba1\u7406 ip link # \u663e\u793a\u94fe\u8def\u4fe1\u606f ip link show dev eth0 # \u663e\u793aeth0\u63a5\u53e3\u94fe\u8def\u4fe1\u606f # \u663e\u793a\u8def\u7531ip route [\u7c7b\u4f3croute -n] ip route | column -t ip route del 192 .168.0.0/24 dev eth1 ip route add 192 .168.0.0/24 dev eth1 ip route del via 10 .2.255.254 # \u5220\u9664\u9ed8\u8ba4\u8def\u7531 ip route add via 10 .2.255.254 # \u589e\u52a0\u9ed8\u8ba4\u8def\u7531 ip route add 192 .168.1.0/24 via 192 .168.0.1 # \u589e\u52a0\u9759\u6001\u8def\u7531\uff0c192.168.0.1\u4e3a\u4e0b\u4e00\u8df3\u5730\u5740 ip route del 192 .168.1.0/24 via 192 .168.0.1 # \u5220\u9664\u9759\u6001\u8def\u7531 \u663e\u793aarp\u4fe1\u606fip neigh [ \u53ef\u4ee5\u53d6\u4ee3arp -n ] \u5220\u9664\u5219\u662fip neigh del IP\u5730\u5740 dev \u8bbe\u5907\u540d \u8def\u7531\u7b56\u7565\u6570\u636e\u5e93:\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u5927\u89c4\u6a21\u7684\u8def\u7531\u5668\uff0c\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u5bf9\u4e8e\u8def\u7531\u7684\u4e0d\u901a\u9700\u6c42\uff0c\u8def\u7531\u7b56\u7565\u6570\u636e\u5e93\u53ef\u4ee5\u5e2e\u4f60\u901a\u8fc7\u591a\u8def\u7531\u8868\u6280\u672f\u6765\u5b9e\u73b0\u3002\u5f53\u5185\u6838\u9700\u8981\u505a\u51fa\u8def\u7531\u9009\u62e9\u65f6\uff0c\u5b83\u4f1a\u627e\u51fa\u5e94\u8be5\u53c2\u8003\u54ea\u4e00\u5f20\u8def\u7531\u8868\u3002\u9664\u4e86ip\u5916,route\u4e5f\u53ef\u4ee5\u4fee\u6539main\u548clocal\u8868\u3002 \u9ed8\u8ba4\u89c4\u5219 # ip rule \u4e0a\u9762\u5217\u51fa\u4e86\u89c4\u5219\u7684\u4f18\u5148\u987a\u5e8f\u3002ip route\u547d\u4ee4\u9ed8\u8ba4\u663e\u793a\u7684\u5c31\u662fmain\u8868\u3002ip route show table all\u663e\u793a\u6240\u6709\u89c4\u5219\u4e2d\u7684\u8868 # ip route list table local broadcast 192 .168.0.255 dev eth0 proto kernel scope link src 192 .168.0.10 broadcast 10 .2.0.0 dev eth1 proto kernel scope link src 10 .2.0.217 broadcast 127 .255.255.255 dev lo proto kernel scope link src 127 .0.0.1 ... ... default\u8868\u4e3a\u7a7a \u4f8b \u7b80\u5355\u7b56\u7565\u8def\u7531\u6dfb\u52a0 [ \u5f15\u7528\u81eaLinux\u9ad8\u7ea7\u8def\u7531\u4e2d\u6587HOWTO ] \u8ba9\u6211\u4eec\u518d\u6765\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50\u3002\u6211\u6709\u4e24\u4e2aCable Modem\uff0c\u8fde\u63a5\u5230\u4e86\u4e00\u4e2a Linux\u7684NAT ( \u201c\u4f2a\u88c5\u201d ) \u8def\u7531\u5668\u4e0a\u3002\u8fd9\u91cc\u7684\u5ba4\u53cb\u4eec\u5411\u6211\u4ed8\u8d39\u4f7f\u7528Internet\u3002\u5047\u5982\u6211\u5176\u4e2d\u7684\u4e00\u4e2a\u5ba4\u53cb\u56e0\u4e3a\u53ea\u60f3\u8bbf\u95ee hotmail \u800c\u5e0c\u671b\u5c11\u4ed8\u4e00\u4e9b\u94b1\u3002\u5bf9\u6211\u6765\u8bf4\u8fd9\u6ca1\u6709\u95ee\u9898,\u4ed6\u4eec\u80af\u5b9a\u53ea\u80fd\u4f7f\u7528\u90a3\u4e2a\u6bd4\u8f83\u6b21\u7684Cable Modem\u3002 \u90a3\u4e2a\u6bd4\u8f83\u5feb\u7684cable modem \u7684IP\u5730\u5740\u662f 212 .64.94.251\uff0cPPP \u94fe\u8def\uff0c\u5bf9\u7aefIP\u662f212.64.94.1\u3002\u800c\u90a3\u4e2a\u6bd4\u8f83\u6162\u7684cable modem\u7684IP\u5730\u5740\u662f212.64.78.148\uff0c\u5bf9\u7aef\u662f195.96.98.253\u3002 local \u8868\uff1a #ip route list table local \u67e5\u770b\u201cmain\u201d\u8def\u7531\u8868\uff1a #ip route list table main \u6211\u4eec\u73b0\u5728\u4e3a\u6211\u4eec\u7684\u670b\u53cb\u521b\u5efa\u4e86\u4e00\u4e2a\u53eb\u505a\u201cJohn\u201d\u7684\u89c4\u5219\u3002\u5176\u5b9e\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u7eaf\u6570\u5b57\u8868\u793a\u89c4\u5219\uff0c\u4f46\u662f\u4e0d\u65b9\u4fbf\u3002\u6211\u4eec\u53ef\u4ee5\u5411/etc/iproute2/rt_tables\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6570\u5b57\u4e0e\u540d\u5b57\u7684\u5173\u8054\uff1a # echo 200 John >> /etc/iproute2/rt_tables # ip rule add from 10.0.0.10 table John # ip rule \u73b0\u5728\uff0c\u5269\u4e0b\u7684\u4e8b\u60c5\u5c31\u662f\u4e3a John \u7684\u8def\u7531\u8868\u521b\u5efa\u8def\u7531\u9879\u4e86\u3002\u522b\u5fd8\u4e86\u5237\u65b0\u8def\u7531\u7f13\u5b58\uff1a # ip route add default via 195.96.98.253 dev ppp2 table John # ip route flush cache \u603b\u7ed3\u4e3b\u8981\u662f\u4ee5\u4e0b\u51e0\u6b65\uff1a echo 200 John >> /etc/iproute2/rt_tables #\u65b9\u4fbf\u8868\u793a\uff0c\u628a\u89c4\u5219\u540d\u5b57\u548c\u6570\u5b57\u5bf9\u5e94\u52a0\u5165\u5230/etc/iproute2/rt_tables\u6587\u4ef6 ip rule add from 10 .0.0.10 table John #\u65b0\u589e\u89c4\u5219 ip route add default via 195 .96.98.253 dev ppp2 table John #\u89c4\u5219\u4e2d\u6dfb\u52a0\u8def\u7531\u8868 ip route flush cache #\u5237\u65b0\u8def\u7531\u8868 iproute2 ip \u5e38\u7528\u547d\u4ee4\u5907\u5fd8 1 .\u663e\u793aip\u5730\u5740 ip a ip address show ip addr show dev eth0 ip a sh eth0 2 .\u589e\u52a0\u5220\u9664\u5730\u5740 ip address add 192 .0.2.1/24 dev eth0 ip addr del 192 .0.2.2/24 dev eth0 3 .\u663e\u793a\u63a5\u53e3\u7edf\u8ba1 ip -s link ls eth0 \u7f51\u5361\u548c\u94fe\u8def\u914d\u7f6e 4 .\u663e\u793a\u94fe\u8def ip link show ip link sh eth0 4 .\u4fee\u6539\u63a5\u53e3\u72b6\u6001 ip link set eth0 up ip link s gre01 down \u8def\u7531\u8868\u7ba1\u7406 5 .\u663e\u793a\u8def\u7531\u8868 ip route ip ro show dev gre01 6 .\u589e\u52a0\u65b0\u8def\u7531 ip route add 10 .2.2.128/27 dev gre01 7 .\u589e\u52a0\u9ed8\u8ba4\u8def\u7531 ip route add default via 192 .168.1.1 8 .\u4fee\u6539\u9ed8\u8ba4\u8def\u7531 ip route chg default via 192 .168.1.2 9 .\u5220\u9664\u9ed8\u8ba4\u8def\u7531 ip route del default \u96a7\u9053\u914d\u7f6e 10 .\u589e\u52a0\u5220\u9664GRE\u96a7\u9053 ip tunnel add gre01 mode gre local 10 .1.1.1 remote 20 .2.2.1 ttl 255 ip tunnel del gre01 11 .IPIP\u96a7\u9053 ip tunl a ipip01 mode ipip local 10 .1.1.1 remote 20 .2.2.1 ttl 255 12 .\u663e\u793a\u96a7\u9053 ip tunnel show 13 .\u663e\u793a\u96a7\u9053\u7edf\u8ba1 ip -s tunl ls gre01 \u90bb\u5c45\u548carp\u8868\u7ba1\u7406 13 .\u67e5\u770barp\u8868 ip neigh show 14 .\u624b\u5de5\u589e\u52a0\u5220\u9664arp\u9879 ip neighbor add 10 .2.2.2 dev eth0 ip neigh del 10 .2.2.1 dev eth0 socket\u7edf\u8ba1 15 .\u663e\u793a\u5f53\u524d\u76d1\u542c ss -l 16 .\u663e\u793a\u5f53\u524d\u76d1\u542c\u7684\u8fdb\u7a0b ss -p \u5730\u5740\u7ba1\u7406 \u5728\u672c\u8282\u4e2d\uff0c$ {address}\u503c\u5e94\u8be5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u683c\u5f0f\u7684\u4e3b\u673a\u5730\u5740\uff0c$ {mask}\u53ef\u4ee5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u6216\u524d\u7f00\u957f\u5ea6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.10/24\u548c192.0.2.10/255.255.255.0\u540c\u6837\u53ef\u4ee5\u63a5\u53d7\u3002 \u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u67d0\u4e9b\u4e1c\u897f\u662f\u5426\u4e3a\u6b63\u786e\u7684\u4e3b\u673a\u5730\u5740\uff0c\u8bf7\u4f7f\u7528ipcalc\u6216\u7c7b\u4f3c\u7a0b\u5e8f\u8fdb\u884c\u68c0\u67e5\u3002 \u663e\u793a\u6240\u6709\u5730\u5740 ip\u5730\u5740\u663e\u793a \u6240\u6709show\u547d\u4ee4\u90fd\u53ef\u4ee5\u4e0e-4\u6216-6\u9009\u9879\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u4ec5\u663e\u793aIPv4\u6216IPv6\u5730\u5740\u3002 \u663e\u793a\u5355\u4e2a\u754c\u9762\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u663e\u793aeth0 \u4ec5\u663e\u793a\u6b63\u5728\u8fd0\u884c\u7684\u63a5\u53e3\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a \u4ec5\u663e\u793a\u9759\u6001\u6216\u52a8\u6001IPv6\u5730\u5740 \u4ec5\u663e\u793a\u9759\u6001\u914d\u7f6e\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}]\u6c38\u4e45 \u4ec5\u663e\u793a\u901a\u8fc7\u81ea\u52a8\u914d\u7f6e\u5b66\u4e60\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}] dynamic \u5411\u63a5\u53e3\u6dfb\u52a0\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} \u4f8b\u5b50\uff1a ip address add 192.0.2.10/27 dev eth0 ip address add 2001\uff1adb8\uff1a1 :: / 48 dev tun10 \u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u5730\u5740\u3002 \u5982\u679c\u60a8\u6dfb\u52a0\u591a\u4e2a\u5730\u5740\uff0c\u5219\u60a8\u7684\u673a\u5668\u5c06\u63a5\u53d7\u6240\u6709\u6570\u636e\u5305\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u60a8\u6dfb\u52a0\u7684\u7b2c\u4e00\u4e2a\u5730\u5740\u5c06\u7528\u4f5c\u4f20\u51fa\u6d41\u91cf\u7684\u6e90\u5730\u5740\uff0c\u5b83\u88ab\u79f0\u4e3a\u4e3b\u5730\u5740\u3002 \u60a8\u8bbe\u7f6e\u7684\u6240\u6709\u5176\u4ed6\u5730\u5740\u90fd\u5c06\u6210\u4e3a\u6b21\u8981\u5730\u5740\u3002 \u6dfb\u52a0\u5177\u6709\u4eba\u7c7b\u53ef\u8bfb\u63cf\u8ff0\u7684\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} label $ {interface name}\uff1a$ {description} \u4f8b\u5b50\uff1a ip address add 192.0.2.1/24 dev eth0 label eth0\uff1aWANaddress \u7531\u4e8e\u4e00\u4e9b\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u6807\u7b7e\u5fc5\u987b\u4ee5\u63a5\u53e3\u540d\u79f0\u5f00\u5934\uff0c\u540e\u8ddf\u5192\u53f7\uff0c\u5426\u5219\u4f1a\u51fa\u9519\u3002 \u4fdd\u6301\u6807\u7b7e\u77ed\u4e8e\u5341\u516d\u4e2a\u5b57\u7b26\uff0c\u5426\u5219\u4f60\u4f1a\u5f97\u5230\u8fd9\u4e2a\u9519\u8bef\uff1a RTNETLINK\u56de\u7b54\uff1a\u6570\u5b57\u7ed3\u679c\u8d85\u51fa\u8303\u56f4 \u7b14\u8bb0 \u5bf9\u4e8eIPv6\u5730\u5740\uff0c\u6b64\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\uff08\u5c06\u6dfb\u52a0\u5730\u5740\uff0c\u4f46\u6ca1\u6709\u6807\u7b7e\uff09\u3002 \u5220\u9664\u5730\u5740 ip address delete $ {address} / $ {prefix} dev $ {interface name} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5220\u9664192.0.2.1/24 dev eth0 ip address delete 2001\uff1adb8 :: 1/64 dev tun1 \u63a5\u53e3\u540d\u79f0\u662f\u5fc5\u9700\u7684\u3002Linux\u786e\u5b9e\u5141\u8bb8\u5728\u591a\u4e2a\u63a5\u53e3\u4e0a\u914d\u7f6e\u76f8\u540c\u7684\u5730\u5740\uff0c\u5e76\u4e14\u5b83\u5177\u6709\u6709\u6548\u7684\u7528\u4f8b\u3002 \u4ece\u63a5\u53e3\u4e2d\u5220\u9664\u6240\u6709\u5730\u5740 IP\u5730\u5740\u5237\u65b0\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5237\u65b0dev eth1 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u547d\u4ee4\u5220\u9664IPv4\u548cIPv6\u5730\u5740\u3002\u5982\u679c\u60a8\u53ea\u60f3\u79fb\u9664IPv4\u6216IPv6\u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u201cip-4\u5730\u5740\u5237\u65b0\u201d\u6216\u201cip-6\u5730\u5740\u5237\u65b0\u201d\u3002 \u7b14\u8bb0 \u65e0\u6cd5\u4ea4\u6362\u4e3b\u5730\u5740\u548c\u8f85\u52a9\u5730\u5740\uff0c\u4e5f\u65e0\u6cd5\u663e\u5f0f\u8bbe\u7f6e\u65b0\u7684\u4e3b\u5730\u5740\u3002\u5c1d\u8bd5\u59cb\u7ec8\u9996\u5148\u8bbe\u7f6e\u4e3b\u5730\u5740\u3002 \u4f46\u662f\uff0c\u5982\u679csysctl\u53d8\u91cfnet.ipv4.conf\u3002$ {interface} .promote_secondaries\u8bbe\u7f6e\u4e3a1\uff0c\u90a3\u4e48\u5f53\u60a8\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u7b2c\u4e00\u4e2a\u8f85\u52a9\u5730\u5740\u5c06\u6210\u4e3a\u65b0\u7684\u4e3b\u5730\u5740\u3002 \u8bf7\u6ce8\u610f\uff0cnet.ipv4.conf.default.promote_secondaries = 1 \u4e0d\u662f\u6240\u6709Linux\u53d1\u884c\u7248\u4e2d\u7684\u901a\u7528\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u56e0\u6b64\u8bf7\u5728\u5c1d\u8bd5\u4e4b\u524d\u68c0\u67e5\u60a8\u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5b83\u8bbe\u7f6e\u4e3a0\uff0c\u90a3\u4e48\u5f53\u4f60\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u6240\u6709\u7684\u5730\u5740\u90fd\u5c06\u4ece\u63a5\u53e3\u4e2d\u5220\u9664\u3002 \u5982\u679c\u4e3b\u5730\u5740\u88ab\u5220\u9664\uff0c\u5219\u8f85\u52a9IPv6\u5730\u5740\u603b\u662f\u88ab\u63d0\u5347\u4e3a\u4e3b\u5730\u5740\uff0c\u56e0\u6b64\u60a8\u4e0d\u5fc5\u62c5\u5fc3sysctl\u8bbe\u7f6e\u3002 \u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u7ba1\u7406 \u5bf9\u4e8e\u559c\u6b22\u82f1\u56fd\u62fc\u5199\u7684\u5973\u58eb\u4eec\uff0c\u5148\u751f\u4eec\uff0c\u8fd9\u4e2a\u6307\u6325\u5bb6\u5ead\u4e5f\u652f\u6301\u201c\u90bb\u5c45\u201d\u62fc\u5199\u3002 \u67e5\u770b\u90bb\u5c45\u8868 IP\u90bb\u5c45\u79c0 \u6240\u6709\u201cshow\u201d\u547d\u4ee4\u90fd\u652f\u6301-4\u548c-6\u9009\u9879\uff0c\u4ee5\u4ec5\u67e5\u770bIPv4\uff08ARP\uff09\u6216IPv6\uff08NDP\uff09\u90bb\u5c45\u3002\u9ed8\u8ba4\u663e\u793a\u6240\u6709\u7684\u90bb\u5c45\u3002 \u67e5\u770b\u5355\u4e2a\u754c\u9762\u7684\u90bb\u5c45 ip neighbor show dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor show dev eth0 \u5237\u65b0\u63a5\u53e3\u7684\u8868\u683c ip neighbor flush dev $ {interface name} \u4f8b\u5b50\uff1a IP\u90bb\u5c45\u5237\u65b0\u5f00\u53d1eth1 \u6dfb\u52a0\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip neighbor add $ {\u7f51\u7edc\u5730\u5740} lladdr $ {link layer address} dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor add 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5176\u4e2d\u4e00\u4e2a\u7528\u4f8b\u662f\u4e3a\u5177\u6709\u7981\u7528ARP\u7684\u63a5\u53e3\u6dfb\u52a0\u9759\u6001\u6761\u76ee\uff0c\u4ee5\u9650\u5236\u5177\u6709\u7279\u5b9aMAC\u5730\u5740\u7684\u4e3b\u673a\u7684\u63a5\u53e3\u4f7f\u7528\u60c5\u51b5\u3002 \u5220\u9664\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip\u90bb\u5c45\u5220\u9664$ {\u7f51\u7edc\u5730\u5740} lladdr $ {\u94fe\u63a5\u5c42\u5730\u5740}\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip neighbor delete 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5141\u8bb8\u5220\u9664\u9759\u6001\u6761\u76ee\uff0c\u6216\u8005\u5728\u4e0d\u5237\u65b0\u8868\u683c\u7684\u60c5\u51b5\u4e0b\u6446\u8131\u81ea\u52a8\u5b66\u4e60\u7684\u6761\u76ee\u3002 \u94fe\u63a5\u7ba1\u7406 \u94fe\u63a5\u662f\u7f51\u7edc\u754c\u9762\u7684\u53e6\u4e00\u4e2a\u672f\u8bed\u3002\u6765\u81ea\u201cip link\u201d\u7cfb\u5217\u7684\u547d\u4ee4\u6267\u884c\u6240\u6709\u63a5\u53e3\u7c7b\u578b\u901a\u7528\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u67e5\u770b\u94fe\u63a5\u4fe1\u606f\u6216\u66f4\u6539MTU\u3002 \u4ece\u5386\u53f2\u4e0a\u770b\uff0c\u201cip link\u201d\u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u9664\u96a7\u9053\uff08IPIP\uff0cGRE\u7b49\uff09\uff0cL2TPv3\u548cVXLAN\u63a5\u53e3\uff08\u5b83\u4eec\u5404\u81ea\u5177\u6709\u547d\u4ee4\uff09\u4e4b\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\u3002\u5728\u8f83\u65b0\u7684iproute2\u7248\u672c\u4e2d\uff08\u81f3\u5c113.16\uff09\uff0c\u5b83\u4eec\u53ef\u4ee5\u521b\u5efa\u9664L2TPv3\u4ee5\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\uff0c\u5c3d\u7ba1\u4f7f\u7528\u7279\u6b8a\u547d\u4ee4\u7cfb\u5217\u5bf9\u5176\u4e2d\u7684\u4e00\u4e9b\u66f4\u52a0\u65b9\u4fbf\u3002 \u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528\u201cip link add\u201d\u548c\u201cip link set\u201d\u547d\u4ee4\u7684\u201cname $ {name}\u201d\u53c2\u6570\u8bbe\u7f6e\u7684\u63a5\u53e3\u540d\u79f0\u53ef\u80fd\u662f\u4efb\u610f\u7684\uff0c\u751a\u81f3\u53ef\u80fd\u5305\u542bunicode\u5b57\u7b26\u3002\u4f46\u662f\uff0c\u6700\u597d\u575a\u6301\u4f7f\u7528ASCII\uff0c\u56e0\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u5904\u7406unicode\u3002 \u53e6\u8bf7\u6ce8\u610f\uff0c\u5176\u4ed6\u7a0b\u5e8f\uff08\u5982iptables\uff09\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u94fe\u63a5\u540d\u79f0\u683c\u5f0f\u548c\u957f\u5ea6\u9650\u5236\uff0c\u6240\u4ee5\u6700\u597d\u4f7f\u7528\u77ed\u7684\u5b57\u6bcd\u6570\u5b57\u540d\u79f0\uff0c\u5e76\u5728\u94fe\u63a5\u522b\u540d\u4e2d\u63d0\u4f9b\u5176\u4ed6\u4fe1\u606f \u3002 \u663e\u793a\u6709\u5173\u6240\u6709\u94fe\u63a5\u7684\u4fe1\u606f IP\u94fe\u63a5\u663e\u793a IP\u94fe\u63a5\u5217\u8868 \u8fd9\u4e9b\u547d\u4ee4\u662f\u7b49\u4ef7\u7684\uff0c\u53ef\u4ee5\u7528\u4e8e\u76f8\u540c\u7684\u53c2\u6570\u3002 \u663e\u793a\u6709\u5173\u7279\u5b9a\u94fe\u63a5\u7684\u4fe1\u606f ip link show dev $ {interface name} \u4f8b\u5b50\uff1a ip link show dev eth0 ip link show dev tun10 \u5355\u8bcd\u201cdev\u201d\u53ef\u4ee5\u7701\u7565\u3002 \u4e0a\u4e0b\u94fe\u63a5 ip link set dev $ {interface name} up ip link set dev $ {interface name} down \u4f8b\u5b50\uff1a ip link set dev eth0 down ip\u94fe\u8def\u8bbe\u7f6edev br0 up \u6ce8\u610f\uff1a\u4e0b\u9762\u63cf\u8ff0\u7684\u865a\u62df\u94fe\u8def\uff0c\u5982VLAN\u548c\u7f51\u6865\u5728\u521b\u5efa\u540e\u7acb\u5373\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u4f60\u9700\u8981\u63d0\u9192\u4ed6\u4eec\u5f00\u59cb\u4f7f\u7528\u5b83\u4eec\u3002 \u8bbe\u7f6e\u4eba\u7c7b\u53ef\u8bfb\u7684\u94fe\u63a5\u63cf\u8ff0 ip link set dev $ {interface name}\u522b\u540d\u201c$ {description}\u201d \u4f8b\u5b50\uff1a ip link set dev eth0\u522b\u540d\u201cLAN\u63a5\u53e3\u201d \u94fe\u63a5\u522b\u540d\u663e\u793a\u5728\u201cip link show\u201d\u8f93\u51fa\u4e2d\uff0c\u5982\uff1a 2\uff1aeth0\uff1a mtu 1500 qdisc mq\u72b6\u6001UP\u6a21\u5f0fDEFAULT qlen 1000 link / ether 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f brd ff\uff1aff\uff1aff\uff1aff\uff1aff\uff1aff \u522b\u540dLAN\u63a5\u53e3 \u91cd\u547d\u540d\u4e00\u4e2a\u63a5\u53e3 ip link set dev $ {old interface name} name $ {new interface name} \u4f8b\u5b50\uff1a ip link set dev eth0 name lan \u8bf7\u6ce8\u610f\uff0c\u60a8\u4e0d\u80fd\u91cd\u547d\u540d\u6d3b\u52a8\u754c\u9762\u3002\u5728\u505a\u4e4b\u524d\u4f60\u9700\u8981\u628a\u5b83\u653e\u4e0b\u3002 \u66f4\u6539\u94fe\u8def\u5c42\u5730\u5740\uff08\u901a\u5e38\u662fMAC\u5730\u5740\uff09 ip link set dev $ {interface name} address $ {address} \u94fe\u8def\u5c42\u5730\u5740\u662f\u4e00\u4e2a\u76f8\u5f53\u5e7f\u6cdb\u7684\u6982\u5ff5\u3002\u6700\u7740\u540d\u7684\u4f8b\u5b50\u662f\u4ee5\u592a\u7f51\u8bbe\u5907\u7684MAC\u5730\u5740\u3002\u8981\u6539\u53d8MAC\u5730\u5740\uff0c\u4f60\u9700\u8981\u8fd9\u6837\u7684\u4e1c\u897f\uff1a ip link set dev eth0 address 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f \u66f4\u6539\u94fe\u63a5MTU ip link set dev $ {interface name} mtu $ {MTU value} \u4f8b\u5b50\uff1a ip link set dev tun0 mtu 1480 MTU\u4ee3\u8868\u201c\u6700\u5927\u4f20\u8f93\u5355\u4f4d\u201d\uff0c\u5373\u63a5\u53e3\u4e00\u6b21\u53ef\u4ee5\u4f20\u8f93\u7684\u6700\u5927\u5e27\u6570\u3002 \u9664\u4e86\u50cf\u4e0a\u9762\u4f8b\u5b50\u90a3\u6837\u51cf\u5c11\u96a7\u9053\u4e2d\u7684\u5206\u6bb5\u4e4b\u5916\uff0c\u8fd9\u4e5f\u7528\u4e8e\u63d0\u9ad8\u652f\u6301\u6240\u8c13\u7684\u201c\u5de8\u578b\u5e27\u201d\uff08\u6700\u591a9000\u4e2a\u5b57\u8282\u7684\u5e27\uff09\u7684\u5343\u5146\u4ee5\u592a\u7f51\u94fe\u8def\u7684\u6027\u80fd\u3002\u5982\u679c\u4f60\u6240\u6709\u7684\u8bbe\u5907\u90fd\u652f\u6301\u5343\u5146\u4ee5\u592a\u7f51\uff0c\u4f60\u53ef\u80fd\u60f3\u8981\u505a\u7c7b\u4f3c\u7684\u4e8b\u60c5 ip link set dev eth0 mtu 9000 \u8bf7\u6ce8\u610f\uff0c\u60a8\u53ef\u80fd\u8fd8\u9700\u8981\u5728L2\u4ea4\u6362\u673a\u4e0a\u914d\u7f6e\u5b83\uff0c\u5176\u4e2d\u4e00\u4e9b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5df2\u5c06\u5176\u7981\u7528\u3002 \u5220\u9664\u94fe\u63a5 ip link delete dev $ {interface name} \u663e\u7136\uff0c\u53ea\u80fd\u5220\u9664\u50cfVLAN\u6216\u7f51\u6865\u8fd9\u6837\u7684\u865a\u62df\u94fe\u8def\u3002 \u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u7ec4\u64ad\u5173\u95ed \u9664\u975e\u4f60\u771f\u7684\u660e\u767d\u4f60\u5728\u505a\u4ec0\u4e48\uff0c\u6700\u597d\u4e0d\u8981\u78b0\u8fd9\u4e2a\u3002 \u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528ARP ip link\u8bbe\u7f6e$ {interface name} arp ip link\u8bbe\u7f6e$ {interface name} arp off \u4eba\u4eec\u53ef\u80fd\u5e0c\u671b\u7981\u7528ARP\u6765\u5f3a\u5236\u6267\u884c\u5b89\u5168\u7b56\u7565\uff0c\u5e76\u53ea\u5141\u8bb8\u7279\u5b9a\u7684MAC\u4e0e\u63a5\u53e3\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u767d\u540d\u5355MAC\u7684\u90bb\u5c45\u8868\u6761\u76ee\u5e94\u624b\u52a8\u521b\u5efa\uff08\u8bf7\u53c2\u89c1\u90bb\u5c45\u8868\u7ba1\u7406 \u90e8\u5206\uff09\uff0c\u5426\u5219\u4ec0\u4e48\u90fd\u4e0d\u80fd\u4e0e\u8be5\u63a5\u53e3\u901a\u4fe1\u3002 \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u5728\u63a5\u5165\u5c42\u4ea4\u6362\u673a\u4e0a\u914d\u7f6eMAC\u7b56\u7565\u3002\u9664\u975e\u4f60\u786e\u5b9a\u4f60\u8981\u505a\u4ec0\u4e48\u4ee5\u53ca\u4e3a\u4ec0\u4e48\uff0c\u5426\u5219\u4e0d\u8981\u6539\u53d8\u8fd9\u4e2a\u6807\u5fd7\u3002 \u521b\u5efa\u4e00\u4e2aVLAN\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {VLAN\u63a5\u53e3\u540d\u79f0}\u94fe\u63a5$ {\u7236\u63a5\u53e3\u540d\u79f0}\u952e\u5165vlan id $ {tag} \u4f8b\u5b50\uff1a ip link add name eth0.110 link eth0 type vlan id 110 Linux\u652f\u6301\u7684\u552f\u4e00VLAN\u7c7b\u578b\u662fIEEE 802.1q VLAN\uff0c\u4e0d\u652f\u6301ISL\u7b49\u4f20\u7edf\u5b9e\u73b0\u3002 \u4e00\u65e6\u521b\u5efa\u4e86\u4e00\u4e2aVLAN\u63a5\u53e3\uff0c\u6240\u6709\u7531$ {parent interface}\u63a5\u6536\u7684id\u9009\u9879\u4e2d\u6307\u5b9a\u7684$ {tag}\u6807\u8bb0\u7684\u5e27\u5c06\u7531\u8be5VLAN\u63a5\u53e3\u5904\u7406\u3002 eth0.100\u540d\u79f0\u683c\u5f0f\u662f\u4f20\u7edf\u7684\uff0c\u4f46\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u547d\u540d\u8be5\u63a5\u53e3\uff0c\u5c31\u50cf\u4f7f\u7528\u5176\u4ed6\u63a5\u53e3\u7c7b\u578b\u4e00\u6837\u3002 VLAN\u53ef\u4ee5\u901a\u8fc7\u7f51\u6865\uff0c\u7ed1\u5b9a\u548c\u5176\u4ed6\u80fd\u591f\u5904\u7406\u4ee5\u592a\u7f51\u5e27\u7684\u63a5\u53e3\u6765\u521b\u5efa\u3002 \u521b\u5efaQinQ\u63a5\u53e3\uff08VLAN\u5806\u53e0\uff09 ip link add name $ {service interface} link $ {physical interface} type vlan proto 802.1ad id $ {service tag} ip link add name $ {client interface} link $ {service interface}\u8f93\u5165vlan proto 802.1q id $ {client tag} \u4f8b\uff1a ip link add name eth0.100 link eth0 type vlan proto 802.1ad id 100\uff03\u521b\u5efa\u670d\u52a1\u6807\u7b7e\u63a5\u53e3 ip link add name eth0.100.200 link eth0.100 type vlan proto 802.1q id 200\uff03\u521b\u5efa\u5ba2\u6237\u7aef\u6807\u7b7e\u63a5\u53e3 VLAN\u5806\u53e0\uff08\u53c8\u540d802.1ad QinQ\uff09\u662f\u4e00\u79cd\u5728\u53e6\u4e00\u4e2aVLAN\u4e0a\u4f20\u8f93\u5e26VLAN\u6807\u8bb0\u7684\u6d41\u91cf\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u7528\u4f8b\u5982\u4e0b\u6240\u793a\uff1a\u5047\u8bbe\u60a8\u662f\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u5e76\u4e14\u60a8\u6709\u4e00\u4f4d\u5ba2\u6237\u60f3\u8981\u4f7f\u7528\u60a8\u7684\u7f51\u7edc\u57fa\u7840\u67b6\u6784\u5c06\u5176\u7f51\u7edc\u7684\u90e8\u5206\u8fde\u63a5\u5230\u5f7c\u6b64\u3002\u4ed6\u4eec\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528\u591a\u4e2aVLAN\uff0c\u56e0\u6b64\u666e\u901a\u7684\u79df\u7528VLAN\u4e0d\u662f\u4e00\u79cd\u9009\u62e9\u3002\u901a\u8fc7\u4f7f\u7528QinQ\uff0c\u60a8\u53ef\u4ee5\u5728\u5ba2\u6237\u6d41\u91cf\u8fdb\u5165\u7f51\u7edc\u65f6\u6dfb\u52a0\u7b2c\u4e8c\u4e2a\u6807\u7b7e\uff0c\u5e76\u5728\u9000\u51fa\u65f6\u5220\u9664\u8be5\u6807\u7b7e\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u51b2\u7a81\uff0c\u60a8\u4e0d\u9700\u8981\u6d6a\u8d39VLAN\u7f16\u53f7\u3002 \u670d\u52a1\u6807\u7b7e\u662f\u63d0\u4f9b\u5546\u7528\u6765\u901a\u8fc7\u7f51\u7edc\u627f\u8f7d\u5ba2\u6237\u7aef\u6d41\u91cf\u7684VLAN\u6807\u7b7e\u3002\u5ba2\u6237\u6807\u7b7e\u662f\u5ba2\u6237\u8bbe\u5b9a\u7684\u6807\u7b7e\u3002 \u8bf7\u6ce8\u610f\uff0c\u5ba2\u6237\u7aefVLAN\u63a5\u53e3\u7684\u94fe\u8defMTU\u4e0d\u4f1a\u81ea\u52a8\u8c03\u6574\uff0c\u60a8\u9700\u8981\u4eb2\u81ea\u5904\u7406\uff0c\u5e76\u5c06\u5ba2\u6237\u7aef\u63a5\u53e3MTU\u51cf\u5c11\u81f3\u5c114\u4e2a\u5b57\u8282\uff0c\u6216\u76f8\u5e94\u5730\u589e\u52a0\u7236\u6bcdMTU\u3002 \u7b26\u5408\u6807\u51c6\u7684QinQ\u81eaLinux 3.10\u8d77\u53ef\u7528\u3002 \u521b\u5efa\u4f2a\u4ee5\u592a\u7f51\uff08aka macvlan\uff09\u63a5\u53e3 ip link add name $ {macvlan interface name} link $ {parent interface}\u952e\u5165macvlan \u4f8b\u5b50\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0peth0\u94fe\u63a5eth0\u7c7b\u578bmacvlan \u60a8\u53ef\u4ee5\u5c06macvlan\u63a5\u53e3\u89c6\u4e3a\u7236\u63a5\u53e3\u4e0a\u7684\u9644\u52a0\u865a\u62dfMAC\u5730\u5740\u3002\u4ece\u7528\u6237\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u4eec\u770b\u8d77\u6765\u50cf\u666e\u901a\u7684\u4ee5\u592a\u7f51\u63a5\u53e3\uff0c\u5e76\u5904\u7406\u6240\u6709\u901a\u4fe1\u7684MAC\u5730\u5740\uff0c\u8fd9\u4e9bMAC\u5730\u5740\u662f\u901a\u8fc7\u5176\u7236\u63a5\u53e3\u5206\u914d\u7684\u3002 \u8fd9\u901a\u5e38\u7528\u4e8e\u6d4b\u8bd5\uff0c\u6216\u8005\u5f53\u53ea\u6709\u4e00\u4e2a\u7269\u7406\u63a5\u53e3\u53ef\u7528\u65f6\uff0c\u4f7f\u7528\u7531MAC\u6807\u8bc6\u7684\u591a\u4e2a\u670d\u52a1\u5b9e\u4f8b\u3002 \u5b83\u4eec\u4e5f\u53ef\u4ee5\u7528\u4e8eIP\u5730\u5740\u5206\u9694\uff0c\u800c\u4e0d\u662f\u5c06\u591a\u4e2a\u5730\u5740\u5206\u914d\u7ed9\u76f8\u540c\u7684\u7269\u7406\u63a5\u53e3\uff0c\u7279\u522b\u662f\u5982\u679c\u67d0\u4e9b\u670d\u52a1\u65e0\u6cd5\u6b63\u786e\u64cd\u4f5c\u8f85\u52a9\u5730\u5740\u3002 \u521b\u5efa\u4e00\u4e2a\u865a\u62df\u63a5\u53e3 ip link add name $ {dummy interface name} type dummy \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0dummy0\u7c7b\u578b\u865a\u62df Dummy\u63a5\u53e3\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0eLoopback\u63a5\u53e3\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u9700\u8981\u5c3d\u53ef\u80fd\u591a\u7684\u63a5\u53e3\u5373\u53ef\u3002 \u5b83\u4eec\u7684\u7b2c\u4e00\u4e2a\u76ee\u7684\u662f\u5728\u4e3b\u673a\u5185\u90e8\u8fdb\u884c\u7a0b\u5e8f\u7684\u901a\u4fe1\u3002 \u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\u5229\u7528\u4ed6\u4eec\u603b\u662f\u8d77\u6765\u7684\u4e8b\u5b9e\uff08\u9664\u975e\u5728\u884c\u653f\u4e0a\u88ab\u5265\u593a\uff09\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5728\u5177\u6709\u591a\u4e2a\u7269\u7406\u63a5\u53e3\u7684\u8def\u7531\u5668\u4e0a\u4e3a\u5b83\u4eec\u5206\u914d\u670d\u52a1\u5730\u5740\u3002\u53ea\u8981\u5206\u914d\u7ed9\u56de\u9001\u6216\u4f2a\u63a5\u53e3\u7684\u5730\u5740\u7684\u6d41\u91cf\u8def\u7531\u5230\u62e5\u6709\u5b83\u7684\u673a\u5668\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u7684\u4efb\u4f55\u63a5\u53e3\u8bbf\u95ee\u5b83\u3002 \u521b\u5efa\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u6865\u540d\u79f0}\u7c7b\u578b\u6865 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0br0\u7c7b\u578b\u6865 \u7f51\u6865\u63a5\u53e3\u662f\u865a\u62df\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u3002\u5b83\u4eec\u53ef\u4ee5\u7528\u4e8e\u5728\u4ee5\u592a\u7f51\u63a5\u53e3\u4e4b\u95f4\u900f\u660e\u5730\u4e2d\u7ee7\u6d41\u91cf\uff0c\u5e76\u4e14\u8d8a\u6765\u8d8a\u666e\u904d\u5730\u7528\u4f5c\u8fd0\u884c\u5728\u7ba1\u7406\u7a0b\u5e8f\u5185\u90e8\u7684\u865a\u62df\u673a\u7684\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u3002 \u60a8\u53ef\u4ee5\u5c06\u4e00\u4e2aIP\u5730\u5740\u5206\u914d\u7ed9\u4e00\u4e2a\u7f51\u6865\uff0c\u5e76\u4e14\u5b83\u5c06\u4ece\u6240\u6709\u7f51\u6865\u7aef\u53e3\u53ef\u89c1\u3002 \u5982\u679c\u6b64\u547d\u4ee4\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u52a0\u8f7d\u4e86\u201c\u7f51\u6865\u201d\u6a21\u5757\u3002 \u6dfb\u52a0\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 ip link set dev $ {interface name} master $ {bridge name} \u4f8b\u5b50\uff1a ip link set dev eth0 master br0 \u60a8\u6dfb\u52a0\u5230\u7f51\u6865\u7684\u63a5\u53e3\u5c06\u6210\u4e3a\u865a\u62df\u4ea4\u6362\u673a\u7aef\u53e3\u3002\u5b83\u4ec5\u5728\u6570\u636e\u94fe\u8def\u5c42\u4e0a\u8fd0\u884c\u5e76\u505c\u6b62\u6240\u6709\u7f51\u7edc\u5c42\u7684\u64cd\u4f5c\u3002 \u4ece\u6865\u4e0a\u5220\u9664\u63a5\u53e3 ip link set dev $ {interface name} nomaster \u4f8b\u5b50\uff1a ip link set dev eth0 nomaster \u521b\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u754c\u9762 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u540d\u79f0}\u952e\u5165\u503a\u5238 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0bond1\u7c7b\u578b\u7684\u503a\u5238 \u6ce8\u610f\uff1a\u8fd9\u4e0d\u8db3\u4ee5\u4ee5\u4efb\u4f55\u6709\u610f\u4e49\u7684\u65b9\u5f0f\u914d\u7f6e\u7ed1\u5b9a\uff08\u94fe\u63a5\u805a\u5408\uff09\u3002\u60a8\u9700\u8981\u6839\u636e\u60a8\u7684\u60c5\u51b5\u8bbe\u7f6e\u7c98\u5408\u53c2\u6570\u3002\u8fd9\u8fdc\u8fdc\u8d85\u51fa\u4e86\u5907\u5fd8\u5355\u8303\u56f4\uff0c\u56e0\u6b64\u8bf7\u67e5\u9605\u6587\u6863\u3002 \u63a5\u53e3\u4ee5\u4e0e\u6865\u63a5\u7ec4\u76f8\u540c\u7684\u65b9\u5f0f\u6dfb\u52a0\u5230\u7ed1\u5b9a\u7ec4\uff0c\u8bf7\u6ce8\u610f\uff0c\u9664\u975e\u60a8\u5c06\u5176\u5173\u95ed\uff0c\u5426\u5219\u65e0\u6cd5\u6dfb\u52a0\u5b83\u3002 \u521b\u5efa\u4e00\u4e2a\u4e2d\u95f4\u529f\u80fd\u5757\u63a5\u53e3 ip link add $ {interface name}\u952e\u5165ifb \u4f8b\uff1a ip\u94fe\u63a5\u6dfb\u52a0ifb10\u7c7b\u578bifb \u4e2d\u95f4\u529f\u80fd\u5757\u8bbe\u5907\u4e0etc\u4e00\u8d77\u7528\u4e8e\u6d41\u91cf\u91cd\u5b9a\u5411\u548c\u955c\u50cf\u3002\u8fd9\u4e5f\u8d85\u51fa\u4e86\u672c\u6587\u6863\u7684\u8303\u56f4\uff0c\u8bf7\u53c2\u9605tc\u6587\u6863\u3002 \u521b\u5efa\u4e00\u5bf9\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907 \u865a\u62df\u4ee5\u592a\u7f51\uff08veth\uff09\u8bbe\u5907\u603b\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u5e76\u4e14\u4f5c\u4e3a\u53cc\u5411\u7ba1\u9053\u5de5\u4f5c\uff0c\u4e0d\u7ba1\u8fdb\u5165\u5176\u4e2d\u7684\u54ea\u4e00\u4e2a\uff0c\u90fd\u4f1a\u4ece\u53e6\u4e00\u4e2a\u7ba1\u9053\u51fa\u6765\u3002\u5b83\u4eec\u4e0e\u7cfb\u7edf\u5206\u533a\u529f\u80fd\uff08\u5982\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u548c\u5bb9\u5668\uff08OpenVZ\u548cLXC\uff09\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u4e00\u4e2a\u5206\u533a\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u5206\u533a\u3002 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u7b2c\u4e00\u4e2a\u8bbe\u5907\u540d\u79f0}\u7c7b\u578bveth peer name $ {\u7b2c\u4e8c\u4e2a\u8bbe\u5907\u540d\u79f0} \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth-host\u7c7b\u578bveth\u5bf9\u7b49\u540d\u79f0veth-guest \u6ce8\u610f\uff1a\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907\u662f\u5728UP\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u4e0d\u9700\u8981\u5728\u521b\u5efa\u540e\u624b\u52a8\u542f\u52a8\u5b83\u4eec\u3002 \u94fe\u63a5\u7ec4\u7ba1\u7406 \u94fe\u63a5\u7ec4\u4e0e\u7ba1\u7406\u578b\u4ea4\u6362\u673a\u4e2d\u7684\u7aef\u53e3\u8303\u56f4\u7c7b\u4f3c\u3002\u60a8\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u6dfb\u52a0\u5230\u7f16\u53f7\u7ec4\uff0c\u5e76\u7acb\u5373\u5728\u8be5\u7ec4\u7684\u6240\u6709\u63a5\u53e3\u4e0a\u6267\u884c\u64cd\u4f5c\u3002 \u672a\u5206\u914d\u7ed9\u4efb\u4f55\u7ec4\u7684\u94fe\u63a5\u5c5e\u4e8e\u7ec40\uff0c\u4e5f\u79f0\u4e3a\u201c\u9ed8\u8ba4\u201d\u3002 \u5c06\u754c\u9762\u6dfb\u52a0\u5230\u7ec4 ip link set dev $ {interface name} group $ {group number} \u4f8b\u5b50\uff1a ip link set dev eth0 group 42 ip link set dev eth1 group 42 \u4ece\u7ec4\u4e2d\u5220\u9664\u4e00\u4e2a\u63a5\u53e3 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176\u5206\u914d\u7ed9\u9ed8\u8ba4\u7ec4\u6765\u5b8c\u6210\u3002 ip link set dev $ {interface name} group 0 ip link set dev $ {interface}\u7ec4\u9ed8\u8ba4\u503c \u4f8b\u5b50\uff1a ip link set dev tun10 group 0 \u4e3a\u7ec4\u5206\u914d\u4e00\u4e2a\u7b26\u53f7\u540d\u79f0 \u7ec4\u540d\u5b58\u50a8\u5728/ etc / iproute2 / group\u6587\u4ef6\u4e2d\u3002\u7ec40\u7684\u7b26\u53f7\u540d\u79f0\u201cdefault\u201d\u6070\u597d\u6765\u81ea\u90a3\u91cc\u3002\u60a8\u53ef\u4ee5\u6309\u7167\u76f8\u540c\u7684\u201c$ {number} $ {name}\u201d\u683c\u5f0f\u6dfb\u52a0\u60a8\u81ea\u5df1\u7684\uff0c\u6bcf\u884c\u4e00\u4e2a\u3002\u60a8\u6700\u591a\u53ef\u4ee5\u6709255\u4e2a\u547d\u540d\u7ec4\u3002 \u4e00\u65e6\u914d\u7f6e\u4e86\u7ec4\u540d\uff0c\u5728ip\u547d\u4ee4\u4e2d\u53ef\u4ee5\u4ea4\u6362\u4f7f\u7528\u6570\u5b57\u548c\u540d\u79f0\u3002 \u4f8b\uff1a echo\u201c10 customer-vlans\u201d>> / etc / iproute2 / group \u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u6240\u6709\u64cd\u4f5c\u4e2d\u4f7f\u7528\u8be5\u540d\u79f0\uff0c\u4f8b\u5982 ip link set dev eth0.100 group customer-vlans \u5bf9\u7ec4\u6267\u884c\u64cd\u4f5c ip link set group $ {group number} $ {operation and arguments} \u4f8b\u5b50\uff1a IP\u94fe\u8def\u8bbe\u7f6e\u7ec442\u5411\u4e0b ip\u94fe\u8def\u8bbe\u7f6e\u7ec4\u4e0a\u884c\u94fe\u8defmtu 1200 \u67e5\u770b\u6765\u81ea\u7279\u5b9a\u7ec4\u7684\u94fe\u63a5\u7684\u4fe1\u606f \u4f7f\u7528\u901a\u5e38\u7684\u4fe1\u606f\u67e5\u770b\u547d\u4ee4\u548c\u201cgroup $ {group}\u201d\u4fee\u9970\u7b26\u3002 \u4f8b\u5b50\uff1a IP\u94fe\u8def\u5217\u8868\u7ec442 IP\u5730\u5740\u663e\u793a\u7ec4\u5ba2\u6237 Tun\u548cTap\u8bbe\u5907 Tun\u548ctap\u8bbe\u5907\u5141\u8bb8\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6a21\u62df\u7f51\u7edc\u8bbe\u5907\u3002\u5f53\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6253\u5f00\u5b83\u4eec\u65f6\uff0c\u5b83\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4ece\u5185\u6838\u7f51\u7edc\u5806\u6808\u8def\u7531\u5230\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u8bfb\u53d6\uff0c\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5199\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u636e\u5c06\u4f5c\u4e3a\u672c\u5730\u4f20\u51fa\u6570\u636e\u5305\u6ce8\u5165\u5230\u7f51\u7edc\u5806\u6808\u4e2d\u3002\u4e24\u8005\u7684\u533a\u522b\u5728\u4e8e\uff1a \u70b9\u51fb\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cb\u4ee5\u592a\u7f51\u5e27\u3002 tun\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cbIP\u6570\u636e\u5305\u3002 \u6709\u4e24\u79cd\u7c7b\u578b\u7684tun / tap\u8bbe\u5907\uff1apersistent\u548ctransient\u3002\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5728\u6253\u5f00\u7279\u6b8a\u8bbe\u5907\u65f6\u521b\u5efa\u77ac\u65f6tun / tap\u8bbe\u5907\uff0c\u5e76\u5728\u5173\u8054\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5173\u95ed\u65f6\u81ea\u52a8\u9500\u6bc1\u3002\u8fd9\u91cc\u5217\u51fa\u7684\u547d\u4ee4\u64cd\u7eb5\u6301\u4e45\u6027\u8bbe\u5907\u3002 \u67e5\u770btun / tap\u8bbe\u5907 ip tuntap\u663e\u793a \u6ce8\u610f\uff1a\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7f29\u5199\u4e3a\u201cip tuntap\u201d\u3002 \u8be5\u547d\u4ee4\u662f\u67e5\u660e\u67d0\u4e2a\u8bbe\u5907\u662f\u5904\u4e8etun\u8fd8\u662ftap\u6a21\u5f0f\u7684\u552f\u4e00\u65b9\u6cd5\u3002 \u6dfb\u52a0\u53ef\u4f9broot\u7528\u6237\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} \u4f8b\u5b50\uff1a ip tuntap add dev tun0\u6a21\u5f0f ip tuntap add dev tap9\u6a21\u5f0f\u70b9\u51fb \u6dfb\u52a0\u666e\u901a\u7528\u6237\u53ef\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} user $ {user} group $ {group} \u4f8b\uff1a ip tuntap add dev tun1\u6a21\u5f0ftun\u7528\u6237\u6211\u7ec4mygroup ip tuntap add dev tun2 mode tun user 1000 group 1001 \u4f7f\u7528\u5907\u7528\u6570\u636e\u5305\u683c\u5f0f\u6dfb\u52a0tun / tap\u8bbe\u5907 \u5c06\u5143\u4fe1\u606f\u6dfb\u52a0\u5230\u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u63a5\u6536\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u3002\u5f88\u5c11\u6709\u7a0b\u5e8f\u671f\u671b\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5305\u62ec\u5b83\u5728\u4e0d\u671f\u671b\u7684\u60c5\u51b5\u4e0b\u4f1a\u7834\u574f\u4e8b\u60c5\u3002 ip tuntap add dev $ {interface name} mode $ {mode} pi \u4f8b\uff1a ip tuntap add dev tun1 mode tun pi \u6dfb\u52a0\u5ffd\u7565\u6d41\u91cf\u63a7\u5236\u7684tun / tap \u901a\u5e38\uff0c\u53d1\u9001\u5230tun / tap\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ee5\u4e0e\u53d1\u9001\u5230\u4efb\u4f55\u5176\u4ed6\u8bbe\u5907\u7684\u6570\u636e\u5305\u76f8\u540c\u7684\u65b9\u5f0f\u4f20\u64ad\uff1a\u5b83\u4eec\u88ab\u7f6e\u4e8e\u7531\u6d41\u91cf\u63a7\u5236\u5f15\u64ce\uff08\u7531tc\u547d\u4ee4\u914d\u7f6e\uff09\u5904\u7406\u7684\u961f\u5217\u4e2d\u3002\u8fd9\u53ef\u4ee5\u88ab\u7ed5\u8fc7\uff0c\u4ece\u800c\u7981\u7528\u8be5tun / tap\u8bbe\u5907\u7684\u6d41\u91cf\u63a7\u5236\u5f15\u64ce\u3002 ip tuntap add dev $ {interface name} mode $ {mode} one_queue \u4f8b\uff1a ip tuntap add dev tun1 mode tun one_queue \u5220\u9664tun / tap\u8bbe\u5907 ip tuntap del dev $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0f$ {mode} \u4f8b\u5b50\uff1a ip tuntap\u5220\u9664dev tun0\u6a21\u5f0ftun ip tuntap\u5220\u9664dev tap1\u6a21\u5f0f\u70b9\u51fb \u6ce8\u610f\uff1a\u60a8\u5fc5\u987b\u6307\u5b9a\u6a21\u5f0f\u3002\u8be5\u6a21\u5f0f\u4e0d\u4f1a\u663e\u793a\u5728\u201cip link show\u201d\u4e2d\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u5b83\u662fTUN\u8fd8\u662fTAP\uff0c\u8bf7\u53c2\u9605\u201cip tuntap show\u201d\u7684\u8f93\u51fa\u3002 \u96a7\u9053\u7ba1\u7406 \u96a7\u9053\u662f\u770b\u8d77\u6765\u50cf\u666e\u901a\u63a5\u53e3\u7684\u201c\u7f51\u7edc\u866b\u6d1e\u201d\uff0c\u4f46\u901a\u8fc7\u5b83\u4eec\u53d1\u9001\u7684\u6570\u636e\u5305\u88ab\u5c01\u88c5\u5230\u53e6\u4e00\u4e2a\u534f\u8bae\u4e2d\uff0c\u5e76\u901a\u8fc7\u591a\u4e2a\u4e3b\u673a\u53d1\u9001\u5230\u96a7\u9053\u7684\u53e6\u4e00\u7aef\uff0c\u7136\u540e\u6309\u7167\u901a\u5e38\u7684\u65b9\u5f0f\u8fdb\u884c\u89e3\u5c01\u88c5\u548c\u5904\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5047\u88c5\u4e24\u53f0\u673a\u5668\u6709\u76f4\u63a5\u7684\u8fde\u901a\u6027\uff0c\u800c\u4ed6\u4eec\u5b9e\u9645\u4e0a\u6ca1\u6709\u3002 \u8fd9\u901a\u5e38\u7528\u4e8e\u865a\u62df\u4e13\u7528\u7f51\u7edc\uff08\u4e0eIPsec\u4e4b\u7c7b\u7684\u52a0\u5bc6\u4f20\u8f93\u534f\u8bae\u7ed3\u5408\u4f7f\u7528\uff09\uff0c\u6216\u901a\u8fc7\u4e0d\u4f7f\u7528\u5b83\u7684\u4e2d\u95f4\u7f51\u7edc\u8fde\u63a5\u4f7f\u7528\u67d0\u79cd\u534f\u8bae\u7684\u7f51\u7edc\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4ec5\u652f\u6301IPv4\u7684\u7f51\u6bb5\u5206\u9694\u7684IPv6\u7f51\u7edc\uff09\u3002 \u6ce8\u610f\uff1a\u96a7\u9053\u81ea\u5df1\u63d0\u4f9b\u96f6\u5b89\u5168\u6027\u3002\u5b83\u4eec\u4e0e\u5176\u5e95\u5c42\u7f51\u7edc\u4e00\u6837\u5b89\u5168\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u9700\u8981\u5b89\u5168\u6027\uff0c\u8bf7\u901a\u8fc7\u52a0\u5bc6\u4f20\u8f93\uff08\u4f8b\u5982IPsec\uff09\u4f7f\u7528\u5b83\u4eec\u3002 Linux\u76ee\u524d\u652f\u6301IPIP\uff08IPv4\u4e2d\u7684IPv4\uff09\uff0cSIT\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cIP6IP6\uff08IPv6\u4e2d\u7684IPv6\uff09\uff0cIPIP6\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cGRE\uff08\u51e0\u4e4e\u4efb\u4f55\u4e1c\u897f\uff09\u4ee5\u53ca\u6700\u8fd1\u7684\u7248\u672c\u4e2d\u7684VTI IPsec\uff09\u7684\u3002 \u8bf7\u6ce8\u610f\uff0c\u96a7\u9053\u662f\u5728DOWN\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u60a8\u9700\u8981\u5c06\u5b83\u4eec\u63d0\u8d77\u3002 \u5728\u672c\u8282\u4e2d\uff0c$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u548c$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u662f\u6307\u5206\u914d\u7ed9\u7aef\u70b9\u7269\u7406\u63a5\u53e3\u7684\u5730\u5740\u3002$ {address}\u662f\u6307\u5206\u914d\u7ed9tunnel\u63a5\u53e3\u7684\u5730\u5740\u3002 \u521b\u5efa\u4e00\u4e2aIPIP\u96a7\u9053 ip tunnel add $ {interface name}\u6a21\u5f0fipip local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun0 mode ipip local 192.0.2.1 remote 198.51.100.3 ip link set dev tun0 up ip address add 10.0.0.1/30 dev tun0 \u521b\u5efa\u4e00\u4e2aSIT\u96a7\u9053 sudo ip tunnel add $ {interface name}\u6a21\u5f0f\u5750\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun9\u6a21\u5f0f\u5750\u672c\u5730192.0.2.1\u8fdc\u7a0b198.51.100.3 ip link set dev tun9 up ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun9 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u901a\u5e38\u7528\u4e8e\u4e3aIPv4\u8fde\u63a5\u7684\u7f51\u7edc\u63d0\u4f9bIPv6\u8fde\u63a5\u3002\u6709\u6240\u8c13\u7684\u201c\u96a7\u9053\u7ecf\u7eaa\u4eba\u201d\u63d0\u4f9b\u7ed9\u6240\u6709\u611f\u5174\u8da3\u7684\u4eba\uff0c\u5982Hurricane Electric tunnelbroker.net\u3002 \u521b\u5efa\u4e00\u4e2aIPIP6\u96a7\u9053 ip -6 tunnel add $ {interface name}\u6a21\u5f0fipip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun8 mode ipip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u5728\u4e2d\u8f6c\u8fd0\u8425\u5546\u5206\u9636\u6bb5IPv4\uff08\u5373\u4e0d\u4f1a\u5f88\u5feb\uff09\u65f6\u5e7f\u6cdb\u4f7f\u7528\u3002 \u521b\u5efa\u4e00\u4e2aIP6IP6\u96a7\u9053 ip -6 tunnel add $ {interface name}\u6a21\u5f0fip6ip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun3 mode ip6ip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 ip\u94fe\u63a5\u8bbe\u7f6edev tun3 up ip address add 2001\uff1adb8\uff1a2\uff1a2 :: 1/64 dev tun3 \u5c31\u50cfIPIP6\u4e00\u6837\uff0c\u8fd9\u4e9b\u4e0d\u4f1a\u5f88\u5feb\u6709\u7528\u3002 \u521b\u5efa\u4e00\u4e2agretap\uff08\u4ee5\u592a\u7f51over GRE\uff09\u8bbe\u5907 IP\u94fe\u63a5\u6dfb\u52a0$ {\u63a5\u53e3\u540d\u79f0}\u7c7b\u578bgretap\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip link add gretap0 type gretap local 192.0.2.1 remote 203.0.113.3 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u4ee5\u592a\u7f51\u5e27\u5c01\u88c5\u4e3aIPv4\u6570\u636e\u5305\u3002 \u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u4e5f\u652f\u6301IPv6\u4e0a\u7684gretap\uff0c\u4f60\u9700\u8981\u7528\u201cip6gretap\u201d\u66ff\u6362\u6a21\u5f0f\u6765\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8eIPv6\u7684\u94fe\u63a5\u3002 \u8fd9\u53ef\u80fd\u5e94\u8be5\u662f\u5728\u201c\u94fe\u63a5\u7ba1\u7406\u201d\u90e8\u5206\uff0c\u4f46\u7531\u4e8e\u5b83\u6d89\u53ca\u5c01\u88c5\uff0c\u5b83\u5728\u8fd9\u91cc\u3002\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u7684\u96a7\u9053\u63a5\u53e3\u770b\u8d77\u6765\u50cf\u4e00\u4e2aL2\u94fe\u8def\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5176\u6dfb\u52a0\u5230\u6865\u7ec4\u3002\u8fd9\u7528\u4e8e\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u8fde\u63a5L2\u6bb5\u3002 \u521b\u5efa\u4e00\u4e2aGRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun6 mode gre local 192.0.2.1 remote 203.0.113.3 ip\u94fe\u63a5\u8bbe\u7f6edev tun6 up ip address add 192.168.0.1/30 dev tun6 ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun6 GRE\u53ef\u4ee5\u540c\u65f6\u5c01\u88c5IPv4\u548cIPv6\u3002\u4f46\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f7f\u7528IPv4\u8fdb\u884c\u4f20\u8f93\uff0c\u5bf9\u4e8e\u57fa\u4e8eIPv6\u7684GRE\uff0c\u5b58\u5728\u5355\u72ec\u7684\u96a7\u9053\u6a21\u5f0f\u201cip6gre\u201d\u3002 \u521b\u5efa\u591a\u4e2aGRE\u96a7\u9053\u5230\u540c\u4e00\u4e2a\u7aef\u70b9 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u952e$ {\u952e\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun4 mode gre local 192.0.2.1 remote 203.0.113.6 key 123 ip tunnel add tun5 mode gre local 192.0.2.1 remote 203.0.113.6 key 124 \u952e\u63a7\u96a7\u9053\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u6765\u89e3\u9664\u5bc6\u7801\u3002\u5bc6\u94a5\u53ef\u80fd\u91c7\u7528\u70b9\u5206\u5341\u8fdb\u5236IPv4\u7c7b\u683c\u5f0f\u3002 \u8bf7\u6ce8\u610f\uff0c\u5bc6\u94a5\u4e0d\u4f1a\u4e3a\u96a7\u9053\u6dfb\u52a0\u4efb\u4f55\u5b89\u5168\u6027\u3002\u8fd9\u53ea\u662f\u4e00\u4e2a\u7528\u6765\u533a\u5206\u4e00\u6761\u96a7\u9053\u548c\u53e6\u4e00\u6761\u96a7\u9053\u7684\u6807\u8bc6\u7b26\u3002 \u521b\u5efa\u4e00\u4e2a\u70b9\u5bf9\u591a\u70b9\u7684GRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u5bc6\u94a5$ {\u5bc6\u94a5\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun8 mode gre local 192.0.2.1 key 1234 ip\u94fe\u63a5\u8bbe\u7f6edev tun8 up ip address add 10.0.0.1/27 dev tun8 \u8bf7\u6ce8\u610f\u7f3a\u5c11$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u3002\u8fd9\u4e0eCisco IOS\u4e2d\u6240\u8c13\u7684\u201cmode gre multipoint\u201d\u76f8\u540c\u3002 \u5728\u6ca1\u6709\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\u7684\u60c5\u51b5\u4e0b\uff0c\u5bc6\u94a5\u662f\u8bc6\u522b\u96a7\u9053\u6d41\u91cf\u7684\u552f\u4e00\u65b9\u6cd5\uff0c\u56e0\u6b64\u9700\u8981$ {key value}\u3002 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5141\u8bb8\u60a8\u901a\u8fc7\u4f7f\u7528\u76f8\u540c\u7684\u96a7\u9053\u63a5\u53e3\u4e0e\u591a\u4e2a\u7aef\u70b9\u8fdb\u884c\u901a\u4fe1\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5177\u6709\u591a\u4e2a\u7aef\u70b9\u7684\u590d\u6742VPN\u8bbe\u7f6e\uff08\u5728\u601d\u79d1\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u52a8\u6001\u591a\u70b9VPN\u201d\uff09\u3002 \u7531\u4e8e\u6ca1\u6709\u660e\u786e\u7684\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\uff0c\u663e\u7136\u4ec5\u4ec5\u521b\u5efa\u96a7\u9053\u662f\u4e0d\u591f\u7684\u3002\u4f60\u7684\u7cfb\u7edf\u9700\u8981\u77e5\u9053\u5176\u4ed6\u7aef\u70b9\u5728\u54ea\u91cc\u3002 \u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u4f7f\u7528NHRP\uff08\u4e0b\u4e00\u8df3\u89e3\u6790\u534f\u8bae\uff09\u3002\u5bf9\u4e8e\u6d4b\u8bd5\uff0c\u60a8\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u5bf9\u7b49\u7aef\uff08\u7ed9\u5b9a\u8fdc\u7a0b\u7aef\u70b9\u5728\u5176\u7269\u7406\u63a5\u53e3\u4e0a\u4f7f\u7528203.0.113.6\u5730\u5740\uff0c\u5728\u96a7\u9053\u4e0a\u4f7f\u752810.0.0.2\uff09\uff1a ip neighbor add 10.0.0.2 lladdr 203.0.113.6 dev tun8 \u60a8\u4e5f\u5fc5\u987b\u5728\u8fdc\u7a0b\u7aef\u70b9\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a ip neighbor add 10.0.0.1 lladdr 192.0.2.1 dev tun8 \u8bf7\u6ce8\u610f\uff0c\u94fe\u8def\u5c42\u5730\u5740\u548c\u90bb\u5c45\u5730\u5740\u90fd\u662fIP\u5730\u5740\uff0c\u56e0\u6b64\u5b83\u4eec\u4f4d\u4e8e\u540c\u4e00\u4e2aOSI\u5c42\u3002\u94fe\u8def\u5c42\u5730\u5740\u6982\u5ff5\u53d8\u5f97\u6709\u8da3\u7684\u60c5\u51b5\u4e4b\u4e00\u3002 \u901a\u8fc7IPv6\u521b\u5efaGRE\u96a7\u9053 \u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u652f\u6301GRE over IPv6\u3002\u6ca1\u6709\u5bc6\u94a5\u7684\u70b9\u5bf9\u70b9\uff1a ip-6\u96a7\u9053\u6dfb\u52a0\u540d\u79f0$ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fip6gre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9} \u5b83\u5e94\u8be5\u652f\u6301\u4e0a\u8ff0IPv4 GRE\u652f\u6301\u7684\u6240\u6709\u9009\u9879\u548c\u529f\u80fd\u3002 \u5220\u9664\u96a7\u9053 ip tunnel del $ {interface name} \u4f8b\u5b50\uff1a ip tunnel del gre1 \u8bf7\u6ce8\u610f\uff0c\u5728\u8f83\u65e7\u7684iproute2\u7248\u672c\u4e2d\uff0c\u6b64\u547d\u4ee4\u4e0d\u652f\u6301\u5b8c\u6574\u7684\u201c\u5220\u9664\u201d\u5b57\uff0c\u53ea\u6709\u201cdel\u201d\u3002\u6700\u8fd1\u7684\u7248\u672c\u5141\u8bb8\u5168\u90e8\u548c\u7f29\u5199\u5f62\u5f0f\uff08\u5728iproute2-ss131122\u4e2d\u6d4b\u8bd5\uff09\u3002 \u4fee\u6539\u96a7\u9053 IP\u96a7\u9053\u66f4\u6539$ {\u63a5\u53e3\u540d\u79f0} $ {\u9009\u9879} \u4f8b\u5b50\uff1a ip tunnel change tun0 remote 203.0.113.89 ip\u96a7\u9053\u66f4\u6539tun10\u5bc6\u94a523456 \u6ce8\u610f\uff1a\u663e\u7136\uff0c\u60a8\u65e0\u6cd5\u5c06\u5bc6\u94a5\u6dfb\u52a0\u5230\u4e4b\u524d\u672a\u52a0\u5bc6\u7684\u96a7\u9053\u3002\u4e0d\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u9519\u8bef\u8fd8\u662f\u4e00\u4e2a\u529f\u80fd\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u663e\u800c\u6613\u89c1\u7684\u539f\u56e0\uff0c\u60a8\u65e0\u6cd5\u5373\u65f6\u66f4\u6539\u96a7\u9053\u6a21\u5f0f\u3002 \u67e5\u770b\u96a7\u9053\u4fe1\u606f IP\u96a7\u9053\u8868\u6f14 ip tunnel show $ {interface name} \u4f8b\u5b50\uff1a $ ip tun show tun99 tun99\uff1agre / ip remote 10.46.1.20 local 10.91.19.110 ttl inherit L2TPv3\u4f2a\u7ebf\u7ba1\u7406 L2TPv3\u662fL2\u4f2a\u7ebf\u901a\u5e38\u4f7f\u7528\u7684\u96a7\u9053\u534f\u8bae\u3002 \u5728\u8bb8\u591a\u53d1\u884c\u7248\u4e2d\uff0cL2TPv3\u88ab\u7f16\u8bd1\u4e3a\u6a21\u5757\uff0c\u5e76\u4e14\u53ef\u80fd\u4e0d\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u3002\u5982\u679c\u4f60\u5f97\u5230\u4e00\u4e2a\u201cRTNETLINK\u7b54\u6848\uff1a\u6ca1\u6709\u8fd9\u6837\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u201d\u548c\u201c\u9519\u8bef\u7684\u5bf9\u5185\u6838\u201d\u6d88\u606f\u7ed9\u4efb\u4f55\u201cip l2tp\u201d\u547d\u4ee4\uff0c\u60c5\u51b5\u53ef\u80fd\u5982\u6b64\u3002\u52a0\u8f7dl2tp_netlink\u548c l2tp_eth\u6a21\u5757\u3002\u5982\u679c\u4f60\u60f3\u901a\u8fc7IP\u800c\u4e0d\u662fUDP\u4f7f\u7528L2TPv3\uff0c\u8fd8\u9700\u8981\u52a0\u8f7d l2tp_ip\u3002 \u4e0eLinux\u4e2d\u7684\u5176\u4ed6\u96a7\u9053\u534f\u8bae\u5b9e\u73b0\u76f8\u6bd4\uff0cL2TPv3\u672f\u8bed\u6709\u6240\u9006\u8f6c\u3002\u60a8\u521b\u5efa\u4e00\u4e2a\u96a7\u9053\uff0c\u7136\u540e\u7ed1\u5b9a\u4f1a\u8bdd\u5427\u3002\u60a8\u53ef\u4ee5\u5c06\u5177\u6709\u4e0d\u540c\u6807\u8bc6\u7b26\u7684\u591a\u4e2a\u4f1a\u8bdd\u7ed1\u5b9a\u5230\u76f8\u540c\u7684\u96a7\u9053\u3002\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff08\u9ed8\u8ba4\u540d\u79f0\u4e3al2tpethX\uff09\u4e0e\u4f1a\u8bdd\u76f8\u5173\u8054\u3002 \u6ce8\u610f\uff1a Linux\u5185\u6838\u4ec5\u5b9e\u73b0\u6570\u636e\u5e27\u7684\u5904\u7406\uff0c\u56e0\u6b64\u60a8\u53ea\u80fd\u521b\u5efa\u5e26\u6709iproute2\u7684\u975e\u6258\u7ba1\u96a7\u9053\uff0c\u5e76\u4e14\u53cc\u65b9\u90fd\u624b\u52a8\u914d\u7f6e\u6240\u6709\u8bbe\u7f6e\u3002\u5982\u679c\u60a8\u60f3\u8981\u4f7f\u7528L2TP\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95eeVPN\u6216\u5176\u4ed6\u975e\u56fa\u5b9a\u4f2a\u7ebf\uff0c\u5219\u9700\u8981\u7528\u6237\u7a7a\u95f4\u5b88\u62a4\u7a0b\u5e8f\u6765\u5904\u7406\u5b83\u3002\u8fd9\u8d85\u51fa\u4e86\u672c\u6587\u6863\u8303\u56f4\u3002 \u901a\u8fc7UDP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id $ {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ udp_sport $ {\u6e90\u7aef\u53e3} \\ udp_dport $ {\u76ee\u6807\u7aef\u53e3} \\ encap udp \\ \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} \\ \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id 1 \\ peer_tunnel_id 1 \\ udp_sport 5000 \\ udp_dport 5000 encap udp \\ \u672c\u5730192.0.2.1 \u8fdc\u7a0b203.0.113.2 \u6ce8\u610f\uff1a\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u96a7\u9053\u6807\u8bc6\u7b26\u548c\u5176\u4ed6\u8bbe\u7f6e\u5fc5\u987b\u5339\u914d\u3002 \u901a\u8fc7IP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ encap ip \\ \u672c\u5730192.0.2.1 \\ \u8fdc\u7a0b203.0.113.2 \u76f4\u63a5\u5c01\u88c5\u6210IP\u7684L2TPv3\u63d0\u4f9b\u8f83\u5c11\u7684\u5f00\u9500\uff0c\u4e00\u822c\u65e0\u6cd5\u901a\u8fc7NAT\u3002 \u521b\u5efa\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp add session tunnel_id $ {local tunnel identifier} \\ session_id $ {\u672c\u5730\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_session_id $ {\u8fdc\u7a0b\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26} \u4f8b\u5b50\uff1a ip l2tp add session tunnel_id 1 session_id 10 \\ peer_session_id 10 \u6ce8\u610f\uff1a tunnel_id\u503c\u5fc5\u987b\u5339\u914d\u5148\u524d\u521b\u5efa\u7684\u96a7\u9053\u7684\u503c\u3002\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u4f1a\u8bdd\u6807\u8bc6\u7b26\u5fc5\u987b\u5339\u914d\u3002 \u4e00\u65e6\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a\u96a7\u9053\u548c\u4e00\u4e2a\u4f1a\u8bdd\uff0cl2tpethX\u754c\u9762\u5c31\u4f1a\u51fa\u73b0\uff0c\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u5c06\u72b6\u6001\u66f4\u6539\u4e3a\u542f\u52a8\u5e76\u5c06\u5176\u4e0e\u53e6\u4e00\u4e2a\u754c\u9762\u6865\u63a5\u6216\u5206\u914d\u5730\u5740\u3002 \u5220\u9664\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp del session tunnel_id $ {tunnel identifier} \\ session_id $ {\u4f1a\u8bdd\u6807\u8bc6\u7b26} \u4f8b\u5b50 ip l2tp del session tunnel_id 1 session_id 1 \u5220\u9664L2TPv3\u96a7\u9053 ip l2tp del tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50 ip l2tp del tunnel tunnel_id 1 \u6ce8\u610f\uff1a\u5220\u9664\u4e4b\u524d\uff0c\u60a8\u9700\u8981\u5220\u9664\u4e0e\u96a7\u9053\u76f8\u5173\u7684\u6240\u6709\u4f1a\u8bdd\u3002 \u67e5\u770bL2TPv3\u96a7\u9053\u4fe1\u606f ip l2tp\u663e\u793a\u96a7\u9053 ip l2tp show tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50\uff1a ip l2tp show tunnel tunnel_id 12 \u67e5\u770bL2TPv3\u4f1a\u8bdd\u4fe1\u606f ip l2tp\u663e\u793a\u4f1a\u8bdd ip l2tp show session session_id $ {session identifier} \\ tunnel_id $ {\u96a7\u9053\u6807\u8bc6\u7b26} \u4f8b\u5b50\uff1a ip l2tp show session session_id 1 tunnel_id 12 VXLAN\u7ba1\u7406 VXLAN\u662f\u7b2c2\u5c42\u96a7\u9053\u534f\u8bae\uff0c\u901a\u5e38\u4e0e\u865a\u62df\u5316\u7cfb\u7edf\uff08\u5982KVM\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u8fd0\u884c\u5728\u4e0d\u540c\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u8282\u70b9\u4e0a\u7684\u865a\u62df\u673a\u5f7c\u6b64\u8fde\u63a5\u5e76\u8fde\u63a5\u5230\u5916\u90e8\u4e16\u754c\u3002 \u4e0e\u70b9\u5bf9\u70b9\u7684GRE\u6216L2TPv3\u4e0d\u540c\uff0cVXLAN\u901a\u8fc7\u4f7f\u7528IP\u591a\u64ad\u6765\u590d\u5236\u591a\u8def\u8bbf\u95ee\u4ea4\u6362\u7f51\u7edc\u7684\u4e00\u4e9b\u5c5e\u6027\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u901a\u8fc7\u4e0e\u5e27\u4e00\u8d77\u53d1\u9001\u7f51\u7edc\u6807\u8bc6\u7b26\u6765\u652f\u6301\u865a\u62df\u7f51\u7edc\u5206\u79bb\u3002 \u7f3a\u70b9\u662f\u60a8\u9700\u8981\u4f7f\u7528\u591a\u64ad\u8def\u7531\u534f\u8bae\uff08\u901a\u5e38\u662fPIM-SM\uff09\u624d\u80fd\u4f7f\u5176\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u5de5\u4f5c\u3002 VXLAN\u7684\u5e95\u5c42\u5c01\u88c5\u534f\u8bae\u662fUDP\u3002 \u521b\u5efa\u5355\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan id <0-16777215> dev $ {source interface} \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan ID 42 dev eth0\u8fdc\u7a0b203.0.113.6\u672c\u5730192.0.2.1 dstport 4789 \u6ce8\u610f\uff1a id\u9009\u9879\u8868\u793aVXLAN\u7f51\u7edc\u6807\u8bc6\u7b26\uff08VNI\uff09\u3002 \u521b\u5efa\u7ec4\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan id <0-16777215> dev $ {source interface} \u7ec4$ {\u591a\u64ad\u5730\u5740} dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan id 42 dev eth0\u7ec4239.0.0.1 dstport 4789 \u4e4b\u540e\uff0c\u60a8\u9700\u8981\u5c06\u94fe\u63a5\u4e0e\u5176\u4ed6\u63a5\u53e3\u6865\u63a5\u6216\u5206\u914d\u5730\u5740\u3002 \u8def\u7531\u7ba1\u7406 \u5bf9\u4e8eIPv4\u8def\u7531\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u524d\u7f00\u957f\u5ea6\u6216\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.0/24\u548c192.0.2.0/255.255.255.0\u90fd\u53ef\u4ee5\u63a5\u53d7\u3002 \u6ce8\u610f\uff1a\u6839\u636e\u4e0b\u9762\u7684\u90e8\u5206\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u9759\u6001\u8def\u7531\uff0c\u5e76\u4e14\u7531\u4e8e\u94fe\u63a5\u5173\u95ed\u800c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5b83\u5c06\u88ab\u5220\u9664\uff0c\u5e76\u4e14 \u6c38\u8fdc\u4e0d\u4f1a\u81ea\u884c\u6062\u590d\u3002\u60a8\u53ef\u80fd\u6ca1\u6709\u6ce8\u610f\u5230\u8fd9\u79cd\u884c\u4e3a\uff0c\u56e0\u4e3a\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u9644\u52a0\u8f6f\u4ef6\uff08\u4f8b\u5982NetworkManager\u6216rp-pppoe\uff09\u8d1f\u8d23\u5728\u94fe\u63a5\u4e0a\u4e0b\u65f6\u6062\u590d\u8def\u7531\u3002 \u5982\u679c\u60a8\u6253\u7b97\u5c06\u60a8\u7684Linux\u673a\u5668\u7528\u4f5c\u8def\u7531\u5668\uff0c\u8bf7\u8003\u8651\u5b89\u88c5\u8bf8\u5982Quagga \u6216BIRD\u4e4b\u7c7b\u7684\u8def\u7531\u534f\u8bae\u5957\u4ef6\u3002\u5b83\u4eec\u8ddf\u8e2a\u63a5\u53e3\u72b6\u6001\u5e76\u5728\u8def\u7531\u5668\u65ad\u5f00\u540e\u6062\u590d\u8def\u7531\u65f6\u6062\u590d\u8def\u7531\u3002\u5f53\u7136\uff0c\u4ed6\u4eec\u4e5f\u5141\u8bb8\u4f60\u4f7f\u7528\u52a8\u6001\u8def\u7531\u534f\u8bae\uff0c\u5982OSPF\u548cBGP\u3002 \u8fde\u63a5\u7684\u8def\u7ebf \u67d0\u4e9b\u8def\u7ebf\u5728\u7cfb\u7edf\u4e2d\u663e\u793a\uff0c\u6ca1\u6709\u660e\u786e\u7684\u914d\u7f6e\uff08\u8fdd\u80cc\u60a8\u7684\u610f\u613f\uff09\u3002 \u4e00\u65e6\u4e3a\u63a5\u53e3\u5206\u914d\u5730\u5740\uff0c\u7cfb\u7edf\u5c06\u8ba1\u7b97\u5176\u7f51\u7edc\u5730\u5740\u5e76\u4e3a\u5176\u521b\u5efa\u8def\u7531\uff08\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u5b50\u7f51\u63a9\u7801\uff09\u3002\u8fd9\u4e9b\u8def\u7531\u88ab\u79f0\u4e3a\u8fde\u63a5\u8def\u7531\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u5c06203.0.113.25/24\u5206\u914d\u7ed9eth0\uff0c\u5219\u4f1a\u521b\u5efa\u5230203.0.113.0/24\u7f51\u7edc\u7684\u5df2\u8fde\u63a5\u8def\u7531\uff0c\u5e76\u4e14\u7cfb\u7edf\u5c06\u77e5\u9053\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u8be5\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a\u3002 \u5f53\u63a5\u53e3\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u4e0e\u5176\u5173\u8054\u7684\u8fde\u63a5\u8def\u7531\u5c06\u88ab\u5220\u9664\u3002\u8fd9\u7528\u4e8e\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u68c0\u6d4b\uff0c\u56e0\u6b64\u901a\u8fc7\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u7684\u8def\u7531\u88ab\u5220\u9664\u3002\u76f8\u540c\u7684\u673a\u5236\u963b\u6b62\u60a8\u901a\u8fc7\u65e0\u6cd5\u8bbf\u95ee\u7684\u7f51\u5173\u521b\u5efa\u8def\u7531\u3002 \u67e5\u770b\u6240\u6709\u8def\u7ebf ip\u8def\u7531 ip\u8def\u7531\u663e\u793a \u60a8\u53ef\u4ee5\u4f7f\u7528-4\u548c-6\u9009\u9879\u4ec5\u67e5\u770bIPv4\u6216IPv6\u8def\u7531\u3002\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u9009\u9879\uff0c\u5219\u663e\u793aIPv4\u8def\u7531\u3002\u8981\u67e5\u770bIPv6\u8def\u7531\uff0c\u8bf7\u4f7f\u7528\uff1a ip-6\u8def\u7531 \u67e5\u770b\u5230\u7f51\u7edc\u53ca\u5176\u6240\u6709\u5b50\u7f51\u7684\u8def\u7531 ip route show to root $ {address} / $ {mask} \u4f8b\u5982\uff0c\u5982\u679c\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528192.168.0.0/24\u5b50\u7f51\uff0c\u5e76\u4e14\u8be5\u5b50\u7f51\u5206\u4e3a192.168.0.0/25\u548c192.168.0.128/25\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u6240\u6709\u8fd9\u4e9b\u8def\u7531\uff1a ip route\u663e\u793a\u4e3a\u6839192.168.0.0/24 \u6ce8\u610f\uff1a\u8fd9\u4e2a\u548c\u5176\u4ed6show\u547d\u4ee4\u4e2d\u7684\u201cto\u201d\u662f\u53ef\u9009\u7684\u3002 \u67e5\u770b\u5230\u7f51\u7edc\u548c\u6240\u6709\u8d85\u7f51\u7684\u8def\u7531 ip route show to match $ {address} / $ {mask} \u5982\u679c\u8981\u67e5\u770b\u8def\u7531\u5230192.168.0.0/24\u548c\u6240\u6709\u66f4\u5927\u7684\u5b50\u7f51\uff0c\u8bf7\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u5339\u914d192.168.0.0/24 \u7531\u4e8e\u8def\u7531\u5668\u66f4\u504f\u5411\u4e8e\u66f4\u5177\u4f53\u7684\u8def\u7531\uff0c\u56e0\u6b64\u901a\u5e38\u7528\u4e8e\u8c03\u8bd5\u7279\u5b9a\u5b50\u7f51\u7684\u6d41\u91cf\u53d1\u9001\u9519\u8bef\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u7f3a\u5c11\u8def\u7531\u4f46\u5b58\u5728\u5230\u8f83\u5927\u5b50\u7f51\u7684\u8def\u7531\u3002 \u67e5\u770b\u8def\u7531\u5230\u786e\u5207\u7684\u5b50\u7f51 ip route\u663e\u793a\u7cbe\u786e$ {address} / $ {mask} \u5982\u679c\u60a8\u60f3\u67e5\u770b192.168.0.0/24\u7684\u8def\u7531\uff0c\u4f46\u4e0d\u60f3\u67e5\u770b\u8def\u7531192.168.0.0/25\u548c192.168.0.0/16\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u786e\u5207\u7684192.168.0.0/24 \u4ec5\u67e5\u770b\u5185\u6838\u5b9e\u9645\u4f7f\u7528\u7684\u8def\u7ebf ip route get $ {address} / $ {mask} \u4f8b\uff1a ip route\u83b7\u5f97192.168.0.0/24 \u8bf7\u6ce8\u610f\uff0c\u5728\u590d\u6742\u8def\u7531\u573a\u666f\uff08\u5982\u591a\u8def\u5f84\u8def\u7531\uff09\u4e2d\uff0c\u7ed3\u679c\u53ef\u80fd\u201c\u6b63\u786e\u4f46\u4e0d\u5b8c\u6574\u201d\uff0c\u56e0\u4e3a\u5b83\u603b\u662f\u663e\u793a\u9996\u5148\u4f7f\u7528\u7684\u4e00\u6761\u8def\u7531\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e0d\u662f\u95ee\u9898\uff0c\u4f46\u4e0d\u8981\u5fd8\u8bb0\u67e5\u770b\u76f8\u5e94\u7684\u201cshow\u201d\u547d\u4ee4\u8f93\u51fa\u3002 \u67e5\u770b\u8def\u7531\u7f13\u5b58\uff08\u4ec5\u9650\u4e8e3.6\u5185\u6838\u4e4b\u524d\uff09 IP\u8def\u7531\u663e\u793a\u7f13\u5b58 \u5728\u7248\u672c3.6\u4e4b\u524d\uff0cLinux\u4f7f\u7528\u8def\u7531\u7f13\u5b58\u3002\u5728\u8f83\u65e9\u7684\u5185\u6838\u4e2d\uff0c\u6b64\u547d\u4ee4\u663e\u793a\u8def\u7531\u7f13\u5b58\u7684\u5185\u5bb9\u3002\u5b83\u53ef\u4ee5\u4e0e\u4e0a\u8ff0\u7684\u4fee\u9970\u7b26\u4e00\u8d77\u4f7f\u7528\u3002\u5728\u8f83\u65b0\u7684\u5185\u6838\u4e2d\uff0c\u5b83\u4ec0\u4e48\u90fd\u4e0d\u505a\u3002 \u901a\u8fc7\u7f51\u5173\u6dfb\u52a0\u8def\u7531 ip route\u901a\u8fc7$ {next hop}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7192.0.2.1\u6dfb\u52a0192.0.2.128/25 ip route add 2001\uff1adb8\uff1a1 :: / 48 via 2001\uff1adb8\uff1a1 :: 1 \u901a\u8fc7\u754c\u9762\u6dfb\u52a0\u8def\u7ebf ip route add $ {address} / $ {mask} dev $ {interface name} \u4f8b\uff1a ip route add 192.0.2.0/25 dev ppp0 \u63a5\u53e3\u8def\u7531\u901a\u5e38\u7528\u4e8e\u70b9\u5bf9\u70b9\u63a5\u53e3\uff0c\u5982PPP\u96a7\u9053\uff0c\u5176\u4e2d\u4e0d\u9700\u8981\u4e0b\u4e00\u8df3\u5730\u5740\u3002 \u66f4\u6539\u6216\u66ff\u6362\u8def\u7ebf \u60a8\u53ef\u4ee5\u4f7f\u7528\u201c\u66f4\u6539\u201d\u547d\u4ee4\u6765\u66f4\u6539\u73b0\u6709\u8def\u7ebf\u7684\u53c2\u6570\u3002\u201c\u66ff\u6362\u201d\u547d\u4ee4\u53ef\u7528\u4e8e\u6dfb\u52a0\u65b0\u8def\u7531\u6216\u4fee\u6539\u73b0\u6709\u8def\u7531\uff08\u5982\u679c\u4e0d\u5b58\u5728\uff09\u3002\u4f8b\u5b50\uff1a IP\u8def\u7531\u901a\u8fc710.0.0.1\u66f4\u6539192.168.2.0/24 ip route\u66ff\u6362192.0.2.1/27 dev tun0 \u5220\u9664\u8def\u7ebf ip route delete $ {\u8def\u7531\u8bed\u53e5\u7684\u5176\u4f59\u90e8\u5206} \u4f8b\u5b50\uff1a IP\u8def\u7531\u901a\u8fc710.0.0.1\u5220\u966410.0.1.0/25 ip route\u5220\u9664\u9ed8\u8ba4dev ppp0 \u9ed8\u8ba4\u8def\u7531 \u6709\u4e00\u4e2a\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\u7684\u5feb\u6377\u65b9\u5f0f\u3002 ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a0\u9ed8\u8ba4\u503c ip route add default dev $ {interface name} \u8fd9\u4e9b\u76f8\u5f53\u4e8e\uff1a ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a00.0.0.0/0 ip route add 0.0.0.0/0 dev $ {interface name} \u5bf9\u4e8eIPv6\u8def\u7531\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5de5\u4f5c\uff0c\u76f8\u5f53\u4e8e:: / 0 ip-6\u8def\u7531\u901a\u8fc72001\uff1adb8 :: 1\u6dfb\u52a0\u9ed8\u8ba4\u503c \u9ed1\u6d1e\u8def\u7ebf ip route add blackhole $ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route add blackhole 192.0.2.1/32 \u4e0e\u9ed1\u6d1e\u8def\u7ebf\u76f8\u5339\u914d\u7684\u76ee\u7684\u5730\u7684\u4ea4\u901a\u6d41\u88ab\u65e0\u58f0\u5730\u4e22\u5f03\u3002 \u9ed1\u6d1e\u8def\u7ebf\u6709\u53cc\u91cd\u76ee\u7684\u3002\u9996\u5148\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4e22\u5f03\u53d1\u9001\u5230\u4e0d\u60f3\u8981\u7684\u76ee\u7684\u5730\u7684\u6d41\u91cf\uff0c\u4f8b\u5982\u5df2\u77e5\u7684\u6076\u610f\u4e3b\u673a\u3002 \u7b2c\u4e8c\u4e2a\u4e0d\u592a\u660e\u663e\uff0c\u6309\u7167RFC1812\u4f7f\u7528\u201c\u6700\u957f\u5339\u914d\u89c4\u5219\u201d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u8def\u7531\u5668\u8ba4\u4e3a\u5b83\u5177\u6709\u901a\u5f80\u66f4\u5927\u5b50\u7f51\u7684\u8def\u7531\uff0c\u800c\u4e0d\u662f\u6574\u4f53\u4f7f\u7528\u5b83\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u52a8\u6001\u8def\u7531\u534f\u8bae\u901a\u544a\u6574\u4e2a\u5b50\u7f51\u65f6\u3002\u5927\u578b\u5b50\u7f51\u901a\u5e38\u4f1a\u5206\u6210\u8f83\u5c0f\u7684\u90e8\u5206\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u7684\u5b50\u7f51\u662f192.0.2.0/24\uff0c\u5e76\u4e14\u60a8\u5df2\u5c06192.0.2.1/25\u548c192.0.2.129/25\u5206\u914d\u7ed9\u60a8\u7684\u63a5\u53e3\uff0c\u5219\u7cfb\u7edf\u4f1a\u521b\u5efa\u8fde\u63a5\u5230/ 25\u7684\u8fde\u63a5\u8def\u7531\uff0c\u4f46\u4e0d\u662f\u6574\u4e2a/ 24\uff0c\u5e76\u4e14\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u53ef\u80fd\u4e0d\u60f3\u901a\u544a/ 24\uff0c\u56e0\u4e3a\u60a8\u6ca1\u6709\u8def\u7531\u5230\u8be5\u786e\u5207\u7684\u5b50\u7f51\u3002\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u9ed1\u6d1e\u8def\u7531\u8bbe\u7f6e\u4e3a192.0.2.0/24\u3002 \u5176\u4ed6\u7279\u6b8a\u8def\u7ebf ip route add unreachable $ {address} / $ {mask} ip route add prohibit $ {address} / $ {mask} ip route add throw $ {address} / $ {mask} \u8fd9\u4e9b\u8def\u7531\u4f7f\u7cfb\u7edf\u4e22\u5f03\u6570\u636e\u5305\uff0c\u5e76\u5411\u53d1\u4ef6\u4eba\u56de\u590dICMP\u9519\u8bef\u6d88\u606f\u3002 \u65e0\u6cd5\u8bbf\u95ee \u53d1\u9001ICMP\u201c\u4e3b\u673a\u4e0d\u53ef\u8fbe\u201d\u3002 \u7981\u6b62 \u53d1\u9001ICMP\u201c\u7ba1\u7406\u7981\u6b62\u201d\u3002 \u6254 \u53d1\u9001\u201c\u7f51\u7edc\u4e0d\u53ef\u8fbe\u201d\u3002 \u4e0e\u9ed1\u6d1e\u8def\u7531\u4e0d\u540c\uff0c\u8fd9\u4e9b\u4e0d\u80fd\u7528\u4e8e\u963b\u6b62\u4e0d\u9700\u8981\u7684\u6d41\u91cf\uff08\u4f8b\u5982DDoS\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f1a\u4e3a\u6bcf\u4e2a\u4e22\u5f03\u7684\u6570\u636e\u5305\u751f\u6210\u4e00\u4e2a\u56de\u590d\u6570\u636e\u5305\uff0c\u4ece\u800c\u521b\u5efa\u66f4\u5927\u7684\u6d41\u91cf\u3002\u5b83\u4eec\u53ef\u4ee5\u5f88\u597d\u5730\u5b9e\u65bd\u5185\u90e8\u8bbf\u95ee\u7b56\u7565\uff0c\u4f46\u9996\u5148\u8003\u8651\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u9632\u706b\u5899\u3002 \u201c\u629b\u51fa\u201d\u8def\u7531\u53ef\u7528\u4e8e\u5b9e\u65bd\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff0c\u5728\u975e\u9ed8\u8ba4\u8868\u4e2d\u5b83\u4eec\u4f1a\u505c\u6b62\u5f53\u524d\u8868\u67e5\u627e\uff0c\u4f46\u4e0d\u53d1\u9001ICMP\u9519\u8bef\u6d88\u606f\u3002 \u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u7684\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u516c\u5236$ {number}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc710.0.1.1 metric\u6dfb\u52a0192.168.2.0/24 ip route add 192.168.2.0 dev ppp0 metric 10 \u5982\u679c\u6709\u591a\u6761\u8def\u7531\u901a\u5411\u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u503c\u7684\u540c\u4e00\u4e2a\u7f51\u7edc\uff0c\u5219\u5177\u6709\u6700\u4f4e\u5ea6\u91cf\u503c\u7684\u8def\u7531\u5c06\u662f\u9996\u9009\u3002 \u8fd9\u4e2a\u6982\u5ff5\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u662f\uff0c\u5f53\u4e00\u4e2a\u63a5\u53e3\u5173\u95ed\u65f6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u65e0\u7528\u7684\u8def\u7531\u4ece\u8def\u7531\u8868\u4e2d\u6d88\u5931\uff08\u53c2\u89c1\u8fde\u63a5\u8def\u7531\u90e8\u5206\uff09\uff0c\u7cfb\u7edf\u5c06\u56de\u9000\u5230\u66f4\u9ad8\u7684\u5ea6\u91cf\u8def\u7531\u3002 \u6b64\u529f\u80fd\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u5230\u91cd\u8981\u76ee\u7684\u5730\u7684\u5907\u4efd\u8fde\u63a5\u3002 \u591a\u8def\u5f84\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u6dfb\u52a0$ {addresss} / $ {mask} nexthop\u901a\u8fc7$ {number} nexthop\u901a\u8fc7$ {gateway 2}\u52a0\u6743$ {number} \u591a\u8def\u5f84\u8def\u7531\u4f7f\u5f97\u7cfb\u7edf\u6839\u636e\u6743\u91cd\u5728\u591a\u4e2a\u94fe\u8def\u4e0a\u5e73\u8861\u6570\u636e\u5305\uff08\u8f83\u9ad8\u7684\u6743\u91cd\u662f\u9996\u9009\uff0c\u6240\u4ee5\u6743\u91cd\u4e3a2\u7684\u7f51\u5173/\u63a5\u53e3\u5c06\u6bd4\u53e6\u4e00\u4e2a\u6743\u91cd\u4e3a1\u7684\u7f51\u5173/\u63a5\u53e3\u5927\u7ea6\u591a\u4e24\u500d\uff09\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u914d\u7f6e\u5c3d\u53ef\u80fd\u591a\u7684\u7f51\u5173\uff0c\u5e76\u6df7\u5408\u7f51\u5173\u548c\u63a5\u53e3\u8def\u7531\uff0c\u5982\uff1a ip route\u6dfb\u52a0\u9ed8\u8ba4nexthop\u901a\u8fc7192.168.1.1\u6743\u91cd1 nexthop dev ppp0\u6743\u91cd10 \u8b66\u544a\uff1a\u8fd9\u79cd\u5e73\u8861\u7684\u7f3a\u70b9\u662f\u6570\u636e\u5305\u4e0d\u80fd\u4fdd\u8bc1\u901a\u8fc7\u5b83\u4eec\u8fdb\u5165\u7684\u76f8\u540c\u94fe\u8def\u53d1\u56de\u3002\u8fd9\u79f0\u4e3a\u201c\u4e0d\u5bf9\u79f0\u8def\u7531\u201d\u3002\u5bf9\u4e8e\u7b80\u5355\u5730\u8f6c\u53d1\u6570\u636e\u5305\u800c\u4e0d\u505a\u4efb\u4f55\u672c\u5730\u6d41\u91cf\u5904\u7406\uff08\u5982NAT\uff09\u7684\u8def\u7531\u5668\uff0c\u8fd9\u901a\u5e38\u662f\u6b63\u5e38\u7684\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u751a\u81f3\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002 \u5982\u679c\u60a8\u7684\u7cfb\u7edf\u9664\u4e86\u5728\u63a5\u53e3\u4e4b\u95f4\u8f6c\u53d1\u6570\u636e\u5305\u4e4b\u5916\u4ec0\u4e48\u90fd\u505a\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f20\u5165\u8fde\u63a5\u51fa\u73b0\u95ee\u9898\uff0c\u5e94\u91c7\u53d6\u4e00\u4e9b\u63aa\u65bd\u6765\u9632\u6b62\u5b83\u4eec\u3002 \u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531 Linux\u4e2d\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff08PBR\uff09\u7684\u8bbe\u8ba1\u65b9\u5f0f\u5982\u4e0b\uff1a\u9996\u5148\u521b\u5efa\u81ea\u5b9a\u4e49\u8def\u7531\u8868\uff0c\u7136\u540e\u521b\u5efa\u89c4\u5219\u4ee5\u544a\u77e5\u5185\u6838\u5e94\u8be5\u4f7f\u7528\u8fd9\u4e9b\u8868\u800c\u4e0d\u662f\u9ed8\u8ba4\u8868\u8fdb\u884c\u7279\u5b9a\u6d41\u91cf\u3002 \u4e00\u4e9b\u8868\u683c\u662f\u9884\u5b9a\u4e49\u7684\uff1a \u672c\u5730\uff08\u8868255\uff09 \u5305\u542b\u63a7\u5236\u8def\u7531\u672c\u5730\u548c\u5e7f\u64ad\u5730\u5740\u3002 \u4e3b\u8981\uff08\u8868254\uff09 \u5305\u542b\u6240\u6709\u975ePBR\u8def\u7531\u3002\u5982\u679c\u60a8\u5728\u6dfb\u52a0\u8def\u7ebf\u65f6\u672a\u6307\u5b9a\u8868\u683c\uff0c\u5219\u4f1a\u663e\u793a\u5728\u6b64\u5904\u3002 \u9ed8\u8ba4\uff08\u8868253\uff09 \u4fdd\u7559\u7528\u4e8e\u540e\u671f\u5904\u7406\uff0c\u901a\u5e38\u672a\u4f7f\u7528\u3002 \u7528\u6237\u5b9a\u4e49\u7684\u8868\u683c\u4f1a\u5728\u60a8\u5411\u5176\u6dfb\u52a0\u7b2c\u4e00\u6761\u8def\u7ebf\u65f6\u81ea\u52a8\u521b\u5efa\u3002 \u521b\u5efa\u4e00\u4e2a\u7b56\u7565\u8def\u7531 ip route add $ {route options} table $ {table id or name} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7203.0.113.1\u886810\u6dfb\u52a0192.0.2.0/27 ip route\u901a\u8fc7192.168.0.1\u8868ISP2\u6dfb\u52a00.0.0.0/0 ip route add 2001\uff1adb8 :: / 48 dev eth1 table 100 \u6ce8\u610f\uff1a\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7b56\u7565\u8def\u7531\u4e2d\u7684\u201c\u8def\u7531\u7ba1\u7406\u201d\u90e8\u5206\u4e2d\u63cf\u8ff0\u7684\u4efb\u4f55\u8def\u7531\u9009\u9879\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u6700\u540e\u7684\u201c\u8868$ {\u8868id /\u540d\u79f0}\u201d\u90e8\u5206\u3002 \u6570\u5b57\u8868\u683c\u6807\u8bc6\u7b26\u548c\u540d\u79f0\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\u8981\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u7b26\u53f7\u540d\u79f0\uff0c\u8bf7\u7f16\u8f91/ etc / iproute2 / rt_tables\u914d\u7f6e\u6587\u4ef6\u3002 \u201c\u5220\u9664\u201d\uff0c\u201c\u66f4\u6539\u201d\uff0c\u201c\u66ff\u6362\u201d\u6216\u4efb\u4f55\u5176\u4ed6\u8def\u7531\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u4e0e\u4efb\u4f55\u8868\u4e00\u8d77\u4f7f\u7528\u3002 \u201cip route ... table main\u201d\u6216\u201cip route ... table 254\u201d\u5bf9\u6ca1\u6709\u8868\u683c\u90e8\u5206\u7684\u547d\u4ee4\u5177\u6709\u5b8c\u5168\u76f8\u540c\u7684\u6548\u679c\u3002 \u67e5\u770b\u7b56\u7565\u8def\u7531 ip route show table $ {\u8868ID\u6216\u540d\u79f0} \u4f8b\u5b50\uff1a ip route show table 100 ip route show table test \u6ce8\u610f\uff1a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u9700\u8981\u201c\u663e\u793a\u201d\u5b57\uff0c\u50cf\u201cip route table 120\u201d\u8fd9\u6837\u7684\u7b80\u5199\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u8be5\u547d\u4ee4\u4e0d\u660e\u786e\u3002 \u4e00\u822c\u89c4\u5219\u8bed\u6cd5 ip rule add $ {options} \u5982\u679c\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\uff0c\u5339\u914d$ {options}\uff08\u5982\u4e0b\u6240\u8ff0\uff09\u7684\u6d41\u91cf\u5c06\u6839\u636e\u5177\u6709\u6307\u5b9a\u540d\u79f0/ id\u7684\u8868\u8fdb\u884c\u8def\u7531\uff0c\u800c\u4e0d\u662f\u201c\u4e3b\u201d/ 254\u8868\u3002 \u201c\u9ed1\u6d1e\u201d\uff0c\u201c\u7981\u6b62\u201d\u548c\u201c\u65e0\u6cd5\u8bbf\u95ee\u201d\u7684\u52a8\u4f5c\uff0c\u5176\u5de5\u4f5c\u65b9\u5f0f\u4e0e\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u7684\u7c7b\u578b\u76f8\u540c\u3002\u5728\u5927\u591a\u6570\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\u4f5c\u4e3a\u6700\u5e38\u89c1\u7684\u64cd\u4f5c\u3002 \u5bf9\u4e8eIPv6\u89c4\u5219\uff0c\u4f7f\u7528\u201cip -6\u201d\uff0c\u5176\u4f59\u8bed\u6cd5\u662f\u76f8\u540c\u7684\u3002 \u201ctable $ {table id or name}\u201d\u53ef\u4ee5\u7528\u4f5c\u201c\u67e5\u627e$ {\u8868id\u6216\u540d\u79f0}\u201d\u7684\u522b\u540d\u3002 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u6e90\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u4ece$ {\u6e90\u7f51\u7edc} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e10 \u4ece2001\u5e74ip-6\u89c4\u5219\u6dfb\u52a0\uff1adb8 :: / 32\u7981\u6b62 \u6ce8\u610f\uff1a \u201call\u201d\u53ef\u4ee5\u7528\u4f5c0.0.0.0/0\u6216\u8005:: / 0\u7684\u7b80\u5199 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u76ee\u6807\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u5230$ {\u76ee\u6807\u7f51\u7edc} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u5230192.0.2.0/24\u9ed1\u6d1e ip -6\u89c4\u5219\u6dfb\u52a0\u52302001\uff1adb8 :: / 32\u67e5\u627e100 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914dToS\u5b57\u6bb5\u503c ip rule add tos $ {ToS value} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0tos 0x10\u67e5\u627e110 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u9632\u706b\u5899\u6807\u8bb0\u503c\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0fwmark $ {mark} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0fwmark 0x11\u67e5\u627e100 \u6ce8\u610f\uff1a\u8bf7\u53c2\u9605iptables\u6587\u6863\u4ee5\u4e86\u89e3\u5982\u4f55\u8bbe\u7f6e\u6807\u8bb0\u3002 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u5165\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0IIF $ {\u63a5\u53e3\u540d\u79f0} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0iif eth0\u67e5\u627e10 ip\u89c4\u5219\u6dfb\u52a0iif\u67e5\u627e20 \u201ciif lo\u201d\uff08\u56de\u9001\uff09\u89c4\u5219\u5c06\u5339\u914d\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf\u3002 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u51fa\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip rule add oif $ {interface name} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0oif eth0\u67e5\u627e10 \u6ce8\u610f\uff1a\u8fd9\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf\u3002 \u8bbe\u7f6e\u89c4\u5219\u4f18\u5148\u7ea7 ip\u89c4\u5219\u6dfb\u52a0$ {options} $ {action}\u4f18\u5148\u7ea7$ {value} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/25\u67e5\u627e10\u4f18\u5148\u7ea710 ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e20\u4f18\u5148\u7ea720 \u6ce8\u610f\uff1a\u7531\u4e8e\u89c4\u5219\u4ece\u6700\u4f4e\u4f18\u5148\u7ea7\u5230\u6700\u9ad8\u4f18\u5148\u7ea7\u8fdb\u884c\u904d\u5386\uff0c\u5e76\u4e14\u5904\u7406\u5728\u7b2c\u4e00\u6b21\u5339\u914d\u65f6\u505c\u6b62\uff0c\u6240\u4ee5\u60a8\u9700\u8981\u5728\u4e0d\u592a\u5177\u4f53\u7684\u60c5\u51b5\u4e0b\u653e\u7f6e\u66f4\u5177\u4f53\u7684\u89c4\u5219\u3002\u4ee5\u4e0a\u793a\u4f8b\u6f14\u793a\u4e86192.0.2.0/24\u53ca\u5176\u5b50\u7f51192.0.2.0/25\u7684\u89c4\u5219\u3002\u5982\u679c\u4f18\u5148\u987a\u5e8f\u88ab\u98a0\u5012\u8fc7\u6765\uff0c\u800c\u4e14/ 25\u7684\u89c4\u5219\u88ab\u7f6e\u4e8e24\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u90a3\u6c38\u8fdc\u4e0d\u4f1a\u8fbe\u5230\u3002 \u663e\u793a\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u663e\u793a ip-6\u89c4\u5219\u663e\u793a \u5220\u9664\u89c4\u5219 ip rule del $ {options} $ {action} \u4f8b\u5b50\uff1a ip rule del 192.0.2.0/24\u67e5\u627e10 \u6ce8\u610f\uff1a\u60a8\u53ef\u4ee5\u4ece\u201cip rule show\u201d/\u201cip -6 rule show\u201d\u7684\u8f93\u51fa\u590d\u5236/\u7c98\u8d34\u3002 \u5220\u9664\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u5237\u65b0 ip-6\u89c4\u5219\u5237\u65b0 \u6ce8\uff1a\u6b64\u64cd\u4f5c\u5177\u6709\u9ad8\u5ea6\u7834\u574f\u6027\u3002\u5373\u4f7f\u60a8\u6ca1\u6709\u914d\u7f6e\u4efb\u4f55\u89c4\u5219\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u521d\u59cb\u5316\u201c\u4ece\u6240\u6709\u4e3b\u67e5\u627e\u201d\u89c4\u5219\u3002\u5728\u672a\u914d\u7f6e\u7684\u673a\u5668\u4e0a\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\uff1a $ ip\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 32767\uff1a\u4ece\u6240\u6709\u67e5\u627e\u9ed8\u8ba4 $ ip -6\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 \u201c\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730\u201d\u89c4\u5219\u662f\u7279\u6b8a\u7684\uff0c\u4e0d\u80fd\u88ab\u5220\u9664\u3002\u201c\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981\u201d\u4e0d\u662f\uff0c\u53ef\u80fd\u6709\u6ca1\u6709\u5b83\u7684\u6b63\u5f53\u7406\u7531\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u60f3\u8def\u7531\u4f60\u521b\u5efa\u663e\u5f0f\u89c4\u5219\u7684\u6d41\u91cf\u3002\u4f5c\u4e3a\u4e00\u4e2a\u526f\u4f5c\u7528\uff0c\u5982\u679c\u4f60\u505a\u201cip rule flush\u201d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5c06\u88ab\u5220\u9664\uff0c\u8fd9\u5c06\u4f7f\u7cfb\u7edf\u505c\u6b62\u8def\u7531\u4efb\u4f55\u6d41\u91cf\uff0c\u76f4\u5230\u4f60\u6062\u590d\u4f60\u7684\u89c4\u5219\u3002 \u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u7ba1\u7406 \u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u662f\u5355\u4e2a\u673a\u5668\u4e2d\u9694\u79bb\u7684\u7f51\u7edc\u5806\u6808\u5b9e\u4f8b\u3002\u5b83\u4eec\u53ef\u7528\u4e8e\u5b89\u5168\u57df\u5206\u79bb\uff0c\u7ba1\u7406\u865a\u62df\u673a\u4e4b\u95f4\u7684\u6d41\u91cf\u7b49\u3002 \u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u90fd\u662f\u5177\u6709\u81ea\u5df1\u7684\u63a5\u53e3\uff0c\u5730\u5740\uff0c\u8def\u7531\u7b49\u7684\u7f51\u7edc\u5806\u6808\u7684\u5b8c\u6574\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u8fd0\u884c\u8fdb\u7a0b\uff0c\u5e76\u5c06\u547d\u540d\u7a7a\u95f4\u6865\u63a5\u5230\u7269\u7406\u63a5\u53e3\u3002 \u521b\u5efa\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4 ip netns\u6dfb\u52a0$ {\u547d\u540d\u7a7a\u95f4\u540d\u79f0} \u4f8b\u5b50\uff1a ip netns\u6dfb\u52a0foo \u5217\u51fa\u73b0\u6709\u7684\u547d\u540d\u7a7a\u95f4 ip netns\u5217\u8868 \u5220\u9664\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4 ip netns\u5220\u9664$ {namespace name} \u4f8b\u5b50\uff1a ip netns\u5220\u9664foo \u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4e00\u4e2a\u8fdb\u7a0b ip netns exec $ {namespace name} $ {command} \u4f8b\u5b50\uff1a ip netns exec foo / bin / sh \u6ce8\u610f\uff1a\u5c06\u8fdb\u7a0b\u5206\u914d\u7ed9\u975e\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u9700\u8981root\u6743\u9650\u3002 \u4f60\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4efb\u4f55\u8fdb\u7a0b\uff0c\u7279\u522b\u662f\u4f60\u53ef\u4ee5\u8fd0\u884c\u201cip\u201d\u672c\u8eab\uff0c\u672c\u8282\u4e2d\u7684\u547d\u4ee4\u201cip netns exec foo ip link list\u201d\u4e0d\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u8bed\u6cd5\uff0c\u800c\u662f\u7b80\u5355\u5730\u6267\u884c\u53e6\u4e00\u4e2a\u201cip\u201d\u526f\u672c\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4\u3002\u60a8\u4e5f\u53ef\u4ee5\u5728\u540d\u79f0\u7a7a\u95f4\u5185\u8fd0\u884c\u4ea4\u4e92\u5f0fshell\u3002 \u5217\u51fa\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4\u7684\u6240\u6709\u8fdb\u7a0b ip netns pids $ {namespace name} \u8f93\u51fa\u5c06\u662f\u4e00\u4e2aPID\u5217\u8868\u3002 \u786e\u5b9a\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4 ip netns\u6807\u8bc6$ {pid} \u4f8b\u5b50\uff1a ip netns\u8bc6\u522b9000 \u5c06\u7f51\u7edc\u63a5\u53e3\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4 ip link set dev $ {interface name} netns $ {namespace name} ip link set dev $ {interface name} netns $ {pid} \u4f8b\u5b50\uff1a ip link set dev eth0.100 netns foo \u6ce8\u610f\uff1a\u4e00\u65e6\u4f60\u7ed9\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u5206\u914d\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c\u5b83\u5c06\u4ece\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u6d88\u5931\uff0c\u4f60\u5c06\u4e0d\u5f97\u4e0d\u901a\u8fc7\u201cip netns exec $ {netspace name}\u201d\u6267\u884c\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u5982\u201cip netns exec $ {netspace name} ip link set dev dummy0 down\u201c\u3002 \u800c\u4e14\uff0c\u5f53\u60a8\u5c06\u63a5\u53e3\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\u65f6\uff0c\u5b83\u4f1a\u4e22\u5931\u6240\u6709\u5df2\u914d\u7f6e\u7684\u914d\u7f6e\uff0c\u4f8b\u5982\u914d\u7f6e\u7684IP\u5730\u5740\u5e76\u8fdb\u5165DOWN\u72b6\u6001\u3002\u60a8\u9700\u8981\u5c06\u5176\u6062\u590d\u5e76\u91cd\u65b0\u914d\u7f6e\u3002 \u5982\u679c\u60a8\u6307\u5b9a\u4e00\u4e2aPID\u800c\u4e0d\u662f\u547d\u540d\u7a7a\u95f4\u540d\u79f0\uff0c\u5219\u8be5\u63a5\u53e3\u5c06\u88ab\u5206\u914d\u5230\u5177\u6709\u8be5PID\u7684\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4f8b\u5982\u201cip netns exec $ {namespace name} ip link set dev $ {intf} netns 1\u201d\u5c06\u63a5\u53e3\u91cd\u65b0\u5206\u914d\u56de\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\uff08\u56e0\u4e3a\u521d\u59cb\u5316\u6216\u5176\u4ed6PID 1\u7684\u8fdb\u7a0b\u51e0\u4e4e\u53ef\u4ee5\u4fdd\u8bc1\u5904\u4e8e\u9ed8\u8ba4\u72b6\u6001\u547d\u540d\u7a7a\u95f4\uff09\u3002 \u5c06\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a \u8fd9\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u4e24\u4e2aveth\u94fe\u63a5\u5e76\u4e3a\u5b83\u4eec\u5206\u914d\u4e24\u4e2a\u4e0d\u540c\u7684\u540d\u79f0\u7a7a\u95f4\u6765\u5b8c\u6210\u3002\u5047\u8bbe\u4f60\u60f3\u5c06\u547d\u540d\u7a7a\u95f4\u201cfoo\u201d\u8fde\u63a5\u5230\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4\u3002 \u521b\u5efa\u4e00\u5bf9veth\u8bbe\u5907\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth1\u7c7b\u578bveth peer name veth2 \u5c06veth2\u79fb\u52a8\u5230\u540d\u79f0\u7a7a\u95f4foo\uff1a ip link set dev veth2 netns foo \u5e26\u4e0aveth2\u5e76\u5728\u201cfoo\u201d\u547d\u540d\u7a7a\u95f4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff1a ip netns exec foo ip link set dev veth2 up ip netns exec foo ip address add 10.1.1.1/24 dev veth2 \u5411veth1\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff0c\u8be5\u5730\u5740\u4fdd\u7559\u5728\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u4e2d\uff1a ip address add 10.1.1.2/24 dev veth1 \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5ping 10.1.1.1\uff0c\u5982\u679c\u5728foo\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5e76\u4e14\u8bbe\u7f6e\u8def\u7531\u5230\u5728\u8be5\u547d\u540d\u7a7a\u95f4\u7684\u5176\u4ed6\u63a5\u53e3\u4e2d\u914d\u7f6e\u7684\u5b50\u7f51\u7684\u8def\u7531\u3002 \u5982\u679c\u60a8\u60f3\u8981\u5207\u6362\u800c\u4e0d\u662f\u8def\u7531\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bveth\u63a5\u53e3\u4e0e\u76f8\u5e94\u540d\u79f0\u7a7a\u95f4\u4e2d\u7684\u5176\u4ed6\u63a5\u53e3\u8fdb\u884c\u6865\u63a5\u3002\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6280\u672f\u5c06\u540d\u79f0\u7a7a\u95f4\u8fde\u63a5\u5230\u7269\u7406\u7f51\u7edc\u3002 \u76d1\u89c6\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u5b50\u7cfb\u7edf\u4e8b\u4ef6 ip netns\u76d1\u89c6\u5668 \u663e\u793a\u4e8b\u4ef6\uff0c\u4f8b\u5982\u521b\u5efa\u548c\u5220\u9664\u540d\u79f0\u7a7a\u95f4\u3002 \u591a\u64ad\u7ba1\u7406 \u591a\u64ad\u4e3b\u8981\u7531\u5e94\u7528\u7a0b\u5e8f\u548c\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u5904\u7406\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u505a\u7684\u5e76\u4e0d\u591a\uff0c\u800c\u4e14\u5e94\u8be5\u5728\u8fd9\u91cc\u624b\u52a8\u5b8c\u6210\u3002\u591a\u64ad\u76f8\u5173\u7684ip\u547d\u4ee4\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5\u3002 \u67e5\u770b\u591a\u64ad\u7ec4 ip maddress\u8282\u76ee ip maddress show $ {interface name} \u4f8b\uff1a $ ip maddress show dev lo 1\uff1alo inet 224.0.0.1 inet6 ff02 :: 1 inet6 ff01 :: 1 \u6dfb\u52a0\u94fe\u8def\u5c42\u591a\u64ad\u5730\u5740 \u60a8\u4e0d\u80fd\u624b\u52a8\u52a0\u5165IP\u591a\u64ad\u7ec4\uff0c\u4f46\u53ef\u4ee5\u6dfb\u52a0\u591a\u64adMAC\u5730\u5740\uff08\u5c3d\u7ba1\u5f88\u5c11\u9700\u8981\uff09\u3002 ip maddress add $ {MAC\u5730\u5740} dev $ {\u63a5\u53e3\u540d\u79f0} \u4f8b\uff1a ip maddress\u6dfb\u52a001\uff1a00\uff1a5e\uff1a00\uff1a00\uff1aab dev eth0 \u67e5\u770b\u7ec4\u64ad\u8def\u7531 \u7ec4\u64ad\u8def\u7531\u65e0\u6cd5\u624b\u52a8\u6dfb\u52a0\uff0c\u56e0\u6b64\u6b64\u547d\u4ee4\u53ea\u80fd\u663e\u793a\u7531\u8def\u7531\u5b88\u62a4\u7a0b\u5e8f\u5b89\u88c5\u7684\u7ec4\u64ad\u8def\u7531\u3002\u5b83\u652f\u6301\u76f8\u540c\u7684\u4fee\u9970\u7b26\u6765\u5355\u64ad\u8def\u7531\u67e5\u770b\u547d\u4ee4\uff08iif\uff0ctable\uff0cfrom\u7b49\uff09\u3002 ip mroute\u663e\u793a \u7f51\u7edc\u4e8b\u4ef6\u76d1\u63a7 \u60a8\u53ef\u4ee5\u4f7f\u7528iproute2\u76d1\u89c6\u67d0\u4e9b\u7f51\u7edc\u4e8b\u4ef6\uff0c\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\uff0c\u8def\u7531\u8868\u548cARP / NDP\u8868\u4e2d\u7684\u66f4\u6539\u3002 \u76d1\u63a7\u6240\u6709\u4e8b\u4ef6 \u60a8\u53ef\u4ee5\u4e0d\u5e26\u53c2\u6570\u5730\u8c03\u7528\u8be5\u547d\u4ee4\uff0c\u6216\u8005\u660e\u786e\u6307\u5b9a\u201c\u5168\u90e8\u201d\u3002 IP\u76d1\u89c6\u5668 ip\u76d1\u89c6\u6240\u6709 \u76d1\u89c6\u7279\u5b9a\u4e8b\u4ef6 ip monitor $ {event type} \u4e8b\u4ef6\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a \u94fe\u63a5 \u94fe\u8def\u72b6\u6001\uff1a\u63a5\u53e3\u4e0a\u4e0b\uff0c\u865a\u62df\u63a5\u53e3\u88ab\u521b\u5efa\u6216\u9500\u6bc1\u7b49\u3002 \u5730\u5740 \u94fe\u63a5\u5730\u5740\u66f4\u6539\u3002 \u8def\u7ebf \u8def\u7531\u8868\u66f4\u6539\u3002 mroute \u7ec4\u64ad\u8def\u7531\u66f4\u6539\u3002 \u5636 \u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u4e2d\u7684\u66f4\u6539\u3002 \u5f53\u5b58\u5728\u4e0d\u540c\u7684IPv4\u548cIPv6\u5b50\u7cfb\u7edf\u65f6\uff0c\u901a\u5e38\u7684\u201c-4\u201d\u548c\u201c-6\u201d\u9009\u9879\u5141\u8bb8\u60a8\u4ec5\u663e\u793a\u6307\u5b9a\u534f\u8bae\u7684\u4e8b\u4ef6\u3002\u5982\uff1a ip -4\u76d1\u63a7\u8def\u7531 ip-6\u76d1\u89c6\u5668\u90bb\u5c45 ip -4\u76d1\u89c6\u5668\u5730\u5740 \u9605\u8bfbrtmon\u751f\u6210\u7684\u65e5\u5fd7\u6587\u4ef6 iproute2\u5305\u542b\u4e00\u4e2a\u540d\u4e3a\u201crtmon\u201d\u7684\u7a0b\u5e8f\uff0c\u5176\u529f\u80fd\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u5c06\u4e8b\u4ef6\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6\u800c\u4e0d\u662f\u663e\u793a\u5b83\u4eec\u3002\u201cip monitor\u201d\u547d\u4ee4\u5141\u8bb8\u60a8\u8bfb\u53d6\u7531\u7a0b\u5e8f\u521b\u5efa\u7684\u6587\u4ef6\u201c\u3002 ip monitor $ {event type}\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84} rtmon\u8bed\u6cd5\u4e0e\u201cip monitor\u201d\u7c7b\u4f3c\uff0c\u9664\u4e86\u4e8b\u4ef6\u7c7b\u578b\u4ec5\u9650\u4e8e\u94fe\u63a5\uff0c\u5730\u5740\uff0c\u8def\u7531\u548c\u5168\u90e8; \u548c\u5730\u5740\u65cf\u5728\u201c-family\u201d\u9009\u9879\u4e2d\u6307\u5b9a\u3002 rtmon [-family ] [<\u8def\u7531|\u94fe\u63a5|\u5730\u5740|\u6240\u6709>]\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84} netconf\uff08sysctl\u914d\u7f6e\u67e5\u770b\uff09 \u67e5\u770b\u6240\u6709\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf\u663e\u793a \u67e5\u770b\u7279\u5b9a\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf show dev $ {interface} \u4f8b\u5b50\uff1a ip netconf show dev eth0","title":"\u9009\u578b"},{"location":"Utilities/#net-tools","text":"","title":"Net-tools"},{"location":"Utilities/#netstat","text":"netstat [ - vWeenNcCF ] [ < Af > ] - r netstat [ - vWnNcaeol ] [ < Socket > ...] netstat { [ - vWeenNac ] - i | [ - cnNe ] - M | - s [ - 6 tuw ] } < Socket >= { - t | --tcp} {-u|--udp} {-U|--udplite} {-S|--sctp} {-w|--raw} { - x | --unix} --ax25 --ipx --netrom < AF >= Use '-6|-4' or '-A <af>' or '--<af>' \uff1b\u9ed8\u8ba4\uff1a inet \u5217\u51fa\u6240\u6709\u652f\u6301\u7684\u534f\u8bae\uff1a inet ( DARPA Internet ) inet6 ( IPv6 ) ax25 ( AMPR AX . 25 ) netrom ( AMPR NET / ROM ) ipx ( Novell IPX ) ddp ( Appletalk DDP ) x25 ( CCITT X . 25 ) - r , --route \u663e\u793a\u8def\u7531\u8868 - i , --interfaces \u663e\u793a\u7f51\u7edc\u63a5\u53e3\u8868 - g , --groups \u663e\u793a\u7ec4\u64ad\u7ec4\u6210\u5458\u5173\u7cfb - s , --statistics display networking statistics (like SNMP) - t , --tcp \u663e\u793aTCP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - u , --udp \u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - M , --masquerade \u663e\u793a\u4f2a\u88c5\u7684\u7f51\u7edc\u8fde\u63a5 - v , --verbose \u663e\u793a\u8be6\u7ec6\u4fe1\u606f - w , --raw \u663e\u793aRAW\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5 - W , --wide don't truncate IP addresses - n , --numeric \u4e0d\u89e3\u6790\u540d\u79f0,\u76f4\u63a5\u4f7f\u7528IP --numeric-hosts \u4e0d\u89e3\u6790\u4e3b\u673a\u540d --numeric-ports \u5ffd\u7565\u7aef\u53e3\u540d\u79f0 --numeric-users \u5ffd\u7565\u7528\u6237\u540d - A , --protocol=family \u5217\u51fa\u5bf9\u5e94\u534f\u8bae\u7c7b\u578b\u8fde\u7ebf\u4e2d\u7684\u76f8\u5173\u5730\u5740(family\uff1ainet\uff0cinet6\uff0cunix\uff0cipx\uff0cax25\uff0cnetrom\uff0ceconet\uff0cddp\u548cbluetooth) - x , --unix \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A unix\"\u53c2\u6570\u76f8\u540c --ip,--inet \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A inet\"\u53c2\u6570\u76f8\u540c - N , --symbolic \u89e3\u6790\u786c\u4ef6\u3001\u5916\u56f4\u8bbe\u5907\u7684\u7b26\u53f7\u8fde\u63a5\u540d\u79f0 - e , --extend \u663e\u793a\u7f51\u7edc\u4e2d\u5176\u4ed6\u66f4\u591a\u4fe1\u606f - p , --programs \u663e\u793a\u6b63\u5728\u4f7f\u7528Socket\u7684\u8fdb\u7a0bPID\u548c\u7a0b\u5e8f\u540d\u79f0 - o , --timers display timers(\u663e\u793a\u8ba1\u65f6\u5668) - c , --continuous \u6301\u7eed\u5217\u51fa\u7f51\u7edc\u72b6\u6001(\u9ed8\u8ba41s) - l , --listening \u663e\u793a\u4fa6\u542c\u670d\u52a1\u5668sockets - a , --all \u663e\u793a\u6240\u6709\u8fde\u7ebf\u4e2d\u7684Socket(default: connected) - F , --fib \u4eceFIB(forwarding information base)\u6253\u5370\u8def\u7531\u4fe1\u606f(default) - C , --cache \u4ece\u8def\u7531\u7f13\u5b58\u4e2d\u6253\u5370\u8def\u7531\u4fe1\u606f - Z , --context \u663e\u793asockets\u7684SELinux security context","title":"netstat"},{"location":"Utilities/#netstat_1","text":"# \u5217\u51fa\u6240\u6709\u7aef\u53e3 (\u5305\u62ec\u76d1\u542c\u548c\u672a\u76d1\u542c\u7684) netstat -a #\u5217\u51fa\u6240\u6709\u7aef\u53e3 netstat -at #\u5217\u51fa\u6240\u6709tcp\u7aef\u53e3 netstat -au #\u5217\u51fa\u6240\u6709udp\u7aef\u53e3 netstat -ng #\u67e5\u770b\u7ec4\u64ad\u60c5\u51b5 # \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684 Sockets netstat -l #\u53ea\u663e\u793a\u76d1\u542c\u7aef\u53e3 netstat -lt #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c tcp \u7aef\u53e3 netstat -lu #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c udp \u7aef\u53e3 netstat -lx #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c UNIX \u7aef\u53e3 # \u663e\u793a\u6bcf\u4e2a\u534f\u8bae\u7684\u7edf\u8ba1\u4fe1\u606f netstat -s \u663e\u793a\u6240\u6709\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -st \u663e\u793aTCP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -su \u663e\u793aUDP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f netstat -pt # \u5728netstat\u8f93\u51fa\u4e2d\u663e\u793a PID \u548c\u8fdb\u7a0b\u540d\u79f0 netstat - p \u53ef\u4ee5\u4e0e\u5176\u5b83\u5f00\u5173\u4e00\u8d77\u4f7f\u7528\uff0c\u5c31\u53ef\u4ee5\u6dfb\u52a0\u201cPID/\u8fdb\u7a0b\u540d\u79f0\u201d\u5230netstat\u8f93\u51fa\u4e2d\uff0c\u8fd9\u6837debugging\u7684\u65f6\u5019\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u53d1\u73b0\u7279\u5b9a\u7aef\u53e3\u8fd0\u884c\u7684\u7a0b\u5e8f\u3002","title":"netstat\u5b9e\u4f8b"},{"location":"Utilities/#netstathost-port-or-user","text":"# \u5f53\u4f60\u4e0d\u60f3\u8ba9\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d\u663e\u793a\uff0c\u4f7f\u7528`netstat -n`\u3002\u5c06\u4f1a\u4f7f\u7528\u6570\u5b57\u4ee3\u66ff\u90a3\u4e9b\u540d\u79f0\u3002\u540c\u6837\u53ef\u4ee5\u52a0\u901f\u8f93\u51fa\uff0c\u56e0\u4e3a\u4e0d\u7528\u8fdb\u884c\u6bd4\u5bf9\u67e5\u8be2\u3002 netstat -an # \u5982\u679c\u53ea\u662f\u4e0d\u60f3\u8ba9\u8fd9\u4e09\u4e2a\u540d\u79f0\u4e2d\u7684\u4e00\u4e2a\u88ab\u663e\u793a\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4: netsat -a --numeric-ports netsat -a --numeric-hosts netsat -a --numeric-users # \u627e\u51fa\u7a0b\u5e8f\u8fd0\u884c\u7684\u7aef\u53e3,\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8fdb\u7a0b\u90fd\u80fd\u627e\u5230\uff0c\u6ca1\u6709\u6743\u9650\u7684\u4f1a\u4e0d\u663e\u793a\uff0c\u4f7f\u7528 root \u6743\u9650\u67e5\u770b\u6240\u6709\u7684\u4fe1\u606f netstat -ap | grep ssh # \u627e\u51fa\u8fd0\u884c\u5728\u6307\u5b9a\u7aef\u53e3\u7684\u8fdb\u7a0b netstat -an | grep ':80' \u547d\u4ee4\u62c6\u5206 \u8be6\u89e3 /^tcp/ \u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\uff0c\u201c^\u201d\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u7528\u6cd5\uff0c\u4ee5...\u5f00\u5934\uff0c\u8fd9\u91cc\u662f\u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\u3002 S[] \u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u53ebS\u7684\u6570\u7ec4\uff0c\u5728awk\u4e2d\uff0c\u6570\u7ec4\u4e0b\u6807\u901a\u5e38\u4ece 1 \u5f00\u59cb\uff0c\u800c\u4e0d\u662f 0\u3002 NF \u5f53\u524d\u8bb0\u5f55\u91cc\u57df\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4ee5\u7a7a\u683c\u5206\u9694\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0cNF\u57df\u4e2a\u6570\u7b49\u4e8e6 $NF \u8868\u793a\u4e00\u884c\u7684\u6700\u540e\u4e00\u4e2a\u57df\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c NF\u4e5f\u5c31\u662f NF\u4e5f\u5c31\u662f 6\uff0c\u8868\u793a\u7b2c6\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u4e5f\u5c31\u662fSYN_RECV\u6216TIME_WAIT\u7b49\u3002 S[$NF] \u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662fS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570 ++S[$NF] \u8868\u793a\u628a\u67d0\u4e2a\u6570\u52a0\u4e00\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662f\u628aS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570\u52a0\u4e00 END \u7ed3\u675f forkey in S \u904d\u5386S[]\u6570\u7ec4 print key,\u201d\\t\u201d,S[key] \u6253\u5370\u6570\u7ec4\u7684\u952e\u548c\u503c\uff0c\u4e2d\u95f4\u7528\\t\u5236\u8868\u7b26\u5206\u5272\uff0c\u663e\u793a\u597d\u4e00\u4e9b\u3002","title":"\u5728netstat\u8f93\u51fa\u4e2d\u4e0d\u663e\u793a\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d(host, port or user)"},{"location":"Utilities/#iptcp","text":"#\u67e5\u770b\u8fde\u63a5\u67d0\u670d\u52a1\u7aef\u53e3\u524d20\u4e2aIP\u5730\u5740\u53ca\u8fde\u63a5\u6570\uff1a netstat -ntu | grep :80 | awk '{print $5}' | cut -d: -f1 | awk '{++ip[$1]} END {for(i in ip) print ip[i],\"\\t\",i}' | sort -nr | head -n 20 netstat -anlp | grep 80 | grep tcp | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | head -n 20 netstat -nat | awk '/:80/{split($5,ip,\":\");++A[ip[1]]}END{for(i in A) print A[i],i}' | sort -rn | head -n 20 netstat -nat | grep \":80\" | grep ESTABLISHED | awk '{printf \"%s %s\\n\",$5,$6}' | sort -rn | head -n 20 # \u6839\u636e\u7aef\u53e3\u5217\u51fa\u8fdb\u7a0b netstat -ntlp | grep 80 | awk '{print $7}' | cut -d: -f1 # \u7528tcpdump\u55c5\u63a280\u7aef\u53e3\u524d\u7684\u8bbf\u95ee\u91cf tcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F \".\" '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -nr | head -20 # \u67e5\u770bphpcgi\u8fdb\u7a0b\u6570\uff0c\u5982\u679c\u63a5\u8fd1\u9884\u8bbe\u503c\uff0c\u8bf4\u660e\u4e0d\u591f\u7528\uff0c\u9700\u8981\u589e\u52a0 netstat -anpo | grep \"php-cgi\" | wc -l # \u67e5\u770bTCP\u8fde\u63a5\u72b6\u6001\u3001\u5e76\u53d1\u53ca\u8fde\u63a5\u6570\u7684\u547d\u4ee4 netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' netstat -nat | awk '{print $NF}' | grep -v '[a-z]' | sort | uniq -c | sort -rn netstat -n | awk '/^tcp/ {++state[$NF]}; END {for(key in state) print key,\"\\t\",state[key]}' netstat -n | awk '/^tcp/ {++arr[$NF]};END {for(k in arr) print k,\"\\t\",arr[k]}' netstat -nt | grep -e 127 .0.0.1 -e 0 .0.0.0 -e ::: -v | awk '/^tcp/ {++state[$NF]} END {for(i in state) print i,\"\\t\",state[i]}' # \u67e5\u627e\u524d20\u7684time_wait\u8fde\u63a5 netstat -n | grep TIME_WAIT | awk '{print $5}' | sort | uniq -c | sort -rn | head -n 20 # \u67e5\u627e\u67e5\u524d20\u7684SYN\u8fde\u63a5 netstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | head -n 20 # \u7edf\u8ba1\u670d\u52a1\u5668\u5f53\u524d\u5355IP\u8fde\u63a5\u6570\u6700\u5927\u7684IP\u5730\u5740\u524d\u5341 netstat -an | grep EST | awk -F '[ :]+' '{++S[$6]} END {for (key in S) print \"ip:\"key\"----->\",S[key]}' | sort -rn -k2","title":"IP\u548cTCP\u5206\u6790"},{"location":"Utilities/#tcp","text":"\u72b6\u6001 \u63cf\u8ff0 CLOSED \u65e0\u8fde\u63a5\u662f\u6d3b\u52a8\u7684\u6216\u6b63\u5728\u8fdb\u884c LISTEN \u670d\u52a1\u5668\u5728\u7b49\u5f85\u8fdb\u5165\u547c\u53eb SYN_RECV \u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u5df2\u7ecf\u5230\u8fbe SYN_SENT \u5e94\u7528\u5df2\u7ecf\u5f00\u59cb ESTABLISHED \u6b63\u5e38\u6570\u636e\u4f20\u8f93\u72b6\u6001 FIN_WAIT1 \u5e94\u7528\u8bf4\u5b83\u5df2\u7ecf\u5b8c\u6210 FIN_WAIT2 \u53e6\u4e00\u8fb9\u5df2\u540c\u610f\u91ca\u653e ITMED_WAIT \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389 CLOSING \u4e24\u8fb9\u540c\u65f6\u5c1d\u8bd5\u5173\u95ed TIME_WAIT \u53e6\u4e00\u8fb9\u5df2\u521d\u59cb\u5316\u4e00\u4e2a\u91ca\u653e LAST_ACK \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389","title":"TCP\u72b6\u6001\u8bf4\u660e"},{"location":"Utilities/#tcpnetstat","text":"Active Internet connections (w/o servers) Proto Recv-Q Send-Q Local AddressForeign AddressState Proto The protocol (tcp, udp, raw) used by the socket. \u7b2c\u4e00\u5217\u4e3asocket\u4f7f\u7528\u7684\u534f\u8bae\u3002 Recv-Q The count of bytes not copied by the user program connected to this socket. \u7b2c\u4e8c\u5217\u4e3a\u63a5\u5230\u7684\u4f46\u662f\u8fd8\u6ca1\u5904\u7406\u7684\u5b57\u8282\u6570\u3002 Send-Q The count of bytes not acknowledged by the remote host. \u7b2c\u4e09\u5217\u4e3a\u5df2\u7ecf\u53d1\u9001\u7684\u4f46\u662f\u6ca1\u6709\u88ab\u8fdc\u7a0b\u4e3b\u673a\u786e\u8ba4\u6536\u5230\u7684\u5b57\u8282\u6570\u3002 Local Address Address and port number of the local end of the socket.Unless the --numeric(-n) optionisspecified,thesocketaddress is resolved to its canonical host name (FQDN), and the port number is translated into the corresponding service name. \u7b2c\u56db\u5217\u4e3a \u672c\u5730\u7684\u5730\u5740\u53ca\u7aef\u53e3\u3002 Foreign Address Address and port number of the remote endofthesocket.Analogousto\"Local Address.\" \u7b2c\u4e94\u5217\u4e3a\u5916\u90e8\u7684\u5730\u5740\u53ca\u7aef\u53e3\u3002 State Thestateofthesocket.Sincethere are no states in raw mode and usually no states used in UDP, this column may be left blank. Normally this can be one of sev- eral values: \u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217\u3002 netstat\u7b2c\u516d\u5217State\u7684\u72b6\u6001\u4fe1\u606f State Thestateofthesocket.Sincethere are no states in raw mode and usually no states used in UDP, this column may be left blank. Normally this can be one of sev- eral values: \u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217\u3002 ESTABLISHED The socket has an established connection. socket\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\uff0c\u8868\u793a\u5904\u4e8e\u8fde\u63a5\u7684\u72b6\u6001\uff0c\u4e00\u822c\u8ba4\u4e3a\u6709\u4e00\u4e2aESTABLISHED\u8ba4\u4e3a\u662f\u4e00\u4e2a\u670d\u52a1\u7684\u5e76\u53d1\u8fde\u63a5\u3002\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8\u3002 SYN_SENT The socket is actively attempting to establish a connection. socket\u6b63\u5728\u79ef\u6781\u5c1d\u8bd5\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u5373\u5904\u4e8e\u53d1\u9001\u540e\u8fde\u63a5\u524d\u7684\u4e00\u4e2a\u7b49\u5f85\u4f46\u672a\u5339\u914d\u8fdb\u5165\u8fde\u63a5\u7684\u72b6\u6001\u3002 SYN_RECV A connection request has been received from the network. \u5df2\u7ecf\u4ece\u7f51\u7edc\u4e0a\u6536\u5230\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u3002 FIN_WAIT1 The socket is closed, and the connection is shutting down. socket\u5df2\u5173\u95ed\uff0c\u8fde\u63a5\u6b63\u5728\u6216\u6b63\u8981\u5173\u95ed\u3002 FIN_WAIT2 Connectionisclosed,andthesocket is waiting for a shutdown from the remote end. \u8fde\u63a5\u5df2\u5173\u95ed\uff0c\u5e76\u4e14socket\u6b63\u5728\u7b49\u5f85\u8fdc\u7aef\u7ed3\u675f\u3002 TIME_WAIT The socket is waiting after close to handle packets still in the network. socket\u6b63\u5728\u7b49\u5f85\u5173\u95ed\u5904\u7406\u4ecd\u5728\u7f51\u7edc\u4e0a\u7684\u6570\u636e\u5305\uff0c\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8\u3002 CLOSED The socket is not being used.| socket\u4e0d\u5728\u88ab\u5360\u7528\u4e86\u3002 CLOSE_WAIT The remote end has shutdown, waiting for the socket to close. \u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u7b49\u5f85socket\u5173\u95ed\u3002 LAST_ACK The remote end has shut down, and the socket is closed. Waiting for acknowl-edgement.| \u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u5e76\u4e14socket\u4e5f\u5df2\u5173\u95ed\uff0c\u7b49\u5f85acknowl-edgement\u3002 LISTEN Thesocketislisteningforincoming connections.Such sockets are not included in the output unless you specify the --listening (-l) or --all (-a) option. socket\u6b63\u5728\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\u3002 CLOSING Both sockets are shut down but we still don\u2019t have all our data sent. sockets\u5173\u95ed\uff0c\u4f46\u662f\u6211\u4eec\u4ecd\u65e7\u6ca1\u6709\u53d1\u9001\u6570\u636e\u3002 UNKNOWN The state of the socket is unknown \u672a\u77e5\u7684\u72b6\u6001\u3002 # \u65e5\u5fd7\u5206\u6790\u7bc7(Apache)\uff1a # \u5f97\u8bbf\u95ee\u524d10\u4f4d\u7684ip\u5730\u5740 cat access.log | awk '{print $1}' | sort | uniq -c | sort -nr | head -10 cat access.log | awk '{counts[$(11)]+=1}; END {for(url in counts) print counts[url], url}' # \u95ee\u6b21\u6570\u6700\u591a\u7684\u6587\u4ef6\u6216\u9875\u9762,\u53d6\u524d20 cat access.log | awk '{print $11}' | sort | uniq -c | sort -nr | head -20 # \u51fa\u4f20\u8f93\u6700\u5927\u7684\u51e0\u4e2aexe\u6587\u4ef6\uff08\u5206\u6790\u4e0b\u8f7d\u7ad9\u7684\u65f6\u5019\u5e38\u7528\uff09 cat access.log | awk '($7~/\\.exe/){print $10 \" \" $1 \" \" $4 \" \" $7}' | sort -nr | head -20 # \u51fa\u8f93\u51fa\u5927\u4e8e200000byte(\u7ea6200kb)\u7684exe\u6587\u4ef6\u4ee5\u53ca\u5bf9\u5e94\u6587\u4ef6\u53d1\u751f\u6b21\u6570 cat access.log | awk '($10 > 200000 && $7~/\\.exe/){print $7}' | sort -n | uniq -c | sort -nr | head -100 # \u679c\u65e5\u5fd7\u6700\u540e\u4e00\u5217\u8bb0\u5f55\u7684\u662f\u9875\u9762\u6587\u4ef6\u4f20\u8f93\u65f6\u95f4\uff0c\u5219\u6709\u5217\u51fa\u5230\u5ba2\u6237\u7aef\u6700\u8017\u65f6\u7684\u9875\u9762 cat access.log | awk '($7~/\\.php/){print $NF \" \" $1 \" \" $4 \" \" $7}' | sort -nr | head -100 # \u51fa\u6700\u6700\u8017\u65f6\u7684\u9875\u9762(\u8d85\u8fc760\u79d2\u7684)\u7684\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570 cat access.log | awk '($NF > 60 && $7~/\\.php/){print $7}' | sort -n | uniq -c | sort -nr | head -100 # \u51fa\u4f20\u8f93\u65f6\u95f4\u8d85\u8fc7 30 \u79d2\u7684\u6587\u4ef6 cat access.log | awk '($NF > 30){print $7}' | sort -n | uniq -c | sort -nr | head -20 # \u8ba1\u7f51\u7ad9\u6d41\u91cf\uff08G) cat access.log | awk '{sum+=$10} END {print sum/1024/1024/1024}' # \u8ba1404\u7684\u8fde\u63a5 awk '($9 ~/404/)' access.log | awk '{print $9,$7}' | sort # \u8ba1http status. cat access.log | awk '{counts[$(9)]+=1}; END {for(code in counts) print code, counts[code]}' cat access.log | awk '{print $9}' | sort | uniq -c | sort -rn # \u86db\u5206\u6790--\u67e5\u770b\u662f\u54ea\u4e9b\u8718\u86db\u5728\u6293\u53d6\u5185\u5bb9\u3002 /usr/sbin/tcpdump -i eth0 -l -s 0 -w - dst port 80 | strings | grep -i user-agent | grep -i -E 'bot|crawler|slurp|spider' # \u65e5\u5fd7\u5206\u6790\u7bc7(Squid) # \u6309\u57df\u7edf\u8ba1\u6d41\u91cf zcat squid_access.log.tar.gz | awk '{print $10,$7}' | awk 'BEGIN{FS=\"[ /]\"}{trfc[$4]+=$1}END{for(domain in trfc){printf \"%s\\t%d\\n\",domain,trfc[domain]}}' # \u6570\u636e\u5e93\u7bc7 # \u67e5\u770b\u6570\u636e\u5e93\u6267\u884c\u7684sql /usr/sbin/tcpdump -i eth0 -s 0 -l -w - dst port 3306 | strings | egrep -i 'SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER|CALL'","title":"tcp\u8fde\u63a5\u72b6\u6001\u7684\u63cf\u8ff0\u8bf4\u660e(netstat\u8f93\u51fa)"},{"location":"Varnish/","text":"caching HTTP reverse proxy \u00b6","title":"Varnish"},{"location":"Varnish/#caching-http-reverse-proxy","text":"","title":"caching HTTP reverse proxy"},{"location":"Vim/","text":"Vim \u00b6 \" \u67e5\u770b\u6587\u4ef6\u7f16\u7801\u683c\u5f0f : echo & fileencoding vim \u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0c encoding \u3001 fileencoding \u3001 fileencodings \u3001 termencoding ( \u8fd9\u4e9b\u9009\u9879\u53ef\u80fd\u7684\u53d6\u503c\u8bf7\u53c2\u8003 vim \u5728\u7ebf\u5e2e\u52a9 :help encoding - names ) \uff0c\u5b83\u4eec\u7684\u610f\u4e49\u5982\u4e0b: encoding : vim \u5185\u90e8\u4f7f\u7528\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5305\u62ec vim \u7684 buffer ( \u7f13\u51b2\u533a ) \u3001\u83dc\u5355\u6587\u672c\u3001\u6d88\u606f\u6587\u672c\u7b49\u3002 fileencoding : vim \u4e2d\u5f53\u524d\u7f16\u8f91\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c vim \u4fdd\u5b58\u6587\u4ef6\u65f6\u4e5f\u4f1a\u5c06\u6587\u4ef6\u4fdd\u5b58\u4e3a\u8fd9\u79cd\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f ( \u4e0d\u7ba1\u662f\u5426\u65b0\u6587\u4ef6\u90fd\u5982\u6b64 ) \u3002 fileencodings : vim \u542f\u52a8\u65f6\u4f1a\u6309\u7167\u5b83\u6240\u5217\u51fa\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u9010\u4e00\u63a2\u6d4b\u5373\u5c06\u6253\u5f00\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5e76\u4e14\u5c06 fileencoding \u8bbe\u7f6e\u4e3a\u6700\u7ec8\u63a2\u6d4b\u5230\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u56e0\u6b64\u6700\u597d\u5c06 unicode \u7f16\u7801\u65b9\u5f0f\u653e\u5230\u8fd9\u4e2a\u5217\u8868\u7684\u6700\u524d\u9762\uff0c\u5c06\u62c9\u4e01\u8bed\u7cfb\u7f16\u7801\u65b9\u5f0f latin1 \u653e\u5230\u6700\u540e\u9762\u3002 termencoding : vim \u6240\u5de5\u4f5c\u7684\u7ec8\u7aef ( \u6216\u8005 windows \u7684 console \u7a97\u53e3 ) \u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u4e2a\u9009\u9879\u5728 windows \u4e0b\u5bf9\u6211\u4eec\u5e38\u7528\u7684 gui \u6a21\u5f0f\u7684 gvim \u65e0\u6548\uff0c\u800c\u5bf9 console \u6a21\u5f0f\u7684 vim \u800c\u8a00\u5c31\u662f windows \u63a7\u5236\u53f0\u7684\u4ee3\u7801\u9875\uff0c\u5e76\u4e14\u901a\u5e38\u6211\u4eec\u4e0d\u9700\u8981\u6539\u53d8\u5b83\u3002 \u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u6700\u597d\uff0c\u53ef\u4ee5\u514d\u53bb\u4e0b\u9762\u5bf9\u83dc\u5355\u548c\u63d0\u793a\u4fe1\u606f\uff08 b \uff0cc\u90e8\u5206\uff09\u7684\u8bbe\u7f6e \u5982\u679c\u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u5728\u5b89\u88c5gvim\u7684\u65f6\u5019\uff0c\u5c06\u652f\u6301\u672c\u5730\u8bed\u8a00\u7684\u9009\u9879\u53bb\u6389\u3002 \u89e3\u51b3vim\u6587\u4ef6\u4e71\u7801\uff0c\u6253\u5f00\u6587\u4ef6\u4e71\u7801\uff0c\u83dc\u5355\uff0c\u63d0\u793a\u4fe1\u606f\u4e71\u7801\uff1a \u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0c encoding \u3001 fileencoding \u3001 fileencodings \u3001 termencoding \u5728linux\u4e2d\u4fee\u6539.vimrc\uff08\u5728win\u4e2d\u662f_vimrc\uff09 windows\u7cfb\u7edf\u4e5f\u53ef\u4ee5\u5728vim\u83dc\u5355\u9879\u4e2d\uff1a\u7f16\u8f91 > \u542f\u52a8\u8bbe\u5b9a\uff0c\u76f4\u63a5\u6253\u5f00_vimrc\u6587\u4ef6 \" \u8bbe\u7f6e\u6587\u4ef6\u7684\u4ee3\u7801\u5f62\u5f0f set encoding = utf -8 set termencoding = utf -8 set fileencoding = utf -8 set fileencodings = ucs - bom , utf -8 , chinese , cp936 \" vim\u7684\u83dc\u5355\u4e71\u7801\u89e3\u51b3\uff1a \u540c\u6837\u5728 _vimrc\u6587\u4ef6\u91cc\u4ee5\u4e0a\u7684\u4e2d\u6587\u8bbe\u7f6e\u540e\u52a0\u4e0a\u4e0b\u5217\u547d\u4ee4 source $vimruntime/delmenu. vim source $vimruntime/menu. vim \" vim\u63d0\u793a\u4fe1\u606f\u4e71\u7801\u7684\u89e3\u51b3 language messages zh_cn.utf -8 VIM\u4e3b\u5e2e\u52a9\u6587\u6863 \u00b6 \u5de5\u4f5c\u6a21\u5f0f\uff1a\u547d\u4ee4\u6a21\u5f0f\uff08\u9ed8\u8ba4\u754c\u9762\uff09\uff0c\u63d2\u5165\u6a21\u5f0f\uff0c\u53ef\u89c6\u5316\u6a21\u5f0f \u547d\u4ee4\u6a21\u5f0f\u73af\u5883\u4e2d\u7684\u64cd\u4f5c\uff1a \u83b7\u5f97\u7279\u5b9a\u5e2e\u52a9\uff1a | \u7c7b\u522b | \u4f8b\u5b50 | | : ------ : | : ------ : | | \u666e\u901a\u6a21\u5f0f\u547d\u4ee4 | :help x | | | | \" \u5168\u5c40 : help keyword \u5173\u952e\u5b57\u5e2e\u52a9 \" \u6253\u5f00/\u4fdd\u5b58/\u9000\u51fa/\u6539\u53d8\u6587\u4ef6(\u7f13\u5b58\u533a) : e < path /to/ file > \u6253\u5f00\u6587\u4ef6 : w \u4fdd\u5b58 : saveas < path /to/ file > \u4fdd\u5b58\u5230 : x , ZZ\u6216: wq \u4fdd\u5b58\u5e76\u9000\u51fa ( :x\u53ea\u4fdd\u5b58\u4e0d\u9000\u51fa ) : w ! sudo tee % \u4f7f\u7528sudo\u4fdd\u5b58 : [range] w \u53ea\u4fdd\u5b58[range]\u5185\u7684 : q ! \u4e0d\u4fdd\u5b58\u9000\u51fa ( : qa !, \u5373\u4f7f\u6709\u4fee\u6539\u8fc7\u7684\u9690\u85cf\u7f13\u51b2\u533a\u4e5f\u4e0d\u4fdd\u5b58\u9000\u51fa ) : bn , : bp \u663e\u793a\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u6587\u4ef6buffer \" \u57fa\u672c\u79fb\u52a8\u547d\u4ee4 h \u3001 j \u3001 k \u3001 l \u2190 \u2193 \u2191 \u2192 b \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e B \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e ( \u5355\u8bcd\u542b\u6807\u70b9 ) 0 \u5230\u7b2c\u4e00\u5217 ^ \u5230\u8be5\u884c\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 $ \u5230\u884c\u5c3e g_ \u5230\u8be5\u884c\u6700\u540e\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 gg \u5230\u7b2c\u4e00\u884c G \u5230\u6700\u540e\u4e00\u884c nG \u5230\u7b2c\u51e0\u884c : n \u5230\u7b2c\u51e0\u884c H \u5230\u5c4f\u5e55\u4e0a\u7aefhigh M \u5230\u5c4f\u5e55\u4e2d\u592emidden L \u5230\u5c4f\u5e55\u4e0b\u7aeflow Ctrl + e \u5411\u4e0b\u6eda\u52a8\u4e00\u884c Ctrl + y \u5411\u4e0a\u6eda\u52a8\u4e00\u884c Ctrl + b \u5411\u540e\u6eda\u52a8\u4e00\u5c4f Ctrl + f \u5411\u524d\u6eda\u52a8\u4e00\u5c4f Ctrl + d \u5411\u524d\u6eda\u52a8\u534a\u5c4f Ctrl + u \u5411\u540e\u6eda\u52a8\u534a\u5c4f \" insert\u547d\u4ee4 a \u5149\u6807\u540e\u63d2\u5165 A \u672c\u884c\u884c\u672b\u63d2\u5165\u6587\u672c\uff1b i \u5149\u6807\u524d\u63d2\u5165\u6587\u672c\uff1b I \u5149\u6807\u672c\u884c\u5f00\u59cb\u63d2\u5165\u6587\u672c\uff1b o \u5149\u6807\u4e0b\u63d2\u5165\u65b0\u884c\uff1b O \u5149\u6807\u4e0a\u63d2\u5165\u65b0\u884c\uff1b \" \u590d\u5236\u548c\u526a\u5207\u547d\u4ee4\uff1a P , p \u7c98\u8d34\u5728\u5149\u6807\u6240\u5728\u884c\u7684\u540e\u9762\u3001\u524d\u9762 yy , Y \u590d\u5236\u5f53\u524d\u884c nyy , nY \u590d\u5236\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c dd \u526a\u5207\u5f53\u524d\u884c ndd \u526a\u5207\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c u \u64a4\u9500 < C - r > \u6062\u590d \" \u5176\u4ed6 r \u66ff\u6362\u5f53\u524d\u5b57\u7b26 J \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c gJ \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c ( \u53bb\u9664\u7a7a\u683c ) cc \u6e05\u7a7a\u5f53\u524d\u884c\u5e76\u8fdb\u5165insert mode C \u66ff\u6362\u5230\u884c\u5c3e s \u5220\u9664\u5f53\u524d\u5b57\u7b26\u5e76\u8fdb\u5165insert mode xp \u5f53\u524d\u5b57\u7b26\u540e\u79fb : %s /old/ new / g \u5168\u90e8\u66ff\u6362 : %s /old/ new /gc \u9010\u4e2a\u66ff\u6362 `. \u8f6c\u5230\u4e0a\u6b21\u7f16\u8f91\u7684\u884c == \u4fee\u590d\u884c\u7f29\u8fdb \" \u53ef\u89c6\u5316\u6a21\u5f0f\u547d\u4ee4 aw \u9009\u62e9\u5f53\u524d\u5355\u8bcd ab \u9009\u62e9\u88ab () \u5305\u88f9\u7684\u533a\u57df ( \u542b\u62ec\u53f7 ) aB \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df ( \u542b\u62ec\u53f7 ) ib \u9009\u62e9 () \u5305\u88f9\u7684\u533a\u57df ( \u4e0d\u542b\u62ec\u53f7 ) iB \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df ( \u4e0d\u542b\u62ec\u53f7 ) <> \u5411\u5de6 \u5411\u53f3\u7f29\u8fdb ~ \u5927\u5c0f\u5199\u5207\u6362 \" \u5bc4\u5b58\u5668 : reg \u663e\u793a\u5bc4\u5b58\u5668\u5185\u5bb9 \"xy \u590d\u5236\u5230\u5bc4\u5b58\u5668x \"xp \u7c98\u8d34\u5bc4\u5b58\u5668x\u4e2d\u5185\u5bb9 \" \u5bc4\u5b58\u5668\u5b58\u50a8\u5728~/.viminfo\u4e2d,\u4e0b\u6b21\u91cd\u542fvim\u4ecd\u4f1a\u52a0\u8f7d \" \u5bc4\u5b58\u56680\u5b58\u50a8\u4e0a\u4e00\u6b21\u590d\u5236\u7684\u503c \" \u6807\u7b7e : tabnew file \u5728\u65b0\u6807\u7b7e\u6253\u5f00\u6587\u4ef6 gt \u5207\u6362\u5230\u4e0b\u4e2a\u6807\u7b7e gT \u5207\u6362\u5230\u4e0a\u4e2a\u6807\u7b7e ngt \u5207\u6362\u5230\u7b2cn\u4e2a\u6807\u7b7e : tabc \u5173\u95ed\u5f53\u524d\u6807\u7b7e : tabo \u5173\u95ed\u5176\u4ed6\u6807\u7b7e ```vim . \u91cd\u590d\u4e0a\u4e00\u4e2a\u64cd\u4f5c N \u91cd\u590d N\u6b21 NG \u8df3\u8f6c\u5230N\u884c gg \u8df3\u8f6c\u5230\u6587\u4ef6\u5f00\u59cb G \u8df3\u8f6c\u5230\u884c\u672b w \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd W \u5230\u4e0b\u4e2a\u5355\u8bcd(\u542b\u6807\u70b9) e \u8df3\u8f6c\u5230\u5f53\u524d\u5355\u8bcd\u8bcd\u5c3e E \u5230\u4e0b\u4e2a\u5355\u8bcd\u7ed3\u5c3e(\u542b\u6807\u70b9) \" \u7406\u89e3ew\u548cEW\u79fb\u52a8\u533a\u522b \u5149\u6807\u4f4d\u7f6e ew E W | || | | x = (name_1,vision_3); # this is a comment % \u8df3\u8f6c\u5230\u5bf9\u5e94\u7684( { [ \u7b26\u53f7 * # \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u5149\u6807\u4e0b\u6240\u5728\u7684\u5355\u8bcd \" \u5927\u591a\u6570\u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u683c\u5f0f\uff1a <\u5f00\u59cb\u4f4d\u7f6e><\u547d\u4ee4><\u7ed3\u675f\u4f4d\u7f6e> 0y$ \u590d\u5236\u6574\u884c ye \u590d\u5236\u5230\u8bcd\u5c3e gU \u5927\u5199 gu \u5c0f\u5199...... dt\" \u79fb\u9664\u6240\u6709\u76f4\u5230\"\u7b26\u53f7 move \" \u533a\u57df\u9009\u62e9 a \u6216 i \" \u5728visual mode\u4e0b\u64cd\u4f5c action\u53ef\u4ee5\u662f\u4efb\u4f55\u64cd\u4f5c\uff0c\u5982d(delete)\u3001y(yank)\u7b49\u7b49 object\u53ef\u4ee5\u662f\uff1aw\u3001W\u3001s(sentence\u53e5\u5b50)\u3001p(paragraph\u6bb5\u843d)\u4e5f\u53ef\u4ee5\u662f\u7b26\u53f7\uff0c\u5982\uff1a\" ' )\u7b49 \" \u4f8b\u5b50\u8be6\u89e3\uff1a(\u5047\u8bbe\u5149\u6807\u5728\u7b2c\u4e00\u4e2ao\u4e0a) (map (+) (\"foo\")) vi\" \u9009\u62e9foo va\" \u9009\u62e9\"foo\" vi) \u9009\u62e9(\"foo\") v2i \u9009\u62e9map (+) (\"foo\") v2a (map (+) (\"foo\")) \" \u9009\u62e9\u957f\u65b9\u5f62\u5757\u8fdb\u884c\u6ce8\u91ca\u4f8b\u5b50 ^ \u2192 \u8df3\u8f6c\u5230\u884c\u9996\u975e\u7a7a\u767d\u7b26 \u2192 \u53ef\u89c6\u5757 \u2192 move down (could also be jjj or %, etc\u2026) I-- [ESC] \u2192 \u7528#\u6ce8\u91ca\u6bcf\u4e00\u884c \" \u6ce8\uff1aWindows\u5e73\u53f0\u4e0b\uff0c\u82e5\u526a\u5207\u677f\u975e\u7a7a\uff0c \u53d6\u4ee3 \" \u81ea\u52a8\u5b8c\u6210 \u6309 \u548c ,\u8f93\u5165\u5355\u8bcd\u5f00\u5934\uff0c\u6309\u952e\u540e\u8fdb\u884c\u9009\u62e9\u8981\u8f93\u5165\u7684\u5355\u8bcd \" \u5b8f qa\u5f55\u5236\u884c\u4e3a\u5230\u6ce8\u518c\u8868a\u4e2d\uff0c\u7136\u540e\u5f53\u4f60\u952e\u5165@a\u7684\u65f6\u5019\uff0c@a\u5c06\u4f1a\u91cd\u653e\u4f60\u4fdd\u5b58\u5728\u6ce8\u518c\u8868a\u4e2d\u7684\u5b8f\u3002@@\u662f\u91cd\u653e\u6700\u540e\u4e00\u4e2a\u6267\u884c\u8fc7\u5b8f\u7684\u5feb\u6377\u952e \" \u53ef\u89c6\u5316\u9009\u62e9:v,V, < > \u5411\u5de6\u3001\u5411\u53f3\u7f29\u8fdb = \u81ea\u52a8\u7f29\u8fdb \" \u4f8b\u5982\uff1a\u884c\u5c3e\u6dfb\u52a0\u7b26\u53f7; G $ A ; :set nu ---\u8bbe\u7f6e\u884c\u53f7 :set nonu ----\u53d6\u6d88\u884c\u53f7 \u5220\u9664\u547d\u4ee4\uff1a x \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u7684\u5b57\u7b26\uff1b nx \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u540eN\u4e2a\u5b57\u7b26\uff1b dd \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u7684\u5185\u5bb9\uff1b dG \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u5230\u672b\u5c3e\u7684\u5185\u5bb9\uff1b ndd\u5220\u9664N\u884c\uff1b D \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u5230\u884c\u5c3e\uff1b \uff1an1,n2d \u5220\u9664\u6307\u5b9a\u7684\u8303\u56f4\uff1b \u66ff\u6362\u548c\u53d6\u6d88\u547d\u4ee4\uff1a r \u53d6\u4ee3\u5149\u6807\u6240\u5728\u5904\u5b57\u7b26\uff1b R \u4ece\u5149\u6807\u6240\u5728\u5904\u5f00\u59cb\u66ff\u6362\u5b57\u7b26\uff0cpress ESc overj\uff1b u \u53d6\u6d88\u4e0a\u4e00\u6b65\u64cd\u4f5c\uff1b\u5bf9\u4e8e\u8fd8\u6ca1\u6709\u540c\u6b65\u786c\u76d8\u7684\u64cd\u4f5c\u65f6\u6709\u6548\u7684\uff1b \u641c\u7d22\u548c\u66ff\u6362\u547d\u4ee4\uff1a /command n,N \u7684\u533a\u522b\u662f\u524d\u8005\u6709\u524d\u5f80\u540e\uff0c\u540e\u8005\u76f8\u53cd\uff1b \u5982\u679c\u5728\u641c\u7d22\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u8bdd\uff0c\u4f7f\u7528\u547d\u4ee4:set ic; :%s/old/new/g \u5168\u6587\u66ff\u6362\uff1b :n1,n2s/old/new/g g ,c\u7684\u533a\u522b\u5c31\u662f\u662f\u5426\u5728\u8fdb\u884c\u64cd\u4f5c\u7684\u4e0a\u7684\u786e\u8ba4\uff1b \u4fdd\u6301\u548c\u9000\u51fa\u7684\u547d\u4ee4\uff1a :wq :wq! ZZ equal :wq :q! :w :w /test/important.bak \u6280\u672f\u5e94\u7528\u5b9e\u4f8b\uff1a vi :r \u6587\u4ef6\u540d \u5bfc\u5165\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u8005\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c\uff1b :!\u547d\u4ee4 \u5728vi\u4e2d\u6267\u884c\u547d\u4ee4 :r !date#\u8fd9\u4e2a\u547d\u4ee4\u5f88\u4f7f\u7528\uff1b \u8fde\u7eed\u884c\u6ce8\u91ca\uff1a :n1,n2s/^/#/g \u53d6\u6d88\u7684\u547d\u4ee4\uff1b:n1,n2s/^#//g \u5c16\u89d2\u53f7\u8868\u793a\u884c\u9996\uff1b\u659c\u6760\u8868\u793a\u5206\u9694\u7b26\uff1b \u6269\u5c55\u77e5\u8bc6\u70b9\uff1a \u5728linux\u7cfb\u7edf\u5f53\u4e2d\u5e76\u4e0d\u662f\u6240\u6709\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u6ce8\u91ca\u884c\u90fd\u662f\u4f7f\u7528#\u952e\uff0c\u5728~./vimrc\u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u7684\u6ce8\u91ca\u884c\u662f\u53cc\u5f15\u53f7\uff1b : setshowmode \u663e\u793a\u5f53\u524d\u6a21\u5f0f x \u5220\u9664\u5b57\u7b26","title":"Vim"},{"location":"Vim/#vim","text":"\" \u67e5\u770b\u6587\u4ef6\u7f16\u7801\u683c\u5f0f : echo & fileencoding vim \u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0c encoding \u3001 fileencoding \u3001 fileencodings \u3001 termencoding ( \u8fd9\u4e9b\u9009\u9879\u53ef\u80fd\u7684\u53d6\u503c\u8bf7\u53c2\u8003 vim \u5728\u7ebf\u5e2e\u52a9 :help encoding - names ) \uff0c\u5b83\u4eec\u7684\u610f\u4e49\u5982\u4e0b: encoding : vim \u5185\u90e8\u4f7f\u7528\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5305\u62ec vim \u7684 buffer ( \u7f13\u51b2\u533a ) \u3001\u83dc\u5355\u6587\u672c\u3001\u6d88\u606f\u6587\u672c\u7b49\u3002 fileencoding : vim \u4e2d\u5f53\u524d\u7f16\u8f91\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c vim \u4fdd\u5b58\u6587\u4ef6\u65f6\u4e5f\u4f1a\u5c06\u6587\u4ef6\u4fdd\u5b58\u4e3a\u8fd9\u79cd\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f ( \u4e0d\u7ba1\u662f\u5426\u65b0\u6587\u4ef6\u90fd\u5982\u6b64 ) \u3002 fileencodings : vim \u542f\u52a8\u65f6\u4f1a\u6309\u7167\u5b83\u6240\u5217\u51fa\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u9010\u4e00\u63a2\u6d4b\u5373\u5c06\u6253\u5f00\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5e76\u4e14\u5c06 fileencoding \u8bbe\u7f6e\u4e3a\u6700\u7ec8\u63a2\u6d4b\u5230\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u56e0\u6b64\u6700\u597d\u5c06 unicode \u7f16\u7801\u65b9\u5f0f\u653e\u5230\u8fd9\u4e2a\u5217\u8868\u7684\u6700\u524d\u9762\uff0c\u5c06\u62c9\u4e01\u8bed\u7cfb\u7f16\u7801\u65b9\u5f0f latin1 \u653e\u5230\u6700\u540e\u9762\u3002 termencoding : vim \u6240\u5de5\u4f5c\u7684\u7ec8\u7aef ( \u6216\u8005 windows \u7684 console \u7a97\u53e3 ) \u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u4e2a\u9009\u9879\u5728 windows \u4e0b\u5bf9\u6211\u4eec\u5e38\u7528\u7684 gui \u6a21\u5f0f\u7684 gvim \u65e0\u6548\uff0c\u800c\u5bf9 console \u6a21\u5f0f\u7684 vim \u800c\u8a00\u5c31\u662f windows \u63a7\u5236\u53f0\u7684\u4ee3\u7801\u9875\uff0c\u5e76\u4e14\u901a\u5e38\u6211\u4eec\u4e0d\u9700\u8981\u6539\u53d8\u5b83\u3002 \u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u6700\u597d\uff0c\u53ef\u4ee5\u514d\u53bb\u4e0b\u9762\u5bf9\u83dc\u5355\u548c\u63d0\u793a\u4fe1\u606f\uff08 b \uff0cc\u90e8\u5206\uff09\u7684\u8bbe\u7f6e \u5982\u679c\u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u5728\u5b89\u88c5gvim\u7684\u65f6\u5019\uff0c\u5c06\u652f\u6301\u672c\u5730\u8bed\u8a00\u7684\u9009\u9879\u53bb\u6389\u3002 \u89e3\u51b3vim\u6587\u4ef6\u4e71\u7801\uff0c\u6253\u5f00\u6587\u4ef6\u4e71\u7801\uff0c\u83dc\u5355\uff0c\u63d0\u793a\u4fe1\u606f\u4e71\u7801\uff1a \u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0c encoding \u3001 fileencoding \u3001 fileencodings \u3001 termencoding \u5728linux\u4e2d\u4fee\u6539.vimrc\uff08\u5728win\u4e2d\u662f_vimrc\uff09 windows\u7cfb\u7edf\u4e5f\u53ef\u4ee5\u5728vim\u83dc\u5355\u9879\u4e2d\uff1a\u7f16\u8f91 > \u542f\u52a8\u8bbe\u5b9a\uff0c\u76f4\u63a5\u6253\u5f00_vimrc\u6587\u4ef6 \" \u8bbe\u7f6e\u6587\u4ef6\u7684\u4ee3\u7801\u5f62\u5f0f set encoding = utf -8 set termencoding = utf -8 set fileencoding = utf -8 set fileencodings = ucs - bom , utf -8 , chinese , cp936 \" vim\u7684\u83dc\u5355\u4e71\u7801\u89e3\u51b3\uff1a \u540c\u6837\u5728 _vimrc\u6587\u4ef6\u91cc\u4ee5\u4e0a\u7684\u4e2d\u6587\u8bbe\u7f6e\u540e\u52a0\u4e0a\u4e0b\u5217\u547d\u4ee4 source $vimruntime/delmenu. vim source $vimruntime/menu. vim \" vim\u63d0\u793a\u4fe1\u606f\u4e71\u7801\u7684\u89e3\u51b3 language messages zh_cn.utf -8","title":"Vim"},{"location":"Vim/#vim_1","text":"\u5de5\u4f5c\u6a21\u5f0f\uff1a\u547d\u4ee4\u6a21\u5f0f\uff08\u9ed8\u8ba4\u754c\u9762\uff09\uff0c\u63d2\u5165\u6a21\u5f0f\uff0c\u53ef\u89c6\u5316\u6a21\u5f0f \u547d\u4ee4\u6a21\u5f0f\u73af\u5883\u4e2d\u7684\u64cd\u4f5c\uff1a \u83b7\u5f97\u7279\u5b9a\u5e2e\u52a9\uff1a | \u7c7b\u522b | \u4f8b\u5b50 | | : ------ : | : ------ : | | \u666e\u901a\u6a21\u5f0f\u547d\u4ee4 | :help x | | | | \" \u5168\u5c40 : help keyword \u5173\u952e\u5b57\u5e2e\u52a9 \" \u6253\u5f00/\u4fdd\u5b58/\u9000\u51fa/\u6539\u53d8\u6587\u4ef6(\u7f13\u5b58\u533a) : e < path /to/ file > \u6253\u5f00\u6587\u4ef6 : w \u4fdd\u5b58 : saveas < path /to/ file > \u4fdd\u5b58\u5230 : x , ZZ\u6216: wq \u4fdd\u5b58\u5e76\u9000\u51fa ( :x\u53ea\u4fdd\u5b58\u4e0d\u9000\u51fa ) : w ! sudo tee % \u4f7f\u7528sudo\u4fdd\u5b58 : [range] w \u53ea\u4fdd\u5b58[range]\u5185\u7684 : q ! \u4e0d\u4fdd\u5b58\u9000\u51fa ( : qa !, \u5373\u4f7f\u6709\u4fee\u6539\u8fc7\u7684\u9690\u85cf\u7f13\u51b2\u533a\u4e5f\u4e0d\u4fdd\u5b58\u9000\u51fa ) : bn , : bp \u663e\u793a\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u6587\u4ef6buffer \" \u57fa\u672c\u79fb\u52a8\u547d\u4ee4 h \u3001 j \u3001 k \u3001 l \u2190 \u2193 \u2191 \u2192 b \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e B \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e ( \u5355\u8bcd\u542b\u6807\u70b9 ) 0 \u5230\u7b2c\u4e00\u5217 ^ \u5230\u8be5\u884c\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 $ \u5230\u884c\u5c3e g_ \u5230\u8be5\u884c\u6700\u540e\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 gg \u5230\u7b2c\u4e00\u884c G \u5230\u6700\u540e\u4e00\u884c nG \u5230\u7b2c\u51e0\u884c : n \u5230\u7b2c\u51e0\u884c H \u5230\u5c4f\u5e55\u4e0a\u7aefhigh M \u5230\u5c4f\u5e55\u4e2d\u592emidden L \u5230\u5c4f\u5e55\u4e0b\u7aeflow Ctrl + e \u5411\u4e0b\u6eda\u52a8\u4e00\u884c Ctrl + y \u5411\u4e0a\u6eda\u52a8\u4e00\u884c Ctrl + b \u5411\u540e\u6eda\u52a8\u4e00\u5c4f Ctrl + f \u5411\u524d\u6eda\u52a8\u4e00\u5c4f Ctrl + d \u5411\u524d\u6eda\u52a8\u534a\u5c4f Ctrl + u \u5411\u540e\u6eda\u52a8\u534a\u5c4f \" insert\u547d\u4ee4 a \u5149\u6807\u540e\u63d2\u5165 A \u672c\u884c\u884c\u672b\u63d2\u5165\u6587\u672c\uff1b i \u5149\u6807\u524d\u63d2\u5165\u6587\u672c\uff1b I \u5149\u6807\u672c\u884c\u5f00\u59cb\u63d2\u5165\u6587\u672c\uff1b o \u5149\u6807\u4e0b\u63d2\u5165\u65b0\u884c\uff1b O \u5149\u6807\u4e0a\u63d2\u5165\u65b0\u884c\uff1b \" \u590d\u5236\u548c\u526a\u5207\u547d\u4ee4\uff1a P , p \u7c98\u8d34\u5728\u5149\u6807\u6240\u5728\u884c\u7684\u540e\u9762\u3001\u524d\u9762 yy , Y \u590d\u5236\u5f53\u524d\u884c nyy , nY \u590d\u5236\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c dd \u526a\u5207\u5f53\u524d\u884c ndd \u526a\u5207\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c u \u64a4\u9500 < C - r > \u6062\u590d \" \u5176\u4ed6 r \u66ff\u6362\u5f53\u524d\u5b57\u7b26 J \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c gJ \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c ( \u53bb\u9664\u7a7a\u683c ) cc \u6e05\u7a7a\u5f53\u524d\u884c\u5e76\u8fdb\u5165insert mode C \u66ff\u6362\u5230\u884c\u5c3e s \u5220\u9664\u5f53\u524d\u5b57\u7b26\u5e76\u8fdb\u5165insert mode xp \u5f53\u524d\u5b57\u7b26\u540e\u79fb : %s /old/ new / g \u5168\u90e8\u66ff\u6362 : %s /old/ new /gc \u9010\u4e2a\u66ff\u6362 `. \u8f6c\u5230\u4e0a\u6b21\u7f16\u8f91\u7684\u884c == \u4fee\u590d\u884c\u7f29\u8fdb \" \u53ef\u89c6\u5316\u6a21\u5f0f\u547d\u4ee4 aw \u9009\u62e9\u5f53\u524d\u5355\u8bcd ab \u9009\u62e9\u88ab () \u5305\u88f9\u7684\u533a\u57df ( \u542b\u62ec\u53f7 ) aB \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df ( \u542b\u62ec\u53f7 ) ib \u9009\u62e9 () \u5305\u88f9\u7684\u533a\u57df ( \u4e0d\u542b\u62ec\u53f7 ) iB \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df ( \u4e0d\u542b\u62ec\u53f7 ) <> \u5411\u5de6 \u5411\u53f3\u7f29\u8fdb ~ \u5927\u5c0f\u5199\u5207\u6362 \" \u5bc4\u5b58\u5668 : reg \u663e\u793a\u5bc4\u5b58\u5668\u5185\u5bb9 \"xy \u590d\u5236\u5230\u5bc4\u5b58\u5668x \"xp \u7c98\u8d34\u5bc4\u5b58\u5668x\u4e2d\u5185\u5bb9 \" \u5bc4\u5b58\u5668\u5b58\u50a8\u5728~/.viminfo\u4e2d,\u4e0b\u6b21\u91cd\u542fvim\u4ecd\u4f1a\u52a0\u8f7d \" \u5bc4\u5b58\u56680\u5b58\u50a8\u4e0a\u4e00\u6b21\u590d\u5236\u7684\u503c \" \u6807\u7b7e : tabnew file \u5728\u65b0\u6807\u7b7e\u6253\u5f00\u6587\u4ef6 gt \u5207\u6362\u5230\u4e0b\u4e2a\u6807\u7b7e gT \u5207\u6362\u5230\u4e0a\u4e2a\u6807\u7b7e ngt \u5207\u6362\u5230\u7b2cn\u4e2a\u6807\u7b7e : tabc \u5173\u95ed\u5f53\u524d\u6807\u7b7e : tabo \u5173\u95ed\u5176\u4ed6\u6807\u7b7e ```vim . \u91cd\u590d\u4e0a\u4e00\u4e2a\u64cd\u4f5c N \u91cd\u590d N\u6b21 NG \u8df3\u8f6c\u5230N\u884c gg \u8df3\u8f6c\u5230\u6587\u4ef6\u5f00\u59cb G \u8df3\u8f6c\u5230\u884c\u672b w \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd W \u5230\u4e0b\u4e2a\u5355\u8bcd(\u542b\u6807\u70b9) e \u8df3\u8f6c\u5230\u5f53\u524d\u5355\u8bcd\u8bcd\u5c3e E \u5230\u4e0b\u4e2a\u5355\u8bcd\u7ed3\u5c3e(\u542b\u6807\u70b9) \" \u7406\u89e3ew\u548cEW\u79fb\u52a8\u533a\u522b \u5149\u6807\u4f4d\u7f6e ew E W | || | | x = (name_1,vision_3); # this is a comment % \u8df3\u8f6c\u5230\u5bf9\u5e94\u7684( { [ \u7b26\u53f7 * # \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u5149\u6807\u4e0b\u6240\u5728\u7684\u5355\u8bcd \" \u5927\u591a\u6570\u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u683c\u5f0f\uff1a <\u5f00\u59cb\u4f4d\u7f6e><\u547d\u4ee4><\u7ed3\u675f\u4f4d\u7f6e> 0y$ \u590d\u5236\u6574\u884c ye \u590d\u5236\u5230\u8bcd\u5c3e gU \u5927\u5199 gu \u5c0f\u5199...... dt\" \u79fb\u9664\u6240\u6709\u76f4\u5230\"\u7b26\u53f7 move \" \u533a\u57df\u9009\u62e9 a \u6216 i \" \u5728visual mode\u4e0b\u64cd\u4f5c action\u53ef\u4ee5\u662f\u4efb\u4f55\u64cd\u4f5c\uff0c\u5982d(delete)\u3001y(yank)\u7b49\u7b49 object\u53ef\u4ee5\u662f\uff1aw\u3001W\u3001s(sentence\u53e5\u5b50)\u3001p(paragraph\u6bb5\u843d)\u4e5f\u53ef\u4ee5\u662f\u7b26\u53f7\uff0c\u5982\uff1a\" ' )\u7b49 \" \u4f8b\u5b50\u8be6\u89e3\uff1a(\u5047\u8bbe\u5149\u6807\u5728\u7b2c\u4e00\u4e2ao\u4e0a) (map (+) (\"foo\")) vi\" \u9009\u62e9foo va\" \u9009\u62e9\"foo\" vi) \u9009\u62e9(\"foo\") v2i \u9009\u62e9map (+) (\"foo\") v2a (map (+) (\"foo\")) \" \u9009\u62e9\u957f\u65b9\u5f62\u5757\u8fdb\u884c\u6ce8\u91ca\u4f8b\u5b50 ^ \u2192 \u8df3\u8f6c\u5230\u884c\u9996\u975e\u7a7a\u767d\u7b26 \u2192 \u53ef\u89c6\u5757 \u2192 move down (could also be jjj or %, etc\u2026) I-- [ESC] \u2192 \u7528#\u6ce8\u91ca\u6bcf\u4e00\u884c \" \u6ce8\uff1aWindows\u5e73\u53f0\u4e0b\uff0c\u82e5\u526a\u5207\u677f\u975e\u7a7a\uff0c \u53d6\u4ee3 \" \u81ea\u52a8\u5b8c\u6210 \u6309 \u548c ,\u8f93\u5165\u5355\u8bcd\u5f00\u5934\uff0c\u6309\u952e\u540e\u8fdb\u884c\u9009\u62e9\u8981\u8f93\u5165\u7684\u5355\u8bcd \" \u5b8f qa\u5f55\u5236\u884c\u4e3a\u5230\u6ce8\u518c\u8868a\u4e2d\uff0c\u7136\u540e\u5f53\u4f60\u952e\u5165@a\u7684\u65f6\u5019\uff0c@a\u5c06\u4f1a\u91cd\u653e\u4f60\u4fdd\u5b58\u5728\u6ce8\u518c\u8868a\u4e2d\u7684\u5b8f\u3002@@\u662f\u91cd\u653e\u6700\u540e\u4e00\u4e2a\u6267\u884c\u8fc7\u5b8f\u7684\u5feb\u6377\u952e \" \u53ef\u89c6\u5316\u9009\u62e9:v,V, < > \u5411\u5de6\u3001\u5411\u53f3\u7f29\u8fdb = \u81ea\u52a8\u7f29\u8fdb \" \u4f8b\u5982\uff1a\u884c\u5c3e\u6dfb\u52a0\u7b26\u53f7; G $ A ; :set nu ---\u8bbe\u7f6e\u884c\u53f7 :set nonu ----\u53d6\u6d88\u884c\u53f7 \u5220\u9664\u547d\u4ee4\uff1a x \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u7684\u5b57\u7b26\uff1b nx \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u540eN\u4e2a\u5b57\u7b26\uff1b dd \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u7684\u5185\u5bb9\uff1b dG \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u5230\u672b\u5c3e\u7684\u5185\u5bb9\uff1b ndd\u5220\u9664N\u884c\uff1b D \u5220\u9664\u5149\u6807\u6240\u5728\u884c\u5230\u884c\u5c3e\uff1b \uff1an1,n2d \u5220\u9664\u6307\u5b9a\u7684\u8303\u56f4\uff1b \u66ff\u6362\u548c\u53d6\u6d88\u547d\u4ee4\uff1a r \u53d6\u4ee3\u5149\u6807\u6240\u5728\u5904\u5b57\u7b26\uff1b R \u4ece\u5149\u6807\u6240\u5728\u5904\u5f00\u59cb\u66ff\u6362\u5b57\u7b26\uff0cpress ESc overj\uff1b u \u53d6\u6d88\u4e0a\u4e00\u6b65\u64cd\u4f5c\uff1b\u5bf9\u4e8e\u8fd8\u6ca1\u6709\u540c\u6b65\u786c\u76d8\u7684\u64cd\u4f5c\u65f6\u6709\u6548\u7684\uff1b \u641c\u7d22\u548c\u66ff\u6362\u547d\u4ee4\uff1a /command n,N \u7684\u533a\u522b\u662f\u524d\u8005\u6709\u524d\u5f80\u540e\uff0c\u540e\u8005\u76f8\u53cd\uff1b \u5982\u679c\u5728\u641c\u7d22\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u8bdd\uff0c\u4f7f\u7528\u547d\u4ee4:set ic; :%s/old/new/g \u5168\u6587\u66ff\u6362\uff1b :n1,n2s/old/new/g g ,c\u7684\u533a\u522b\u5c31\u662f\u662f\u5426\u5728\u8fdb\u884c\u64cd\u4f5c\u7684\u4e0a\u7684\u786e\u8ba4\uff1b \u4fdd\u6301\u548c\u9000\u51fa\u7684\u547d\u4ee4\uff1a :wq :wq! ZZ equal :wq :q! :w :w /test/important.bak \u6280\u672f\u5e94\u7528\u5b9e\u4f8b\uff1a vi :r \u6587\u4ef6\u540d \u5bfc\u5165\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u8005\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c\uff1b :!\u547d\u4ee4 \u5728vi\u4e2d\u6267\u884c\u547d\u4ee4 :r !date#\u8fd9\u4e2a\u547d\u4ee4\u5f88\u4f7f\u7528\uff1b \u8fde\u7eed\u884c\u6ce8\u91ca\uff1a :n1,n2s/^/#/g \u53d6\u6d88\u7684\u547d\u4ee4\uff1b:n1,n2s/^#//g \u5c16\u89d2\u53f7\u8868\u793a\u884c\u9996\uff1b\u659c\u6760\u8868\u793a\u5206\u9694\u7b26\uff1b \u6269\u5c55\u77e5\u8bc6\u70b9\uff1a \u5728linux\u7cfb\u7edf\u5f53\u4e2d\u5e76\u4e0d\u662f\u6240\u6709\u7684\u914d\u7f6e\u6587\u4ef6\u7684\u6ce8\u91ca\u884c\u90fd\u662f\u4f7f\u7528#\u952e\uff0c\u5728~./vimrc\u7684\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u7684\u6ce8\u91ca\u884c\u662f\u53cc\u5f15\u53f7\uff1b : setshowmode \u663e\u793a\u5f53\u524d\u6a21\u5f0f x \u5220\u9664\u5b57\u7b26","title":"VIM\u4e3b\u5e2e\u52a9\u6587\u6863"},{"location":"Windows/","text":"Windows \u00b6 \u81ea\u52a8\u5173\u673a \u00b6 sleep 3600; shutdown -s \u6216 at 00:00:00PM shutdown -s \u6216 schtasks /create /sc once /tn \"auto shutdown my computer\" /tr \"shutdown -s\" /st 15:30 * Schedule daily shutdown * At 11:00:00PM /every:M,T,W,TH,F,SA,SU shutdown -s * Schedule automatic resart * at 11:00:00PM shutdown -r * For Sleep * sleep number_of_seconds_to_wait; shutdown -r serial number for RAM, motherboard, hard disk,Changing Computer Name wmic memorychip get serialnumber wmic diskdrive get serialnumber wmic baseboard get serialnumber wmic cdrom where drive='d:' get SerialNumber WMIC computersystem where caption='currentname' rename newname Disable WiFi connection netsh interface set interface name= \"Wireless Network Connection\" admin=DISABLED Enable/Disable Firewall * For XP/Server 2003 * netsh firewall set opmode mode=ENABLE netsh firewall set opmode mode=DISABLE * For later versions * netsh advfirewall set currentprofile state on netsh advfirewall set currentprofile state off netsh advfirewall set domainprofile state on netsh advfirewall set domainprofile state off netsh advfirewall set privateprofile state on netsh advfirewall set privateprofile state off netsh advfirewall set publicprofile state on netsh advfirewall set publicprofile state off netsh advfirewall set allprofiles state on netsh advfirewall set allprofiles state off Join or remove a Computer to Domain netdom.exe join %computername% /domain:DomainName /UserD:DomainName\\UserName /PasswordD:Password netdom.exe remove %computername% /domain:Domainname /UserD:DomainName\\UserName /PasswordD:Password @echo off&setlocal enabledelayedexpansion rem \u6839\u636e\u5f53\u524d\u65e5\u671f\u83b7\u53d6\uff0c\u5e74\u6708\u65e5\u4e32 set yyyy=%date:~0,4% set mm=%date:~5,2% set day=%date:~8,2% set \"Ymd=%yyyy%-%mm%-%day%\" rem \u628a\u5e74\u6708\u65e5\u4e32\u4e2d\u672b\u5c3e\u7a7a\u683c\u66ff\u6362\u6389 set \"Ymd=%Ymd: =%\" echo %Ymd% rem \u83b7\u53d6n\u5929\u524d\u7684\u65e5\u671f for /f \"tokens=1-3 delims=-:/ \" %%a in (\"%date%\") do (set Y=%%a&set M=%%b&set D=%%c&if \"!M:~0,1!\" \"0\" set M=!M:~1! if \"!D:~0,1!\" \"0\" set D=!D:~1!) rem \u60f3\u83b7\u53d6n\u5929\u524d\uff0c\u5c31\u4fee\u6539set/a D-=n\u5929\u6570\u5c31\u884c set/a D-=1&if !D! leq 0 (set/a M-=1&if !M!==0 set/a Y-=1,M=12 set/a \"T= !(M-2)\",\"R=( !(Y%%4)& ! !(Y%%100))| !(Y%%400)\",\"C= !(M-4)| !(M-6)| !(M-9)| !(M-11)\",\"D=T*(28+R)+C*30+( !T&^!C)*31\"+D) set M=0%M%&set D=0%D% set previousdate=%Y%-%M: -2%-%D: -2% echo %previousdate% rem \u5220\u9664\u524d\u4e00\u5929\u7684\u538b\u7f29\u6587\u4ef6 del E:\\compresed\\%previousdate%.7z /q rem \u538b\u7f29\u4eca\u5929\u7684\u65e5\u5fd7\u6587\u4ef6 cd /d D: cd D:\\7-Zip 7z.exe a -r E:\\compresed\\%Ymd%.7z E:\\log_%Ymd%.csv -m0=LZMA2 -mx=9 -aoa -y java \u73af\u5883 \u53d8\u91cf\u540d\uff1aPath \u53d8\u91cf\u503c\uff1a%java_home%\\bin \u65b0\u5efa\u53d8\u91cf\u540d\uff1aJAVA_HOME \u53d8\u91cf\u503c\uff1aD:\\jdk1.8.0_111\uff08\u8fd9\u91cc\u662fjdk\u7684\u5b89\u88c5\u76ee\u5f55\uff09 \u65b0\u5efa\u53d8\u91cf\u540d\uff1aCLASSPATH \u53d8\u91cf\u503c\uff1a.;%JAVA_HOME%\\lib VMware Workstation 15 . x FU512 - 2 DG1H - M85QZ - U7Z5T - PY8ZD CU3MA - 2 LG1N - 48 EGQ - 9 GNGZ - QG0UD GV7N2 - DQZ00 - 4897 Y - 27 ZNX - NV0TD YZ718 - 4 REEQ - 08 DHQ - JNYQC - ZQRD0 GZ3N0 - 6 CX0L - H80UP - FPM59 - NKAD4 YY31H - 6 EYEJ - 480 VZ - VXXZC - QF2E0 ZG51K - 25 FE1 - H81ZP - 95 XGT - WV2C0 VG30H - 2 AX11 - H88FQ - CQXGZ - M6AY4 CU7J2 - 4 KG8J - 489 TY - X6XGX - MAUX2 FY780 - 64 E90 - 0845 Z - 1 DWQ9 - XPRC0 UF312 - 07 W82 - H89XZ - 7 FPGE - XUH80 AA3DH - 0 PYD1 - 0803 P - X4Z7V - PGHR4 visio\u5bc6\u94a5 W9WC2 - JN9W2 - H4CBV - 24 QR7 - M4HB8 windows\u66f4\u6539\u8fdc\u7a0b\u684c\u9762\u7aef\u53e3 \u00b6 regedit\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u5206\u522b\u66f4\u6539\u5176\u4e0b\u7684PortNumber\u952e\u503c HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp bat\u811a\u672c\u8fdc\u7a0b\u8fde\u63a5\uff1b\u811a\u672c\u5982\u4e0b\u3002\u4f7f\u7528\u793a\u4f8b\uff1ardp.bat \"my.host.name.de\" \"port\" \"username\" \"password\" : : RDP connection without password prompt ------------ : : %1 = hostname : : %2 = port : : %3 = username : : %4 = password : : --------------------------------------------------- cmdkey /add: \" %~1 \" /user: \" %~3 \" /pass: \" %~4 \" start /wait mstsc /v: \" %~1 : %~2 \" cmdkey /delete: \" %~1 \" : : \u5237\u65b0\u7ec4\u7b56\u7565 gpupdate/force gpupdate /target:computer windows\u670d\u52a1\u7ed1\u5b9aIP\u95ee\u9898 netsh\u2192>http\u2192>show iplisten delete iplisten ipaddress=x.x.x.x \u7f51\u6613\u4e91\uff1a[27493175.mp3] nslookup -vc github.com 8.8.8.8 choice /t 5 /d y /n >nul # \u6279\u5904\u7406\u547d\u4ee4\u5ef6\u8fdf\u65b9\u6cd5 https://www.jsdelivr.com/package/gh/Black-Gold/MyNotes Windows Commands\u8be6\u89e3\u5927\u5168 \u00b6 \u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u67092\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff0cAdministration Mode\u548cApplication Mode\u3002\u8fd9\u4e24\u79cd\u5de5\u4f5c\u6a21\u5f0f\u5206\u522b\u9002\u5e94\u4e0d\u540c\u7684\u573a\u666f\u9700\u6c42\u3002 Administration Mode \u9ed8\u8ba4\u7684Windows Server\u5b89\u88c5\u540e\u5c31\u5904\u4e8e\u8be5\u6a21\u5f0f\uff0c\u670d\u52a1\u5668\u4e0d\u8981\u6c42\u5ba2\u6237\u7aef\u63d0\u4f9bLicense\uff0c\u4f46\u662f\u4ec5\u4ec5\u5141\u8bb82\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002 Application Mode \u5fae\u8f6f\u7684Windows Server\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u590d\u6742\u7684\u8fdc\u7a0b\u8fde\u63a5\u7684\u573a\u666f\u9700\u8981\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u4e8eCitrix\u57fa\u4e8e\u8fdc\u7a0b\u684c\u9762\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u6237\u5728\u5b89\u88c5\u8fdc\u7a0b\u684c\u9762\u4f1a\u8bdd\u670d\u52a1(Remote Desktop Session Host)\u540e\uff0c\u670d\u52a1\u5668\u8f6c\u6362\u4e3aapplication mode\uff0c\u624d\u53ef\u4ee5\u4e0d\u9650\u5236\u7528\u6237\u6570\u8fdb\u884c\u8fde\u63a5\u3002 \u6b64\u65f6\uff0c\u670d\u52a1\u5668\u9ed8\u8ba4\u6709120\u5929\u7684Grace Period\uff0c\u5141\u8bb8\u4e0d\u9650\u5236\u7528\u6237\u6570\u7684\u8fdc\u7a0b\u8fde\u63a5\u3002\u5728120\u5929\u540e\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e00\u53f0\u5df2\u7ecf\u5b89\u88c5Remote Desktop License\u7684\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u624d\u53ef\u4ee5\u591a\u7528\u6237\u7ee7\u7eed\u8fde\u63a5\uff0c\u5426\u5219\u4f1a\u63d0\u793a\u201c\u7531\u4e8e\u6ca1\u6709\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u53ef\u4ee5\u63d0\u4f9b\u8bb8\u53ef\u8bc1\uff0c\u8fdc\u7a0b\u4f1a\u8bdd\u88ab\u4e2d\u65ad\u201c\u7684\u62a5\u9519\u3002\u4f46\u662f\u6b64\u65f6\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7mstsc /admin\u547d\u4ee4\u8fde\u63a5\u5230\u8fdc\u7a0b\u684c\u9762","title":"WindowsServer"},{"location":"Windows/#windows","text":"","title":"Windows"},{"location":"Windows/#_1","text":"sleep 3600; shutdown -s \u6216 at 00:00:00PM shutdown -s \u6216 schtasks /create /sc once /tn \"auto shutdown my computer\" /tr \"shutdown -s\" /st 15:30 * Schedule daily shutdown * At 11:00:00PM /every:M,T,W,TH,F,SA,SU shutdown -s * Schedule automatic resart * at 11:00:00PM shutdown -r * For Sleep * sleep number_of_seconds_to_wait; shutdown -r serial number for RAM, motherboard, hard disk,Changing Computer Name wmic memorychip get serialnumber wmic diskdrive get serialnumber wmic baseboard get serialnumber wmic cdrom where drive='d:' get SerialNumber WMIC computersystem where caption='currentname' rename newname Disable WiFi connection netsh interface set interface name= \"Wireless Network Connection\" admin=DISABLED Enable/Disable Firewall * For XP/Server 2003 * netsh firewall set opmode mode=ENABLE netsh firewall set opmode mode=DISABLE * For later versions * netsh advfirewall set currentprofile state on netsh advfirewall set currentprofile state off netsh advfirewall set domainprofile state on netsh advfirewall set domainprofile state off netsh advfirewall set privateprofile state on netsh advfirewall set privateprofile state off netsh advfirewall set publicprofile state on netsh advfirewall set publicprofile state off netsh advfirewall set allprofiles state on netsh advfirewall set allprofiles state off Join or remove a Computer to Domain netdom.exe join %computername% /domain:DomainName /UserD:DomainName\\UserName /PasswordD:Password netdom.exe remove %computername% /domain:Domainname /UserD:DomainName\\UserName /PasswordD:Password @echo off&setlocal enabledelayedexpansion rem \u6839\u636e\u5f53\u524d\u65e5\u671f\u83b7\u53d6\uff0c\u5e74\u6708\u65e5\u4e32 set yyyy=%date:~0,4% set mm=%date:~5,2% set day=%date:~8,2% set \"Ymd=%yyyy%-%mm%-%day%\" rem \u628a\u5e74\u6708\u65e5\u4e32\u4e2d\u672b\u5c3e\u7a7a\u683c\u66ff\u6362\u6389 set \"Ymd=%Ymd: =%\" echo %Ymd% rem \u83b7\u53d6n\u5929\u524d\u7684\u65e5\u671f for /f \"tokens=1-3 delims=-:/ \" %%a in (\"%date%\") do (set Y=%%a&set M=%%b&set D=%%c&if \"!M:~0,1!\" \"0\" set M=!M:~1! if \"!D:~0,1!\" \"0\" set D=!D:~1!) rem \u60f3\u83b7\u53d6n\u5929\u524d\uff0c\u5c31\u4fee\u6539set/a D-=n\u5929\u6570\u5c31\u884c set/a D-=1&if !D! leq 0 (set/a M-=1&if !M!==0 set/a Y-=1,M=12 set/a \"T= !(M-2)\",\"R=( !(Y%%4)& ! !(Y%%100))| !(Y%%400)\",\"C= !(M-4)| !(M-6)| !(M-9)| !(M-11)\",\"D=T*(28+R)+C*30+( !T&^!C)*31\"+D) set M=0%M%&set D=0%D% set previousdate=%Y%-%M: -2%-%D: -2% echo %previousdate% rem \u5220\u9664\u524d\u4e00\u5929\u7684\u538b\u7f29\u6587\u4ef6 del E:\\compresed\\%previousdate%.7z /q rem \u538b\u7f29\u4eca\u5929\u7684\u65e5\u5fd7\u6587\u4ef6 cd /d D: cd D:\\7-Zip 7z.exe a -r E:\\compresed\\%Ymd%.7z E:\\log_%Ymd%.csv -m0=LZMA2 -mx=9 -aoa -y java \u73af\u5883 \u53d8\u91cf\u540d\uff1aPath \u53d8\u91cf\u503c\uff1a%java_home%\\bin \u65b0\u5efa\u53d8\u91cf\u540d\uff1aJAVA_HOME \u53d8\u91cf\u503c\uff1aD:\\jdk1.8.0_111\uff08\u8fd9\u91cc\u662fjdk\u7684\u5b89\u88c5\u76ee\u5f55\uff09 \u65b0\u5efa\u53d8\u91cf\u540d\uff1aCLASSPATH \u53d8\u91cf\u503c\uff1a.;%JAVA_HOME%\\lib VMware Workstation 15 . x FU512 - 2 DG1H - M85QZ - U7Z5T - PY8ZD CU3MA - 2 LG1N - 48 EGQ - 9 GNGZ - QG0UD GV7N2 - DQZ00 - 4897 Y - 27 ZNX - NV0TD YZ718 - 4 REEQ - 08 DHQ - JNYQC - ZQRD0 GZ3N0 - 6 CX0L - H80UP - FPM59 - NKAD4 YY31H - 6 EYEJ - 480 VZ - VXXZC - QF2E0 ZG51K - 25 FE1 - H81ZP - 95 XGT - WV2C0 VG30H - 2 AX11 - H88FQ - CQXGZ - M6AY4 CU7J2 - 4 KG8J - 489 TY - X6XGX - MAUX2 FY780 - 64 E90 - 0845 Z - 1 DWQ9 - XPRC0 UF312 - 07 W82 - H89XZ - 7 FPGE - XUH80 AA3DH - 0 PYD1 - 0803 P - X4Z7V - PGHR4 visio\u5bc6\u94a5 W9WC2 - JN9W2 - H4CBV - 24 QR7 - M4HB8","title":"\u81ea\u52a8\u5173\u673a"},{"location":"Windows/#windows_1","text":"regedit\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u5206\u522b\u66f4\u6539\u5176\u4e0b\u7684PortNumber\u952e\u503c HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp bat\u811a\u672c\u8fdc\u7a0b\u8fde\u63a5\uff1b\u811a\u672c\u5982\u4e0b\u3002\u4f7f\u7528\u793a\u4f8b\uff1ardp.bat \"my.host.name.de\" \"port\" \"username\" \"password\" : : RDP connection without password prompt ------------ : : %1 = hostname : : %2 = port : : %3 = username : : %4 = password : : --------------------------------------------------- cmdkey /add: \" %~1 \" /user: \" %~3 \" /pass: \" %~4 \" start /wait mstsc /v: \" %~1 : %~2 \" cmdkey /delete: \" %~1 \" : : \u5237\u65b0\u7ec4\u7b56\u7565 gpupdate/force gpupdate /target:computer windows\u670d\u52a1\u7ed1\u5b9aIP\u95ee\u9898 netsh\u2192>http\u2192>show iplisten delete iplisten ipaddress=x.x.x.x \u7f51\u6613\u4e91\uff1a[27493175.mp3] nslookup -vc github.com 8.8.8.8 choice /t 5 /d y /n >nul # \u6279\u5904\u7406\u547d\u4ee4\u5ef6\u8fdf\u65b9\u6cd5 https://www.jsdelivr.com/package/gh/Black-Gold/MyNotes","title":"windows\u66f4\u6539\u8fdc\u7a0b\u684c\u9762\u7aef\u53e3"},{"location":"Windows/#windows-commands","text":"\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u67092\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff0cAdministration Mode\u548cApplication Mode\u3002\u8fd9\u4e24\u79cd\u5de5\u4f5c\u6a21\u5f0f\u5206\u522b\u9002\u5e94\u4e0d\u540c\u7684\u573a\u666f\u9700\u6c42\u3002 Administration Mode \u9ed8\u8ba4\u7684Windows Server\u5b89\u88c5\u540e\u5c31\u5904\u4e8e\u8be5\u6a21\u5f0f\uff0c\u670d\u52a1\u5668\u4e0d\u8981\u6c42\u5ba2\u6237\u7aef\u63d0\u4f9bLicense\uff0c\u4f46\u662f\u4ec5\u4ec5\u5141\u8bb82\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\u3002 Application Mode \u5fae\u8f6f\u7684Windows Server\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u590d\u6742\u7684\u8fdc\u7a0b\u8fde\u63a5\u7684\u573a\u666f\u9700\u8981\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u4e8eCitrix\u57fa\u4e8e\u8fdc\u7a0b\u684c\u9762\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u6237\u5728\u5b89\u88c5\u8fdc\u7a0b\u684c\u9762\u4f1a\u8bdd\u670d\u52a1(Remote Desktop Session Host)\u540e\uff0c\u670d\u52a1\u5668\u8f6c\u6362\u4e3aapplication mode\uff0c\u624d\u53ef\u4ee5\u4e0d\u9650\u5236\u7528\u6237\u6570\u8fdb\u884c\u8fde\u63a5\u3002 \u6b64\u65f6\uff0c\u670d\u52a1\u5668\u9ed8\u8ba4\u6709120\u5929\u7684Grace Period\uff0c\u5141\u8bb8\u4e0d\u9650\u5236\u7528\u6237\u6570\u7684\u8fdc\u7a0b\u8fde\u63a5\u3002\u5728120\u5929\u540e\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e00\u53f0\u5df2\u7ecf\u5b89\u88c5Remote Desktop License\u7684\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u624d\u53ef\u4ee5\u591a\u7528\u6237\u7ee7\u7eed\u8fde\u63a5\uff0c\u5426\u5219\u4f1a\u63d0\u793a\u201c\u7531\u4e8e\u6ca1\u6709\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u53ef\u4ee5\u63d0\u4f9b\u8bb8\u53ef\u8bc1\uff0c\u8fdc\u7a0b\u4f1a\u8bdd\u88ab\u4e2d\u65ad\u201c\u7684\u62a5\u9519\u3002\u4f46\u662f\u6b64\u65f6\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7mstsc /admin\u547d\u4ee4\u8fde\u63a5\u5230\u8fdc\u7a0b\u684c\u9762","title":"Windows Commands\u8be6\u89e3\u5927\u5168"},{"location":"Zabbix/","text":"","title":"Zabbix"},{"location":"static/material/fonts/material-design-icons/","text":"The recommended way to use the Material Icons font is by linking to the web font hosted on Google Fonts: < link href = \"https://fonts.googleapis.com/icon?family=Material+Icons\" rel = \"stylesheet\" > Read more in our full usage guide: http://google.github.io/material-design-icons/#icon-font-for-the-web","title":"Home"}]}