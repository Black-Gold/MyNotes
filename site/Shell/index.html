
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Material Design theme for MyNotes">
      
      
      
        <meta name="author" content="Anonymous">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.7">
    
    
      
        <title>Shell - Material Design for MyNotes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.c772ddf0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-131093963-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="green" data-md-color-accent="light-green">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shell" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Material Design for MyNotes" class="md-header__button md-logo" aria-label="Material Design for MyNotes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Material Design for MyNotes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Shell
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/Black-Gold/MyNotes/" title="前往 GitHub 仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Black-Gold/MyNotes
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Material Design for MyNotes" class="md-nav__button md-logo" aria-label="Material Design for MyNotes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Material Design for MyNotes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/Black-Gold/MyNotes/" title="前往 GitHub 仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Black-Gold/MyNotes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Vim/" class="md-nav__link">
        Vim
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      <label class="md-nav__link" for="__nav_3">
        Languages
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Languages" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Languages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Regex/" class="md-nav__link">
        Regex
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Shell
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Shell
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell_1" class="md-nav__link">
    shell多行注释实现方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eof" class="md-nav__link">
    EOF常见用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_2" class="md-nav__link">
    shell特殊变量基本解释
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_3" class="md-nav__link">
    在shell中常用的符号一般用法
  </a>
  
    <nav class="md-nav" aria-label="在shell中常用的符号一般用法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell_4" class="md-nav__link">
    shell变量子串说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    bash退出和退出状态
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    特殊变量类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    测试
  </a>
  
    <nav class="md-nav" aria-label="测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if" class="md-nav__link">
    if使用的主要表达式
  </a>
  
    <nav class="md-nav" aria-label="if使用的主要表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if_1" class="md-nav__link">
    if语句[ ] [[ ]]比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#then" class="md-nav__link">
    then语句后面的命令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    操作符
  </a>
  
    <nav class="md-nav" aria-label="操作符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    算术运算符
  </a>
  
    <nav class="md-nav" aria-label="算术运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    算术测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    其他比较操作符
  </a>
  
    <nav class="md-nav" aria-label="其他比较操作符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    整数比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    字符串比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    混合比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    算术和字符串比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    位操作符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    数字常量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    变量访问
  </a>
  
    <nav class="md-nav" aria-label="变量访问">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    变量间接引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random" class="md-nav__link">
    $RANDOM随机整数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    循环与分支
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    定义一个颜色输出字符串函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    批量创建用户
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    创建特定大小的文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shellcpu" class="md-nav__link">
    shell采集系统cpu 内存 磁盘 网络信息
  </a>
  
    <nav class="md-nav" aria-label="shell采集系统cpu 内存 磁盘 网络信息">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    cpu信息采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    内存采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    磁盘信息采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    网络信息采集
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Python3/" class="md-nav__link">
        Python3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Go/" class="md-nav__link">
        Go
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Enterprise/" class="md-nav__link">
        Enterprise-class
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        CloudNative
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="CloudNative" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          CloudNative
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Coreos/" class="md-nav__link">
        ContainerOS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Servers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Servers" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Servers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Utilities/" class="md-nav__link">
        Iproute2&Net-tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Iptables/" class="md-nav__link">
        Iptables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Firewalld/" class="md-nav__link">
        Firewalld
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Ansible/" class="md-nav__link">
        Ansible
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Windows/" class="md-nav__link">
        WindowsServer
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        WebServer
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="WebServer" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          WebServer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Nginx/" class="md-nav__link">
        Nginx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Apache/" class="md-nav__link">
        Apache
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Tomcat/" class="md-nav__link">
        Tomcat
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Caddy/" class="md-nav__link">
        Caddy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Database
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Database" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Database
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MySQL/" class="md-nav__link">
        MySQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MySQL/" class="md-nav__link">
        MariaDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Oracle/" class="md-nav__link">
        Oracle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../MongoDB/" class="md-nav__link">
        MongoDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Memcached/" class="md-nav__link">
        Memcached
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Monitor
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Monitor" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Monitor
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Zabbix/" class="md-nav__link">
        Zabbix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Elk/" class="md-nav__link">
        ELKStack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Prometheus/" class="md-nav__link">
        Prometheus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Grafana/" class="md-nav__link">
        Grafana
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Nagios/" class="md-nav__link">
        Nagios
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        CI/CD
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="CI/CD" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          CI/CD
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Git/" class="md-nav__link">
        Git&GitLab
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Jenkins/" class="md-nav__link">
        Jenkins
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        Cache
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Cache" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Cache
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Squid/" class="md-nav__link">
        Squid
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Varnish/" class="md-nav__link">
        Varnish
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Stunnel/" class="md-nav__link">
        Stunnel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../TrafficServer/" class="md-nav__link">
        ApacheTraffic
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      <label class="md-nav__link" for="__nav_11">
        LB&HA
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="LB&HA" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          LB&HA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../LVS/" class="md-nav__link">
        LVS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Haproxy/" class="md-nav__link">
        HAProxy
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      <label class="md-nav__link" for="__nav_12">
        MessageQueue
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="MessageQueue" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          MessageQueue
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Kafka/" class="md-nav__link">
        Kafka
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ActiveMQ/" class="md-nav__link">
        ActiveMQ
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../RabbitMQ/" class="md-nav__link">
        RabbitMQ
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      <label class="md-nav__link" for="__nav_13">
        FileSystem
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FileSystem" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          FileSystem
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Ceph/" class="md-nav__link">
        Ceph
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../GlusterFS/" class="md-nav__link">
        GlusterFS
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      <label class="md-nav__link" for="__nav_14">
        Network
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Network" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Network
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Cisco/" class="md-nav__link">
        Cisco
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Monitors/" class="md-nav__link">
        Monitors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../Others/" class="md-nav__link">
        Others
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell_1" class="md-nav__link">
    shell多行注释实现方式
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eof" class="md-nav__link">
    EOF常见用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_2" class="md-nav__link">
    shell特殊变量基本解释
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_3" class="md-nav__link">
    在shell中常用的符号一般用法
  </a>
  
    <nav class="md-nav" aria-label="在shell中常用的符号一般用法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell_4" class="md-nav__link">
    shell变量子串说明
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    bash退出和退出状态
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    特殊变量类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    测试
  </a>
  
    <nav class="md-nav" aria-label="测试">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if" class="md-nav__link">
    if使用的主要表达式
  </a>
  
    <nav class="md-nav" aria-label="if使用的主要表达式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if_1" class="md-nav__link">
    if语句[ ] [[ ]]比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#then" class="md-nav__link">
    then语句后面的命令
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    操作符
  </a>
  
    <nav class="md-nav" aria-label="操作符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    算术运算符
  </a>
  
    <nav class="md-nav" aria-label="算术运算符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    算术测试
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    其他比较操作符
  </a>
  
    <nav class="md-nav" aria-label="其他比较操作符">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    整数比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    字符串比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    混合比较
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    算术和字符串比较
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    位操作符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    数字常量
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    变量访问
  </a>
  
    <nav class="md-nav" aria-label="变量访问">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    变量间接引用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random" class="md-nav__link">
    $RANDOM随机整数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    循环与分支
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    定义一个颜色输出字符串函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    批量创建用户
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    创建特定大小的文件
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shellcpu" class="md-nav__link">
    shell采集系统cpu 内存 磁盘 网络信息
  </a>
  
    <nav class="md-nav" aria-label="shell采集系统cpu 内存 磁盘 网络信息">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu" class="md-nav__link">
    cpu信息采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    内存采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    磁盘信息采集
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    网络信息采集
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/Black-Gold/MyNotes/edit/master/docs/Shell.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="shell">shell笔记<a class="headerlink" href="#shell" title="Permanent link">&para;</a></h1>
<p>bash shell本身不支持正则表达式，使用正则的是shell命令和工具，如grep、sed等。bash shell可以使用正则表达式中的一些元字符实
现通配(Globbing)功能。通配就是把一个包含通配符的非具体文件名扩展存储在计算机或网络上的一批具体文件名的过程</p>
<p>注意事项：</p>
<ul>
<li>不要使用for循环读取文件的行。请改用while读取循环</li>
<li>cat file | grep pattern   不要使用此方式，而应该使用grep 'pattern' file | sed 'expression'</li>
<li>使用$(...)取代<code>...</code></li>
<li>bash测试时使用[[]]代替[]更安全</li>
<li>ls -l | awk '{ print $8 }' 不要解析ls命令的输出，ls输出并非很靠谱</li>
<li>for number in $(seq 1 10); do 不要使用seq计数</li>
<li>
<p>i=<code>expr $i + 1</code> 不要使用expr，用i++代替</p>
</li>
<li>
<p>Reference List</p>
</li>
<li>
<p>Bash Guide for Beginners</p>
</li>
<li>Advanced Bash-Scripting Guide</li>
</ul>
<h2 id="shell_1">shell多行注释实现方式<a class="headerlink" href="#shell_1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>方法一：
: <span class="s">&lt;&lt; 字符(一般使用comment便于识别)</span>
<span class="s">语句</span>
<span class="s">字符</span>

方法二：
: <span class="s1">&#39;</span>
<span class="s1">语句</span>
<span class="s1">&#39;</span>
</code></pre></div>
<h2 id="eof">EOF常见用法<a class="headerlink" href="#eof" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># 编写SHELL显示多个信息</span>
cat <span class="s">&lt;&lt;EOF</span>
<span class="s">+--------------------------------------------------------------+</span>
<span class="s">|         === Welcome to Tunoff services ===                   |</span>
<span class="s">+--------------------------------------------------------------+</span>
<span class="s">EOF</span>

<span class="c1"># 将mongodbrepo写入到mongodb.repo文件</span>
cat <span class="s">&lt;&lt; EOF &gt; /etc/yum.repos.d/mongodb.repo</span>
<span class="s">[mongodb-org-3.4]</span>
<span class="s">name=MongoDB 3.4 Repository</span>
<span class="s">baseurl=https://mirrors.aliyun.com/mongodb/yum/redhat/\$releasever/mongodb-org/3.4/\$basearch/</span>
<span class="s">gpgcheck=0</span>
<span class="s">enabled=1</span>
<span class="s">EOF</span>
</code></pre></div>
<h2 id="shell_2">shell特殊变量基本解释<a class="headerlink" href="#shell_2" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>$*     # 传递给程序的所有参数组成的字符串
$@     # (常用)传递给程序的所有参数，和$*类似，但每个都用双括号括起，且仍保留每个引用变量的区段含义
$#     # (常用)传递给程序的总的参数数目
$*     # (常用)传递给程序的所有参数组成的字符串
$_     # 获取在此之前执行的命令或脚本的最后一个参数
$?     # (常用)上一条命令执行后返回值;成功返回0,失败返回1

<span class="gh"># 返回值参考：</span>
0      # 表示运行成功
2      # 权限拒绝
1~125  # 运行失败、脚本命令、系统命令错误或参数传递错误
126    # 找到该命令但无法执行
127    # 未找到要运行的命令
&gt;128   # 命令被系统强制结束
$$     # 当前shell运行时的进程ID
$!     # 上一个子进程的进程号
$@     # 所有的参数，每个都用双括号括起
$n     # (常用)位置参数值，n表示位置，获取当前脚本第n个参数值，n大于9时要用大括号，例${10}，接的参数以空格隔开
$0     # (常用)当前shell名(当前执行进程的进程名，如果执行脚本包含路径则返回也包含脚本路径)

<span class="gh"># 数值比较：</span>

-eq     # 等于
-ne     # 不等于
-gt     # 大于
-ge     # 大于或等于
-lt     # 小于
-le     # 小于或等于

<span class="gh"># 逻辑测试：</span>
&amp;&amp;      # 逻辑与
||      # 逻辑或
!       # 逻辑否
</code></pre></div>
<h2 id="shell_3">在shell中常用的符号一般用法<a class="headerlink" href="#shell_3" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="gh"># ;(Command separator)分号</span>
在shell中担任&quot;连续指令&quot;功能的符号就是分号,分号符允许在同一行有两个或多个命令
例如：cd ~/backup;mkdir startup;cp ~/.* startup/.  # 进入家目录下backup并创建目录startup，复制家目录下所有到startup下

<span class="gh"># ;;(Terminator)连续分号</span>
专用在case流程控制选项，担任Terminator角色。case语句分支的结束符使用双分号，如下：
case $variable in
  [yY]|[Yy][Ee][Ss])
    echo &quot;let&#39;s go&quot;;;
  [Nn]|[Nn][Oo])
    echo &quot;poor man&quot;;;
  *)
    echo &quot;you answer is false&quot;;;
esac

<span class="gh"># .(dot)英文句号</span>
shell中一个dot代表当前目录，两个代表上层目录
正则表达式中则代表一个字符
作为命令使用时等同于source
文件名前缀使用时象征为隐藏文件

<span class="gh"># &#39;string&#39;(single quote)单引号</span>
单引号括住的内容将被视为单一字符串，且$符号也被当做一般字符处理

<span class="gh"># &quot;string&quot;(double quote)双引号</span>
双引号括住的内容将被视为单一字符串，可以防止通配符扩展，但是允许变量扩展。此处和单引号不同

<span class="gh"># `command`(backticks)倒引号</span>
倒引号内的command会被当做命令来执行,最好使用$(command)来代替

<span class="gh"># ,(comma)英文逗号</span>
此符号常用在运算中，用作区域隔离。例如：
let &quot;t1 = ((a = 5 + 3, b = 7 - 1, c = 15 - 4))&quot;;echo &quot;t1 = $t1, a = $a, b = $b&quot;

<span class="gh"># /(forward slash)斜线</span>
路径中表示文件路径分隔符，四则运算中代表除法符号。例如：let &quot;num1 = ((a = 10 / 2, b = 25 / 5))&quot;;echo $num1,$a,$b

<span class="gh"># \\ 倒斜线</span>
交互模式下的escape字符
作用：放在指令前取消aliases；放在特殊符号前则该特殊符号不再有特殊意义；放在指令最末端表示连接下一行

<span class="gh"># | (pipeline)管道</span>
pipeline用来连接上个指令的标准输出作为下个指令的标准输入

<span class="gh"># !(negate or reverse)英文感叹号</span>
通常作为反逻辑使用，如条件测试中!=表示不等于,例如判断上个指令是否执行成功
if [ &quot;$?&quot; != 0 ]; then echo &quot;Executes error&quot;; fi
还用来调用属于历史命令机制的调用，但在脚本中命令历史机制是被禁止的

<span class="gh"># : 英文冒号</span>
bash中作为内建指令表示什么都不做，但返回状态值0 例如：
: ${HOSTNAME}${USER}    # 检查这两个环境变量是否已设置，没有设置则以标准错误显示错误信息

<span class="gh"># ? (wild card)问号</span>
正则表示匹配任意一个字符，但不包含null
在一些表达式中，作为测试操作符，问号表示一个条件测试，在双括号(())中表示C风格的三元操作符，在参数替换表达式用来测试一个变量是否被赋值

<span class="gh"># * (wild card)星号</span>
正则中表示任何字符，包含null；四则运算中表示乘法

<span class="gh"># ** 幂运算</span>
let sum=2**3;echo $sum  # 输出8

<span class="gh"># $ (dollar sign)dollar符号</span>
变量替换代表符号，用来引用一个变量的内容；正则中表示匹配行尾

<span class="gh"># ${}   变量的正则表达式</span>
bash中很多用法，详情见下文，参数替换

<span class="gh"># ()   (command group)指令群组</span>
用括号将一串连续指令括起来，称作指令群组，例如：(cd ~ ; var=`pwd` ;echo $var)
数组初始化：array=(element1 element2 element3)

<span class="gh"># (())</span>
作用和let命令相似，用在算数运算中，但执行效率略高.例如：
((a = 10));echo -e &quot;初始值: a = $a \n&quot;;((a++));echo &quot;a++ 后结果: a=$a&quot;

<span class="gh"># { }   大括号(block of code)</span>
用法一：是作为代码块，实际是创建了一个匿名函数，与小括号不同的是不会新创建一个sub shell运行。脚本余下部分仍可使用括号内
变量，括号内命令之间用分号隔开，最后一个也必须有分号，{}第一个命令和左边的大括号必须要有一个空格。例如：
a=one; { a=two; echo -e &quot;\n$a \n&quot;;}; echo $a

用法二：大括号拓展。(通配(globbing))将对大括号中的文件名做扩展。在大括号中，不允许有空白，除非这个空白被引用或转义。
第一种：对大括号中的以逗号分割的文件列表进行拓展。如 touch {a,b}.txt 结果为a.txt b.txt。第二种：对大括号中以点点（..）
分割的顺序文件列表起拓展作用，如：touch {a..d}.txt 结果为a.txt b.txt c.txt d.txt
还可以用在字符串组合上，如：mkdir {a,b}-{1,2} 结果为：a-1 a-2 b-1 b-2

<span class="gh"># [] 中括号------尽量使用[[]]替代[]</span>
与test等同，通常用作条件判断，参数作为比较表达式或文件测试，根据结果返回状态码
test和[]中比较运算符只有==和!=，用于字符串比较，整数比较只能-gt,-eq等
正则中表示一个字符范围
在一个array结构的上下文中，中括号用于引用数组中每个元素的编号

<span class="gh"># [[]]</span>
此括号之间任何字符都不会发生文件扩展名或者单词的分割，但会有参数扩展和命令替换
支持字符串的模式匹配，字符串比较时可以把右边当做一个模式
使用[[]]作为条件判断可防止脚本中逻辑错误，&amp;&amp;,||,&lt;,&gt;操作符可在[[]]正常使用，但在[]中会报错
例如：read ak; if [[ $ak &gt; 5 || $ak &lt; 2 ]]; then echo &quot;$ak&quot;; fi

<span class="gh"># 输出/输入重定向操作符：&gt; &gt;&gt; &lt; &lt;&lt; &amp;&gt; 2&amp;&gt; 2&lt;&gt;&gt;&amp; &gt;&amp;2</span>
文件描述符(file descriptor）通常用一个数字(0-9)表示文件
常见描述符如下：
文件描述符       名称           缩写      默认值
    0          标准输入        stdin      键盘
    1          标准输出        stdout     屏幕
    2        标准错误输出      stderr     屏幕
简单使用&lt;或&gt;时，相当于0&lt;或1&gt;

command &gt; file      # command命令输出重定向到file
command &gt;&gt; file     # command命令输出重定向追加到file
command &lt; file      # command命令从file读取
command &lt;&lt; file     # 从命令行读取输入，知道与file匹配的行结束，除非使用引号将输入括起来，此模式将对输入内容进行shell变量替换如果使用&lt;&lt;-则忽略接下来输入行首的tab
command &lt;&lt;&lt; word    # 把字符word和后面的换行作为输入提供给command
command &lt;&gt; file     # 以读写模式将file重定向到输入，file不会被破坏
command &gt;| file     # 和&gt;功能相同,强迫重定向，会强制覆盖一个已存在文件
: &gt; file            # 将file截断为0长度
command &gt;&amp;n         # 把输出送到文件描述符n，注意： &gt;&amp;实际上复制了文件描述符，使cmd &gt; file 2&gt;&amp;1与cmd 2&gt;&amp;1 &gt;file的效果不一样
command m&gt;&amp;n        # 把输出到文件符m的信息重定向到文件描述符n
command &gt;&amp;-         # 关闭标准输出
command &lt;&amp;n         # 输入来自文件描述符n
command m&lt;&amp;n        # m来自文件描述各个n
command &lt;&amp;-         # 关闭标准输入
command &lt;&amp;n-        # 移动输入文件描述符n而非复制它（需要解释）
&amp;&gt; file和 &gt; file 2&gt;&amp;1相同 # 将stdout和stderr组合覆盖到file

<span class="gh"># ~+</span>
表示当前工作路径，与变量$PWD一致
</code></pre></div>
<h3 id="shell_4">shell变量子串说明<a class="headerlink" href="#shell_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="center">表达式</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">${parameter}</td>
<td align="center">返回变量$parameter的内容</td>
</tr>
<tr>
<td align="center">${#parameter}</td>
<td align="center">返回变量$parameter内容的字符长度</td>
</tr>
<tr>
<td align="center">${parameter:offset}</td>
<td align="center">在变量$parameter中，从位置offset后提取字符串到结尾</td>
</tr>
<tr>
<td align="center">${parameter:offset:length}</td>
<td align="center">在变量$parameter中从位置offset后提取字符串长度为length的子串</td>
</tr>
<tr>
<td align="center">${parameter#word}</td>
<td align="center">从变量$parameter开头删除最短匹配的word子串</td>
</tr>
<tr>
<td align="center">${parameter##word}</td>
<td align="center">从变量$parameter开头删除最长匹配的word子串</td>
</tr>
<tr>
<td align="center">${parameter%word}</td>
<td align="center">从变量$parameter结尾开始删除最短匹配的word子串</td>
</tr>
<tr>
<td align="center">${parameter%%word}</td>
<td align="center">从变量$parameter结尾开始删除最长匹配的word子串</td>
</tr>
<tr>
<td align="center">${parameter/pattern/string}</td>
<td align="center">使用string代替第一个匹配的pattern</td>
</tr>
<tr>
<td align="center">${parameter//pattern/string}</td>
<td align="center">使用string代替所有匹配的pattern</td>
</tr>
<tr>
<td align="center">${parameter:-word}</td>
<td align="center">如果变量parameter没有值为空或未赋值则返回word字符串作为变量的值</td>
</tr>
<tr>
<td align="center">${parameter:=word}</td>
<td align="center">如果变量parameter没有值为空或未赋值则返回word字符串作为变量的值,位置变量和特殊变量不适用</td>
</tr>
<tr>
<td align="center">${parameter:?word}</td>
<td align="center">如果变量parameter没有值为空或未赋值则word字符串作为标准错误输出，否则输出变量的值</td>
</tr>
<tr>
<td align="center">${parameter:+word}</td>
<td align="center">如果变量parameter没有值为空或未赋值则什么都不做，否则word字符串替代变量的值</td>
</tr>
</tbody>
</table>
<p>word可以表示为一串字符，比如a*c表示删除从字符a到c的所有字符</p>
<h2 id="bash">bash退出和退出状态<a class="headerlink" href="#bash" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>: <span class="s">&lt;&lt; comment</span>
<span class="s">exit命令一般用于结束一个脚本，它也能返回一个值给父进程,每一个命令都能返回一个退出状态（有时也看做返回状态).一个命令执行</span>
<span class="s">成功返回0，一个执行不成功的命令则返回一个非零值，此值通常可以被解释成一个对应的错误值。除了一些例外的情况，UNIX命令，程</span>
<span class="s">序或是软件包执行成功都是以返回0的作为退出码</span>

<span class="s">同样的，在脚本里的函数和脚本自身都会返回退出状态码。在脚本或函数里最后一个命令将决定退出状态码。在一个脚本里，exit n命令</span>
<span class="s">将会返回shell一个nnn的退出状态码。（nnn必须是一个在0-255范围的十进制整数）</span>

<span class="s">如果一个脚本以不带参数的exit命令结束，脚本的退出状态码将会是执行exit命令前的最后一个命令的退出码，脚本结束没有exit,不带</span>
<span class="s">参数的exit和exit $?三者等价，$?变量保存了最后一个命令执行后的退出状态，当一个函数返回时，$?保存了函数里最后一个命令的退</span>
<span class="s">出状态码。这就是Bash里函数返回值的处理办法。当一个脚本运行结束，$? 变量保存脚本的退出状态，而脚本的退出状态则是脚本中最</span>
<span class="s">后一个已执行命令的退出状态。并且依照惯例，0表示执行成功，1-255的整数范围表示错误或反常的条件</span>

<span class="s">逻辑非操作符!，反转一个命令或一个测试的结果。也能反转退出状态</span>
<span class="s">comment</span>
</code></pre></div>
<h2 id="_1">特殊变量类型<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># 局部变量：只在代码块或一个函数中有效</span>
<span class="c1"># 环境变量：其会影响shell的行为和用户接口，大部分情况下，每个进程都有一个环境，其由进程使用的环境变量组成</span>
<span class="c1"># 分配给环境变量的总空间有限，若创建太多环境变量或有些环境变量的值太长而占用过多空间则会出错</span>
<span class="c1"># 例如：</span>
: <span class="s">&lt;&lt;comment</span>
<span class="s">#eval命令将这些参数串联在一起成为一个命令，然后读取并执行这些命令，并将其退出状态作为的退出状态返回。如果没有参数或只有空参数，则返回状态为零</span>
<span class="s">eval &quot;`seq 10000 | sed -e &#39;s/.*/export var&amp;=ZZZZZZZZZZZZZZ/&#39;`&quot;</span>
<span class="s">du</span>
<span class="s">/usr/bin/du:Argument list too long</span>
<span class="s">comment</span>
<span class="c1"># 如果一个脚步要设置一个环境变量，则需要将其导出(export)，也就是讲需通知到脚本的环境表，这是export命令功能</span>
<span class="c1"># 一个脚本只能导出（export）变量到子进程，也就是说只能导出到由此脚本生成的命令或进程中。在一个命令行中运行的脚本不能导出</span>
<span class="c1"># 一个变量影响到命令行的环境。子进程不能导出变量到生成它的父进程中。</span>
<span class="c1"># 位置参数</span>
: <span class="s">&lt;&lt;comment</span>
<span class="s">命令行传递给脚本的参数是$0,$1,$2....</span>
<span class="s">$0是脚本的名字，$1是第一个参数，$2是第二个参数......在位置参数$9之后的参数必须用大括号括起来。如：${10}</span>
<span class="s">特殊变量$*和$@表示所有的位置参数</span>
<span class="s">comment</span>

: <span class="s">&lt;&lt;comment</span>
<span class="s">#!/bin/bash</span>
<span class="s"># 位置参数例子：</span>
<span class="s"># 至少以10个参数运行此脚本。例如：./script.sh 1 2 3 4 5 6 7 8 9 10</span>
<span class="s">min_params=10</span>
<span class="s">echo &quot;脚本名字是\&quot;$0\&quot;.&quot;</span>
<span class="s"># 用./表示当前目录</span>
<span class="s">echo &quot;脚本名字是\&quot;`basename $0`\&quot;.&quot;</span>
<span class="s">comment</span>
</code></pre></div>
<h2 id="_2">测试<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="if">if使用的主要表达式<a class="headerlink" href="#if" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="center">主要的表达式</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">[ -a FILE ]</td>
<td align="center">文件如果存在返回True，与-e一样但不赞成使用</td>
</tr>
<tr>
<td align="center">[ -b FILE ]</td>
<td align="center">文件如果存在并且是块设备返回True(软盘,光驱等)</td>
</tr>
<tr>
<td align="center">[ -c FILE ]</td>
<td align="center">文件如果存在并且时字符设备返回True(键盘,调制解调器,声卡等)</td>
</tr>
<tr>
<td align="center">[ -d FILE ]</td>
<td align="center">如果是目录返回True</td>
</tr>
<tr>
<td align="center">[ -e FILE ]</td>
<td align="center">文件如果存在返回True</td>
</tr>
<tr>
<td align="center">[ -f FILE ]</td>
<td align="center">文件是普通文件并且不是一个目录或是一个设备文件返回True</td>
</tr>
<tr>
<td align="center">[ -g FILE ]</td>
<td align="center">文件如果存在并且文件或目录的设置-组-ID(sgid)标记被设置则返回True，如果一个目录的sgid标志被设置，在这个<br/>目录下创建的文件都属于拥有此目录的用户组，而不必是创建文件的用户所属的组。这个特性对在一个工作组里的同享目录很有用处</td>
</tr>
<tr>
<td align="center">[ -h FILE ]</td>
<td align="center">文件如果存在并且是个符号链接返回True</td>
</tr>
<tr>
<td align="center">[ -k FILE ]</td>
<td align="center">文件如果存在且粘住位设置返回True。俗称“粘性位”，保存文本模式标志是一种特殊类型的文件权限。如果<br/>一个文件设置了这个标志，该文件将被保存在缓存内存中，以便更快地访问。〔2〕如果设置在目录上，则限制写入权限。设置粘性<br/>位将T添加到文件或目录列表的权限(drwxrwxrw**t**)，如果用户不拥有设置了粘性位的目录，但在该目录中具有写权限，则他只能<br/>删除其拥有的目录中的文件。这样可以防止用户在公共可访问目录（如/tMP）中无意中覆盖或删除彼此的文件</td>
</tr>
<tr>
<td align="center">[ -p FILE ]</td>
<td align="center">文件如果存在并且文件是一个管道返回True</td>
</tr>
<tr>
<td align="center">[ -r FILE ]</td>
<td align="center">文件如果存在并且文件可读返回True(指运行这个测试命令的用户的读权限)</td>
</tr>
<tr>
<td align="center">[ -s FILE ]</td>
<td align="center">文件如果存在并且文件大小大于0返回True</td>
</tr>
<tr>
<td align="center">[ -t FD ]</td>
<td align="center">如果一个文件描述符FD(对应函数的返回值)打开并引用了终端则为True，文件(描述符)与一个终端设备相关，这个测<br/>试选项可以用于检查脚本中是否标准输入 ([ -t 0 ])或标准输出([ -t 1 ])是一个终端</td>
</tr>
<tr>
<td align="center">[ -u FILE ]</td>
<td align="center">文件如果存在返回True，文件的设置-用户-ID(suid)标志被设置，一个root用户拥有的二进制执行文件如果设置了<br/>设置-用户-ID位(suid)标志普通用户可以以root权限运行。[1] 这对需要存取系统硬件的执行程序（比如说pppd和cdrecord）很有用<br/>如果没有设置suid位，则这些二进制执行程序不能由非root调用。被设置了suid标志的文件在权限列中以s标志表示(-rw**s**r-xr-t)</td>
</tr>
<tr>
<td align="center">[ -w FILE ]</td>
<td align="center">文件如果存在并且可写的返回True(运行这个测试命令的用户的写权限)</td>
</tr>
<tr>
<td align="center">[ -x FILE ]</td>
<td align="center">文件如果存在并且是可执行的返回True(测试命令的用户的执行权限)</td>
</tr>
<tr>
<td align="center">[ -O FILE ]</td>
<td align="center">文件如果存在并且由有效用户ID所拥有的返回True(你是文件拥有者)</td>
</tr>
<tr>
<td align="center">[ -G FILE ]</td>
<td align="center">文件如果存在并且与用户组ID相同返回True(文件所在的组和文件的groupID一致)</td>
</tr>
<tr>
<td align="center">[ -L FILE ]</td>
<td align="center">文件如果存在并且是一个符号链接返回True</td>
</tr>
<tr>
<td align="center">[ -N FILE ]</td>
<td align="center">文件如果存在并且最后一次读后被修改返回True</td>
</tr>
<tr>
<td align="center">[ -S FILE ]</td>
<td align="center">文件如果存在并且是一个socket返回True</td>
</tr>
<tr>
<td align="center">[ FILE1 -nt FILE2 ]</td>
<td align="center">如果FILE1比FILE2更新，或者FILE1存在且FILE2不存在，则为True</td>
</tr>
<tr>
<td align="center">[ FILE1 -ot FILE2 ]</td>
<td align="center">如果FILE1比FILE2旧，或者FILE2存在且FILE1不存在，则为True</td>
</tr>
<tr>
<td align="center">[ FILE1 -ef FILE2 ]</td>
<td align="center">如果FILE1和FILE2引用相同的设备和inode编号(相同的文件硬链接)，则为True</td>
</tr>
<tr>
<td align="center">[ -o OPTIONNAME ]</td>
<td align="center">如果启用了shell选项“OPTIONNAME”(选项名称)，则为True</td>
</tr>
<tr>
<td align="center">[ -z STRING ]</td>
<td align="center">如果字符串为0则为True</td>
</tr>
<tr>
<td align="center">[ -n STRING ] or [ STRING ]</td>
<td align="center">如果字符串不为0则为True</td>
</tr>
<tr>
<td align="center">[ STRING1 == STRING2 ]</td>
<td align="center">如果字符串相等则为True，对于严格的POSIX合规性，可以使用“=”代替“==”</td>
</tr>
<tr>
<td align="center">[ STRING1 != STRING2 ]</td>
<td align="center">如果字符串不相等则为True</td>
</tr>
<tr>
<td align="center">[ STRING1 &lt; STRING2 ]</td>
<td align="center">如果“STRING1”在当前locale环境中按字典顺序在“STRING2”之前排序，则为True</td>
</tr>
<tr>
<td align="center">[ STRING1 &gt; STRING2 ]</td>
<td align="center">如果“STRING1”在当前locale环境中按字典顺序在“STRING2”之后排序，则为True</td>
</tr>
<tr>
<td align="center">[ ARG1 OP ARG2 ]</td>
<td align="center">“OP”是-eq，-ne，-lt，-le，-gt或-ge之一。 如果“ARG1”分别等于，不等于，小于，小于或等于，大于<br/>或大于或等于“ARG2”，则这些算术二元运算符返回true。 “ARG1”和“ARG2”是整数</td>
</tr>
</tbody>
</table>
<p>可以使用以下运算符组合表达式，按优先级递减顺序列出：</p>
<table>
<thead>
<tr>
<th align="center">类别</th>
<th align="center">例子</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">[ ! EXPR ]</td>
<td align="center">"非" -- 反转上面所有测试的结果(如果没有给出条件则返回真),如果EXPR是false则为真</td>
</tr>
<tr>
<td align="center">[ ( EXPR ) ]</td>
<td align="center">返回EXPR的值。 这可以用于覆盖运算符的正常优先级</td>
</tr>
<tr>
<td align="center">[ EXPR1 -a EXPR2 ]</td>
<td align="center">如果EXPR1和EXPR2都为真，则为真</td>
</tr>
<tr>
<td align="center">[ EXPR1 -o EXPR2 ]</td>
<td align="center">如果EXPR1或EXPR2为真，则为真</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># 大多数程序员更喜欢使用test内置命令，这相当于使用方括号进行比较，如下所示</span>
<span class="nb">test</span> <span class="s2">&quot;</span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s1">&#39;root&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nb">echo</span> you are using a non-privileged account<span class="p">;</span> <span class="nb">exit</span> <span class="m">1</span><span class="o">)</span>
<span class="c1"># 如果在子shell中调用exit，则不会将变量传递给父级。如果您不希望Bash派生子shell，请使用{ }代替()</span>
</code></pre></div>
<h4 id="if_1">if语句[ ] [[ ]]比较<a class="headerlink" href="#if_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">测试类型</th>
<th align="center">[ ]</th>
<th align="center">[[ ]]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">数字测试</td>
<td align="center">-eq -ne -lt -le -gt -ge</td>
<td align="center">同[ ]</td>
</tr>
<tr>
<td align="center">文件测试</td>
<td align="center">-r -l -w -x -f -d -s -nt -ot</td>
<td align="center">同[ ]</td>
</tr>
<tr>
<td align="center">字符测试</td>
<td align="center">= != -n -z ==(同=) 不可使用&lt;= &gt;=</td>
<td align="center">同[ ]</td>
</tr>
<tr>
<td align="center">逻辑测试</td>
<td align="center">-a -o !</td>
<td align="center">&amp;&amp; || !</td>
</tr>
<tr>
<td align="center">数学运算</td>
<td align="center">不可以使用</td>
<td align="center">+ - * / %</td>
</tr>
<tr>
<td align="center">组合</td>
<td align="center">用各自逻辑符号连接的数字(运算)测试、文件测试、字符测试</td>
<td align="center">同[ ]</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="center">情况复杂的字符测试</th>
<th align="center">[ ]</th>
<th align="center">[[ ]]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">&lt; &gt;</td>
<td align="center">比较结果异常，如:<span><span class="MathJax_Preview">[ 12 &gt; 21 ]与</span><script type="math/tex">[ 12 > 21 ]与</script></span>[ 21 &gt; 12 ]、<span><span class="MathJax_Preview">[ a &gt; b ]与</span><script type="math/tex">[ a > b ]与</script></span>[ b &gt; a ]的返回值一样</td>
<td align="center">根据对于ASCII码进行比较<br/>(若多个字母和数字组合，则先比较首个，相同再比较下一个)</td>
</tr>
<tr>
<td align="center">\&gt; \&lt;</td>
<td align="center">根据对于ASCII码进行比较(若多个字母和数字组合，则先比较首个，相同再比较下一个)</td>
<td align="center">不可以使用</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># if then else结构测试断掉的连接</span>

<span class="c1">#!/bin/bash</span>
<span class="c1"># broken-link.sh</span>
<span class="c1"># 由Lee bigelow所写&lt;ligelowbee@yahoo.com&gt;</span>

<span class="c1"># 一个用于发现死符号链接并且输出它们的链接文件的纯shell的脚本。</span>
<span class="c1"># 所以它们能把输出提供给xargs并处理 :)</span>
<span class="c1"># 例如： broken-link.sh /somedir /someotherdir|xargs rm</span>
<span class="c1"># 下面是更好的发现死符号链接的办法:</span>
<span class="c1"># find &quot;somedir&quot; -type l -print0|\</span>
<span class="c1"># xargs -r0 file|\</span>
<span class="c1"># grep &quot;broken symbolic&quot;|</span>
<span class="c1"># sed -e &#39;s/^\|: *broken symbolic.*$/&quot;/g&#39;</span>
<span class="c1"># 但这不是纯bash脚本，下面的则是.</span>
<span class="c1"># 注意: 谨防在/proc文件系统和死循环链接中使用!</span>
<span class="c1"># 如果没有参数被传递给脚本作为搜索目录，则使用当前目录</span>
<span class="o">[[</span> <span class="nv">$#</span> -eq <span class="m">0</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">directories</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span> <span class="o">||</span> <span class="nv">directories</span><span class="o">=</span><span class="nv">$@</span>

<span class="c1">#Setup the function link_chk to check the directory it is passed</span>
<span class="c1">#for files that are links and don&#39;t exist, then print them quoted.</span>
<span class="c1">#If one of the elements in the directory is a subdirectory then</span>
<span class="c1">#send that send that subdirectory to the link_check function.</span>
<span class="c1">########</span>
link_chk <span class="o">()</span> <span class="o">{</span>
    <span class="k">for</span> element <span class="k">in</span> <span class="nv">$1</span>/*<span class="p">;</span> <span class="k">do</span>
    <span class="o">[[</span> -h <span class="s2">&quot;</span><span class="nv">$element</span><span class="s2">&quot;</span> -a ! -e <span class="s2">&quot;</span><span class="nv">$element</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="se">\&quot;</span><span class="nv">$element</span><span class="se">\&quot;</span>
    <span class="o">[[</span> -d <span class="s2">&quot;</span><span class="nv">$element</span><span class="s2">&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> linkchk <span class="nv">$element</span>
    <span class="c1"># Of course, &#39;-h&#39; tests for symbolic link, &#39;-d&#39; for directory.</span>
    <span class="k">done</span>
<span class="o">}</span>

<span class="c1">#Send each arg that was passed to the script to the link_chk function</span>
<span class="c1">#if it is a valid directory.  If not, then print the error message</span>
<span class="c1">#and usage info.</span>
<span class="c1">############</span>
<span class="k">for</span> directory <span class="k">in</span> <span class="nv">$directories</span><span class="p">;</span> <span class="k">do</span>
    <span class="k">if</span> <span class="o">[[</span> -d <span class="nv">$directories</span> <span class="o">]]</span>
    <span class="k">then</span> link_chk <span class="nv">$directories</span>
    <span class="k">else</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$directories</span><span class="s2"> is not a directory&quot;</span>
        <span class="nb">echo</span> <span class="s2">&quot;Usage: </span><span class="nv">$0</span><span class="s2"> dir1 dir2 ...&quot;</span>
    <span class="k">fi</span>
<span class="k">done</span>

<span class="c1"># [1] 一定要意识到suid二进制文件可能引起潜在的安全漏洞，并且在shell脚本中suid标志已经不起作用了</span>
<span class="c1"># [2] 在现代UNIX操作系统，粘住位已经不在文件中再使用，只用在目录中</span>
</code></pre></div>
<h4 id="then">then语句后面的命令<a class="headerlink" href="#then" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># then语句后面的CONSEQUENT-COMMANDS列表可以是任何有效的UNIX命令，任何可执行程序，任何可执行shell脚本或任何shell语句，但结</span>
<span class="c1"># 束fi除外。重要的是要记住，then和fi被认为是shell中的分隔语句。因此，在命令行上发出时，它们用分号分隔</span>
<span class="c1">#第一个示例检查文件是否存在</span>
<span class="c1">#!/bin/bash</span>

<span class="nb">echo</span> <span class="s2">&quot;This scripts checks the existence of the messages file.&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;Checking...&quot;</span>
<span class="k">if</span> <span class="o">[[</span> -f /var/log/messages <span class="o">]]</span>
  <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;/var/log/messages exists.&quot;</span>
<span class="k">fi</span>
<span class="nb">echo</span>
<span class="nb">echo</span> <span class="s2">&quot;...done.&quot;</span>

: <span class="s">&lt;&lt; comment</span>
<span class="s">一个if/then结构测试一列命令的退出状态是否为0（因为依照惯例，0意味着命令执行成功），如果是0则会执行一个或多个命令</span>
<span class="s">有一个命令 [ (左方括是特殊字符). 它和test是同义词,因为效率的原因，它被内建在shell里。这个命令的参数是比较表达式或者</span>
<span class="s">文件测试，它会返回一个退出状态指示比较的结果(0表示真，1表示假)</span>

<span class="s">#一个if/then结构能包含嵌套的比较和测试</span>
<span class="s">if echo &quot;Next *if* is part of the comparison for the first *if*.&quot;</span>
<span class="s">  if [[ $comparison = &quot;integer&quot; ]]</span>
<span class="s">    then (( a &lt; b ))</span>
<span class="s">  else</span>
<span class="s">    [[ $a &lt; $b ]]</span>
<span class="s">  fi</span>
<span class="s">then</span>
<span class="s">  echo &#39;$a is less than $b&#39;</span>
<span class="s">fi</span>
<span class="s">comment</span>

<span class="c1"># 当if和then在同一行的时候，一个分号（;）必须用在if语句的结尾。if和then都是关键字.关键字（或命令）开始一个语句，如果在同</span>
<span class="c1"># 一行开始另一个新语句时，前面一个语句必须用分号（;）结束  例如：if [ -x &quot;$filename&quot; ]; then</span>

<span class="c1">#等价的测试命令：test,/usr/bin/test,[]和/usr/bin/[</span>
<span class="c1">#!/bin/bash</span>
<span class="k">if</span> <span class="nb">test</span> -z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;No command-line arguments.&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;First command-line argument is </span><span class="nv">$1</span><span class="s2">.&quot;</span>
<span class="k">fi</span>

<span class="k">if</span> /usr/bin/test -z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>      <span class="c1"># 和内建的&quot;test&quot;命令一样.</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;No command-line arguments.&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;First command-line argument is </span><span class="nv">$1</span><span class="s2">.&quot;</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">]</span>                <span class="c1"># 和上面代码块的功能一样</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;No command-line arguments.&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;First command-line argument is </span><span class="nv">$1</span><span class="s2">.&quot;</span>
<span class="k">fi</span>

<span class="k">if</span> /usr/bin/<span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span> <span class="o">]</span>       <span class="c1"># 同样和上面的代码块一样.</span>
<span class="c1"># if /usr/bin/[ -z &quot;$1&quot;       # 工作, 但还是给出一个错误信息.注意:这个已经在bash 3.x版本被修补好了。</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;No command-line arguments.&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;First command-line argument is </span><span class="nv">$1</span><span class="s2">.&quot;</span>
<span class="k">fi</span>

<span class="c1"># 在[[和]]之间的所有的字符都不会被文件扩展或是标记分割，但是会有参数引用和命令替换</span>
<span class="nv">file</span><span class="o">=</span>/etc/passwd

<span class="k">if</span> <span class="o">[[</span> -e <span class="nv">$file</span> <span class="o">]]</span>
<span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&quot;Password file exists.&quot;</span>
<span class="k">fi</span>

<span class="c1"># 用[[ .. ]]测试结构比用[ .. ]更能防止脚本逻辑错误。例如：&amp;&amp;,||,&lt;和&gt;操作符能在一个[[]]测试里通过，但在[]结构会发生错误</span>
<span class="c1"># 在一个if的后面，不必一定是test命令或是test结构（[]或是[[]]）</span>
<span class="nv">dir</span><span class="o">=</span>/home/bozo

<span class="k">if</span> <span class="nb">cd</span> <span class="s2">&quot;</span><span class="nv">$dir</span><span class="s2">&quot;</span> <span class="m">2</span>&gt;/dev/null<span class="p">;</span> <span class="k">then</span>   <span class="c1"># &quot;2&gt;/dev/null&quot;会隐藏错误的信息.</span>
  <span class="nb">echo</span> <span class="s2">&quot;Now in </span><span class="nv">$dir</span><span class="s2">.&quot;</span>
<span class="k">else</span>
  <span class="nb">echo</span> <span class="s2">&quot;Can&#39;t change to </span><span class="nv">$dir</span><span class="s2">.&quot;</span>
<span class="k">fi</span>
<span class="c1"># &quot;if COMMAND&quot;结构会返回COMMAND命令的退出状态码</span>
<span class="c1"># 同样的，在一个测试方括号里面的条件测试也可以用列表结构(list construct)而不必用if。</span>
<span class="nv">var1</span><span class="o">=</span><span class="m">20</span>
<span class="nv">var2</span><span class="o">=</span><span class="m">22</span>
<span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$var1</span><span class="s2">&quot;</span> -ne <span class="s2">&quot;</span><span class="nv">$var2</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$var1</span><span class="s2"> is not equal to </span><span class="nv">$var2</span><span class="s2">&quot;</span>

<span class="nv">home</span><span class="o">=</span>/home/bozo
<span class="o">[</span> -d <span class="s2">&quot;</span><span class="nv">$home</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$home</span><span class="s2"> directory does not exist.&quot;</span>
</code></pre></div>
<h2 id="_3">操作符<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">算术运算符<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th align="center">算术运算符</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"></td>
<td align="center">bash无法处理浮点运算，默认会把小数点的数字作为字符串，脚本中使用bc进行浮点计算或添加数学库函数的支持</td>
</tr>
<tr>
<td align="center">+ -</td>
<td align="center">加法 减法(常用)</td>
</tr>
<tr>
<td align="center">* / %</td>
<td align="center">乘法 除法 取模(常用)</td>
</tr>
<tr>
<td align="center">**</td>
<td align="center">幂运算(常用)</td>
</tr>
<tr>
<td align="center">++ --</td>
<td align="center">自加 自减，可放在变量前变量后,变量之前表示先自增或自减再赋值给变量，之后表示先赋值再自增或自减(常用)</td>
</tr>
<tr>
<td align="center">! &amp;&amp; ||</td>
<td align="center">逻辑非（取反） 逻辑与（and） 逻辑或（or） (常用)</td>
</tr>
<tr>
<td align="center">&lt; &lt;= &gt; &gt;=</td>
<td align="center">比较符号</td>
</tr>
<tr>
<td align="center">== != =</td>
<td align="center">比较符号</td>
</tr>
<tr>
<td align="center">&lt;&lt; &gt;&gt;</td>
<td align="center">向左位移 向右位移</td>
</tr>
<tr>
<td align="center">~</td>
<td align="center">&amp; ^</td>
</tr>
<tr>
<td align="center">= += -= *= /= %=</td>
<td align="center">赋值运算符</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th align="center">算术运算表达式和运算命令</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">(())</td>
<td align="center">整数运算的常用操作符</td>
</tr>
<tr>
<td align="center">let</td>
<td align="center">用于整数运算和(())类似</td>
</tr>
<tr>
<td align="center">expr</td>
<td align="center">通常用于整数计算也有其他额外功能</td>
</tr>
<tr>
<td align="center">bc</td>
<td align="center">适合整数和小数运算</td>
</tr>
<tr>
<td align="center">$[]</td>
<td align="center">用于整数运算</td>
</tr>
<tr>
<td align="center">awk</td>
<td align="center">整数和小数运算</td>
</tr>
<tr>
<td align="center">declare</td>
<td align="center">定义变量值和属性,-i参数用于定义整型变量</td>
</tr>
</tbody>
</table>
<h4 id="_5">算术测试<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="gh"># (( ))结构扩展并计算一个算术表达式的值。如果表达式值为0，会返回1或假作为退出状态码。一个非零值的表达式返回一个0或真作为</span>
<span class="gh"># 退出状态码。这个结构和先前test命令及[]结构的讨论刚好相反</span>

<span class="gh">#用(( ))进行算术测试</span>
<span class="gh">#!/bin/bash</span>
<span class="gh"># 算术测试.(( ... ))结构会求值并测试该值。退出状态码与[ ... ]结构正好相反!返回0代表真，1代表假</span>

(( 0 )); echo &quot;Exit status of \&quot;(( 0 ))\&quot; is $?.&quot;         # 1
(( 1 )); echo &quot;Exit status of \&quot;(( 1 ))\&quot; is $?.&quot;         # 0
(( 5 &gt; 4 )); echo &quot;Exit status of \&quot;(( 5 &gt; 4 ))\&quot; is $?.&quot;     # 0
(( 5 &gt; 9 )); echo &quot;Exit status of \&quot;(( 5 &gt; 9 ))\&quot; is $?.&quot;     # 1
(( 5 - 5 )); echo &quot;Exit status of \&quot;(( 5 - 5 ))\&quot; is $?.&quot;     # 1
(( 5 / 4 )); echo &quot;Exit status of \&quot;(( 5 / 4 ))\&quot; is $?.&quot;     # 0
(( 1 / 2 )); echo &quot;Exit status of \&quot;(( 1 / 2 ))\&quot; is $?.&quot;     # 1
(( 1 / 0 )) 2&gt;/dev/null; echo &quot;Exit status of \&quot;(( 1 / 0 ))\&quot; is $?.&quot;     # 1
</code></pre></div>
<h3 id="_6">其他比较操作符<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>二元比较操作符比较两个变量或是数值。注意整数和字符串比较的分别</p>
<h4 id="_7">整数比较<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">表达式</th>
<th align="center">含义</th>
<th align="center">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-eq</td>
<td align="center">等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -eq "</span><script type="math/tex">a" -eq "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">-ne</td>
<td align="center">不等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -ne "</span><script type="math/tex">a" -ne "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">-gt</td>
<td align="center">大于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -gt "</span><script type="math/tex">a" -gt "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">-ge</td>
<td align="center">大于等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -ge "</span><script type="math/tex">a" -ge "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">-lt</td>
<td align="center">小于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -lt "</span><script type="math/tex">a" -lt "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">-le</td>
<td align="center">小于等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" -le "</span><script type="math/tex">a" -le "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">小于(在双小括号内使用)</td>
<td align="center">(("<span><span class="MathJax_Preview">a" &gt; "</span><script type="math/tex">a" > "</script></span>b"))</td>
</tr>
<tr>
<td align="center">&gt;=</td>
<td align="center">大于等于(在双小括号里使用)</td>
<td align="center">(("<span><span class="MathJax_Preview">a" &gt;= "</span><script type="math/tex">a" >= "</script></span>b"))</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">小于(在双小括号里使用)</td>
<td align="center">(("<span><span class="MathJax_Preview">a" &lt; "</span><script type="math/tex">a" < "</script></span>b"))</td>
</tr>
<tr>
<td align="center">&lt;=</td>
<td align="center">小于等于 (在双括号里使用)</td>
<td align="center">(("<span><span class="MathJax_Preview">a" &lt;= "</span><script type="math/tex">a" <= "</script></span>b"))</td>
</tr>
</tbody>
</table>
<h4 id="_8">字符串比较<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">表达式</th>
<th align="center">含义</th>
<th align="center">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">=</td>
<td align="center">等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" = "</span><script type="math/tex">a" = "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">==</td>
<td align="center">等于①</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" == "</span><script type="math/tex">a" == "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">!=</td>
<td align="center">不等于</td>
<td align="center">if [ "<span><span class="MathJax_Preview">a" != "</span><script type="math/tex">a" != "</script></span>b" ]</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">小于,按照ASCII字符排序进行比较</td>
<td align="center">if [[ "<span><span class="MathJax_Preview">a" &lt; "</span><script type="math/tex">a" < "</script></span>b" ]]或if [ "<span><span class="MathJax_Preview">a" \&lt; "</span><script type="math/tex">a" \< "</script></span>b" ]，在[]要注意转义字符&lt;</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">大于,按照ASCII字符排序进行比较</td>
<td align="center">if [[ "<span><span class="MathJax_Preview">a" &gt; "</span><script type="math/tex">a" > "</script></span>b" ]]或if [ "<span><span class="MathJax_Preview">a" \&gt; "</span><script type="math/tex">a" \> "</script></span>b" ]，在[]要注意转义字符&gt;</td>
</tr>
<tr>
<td align="center">-z</td>
<td align="center">字符串为null,即指定字符串长度为零</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">-n</td>
<td align="center">字符串不为null,即长度不为零</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>①区别解析：</p>
<ul>
<li>==和=同义词，但==比较操作符在一个双中括号测试和一个单中括号测试意思不同</li>
<li>[[ <span><span class="MathJax_Preview">a == z* ]]    # 如果变量</span><script type="math/tex">a == z* ]]    # 如果变量</script></span>a以字符"z"开始(模式匹配)则为真</li>
<li>[[ <span><span class="MathJax_Preview">a == "z*" ]]  # 如果变量</span><script type="math/tex">a == "z*" ]]  # 如果变量</script></span>a与z*(字面上的匹配)相等则为真</li>
<li>[ $a == z* ]      # 文件扩展和单元分割有效</li>
<li>[ "<span><span class="MathJax_Preview">a" == "z*" ]  # 如果变量</span><script type="math/tex">a" == "z*" ]  # 如果变量</script></span>a与z*(字面上的匹配)相等则为真</li>
</ul>
<p>注意事项：</p>
<p>在方括号测试里，进行-n测试时必须把字符串用引号引起来，-z一般不引起来都能工作，但最好把测试字符串用引号括起来。如果$string
变量为空，此字符串变量引起来依然会报错，安全的方法是附加一个外部字符串给可能有空字符变量。如：</p>
<p>[ "x<span><span class="MathJax_Preview">string" != x -o "x</span><script type="math/tex">string" != x -o "x</script></span>a" = "x$b" ]（x字符可以互相抵消）</p>
<h4 id="_9">混合比较<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th align="center">表达式</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">-a</td>
<td align="center">逻辑与，如果exp1和exp2都为真，则exp1 -a exp2返回真</td>
</tr>
<tr>
<td align="center">-o</td>
<td align="center">逻辑或，只要exp1和exp2任何一个为真，则exp1 -o exp2返回真</td>
</tr>
</tbody>
</table>
<h4 id="_10">算术和字符串比较<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># a和b既能被看成是整数也能被看着是字符串。在字符串和数字之间不是严格界定的，bash变量是无类型的，Bash变量不是强类型的</span>
<span class="c1">#  Bash允许变量的整数操作和比较，但这些变量必须只包括数字字符,不管怎么样，应该小心考虑。例如：</span>
<span class="c1">#!/bin/bash</span>
<span class="c1"># 此例子中-ne和!=均能工作，以下是具体比较</span>
<span class="nv">a</span><span class="o">=</span><span class="m">4</span>
<span class="nv">b</span><span class="o">=</span><span class="m">5</span>

<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$a</span><span class="s2">&quot;</span> -ne <span class="s2">&quot;</span><span class="nv">$b</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$a</span><span class="s2"> 不等于 </span><span class="nv">$b</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;(整数比较)&quot;</span><span class="p">;</span> <span class="k">fi</span>   <span class="c1"># ab作为整数比较</span>
<span class="k">if</span> <span class="o">[[</span> <span class="s2">&quot;</span><span class="nv">$a</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$b</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$a</span><span class="s2"> 不等于 </span><span class="nv">$b</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;(字符串比较)&quot;</span><span class="p">;</span> <span class="k">fi</span>    <span class="c1"># ab作为字符串比较</span>

<span class="c1"># 测试一个字符串是否是null值</span>
<span class="c1">#!/bin/bash</span>

<span class="c1"># 用if [ ... ]结构,测试null字符串和没有用引号引起的字符串</span>
<span class="c1"># 如果一个字符串变量没有被初始化，它里面的值未定义。这种情况称为&quot;null&quot;值(不同于零)</span>

<span class="c1"># 第一次，$string1没有被声明或初始化</span>
<span class="k">if</span> <span class="o">[[</span> -n <span class="nv">$string1</span> <span class="o">]]</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is not null.&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is null.&quot;</span>
<span class="k">fi</span>
<span class="c1"># 错误结果.</span>
<span class="c1"># Shows $string1 as not null, although it was not initialized.</span>

<span class="c1"># 第二次, $string1变量被引号引起</span>
<span class="k">if</span> <span class="o">[[</span> -n <span class="s2">&quot;</span><span class="nv">$string1</span><span class="s2">&quot;</span> <span class="o">]]</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is not null.&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is null.&quot;</span>
<span class="k">fi</span>                    <span class="c1"># 在一个测试方括里用引号引起变量!</span>

<span class="c1"># 第三次,变量$string1什么也不加</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$string1</span> <span class="o">]]</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is not null.&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is null.&quot;</span>
<span class="k">fi</span>
<span class="c1"># 以上正常执行,[]测试运算符单独检测字符串是否为空,但用引号括起来&quot;$string1&quot;才是更好习惯</span>

<span class="nv">string1</span><span class="o">=</span>initialized

<span class="k">if</span> <span class="o">[</span> <span class="nv">$string1</span> <span class="o">]</span>       <span class="c1"># Again, $string1 stands naked.</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is not null.&quot;</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is null.&quot;</span>
<span class="k">fi</span>
<span class="c1"># 再次显示正确结果，然而更好仍然是用引号括起来，且看以下的列子</span>

<span class="nv">string1</span><span class="o">=</span><span class="s2">&quot;a = b&quot;</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$string1</span> <span class="o">]</span>       <span class="c1"># 没有用引号引起来</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is not null.&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;String \&quot;string1\&quot; is null.&quot;</span>
<span class="k">fi</span>
<span class="c1"># $string1没有引号显示出错误的结果</span>

<span class="c1">#!/bin/bash</span>
<span class="c1"># 用more命令查看被压缩过的文件</span>

<span class="nv">NOARGS</span><span class="o">=</span><span class="m">65</span>
<span class="nv">NOTFOUND</span><span class="o">=</span><span class="m">66</span>
<span class="nv">NOTGZIP</span><span class="o">=</span><span class="m">67</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$#</span> -eq <span class="m">0</span> <span class="o">]</span> <span class="c1"># 等同于:  if [ -z &quot;$1&quot; ]</span>
<span class="c1"># $1可以存在,但为空:  zmore &quot;&quot; arg2 arg3</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Usage: `basename </span><span class="nv">$0</span><span class="s2">` filename&quot;</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="c1"># 错误信息打印到标准错误.</span>
<span class="nb">exit</span> <span class="nv">$NOARGS</span>
<span class="c1"># 返回65作为脚本的退出状态(错误码).</span>
<span class="k">fi</span>

<span class="nv">filename</span><span class="o">=</span><span class="nv">$1</span>

<span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&quot;</span><span class="nv">$filename</span><span class="s2">&quot;</span> <span class="o">]</span>   <span class="c1"># Quoting $filename allows for possible ces.</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;File </span><span class="nv">$filename</span><span class="s2"> not found!&quot;</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="c1"># 错误信息打印到标准错误.</span>
<span class="nb">exit</span> <span class="nv">$NOTFOUND</span>
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">filename</span><span class="p">##*.</span><span class="si">}</span> !<span class="o">=</span> <span class="s2">&quot;gz&quot;</span> <span class="o">]</span>
<span class="c1"># 在方括号里使用变量替换.</span>
    <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;File </span><span class="nv">$1</span><span class="s2"> is not a gzipped file!&quot;</span>
<span class="nb">exit</span> <span class="nv">$NOTGZIP</span>
<span class="k">fi</span>

zcat <span class="nv">$1</span> <span class="p">|</span> more  <span class="c1"># 用过滤程序more,也可以用less代替</span>

<span class="nb">exit</span> <span class="nv">$?</span>   <span class="c1"># 脚本返回管道的退出状态,实际上&quot;exit $?&quot;是多余的,因为在任何情况下，脚本会返回最后一个执行命令的退出码</span>
</code></pre></div>
<h3 id="_11">位操作符<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>很少在脚本中使用，主要用于操作和测试从端口或sockets中读取的数据，位运算多用于编译型语言，如C、C++语言</p>
<table>
<thead>
<tr>
<th align="center">表达式</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">&lt;&lt;</td>
<td align="center">左位移，每移一位相当于乘以2</td>
</tr>
<tr>
<td align="center">&lt;&lt;=</td>
<td align="center">左位移赋值,如：let "var &lt;&lt;=2" 时var变量二进制值左移两位，相当于乘以4</td>
</tr>
<tr>
<td align="center">&gt;&gt;</td>
<td align="center">右位移，每移一位相当除以2</td>
</tr>
<tr>
<td align="center">&gt;&gt;=</td>
<td align="center">右位移赋值</td>
</tr>
<tr>
<td align="center">&amp;</td>
<td align="center">位与</td>
</tr>
<tr>
<td align="center">&amp;=</td>
<td align="center">位与赋值</td>
</tr>
<tr>
<td align="center">|</td>
<td align="center">位或</td>
</tr>
<tr>
<td align="center">|=</td>
<td align="center">位或赋值</td>
</tr>
<tr>
<td align="center">~</td>
<td align="center">位反</td>
</tr>
<tr>
<td align="center">!</td>
<td align="center">位非</td>
</tr>
<tr>
<td align="center">^</td>
<td align="center">位或</td>
</tr>
<tr>
<td align="center">^=</td>
<td align="center">位或赋值</td>
</tr>
</tbody>
</table>
<h3 id="_12">数字常量<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>除非一个数字有特别的前缀或符号，否则shell脚本把它当成十进制的数。一个前缀为0的数字是八进制数。一个前缀为0x的数字是十六
进制数。一个数用内嵌的#来求值则看成BASE#NUMBER(有范围和符号限制)(译者注：BASE#NUMBER即：基数#数值，参考下面的例子)</p>
<div class="highlight"><pre><span></span><code><span class="c1">#数字常量的表示法</span>
<span class="c1">#!/bin/bash</span>
<span class="c1"># numbers.sh: 不同基数的数字表示法.</span>

<span class="c1"># 十进制数: 它是默认的</span>
<span class="nb">let</span> <span class="s2">&quot;dec = 32&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;decimal number = </span><span class="nv">$dec</span><span class="s2">&quot;</span>             <span class="c1"># 32</span>

<span class="c1"># 八进制数: 以&#39;0&#39;(零)为前缀</span>
<span class="nb">let</span> <span class="s2">&quot;oct = 032&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;octal number = </span><span class="nv">$oct</span><span class="s2">&quot;</span>               <span class="c1"># 26,结果表示为十进制.</span>

<span class="c1"># 十六进制: 以&#39;0x&#39;或&#39;0X&#39;为前缀</span>
<span class="nb">let</span> <span class="s2">&quot;hex = 0x32&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;hexadecimal number = </span><span class="nv">$hex</span><span class="s2">&quot;</span>         <span class="c1"># 50,以十进制的形式表示.</span>

<span class="c1"># 其他的进制的表示形式: BASE#NUMBER</span>
<span class="c1"># BASE值在2和64之间.</span>
<span class="c1"># NUMBER必须使用在BASE范围内的符号,看下面的示例.</span>

<span class="nb">let</span> <span class="s2">&quot;bin = 2#111100111001101&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;binary number = </span><span class="nv">$bin</span><span class="s2">&quot;</span>              <span class="c1"># 31181</span>
<span class="nb">let</span> <span class="s2">&quot;b32 = 32#77&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;base-32 number = </span><span class="nv">$b32</span><span class="s2">&quot;</span>             <span class="c1"># 231</span>
<span class="nb">let</span> <span class="s2">&quot;b64 = 64#@_&quot;</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&quot;base-64 number = </span><span class="nv">$b64</span><span class="s2">&quot;</span>             <span class="c1"># 4031</span>
<span class="c1"># 这个符号只能工作在ASCII码值为2-64的范围限制.</span>
<span class="c1"># 10个数字+26个小写字母+26个大写字母+ @ + _</span>

<span class="nb">echo</span> <span class="k">$((</span><span class="m">36#</span>zz<span class="k">))</span> <span class="k">$((</span><span class="m">2#10101010</span><span class="k">))</span> <span class="k">$((</span><span class="m">16#</span>AF16<span class="k">))</span> <span class="k">$((</span><span class="m">53#1</span>aA<span class="k">))</span>    <span class="c1"># 1295 170 44822 3375</span>

<span class="c1">#  提示：使用一个超出给定进制的数字将会引起一个错误信息，例如：</span>
<span class="nb">let</span> <span class="s2">&quot;bad_oct = 081&quot;</span>     <span class="c1"># 此例子会发生错误，因为八进制数字只能使用数字0-7.</span>
</code></pre></div>
<h2 id="_13">变量访问<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<h3 id="_14">变量间接引用<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nv">a</span><span class="o">=</span>b
<span class="nv">b</span><span class="o">=</span>c
<span class="nb">echo</span> <span class="s2">&quot;a=</span><span class="nv">$a</span><span class="s2">&quot;</span> <span class="c1"># a=1 直接引用</span>
<span class="nb">echo</span> <span class="s2">&quot;a=\$</span><span class="nv">$a</span><span class="s2">&quot;</span>   <span class="c1"># a=c   间接引用</span>
</code></pre></div>
<h3 id="random">$RANDOM随机整数<a class="headerlink" href="#random" title="Permanent link">&para;</a></h3>
<p>$RANDOM是Bash的一个返回伪随机[1]整数(范围为0-32767)的内部函数(而不是一个常量或变量)，不应该用于产生加密的密钥</p>
<h2 id="_15">循环与分支<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<p>循环控制：break命令将会跳出循环,continue命令将会跳过本次循环下边的语句,直接进入下次循环</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span> i <span class="k">in</span> <span class="o">{</span><span class="m">1</span>..100<span class="o">}</span>
<span class="k">do</span>
  <span class="nb">echo</span> <span class="s2">&quot;自增计数循环示例---</span><span class="nv">$i</span><span class="s2">&quot;</span>
<span class="k">done</span>
</code></pre></div>
<h2 id="_16">定义一个颜色输出字符串函数<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># function关键字定义一个函数，可加或不加</span>
方法一：
<span class="k">function</span> echo_color<span class="o">(){</span>
 <span class="k">if</span> <span class="o">[</span><span class="nv">$1</span> <span class="o">==</span> <span class="s2">&quot;green&quot;</span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\033[32;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
 <span class="k">elif</span> <span class="o">[</span><span class="nv">$1</span> <span class="o">==</span> <span class="s2">&quot;red&quot;</span><span class="m">0</span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\\033[31;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
 <span class="k">fi</span>
<span class="o">}</span>

方法二：
<span class="k">function</span> echo_color<span class="o">(){</span>
 <span class="k">case</span> <span class="nv">$1</span> <span class="k">in</span>
  green<span class="o">)</span>
   <span class="nb">echo</span> -e <span class="s2">&quot;\033[32;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
   <span class="p">;;</span>
  red<span class="o">)</span>
   <span class="nb">echo</span> -e <span class="s2">&quot;\033[31;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
   <span class="p">;;</span>
  *<span class="o">)</span>
   <span class="nb">echo</span> <span class="s2">&quot;Example:echo_color red string&quot;</span>
  <span class="k">esac</span>
<span class="o">}</span>
</code></pre></div>
<h2 id="_17">批量创建用户<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date+%F_%T<span class="k">)</span>
<span class="nv">USER_FILE</span><span class="o">=</span>user.txt
echo_color<span class="o">(){</span>
 <span class="k">if</span> <span class="o">[</span><span class="nv">$1</span> <span class="o">==</span> <span class="s2">&quot;green&quot;</span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\033[32;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
 <span class="k">elif</span> <span class="o">[</span><span class="nv">$1</span> <span class="o">==</span> <span class="s2">&quot;red&quot;</span><span class="m">0</span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;\\033[31;40m</span><span class="nv">$2</span><span class="s2">\033[0m&quot;</span>
 <span class="k">fi</span>
<span class="o">}</span>
<span class="c1"># 如果用户文件存在并大于0就备份</span>
 <span class="k">if</span> <span class="o">[</span>-s <span class="nv">$USER_FILE</span><span class="o">]</span><span class="p">;</span><span class="k">then</span>
  mv <span class="nv">$USER_FILE</span> <span class="si">${</span><span class="nv">USER_FILE</span><span class="si">}</span>-<span class="si">${</span><span class="nv">DATE</span><span class="si">}</span>.bak
  echo_color green <span class="s2">&quot;</span><span class="nv">$USER_FILE</span><span class="s2"> exist,rename </span><span class="si">${</span><span class="nv">USER_FILE</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">DATE</span><span class="si">}</span><span class="s2">.bak&quot;</span>
 <span class="k">fi</span>
 <span class="nb">echo</span>
</code></pre></div>
<h2 id="_18">创建特定大小的文件<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># 创建10M大小的daygeek.txt文件</span>
fallocate -l 10M daygeek.txt
truncate -s 10M daygeek1.txt
head -c 10MB /dev/zero &gt; daygeek4.txt

dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>daygeek2.txt  <span class="nv">bs</span><span class="o">=</span>10M  <span class="nv">count</span><span class="o">=</span><span class="m">1</span>
或
dd <span class="k">if</span><span class="o">=</span>/dev/zero <span class="nv">of</span><span class="o">=</span>daygeek3.txt  <span class="nv">bs</span><span class="o">=</span>1M  <span class="nv">count</span><span class="o">=</span><span class="m">10</span>
</code></pre></div>
<h2 id="shellcpu">shell采集系统cpu 内存 磁盘 网络信息<a class="headerlink" href="#shellcpu" title="Permanent link">&para;</a></h2>
<h3 id="cpu">cpu信息采集<a class="headerlink" href="#cpu" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># cpu使用率采集算法;通过/proc/stat文件采集并计算CPU总使用率或者单个核使用率。以cpu0为例，算法如下：</span>
: <span class="s">&lt;&lt; comment</span>
<span class="s">cat /proc/stat | grep ‘cpu0’ # 得到cpu0的信息</span>
<span class="s">cpuTotal1=user+nice+system+idle+iowait+irq+softirq</span>
<span class="s">cpuUsed1=user+nice+system+irq+softirq</span>
<span class="s">sleep 30秒</span>
<span class="s"># 再次cat /proc/stat | grep ‘cpu0’ 得到cpu的信息</span>
<span class="s">cpuTotal2=user+nice+system+idle+iowait+irq+softirq</span>
<span class="s">cpuUsed2=user+nice+system+irq+softirq</span>
<span class="s"># 得到cpu0 在30秒内的单核利用率：(cpuUsed2 – cpuUsed1) * 100 / (cpuTotal2 – cpuTotal1)</span>
<span class="s"># 相当于使用top –d 30命令，把user、nice、system、irq、softirq五项的使用率相加</span>
<span class="s">comment</span>

<span class="nv">a</span><span class="o">=(</span><span class="sb">`</span>cat /proc/stat <span class="p">|</span> grep -E <span class="s2">&quot;cpu\b&quot;</span> <span class="p">|</span> awk -v <span class="nv">total</span><span class="o">=</span><span class="m">0</span> <span class="se">\</span>
<span class="s1">&#39;{$1=&quot;&quot;;for(i=2;i&lt;=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }END{print total,used}&#39;</span><span class="sb">`</span><span class="o">)</span>
sleep <span class="m">30</span>
<span class="nv">b</span><span class="o">=(</span><span class="sb">`</span>cat /proc/stat <span class="p">|</span> grep -E <span class="s2">&quot;cpu\b&quot;</span> <span class="p">|</span> awk -v <span class="nv">total</span><span class="o">=</span><span class="m">0</span> <span class="s1">&#39;{$1=&quot;&quot;;for(i=2;i&lt;=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }\</span>
<span class="s1">END{print total,used}&#39;</span><span class="sb">`</span><span class="o">)</span>
<span class="nv">cpu_usage</span><span class="o">=(((</span><span class="si">${</span><span class="nv">b</span><span class="p">[1]</span><span class="si">}</span>-<span class="si">${</span><span class="nv">a</span><span class="p">[1]</span><span class="si">}</span><span class="o">)</span>*100<span class="o">)</span>/<span class="o">(</span><span class="si">${</span><span class="nv">b</span><span class="p">[0]</span><span class="si">}</span>-<span class="si">${</span><span class="nv">a</span><span class="p">[0]</span><span class="si">}</span><span class="o">)))</span>  <span class="c1"># 此处语法有问题，暂未修复</span>

<span class="c1"># cpu负载采集算法：读取/proc/loadavg得到机器的1/5/15分钟平均负载，再乘以100</span>

<span class="nv">cpuload</span><span class="o">=(</span><span class="sb">`</span>cat /proc/loadavg <span class="p">|</span> awk <span class="s1">&#39;{print $1,$2,$3}&#39;</span><span class="sb">`</span><span class="o">)</span>
<span class="nv">load1</span><span class="o">=</span><span class="si">${</span><span class="nv">cpuload</span><span class="p">[0]</span><span class="si">}</span>
<span class="nv">load5</span><span class="o">=</span><span class="si">${</span><span class="nv">cpuload</span><span class="p">[1]</span><span class="si">}</span>
<span class="nv">load15</span><span class="o">=</span><span class="si">${</span><span class="nv">cpuload</span><span class="p">[2]</span><span class="si">}</span>
</code></pre></div>
<h3 id="_19">内存采集<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 应用程序使用内存采集算法：读取/proc/meminfo文件，(MemTotal – MemFree – Buffers – Cached)/1024得到应用程序使用内存数</span>

awk <span class="s1">&#39;/MemTotal/{total=$2}/MemFree/{free=$2}/Buffers/{buffers=$2}/^Cached/{cached=$2}END\</span>
<span class="s1">{print (total-free-buffers-cached)/1024}&#39;</span>  /proc/meminfo

<span class="c1"># MEM使用量采集算法：读取/proc/meminfo文件，MemTotal – MemFree得到MEM使用量</span>

awk <span class="s1">&#39;/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/1024}&#39;</span>  /proc/meminfo

<span class="c1"># SWAP使用大小采集算法：通过/proc/meminfo文件，SwapTotal – SwapFree得到SWAP使用大小</span>

awk <span class="s1">&#39;/SwapTotal/{total=$2}/SwapFree/{free=$2}END{print (total-free)/1024}&#39;</span>  /proc/meminfo
</code></pre></div>
<h3 id="_20">磁盘信息采集<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 磁盘I/O</span>
<span class="c1"># IN：平均每秒把数据从硬盘读到物理内存的数据量</span>
<span class="c1"># 采集算法：读取/proc/vmstat文件得出最近240秒内pgpgin的增量，把pgpgin的增量再除以240得到每秒的平均增量</span>
<span class="c1"># 相当于vmstat 240命令bi一列的输出</span>

<span class="nv">a</span><span class="o">=</span><span class="sb">`</span>awk <span class="s1">&#39;/pgpgin/{print $2}&#39;</span> /proc/vmstat<span class="sb">`</span>
<span class="c1">#sleep 240</span>
<span class="nv">b</span><span class="o">=</span><span class="sb">`</span>awk <span class="s1">&#39;/pgpgin/{print $2}&#39;</span> /proc/vmstat<span class="sb">`</span>
<span class="nv">ioin</span><span class="o">=</span><span class="k">$((</span>b-a<span class="o">)/</span><span class="m">240</span><span class="k">))</span>

<span class="c1"># OUT：平均每秒把数据从物理内存写到硬盘的数据量</span>
<span class="c1"># 采集算法：读取/proc/vmstat文件得出最近240秒内pgpgout的增量，把pgpgout的增量再除以240得到每秒的平均增量</span>
<span class="c1"># 相当于vmstat 240命令bo一列的输出</span>

<span class="nv">a</span><span class="o">=</span><span class="sb">`</span>awk <span class="s1">&#39;/pgpgout/{print $2}&#39;</span> /proc/vmstat<span class="sb">`</span>
sleep <span class="m">240</span>
<span class="nv">b</span><span class="o">=</span><span class="sb">`</span>awk <span class="s1">&#39;/pgpgout/{print $2}&#39;</span> /proc/vmstat<span class="sb">`</span>
<span class="nv">ioout</span><span class="o">=</span><span class="k">$((</span><span class="o">(</span>b-a<span class="o">)/</span><span class="m">240</span><span class="k">))</span>
</code></pre></div>
<h3 id="_21">网络信息采集<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># 流量:以https://www.centos.bz/为例，eth0是内网，eth1外网，获取60秒的流量</span>
<span class="c1"># 机器网卡的平均每秒流量</span>
<span class="c1"># 采集算法：读取/proc/net/dev文件，得到60秒内发送和接收的字节数（KB），然后乘以8，再除以60，得到每秒的平均流量</span>

<span class="nv">traffic_be</span><span class="o">=(</span><span class="sb">`</span>awk -F<span class="s1">&#39;[: ]+&#39;</span> <span class="s1">&#39;BEGIN{ORS=&quot; &quot;}/eth0/{print $3,$10}/eth1/{print $3,$11}&#39;</span> /proc/net/dev<span class="sb">`</span><span class="o">)</span>
sleep <span class="m">60</span>
<span class="nv">traffic_af</span><span class="o">=(</span><span class="sb">`</span>awk -F<span class="s1">&#39;[: ]+&#39;</span> <span class="s1">&#39;BEGIN{ORS=&quot; &quot;}/eth0/{print $3,$10}/eth1/{print $3,$11}&#39;</span> /proc/net/dev<span class="sb">`</span><span class="o">)</span>
<span class="nv">eth0_in</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">traffic_af</span><span class="p">[0]</span><span class="si">}</span><span class="o">-</span><span class="si">${</span><span class="nv">traffic_be</span><span class="p">[0]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth0_out</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">traffic_af</span><span class="p">[1]</span><span class="si">}</span><span class="o">-</span><span class="si">${</span><span class="nv">traffic_be</span><span class="p">[1]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth1_in</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">traffic_af</span><span class="p">[2]</span><span class="si">}</span><span class="o">-</span><span class="si">${</span><span class="nv">traffic_be</span><span class="p">[2]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth1_out</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">traffic_af</span><span class="p">[3]</span><span class="si">}</span><span class="o">-</span><span class="si">${</span><span class="nv">traffic_be</span><span class="p">[3]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>

<span class="c1"># 数据包量：机器网卡的平均每秒包量</span>
<span class="c1"># 采集算法：读取/proc/net/dev文件，得到60秒内发送和接收的包量，然后除以60，得到每秒的平均包量</span>

<span class="nv">packet_be</span><span class="o">=(</span><span class="sb">`</span>awk -F<span class="s1">&#39;[: ]+&#39;</span> <span class="s1">&#39;BEGIN{ORS=&quot; &quot;}/eth0/{print $4,$12}/eth1/{print $4,$12}&#39;</span> /proc/net/dev<span class="sb">`</span><span class="o">)</span>
sleep <span class="m">60</span>
<span class="nv">packet_af</span><span class="o">=(</span><span class="sb">`</span>awk -F<span class="s1">&#39;[: ]+&#39;</span> <span class="s1">&#39;BEGIN{ORS=&quot; &quot;}/eth0/{print $4,$12}/eth1/{print $4,$12}&#39;</span> /proc/net/dev<span class="sb">`</span><span class="o">)</span>
<span class="nv">eth0_in</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">packet_af</span><span class="p">[0]</span><span class="si">}</span><span class="o">-</span><span class="si">${</span><span class="nv">packet_be</span><span class="p">[0]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth0_out</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">packet_af</span><span class="p">[1]</span><span class="si">}</span><span class="o">-</span> <span class="si">${</span><span class="nv">packet_be</span><span class="p">[1]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth1_in</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">packet_af</span><span class="p">[2]</span><span class="si">}</span><span class="o">-</span> <span class="si">${</span><span class="nv">packet_be</span><span class="p">[2]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
<span class="nv">eth1_out</span><span class="o">=</span><span class="k">$((</span> <span class="o">(</span><span class="si">${</span><span class="nv">packet_af</span><span class="p">[3]</span><span class="si">}</span><span class="o">-</span> <span class="si">${</span><span class="nv">packet_be</span><span class="p">[3]</span><span class="si">}</span><span class="o">)/</span><span class="m">60</span> <span class="k">))</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../Regex/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              Regex
            </div>
          </div>
        </a>
      
      
        <a href="../Python3/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              Python3
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/Black-Gold" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.instagram.com/black0gold/" target="_blank" rel="noopener" title="www.instagram.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "search.suggest"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": {"default": "stable"}}</script>
    
    
      <script src="../assets/javascripts/bundle.65ce87ac.min.js"></script>
      
    
  </body>
</html>