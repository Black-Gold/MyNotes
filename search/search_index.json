{"config":{"lang":["en","zh"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"Welcome to MyWebSite","text":""},{"location":"#devops-wiki","title":"DevOps Wiki","text":""},{"location":"reference-example/","title":"mkdocs-material\u8bed\u6cd5\u4e2d\u6587\u793a\u4f8b\u53c2\u8003","text":"<p>\u82f1\u6587\u539f\u6587\u53c2\u8003\u94fe\u63a5 \u6b64\u9875\u9762\u76ee\u7684\u662f\u76f4\u63a5\u663e\u793a\u5177\u4f53\u6548\u679c\uff0c\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u9700\u8981\u6253\u5f00\u6e90\u6587\u4ef6\u53c2\u8003\u3002</p>"},{"location":"reference-example/#icons-emojis","title":"Icons, Emojis","text":"<p>\u641c\u7d22icons, emojis\u94fe\u63a5 </p>"},{"location":"reference-example/#note","title":"\u8b66\u544anote","text":"<p>\u652f\u6301\u7684\u8b66\u544a\u7c7b\u578b\u6709: <code>note</code>,<code>abstract</code>,<code>info</code>,<code>tip</code>,<code>success</code>,<code>question</code>,<code>warning</code>,<code>failure</code>,<code>danger</code>,<code>bug</code>,<code>example</code>,<code>quote</code></p> <p>\u8b66\u544a\u793a\u4f8b1: \u8b66\u544a\u9075\u5faa\u4e00\u4e2a\u7b80\u5355\u7684\u8bed\u6cd5\uff1a\u4e00\u4e2a\u5757\u4ee5<code>!!!</code>\u5f00\u59cb\uff0c\u540e\u9762\u8ddf\u7740\u4e00\u4e2a\u4f5c\u4e3a\u8b66\u544a\u7c7b\u578b\u9650\u5b9a\u7b26\u7684\u5173\u952e\u5b57\uff0c\u5757\u7684\u5185\u5bb9\u5728\u4e0b\u4e00\u884c\uff0c\u7f29\u8fdb\u56db\u4e2a\u7a7a\u683c</p> <p>Note</p> <p>\u6b64\u9875\u9762\u76ee\u7684\u662f\u76f4\u63a5\u663e\u793a\u5177\u4f53\u6548\u679c\uff0c\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u9700\u8981\u6253\u5f00\u6e90\u6587\u4ef6\u53c2\u8003\u3002</p> <p>Quote</p> <p>\u6b64\u9875\u9762\u76ee\u7684\u662f\u76f4\u63a5\u663e\u793a\u5177\u4f53\u6548\u679c\uff0c\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u9700\u8981\u6253\u5f00\u6e90\u6587\u4ef6\u53c2\u8003\u3002</p> <p>\u8b66\u544a\u793a\u4f8b2: \u81ea\u5b9a\u4e49\u8b66\u544a\u6807\u9898</p> <p>\u5e26\u81ea\u5b9a\u4e49\u6807\u9898\u7684\u8b66\u544a</p> <p>\u6b64\u9875\u9762\u76ee\u7684\u662f\u76f4\u63a5\u663e\u793a\u5177\u4f53\u6548\u679c\uff0c\u5177\u4f53\u5982\u4f55\u4f7f\u7528\u9700\u8981\u6253\u5f00\u6e90\u6587\u4ef6\u53c2\u8003\u3002</p> <p>\u8b66\u544a\u793a\u4f8b2: \u65e0\u56fe\u6807\u548c\u6807\u9898\u7684\u8b66\u544a\uff0c\u6ce8\u610f\u8fd9\u4e0d\u9002\u7528\u4e8e\u6298\u53e0\u5757</p> <p>\u65e0\u56fe\u6807\u548c\u6807\u9898\u7684warning\u8b66\u544a\uff0c\u6ce8\u610f\u65e0\u6807\u9898\u8b66\u544a\u4e0d\u80fd\u7528\u4e8e\u6298\u53e0\u5757</p> <p>\u8b66\u544a\u793a\u4f8b3: \u53ef\u6298\u53e0\u8b66\u544a</p> Tip <p>\u5f53\u542f\u7528<code>Details</code>\u5e76\u4e14\u8b66\u544a\u5757\u4ee5<code>???</code>\u800c\u4e0d\u662f<code>!!!</code>\u5f00\u59cb\u65f6\uff0c\u8b66\u544a\u5757\u88ab\u6e32\u67d3\u4e3a\u53ef\u6298\u53e0\u4e14\u521d\u59cb\u6536\u8d77</p> Success <p><code>???</code>\u540e\u6dfb\u52a0\u4e00\u4e2a<code>+</code>\u7b26\u53f7\uff0c\u8b66\u544a\u5757\u88ab\u6e32\u67d3\u4e3a\u53ef\u6298\u53e0\u4e14\u521d\u59cb\u5c55\u5f00</p> <p>\u8b66\u544a\u793a\u4f8b4: \u8b66\u544a\u4e5f\u53ef\u4ee5\u88ab\u6e32\u67d3\u4e3a\u5185\u8054\u5757(\u4f8b\u5982\uff0c\u7528\u4e8e\u8fb9\u680f)\uff0c\u4f7f\u7528 <code>inline end</code> \u4fee\u9970\u7b26\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7\uff0c\u6216\u8005\u4f7f\u7528 <code>inline</code> \u4fee\u9970\u7b26\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7</p> <p>\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7</p> <p>\u4f7f\u7528 <code>inline end</code> \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7 [left for rtl languages \u4ece\u53f3\u5f80\u5de6\u4e66\u5199\u9605\u8bfb\u7684\u8bed\u8a00\uff0c\u5982\u963f\u62c9\u4f2f\u8bed]</p> inline end \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7<pre><code>!!! info inline end \"\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7\"\n    \u4f7f\u7528 `inline end` \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u53f3\u4fa7\n    [left for rtl languages\n    \u4ece\u53f3\u5f80\u5de6\u4e66\u5199\u9605\u8bfb\u7684\u8bed\u8a00\uff0c\u5982\u963f\u62c9\u4f2f\u8bed]\n</code></pre> <p>\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7</p> <p>\u4f7f\u7528 <code>inline</code> \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7 [right for rtl languages \u4ece\u53f3\u5f80\u5de6\u4e66\u5199\u9605\u8bfb\u7684\u8bed\u8a00\uff0c\u5982\u963f\u62c9\u4f2f\u8bed]</p> inline \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7<pre><code>!!! info inline \"\u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7\"\n    \u4f7f\u7528 `inline` \u5c06\u8b66\u544a\u653e\u7f6e\u5728\u5de6\u4fa7\n    [right for rtl languages\n    \u4ece\u53f3\u5f80\u5de6\u4e66\u5199\u9605\u8bfb\u7684\u8bed\u8a00\uff0c\u5982\u963f\u62c9\u4f2f\u8bed]\n</code></pre>"},{"location":"reference-example/#_1","title":"\u6ce8\u91ca","text":"<p>\u6ce8\u91ca\u793a\u4f8b1: \u6ce8\u91ca\u5fc5\u987b\u4ece\u6570\u5b571\u5f00\u59cb\uff0c\u4e14\u6b63\u6587\u548c\u6ce8\u91ca\u4e2d\u95f4\u987b\u6709\u4e00\u884c\u7a7a\u884c (1)</p> <ol> <li> \u6211\u662f\u4e00\u4e2a\u6ce8\u91ca\uff01\u6211\u53ef\u4ee5\u5305\u542b<code>code</code>\u3001\u683c\u5f0f\u5316\u7684\u6587\u672c\u3001     \u56fe\u50cf...\u57fa\u672c\u4e0a\u4efb\u4f55\u53ef\u4ee5\u7528Markdown\u8868\u8fbe\u7684\u4e1c\u897f\u3002</li> </ol> <p>\u6ce8\u91ca\u793a\u4f8b2: \u5d4c\u5957\u5f0f\u6ce8\u91ca\uff0c\u7b2c\u4e8c\u4e2a\u6ce8\u91ca\u8981\u548c\u7b2c\u4e00\u4e2a\u6ce8\u91ca\u4e2d\u95f4\u7a7a\u4e00\u884c (1)</p> <ol> <li> <p> \u6211\u662f\u7b2c\u4e00\u4e2a\u6ce8\u91ca! (1)</p> <ol> <li> \u6211\u662f\u7b2c\u4e8c\u4e2a\u6ce8\u91ca!</li> </ol> </li> </ol> <p>\u6ce8\u91ca\u793a\u4f8b3: \u5185\u5bb9\u9009\u578b\u5361\u4e2d\u6dfb\u52a0\u6ce8\u91ca</p> \u5185\u5bb9\u9009\u578b\u5361 1\u5185\u5bb9\u9009\u578b\u5361 2 <p>\u5185\u5bb9\u9009\u578b\u53611\u4e2d\u5185\u5bb9\u7684\u6ce8\u91ca (1)</p> <ol> <li> \u9009\u9879\u53611\u5185\u5bb9\u6ce8\u91ca!</li> </ol> <p>\u5185\u5bb9\u9009\u578b\u53612\u4e2d\u5185\u5bb9\u7684\u6ce8\u91ca (1)</p> <ol> <li> \u9009\u9879\u53612\u5185\u5bb9\u6ce8\u91ca!</li> </ol> <p>\u6ce8\u91ca\u793a\u4f8b4: \u8b66\u544a\u7684\u6807\u9898\u548c\u5185\u5bb9\u4e5f\u53ef\u4ee5\u627f\u8f7d\u6ce8\u91ca\uff0c\u53ea\u9700\u5728\u7c7b\u578b\u9650\u5b9a\u7b26\u540e\u9762\u6dfb\u52a0<code>annotate</code>\u4fee\u9970\u7b26\uff0c\u8fd9\u548cinline block\u7684\u5de5\u4f5c\u539f\u7406\u7c7b\u4f3c\uff1a</p> <p>\u8b66\u544a\u7684\u6807\u9898\u6dfb\u52a0\u6ce8\u91ca\u793a\u4f8b: (1)</p> <p>\u8b66\u544a\u7684\u5185\u5bb9\u6dfb\u52a0\u6ce8\u91ca\u793a\u4f8b, (2) \u6b64\u5904\u5747\u4e3a\u8b66\u544a\u5185\u5bb9</p> <ol> <li> \u6211\u662f\u8b66\u544a\u6807\u9898\u7684\u6ce8\u91ca!</li> <li> \u6211\u662f\u8b66\u544a\u5185\u5bb9\u7684\u6ce8\u91ca!</li> </ol>"},{"location":"reference-example/#_2","title":"\u6309\u94ae","text":"<p>\u6309\u94ae\u793a\u4f8b1: \u94fe\u63a5\u4f5c\u4e3a\u4e00\u4e2a\u6309\u94ae\u663e\u793a\uff0c\u540e\u7f00\u52a0\u4e0a\u5927\u62ec\u53f7\u5e76\u6dfb\u52a0<code>.md-button</code>\u7c7b\u9009\u62e9\u5668\u5373\u53ef\uff0c\u6309\u94ae\u989c\u8272\u7ee7\u627f\u4e8emkdocs.yml\u7684primary color\u548caccent color</p> <p>\u8bbf\u95ee\u6b64\u7f51\u7ad9</p> <p>\u8bbf\u95ee\u6b64\u7f51\u7ad9</p> <p>\u6309\u94ae\u793a\u4f8b2: \u5e26\u56fe\u6807\u7684\u6309\u94ae</p> <p>\u8bbf\u95ee\u6211\u7684GitHub  </p>"},{"location":"reference-example/#_3","title":"\u4ee3\u7801\u5757","text":"<p>\u4ee3\u7801\u5757\u793a\u4f8b1: \u5e26\u6709\u6807\u9898\u7684\u4ee3\u7801\u5757</p> bubble_sort.py<pre><code>def bubble_sort(items):\n    for i in range(len(items)):\n        for j in range(len(items) - 1 - i):\n            if items[j] &gt; items[j + 1]:\n                items[j], items[j + 1] = items[j + 1], items[j]\n</code></pre> <p>\u4ee3\u7801\u5757\u793a\u4f8b2: \u5982\u679c\u4f60\u60f3\u53bb\u6389\u4ee3\u7801\u6ce8\u91ca\u5468\u56f4\u7684\u6ce8\u91ca\u5b57\u7b26\uff0c\u53ea\u9700\u5728\u4ee3\u7801\u6ce8\u91ca\u7684\u53f3\u62ec\u53f7\u540e\u9762\u52a0\u4e0a<code>!</code>\u611f\u53f9\u53f7\u5373\u53ef 99TimesTable.sh<pre><code># \u5229\u7528bash\u7684for\u5faa\u73af\u751f\u621099\u4e58\u6cd5\u8868 (1)\n# \u5229\u7528bash\u7684for\u5faa\u73af\u751f\u621099\u4e58\u6cd5\u8868 (2)!\n#!/bin/bash\nfor i in {1..9}\ndo\n    for ((j=1; j&lt;=i; j++))\n    do\n        product=$((i*j))\n        printf \"%d*%d=%d \" \"$j\" \"$i\" \"$product\"\n    done\n    printf \"\\n\"\ndone\n</code></pre></p> <ol> <li> \u672a\u53bb\u6389\u4ee3\u7801\u4e2d\u6ce8\u91ca\u5b57\u7b26\u7684\u6ce8\u91ca\u793a\u4f8b!\u6b64\u65f6\u53ef\u4ee5\u770b\u5230<code>#</code>\u6ce8\u91ca\u5b57\u7b26\u548c\u5185\u5bb9</li> <li> \u53bb\u6389\u4ee3\u7801\u4e2d\u6ce8\u91ca\u5b57\u7b26\u7684\u6ce8\u91ca\u793a\u4f8b!\u6b64\u65f6\u5df2\u770b\u4e0d\u5230<code>#</code>\u6ce8\u91ca\u5b57\u7b26\u548c\u5185\u5bb9</li> </ol> <p>\u4ee3\u7801\u5757\u793a\u4f8b3: \u5e26\u884c\u53f7\u7684\u4ee3\u7801\u5757,\u5e76\u9ad8\u4eae\u7b2c6\u884c 99TimesTable.sh<pre><code># \u5229\u7528bash\u7684while\u5faa\u73af\u751f\u621099\u4e58\u6cd5\u8868\ni=1\nwhile [ $i -le 9 ]\ndo\n    j=1\n    while [ $j -le $i ]\n    do\n        product=$((i*j))\n        echo -n \"$j*$i=$product \"\n        j=$((j+1))\n    done\n    echo\n    i=$((i+1))\ndone\n</code></pre></p> <p>\u4ee3\u7801\u5757\u793a\u4f8b4: \u9ad8\u4eae\u591a\u884c</p> \u9ad8\u4eae\u4e0d\u8fde\u7eed\u591a\u884c\u9ad8\u4eae\u8fde\u7eed\u591a\u884c Python<pre><code>def bubble_sort(items):\n    for i in range(len(items)):\n        for j in range(len(items) - 1 - i):\n            if items[j] &gt; items[j + 1]:\n                items[j], items[j + 1] = items[j + 1], items[j]\n</code></pre> Python<pre><code>def bubble_sort(items):\n    for i in range(len(items)):\n        for j in range(len(items) - 1 - i):\n            if items[j] &gt; items[j + 1]:\n                items[j], items[j + 1] = items[j + 1], items[j]\n</code></pre> <p>\u4ee3\u7801\u5757\u793a\u4f8b5: \u9ad8\u4eae\u5185\u8054\u4ee3\u7801\u5757\uff0c\u6dfb\u52a0\u4e00\u4e2ashebang\u524d\u7f00\u52a0\u5bf9\u5e94\u8bed\u8a00\u7f29\u5199</p> <p>shebang\u524d\u7f00\u793a\u4f8b: <code>#!python</code>\uff0c<code>#!c++</code>\uff0c<code>#!csharp</code>\uff0c<code>#!cpp</code>\uff0c<code>#!js</code>\uff0c<code>#!javascript</code>\uff0c<code>#!ts</code>\uff0c<code>#!typescript</code>\uff0c<code>#!php</code>\uff0c<code>#!go</code>\uff0c<code>#!java</code>\uff0c<code>#!ruby</code>\uff0c<code>#!swift</code>\uff0c<code>#!scala</code>\uff0c<code>#!kotlin</code>\uff0c<code>#!rust</code>\uff0c<code>#!scala</code>\uff0c<code>#!gro</code></p> <p><code>range()</code> \u7528\u4e8e\u751f\u6210\u6570\u5b57\u5e8f\u5217</p> <p>\u4ee3\u7801\u5757\u793a\u4f8b6: \u4ee3\u7801\u5757\u5f15\u5165\u6587\u4ef6<code>.gitignore</code>\u5185\u5bb9 .gitignore\u6587\u4ef6\u5185\u5bb9<pre><code>site/\n.cache\n.gitignore\n</code></pre></p>"},{"location":"reference-example/#_4","title":"\u5185\u5bb9\u6807\u7b7e","text":"<p>\u5185\u5bb9\u6807\u7b7e\u793a\u4f8b1: \u5e26\u6709\u4ee3\u7801\u5757\u7684\u5185\u5bb9\u6807\u7b7e</p> CC++ C<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n  printf(\"Hello world!\\n\");\n  return 0;\n}\n</code></pre> C++<pre><code>#include &lt;iostream&gt;\n\nint main(void) {\n  std::cout &lt;&lt; \"Hello world!\" &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre> <p>\u5185\u5bb9\u6807\u7b7e\u793a\u4f8b2: \u5e26\u6709\u5217\u8868\u7684\u5185\u5bb9\u6807\u7b7e\uff0c\u76ee\u7684\u662f\u5bf9\u5185\u5bb9\u8fdb\u884c\u5206\u7ec4</p> \u65e0\u5e8f\u5217\u8868\u6709\u5e8f\u5217\u8868 <ul> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ul> <ol> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ol> <p>\u5185\u5bb9\u6807\u7b7e\u793a\u4f8b3: \u5f53\u542f\u7528SuperFences\u65f6\uff0c\u5185\u5bb9\u9009\u9879\u5361\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u5d4c\u5957\u5185\u5bb9\uff0c\u5305\u62ec\u66f4\u591a\u7684\u5185\u5bb9\u9009\u9879\u5361\uff0c\u4e5f\u53ef\u4ee5\u5d4c\u5957\u5728\u5176\u4ed6\u5757\u4e2d\uff0c\u5982\u8b66\u544a\u6216block quote</p> <p>\u5185\u5bb9\u6807\u7b7e\u793a\u4f8b3</p> \u65e0\u5e8f\u5217\u88681\u6709\u5e8f\u5217\u88681 Markdown<pre><code>* \u5c04\u624b\u5ea7\n* \u767d\u7f8a\u5ea7\n* \u91d1\u725b\u5ea7\n</code></pre> Markdown<pre><code>1. \u5c04\u624b\u5ea7\n2. \u767d\u7f8a\u5ea7\n3. \u91d1\u725b\u5ea7\n</code></pre>"},{"location":"reference-example/#_5","title":"\u8868\u683c","text":"<p>\u8868\u683c\u793a\u4f8b1: \u53ef\u4ee5\u5305\u542b\u4efb\u610f\u7684Markdown\uff0c\u5305\u62ec\u5185\u8054\u4ee3\u7801\u5757\uff0c\u4ee5\u53ca\u56fe\u6807\u548c\u8868\u60c5\u7b26\u53f7</p> Method Description <code>GET</code>      Fetch resource <code>PUT</code>  Update resource <code>DELETE</code>      Delete resource <p>\u8868\u683c\u793a\u4f8b2: \u5b9a\u4e49\u8868\u683c\u5bf9\u9f50\u65b9\u5f0f</p> \u5de6\u5bf9\u9f50\u5c45\u4e2d\u5bf9\u9f50\u53f3\u5bf9\u9f50 Data table, columns aligned to left<pre><code>| Method      | Description                          |\n| :---------- | :----------------------------------- |\n| `GET`       | :material-check:     Fetch resource  |\n| `PUT`       | :material-check-all: Update resource |\n| `DELETE`    | :material-close:     Delete resource |\n</code></pre> Data table, columns centered<pre><code>| Method      | Description                          |\n| :---------: | :----------------------------------: |\n| `GET`       | :material-check:     Fetch resource  |\n| `PUT`       | :material-check-all: Update resource |\n| `DELETE`    | :material-close:     Delete resource |\n</code></pre> Data table, columns aligned to right<pre><code>| Method      | Description                          |\n| ----------: | -----------------------------------: |\n| `GET`       | :material-check:     Fetch resource  |\n| `PUT`       | :material-check-all: Update resource |\n| `DELETE`    | :material-close:     Delete resource |\n</code></pre>"},{"location":"reference-example/#diagrams","title":"Diagrams\u56fe\u8868","text":"<p>\u5176\u4ed6\u56fe\u53c2\u8003\u94fe\u63a5</p> <p>\u56fe\u8868\u793a\u4f8b1: \u6d41\u7a0b\u56fe</p> <pre><code>graph LR\n  A[Start] --&gt; B{Error?};\n  B --&gt;|Yes| C[Hmm...];\n  C --&gt; D[Debug];\n  D --&gt; B;\n  B ----&gt;|No| E[Yay!];</code></pre> <p>\u56fe\u8868\u793a\u4f8b2: \u5e8f\u5217\u56fe</p> <pre><code>sequenceDiagram\n  autonumber\n  Alice-&gt;&gt;John: Hello John, how are you?\n  loop Healthcheck\n      John-&gt;&gt;John: Fight against hypochondria\n  end\n  Note right of John: Rational thoughts!\n  John--&gt;&gt;Alice: Great!\n  John-&gt;&gt;Bob: How about you?\n  Bob--&gt;&gt;John: Jolly good!</code></pre> <p>\u56fe\u8868\u793a\u4f8b2: \u72b6\u6001\u56fe</p> <pre><code>stateDiagram-v2\n  state fork_state &lt;&lt;fork&gt;&gt;\n    [*] --&gt; fork_state\n    fork_state --&gt; State2\n    fork_state --&gt; State3\n\n    state join_state &lt;&lt;join&gt;&gt;\n    State2 --&gt; join_state\n    State3 --&gt; join_state\n    join_state --&gt; State4\n    State4 --&gt; [*]</code></pre>"},{"location":"reference-example/#_6","title":"\u683c\u5f0f\u5316","text":"<p>Text can be deleted and replacement text added. This can also be combined into onea single operation. Highlighting is also possible and comments can be added inline.</p> <p>Formatting can also be applied to blocks by putting the opening and closing tags on separate lines and adding new lines between the tags and the content.</p> <ul> <li>This was marked</li> <li>This was inserted</li> <li>This was deleted</li> </ul> <p>\u6587\u672c\u4e0a\u4e0b\u6807\u548c\u3001</p> <ul> <li>H<sub>2</sub>O</li> <li>A<sup>T</sup>A</li> <li>text<sup>a superscript</sup></li> </ul> <p>\u663e\u793a\u952e\u76d8\u6309\u952e\u53c2\u8003\u94fe\u63a5</p> <p>Ctrl+Alt+Del</p>"},{"location":"reference-example/#grids","title":"grids\u7f51\u683c","text":"<p>\u7f51\u683c\u793a\u4f8b1: \u5217\u8868\u8bed\u6cd5\uff0c\u672c\u8d28\u4e0a\u662f\u5361\u7247\u7f51\u683c\u7684\u5feb\u6377\u65b9\u5f0f\uff0c\u7531\u4e00\u4e2a\u65e0\u5e8f(\u6216\u6709\u5e8f)\u7684\u5217\u8868\u7ec4\u6210\uff0c\u8be5\u5217\u8868\u7531div\u5305\u88f9\uff0c\u540c\u65f6\u5305\u542bgrid\u548ccards\u7c7b</p> <ul> <li> HTML for content and structure</li> <li> JavaScript for interactivity</li> <li> CSS for text running out of boxes</li> <li> Internet Explorer ... huh?</li> </ul> <p>\u7f51\u683c\u793a\u4f8b2: \u5757\u8bed\u6cd5\uff0c\u5141\u8bb8\u5c06\u5361\u7247\u548c\u5176\u4ed6\u5143\u7d20\u4e00\u8d77\u6392\u5217\u5728\u7f51\u683c\u4e2d\uff0c\u5982\u5728\u901a\u7528\u7f51\u683c\u90e8\u5206\u4e2d\u89e3\u91ca\u7684\u90a3\u6837\uff0c\u53ea\u9700\u5c06card\u7c7b\u6dfb\u52a0\u5230grid\u4e2d\u7684\u4efb\u4f55\u5757\u5143\u7d20\u4e2d</p> <p> HTML for content and structure</p> <p> JavaScript for interactivity</p> <p> CSS for text running out of boxes</p> <p> Internet Explorer ... huh?</p> <p>\u7f51\u683c\u793a\u4f8b3: \u590d\u6742\u5361\u7247\u7f51\u683c</p> <ul> <li> <p> Set up in 5 minutes</p> <p>Install <code>mkdocs-material</code> with <code>pip</code> and get up and running in minutes</p> <p> Getting started</p> </li> <li> <p> It's just Markdown</p> <p>Focus on your content and generate a responsive and searchable static site</p> <p> Reference</p> </li> <li> <p> Made to measure</p> <p>Change the colors, fonts, language, icons, logo and more with a few lines</p> <p> Customization</p> </li> <li> <p> Open Source, MIT</p> <p>Material for MkDocs is licensed under MIT and available on [GitHub]</p> <p> License</p> </li> </ul> <p>\u7f51\u683c\u793a\u4f8b4: \u901a\u7528\u7f51\u683c\uff0c\u5141\u8bb8\u5728\u7f51\u683c\u4e2d\u5b89\u6392\u4efb\u610f\u5757\u5143\u7d20\uff0c\u5305\u62ec\u8b66\u544a\u3001\u4ee3\u7801\u5757\u3001\u5185\u5bb9\u6807\u7b7e\u7b49\u7b49\u3002\u53ea\u9700\u4f7f\u7528\u5e26\u6709grid\u7c7b\u7684div\u6765\u5305\u88c5\u4e00\u7ec4\u5757\uff1a</p> grid\u65e0\u5e8f\u5217\u8868grid\u6709\u5e8f\u5217\u8868 <ul> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ul> <ol> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ol> \u5185\u5bb9\u6807\u7b7e<pre><code>=== \"\u65e0\u5e8f\u5217\u8868\"\n\n    * \u5c04\u624b\u5ea7m\n    * \u767d\u7f8a\u5ea7\n    * \u91d1\u725b\u5ea7\n\n=== \"\u6709\u5e8f\u5217\u8868\"\n\n    1. \u5c04\u624b\u5ea7\n    2. \u767d\u7f8a\u5ea7\n    3. \u91d1\u725b\u5ea7\n</code></pre>"},{"location":"reference-example/#_7","title":"\u56fe\u7247","text":"<p>\u56fe\u7247\u5c45\u5de6</p> <p></p> \u5e26\u8bf4\u660e\u56fe\u7247 <p></p>"},{"location":"reference-example/#_8","title":"\u5217\u8868","text":"<p>\u5217\u8868\u793a\u4f8b1: \u65e0\u5e8f\u5217\u8868\u53ef\u4ee5\u901a\u8fc7\u5728\u4e00\u884c\u524d\u52a0\u4e0a<code>-</code> <code>*</code> <code>+</code> \u6807\u8bb0\u6765\u7f16\u5199\uff0c\u6240\u6709\u8fd9\u4e9b\u6807\u8bb0\u90fd\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\u6b64\u5916\uff0c\u6240\u6709\u7c7b\u578b\u7684\u5217\u8868\u90fd\u53ef\u4ee5\u5d4c\u5957\u5728\u5f7c\u6b64\u4e4b\u4e2d</p> <ul> <li>\u65e0\u5e8f\u5217\u8868\u793a\u4f8b<ul> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ul> </li> </ul> <p>\u5217\u8868\u793a\u4f8b2: \u6709\u5e8f\u5217\u8868\u5fc5\u987b\u4ee5\u6570\u5b57\u5f00\u5934\uff0c\u7d27\u63a5\u7740\u4e00\u4e2a\u70b9\u3002\u6570\u5b57\u4e0d\u9700\u8981\u8fde\u7eed\uff0c\u53ef\u4ee5\u5168\u90e8\u8bbe\u7f6e\u4e3a1.\uff0c\u56e0\u4e3a\u5b83\u4eec\u5728\u6e32\u67d3\u65f6\u5c06\u91cd\u65b0\u7f16\u53f7</p> <ol> <li>\u5c04\u624b\u5ea7<ol> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7<ol> <li>\u5c04\u624b\u5ea7</li> <li>\u767d\u7f8a\u5ea7</li> <li>\u91d1\u725b\u5ea7</li> </ol> </li> </ol> </li> </ol> <p>\u5217\u8868\u793a\u4f8b3: \u81ea\u5b9a\u4e49\u5217\u8868\u542f\u7528\u65f6\uff0c\u4efb\u610f\u952e\u503c\u5bf9\u7684\u5217\u8868\uff0c\u4f8b\u5982\u51fd\u6570\u6216\u6a21\u5757\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u7528\u7b80\u5355\u7684\u8bed\u6cd5\u679a\u4e3e</p> <code>\u987e\u5ba2\u5f88\u9ad8\u5174</code> \u53d6\u51b3\u4e8e\u751f\u6d3b <code>\u660e\u5929\u514d\u8d39</code> \u4e0d\u62c5\u5fc3\u5929\u6c14 <p>\u5217\u8868\u793a\u4f8b4: \u5f53Tasklist\u542f\u7528\u65f6\uff0c\u65e0\u5e8f\u5217\u8868\u9879\u53ef\u4ee5\u4f7f\u7528<code>[ ]</code>\u4f5c\u4e3a\u524d\u7f00\u6765\u5448\u73b0\u672a\u9009\u4e2d\u7684\u590d\u9009\u6846\uff0c\u6216\u8005\u4f7f\u7528<code>[x]</code>\u6765\u5448\u73b0\u9009\u4e2d\u7684\u590d\u9009\u6846\uff0c\u4ece\u800c\u5141\u8bb8\u5b9a\u4e49\u4efb\u52a1\u5217\u8868</p> <ul> <li> Lorem ipsum dolor sit amet, consectetur adipiscing elit</li> <li> Vestibulum convallis sit amet nisi a tincidunt<ul> <li> In hac habitasse platea dictumst</li> <li> In scelerisque nibh non dolor mollis congue sed et metus</li> <li> Praesent sed risus massa</li> </ul> </li> <li> Aenean pretium efficitur erat, donec pharetra, ligula non scelerisque</li> </ul>"},{"location":"reference-example/#_9","title":"\u811a\u6ce8","text":"<p> Jump to footnote1</p> <p> Jump to footnote2</p> <ol> <li> <p>\u811a\u6ce81\u00a0\u21a9</p> </li> <li> <p>\u811a\u6ce82\u00a0\u21a9</p> </li> </ol>"},{"location":"automation/Ansible/","title":"Ansible","text":"Markdown<pre><code>sage: ansible &lt;host-pattern&gt; [options]\n\nDefine and run a single task 'playbook' against a set of hosts\n\nOptions:\n  -a MODULE_ARGS, --args=MODULE_ARGS\n                        module arguments\n  --ask-vault-pass      ask for vault password\n  -B SECONDS, --background=SECONDS\n                        run asynchronously, failing after X seconds\n                        (default=N/A)\n  -C, --check           don't make any changes; instead, try to predict some\n                        of the changes that may occur\n  -D, --diff            when changing (small) files and templates, show the\n                        differences in those files; works great with --check\n  -e EXTRA_VARS, --extra-vars=EXTRA_VARS\n                        set additional variables as key=value or YAML/JSON, if\n                        filename prepend with @\n  -f FORKS, --forks=FORKS\n                        specify number of parallel processes to use\n                        (default=5)\n  -h, --help            show this help message and exit\n  -i INVENTORY, --inventory=INVENTORY, --inventory-file=INVENTORY\n                        specify inventory host path or comma separated host\n                        list. --inventory-file is deprecated\n  -l SUBSET, --limit=SUBSET\n                        further limit selected hosts to an additional pattern\n  --list-hosts          outputs a list of matching hosts; does not execute\n                        anything else\n  -m MODULE_NAME, --module-name=MODULE_NAME\n                        module name to execute (default=command)\n  -M MODULE_PATH, --module-path=MODULE_PATH\n                        prepend colon-separated path(s) to module library\n                        (default=[u'/root/.ansible/plugins/modules',\n                        u'/usr/share/ansible/plugins/modules'])\n  -o, --one-line        condense output\n  --playbook-dir=BASEDIR\n                        Since this tool does not use playbooks, use this as a\n                        subsitute playbook directory.This sets the relative\n                        path for many features including roles/ group_vars/\n                        etc.\n  -P POLL_INTERVAL, --poll=POLL_INTERVAL\n                        set the poll interval if using -B (default=15)\n  --syntax-check        perform a syntax check on the playbook, but do not\n                        execute it\n  -t TREE, --tree=TREE  log output to this directory\n  --vault-id=VAULT_IDS  the vault identity to use\n  --vault-password-file=VAULT_PASSWORD_FILES\n                        vault password file\n  -v, --verbose         verbose mode (-vvv for more, -vvvv to enable\n                        connection debugging)\n  --version             show program's version number and exit\n\n  Connection Options:\n    control as whom and how to connect to hosts\n\n    -k, --ask-pass      ask for connection password\n    --private-key=PRIVATE_KEY_FILE, --key-file=PRIVATE_KEY_FILE\n                        use this file to authenticate the connection\n    -u REMOTE_USER, --user=REMOTE_USER\n                        connect as this user (default=None)\n    -c CONNECTION, --connection=CONNECTION\n                        connection type to use (default=smart)\n    -T TIMEOUT, --timeout=TIMEOUT\n                        override the connection timeout in seconds\n                        (default=10)\n    --ssh-common-args=SSH_COMMON_ARGS\n                        specify common arguments to pass to sftp/scp/ssh (e.g.\n                        ProxyCommand)\n    --sftp-extra-args=SFTP_EXTRA_ARGS\n                        specify extra arguments to pass to sftp only (e.g. -f,\n                        -l)\n    --scp-extra-args=SCP_EXTRA_ARGS\n                        specify extra arguments to pass to scp only (e.g. -l)\n    --ssh-extra-args=SSH_EXTRA_ARGS\n                        specify extra arguments to pass to ssh only (e.g. -R)\n\n  Privilege Escalation Options:\n    control how and which user you become as on target hosts\n\n    -s, --sudo          run operations with sudo (nopasswd) (deprecated, use\n                        become)\n    -U SUDO_USER, --sudo-user=SUDO_USER\n                        desired sudo user (default=root) (deprecated, use\n                        become)\n    -S, --su            run operations with su (deprecated, use become)\n    -R SU_USER, --su-user=SU_USER\n                        run operations with su as this user (default=None)\n                        (deprecated, use become)\n    -b, --become        run operations with become (does not imply password\n                        prompting)\n    --become-method=BECOME_METHOD\n                        privilege escalation method to use (default=sudo),\n                        valid choices: [ sudo | su | pbrun | pfexec | doas |\n                        dzdo | ksu | runas | pmrun | enable | machinectl ]\n    --become-user=BECOME_USER\n                        run operations as this user (default=root)\n    --ask-sudo-pass     ask for sudo password (deprecated, use become)\n    --ask-su-pass       ask for su password (deprecated, use become)\n    -K, --ask-become-pass\n                        ask for privilege escalation password\n</code></pre>"},{"location":"automation/Ansible/#centos","title":"Centos\u4e0b\u5b89\u88c5\u90e8\u7f72","text":"<p>Ansible\u662f\u4e00\u79cd\u6279\u91cf\u90e8\u7f72\u5de5\u5177\uff0c\u73b0\u5728\u8fd0\u7ef4\u4eba\u5458\u7528\u7684\u6700\u591a\u7684\u4e09\u79cd\u5f00\u6e90\u96c6\u4e2d\u5316\u7ba1\u7406\u5de5\u5177\u6709\uff1apuppet,saltstack,ansible\uff0c\u5404\u6709\u5404\u7684\u4f18\u7f3a\u70b9\uff0c\u5176\u4e2dsaltstack\u548cansible\u90fd\u662f\u7528python\u5f00\u53d1\u7684\u3002ansible\u5176\u5b9e\u51c6\u786e\u7684\u8bf4\u53ea\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6846\u67b6\uff0c\u5b83\u8981\u57fa\u4e8e\u5f88\u591a\u5176\u4ed6\u7684python\u6a21\u5757\u624d\u80fd\u5de5\u4f5c\u7684\uff0c\u6240\u4ee5\u5728\u5b89\u88c5ansible\u7684\u65f6\u5019\u4f60\u8981\u518d\u88c5\u5f88\u591a\u5176\u4ed6\u7684\u4f9d\u8d56\u5305\u7684</p> <p>\u597d\u5904\u4e4b\u4e00\u662f\u4f7f\u7528\u8005\u53ef\u4ee5\u5f00\u53d1\u81ea\u5df1\u7684\u6a21\u5757\uff0c\u653e\u5728\u91cc\u9762\u4f7f\u7528\u3002\u7b2c\u4e8c\u4e2a\u597d\u5904\u662f\u65e0\u9700\u5728\u5ba2\u6237\u7aef\u5b89\u88c5agent\uff0c\u66f4\u65b0\u65f6\uff0c\u53ea\u9700\u5728\u64cd\u4f5c\u673a\u4e0a\u8fdb\u884c\u4e00\u6b21\u66f4\u65b0\u5373\u53ef\u3002\u7b2c\u4e09\u4e2a\u597d\u5904\u662f\u6279\u91cf\u4efb\u52a1\u6267\u884c\u53ef\u4ee5\u5199\u6210\u811a\u672c\uff0c\u800c\u4e14\u4e0d\u7528\u5206\u53d1\u5230\u8fdc\u7a0b\u5c31\u53ef\u4ee5\u6267\u884c</p> Text Only<pre><code>(1)\u3001python2.7\u5b89\u88c5,\u5347\u7ea7\u52302.7.9\n\nhttps://www.python.org/ftp/python/2.7.9/Python-2.7.9.tgz\n\n# tar xvzf Python-2.7.9.tgz\n\n# cd Python-2.7.9\n\n# ./configure --prefix=/usr/local\n\n# make &amp;&amp; make install\n## \u5c06python\u5934\u6587\u4ef6\u62f7\u8d1d\u5230\u6807\u51c6\u76ee\u5f55\uff0c\u4ee5\u907f\u514d\u7f16\u8bd1ansible\u65f6\uff0c\u627e\u4e0d\u5230\u6240\u9700\u7684\u5934\u6587\u4ef6\n\n# cd /usr/local/include/python2.7\n\n# cp -a ./* /usr/local/include/\n\n## \u5907\u4efd\u65e7\u7248\u672c\u7684python\uff0c\u5e76\u7b26\u53f7\u94fe\u63a5\u65b0\u7248\u672c\u7684python\n\n# cd /usr/bin   #\u65e7\u7248\u672cPython\u8def\u5f84\n\n# mv python python.old  #\u5907\u4efd\u65e7\u7248\u672c\n\n# ln -s /usr/local/bin/python2 /usr/local/bin/python\n\n# rm -f /usr/bin/python &amp;&amp; cp /usr/local/bin/python2 /usr/bin/python\n\n## \u4fee\u6539yum\u811a\u672c\uff0c\u4f7f\u5176\u6307\u5411\u65e7\u7248\u672c\u7684python\uff0c\u5df2\u907f\u514d\u5176\u65e0\u6cd5\u8fd0\u884c\n\n# vim /usr/bin/yum\n\n#!/usr/bin/python  --&gt;  #!/usr/bin/python2.7\n\nNo module named urlgrabber.grabber\u62a5\u9519\u5904\u7406\n\nvim /usr/libexec/urlgrabber-ext-down\n\n#! /usr/bin/python  --&gt; #! /usr/bin/python2.7\n\npython --version\u9a8c\u8bc1\u7248\u672c\nTips :\u82e5python\u7248\u672c\u5df2\u7ecf\u4e3a2.6\u6216\u4ee5\u4e0a\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u518d\u91cd\u88c5python\uff0c\u53ea\u662f\u8fd8\u9700\u8981\u5b89\u88c5python\u5f00\u53d1\u5305\uff1apython-dev(\u6709\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4e3apython-devel)\n\n(2)\u3001setuptools pip wheel\u6a21\u5757\u5b89\u88c5\nwget https://bootstrap.pypa.io/get-pip.py\n\npython get-pip.py\n\npython -m pip install --upgrade pip setuptools wheel    #\u5347\u7ea7pip setuptools wheel\n\n\u5b89\u88c5\u597dsetuptools\u540e\u5c31\u53ef\u4ee5\u5229\u7528easy_install\u6216pip\u8fd9\u4e2a\u5de5\u5177\u5b89\u88c5\u4e0b\u9762\u7684python\u6a21\u5757\u4e86\n\neasy_install pycrypto pyyaml jinja2 paramiko simplejson\n\npip install pycrypto pyyaml jinja2 paramiko simplejson\n\n(3)\u3001ansible\u5b89\u88c5\n\nhttps://github.com/ansible/ansible/archive/v1.7.2.tar.gz\n\n# tar xvzf ansible-1.7.2.tar.gz\n\n# cd ansible-1.7.2\n\n# python setup.py install\n\n\n\n(4)\u3001SSH\u514d\u5bc6\u94a5\u767b\u5f55\u8bbe\u7f6e\n\n## \u751f\u6210\u516c\u94a5/\u79c1\u94a5\n\n# ssh-keygen -t rsa -P ''\n\n## \u5199\u5165\u4fe1\u4efb\u6587\u4ef6\uff08\u5c06/root/.ssh/id_rsa_storm1.pub\u5206\u53d1\u5230\u5176\u4ed6\u670d\u52a1\u5668\uff0c\u5e76\u5728\u6240\u6709\u670d\u52a1\u5668\u4e0a\u6267\u884c\u5982\u4e0b\u6307\u4ee4\uff09\uff1a\n\n# cat /root/.ssh/id_rsa_storm1.pub &gt;&gt; /root/.ssh/authorized_keys\n\n# chmod 600 /root/.ssh/authorized_keys\n\n\n\n(5)\u3001\u62f7\u8d1d\uff0c\u751f\u6210ansible\u914d\u7f6e\u6587\u4ef6\n\na \u914d\u7f6e\u6587\u4ef6/etc/ansible/ansible.cfg\n\n# mkdir -p /etc/ansible\n\n#cp ansible-1.7.2/examples/ansible.cfg /etc/ansible/\n\nb \u914d\u7f6e\u6587\u4ef6/etc/ansible/hosts\n\n# vim /etc/ansible/hosts\n\n[test]\n\n192.168.110.20\n\n192.168.110.30\n\n\n\n\u6d4b\u8bd5\n\n# ansible test -m command -a 'uptime'\n\n## \u7528\u6765\u6d4b\u8bd5\u8fdc\u7a0b\u4e3b\u673a\u7684\u8fd0\u884c\u72b6\u6001\n\n# ansible test -m ping\n\n\u53c2\u770b\u6240\u6709\u7684\u53c2\u6570\n\nansible-doc -l\n</code></pre>"},{"location":"automation/Ansible/#ansible_1","title":"ansible\u7684\u79bb\u7ebf\u5b89\u88c5","text":"<p>\u9700\u8981\u63d0\u524d\u51c6\u5907\u7684\u5b89\u88c5\u5305\u811a\u672c,install_ansible.sh</p> Text Only<pre><code>#!/bin/sh  \n# 1.\u521b\u5efa\u6587\u4ef6\u5939  \nmkdir /opt/ansible  \n\n# 2. \u79fb\u52a8\u8d44\u6e90\u5230\u76ee\u6807\u6587\u4ef6\u5939  \ncp -rf ./res/* /opt/ansible/  \n\n# 3. \u5b89\u88c5python  \ncd /opt/ansible  \ntar xvzf Python-2.7.tgz  \nrm -f Python-2.7.tgz  \ncd Python-2.7  \n./configure --prefix=/usr/local  \nmake  \nmake install  \ncd /usr/local/include/python2.7  \ncp -a ./* /usr/local/include/  \ncd /usr/bin  \nmv python python.old  \nln -s -f /usr/local/bin/python2.7 /usr/local/bin/python  \nrm -f /usr/bin/python &amp;&amp; cp /usr/local/bin/python2.7 /usr/bin/python  \n\n# 4. \u5b89\u88c5setuptools  \ncd /opt/ansible  \ntar xvzf setuptools-7.0.tar.gz  \nrm -f setuptools-7.0.tar.gz  \ncd setuptools-7.0  \npython setup.py install  \n\n# 5. \u5b89\u88c5pycrypto  \ncd /opt/ansible  \ntar xvzf pycrypto-2.6.tar.gz  \nrm -f pycrypto-2.6.tar.gz  \ncd pycrypto-2.6  \npython setup.py install  \n\n# 6. \u5b89\u88c5PyYAML  \ncd /opt/ansible  \ntar xvzf yaml-0.1.5.tar.gz  \nrm -f yaml-0.1.5.tar.gz  \ncd yaml-0.1.5  \n./configure --prefix=/usr/local  \nmake --jobs=`grep processor /proc/cpuinfo | wc -l`  \nmake install  #\u51fa\u95ee\u9898\u4e86  \n\ncd /opt/ansible  \ntar xvzf PyYAML-3.11.tar.gz  \nrm -f PyYAML-3.11.tar.gz  \ncd PyYAML-3.11  \npython setup.py install  \n\n# 7. \u5b89\u88c5MarkupSafe  \ncd /opt/ansible  \ntar xvzf MarkupSafe-0.9.3.tar.gz  \nrm -f MarkupSafe-0.9.3.tar.gz  \ncd MarkupSafe-0.9.3  \npython setup.py install  \ncd /opt/ansible  \ntar xvzf Jinja2-2.7.3.tar.gz  \nrm -f Jinja2-2.7.3.tar.gz  \ncd Jinja2-2.7.3  \npython setup.py install  \n\n# 8. \u5b89\u88c5ecdsa  \ncd /opt/ansible  \ntar xvzf ecdsa-0.13.tar.gz  \nrm -f ecdsa-0.13.tar.gz  \ncd ecdsa-0.13  \npython setup.py install  \ncd /opt/ansible  \ntar xvzf paramiko-1.15.1.tar.gz  \nrm -f paramiko-1.15.1.tar.gz  \ncd paramiko-1.15.1  \npython setup.py install  \n\n# 9. \u5b89\u88c5simplejson  \ncd /opt/ansible  \ntar xvzf simplejson-3.8.2.tar.gz  \nrm -f simplejson-3.8.2.tar.gz  \ncd simplejson-3.8.2  \npython setup.py install  \ncd /opt/ansible  \ntar xvzf ansible-latest.tar.gz  \nrm -f ansible-latest.tar.gz  \ncd ansible-2.1.0.0  \npython setup.py install  \n</code></pre>"},{"location":"automation/Ansible/#apollo-","title":"Apollo--\u643a\u7a0b\u6846\u67b6\u90e8\u95e8\u7814\u53d1\u7684\u914d\u7f6e\u7ba1\u7406\u5e73\u53f0","text":""},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2024/02/24/http%E7%8A%B6%E6%80%81%E7%A0%81%E8%A7%A3%E9%87%8A/","title":"HTTP\u72b6\u6001\u7801\u89e3\u91ca","text":"<p>\u5b98\u65b9rfc7231\u6587\u6863\u53c2\u8003</p>"},{"location":"blog/2024/02/24/http%E7%8A%B6%E6%80%81%E7%A0%81%E8%A7%A3%E9%87%8A/#http_1","title":"HTTP\u72b6\u6001\u7801","text":"Markdown<pre><code>1xx\uff08\u4e34\u65f6\u54cd\u5e94\uff09:\n  100 Continue\uff08\u7ee7\u7eed\uff09\uff1a\u670d\u52a1\u5668\u5df2\u6536\u5230\u8bf7\u6c42\u7684\u521d\u59cb\u90e8\u5206\uff0c\u5ba2\u6237\u7aef\u5e94\u7ee7\u7eed\u8bf7\u6c42\u3002\n  101 Switching Protocols\uff08\u5207\u6362\u534f\u8bae\uff09\uff1a\u670d\u52a1\u5668\u6b63\u5728\u66f4\u6539\u534f\u8bae\u3002\n  102 Processing\uff08\u5904\u7406\u4e2d\uff09\uff1a\u670d\u52a1\u5668\u5df2\u63a5\u53d7\u8bf7\u6c42\uff0c\u4f46\u5c1a\u672a\u5b8c\u6210\u5904\u7406\u3002\n\n2xx\uff08\u6210\u529f\uff09\n    200 OK\uff08\u6210\u529f\uff09\uff1a\u8bf7\u6c42\u5df2\u6210\u529f\u3002\n    201 Created\uff08\u5df2\u521b\u5efa\uff09\uff1a\u8bf7\u6c42\u5df2\u7ecf\u88ab\u5b9e\u73b0\uff0c\u800c\u4e14\u6709\u4e00\u4e2a\u65b0\u7684\u8d44\u6e90\u88ab\u521b\u5efa\u3002\n    202 Accepted\uff08\u5df2\u63a5\u53d7\uff09\uff1a\u5df2\u63a5\u53d7\u8bf7\u6c42\uff0c\u4f46\u5c1a\u672a\u5904\u7406\u3002\n    203 Non-Authoritative Information\uff08\u975e\u6743\u5a01\u4fe1\u606f\uff09\uff1a\u670d\u52a1\u5668\u5df2\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u8fd4\u56de\u7684\u4fe1\u606f\u53ef\u80fd\u6765\u81ea\u53e6\u4e00\u6765\u6e90\u3002\n    204 No Content\uff08\u65e0\u5185\u5bb9\uff09\uff1a\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\uff0c\u4f46\u6ca1\u6709\u8fd4\u56de\u5185\u5bb9\u3002\n    205 Reset Content\uff08\u91cd\u7f6e\u5185\u5bb9\uff09\uff1a\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\uff0c\u7528\u6237\u4ee3\u7406\u5e94\u91cd\u7f6e\u6587\u6863\u89c6\u56fe\u3002\n    206 Partial Content\uff08\u90e8\u5206\u5185\u5bb9\uff09\uff1a\u670d\u52a1\u5668\u6210\u529f\u5904\u7406\u4e86\u90e8\u5206GET\u8bf7\u6c42\u3002\n\n3xx\uff08\u91cd\u5b9a\u5411\uff09\n    300 Multiple Choices\uff08\u591a\u79cd\u9009\u62e9\uff09\uff1a\u5bf9\u8bf7\u6c42URI\u6709\u591a\u4e2a\u53ef\u7528\u8d44\u6e90\u3002\n    301 Moved Permanently\uff08\u6c38\u4e45\u91cd\u5b9a\u5411\uff09\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u88ab\u6c38\u4e45\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002\n    302 Found\uff08\u627e\u5230\uff09\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u4e34\u65f6\u4ece\u4e0d\u540c\u7684URI\u54cd\u5e94\u3002\n    303 See Other\uff08\u67e5\u770b\u5176\u4ed6\uff09\uff1a\u5bf9\u4e8e\u5b8c\u6210\u8bf7\u6c42\uff0c\u5ba2\u6237\u7aef\u5e94\u8be5\u5bfb\u627e\u53e6\u4e00\u4e2aURI\u3002\n    304 Not Modified\uff08\u672a\u4fee\u6539\uff09\uff1a\u8d44\u6e90\u672a\u88ab\u4fee\u6539\u3002\n    305 Use Proxy\uff08\u4f7f\u7528\u4ee3\u7406\uff09\uff1a\u8bf7\u6c42\u5e94\u4f7f\u7528\u4ee3\u7406\u8bbf\u95ee\u8bf7\u6c42\u7684URI\u3002\n    307 Temporary Redirect\uff08\u4e34\u65f6\u91cd\u5b9a\u5411\uff09\uff1a\u5bf9\u8bf7\u6c42\u7684\u8d44\u6e90\u4e34\u65f6\u4ece\u4e0d\u540c\u7684URI\u54cd\u5e94\u3002\n\n4xx\uff08\u8bf7\u6c42\u9519\u8bef\uff09\n    400 Bad Request\uff08\u9519\u8bef\u8bf7\u6c42\uff09\uff1a\u8bf7\u6c42\u65e0\u6548\u3002\n    401 Unauthorized\uff08\u672a\u6388\u6743\uff09\uff1a\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\u3002\n    402 Payment Required\uff08\u8981\u6c42\u4ed8\u6b3e\uff09\uff1a\u4fdd\u7559\u4f9b\u5c06\u6765\u4f7f\u7528\u3002\n    403 Forbidden\uff08\u7981\u6b62\uff09\uff1a\u670d\u52a1\u5668\u62d2\u7edd\u8bf7\u6c42\u3002\n    404 Not Found\uff08\u672a\u627e\u5230\uff09\uff1a\u670d\u52a1\u5668\u627e\u4e0d\u5230\u8bf7\u6c42\u7684\u8d44\u6e90\u3002\n    405 Method Not Allowed\uff08\u65b9\u6cd5\u4e0d\u5141\u8bb8\uff09\uff1a\u8bf7\u6c42\u4e2d\u6307\u5b9a\u7684\u65b9\u6cd5\u4e0d\u5141\u8bb8\u3002\n    406 Not Acceptable\uff08\u4e0d\u63a5\u53d7\uff09\uff1a\u670d\u52a1\u5668\u751f\u6210\u7684\u54cd\u5e94\u65e0\u6cd5\u8ba9\u5ba2\u6237\u7aef\u63a5\u53d7\u3002\n    407 Proxy Authentication Required\uff08\u9700\u8981\u4ee3\u7406\u8eab\u4efd\u9a8c\u8bc1\uff09\uff1a\u5ba2\u6237\u7aef\u5fc5\u987b\u5148\u901a\u8fc7\u4ee3\u7406\u6388\u6743\u3002\n    408 Request Timeout\uff08\u8bf7\u6c42\u8d85\u65f6\uff09\uff1a\u670d\u52a1\u5668\u7b49\u5f85\u8bf7\u6c42\u65f6\u53d1\u751f\u8d85\u65f6\u3002\n    409 Conflict\uff08\u51b2\u7a81\uff09\uff1a\u8bf7\u6c42\u5bfc\u81f4\u51b2\u7a81\u3002\n    410 Gone\uff08\u6d88\u5931\uff09\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u518d\u53ef\u7528\u3002\n    411 Length Required\uff08\u9700\u8981\u957f\u5ea6\uff09\uff1a\u7f3a\u5c11\u5fc5\u9700\u7684Content-Length\u5934\u5b57\u6bb5\u3002\n    412 Precondition Failed\uff08\u524d\u63d0\u6761\u4ef6\u5931\u8d25\uff09\uff1a\u8bf7\u6c42\u4e2d\u6307\u5b9a\u7684\u524d\u63d0\u6761\u4ef6\u5931\u8d25\u3002\n    413 Payload Too Large\uff08\u8d1f\u8f7d\u8fc7\u5927\uff09\uff1a\u8bf7\u6c42\u6b63\u6587\u592a\u5927\u3002\n    414 URI Too Long\uff08URI\u8fc7\u957f\uff09\uff1aURI\u592a\u957f\u3002\n    415 Unsupported Media Type\uff08\u4e0d\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b\uff09\uff1a\u4e0d\u652f\u6301\u8bf7\u6c42\u4e2d\u4f7f\u7528\u7684\u5a92\u4f53\u7c7b\u578b\u3002\n    416 Range Not Satisfiable\uff08\u8303\u56f4\u4e0d\u53ef\u6ee1\u8db3\uff09\uff1a\u65e0\u6cd5\u6ee1\u8db3\u8bf7\u6c42\u7684Range\u5934\u5b57\u6bb5\u3002\n    417 Expectation Failed\uff08\u671f\u671b\u5931\u8d25\uff09\uff1a\u670d\u52a1\u5668\u65e0\u6cd5\u6ee1\u8db3Expect\u5934\u5b57\u6bb5\u7684\u671f\u671b\u503c\u3002\n    426 Upgrade Required\uff08\u9700\u8981\u5347\u7ea7\uff09\uff1a\u5ba2\u6237\u7aef\u9700\u8981\u5207\u6362\u5230TLS/1.0\u3002\n\n5xx\uff08\u670d\u52a1\u5668\u9519\u8bef\uff09\n    500 Internal Server Error\uff08\u670d\u52a1\u5668\u5185\u90e8\u9519\u8bef\uff09\uff1a\u670d\u52a1\u5668\u9047\u5230\u4e86\u65e0\u6cd5\u5904\u7406\u7684\u9519\u8bef\u3002\n    501 Not Implemented\uff08\u672a\u5b9e\u73b0\uff09\uff1a\u670d\u52a1\u5668\u4e0d\u5177\u5907\u5b8c\u6210\u8bf7\u6c42\u6240\u9700\u7684\u529f\u80fd\u3002\n    502 Bad Gateway\uff08\u9519\u8bef\u7f51\u5173\uff09\uff1a\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u63a5\u6536\u5230\u65e0\u6548\u54cd\u5e94\u3002\n    503 Service Unavailable\uff08\u670d\u52a1\u4e0d\u53ef\u7528\uff09\uff1a\u670d\u52a1\u5668\u6682\u65f6\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\u3002\n    504 Gateway Timeout\uff08\u7f51\u5173\u8d85\u65f6\uff09\uff1a\u670d\u52a1\u5668\u4f5c\u4e3a\u7f51\u5173\u6216\u4ee3\u7406\uff0c\u672a\u80fd\u53ca\u65f6\u4ece\u4e0a\u6e38\u670d\u52a1\u5668\u63a5\u6536\u5230\u8bf7\u6c42\u3002\n    505 HTTP Version Not Supported\uff08HTTP\u7248\u672c\u4e0d\u652f\u6301\uff09\uff1a\u670d\u52a1\u5668\u4e0d\u652f\u6301\u8bf7\u6c42\u4e2d\u6240\u4f7f\u7528\u7684HTTP\u534f\u8bae\u7248\u672c\u3002\n\n[\u53c2\u8003RFC 6585 - Additional HTTP Status Codes](https://tools.ietf.org/html/rfc6585)\nRFC 6585 \u65b0\u589e\u72b6\u6001\u7801\n    418 I'm a teapot\uff08\u6211\u662f\u4e00\u4e2a\u8336\u58f6\uff09\uff1a\u670d\u52a1\u5668\u62d2\u7edd\u5c1d\u8bd5\u7528\u4e8e\u51b2\u6ce1\u5496\u5561\u7684\u8bf7\u6c42\uff0c\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u8336\u58f6\u3002\n    421 Misdirected Request\uff08\u8bf7\u6c42\u9519\u8bef\uff09\uff1a\u670d\u52a1\u5668\u65e0\u6cd5\u751f\u6210\u5bf9\u5f53\u524d\u76ee\u6807\u8d44\u6e90\u7684\u54cd\u5e94\uff0c\u4f46\u53ef\u80fd\u5bf9\u5176\u4ed6\u76ee\u6807\u8d44\u6e90\u6709\u6548\u3002\n    428 Precondition Required\uff08\u8981\u6c42\u5148\u51b3\u6761\u4ef6\uff09\uff1a\u670d\u52a1\u5668\u8981\u6c42\u8bf7\u6c42\u5305\u542b\u524d\u63d0\u6761\u4ef6\u3002\n    429 Too Many Requests\uff08\u8bf7\u6c42\u6570\u8fc7\u591a\uff09\uff1a\u7528\u6237\u5728\u7ed9\u5b9a\u7684\u65f6\u95f4\u5185\u53d1\u9001\u4e86\u592a\u591a\u8bf7\u6c42\u3002\n    431 Request Header Fields Too Large\uff08\u8bf7\u6c42\u5934\u5b57\u6bb5\u592a\u5927\uff09\uff1a\u670d\u52a1\u5668\u4e0d\u613f\u610f\u5904\u7406\u8bf7\u6c42\uff0c\u56e0\u4e3a\u8bf7\u6c42\u5934\u5b57\u6bb5\u592a\u5927\u3002\n    451 Unavailable For Legal Reasons\uff08\u56e0\u6cd5\u5f8b\u539f\u56e0\u4e0d\u53ef\u7528\uff09\uff1a\u8bf7\u6c42\u7684\u8d44\u6e90\u56e0\u6cd5\u5f8b\u539f\u56e0\u4e0d\u53ef\u7528\u3002\n</code></pre>"},{"location":"blog/2024/02/24/general/","title":"General","text":""},{"location":"blog/2024/02/24/general/#_1","title":"\u8c37\u6b4c\u641c\u7d22\u6280\u5de7","text":"Markdown<pre><code>\u8bbe\u7f6e\u5b9a\u65f6 set timer for 1 minute\n\u67e5\u8be2\u60a8\u7684IP  ip address\n\u63b7\u8272\u5b50  roll a dice\n\"\" \u82f1\u6587\u53cc\u5f15\u53f7\u7cbe\u786e\u641c\u7d22\n- \u6392\u9664\u5b57\u7b26\n\u641c\u7d22\u793e\u4ea4\u6807\u7b7e \u5c06 at \u7b26\u53f7 (@) \u653e\u5728\u60a8\u8981\u641c\u7d22\u7684\u793e\u4ea4\u6807\u7b7e\u4e4b\u524d\uff0c\u4f8b\u5982\uff1a@digitaltrends\niphone $75..$200   \u641c\u7d22 \u5728$75..$200\u533a\u95f4\u7684 iphone\n\u597d: baidu.com \u4f7f\u7528\u5192\u53f7\u641c\u7d22\u7279\u5b9a\u7684\u7f51\u7ad9\nam*zing \u4f7f\u7528\u661f\u53f7\u901a\u914d\u7b26\u4ee3\u66ff\u7f3a\u5c11\u5355\u8bcd\n#trump \u641c\u7d22\u5173\u4e8e\u5ddd\u666e\u7684\u70ed\u70b9\u4fe1\u606f\nrelated:amazon.com \u627e\u5230\u4e0e\u5176\u4ed6\u7f51\u7ad9\u7c7b\u4f3c\u7684\u7f51\u7ad9\nBlack or red \u5408\u5e76\u641c\u7d22\nfiletype:pdf \u627e\u5230\u7279\u5b9a\u6587\u4ef6\nsite:www.so.com \u5728360\u641c\u7d22\u5f15\u64ce\u4e2d\u5bfb\u627e\nallintitle: allinurl:\n@twitter \u641c\u7d22\u793e\u4ea4\u5a92\u4f53\ninfo: \u83b7\u53d6\u6709\u5173\u7f51\u7ad9\u7684\u8be6\u7ec6\u4fe1\u606f\ncache:  \u67e5\u770bGoogle\u7684\u7f51\u7ad9\u7f13\u5b58\u7248\u672c\ngoogle.com/history \u641c\u7d22\u5386\u53f2\ninurl:  \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728url\u94fe\u63a5\u4e2d\nintitle:    \u641c\u7d22\u7684\u5173\u952e\u5b57\u5728\u7f51\u9875\u6807\u9898\u4e2d\ninauthor:\"\u4f5c\u8005\u540d\"  \u6839\u636e\u4f5c\u8005\u540d\u641c\u7d22\u76f8\u5173\u4e66\u7c4d\u53ca\u4fe1\u606f\n\nAND\uff1a\u8fd4\u56de\u67e5\u8be2\u4e24\u7aef\u7684\u7ed3\u679c\u3002\u4f8b\uff1agrowth hacks AND youtube\nNOT\uff1a\u8fd4\u56de\u9664NOT\u4e4b\u540e\u7684\u6240\u6709\u7ed3\u679c\u3002\u4f8b\uff1amonty python NOT bbc\n\u4f7f\u7528~\u641c\u7d22\u8bcd\u7684\u540c\u4e49\u8bcd\n\u4f7f\u7528in\u7684\u7ffb\u8bd1\u548c\u8f6c\u6362\nprocess management inurl:forum|forums|discussion|viewthread|showthread|viewtopic|showtopic \u8bba\u575b\ngoogle.com/ncr\u3002NCR\u4ee3\u8868\u65e0\u56fd\u5bb6/\u5730\u533a\u91cd\u5b9a\u5411\nprocess automation filetype:pdf\n\n\u5c06\u201clink:\u201d\u653e\u5728\u60a8\u60f3\u8981\u67e5\u627e\u94fe\u63a5\u5230\u7684\u9875\u9762\u7684\u7f51\u7ad9\u6216\u57df\u7684\u524d\u9762\uff0c\u4f8b\u5982\uff1alink:digitaltrends.com\n\u5c06\u201crelated\uff1a\u201d\u653e\u5728\u60a8\u60f3\u8981\u67e5\u627e\u7c7b\u4f3c\u7ed3\u679c\u7684\u7f51\u7ad9\u6216\u57df\u7684\u524d\u9762\uff0c\u4f8b\u5982\uff1arelated\uff1adigitaltrends.com\n\n\u641c\u7d22ftp\ninurl:ftp:// -inurl:http:// -inurl:https://\n\n-inurl(html|htm|php) intitle:\"index of\" +\"last modified\" +\"parent directory\" +description +size\n\n-inurl:(htm|html|php) intitle:\"index of\" +\"last modified\" +\"parent directory\" +description +size +(wmv|avi)\n\n-inurl:(htm|html|php) intitle:\"index of\" +\"last modified\" +\"parent directory\" +description +size +(jpg|gif)\n\n-inurl:(htm|html|php) intitle:\"index of\" +\"last modified\" +\"parent directory\" +description +size +(wma|mp3)\n\n[-inurl:(htm|html|php) intitle:\" index of\"  +\" last modified\"  +\" parent directory\" +description +size +(jpg|gif) \u201cbritney spears\"]\n</code></pre>"},{"location":"blog/2024/02/24/general/#ip","title":"\u83b7\u53d6\u516c\u7f51IP","text":"Bash<pre><code># \u83b7\u53d6\u516c\u7f51ip\n# \u666e\u901a\u6587\u672c\u683c\u5f0f\ncurl icanhazip.com\ncurl http://members.3322.org/dyndns/getip\ncurl ip.6655.com/ip.aspx\ncurl ident.me\ncurl ipecho.net/plain\ncurl whatismyip.akamai.com\ncurl ifconfig.me\ncurl myip.dnsomatic.com\ncurl ifconfig.co\ncurl http://ipv4.ip.sb\ncurl http://ip-api.com/json\n\n# json\u683c\u5f0f\ncurl ipinfo.io\n\n# \u8fd4\u56deip\u548c\u5730\u533a\ncurl ip.6655.com/ip.aspx?area=1\ncurl cip.cc\nwget -q -O - http://icanhazip.com | /usr/bin/tail\n\nhttps://pv.sohu.com/cityjson?ie=utf-8\n</code></pre>"},{"location":"cache/Squid/","title":"caching proxy","text":""},{"location":"cache/Varnish/","title":"caching HTTP reverse proxy","text":""},{"location":"cloud-native/Docker/","title":"docker\u7b14\u8bb0","text":"Markdown<pre><code>Offical:\u4e00\u6761\u547d\u4ee4\u5b89\u88c5\u6700\u65b0\u7a33\u5b9a\u7248docker\uff1acurl -fsSl https://get.docker.com | sh\n![docker\u5b89\u88c5\u5b98\u65b9\u53c2\u8003\u94fe\u63a5](https://docs.docker.com/engine/install)\n![docker-compose\u5b89\u88c5\u5b98\u65b9\u53c2\u8003\u94fe\u63a5](https://docs.docker.com/compose/install)\n![docker reference](https://docs.docker.com/reference)\n\n![Docker Captains\u64b0\u5199\u7684\u5b66\u4e60\u8d44\u6e90](https://docs.docker.com/get-started/resources)\n![docker-desktop\u542f\u52a8k8s\u56fd\u5185\u7528\u6237\u53c2\u8003\u94fe\u63a5](https://github.com/AliyunContainerService/k8s-for-docker-desktop/blob/master/README.md)\n</code></pre> <p>\u81ea\u5b9a\u4e49Windows10\u4e0bdocker-desktop\u7684vm data\u5b58\u50a8\u8def\u5f84</p> <ol> <li>quit Docker Desktop</li> <li>wsl -l -v   \u67e5\u770b\u5f53\u524d\u8fd0\u884c\u7684vm</li> <li>wsl --export docker-desktop-data \"\u81ea\u5b9a\u4e49\u8def\u5f84\\docker-desktop-data.tar\" \u5bfc\u51fa\u5f53\u524d\u6570\u636e\u5230\u81ea\u5b9a\u4e49\u76ee\u5f55</li> <li>wsl --unregister docker-desktop-data unregister\u5176data\u7684vm\uff0c\u6210\u529f\u4f1a\u81ea\u52a8\u5220\u9664\u9ed8\u8ba4\u7684vhdx\u6587\u4ef6</li> <li>wsl --import docker-desktop-data \"\u81ea\u5b9a\u4e49\u8def\u5f84\" \"\u81ea\u5b9a\u4e49\u8def\u5f84\\docker-desktop-data.tar\" --version 2 \u5bfc\u5165\u4e4b\u524d\u5bfc\u51fa\u7684vm data</li> </ol> <p>\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684Docker Compose:</p> Bash<pre><code>sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose\n</code></pre>"},{"location":"cloud-native/Docker/#docker_1","title":"\u5378\u8f7ddocker","text":"Bash<pre><code>yum remove docker-ce\nrm -rf /var/lib/docker\nrm -rf /var/lib/containerd\n</code></pre> <p>WARNING: Error loading config file: /home/user/.docker/config.json - stat /home/user/.docker/config.json: permission denied To fix this problem, either remove the ~/.docker/ directory (it is recreated automatically, but any custom settings are lost), or change its ownership and permissions using the following commands:</p> <p>$ sudo chown \"\\(USER\":\"\\)USER\" /home/\"$USER\"/.docker -R $ sudo chmod g+rwx \"$HOME/.docker\" -R</p>"},{"location":"cloud-native/Docker/#centos6docker","title":"centos6\u5b89\u88c5docker\u4f9d\u8d56\u51fa\u9519\u89e3\u51b3","text":"Bash<pre><code>yum remove docker-io\nrm -rf /var/lib/docker\nrm /etc/yum.repos.d/docker.repo\nyum install docker-io\u6216\u8005yum install the docker-engine-1.7.1 rpm\nyum install http://yum.dockerproject.org/repo/main/centos/6/Packages/docker-engine-1.7.1-1.el6.x86_64.rpm\nservice docker status\n</code></pre>"},{"location":"cloud-native/Docker/#docker_2","title":"Docker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f","text":"Bash<pre><code>\u901a\u8fc7 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\uff0c\u4e2d\u56fd\u533a\u7528\u6237\u80fd\u591f\u5feb\u901f\u8bbf\u95ee\u6700\u6d41\u884c\u7684 Docker \u955c\u50cf\u3002\u8be5\u955c\u50cf\u6258\u7ba1\u4e8e\u4e2d\u56fd\u5927\u9646\uff0c\u672c\u5730\u7528\u6237\u73b0\u5728\u5c06\u4f1a\u4eab\u53d7\u5230\u66f4\u5feb\u7684\u4e0b\u8f7d\u901f\u5ea6\u548c\u66f4\u5f3a\u7684\u7a33\u5b9a\u6027\uff0c\u4ece\u800c\u80fd\u591f\u66f4\u654f\u6377\u5730\u5f00\u53d1\u548c\u4ea4\u4ed8 Docker \u5316\u5e94\u7528\n\nDocker \u4e2d\u56fd\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u53ef\u901a\u8fc7 registry.docker-cn.com \u8bbf\u95ee\u3002\u8be5\u955c\u50cf\u5e93\u53ea\u5305\u542b\u6d41\u884c\u7684\u516c\u6709\u955c\u50cf\u3002\u79c1\u6709\u955c\u50cf\u4ecd\u9700\u8981\u4ece\u7f8e\u56fd\u955c\u50cf\u5e93\u4e2d\u62c9\u53d6\n\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u76f4\u63a5\u4ece\u8be5\u955c\u50cf\u52a0\u901f\u5730\u5740\u8fdb\u884c\u62c9\u53d6\uff1a\n\n$ docker pull registry.docker-cn.com/myname/myrepo:mytag\n\u4f8b\u5982:\n\n$ docker pull registry.docker-cn.com/library/ubuntu:16.04\n\u6ce8: \u9664\u975e\u60a8\u4fee\u6539\u4e86 Docker \u5b88\u62a4\u8fdb\u7a0b\u7684 `--registry-mirror` \u53c2\u6570 (\u89c1\u4e0b\u6587), \u5426\u5219\u60a8\u5c06\u9700\u8981\u5b8c\u6574\u5730\u6307\u5b9a\u5b98\u65b9\u955c\u50cf\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff0clibrary/ubuntu\u3001library/redis\u3001library/nginx\n\n\u4f7f\u7528 --registry-mirror \u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b\n\u60a8\u53ef\u4ee5\u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b\u9ed8\u8ba4\u4f7f\u7528 Docker \u5b98\u65b9\u955c\u50cf\u52a0\u901f\u3002\u8fd9\u6837\u60a8\u53ef\u4ee5\u9ed8\u8ba4\u901a\u8fc7\u5b98\u65b9\u955c\u50cf\u52a0\u901f\u62c9\u53d6\u955c\u50cf\uff0c\u800c\u65e0\u9700\u5728\u6bcf\u6b21\u62c9\u53d6\u65f6\u6307\u5b9a registry.docker-cn.com\n\n\u60a8\u53ef\u4ee5\u5728 Docker \u5b88\u62a4\u8fdb\u7a0b\u542f\u52a8\u65f6\u4f20\u5165 --registry-mirror \u53c2\u6570\uff1a\n\n$ docker --registry-mirror=https://registry.docker-cn.com daemon\n\u4e3a\u4e86\u6c38\u4e45\u6027\u4fdd\u7559\u66f4\u6539\uff0c\u60a8\u53ef\u4ee5\u4fee\u6539 /etc/docker/daemon.json \u6587\u4ef6\u5e76\u6dfb\u52a0\u4e0a registry-mirrors \u952e\u503c\n\n{\n  \"registry-mirrors\": [\"https://registry.docker-cn.com\"]\n}\n\n\u4fee\u6539\u4fdd\u5b58\u540e\u91cd\u542f Docker \u4ee5\u4f7f\u914d\u7f6e\u751f\u6548\n\n\u6ce8: \u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u9002\u7528\u4e8e Mac \u7684 Docker \u548c\u9002\u7528\u4e8e Windows \u7684 Docker \u6765\u8fdb\u884c\u8bbe\u7f6e\n\n\u4f7f\u7528TLS(https)\u4fdd\u62a4docker\u5b88\u62a4\u8fdb\u7a0b\u5957\u63a5\u5b57\u5b89\u5168\u53c2\u8003\u94fe\u63a5\uff1a\nhttps://docs.docker.com/engine/security/protect-access/\n</code></pre>"},{"location":"cloud-native/Docker/#_1","title":"Docker","text":"Markdown<pre><code>Docker\u7684\u7f51\u7edc\u5b50\u7cfb\u7edf\u53ef\u4f7f\u7528\u9a71\u52a8\u7a0b\u5e8f\u63d2\u5165\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6709\u51e0\u4e2a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5b83\u4eec\u63d0\u4f9b\u6838\u5fc3\u8054\u7f51\u529f\u80fd\uff1a\n\n1. bridge\uff1a\u9ed8\u8ba4\u7684\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u3002\u5982\u679c\u60a8\u672a\u6307\u5b9a\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5219\u8fd9\u662f\u60a8\u6b63\u5728\u521b\u5efa\u7684\u7f51\u7edc\u7c7b\u578b\u3002\u5f53\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u5728\u9700\u8981\u901a\u4fe1\u7684\u72ec\u7acb\u5bb9\u5668\u4e2d\u8fd0\u884c\u65f6\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528\u7f51\u6865\u7f51\u7edc\n    \u8be6\u89e3\uff1a\u7f51\u6865\u662f\u5728\u7f51\u6bb5\u4e4b\u95f4\u8f6c\u53d1\u6d41\u91cf\u7684\u94fe\u8def\u5c42\u8bbe\u5907\uff0c\u5176\u53ef\u4ee5\u662f\u4e3b\u673a\u5185\u6838\u4e2d\u8fd0\u884c\u7684\u786c\u4ef6\u8bbe\u5907\u548c\u8f6f\u4ef6\u8bbe\u5907\uff0cdocker\u4e2d\u4f7f\u7528\u8f6f\u4ef6\u7f51\u6865\u6765\u5141\u8bb8\u540c\u4e00\u7f51\u6865\u7f51\u7edc\u7684\u5bb9\u5668\u901a\u4fe1\uff0cbridge\u7f51\u7edc\n    \u7528\u4e8e\u540c\u4e00\u4e2adocker\u5b88\u62a4\u8fdb\u7a0b\u4e3b\u673a\u4e2d\u8fd0\u884c\u7684\u5bb9\u5668\uff0c\u4e3a\u4e86\u8ba9\u4e0d\u540cdocker\u5b88\u62a4\u8fdb\u7a0b\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\u4e4b\u95f4\u901a\u4fe1\uff0c\u53ef\u4ee5\u5728OS\u7ea7\u522b\u8bbe\u7f6e\u8def\u7531\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528overlay\u7f51\u7edc\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u5b9a\u4e49\n    \u521b\u5efa\u7f51\u6865\u7f51\u7edc\uff0c\u4e14\u7528\u6237\u5b9a\u4e49\u7684\u7f51\u6865\u7f51\u7edc\u4f18\u5148\u4e8e\u9ed8\u8ba4bridge\u7f51\u7edc\n\n2. host\uff1a\u5bf9\u4e8e\u72ec\u7acb\u5bb9\u5668\uff0c\u8bf7\u5220\u9664\u5bb9\u5668\u4e0eDocker\u4e3b\u673a\u4e4b\u95f4\u7684\u7f51\u7edc\u9694\u79bb\uff0c\u7136\u540e\u76f4\u63a5\u4f7f\u7528\u4e3b\u673a\u7684\u7f51\u7edc\n  \u8be6\u89e3\uff1a\u5bf9\u5bb9\u5668\u4f7f\u7528host\u7f51\u7edc\u6a21\u5f0f\uff0c\u5219\u8be5\u5bb9\u5668\u7684\u7f51\u7edc\u5806\u6808\u4e0d\u4f1a\u4e0eDocker\u4e3b\u673a\u9694\u79bb\uff08\u8be5\u5bb9\u5668\u5171\u4eab\u4e3b\u673a\u7684\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\uff0c\u5e76\u4e14\u8be5\u5bb9\u5668\u4e0d\u4f1a\u5206\u914d\u81ea\u5df1\u7684IP\u5730\u5740\n  \u4e3b\u673a\u6a21\u5f0f\u7f51\u7edc\u5bf9\u4e8e\u4f18\u5316\u6027\u80fd\u4ee5\u53ca\u5728\u5bb9\u5668\u9700\u8981\u5904\u7406\u5927\u91cf\u7aef\u53e3\u7684\u60c5\u51b5\u4e0b\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u4e0d\u9700\u8981\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08NAT\uff09\uff0c\u5e76\u4e14\u4e0d\u4f1a\u4e3a\u6bcf\u4e2a\u7aef\u53e3\u521b\u5efa\u201c userland-proxy\u201d\n\n3. overlay\uff1a\u8986\u76d6\u7f51\u7edc\u5c06\u591a\u4e2aDocker\u5b88\u62a4\u7a0b\u5e8f\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5e76\u4f7f\u7fa4\u96c6\u670d\u52a1\u80fd\u591f\u76f8\u4e92\u901a\u4fe1\u3002\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8986\u76d6\u7f51\u7edc\u6765\u4fc3\u8fdb\u7fa4\u96c6\u670d\u52a1\u548c\u72ec\u7acb\u5bb9\u5668\u4e4b\u95f4\u6216\u4e0d\u540cDocker\u5b88\u62a4\u7a0b\u5e8f\u4e0a\u7684\u4e24\u4e2a\u72ec\u7acb\u5bb9\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u3002\u8fd9\u79cd\u7b56\u7565\u6d88\u9664\u4e86\u5728\u8fd9\u4e9b\u5bb9\u5668\u4e4b\u95f4\u8fdb\u884c\u64cd\u4f5c\u7cfb\u7edf\u7ea7\u8def\u7531\u7684\u9700\u8981\n  \u8be6\u89e3\uff1aoverlay\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u521b\u5efa\u591a\u4e2a\u4e3b\u673adocker\u5b88\u62a4\u8fdb\u7a0b\u4e4b\u95f4\u7684\u5206\u5e03\u5f0f\u7f51\u7edc\uff0c\u5176\u4f4d\u4e8e\u7279\u5b9a\u4e3b\u673a\u7f51\u7edc\u4e4b\u4e0a(\u8986\u76d6\u7279\u5b9a\u4e3b\u673a\u7684\u7f51\u7edc)\uff0c\u4ece\u800c\u5728\u542f\u7528\u52a0\u5bc6\u540e\u5141\u8bb8\u4e0e\u5176\u8fde\u63a5\u7684\u5bb9\u5668(\u5305\u62ec\u7fa4\u96c6\u670d\u52a1\u5bb9\u5668)\u8fdb\u884c\u5b89\u5168\u901a\u4fe1\n\n  \u521d\u59cb\u5316\u7fa4\u96c6\u6216\u5c06Docker\u4e3b\u673a\u52a0\u5165\u73b0\u6709\u7fa4\u96c6\u65f6\uff0c\u5c06\u5728\u8be5Docker\u4e3b\u673a\u4e0a\u521b\u5efa\u4e24\u4e2a\u65b0\u7f51\u7edc\uff1a\n  1. \u4e00\u4e2a\u79f0\u4e3a\u7684\u8986\u76d6\u7f51\u7edcingress\uff0c\u7528\u4e8e\u5904\u7406\u4e0e\u7fa4\u4f53\u670d\u52a1\u6709\u5173\u7684\u63a7\u5236\u548c\u6570\u636e\u6d41\u91cf\u3002\u521b\u5efa\u7fa4\u96c6\u670d\u52a1\u5e76\u4e14\u4e0d\u5c06\u5176\u8fde\u63a5\u5230\u7528\u6237\u5b9a\u4e49\u7684\u8986\u76d6\u7f51\u7edc\u65f6\uff0cingress \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5b83\u5c06\u8fde\u63a5\u5230\u7f51\u7edc\n  2.  \u4e00\u4e2a\u540d\u4e3a\u7684\u6865\u63a5\u7f51\u7edcdocker_gwbridge\uff0c\u5b83\u5c06\u5404\u4e2aDocker\u5b88\u62a4\u7a0b\u5e8f\u8fde\u63a5\u5230\u8be5\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u5b88\u62a4\u7a0b\u5e8f\n  \u53ef\u4ee5overlay\u4f7f\u7528docker network create\u6765\u521b\u5efa\u81ea\u5b9a\u4e49\u7f51\u7edc\uff0c\u5c31\u50cf\u521b\u5efa\u81ea\u5b9a\u4e49\u7684bridge\u7f51\u7edc\u4e00\u6837\u3002\u670d\u52a1\u6216\u5bb9\u5668\u53ef\u4ee5\u4e00\u6b21\u8fde\u63a5\u5230\u591a\u4e2a\u7f51\u7edc\u3002\u4f46\u670d\u52a1\u6216\u5bb9\u5668\u53ea\u80fd\u5728\u5b83\u4eec\u5404\u81ea\u8fde\u63a5\u7684\u7f51\u7edc\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\n\n4. macvlan\uff1aMacvlan\u7f51\u7edc\u5141\u8bb8\u60a8\u4e3a\u5bb9\u5668\u5206\u914dMAC\u5730\u5740\uff0c\u4f7f\u5176\u5728\u7f51\u7edc\u4e0a\u663e\u793a\u4e3a\u7269\u7406\u8bbe\u5907\u3002Docker\u5b88\u62a4\u7a0b\u5e8f\u901a\u8fc7\u5176MAC\u5730\u5740\u5c06\u6d41\u91cf\u8def\u7531\u5230\u5bb9\u5668\u3002macvlan \u5728\u5904\u7406\u5e0c\u671b\u76f4\u63a5\u8fde\u63a5\u5230\u7269\u7406\u7f51\u7edc\u800c\u4e0d\u662f\u901a\u8fc7Docker\u4e3b\u673a\u7684\u7f51\u7edc\u5806\u6808\u8fdb\u884c\u8def\u7531\u7684\u65e7\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u4f7f\u7528\u9a71\u52a8\u7a0b\u5e8f\u6709\u65f6\u662f\u6700\u4f73\u9009\u62e9\n\n5. none\uff1a\u5bf9\u4e8e\u6b64\u5bb9\u5668\uff0c\u8bf7\u7981\u7528\u6240\u6709\u8054\u7f51\u3002\u901a\u5e38\u4e0e\u81ea\u5b9a\u4e49\u7f51\u7edc\u9a71\u52a8\u7a0b\u5e8f\u4e00\u8d77\u4f7f\u7528\u3002none\u4e0d\u9002\u7528\u4e8e\u7fa4\u4f53\u670d\u52a1\n\n6. \u7f51\u7edc\u63d2\u4ef6\uff1a\u4f8b\u5982\uff1aWeave Net\u3001flannel\u3001calico\u7b49\n\n\u7f51\u7edc\u9a71\u52a8\u603b\u7ed3\n\u5f53\u60a8\u9700\u8981\u591a\u4e2a\u5bb9\u5668\u5728\u540c\u4e00\u4e2a Docker \u4e3b\u673a\u4e0a\u8fdb\u884c\u901a\u4fe1\u65f6\uff0c\u7528\u6237\u5b9a\u4e49\u7684\u6865\u63a5\u7f51\u7edc\u662f\u6700\u4f73\u9009\u62e9\u3002\n\u5f53\u7f51\u7edc\u5806\u6808\u4e0d\u5e94\u4e0e Docker \u4e3b\u673a\u9694\u79bb\uff0c\u4f46\u60a8\u5e0c\u671b\u5bb9\u5668\u7684\u5176\u4ed6\u65b9\u9762\u88ab\u9694\u79bb\u65f6\uff0c\u4e3b\u673a\u7f51\u7edc\u662f\u6700\u4f73\u9009\u62e9\u3002\n\u5f53\u60a8\u9700\u8981\u5728\u4e0d\u540c Docker \u4e3b\u673a\u4e0a\u8fd0\u884c\u7684\u5bb9\u5668\u8fdb\u884c\u901a\u4fe1\u65f6\uff0c\u6216\u8005\u5f53\u591a\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528 swarm \u670d\u52a1\u534f\u540c\u5de5\u4f5c\u65f6\uff0c\u8986\u76d6\u7f51\u7edc\u662f\u6700\u4f73\u9009\u62e9\u3002\n\u5f53\u60a8\u4ece VM \u8bbe\u7f6e\u8fc1\u79fb\u6216\u9700\u8981\u5bb9\u5668\u770b\u8d77\u6765\u50cf\u7f51\u7edc\u4e0a\u7684\u7269\u7406\u4e3b\u673a\u65f6\uff0cMacvlan \u7f51\u7edc\u662f\u6700\u4f73\u9009\u62e9\uff0c\u6bcf\u4e2a\u4e3b\u673a\u90fd\u6709\u552f\u4e00\u7684 MAC \u5730\u5740\u3002\n\u7b2c\u4e09\u65b9\u7f51\u7edc\u63d2\u4ef6\u5141\u8bb8\u60a8\u5c06 Docker \u4e0e\u4e13\u95e8\u7684\u7f51\u7edc\u5806\u6808\u96c6\u6210\n\n\u81ea\u5b9a\u4e49\u7f51\u6865\u548c\u9ed8\u8ba4bridge\u7684\u533a\u522b\n\u7528\u6237\u5b9a\u4e49\u7684\u7f51\u6865\u5728\u5bb9\u5668\u4e4b\u95f4\u63d0\u4f9b\u81ea\u52a8 DNS \u89e3\u6790\n\u7528\u6237\u5b9a\u4e49\u7684\u6865\u63d0\u4f9b\u66f4\u597d\u7684\u9694\u79bb\n\u5bb9\u5668\u53ef\u4ee5\u5728\u8fd0\u884c\u4e2d\u4ece\u7528\u6237\u5b9a\u4e49\u7684\u7f51\u7edc\u8fde\u63a5\u548c\u5206\u79bb\n\u6bcf\u4e2a\u7528\u6237\u5b9a\u4e49\u7684\u7f51\u7edc\u90fd\u4f1a\u521b\u5efa\u4e00\u4e2a\u53ef\u914d\u7f6e\u7684\u7f51\u6865\n\u9ed8\u8ba4\u7f51\u6865\u7f51\u7edc\u4e0a\u7684\u94fe\u63a5\u5bb9\u5668\u5171\u4eab\u73af\u5883\u53d8\u91cf\n</code></pre> <p>https://github.com/wsargent/docker-cheat-sheet</p>"},{"location":"cloud-native/Docker/#docker_3","title":"Docker\u652f\u6301\u4ee5\u4e0b\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f","text":"Markdown<pre><code>overlay2 \u662f\u5f53\u524d\u6240\u6709\u53d7\u652f\u6301\u7684Linux\u53d1\u884c\u7248\u7684\u9996\u9009\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u4efb\u4f55\u989d\u5916\u7684\u914d\u7f6e\naufs\u662f\u5728\u5185\u68383.13\u4e0a\u7684Ubuntu 14.04\u4e0a\u8fd0\u884c\u7684Docker 18.06\u53ca\u66f4\u65e9\u7248\u672c\u7684\u9996\u9009\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\uff0c\u800c\u8be5\u5185\u6838\u4e0d\u652f\u6301overlay2\nfuse-overlayfs\u4ec5\u5728\u4e0d\u63d0\u4f9b\u5bf9rootless\u7684\u652f\u6301\u7684\u4e3b\u673a\u4e0a\u8fd0\u884cRootless Docker\u65f6\u624d\u9996\u9009overlay2\u3002\u5728Ubuntu\u548cDebian 10\u4e0a\uff0c\u5373\u4f7f\u5728\u65e0\u6839\u6a21\u5f0f\u4e0bfuse-overlayfs\u4e5f\u4e0d\u9700\u8981\u4f7f\u7528\u8be5\u9a71\u52a8\u7a0b\u5e8foverlay2\u3002\u8bf7\u53c2\u9605\u65e0\u6839\u6a21\u5f0f\u6587\u6863\ndevicemapper\u652f\u6301\uff0c\u4f46\u662fdirect-lvm\u5bf9\u4e8e\u751f\u4ea7\u73af\u5883\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3aloopback-lvm\u96f6\u914d\u7f6e\u867d\u7136\u6027\u80fd\u5f88\u5dee\u3002devicemapper\u662fCentOS\u548cRHEL\u7684\u63a8\u8350\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u5185\u6838\u7248\u672c\u4e0d\u652f\u6301overlay2\u3002\u4f46\u662f\uff0c\u5f53\u524d\u7248\u672c\u7684CentOS\u548cRHEL\u73b0\u5728\u652f\u6301overlay2\uff0c\u8fd9\u662f\u63a8\u8350\u7684\u9a71\u52a8\u7a0b\u5e8f\n\u5982\u679cbtrfs\u548czfs\u9a71\u52a8\u7a0b\u5e8f\u662f\u540e\u5907\u6587\u4ef6\u7cfb\u7edf\uff08\u5b89\u88c5\u4e86Docker\u7684\u4e3b\u673a\u7684\u6587\u4ef6\u7cfb\u7edf\uff09\uff0c\u5219\u4f7f\u7528\u5b83\u4eec\u3002\u8fd9\u4e9b\u6587\u4ef6\u7cfb\u7edf\u5141\u8bb8\u4f7f\u7528\u9ad8\u7ea7\u9009\u9879\uff0c\u4f8b\u5982\u521b\u5efa\u201c\u5feb\u7167\u201d\uff0c\u4f46\u9700\u8981\u66f4\u591a\u7684\u7ef4\u62a4\u548c\u8bbe\u7f6e\u3002\u8fd9\u4e9b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u4f9d\u8d56\u4e8e\u6b63\u786e\u914d\u7f6e\u7684\u540e\u5907\u6587\u4ef6\u7cfb\u7edf\n\u8be5vfs\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5e76\u5728\u90a3\u91cc\u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u5199\u5165\u65f6\u590d\u5236\u6587\u4ef6\u7cfb\u7edf\u7684\u60c5\u51b5\u3002\u6b64\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\u7684\u6027\u80fd\u5f88\u5dee\uff0c\u901a\u5e38\u4e0d\u5efa\u8bae\u5728\u751f\u4ea7\u4e2d\u4f7f\u7528\n</code></pre>"},{"location":"cloud-native/Docker/#_2","title":"\u652f\u6301\u7684\u6587\u4ef6\u7cfb\u7edf","text":"\u5b58\u50a8\u9a71\u52a8 \u652f\u6301\u7684\u6587\u4ef6\u7cfb\u7edf overlay2, overlay xfs with ftype=1, ext4 fuse-overlayfs any filesystem aufs xfs, ext4 devicemapper direct-lvm btrfs btrfs zfs zfs vfs any filesystem <p>\u9664\u5176\u4ed6\u4e8b\u9879\u5916\uff0c\u6bcf\u4e2a\u5b58\u50a8\u9a71\u52a8\u7a0b\u5e8f\u90fd\u6709\u5176\u81ea\u5df1\u7684\u6027\u80fd\u7279\u5f81\uff0c\u8fd9\u4f7f\u5176\u6216\u591a\u6216\u5c11\u5730\u9002\u5408\u4e8e\u4e0d\u540c\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u8003\u8651\u4ee5\u4e0b\u6982\u62ec\uff1a</p> <ul> <li>overlay2\uff0c\uff0caufs\u548coverlay\u90fd\u5728\u6587\u4ef6\u7ea7\u522b\u800c\u4e0d\u662f\u5757\u7ea7\u522b\u8fd0\u884c\u3002\u8fd9\u6837\u53ef\u4ee5\u66f4\u6709\u6548\u5730\u4f7f\u7528\u5185\u5b58\uff0c\u4f46\u662f\u5728\u5199\u7e41\u91cd\u7684\u5de5\u4f5c\u8d1f\u8f7d\u4e2d\uff0c\u5bb9\u5668\u7684\u53ef\u5199\u5c42\u53ef\u80fd\u4f1a\u53d8\u5f97\u975e\u5e38\u5927</li> <li>\u5757\u7ea7\u5b58\u50a8\u9a71\u52a8\u5668\uff0c\u4f8b\u5982devicemapper\uff0cbtrfs\u548czfs\u66f4\u597d\u5730\u4e3a\u5199\u7e41\u91cd\u7684\u5de5\u4f5c\u8d1f\u62c5\uff08\u867d\u7136\u4e0d\u662f\u8fd8\u6709\u6cca\u575e\u7a97\u5377\uff09\u6267\u884c</li> <li>\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u5c42\u6216\u8f83\u6df1\u6587\u4ef6\u7cfb\u7edf\u7684\u8bb8\u591a\u5c0f\u578b\u5199\u64cd\u4f5c\u6216\u5bb9\u5668\uff0c\u5176\u6027\u80fd overlay\u53ef\u80fd\u6bd4\u66f4\u597doverlay2\uff0c\u4f46\u4f1a\u6d88\u8017\u66f4\u591a\u7684inode\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4inode\u8017\u5c3d</li> <li>btrfs\u5e76zfs\u9700\u8981\u5927\u91cf\u7684\u5185\u5b58</li> <li>zfs \u5bf9\u4e8e\u9ad8\u5bc6\u5ea6\u5de5\u4f5c\u8d1f\u8f7d\uff08\u4f8b\u5982PaaS\uff09\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9</li> </ul> <p>Linux \u5bb9\u5668\u4f9d\u8d56\u4e8e\u63a7\u5236\u7ec4 \uff0c\u8fd9\u4e9b\u63a7\u5236\u7ec4\u4e0d\u4ec5\u8ddf\u8e2a\u8fdb\u7a0b\u7ec4\uff0c\u8fd8\u516c\u5f00\u6709\u5173 CPU\u3001\u5185\u5b58\u548c\u5757 I/O \u4f7f\u7528\u60c5\u51b5\u7684\u6307\u6807 \u5728\u57fa\u4e8e systemd \u7684\u7cfb\u7edf\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0systemd.unified_cgroup_hierarchy=1 \u5230\u5185\u6838\u200b\u200b cmdline\u6765\u542f\u7528 cgroup v2</p>"},{"location":"cloud-native/Docker/#dockerfile","title":"Dockerfile\u53c2\u8003","text":"Markdown<pre><code>\u6784\u5efa\u7531Docker\u5b88\u62a4\u7a0b\u5e8f\u8fd0\u884c\uff0c\u800c\u4e0d\u662f\u7531CLI\u8fd0\u884c\u3002\u6784\u5efa\u8fc7\u7a0b\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u662f\u5c06\u6574\u4e2a\u4e0a\u4e0b\u6587\uff08\u9012\u5f52\u5730\uff09\u53d1\u9001\u5230\u5b88\u62a4\u8fdb\u7a0b\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u4ece\u4e00\u4e2a\u7a7a\u76ee\u5f55\u4f5c\u4e3a\u4e0a\u4e0b\u6587\u5f00\u59cb\uff0c\u5e76\u5c06 Dockerfile \u4fdd\u5b58\u5728\u8be5\u76ee\u5f55\u4e2d\u3002\u4ec5\u6dfb\u52a0\u6784\u5efa Dockerfile \u6240\u9700\u7684\u6587\u4ef6\n\n**\u8b66\u544a**\uff1a\u4e0d\u8981\u4f7f\u7528\u6839\u76ee\u5f55/\u4f5c\u4e3aPATH\u6784\u5efa\u4e0a\u4e0b\u6587\uff0c\u56e0\u4e3a\u5b83\u4f1a\u5bfc\u81f4\u6784\u5efa\u5c06\u786c\u76d8\u9a71\u52a8\u5668\u7684\u5168\u90e8\u5185\u5bb9\u4f20\u8f93\u5230 Docker \u5b88\u62a4\u7a0b\u5e8f\n\n## \u89e3\u6790\u5668\u6307\u4ee4\n\u89e3\u6790\u5668\u6307\u4ee4\u662f\u53ef\u9009\u7684\uff0c\u4f1a\u5f71\u54cd aDockerfile\u4e2d\u540e\u7eed\u884c\u7684\u5904\u7406\u65b9\u5f0f\u3002\u89e3\u6790\u5668\u6307\u4ee4\u4e0d\u4f1a\u5411\u6784\u5efa\u6dfb\u52a0\u5c42\uff0c\u4e5f\u4e0d\u4f1a\u663e\u793a\u4e3a\u6784\u5efa\u6b65\u9aa4\u3002\u89e3\u6790\u5668\u6307\u4ee4\u662f\u4f5c\u4e3a\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u6ce8\u91ca\u7f16\u5199\u7684# directive=value\u3002\u5355\u4e2a\u6307\u4ee4\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21\u3002\n\n\u5904\u7406\u5b8c\u6ce8\u91ca\u3001\u7a7a\u884c\u6216\u6784\u5efa\u5668\u6307\u4ee4\u540e\uff0cDocker \u4e0d\u518d\u67e5\u627e\u89e3\u6790\u5668\u6307\u4ee4\u3002\u76f8\u53cd\uff0c\u5b83\u5c06\u4efb\u4f55\u683c\u5f0f\u5316\u4e3a\u89e3\u6790\u5668\u6307\u4ee4\u7684\u5185\u5bb9\u89c6\u4e3a\u6ce8\u91ca\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5c1d\u8bd5\u9a8c\u8bc1\u5b83\u662f\u5426\u53ef\u80fd\u662f\u89e3\u6790\u5668\u6307\u4ee4\u3002\u56e0\u6b64\uff0c\u6240\u6709\u89e3\u6790\u5668\u6307\u4ee4\u90fd\u5fc5\u987b\u4f4d\u4e8eDockerfile.\n\n\u89e3\u6790\u5668\u6307\u4ee4\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002\u4f46\u662f\uff0c\u7ea6\u5b9a\u662f\u5c0f\u5199\u7684\u3002\u7ea6\u5b9a\u8fd8\u5305\u62ec\u5728\u4efb\u4f55\u89e3\u6790\u5668\u6307\u4ee4\u4e4b\u540e\u5305\u542b\u4e00\u4e2a\u7a7a\u884c\u3002\u89e3\u6790\u5668\u6307\u4ee4\u4e0d\u652f\u6301\u6362\u884c\u7b26\n\n\u81ea\u5b9a\u4e49 Dockerfile \u5b9e\u73b0\u5141\u8bb8\u60a8\uff1a\n* \u5728\u4e0d\u66f4\u65b0Docker\u5b88\u62a4\u8fdb\u7a0b\u7684\u60c5\u51b5\u4e0b\u81ea\u52a8\u4fee\u590d\u9519\u8bef\n* \u786e\u4fdd\u6240\u6709\u7528\u6237\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u5b9e\u73b0\u6765\u6784\u5efa\u60a8\u7684Dockerfile\n* \u65e0\u9700\u66f4\u65b0Docker\u5b88\u62a4\u7a0b\u5e8f\u5373\u53ef\u4f7f\u7528\u6700\u65b0\u529f\u80fd\n* \u5728\u5c06\u65b0\u529f\u80fd\u6216\u7b2c\u4e09\u65b9\u529f\u80fd\u96c6\u6210\u5230Docker\u5b88\u62a4\u8fdb\u7a0b\u4e4b\u524d\u8bd5\u7528\u5b83\u4eec\n* \u4f7f\u7528\u66ff\u4ee3\u7684\u6784\u5efa\u5b9a\u4e49\uff0c\u6216\u521b\u5efa\u81ea\u5df1\u7684\n\nDockerfile\u4e2d\u7684\u4ee5\u4e0b\u6307\u4ee4\u652f\u6301ENV\u53d8\u91cf\uff1a\n* ADD\n* COPY\n* ENV\n* EXPOSE\n* FROM\n* LABEL\n* STOPSIGNAL\n* USER\n* VOLUME\n* WORKDIR\n* ONBUILD \uff08\u4e0e\u4e0a\u8ff0\u652f\u6301\u7684\u6307\u4ee4\u4e4b\u4e00\u7ed3\u5408\u4f7f\u7528\u65f6\uff09\n\nRUN\u6709\u4e24\u79cd\u5f62\u5f0f\uff1a\nRUN &lt;command&gt;\uff08shell\u5f62\u5f0f\uff0c\u547d\u4ee4\u5728 shell \u4e2d\u8fd0\u884c\uff0c\u9ed8\u8ba4/bin/sh -c\u5728 Linux \u6216cmd /S /CWindows \u4e0a\uff09\nRUN [\"executable\", \"param1\", \"param2\"]\uff08\u6267\u884c\u5f62\u5f0f\uff09\n\u8be5RUN\u6307\u4ee4\u5c06\u5728\u5f53\u524d\u56fe\u50cf\u4e4b\u4e0a\u7684\u65b0\u5c42\u4e2d\u6267\u884c\u4efb\u4f55\u547d\u4ee4\u5e76\u63d0\u4ea4\u7ed3\u679c\u3002\u751f\u6210\u7684\u63d0\u4ea4\u6620\u50cf\u5c06\u7528\u4e8eDockerfile\n\nCMD\u6307\u4ee4\u6709\u4e09\u79cd\u5f62\u5f0f\uff1a\nCMD [\"executable\",\"param1\",\"param2\"]\uff08exec\u5f62\u5f0f\uff0c\u8fd9\u662f\u9996\u9009\u5f62\u5f0f\uff09\nCMD [\"param1\",\"param2\"]\uff08\u4f5c\u4e3aENTRYPOINT \u7684\u9ed8\u8ba4\u53c2\u6570\uff09\nCMD command param1 param2\uff08\u5916\u58f3\u5f62\u5f0f\uff09\nDockerfile\u4e2d\u53ea\u80fd\u6709\u4e00\u6761CMD\u6307\u4ee4\u3002\u5982\u679c\u60a8\u5217\u51fa\u591a\u4e2a\uff0cCMD \u5219\u53ea\u6709\u6700\u540e\u4e00\u4e2aCMD\u624d\u4f1a\u751f\u6548\n\n\u4e0d\u8981\u7591\u60d1RUN\u4e0eCMD. RUN\u5b9e\u9645\u8fd0\u884c\u4e00\u4e2a\u547d\u4ee4\u5e76\u63d0\u4ea4\u7ed3\u679c\uff1bCMD\u5728\u6784\u5efa\u65f6\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\uff0c\u4f46\u4f1a\u6307\u5b9a\u6620\u50cf\u7684\u9884\u671f\u547d\u4ee4\n\nLABEL\u6307\u4ee4\u5411\u56fe\u50cf\u6dfb\u52a0\u5143\u6570\u636e\n\nEXPOSE\u6307\u4ee4\u901a\u77e5 Docker \u5bb9\u5668\u5728\u8fd0\u884c\u65f6\u4fa6\u542c\u6307\u5b9a\u7684\u7f51\u7edc\u7aef\u53e3\u3002\u53ef\u4ee5\u6307\u5b9a\u7aef\u53e3\u662f\u76d1\u542cTCP\u8fd8\u662fUDP\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u534f\u8bae\uff0c\u9ed8\u8ba4\u4e3aTCP\uff0c\u8981\u540c\u65f6\u5728 TCP \u548c UDP \u4e0a\u516c\u5f00\uff0c\u8bf7\u5305\u542b\u4e24\u884c\n\nADD\u6307\u4ee4\u4ece\u4e2d\u590d\u5236\u65b0\u6587\u4ef6\u3001\u76ee\u5f55\u6216\u8fdc\u7a0b\u6587\u4ef6 URL &lt;src&gt; \uff0c\u5e76\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u8def\u5f84 \u5904\u7684\u56fe\u50cf\u6587\u4ef6\u7cfb\u7edf\u4e2d&lt;dest&gt;\n\nCOPY\u6307\u4ee4\u4ece\u4e2d\u590d\u5236\u65b0\u6587\u4ef6\u6216\u76ee\u5f55&lt;src&gt; \u5e76\u5c06\u5b83\u4eec\u6dfb\u52a0\u5230\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u8def\u5f84&lt;dest&gt;\n\nVOLUME\u6307\u4ee4\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u6307\u5b9a\u540d\u79f0\u7684\u6302\u8f7d\u70b9\uff0c\u5e76\u5c06\u5176\u6807\u8bb0\u4e3a\u4fdd\u5b58\u6765\u81ea\u672c\u673a\u4e3b\u673a\u6216\u5176\u4ed6\u5bb9\u5668\u7684\u5916\u90e8\u6302\u8f7d\u5377\u3002\u8be5\u503c\u53ef\u4ee5\u662f JSON \u6570\u7ec4\n\n\u57fa\u4e8e Windows \u7684\u5bb9\u5668\u4e0a\u7684\u5377\uff1a\u4f7f\u7528\u57fa\u4e8e Windows \u7684\u5bb9\u5668\u65f6\uff0c\u5bb9\u5668\u5185\u5377\u7684\u76ee\u6807\u5fc5\u987b\u662f\u4ee5\u4e0b\u4e4b\u4e00\uff1a\n  \u4e00\u4e2a\u4e0d\u5b58\u5728\u6216\u7a7a\u7684\u76ee\u5f55\n  C:\u9a71\u52a8\u5668\u4ee5\u5916\u7684\u9a71\u52a8\u5668\n\u4ece Dockerfile \u4e2d\u66f4\u6539\u5377\uff1a\u5982\u679c\u4efb\u4f55\u6784\u5efa\u6b65\u9aa4\u5728\u58f0\u660e\u5377\u540e\u66f4\u6539\u4e86\u5377\u4e2d\u7684\u6570\u636e\uff0c\u5219\u8fd9\u4e9b\u66f4\u6539\u5c06\u88ab\u4e22\u5f03\u3002\nJSON \u683c\u5f0f\uff1a\u5217\u8868\u88ab\u89e3\u6790\u4e3a JSON \u6570\u7ec4\u3002\u60a8\u5fc5\u987b\u7528\u53cc\u5f15\u53f7 ( \") \u800c\u4e0d\u662f\u5355\u5f15\u53f7 ( ')\u5c06\u5355\u8bcd\u62ec\u8d77\u6765\u3002\n\u4e3b\u673a\u76ee\u5f55\u5728\u5bb9\u5668\u8fd0\u884c\u65f6\u58f0\u660e\uff1a\u4e3b\u673a\u76ee\u5f55\uff08\u6302\u8f7d\u70b9\uff09\u672c\u8d28\u4e0a\u662f\u4f9d\u8d56\u4e8e\u4e3b\u673a\u7684\u3002\u8fd9\u662f\u4e3a\u4e86\u4fdd\u6301\u56fe\u50cf\u7684\u53ef\u79fb\u690d\u6027\uff0c\u56e0\u4e3a\u4e0d\u80fd\u4fdd\u8bc1\u7ed9\u5b9a\u7684\u4e3b\u673a\u76ee\u5f55\u5728\u6240\u6709\u4e3b\u673a\u4e0a\u90fd\u53ef\u7528\u3002\u56e0\u6b64\uff0c\u60a8\u65e0\u6cd5\u4ece Dockerfile \u4e2d\u6302\u8f7d\u4e3b\u673a\u76ee\u5f55\u3002\u8be5VOLUME\u6307\u4ee4\u4e0d\u652f\u6301\u6307\u5b9ahost-dir \u53c2\u6570\u3002\u60a8\u5fc5\u987b\u5728\u521b\u5efa\u6216\u8fd0\u884c\u5bb9\u5668\u65f6\u6307\u5b9a\u6302\u8f7d\u70b9\n\nHEALTHCHECK\u6307\u4ee4\u544a\u8bc9 Docker \u5982\u4f55\u6d4b\u8bd5\u5bb9\u5668\u4ee5\u68c0\u67e5\u5b83\u662f\u5426\u4ecd\u5728\u5de5\u4f5c\u3002\u8fd9\u53ef\u4ee5\u68c0\u6d4b\u8bf8\u5982 Web \u670d\u52a1\u5668\u9677\u5165\u65e0\u9650\u5faa\u73af\u5e76\u4e14\u65e0\u6cd5\u5904\u7406\u65b0\u8fde\u63a5\u4e4b\u7c7b\u7684\u60c5\u51b5\uff0c\u5373\u4f7f\u670d\u52a1\u5668\u8fdb\u7a0b\u4ecd\u5728\u8fd0\u884c\n\nHELL\u6307\u4ee4\u5141\u8bb8\u8986\u76d6\u7528\u4e8e\u547d\u4ee4\u7684shell\u5f62\u5f0f\u7684\u9ed8\u8ba4 shell \u3002Linux \u4e0a\u7684\u9ed8\u8ba4 shell \u662f[\"/bin/sh\", \"-c\"]\uff0cWindows \u4e0a\u662f[\"cmd\", \"/S\", \"/C\"]. \u8be5SHELL\u6307\u4ee4\u5fc5\u987b\u4ee5 JSON \u683c\u5f0f\u5199\u5165 Dockerfile\n\nhttps://docs.docker.com/compose/compose-file/compose-file-v3/\n\n\u91cd\u542f\u7b56\u7565\n\u914d\u7f6e\u662f\u5426\u4ee5\u53ca\u5982\u4f55\u5728\u9000\u51fa\u65f6\u91cd\u65b0\u542f\u52a8\u5bb9\u5668\u3002\u66ff\u6362 restart.\ncondition: none,on-failure\u6216any(\u9ed8\u8ba4: any) \u4e4b\u4e00\u3002\ndelay\uff1a\u91cd\u65b0\u542f\u52a8\u5c1d\u8bd5\u4e4b\u95f4\u7b49\u5f85\u7684\u65f6\u95f4\uff0c\u6307\u5b9a\u4e3a \u6301\u7eed\u65f6\u95f4\uff08\u9ed8\u8ba4\u503c\uff1a5s\uff09\u3002\nmax_attempts\uff1a\u5728\u653e\u5f03\u4e4b\u524d\u5c1d\u8bd5\u91cd\u65b0\u542f\u52a8\u5bb9\u5668\u7684\u6b21\u6570\uff08\u9ed8\u8ba4\u503c\uff1a\u6c38\u4e0d\u653e\u5f03\uff09\u3002\u5982\u679c\u5728\u914d\u7f6e\u7684 \u5185\u91cd\u65b0\u542f\u52a8\u672a\u6210\u529f window\uff0c\u5219\u6b64\u5c1d\u8bd5\u4e0d\u8ba1\u5165\u914d\u7f6emax_attempts\u503c\u3002\u4f8b\u5982\uff0c\u5982\u679cmax_attempts\u8bbe\u7f6e\u4e3a\u201c2\u201d\uff0c\u5e76\u4e14\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u91cd\u542f\u5931\u8d25\uff0c\u5219\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u4e24\u6b21\u4ee5\u4e0a\u7684\u91cd\u542f\u3002\nwindow\uff1a\u5728\u51b3\u5b9a\u91cd\u542f\u662f\u5426\u6210\u529f\u4e4b\u524d\u7b49\u5f85\u591a\u957f\u65f6\u95f4\uff0c\u6307\u5b9a\u4e3a\u6301\u7eed\u65f6\u95f4\uff08\u9ed8\u8ba4\u503c\uff1a\u7acb\u5373\u51b3\u5b9a\n\n\u56de\u6eda\u914d\u7f6e\n\u914d\u7f6e\u5728\u66f4\u65b0\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\u5e94\u5982\u4f55\u56de\u6eda\u670d\u52a1\u3002\nparallelism\uff1a\u4e00\u6b21\u56de\u6eda\u7684\u5bb9\u5668\u6570\u91cf\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a 0\uff0c\u5219\u6240\u6709\u5bb9\u5668\u540c\u65f6\u56de\u6eda\u3002\ndelay\uff1a\u6bcf\u4e2a\u5bb9\u5668\u7ec4\u56de\u6eda\u4e4b\u95f4\u7b49\u5f85\u7684\u65f6\u95f4\uff08\u9ed8\u8ba4\u4e3a 0 \u79d2\uff09\u3002\nfailure_action: \u5982\u679c\u56de\u6eda\u5931\u8d25\u600e\u4e48\u529e\u3002\u5176\u4e2d\u4e00\u4e2acontinue\u6216\u8005pause\uff08\u9ed8\u8ba4pause\uff09\nmonitor\uff1a\u6bcf\u6b21\u4efb\u52a1\u66f4\u65b0\u540e\u76d1\u63a7\u5931\u8d25\u7684\u6301\u7eed\u65f6\u95f4(ns|us|ms|s|m|h)\uff08\u9ed8\u8ba4 5s\uff09\u6ce8\u610f\uff1a\u8bbe\u7f6e\u4e3a 0 \u5c06\u4f7f\u7528\u9ed8\u8ba4 5s\u3002\nmax_failure_ratio\uff1a\u56de\u6eda\u671f\u95f4\u5141\u8bb8\u7684\u6545\u969c\u7387\uff08\u9ed8\u8ba4\u4e3a 0\uff09\u3002\norder\uff1a\u56de\u6eda\u671f\u95f4\u7684\u64cd\u4f5c\u987a\u5e8f\u3002\u4e4b\u4e00stop-first\uff08\u65e7\u4efb\u52a1\u5728\u5f00\u59cb\u65b0\u4efb\u52a1\u4e4b\u524d\u505c\u6b62\uff09\uff0c\u6216start-first\uff08\u9996\u5148\u542f\u52a8\u65b0\u4efb\u52a1\uff0c\u5e76\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u77ed\u6682\u91cd\u53e0\uff09\uff08\u9ed8\u8ba4stop-first\uff09\u3002\n\n\u66f4\u65b0\u914d\u7f6e\n\u914d\u7f6e\u5e94\u5982\u4f55\u66f4\u65b0\u670d\u52a1\u3002\u7528\u4e8e\u914d\u7f6e\u6eda\u52a8\u66f4\u65b0\u3002\nparallelism\uff1a\u4e00\u6b21\u66f4\u65b0\u7684\u5bb9\u5668\u6570\u91cf\u3002\ndelay\uff1a\u66f4\u65b0\u4e00\u7ec4\u5bb9\u5668\u4e4b\u95f4\u7684\u7b49\u5f85\u65f6\u95f4\u3002\nfailure_action: \u5982\u679c\u66f4\u65b0\u5931\u8d25\u600e\u4e48\u529e\u3002\u5176\u4e2d\u4e00\u4e2acontinue\uff0crollback\u6216\u8005pause \uff08\u9ed8\u8ba4\uff1apause\uff09\nmonitor\uff1a\u6bcf\u6b21\u4efb\u52a1\u66f4\u65b0\u540e\u76d1\u63a7\u5931\u8d25\u7684\u6301\u7eed\u65f6\u95f4(ns|us|ms|s|m|h)\uff08\u9ed8\u8ba4 5s\uff09\u6ce8\u610f\uff1a\u8bbe\u7f6e\u4e3a 0 \u5c06\u4f7f\u7528\u9ed8\u8ba4 5s\u3002\nmax_failure_ratio\uff1a\u66f4\u65b0\u671f\u95f4\u53ef\u5bb9\u5fcd\u7684\u6545\u969c\u7387\u3002\norder\uff1a\u66f4\u65b0\u671f\u95f4\u7684\u64cd\u4f5c\u987a\u5e8f\u3002\u4e4b\u4e00stop-first\uff08\u65e7\u4efb\u52a1\u5728\u5f00\u59cb\u65b0\u4efb\u52a1\u4e4b\u524d\u505c\u6b62\uff09\uff0c\u6216start-first\uff08\u65b0\u4efb\u52a1\u9996\u5148\u542f\u52a8\uff0c\u5e76\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u77ed\u6682\u91cd\u53e0\uff09\uff08\u9ed8\u8ba4stop-first\uff09\u6ce8\u610f\uff1a\u4ec5\u652f\u6301 v3.4 \u53ca\u66f4\u9ad8\u7248\u672c\n</code></pre>"},{"location":"cloud-native/Docker/#_3","title":"\u5b9e\u4f8b","text":"Bash<pre><code>## \u6e05\u7406\u5197\u4f59container\u548cimage\uff0c\u53ef\u91c7\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a\n\n### \u505c\u6b62\u6240\u6709\u7684container\uff0c\u8fd9\u6837\u624d\u80fd\u591f\u5220\u9664\u5176\u4e2d\u7684images\uff1a\n\ndocker stop $(docker ps -a -q)\n\n### \u5982\u679c\u60f3\u8981\u5220\u9664\u6240\u6709container\u7684\u8bdd\u518d\u52a0\u4e00\u4e2a\u6307\u4ee4\uff1a\n\ndocker rm -f $(docker ps -a -q)\n\n### \u6839\u636e\u8fc7\u6ee4\u6761\u4ef6\u5220\u9664container\uff0c\u4f8b\u5982\uff1a\u5220\u9664\u67d0container\u4e4b\u524d\u7684container\n\ndocker rm -f $(sudo docker ps --before=\"container_id_here\" -q)\n\n### \u5220\u9664\u6240\u6709\u9000\u51fa\u72b6\u6001\u7684container\n\ndocker rm $(docker ps -q -f status=exited)\n\n# \u60f3\u8981\u5220\u9664untagged images\uff0c\u4e5f\u5c31\u662f\u90a3\u4e9bid\u4e3aNone\u7684image\u7684\u8bdd\u53ef\u4ee5\u7528\ndocker rmi $(docker images | grep \"^&lt;none&gt;\" | awk \"{print $3}\")\n\n# \u8981\u5220\u9664\u5168\u90e8image\u7684\u8bdd\ndocker rmi $(docker images -q)\n\n# \u540c\u65f6\u5220\u9664container\u548cimages\ndocker ps -a --no-trunc  | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker stop &amp;&amp; \\\ndocker ps -a --no-trunc  | grep \"search_term_here\" | awk \"{print $1}\" | xargs -r --no-run-if-empty docker rm &amp;&amp; \\\ndocker images --no-trunc | grep \"search_term_here\" | awk \"{print $3}\" | xargs -r --no-run-if-empty docker rmi\n\n# \u5220\u9664exited\u72b6\u6001\u548cnon-tagged\u7684\u5bb9\u5668\ndocker ps --filter 'status=Exited' -a | xargs docker stop docker images --filter \"dangling=true\" -q | xargs docker rmi\n\ndocker volume inspect {container}   # \u67e5\u770b\u5bb9\u5668\u6570\u636e\u5b58\u50a8\u4f4d\u7f6e\ndocker volume rm $(docker volume ls -qf dangling=true)  # \u6e05\u7406orphaned volumes\n\ndocker network rm $(docker network ls -q)   # clean up orphaned networks\n\n## NEW IMAGES/CONTAINERS\n\n\\# create new docker container, ie. ubuntu\ndocker pull ubuntu:latest # 1x pull down image\ndocker run -i -t ubuntu /bin/bash # drops you into new container as root\n</code></pre>"},{"location":"cloud-native/Docker/#_4","title":"\u95ee\u9898\u53ca\u6545\u969c\u89e3\u51b3\u529e\u6cd5","text":"<p>1.question\uff1aCannot connect to the Docker daemon. Is 'docker -d' running on this host?</p> <p>yum install -y device-mapper-libs device-mapper</p> <p>2.helps whit error:'unexpected end of JON input'</p> <p>docker rm -f $(docker ps -a -q)</p> <p>#go to container command line docker exec -it \"container_name_here\" bash</p>"},{"location":"cloud-native/Knative/","title":"Knative","text":"Markdown<pre><code>Knative Serving \u670d\u52a1\u7ec4\u4ef6\nKnative Eventing \u4e8b\u4ef6\u7ec4\u4ef6\n</code></pre>"},{"location":"cloud-native/Knative/#hashicorp-terraform","title":"Hashicorp Terraform","text":""},{"location":"cloud-native/Knative/#hashicorp-consul","title":"Hashicorp Consul","text":"Markdown<pre><code>consul join \u624b\u52a8\u8fde\u63a5\u521b\u5efa\u96c6\u7fa4\nconsul info \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f\nconsul kv get -recurse  \u5217\u51fa\u6240\u6709\u952e\u503c\u5b58\u50a8\n\nsudo chown root:root consul\nsudo mv consul /usr/local/bin/\nconsul -autocomplete-install\ncomplete -C /usr/local/bin/consul consul\nsudo useradd --system --home /etc/consul.d --shell /bin/false consul\n\u521b\u5efa\u6570\u636e\u76ee\u5f55\nsudo mkdir --parents /opt/consul\nsudo chown --recursive consul:consul /opt/consul\n\nsudo cat &gt; /etc/systemd/system/consul.service &lt;&lt;EOF\n[Unit]\nDescription=\"HashiCorp Consul - A service mesh solution\"\nDocumentation=https://www.consul.io/\nRequires=network-online.target\nAfter=network-online.target\nConditionFileNotEmpty=/etc/consul.d/consul.hcl\n\n[Service]\nType=notify\nUser=consul\nGroup=consul\nExecStart=/usr/local/bin/consul agent -config-dir=/etc/consul.d/\nExecReload=/usr/local/bin/consul reload\nKillMode=process\nRestart=on-failure\nLimitNOFILE=65536\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo mkdir --parents /etc/consul.d\nsudo touch /etc/consul.d/consul.hcl\nsudo chown --recursive consul:consul /etc/consul.d\nsudo chmod 640 /etc/consul.d/consul.hcl\n\nencrypt- \u6307\u5b9a\u7528\u4e8e\u52a0\u5bc6consul\u7f51\u7edc\u6d41\u91cf\u7684\u5bc6\u94a5,\u4f7f\u7528consul keygen\u547d\u4ee4\u6765\u751f\u6210\ncat &gt; /etc/consul.d/consul.hcl &lt;&lt;EOF\ndatacenter = \"dc1\"\ndata_dir = \"/opt/consul\"\nencrypt = \"Luj2FZWwlt8475wD1WtwUQ==\"\nEOF\n</code></pre> <p>sudo mkdir --parents /etc/consul.d sudo touch /etc/consul.d/server.hcl sudo chown --recursive consul:consul /etc/consul.d sudo chmod 640 /etc/consul.d/server.hcl3</p> <p>ui = true   \u5f00\u542fui\u754c\u9762\uff0c\u53ea\u9700\u9009\u5b9a\u4e00\u53f0\u8fd0\u884cui\u5373\u53ef server- \u7528\u4e8e\u63a7\u5236\u4ee3\u7406\u662f\u5426\u5904\u4e8e\u670d\u52a1\u5668\u6216\u5ba2\u6237\u7aef\u6a21\u5f0f bootstrap-expect- \u63d0\u4f9b\u6570\u636e\u4e2d\u5fc3\u4e2d\u7684\u9884\u671f\u670d\u52a1\u5668\u6570 cat &gt; /etc/consul.d/server.hcl &lt;&lt;EOF server = true bootstrap_expect = 3 EOF</p>"},{"location":"cloud-native/Knative/#hashicorp-vault","title":"Hashicorp Vault","text":""},{"location":"cloud-native/Knative/#hashicorp","title":"Hashicorp","text":""},{"location":"cloud-native/Kubernetes/","title":"Kubernetes","text":"Markdown<pre><code>Kubernetes\u901a\u8fc7\u5c06\u5bb9\u5668\u653e\u5165\u5728\u8282\u70b9\uff08Node\uff09\u4e0a\u8fd0\u884c\u7684Pod\u4e2d\u6765\u6267\u884c\u4f60\u7684\u5de5\u4f5c\u8d1f\u8f7d\u3002\u8282\u70b9\u53ef\u4ee5\u662f\u4e00\u4e2a\u865a\u62df\u673a\u6216\u8005\u7269\u7406\u673a\u5668\uff0c\u53d6\u51b3\u4e8e\u6240\u5728\u7684\u96c6\u7fa4\u914d\u7f6e\u3002\u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u8fd0\u884cPods\u6240\u9700\u7684\u670d\u52a1\uff0c\u8fd9\u4e9bPods\u7531Control Plane\u8d1f\u8d23\u7ba1\u7406\nnode\u4e0a\u7ec4\u4ef6\u5305\u62ec\uff1akubelet\u3001container runtime\u3001kube-proxy\nnode\u5bf9\u8c61\u7684\u540d\u79f0\u5fc5\u987b\u662f\u5408\u6cd5\u7684DNS\u5b50\u57df\u540d\n\n![\u90e8\u7f72\u65b9\u5f0f\u6f14\u53d8\u56fe](https://d33wubrfki0l68.cloudfront.net/26a177ede4d7b032362289c6fccd448fc4a91174/eb693/images/docs/container_evolution.svg)\n\n![Kubernetes\u7ec4\u4ef6\u56fe](https://d33wubrfki0l68.cloudfront.net/2475489eaf20163ec0f54ddc1d92aa8d4c87c96b/e7c81/images/docs/components-of-kubernetes.svg)\n\n## k8s\u7ec4\u4ef6\n\n### \u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\n\nkube-apiserver\uff1akube-apiserver\u53ef\u901a\u8fc7\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u5728\u8fd9\u4e9b\u5b9e\u4f8b\u4e4b\u95f4\u5e73\u8861\u6d41\u91cf\netcd\uff1a\u4e00\u81f4\u6027\u548c\u9ad8\u53ef\u7528\uff0c\u4f5c\u4e3a\u4fdd\u5b58k8s\u6240\u6709\u96c6\u7fa4\u6570\u636e\u7684\u540e\u53f0\u6570\u636e\u5e93\nkube-scheduler\uff1a\u8d1f\u8d23\u76d1\u89c6\u65b0\u521b\u5efa\u3001\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9node\u7684pods\uff0c\u5206\u914dpod\u5230\u67d0\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u8c03\u5ea6\u4e3b\u8981\u8003\u8651\u56e0\u7d20\u662fpod\u7684\u8d44\u6e90\u9700\u6c42\u3001\u8f6f\u786c\u4ef6\u6216\u7b56\u7565\u7684\u7ea6\u675f\u3001\u4eb2\u548c\u6027\u548c\u53cd\u4eb2\u548c\u6027\u89c4\u8303\u3001\u6570\u636e\u4f4d\u7f6e\u3001\u5de5\u4f5c\u8d1f\u8f7d\u95f4\u7684\u5e72\u6270\u548c\u6700\u540e\u65f6\u9650\nkube-controller-manage\uff1a\u5728node\u8282\u70b9\u8fd0\u884c\u63a7\u5236\u5668\u7684\u7ec4\u4ef6\ncloud-controller-manager\uff1a\u4e91\u63a7\u5236\u7ba1\u7406\u5668\u662f\u6307\u5d4c\u5165\u7279\u5b9a\u4e91\u7684\u63a7\u5236\u903b\u8f91\u7684\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6\n\n### Node\u7ec4\u4ef6\n\nkubelet\uff1a\u96c6\u7fa4\u4e2d\u5728\u6bcf\u4e2anode\u8282\u70b9\u8fd0\u884c\u7684\u4ee3\u7406\uff0c\u5176\u4fdd\u8bc1\u6bcf\u4e2a\u5bb9\u5668\u90fd\u8fd0\u884c\u5728pod\u4e2d\uff0ckubelet\u4e0d\u4f1a\u7ba1\u7406\u975ek8s\u521b\u5efa\u7684\u5bb9\u5668\nkube-proxy\uff1a\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff0ckube-proxy\u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u7f51\u7edc\u89c4\u5219\uff0c\u8fd9\u4e9b\u89c4\u5219\u5141\u8bb8\u4ece\u96c6\u7fa4\u5185\u90e8\u6216\u5916\u90e8\u4e0epod\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1\n\u5bb9\u5668\u8fdb\u884c\u65f6(container runtime)\uff1a\u5bb9\u5668\u8fd0\u884c\u65f6\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u7684\u7ec4\u4ef6\n\n### \u63d2\u4ef6(Addons)\n\n\u63d2\u4ef6\u4f7f\u7528k8s\u8d44\u6e90(DaemonSet\u3001Deployment\u7b49)\u5b9e\u73b0\u96c6\u7fa4\u529f\u80fd\uff0c\u63d2\u4ef6\u547d\u540d\u7a7a\u95f4\u57df\u7684\u8d44\u6e90\u5c5e\u4e8ekube-system\u547d\u540d\u7a7a\u95f4\n\u5b8c\u6574\u63d2\u4ef6\u5217\u8868\uff1a![Addons](https://kubernetes.io/zh/docs/concepts/cluster-administration/addons)\n\n![k8s\u57fa\u672c\u67b6\u6784\u4ecb\u7ecd](https://kubernetes.io/zh/docs/concepts/architecture)\n\n\n## Kubernetes\u63d0\u4f9b\u82e5\u5e72\u79cd\u5185\u7f6e\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8d44\u6e90\uff1a\n\n* Deployment\u548cReplicaSet\uff08\u66ff\u6362\u539f\u6765\u7684\u8d44\u6e90ReplicationController\uff09\u3002Deployment\u5f88\u9002\u5408\u7528\u6765\u7ba1\u7406\u4f60\u7684\u96c6\u7fa4\u4e0a\u7684\u65e0\u72b6\u6001\u5e94\u7528\uff0cDeployment\u4e2d\u7684\u6240\u6709Pod\u90fd\u662f\u76f8\u4e92\u7b49\u4ef7\u7684\uff0c\u5e76\u4e14\u5728\u9700\u8981\u7684\u65f6\u5019\u88ab\u6362\u6389\n* StatefulSet\u8ba9\u4f60\u80fd\u591f\u8fd0\u884c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8ddf\u8e2a\u5e94\u7528\u72b6\u6001\u7684Pods\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u7684\u8d1f\u8f7d\u4f1a\u5c06\u6570\u636e\u4f5c\u6301\u4e45\u5b58\u50a8\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e2aStatefulSet\uff0c\u5c06\u6bcf\u4e2aPod\u4e0e\u67d0\u4e2aPersistentVolume\u5bf9\u5e94\u8d77\u6765\u3002\u4f60\u5728StatefulSet\u4e2d\u5404\u4e2aPod\u5185\u8fd0\u884c\u7684\u4ee3\u7801\u53ef\u4ee5\u5c06\u6570\u636e\u590d\u5236\u5230\u540c\u4e00StatefulSet\u4e2d\u7684\u5176\u5b83Pod\u4e2d\u4ee5\u63d0\u9ad8\u6574\u4f53\u7684\u670d\u52a1\u53ef\u9760\u6027\n* DaemonSet\u5b9a\u4e49\u63d0\u4f9b\u8282\u70b9\u672c\u5730\u652f\u6491\u8bbe\u65bd\u7684Pods\u3002\u8fd9\u4e9bPods\u53ef\u80fd\u5bf9\u4e8e\u4f60\u7684\u96c6\u7fa4\u7684\u8fd0\u7ef4\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u4f8b\u5982\u4f5c\u4e3a\u7f51\u7edc\u94fe\u63a5\u7684\u8f85\u52a9\u5de5\u5177\u6216\u8005\u4f5c\u4e3a\u7f51\u7edc\u63d2\u4ef6\u7684\u4e00\u90e8\u5206\u7b49\u7b49\u3002\u6bcf\u6b21\u4f60\u5411\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\u65f6\uff0c\u5982\u679c\u8be5\u8282\u70b9\u4e0e\u67d0DaemonSet\u7684\u89c4\u7ea6\u5339\u914d\uff0c\u5219\u63a7\u5236\u9762\u4f1a\u4e3a\u8be5DaemonSet\u8c03\u5ea6\u4e00\u4e2aPod\u5230\u8be5\u65b0\u8282\u70b9\u4e0a\u8fd0\u884c\n* Job\u548cCronJob\u3002\u5b9a\u4e49\u4e00\u4e9b\u4e00\u76f4\u8fd0\u884c\u5230\u7ed3\u675f\u5e76\u505c\u6b62\u7684\u4efb\u52a1\u3002Job\u7528\u6765\u8868\u8fbe\u7684\u662f\u4e00\u6b21\u6027\u7684\u4efb\u52a1\uff0c\u800cCronJob\u4f1a\u6839\u636e\u5176\u65f6\u95f4\u89c4\u5212\u53cd\u590d\u8fd0\u884c\n</code></pre>"},{"location":"cloud-native/Kubernetes/#k8s","title":"k8s\u7ec4\u4ef6","text":""},{"location":"cloud-native/Kubernetes/#_1","title":"\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6","text":"<p>kube-apiserver\uff1akube-apiserver\u53ef\u901a\u8fc7\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u5728\u8fd9\u4e9b\u5b9e\u4f8b\u4e4b\u95f4\u5e73\u8861\u6d41\u91cf etcd\uff1a\u4e00\u81f4\u6027\u548c\u9ad8\u53ef\u7528\uff0c\u4f5c\u4e3a\u4fdd\u5b58k8s\u6240\u6709\u96c6\u7fa4\u6570\u636e\u7684\u540e\u53f0\u6570\u636e\u5e93 kube-scheduler\uff1a\u8d1f\u8d23\u76d1\u89c6\u65b0\u521b\u5efa\u3001\u672a\u6307\u5b9a\u8fd0\u884c\u8282\u70b9node\u7684pods\uff0c\u5206\u914dpod\u5230\u67d0\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\uff0c\u8c03\u5ea6\u4e3b\u8981\u8003\u8651\u56e0\u7d20\u662fpod\u7684\u8d44\u6e90\u9700\u6c42\u3001\u8f6f\u786c\u4ef6\u6216\u7b56\u7565\u7684\u7ea6\u675f\u3001\u4eb2\u548c\u6027\u548c\u53cd\u4eb2\u548c\u6027\u89c4\u8303\u3001\u6570\u636e\u4f4d\u7f6e\u3001\u5de5\u4f5c\u8d1f\u8f7d\u95f4\u7684\u5e72\u6270\u548c\u6700\u540e\u65f6\u9650 kube-controller-manage\uff1a\u5728node\u8282\u70b9\u8fd0\u884c\u63a7\u5236\u5668\u7684\u7ec4\u4ef6 cloud-controller-manager\uff1a\u4e91\u63a7\u5236\u7ba1\u7406\u5668\u662f\u6307\u5d4c\u5165\u7279\u5b9a\u4e91\u7684\u63a7\u5236\u903b\u8f91\u7684\u63a7\u5236\u5e73\u9762\u7ec4\u4ef6</p>"},{"location":"cloud-native/Kubernetes/#node","title":"Node\u7ec4\u4ef6","text":"<p>kubelet\uff1a\u96c6\u7fa4\u4e2d\u5728\u6bcf\u4e2anode\u8282\u70b9\u8fd0\u884c\u7684\u4ee3\u7406\uff0c\u5176\u4fdd\u8bc1\u6bcf\u4e2a\u5bb9\u5668\u90fd\u8fd0\u884c\u5728pod\u4e2d\uff0ckubelet\u4e0d\u4f1a\u7ba1\u7406\u975ek8s\u521b\u5efa\u7684\u5bb9\u5668 kube-proxy\uff1a\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u8fd0\u884c\u7684\u7f51\u7edc\u4ee3\u7406\uff0ckube-proxy\u7ef4\u62a4\u8282\u70b9\u4e0a\u7684\u7f51\u7edc\u89c4\u5219\uff0c\u8fd9\u4e9b\u89c4\u5219\u5141\u8bb8\u4ece\u96c6\u7fa4\u5185\u90e8\u6216\u5916\u90e8\u4e0epod\u8fdb\u884c\u7f51\u7edc\u901a\u4fe1 \u5bb9\u5668\u8fdb\u884c\u65f6(container runtime)\uff1a\u5bb9\u5668\u8fd0\u884c\u65f6\u662f\u8d1f\u8d23\u8fd0\u884c\u5bb9\u5668\u7684\u7ec4\u4ef6</p>"},{"location":"cloud-native/Kubernetes/#addons","title":"\u63d2\u4ef6(Addons)","text":"<p>\u63d2\u4ef6\u4f7f\u7528k8s\u8d44\u6e90(DaemonSet\u3001Deployment\u7b49)\u5b9e\u73b0\u96c6\u7fa4\u529f\u80fd\uff0c\u63d2\u4ef6\u547d\u540d\u7a7a\u95f4\u57df\u7684\u8d44\u6e90\u5c5e\u4e8ekube-system\u547d\u540d\u7a7a\u95f4 \u5b8c\u6574\u63d2\u4ef6\u5217\u8868\uff1a</p> <p>Ingress \u662f\u5bf9\u96c6\u7fa4\u4e2d\u670d\u52a1\u7684\u5916\u90e8\u8bbf\u95ee\u8fdb\u884c\u7ba1\u7406\u7684 API \u5bf9\u8c61\uff0c\u5178\u578b\u7684\u8bbf\u95ee\u65b9\u5f0f\u662fHTTP\uff0c\u5fc5\u987b\u5177\u6709 Ingress \u63a7\u5236\u5668 \u624d\u80fd\u6ee1\u8db3 Ingress \u7684\u8981\u6c42\u3002 \u4ec5\u521b\u5efa Ingress \u8d44\u6e90\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u6548\u679c</p> <p>Istio Ingress \u662f\u4e00\u4e2a\u57fa\u4e8e Istio \u7684 Ingress \u63a7\u5236\u5668 HAProxy Ingress \u9488\u5bf9 HAProxy \u7684 Ingress \u63a7\u5236\u5668 \u7528\u4e8e Kubernetes \u7684 NGINX Ingress \u63a7\u5236\u5668 \u80fd\u591f\u4e0e NGINX Web \u670d\u52a1\u5668\uff08\u4f5c\u4e3a\u4ee3\u7406\uff09 \u4e00\u8d77\u4f7f\u7528</p> <p>Kubernetes\u63d0\u4f9b\u82e5\u5e72\u79cd\u5185\u7f6e\u7684\u5de5\u4f5c\u8d1f\u8f7d\u8d44\u6e90\uff1a</p> <ul> <li>Deployment\u548cReplicaSet\uff08\u66ff\u6362\u539f\u6765\u7684\u8d44\u6e90ReplicationController\uff09\u3002Deployment\u5f88\u9002\u5408\u7528\u6765\u7ba1\u7406\u4f60\u7684\u96c6\u7fa4\u4e0a\u7684\u65e0\u72b6\u6001\u5e94\u7528\uff0cDeployment\u4e2d\u7684\u6240\u6709Pod\u90fd\u662f\u76f8\u4e92\u7b49\u4ef7\u7684\uff0c\u5e76\u4e14\u5728\u9700\u8981\u7684\u65f6\u5019\u88ab\u6362\u6389</li> <li>StatefulSet\u8ba9\u4f60\u80fd\u591f\u8fd0\u884c\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8ddf\u8e2a\u5e94\u7528\u72b6\u6001\u7684Pods\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u7684\u8d1f\u8f7d\u4f1a\u5c06\u6570\u636e\u4f5c\u6301\u4e45\u5b58\u50a8\uff0c\u4f60\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e2aStatefulSet\uff0c\u5c06\u6bcf\u4e2aPod\u4e0e\u67d0\u4e2aPersistentVolume\u5bf9\u5e94\u8d77\u6765\u3002\u4f60\u5728StatefulSet\u4e2d\u5404\u4e2aPod\u5185\u8fd0\u884c\u7684\u4ee3\u7801\u53ef\u4ee5\u5c06\u6570\u636e\u590d\u5236\u5230\u540c\u4e00StatefulSet\u4e2d\u7684\u5176\u5b83Pod\u4e2d\u4ee5\u63d0\u9ad8\u6574\u4f53\u7684\u670d\u52a1\u53ef\u9760\u6027</li> <li>DaemonSet\u5b9a\u4e49\u63d0\u4f9b\u8282\u70b9\u672c\u5730\u652f\u6491\u8bbe\u65bd\u7684Pods\u3002\u8fd9\u4e9bPods\u53ef\u80fd\u5bf9\u4e8e\u4f60\u7684\u96c6\u7fa4\u7684\u8fd0\u7ef4\u662f\u975e\u5e38\u91cd\u8981\u7684\uff0c\u4f8b\u5982\u4f5c\u4e3a\u7f51\u7edc\u94fe\u63a5\u7684\u8f85\u52a9\u5de5\u5177\u6216\u8005\u4f5c\u4e3a\u7f51\u7edc\u63d2\u4ef6\u7684\u4e00\u90e8\u5206\u7b49\u7b49\u3002\u6bcf\u6b21\u4f60\u5411\u96c6\u7fa4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u8282\u70b9\u65f6\uff0c\u5982\u679c\u8be5\u8282\u70b9\u4e0e\u67d0DaemonSet\u7684\u89c4\u7ea6\u5339\u914d\uff0c\u5219\u63a7\u5236\u9762\u4f1a\u4e3a\u8be5DaemonSet\u8c03\u5ea6\u4e00\u4e2aPod\u5230\u8be5\u65b0\u8282\u70b9\u4e0a\u8fd0\u884c</li> <li>Job\u548cCronJob\u3002\u5b9a\u4e49\u4e00\u4e9b\u4e00\u76f4\u8fd0\u884c\u5230\u7ed3\u675f\u5e76\u505c\u6b62\u7684\u4efb\u52a1\u3002Job\u7528\u6765\u8868\u8fbe\u7684\u662f\u4e00\u6b21\u6027\u7684\u4efb\u52a1\uff0c\u800cCronJob\u4f1a\u6839\u636e\u5176\u65f6\u95f4\u89c4\u5212\u53cd\u590d\u8fd0\u884c</li> </ul> <p>Pod \u7684 status \u5b57\u6bb5\u662f\u4e00\u4e2a PodStatus \u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a phase \u5b57\u6bb5\u3002</p> <p>Pod \u7684\u9636\u6bb5\uff08Phase\uff09\u662f Pod \u5728\u5176\u751f\u547d\u5468\u671f\u4e2d\u6240\u5904\u4f4d\u7f6e\u7684\u7b80\u5355\u5b8f\u89c2\u6982\u8ff0\u3002 \u8be5\u9636\u6bb5\u5e76\u4e0d\u662f\u5bf9\u5bb9\u5668\u6216 Pod \u72b6\u6001\u7684\u7efc\u5408\u6c47\u603b\uff0c\u4e5f\u4e0d\u662f\u4e3a\u4e86\u6210\u4e3a\u5b8c\u6574\u7684\u72b6\u6001\u673a\u3002 Pod \u9636\u6bb5\u7684\u6570\u91cf\u548c\u542b\u4e49\u662f\u4e25\u683c\u5b9a\u4e49\u7684\u3002 \u9664\u4e86\u672c\u6587\u6863\u4e2d\u5217\u4e3e\u7684\u5185\u5bb9\u5916\uff0c\u4e0d\u5e94\u8be5\u518d\u5047\u5b9a Pod \u6709\u5176\u4ed6\u7684 phase \u503c\u3002 \u4e0b\u9762\u662f phase \u53ef\u80fd\u7684\u503c\uff1a \u53d6\u503c  \u63cf\u8ff0 Pending\uff08\u60ac\u51b3\uff09 Pod \u5df2\u88ab Kubernetes \u7cfb\u7edf\u63a5\u53d7\uff0c\u4f46\u6709\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5bb9\u5668\u5c1a\u672a\u521b\u5efa\u4ea6\u672a\u8fd0\u884c\u3002\u6b64\u9636\u6bb5\u5305\u62ec\u7b49\u5f85 Pod \u88ab\u8c03\u5ea6\u7684\u65f6\u95f4\u548c\u901a\u8fc7\u7f51\u7edc\u4e0b\u8f7d\u955c\u50cf\u7684\u65f6\u95f4\uff0c Running\uff08\u8fd0\u884c\u4e2d\uff09    Pod \u5df2\u7ecf\u7ed1\u5b9a\u5230\u4e86\u67d0\u4e2a\u8282\u70b9\uff0cPod \u4e2d\u6240\u6709\u7684\u5bb9\u5668\u90fd\u5df2\u88ab\u521b\u5efa\u3002\u81f3\u5c11\u6709\u4e00\u4e2a\u5bb9\u5668\u4ecd\u5728\u8fd0\u884c\uff0c\u6216\u8005\u6b63\u5904\u4e8e\u542f\u52a8\u6216\u91cd\u542f\u72b6\u6001\u3002 Succeeded\uff08\u6210\u529f\uff09   Pod \u4e2d\u7684\u6240\u6709\u5bb9\u5668\u90fd\u5df2\u6210\u529f\u7ec8\u6b62\uff0c\u5e76\u4e14\u4e0d\u4f1a\u518d\u91cd\u542f\u3002 Failed\uff08\u5931\u8d25\uff09  Pod \u4e2d\u7684\u6240\u6709\u5bb9\u5668\u90fd\u5df2\u7ec8\u6b62\uff0c\u5e76\u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u5bb9\u5668\u662f\u56e0\u4e3a\u5931\u8d25\u7ec8\u6b62\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bb9\u5668\u4ee5\u975e 0 \u72b6\u6001\u9000\u51fa\u6216\u8005\u88ab\u7cfb\u7edf\u7ec8\u6b62\u3002 Unknown\uff08\u672a\u77e5\uff09 \u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u65e0\u6cd5\u53d6\u5f97 Pod \u7684\u72b6\u6001\u3002\u8fd9\u79cd\u60c5\u51b5\u901a\u5e38\u662f\u56e0\u4e3a\u4e0e Pod \u6240\u5728\u4e3b\u673a\u901a\u4fe1\u5931\u8d25</p> <p>Kubernetes \u652f\u6301\u5f88\u591a\u7c7b\u578b\u7684\u5377\u3002 Pod \u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u4efb\u610f\u6570\u76ee\u7684\u5377\u7c7b\u578b\u3002 \u4e34\u65f6\u5377\u7c7b\u578b\u7684\u751f\u547d\u5468\u671f\u4e0e Pod \u76f8\u540c\uff0c\u4f46\u6301\u4e45\u5377\u53ef\u4ee5\u6bd4 Pod \u7684\u5b58\u6d3b\u671f\u957f\u3002 \u56e0\u6b64\uff0c\u5377\u7684\u5b58\u5728\u65f6\u95f4\u4f1a\u8d85\u51fa Pod \u4e2d\u8fd0\u884c\u7684\u6240\u6709\u5bb9\u5668\uff0c\u5e76\u4e14\u5728\u5bb9\u5668\u91cd\u65b0\u542f\u52a8\u65f6\u6570\u636e\u4e5f\u4f1a\u5f97\u5230\u4fdd\u7559\u3002 \u5f53 Pod \u4e0d\u518d\u5b58\u5728\u65f6\uff0c\u4e34\u65f6\u5377\u4e5f\u5c06\u4e0d\u518d\u5b58\u5728\u3002\u4f46\u662f\u6301\u4e45\u5377\u4f1a\u7ee7\u7eed\u5b58\u5728 Kubernetes \u652f\u6301\u4e0b\u5217\u7c7b\u578b\u7684\u5377 cephfs cephfs \u5377\u5141\u8bb8\u4f60\u5c06\u73b0\u5b58\u7684 CephFS \u5377\u6302\u8f7d\u5230 Pod \u4e2d\u3002 \u4e0d\u50cf emptyDir \u90a3\u6837\u4f1a\u5728 Pod \u88ab\u5220\u9664\u7684\u540c\u65f6\u4e5f\u4f1a\u88ab\u5220\u9664\uff0ccephfs \u5377\u7684\u5185\u5bb9\u5728 Pod \u88ab\u5220\u9664 \u65f6\u4f1a\u88ab\u4fdd\u7559\uff0c\u53ea\u662f\u5377\u88ab\u5378\u8f7d\u4e86\u3002\u8fd9\u610f\u5473\u7740 cephfs \u5377\u53ef\u4ee5\u88ab\u9884\u5148\u586b\u5145\u6570\u636e\uff0c\u4e14\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728 Pod \u4e4b\u95f4\u5171\u4eab\u3002\u540c\u4e00 cephfs \u5377\u53ef\u540c\u65f6\u88ab\u591a\u4e2a\u5199\u8005\u6302\u8f7d</p> <p>configMap configMap \u5377 \u63d0\u4f9b\u4e86\u5411 Pod \u6ce8\u5165\u914d\u7f6e\u6570\u636e\u7684\u65b9\u6cd5\u3002 ConfigMap \u5bf9\u8c61\u4e2d\u5b58\u50a8\u7684\u6570\u636e\u53ef\u4ee5\u88ab configMap \u7c7b\u578b\u7684\u5377\u5f15\u7528\uff0c\u7136\u540e\u88ab Pod \u4e2d\u8fd0\u884c\u7684 \u5bb9\u5668\u5316\u5e94\u7528\u4f7f\u7528\u3002 \u5f15\u7528 configMap \u5bf9\u8c61\u65f6\uff0c\u4f60\u53ef\u4ee5\u5728 volume \u4e2d\u901a\u8fc7\u5b83\u7684\u540d\u79f0\u6765\u5f15\u7528\u3002 \u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49 ConfigMap \u4e2d\u7279\u5b9a\u6761\u76ee\u6240\u8981\u4f7f\u7528\u7684\u8def\u5f84 \u8bf4\u660e\uff1a \u5728\u4f7f\u7528 ConfigMap \u4e4b\u524d\u4f60\u9996\u5148\u8981\u521b\u5efa\u5b83\u3002 \u5bb9\u5668\u4ee5 subPath \u5377\u6302\u8f7d\u65b9\u5f0f\u4f7f\u7528 ConfigMap \u65f6\uff0c\u5c06\u65e0\u6cd5\u63a5\u6536 ConfigMap \u7684\u66f4\u65b0\u3002 \u6587\u672c\u6570\u636e\u6302\u8f7d\u6210\u6587\u4ef6\u65f6\u91c7\u7528 UTF-8 \u5b57\u7b26\u7f16\u7801\u3002\u5982\u679c\u4f7f\u7528\u5176\u4ed6\u5b57\u7b26\u7f16\u7801\u5f62\u5f0f\uff0c\u53ef\u4f7f\u7528 binaryData \u5b57\u6bb5</p> <p>emptyDir \u5f53 Pod \u5206\u6d3e\u5230\u67d0\u4e2a Node \u4e0a\u65f6\uff0cemptyDir \u5377\u4f1a\u88ab\u521b\u5efa\uff0c\u5e76\u4e14\u5728 Pod \u5728\u8be5\u8282\u70b9\u4e0a\u8fd0\u884c\u671f\u95f4\uff0c\u5377\u4e00\u76f4\u5b58\u5728\u3002 \u5c31\u50cf\u5176\u540d\u79f0\u8868\u793a\u7684\u90a3\u6837\uff0c\u5377\u6700\u521d\u662f\u7a7a\u7684\u3002 \u5c3d\u7ba1 Pod \u4e2d\u7684\u5bb9\u5668\u6302\u8f7d emptyDir \u5377\u7684\u8def\u5f84\u53ef\u80fd\u76f8\u540c\u4e5f\u53ef\u80fd\u4e0d\u540c\uff0c\u8fd9\u4e9b\u5bb9\u5668\u90fd\u53ef\u4ee5\u8bfb\u5199 emptyDir \u5377\u4e2d\u76f8\u540c\u7684\u6587\u4ef6\u3002 \u5f53 Pod \u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u88ab\u4ece\u8282\u70b9\u4e0a\u5220\u9664\u65f6\uff0cemptyDir \u5377\u4e2d\u7684\u6570\u636e\u4e5f\u4f1a\u88ab\u6c38\u4e45\u5220\u9664\u3002 \u8bf4\u660e\uff1a \u5bb9\u5668\u5d29\u6e83\u5e76\u4e0d\u4f1a\u5bfc\u81f4 Pod \u88ab\u4ece\u8282\u70b9\u4e0a\u79fb\u9664\uff0c\u56e0\u6b64\u5bb9\u5668\u5d29\u6e83\u671f\u95f4 emptyDir \u5377\u4e2d\u7684\u6570\u636e\u662f\u5b89\u5168\u7684\u3002 emptyDir \u7684\u4e00\u4e9b\u7528\u9014\uff1a \u7f13\u5b58\u7a7a\u95f4\uff0c\u4f8b\u5982\u57fa\u4e8e\u78c1\u76d8\u7684\u5f52\u5e76\u6392\u5e8f\u3002 \u4e3a\u8017\u65f6\u8f83\u957f\u7684\u8ba1\u7b97\u4efb\u52a1\u63d0\u4f9b\u68c0\u67e5\u70b9\uff0c\u4ee5\uf965\u4efb\u52a1\u80fd\u65b9\uf965\u5730\u4ece\u5d29\u6e83\u524d\u72b6\u6001\u6062\u590d\u6267\ufa08\u3002 \u5728 Web \u670d\u52a1\u5668\u5bb9\u5668\u670d\u52a1\u6570\u636e\u65f6\uff0c\u4fdd\u5b58\u5185\u5bb9\u7ba1\u7406\u5668\u5bb9\u5668\u83b7\u53d6\u7684\u6587\u4ef6</p> <p>glusterfs glusterfs \u5377\u80fd\u5c06 Glusterfs (\u4e00\u4e2a\u5f00\u6e90\u7684\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf) \u6302\u8f7d\u5230\u4f60\u7684 Pod \u4e2d\u3002\u4e0d\u50cf emptyDir \u90a3\u6837\u4f1a\u5728\u5220\u9664 Pod \u7684\u540c\u65f6\u4e5f\u4f1a\u88ab\u5220\u9664\uff0cglusterfs \u5377\u7684\u5185\u5bb9\u5728\u5220\u9664 Pod \u65f6\u4f1a\u88ab\u4fdd\u5b58\uff0c\u5377\u53ea\u662f\u88ab\u5378\u8f7d\u3002 \u8fd9\u610f\u5473\u7740 glusterfs \u5377\u53ef\u4ee5\u88ab\u9884\u5148\u586b\u5145\u6570\u636e\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728 Pod \u4e4b\u95f4\u5171\u4eab\u3002 GlusterFS \u53ef\u4ee5\u88ab\u591a\u4e2a\u5199\u8005\u540c\u65f6\u6302\u8f7d</p> <p>hostPath \u5377\u80fd\u5c06\u4e3b\u673a\u8282\u70b9\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u6302\u8f7d\u5230\u4f60\u7684 Pod \u4e2d\u3002 \u867d\u7136\u8fd9\u4e0d\u662f\u5927\u591a\u6570 Pod \u9700\u8981\u7684\uff0c\u4f46\u662f\u5b83\u4e3a\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u9003\u751f\u8231\u3002 \u4f8b\u5982\uff0chostPath \u7684\u4e00\u4e9b\u7528\u6cd5\u6709\uff1a \u8fd0\u884c\u4e00\u4e2a\u9700\u8981\u8bbf\u95ee Docker \u5185\u90e8\u673a\u5236\u7684\u5bb9\u5668\uff1b\u53ef\u4f7f\u7528 hostPath \u6302\u8f7d /var/lib/docker \u8def\u5f84\u3002 \u5728\u5bb9\u5668\u4e2d\u8fd0\u884c cAdvisor \u65f6\uff0c\u4ee5 hostPath \u65b9\u5f0f\u6302\u8f7d /sys\u3002 \u5141\u8bb8 Pod \u6307\u5b9a\u7ed9\u5b9a\u7684 hostPath \u5728\u8fd0\u884c Pod \u4e4b\u524d\u662f\u5426\u5e94\u8be5\u5b58\u5728\uff0c\u662f\u5426\u5e94\u8be5\u521b\u5efa\u4ee5\u53ca\u5e94\u8be5\u4ee5\uf9fd\u4e48\u65b9\u5f0f\u5b58\u5728</p> <p>nfs nfs \u5377\u80fd\u5c06 NFS (\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf) \u6302\u8f7d\u5230\u4f60\u7684 Pod \u4e2d\u3002 \u4e0d\u50cf emptyDir \u90a3\u6837\u4f1a\u5728\u5220\u9664 Pod \u7684\u540c\u65f6\u4e5f\u4f1a\u88ab\u5220\u9664\uff0cnfs \u5377\u7684\u5185\u5bb9\u5728\u5220\u9664 Pod \u65f6\u4f1a\u88ab\u4fdd\u5b58\uff0c\u5377\u53ea\u662f\u88ab\u5378\u8f7d\u3002 \u8fd9\u610f\u5473\u7740 nfs \u5377\u53ef\u4ee5\u88ab\u9884\u5148\u586b\u5145\u6570\u636e\uff0c\u5e76\u4e14\u8fd9\u4e9b\u6570\u636e\u53ef\u4ee5\u5728 Pod \u4e4b\u95f4\u5171\u4eab</p> <p>local local \u5377\u6240\u4ee3\u8868\u7684\u662f\u67d0\u4e2a\u88ab\u6302\u8f7d\u7684\u672c\u5730\u5b58\u50a8\u8bbe\u5907\uff0c\u4f8b\u5982\u78c1\u76d8\u3001\u5206\u533a\u6216\u8005\u76ee\u5f55\u3002 local \u5377\u53ea\u80fd\u7528\u4f5c\u9759\u6001\u521b\u5efa\u7684\u6301\u4e45\u5377\u3002\u5c1a\u4e0d\u652f\u6301\u52a8\u6001\u914d\u7f6e\u3002 \u4e0e hostPath \u5377\u76f8\u6bd4\uff0clocal \u5377\u80fd\u591f\u4ee5\u6301\u4e45\u548c\u53ef\u79fb\u690d\u7684\u65b9\u5f0f\u4f7f\u7528\uff0c\u800c\u65e0\u9700\u624b\u52a8\u5c06 Pod \u8c03\u5ea6\u5230\u8282\u70b9\u3002\u7cfb\u7edf\u901a\u8fc7\u67e5\u770b PersistentVolume \u7684\u8282\u70b9\u4eb2\u548c\u6027\u914d\u7f6e\uff0c\u5c31\u80fd\u4e86\u89e3\u5377\u7684\u8282\u70b9\u7ea6\u675f\u3002 \u7136\u800c\uff0clocal \u5377\u4ecd\u7136\u53d6\u51b3\u4e8e\u5e95\u5c42\u8282\u70b9\u7684\u53ef\u7528\u6027\uff0c\u5e76\u4e0d\u9002\u5408\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u3002 \u5982\u679c\u8282\u70b9\u53d8\u5f97\u4e0d\u5065\u5eb7\uff0c\u90a3\u4e48local \u5377\u4e5f\u5c06\u53d8\u5f97\u4e0d\u53ef\u88ab Pod \u8bbf\u95ee\u3002\u4f7f\u7528\u5b83\u7684 Pod \u5c06\u4e0d\u80fd\u8fd0\u884c\u3002 \u4f7f\u7528 local \u5377\u7684\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u80fd\u591f\u5bb9\u5fcd\u8fd9\u79cd\u53ef\u7528\u6027\u7684\u964d\u4f4e\uff0c\u4ee5\u53ca\u56e0\u5e95\u5c42\u78c1\u76d8\u7684\u8010\u7528\u6027\u7279\u5f81 \u800c\u5e26\u6765\u7684\u6f5c\u5728\u7684\u6570\u636e\u4e22\u5931\u98ce\u9669 \u4f7f\u7528 local \u5377\u65f6\uff0c\u4f60\u9700\u8981\u8bbe\u7f6e PersistentVolume \u5bf9\u8c61\u7684 nodeAffinity \u5b57\u6bb5\u3002 Kubernetes \u8c03\u5ea6\ufa38\u4f7f\u7528 PersistentVolume \u7684 nodeAffinity \u4fe1\u606f\u6765\u5c06\u4f7f\u7528 local \u5377\u7684 Pod \u8c03\u5ea6\u5230\u6b63\u786e\u7684\u8282\u70b9</p> <p>persistentVolumeClaim persistentVolumeClaim \u5377\u7528\u6765\u5c06\u6301\u4e45\u5377\uff08PersistentVolume\uff09 \u6302\u8f7d\u5230 Pod \u4e2d\u3002 \u6301\u4e45\u5377\u7533\u9886\uff08PersistentVolumeClaim\uff09\u662f\u7528\u6237\u5728\u4e0d\u77e5\u9053\u7279\u5b9a\u4e91\u73af\u5883\u7ec6\u8282\u7684\u60c5\u51b5\u4e0b\"\u7533\u9886\"\u6301\u4e45\u5b58\u50a8</p> <p>PersistentVolume\uff08PV\uff09\u662f\u4e00\u5757\u96c6\u7fa4\u91cc\u7531\u7ba1\u7406\u5458\u624b\u52a8\u63d0\u4f9b\uff0c\u6216 kubernetes \u901a\u8fc7 StorageClass \u52a8\u6001\u521b\u5efa\u7684\u5b58\u50a8\u3002 PersistentVolumeClaim\uff08PVC\uff09\u662f\u4e00\u4e2a\u6ee1\u8db3\u5bf9 PV \u5b58\u50a8\u9700\u8981\u7684\u8bf7\u6c42 PersistentVolumes \u548c PersistentVolumeClaims \u662f\u72ec\u7acb\u4e8e Pod \u751f\u547d\u5468\u671f\u800c\u5728 Pod \u91cd\u542f\uff0c\u91cd\u65b0\u8c03\u5ea6\u751a\u81f3\u5220\u9664\u8fc7\u7a0b\u4e2d\u4fdd\u5b58\u6570\u636e</p> <p>secret secret \u5377\u7528\u6765\u7ed9 Pod \u4f20\u9012\u654f\u611f\u4fe1\u606f\uff0c\u4f8b\u5982\u5bc6\u7801\u3002\u4f60\u53ef\u4ee5\u5c06 Secret \u5b58\u50a8\u5728 Kubernetes API \u670d\u52a1\u5668\u4e0a\uff0c\u7136\u540e\u4ee5\u6587\u4ef6\u7684\u5f62\u5f0f\u6302\u5728\u5230 Pod \u4e2d\uff0c\u65e0\u9700\u76f4\u63a5\u4e0e Kubernetes \u8026\u5408\u3002 secret \u5377\u7531 tmpfs\uff08\u57fa\u4e8e RAM \u7684\u6587\u4ef6\u7cfb\u7edf\uff09\u63d0\u4f9b\u5b58\u50a8\uff0c\u56e0\u6b64\u5b83\u4eec\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u5199\u5165\u975e\u6613\u5931\u6027 \uff08\u6301\u4e45\u5316\u7684\uff09\u5b58\u50a8\u5668 \u8bf4\u660e\uff1a \u4f7f\u7528\u524d\u4f60\u5fc5\u987b\u5728 Kubernetes API \u4e2d\u521b\u5efa secret\u3002 \u8bf4\u660e\uff1a \u5bb9\u5668\u4ee5 subPath \u5377\u6302\u8f7d\u65b9\u5f0f\u6302\u8f7d Secret \u65f6\uff0c\u5c06\u611f\u77e5\u4e0d\u5230 Secret \u7684\u66f4\u65b0</p> <p>\u83b7\u53d6\u5bb9\u5668simmemleak-hra99\u7ec8\u6b62\u4e4b\u524d\u7684\u72b6\u6001 kubectl get pod -o go-template='{{range.status.containerStatuses}}{{\"Container Name: \"}}{{.name}}{{\"\\r\\nLastState: \"}}{{.lastState}}{{end}}'  simmemleak-hra99</p> <p>kube-scheduler\u8c03\u5ea6\u5668\u8c03\u4f18 \u8bbe\u7f6e\u9608\u503c percentageOfNodesToScore \u9009\u9879\u63a5\u53d7\u4ece 0 \u5230 100 \u4e4b\u95f4\u7684\u6574\u6570\u503c\u3002 0 \u503c\u6bd4\u8f83\u7279\u6b8a\uff0c\u8868\u793a kube-scheduler \u5e94\u8be5\u4f7f\u7528\u5176\u7f16\u8bd1\u540e\u7684\u9ed8\u8ba4\u503c\u3002 \u5982\u679c\u4f60\u8bbe\u7f6e percentageOfNodesToScore \u7684\u503c\u8d85\u8fc7\u4e86 100\uff0c kube-scheduler \u7684\u8868\u73b0\u7b49\u4ef7\u4e8e\u8bbe\u7f6e\u503c\u4e3a 100 \u8981\u4fee\u6539\u8fd9\u4e2a\u503c\uff0c\u5148\u7f16\u8f91 kube-scheduler \u7684\u914d\u7f6e\u6587\u4ef6 \u7136\u540e\u91cd\u542f\u8c03\u5ea6\u5668\u3002 \u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u662f /etc/kubernetes/config/kube-scheduler.yaml</p> <p>\u9ed8\u8ba4\u9608\u503c \u5982\u679c\u4f60\u4e0d\u6307\u5b9a\u9608\u503c\uff0cKubernetes \u4f7f\u7528\u7ebf\u6027\u516c\u5f0f\u8ba1\u7b97\u51fa\u4e00\u4e2a\u6bd4\u4f8b\uff0c\u5728 100-\u8282\u70b9\u96c6\u7fa4 \u4e0b\u53d6 50%\uff0c\u5728 5000-\u8282\u70b9\u7684\u96c6\u7fa4\u4e0b\u53d6 10%\u3002\u8fd9\u4e2a\u81ea\u52a8\u8bbe\u7f6e\u7684\u53c2\u6570\u7684\u6700\u4f4e\u503c\u662f 5%</p> <p>\u66f4\u6539PV\u56de\u6536\u7b56\u7565 kubectl patch pv  -p '{\"spec\":{\"persistentVolumeReclaimPolicy\":\"Retain\"}}' <p>DaemonSet \u6709\u4e24\u79cd\u66f4\u65b0\u7b56\u7565\uff1a\u8981\u542f\u7528 DaemonSet \u7684\u6eda\u52a8\u66f4\u65b0\u529f\u80fd\uff0c\u5fc5\u987b\u8bbe\u7f6e .spec.updateStrategy.type \u4e3a RollingUpdate OnDelete: \u4f7f\u7528 OnDelete \u66f4\u65b0\u7b56\u7565\u65f6\uff0c\u5728\u66f4\u65b0 DaemonSet \u6a21\u677f\u540e\uff0c\u53ea\u6709\u5f53\u4f60\u624b\u52a8\u5220\u9664\u8001\u7684 DaemonSet pods \u4e4b\u540e\uff0c\u65b0\u7684 DaemonSet Pod \u624d\u4f1a\u88ab\u81ea\u52a8\u521b\u5efa\u3002\u8ddf Kubernetes 1.6 \u4ee5\u524d\u7684\u7248\u672c\u7c7b\u4f3c\u3002 RollingUpdate: \u8fd9\u662f\u9ed8\u8ba4\u7684\u66f4\u65b0\u7b56\u7565\u3002\u4f7f\u7528 RollingUpdate \u66f4\u65b0\u7b56\u7565\u65f6\uff0c\u5728\u66f4\u65b0 DaemonSet \u6a21\u677f\u540e\uff0c \u8001\u7684 DaemonSet pods \u5c06\u88ab\u7ec8\u6b62\uff0c\u5e76\u4e14\u5c06\u4ee5\u53d7\u63a7\u65b9\u5f0f\u81ea\u52a8\u521b\u5efa\u65b0\u7684 DaemonSet pods\u3002 \u66f4\u65b0\u671f\u95f4\uff0c\u6700\u591a\u53ea\u80fd\u6709 DaemonSet \u7684\u4e00\u4e2a Pod \u8fd0\u884c\u4e8e\u6bcf\u4e2a\u8282\u70b9\u4e0a</p> <p>DaemonSet \u6eda\u52a8\u66f4\u65b0\u5361\u4f4f\u539f\u56e0\uff1a \u4e00\u4e9b\u8282\u70b9\u53ef\u7528\u8d44\u6e90\u8017\u5c3d \u4e0d\u5b8c\u6574\u7684\u6eda\u52a8\u66f4\u65b0\uff0c\u6bd4\u5982\uff0c\u5bb9\u5668\u5904\u4e8e\u5d29\u6e83\u5faa\u73af\u72b6\u6001\u6216\u8005\u5bb9\u5668\u955c\u50cf\u4e0d\u5b58\u5728 \u65f6\u949f\u504f\u5dee\uff0cmaster\u8282\u70b9\u548cworker\u8282\u70b9\u65f6\u949f\u504f\u5dee</p> <p>deployment\u793a\u4f8b apiVersion: apps/v1 kind: Deployment metadata:   name: nginx-deployment   labels:     app: nginx spec:   replicas: 3   selector:     matchLabels:       app: nginx   template:     metadata:       labels:         app: nginx     spec:       containers:       - name: nginx         image: nginx:1.14.2         ports:         - containerPort: 80</p> <p>replicaset\u793a\u4f8b apiVersion: apps/v1 kind: ReplicaSet metadata:   name: frontend   labels:     app: guestbook     tier: frontend spec:   # modify replicas according to your case   replicas: 3   selector:     matchLabels:       tier: frontend   template:     metadata:       labels:         tier: frontend     spec:       containers:       - name: php-redis         image: gcr.io/google_samples/gb-frontend:v3</p> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u4e86 StatefulSet \u7684\u7ec4\u4ef6 apiVersion: v1 kind: Service metadata:   name: nginx   labels:     app: nginx spec:   ports:   - port: 80     name: web   clusterIP: None   selector:     app: nginx</p> <p>apiVersion: apps/v1 kind: StatefulSet metadata:   name: web spec:   selector:     matchLabels:       app: nginx # has to match .spec.template.metadata.labels   serviceName: \"nginx\"   replicas: 3 # by default is 1   template:     metadata:       labels:         app: nginx # has to match .spec.selector.matchLabels     spec:       terminationGracePeriodSeconds: 10       containers:       - name: nginx         image: k8s.gcr.io/nginx-slim:0.8         ports:         - containerPort: 80           name: web         volumeMounts:         - name: www           mountPath: /usr/share/nginx/html   volumeClaimTemplates:   - metadata:       name: www     spec:       accessModes: [ \"ReadWriteOnce\" ]       storageClassName: \"my-storage-class\"       resources:         requests:           storage: 1Gi</p> <p>daemonset\u793a\u4f8b apiVersion: apps/v1 kind: DaemonSet metadata:   name: fluentd-elasticsearch   namespace: kube-system   labels:     k8s-app: fluentd-logging spec:   selector:     matchLabels:       name: fluentd-elasticsearch   template:     metadata:       labels:         name: fluentd-elasticsearch     spec:       tolerations:       # this toleration is to have the daemonset runnable on master nodes       # remove it if your masters can't run pods       - key: node-role.kubernetes.io/master         effect: NoSchedule       containers:       - name: fluentd-elasticsearch         image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2         resources:           limits:             memory: 200Mi           requests:             cpu: 100m             memory: 200Mi         volumeMounts:         - name: varlog           mountPath: /var/log         - name: varlibdockercontainers           mountPath: /var/lib/docker/containers           readOnly: true       terminationGracePeriodSeconds: 30       volumes:       - name: varlog         hostPath:           path: /var/log       - name: varlibdockercontainers         hostPath:           path: /var/lib/docker/containers</p> <p>job\u793a\u4f8b apiVersion: batch/v1 kind: Job metadata:   name: pi spec:   template:     spec:       containers:       - name: pi         image: perl         command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]       restartPolicy: Never   backoffLimit: 4</p> <p>cronjob\u793a\u4f8b apiVersion: batch/v1beta1 kind: CronJob metadata:   name: hello spec:   schedule: \"*/1 * * * *\"   jobTemplate:     spec:       template:         spec:           containers:           - name: hello             image: busybox             imagePullPolicy: IfNotPresent             command:             - /bin/sh             - -c             - date; echo Hello from the Kubernetes cluster           restartPolicy: OnFailure</p> <p>pv\u793a\u4f8b kind: PersistentVolume apiVersion: v1 metadata:   name: test   labels:     type: quobyte spec:   capacity:     storage: 1Gi   accessModes:     - ReadWriteOnce   storageClassName: \"base\"   quobyte:     # the registry parameter was an required parameter, but is not used anymore.     # It's here for API compatibility.     registry: ignored:7861     volume: test     readOnly: false     user: root     group: root</p> <p>statefulset\u548cdeployment\u3001replicaset\u533a\u522b \u65e0\u72b6\u6001\u5e94\u7528\u7a0b\u5e8f\u662f\u4e00\u4e2a\u4e0d\u5173\u5fc3\u5b83\u6b63\u5728\u4f7f\u7528\u54ea\u4e2a\u7f51\u7edc\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5b83\u4e0d\u9700\u8981\u6c38\u4e45\u6027\u5b58\u50a8\u3002\u65e0\u72b6\u6001\u5e94\u7528\u7a0b\u5e8f\u7684\u793a\u4f8b\u53ef\u80fd\u5305\u62ecWeb\u670d\u52a1\u5668\uff08Apache\uff0cNginx\u6216Tomcat\uff09 \u6709\u72b6\u6001\u5e94\u7528\u7a0b\u5e8f\u3002\u5047\u8bbe\u60a8\u6709\u4e00\u4e2amysql\u6570\u636e\u5e93\u96c6\u7fa4\u3002\u4e3a\u4e86\u4f7f\u8fd9\u6837\u7684\u5e94\u7528\u7a0b\u5e8f\u6b63\u5e38\u8fd0\u884c\uff0cmysql\u5b9e\u4f8b\u672c\u8eab\u4e5f\u4f1a\u5728\u5f7c\u6b64\u4e4b\u95f4\u5efa\u7acb\u8fde\u63a5\u4ee5\u9009\u4e3e\u4e00\u4e2a\u4e3b\u8282\u70b9\u3002\u7531\u4e8e\u8fd9\u79cd\u8bbe\u8ba1\uff0cmysql\u96c6\u7fa4\u662f\u6709\u72b6\u6001\u5e94\u7528\u7a0b\u5e8f\u7684\u4e00\u4e2a\u793a\u4f8b\uff0c\u800c\u4e14\u9700\u8981\u6301\u4e45\u5316\u7684\u5b58\u50a8\u6570\u636e</p>"},{"location":"cloud-native/Serverless/","title":"Serverless","text":""},{"location":"cloud-native/Serverless/#istio","title":"Istio","text":"Markdown<pre><code>**Kubernetes vs Service Mesh**\nKubernetes\u4e0eServiceMesh\u4e2d\u7684\u7684\u670d\u52a1\u8bbf\u95ee\u5173\u7cfb(\u6bcf\u4e2apod\u4e00\u4e2asidecar\u7684\u6a21\u5f0f)\n![compare1](https://www.servicemesher.com/istio-handbook/images/kubernetes-vs-service-mesh.png)\n\n\u63a7\u5236\u5e73\u9762\u7684\u7279\u70b9\uff1a\n* \u4e0d\u76f4\u63a5\u89e3\u6790\u6570\u636e\u5305\n* \u4e0e\u63a7\u5236\u5e73\u9762\u4e2d\u7684\u4ee3\u7406\u901a\u4fe1\uff0c\u4e0b\u53d1\u7b56\u7565\u548c\u914d\u7f6e\n* \u8d1f\u8d23\u7f51\u7edc\u884c\u4e3a\u7684\u53ef\u89c6\u5316\n* \u901a\u5e38\u63d0\u4f9b API \u6216\u8005\u547d\u4ee4\u884c\u5de5\u5177\u53ef\u7528\u4e8e\u914d\u7f6e\u7248\u672c\u5316\u7ba1\u7406\uff0c\u4fbf\u4e8e\u6301\u7eed\u96c6\u6210\u548c\u90e8\u7f72\n\n\u6570\u636e\u5e73\u9762\u7684\u7279\u70b9\uff1a\n* \u901a\u5e38\u662f\u6309\u7167\u65e0\u72b6\u6001\u76ee\u6807\u8bbe\u8ba1\u7684\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e3a\u4e86\u63d0\u9ad8\u6d41\u91cf\u8f6c\u53d1\u6027\u80fd\uff0c\u9700\u8981\u7f13\u5b58\u4e00\u4e9b\u6570\u636e\uff0c\u56e0\u6b64\u65e0\u72b6\u6001\u4e5f\u662f\u6709\u4e89\u8bae\u7684\n* \u76f4\u63a5\u5904\u7406\u5165\u7ad9\u548c\u51fa\u7ad9\u6570\u636e\u5305\uff0c\u8f6c\u53d1\u3001\u8def\u7531\u3001\u5065\u5eb7\u68c0\u67e5\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u8ba4\u8bc1\u3001\u9274\u6743\u3001\u4ea7\u751f\u76d1\u63a7\u6570\u636e\u7b49\n* \u5bf9\u5e94\u7528\u6765\u8bf4\u900f\u660e\uff0c\u5373\u53ef\u4ee5\u505a\u5230\u65e0\u611f\u77e5\u90e8\u7f72\n\n**Istio service mesh\u67b6\u6784\u56fe**\n![arch](https://www.servicemesher.com/istio-handbook/images/istio-mesh-arch.png)\n\n**Istio\u6838\u5fc3\u7ec4\u4ef6\uff1a**\n**Envoy**\nIstio\u6570\u636e\u5e73\u9762\u9ed8\u8ba4\u4f7f\u7528Envoy\u4f5c\u4e3asidecar\u4ee3\u7406\uff0c\u4e3b\u8981\u529f\u80fd\u5305\u62ec\uff1a\n* \u8def\u7531\u3001\u6d41\u91cf\u8f6c\u79fb\n* \u5f39\u6027\u80fd\u529b\uff1a\u5982\u8d85\u65f6\u91cd\u8bd5\u3001\u7194\u65ad\u7b49\n* \u8c03\u8bd5\u529f\u80fd\uff1a\u5982\u6545\u969c\u6ce8\u5165\u3001\u6d41\u91cf\u955c\u50cf\n**Pilot**\nPilot\u7ec4\u4ef6\u4e3b\u8981\u529f\u80fd\u662f\u5c06\u8def\u7531\u89c4\u5219\u7b49\u914d\u7f6e\u4fe1\u606f\u8f6c\u5316\u4e3asidecar\u53ef\u4ee5\u8bc6\u522b\u7684\u4fe1\u606f\uff0c\u5e76\u4e0b\u53d1\u7ed9\u6570\u636e\u5e73\u9762\n**Citadel**\nCitadel\u662f\u8d1f\u8d23\u5b89\u5168\u7684\u7ec4\u4ef6\uff0c\u5185\u7f6e\u8eab\u4efd\u548c\u8bc1\u4e66\u7ba1\u7406\u529f\u80fd\uff0c\u5b9e\u73b0\u5f3a\u5927\u7684\u8ba4\u8bc1\u548c\u6388\u6743\u64cd\u4f5c\n**Galley**\nGalley\u662fIstio 1.1\u7248\u672c\u4e2d\u65b0\u589e\u7ec4\u4ef6\uff0c\u76ee\u7684\u662f\u5c06Pilot\u548c\u5e95\u5c42\u5e73\u53f0(K8s)\u8fdb\u884c\u89e3\u8026\u5408\uff0c\u5206\u62c5\u539f\u6765Pilot\u7684\u90e8\u5206\u529f\u80fd\uff0c\u4e3b\u8981\u8d1f\u8d23\u914d\u7f6e\u7684\u9a8c\u8bc1\u3001\u63d0\u53d6\u548c\u5904\u7406\u7b49\u529f\u80fd\n</code></pre>"},{"location":"coding/Git/","title":"Git","text":""},{"location":"coding/Git/#_1","title":"\u57fa\u672c\u8bbe\u7f6e","text":"Bash<pre><code># \u5173\u4e8e\u6362\u884c\u7b26\u7684\u8bbe\u7f6e\n\ngit config --global core.autocrlf true  # \u8bbe\u7f6etrue\u540e\uff0c\u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u81ea\u52a8\u8f6c\u4e3acrlf\ngit config --global core.autocrlf input # \u63d0\u4ea4\u65f6\u81ea\u52a8\u8f6c\u4e3aLF\uff0c\u7b7e\u51fa\u65f6\u4e0d\u81ea\u52a8\u8f6c\u4e3aCRLF\ngit config --global core.autocrlf false # \u63d0\u4ea4\u548c\u7b7e\u51fa\u65f6\u4fdd\u7559crlf\u6362\u884c\n\n# \u5173\u4e8e\u5bc6\u7801\u7684\u8bbe\u7f6e\ngit config --global credential.helper cache # \u8bbe\u7f6e\u8bb0\u4f4f\u5bc6\u7801\uff08\u9ed8\u8ba415\u5206\u949f\uff09\uff1a\ngit config --global credential.helper 'cache --timeout=3600' # \u5982\u679c\u60f3\u81ea\u5df1\u8bbe\u7f6e\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff1a\ngit credential-cache exit # \u5b88\u62a4\u7a0b\u5e8f\u63d0\u524d\u9000\u51fa\uff0c\u8bf7\u5728\u8d85\u65f6\u4e4b\u524d\u5fd8\u8bb0\u6240\u6709\u7f13\u5b58\u7684\u51ed\u636e\ngit config --global credential.helper store # \u957f\u671f\u5b58\u50a8\u5bc6\u7801\uff1a\n\n# \u53d6\u6d88\u5b58\u50a8\u5bc6\u7801\ngit config --unset-all credential.helper\ngit config --global --unset-all credential.helper\ngit config --system --unset-all credential.helper\n\n# \u5173\u4e8e\u4ee3\u7406\u7684\u8bbe\u7f6e\n\n# http\u548chttps\u534f\u8bae\u8bbe\u7f6esocks5\u4ee3\u7406\ngit config --global http.proxy 'socks5h://127.0.0.1:1080'   # socks5, h\u8868\u793a\u5305\u62ec\u57df\u540d\u89e3\u6790\ngit config --global http.proxy http://127.0.0.1:108 # \u8bbe\u7f6ehttp\u548chttps\u4ee3\u7406\ngit config --global --unset http.proxy  # \u53d6\u6d88\u4ee3\u7406\n\ngit config --global http.https://github.com.proxy socks5://127.0.0.1:1080   # \u53ea\u5bf9github.com\u8bbe\u7f6e\u4ee3\u7406\ngit config --global --unset http.https://github.com.proxy  # \u53d6\u6d88\u5bf9github.com\u7684\u4ee3\u7406\n\n# ssh\u534f\u8bae\u8bbe\u7f6e\u4ee3\u7406\n# Linux\u4fee\u6539~/.ssh/config\u6587\u4ef6\uff0c\u6dfb\u52a0\u5982\u4e0b\u5185\u5bb9\nHost github.com\nUser git\nProxyCommand nc -v -x 127.0.0.1:1080 %h %p\n# Windows\u5728\u7528\u6237\u76ee\u5f55\u4e0b\u4fee\u6539.ssh/config\u6587\u4ef6\uff0c\u6ce8\u610f\u8981\u5b89\u88c5gitforwindows\u5e76\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\nHost github.com\nUser git\nProxyCommand connect -S 127.0.0.1:1080 %h %p\n\ngit config --list   # \u7f57\u5217\u5f53\u524d\u914d\u7f6e\ngit config -e [--global]    # \u7f16\u8f91\u914d\u7f6e\n</code></pre>"},{"location":"coding/Git/#_2","title":"\u57fa\u672c\u4f7f\u7528\u6d41\u7a0b","text":"Bash<pre><code># \u5b89\u88c5\u540e\u8bbe\u7f6e\u7528\u6237\u540d\u548c\u90ae\u7bb1\uff1a\ngit config --global user.name \"Your Name\"\ngit config --global user.email \"email@example.com\"\n\ngit init    # \u521d\u59cb\u5316\u4ed3\u5e93\n\ngit clone --depth 1 # \u514b\u9686\u76ee\u5f55\u6df1\u5ea6\u4e3a1\n\ngit checkout master # \u83b7\u53d6\u4e3b\u5e72master\u4ee3\u7801\ngit checkout -b myfeature # \u65b0\u5efa\u4e00\u4e2a\u5f00\u53d1\u5206\u652fmyfeature\n\n# \u63d0\u4ea4\u5206\u652f\ngit add --all # \u4ecegit2.0\u540eall\u53c2\u6570\u662fgit add\u7684\u9ed8\u8ba4\u53c2\u6570\ngit add -p  # \u589e\u52a0\u6bcf\u4e2a\u53d8\u5316\u5230\u7f13\u5b58\u533a\u65f6\u90fd\u8981\u6c42\u786e\u8ba4\ngit remore add origin [\u8fdc\u7a0b\u4ed3\u5e93\u8def\u5f84]\n\ngit commit --vervose # \u53c2\u6570vervose\u4f1a\u5217\u51fadiff\u7684\u7ed3\u679c,\u7b49\u540c\u4e8e-v\ngit commit -a --allow-empty-message -m \"\" # \u4ee5\u7a7a\u6d88\u606fcommit\uff0c\u5373\u4e0d\u5199commit message\ngit commit --amend -m message   # \u91cd\u505a\u4e0a\u4e00\u6b21\u63d0\u4ea4\u4fe1\u606f\n\n# \u4e0e\u4e3b\u5e72\u540c\u6b65-\u5206\u652f\u5f00\u53d1\u8fc7\u7a0b\u5e94\u7ecf\u5e38\u4e0e\u4e3b\u5e72\u4fdd\u6301\u540c\u6b65\ngit fetch origin\ngit rebase origin/master\n\ngit rebase -i origin/master # \u5408\u5e76commit,\u5206\u652f\u5f00\u53d1\u540e\uff0c\u53ef\u80fd\u5f88\u591acommit,-i\u53c2\u6570\u8868\u793a\u4e92\u52a8(interactive)\ngit push --force origin myfeature   # \u63a8\u9001\u5206\u652f\u81f3\u8fdc\u7a0b\u4ed3\u5e93\ngit remote set-url origin URL # \u66f4\u6362\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740\uff0cURL\u4e3a\u65b0\u5730\u5740\ngit remote -v   # \u67e5\u770b\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5730\u5740\ngit rm -r --cached dirfile # \u5220\u9664\u8fdc\u7a0b\u76ee\u5f55\u6216\u6587\u4ef6\ngit branch  # \u5217\u51fa\u6240\u6709\u672c\u5730\u5206\u652f\ngit branch -r   # \u5217\u51fa\u6240\u6709\u8fdc\u7a0b\u5206\u652f\n\n# \u5220\u9664\u8fdc\u7a0b\u5206\u652f\ngit push origin --delete [branch-name]\ngit branch -dr [remote/branch]\n\ngit tag # \u5217\u51fa\u6240\u6709tag\u6807\u7b7e\ngit tag -d [tag]    # \u5220\u9664\u672c\u5730tag\ngit show tag    # \u663e\u793atag\u4fe1\u606f\n\ngit revert --no-commit HEAD~3...HEAD    # \u8981\u901a\u8fc7\u8fd8\u539f\u6700\u540e3\u6b21\u63d0\u4ea4\u6765\u8fdb\u884c\u65b0\u63d0\u4ea4\n</code></pre>"},{"location":"coding/Python3/","title":"python3\u624b\u518c","text":""},{"location":"coding/Python3/#python","title":"Python\u76f8\u5173\u8bf4\u660e","text":"Markdown<pre><code>## \u6a21\u5757\uff08modules\uff09\uff1a\n\n\u6a21\u5757\u662fPython\u4ee3\u7801\u7684\u57fa\u672c\u7ec4\u7ec7\u5355\u5143\u3002\n\n\u6a21\u5757\u552f\u4e00\u7684\u7279\u6b8a\u64cd\u4f5c\u662f\u5c5e\u6027\u8bbf\u95ee: m.name\uff0c\u8fd9\u91ccm\u4e3a\u4e00\u4e2a\u6a21\u5757\u800cname\u8bbf\u95ee\u5b9a\u4e49\u5728m\u7684\u7b26\u53f7\u8868\u4e2d\u7684\u4e00\u4e2a\u540d\u79f0\u3002\u6a21\u5757\u5c5e\u6027\u53ef\u4ee5\u88ab\u8d4b\u503c\u3002\n\uff08\u6ce8\u610f\uff1aimport \u8bed\u53e5\u4e25\u683c\u6765\u8bf4\u4e5f\u662f\u5bf9\u6a21\u5757\u5bf9\u8c61\u7684\u4e00\u79cd\u64cd\u4f5c\uff1bimport foo \u4e0d\u8981\u6c42\u5b58\u5728\u4e00\u4e2a\u540d\u4e3a foo \u7684\u6a21\u5757\u5bf9\u8c61\uff0c\n\u800c\u662f\u8981\u6c42\u5b58\u5728\u4e00\u4e2a\u5bf9\u4e8e\u540d\u4e3afoo\u7684\u6a21\u5757\u7684(\u6c38\u4e45\u6027) \u5b9a\u4e49\uff09\n\n\u6bcf\u4e2a\u6a21\u5757\u90fd\u6709\u4e00\u4e2a\u7279\u6b8a\u5c5e\u6027 __dict__\u3002 \u8fd9\u662f\u5305\u542b\u6a21\u5757\u7684\u7b26\u53f7\u8868\u7684\u5b57\u5178\u3002 \u4fee\u6539\u6b64\u5b57\u5178\u5c06\u5b9e\u9645\u6539\u53d8\u6a21\u5757\u7684\u7b26\u53f7\u8868\uff0c\n\u4f46\u662f\u65e0\u6cd5\u76f4\u63a5\u5bf9 __dict__ \u8d4b\u503c (\u4f60\u53ef\u4ee5\u5199 m.__dict__['a'] = 1\uff0c\u8fd9\u4f1a\u5c06 m.a \u5b9a\u4e49\u4e3a 1\uff0c\n\u4f46\u662f\u4e0d\u80fd\u5199 m.__dict__ = {})\u3002\u4e5f\u4e0d\u5efa\u8bae\u76f4\u63a5\u4fee\u6539__dict__\n\n\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u6807\u8bc6\u7b26\u662f\u6709\u7279\u6b8a\u610f\u4e49\u7684\n    \u2022 \u4ee5\u5355\u4e0b\u5212\u7ebf\u5f00\u5934\uff08_foo\uff09\u7684\u4ee3\u8868\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u7684\u7c7b\u5c5e\u6027\uff0c\u9700\u901a\u8fc7\u7c7b\u63d0\u4f9b\u7684\u63a5\u53e3\u8fdb\u884c\u8bbf\u95ee\n    \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\uff08__foo\uff09\u4ee3\u8868\u7c7b\u7684\u79c1\u6709\u6210\u5458\n    \u2022 \u4ee5\u53cc\u4e0b\u5212\u7ebf\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\uff08__foo__\uff09\u4ee3\u8868python\u91cc\u7279\u6b8a\u65b9\u6cd5\u4e13\u7528\u7684\u6807\u8bc6\uff0c\u5982__init__\uff08\uff09\u4ee3\u8868\u7c7b\u7684\u6784\u9020\u51fd\u6570\n\n## \u6807\u51c6\u6a21\u5757\n\nPython\u9644\u5e26\u4e00\u4e2a\u6807\u51c6\u6a21\u5757\u5e93\uff0c\u53d8\u91cfsys.ps1 \u548csys.ps2 \u5b9a\u4e49\u7528\u4f5c\u4e3b\u8981\u548c\u8f85\u52a9\u63d0\u793a\u7684\u5b57\u7b26\u4e32\uff1b\u8fd9\u4e24\u4e2a\u53d8\u91cf\u53ea\u6709\u5728\u7f16\u8bd1\u5668\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u624d\u88ab\u5b9a\u4e49\n\nsys.path\u53d8\u91cf\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868\uff0c\u7528\u4e8e\u786e\u5b9a\u89e3\u91ca\u5668\u7684\u6a21\u5757\u641c\u7d22\uff0c\u53ef\u4ee5\u4f7f\u7528\u6807\u51c6\u5217\u8868\u64cd\u4f5c\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\n\n\u5982\u4f55\u7406\u89e3__name__==\"__main__\"\uff1a\npython\u6bcf\u4e2a\u6a21\u5757\u90fd\u6709\u4e00\u4e2a\u540d\u4e3a__name__\u7684\u7279\u6b8a\u5c5e\u6027\uff0c\u5f53\u6a21\u5757\u4f5c\u4e3a\u4e3b\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c__name__\u5c5e\u6027\u7684\u503c\u5373\u4e3a'__main__'\uff0c\n\u5426\u5219__name__\u7684\u503c\u5c06\u8bbe\u7f6e\u4e3a\u5305\u542b\u6a21\u5757\u7684\u540d\u79f0\n\n### \u793a\u4f8b:\u521b\u5efamodule.py\u6587\u4ef6\u5982\u4e0b\nfoo = 100\n\ndef hello():\n    print(\"i am from my_module.py\")\n\nif __name__ == \"__main__\":\n    print(\"Executing as main program\")\n    print(\"Value of __name__ is: \", __name__)\n    hello()\n\n### \u7d27\u968f\u5176\u4e0a\uff0c\u521b\u5efatest.py\u6587\u4ef6\u5982\u4e0b\uff0cmodule.__name__\u662fmodule\u800c\u4e0d\u662f__main__\uff0c\u6b64\u5904\u672a\u8f93\u51faif.....__main__\u7684\u5185\u5bb9\nimport module\n\nprint(module.foo)\nmodule.hello()\n\nprint(module.__name__)\n\n## import\u8bed\u53e5\n\n\u51fa\u4e8e\u6548\u7387\u7684\u8003\u8651\uff0c\u6bcf\u4e2a\u6a21\u5757\u5728\u6bcf\u4e2a\u89e3\u91ca\u5668\u4f1a\u8bdd\u4e2d\u53ea\u88ab\u5bfc\u5165\u4e00\u6b21\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u66f4\u6539\u4e86\u4f60\u7684\u6a21\u5757\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u542f\u52a8\u89e3\u91ca\u5668\uff0c \u6216\u8005\uff0c\u5982\u679c\u5b83\u53ea\n\u662f\u4e00\u4e2a\u8981\u4ea4\u4e92\u5f0f\u5730\u6d4b\u8bd5\u7684\u6a21\u5757\uff0c\u8bf7\u4f7f\u7528 importlib.reload()\uff0c\u4f8b\u5982 import importlib; importlib.reload(modulename)\n\u6a21\u5757\u641c\u7d22\u8def\u5f84\uff1a\u89e3\u91ca\u5668\u9996\u5148\u5bfb\u627e\u5177\u6709\u8be5\u5bfc\u5165\u540d\u79f0\u7684\u5185\u7f6e\u6a21\u5757\uff0c\u82e5\u6ca1\u6709\u5219\u4f1a\u4ecesys.path\u53d8\u91cf\u6240\u7ed9\u51fa\u7684\u76ee\u5f55\u5217\u8868\u5bfb\u627e\uff0c\u652f\u6301\u7b26\u53f7\u94fe\u63a5\u7684\u6587\u4ef6\u7cfb\n\u7edf\u4e0a\uff0c\u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55\u662f\u5728\u8ffd\u52a0\u7b26\u53f7\u94fe\u63a5\u540e\u624d\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5305\u542b\u7b26\u53f7\u94fe\u63a5\u7684\u76ee\u5f55\u5e76\u6ca1\u6709\u88ab\u6dfb\u52a0\u5230\u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84\u4e0a\n\nsys.path\u7684\u521d\u59cb\u76ee\u5f55\u5730\u5740\uff1a\n\n* \u5305\u542b\u8f93\u5165\u811a\u672c\u7684\u76ee\u5f55(\u6216\u8005\u672a\u6307\u5b9a\u6587\u4ef6\u65f6\u7684\u5f53\u671f\u76ee\u5f55)\n* PYTHONPATH(\u4e00\u4e2a\u5305\u542b\u76ee\u5f55\u540d\u79f0\u7684\u5217\u8868\uff0c\u5176\u548cshell\u53d8\u91cfPATH\u5177\u6709\u76f8\u540c\u7684\u8bed\u6cd5)\n* \u53d6\u51b3\u4e8ePython\u5b89\u88c5\u7684\u9ed8\u8ba4\u8bbe\u7f6e\n\n\u4e86\u89e3\u4e86\u641c\u7d22\u8def\u5f84\u7684\u6982\u5ff5\uff0c\u5c31\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u4fee\u6539sys.path\u6765\u5f15\u5165\u4e00\u4e9b\u4e0d\u5728\u641c\u7d22\u8def\u5f84\u4e2d\u7684\u6a21\u5757\n**__name__\u5c5e\u6027** \u4e00\u4e2a\u6a21\u5757\u88ab\u53e6\u4e00\u4e2a\u7a0b\u5e8f\u7b2c\u4e00\u6b21\u5f15\u5165\u65f6\uff0c\u5176\u4e3b\u7a0b\u5e8f\u5c06\u8fd0\u884c\u3002\u5982\u679c\u6211\u4eec\u60f3\u5728\u6a21\u5757\u88ab\u5f15\u5165\u65f6\uff0c\u6a21\u5757\u4e2d\u7684\u67d0\u4e00\u7a0b\u5e8f\u5757\u4e0d\u6267\u884c\n\u6211\u4eec\u53ef\u4ee5\u7528__name__\u5c5e\u6027\u6765\u4f7f\u8be5\u7a0b\u5e8f\u5757\u4ec5\u5728\u8be5\u6a21\u5757\u81ea\u8eab\u8fd0\u884c\u65f6\u6267\u884c\n\nif __name__ == '__main__':\n print('\u7a0b\u5e8f\u81ea\u8eab\u5728\u8fd0\u884c')\nelse:\n print('\u6211\u6765\u81ea\u53e6\u4e00\u6a21\u5757')\n\n\u6bcf\u4e2a\u6a21\u5757\u90fd\u6709\u4e00\u4e2a__name__\u5c5e\u6027\uff0c\u5f53\u5176\u503c\u662f'__main__'\u65f6\uff0c\u8868\u660e\u8be5\u6a21\u5757\u81ea\u8eab\u5728\u8fd0\u884c\uff0c\u5426\u5219\u662f\u88ab\u5f15\u5165\n\n\u53ef\u4ee5\u5728Python\u547d\u4ee4\u4e2d\u4f7f\u7528-O\u6216-OO\u5f00\u5173,\u4ee5\u51cf\u5c0f\u7f16\u8bd1\u540e\u6a21\u5757\u7684\u5927\u5c0f\u3002-O\u5f00\u5173\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\uff0c-OO\u5f00\u5173\u540c\u65f6\u53bb\u9664\u65ad\u8a00\u8bed\u53e5\u548c__doc__\u5b57\u7b26\u4e32\n\u4e00\u4e2a\u4ece.pyc\u6587\u4ef6\u8bfb\u51fa\u7684\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u6bd4\u5b83\u4ece.py\u8bfb\u51fa\u65f6\u8fd0\u884c\u7684\u66f4\u5feb\u3002\u533a\u522b\u5728\u4e8e.pyc\u6587\u4ef6\u8f7d\u5165\u901f\u5ea6\u66f4\u5feb\ncompileall\u6a21\u5757\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6a21\u5757\u521b\u5efa.pyc\u6587\u4ef6\n\n## \u7c7b\uff1a\n\n\u7c7b\u5b9a\u4e49\u5c31\u662f\u5bf9\u7c7b\u5bf9\u8c61\u7684\u5b9a\u4e49(\u53c2\u8003[\u6807\u51c6\u7c7b\u578b\u5c42\u7ea7\u7ed3\u6784]https://docs.python.org/zh-cn/3/reference/datamodel.html#types)\n\n\u7c7b\u5b9a\u4e49\u662f\u4e00\u6761\u53ef\u6267\u884c\u8bed\u53e5\u3002 \u5176\u4e2d\u7ee7\u627f\u5217\u8868\u901a\u5e38\u7ed9\u51fa\u57fa\u7c7b\u7684\u5217\u8868\n(\u8fdb\u9636\u7528\u6cd5\u8bf7\u53c2\u89c1[\u5143\u7c7b]https://docs.python.org/zh-cn/3/reference/datamodel.html#metaclasses)\uff0c\n\u5217\u8868\u4e2d\u7684\u6bcf\u4e00\u9879\u90fd\u5e94\u5f53\u88ab\u6c42\u503c\u4e3a\u4e00\u4e2a\u5141\u8bb8\u5b50\u7c7b\u7684\u7c7b\u5bf9\u8c61\u3002\u6ca1\u6709\u7ee7\u627f\u5217\u8868\u7684\u7c7b\u9ed8\u8ba4\u7ee7\u627f\u81ea\u57fa\u7c7b object\n\n\u968f\u540e\u7c7b\u4f53\u5c06\u5728\u4e00\u4e2a\u65b0\u7684\u6267\u884c\u5e27 (\u53c2\u89c1 \u547d\u540d\u4e0e\u7ed1\u5b9a) \u4e2d\u88ab\u6267\u884c\uff0c\u4f7f\u7528\u65b0\u521b\u5efa\u7684\u5c40\u90e8\u547d\u540d\u7a7a\u95f4\u548c\u539f\u6709\u7684\u5168\u5c40\u547d\u540d\u7a7a\u95f4\u3002\uff08\u901a\u5e38\uff0c\u7c7b\u4f53\u4e3b\u8981\u5305\u542b\u51fd\u6570\u5b9a\u4e49\uff09\n\u5f53\u7c7b\u4f53\u7ed3\u675f\u6267\u884c\u65f6\uff0c\u5176\u6267\u884c\u5e27\u5c06\u88ab\u4e22\u5f03\u800c\u5176\u5c40\u90e8\u547d\u540d\u7a7a\u95f4\u4f1a\u88ab\u4fdd\u5b58\u3002 3 \u4e00\u4e2a\u7c7b\u5bf9\u8c61\u968f\u540e\u4f1a\u88ab\u521b\u5efa\uff0c\u5176\u57fa\u7c7b\u4f7f\u7528\u7ed9\u5b9a\u7684\u7ee7\u627f\u5217\u8868\uff0c\n\u5c5e\u6027\u5b57\u5178\u4f7f\u7528\u4fdd\u5b58\u7684\u5c40\u90e8\u547d\u540d\u7a7a\u95f4\u3002 \u7c7b\u540d\u79f0\u5c06\u5728\u539f\u6709\u7684\u5168\u5c40\u547d\u540d\u7a7a\u95f4\u4e2d\u7ed1\u5b9a\u5230\u8be5\u7c7b\u5bf9\u8c61\n\n\u7c7b\u7684\u521b\u5efa\u53ef\u4f7f\u7528\u5143\u7c7b\u8fdb\u884c\u91cd\u5ea6\u5b9a\u5236\u3002\u7c7b\u4e5f\u53ef\u4ee5\u88ab\u88c5\u9970\uff1a\u5c31\u50cf\u88c5\u9970\u51fd\u6570\u4e00\u6837\n\n\u6ce8\u610f\u4e8b\u9879: \u5728\u7c7b\u5b9a\u4e49\u5185\u5b9a\u4e49\u7684\u53d8\u91cf\u662f\u7c7b\u5c5e\u6027\uff1b\u5b83\u4eec\u5c06\u88ab\u7c7b\u5b9e\u4f8b\u6240\u5171\u4eab\u3002 \u5b9e\u4f8b\u5c5e\u6027\u53ef\u901a\u8fc7 self.name = value \u5728\u65b9\u6cd5\u4e2d\u8bbe\u5b9a\u3002\n\u7c7b\u548c\u5b9e\u4f8b\u5c5e\u6027\u5747\u53ef\u901a\u8fc7 \"self.name\" \u8868\u793a\u6cd5\u6765\u8bbf\u95ee\uff0c\u5f53\u901a\u8fc7\u6b64\u65b9\u5f0f\u8bbf\u95ee\u65f6\u5b9e\u4f8b\u5c5e\u6027\u4f1a\u9690\u85cf\u540c\u540d\u7684\u7c7b\u5c5e\u6027\u3002\n\u7c7b\u5c5e\u6027\u53ef\u88ab\u7528\u4f5c\u5b9e\u4f8b\u5c5e\u6027\u7684\u9ed8\u8ba4\u503c\uff0c\u4f46\u5728\u6b64\u573a\u666f\u4e0b\u4f7f\u7528\u53ef\u53d8\u503c\u53ef\u80fd\u5bfc\u81f4\u672a\u9884\u671f\u7684\u7ed3\u679c\u3002 \u53ef\u4ee5\u4f7f\u7528 \u63cf\u8ff0\u5668 \u6765\u521b\u5efa\u5177\u6709\u4e0d\u540c\u5b9e\u73b0\u7ec6\u8282\u7684\u5b9e\u4f8b\u53d8\u91cf\n\n\u7c7b\u7684\u4e13\u6709\u65b9\u6cd5\uff1a\n__init__ : \u6784\u9020\u51fd\u6570\uff0c\u5728\u751f\u6210\u5bf9\u8c61\u65f6\u8c03\u7528\n__del__ : \u6790\u6784\u51fd\u6570\uff0c\u91ca\u653e\u5bf9\u8c61\u65f6\u4f7f\u7528\n__repr__ : \u6253\u5370\uff0c\u8f6c\u6362\n__setitem__ : \u6309\u7167\u7d22\u5f15\u8d4b\u503c\n__getitem__: \u6309\u7167\u7d22\u5f15\u83b7\u53d6\u503c\n__len__: \u83b7\u5f97\u957f\u5ea6\n__cmp__: \u6bd4\u8f83\u8fd0\u7b97\n__call__: \u51fd\u6570\u8c03\u7528\n__add__: \u52a0\u8fd0\u7b97\n__sub__: \u51cf\u8fd0\u7b97\n__mul__: \u4e58\u8fd0\u7b97\n__div__: \u9664\u8fd0\u7b97\n__mod__: \u6c42\u4f59\u8fd0\u7b97\n__pow__: \u4e58\u65b9\n\n\u7c7b\u63d0\u4f9b\u4e86\u4e00\u79cd\u7ec4\u5408\u6570\u636e\u548c\u529f\u80fd\u7684\u65b9\u6cd5\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u7c7b\u610f\u5473\u7740\u521b\u5efa\u4e00\u4e2a\u65b0\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u4ece\u800c\u5141\u8bb8\u521b\u5efa\u4e00\u4e2a\u8be5\u7c7b\u578b\u7684\u65b0\u5b9e\u4f8b\u3002\u6bcf\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u53ef\u4ee5\u62e5\u6709\u4fdd\u5b58\n\u81ea\u5df1\u72b6\u6001\u7684\u5c5e\u6027\u3002\u4e00\u4e2a\u7c7b\u7684\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u6709\u6539\u53d8\u81ea\u5df1\u72b6\u6001\u7684\uff08\u5b9a\u4e49\u5728\u7c7b\u4e2d\u7684\uff09\u65b9\u6cd5\u3002Python\u7684\u7c7b\u63d0\u4f9b\u4e86\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u6240\u6709\u6807\u51c6\u7279\u6027\uff1a\u7c7b\u7ee7\u627f\u673a\u5236\n\u5141\u8bb8\u591a\u4e2a\u57fa\u7c7b\uff0c\u6d3e\u751f\u7c7b\u53ef\u4ee5\u8986\u76d6\u5b83\u57fa\u7c7b\u7684\u4efb\u4f55\u65b9\u6cd5\uff0c\u4e00\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8c03\u7528\u57fa\u7c7b\u4e2d\u76f8\u540c\u540d\u79f0\u7684\u7684\u65b9\u6cd5\u3002\u5bf9\u8c61\u53ef\u4ee5\u5305\u542b\u4efb\n\u610f\u6570\u91cf\u548c\u7c7b\u578b\u7684\u6570\u636e\u3002\u548c\u6a21\u5757\u4e00\u6837\uff0c\u7c7b\u4e5f\u62e5\u6709Python\u7684\u52a8\u6001\u7279\u6027\uff1a\u5b83\u4eec\u5728\u8fd0\u884c\u65f6\u521b\u5efa\uff0c\u53ef\u4ee5\u5728\u521b\u5efa\u540e\u4fee\u6539\n\n\u7c7b\uff1a\n    \u5b9a\u4e49\uff1a\n    class \u7c7b\u540d()\uff1a\n        def __init__(self,\u53c2\u6570\u2026\u2026):\n        def \u51fd\u6570\u540d1(self,\u53c2\u6570\u2026\u2026):\n        def \u51fd\u6570\u540d2(self,\u53c2\u6570\u2026\u2026):\n    \u8c03\u7528\uff1a\n        \u5b9e\u4f8b\u540d = \u7c7b\u540d()\n        \u5b9e\u4f8b\u540d.\u65b9\u6cd5\u540d(\u53c2\u6570)\n\n## \u5bf9\u8c61\n\n\u5bf9\u8c61\u662fPython\u5bf9\u6570\u636e\u7684\u62bd\u8c61\u3002Python\u7a0b\u5e8f\u4e2d\u7684\u6240\u6709\u6570\u636e\u90fd\u7531\u5bf9\u8c61\u6216\u5bf9\u8c61\u4e4b\u95f4\u7684\u5173\u7cfb\u8868\u793a\n\n\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u7f16\u53f7\uff0c\u7c7b\u578b\u548c\u503c\u3002\u4e00\u65e6\u521b\u5efa\u4e86\u5bf9\u8c61\uff0c\u5176\u7f16\u53f7\u5c31\u4e0d\u4f1a\u6539\u53d8\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u8be5\u5bf9\u8c61\u5728\u5185\u5b58\u4e2d\u7684\u5730\u5740\uff0ctype()\u51fd\u6570\u8fd4\u56de\u5bf9\u8c61\u7684\u7c7b\u578b\uff08\u5bf9\u8c61\u672c\u8eab\uff09\u3002\n\u7c7b\u4f3c\u7f16\u53f7\u4e00\u6837\uff0c\u5bf9\u8c61\u7684\u7c7b\u578b\u4e5f\u662f\u4e0d\u53ef\u66f4\u6539\u7684\uff0c\u67d0\u4e9b\u5bf9\u8c61\u7684\u503c\u662f\u53ef\u4ee5\u6539\u53d8\u7684\n\n\u6ce8\u610f\uff1a\u4f7f\u7528\u5b9e\u73b0\u7684\u8ddf\u8e2a\u6216\u8c03\u8bd5\u529f\u80fd\u53ef\u80fd\u4ee4\u6b63\u5e38\u60c5\u51b5\u4e0b\u4f1a\u88ab\u56de\u6536\u7684\u5bf9\u8c61\u7ee7\u7eed\u5b58\u6d3b\u3002\u8fd8\u8981\u6ce8\u610f\u901a\u8fc7 'try...except' \u8bed\u53e5\u6355\u6349\u5f02\u5e38\u4e5f\u53ef\u80fd\u4ee4\u5bf9\u8c61\u4fdd\u6301\u5b58\u6d3b\n\n\u5b9e\u4f8b\u65b9\u6cd5\u7528\u4e8e\u7ed3\u5408\u7c7b\u3001\u7c7b\u5b9e\u4f8b\u548c\u4efb\u4f55\u53ef\u8c03\u7528\u5bf9\u8c61(\u901a\u5e38\u4e3a\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570)\u3002\u7279\u6b8a\u7684\u53ea\u8bfb\u5c5e\u6027: __self__ \u4e3a\u7c7b\u5b9e\u4f8b\u5bf9\u8c61\u672c\u8eab\uff0c__func__ \u4e3a\u51fd\u6570\u5bf9\u8c61\uff1b\n__doc__ \u4e3a\u65b9\u6cd5\u7684\u6587\u6863 (\u4e0e __func__.__doc__ \u4f5c\u7528\u76f8\u540c)\uff1b__name__ \u4e3a\u65b9\u6cd5\u540d\u79f0 (\u4e0e __func__.__name__ \u4f5c\u7528\u76f8\u540c)\uff1b\n__module__ \u4e3a\u65b9\u6cd5\u6240\u5c5e\u6a21\u5757\u7684\u540d\u79f0\uff0c\u6ca1\u6709\u5219\u4e3a None\n\n\u5f53\u4e00\u4e2a\u5b9e\u4f8b\u65b9\u6cd5\u5bf9\u8c61\u88ab\u8c03\u7528\u65f6\uff0c\u4f1a\u8c03\u7528\u5bf9\u5e94\u7684\u4e0b\u5c42\u51fd\u6570 (__func__)\uff0c\u5e76\u5c06\u7c7b\u5b9e\u4f8b (__self__) \u63d2\u5165\u53c2\u6570\u5217\u8868\u7684\u5f00\u5934\u3002\n\u4f8b\u5982\uff0c\u5f53 C \u662f\u4e00\u4e2a\u5305\u542b\u4e86 f() \u51fd\u6570\u5b9a\u4e49\u7684\u7c7b\uff0c\u800c x \u662f C \u7684\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5219\u8c03\u7528 x.f(1) \u5c31\u7b49\u540c\u4e8e\u8c03\u7528 C.f(x, 1)\n\n## \u51fd\u6570\n\n\u51fd\u6570\u5bf9\u8c61\u662f\u901a\u8fc7\u51fd\u6570\u5b9a\u4e49\u521b\u5efa\u7684\u3002 \u5bf9\u51fd\u6570\u5bf9\u8c61\u7684\u552f\u4e00\u64cd\u4f5c\u662f\u8c03\u7528\u5b83: func(argument-list)\n\n\u5b9e\u9645\u4e0a\u5b58\u5728\u4e24\u79cd\u4e0d\u540c\u7684\u51fd\u6570\u5bf9\u8c61\uff1a\u5185\u7f6e\u51fd\u6570\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570\u3002 \u4e24\u8005\u652f\u6301\u540c\u6837\u7684\u64cd\u4f5c\uff08\u8c03\u7528\u51fd\u6570\uff09\uff0c\u4f46\u5b9e\u73b0\u65b9\u5f0f\u4e0d\u540c\uff0c\u56e0\u6b64\u5bf9\u8c61\u7c7b\u578b\u4e5f\u4e0d\u540c\n\n\u51fd\u6570\uff1a\n   \u5b9a\u4e49\uff1a\n   def \u51fd\u6570\u540d\uff08\u53c2\u65701\uff0c\u53c2\u65702\u2026\u2026\uff09\uff1a\n       \u8bed\u53e5\u5757\n       return \u8fd4\u56de\u503c\n   \u8c03\u7528\uff1a\n       \u51fd\u6570\u540d\uff08\u53c2\u65701\uff0c\u53c2\u65702\u2026\u2026\uff09\n       \u53d8\u91cf\u540d = \u51fd\u6570\u540d\uff08\u53c2\u65701\uff0c\u53c2\u65702\u2026\u2026\uff09\n\n## \u65b9\u6cd5\n\n\u65b9\u6cd5\u662f\u4f7f\u7528\u5c5e\u6027\u8868\u793a\u6cd5\u6765\u8c03\u7528\u7684\u51fd\u6570\u3002\u5b58\u5728\u4e24\u79cd\u5f62\u5f0f\uff1a\u5185\u7f6e\u65b9\u6cd5\uff08\u4f8b\u5982\u5217\u8868\u7684append()\u65b9\u6cd5\uff09\u548c\u7c7b\u5b9e\u4f8b\u65b9\u6cd5\u3002\u5185\u7f6e\u65b9\u6cd5\u7531\u652f\u6301\u5b83\u4eec\u7684\u7c7b\u578b\u6765\u63cf\u8ff0\n\n## \u5305(packages)\n\n\u53ef\u4ee5\u628a\u5305\u770b\u6210\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\uff0c\u5e76\u628a\u6a21\u5757\u770b\u6210\u662f\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u4f46\u4e0d\u8981\u5bf9\u8fd9\u4e2a\u7c7b\u4f3c\u505a\u8fc7\u4e8e\u5b57\u9762\u7684\u7406\u89e3\uff0c\u56e0\u4e3a\u5305\u548c\u6a21\u5757\u4e0d\u662f\u5fc5\u987b\u6765\u81ea\u4e8e\u6587\u4ef6\u7cfb\u7edf\n\n\u8981\u6ce8\u610f\u7684\u4e00\u4e2a\u91cd\u70b9\u6982\u5ff5\u662f\u6240\u6709\u5305\u90fd\u662f\u6a21\u5757\uff0c\u4f46\u5e76\u975e\u6240\u6709\u6a21\u5757\u90fd\u662f\u5305\u3002\u6216\u8005\u6362\u53e5\u8bdd\u8bf4\uff0c\u5305\u53ea\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6a21\u5757\u3002\n\u7279\u522b\u5730\uff0c\u4efb\u4f55\u5177\u6709 __path__ \u5c5e\u6027\u7684\u6a21\u5757\u90fd\u4f1a\u88ab\u5f53\u4f5c\u662f\u5305\n\n* \u8981\u4f7f\u7528\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5b57\u9762\u503c\uff0c\u5728\u5b57\u7b26\u4e32\u5f00\u59cb\u5f15\u53f7\u6216\u4e09\u5f15\u53f7\u4e4b\u524d\u52a0\u4e0a\u4e00\u4e2af\u6216F\uff0c\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\uff0c\u53ef\u4ee5\u5728{}\u5b57\u7b26\u4e4b\u95f4\u5f15\u7528\u53d8\u91cf\u6216\u5b57\u9762\u503c\u7684Python\u8868\u8fbe\u5f0f\n* \u5b57\u7b26\u4e32\u7684str.format()\u65b9\u6cd5\n* \u4f7f\u7528\u5b57\u7b26\u4e32\u5207\u7247\u548c\u8fde\u63a5\u64cd\u4f5c\u81ea\u884c\u5b8c\u6210\u5bf9\u6240\u6709\u5b57\u7b26\u4e32\u7684\u5904\u7406\n\n### \u5bfc\u5165\u6a21\u5757\n\nimport math # \u5bfc\u5165math\u6a21\u5757\n\nfrom math import ceil, floor    # \u4ece\u4e00\u4e2a\u6a21\u5757\u5bfc\u5165\u7279\u5b9a\u7684\u51fd\u6570ceil,floor\n\nimport math as m    ### \u5bfc\u5165\u5e76\u7b80\u5316\u4e00\u4e2a\u6a21\u5757\u7684\u540d\u79f0\n\n## Python\u5f00\u53d1\u73af\u5883\u6700\u4f73\u5b9e\u8df5\n\n```bash\n# \u8bbe\u7f6epip\u914d\u7f6e\u6587\u4ef6\n: &lt;&lt; comment\nLinux\uff1a$HOME/.pip/pip.conf\nWindows\uff1a%APPDATA%\\pip\\pip.ini\nvirtualenv\uff1a%VIRTUAL_ENV%\\pip.ini\n\u5168\u5c40\u751f\u6548\u8bbe\u7f6e\u5982\u4e0b\uff1a(\u4e0d\u652f\u6301Windows Vista)\nLinux\uff1a/etc/pip.conf\nWindows XP\uff1aC:\\Documents and Settings\\All Users\\Application Data\\pip\\pip.ini\nWindows7\u6216\u4e4b\u540e\u7248\u672c\uff1aC:\\ProgramData\\pip\\pip.ini\ncomment\n\n# pip\u914d\u7f6e\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a\n[global]\ntimeout = 120\nno-cache-dir = true\nindex-url = https://mirrors.aliyun.com/pypi/simple/\nextra-index-url = https://mirrors.huaweicloud.com/repository/pypi/simple\n\n[freeze]\ntimeout = 10\n\n[install]\nignore-installed = true\ntrusted-host =\n    mirrors.aliyun.com\n    mirrors.huaweicloud.com\n\npython -m SimpleHTTPServer | Serve current directory tree at http://$HOSTNAME:8000/     # \u5229\u7528python\u7b80\u5355\u5efa\u7acbwebserver\n\n# yum -y install epel-release\n# yum -y install python2-pip\n# yum -y install python3-pip\npython -m pip install -U pip setuptools\n\n# python -m site --user-base \u627e\u5230 \u7528\u6237\u57fa\u7840\u76ee\u5f55,\u5c06\u57fa\u7840\u76ee\u5f55\u6dfb\u52a0\u5230PATH\n# \u5728 Windows \u4e0a\uff0c\u60a8\u901a\u8fc7\u8fd0\u884c py -m site --user-site \u627e\u5230\u7528\u6237\u57fa\u7840\u76ee\u5f55\uff0c\u5c06 site-packages \u66ff\u6362\u4e3a Scripts\n# \u81ea\u5b9a\u4e49pipenv\u865a\u62df\u73af\u5883\u521b\u5efa\u76ee\u5f55\uff0cwindows\u901a\u8fc7\u8bbe\u7f6e\u53d8\u91cfWORKON_HOME\uff0c\u5176\u503c\u8bbe\u7f6e\u4e3aPIPENV_VENV_IN_PROJECT\u65f6\u8868\u793a\u5f53\u9879\u76ee\u76ee\u5f55\u4e2d\u521b\u5efa\n# linux\u5728.bashrc\u6587\u4ef6\u6dfb\u52a0export PIPENV_VENV_IN_PROJECT=1\u6216export PIPENV_VENV_IN_PROJECT=\"enabled\"\npip install --user pipenv\n\n# \u5728Windows\u5b89\u88c5virtualenv\u548cvirtualenvwrapper-win\u7528\u4e8e\u521b\u5efa\u591a\u4e2aPython\u7248\u672c\u5f00\u53d1\u73af\u5883\uff0cLinux\u4e2d\u6700\u597d\u4f7f\u7528pyenv\u4ee3\u66ff\n# \u5b89\u88c5pipenv\u548cautoenv\uff0c\u81ea\u52a8\u6fc0\u6d3b\u73af\u5883\n# \u5728Linux\u4e0a:\ngit clone git://github.com/kennethreitz/autoenv.git ~/.autoenv\necho 'source ~/.autoenv/activate.sh' &gt;&gt; ~/.bashrc\n\n# pipes\uff1aPipenv\u865a\u62df\u73af\u5883\u5207\u6362\u5de5\u5177\n# MacOs + Ubuntu:\npip3 install pipenv-pipes --user\n\n# Windows:\npip3 install pipenv-pipes\npip3 install curses --find-links=https://github.com/gtalarico/curses-win/releases\n</code></pre>"},{"location":"coding/Python3/#_1","title":"\u7b80\u4ecb","text":"Markdown<pre><code>#!/usr/bin/python3\n# -*- coding: UTF-8 -*-\n# Python\u4e2d\u5355\u884c\u6ce8\u91ca\u4ee5#\u5f00\u5934\uff0c\u591a\u884c\u6ce8\u91ca\u7528\u4e09\u4e2a\u5355\u5f15\u53f7\uff08```\uff09\u6216\u8005\u4e09\u4e2a\u53cc\u5f15\u53f7\uff08\"\"\"\uff09\u5c06\u6ce8\u91ca\u62ec\u8d77\u6765\n# \u7279\u6b8a\u5b57\u7b26\u6bd4\u5982\\n\u5728\u5355\u53cc\u5f15\u53f7\u6709\u540c\u6837\u7684\u610f\u4e49\uff0c\u4e0d\u540c\u4e4b\u5904\u662f\u5728\u5355\u5f15\u53f7\u4e2d\u65e0\u9700\u8f6c\u4e49\u53cc\u5f15\u53f7\uff0c\u4e5f\u5c31\u662f\u8868\u793a\u5176\u5b9e\u9645\u610f\u4e49\u3002\u53cd\u4e4b\u4ea6\u7136\n\nhelp(len)           # \u5185\u5efalen()\u51fd\u6570\u5e2e\u52a9\nhelp(sys)           # sys\u6a21\u5757\u5e2e\u52a9,\u5fc5\u987b\u5148import sys\nhelp(sys.exit)      # exit()\u51fd\u6570\u5728sys\u6a21\u5757\u7684\u5e2e\u52a9\nhelp('xyz'.split)   # \u5bf9\u4e8estring\u5bf9\u8c61splist()\u65b9\u6cd5\u7684\u5e2e\u52a9\uff0c\u548chelp(str.split)\u4e00\u6837\nhelp(list)          # list\u5bf9\u8c61\u5e2e\u52a9\nhelp(list.append)   # list\u5bf9\u8c61append()\u65b9\u6cd5\u5e2e\u52a9\ndir(list)           # \u663e\u793alist\u5bf9\u8c61\u5c5e\u6027\uff0c\u5305\u62ec\u5176\u65b9\u6cd5\ndir(sys)            # \u7c7b\u4f3chelp()\n\npython\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u6709\u56db\u79cd\uff1a\u6574\u6570int\u3001\u957f\u6574\u6570\u3001\u6d6e\u70b9\u6570float\u3001\u590d\u6570complex\npython\u4e2d\u53d8\u91cf\u65e0\u9700\u58f0\u660e\uff0c\u6bcf\u4e2a\u53d8\u91cf\u5728\u4f7f\u7528\u524d\u5fc5\u987b\u8d4b\u503c\uff0c\u53d8\u91cf\u8d4b\u503c\u540e\u8be5\u53d8\u91cf\u624d\u4f1a\u88ab\u521b\u5efa\u3002\u53d8\u91cf\u6ca1\u6709\u7c7b\u578b\uff0c\u800c\u901a\u5e38\u6240\u8bf4\u7684\u201c\u7c7b\u578b\u201d\u6307\u5185\u5b58\u4e2d\u5bf9\u8c61\u7684\u7c7b\u578b\n\npython3\u4e2d\u5e38\u7528\u7684\u5185\u7f6e\u6570\u636e\u7c7b\u578b\uff1a\n* Boolean (\u5e03\u5c14\u503c)\n* Numbers (\u6570\u5b57)\n* String (\u5b57\u7b26\u4e32)\n* Bytes (\u5b57\u8282)\n* List (\u5217\u8868)\n  * \u793a\u4f8b\uff1alist1 = ['Google', 'aws', 1997, 2000]\n  * \u7a7a\u5217\u8868:list2 = []\n* Tuple (\u5143\u7ec4)\n  * \u793a\u4f8b\uff1atuple1 = ('Google', 'aws', 1997, 2000)\n  * \u7a7a\u5143\u7ec4:tuple2 = ()  ======&gt;&gt;\u7b49\u4ef7\u4e8etuple1 = tuple()\n* Sets (\u96c6\u5408)\n  * \u793a\u4f8b\uff1aset1 = {'apple', 234, 'apple', 'banana'}\n  * \u7a7a\u96c6\u5408\uff1aset2 = set()\n* Dictionaries (\u5b57\u5178)\n  * \u793a\u4f8b\uff1adict1 = {'Alice': '21', 'Beth': '12', 'Cecil': '19'}\n  * \u7a7a\u5b57\u5178:dict1 = {}\n\npython\u53ef\u53d8\u6570\u636e\u7c7b\u578b\uff1alist\u3001dict\npython\u4e0d\u53ef\u53d8\u6570\u636e\u7c7b\u578b\uff1aint\u3001str\u3001tuple\n</code></pre>"},{"location":"coding/Python3/#-","title":"\u5185\u7f6e\u51fd\u6570\u5217\u8868 -- \u975e\u5168\u9762\u6027","text":""},{"location":"coding/Python3/#absx","title":"abs(x)","text":"<p>\u8fd4\u56de\u6570\u5b57\u7684\u7edd\u5bf9\u503c\uff0c\u53c2\u6570x\u5fc5\u987b\u662f\u6574\u6570\u6216\u6d6e\u70b9\u6570\uff0c\u5982\u679c\u53c2\u6570\u4e3a\u590d\u6570\uff0c\u5219\u8fd4\u56de\u5176\u5927\u5c0f</p>"},{"location":"coding/Python3/#alliterable","title":"all(iterable)","text":"<p>\u5982\u679c\u6240\u6709\u5143\u7d20\u7684\u8fed\u4ee3\u90fd\u662ftrue(\u6216iterable\u4e3a\u7a7a)\uff0c\u5219\u8fd4\u56deTrue\uff0c\u76f8\u5f53\u4e8e\uff1a</p> Python<pre><code>def all(iterable):\n    for element in iterable:\n        if not element:\n            return False\n    return True\n</code></pre>"},{"location":"coding/Python3/#anyiterable","title":"any(iterable)","text":"<p>\u5982\u679citerable\u7684\u4efb\u4f55\u5143\u7d20\u4e3atrue\uff0c\u5373\u6709\u4e00\u4e2a\u4e3a\u771f\u65f6\uff0c\u5219\u8fd4\u56deTrue\uff0c\u5426\u5219False\uff0c\u76f8\u5f53\u4e8e\uff1a</p> Python<pre><code>def any(iterable):\n    for element in iterable:\n        if element:\n            return True\n    return False\n</code></pre>"},{"location":"coding/Python3/#binx","title":"bin(x)","text":"Python<pre><code># \u5c06\u6574\u6570\u8f6c\u6362\u4e3a\u524d\u7f00\u5e26\u6709'0b'\u7684\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32\uff0c\u7ed3\u679c\u4e3a\u6709\u6548\u7684python\u8868\u8fbe\u5f0f\n# \u53bb\u9664\u524d\u7f00ob\u7684\u65b9\u6cd5\u6709\u4e24\u79cd\nprint(format(14, '#b'), format(14, 'b'))   # \u65b9\u6cd5\u4e00\n\nprint(f'{14:#b}', f'{14:b}')    # \u65b9\u6cd5\u4e8c\n</code></pre>"},{"location":"coding/Python3/#chri","title":"chr(i)","text":"<p>\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u7684unicode\u4ee3\u7801\u70b9\u7684\u6574\u6570\uff0c\u4f8b\uff1achr(97)\u8fd4\u56de\u5b57\u7b26\u4e32'a'\uff0c\u4e0e\u5176\u76f8\u53cd\u662ford()</p>"},{"location":"coding/Python3/#enumerateiterable-start0","title":"enumerate(iterable, start=0)","text":"<p>\u8fd4\u56de\u4e00\u4e2a\u679a\u4e3e\u5bf9\u8c61\uff0citerable\u5fc5\u987b\u4e3a\u5e8f\u5217\uff0c\u8fed\u4ee3\u5668\u6216\u5176\u4ed6\u652f\u6301\u8fed\u4ee3\u7684\u5bf9\u8c61\uff0cnext()\u662f\u7531enumerate()\u8fd4\u56de\u7684\u8fed\u4ee3\u5668\u7684\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5143\u7ec4\uff0c \u8be5\u5143\u7ec4\u5305\u62ec\u4e00\u4e2a\u8ba1\u6570(start\u4e3a\u5f00\u59cb\uff0c\u9ed8\u8ba4\u4e3a0)\u4ee5\u53ca\u901a\u8fc7\u5bf9iterable\u8fdb\u884c\u8fed\u4ee3\u83b7\u5f97\u7684\u503c</p>"},{"location":"coding/Python3/#evalexpression-globals-locals","title":"eval(expression[, globals[, locals]])","text":"Markdown<pre><code>eval()\u80fd\u591f\u6267\u884c\u4efb\u610f\u7684\u5b57\u7b26\u4e32\u4f5c\u4e3apython\u4ee3\u7801\uff0c\u5176\u63a5\u53d7\u6e90\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\uff0cexpression\u53ef\u4ee5\u662f\u4efb\u4f55\u6709\u6548\u7684python\u8868\u8fbe\u5f0f\nglobals\uff1a\u6267\u884c\u6e90\u65f6\u8981\u4f7f\u7528\u7684\u5168\u5c40\u540d\u79f0\u7a7a\u95f4\u3002\u5b83\u5fc5\u987b\u662f\u5b57\u5178\u3002\u5982\u679c\u672a\u63d0\u4f9b\uff0c\u5219\u5c06\u4f7f\u7528\u5f53\u524d\u7684\u5168\u5c40\u540d\u79f0\u7a7a\u95f4\nlocals\uff1a\u6267\u884c\u6e90\u65f6\u8981\u4f7f\u7528\u7684\u672c\u5730\u540d\u79f0\u7a7a\u95f4\u3002\u5b83\u53ef\u4ee5\u662f\u4efb\u4f55\u6620\u5c04\u5bf9\u8c61\u3002\u5982\u679c\u7701\u7565\uff0c\u5219\u9ed8\u8ba4\u4e3a\u5168\u5c40\u5b57\u5178\n\n\u9632\u6b62\u4e0d\u53d7\u4fe1\u4efb\u7684\u6e90\u76f4\u63a5\u4f20\u9012\u7ed9eval()\uff0c\u5bfc\u81f4\u5bf9\u7cfb\u7edf\u9020\u6210\u7834\u574f\uff0c\u90a3\u4e48\u4f7feval()\u5b89\u5168\u7684\u53c2\u8003\u65b9\u6cd5\u5982\u4e0b\n\u6307\u5b9a\u540d\u79f0\u7a7a\u95f4\uff1aeval()\u53ef\u9009\u7684\u63a5\u53d7\u4e24\u4e2a\u6620\u5c04\u5145\u5f53\u8981\u88ab\u6267\u884c\u7528\u4e8e\u8868\u8fbe\u7684\u5168\u5c40\u548c\u5c40\u90e8\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u5982\u679c\u672a\u63d0\u4f9b\u6620\u5c04\uff0c\u5219\u4f7f\u7528\u5168\u5c40\u548c\u5c40\u90e8\u540d\u79f0\u7a7a\u95f4\u7684\u5f53\u524d\u503c\nprint('abs(-10)', {'__builtins__':None}, {})    # \u5220\u9664\u5bf9\u5185\u7f6e\u51fd\u6570\u7684\u8bbf\u95ee\n\u4ee5\u4e0a\u65b9\u6cd5\u4ecd\u7136\u4e0d\u591f\u5b89\u5168\uff0c\u5982\u679c\u4f20\u9012\u7684expression\u672c\u8eab\u5c31\u5177\u6709\u5f3a\u6253\u7684\u653b\u51fb\u6027\uff0c\u4e5f\u4f1a\u51fa\u73b0\u5b89\u5168\u95ee\u9898\uff0c\u6240\u4ee5\u5173\u952e\u70b9\u5c31\u662f\u4ec5\u5bf9\u53d7\u4fe1\u4efb\u7684\u6e90\u4f7f\u7528eval()\n</code></pre>"},{"location":"coding/Python3/#filterfunction-iterable","title":"filter(function, iterable)","text":"<p>\u5f53function\u8fd4\u56detrue\u65f6\uff0c\u4e3a\u8fd9\u4e9biterable\u7684\u5143\u7d20\u6784\u9020\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0citerable\u53ef\u4ee5\u4e3a\u5e8f\u5217\u3001\u652f\u6301\u8fed\u4ee3\u7684\u5bb9\u5668\u548c\u8fed\u4ee3\u5668\uff0c \u5982\u679cfunction\u662fNone\uff0c\u5219\u5047\u5b9a\u4e3a\u8eab\u4efd\u51fd\u6570\uff0c\u5373\u5220\u9664\u6240\u6709false\u7684iterable\u7684\u5143\u7d20</p>"},{"location":"coding/Python3/#globals","title":"globals()","text":"<p>\u8fd4\u56de\u8868\u793a\u5f53\u524d\u5168\u5c40\u7b26\u53f7\u8868\u7684\u5b57\u5178\uff0c\u59cb\u7ec8\u662f\u5f53\u524d\u6a21\u5757\u7684\u5b57\u5178(\u5728\u51fd\u6570\u6216\u65b9\u6cd5\u5185\u90e8\uff0c\u8fd9\u662f\u5b9a\u4e49\u5b83\u7684\u6a21\u5757\uff0c\u800c\u4e0d\u662f\u4ece\u4e2d\u8c03\u7528\u5b83\u7684\u6a21\u5757)</p>"},{"location":"coding/Python3/#idobject","title":"id(object)","text":"<p>\u8fd4\u56deobject\u7684\u201d\u8eab\u4efd\u201c\uff0c\u8fd9\u662f\u4e2a\u6574\u6570\uff0c\u7528\u4ee5\u4fdd\u8bc1\u5728\u6b64\u5bf9\u8c61\u7684\u751f\u5b58\u671f\u5185\u552f\u4e00\u4e14\u6052\u5b9a\uff0c\u4f46\u5177\u6709\u4e0d\u91cd\u53e0\u751f\u547d\u5468\u671f\u7684\u4e24\u4e2a\u5bf9\u8c61\u53ef\u80fd\u5177\u6709\u76f8\u540c\u7684id()\u503c</p>"},{"location":"coding/Python3/#lens","title":"len(s)","text":"<p>\u8fd4\u56de\u5bf9\u8c61\u7684\u957f\u5ea6(\u9879\u76ee\u6570),\u53c2\u6570\u53ef\u4ee5\u662f\u5e8f\u5217\u6216\u96c6\u5408</p>"},{"location":"coding/Python3/#locals","title":"locals()","text":"<p>\u66f4\u65b0\u5e76\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u5728\u672c\u5730\u540d\u79f0\u7a7a\u95f4\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf\u7684\u5b57\u5178\uff0clocals()\u5728\u529f\u80fd\u5757\u4e2d\u8c03\u7528\u81ea\u7531\u53d8\u91cf\u4f1a\u8fd4\u56de\u81ea\u7531\u53d8\u91cf\uff0c\u800c\u5728\u7c7b\u5757\u4e2d\u5219\u4e0d\u4f1a\uff0c \u5728\u6a21\u5757\u7ea7\u522b(\u5168\u5c40\u540d\u79f0\u7a7a\u95f4)locals()\u548cglobals()\u662f\u76f8\u540c\u7684\u5b57\u5178</p> <p>\u6ce8\u610f\uff1a\u8be5\u5b57\u5178\u7684\u5185\u5bb9\u4e0d\u5f97\u4fee\u6539\uff1b\u66f4\u6539\u53ef\u80fd\u4e0d\u4f1a\u5f71\u54cd\u89e3\u91ca\u5668\u4f7f\u7528\u7684\u5c40\u90e8\u53d8\u91cf\u548c\u81ea\u7531\u53d8\u91cf\u7684\u503c</p>"},{"location":"coding/Python3/#mapfunction-iterable","title":"map(function, iterable, ...)","text":"<p>\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u8be5\u8fed\u4ee3\u5668\u5c06\u51fd\u6570\u5e94\u7528\u4e8eiterable\u7684\u6bcf\u4e2a\u9879\u76ee\u5e76\u8fd4\u56de\u7ed3\u679c\uff0c\u5982\u679c\u4f20\u9012\u4e86\u5176\u4ed6\u53ef\u8fed\u4ee3\u53c2\u6570\u5219\u51fd\u6570\u5fc5\u987b\u91c7\u7528\u90a3\u4e48\u591a\u53c2\u6570\uff0c\u5e76\u4e14\u5e76\u884c\u5730\u5c06 \u5176\u5e94\u7528\u4e8e\u6240\u6709\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u9879</p>"},{"location":"coding/Python3/#max","title":"max()","text":"<p>\u8fd4\u56de\u53ef\u8fed\u4ee3\u7684\u6700\u5927\u9879\u76ee\u6216\u4e24\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u4e2d\u6700\u5927\u7684\u9879\u76ee\uff0c\u5982\u679c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4f4d\u7f6e\u53c2\u6570\uff0c\u5219\u5e94\u8be5\u662f\u53ef\u8fed\u4ee3\u7684\uff0c\u8fd4\u56deiterable\u4e2d\u6700\u5927\u7684\u9879\u76ee\uff0c\u5982\u679c\u63d0\u4f9b\u4e86\u4e24\u4e2a \u6216\u591a\u4e2a\u4f4d\u7f6e\u53c2\u6570\uff0c\u5219\u8fd4\u56de\u5634\u7684\u4f4d\u7f6e\u53c2\u6570\u3002\u591a\u4e2a\u6700\u5927\u9879\u65f6\uff0c\u8fd4\u56de\u7b2c\u4e00\u4e2a</p>"},{"location":"coding/Python3/#min","title":"min()","text":"<p>\u8fd4\u56de\u53ef\u8fed\u4ee3\u7684\u6700\u5c0f\u9879\u6216\u4e24\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u4e2d\u7684\u6700\u5c0f\u9879</p>"},{"location":"coding/Python3/#ordc","title":"ord\u00a9","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u8868\u793aunicode\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u8fd4\u56de\u4e00\u4e2a\u6574\u6570\u8868\u793a\u8be5\u5b57\u7b26\u7684unicode\u4ee3\u7801\u70b9\uff0c\u5bf9\u4e8eASCII\u5b57\u7b26\uff0c\u8fd4\u56de\u503c\u662f7\u4f4dASCII\u4ee3\u7801,\u4e0e\u5176\u76f8\u53cd\u7684\u51fd\u6570\u4e3achr()</p>"},{"location":"coding/Python3/#rangestop-rangestart-stopstep","title":"range(stop) -- range(start, stop[,step])","text":"<p>range\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u4e0d\u53ef\u53d8\u7684\u5e8f\u5217\u7c7b\u578b\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u51fd\u6570 xrange()\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\u800c\u4e0d\u662f\u5217\u8868\u4e2d\u7684\u5217\u8868\uff0c\u5728\u5185\u5b58\u4e2d\u5360\u7528\u66f4\u5c0f</p>"},{"location":"coding/Python3/#reversedseq","title":"reversed(seq)","text":"<p>\u8fd4\u56de\u4e00\u4e2a\u53cd\u5411\u8fed\u4ee3\u5668\uff0cseq\u5fc5\u987b\u5177\u6709__reversed__()\u65b9\u6cd5\u6216\u652f\u6301\u5e8f\u5217\u534f\u8bae\u7684\u5bf9\u8c61</p>"},{"location":"coding/Python3/#sortediterable-keynone-reversefalse","title":"sorted(iterable, *, key=None, reverse=False)","text":"<p>\u4eceiterable\u4e2d\u7684\u9879\u76ee\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u6392\u5e8f\u5217\u8868\uff0c\u6709\u4e24\u4e2a\u53ef\u9009\u53c2\u6570\uff0c\u5fc5\u987b\u5c06\u5176\u6307\u5b9a\u4e3a\u5173\u952e\u5b57\u53c2\u6570\uff0ckey\u6307\u5b9a\u4e00\u4e2a\u53c2\u6570\u7684\u529f\u80fd\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u4eceiterable\u4e2d \u7684\u6bcf\u4e2a\u5143\u7d20\u4e2d\u63d0\u53d6\u4e00\u4e2a\u6bd4\u8f83\u952e(\u4f8b\u5982\uff1akey=str.lower)\uff0c\u9ed8\u8ba4\u4e3aNone\u76f4\u63a5\u6bd4\u8f83\u5143\u7d20\uff0creverse\u662f\u4e00\u4e2a\u5e03\u5c14\u503c\uff0cTrue\u8868\u793a\u5bf9\u5217\u8868\u8fdb\u884c\u53cd\u8f6c\u6392\u5e8f</p>"},{"location":"coding/Python3/#sumiterable-start0","title":"sum(iterable, /, start=0)","text":"<p>\u4ece\u5de6\u5230\u53f3\u5f00\u59cb\u6c42\u548c\u8fed\u4ee3\u7684\u9879\u76ee\u7136\u540e\u8fd4\u56de\u603b\u6570\uff0c\u8be5\u8fed\u4ee3\u7684\u9879\u76ee\u901a\u5e38\u4e3a\u6574\u6570\uff0c\u8d77\u59cb\u503c\u4e0d\u5141\u8bb8\u4e3a\u5b57\u7b26\u4e32\u3002 \u8fde\u63a5\u5b57\u7b26\u4e32\u5e8f\u5217\u7684\u9996\u9009\u5feb\u901f\u65b9\u6cd5\u662f\u8c03\u7528''.join(sequence)\uff0c\u8981\u4e32\u8054\u4e00\u7cfb\u5217\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u63a8\u8350\u4f7f\u7528itertools.chain()</p>"},{"location":"coding/Python3/#zipiterables","title":"zip(*iterables)","text":"<p>\u521b\u5efa\u4e00\u4e2a\u8fed\u4ee3\u5668\u4ee5\u805a\u5408\u6bcf\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e2d\u7684\u5143\u7d20</p> <p>\u8fd4\u56de\u5143\u7ec4\u7684\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u5176\u4e2d\u7b2ci\u4e2a\u5143\u7ec4\u5305\u542b\u6bcf\u4e2a\u53c2\u6570\u5e8f\u5217\u6216\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e2d\u7684\u7b2ci\u4e2a\u5143\u7d20\u3002\u5f53\u6700\u77ed\u7684\u53ef\u8fed\u4ee3\u8f93\u5165\u8017\u5c3d\u65f6\uff0c\u8fed\u4ee3\u5668\u5c06\u505c\u6b62\u3002 \u4f7f\u7528\u5355\u4e2a\u53ef\u8fed\u4ee3\u53c2\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5143\u7ec4\u7684\u8fed\u4ee3\u5668\u3002\u6ca1\u6709\u53c2\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684\u8fed\u4ee3\u5668\u3002\u76f8\u5f53\u4e8e\u4ee5\u4e0b\u793a\u4f8b\uff1a</p> Python<pre><code>def zip(*iterables):\n    # zip('ABCD', 'xy') --&gt; Ax By\n    sentinel = object()\n    iterators = [iter(it) for it in iterables]\n    while iterators:\n        result = []\n        for it in iterators:\n            elem = next(it, sentinel)\n            if elem is sentinel:\n                return\n            result.append(elem)\n        yield tuple(result)\n</code></pre>"},{"location":"coding/Python3/#_2","title":"\u5185\u7f6e\u5e38\u91cf","text":"<p>\u5c11\u6570\u7684\u5e38\u91cf\u5b58\u5728\u4e8e\u5185\u7f6e\u547d\u540d\u7a7a\u95f4\u4e2d\uff1a</p>"},{"location":"coding/Python3/#_3","title":"\u5185\u7f6e\u7c7b\u578b","text":"<p>\u4e3b\u8981\u5185\u7f6e\u7c7b\u578b\u6709\u6570\u5b57\u3001\u5e8f\u5217\u3001\u6620\u5c04\u3001\u7c7b\u3001\u5b9e\u4f8b\u548c\u5f02\u5e38\uff0c\u5b9e\u9645\u4e0a\u6240\u6709\u5bf9\u8c61\u90fd\u53ef\u4ee5\u6bd4\u8f83\u662f\u5426\u76f8\u7b49\u3001\u68c0\u6d4b\u903b\u8f91\u503c\uff0c\u4ee5\u53ca\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32(\u4f7f\u7528repr()\u51fd\u6570\u6216\u7565\u6709\u5dee\u5f02\u7684str()\u51fd\u6570) \u540e\u4e00\u4e2a\u51fd\u6570\u662f\u5728\u5bf9\u8c61\u7531 print() \u51fd\u6570\u8f93\u51fa\u65f6\u88ab\u9690\u5f0f\u5730\u8c03\u7528\u7684</p>"},{"location":"coding/Python3/#_4","title":"\u903b\u8f91\u503c\u68c0\u6d4b","text":"<p>\u4efb\u4f55\u5bf9\u8c61\u90fd\u53ef\u4ee5\u8fdb\u884c\u903b\u8f91\u503c\u68c0\u6d4b\uff0c\u4ee5\u4fbf\u4e8e\u5728if\u6216while\u4e2d\u4f5c\u4e3a\u6761\u4ef6\u6216\u4f5c\u4e3a\u4e0b\u6587\u5e03\u5c14\u503c\u8fd0\u7b97\u7684\u64cd\u4f5c\u6570\u6765\u4f7f\u7528</p> <p>\u4e00\u4e2a\u5bf9\u8c61\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5747\u88ab\u89c6\u4e3a\u771f\u503c\uff0c\u9664\u975e\u8be5\u5bf9\u8c61\u88ab\u8c03\u7528\u65f6\u5176\u6240\u5c5e\u7c7b\u5b9a\u4e49\u4e86__bool__()\u65b9\u6cd5\u4e14\u8fd4\u56deFalse\u6216\u8005\u5b9a\u4e49\u4e86__len__()\u65b9\u6cd5\u4e14\u8fd4\u56de0 \u4ee5\u4e0b\u57fa\u672c\u5217\u51fa\u4f1a\u88ab\u89c6\u4e3a\u5047\u503c\u7684\u5185\u7f6e\u5bf9\u8c61\uff1a</p> <p>\u4e0b\u9762\u57fa\u672c\u5b8c\u6574\u7f57\u5217\u51fa\u4f1a\u88ab\u89c6\u4e3a\u5047\u503c\u7684\u5185\u7f6e\u5bf9\u8c61\uff1a</p> <ul> <li>\u88ab\u5b9a\u4e49\u4e3a\u5047\u503c\u7684\u5e38\u91cf: None \u548c False</li> <li>\u4efb\u4f55\u6570\u503c\u7c7b\u578b\u7684\u96f6: 0, 0.0, 0j, Decimal(0), Fraction(0, 1)</li> <li>\u7a7a\u7684\u5e8f\u5217\u548c\u591a\u9879\u96c6: '', (), [], {}, set(), range(0)</li> </ul>"},{"location":"coding/Python3/#-andornot","title":"\u5e03\u5c14\u7c7b\u578b\u8fd0\u7b97 -- and\u3001or\u3001not","text":"\u8fd0\u7b97 \u7ed3\u679c \u6ce8\u91ca x\u00a0or\u00a0y if\u00a0x\u00a0is false, then\u00a0y, else\u00a0x \u8fd9\u662f\u4e2a\u77ed\u8def\u8fd0\u7b97\u7b26\uff0c\u56e0\u6b64\u53ea\u6709\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u771f\u503c\u65f6\u624d\u4f1a\u5bf9\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6c42\u503c x\u00a0and\u00a0y if\u00a0x\u00a0is false, then\u00a0x, else\u00a0y not\u00a0\u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64\u00a0not\u00a0a\u00a0==\u00a0b\u00a0\u4f1a\u88ab\u89e3\u8bfb\u4e3a\u00a0not\u00a0(a\u00a0==\u00a0b)\u00a0\u800c\u00a0a\u00a0==\u00a0not\u00a0b\u00a0\u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef not\u00a0x if\u00a0x\u00a0is false, then\u00a0True, else\u00a0False not\u00a0\u7684\u4f18\u5148\u7ea7\u6bd4\u975e\u5e03\u5c14\u8fd0\u7b97\u7b26\u4f4e\uff0c\u56e0\u6b64\u00a0not\u00a0a\u00a0==\u00a0b\u00a0\u4f1a\u88ab\u89e3\u8bfb\u4e3a\u00a0not\u00a0(a\u00a0==\u00a0b)\u00a0\u800c\u00a0a\u00a0==\u00a0not\u00a0b\u00a0\u4f1a\u5f15\u53d1\u8bed\u6cd5\u9519\u8bef"},{"location":"coding/Python3/#_5","title":"\u6bd4\u8f83\u8fd0\u7b97","text":"<p>\u516b\u79cd\u6bd4\u8f83\u8fd0\u7b97\u7b26\uff0c\u4f18\u5148\u7ea7\u76f8\u540c(\u6bd4\u5e03\u5c14\u8fd0\u7b97\u4f18\u5148\u7ea7\u9ad8)\u3002\u6bd4\u8f83\u8fd0\u7b97\u53ef\u4ee5\u4efb\u610f\u4e32\u8fde\u3002is\u548cis not\u8fd0\u7b97\u7b26\u65e0\u6cd5\u81ea\u5b9a\u4e49\u5e76\u4e14\u53ef\u4ee5\u88ab\u5e94\u7528\u4e8e\u4efb\u610f\u4e24\u4e2a \u5bf9\u8c61\u800c\u4e0d\u4f1a\u5f15\u53d1\u5f02\u5e38\uff1b\u8fd8\u6709\u4e24\u79cd\u5177\u6709\u76f8\u540c\u8bed\u6cd5\u4f18\u5148\u7ea7\u7684\u8fd0\u7b97in\u548cnot in\uff0c\u5b83\u4eec\u88abiterable\u6216\u5b9e\u73b0\u4e86__contains__()\u65b9\u6cd5\u7684\u7c7b\u578b\u6240\u652f\u6301</p> \u8fd0\u7b97\u7b26 \u542b\u4e49 &lt; \u5c0f\u4e8e &lt;= \u5c0f\u4e8e\u6216\u7b49\u4e8e &gt; \u5927\u4e8e &gt;= \u5927\u4e8e\u6216\u7b49\u4e8e == \u7b49\u4e8e != \u4e0d\u7b49\u4e8e is \u5bf9\u8c61\u6807\u8bc6 is\u00a0not \u5426\u5b9a\u5bf9\u8c61\u6807\u8bc6"},{"location":"coding/Python3/#-intfloatcomplex","title":"\u6570\u5b57\u7c7b\u578b\u8fd0\u7b97 -- int\u3001float\u3001complex","text":"<p>Python\u6709\u4e09\u79cd\u4e0d\u540c\u7684\u6570\u5b57\u7c7b\u578b\uff1a\u6574\u6570\u3001\u6d6e\u70b9\u6570\u548c\u590d\u6570\u3002(python2\u4e2d\u624d\u6709long\u7c7b\u578b)\u5e03\u5c14\u503c\u5c5e\u4e8e\u6574\u6570\u7684\u5b50\u7c7b\u578b\u3002\u6574\u6570\u6709\u65e0\u9650\u7cbe\u5ea6\uff0c\u6d6e\u70b9\u6570\u901a\u5e38\u4ee5C\u8bed\u8a00\u4e2d double\u5b9e\u73b0\u590d\u6570\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\uff0c\u6bcf\u4e2a\u90fd\u662f\u6d6e\u70b9\u6570</p> <p>\u6570\u5b57\u662f\u7531\u6570\u5b57\u5b57\u9762\u503c\u6216\u5185\u7f6e\u51fd\u6570\u4e0e\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u6765\u521b\u5efa\u3002\u672a\u4fee\u9970\u7684\u6574\u6570\u5b57\u9762\u503c(\u5305\u62ec\u5341\u516d\u8fdb\u5236\u3001\u516b\u8fdb\u5236\u548c\u4e8c\u8fdb\u5236\u6570)\u4f1a\u751f\u6210\u6574\u6570\uff0c\u5305\u542b\u5c0f\u6570\u70b9\u6216\u5e42\u8fd0\u7b97\u7b26\u7684 \u6570\u5b57\u5b57\u9762\u503c\u4f1a\u751f\u6210\u6d6e\u70b9\u6570\uff0c\u5728\u6570\u5b57\u5b57\u9762\u503c\u672b\u5c3e\u52a0\u4e0a 'j' \u6216 'J' \u4f1a\u751f\u6210\u865a\u6570(\u5b9e\u90e8\u4e3a\u96f6\u7684\u590d\u6570)\u5c06\u5176\u4e0e\u6574\u6570\u6216\u6d6e\u70b9\u6570\u76f8\u52a0\u6765\u5f97\u5230\u5177\u6709\u5b9e\u90e8\u548c\u865a\u90e8\u7684\u590d\u6570</p>"},{"location":"coding/Python3/#numbers","title":"Numbers(\u6570\u5b57)","text":"Markdown<pre><code>python3\u652f\u6301int(\u6574\u6570)\u3001float(\u6d6e\u70b9)\u3001bool(\u5e03\u5c14)\u3001complex(\u590d\u6570)\n\n\u6ce8\u610f\uff1a\npython\u53ef\u4ee5\u540c\u65f6\u4e3a\u591a\u4e2a\u53d8\u91cf\u8d4b\u503c\uff0c\u5982\uff1aa,b=1,2\n\u4e00\u4e2a\u53d8\u91cf\u53ef\u4ee5\u901a\u8fc7\u8d4b\u503c\u6307\u5411\u4e0d\u540c\u7c7b\u578b\u7684\u5bf9\u8c61\n\u6570\u503c\u7684\u9664\u6cd5\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6d6e\u70b9\u6570\uff0c\u8981\u83b7\u53d6\u6574\u6570\u4f7f\u7528//\u64cd\u4f5c\u7b26\n\u5728\u6df7\u5408\u8ba1\u7b97\u65f6\uff0cPython\u4f1a\u628a\u6574\u6570\u7c7b\u578b\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570\n</code></pre> <p>\u6240\u6709\u6570\u5b57\u7c7b\u578b\uff08\u590d\u6570\u9664\u5916\uff09\u90fd\u652f\u6301\u4e0b\u5217\u8fd0\u7b97\uff0c\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f(\u6240\u6709\u6570\u5b57\u8fd0\u7b97\u7684\u4f18\u5148\u7ea7\u90fd\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97)</p> <ul> <li>\u5411\u4e0a\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u524d\u9762\u7684\u6574\u6570\u5c31\u52a01</li> <li>\u5411\u4e0b\u53d6\u6574--\u4e0d\u7ba1\u56db\u820d\u4e94\u5165\u7684\u89c4\u5219 \u53ea\u8981\u540e\u9762\u6709\u5c0f\u6570\u5ffd\u7565\u5c0f\u6570</li> </ul> \u8fd0\u7b97\u7b26 \u63cf\u8ff0 \u6ce8\u91ca + \u52a0 - \u51cf * \u4e58 / \u9664 // \u53d6\u6574\u6570--\u8fd4\u56de\u5546\u7684\u6574\u6570\u90e8\u5206(\u5411\u4e0b\u53d6\u6574) \u7ed3\u679c\u662f\u4e2a\u6574\u6570\uff0c\u4f46\u7c7b\u578b\u4e0d\u4e00\u5b9a\u662fint\uff0c\u8fd0\u7b97\u7ed3\u679c\u603b\u662f\u5411\u8d1f\u65e0\u7a77\u65b9\u5411\u820d\u5165\u3002\u5982\uff1a1//2\u4e3a0\uff0c(-1)//2\u4e3a-1 % \u53d6\u6a21--\u8fd4\u56de\u9664\u6cd5\u7684\u4f59\u6570 \u4e0d\u53ef\u7528\u4e8e\u590d\u6570\uff0c\u800c\u5e94\u5728\u9002\u5f53\u6761\u4ef6\u4e0b\u4f7f\u7528abs()\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 -x x\u00a0\u53d6\u53cd +x x\u00a0\u4e0d\u53d8 abs(x) x\u00a0\u7684\u7edd\u5bf9\u503c\u6216\u5927\u5c0f int(x) \u5c06\u00a0x\u00a0\u8f6c\u6362\u4e3a\u6574\u6570 float(x) \u5c06\u00a0x\u00a0\u8f6c\u6362\u4e3a\u6d6e\u70b9\u6570 complex(re,\u00a0im) \u4e00\u4e2a\u5e26\u6709\u5b9e\u90e8\u00a0re\u00a0\u548c\u865a\u90e8\u00a0im\u00a0\u7684\u590d\u6570\u3002im\u00a0\u9ed8\u8ba4\u4e3a0 c.conjugate() \u590d\u6570c\u7684\u7ed3\u5408(\u5171\u8f6d) divmod(x,\u00a0y) (x\u00a0//\u00a0y,\u00a0x\u00a0%\u00a0y) \u4e0d\u53ef\u7528\u4e8e\u590d\u6570 pow(x,\u00a0y) x\u00a0\u7684\u00a0y\u00a0\u6b21\u5e42 Python\u5c06pow(0, 0)\u548c0**0\u5b9a\u4e49\u4e3a1\uff0c\u8fd9\u662f\u7f16\u7a0b\u8bed\u8a00\u666e\u904d\u505a\u6cd5 ** \u5e42 <p>\u6240\u6709\u7684numbers.Real\u7c7b\u578b(int\u548cfloat)\u8fd8\u5305\u62ec\u4ee5\u4e0b\u8fd0\u7b97(\u66f4\u591a\u6570\u5b57\u8fd0\u7b97\u53c2\u8003math\u548ccmath\u6a21\u5757):</p> \u8fd0\u7b97\u7b26 \u7ed3\u679c math.trunc(x) x\u00a0\u622a\u65ad\u4e3aIntegral round(x[,\u00a0n]) x\u00a0\u820d\u5165\u5230n\u4f4d\u5c0f\u6570\uff0c\u534a\u6570\u503c\u4f1a\u820d\u5165\u5230\u5076\u6570\uff0c\u5982\u679c\u7701\u7565n\uff0c\u5219\u9ed8\u8ba4\u4e3a0 math.floor(x) &lt;=\u00a0x\u00a0\u7684\u6700\u5927\u00a0Integral math.ceil(x) &gt;=\u00a0x\u00a0\u7684\u6700\u5c0f\u00a0Integral"},{"location":"coding/Python3/#_6","title":"\u6574\u6570\u7c7b\u578b\u7684\u6309\u4f4d\u8fd0\u7b97","text":"<p>\u6309\u4f4d\u8fd0\u7b97\u53ea\u5bf9\u6574\u6570\u6709\u610f\u4e49\uff0c\u6309\u4f4d\u8fd0\u7b97\u7b26\u662f\u628a\u6570\u5b57\u770b\u4f5c\u4e8c\u8fdb\u5236\u6765\u8fdb\u884c\u8ba1\u7b97\u7684\u3002\u4e8c\u8fdb\u5236\u6309\u4f4d\u8fd0\u7b97\u4f18\u5148\u7ea7\u5168\u90fd\u4f4e\u4e8e\u6570\u5b57\u8fd0\u7b97\uff0c\u4f46\u9ad8\u4e8e\u6bd4\u8f83\u8fd0\u7b97 \u4e00\u5143\u8fd0\u7b97<code>~</code>\u548c\u5176\u4ed6\u4e00\u5143\u7b97\u672f\u8fd0\u7b97<code>+</code>\u548c<code>-</code>\u5177\u6709\u76f8\u540c\u7684\u4f18\u5148\u7ea7</p> <p>\u4ee5\u4f18\u5148\u7ea7\u5347\u5e8f\u6392\u5e8f\u7684\u6309\u4f4d\u8fd0\u7b97\u5217\u8868\uff1a</p> \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca | \u6309\u4f4d\u6216\u8fd0\u7b97\u7b26\uff1a\u53ea\u8981\u5bf9\u5e94\u7684\u4e8c\u4e2a\u4e8c\u8fdb\u4f4d\u6709\u4e00\u4e2a\u4e3a1\u65f6\uff0c\u7ed3\u679c\u4f4d\u5c31\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c ^ \u6309\u4f4d\u5f02\u6216\u8fd0\u7b97\u7b26\uff1a\u5f53\u4e24\u5bf9\u5e94\u7684\u4e8c\u8fdb\u4f4d\u76f8\u5f02\u65f6\uff0c\u7ed3\u679c\u4e3a1 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c &amp; \u6309\u4f4d\u4e0e\u8fd0\u7b97\u7b26\uff1a\u53c2\u4e0e\u8fd0\u7b97\u7684\u4e24\u4e2a\u503c,\u5982\u679c\u4e24\u4e2a\u76f8\u5e94\u4f4d\u90fd\u4e3a1,\u5219\u8be5\u4f4d\u7684\u7ed3\u679c\u4e3a1,\u5426\u5219\u4e3a0 \u4f7f\u7528\u5e26\u6709\u81f3\u5c11\u4e00\u4e2a\u989d\u5916\u7b26\u53f7\u6269\u5c55\u4f4d\u7684\u6709\u9650\u4e2a\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff08\u6709\u6548\u4f4d\u5bbd\u5ea6\u4e3a 1 + max(x.bit_length(), y.bit_length()) \u6216\u4ee5\u4e0a\uff09\u6267\u884c\u8fd9\u4e9b\u8ba1\u7b97\u5c31\u8db3\u4ee5\u83b7\u5f97\u76f8\u5f53\u4e8e\u6709\u65e0\u6570\u4e2a\u7b26\u53f7\u4f4d\u65f6\u7684\u540c\u6837\u7ed3\u679c x\u00a0&lt;&lt;\u00a0n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u5de6\u79fbn\u4f4d\uff0c\u9ad8\u4f4d\u4e22\u5f03\uff0c\u4f4e\u4f4d\u88650 \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\u4f1a\u5bfc\u81f4\u5f15\u53d1ValueError,\u5de6\u79fbn\u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u4e58\u4ee5pow(2, n) x\u00a0&gt;&gt;\u00a0n x\u7684\u5404\u4e8c\u8fdb\u4f4d\u5168\u90e8\u53f3\u79fbn\u4f4d \u8d1f\u7684\u79fb\u4f4d\u6570\u662f\u975e\u6cd5\u7684\uff0c\u4f1a\u5bfc\u81f4\u5f15\u53d1 ValueError\uff1b\u53f3\u79fb n \u4f4d\u7b49\u4ef7\u4e8e\u4e0d\u5e26\u6ea2\u51fa\u68c0\u6d4b\u5730\u9664\u4ee5 pow(2, n) ~x x\u00a0\u9010\u4f4d\u53d6\u53cd <p>\u6574\u6570int\u7c7b\u578b\u7684\u9644\u52a0\u65b9\u6cd5\uff1a</p> <p>int.bit_length()    \u8fd4\u56de\u4ee5\u4e8c\u8fdb\u5236\u8868\u793a\u4e00\u4e2a\u6574\u6570\u6240\u9700\u7684\u4f4d\u6570\uff0c\u4e0d\u5305\u62ec\u7b26\u53f7\u4f4d\u548c\u524d\u9762\u76840 int.to_bytes()      \u8fd4\u56de\u8868\u793a\u4e00\u4e2a\u6574\u6570\u7684\u5b57\u8282\u6570\u7ec4\uff0c\u6574\u6570\u4f1a\u4f7f\u7528length\u4e2a\u5b57\u8282\u6765\u8868\u793a\u3002 \u5982\u679c\u6574\u6570\u4e0d\u80fd\u7528\u7ed9\u5b9a\u7684\u5b57\u8282\u6570\u6765\u8868\u793a\u5219\u4f1a\u5f15\u53d1 OverflowError int.from_tytes()    \u8fd4\u56de\u7531\u7ed9\u5b9a\u5b57\u8282\u6570\u7ec4\u8868\u8fbe\u7684\u6574\u6570 int.as_integer_ratio() \u8fd4\u56de\u4e00\u5bf9\u6574\u6570\uff0c\u5176\u6bd4\u7387\u6b63\u597d\u7b49\u4e8e\u539f\u6574\u6570\u4e14\u5206\u6bcd\u4e3a\u6b63\u6570\uff0c\u6574\u6570\u7684\u6bd4\u7387\u603b\u662f\u7528\u8fd9\u4e2a\u6574\u6570\u672c\u8eab\u4f5c\u4e3a\u5206\u5b50\uff0c1\u4f5c\u4e3a\u5206\u6bcd</p> <p>\u6d6e\u70b9\u7c7b\u578b\u7684\u9644\u52a0\u65b9\u6cd5\uff1a</p> <p>float.as_integer_ratio()    \u8fd4\u56de\u4e00\u5bf9\u6574\u6570\uff0c\u5176\u6bd4\u7387\u6b63\u597d\u7b49\u4e8e\u539f\u6d6e\u70b9\u6570\u4e14\u5206\u6bcd\u4e3a\u6b63\u6570,\u65e0\u7a77\u5927\u4f1a\u5f15\u53d1OverflowError\u800cNaN\u4f1a\u5f15\u53d1ValueError float.is_integer()  \u82e5float\u5b9e\u4f8b\u53ef\u7528\u6709\u9650\u4f4d\u6574\u6570\u8868\u793a\u5219\u8fd4\u56deTrue\uff0c\u5426\u5219\u8fd4\u56deFalse float.hex() \u4ee5\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u793a\u4e00\u4e2a\u6d6e\u70b9\u6570\uff0c\u6b64\u4e3a\u5b9e\u4f8b\u65b9\u6cd5 float.fromhex() \u8fd4\u56de\u4ee5\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32\u8868\u793a\u7684\u6d6e\u70b9\u6570\uff0c\u6b64\u4e3a\u7c7b\u65b9\u6cd5</p>"},{"location":"coding/Python3/#_7","title":"\u8fed\u4ee3\u5668\u7c7b\u578b","text":"<p>Python\u652f\u6301\u8fed\u4ee3\u5bb9\u5668\u7684\u6982\u5ff5\u3002\u8fd9\u662f\u4f7f\u7528\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u5b9e\u73b0\u7684; \u8fd9\u4e9b\u7528\u4e8e\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u652f\u6301\u8fed\u4ee3</p>"},{"location":"coding/Python3/#_8","title":"\u751f\u6210\u5668\u7c7b\u578b","text":"<p>Python\u7684\u751f\u6210\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fed\u4ee3\u5668\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u5bb9\u5668\u5bf9\u8c61\u7684__iter__()\u65b9\u6cd5\u88ab\u5b9e\u73b0\u4e3a\u751f\u6210\u5668\uff0c\u5b83\u5c06\u81ea\u52a8\u8fd4\u56de\u63d0\u4f9b__iter__() \u548c__next__()\u65b9\u6cd5\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff08\u6280\u672f\u4e0a\uff0c\u751f\u6210\u5668\u5bf9\u8c61\uff09</p> Python<pre><code>def my_range(start, stop, step = 1):\n    if stop &lt;= start:\n        raise RuntimeError(\"start must be smaller than stop\")\n    i = start\n    while i &lt; stop:\n        yield i\n        i += step\n\ntry:\n    for k in my_range(10, 50, 3):\n        print(k)\nexcept RuntimeError as ex:\n    print(ex)\nexcept TypeError:\n    print(\"Unknown error occurred\")\n</code></pre>"},{"location":"coding/Python3/#-listtuplerange","title":"\u5e8f\u5217\u7c7b\u578b -- list\u3001tuple\u3001range","text":"<p>\u901a\u7528\u5e8f\u5217\u7c7b\u578b\u64cd\u4f5c\uff1a\u5927\u591a\u6570\u5e8f\u5217\u7c7b\u578b\u5305\u62ec\u53ef\u53d8\u7c7b\u578b\u548c\u4e0d\u53ef\u53d8\u7c7b\u578b\u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u64cd\u4f5c\uff0ccollections.abc.Sequence ABC \u7528\u6765\u66f4\u5bb9\u6613\u7684\u5728\u81ea\u5b9a \u4e49\u5e8f\u5217\u7c7b\u578b\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c\u3002\u6b64\u8868\u6309\u4f18\u5148\u7ea7\u5347\u5e8f\u7f57\u5217\u5e8f\u5217\u64cd\u4f5c\uff0c\u8868\u683c\u4e2d\uff0cs \u548c t \u662f\u5177\u6709\u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\uff0cn, i, j \u548c k \u662f\u6574\u6570\u800c x \u662f \u4efb\u4f55\u6ee1\u8db3 s \u6240\u89c4\u5b9a\u7684\u7c7b\u578b\u548c\u503c\u9650\u5236\u7684\u4efb\u610f\u5bf9\u8c61</p> <p>\u4efb\u4f55\u7684\u5e8f\u5217(\u6216\u8005\u53ef\u8fed\u4ee3\u5bf9\u8c61)\u90fd\u53ef\u901a\u8fc7\u4e00\u4e2a\u8d4b\u503c\u8bed\u53e5\u89e3\u538b\u5e76\u8d4b\u503c\u7ed9\u591a\u4e2a\u53d8\u91cf\uff0c\u552f\u4e00\u7684\u524d\u63d0\u5c31\u662f\u53d8\u91cf\u7684\u6570\u91cf\u5fc5\u987b\u4e0e\u5e8f\u5217\u5143\u7d20\u6570\u76f8\u540c</p> <p>\u76f8\u540c\u7c7b\u578b\u7684\u5e8f\u5217\u4e5f\u652f\u6301\u6bd4\u8f83\u3002 \u7279\u522b\u5730\uff0ctuple \u548c list \u7684\u6bd4\u8f83\u662f\u901a\u8fc7\u6bd4\u8f83\u5bf9\u5e94\u5143\u7d20\u7684\u5b57\u5178\u987a\u5e8f\u3002 \u8fd9\u610f\u5473\u7740\u60f3\u8981\u6bd4\u8f83\u7ed3\u679c\u76f8\u7b49\uff0c\u5219\u6bcf\u4e2a\u5143 \u7d20\u6bd4\u8f83\u7ed3\u679c\u90fd\u5fc5\u987b\u76f8\u7b49\uff0c\u5e76\u4e14\u4e24\u4e2a\u5e8f\u5217\u957f\u5ea6\u5fc5\u987b\u76f8\u540c</p> <p>\u5927\u591a\u6570\u5e8f\u5217\u7c7b\u578b\uff0c\u5305\u62ec\u53ef\u53d8\u7c7b\u578b\u548c\u4e0d\u53ef\u53d8\u7c7b\u578b\u90fd\u652f\u6301\u4e0b\u8868\u4e2d\u7684\u64cd\u4f5c</p> \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca x\u00a0in\u00a0s \u5982\u679c\u00a0s\u00a0\u4e2d\u7684\u67d0\u9879\u7b49\u4e8e\u00a0x\u00a0\u5219\u7ed3\u679c\u4e3a\u00a0True\uff0c\u5426\u5219\u4e3a\u00a0False 1 x\u00a0not\u00a0in\u00a0s \u5982\u679c\u00a0s\u00a0\u4e2d\u7684\u67d0\u9879\u7b49\u4e8e\u00a0x\u00a0\u5219\u7ed3\u679c\u4e3a\u00a0False\uff0c\u5426\u5219\u4e3a\u00a0True 1 s\u00a0+\u00a0t s\u00a0\u4e0e\u00a0t\u00a0\u76f8\u62fc\u63a5 67 s\u00a0*\u00a0n\u00a0\u6216\u00a0n\u00a0*\u00a0s \u76f8\u5f53\u4e8e\u00a0s\u00a0\u4e0e\u81ea\u8eab\u8fdb\u884c\u00a0n\u00a0\u6b21\u62fc\u63a5 27 s[i] s\u00a0\u7684\u7b2c\u00a0i\u00a0\u9879\uff0c\u8d77\u59cb\u4e3a 0 3 s[i:j] s\u00a0\u4ece\u00a0i\u00a0\u5230\u00a0j\u00a0\u7684\u5207\u7247 34 s[i:j:k] s\u00a0\u4ece\u00a0i\u00a0\u5230\u00a0j\u00a0\u6b65\u957f\u4e3a\u00a0k\u00a0\u7684\u5207\u7247 35 len(s) s\u00a0\u7684\u957f\u5ea6 min(s) s\u00a0\u7684\u6700\u5c0f\u9879 max(s) s\u00a0\u7684\u6700\u5927\u9879 s.index(x[, i[, j]]) x\u5728s\u4e2d\u9996\u6b21\u51fa\u73b0\u9879\u7684\u7d22\u5f15\u53f7(\u7d22\u5f15\u548c\u5728i\u6216\u5176\u540e\u4e14\u5728j\u4e4b\u524d) 8 s.count(x) x\u00a0\u5728\u00a0s\u00a0\u4e2d\u51fa\u73b0\u7684\u603b\u6b21\u6570 <p>\u6ce8\u91ca:</p> <ol> <li>\u867d\u7136 in \u548c not in \u64cd\u4f5c\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\u4ec5\u88ab\u7528\u4e8e\u7b80\u5355\u7684\u6210\u5458\u68c0\u6d4b\uff0c\u67d0\u4e9b\u4e13\u95e8\u5316\u5e8f\u5217 (\u4f8b\u5982 str, bytes \u548c bytearray) \u4e5f\u4f7f\u7528\u5b83\u4eec\u8fdb\u884c\u5b50\u5e8f\u5217\u68c0\u6d4b</li> <li>\u5c0f\u4e8e 0 \u7684 n \u503c\u4f1a\u88ab\u5f53\u4f5c 0 \u6765\u5904\u7406 (\u751f\u6210\u4e00\u4e2a\u4e0e s \u540c\u7c7b\u578b\u7684\u7a7a\u5e8f\u5217)\u3002 \u8bf7\u6ce8\u610f\u5e8f\u5217 s \u4e2d\u7684\u9879\u5e76\u4e0d\u4f1a\u88ab\u62f7\u8d1d\uff1b\u5b83\u4eec\u4f1a\u88ab\u591a\u6b21\u5f15\u7528</li> <li>\u5982\u679c i \u6216 j \u4e3a\u8d1f\u503c\uff0c\u5219\u7d22\u5f15\u987a\u5e8f\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217 s \u7684\u672b\u5c3e: \u7d22\u5f15\u53f7\u4f1a\u88ab\u66ff\u6362\u4e3a len(s) + i \u6216 len(s) + j\u3002 \u4f46\u8981\u6ce8\u610f -0 \u4ecd\u7136\u4e3a 0</li> <li>s \u4ece i \u5230 j \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 i &lt;= k &lt; j \u7684\u7d22\u5f15\u53f7 k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u5982\u679c i \u6216 j \u5927\u4e8e len(s)\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u88ab\u7701\u7565    \u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 0\u3002 \u5982\u679c j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5219\u4f7f\u7528 len(s)\u3002 \u5982\u679c i \u5927\u4e8e\u7b49\u4e8e j\uff0c\u5219\u5207\u7247\u4e3a\u7a7a</li> <li>s \u4ece i \u5230 j \u6b65\u957f\u4e3a k \u7684\u5207\u7247\u88ab\u5b9a\u4e49\u4e3a\u6240\u6709\u6ee1\u8db3 0 &lt;= n &lt; (j-i)/k \u7684\u7d22\u5f15\u53f7 x = i + n*k \u7684\u9879\u7ec4\u6210\u7684\u5e8f\u5217\u3002 \u6362\u53e5\u8bdd\u8bf4\uff0c\u7d22\u5f15\u53f7\u4e3a i, i+k,    i+2*k, i+3*k\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u5f53\u8fbe\u5230 j \u65f6\u505c\u6b62 (\u4f46\u4e00\u5b9a\u4e0d\u5305\u62ec j)\u3002 \u5f53 k \u4e3a\u6b63\u503c\u65f6\uff0ci \u548c j \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s)\u3002 \u5f53 k \u4e3a\u8d1f\u503c\u65f6\uff0ci \u548c j    \u4f1a\u88ab\u51cf\u81f3\u4e0d\u5927\u4e8e len(s) - 1\u3002 \u5982\u679c i \u6216 j \u88ab\u7701\u7565\u6216\u4e3a None\uff0c\u5b83\u4eec\u4f1a\u6210\u4e3a\u201c\u7ec8\u6b62\u201d\u503c (\u662f\u54ea\u4e00\u7aef\u7684\u7ec8\u6b62\u503c\u5219\u53d6\u51b3\u4e8e k \u7684\u7b26\u53f7)\u3002 \u8bf7\u6ce8\u610f\uff0ck \u4e0d\u53ef    \u4e3a\u96f6\u3002 \u5982\u679c k \u4e3a None\uff0c\u5219\u5f53\u4f5c 1 \u5904\u7406</li> <li>\u62fc\u63a5\u4e0d\u53ef\u53d8\u5e8f\u5217\u603b\u662f\u4f1a\u751f\u6210\u65b0\u7684\u5bf9\u8c61\u3002 \u8fd9\u610f\u5473\u7740\u901a\u8fc7\u91cd\u590d\u62fc\u63a5\u6765\u6784\u5efa\u5e8f\u5217\u7684\u8fd0\u884c\u65f6\u5f00\u9500\u5c06\u4f1a\u57fa\u4e8e\u5e8f\u5217\u603b\u957f\u5ea6\u7684\u4e58\u65b9\u3002 \u60f3\u8981\u83b7\u5f97\u7ebf\u6027\u7684\u8fd0\u884c\u65f6\u5f00\u9500\uff0c\u5fc5\u987b    \u6539\u7528\u4e0b\u5217\u66ff\u4ee3\u65b9\u6848\u4e4b\u4e00\uff1a<ul> <li>\u5982\u679c\u62fc\u63a5 str \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u5217\u8868\u5e76\u5728\u6700\u540e\u4f7f\u7528 str.join() \u6216\u662f\u5199\u5165\u4e00\u4e2a io.StringIO \u5b9e\u4f8b\u5e76\u5728\u7ed3\u675f\u65f6\u83b7\u53d6\u5b83\u7684\u503c</li> <li>\u5982\u679c\u62fc\u63a5 bytes \u5bf9\u8c61\uff0c\u4f60\u53ef\u4ee5\u7c7b\u4f3c\u5730\u4f7f\u7528 bytes.join() \u6216 io.BytesIO\uff0c\u6216\u8005\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 bytearray \u5bf9\u8c61\u8fdb\u884c\u539f\u5730\u62fc\u63a5\u3002 bytearray   \u5bf9\u8c61\u662f\u53ef\u53d8\u7684\uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u6548\u7684\u91cd\u5206\u914d\u673a\u5236</li> <li>\u5982\u679c\u62fc\u63a5 tuple \u5bf9\u8c61\uff0c\u8bf7\u6539\u4e3a\u6269\u5c55 list \u7c7b</li> <li>\u5bf9\u4e8e\u5176\u5b83\u7c7b\u578b\uff0c\u8bf7\u67e5\u770b\u76f8\u5e94\u7684\u6587\u6863</li> </ul> </li> <li>\u67d0\u4e9b\u5e8f\u5217\u7c7b\u578b (\u4f8b\u5982 range) \u4ec5\u652f\u6301\u9075\u5faa\u7279\u5b9a\u6a21\u5f0f\u7684\u9879\u5e8f\u5217\uff0c\u56e0\u6b64\u5e76\u4e0d\u652f\u6301\u5e8f\u5217\u62fc\u63a5\u6216\u91cd\u590d</li> <li>\u5f53 x \u5728 s \u4e2d\u627e\u4e0d\u5230\u65f6 index \u4f1a\u5f15\u53d1 ValueError\u3002 \u4e0d\u662f\u6240\u6709\u5b9e\u73b0\u90fd\u652f\u6301\u4f20\u5165\u989d\u5916\u53c2\u6570 i \u548c j\u3002 \u8fd9\u4e24\u4e2a\u53c2\u6570\u5141\u8bb8\u9ad8\u6548\u5730\u641c\u7d22\u5e8f\u5217\u7684\u5b50\u5e8f\u5217    \u4f20\u5165\u8fd9\u4e24\u4e2a\u989d\u5916\u53c2\u6570\u5927\u81f4\u76f8\u5f53\u4e8e\u4f7f\u7528 s[i:j].index(x)\uff0c\u4f46\u662f\u4e0d\u4f1a\u590d\u5236\u4efb\u4f55\u6570\u636e\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u7d22\u5f15\u662f\u76f8\u5bf9\u4e8e\u5e8f\u5217\u7684\u5f00\u5934\u800c\u975e\u5207\u7247\u7684\u5f00\u5934</li> </ol>"},{"location":"coding/Python3/#_9","title":"\u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b","text":"<p>\u4e0d\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u901a\u5e38\u5b9e\u73b0\u7684\u552f\u4e00\u64cd\u4f5c\u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u672a\u5b9e\u73b0\u5bf9hash()\u5185\u7f6e\u51fd\u6570\u7684\u652f\u6301\uff0c\u4f8b\u5982\uff1atuple\u5b9e\u4f8b\u88ab\u7528\u4f5cdict\u952e\u4ee5\u53ca\u5b58\u50a8\u5728set\u548cfrozenset\u5b9e\u4f8b\u4e2d \u5c1d\u8bd5\u5bf9\u5305\u542b\u6709\u4e0d\u53ef\u54c8\u5e0c\u503c\u7684\u4e0d\u53ef\u53d8\u5e8f\u5217\u8fdb\u884c\u54c8\u5e0c\u8fd0\u7b97\u5c06\u4f1a\u5bfc\u81f4 TypeError</p>"},{"location":"coding/Python3/#_10","title":"\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b","text":"<p>\u4ee5\u4e0b\u64cd\u4f5c\u662f\u5728\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u5b9a\u4e49\uff0ccollections.abc.MutableSequence ABC\u88ab\u63d0\u4f9b\u7528\u6765\u66f4\u5bb9\u6613\u5728\u81ea\u5b9a\u4e49\u5e8f\u5217\u7c7b\u578b\u4e0a\u6b63\u786e\u5b9e\u73b0\u8fd9\u4e9b\u64cd\u4f5c</p> <p>\u8868\u683c\u4e2d\u7684 s \u662f\u53ef\u53d8\u5e8f\u5217\u7c7b\u578b\u7684\u5b9e\u4f8b\uff0ct \u662f\u4efb\u610f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u800c x \u662f\u7b26\u5408\u5bf9 s \u6240\u89c4\u5b9a\u7c7b\u578b\u4e0e\u503c\u9650\u5236\u7684\u4efb\u4f55\u5bf9\u8c61 (\u4f8b\u5982\uff0cbytearray \u4ec5\u63a5\u53d7\u6ee1\u8db3 0 &lt;= x &lt;= 255 \u503c\u9650\u5236\u7684\u6574\u6570)</p> \u8fd0\u7b97\u7b26 \u7ed3\u679c \u6ce8\u91ca s[i]\u00a0=\u00a0x \u5c06\u00a0s\u00a0\u7684\u7b2c\u00a0i\u00a0\u9879\u66ff\u6362\u4e3a\u00a0x s[i:j]\u00a0=\u00a0t \u5c06\u00a0s\u00a0\u4ece\u00a0i\u00a0\u5230\u00a0j\u00a0\u7684\u5207\u7247\u66ff\u6362\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\u00a0t\u7684\u5185\u5bb9 del\u00a0s[i:j] \u7b49\u540c\u4e8e\u00a0s[i:j]\u00a0=\u00a0[] s[i:j:k]\u00a0=\u00a0t \u5c06\u00a0s[i:j:k]\u00a0\u7684\u5143\u7d20\u66ff\u6362\u4e3a\u00a0t\u00a0\u7684\u5143\u7d20 t\u5fc5\u987b\u548c\u5b83\u6240\u66ff\u6362\u7684\u5207\u7247\u5177\u6709\u76f8\u540c\u957f\u5ea6 del\u00a0s[i:j:k] \u4ece\u5217\u8868\u4e2d\u79fb\u9664\u00a0s[i:j:k]\u00a0\u7684\u5143\u7d20 s.append(x) \u5c06\u00a0x\u00a0\u6dfb\u52a0\u5230\u5e8f\u5217\u7684\u672b\u5c3e (\u7b49\u540c\u4e8e\u00a0s[len(s):len(s)]\u00a0=\u00a0[x]) s.clear() \u4ece\u00a0s\u00a0\u4e2d\u79fb\u9664\u6240\u6709\u9879 (\u7b49\u540c\u4e8e\u00a0del\u00a0s[:]) clear()\u548ccopy()\u5747\u662f\u4e3a\u4e86\u4e0e\u4e0d\u652f\u6301\u5207\u7247\u64cd\u4f5c\u7684\u53ef\u53d8\u5bb9\u5668(\u5982:dict\u3001set)\u7684\u63a5\u53e3\u4fdd\u6301\u4e00\u81f4 s.copy() \u521b\u5efa\u00a0s\u00a0\u7684\u6d45\u62f7\u8d1d (\u7b49\u540c\u4e8e\u00a0s[:]) \u540c\u4e0a s.extend(t)\u00a0\u6216\u00a0s\u00a0+=\u00a0t \u7528\u00a0t\u00a0\u7684\u5185\u5bb9\u6269\u5c55\u00a0s\u00a0(\u57fa\u672c\u4e0a\u7b49\u540c\u4e8e\u00a0s[len(s):len(s)]\u00a0=\u00a0t) s\u00a0*=\u00a0n \u4f7f\u7528\u00a0s\u00a0\u7684\u5185\u5bb9\u91cd\u590d\u00a0n\u00a0\u6b21\u6765\u5bf9\u5176\u8fdb\u884c\u66f4\u65b0 n\u503c\u4e3a\u4e00\u4e2a\u6574\u6570\u6216\u4e00\u4e2a\u5b9e\u73b0\u4e86__index__()\u7684\u5bf9\u8c61\uff0cn\u503c\u4e3a0\u6216\u8d1f\u6570\u5c06\u6e05\u7a7a\u5e8f\u5217\u3002\u5e8f\u5217\u4e2d\u7684\u9879\u4e0d\u80fd\u88ab\u62f7\u8d1d\uff0c\u4f1a\u88ab\u591a\u6b21\u5f15\u7528 s.insert(i,\u00a0x) \u5728\u7531\u00a0i\u00a0\u7ed9\u51fa\u7684\u7d22\u5f15\u4f4d\u7f6e\u5c06\u00a0x\u00a0\u63d2\u5165\u00a0s\u00a0(\u7b49\u540c\u4e8e\u00a0s[i:i]\u00a0=\u00a0[x]) s.pop([i]) \u63d0\u53d6\u5728\u00a0i\u00a0\u4f4d\u7f6e\u4e0a\u7684\u9879\uff0c\u5e76\u5c06\u5176\u4ece\u00a0s\u00a0\u4e2d\u79fb\u9664 \u53ef\u9009\u53c2\u6570\u9ed8\u8ba4\u4e3a-1\uff0c\u56e0\u6b64\u9ed8\u8ba4\u60c5\u51b5\u4f1a\u79fb\u9664\u5e76\u8fd4\u56de\u6700\u540e\u4e00\u9879 s.remove(x) \u5220\u9664\u00a0s\u00a0\u4e2d\u7b2c\u4e00\u4e2a\u00a0s[i]\u00a0\u7b49\u4e8e\u00a0x\u00a0\u7684\u9879\u76ee\u3002 \u5f53s\u627e\u4e0d\u5230x\u65f6\uff0cremove\u64cd\u4f5c\u4f1a\u5f15\u53d1ValueError s.reverse() \u5c06\u5217\u8868\u4e2d\u7684\u5143\u7d20\u9006\u5e8f \u5f53\u53cd\u8f6c\u6bd4\u8f83\u5927\u7684\u5e8f\u5217\u65f6\uff0creverse()\u65b9\u6cd5\u4f1a\u539f\u5730\u4fee\u6539\u6b64\u5e8f\u5217\u6765\u4fdd\u8bc1\u7a7a\u95f4\u7ecf\u6d4e\u6027\uff0c\u4e3a\u63d0\u9192\u7528\u6237\u6b64\u64cd\u4f5c\u662f\u901a\u8fc7\u95f4\u63a5\u5f71\u54cd\u8fdb\u884c\u7684\uff0c\u5b83\u5e76\u4e0d\u4f1a\u8fd4\u56de\u53cd\u8f6c\u540e\u7684\u5e8f\u5217"},{"location":"coding/Python3/#python_1","title":"Python\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7","text":"<p>\u4ee5\u4e0b\u8868\u683c\u5217\u51fa\u4e86\u4ece\u6700\u9ad8\u5230\u6700\u4f4e\u4f18\u5148\u7ea7\u7684\u5e38\u7528\u8fd0\u7b97\u7b26,\u540c\u4e00\u6846\u4e2d\u8fd0\u7b97\u7b26\u5177\u6709\u76f8\u540c\u4f18\u5148\u7ea7\uff0c\u9664\u975e\u660e\u786e\u7ed9\u51fa\u8bed\u6cd5\uff0c\u5426\u5219\u8fd0\u7b97\u7b26\u4e3a\u4e8c\u8fdb\u5236\uff1a\u8d1f\u51e0\u6b21\u65b9\u5176\u5b9e\u5c31\u662f\u5b83\u7684\u6b63\u51e0\u6b21\u65b9\u5206\u4e4b\u4e00</p> \u8fd0\u7b97\u7b26 \u63cf\u8ff0 ** \u6307\u6570 (\u6700\u9ad8\u4f18\u5148\u7ea7) + - ~ \u6b63\u3001\u8d1f\u3001\u6309\u4f4d\u975e (\u6700\u540e\u4e24\u4e2a\u7684\u65b9\u6cd5\u540d\u4e3a +@ \u548c -@) * @ / // % \u4e58\u6cd5\u3001\u77e9\u9635\u4e58\u6cd5\u3001\u9664\u6cd5\u3001\u5e95\u6570\u9664\u6cd5(\u53d6\u6574\u9664)\u3001\u4f59\u6570(\u53d6\u6a21)\uff1b%\u8fd0\u7b97\u7b26\u8fd8\u7528\u4e8e\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\uff0c\u9002\u7528\u4e8e\u76f8\u540c\u7684\u4f18\u5148\u7ea7 + - \u52a0\u6cd5\u3001\u51cf\u6cd5 &lt;&lt; &gt;&gt; \u5de6\u79fb,\u53f3\u79fb\u4f4d\u8fd0\u7b97\u7b26 &amp; \u6309\u4f4d\u4e0e ^ \u6309\u4f4d\u5f02\u6216 | \u6309\u4f4d\u6216 in, not in, is, is not, &lt;, &lt;=, &gt;, &gt;=, !=, == \u6bd4\u8f83,\u5305\u62ec\u6210\u5458\u8d44\u683c\u6d4b\u8bd5\u548c\u8eab\u4efd\u6d4b\u8bd5 not x NOT \u5e03\u5c14\u7c7b\u578b x and \u5e03\u5c14\u7c7b\u578b AND or \u5e03\u5c14\u7c7b\u578b OR if - else if\u6761\u4ef6\u8868\u8fbe\u5f0f lambda Lambda\u8868\u8fbe\u5f0f := Assignment expression"},{"location":"coding/Python3/#list","title":"List(\u5217\u8868)","text":"<p>\u5217\u8868list\u662fPython\u4e2d\u4f7f\u7528\u6700\u9891\u7e41\u7684\u6570\u636e\u7c7b\u578b;\u5217\u8868\u662f\u5199\u5728<code>[]</code>\u65b9\u62ec\u53f7\u4e4b\u95f4\uff0c\u7528\u9017\u53f7\u9694\u5f00\u7684\u5143\u7d20\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5143\u7d20\u7684\u7c7b\u578b\u53ef\u4ee5\u4e0d\u540c\uff0c\u548c\u5b57\u7b26\u4e32 \u4e00\u6837\uff0c\u5217\u8868\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\u3002\u5217\u8868\u88ab\u5207\u7247\u540e\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u6240\u9700\u5143\u7d20\u7684\u65b0\u5217\u8868\uff0c\u5217\u8868\u8fd8\u652f\u6301\u4e32\u8054\u64cd\u4f5c\uff0c\u4f7f\u7528+\u7b26\u53f7</p> Markdown<pre><code># \u6ce8\u610f\uff1a\n1\u3001List\u5199\u5728\u65b9\u62ec\u53f7\u4e4b\u95f4\uff0c\u5143\u7d20\u7528\u9017\u53f7\u9694\u5f00,\u5217\u8868\u89e3\u6790\u53ef\u4ee5\u751f\u6210\u5e38\u89c4\u5217\u8868\n2\u3001\u548c\u5b57\u7b26\u4e32\u4e00\u6837\uff0clist\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\n3\u3001List\u53ef\u4ee5\u4f7f\u7528+\u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5\n4\u3001List\u4e2d\u7684\u5143\u7d20\u662f\u53ef\u4ee5\u6539\u53d8\u7684\n5\u3001\u904d\u5386\u5217\u8868\u65f6\uff0c\u6709\u65f6\u5f88\u60f3\u66f4\u6539\u5217\u8868\u3002\u4f46\u662f\u521b\u5efa\u65b0\u5217\u8868\u901a\u5e38\u66f4\u7b80\u5355\uff0c\u66f4\u5b89\u5168\n</code></pre>"},{"location":"coding/Python3/#_11","title":"\u5217\u8868\u5bf9\u8c61\u7684\u65b9\u6cd5","text":"<p>\u4ee5\u4e0b\u65b9\u6cd5\u662f\u4f5c\u7528\u5728list\u5bf9\u8c61\u4e0a\u7684\u3002\u800clen()\u662f\u5c06list\u3001string\u6216\u5176\u4ed6\u7c7b\u578b\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570\uff0c insert\uff0cremove\u6216\u8005sort\u53ea\u4fee\u6539\u5217\u8868\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u9ed8\u8ba4\u8fd4\u56deNone\uff0c\u8fd9\u662fPython\u4e2d\u6240\u6709\u53ef\u53d8\u6570\u636e\u7ed3\u6784\u7684\u8bbe\u8ba1\u539f\u5219</p> \u65b9\u6cd5 \u63cf\u8ff0 list.append(elem) (elem\u8868\u793aelement)\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5217\u8868\u7684\u7ed3\u5c3e\uff0c\u76f8\u5f53\u4e8e a[len(a):] = [elem] list.extend(iterable) \u901a\u8fc7\u9644\u52a0\u6765\u81eaiterable\u7684\u6240\u6709\u9879\u6765\u6269\u5c55\u5217\u8868\u3002\u7b49\u540c\u4e8e a[len(a):] = iterable list.insert(index, elem) \u5728\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u4e2a\u5143\u7d20\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u51c6\u5907\u63d2\u5165\u5230\u5176\u524d\u9762\u7684\u90a3\u4e2a\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u4f8b\u5982 a.insert(0, x) \u4f1a\u63d2\u5165\u5230\u6574\u4e2a\u5217\u8868\u4e4b\u524d\uff0c\u800c a.insert(len(a), x) \u76f8\u5f53\u4e8e a.append(x) list.remove(elem) \u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u7684\u7b2c\u4e00\u4e2a\u5b9e\u4f8b\u5e76\u5c06\u5176\u5220\u9664,\u5982\u679c\u4e0d\u5b58\u5728\u5219\u629b\u51faValueError list.pop([i]) \u4ece\u5217\u8868\u7684\u6307\u5b9a\u4f4d\u7f6e\u5220\u9664\u5143\u7d20\uff0c\u5e76\u5c06\u5176\u8fd4\u56de\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7d22\u5f15\uff0ca.pop()\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u5143\u7d20,\u5e76\u8fd4\u56de\u6240\u5220\u9664\u7684\u503c\u3002\u65b9\u6cd5\u4e2di\u4e24\u8fb9\u7684\u65b9\u62ec\u53f7\u8868\u793a\u8fd9\u4e2a\u53c2\u6570\u662f\u53ef\u9009\u7684\uff0c\u800c\u4e0d\u662f\u8981\u6c42\u4f60\u8f93\u5165\u4e00\u5bf9\u65b9\u62ec\u53f7 list.clear() \u79fb\u9664\u5217\u8868\u4e2d\u7684\u6240\u6709\u9879\uff0c\u7b49\u4e8edel a[:] list.index(elem) \u4ece\u5217\u8868\u7684\u5f00\u5934\u641c\u7d22\u7ed9\u5b9a\u5143\u7d20\u5e76\u8fd4\u56de\u5176\u7d22\u5f15\u3002\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u5143\u7d20\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef list.count(x) \u8fd4\u56de x \u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570 list.sort() \u5bf9\u5217\u8868\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u6c38\u4e45\u6392\u5e8f,\u4e0d\u8981\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c,\u540e\u9762\u4f7f\u7528sorted()\u51fd\u6570\u4e34\u65f6\u6392\u5e8f\u663e\u793a\u66f4\u597d list.reverse() \u5012\u5e8f\u6392\u5217\u5217\u8868\u4e2d\u7684\u5143\u7d20 list.copy() \u8fd4\u56de\u5217\u8868\u7684\u6d45\u590d\u5236\uff0c\u7b49\u4e8ea[:]"},{"location":"coding/Python3/#_12","title":"\u5c06\u5217\u8868\u5f53\u505a\u5806\u6808\u4f7f\u7528","text":"<p>\u5217\u8868\u65b9\u6cd5\u4f7f\u5f97\u5217\u8868\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u4f5c\u4e3a\u4e00\u4e2a\u5806\u6808\u6765\u4f7f\u7528\uff0c\u5806\u6808\u4f5c\u4e3a\u7279\u5b9a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6700\u540e\u4e00\u4e2a\u63d2\u5165\uff0c\u6700\u5148\u53d6\u51fa\uff08\u540e\u8fdb\u5148\u51fa\uff09\u3002 \u7528 append()\u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5230\u5806\u6808\u9876\u3002\u7528\u4e0d\u6307\u5b9a\u7d22\u5f15\u7684 pop() \u65b9\u6cd5\u53ef\u4ee5\u628a\u4e00\u4e2a\u5143\u7d20\u4ece\u5806\u6808\u9876\u53d6\u51fa\u6765</p> Python<pre><code>stack = [3, 4, 5]\nstack.append(7)\nstack.pop()\n</code></pre>"},{"location":"coding/Python3/#_13","title":"\u5c06\u5217\u8868\u5f53\u4f5c\u961f\u5217\u4f7f\u7528","text":"<p>\u4e5f\u53ef\u4ee5\u628a\u5217\u8868\u5f53\u505a\u961f\u5217\u7528\uff0c\u5176\u4e2d\u5148\u6dfb\u52a0\u7684\u5143\u7d20\u88ab\u6700\u5148\u53d6\u51fa (\u201c\u5148\u8fdb\u5148\u51fa\u201d)\uff1b\u4f46\u662f\u5217\u8868\u7528\u4f5c\u8fd9\u6837\u7684\u76ee\u7684\u76f8\u5f53\u4f4e\u6548\u3002\u5728\u5217\u8868\u7684\u6700\u540e\u6dfb\u52a0\u6216\u8005 \u5f39\u51fa\u5143\u7d20\u901f\u5ea6\u5feb\uff0c\u7136\u800c\u5728\u5217\u8868\u91cc\u63d2\u5165\u6216\u8005\u4ece\u5934\u90e8\u5f39\u51fa\u901f\u5ea6\u5374\u5f88\u6162\uff08\u56e0\u4e3a\u6240\u6709\u5176\u4ed6\u7684\u5143\u7d20\u90fd\u5fc5\u987b\u79fb\u52a8\u4e00\u4f4d\uff09;\u8981\u5b9e\u73b0\u4e00\u4e2a\u961f\u5217\uff0ccollections. deque\u88ab\u8bbe\u8ba1\u7528\u4e8e\u5feb\u901f\u4ece\u4e24\u7aef\u64cd\u4f5c</p> Python<pre><code>from collections import deque\nqueue = deque([\"bob\", \"John\", \"michael\"])\nqueue.append(\"Tom\")\nqueue.popleft()\n</code></pre>"},{"location":"coding/Python3/#_14","title":"\u5217\u8868\u63a8\u5bfc\u5f0f","text":"<p>\u5217\u8868\u63a8\u5bfc\u5f0f\u63d0\u4f9b\u4e86\u4ece\u5e8f\u5217\u521b\u5efa\u5217\u8868\u7684\u7b80\u5355\u9014\u5f84\u3002\u5e38\u89c1\u7684\u7528\u6cd5\u662f\u628a\u67d0\u79cd\u64cd\u4f5c\u5e94\u7528\u4e8e\u5e8f\u5217\u6216\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u6bcf\u4e2a\u5143\u7d20\u4e0a\uff0c\u7136\u540e\u4f7f\u7528\u5176\u7ed3\u679c\u6765\u521b\u5efa \u5217\u8868\uff0c\u6216\u8005\u901a\u8fc7\u6ee1\u8db3\u67d0\u4e9b\u7279\u5b9a\u6761\u4ef6\u5143\u7d20\u6765\u521b\u5efa\u5b50\u5e8f\u5217</p> <p>\u6bcf\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f\u90fd\u5728for\u4e4b\u540e\u8ddf\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u7136\u540e\u6709\u96f6\u5230\u591a\u4e2a for \u6216 if \u5b50\u53e5\u3002\u8fd4\u56de\u7ed3\u679c\u662f\u4e00\u4e2a\u6839\u636e\u8868\u8fbe\u4ece\u5176\u540e\u7684 for \u548c if \u4e0a\u4e0b\u6587\u73af \u5883\u4e2d\u751f\u6210\u51fa\u6765\u7684\u5217\u8868\u3002\u5982\u679c\u5e0c\u671b\u8868\u8fbe\u5f0f\u63a8\u5bfc\u51fa\u4e00\u4e2a\u5143\u7ec4\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u62ec\u53f7</p> Python<pre><code># \u8ba1\u7b97\u6b63\u65b9\u5f62\uff0c\u65b9\u6cd5\u4e00\u548c\u65b9\u6cd5\u4e8c\u7b49\u6548\nsquares1 = list(map(lambda x: x**2, range(10)))  # \u65b9\u6cd5\u4e00\uff1alambda\u8868\u8fbe\u5f0f\u6cd5\nsquares2 = [x**2 for x in range(10)]    # \u65b9\u6cd5\u4e8c:\u5217\u8868\u63a8\u5bfc\u5f0f\n</code></pre>"},{"location":"coding/Python3/#del","title":"\u5d4c\u5957\u5217\u8868\u63a8\u5bfc\u5f0f\u548cdel\u8bed\u53e5","text":"<p>\u5217\u8868\u63a8\u5bfc\u5f0f\u4e2d\u7684\u521d\u59cb\u8868\u8fbe\u5f0f\u53ef\u4ee5\u662f\u4efb\u4f55\u8868\u8fbe\u5f0f\uff0c\u5305\u62ec\u53e6\u4e00\u4e2a\u5217\u8868\u63a8\u5bfc\u5f0f</p> <p>del\u8bed\u53e5\uff1a\u4f7f\u7528del\u8bed\u53e5\u53ef\u4ee5\u4ece\u4e00\u4e2a\u5217\u8868\u4e2d\u4f9d\u7d22\u5f15\u800c\u4e0d\u662f\u503c\u6765\u5220\u9664\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u4e0e\u4f7f\u7528 pop() \u8fd4\u56de\u4e00\u4e2a\u503c\u4e0d\u540c\u3002\u53ef\u4ee5\u7528 del \u8bed\u53e5\u4ece\u5217\u8868 \u4e2d\u79fb\u9664\u5207\u7247\uff0c\u6216\u6e05\u7a7a\u6574\u4e2a\u5217\u8868\uff08\u6211\u4eec\u4ee5\u524d\u4ecb\u7ecd\u7684\u65b9\u6cd5\u662f\u7a7a\u5217\u8868\u8d4b\u503c\u7ed9\u4e00\u4e2a\u6307\u5b9a\u7684\u5207\u7247)\uff0cdel\u4e5f\u53ef\u4ee5\u7528\u6765\u5220\u9664\u6574\u4e2a\u53d8\u91cf</p> Python<pre><code># \u5c06matrix\u5217\u8868\u7684\u884c\u548c\u5217\u8f6c\u7f6e\uff0c\u5185\u7f6e\u51fd\u6570\u65b9\u6cd5\uff0c\u8fd4\u56de\u7ed3\u679c\u5217\u8868\u4e2d\u6bcf\u4e2a\u5143\u7d20\u4e0d\u53d8\u4ecd\u4e3a\u5217\u8868\nmatrix = [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]]\nprint([[row[i] for row in matrix] for i in range(4)])\n\nprint(list(zip(*matrix)))  # zip()\u65b9\u6cd5\uff0c\u8fd4\u56de\u7ed3\u679c\u5217\u8868\u4e2d\u6bcf\u4e2a\u5143\u7d20\u4e3a\u5143\u7ec4tuple\n</code></pre>"},{"location":"coding/Python3/#python_2","title":"python\u9ad8\u7ea7\u7279\u6027\uff1a\u5207\u7247\u3001\u8fed\u4ee3\u3001\u63a8\u5bfc\u5f0f\u3001\u751f\u6210\u5668\u3001\u8fed\u4ee3\u5668","text":"Python<pre><code>\"\"\"\n\u5207\u7247\u5728\u5217\u8868\u4e0a\u5c31\u50cf\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u53ef\u4ee5\u7528\u6765\u6539\u53d8\u5217\u8868\u7684\u5b50\u90e8\u5206\n\u7ed9\u5b9a\u4e00\u4e2alist\u6216tuple\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7for\u5faa\u73af\u6765\u904d\u5386\u8fd9\u4e2alist\u6216tuple\uff0c\u8fd9\u79cd\u904d\u5386\u6211\u4eec\u79f0\u4e3a\u8fed\u4ee3(Iteration)\n\u8fed\u4ee3\u662f\u8bbf\u95ee\u96c6\u5408\u5143\u7d20\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u8fed\u4ee3\u5668\u53ef\u4ee5\u8bb0\u4f4f\u904d\u5386\u4f4d\u7f6e\u7684\u5bf9\u8c61\u3002\u8fed\u4ee3\u5668\u5bf9\u8c61\u4ece\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\u8bbf\u95ee\uff0c\u77e5\u9053\u6240\u6709\u5143\u7d20\u7ed3\u675f\uff0c\u8fed\u4ee3\n\u5668\u53ea\u80fd\u5f80\u524d\uff0c\u8fed\u4ee3\u5668\u6709\u4e24\u4e2a\u65b9\u6cd5iter()\u548cnext()\u3002\u5b57\u7b26\u4e32\u3001\u5217\u8868\u548c\u5143\u7ec4\u5bf9\u8c61\u90fd\u53ef\u7528\u4e8e\u521b\u5efa\u8fed\u4ee3\u5668\n\"\"\"\n\nlist1 = [1, 2, 3, 4]  # \u521b\u5efa\u5217\u8868list1\nit = iter(list1)  # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it\nprint(next(it))  # \u8f93\u51fa\u8fed\u4ee3\u5668\u4e0b\u4e00\u4e2a\u5143\u7d20\n\n# \u8fed\u4ee3\u5668\u5bf9\u8c61\u53ef\u4ee5\u7528for\u8bed\u53e5\u8fdb\u884c\u904d\u5386\nlist2 = [1, 2, 3, 4]  # \u521b\u5efa\u5217\u8868list2\nit = iter(list1)  # \u521b\u5efa\u8fed\u4ee3\u5668\u5bf9\u8c61it\nfor x in it:\n    print(x, end=\" \")\n\n\n# \u5217\u8868\u63a8\u5bfc\u5f0f\u5373List Comprehensions\uff0c\u662fPython\u5185\u7f6e\u7684\u975e\u5e38\u7b80\u5355\u5374\u5f3a\u5927\u7684\u53ef\u4ee5\u7528\u6765\u521b\u5efalist\u7684\u751f\u6210\u5f0f\n# for\u5faa\u73af\u540e\u9762\u8fd8\u53ef\u4ee5\u52a0\u4e0aif\u5224\u65ad\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7b5b\u9009\u51fa\u4ec5\u5076\u6570\u7684\u5e73\u65b9\uff1a\nprint([x * x for x in range(1, 11) if x % 2 == 0])\n\n# \u8fd0\u7528\u5217\u8868\u63a8\u5bfc\u5f0f\uff0c\u53ef\u4ee5\u5199\u51fa\u975e\u5e38\u7b80\u6d01\u7684\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u76ee\u5f55\u540d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u884c\u4ee3\u7801\u5b9e\u73b0\nimport os   # \u5bfc\u5165os\u6a21\u5757\nprint([d for d in os.listdir('.')]) # \u5217\u51fa\u5f53\u524d\u76ee\u5f55\u4e0b\u6587\u4ef6\u548c\u76ee\u5f55\u540d(\u5305\u542b\u9690\u85cf\u6587\u4ef6\u6216\u76ee\u5f55)\n\n# \u4f7f\u7528itertools\u5305\u4e2ditertools.chain.from_iterable()\u5feb\u901f\u78be\u5e73\u4e00\u4e2a\u5185\u5d4c\u5217\u8868\nimport itertools\nlist_1 = [[1, 2], [3, 4]]\nprint(list(itertools.chain(*list_1)))   # \u7b2c\u4e00\u79cd\u65b9\u5f0f\nprint(list(itertools.chain.from_iterable(list_1)))  # \u7b2c\u4e8c\u79cd\u65b9\u5f0f\n</code></pre> Python<pre><code>\"\"\"\n\u4f7f\u7528\u4e86yield\u7684\u51fd\u6570\u79f0\u4e3a\u751f\u6210\u5668(generator)\uff0c\u751f\u6210\u5668\u662f\u4e00\u4e2a\u8fd4\u56de\u8fed\u4ee3\u5668\u7684\u51fd\u6570\uff0c\u7b80\u5355\u7684\u7406\u89e3\u5c31\u662f\u751f\u6210\u5668\u5c31\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\u3002\u5728\u8c03\u7528\u751f\u6210\u5668\n\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u6b21\u9047\u5230yield\u51fd\u6570\u4f1a\u6682\u505c\u5e76\u4fdd\u5b58\u5f53\u524d\u6240\u6709\u7684\u8fd0\u884c\u4fe1\u606f\uff0c\u8fd4\u56deyield\u7684\u503c\uff0c\u5e76\u5728\u4e0b\u4e00\u6b21next()\u65b9\u6cd5\u4ece\u5f53\u524d\u4f4d\u7f6e\u7ee7\u7eed\u8fd0\u884c\n\"\"\"\n\n# \u4f7f\u7528\u751f\u6210\u5668\u751f\u6210\u6590\u6ce2\u90a3\u5951\u6570\u5217,\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff1a\u5373\u4e24\u4e2a\u5143\u7d20\u7684\u548c\u786e\u5b9a\u4e0b\u4e00\u4e2a\u6570\nimport sys\ndef fibonacci(x):\n    a, b, count = 0, 1, 0\n    while True:\n        if count &gt; x:\n            return\n        yield a # \u5c06fibonacci\u51fd\u6570\u53d8\u6210generator\uff0cprint(a)\u6539\u6210yield a\n        a, b = b, a + b\n        count += 1\nf = fibonacci(21)   # f\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u7531\u751f\u6210\u5668\u8fd4\u56de\u751f\u6210\n\nwhile True:\n    try:\n        print(next(f), end=\"\")\n    except StopIteration:\n        sys.exit()\n\n# \u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u6570\u636e\u7c7b\u578b\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a\n# \u4e00\u662f\u96c6\u5408\u6570\u636e\u7c7b\u578b\uff0c\u5982list\u3001tuple\u3001dict\u3001set\u3001str\u7b49\n# \u4e8c\u662fgenerator\uff0c\u5305\u62ec\u751f\u6210\u5668\u548c\u5e26yield\u7684generator function\n# \u8fd9\u4e9b\u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u7edf\u79f0\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1aIterable\n\n# \u53ef\u4ee5\u4f7f\u7528isinstance()\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662fIterable\u5bf9\u8c61\n# \u751f\u6210\u5668\u90fd\u662fIterator\u5bf9\u8c61\uff0c\u4f46list\u3001dict\u3001str\u867d\u7136\u662fIterable\uff0c\u5374\u4e0d\u662fIterator\u3002\u628alist\u3001dict\u3001str\u7b49Iterable\u53d8\u6210Iterator\u53ef\u4ee5\u4f7f\u7528iter()\u51fd\u6570\n</code></pre> Python<pre><code>\"\"\"\n\u4e3a\u4ec0\u4e48list\u3001dict\u3001str\u7b49\u6570\u636e\u7c7b\u578b\u4e0d\u662fIterator?\n\u8fd9\u662f\u56e0\u4e3aPython\u7684Iterator\u5bf9\u8c61\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u636e\u6d41\uff0cIterator\u5bf9\u8c61\u53ef\u4ee5\u88abnext()\u51fd\u6570\u8c03\u7528\u5e76\u4e0d\u65ad\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u76f4\u5230\u6ca1\u6709\u6570\u636e\u65f6\u629b\u51fa\nStopIteration\u9519\u8bef\u3002\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u636e\u6d41\u770b\u505a\u662f\u4e00\u4e2a\u6709\u5e8f\u5e8f\u5217\uff0c\u4f46\u6211\u4eec\u5374\u4e0d\u80fd\u63d0\u524d\u77e5\u9053\u5e8f\u5217\u7684\u957f\u5ea6\uff0c\u53ea\u80fd\u4e0d\u65ad\u901a\u8fc7next()\u51fd\u6570\u5b9e\u73b0\u6309\u9700\u8ba1\u7b97\n\u4e0b\u4e00\u4e2a\u6570\u636e\uff0c\u6240\u4ee5Iterator\u7684\u8ba1\u7b97\u662f\u60f0\u6027\u7684\uff0c\u53ea\u6709\u5728\u9700\u8981\u8fd4\u56de\u4e0b\u4e00\u4e2a\u6570\u636e\u65f6\u5b83\u624d\u4f1a\u8ba1\u7b97\nIterator\u751a\u81f3\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u65e0\u9650\u5927\u7684\u6570\u636e\u6d41\uff0c\u4f8b\u5982\u5168\u4f53\u81ea\u7136\u6570\u3002\u800c\u4f7f\u7528list\u662f\u6c38\u8fdc\u4e0d\u53ef\u80fd\u5b58\u50a8\u5168\u4f53\u81ea\u7136\u6570\u7684\n\"\"\"\n\n# \u603b\u7ed3\uff1a\n# \u51e1\u662f\u53ef\u4f5c\u7528\u4e8efor\u5faa\u73af\u7684\u5bf9\u8c61\u90fd\u662fIterable\u7c7b\u578b\n# \u51e1\u662f\u53ef\u4f5c\u7528\u4e8enext()\u51fd\u6570\u7684\u5bf9\u8c61\u90fd\u662fIterator\u7c7b\u578b\uff0c\u5b83\u4eec\u8868\u793a\u4e00\u4e2a\u60f0\u6027\u8ba1\u7b97\u7684\u5e8f\u5217\n# \u96c6\u5408\u6570\u636e\u7c7b\u578b\u5982list\u3001dict\u3001str\u7b49\u662fIterable\u4f46\u4e0d\u662fIterator\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u901a\u8fc7iter()\u51fd\u6570\u83b7\u5f97\u4e00\u4e2aIterator\u5bf9\u8c61\n\n# Python\u7684for\u5faa\u73af\u672c\u8d28\u4e0a\u5c31\u662f\u901a\u8fc7\u4e0d\u65ad\u8c03\u7528next()\u51fd\u6570\u5b9e\u73b0\u7684\uff0c\u4f8b\u5982\uff1a\nfor x in [1, 2, 3, 4, 5]:\n    pass\n\n# \u5b9e\u9645\u4e0a\u5b8c\u5168\u7b49\u4ef7\u4e8e\uff1a\n# \u9996\u5148\u83b7\u5f97Iterator\u5bf9\u8c61:\nit = iter([1, 2, 3, 4, 5])\n# \u5faa\u73af:\nwhile True:\n    try:\n        # \u83b7\u5f97\u4e0b\u4e00\u4e2a\u503c:\n        x = next(it)\n    except StopIteration:\n        # \u9047\u5230StopIteration\u5c31\u9000\u51fa\u5faa\u73af\n        break\n</code></pre>"},{"location":"coding/Python3/#tuple","title":"Tuple\uff08\u5143\u7ec4\uff09","text":"<p>\u5143\u7ec4\uff08tuple\uff09\u4e0e\u5217\u8868\u7c7b\u4f3c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539\u3002\u5143\u7ec4\u5199\u5728<code>()</code>\u5c0f\u62ec\u53f7\u91cc\uff0c\u5143\u7d20\u4e4b\u95f4\u7528\u9017\u53f7\u9694\u5f00\u3002\u5143\u7ec4\u4e2d\u7684\u5143\u7d20\u7c7b\u578b\u4e5f\u53ef \u4ee5\u4e0d\u76f8\u540c\uff0c\u5e76\u4e14\u901a\u8fc7\u89e3\u5305\u6216\u7d22\u5f15\u6765\u8bbf\u95ee\uff0c\u800c\u5217\u8868\u901a\u8fc7\u8fed\u4ee3\u8bbf\u95ee</p> <p>\u5143\u7ec4\u662f\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7ed9\u5143\u7956\u7684\u5355\u72ec\u4e00\u4e2a\u5143\u7d20\u8d4b\u503c\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u7a7a\u5143\u7956\u7531\u4e00\u5bf9\u7a7a\u5706\u62ec\u53f7\u521b\u5efa\uff0c\u542b\u6709\u4e00\u4e2a\u5143\u7d20\u7684\u5143\u7956\u53ef\u4ee5\u901a\u8fc7\u518d\u6b64\u5143\u7956\u4e4b\u540e\u6dfb\u52a0\u4e00\u4e2a\u9017\u53f7\u521b\u5efa (\u5c06\u4e00\u4e2a\u503c\u62ec\u5728\u62ec\u53f7\u4e2d\u662f\u4e0d\u591f\u7684)</p> Markdown<pre><code># \u5143\u7ec4\u4e0e\u5b57\u7b26\u4e32\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u88ab\u7d22\u5f15\u4e14\u4e0b\u6807\u7d22\u5f15\u4ece0\u5f00\u59cb\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u622a\u53d6/\u5207\u7247\u3002\u5176\u5b9e\uff0c\u53ef\u4ee5\u628a\u5b57\u7b26\u4e32\u770b\u4f5c\u4e00\u79cd\u7279\u6b8a\u7684\u5143\u7ec4\u3002\u6539\u5143\u7ec4\u5143\u7d20\u7684\u64cd\u4f5c\u662f\u975e\u6cd5\u7684,\u5143\u7ec4\n  \u4e5f\u652f\u6301\u7528+\u64cd\u4f5c\u7b26\n# \u867d\u7136tuple\u7684\u5143\u7d20\u4e0d\u53ef\u6539\u53d8\uff0c\u4f46\u5b83\u53ef\u4ee5\u5305\u542b\u53ef\u53d8\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982list\u5217\u8868\u3002\u6784\u9020\u5305\u542b0\u4e2a\u62161\u4e2a\u5143\u7d20\u7684tuple\u662f\u4e2a\u7279\u6b8a\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u6709\u4e00\u4e9b\u989d\u5916\u7684\u8bed\u6cd5\u89c4\u5219\uff1a\ntup1 = ()    # \u7a7a\u5143\u7ec4\ntup2 = (20,) # \u5355\u5143\u7ec4\uff0c\u9700\u8981\u5728\u5143\u7d20\u540e\u6dfb\u52a0\u9017\u53f7\n\n# string\u3001list\u548ctuple\u90fd\u5c5e\u4e8esequence\uff08\u5e8f\u5217\uff09\n# \u6ce8\u610f\uff1a\n1\u3001\u4e0e\u5b57\u7b26\u4e32\u4e00\u6837\uff0c\u5143\u7ec4\u7684\u5143\u7d20\u4e0d\u80fd\u4fee\u6539;\u521b\u5efa\u5355\u5143\u7d20\u5143\u7ec4\uff0c\u9700\u8981\u5728\u503c\u4e4b\u540e\u52a0\u4e0a\u4e00\u4e2a\u9017\u53f7\u3002\u6ca1\u6709\u9017\u53f7\uff0cPython \u4f1a\u5047\u5b9a\u8fd9\u53ea\u662f\u4e00\u5bf9\u989d\u5916\u7684\u5706\u62ec\u53f7\uff0c\u5e76\u4e0d\u521b\u5efa\u5143\u7ec4\n2\u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u88ab\u7d22\u5f15\u548c\u5207\u7247\uff0c\u65b9\u6cd5\u4e00\u6837\n3\u3001\u6ce8\u610f\u6784\u9020\u5305\u542b0\u62161\u4e2a\u5143\u7d20\u7684\u5143\u7ec4\u7684\u7279\u6b8a\u8bed\u6cd5\u89c4\u5219\n4\u3001\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f7f\u7528+\u64cd\u4f5c\u7b26\u8fdb\u884c\u62fc\u63a5\n</code></pre>"},{"location":"coding/Python3/#_15","title":"\u5143\u7ec4\u5185\u7f6e\u51fd\u6570","text":"\u65b9\u6cd5 \u63cf\u8ff0 len(tuple) \u8ba1\u7b97\u5143\u7ec4\u5143\u7d20\u4e2a\u6570 max(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5927\u503c min(tuple) \u8fd4\u56de\u5143\u7ec4\u4e2d\u5143\u7d20\u6700\u5c0f\u503c tuple(seq) \u5c06\u5217\u8868\u8f6c\u6362\u4e3a\u5143\u7ec4"},{"location":"coding/Python3/#range","title":"range(\u8303\u56f4)","text":"<p>range\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u6570\u5b57\u5e8f\u5217\uff0c\u901a\u5e38\u7528\u4e8e\u5728for\u5faa\u73af\u4e2d\u5faa\u73af\u7279\u5b9a\u7684\u6b21\u6570</p>"},{"location":"coding/Python3/#-string","title":"\u6587\u672c\u5e8f\u5217\u7c7b\u578b -- String","text":"<p>Python\u4e2d\u7684\u6587\u672c\u6570\u636e\u7531str\u5bf9\u8c61\u6216\u5b57\u7b26\u4e32\u5904\u7406\uff0c\u5b57\u7b26\u4e32\u662fUnicode\u7684\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u7531\u591a\u79cd\u65b9\u5f0f\u7f16\u5199</p>"},{"location":"coding/Python3/#string","title":"String(\u5b57\u7b26\u4e32)","text":"Markdown<pre><code># \u201cstr\u201d\u4e3a\u5185\u7f6e\u5b57\u7b26\u4e32\u7c7b;\u7528\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u681d\u8d77\u6765\uff0c\u540c\u65f6\u4f7f\u7528\u53cd\u659c\u6760\\\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\uff0c\u82e5\u4e0d\u60f3\u8ba9\u53cd\u659c\u6760\u4ea7\u751f\u8f6c\u4e49\u6548\u679c\uff0c\u5728\u5b57\u7b26\u4e32\u524d\u6dfb\u52a0\u4e00\n# \u4e2ar\uff0c\u8868\u793a\u539f\u59cb\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u6587\u5b57\u53ef\u4ee5\u8de8\u8d8a\u591a\u884c\uff0c\u4f46\u6bcf\u884c\u672b\u5c3e\u5fc5\u987b\u6709\u4e00\u4e2a\u53cd\u659c\u6760\\\u6765\u8f6c\u4e49\u6362\u884c\u7b26\u3002\u4e09\u5f15\u53f7\u5185\u7684\u5b57\u7b26\u4e32\u6587\u5b57\"\"\"\u6216\u201d''\u53ef\u4ee5\n#\u8de8\u8d8a\u591a\u884c\u7684\u6587\u5b57\uff1bpython\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f\uff0c\u7b2c\u4e00\u79cd\u662f\u4ece\u5de6\u5f80\u53f3\u4f9d\u6b21\u4ece0\u5f00\u59cb\u9012\u589e\uff0c\u7b2c\u4e8c\u79cd\u662f\u4ece\u53f3\u5f80\u5de6\u4f9d\u6b21\u4ece-1\u5f00\u59cb\u9012\u51cf\n# \u6ce8\u610f\uff1a\u6ca1\u6709\u5355\u72ec\u7684\u5b57\u7b26\u7c7b\u578b\uff0c\u4e00\u4e2a\u5b57\u7b26\u5c31\u662f\u957f\u5ea6\u4e3a1\u7684\u5b57\u7b26\u4e32\uff0c\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u5207\u7247\uff0c\u83b7\u53d6\u4e00\u6bb5\u5b57\u7b26\u4e32\uff0c\u5f62\u5f0f\u4e3a\u53d8\u91cf[\u5934\u4e0b\u6807:\u5c3e\u4e0b\u6807]\n# \u622a\u53d6\u8303\u56f4\u662f\u524d\u95ed\u540e\u5f00[2:]\uff0c\u5e76\u4e14\u4e24\u4e2a\u7d22\u5f15\u90fd\u53ef\u4ee5\u7701\u7565\uff1bpython\u5b57\u7b26\u4e32\u4e0d\u80fd\u88ab\u6539\u53d8\uff0c\u5982\u5411\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u8d4b\u503c\uff0cword[0]='m'\u4f1a\u5bfc\u81f4\u9519\u8bef\n\n# \u6ce8\u610f\uff1a\n1\u3001\u53cd\u659c\u6760\u53ef\u4ee5\u7528\u6765\u8f6c\u4e49\uff0c\u4f7f\u7528r\u53ef\u4ee5\u8ba9\u53cd\u659c\u6760\u4e0d\u53d1\u751f\u8f6c\u4e49\n2\u3001\u5b57\u7b26\u4e32\u53ef\u4ee5\u7528+\u8fd0\u7b97\u7b26\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u7528* \u8fd0\u7b97\u7b26\u91cd\u590d\n3\u3001Python\u4e2d\u7684\u5b57\u7b26\u4e32\u6709\u4e24\u79cd\u7d22\u5f15\u65b9\u5f0f\uff0c\u4ece\u5de6\u5f80\u53f3\u4ee50\u5f00\u59cb\uff0c\u4ece\u53f3\u5f80\u5de6\u4ee5-1\u5f00\u59cb\n4\u3001Python\u4e2d\u7684\u5b57\u7b26\u4e32\u4e0d\u80fd\u6539\u53d8\u3002\u56e0\u6b64\u6784\u9020*new*\u5b57\u7b26\u4e32\u6765\u8868\u793a\u8ba1\u7b97\u503c\uff1b\u4f8b\u5982\u8868\u8fbe\u5f0f('hello'+'there')\u6784\u5efa\u65b0\u7684hellothere\u5b57\u7b26\u4e32\n</code></pre>"},{"location":"coding/Python3/#_16","title":"\u5e38\u89c1\u7684\u5b57\u7b26\u4e32\u65b9\u6cd5","text":"<p>\u5b57\u7b26\u4e32\u5b9e\u73b0\u5e38\u89c1\u7684\u5e8f\u5217\u64cd\u4f5c,\u4ee5\u53ca\u4ee5\u4e0b\u7684\u63cf\u8ff0\u7684\u4e00\u4e9b\u65b9\u6cd5</p> \u65b9\u6cd5 \u63cf\u8ff0 str.capitalize() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u9996\u5b57\u7b26\u5927\u5199\uff0c\u5176\u4f59\u5b57\u7b26\u5c0f\u5199 str.lower(),str.upper() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5e76\u5c06\u6240\u6709\u5957\u63a5\u5b57\u7b26\u8f6c\u6362\u4e3a\u5c0f\u5199\u6216\u5927\u5199 str.strip([chars]) \u8fd4\u56de\u5220\u9664\u4e86\u5f00\u5934\u548c\u7ed3\u5c3e\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u526f\u672c\u3002 chars\u53c2\u6570\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u8981\u5220\u9664\u7684\u5b57\u7b26\u96c6\u3002\u5982\u679c\u7701\u7565\u6216None\uff0c\u5219chars\u53c2\u6570\u9ed8\u8ba4\u4e3a\u5220\u9664\u7a7a\u683c str.isalpha()/str.isdigit()/str.isspace()... \u6d4b\u8bd5\u6240\u6709\u5b57\u7b26\u4e32\u5b57\u7b26\u662f\u5426\u5728\u5404\u79cd\u5b57\u7b26\u7c7b\u4e2d str.find() \u68c0\u6d4b\u5b57\u7b26\u4e32\u4e2d\u662f\u5426\u5305\u542b\u5b50\u5b57\u7b26\u4e32str\uff0c\u5982\u679c\u6307\u5b9astart\u548cend\u8303\u56f4\uff0c\u5219\u68c0\u67e5\u662f\u5426\u5305\u542b\u5728\u6307\u5b9a\u8303\u56f4\u5185\uff0c\u5982\u679c\u5305\u542b\u5b50\u5b57\u7b26\u4e32\u8fd4\u56de\u6700\u4f4e\u7684\u7d22\u5f15\u503c\uff0c\u5426\u5219\u8fd4\u56de-1 str.format(*args, **kwargs) \u6267\u884c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u64cd\u4f5c\u3002\u8c03\u7528\u6b64\u65b9\u6cd5\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u5305\u542b\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u6216\u8005\u4ee5\u82b1\u62ec\u53f7{}\u62ec\u8d77\u6765\u7684\u66ff\u6362\u57df\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd\u5305\u542b\u4f4d\u7f6e\u53c2\u6570\u7684\u6570\u5b57\u7d22\u5f15\u6216\u5173\u952e\u5b57\u53c2\u6570\u7684\u540d\u79f0\u3002\u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u526f\u672c\uff0c\u5176\u4e2d\u6bcf\u4e2a\u66ff\u6362\u5b57\u6bb5\u90fd\u66ff\u6362\u4e3a\u76f8\u5e94\u53c2\u6570\u7684\u5b57\u7b26\u4e32\u503c str.split(sep=None, maxsplit=-1) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u5355\u8bcd\u7ec4\u6210\u7684\u5217\u8868\uff0c\u4f7f\u7528sep\u4f5c\u4e3a\u5206\u5272\u7684\u5b57\u7b26\uff0c\u82e5\u7ed9\u51fasep\uff0c\u5219\u8fde\u7eed\u7684\u5206\u9694\u5b57\u7b26\u4e0d\u4f1a\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5e76\u88ab\u89c6\u4e3a\u5212\u5206\u7a7a\u5b57\u7b26\u4e32,\u5982\u679c\u7ed9\u51famaxsplit\uff0c\u5217\u8868\u6700\u591a\u53ea\u6709maxsplit + 1\u4e2a\u5143\u7d20,\u5982\u679cmaxsplit\u6ca1\u6709\u7ed9\u51fa\u6216\u8005\u662f-1\uff0c\u5219\u6ca1\u6709\u5206\u5272\u6570\u91cf\u9650\u5236 str.splitlines([keepends]) \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2d\u7684\u884c\u4f5c\u4e3a\u5217\u8868\uff0c\u5728\u884c\u8fb9\u754c\u5904\u65ad\u5f00\u3002\u9664\u975e\u7ed9\u51fakeepends\u4e14\u4e3atrue\uff0c\u5426\u5219\u6362\u884c\u7b26\u4e0d\u5305\u62ec\u5728\u7ed3\u679c\u5217\u8868\u4e2d;\u6b64\u65b9\u6cd5\u5728\u4ee5\u4e0b\u8fb9\u754c\u5904\u8fdb\u884c\u5206\u5272 \u8868\u793a \u63cf\u8ff0 \\n \u6362\u884c \\r \u56de\u8f66 \\r\\n \u56de\u8f66+\u6362\u884c \\v\u00a0or\u00a0\\x0b \u884c\u5217\u8868 \\f\u00a0or\u00a0\\x0c \u6362\u9875 \\x1c \u6587\u4ef6\u5206\u9694\u7b26 \\x1d \u7ec4\u5206\u9694\u7b26 \\x1e \u8bb0\u5f55\u5206\u9694\u7b26 \\x85 \u4e0b\u4e00\u884c\uff08C1\u63a7\u5236\u4ee3\u7801\uff09 \\u2028 \u884c\u5206\u9694\u7b26 \\u2029 \u6bb5\u843d\u5206\u9694\u7b26 Python<pre><code>print(b'\\xe5\\x85\\x83'.decode('utf-8'))  # \u5c06bytes\u89e3\u7801\u4e3autf-8\u5b57\u7b26\u4e32\uff0c\u8bed\u6cd5\u66f4\u52a0Pythonic\nprint(str(b'\\xe5\\x85\\x83', 'utf-8'))    # \u5c06bytes\u89e3\u7801\u4e3autf-8\u5b57\u7b26\u4e32\uff0c\u53ef\u7528\u6027\u8303\u56f4\u66f4\u5e7f\n</code></pre>"},{"location":"coding/Python3/#printf","title":"printf\u98ce\u683c\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316","text":"<p>\u5b57\u7b26\u4e32\u5177\u6709\u4e00\u79cd\u7279\u6b8a\u5185\u7f6e\u64cd\u4f5c\uff1a\u4f7f\u7528%(\u53d6\u6a21)\u8fd0\u7b97\u7b26\uff0c\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u7684sprintf()</p> <p>\u8f6c\u6362\u6807\u8bb0\u7b26\u5305\u542b\u4e24\u4e2a\u6216\u66f4\u591a\u5b57\u7b26\u5e76\u5177\u6709\u4ee5\u4e0b\u7ec4\u6210\uff0c\u4e14\u5fc5\u987b\u9075\u5faa\u6b64\u5904\u89c4\u5b9a\u7684\u987a\u5e8f\uff1a</p> <ol> <li>'%' \u5b57\u7b26\uff0c\u7528\u4e8e\u6807\u8bb0\u8f6c\u6362\u7b26\u7684\u8d77\u59cb</li> <li>\u6620\u5c04\u952e\uff08\u53ef\u9009\uff09\uff0c\u7531\u52a0\u5706\u62ec\u53f7\u7684\u5b57\u7b26\u5e8f\u5217\u7ec4\u6210 (\u4f8b\u5982 (somename))</li> <li>\u8f6c\u6362\u6807\u5fd7\uff08\u53ef\u9009\uff09\uff0c\u7528\u4e8e\u5f71\u54cd\u67d0\u4e9b\u8f6c\u6362\u7c7b\u578b\u7684\u7ed3\u679c</li> <li>\u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\uff08\u53ef\u9009\uff09\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u5bbd\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u6700\u5c0f\u5b57\u6bb5\u5bbd\u5ea6\u548c\u53ef\u9009\u7684\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20</li> <li>\u7cbe\u5ea6\uff08\u53ef\u9009\uff09\uff0c\u4ee5\u5728 '.' (\u70b9\u53f7) \u4e4b\u540e\u52a0\u7cbe\u5ea6\u503c\u7684\u5f62\u5f0f\u7ed9\u51fa\u3002 \u5982\u679c\u6307\u5b9a\u4e3a '*' (\u661f\u53f7)\uff0c\u5219\u5b9e\u9645\u7cbe\u5ea6\u4f1a\u4ece values \u5143\u7ec4\u7684\u4e0b\u4e00\u5143\u7d20\u4e2d\u8bfb\u53d6\uff0c\u8981\u8f6c\u6362\u7684\u5bf9\u8c61\u5219\u4e3a\u7cbe\u5ea6\u4e4b\u540e\u7684\u5143\u7d20</li> <li>\u957f\u5ea6\u4fee\u9970\u7b26\uff08\u53ef\u9009\uff09</li> <li>\u8f6c\u6362\u7c7b\u578b</li> </ol> <p>\u8f6c\u6362\u6807\u5fd7\u5b57\u7b26\u4e3a\uff1a</p> \u6807\u5fd7 \u542b\u4e49 '#' \u503c\u7684\u8f6c\u6362\u5c06\u4f7f\u7528\u201c\u66ff\u4ee3\u5f62\u5f0f\u201d(\u5177\u4f53\u5b9a\u4e49\u89c1\u4e0b\u6587) '0' \u8f6c\u6362\u5c06\u4e3a\u6570\u5b57\u503c\u586b\u5145\u96f6\u5b57\u7b26 '-' \u8f6c\u6362\u503c\u5c06\u9760\u5de6\u5bf9\u9f50\uff08\u5982\u679c\u540c\u65f6\u7ed9\u51fa\u00a0'0'\u00a0\u8f6c\u6362\uff0c\u5219\u4f1a\u8986\u76d6\u540e\u8005\uff09 '\u00a0' (\u7a7a\u683c) \u7b26\u53f7\u4f4d\u8f6c\u6362\u4ea7\u751f\u7684\u6b63\u6570\uff08\u6216\u7a7a\u5b57\u7b26\u4e32\uff09\u524d\u5c06\u7559\u51fa\u4e00\u4e2a\u7a7a\u683c '+' \u7b26\u53f7\u5b57\u7b26 ('+'\u00a0\u6216\u00a0'-') \u5c06\u663e\u793a\u4e8e\u8f6c\u6362\u7ed3\u679c\u7684\u5f00\u5934(\u4f1a\u8986\u76d6 \"\u7a7a\u683c\" \u6807\u5fd7) <p>\u8f6c\u6362\u7c7b\u578b\u4e3a\uff1a</p> \u8f6c\u6362\u7b26 \u542b\u4e49 \u6ce8\u91ca d \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 i \u6709\u7b26\u53f7\u5341\u8fdb\u5236\u6574\u6570 o \u6709\u7b26\u53f7\u516b\u8fdb\u5236\u6570 1 u \u8fc7\u65f6\u7c7b\u578b  \u7b49\u4ef7\u4e8e\u00a0'd' 6 x \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5c0f\u5199\uff09 2 X \u6709\u7b26\u53f7\u5341\u516d\u8fdb\u5236\u6570\uff08\u5927\u5199\uff09 2 e \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5c0f\u5199\uff09 3 E \u6d6e\u70b9\u6307\u6570\u683c\u5f0f\uff08\u5927\u5199\uff09 3 f \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 F \u6d6e\u70b9\u5341\u8fdb\u5236\u683c\u5f0f 3 g \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5c0f\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 G \u6d6e\u70b9\u683c\u5f0f\u3002 \u5982\u679c\u6307\u6570\u5c0f\u4e8e 4 \u6216\u4e0d\u5c0f\u4e8e\u7cbe\u5ea6\u5219\u4f7f\u7528\u5927\u5199\u6307\u6570\u683c\u5f0f\uff0c\u5426\u5219\u4f7f\u7528\u5341\u8fdb\u5236\u683c\u5f0f 4 c \u5355\u4e2a\u5b57\u7b26\uff08\u63a5\u53d7\u6574\u6570\u6216\u5355\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff09 r \u5b57\u7b26\u4e32\uff08\u4f7f\u7528\u00a0repr()\u00a0\u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 s \u5b57\u7b26\u4e32\uff08\u4f7f\u7528\u00a0str()\u00a0\u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 a \u5b57\u7b26\u4e32\uff08\u4f7f\u7528\u00a0ascii()\u00a0\u8f6c\u6362\u4efb\u4f55 Python \u5bf9\u8c61\uff09 5 % \u4e0d\u8f6c\u6362\u53c2\u6570\uff0c\u5728\u7ed3\u679c\u4e2d\u8f93\u51fa\u4e00\u4e2a\u00a0'%'\u00a0\u5b57\u7b26 <p>\u6ce8\u91ca:</p> <ol> <li>\u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165\u6807\u793a\u516b\u8fdb\u5236\u6570\u7684\u524d\u7f00 ('0o')</li> <li>\u6b64\u66ff\u4ee3\u5f62\u5f0f\u4f1a\u5728\u7b2c\u4e00\u4e2a\u6570\u7801\u4e4b\u524d\u63d2\u5165 '0x' \u6216 '0X' \u524d\u7f00\uff08\u53d6\u51b3\u4e8e\u662f\u4f7f\u7528 'x' \u8fd8\u662f 'X' \u683c\u5f0f\uff09</li> <li>\u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u5373\u4f7f\u5176\u540e\u5e76\u6ca1\u6709\u6570\u5b57,\u5c0f\u6570\u70b9\u540e\u7684\u6570\u5b57\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6</li> <li>\u6b64\u66ff\u4ee3\u5f62\u5f0f\u603b\u662f\u4f1a\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u4e00\u4e2a\u5c0f\u6570\u70b9\uff0c\u672b\u5c3e\u5404\u4f4d\u7684\u96f6\u4e0d\u4f1a\u5982\u5176\u4ed6\u60c5\u51b5\u4e0b\u90a3\u6837\u88ab\u79fb\u9664,\u5c0f\u6570\u70b9\u524d\u540e\u7684\u6709\u6548\u6570\u7801\u4f4d\u6570\u7531\u7cbe\u5ea6\u51b3\u5b9a\uff0c\u9ed8\u8ba4\u4e3a 6</li> <li>\u5982\u679c\u7cbe\u5ea6\u4e3a N\uff0c\u8f93\u51fa\u5c06\u622a\u77ed\u4e3a N \u4e2a\u5b57\u7b26</li> <li>\u53c2\u89c1PEP 237</li> </ol>"},{"location":"coding/Python3/#-bytesbytearraymemoryview","title":"\u4e8c\u8fdb\u5236\u5e8f\u5217\u7c7b\u578b -- bytes\u3001bytearray\u3001memoryview","text":"<p>\u7528\u4e8e\u64cd\u4f5c\u4e8c\u8fdb\u5236\u6570\u636e\u7684\u6838\u5fc3\u5185\u7f6e\u7c7b\u578b\u662fbytes\u548cbytearray\uff0c\u5b83\u4eec\u652f\u6301memoryview\u4f7f\u7528buffer protocol\u534f\u8bae\u6765\u8bbf\u95ee\u5176\u4ed6\u4e8c\u8fdb\u5236\u5bf9\u8c61\u7684\u5185\u5b58\u800c\u65e0\u9700\u505a\u4e00\u4e2a\u590d\u5236 \u8be5array\u6a21\u5757\u652f\u6301\u6709\u6548\u5b58\u50a8\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u598232\u4f4d\u6574\u6570\u548cIEEE754\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u503c</p>"},{"location":"coding/Python3/#bytes","title":"bytes\u5bf9\u8c61","text":"Markdown<pre><code>\u5b57\u8282\u5bf9\u8c61\u662f\u5355\u4e2a\u5b57\u8282\u4e0d\u53ef\u53d8\u5e8f\u5217\uff0c\u7531\u4e8e\u4e3b\u8981\u7684\u4e8c\u8fdb\u5236\u534f\u8bae\u5927\u591a\u57fa\u4e8eASCII\u6587\u672c\u7f16\u7801\uff0c\u56e0\u6b64\u5b57\u8282\u5bf9\u8c61\u63d0\u4f9b\u4e86\u51e0\u79cd\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4ec5\u5728\u5904\u7406ASCII\n\u517c\u5bb9\u6570\u636e\u65f6\u6709\u6548\uff0c\u5e76\u4e14\u4ee5\u5404\u79cd\u5176\u4ed6\u65b9\u5f0f\u4e0e\u5b57\u7b26\u4e32\u5bf9\u8c61\u5bc6\u5207\u76f8\u5173\n\n\u5b57\u8282\u6587\u5b57\u7684\u8bed\u6cd5\u548c\u5b57\u7b26\u4e32\u6587\u5b57\u7684\u8bed\u6cd5\u7c7b\u4f3c\uff0c\u53ea\u662f\u6dfb\u52a0\u4e86\u524d\u7f00 b\n\u5b57\u8282\u6587\u5b57\u4e2d\u53ea\u5141\u8bb8\u4f7f\u7528ASCII\u5b57\u7b26\uff08\u65e0\u8bba\u58f0\u660e\u7684\u6e90\u4ee3\u7801\u7f16\u7801\u5982\u4f55\uff09\u3002\u5fc5\u987b\u4f7f\u7528\u9002\u5f53\u7684\u8f6c\u4e49\u5e8f\u5217\u5c06\u8d85\u8fc7127\u7684\u4efb\u4f55\u4e8c\u8fdb\u5236\u503c\u8f93\u5165\u5230\u5b57\u8282\u6587\u5b57\u4e2d\n\u4e0e\u5b57\u7b26\u4e32\u6587\u5b57\u4e00\u6837\uff0c\u5b57\u8282\u6587\u5b57\u4e5f\u53ef\u4ee5\u4f7f\u7528r\u524d\u7f00\u6765\u7981\u7528\u8f6c\u4e49\u5e8f\u5217\u7684\u5904\u7406\n\u867d\u7136\u5b57\u8282\u6587\u5b57\u548c\u8868\u793a\u57fa\u4e8eASCII\u6587\u672c\uff0c\u4f46\u5b57\u8282\u5bf9\u8c61\u5b9e\u9645\u4e0a\u8868\u73b0\u4e3a\u4e0d\u53ef\u53d8\u7684\u6574\u6570\u5e8f\u5217\uff0c\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e2a\u503c\u90fd\u53d7\u5230\u9650\u5236\uff0c\u4ee5\u81f40 &lt;= x &lt; 256\uff08\u8bd5\u56fe\n\u8fdd\u53cd\u6b64\u9650\u5236\u5c06\u89e6\u53d1ValueError\uff09\u3002\u8fd9\u662f\u6545\u610f\u5f3a\u8c03\u7684\uff0c\u867d\u7136\u8bb8\u591a\u4e8c\u8fdb\u5236\u683c\u5f0f\u5305\u62ec\u57fa\u4e8eASCII\u7684\u5143\u7d20\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u9762\u5411\u6587\u672c\u7684\u7b97\u6cd5\u8fdb\u884c\u6709\n\u7528\u7684\u64cd\u4f5c\uff0c\u4f46\u5bf9\u4e8e\u4efb\u610f\u4e8c\u8fdb\u5236\u6570\u636e\u901a\u5e38\u4e0d\u662f\u8fd9\u79cd\u60c5\u51b5\uff08\u76f2\u76ee\u5730\u5c06\u6587\u672c\u5904\u7406\u7b97\u6cd5\u5e94\u7528\u4e8e\u975e\u4e8c\u8fdb\u5236\u6570\u636e\u683c\u5f0f\uff09 ASCII\u517c\u5bb9\u901a\u5e38\u4f1a\u5bfc\u81f4\u6570\u636e\u635f\u574f\uff09\n</code></pre> <p>\u9664\u4e86\u6587\u5b57\u5f62\u5f0f\u4e4b\u5916\uff0c\u8fd8\u53ef\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u521b\u5efa\u5b57\u8282\u5bf9\u8c61\uff1a</p> <ul> <li>\u6307\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b57\u8282\u5bf9\u8c61\uff1atypes(10)</li> <li>\u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytes(range(10))</li> <li>\u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytes(obj)</li> </ul>"},{"location":"coding/Python3/#bytearray","title":"bytearray\u5bf9\u8c61","text":"<p>bytearray\u5bf9\u8c61\u662fbytes\u5bf9\u8c61\u7684\u53ef\u53d8\u526f\u672c\uff0c\u7531\u4e8ebytearray\u662f\u53ef\u53d8\u7684\uff0c\u8fd8\u652f\u6301\u53ef\u53d8\u5e8f\u5217\u64cd\u4f5c</p> <p>bytearray\u5bf9\u8c61\u6ca1\u6709\u4e13\u7528\u7684\u6587\u5b57\u8bed\u6cd5\uff0c\u800c\u662f\u59cb\u7ec8\u901a\u8fc7\u8c03\u7528\u6784\u9020\u51fd\u6570\u6765\u521b\u5efa\uff1a</p> <ul> <li>\u521b\u5efa\u4e00\u4e2a\u7a7a\u5b9e\u4f8b\uff1abytearray()</li> <li>\u521b\u5efa\u5177\u6709\u7ed9\u5b9a\u957f\u5ea6\u7684\u96f6\u586b\u5145\u5b9e\u4f8b\uff1abytearray(10)</li> <li>\u4ece\u53ef\u8fed\u4ee3\u7684\u6574\u6570\uff1abytearray(range(10))</li> <li>\u901a\u8fc7buffer protocol\u534f\u8bae\u590d\u5236\u73b0\u6709\u4e8c\u8fdb\u5236\u6570\u636e\uff1abytearray(b'Hello')</li> </ul> <p>bytes\u548cbytearray\u5bf9\u8c61\u90fd\u652f\u6301\u516c\u5171\u5e8f\u5217\u64cd\u4f5c\uff0c\u5b83\u4eec\u4e0d\u4ec5\u4e0e\u76f8\u540c\u7c7b\u578b\u7684\u64cd\u4f5c\u6570\u4e92\u64cd\u4f5c\uff0c\u800c\u4e14\u4e0e\u4efb\u4f55\u7c7b\u4f3c\u5b57\u8282\u7684\u5bf9\u8c61\u4e92\u64cd\u4f5c\uff1b\u7531\u4e8e\u6b64\u7075\u6d3b\u6027 \u5b83\u4eec\u53ef\u4ee5\u5728\u64cd\u4f5c\u4e2d\u81ea\u7531\u6df7\u5408\u800c\u4e0d\u4f1a\u5bfc\u81f4\u9519\u8bef\uff0c\u4f46\u7ed3\u679c\u7684\u8fd4\u56de\u7c7b\u578b\u53ef\u80fd\u53d6\u51b3\u4e8e\u64cd\u4f5c\u6570\u7684\u987a\u5e8f</p>"},{"location":"coding/Python3/#printf_1","title":"printf\u98ce\u683c\u5b57\u8282\u683c\u5f0f\u5316","text":"<p>\u5b57\u8282\u5bf9\u8c61(bytes/bytearray)\u6709\u4e00\u4e2a\u72ec\u7279\u7684\u5185\u7f6e\u64cd\u4f5c\uff1a%\u8fd0\u7b97\u7b26(\u6a21\u6570)\u4e5f\u6210\u4e3a\u5b57\u8282\u683c\u5f0f\u5316\u6216\u63d2\u503c\u8fd0\u7b97\u7b26\uff0c\u5982\u679cformat\u9700\u8981\u5355\u4e2a\u53c2\u6570\uff0c\u5219\u503c\u53ef \u4ee5\u662f\u5355\u4e2a\u975e\u5143\u7ec4\u5bf9\u8c61\uff0c\u5426\u5219\u503c\u5fc5\u987b\u662f\u5177\u6709\u683c\u5f0f\u5b57\u8282\u5bf9\u8c61\u6216\u5355\u4e2a\u6620\u5c04\u5bf9\u8c61(\u5b57\u5178)\u6307\u5b9a\u7684\u9879\u76ee\u6570\u7684\u5143\u7ec4</p> <p>\u5176\u4ed6\u548c\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u76f8\u540c</p>"},{"location":"coding/Python3/#memory-views","title":"memory views","text":"<p>memoryview\u5bf9\u8c61\u5141\u8bb8Python\u4ee3\u7801\u8bbf\u95ee\u652f\u6301buffer protocol\u7684\u5bf9\u8c61\u7684\u5185\u90e8\u6570\u636e\u800c\u65e0\u9700\u590d\u5236</p>"},{"location":"coding/Python3/#set-setfrozenset","title":"Set\u7c7b\u578b -- set\u3001frozenset","text":""},{"location":"coding/Python3/#set","title":"Set\uff08\u96c6\u5408\uff09","text":"Markdown<pre><code>\u96c6\u5408\u662f\u4e00\u4e2a`\u65e0\u5e8f\u4e0d\u91cd\u590d\u5143\u7d20`\u7684\u96c6\u3002set\u5bf9\u8c61\u662f\u7531\u5177\u6709\u552f\u4e00\u6027\u7684hashable\u5bf9\u8c61\u7ec4\u6210\u7684\u65e0\u5e8f\u591a\u9879\u96c6\u5408\u3002\u57fa\u672c\u529f\u80fd\u5305\u62ec\u6210\u5458\u5173\u7cfb\u68c0\u6d4b\u548c\u6d88\u9664\u91cd\u590d\n\u5143\u7d20\u3002\u96c6\u5408\u5bf9\u8c61\u8fd8\u652f\u6301\u6570\u5b66\u96c6\u5408\u7c7b\u8fd0\u7b97\uff0c\u5982\u5e76\u96c6\uff0c\u4ea4\u96c6\uff0c\u5dee\u96c6\u548c\u5bf9\u79f0\u5dee\u96c6\u7b49;\u4f5c\u4e3a\u65e0\u5e8f\u96c6\u5408\uff0c\u4e0d\u8bb0\u5f55\u5143\u7d20\u4f4d\u7f6e\u548c\u63d2\u5165\u987a\u5e8f\uff0c\u96c6\u5408\u4e0d\u652f\u6301\n\u7d22\u5f15\u3001\u5207\u7247\u6216\u5176\u4ed6\u7c7b\u4f3c\u5e8f\u5217\u7684\u884c\u4e3a\n\n\u76ee\u524d\u6709\u4e24\u79cd\u5185\u7f6e\u96c6\u5408\u7c7b\u578b\uff0cset\u548cfrozenset\uff0cset\u7c7b\u578b\u662f\u53ef\u53d8\u7684\uff0c\u5176\u5143\u7d20\u53ef\u4ee5\u7528add()\u548cremove()\u65b9\u6cd5\u6539\u53d8\uff0c\u6240\u4ee5\u4e0d\u5177\u6709\u54c8\u5e0c\u503c\u4e14\u4e0d\u80fd\u88ab\u7528\n\u4f5c\u5b57\u5178\u7684\u952e\u6216\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20\u3002frozenset\u7c7b\u578b\u662f\u4e0d\u53ef\u53d8\u7684\u5e76\u4e14\u4e3ahashable\uff0c\u5176\u5185\u5bb9\u5728\u88ab\u521b\u5efa\u540e\u4e0d\u80fd\u518d\u6539\u53d8\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u4f5c\u5b57\u5178\u7684\u952e\u548c\u5176\u4ed6\u96c6\u5408\u7684\u5143\u7d20\n\n\u53ef\u4ee5\u7528\u5927\u62ec\u53f7`{}`\u521b\u5efa\u96c6\u5408\u3002\u6ce8\u610f\uff1a\u5982\u679c\u8981\u521b\u5efa\u4e00\u4e2a\u7a7a\u96c6\u5408\uff0c\u4f60\u5fc5\u987b\u7528 set() \u800c\u4e0d\u662f {} \uff1b\u540e\u8005\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684\u5b57\u5178\uff0c\u96c6\u5408\u4e5f\u652f\u6301set\u63a8\u5bfc\na = {x for x in 'abracadabra' if x not in 'abc'}    # set\u63a8\u5bfc\n\n# \u6ce8\u610f\uff1a\n1\u3001\u4ece\u5217\u8868\u521b\u5efa\u96c6\u5408,\u53ef\u4f7f\u7528set()\u51fd\u6570\n2\u3001\u96c6\u5408\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u503c;\u4f46\u5982\u679c\u6dfb\u52a0\u96c6\u5408\u5df2\u6709\u7684\u503c\uff0c\u4e0d\u4f1a\u53d1\u751f\u4efb\u4f55\u4e8b\u60c5\uff0c\u4e5f\u4e0d\u4f1a\u62a5\u9519\n</code></pre>"},{"location":"coding/Python3/#_17","title":"\u96c6\u5408\u5185\u7f6e\u65b9\u6cd5","text":"\u65b9\u6cd5 \u63cf\u8ff0 add() add() \u65b9\u6cd5\u63a5\u53d7\u5355\u4e2a\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u5c06\u8be5\u503c\u6dfb\u52a0\u5230\u96c6\u5408\u4e4b\u4e2d update() update() \u65b9\u6cd5\u4ec5\u63a5\u53d7\u4e00\u4e2a\u96c6\u5408\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u5c06\u5176\u6240\u6709\u6210\u5458\u6dfb\u52a0\u5230\u521d\u59cb\u5217\u8868\u4e2d;\u5982\u679c\u6709\u91cd\u590d\u503c\uff0c\u5c06\u4f1a\u88ab\u5ffd\u7565 discard() discard() \u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u8be5\u503c;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 discard()\u65b9\u6cd5\uff0c\u5b83\u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u4e0d\u4ea7\u751f\u9519\u8bef remove() remove() \u65b9\u6cd5\u4e5f\u63a5\u53d7\u4e00\u4e2a\u5355\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u4e5f\u4ece\u96c6\u5408\u4e2d\u5c06\u5176\u5220\u9664;\u9488\u5bf9\u4e00\u4e2a\u96c6\u5408\u4e2d\u4e0d\u5b58\u5728\u7684\u503c\u8c03\u7528 remove()\u65b9\u6cd5\u5c06\u4f1a\u5f15\u53d1KeyError\u9519\u8bef pop() \u4ece\u96c6\u5408\u5220\u9664\u67d0\u4e2a\u503c\u5e76\u8fd4\u56de\u8be5\u503c"},{"location":"coding/Python3/#-_1","title":"\u6620\u5c04\u7c7b\u578b -- \u5b57\u5178","text":""},{"location":"coding/Python3/#dict","title":"Dict\uff08\u5b57\u5178\uff09","text":"Markdown<pre><code>\u4e00\u4e2amapping\u5bf9\u8c61\u6620\u5c04\u53ef\u54c8\u5e0c\u503c\u5230\u4efb\u610f\u5bf9\u8c61\uff0cmapping\u662f\u53ef\u53d8\u5bf9\u8c61\uff1b\u76ee\u524d\u53ea\u6709\u4e00\u79cd\u6807\u51c6\u7684mapping\u7c7b\u578b,\u5373\u5b57\u5178\u3002\u5b57\u5178\u4ee5\u5173\u952e\u5b57\u4f5c\u4e3a\u7d22\u5f15\n\u5173\u952e\u5b57\u53ef\u4ee5\u662f\u4efb\u610f\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u901a\u5e38\u662f\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u3002\u5982\u679c\u4e00\u4e2a\u5143\u7ec4\u4e2d\u53ea\u5305\u542b\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u548c\u5143\u7ec4\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7ec4\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u5173\u952e\u5b57\n\u5982\u679c\u5143\u7ec4\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u5305\u542b\u4e86\u53ef\u53d8\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u4f5c\u4e3a\u5173\u952e\u5b57\u3002\u5173\u952e\u5b57\u5fc5\u987b\u4f7f\u7528\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f\u8bf4list\u548c\u5305\u542b\u53ef\u53d8\u7c7b\u578b\u7684tuple\n\u4e0d\u80fd\u505a\u5173\u952e\u5b57\u3002\u5728\u540c\u4e00\u4e2a\u5b57\u5178\u4e2d\uff0c\u5173\u952e\u5b57\u8fd8\u5fc5\u987b\u4e92\u4e0d\u76f8\u540c\u3002\u53ef\u4ee5\u5c06\u5b57\u5178\u770b\u4f5c\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u7684\u96c6\u5408\uff0c\u5728\u4e00\u4e2a\u5b57\u5178\u4e2d\u952e\u5fc5\u987b\u662f\u552f\u4e00\u7684\n\u5b57\u5178\u4e3b\u8981\u64cd\u4f5c\u662f\u5173\u952e\u5b57\u5b58\u50a8\u548c\u89e3\u6790\u503c\n\n# \u6ce8\u610f\uff1a\n\n1\u3001\u5b57\u5178\u662f\u4e00\u79cd\u6620\u5c04\u7c7b\u578b\uff0c\u5b83\u7684\u5143\u7d20\u662f\u952e\u503c\u5bf9\u3002\u6784\u9020\u51fd\u6570dict()\u76f4\u63a5\u4ece\u952e\u503c\u5bf9sequence\u4e2d\u6784\u5efa\u5b57\u5178\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u63a8\u5bfc\n2\u3001\u5b57\u5178\u7684\u5173\u952e\u5b57\u5fc5\u987b\u4e3a\u4e0d\u53ef\u53d8\u7c7b\u578b\uff0c\u4e14\u4e0d\u80fd\u91cd\u590d\n3\u3001\u521b\u5efa\u7a7a\u5b57\u5178\u4f7f\u7528{}\n\n\u5b57\u5178\u904d\u5386\u6280\u5de7\uff1a\n* \u5728\u5b57\u5178\u4e2d\u904d\u5386\u65f6\uff0c\u5173\u952e\u5b57\u548c\u5bf9\u5e94\u7684\u503c\u53ef\u4ee5\u4f7f\u7528 items() \u65b9\u6cd5\u540c\u65f6\u89e3\u8bfb\u51fa\u6765\n* \u5728\u5e8f\u5217\u4e2d\u904d\u5386\u65f6\uff0c\u7d22\u5f15\u4f4d\u7f6e\u548c\u5bf9\u5e94\u503c\u53ef\u4ee5\u4f7f\u7528 enumerate() \u51fd\u6570\u540c\u65f6\u5f97\u5230\n* \u540c\u65f6\u904d\u5386\u4e24\u4e2a\u6216\u66f4\u591a\u7684\u5e8f\u5217\uff0c\u53ef\u4ee5\u4f7f\u7528 zip() \u7ec4\u5408\n* \u8981\u53cd\u5411\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u9996\u5148\u6307\u5b9a\u8fd9\u4e2a\u5e8f\u5217\u7136\u540e\u8c03\u7528 reversesd() \u51fd\u6570\n* \u8981\u6309\u987a\u5e8f\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\uff0c\u4f7f\u7528 sorted() \u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u5df2\u6392\u5e8f\u7684\u5e8f\u5217\uff0c\u5e76\u4e0d\u4fee\u6539\u539f\u503c\n\ncollections.OrderedDict([items])    \u8fd4\u56dedict\u5b50\u7c7b\u7684\u5b9e\u4f8b\uff0c\u8be5\u5b9e\u4f8b\u5177\u6709\u4e13\u95e8\u7528\u4e8e\u91cd\u65b0\u6392\u5217\u5b57\u5178\u987a\u5e8f\u7684\u65b9\u6cd5\n</code></pre>"},{"location":"coding/Python3/#python_3","title":"python\u5b57\u5178\u5e38\u7528\u65b9\u6cd5","text":"\u65b9\u6cd5 \u63cf\u8ff0 dict.clear() \u5220\u9664\u5b57\u5178\u5185\u6240\u6709\u5143\u7d20 dict.copy() \u8fd4\u56de\u539f\u5b57\u5178\u7684\u6d45\u62f7\u8d1d dict.fromkeys() \u521b\u5efa\u4e00\u4e2a\u65b0\u5b57\u5178\uff0c\u4ee5\u5e8f\u5217seq\u4e2d\u5143\u7d20\u505a\u5b57\u5178\u7684\u952e\uff0cval\u4e3a\u5b57\u5178\u6240\u6709\u952e\u5bf9\u5e94\u7684\u521d\u59cb\u503c dict.get(key, default=None) \u8fd4\u56de\u6307\u5b9a\u952e\u7684\u503c\uff0c\u5982\u679c\u503c\u4e0d\u5728\u5b57\u5178\u4e2d\u8fd4\u56dedefault\u503c key in dict \u5982\u679c\u952e\u5728\u5b57\u5178dict\u91cc\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse dict.items() \u4ee5\u5217\u8868\u8fd4\u56de\u53ef\u904d\u5386\u7684(\u952e, \u503c) \u5143\u7ec4\u6570\u7ec4 dict.keys() \u4ee5\u5217\u8868\u8fd4\u56de\u4e00\u4e2a\u5b57\u5178\u6240\u6709\u7684\u952e dict.setdefault(key, default=None) \u548cget()\u7c7b\u4f3c, \u4f46\u5982\u679c\u952e\u4e0d\u5b58\u5728\u4e8e\u5b57\u5178\u4e2d\uff0c\u5c06\u4f1a\u6dfb\u52a0\u952e\u5e76\u5c06\u503c\u8bbe\u4e3adefault dict.update(dict2) \u628a\u5b57\u5178dict2\u7684\u952e/\u503c\u5bf9\u66f4\u65b0\u5230dict\u91cc dict.values() \u4ee5\u5217\u8868\u8fd4\u56de\u5b57\u5178\u4e2d\u7684\u6240\u6709\u503c"},{"location":"coding/Python3/#dictionary-view-objects","title":"\u5b57\u5178\u89c6\u56fe\u5bf9\u8c61(dictionary view objects)","text":"<p>\u8fd9\u4e9b\u5bf9\u8c61\u901a\u8fc7dict.keys()\u3001dict.values()\u3001dict.items()\u8fd4\u56de\u7684\u662f\u89c6\u56fe\u5bf9\u8c61\uff0c\u5b83\u4eec\u63d0\u4f9b\u5b57\u5178\u6761\u76ee\u7684\u52a8\u6001\u89c6\u56fe\uff0c\u610f\u5473\u7740\u5f53\u5b57\u5178\u66f4\u6539\u65f6\uff0c\u89c6\u56fe\u5219\u4f1a\u53cd\u5e94\u8fd9\u4e9b\u66f4\u6539</p>"},{"location":"coding/Python3/#context-manager-types","title":"\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u7c7b\u578b(Context Manager Types)","text":"<p>python\u7684with\u8bed\u53e5\u652f\u6301\u7531\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\u5b9a\u4e49\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u6982\u5ff5\uff0c\u8fd9\u662f\u4f7f\u7528\u4e00\u5bf9\u65b9\u6cd5\u5b9e\u73b0\u7684\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u5b9a\u4e49\u5728\u8bed\u53e5\u4f53 \u6267\u884c\u4e4b\u524d\u8f93\u5165\u7684\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\uff0c\u5e76\u5728\u8bed\u53e5\u7ed3\u675f\u65f6\u9000\u51fa</p> <p>ython\u5b9a\u4e49\u4e86\u51e0\u4e2a\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u4ee5\u652f\u6301\u7b80\u5355\u7684\u7ebf\u7a0b\u540c\u6b65\uff0c\u6587\u4ef6\u6216\u5176\u4ed6\u5bf9\u8c61\u7684\u5feb\u901f\u5173\u95ed\uff0c\u4ee5\u53ca\u5bf9\u6d3b\u52a8\u5341\u8fdb\u5236\u7b97\u672f\u4e0a\u4e0b\u6587\u7684\u7b80\u5355\u64cd\u4f5c\u3002\u9664\u4e86 \u5b9e\u73b0\u4e0a\u4e0b\u6587\u7ba1\u7406\u534f\u8bae\u4e4b\u5916\uff0c\u7279\u5b9a\u7c7b\u578b\u4e0d\u4f1a\u88ab\u7279\u522b\u5904\u7406</p> <p>Python\u7684\u751f\u6210\u5668\u548ccontextlib.contextmanager\u88c5\u9970\u5668\u63d0\u4f9b\u4e86\u4e00\u79cd\u5b9e\u73b0\u8fd9\u4e9b\u534f\u8bae\u7684\u4fbf\u6377\u65b9\u5f0f\u3002\u5982\u679c\u4f7f\u7528contextlib.contextmanager\u88c5\u9970\u5668 \u4fee\u9970\u751f\u6210\u5668\u51fd\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u5b9e\u73b0\u5fc5\u8981__enter__()\u548c__exit__()\u65b9\u6cd5\u7684\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668\uff0c\u800c\u4e0d\u662f\u7531\u672a\u4fee\u9970\u7684\u751f\u6210\u5668\u51fd\u6570\u751f\u6210\u7684\u8fed\u4ee3\u5668</p> <p>\u8bf7\u6ce8\u610f\uff0cPython/C API\u4e2dPython\u5bf9\u8c61\u7684\u7c7b\u578b\u7ed3\u6784\u4e2d\u6ca1\u6709\u9488\u5bf9\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7279\u5b9a\u63d2\u69fd\u3002\u60f3\u8981\u5b9a\u4e49\u8fd9\u4e9b\u65b9\u6cd5\u7684\u6269\u5c55\u7c7b\u578b\u5fc5\u987b\u5c06\u5b83\u4eec\u4f5c\u4e3a\u666e\u901a\u7684 Python\u53ef\u8bbf\u95ee\u65b9\u6cd5\u63d0\u4f9b\u3002\u4e0e\u8bbe\u7f6e\u8fd0\u884c\u65f6\u4e0a\u4e0b\u6587\u7684\u5f00\u9500\u76f8\u6bd4\uff0c\u5355\u4e2a\u7c7b\u5b57\u5178\u67e5\u627e\u7684\u5f00\u9500\u53ef\u4ee5\u5ffd\u7565\u4e0d\u8ba1</p>"},{"location":"coding/Python3/#_18","title":"\u5faa\u73af","text":"Python<pre><code># python\u5faa\u73af\u8bed\u53e5\u6709for\u548cwhile,while\u4f7f\u7528\u4e0e\u63d0\u524d\u77e5\u9053\u6761\u4ef6\u7684\u60c5\u51b5\n# \u4f7f\u7528while\u5faa\u73af\u8ba1\u7b971-100\u548c\n\ncount = 1\nnum_sum = 0\n\nwhile count &lt;= 100:\n    num_sum += count\n    count += 1\nprint(\"1~100\u548c\u662f:\", num_sum)\n\n# for\u5faa\u73af\u53ef\u4ee5\u904d\u5386\u4efb\u4f55\u5e8f\u5217\u7684\u9879\u76ee\uff0c\u5982\u5217\u8868\u6216\u5b57\u7b26\u4e32,for\u5b9e\u4f8b\u4f7f\u7528break\u8bed\u53e5\uff0cbreak\u8bed\u53e5\u7528\u4e8e\u8df3\u51fa\u5f53\u524d\u5faa\u73af\u4f53\n# continue\u8bed\u53e5\u7ee7\u7eed\u5faa\u73af\u7684\u4e0b\u4e00\u4e2a\u8fed\u4ee3\n# pass\u8bed\u53e5\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002\u5f53\u5728\u8bed\u6cd5\u4e0a\u9700\u8981\u4e00\u6761\u8bed\u53e5\u4f46\u8be5\u7a0b\u5e8f\u4e0d\u9700\u8981\u4efb\u4f55\u64cd\u4f5c\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b83\n\nfoods = [\"apple\", \"beef\", \"fish\"]\nfor egg in foods:\n    if egg == \"beef\":\n        print(\"\u4e24\u4e2a\u4e0d\u540c\u7684\")\n        break   # \u6b64\u5904\u8df3\u51fa\u5faa\u73af\uff0c\u4e0b\u4e00\u53e5\u4e0d\u518d\u8f93\u51fa\n    print(\"\u597d\u5403\u7684\" + egg)\nelse:\n    print(\"\u6ca1\u6709beef\u4e86\")\nprint(\"\u7ed3\u675f\u9009\u9910\")\n\n# range\u53ef\u4ee5\u904d\u5386\u6570\u5b57\u5e8f\u5217\u6765\u81ea\u52a8\u751f\u6210\u6570\u5217\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u67d0\u4e00\u533a\u95f4\n# \u53ef\u4f7frange\u4ece\u6307\u5b9a\u6570\u5b57\u5f00\u59cb\u5e76\u6307\u5b9a\u589e\u91cf\u3002(\u53ef\u4ee5\u662f\u8d1f\u6570\uff0c\u6709\u65f6\u53eb\u505a\u6b65\u957f)\nfor i in range(1, 9, 2):  # \u4ece1\u52309\u6b65\u957f\u4e3a2\n    print(i)\n\n# \u7ed3\u5408range()\u548clen()\u51fd\u6570\u904d\u5386\u4e00\u4e2a\u5e8f\u5217\u7684\u7d22\u5f15\na = ['lee', 'bob', 'bruce']\nfor i in range(len(a)):\n    print(i, a[i])\n</code></pre>"},{"location":"coding/Python3/#_19","title":"\u5224\u65ad\u8bed\u53e5","text":"Markdown<pre><code># if\u8bed\u53e5\u57fa\u672c\u683c\u5f0f\nif condition_1:\n    statement_block_1\nelif condition_2:\n    statement_block_2\nelse:\n    statement_block_3\n\n\u6ce8\u610f\n1\u3001\u6bcf\u4e2a\u6761\u4ef6\u540e\u9762\u8981\u4f7f\u7528\u5192\u53f7\uff08:\uff09\uff0c\u8868\u793a\u63a5\u4e0b\u6765\u662f\u6ee1\u8db3\u6761\u4ef6\u540e\u8981\u6267\u884c\u7684\u8bed\u53e5\u5757\n3\u3001\u5728Python\u4e2d\u6ca1\u6709switch \u2013 case\u8bed\u53e5\n</code></pre> Python<pre><code># \u6f14\u793a\u731c\u6570\u5b57\n#!/usr/local/bin/python3\n# -*- coding: UTF-8 -*-\n\nnumber = 1\nguess = 0\nprint(\"\u731c\u6570\u5b57\")\nwhile guess != number:\n    guess = int(input(\"\u8f93\u5165\u8981\u731c\u7684\u6570\u5b57\uff1a\"))\n    if guess == number:\n        print(\"holly shit,\u4f60\u731c\u5bf9\u4e86!\")\n    elif guess &lt; number:\n        print(\"\u731c\u7684\u592a\u5c0f\u4e86\")\n    elif guess &gt; number:\n        print(\"\u731c\u7684\u592a\u5927\u4e86\")\n</code></pre>"},{"location":"coding/Python3/#_20","title":"\u51fd\u6570","text":""},{"location":"coding/Python3/#_21","title":"\u51fd\u6570\u7684\u53c2\u6570","text":""},{"location":"coding/Python3/#_22","title":"\u9ed8\u8ba4\u53c2\u6570","text":"<p>\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u6307\u5b9a\u9ed8\u8ba4\u503c\u3002\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u53ef\u4ee5\u4f7f\u7528\u6bd4\u5176\u5b9a\u4e49\u6240\u5141\u8bb8\u7684\u53c2\u6570\u66f4\u5c11\u7684\u53c2\u6570\u6765\u8c03\u7528</p> <p>\u65b0\u7684power(x, n)\u51fd\u6570\u5b9a\u4e49\u6ca1\u6709\u95ee\u9898\uff0c\u4f46\u662f\uff0c\u65e7\u7684\u8c03\u7528\u4ee3\u7801\u5931\u8d25\u4e86\uff0c\u539f\u56e0\u662f\u6211\u4eec\u589e\u52a0\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c \u5bfc\u81f4\u65e7\u7684\u4ee3\u7801\u56e0\u4e3a\u7f3a\u5c11\u4e00\u4e2a\u53c2\u6570\u800c\u65e0\u6cd5\u6b63\u5e38\u8c03\u7528\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u9ed8\u8ba4\u53c2\u6570</p> Python<pre><code>def power(x, n=2):\n    s = 1\n    while n &gt; 0:\n        n = n - 1\n        s = s * x\n    return s\n# \u6ce8\u610f\uff1a\u4e00\u662f\u5fc5\u9009\u53c2\u6570\u5728\u524d\uff0c\u9ed8\u8ba4\u53c2\u6570\u5728\u540e\uff0c\u5426\u5219Python\u7684\u89e3\u91ca\u5668\u4f1a\u62a5\u9519\u3002\u8bbe\u7f6e\u9ed8\u8ba4\u53c2\u6570\u6280\u5de7--\u5f53\u51fd\u6570\u6709\u591a\u4e2a\u53c2\u6570\u65f6\uff0c\u628a\u53d8\u5316\u5927\u7684\u53c2\u6570\u653e\n# \u524d\u9762\uff0c\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u653e\u540e\u9762\u3002\u53d8\u5316\u5c0f\u7684\u53c2\u6570\u5c31\u53ef\u4ee5\u4f5c\u4e3a\u9ed8\u8ba4\u53c2\u6570\n# \u5b9a\u4e49\u9ed8\u8ba4\u53c2\u6570\u8981\u7262\u8bb0\u4e00\u70b9\uff1a\u9ed8\u8ba4\u53c2\u6570\u5fc5\u987b\u6307\u5411\u4e0d\u53d8\u5bf9\u8c61,x\u662f\u5f62\u53c2\uff0c\u8c03\u7528power(3, n=2),3\u5c31\u662f\u5b9e\u53c2\n</code></pre>"},{"location":"coding/Python3/#_23","title":"\u4f4d\u7f6e\u53c2\u6570","text":"Python<pre><code>def power(x, n):   # x\u5c31\u662f\u4e00\u4e2a\u4f4d\u7f6e\u53c2\u6570\n    s = 1\n    while n &gt; 0:\n        n = n -1\n        s = s * x\n    return s\n</code></pre>"},{"location":"coding/Python3/#_24","title":"\u53ef\u53d8\u53c2\u6570","text":"Python<pre><code># \u53ef\u53d8\u53c2\u6570\u5c31\u662f\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\uff0c\u53ef\u4ee5\u662f0\u4e2a\u5230\u4efb\u610f\u4e2a\u4f8b\uff1a\u7ed9\u5b9a\u4e00\u7ec4\u6570\u5b57a\uff0cb\uff0cc\u2026\u2026\uff0c\u8bf7\u8ba1\u7b97a2 + b2 + c2 + \u2026\u2026\n# \u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570\ndef calc(numbers):\n    sum1 = 0\n    for n in numbers:\n        sum1 = sum1 + n * n\n    return sum1\n# \u5b9a\u4e49\u53ef\u53d8\u53c2\u6570\u548c\u5b9a\u4e49\u4e00\u4e2alist\u6216tuple\u53c2\u6570\u76f8\u6bd4\uff0c\u4ec5\u4ec5\u5728\u53c2\u6570\u524d\u9762\u52a0\u4e86\u4e00\u4e2a* \u53f7\u3002\u5728\u51fd\u6570\u5185\u90e8\uff0c\u53c2\u6570numbers\u63a5\u6536\u5230\u7684\u662f\u4e00\u4e2atuple\uff0c\u56e0\u6b64\n# \u51fd\u6570\u4ee3\u7801\u5b8c\u5168\u4e0d\u53d8\u3002\u4f46\u662f\uff0c\u8c03\u7528\u8be5\u51fd\u6570\u65f6\uff0c\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e2a\u53c2\u6570\uff0c\u5305\u62ec0\u4e2a\u53c2\u6570\u3002Python\u5141\u8bb8\u4f60\u5728list\u6216tuple\u524d\u9762\u52a0\u4e00\u4e2a*\u53f7\uff0c\u628alist\u6216\n# tuple\u7684\u5143\u7d20\u53d8\u6210\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb\u3002*numbers\u8868\u793a\u628anumbers\u8fd9\u4e2alist\u6216tuple\u7684\u6240\u6709\u5143\u7d20\u4f5c\u4e3a\u53ef\u53d8\u53c2\u6570\u4f20\u8fdb\u53bb\ndef calc2(*numbers):\n    sum2 = 0\n    for n in numbers:\n        sum2 = sum2 + n * n\n    return sum2\n</code></pre>"},{"location":"coding/Python3/#kwargvalue","title":"\u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u4e5f\u53ef\u4ee5\u4f7f\u7528kwarg=value\u7684\u5173\u952e\u5b57\u53c2\u6570\u5f62\u5f0f\u88ab\u8c03\u7528","text":"<p>\u53ef\u53d8\u53c2\u6570\u5217\u8868\uff1a\u4e00\u4e2a\u6700\u4e0d\u5e38\u7528\u7684\u9009\u62e9\u662f\u53ef\u4ee5\u8ba9\u51fd\u6570\u8c03\u7528\u53ef\u53d8\u4e2a\u6570\u7684\u53c2\u6570.\u8fd9\u4e9b\u53c2\u6570\u88ab\u5305\u88c5\u8fdb\u4e00\u4e2a\u5143\u7ec4tuple(\u67e5\u770b\u5143\u7ec4\u548c\u5e8f\u5217).\u5728\u8fd9\u4e9b\u53ef \u53d8\u4e2a\u6570\u7684\u53c2\u6570\u4e4b\u524d,\u53ef\u4ee5\u6709\u96f6\u5230\u591a\u4e2a\u542b\u53c2\u6570\u540d\u7684\u53c2\u6570:</p> <p>\u5728\u51fd\u6570\u8c03\u7528\u4e2d\uff0c\u5173\u952e\u5b57\u53c2\u6570\u5fc5\u987b\u4f4d\u4e8e\u4f4d\u7f6e\u53c2\u6570\u4e4b\u540e,\u4f20\u9012\u7684\u6240\u6709\u5173\u952e\u5b57\u53c2\u6570\u90fd\u5fc5\u987b\u4e0e\u51fd\u6570\u63a5\u53d7\u7684\u53c2\u6570\u4e4b\u4e00\u5339\u914d,\u5e76\u4e14\u5b83\u4eec\u7684\u987a\u5e8f\u5e76\u4e0d\u91cd\u8981</p> Python<pre><code>def arithmetic_mean(*args):\n    sum1 = 0\n    for x in args:\n        sum1 += x\n    return sum1\n\nprint(arithmetic_mean(45,32,89,78))\nprint(arithmetic_mean(8989.8,78787.78,3453,78778.73))\nprint(arithmetic_mean(45,32))\nprint(arithmetic_mean(45))\nprint(arithmetic_mean())\n\n# \u5173\u952e\u5b57\u53c2\u6570\u6709\u4ec0\u4e48\u7528\uff1f\u5b83\u53ef\u4ee5\u6269\u5c55\u51fd\u6570\u7684\u529f\u80fd\u3002\u6bd4\u5982\uff0c\u5728person\u51fd\u6570\u91cc\uff0c\u6211\u4eec\u4fdd\u8bc1\u80fd\u63a5\u6536\u5230name\u548cage\u8fd9\u4e24\u4e2a\u53c2\u6570\uff0c\u4f46\u662f\uff0c\u5982\u679c\u8c03\u7528\u8005\n# \u613f\u610f\u63d0\u4f9b\u66f4\u591a\u7684\u53c2\u6570\uff0c\u6211\u4eec\u4e5f\u80fd\u6536\u5230\u3002\u8bd5\u60f3\u4f60\u6b63\u5728\u505a\u4e00\u4e2a\u7528\u6237\u6ce8\u518c\u7684\u529f\u80fd\uff0c\u9664\u4e86\u7528\u6237\u540d\u548c\u5e74\u9f84\u662f\u5fc5\u586b\u9879\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u53ef\u9009\u9879\uff0c\u5229\u7528\u5173\u952e\u5b57\n# \u53c2\u6570\u6765\u5b9a\u4e49\u8fd9\u4e2a\u51fd\u6570\u5c31\u80fd\u6ee1\u8db3\u6ce8\u518c\u7684\u9700\u6c42\n</code></pre>"},{"location":"coding/Python3/#_25","title":"\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570","text":"Python<pre><code># \u5bf9\u4e8e\u5173\u952e\u5b57\u53c2\u6570\uff0c\u51fd\u6570\u7684\u8c03\u7528\u8005\u53ef\u4ee5\u4f20\u5165\u4efb\u610f\u4e0d\u53d7\u9650\u5236\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u81f3\u4e8e\u5230\u5e95\u4f20\u5165\u4e86\u54ea\u4e9b\uff0c\u5c31\u9700\u8981\u5728\u51fd\u6570\u5185\u90e8\u901a\u8fc7kw\u68c0\u67e5\n\n# \u4ee5person()\u51fd\u6570\u4e3a\u4f8b\uff0c\u6211\u4eec\u5e0c\u671b\u68c0\u67e5\u662f\u5426\u6709city\u548cjob\u53c2\u6570\ndef person(name, age, **kw):\n    if 'city' in kw:\n        # \u6709city\u53c2\u6570\n        pass\n    if 'job' in kw:\n        # \u6709job\u53c2\u6570\n        pass\n    print('name:', name, 'age:', age, 'other:', kw)\n\n# \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u5fc5\u987b\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8fd9\u548c\u4f4d\u7f6e\u53c2\u6570\u4e0d\u540c\u3002\u5982\u679c\u6ca1\u6709\u4f20\u5165\u53c2\u6570\u540d\uff0c\u8c03\u7528\u5c06\u62a5\u9519\n# \u4f7f\u7528\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u53d8\u53c2\u6570\uff0c\u5c31\u5fc5\u987b\u52a0\u4e00\u4e2a*\u4f5c\u4e3a\u7279\u6b8a\u5206\u9694\u7b26\u3002\u5982\u679c\u7f3a\u5c11*\uff0cPython\u89e3\u91ca\u5668\u5c06\u65e0\u6cd5\u8bc6\u522b\u4f4d\u7f6e\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff1a\ndef person(name, age, city, job):\n    # \u7f3a\u5c11 *\uff0ccity\u548cjob\u88ab\u89c6\u4e3a\u4f4d\u7f6e\u53c2\u6570\n    pass\n</code></pre>"},{"location":"coding/Python3/#_26","title":"\u53c2\u6570\u7ec4\u5408","text":"Python<pre><code># Python\u4e2d\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u5173\u952e\u5b57\u53c2\u6570\u548c\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\uff0c\u8fd95\u79cd\u53c2\u6570\u90fd\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\n# \u53c2\u6570\u5b9a\u4e49\u7684\u987a\u5e8f\u5fc5\u987b\u662f\uff1a\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570\u3001\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u5173\u952e\u5b57\u53c2\u6570\n# \u5982\u679c\u51fd\u6570\u63a5\u53d7\u4e0d\u540c\u7c7b\u578b\u7684\u5b9e\u53c2\uff0c\u5fc5\u987b\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u5c06\u63a5\u7eb3\u4efb\u610f\u6570\u91cf\u5b9e\u53c2\u7684\u5f62\u53c2\u653e\u5728\u6700\u540e\n\n# \u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u5305\u542b\u4e0a\u8ff0\u82e5\u5e72\u79cd\u53c2\u6570\uff1a\u5728\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cPython\u89e3\u91ca\u5668\u81ea\u52a8\u6309\u7167\u53c2\u6570\u4f4d\u7f6e\u548c\u53c2\u6570\u540d\u628a\u5bf9\u5e94\u7684\u53c2\u6570\u4f20\u8fdb\u53bb\ndef f1(a, b, c=0, *args, **kw):\n    print('a =', a, 'b =', b, 'c =', c, 'args =', args, 'kw =', kw)\n\ndef f2(a, b, c=0, *, d, **kw):\n    print('a =', a, 'b =', b, 'c =', c, 'd =', d, 'kw =', kw)\n\n# \u6240\u4ee5\uff0c\u5bf9\u4e8e\u4efb\u610f\u51fd\u6570\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3cfunc(*args, **kw)\u7684\u5f62\u5f0f\u8c03\u7528\u5b83\uff0c\u65e0\u8bba\u5b83\u7684\u53c2\u6570\u662f\u5982\u4f55\u5b9a\u4e49\u7684\n</code></pre>"},{"location":"coding/Python3/#_27","title":"\u6982\u62ec","text":"<p>python\u5b98\u65b9\u6307\u5bfc\u610f\u89c1\uff1a</p> <ul> <li>\u5982\u679c\u60a8\u4e0d\u5e0c\u671b\u7528\u6237\u4f7f\u7528\u53c2\u6570\u540d\u79f0\uff0c\u8bf7\u4f7f\u7528\u4ec5\u4f4d\u7f6e\u3002\u5f53\u53c2\u6570\u540d\u79f0\u6ca1\u6709\u5b9e\u9645\u542b\u4e49\u65f6\uff0c\u5982\u679c\u8981\u5728\u8c03\u7528\u51fd\u6570\u65f6\u5f3a\u5236\u6267\u884c\u53c2\u6570\u7684\u987a\u5e8f\uff0c \u6216\u8005\u9700\u8981\u4f7f\u7528\u4e00\u4e9b\u4f4d\u7f6e\u53c2\u6570\u548c\u4efb\u610f\u5173\u952e\u5b57\uff0c\u6b64\u529f\u80fd\u5c06\u975e\u5e38\u6709\u7528</li> <li>\u4ec5\u5f53\u540d\u79f0\u5177\u6709\u542b\u4e49\u4e14\u901a\u8fc7\u4f7f\u7528\u540d\u79f0\u663e\u5f0f\u4f7f\u51fd\u6570\u5b9a\u4e49\u66f4\u6613\u4e8e\u7406\u89e3\u65f6\uff0c\u6216\u8005\u8981\u9632\u6b62\u7528\u6237\u4f9d\u8d56\u4f20\u9012\u7684\u53c2\u6570\u7684\u4f4d\u7f6e\u65f6\uff0c\u624d\u5e94\u4f7f\u7528\u5173\u952e\u5b57</li> <li>\u5bf9\u4e8eAPI\uff0c\u5982\u679c\u5c06\u6765\u8981\u4fee\u6539\u53c2\u6570\u7684\u540d\u79f0\uff0c\u8bf7\u4ec5\u4f7f\u7528\u4f4d\u7f6e\u53c2\u6570\u4ee5\u9632\u6b62\u7834\u574fAPI\u66f4\u6539</li> </ul>"},{"location":"coding/Python3/#_28","title":"\u9012\u5f52\u51fd\u6570","text":"Python<pre><code>\"\"\"\n\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u5728\u5185\u90e8\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u9012\u5f52\u51fd\u6570.\u7406\u8bba\u4e0a\uff0c\u4efb\u4f55\u5faa\u73af\u90fd\u53ef\u4ee5\u8f6c\u6362\u4e3a\u9012\u5f52\uff0c\u4f7f\u7528\u9012\u5f52\u51fd\u6570\u9700\u8981\u6ce8\u610f\u9632\u6b62\u6808\u6ea2\u51fa\u3002\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u51fd\u6570\u8c03\u7528\u662f\u901a\u8fc7\u6808\uff08stack\uff09\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u5b9e\u73b0\u7684\uff0c\u6bcf\u5f53\u8fdb\u5165\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u6808\u5c31\u4f1a\u52a0\u4e00\u5c42\u6808\u5e27\uff0c\u6bcf\u5f53\u51fd\u6570\u8fd4\u56de\uff0c\u6808\u5c31\u4f1a\u51cf\u4e00\u5c42\u6808\u5e27\u3002\u7531\u4e8e\u6808\u7684\u5927\u5c0f\u4e0d\u662f\u65e0\u9650\u7684\uff0c\u6240\u4ee5\uff0c\u9012\u5f52\u8c03\u7528\u7684\u6b21\u6570\u8fc7\u591a\uff0c\u4f1a\u5bfc\u81f4\u6808\u6ea2\u51fa\n\u89e3\u51b3\u9012\u5f52\u8c03\u7528\u6808\u6ea2\u51fa\u7684\u65b9\u6cd5\u662f\u901a\u8fc7\u5c3e\u9012\u5f52\u4f18\u5316\uff0c\u4e8b\u5b9e\u4e0a\u5c3e\u9012\u5f52\u548c\u5faa\u73af\u7684\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\uff0c\u628a\u5faa\u73af\u770b\u6210\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c3e\u9012\u5f52\u51fd\u6570\u4e5f\u662f\u53ef\u4ee5\u7684\n\u5c3e\u9012\u5f52\u662f\u6307\uff0c\u5728\u51fd\u6570\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u8c03\u7528\u81ea\u8eab\u672c\u8eab\uff0c\u5e76\u4e14\uff0creturn\u8bed\u53e5\u4e0d\u80fd\u5305\u542b\u8868\u8fbe\u5f0f\u3002\u8fd9\u6837\uff0c\u7f16\u8bd1\u5668\u6216\u8005\u89e3\u91ca\u5668\u5c31\u53ef\u4ee5\u628a\u5c3e\u9012\u5f52\u505a\u4f18\u5316\uff0c\u4f7f\u9012\u5f52\u672c\u8eab\u65e0\u8bba\u8c03\u7528\u591a\u5c11\u6b21\uff0c\u90fd\u53ea\u5360\u7528\u4e00\u4e2a\u6808\u5e27\uff0c\u4e0d\u4f1a\u51fa\u73b0\u6808\u6ea2\u51fa\u7684\u60c5\u51b5\n\"\"\"\n\n# \u793a\u4f8b\u8ba1\u7b97\u9636\u4e58\u7684\u9012\u5f52\u51fd\u6570\n# \u6ce8\u610f\uff1apython\u9ed8\u8ba4\u53ea\u80fd\u8c03\u75281000\u6b21\uff0c\u56fan\u8981\u5c0f\u4e8e\u7b49\u4e8e997\nimport sys\nsys.setrecursionlimit(2000)     # \u8bbe\u7f6e\u9012\u5f52\u8c03\u7528\u6b21\u6570\u4e3a2000\n\n\ndef fact(n):\n    if n == 0:\n        return 1\n    else:\n        return n * fact(n-1)\n\n\nprint(fact(1000))\n</code></pre>"},{"location":"coding/Python3/#_29","title":"\u89e3\u538b\u7f29\u53c2\u6570\u5217\u8868","text":"<p>\u5f53\u53c2\u6570\u5df2\u7ecf\u5728\u5217\u8868\u6216\u5143\u7ec4\u4e2d\uff0c\u4f46\u9700\u8981\u4e3a\u5355\u72ec\u7684\u4f4d\u7f6e\u53c2\u6570\u7684\u51fd\u6570\u8c03\u7528\u62c6\u5305\u65f6\uff0c\u5219\u60c5\u51b5\u76f8\u53cd\u3002 \u4f7f\u7528*-operator\u7f16\u5199\u51fd\u6570\u8c03\u7528\uff0c\u4ee5\u5c06\u53c2\u6570\u4ece\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u89e3\u5305\u3002\u800c\u5b57\u5178\u53ef\u4ee5\u4ee5\u76f8\u540c\u65b9\u5f0f**-operator\u4f20\u9012\u5173\u952e\u5b57\u53c2\u6570</p> Python<pre><code>\"\"\"\npython\u4e2d*\u548c**\u542b\u4e49:\n\u5f53\u5176\u5728\u51fd\u6570\u5934\u5185(function header)\u65f6\n*   \u6536\u96c6\u5143\u7ec4\u4e2d\u7684\u6240\u6709\u4f4d\u7f6e\u53c2\u6570\n**  \u6536\u96c6\u5b57\u5178\u4e2d\u7684\u6240\u6709\u5173\u952e\u5b57\u53c2\u6570\n\"\"\"\ndef function_1(*a, **kw):\n    print(a, kw)\nfunction_1(1, 2, 3, x=1, y=2, z=3) # \u4f20\u53c2\u7ed9\u51fd\u6570function_1\uff0c\u8fd4\u56de\u503c\u4e3a(1, 2, 3) {'x': 1, 'y': 2, 'z': 3}\n\n\"\"\"\n\u5f53\u5176\u5728\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\u4e2d\n\u5f53\u53c2\u6570\u5df2\u7ecf\u5728\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u4f46\u9700\u8981\u4e3a\u9700\u8981\u5355\u72ec\u4f4d\u7f6e\u53c2\u6570\u7684\u51fd\u6570\u8c03\u7528\u89e3\u5305\u65f6,\u4e0e*\u8fd0\u7b97\u7b26\u4e00\u8d77\u7f16\u5199\u51fd\u6570\u8c03\u7528\u4ee5\u4ece\u5217\u8868\u6216\u5143\u7ec4\u4e2d\u89e3\u538b\u7f29\u53c2\u6570\n*   \u5c06\u5217\u8868\u6216\u5143\u7ec4\u89e3\u5305\u5230\u4f4d\u7f6e\u53c2\u6570\u4e2d\uff0c\u5373\u5c06\u53ef\u8fed\u4ee3\u53d8\u91cf\u4e2d\u7684\u5143\u7d20\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570(\u4ec5\u5f53\u53c2\u6570\u6570\u91cf\u4e0e\u53ef\u8fed\u4ee3\u53d8\u91cf\u4e2d\u7684\u5143\u7d20\u6570\u91cf\u76f8\u540c\u65f6\uff0c\u6b64\u65b9\u6cd5\u624d\u6709\u6548)\n**  \u5c06\u5b57\u5178\u89e3\u538b\u7f29\u4e3a\u5173\u952e\u5b57\u53c2\u6570\uff0c\u5141\u8bb8\u4f20\u9012\u53ef\u53d8\u6570\u91cf\u7684\u5173\u952e\u5b57\u53c2\u6570\u7ed9\u51fd\u6570(\u51fd\u6570\u4e2d\u7684\u53c2\u6570\u540d\u79f0\u5fc5\u987b\u4e0e\u5b57\u5178\u4e2d\u7684\u952e\u540d\u79f0\u5339\u914d\uff1b\u53c2\u6570\u6570\u91cf\u5e94\u4e0e\u5b57\u5178\u4e2d\u7684\u952e\u6570\u76f8\u540c)\n\"\"\"\nlist1 = [1, 2, 3]\ndic = {'x': 1, 'y': 2, 'z': 3}\nfunction_1(*list1, **dic)\n</code></pre>"},{"location":"coding/Python3/#lambda","title":"Lambda\u8868\u8fbe\u5f0f","text":"<p>\u53ef\u4ee5\u4f7f\u7528lambda\u5173\u952e\u5b57\u521b\u5efa\u5c0f\u7684\u533f\u540d\u51fd\u6570\u3002\u6b64\u51fd\u6570\u8fd4\u56de\u5176\u4e24\u4e2a\u53c2\u6570\u7684\u603b\u548c\uff1a\u3002Lambda\u51fd\u6570\u53ef\u4ee5\u5728\u9700\u8981\u51fd\u6570\u5bf9\u8c61\u7684\u4efb\u4f55\u5730\u65b9\u4f7f\u7528\u3002 \u5b83\u4eec\u5728\u8bed\u6cd5\u4e0a\u9650\u4e8e\u5355\u4e2a\u8868\u8fbe\u5f0f,\u4e0d\u80fd\u5305\u542b\u591a\u4e2a\u8868\u8fbe\u5f0f\u3002\u4ece\u8bed\u4e49\u4e0a\u8bb2\uff0c\u5b83\u4eec\u53ea\u662f\u6b63\u5e38\u51fd\u6570\u5b9a\u4e49\u7684\u8bed\u6cd5\u7cd6\u3002\u4e0e\u5d4c\u5957\u51fd\u6570\u5b9a\u4e49\u4e00\u6837\uff0c lambda\u51fd\u6570\u53ef\u4ee5\u5f15\u7528\u5305\u542b\u8303\u56f4\u7684\u53d8\u91cf\uff1alambda a, b: a+b</p> Python<pre><code># \u7528\u9014\u4e00\uff1a\u4f7f\u7528lambda\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\ndef make_incrementor(n):\n    return lambda x: x + n\n\n# \u7528\u9014\u4e8c\uff1a\u4f20\u9012\u4e00\u4e2a\u5c0f\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\npairs = [(1, 'one'), (2, 'two'), (3, 'three'), (4, 'four')]\npairs.sort(key=lambda pair: pair[1])\nprint(pairs)\n\n# \u5c3d\u91cf\u4f7f\u7528\u5217\u8868\u63a8\u5bfc, for\u5faa\u73af\u53d6\u4ee3filter(), map()\u4ee5\u53careduce()\n# \u5c06\u5217\u8868\u6240\u6709\u5143\u7d20\u4f20\u9012\u7ed9\u51fd\u6570\u5e76\u8f93\u51fa\n# map\u51fd\u6570\u548clambda\nnum = [1, 2]\nsquare = list(map(lambda x: x**2, num)) # \u5c06num\u5217\u8868\u6bcf\u4e2a\u5143\u7d20\u6c42\u5176\u5e73\u65b9\u540e\u7ec4\u6210\u4e00\u4e2a\u65b0\u7684\u5217\u8868\n\n# filter\u51fd\u6570\u548clambda\nnum = range(0, 10)\nlist_range = list(filter(lambda x: x &gt; 5, num)) # filter\u51fd\u6570\u8fc7\u6ee4\u5e76\u8fd4\u56de\u7b26\u5408\u6761\u4ef6\u7684\u5143\u7d20\u7ec4\u6210\u7684\u8fed\u4ee3\u5668\n\n# reduce\u51fd\u6570\u548clambda\n# \u5229\u7528reduce\u6c42\u5217\u8868\u5143\u7d20\u4e58\u79ef\uff0c\u4e5f\u53ef\u4f7f\u7528\u5faa\u73af\u6765\u5904\u7406\nfrom functools import reduce\ndata_list = [2, 4, 5]\nresult = reduce(lambda x, y: x * y, data_list)\n</code></pre>"},{"location":"coding/Python3/#map","title":"map\u51fd\u6570","text":"Python<pre><code># map\u51fd\u6570\u4f7f\u7528\u4e00\u4e2a\u51fd\u6570\u548c\u4e00\u4e2a\u8fed\u4ee3\u5668\u4f5c\u4e3a\u8f93\u5165\uff0c\u7136\u540e\u5c06\u8be5\u51fd\u6570\u5e94\u7528\u4e0e\u8fed\u4ee3\u5668\u7684\u6bcf\u4e2a\u503c\u5e76\u8fd4\u56de\u7ed3\u679c\u5217\u8868\nlist5 = [1, 2, 3, 4, 5]\ndef square(num):\n    return num ** 2\n\nprint(list(map(square, list5)))\n</code></pre>"},{"location":"coding/Python3/#_30","title":"\u9762\u5411\u5bf9\u8c61","text":""},{"location":"coding/Python3/#class","title":"\u7c7b(Class)","text":"<p>\u7c7b\u63d0\u4f9b\u4e86\u4e00\u79cd\u5c06\u6570\u636e\u548c\u529f\u80fd\u6346\u7ed1\u5728\u4e00\u8d77\u7684\u65b9\u6cd5\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7c7b\u5c06\u521b\u5efa\u4e00\u79cd\u65b0\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u4ece\u800c\u5141\u8bb8\u521b\u5efa\u8be5\u7c7b\u578b\u7684\u65b0\u5b9e\u4f8b\u3002\u6bcf\u4e2a\u7c7b\u5b9e\u4f8b\u53ef\u4ee5\u5177\u6709\u9644\u52a0\u7684\u5c5e\u6027 \u4ee5\u7ef4\u62a4\u5176\u72b6\u6001\u3002\u7c7b\u5b9e\u4f8b\u8fd8\u53ef\u4ee5\u5177\u6709\u7528\u4e8e\u4fee\u6539\u5176\u72b6\u6001\u7684\u65b9\u6cd5\uff08\u7531\u5176\u7c7b\u5b9a\u4e49\uff09\uff0c\u7ee7\u627f\u673a\u5236\u5141\u8bb8\u591a\u4e2a\u57fa\u7c7b\uff0c\u6d3e\u751f\u7c7b\u53ef\u4ee5\u8986\u76d6\u5176\u4e00\u4e2a\u6216\u591a\u4e2a\u57fa\u7c7b\u7684\u4efb\u4f55\u65b9\u6cd5\uff0c \u4e00\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u8c03\u7528\u5177\u6709\u76f8\u540c\u540d\u79f0\u7684\u57fa\u7c7b\u7684\u65b9\u6cd5\u3002\u5bf9\u8c61\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u6570\u91cf\u548c\u79cd\u7c7b\u7684\u6570\u636e\u3002\u5c31\u50cf\u6a21\u5757\u4e00\u6837\uff0c\u7c7b\u5177\u6709Python\u7684\u52a8\u6001\u7279\u6027\uff1a\u5b83\u4eec\u5728\u8fd0\u884c\u65f6\u521b\u5efa\uff0c \u5e76\u4e14\u53ef\u4ee5\u5728\u521b\u5efa\u540e\u8fdb\u884c\u8fdb\u4e00\u6b65\u4fee\u6539</p>"},{"location":"coding/Python3/#_31","title":"\u7c7b\u5bf9\u8c61","text":"Markdown<pre><code>\u7c7b\u5bf9\u8c61\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\u5c5e\u6027\u5f15\u7528\u548c\u5b9e\u4f8b\u5316\n\u5c5e\u6027\u5f15\u7528\u4f7f\u7528Python\u4e2d\u6240\u6709\u5c5e\u6027\u5f15\u7528\u4f7f\u7528\u7684\u6807\u51c6\u8bed\u6cd5obj.name\u3002\u6709\u6548\u5c5e\u6027\u540d\u79f0\u662f\u521b\u5efa\u7c7b\u5bf9\u8c61\u65f6\u5728\u7c7b\u540d\u79f0\u7a7a\u95f4\u4e2d\u7684\u6240\u6709\u540d\u79f0\uff0c\u793a\u4f8b\uff1a\nclass MyClass:\n    \"\"\"A simple example class\"\"\"\n    i = 12345\n\n    def f(self):\n        return 'hello world'\n\nMyClass.i\u548cMyClass.f\u662f\u6709\u6548\u7684\u5c5e\u6027\u5f15\u7528\uff0c\u5206\u522b\u8fd4\u56de\u6574\u6570\u548c\u51fd\u6570\u5bf9\u8c61\u3002\u7c7b\u5c5e\u6027\u4e5f\u53ef\u4ee5\u5206\u914d\u7ed9\u5b83\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5MyClass.i\u901a\u8fc7\u8d4b\u503c\u6765\u66f4\u6539\u5176\u503c\u3002\n__doc__\u4e5f\u662f\u6709\u6548\u7684\u5c5e\u6027\uff0c\u8fd4\u56de\u5c5e\u4e8e\u7c7b\u7684\u6587\u6863\u5b57\u7b26\u4e32\u3002\"A simple example class\"\n\n\u7c7b\u5b9e\u4f8b\u5316\u4f7f\u7528\u51fd\u6570\u8868\u793a\u6cd5\u3002\u53ea\u662f\u5047\u88c5\u7c7b\u5bf9\u8c61\u662f\u4e00\u4e2a\u65e0\u53c2\u6570\u51fd\u6570\uff0c\u5b83\u5c06\u8fd4\u56de\u8be5\u7c7b\u7684\u65b0\u5b9e\u4f8b\nx = MyClass()   # \u521b\u5efa\u7c7b\u7684\u65b0\u5b9e\u4f8b\u5e76\u5c06\u8be5\u5bf9\u8c61\u5206\u914d\u7ed9\u5c40\u90e8\u53d8\u91cfx\n</code></pre>"},{"location":"coding/Python3/#_32","title":"\u5b9e\u4f8b\u5bf9\u8c61","text":"Markdown<pre><code>\u5b9e\u4f8b\u5bf9\u8c61\u53ea\u80fd\u7406\u89e3\u7684\u64cd\u4f5c\u662f\u5c5e\u6027\u5f15\u7528\u3002\u6709\u6548\u5c5e\u6027\u540d\u79f0\u6709\u4e24\u79cd\uff0c\u6570\u636e\u5c5e\u6027\u548c\u65b9\u6cd5\n\u6570\u636e\u5c5e\u6027\u65e0\u9700\u58f0\u660e\uff1b\u50cf\u5c40\u90e8\u53d8\u91cf\u4e00\u6837\uff0c\u5b83\u4eec\u5728\u9996\u6b21\u5206\u914d\u65f6\u5c31\u5b58\u5728\n\u53e6\u4e00\u79cd\u5b9e\u4f8b\u5c5e\u6027\u5f15\u7528\u662f\u4e00\u79cd\u65b9\u6cd5\u3002\u65b9\u6cd5\u662f\u201c\u5c5e\u4e8e\u201d\u5bf9\u8c61\u7684\u529f\u80fd\n\u5b9e\u4f8b\u5bf9\u8c61\u7684\u6709\u6548\u65b9\u6cd5\u540d\u79f0\u53d6\u51b3\u4e8e\u5176\u7c7b\u3002\u6839\u636e\u5b9a\u4e49\uff0c\u4f5c\u4e3a\u51fd\u6570\u5bf9\u8c61\u7684\u7c7b\u7684\u6240\u6709\u5c5e\u6027\u90fd\u5b9a\u4e49\u4e86\u5176\u5b9e\u4f8b\u7684\u76f8\u5e94\u65b9\u6cd5\u3002\n\u56e0\u6b64\uff0c\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0cx.f\u662f\u4e00\u4e2a\u6709\u6548\u7684\u65b9\u6cd5\u5f15\u7528\uff0c\u56e0\u4e3aMyClass.f\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4f46\u662fx.i\u4e0d\u662f\uff0c\u56e0\u4e3a MyClass.i\u4e0d\u662f\u3002\n\u4f46\u8fd9x.f\u4e0e\u65b9\u6cd5\u4e0d\u540c\uff0cMyClass.f\u5b83\u662f\u65b9\u6cd5\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u51fd\u6570\u5bf9\u8c61\n</code></pre>"},{"location":"coding/Python3/#_33","title":"\u65b9\u6cd5\u5bf9\u8c61","text":"Markdown<pre><code>\u901a\u5e38\u65b9\u6cd5\u5728\u7ed1\u5b9a\u4e4b\u540e\u7acb\u5373\u88ab\u8c03\u7528\n\u4f8b\u5982\uff1ax.f()\n\u5728MyClass\u793a\u4f8b\u4e2d\uff0c\u8fd9\u5c06\u8fd4\u56de\u5b57\u7b26\u4e32\u3002\u4f46\u662f\uff0c\u4e0d\u5fc5\u7acb\u5373\u8c03\u7528\u65b9\u6cd5\uff1a\u65b9\u6cd5\u662f\u4e00\u4e2a\u65b9\u6cd5\u5bf9\u8c61\uff0c\u53ef\u4ee5\u7acb\u5373\u5b58\u50a8\u5e76\u5728\u4ee5\u540e\u8c03\u7528\u3002\u5982\u4e0b\u793a\u4f8b\uff1a\nxf = x.f\nwhile True:\n    print(xf()) # \u5c06\u7ee7\u7eed\u6253\u5370\u76f4\u5230\u65f6\u95f4\u7ed3\u675f\n\n\u65b9\u6cd5\u7684\u7279\u6b8a\u4e4b\u5904\u5728\u4e8e\u5b9e\u4f8b\u5bf9\u8c61\u4f5c\u4e3a\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u3002\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u8be5\u8c03\u7528x.f()\u4e0e\u5b8c\u5168\u7b49\u6548MyClass.f(x)\u3002\u901a\u5e38\uff0c\n\u8c03\u7528\u5177\u6709n\u4e2a\u53c2\u6570\u5217\u8868\u7684\u65b9\u6cd5\u7b49\u6548\u4e8e\u8c03\u7528\u5e26\u6709\u53c2\u6570\u5217\u8868\u7684\u51fd\u6570\uff0c\u8be5\u53c2\u6570\u5217\u8868\u662f\u901a\u8fc7\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e4b\u524d\u63d2\u5165\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61\u800c\u521b\u5efa\u7684\u3002\n\n\u5982\u679c\u60a8\u4ecd\u7136\u4e0d\u4e86\u89e3\u65b9\u6cd5\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u90a3\u4e48\u770b\u4e00\u4e0b\u5b9e\u73b0\u4e5f\u8bb8\u53ef\u4ee5\u6f84\u6e05\u95ee\u9898\u3002\u5f53\u5f15\u7528\u5b9e\u4f8b\u7684\u975e\u6570\u636e\u5c5e\u6027\u65f6\uff0c\u5c06\u641c\u7d22\u5b9e\u4f8b\u7684\u7c7b\u3002\n\u5982\u679c\u540d\u79f0\u8868\u793a\u4f5c\u4e3a\u51fd\u6570\u5bf9\u8c61\u7684\u6709\u6548\u7c7b\u5c5e\u6027\uff0c\u5219\u901a\u8fc7\u5c06\u5b9e\u4f8b\u5bf9\u8c61\u548c\u521a\u5728\u62bd\u8c61\u5bf9\u8c61\u4e2d\u4e00\u8d77\u627e\u5230\u7684\u51fd\u6570\u5bf9\u8c61\u6253\u5305\uff08\u6307\u5411\uff09\u6765\u521b\u5efa\u65b9\u6cd5\u5bf9\u8c61\uff1a\u8fd9\u662f\u65b9\u6cd5\u5bf9\u8c61\u3002\n\u5f53\u4f7f\u7528\u5b9e\u53c2\u5217\u8868\u8c03\u7528\u65b9\u6cd5\u5bf9\u8c61\u65f6\uff0c\u5c06\u4ece\u5b9e\u4f8b\u5bf9\u8c61\u548c\u5b9e\u53c2\u5217\u8868\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u5b9e\u53c2\u5217\u8868\uff0c\u5e76\u4f7f\u7528\u8be5\u65b0\u7684\u5b9e\u53c2\u5217\u8868\u6765\u8c03\u7528\u51fd\u6570\u5bf9\u8c61\n</code></pre>"},{"location":"coding/Python3/#_34","title":"\u7c7b\u548c\u5b9e\u4f8b\u53d8\u91cf","text":"Markdown<pre><code>\u4e00\u822c\u6765\u8bf4\uff0c\u5b9e\u4f8b\u53d8\u91cf\u7528\u4e8e\u6bcf\u4e2a\u5b9e\u4f8b\u552f\u4e00\u7684\u6570\u636e\uff0c\u7c7b\u53d8\u91cf\u7528\u4e8e\u7c7b\u7684\u6240\u6709\u5b9e\u4f8b\u5171\u4eab\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\n\n\u5176\u4ed6\u5907\u6ce8\uff1a\n\u5982\u679c\u5728\u5b9e\u4f8b\u548c\u7c7b\u4e2d\u90fd\u51fa\u73b0\u76f8\u540c\u7684\u5c5e\u6027\u540d\u79f0\uff0c\u5219\u5c5e\u6027\u67e5\u627e\u5c06\u4f18\u5148\u8003\u8651\u8be5\u5b9e\u4f8b\n\n\u6570\u636e\u5c5e\u6027\u53ef\u4ee5\u7531\u5bf9\u8c61\u7684\u65b9\u6cd5\u4ee5\u53ca\u666e\u901a\u7528\u6237\uff08\u201c\u5ba2\u6237\u7aef\u201d\uff09\u5f15\u7528\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u7c7b\u4e0d\u80fd\u7528\u4e8e\u5b9e\u73b0\u7eaf\u62bd\u8c61\u6570\u636e\u7c7b\u578b\u3002\u5b9e\u9645\u4e0a\uff0cPython\u4e2d\u6ca1\u6709\u4efb\u4f55\u4e1c\u897f\u53ef\u4ee5\u5f3a\u5236\u6267\u884c\n\u6570\u636e\u9690\u85cf-\u5b83\u4eec\u5168\u90fd\u57fa\u4e8e\u7ea6\u5b9a\u3002\uff08\u53e6\u4e00\u65b9\u9762\uff0c\u7528C\u7f16\u5199\u7684Python\u5b9e\u73b0\u53ef\u4ee5\u5b8c\u5168\u9690\u85cf\u5b9e\u73b0\u7ec6\u8282\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u63a7\u5236\u5bf9\u5bf9\u8c61\u7684\u8bbf\u95ee\uff1b\u8fd9\u53ef\u4ee5\u7531C\u7f16\u5199\u7684Python\u6269\u5c55\u4f7f\u7528\n\n\u5ba2\u6237\u5e94\u8c28\u614e\u4f7f\u7528\u6570\u636e\u5c5e\u6027-\u5ba2\u6237\u53ef\u80fd\u4f1a\u5728\u6570\u636e\u5c5e\u6027\u4e0a\u52a0\u76d6\u6233\u8bb0\uff0c\u4ece\u800c\u5f04\u4e71\u4e86\u65b9\u6cd5\u7ef4\u62a4\u7684\u4e0d\u53d8\u6027\u3002\u8bf7\u6ce8\u610f\uff0c\u53ea\u8981\u907f\u514d\u540d\u79f0\u51b2\u7a81\uff0c\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u5c06\u81ea\u5df1\u7684\u6570\u636e\u5c5e\u6027\n\u6dfb\u52a0\u5230\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u65b9\u6cd5\u7684\u6709\u6548\u6027-\u518d\u6b21\uff0c\u547d\u540d\u7ea6\u5b9a\u53ef\u4ee5\u5728\u8fd9\u91cc\u8282\u7701\u5f88\u591a\u9ebb\u70e6\u3002\n\n\u6ca1\u6709\u4ece\u65b9\u6cd5\u5185\u90e8\u5f15\u7528\u6570\u636e\u5c5e\u6027\uff08\u6216\u5176\u4ed6\u65b9\u6cd5\uff01\uff09\u7684\u6377\u5f84\u3002\u6211\u53d1\u73b0\u8fd9\u5b9e\u9645\u4e0a\u63d0\u9ad8\u4e86\u65b9\u6cd5\u7684\u53ef\u8bfb\u6027\uff1a\u6d4f\u89c8\u65b9\u6cd5\u65f6\uff0c\u4e0d\u4f1a\u6df7\u6dc6\u5c40\u90e8\u53d8\u91cf\u548c\u5b9e\u4f8b\u53d8\u91cf\n\n\u901a\u5e38\uff0c\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u79f0\u4e3aself\u3002\u8fd9\u53ea\u4e0d\u8fc7\u662f\u4e00\u4e2a\u7ea6\u5b9a\uff1a\u8be5\u540d\u79f0self\u5bf9Python\u7edd\u5bf9\u6ca1\u6709\u7279\u6b8a\u542b\u4e49\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u4e0d\u9075\u5faa\u8be5\u7ea6\u5b9a\uff0c\u60a8\u7684\u4ee3\u7801\u5bf9\u4e8e\u5176\u4ed6\nPython\u7a0b\u5e8f\u5458\u6765\u8bf4\u53ef\u80fd\u5c31\u4e0d\u592a\u53ef\u8bfb\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u60f3\u5230\u53ef\u80fd\u4f1a\u7f16\u5199\u4f9d\u8d56\u4e8e\u8fd9\u79cd\u7ea6\u5b9a\u7684 \u7c7b\u6d4f\u89c8\u5668\u7a0b\u5e8f\u3002\n\n\u4efb\u4f55\u4f5c\u4e3a\u7c7b\u5c5e\u6027\u7684\u51fd\u6570\u5bf9\u8c61\u90fd\u4e3a\u8be5\u7c7b\u7684\u5b9e\u4f8b\u5b9a\u4e49\u65b9\u6cd5\u3002\u4e0d\u5fc5\u5728\u6587\u672c\u4e0a\u5c06\u51fd\u6570\u5b9a\u4e49\u5305\u542b\u5728\u7c7b\u5b9a\u4e49\u4e2d\uff1a\u5c06\u51fd\u6570\u5bf9\u8c61\u5206\u914d\u7ed9\u7c7b\u4e2d\u7684\u5c40\u90e8\u53d8\u91cf\u4e5f\u662f\u53ef\u4ee5\u7684\n\n\u65b9\u6cd5\u53ef\u4ee5\u4ee5\u4e0e\u666e\u901a\u51fd\u6570\u76f8\u540c\u7684\u65b9\u5f0f\u5f15\u7528\u5168\u5c40\u540d\u79f0\u3002\u4e0e\u65b9\u6cd5\u5173\u8054\u7684\u5168\u5c40\u8303\u56f4\u662f\u5305\u542b\u5176\u5b9a\u4e49\u7684\u6a21\u5757\u3002\uff08\u6c38\u8fdc\u4e0d\u8981\u5c06\u7c7b\u7528\u4f5c\u5168\u5c40\u8303\u56f4\u3002\uff09\u867d\u7136\u5f88\u5c11\u6709\u4eba\u9047\u5230\u5728\n\u65b9\u6cd5\u4e2d\u4f7f\u7528\u5168\u5c40\u6570\u636e\u7684\u5145\u5206\u7406\u7531\uff0c\u4f46\u662f\u6709\u5f88\u591a\u5408\u6cd5\u7684\u7528\u9014\u6765\u4f7f\u7528\u5168\u5c40\u8303\u56f4\uff1a\u4e00\u65b9\u9762\uff0c\u5bfc\u5165\u5168\u5c40\u8303\u56f4\u7684\u51fd\u6570\u548c\u6a21\u5757\u53ef\u4ee5\u7531\u65b9\u6cd5\u4ee5\u53ca\u5176\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u548c\u7c7b\u4f7f\u7528\u3002\n\u901a\u5e38\uff0c\u5305\u542b\u8be5\u65b9\u6cd5\u7684\u7c7b\u672c\u8eab\u662f\u5728\u6b64\u5168\u5c40\u8303\u56f4\u5185\u5b9a\u4e49\u7684\n\n\u6bcf\u4e2a\u503c\u90fd\u662f\u4e00\u4e2a\u5bf9\u8c61\uff0c\u56e0\u6b64\u5177\u6709\u4e00\u4e2a\u7c7b\uff08\u4e5f\u79f0\u4e3a\u5176\u7c7b\u578b\uff09\u3002\u5b83\u5b58\u50a8\u4e3aobject.__class__\n</code></pre>"},{"location":"coding/Python3/#inheritance","title":"\u7ee7\u627f(Inheritance)","text":"<p>Python\u5177\u6709\u4e24\u4e2a\u53ef\u7528\u4e8e\u7ee7\u627f\u7684\u5185\u7f6e\u51fd\u6570\uff1a</p> <ul> <li> <p>\u4f7f\u7528isinstance()\u68c0\u67e5\u5b9e\u4f8b\u7684\u7c7b\u578b\uff1a\u4ec5\u5f53obj.__class__\u662fint\u6216\u4e00\u4e9b\u7c7b\u6d3e\u751f\u81eaint\u65f6\uff0cisinstance(obj, int)\u662fTrue</p> </li> <li> <p>\u4f7f\u7528issubclass()\u68c0\u67e5\u7c7b\u7ee7\u627f\uff1a\u56e0\u4e3abool\u662fint\u7684\u5b50\u7c7b\uff0cissubclass(bool, int)\u662fTrue\uff0c \u4f46\u662f\uff0c\u7531\u4e8efloat\u4e0d\u662fint\u7684\u5b50\u7c7b\uff0c\u6240\u4ee5issubclass(float, int)\u4e3aFalse\u3002</p> </li> </ul>"},{"location":"coding/Python3/#multiple-inheritance","title":"\u591a\u91cd\u7ee7\u627f(Multiple Inheritance)","text":""},{"location":"coding/Python3/#_35","title":"\u79c1\u6709\u53d8\u91cf","text":"Markdown<pre><code>Python\u4e2d\u4e0d\u5b58\u5728\u53ea\u80fd\u4ece\u5bf9\u8c61\u5185\u90e8\u8bbf\u95ee\u7684\u201c\u79c1\u6709\u201d\u5b9e\u4f8b\u53d8\u91cf\u3002\u4f46\u662f\uff0c\u5927\u591a\u6570Python\u4ee3\u7801\u9075\u5faa\u4e00\u4e2a\u7ea6\u5b9a\uff1a\n\u4ee5\u4e0b\u5212\u7ebf\u5f00\u5934\u7684\u540d\u79f0\uff08\u4f8b\u5982_spam\uff09\u5e94\u88ab\u89c6\u4e3aAPI\u7684\u975e\u516c\u5f00\u90e8\u5206\uff08\u65e0\u8bba\u662f\u51fd\u6570\uff0c\u65b9\u6cd5\u8fd8\u662f\u6570\u636e\u6210\u5458\uff09\n\n\u540d\u79f0\u4fee\u9970\u6709\u52a9\u4e8e\u8ba9\u5b50\u7c7b\u8986\u76d6\u65b9\u6cd5\u800c\u53c8\u4e0d\u4e2d\u65ad\u7c7b\u5185\u65b9\u6cd5\u8c03\u7528\u3002\u4f8b\u5982\uff1a\nclass Mapping:\n    def __init__(self, iterable):\n        self.items_list = []\n        self.__update(iterable)\n\n    def update(self, iterable):\n        for item in iterable:\n            self.items_list.append(item)\n\n    __update = update   # private copy of original update() method\n\nclass MappingSubclass(Mapping):\n\n    def update(self, keys, values):\n        # provides new signature for update()\n        # but does not break __init__()\n        for item in zip(keys, values):\n            self.items_list.append(item)\n</code></pre>"},{"location":"coding/Python3/#_36","title":"\u5185\u7f6e\u5f02\u5e38","text":"<p>Python\u4e2d\u6240\u6709\u5f02\u5e38\u5fc5\u987b\u4e3a\u4e00\u4e2a\u6d3e\u751f\u81eaBaseException\u7c7b\u7684\u5b9e\u4f8b\u3002\u5728try\u5e26\u6709except\u63d0\u53ca\u7279\u5b9a\u7c7b\u7684\u5b50\u53e5\u7684\u8bed\u53e5\u4e2d\uff0c\u8be5\u5b50\u53e5\u4e5f\u4f1a\u5904\u7406\u4efb\u4f55\u6d3e\u751f\u81ea \u8be5\u7c7b\u7684\u5f02\u5e38\u7c7b,(\u4f46\u4e0d\u5904\u7406\u5b83\u6240\u6d3e\u751f\u51fa\u7684\u5f02\u5e38\u7c7b)\u901a\u8fc7\u5b50\u7c7b\u5316\u521b\u5efa\u7684\u4e24\u4e2a\u4e0d\u76f8\u5173\u5f02\u5e38\u7c7b\u6c38\u8fdc\u662f\u4e0d\u7b49\u6548\u7684\uff0c\u65e2\u4f7f\u5b83\u4eec\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0 try...except\u8bed\u53e5\u6709\u4e00\u4e2a\u53ef\u9009\u7684else\u5b57\u53e5\uff0c\u4f7f\u7528\u65f6\u5fc5\u987b\u653e\u5728\u6240\u6709except\u5b57\u53e5\u540e\u9762\uff0craise\u8bed\u53e5\u5141\u8bb8\u7a0b\u5e8f\u5f3a\u5236\u53d1\u751f\u6307\u5b9a\u7684\u5f02\u5e38\uff0craise\u552f\u4e00\u7684 \u53c2\u6570\u5c31\u662f\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u8fd9\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u5f02\u5e38\u5b9e\u4f8b\u6216\u4e00\u4e2a\u5f02\u5e38\u7c7b(\u6d3e\u751f\u81eaException\u7684\u7c7b)</p>"},{"location":"coding/Python3/#base-classes","title":"\u57fa\u7c7b(Base classes)","text":"<p>\u4ee5\u4e0b\u5f02\u5e38\u4e3b\u8981\u88ab\u7528\u4f5c\u5176\u4ed6\u5f02\u5e38\u7684\u57fa\u7c7b</p> <p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b</p>"},{"location":"coding/Python3/#concrete-exceptions","title":"Concrete exceptions","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b</p>"},{"location":"coding/Python3/#os","title":"OS \u5f02\u5e38","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b</p>"},{"location":"coding/Python3/#_37","title":"\u8b66\u544a","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b</p>"},{"location":"coding/Python3/#_38","title":"\u5f02\u5e38\u5c42\u6b21\u7ed3\u6784","text":"Markdown<pre><code>BaseException\n +-- SystemExit\n +-- KeyboardInterrupt\n +-- GeneratorExit\n +-- Exception\n      +-- StopIteration\n      +-- StopAsyncIteration\n      +-- ArithmeticError\n      |    +-- FloatingPointError\n      |    +-- OverflowError\n      |    +-- ZeroDivisionError\n      +-- AssertionError\n      +-- AttributeError\n      +-- BufferError\n      +-- EOFError\n      +-- ImportError\n      |    +-- ModuleNotFoundError\n      +-- LookupError\n      |    +-- IndexError\n      |    +-- KeyError\n      +-- MemoryError\n      +-- NameError\n      |    +-- UnboundLocalError\n      +-- OSError\n      |    +-- BlockingIOError\n      |    +-- ChildProcessError\n      |    +-- ConnectionError\n      |    |    +-- BrokenPipeError\n      |    |    +-- ConnectionAbortedError\n      |    |    +-- ConnectionRefusedError\n      |    |    +-- ConnectionResetError\n      |    +-- FileExistsError\n      |    +-- FileNotFoundError\n      |    +-- InterruptedError\n      |    +-- IsADirectoryError\n      |    +-- NotADirectoryError\n      |    +-- PermissionError\n      |    +-- ProcessLookupError\n      |    +-- TimeoutError\n      +-- ReferenceError\n      +-- RuntimeError\n      |    +-- NotImplementedError\n      |    +-- RecursionError\n      +-- SyntaxError\n      |    +-- IndentationError\n      |         +-- TabError\n      +-- SystemError\n      +-- TypeError\n      +-- ValueError\n      |    +-- UnicodeError\n      |         +-- UnicodeDecodeError\n      |         +-- UnicodeEncodeError\n      |         +-- UnicodeTranslateError\n      +-- Warning\n           +-- DeprecationWarning\n           +-- PendingDeprecationWarning\n           +-- RuntimeWarning\n           +-- SyntaxWarning\n           +-- UserWarning\n           +-- FutureWarning\n           +-- ImportWarning\n           +-- UnicodeWarning\n           +-- BytesWarning\n           +-- ResourceWarning\n</code></pre>"},{"location":"coding/Python3/#text-processing-services","title":"\u6587\u672c\u5904\u7406\u670d\u52a1(text processing services)","text":""},{"location":"coding/Python3/#_39","title":"\u5e38\u89c1\u5b57\u7b26\u4e32\u5e38\u91cf","text":"\u5b57\u7b26\u4e32 \u63cf\u8ff0 string.ascii_letters \u4ee5\u4e0blowercase\u548cuppercase\u4e24\u4e2a\u5e38\u91cf\u7684\u4e32\u8054 string.ascii_lowercase \u5c0f\u5199\u5b57\u6bcdabcdefghijklmnopqrstuvwxyz string.ascii_uppercase \u5927\u5199\u5b57\u6bcdABCDEFGHIJKLMNOPQRSTUVWXYZ string.digits \u5b57\u7b26\u4e320123456789 string.hexdigits \u5b57\u7b26\u4e320123456789abcdefABCDEF string.octdigits \u5b57\u7b26\u4e3201234567 string.punctuation ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32,\u5728C\u8bed\u8a00\u73af\u5883\u4e2d\u88ab\u89c6\u4e3a\u6807\u70b9\u5b57\u7b26!\"#$%&amp;'()*+,-./:;&lt;=&gt;?@[]^_`{ string.printable \u88ab\u89c6\u4e3a\u53ef\u6253\u5370\u7684ASCII\u5b57\u7b26\u4e32\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ec4\u5408digits\u3001ascii_letters\u3001punctuation\u3001whitespace string.whitespace \u5305\u542b\u6240\u6709\u88ab\u89c6\u4e3a\u7a7a\u683c\u7684ASCII\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff0c\u5305\u62ec\u5b57\u7b26\u95f4\u9694\uff0c\u5236\u8868\u7b26\uff0c\u6362\u884c\u7b26\uff0c\u8fd4\u56de\u7b26\uff0c\u6362\u9875\u7b26\u548c\u5782\u76f4\u5236\u8868\u7b26 Python<pre><code>\"\"\"\n\u8f85\u52a9\u51fd\u6570\uff1astring.capwords(s, sep=None)\n\u4f7f\u7528str.split()\u5c06\u53c2\u6570\u5206\u89e3\u4e3a\u5355\u8bcd\uff0c\u4f7f\u7528str.capitalize()\u5c06\u5355\u8bcd\u9996\u5b57\u6bcd\u5927\u5199\uff0c\u7136\u540e\u4f7f\u7528str.join()\u8fde\u63a5\u5927\u5199\u5355\u8bcd\uff0c\u5982\u679csep\u4e0d\u5b58\u5728\u6216\u4e3aNone\n\u5219\u5c06\u7a7a\u683c\u5b57\u7b26\u7684\u884c\u66ff\u6362\u4e3a\u5355\u4e2a\u7a7a\u683c\uff0c\u5e76\u5220\u9664\u5f00\u5934\u548c\u7ed3\u5c3e\u7684\u7a7a\u683c\uff0c\u5426\u5219\u4f7f\u7528sep\u5206\u9694\u548c\u8fde\u63a5\u5355\u8bcd\uff0c\u5373\u5f53sep\u5339\u914d\u5230\u5355\u8bcd\u7684\u5b57\u7b26\u65f6\uff0c\u5f00\u59cbcapwords\u5904\u7406\u5b57\u7b26\n\"\"\"\nimport string\n\ns = 'street road'\nprint(string.capwords(s, sep='r'))  # \u8f93\u51fa\uff1aStrEet rOad\n</code></pre>"},{"location":"coding/Python3/#_40","title":"\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u8bed\u6cd5","text":"<p>str.format()\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528{}\u62ec\u8d77\u6765\u8981\u66ff\u6362\u7684\u5b57\u6bb5\uff0c\u4e0d\u5728\u82b1\u62ec\u53f7\u4e4b\u5185\u7684\u5185\u5bb9\u4f1a\u4e0d\u52a0\u4fee\u6539\u7684\u6253\u5370\u5230\u8f93\u51fa\u4e2d\u3002\u5b83\u5c06\u4e0d\u52a0\u6539\u53d8\u5730\u590d\u5236\u5230 \u8f93\u51fa\u4e2d\u3002\u5982\u679c\u4f60\u9700\u8981\u5728\u6587\u5b57\u6587\u672c\u4e2d\u5305\u542b\u4e00\u4e2a\u5927\u62ec\u53f7\u5b57\u7b26\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0\u500d\u6765\u8f6c\u4e49\uff1a{{ }}</p> <p>\u66ff\u6362\u5b57\u6bb5\u8bed\u6cd5\u5982\u4e0b\uff1a</p> Markdown<pre><code>replacement_field ::=  \"{\" [field_name] [\"!\" conversion] [\":\" format_spec] \"}\"\nfield_name        ::=  arg_name (\".\" attribute_name | \"[\" element_index \"]\")*\narg_name          ::=  [identifier | digit+]\nattribute_name    ::=  identifier\nelement_index     ::=  digit+ | index_string\nindex_string      ::=  &lt;any source character except \"]\"&gt; +\nconversion        ::=  \"r\" | \"s\" | \"a\"\nformat_spec       ::=  &lt;described in the next section&gt;\n\n# \u793a\u4f8b\uff1a\n&gt;&gt;&gt; \"{} can be {}\".format(\"Strings\", \"interpolated\")\n&gt;&gt;&gt; \"{0} be nimble, {0} be quick, {0} jump over the {1}\".format(\"Jack\", \"candle stick\")\n&gt;&gt;&gt; \"{name} wants to eat {food}\".format(name=\"Bob\", food=\"lasagna\")\n&gt;&gt;&gt; \"%s can be %s the %s way\" % (\"Strings\", \"interpolated\", \"old\")\n</code></pre>"},{"location":"coding/Python3/#mini-language","title":"Mini-Language\u683c\u5f0f\u5316","text":"Python<pre><code># \u683c\u5f0f\u5316\u6574\u6570\u548c\u6d6e\u70b9\u6570\u8fd8\u53ef\u4ee5\u6307\u5b9a\u662f\u5426\u88650\u548c\u6574\u6570\u4e0e\u5c0f\u6570\u7684\u4f4d\u6570\uff1a\nprint('%2d-%02d' % (3, 1))\nprint('%.2f' % 3.1415926)\n\n# \u5b57\u7b26\u4e32\u91cc\u9762\u7684%\u662f\u4e00\u4e2a\u666e\u901a\u5b57\u7b26\u600e\u4e48\u529e\uff1f\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u8f6c\u4e49\uff0c\u7528%%\u6765\u8868\u793a\u4e00\u4e2a%\n\n# \u5229\u7528format()\u65b9\u6cd5\u8fdb\u884c\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\uff0c\u5b83\u4f1a\u7528\u4f20\u5165\u7684\u53c2\u6570\u4f9d\u6b21\u66ff\u6362\u5b57\u7b26\u4e32\u5185\u7684\u5360\u4f4d\u7b26{0},{1}......,\u4f46\u8981\u6bd4\u5360\u4f4d\u7b26\u9ebb\u70e6\n'Hello, {0}, \u6210\u7ee9\u63d0\u5347\u4e86 {1:.1f}%'.format('\u5c0f\u660e', 17.125)\n</code></pre> <p>\u5b57\u7b26\u4e32 % \u64cd\u4f5c\uff0cpython\u6709\u4e00\u4e2aprintf\u683c\u5f0f\u5c06\u5b57\u7b26\u4e32\u653e\u5728\u4e00\u8d77\uff0c%\u64cd\u4f5c\u7b26\u5c06\u5de6\u8fb9(%d int, %s string, %f\u6216%g floating point)\u4ee5printf-type\u683c\u5f0f\u5316\uff0c\u5339\u914d\u5728\u53f3\u8fb9\u7684\u5143\u7ec4\u91cc\u7684\u503c</p> \u683c\u5f0f\u5316\u7b26\u53f7 \u66ff\u6362\u5185\u5bb9\u7c7b\u578b %s \u5b57\u7b26\u4e32 %d \u5341\u8fdb\u5236\u6574\u6570 %x \u5341\u516d\u8fdb\u5236\u6574\u6570 %f \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d %g \u6d6e\u70b9\u6570,\u7cbe\u5ea6\u9ed8\u8ba4\u4e3a6\u4f4d,\u4e0d\u5c3e\u968f0"},{"location":"coding/Python3/#re-","title":"re--\u6b63\u5219\u8868\u8fbe\u5f0f","text":"<p>re\u6a21\u5757\u4e0ePerl\u8bed\u8a00\u7c7b\u4f3c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u64cd\u4f5c\uff0c\u6a21\u5f0f\u548c\u88ab\u641c\u7d22\u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u4f7fUnicode\u5b57\u7b26\u4e32\u4e5f\u53ef\u4ee5\u662f8\u4e3a\u5b57\u8282\u4e32(bytes)\uff0c\u4f46Unicode\u548c 8\u4f4d\u5b57\u8282\u4e32\u4e0d\u80fd\u6df7\u7528\u3002\u56e0\u53cd\u659c\u6760\\\u5728Python\u4e2d\u548c\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\uff0c\u90fd\u5177\u6709\u5c06\u628a\u7279\u6b8a\u5b57\u7b26\u8f6c\u6362\u4e3a\u666e\u901a\u5b57\u7b26\u4e32\u7684\u4f5c\u7528\u3002\u6240\u4ee5\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f \u8981\u5199\u6210<code>\\\\\\\\</code>\u3002\u89e3\u51b3\u529e\u6cd5\u662f\u5bf9\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u6837\u5f0f\u7528\u5e26\u6709r\u524d\u7f00\u7684\u8868\u793aPython\u539f\u59cb\u5b57\u7b26\u7684\u65b9\u6cd5</p> re.search(pattern, string, flags=0) \u67e5\u627e\u5728string\u4e2d\u4e0epattern\u5339\u914d\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u5b57\u7b26\uff0c\u5e76\u8fd4\u56de\u5339\u914d\u5bf9\u8c61\u548c\u4f4d\u7f6e\u3002\u5982\u679cstring\u4e2d\u6ca1\u6709\u4e0e\u6a21\u5f0f\u5339\u914d\uff0c\u5219\u8fd4\u56deNone re.match() \u4e0ere.search()\u76f8\u4f3c\uff0c\u533a\u522b\u5728\u4e8ere.match\u5728\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u5f00\u59cb\u5bfb\u627e\u5339\u914d\u9879\u3002 re.compile(pattern, flags=0) \u5c06\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u7f16\u8bd1\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u5bf9\u8c61\uff0c\u53ef\u4f7f\u7528match()\uff0csearch()\u4ee5\u53ca\u4e0b\u9762\u6240\u8ff0\u7684\u5176\u4ed6\u65b9\u6cd5\u5c06\u5176\u7528\u4e8e\u5339\u914d\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9aflags\u503c\u6765\u4fee\u6539\u8868\u8fbe\u5f0f\u7684\u884c\u4e3a\u3002\u53ef\u4ee5\u4f7f\u7528<code>\u6309\u4f4d\u8fd0\u7b97\u3001\u6216\u8fd0\u7b97</code>\u7ec4\u5408 re.findall() \u4ee5string\u5217\u8868\u5f62\u5f0f\u8fd4\u56destring\u4e2d\u6240\u6709\u975e\u91cd\u590d\u7684\u5339\u914d\u9879 re.finditer() \u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u8be5\u8fed\u4ee3\u5668\u751f\u6210match\u5bf9\u8c61 re.fullmatch() \u5982\u679c\u6574\u4e2a\u5b57\u7b26\u4e32\u548c\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d\uff0c\u8fd4\u56de\u4e00\u4e2a\u5bf9\u5e94match\u5bf9\u8c61\uff0c\u5426\u5219\u8fd4\u56deNone <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u8f6c\u4e49\u7801\uff1a\u53cd\u659c\u6760\u672c\u8eab\u5728python\u4e2d\u5177\u6709\u8f6c\u4e49\u542b\u4e49\uff0c\u4f7f\u7528\u524d\u7f00r\u6d88\u9664\u6b64\u95ee\u9898</p> \u7b26\u53f7 \u542b\u4e49 \\d \u4e00\u4e2a\u6570\u5b57 \\D \u4e00\u4e2a\u975e\u6570\u5b57 \\s \u7a7a\u683c(\u5236\u8868\u7b26\u3001\u7a7a\u683c\u3001\u6362\u884c\u7b26\u7b49) \\S \u975e\u7a7a\u767d \\w \u5b57\u6bcd \\W \u975e\u5b57\u6bcd\u6570\u5b57 <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u951a\u8f6c\u4e49\u7801\uff1a</p> \u7b26\u53f7 \u542b\u4e49 ^ \u5b57\u7b26\u4e32\u6216\u884c\u7684\u5f00\u5934 $ \u5b57\u7b26\u4e32\u6216\u884c\u7684\u7ed3\u5c3e \\A \u5b57\u7b26\u4e32\u5f00\u59cb \\Z \u5b57\u7b26\u4e32\u7ed3\u5c3e \\b \u5355\u8bcd\u5f00\u5934\u6216\u7ed3\u5c3e\u7684\u7a7a\u5b57\u7b26\u4e32 \\B \u7a7a\u5b57\u7b26\u4e32\uff0c\u4e0d\u5728\u5355\u8bcd\u7684\u5f00\u5934\u6216\u7ed3\u5c3e <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u6807\u5fd7\u7f29\u5199:\u53ef\u4ee5\u4e00\u8d77\u7ec4\u5408\u4f7f\u7528\uff0c\u4f8b\u5982\uff1a(?im)\u8868\u793a\u591a\u884c\u5b57\u7b26\u4e32\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u5339\u914d</p> \u6807\u5fd7 \u7f29\u5199 ASCII a IGNORECASE i MULTILINE m DOTALL s VERBOSE x Python<pre><code># re.match()\u548cre.search()\u5bf9\u6bd4\nimport re\n\n\ns = \"python tuts\"\nmatch = re.match(r'py', s)\nif match:\n    print(match.group())\n\ns2 = \"python tuts\"\nmatch = re.search(r'^py', s2)   # re.search()\u6dfb\u52a0^\u7b26\u53f7\u4e0e\u4e0a\u9762re.match()\u76f8\u540c\nif match:\n    print(match.group())\n</code></pre>"},{"location":"coding/Python3/#difflib-helpers-for-computing-deltas","title":"difflib -- helpers for computing deltas","text":"<p>difflib.Differ\u7528\u4e8e\u6bd4\u8f83\u6587\u672c\u884c\u5e8f\u5217\u5e76s\u751f\u6210\u4eba\u7c7b\u53ef\u8bfb\u7684\u5dee\u5f02\u6216\u589e\u91cf\u7684\u7c7b\u3002Differ\u4f7f\u7528SequenceMatcher\u6765\u6bd4\u8f83\u884c\u7684\u5e8f\u5217\u5e76\u6bd4\u8f83\u76f8\u4f3c(\u8fd1\u5339\u914d)\u884c\u4e2d\u5b57\u7b26\u5e8f\u5217</p> <p>Differ delta\u7684\u6bcf\u4e00\u884c\u90fd\u4ee5\u4e24\u4e2a\u5b57\u6bcd\u7684\u4ee3\u7801\u5f00\u5934</p> \u4ee3\u7801 \u542b\u4e49 '- ' \u5339\u914d\u5e26\u6709-\u524d\u7f00\u7684\u884c\u5728\u7b2c\u4e00\u4e2a\u5e8f\u5217\u4e2d\u4f46\u4e0d\u5728\u7b2c\u4e8c\u4e2a\u5e8f\u5217\u4e2d '+ ' \u5339\u914d\u5e26\u6709+\u524d\u7f00\u7684\u884c\u5728\u7b2c\u4e8c\u4e2a\u5e8f\u5217\u4e2d\u4f46\u4e0d\u5728\u7b2c\u4e00\u4e2a\u5e8f\u5217\u4e2d '  ' \u5982\u679c\u6ca1\u6709\u66f4\u6539\u5219\u5728\u5de6\u5217\u6253\u5370\u51fa\u591a\u4f59\u7684\u4e00\u4e2a\u7a7a\u767d\uff0c\u4ee5\u4fbf\u4e8e\u548c\u5176\u4ed6\u6709\u5dee\u5f02\u7684\u8f93\u51fa\u5bf9\u9f50 '? ' \u5982\u679c\u6bd4\u8f83\u7684\u884c\u5185\u5bb9\u6709\u6240\u5dee\u5f02\u5219\u4f7f\u7528?\u6765\u7a81\u51fa\u663e\u793a\u66f4\u6539"},{"location":"coding/Python3/#textwrap-text-wrapping-and-filling","title":"textwrap -- Text wrapping and filling","text":"<p>\u901a\u8fc7\u8c03\u6574\u6bb5\u843d\u4e2d\u51fa\u73b0\u6362\u884c\u7b26\u7684\u4f4d\u7f6e\u6765\u683c\u5f0f\u5316\u6587\u672c\u3002TextWrapper\u6784\u9020\u51fd\u6570\u63a5\u53d7\u8bb8\u591a\u53ef\u9009\u7684\u5173\u952e\u5b57\u53c2\u6570\u3002\u6bcf\u4e2a\u5173\u952e\u5b57\u53c2\u6570\u5bf9\u5e94\u4e00\u4e2a\u5b9e\u4f8b\u5c5e\u6027</p> textwrap.wrap(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u6bb5\u843d\uff0c\u8f93\u51fa\u4ee5\u957f\u5ea6\u5212\u5206\u7684\u884c\u5217\u8868 textwrap.fill(text, width=79, **kwargs) \u5c06text\u4ee5width\u957f\u5ea6\u5212\u5206\u4e3a\u65b0\u7684\u4e00\u884c textwrap.shorten(text, width, **kwargs) \u622a\u65ad\u7ed9\u5b9a\u6587\u672c\u4ee5\u9002\u5408\u7ed9\u5b9a\u5bbd\u5ea6\u5e76\u4ee5[...]\u6298\u53e0\u88ab\u622a\u65ad\u7684\u6587\u672c textwrap.dedent(text) \u4ece\u6587\u672c\u7684\u6bcf\u4e00\u884c\u4e2d\u5220\u9664\u4efb\u4f55\u5e38\u89c1\u7684\u524d\u5bfc\u7a7a\u683c\u3001\u5236\u8868\u7b26 textwrap.indent(text, prefix, predicate=None) \u5728\u6587\u672c\u4e2d\u9009\u5b9a\u884c\u7684\u5f00\u5934\u6dfb\u52a0\u524d\u7f00"},{"location":"coding/Python3/#unicodedata-unicode-database","title":"unicodedata -- Unicode Database","text":"<p>\u63d0\u4f9b\u5bf9unicode\u5b57\u7b26\u6570\u636e\u5e93\u7684\u8bbf\u95ee\uff0c\u8be5\u6570\u636e\u5e93\u5b9a\u4e49\u4e86\u6240\u6709unicode\u5b57\u7b26\u7684\u5b57\u7b26\u5c5e\u6027</p> unicodedata.lookup() \u6309\u540d\u79f0\u67e5\u627e\u5b57\u7b26\uff0c\u82e5\u627e\u5230\u7ed9\u5b9a\u540d\u79f0\u5b57\u7b26\u5219\u8fd4\u56de\u76f8\u5e94\u7684\u5b57\u7b26\uff0c\u82e5\u672a\u627e\u5230\u5219\u5f15\u53d1KeyError unicodedata.name() \u8fd4\u56de\u5206\u914d\u7ed9\u5b57\u7b26chr\u7684\u540d\u79f0\u4f5c\u4e3a\u5b57\u7b26\u4e32\uff0c\u82e5\u6ca1\u6709\u5b9a\u4e49\u540d\u79f0\u5219\u8fd4\u56dedefault\uff0c\u82e5\u6ca1\u6709\u5219\u5f15\u53d1ValueError unicodedata.category() \u8fd4\u56de\u5206\u914d\u7ed9\u5b57\u7b26chr\u7684\u5e38\u89c4\u7c7b\u522b\u4e3a\u5b57\u7b26\u4e32 unicodedata.combining \u8fd4\u56de\u5206\u914d\u7ed9\u5b57\u7b26chr\u7684\u89c4\u8303\u7ec4\u5408\u7c7b\u4f5c\u4e3a\u6574\u6570\uff0c\u82e5\u672a\u5b9a\u4e49\u7ec4\u5408\u7c7b\u5219\u8fd4\u56de0 unicodedata.normalize() \u8fd4\u56deunicode\u5b57\u7b26\u4e32\u7684\u6b63\u5e38\u5f62\u5f0fform\uff0cform\u6709\u6548\u503c\u4e3a\uff1aNFC\u3001NFKC\u3001NFD\u3001NFKD"},{"location":"coding/Python3/#readline-gnu-readline-interface","title":"readline -- GNU readline interface","text":"<p>readline\u6a21\u5757\u5b9a\u4e49\u591a\u79cd\u529f\u80fd\u4ee5\u5e2e\u52a9\u5b8c\u6210\u4ecepython\u89e3\u91ca\u5668\u8bfb\u53d6\u6216\u5199\u5165\u5386\u53f2\u6587\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e5f\u53ef\u4ee5\u901a\u8fc7rlcompleter\u652f\u6301\u4ea4\u4e92\u5f0f\u63d0\u793a\u4e0b\u7684python\u6807\u8bc6\u7b26\u5b8c\u6210 \u7684\u6a21\u5757\u4f7f\u7528\uff0c\u4f7f\u7528\u6b64\u6a21\u5757\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u7684\u4ea4\u4e92\u5f0f\u63d0\u793a\u548c\u5185\u7f6einput()\u529f\u80fd\u63d0\u4f9b\u7684\u63d0\u793a\u884c\u4e3a</p> <p>init\u6587\u4ef6\uff1a\u4ee5\u4e0b\u529f\u80fd\u4e0e\u521d\u59cb\u5316\u6587\u4ef6\u548c\u7528\u6237\u914d\u7f6e\u6709\u5173</p> <p>readline.parse_and_bind(string)     \u6267\u884c\u5728string\u53c2\u6570\u4e2d\u63d0\u4f9b\u7684\u521d\u59cb\u5316\u884c readline.read_init_file([filename]) \u6267\u884c\u4e00\u4e2areadline\u521d\u59cb\u5316\u6587\u4ef6\u3002\u9ed8\u8ba4\u6587\u4ef6\u540d\u4e3a\u6700\u8fd1\u6240\u4f7f\u7528\u7684\u6587\u4ef6\u540d</p> <p>https://docs.python.org/zh-cn/3/library/readline.html</p>"},{"location":"coding/Python3/#rlcompleter-completion-function-for-gnu-readline","title":"rlcompleter -- Completion function for GNU readline","text":"<p>rlcompeleter \u901a\u8fc7\u8865\u5168\u6709\u6548\u7684Python\u6807\u8bc6\u7b26\u548c\u5173\u952e\u5b57\u5b9a\u4e49\u4e86\u4e00\u4e2a\u9002\u7528\u4e8ereadline\u6a21\u5757\u7684\u8865\u5168\u51fd\u6570 \u5176Completer\u5bf9\u8c61\uff0c\u6b64\u5bf9\u8c61\u5177\u6709\u4ee5\u4e0b\u65b9\u6cd5\uff1a</p> <p>Completer.complete(text, state)    \u4e3atext\u8fd4\u56de\u7b2cstate\u9879\u8865\u5168</p>"},{"location":"coding/Python3/#binary-data-services","title":"Binary Data Services","text":""},{"location":"coding/Python3/#struct-interpret-bytes-as-packed-binary-data","title":"struct -- Interpret bytes as packed binary data","text":"<p>\u6b64\u6a21\u5757\u53ef\u4ee5\u6267\u884c Python \u503c\u548c\u4ee5 Python bytes \u5bf9\u8c61\u8868\u793a\u7684 C \u7ed3\u6784\u4e4b\u95f4\u7684\u8f6c\u6362\u3002 \u8fd9\u53ef\u4ee5\u88ab\u7528\u6765\u5904\u7406\u5b58\u50a8\u5728\u6587\u4ef6\u4e2d\u6216\u662f\u4ece\u7f51\u7edc\u8fde\u63a5\u7b49\u5176\u4ed6\u6765\u6e90\u83b7\u53d6\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002 \u5b83\u4f7f\u7528\u683c\u5f0f\u5b57\u7b26\u4e32\u4f5c\u4e3a C \u7ed3\u6784\u5e03\u5c40\u7684\u7cbe\u7b80\u63cf\u8ff0\u4ee5\u53ca\u4e0e Python \u503c\u7684\u53cc\u5411\u8f6c\u6362</p> <p>struct\u5b9a\u4e49\u7684\u51fd\u6570</p> struct.pack() \u8fd4\u56de\u4e00\u4e2a bytes \u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32format\u6253\u5305\u7684\u503cv1, v2, ...\u53c2\u6570\u4e2a\u6570\u5fc5\u987b\u4e0e\u683c\u5f0f\u5b57\u7b26\u4e32\u6240\u8981\u6c42\u7684\u503c\u5b8c\u5168\u5339\u914d struct.unpack() \u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32format\u4ece\u7f13\u51b2\u533abuffer\u89e3\u5305\uff08\u5047\u5b9a\u662f\u7531pack(format, ...)\u6253\u5305\uff09\uff0c\u7ed3\u679c\u4e3a\u4e00\u4e2a\u5143\u7ec4\uff0c\u5373\u4f7f\u5176\u53ea\u5305\u542b\u4e00\u4e2a\u6761\u76ee\u3002 \u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f\u5fc5\u987b\u5339\u914d\u683c\u5f0f\u6240\u8981\u6c42\u7684\u5927\u5c0f struct.unpack_from() \u5bf9 buffer \u4ece\u4f4d\u7f6e offset \u5f00\u59cb\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32 format \u8fdb\u884c\u89e3\u5305\u3002 \u7ed3\u679c\u4e3a\u4e00\u4e2a\u5143\u7ec4\uff0c\u5373\u4f7f\u5176\u4e2d\u53ea\u5305\u542b\u4e00\u4e2a\u6761\u76ee\u3002 \u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f\u4ece\u4f4d\u7f6e offset \u5f00\u59cb\u5fc5\u987b\u81f3\u5c11\u4e3a calcsize() \u663e\u793a\u7684\u683c\u5f0f\u6240\u8981\u6c42\u7684\u5927\u5c0f struct.calcsize() \u8fd4\u56de\u4e0e\u683c\u5f0f\u5b57\u7b26\u4e32format\u76f8\u5bf9\u5e94\u7684\u7ed3\u6784\u7684\u5927\u5c0f(\u5373pack()\u65b9\u6cd5\u6240\u4ea7\u751f\u7684\u5b57\u8282\u4e32\u5bf9\u8c61\u7684\u5927\u5c0f) <p>struct\u6a21\u5757\u8fd8\u5b9a\u4e49\u4ee5\u4e0b\u7c7b\u578b\uff1a class struct.Struct(format)\u7c7b\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684Struct\u5bf9\u8c61\uff0c\u5176\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32format\u5199\u5165\u548c\u8bfb\u53d6\u4e8c\u8fdb\u5236\u6570\u636e \u4e00\u6b21\u6027\u521b\u5efaStruct\u5bf9\u8c61\u5e76\u8c03\u7528\u5176\u65b9\u6cd5\uff0c\u76f8\u6bd4\u4f7f\u7528\u540c\u6837\u683c\u5f0f\u8c03\u7528struct\u51fd\u6570\u66f4\u9ad8\u6548\uff0c\u56e0\u4e3a\u5b57\u7b26\u4e32\u53ea\u9700\u88ab\u7f16\u8bd1\u4e00\u6b21</p> <p>\u6ce8\u89e3\uff1a\u4f20\u9012\u7ed9Struct\u548c\u6a21\u5757\u5c42\u7ea7\u51fd\u6570\u7684\u5df2\u7f16\u8bd1\u7248\u6700\u65b0\u683c\u5f0f\u5b57\u7b26\u4e32\u4f1a\u88ab\u7f13\u5b58\uff0c \u56e0\u6b64\u53ea\u4f7f\u7528\u5c11\u91cf\u683c\u5f0f\u5b57\u7b26\u4e32\u7684\u7a0b\u5e8f\u65e0\u9700\u62c5\u5fc3\u91cd\u7528\u5355\u72ec\u7684Struct\u5b9e\u4f8b</p> <p>\u5df2\u7f16\u8bd1\u7684Struct\u5bf9\u8c61\u652f\u6301\u4ee5\u4e0b\u65b9\u6cd5\u548c\u5c5e\u6027\uff1a</p> <p>\u65b9\u6cd5\uff1a</p> pack() \u7b49\u4ef7\u4e8epack()\u51fd\u6570\uff0clen(result)\u5c06\u7b49\u4e8esize pack_into() \u7b49\u4ef7\u4e8epack_into()\u51fd\u6570 unpack(buffer) \u7b49\u4ef7\u4e8eunpack()\u51fd\u6570\uff0c\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f\u5fc5\u987b\u7b49\u4e8esize unpack_from(buffer, offset=0) \u7b49\u4ef7\u4e8eunpack_from()\u51fd\u6570\uff0c\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f\u4ece\u4f4d\u7f6eoffset\u5f00\u59cb\u4e14\u5fc5\u987b\u81f3\u5c11\u4e3asize\u5927\u5c0f iter_unpack(buffer) \u7b49\u4ef7\u4e8eiter_unpack()\u51fd\u6570\uff0c\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f\u5fc5\u987b\u4e3asize\u7684\u6574\u6570\u500d <p>\u5c5e\u6027\uff1a</p> <p>format  \u7528\u4e8e\u6784\u9020\u6b64 Struct \u5bf9\u8c61\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\u30023.7\u7248\u66f4\u6539: \u683c\u5f0f\u5b57\u7b26\u4e32\u7c7b\u578b\u73b0\u5728\u662fstr\u800c\u4e0d\u518d\u662f bytes</p> <p>size    \u8ba1\u7b97\u51fa\u5bf9\u5e94\u4e8eformat\u7684\u7ed3\u6784\u5927\u5c0f\uff08\u5373pack()\u65b9\u6cd5\u6240\u4ea7\u751f\u7684\u5b57\u8282\u4e32\u5bf9\u8c61\u7684\u5927\u5c0f\uff09</p>"},{"location":"coding/Python3/#codecs-codec-registry-and-base-classes","title":"codecs -- Codec registry and base classes","text":"<p>\u6a21\u5757\u5b9a\u4e49\u4e86\u6807\u51c6 Python \u7f16\u89e3\u7801\u5668\uff08\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\uff09\u7684\u57fa\u7c7b\uff0c\u5e76\u63d0\u4f9b\u63a5\u53e3\u7528\u6765\u8bbf\u95ee\u5185\u90e8\u7684 Python \u7f16\u89e3\u7801\u5668\u6ce8\u518c\u8868\uff0c\u8be5\u6ce8\u518c\u8868\u8d1f\u8d23\u7ba1\u7406\u7f16\u89e3\u7801\u5668\u548c\u9519\u8bef\u5904\u7406\u7684\u67e5\u627e\u8fc7\u7a0b\u3002 \u5927\u591a\u6570\u6807\u51c6\u7f16\u89e3\u7801\u5668\u90fd\u5c5e\u4e8e \u6587\u672c\u7f16\u7801\uff0c\u5b83\u4eec\u53ef\u5c06\u6587\u672c\u7f16\u7801\u4e3a\u5b57\u8282\u4e32\uff0c\u4f46\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e9b\u7f16\u89e3\u7801\u5668\u53ef\u5c06\u6587\u672c\u7f16\u7801\u4e3a\u6587\u672c\uff0c\u4ee5\u53ca\u5b57\u8282\u4e32\u7f16\u7801\u4e3a\u5b57\u8282\u4e32\u3002 \u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668\u53ef\u4ee5\u5728\u4efb\u610f\u7c7b\u578b\u95f4\u8fdb\u884c\u7f16\u7801\u548c\u89e3\u7801\uff0c\u4f46\u67d0\u4e9b\u6a21\u5757\u7279\u6027\u4ec5\u9002\u7528\u4e8e \u6587\u672c\u7f16\u7801 \u6216\u5c06\u6570\u636e\u7f16\u7801\u4e3a \u5b57\u8282\u4e32 \u7684\u7f16\u89e3\u7801\u5668</p> <p>\u4ee5\u4e0b\u7528\u4e8e\u4f7f\u7528\u4efb\u4f55\u7f16\u89e3\u7801\u5668\u8fdb\u884c\u7f16\u7801\u548c\u89e3\u7801\u7684\u51fd\u6570:</p> codecs.encode() \u4f7f\u7528encoding\u6ce8\u518c\u7684\u7f16\u89e3\u7801\u5668\u5bf9obj\u8fdb\u884c\u7f16\u7801 codecs.decode() \u4f7f\u7528encoding\u6ce8\u518c\u7684\u7f16\u89e3\u7801\u5668\u5bf9obj\u8fdb\u884c\u89e3\u7801 codecs.lookup() \u5728python\u7f16\u89e3\u7801\u5668\u6ce8\u518c\u8868\u4e2d\u67e5\u627e\u7f16\u89e3\u7801\u5668\u4fe1\u606f\u5e76\u8fd4\u56de\u4e00\u4e2aCodecInfo\u5bf9\u8c61 codecs.getwriter() \u67e5\u627e\u7ed9\u5b9a\u7f16\u7801\u7684\u7f16\u89e3\u7801\u5668\u5e76\u8fd4\u56de\u5176StreamWriter\u7c7b\u6216factory\u51fd\u6570 codecs.open() \u4f7f\u7528\u7ed9\u5b9a\u7684mode\u6253\u5f00\u5df2\u7f16\u7801\u6587\u4ef6\u5e76\u8fd4\u56de\u4e00\u4e2aSteamReaderWriter\u7684\u5b9e\u4f8b\uff0c\u9ed8\u8ba4\u6587\u4ef6\u6a21\u5f0f\u4e3ar"},{"location":"coding/Python3/#data-types","title":"Data Types","text":""},{"location":"coding/Python3/#datetime","title":"datetime\u57fa\u672c\u7684\u65e5\u671f\u548c\u65f6\u95f4\u7c7b\u578b","text":"<p>datetime\u6a21\u5757\u63d0\u4f9b\u64cd\u7eb5\u65e5\u671f\u548c\u65f6\u95f4\u7684\u7c7b\uff0c\u4f46\u5b9e\u73b0\u7684\u91cd\u70b9\u662f\u9488\u5bf9\u8f93\u51fa\u683c\u5f0f\u5316\u548c\u63d0\u53d6\u64cd\u4f5c\u7684\u6709\u6548\u5c5e\u6027</p>"},{"location":"coding/Python3/#datetime_1","title":"datetime\u6a21\u5757\u5177\u6709\u7684\u5e38\u91cf","text":"datetime.MINYEAR date\u6216datetime\u5bf9\u8c61\u4e2d\u5141\u8bb8\u7684\u6700\u5c0f\u5e74\u4efd,MINYEAR\u503c\u4e3a1 datetime.MAXYEAR date\u6216datetime\u5bf9\u8c61\u4e2d\u5141\u8bb8\u7684\u6700\u5927\u5e74\u4efd\uff0cMAXYEAR\u503c\u4e3a9999"},{"location":"coding/Python3/#datetime_2","title":"datetime\u6a21\u5757\u5177\u6709\u7684\u7c7b\uff0c\u8fd9\u4e9b\u7c7b\u7684\u5bf9\u8c61\u90fd\u662f\u4e0d\u53ef\u53d8\u7684","text":"datetime.date \u5047\u8bbe\u5f53\u524d\u516c\u5386\u59cb\u7ec8\u6709\u6548\u5e76\u4e14\u6c38\u8fdc\u6709\u6548\uff0c\u53c2\u6570\uff1ayear,month,day,\u53c2\u6570\u90fd\u662f\u5fc5\u987b\u7684\u4e14\u5fc5\u987b\u662f\u6574\u6570 datetime.time \u4e00\u4e2a\u7406\u60f3\u7684\u65f6\u95f4\uff0c\u72ec\u7acb\u4e8e\u7279\u5b9a\u4e00\u5929\uff0c\u5047\u8bbe\u6bcf\u5929\u6b63\u597d24*60*60\u79d2\uff0c\u5c5e\u6027\uff1ahour,minute,second,microsecond,tzinfo datetime.datetime \u65e5\u671f\u548c\u65f6\u95f4\u7684\u7ec4\u5408\uff0c\u5c5e\u6027\uff1ayear,month,day,hour,minute,second,microsecond,tzinfo datetime.timedalta \u8868\u8fbe\u5728date,time\u6216datetime\u5b9e\u4f8b\u4e4b\u95f4\u7684\u5dee\u5f02\u7684\u6301\u7eed\u65f6\u95f4\uff0c\u6240\u6709\u53c2\u6570\u9ed8\u8ba4\u503c\u4e3a0 datetime.tzinfo \u65f6\u533a\u4fe1\u606f\u5bf9\u8c61\u7684\u62bd\u8c61\u57fa\u7c7b\uff0c\u901a\u8fc7datetime\u548ctime\u7c7b\u6765\u63d0\u4f9b\u65f6\u95f4\u8c03\u6574 datetime.timezone \u5c06tzinfo\u62bd\u8c61\u57fa\u7c7b\u5b9e\u73b0\u4e3a\u76f8\u5bf9\u4e8eUTC\u7684\u56fa\u5b9a\u504f\u79fb\u91cf\u7684\u7c7b Markdown<pre><code>\u5bf9\u5e94\u5b50\u7c7b\u5173\u7cfb\uff1a\nObject\n    timedelta\n    tzinfo\n        timezone\n    time\n    date\n        datetime\n\n\u516c\u5171\u7279\u6027\uff1adate\u3001datetime\u3001time\u548ctimezone\u7c7b\u578b\u5171\u4eab\u8fd9\u4e9b\u7279\u6027\n* \u8fd9\u4e9b\u7c7b\u578b\u7684\u5bf9\u8c61\u662f\u4e0d\u53ef\u53d8\u7684\n* \u8fd9\u4e9b\u7c7b\u578b\u7684\u5bf9\u8c61\u53ef\u54c8\u5e0c\u7684\uff0c\u610f\u5473\u7740\u53ef\u4ee5\u7528\u4f5c\u5b57\u5178\u7684key\n* \u8fd9\u4e9b\u7c7b\u578b\u7684\u5bf9\u8c61\u901a\u8fc7pickle\u6a21\u5757\u652f\u6301\u9ad8\u6548\u7684\u5e8f\u5217\u5316\u3002\n\n\u786e\u5b9a\u5bf9\u8c61\u662fAware\u6216Naive\n* date\u7c7b\u578b\u7684\u5bf9\u8c61\u90fd\u662fnaive\n* time\u6216datetime\u7c7b\u578b\u7684\u5bf9\u8c61\u53ef\u80fd\u4e3aaware\u6216naive\n    \u5f53\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0cdatetime\u7c7b\u578b\u7684\u5bf9\u8c61d\u662faware\uff0c\u5426\u5219d\u4e3anaive\n    1. d.tzinfo\u4e0d\u80fd\u4e3aNone\n    2. d.tzinfo.utcoffset(d)\u4e0d\u4f1a\u8fd4\u56deNone\n    \u5f53\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0ctime\u7c7b\u578b\u5bf9\u8c61t\u662faware\uff0c\u5426\u5219\u4e3anaive\n    1. t.tzinfo\u4e0d\u4e3aNone\n    2. t.tzinfo.utcoffset(None)\u4e0d\u8fd4\u56deNone\n</code></pre>"},{"location":"coding/Python3/#timedelta","title":"timedelta\u7c7b\u5bf9\u8c61","text":"<p>\u8868\u793a\u4e24\u4e2adate\u6216\u8005time\u7684\u65f6\u95f4\u95f4\u9694</p> <p>datetime.timedalta(days=0, seconds=0, microseconds=0, milliseconds=0, minutes=0, hours=0, weeks=0) \u6240\u6709\u53c2\u6570\u90fd\u662f\u53ef\u9009\u7684\u5e76\u4e14\u9ed8\u8ba4\u4e3a 0\u3002 \u8fd9\u4e9b\u53c2\u6570\u53ef\u4ee5\u662f\u6574\u6570\u6216\u8005\u6d6e\u70b9\u6570\uff0c\u4e5f\u53ef\u4ee5\u662f\u6b63\u6570\u6216\u8005\u8d1f\u6570</p> <p>\u7c7b\u5c5e\u6027\uff1a timedelta.min The most negative timedelta object, timedelta(-999999999)</p> <p>timedelta.max The most positive timedelta object, timedelta(days=999999999, hours=23, minutes=59, seconds=59, microseconds=999999)</p> <p>timedelta.resolution \u4e24\u4e2a\u4e0d\u76f8\u7b49\u7684timedelta\u7c7b\u5bf9\u8c61\u6700\u5c0f\u7684\u95f4\u9694\u4e3atimedelta(microseconds=1)</p>"},{"location":"coding/Python3/#date","title":"date\u5bf9\u8c61","text":"<p>\u4e00\u4e2adate\u5bf9\u8c61\u8868\u793a\u7406\u60f3\u5316\u65e5\u5386\u4e2d\u7684\u65e5\u671f(\u5e74\u6708\u65e5)</p> date.today() \u8fd4\u56de\u5f53\u524d\u7684\u672c\u5730\u65e5\u671f\uff0c\u7b49\u540c\u4e8edate.fromtimestamp(time.time()) date.fromtimestamp(timestamp) \u8fd4\u56de\u4e0ePOSIX\u65f6\u95f4\u6233\u76f8\u5bf9\u5e94\u7684\u672c\u5730\u65e5\u671f\uff0c\u975ePOSIX\u7cfb\u7edf\uff0c\u65f6\u95f4\u6233\u5305\u542bleap\u79d2\u6982\u5ff5\u4f1a\u88ab\u5ffd\u7565 date.fromordinal(ordinal) \u8fd4\u56de\u5bf9\u5e94\u4e8e\u591a\u683c\u52d2\u516c\u5386\u5e8f\u53f7\u7684\u65e5\u671f\uff0c\u5176\u4e2d\u7b2c\u4e00\u5e74\u7684\u4e00\u6708\u4e00\u65e5\u4e3a\u5e8f\u53f71 date.fromisoformat(date_string) \u8fd4\u56dedate\u4e0edate_string\u76f8\u5bf9\u5e94\u7684\u683c\u5f0f\uff0c\u683c\u5f0f\u4e3a:YYYY-MM-DD\uff0c\u6b64\u4e3adate.isofromat\u51fd\u6570\u7684\u53cd\u51fd\u6570 date.fromisocalendar(year,week,day) \u8fd4\u56dedate\u4e0e\u6309\u5e74\uff0c\u5468\u548c\u65e5\u6307\u5b9a\u7684iso\u65e5\u5386\u65e5\u671f\uff0c\u6b64\u4e3adate.isocalendar\u51fd\u6570\u7684\u53cd\u51fd\u6570 <p>date\u7c7b\u5c5e\u6027\uff1a</p> date.min \u6700\u65e9\u7684\u65e5\u671f date.max \u6700\u5927\u7684\u65e5\u671f date.resolution \u975e\u76f8\u7b49\u65e5\u671f\u5bf9\u8c61\u4e4b\u95f4\u7684\u6700\u5c0f\u5dee\u5f02 <p>\u5b9e\u4f8b\u5c5e\u6027(\u53ea\u8bfb)\uff1a</p> date.year  date.month  date.day \u5206\u522b\u5bf9\u5e94\u5e74\u6708\u65e5 <p>\u5b9e\u4f8b\u65b9\u6cd5\uff1a |  |  | | :------: | :------: | | date.replace() | \u8fd4\u56de\u4e00\u4e2a\u5177\u6709\u76f8\u540c\u503c\u7684\u65e5\u671f\uff0c\u4f46\u901a\u8fc7\u6307\u5b9a\u5173\u952e\u5b57\u53c2\u6570\u7ed9\u5b9a\u65b0\u503c\u7684\u53c2\u6570\u9664\u5916 | | date.timetuple() | \u8fd4\u56de\u5e26\u6709time.localtime()\u7684\u5143\u7ec4\u7c7b\u578b\u65f6\u95f4 | | date.toordinal() |  | | date.weekday() | \u4ee5\u6574\u6570\u5f62\u5f0f\u8fd4\u56de\u661f\u671f\u51e0\uff0c\u661f\u671f\u4e00\u4e3a0,\u661f\u671f\u65e5\u4e3a6\uff0c\u4f8b\u5982\uff1adate(2019, 11, 23).weekday() | | date.isoweekday() | \u4ee5\u6574\u6570\u5f62\u5f0f\u8fd4\u56de\u661f\u671f\u51e0\uff0c\u661f\u671f\u4e00\u4e3a1\uff0c\u661f\u671f\u65e5\u4e3a7 | | date.isocalendar() | \u8fd4\u56de\u4e00\u4e2a\u4e09\u5143\u7ec4(iso\u5e74\uff0ciso\u5468\u53f7\uff0ciso\u5de5\u4f5c\u65e5) | | date.isoformat() | \u8fd4\u56de\u4ee5iso8601\u683c\u5f0f\u8868\u793a\u7684\u65e5\u671f\u7684\u5b57\u7b26\u4e32YYY-MM-DD | | date.str() | \u4f8b\u5982\uff1a\u5bf9\u4e8e\u65e5\u671fd\uff0cstr(d)\u7b49\u540c\u4e8ed.isoformat() | | date.ctime() | \u8fd4\u56de\u8868\u793a\u65e5\u671f\u7684\u5b57\u7b26\u4e32\uff0c\u7b49\u6548\u4e8etime.ctime(time.mktime(d.timetuple())) | | date.strftime() | \u8fd4\u56de\u8868\u793a\u65e5\u671f\u7684\u5b57\u7b26\u4e32\uff0c\u7531\u660e\u786e\u7684\u683c\u5f0f\u63a7\u5236 | | date.format() | \u4e0edate.strftime()\u76f8\u540c\uff0c\u8fd9\u6837date\u5728\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u4ee5\u53ca\u4e3a\u5bf9\u8c61\u6307\u5b9a\u683c\u5f0f\u5b57\u7b26\u4e32 |</p>"},{"location":"coding/Python3/#datetime_3","title":"datetime\u5bf9\u8c61","text":"<p>datetime\u662f\u5305\u542b\u4ecedate\u5bf9\u8c61\u548ctime\u5bf9\u8c61\u7684\u6240\u6709\u4fe1\u606f\u7684\u5355\u72ec\u5bf9\u8c61,\u6ce8\u610f\u6b64datetime\u662f\u7531datetime\u7c7b\u4ea7\u751f\u7684datetime\u5b9e\u4f8b\u5bf9\u8c61</p> <p>\u7c7b\u65b9\u6cd5\uff1a</p> datetime.datetime() \u5e74\u6708\u65e5\u4e3a\u5fc5\u987b\u53c2\u6570\uff0ctzinfo\u53ef\u4ee5\u662fNone\u6216tzinfo\u5b50\u7c7b\u7684\u5b9e\u4f8b\uff0cfold\u53c2\u6570\u8303\u56f4\u5728[0, 1]\u5217\u8868\u4e2d datetime.today() \u901a\u8fc7\u8fd4\u56de\u5f53\u524d\u672c\u5730\u65e5\u671f\u65f6\u95f4 datetime.now(tz=None) \u8fd4\u56de\u5f53\u524d\u7684\u672c\u5730\u65e5\u671f\u548c\u65f6\u95f4\uff0ctz\u503c\u4e0d\u662fnone\u65f6\uff0c\u5fc5\u987b\u4e3atzinfo\u5b50\u7c7b\u7684\u5b9e\u4f8b\u4e14\u5f53\u524d\u65e5\u671f\u548c\u65f6\u95f4\u5c06\u8f6c\u6362\u4e3atz\u7684\u65f6\u533a datetime.utcnow() \u8fd4\u56de\u5f53\u524dutc\u65e5\u671f\u548c\u65f6\u95f4 datetime.fromtimestamp() \u8fd4\u56de\u4e0ePOSIX\u65f6\u95f4\u6233\u76f8\u5bf9\u5e94\u7684\u672c\u5730\u65e5\u671f\u548c\u65f6\u95f4 datetime.utcfromtimestamp() \u8fd4\u56de\u4e0edatetimePOSIX\u65f6\u95f4\u6233\u76f8\u5bf9\u5e94\u7684UTC\u65f6\u95f4 datetime.fromordinal() datetime.combine() \u8fd4\u56de\u4e00\u4e2a\u65b0datetime\u5bf9\u8c61\uff0c\u5176\u65e5\u671f\u5206\u91cf\u7b49\u4e8e\u7ed9\u5b9adate\u5bf9\u8c61\u7684\u65e5\u671f\uff0c\u5e76\u4e14\u5176\u65f6\u95f4\u5206\u91cf\u7b49\u4e8e\u7ed9\u5b9atime\u5bf9\u8c61\u7684\u65e5\u671f\u3002\u5982\u679c\u63d0\u4f9b\u4e86tzinfo \u53c2\u6570\uff0c\u5219\u4f7f\u7528\u5176\u503c\u8bbe\u7f6etzinfo\u7ed3\u679c\u7684tzinfo\u5c5e\u6027\uff0c\u5426\u5219\u4f7f\u7528time\u53c2\u6570\u7684\u5c5e\u6027 datetime.fromisoformat() \u8fd4\u56dedatetime\u4e0edate_string\u5bf9\u5e94\u7684\u683c\u5f0f datetime.fromisocalendar() \u8fd4\u56dedatetime\u4e0e\u6309\u5e74\uff0c\u5468\u548c\u65e5\u6307\u5b9a\u7684ISO\u65e5\u5386\u65e5\u671f\u76f8\u5bf9\u5e94\u7684\u65e5\u671f\u3002datetime\u7684\u975e\u65e5\u671f\u90e8\u5206\u5c06\u4f7f\u7528\u5176\u9ed8\u8ba4\u503c\u586b\u5145 datetime.strptime() \u8fd4\u56dedatetime\u4e0edate_string\u76f8\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u5e76\u6839\u636eformat\u8fdb\u884c\u89e3\u6790"},{"location":"coding/Python3/#time","title":"time\u5bf9\u8c61","text":"<p>time\u5bf9\u8c61\u8868\u793a\u4e00\u5929\u4e2d\u7684\uff08\u672c\u5730\uff09\u65f6\u95f4\uff0c\u4e0e\u4efb\u4f55\u7279\u5b9a\u7684\u65e5\u671f\u65e0\u5173\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7tzinfo\u5bf9\u8c61\u8fdb\u884c\u8c03\u6574</p> <p>time\u5b9e\u4f8b\u65b9\u6cd5\uff1a</p> time.isoformat() \u4ee5ISO 8601\u683c\u5f0f\u8fd4\u56de\u4ee3\u8868\u65f6\u95f4\u7684\u5b57\u7b26\u4e32 time.strftime() \u8fd4\u56de\u8868\u793a\u65f6\u95f4\u7684\u5b57\u7b26\u4e32\uff0c\u7531\u660e\u786e\u7684\u683c\u5f0f\u5b57\u7b26\u4e32\u63a7\u5236,\u53c2\u8003\u4ee5\u4e0bstrftime\u548cstrptime\u884c\u4e3a <p>\u4e0b\u8868\u63d0\u4f9b\u4e86strftime()\u4e0estrptime()\u7684\u9ad8\u7ea7\u6bd4\u8f83</p> strftime strftime \u7528\u6cd5 \u6839\u636e\u7ed9\u5b9a\u7684\u683c\u5f0f\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 \u5c06\u5b57\u7b26\u4e32\u89e3\u6790\u4e3a\u7ed9\u5b9a\u76f8\u5e94\u683c\u5f0f\u7684 datetime \u5bf9\u8c61 \u65b9\u6cd5\u7c7b\u578b \u5b9e\u4f8b\u65b9\u6cd5 \u7c7b\u65b9\u6cd5 \u65b9\u6cd5 date\u3001datetime\u3001time datetime Signature strftime(format) strptime(date_string, format) <p>strftime()\u548cstrptime()\u683c\u5f0f\u4ee3\u7801</p> <p>date,datetime,time\u5bf9\u8c61\u90fd\u652f\u6301strftime()\u65b9\u6cd5\u7528\u4e8e\u4ee5\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u65f6\u95f4\uff0c\u76f8\u53cd\uff0cstriptime()\u65b9\u6cd5\u4ece\u65e5\u671f\u6216\u65f6\u95f4\u7684\u5b57\u7b26\u4e32\u8fd4\u56de\u4e00\u4e2adatetime\u5bf9\u8c61</p> strftime strptime \u7528\u6cd5 strftime(format) strptime(date_string, format) <p>| \u65b9\u6cd5\u7c7b\u578b |  |  | | method of |  |  | | signature |  |  | |  |  |  | |  |  |  |</p>"},{"location":"coding/Python3/#calendar","title":"calendar\u4e0e\u65e5\u5386\u76f8\u5173\u529f\u80fd","text":"<p>calendar.Calendar(firstweekday=0),\u521b\u5efa\u4e00\u4e2aCalendar\u5bf9\u8c61\uff0cfirstweekday\u662f\u4e00\u4e2a\u6574\u6570\uff0c\u6307\u5b9a\u4e00\u5468\u7b2c\u4e00\u5929\uff0c\u9ed8\u8ba4\u4e3a0\u4ee3\u8868\u5468\u4e00</p> <p>Calendar\u5b9e\u4f8b\u5177\u6709\u4ee5\u4e0b\u65b9\u6cd5</p> iterweekdays() \u8fd4\u56de\u7528\u4e8e\u4e00\u5468\u661f\u671f\u51e0\u7684\u8fed\u4ee3\u5668\uff0c\u8fed\u4ee3\u5668\u7684\u7b2c\u4e00\u4e2a\u503c\u548cfirstweekday\u5c5e\u6027\u503c\u76f8\u540c itermonthdates() \u8fd4\u56de\u4e00\u5e741-12\u6708\u7684\u8fed\u4ee3\u5668\uff0c\u8be5\u8fed\u4ee3\u5668\u5c06\u8fd4\u56dedatetime.date\u8be5\u6708\u7684\u6240\u6709\u5929\uff08\u4f5c\u4e3a\u5bf9\u8c61\uff09\uff0c\u4ee5\u53ca\u8fd4\u56de\u4e00\u4e2a\u5b8c\u6574\u661f\u671f\u6240\u9700\u7684\u6708\u521d\u6216\u6708\u672b\u4e4b\u540e\u7684\u6240\u6709\u5929 itermonthdays() \u8fd4\u56de\u5929\u6570\u4e3a\u6708\u4efd\u4e2d\u7684\u5929\u6570\uff0c\u5bf9\u4e8e\u6708\u4efd\u4ee5\u5916\u7684\u65e5\u671f\uff0c\u5929\u6570\u4e3a0 itermonthdays2() \u8fd4\u56de\u5929\u6570\u4e3a\u5143\u7ec4\uff0c\u5b83\u7531\u4e00\u4e2a\u6708\u4e2d\u7684\u4e00\u53f7\u548c\u4e00\u4e2a\u5de5\u4f5c\u65e5\u53f7(\u661f\u671f\u51e0)\u7ec4\u6210 itermonthdays3() \u8fd4\u56de\u5929\u6570\u4e3a\u5143\u7ec4\uff0c\u5b83\u7531\u4e00\u5e74\uff0c\u4e00\u4e2a\u6708\u548c\u4e00\u4e2a\u6708\u4e2d\u7684\u7b2c\u51e0\u5929\u7ec4\u6210 itermonthdays4() \u8fd4\u56de\u5929\u6570\u4e3a\u5143\u7ec4\uff0c\u5b83\u7531\u4e00\u5e74\uff0c\u4e00\u4e2a\u6708\uff0c\u4e00\u4e2a\u6708\u4e2d\u7684\u7b2c\u51e0\u5929\u4ee5\u53ca\u4e00\u4e2a\u5de5\u4f5c\u65e5\u53f7(\u661f\u671f\u51e0)\u7684\u7ec4\u6210 monthdatescalendar() \u4ee5\u5217\u8868\u5f62\u5f0f\u8fd4\u56de\u6bcf\u6708\u7684\u661f\u671f\u5217\u8868\uff0c\u6bcf\u5468\u5217\u8868\u662f\u4e03\u4e2adatetime.date\u5bf9\u8c61\u7684\u5217\u8868 monthdayscalendar() \u8fd4\u56de\u8be5\u6708\u7684\u5468\u5217\u8868\uff0c\u5468\u5217\u8868\u662f\u5de5\u4f5c\u65e5\u53f7\u7ec4\u6210 mongthdays2calendar() \u8fd4\u56de\u8be5\u6708\u7684\u5468\u5217\u8868\uff0c\u5468\u5217\u8868\u7531\u65e5\u671f\u548c\u5de5\u4f5c\u65e5\u7ec4\u6210\u7684\u4e03\u4e2a\u5143\u7ec4\u7ec4\u6210 yeardatescalendar() \u8fd4\u56de\u6307\u5b9a\u5e74\u4efd\u51c6\u5907\u683c\u5f0f\u5316\u7684\u6570\u636e\u3002\u8fd4\u56de\u503c\u662f\u6708\u4efd\u884c\u7684\u5217\u8868\u3002\u6bcf\u4e2a\u6708\u884c\u6700\u591a\u5305\u542b\u5bbd\u5ea6\u6708,\u6bcf\u5468\u5305\u542b1-7\u5929\u3002\u5929\u662fdatetime.date\u5bf9\u8c61 yeardays2calendar() \u8fd4\u56de\u5468\u5217\u8868\uff0c\u5468\u5217\u8868\u4e3a\u5929\u6570\u548c\u5de5\u4f5c\u65e5\u7684\u5143\u7ec4\uff0c\u8be5\u6708\u4ee5\u5916\u7684\u5929\u6570\u4e3a0 yeardayscalendar() \u5468\u5217\u8868\u4e3a\u5929\u6570\uff0c\u8be5\u6708\u4ee5\u5916\u7684\u5929\u6570\u4e3a0 <p>\u6b64\u7c7b\u7528\u4e8e\u751f\u6210\u7eaf\u6587\u672c\u65e5\u5386TextCalendar\u5b9e\u4f8b\u5177\u6709\u4ee5\u4e0b\u65b9\u6cd5</p> formatmonth() \u4ee5\u591a\u884c\u5b57\u7b26\u4e32\u8fd4\u56de\u4e00\u4e2a\u6708\u65e5\u5386\uff0cw\u4e3a\u5bbd\u5ea6\uff0cl\u4e3a\u884c\u6570 prmonth() \u4ee5formatmonth()\u8fd4\u56de\u503c\u76f4\u63a5\u6253\u5370\u4e00\u4e2a\u6708\u7684\u65e5\u5386 formatyear() \u4ee5\u591a\u884c\u5b57\u7b26\u4e32\u8fd4\u56de\u4e00\u5e74\u7684\u65e5\u5386 pryear() \u4ee5formatyear()\u8fd4\u56de\u503c\u76f4\u63a5\u6253\u5370\u4e00\u5e74\u7684\u65e5\u5386 <p>\u6b64\u7c7b\u7528\u4e8e\u751f\u6210html\u65e5\u5386\uff0cHTMLCalendar\u5b9e\u4f8b\u65b9\u6cd5</p> formatmonth() \u4ee5html\u8868\u683c\u8fd4\u56de\u4e00\u4e2a\u6708\u7684\u65e5\u5386 formatyear() \u4ee5html\u8868\u683c\u8fd4\u56de\u4e00\u5e74\u7684\u65e5\u5386 formatyearpage() \u4ee5\u5b8c\u6574\u7684html\u9875\u9762\u8fd4\u56de\u4e00\u5e74\u7684\u65e5\u5386\uff0ccss\u53c2\u6570\u4e3a\u8981\u4f7f\u7528\u7684\u7ea7\u8054\u6837\u5f0f\u8868\u7684\u540d\u79f0\uff0cNone\u5219\u4e0d\u4f7f\u7528\u6837\u5f0f\u8868 <p>TextCalendar\u5b50\u7c7bLocaleTextCalendar()\u53ef\u4ee5\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4f20\u9012\u4e00\u4e2a\u8bed\u8a00\u73af\u5883\u540d\u79f0\uff0c\u5c06\u5728\u6307\u5b9a\u7684\u8bed\u8a00\u73af\u5883\u4e2d\u8fd4\u56de\u6708\u4efd\u548c\u5de5\u4f5c\u65e5 HTMLCalendar\u5b50\u7c7bLocaleHtmlCalendar()\u53ef\u4ee5\u5728\u6784\u9020\u51fd\u6570\u4e2d\u4f20\u9012\u4e00\u4e2a\u8bed\u8a00\u73af\u5883\u540d\u79f0\uff0c\u5c06\u5728\u6307\u5b9a\u7684\u8bed\u8a00\u73af\u5883\u4e2d\u8fd4\u56de\u6708\u4efd\u548c\u5de5\u4f5c\u65e5</p> <p>calendar\u7c7b\u7684\u65b9\u6cd5</p> setfirstweekday() \u5c06\u67d0\u5de5\u4f5c\u65e5\u8bbe\u7f6e\u4e3a\u4e00\u5468\u7684\u5f00\u59cb firstweekday() \u8fd4\u56de\u6bcf\u4e2a\u661f\u671f\u5f00\u59cb\u7684\u5de5\u4f5c\u65e5\u8bbe\u7f6e isleap() \u5224\u65ad\u662f\u5426\u4e3a\u95f0\u5e74\uff0c\u662f\u5219\u4e3aTrue\uff0c\u5426\u5219\u4e3aFalse leapdays(y1, y2) \u8fd4\u56dey1\u81f3y2(\u4e0d\u5305\u62ecy2)\u7684\u5e74\u6570 weekday() \u8fd4\u56de\u6307\u5b9a\u5e74\u6708\u65e5\u5bf9\u5e94\u7684\u5de5\u4f5c\u65e5\u53f7 weekheader() \u8fd4\u56de\u5305\u542b\u5de5\u4f5c\u65e5\u540d\u79f0\u7f29\u5199\u7684\u5934,n\u8868\u793a\u8fd4\u56de\u5934\u7684\u5bbd\u5ea6 monthrange() \u8fd4\u56de\u6307\u5b9a\u5e74\u6708\u4e2d\u7b2c\u4e00\u5929\u7684\u5de5\u4f5c\u65e5\u53f7\u548c\u6708\u4efd\u7684\u5929\u6570 monthcalendar() \u8fd4\u56de\u4ee3\u8868\u4e00\u4e2a\u6708\u65e5\u5386\u7684\u5468\u5217\u8868\uff0c\u6708\u4efd\u4ee5\u5916\u7684\u75280\u8868\u793a\uff0c\u9ed8\u8ba4\u4ee5\u6bcf\u4e2a\u661f\u671f\u661f\u671f\u4e00\u5f00\u59cb\uff0c\u9664\u975esetfirstweekday()\u6307\u5b9a\u661f\u671f prmonth() \u901a\u8fc7formatmonth()\u8fd4\u56de\u6708\u4efd\u65e5\u5386"},{"location":"coding/Python3/#collections","title":"collections\u5bb9\u5668\u6570\u636e\u7c7b\u578b","text":"<p>\u6807\u51c6\u5185\u5efa\u5bb9\u5668\u6709dict\u3001list\u3001set\u3001tuple\uff0ccollections\u5b9e\u73b0\u7279\u5b9a\u7684\u5bb9\u5668</p> namedtuple() \u521b\u5efa\u547d\u540d\u5143\u7ec4\u5b50\u7c7b\u7684\u5de5\u5382\u51fd\u6570 deque \u7c7b\u4f3c\u5217\u8868(list)\u7684\u5bb9\u5668\uff0c\u5b9e\u73b0\u4e86\u5728\u4e24\u7aef\u5feb\u901f\u6dfb\u52a0(append)\u548c\u5f39\u51fa(pop) ChainMap \u7c7b\u4f3c\u5b57\u5178(dict)\u7684\u5bb9\u5668\u7c7b\uff0c\u5c06\u591a\u4e2a\u6620\u5c04\u96c6\u5408\u5230\u4e00\u4e2a\u89c6\u56fe\u91cc\u9762 Counter \u5b57\u5178\u7684\u5b50\u7c7b\uff0c\u63d0\u4f9b\u4e86\u53ef\u54c8\u5e0c\u5bf9\u8c61\u7684\u8ba1\u6570\u529f\u80fd OrderedDict \u5b57\u5178\u7684\u5b50\u7c7b\uff0c\u4fdd\u5b58\u4e86\u4ed6\u4eec\u88ab\u6dfb\u52a0\u7684\u987a\u5e8f defaultdict \u5b57\u5178\u7684\u5b50\u7c7b\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5de5\u5382\u51fd\u6570\uff0c\u4e3a\u5b57\u5178\u67e5\u8be2\u63d0\u4f9b\u4e00\u4e2a\u9ed8\u8ba4\u503c UserDict \u5c01\u88c5\u4e86\u5b57\u5178\u5bf9\u8c61\uff0c\u7b80\u5316\u4e86\u5b57\u5178\u5b50\u7c7b\u5316 UserList \u5c01\u88c5\u4e86\u5217\u8868\u5bf9\u8c61\uff0c\u7b80\u5316\u4e86\u5217\u8868\u5b50\u7c7b\u5316 UserString \u5c01\u88c5\u4e86\u5217\u8868\u5bf9\u8c61\uff0c\u7b80\u5316\u4e86\u5b57\u7b26\u4e32\u5b50\u7c7b\u5316 <p>Counter\u5bf9\u8c61 \u4e00\u4e2aCounter\u662f\u4e00\u4e2adict\u7684\u5b50\u7c7b\uff0c\u7528\u4e8e\u8ba1\u6570\u53ef\u54c8\u5e0c\u5bf9\u8c61\uff1b\u5b83\u662f\u4e00\u4e2a\u96c6\u5408\uff0c\u5143\u7d20\u50cf\u5b57\u5178\u952e(key)\u4e00\u6837\u5b58\u50a8\uff0c\u8ba1\u6570\u53ef\u4ee5\u662f\u4efb\u4f55\u6574\u6570\u503c\uff0c\u5305\u62ec0\u548c\u8d1f\u6570</p> Python<pre><code># \u8bb0\u5f55\u5355\u8bcd\u5728\u5217\u8868\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\ncnt = collections.Counter()\nfor word in ['red', 'blue', 'red', 'green', 'blue', 'blue']:\n    cnt[word] += 1\nprint(cnt)  # \u8f93\u51faCounter({'blue': 3, 'red': 2, 'green': 1})\n\n# \u627e\u51fa\u300a\u54c8\u59c6\u96f7\u7279\u300b\u4e2d\u6700\u5e38\u89c1\u7684\u4e24\u4e2a\u5355\u8bcd\nimport re\nwords = re.findall(r'\\w+', open('hamlet.txt').read().lower())\nprint(collections.Counter(words).most_common(2))  # \u8f93\u51fa[('the', 34545), ('and', 22226)]\n</code></pre> <p>collections.abc --- \u5bb9\u5668\u7684\u62bd\u8c61\u57fa\u7c7b heapq --- \u5806\u961f\u5217\u7b97\u6cd5 bisect --- \u6570\u7ec4\u4e8c\u5206\u67e5\u627e\u7b97\u6cd5 array --- \u9ad8\u6548\u7684\u6570\u503c\u6570\u7ec4 weakref --- \u5f31\u5f15\u7528 types --- \u52a8\u6001\u7c7b\u578b\u521b\u5efa\u548c\u5185\u7f6e\u7c7b\u578b\u540d\u79f0</p>"},{"location":"coding/Python3/#copyshallowdeep","title":"copy\u6d45\u5c42(shallow)\u548c\u6df1\u5c42(deep)\u590d\u5236","text":"<p>\u6d45\u5c42\u590d\u5236\u548c\u6df1\u5c42\u590d\u5236\u4e4b\u95f4\u7684\u533a\u522b\u4ec5\u4e0e\u590d\u5408\u5bf9\u8c61 (\u5373\u5305\u542b\u5176\u4ed6\u5bf9\u8c61\u7684\u5bf9\u8c61\uff0c\u5982\u5217\u8868\u6216\u7c7b\u7684\u5b9e\u4f8b) \u76f8\u5173</p> <ol> <li>\u4e00\u4e2a \u6d45\u5c42\u590d\u5236 \u4f1a\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u590d\u5408\u5bf9\u8c61\uff0c\u7136\u540e\uff08\u5728\u53ef\u80fd\u7684\u8303\u56f4\u5185\uff09\u5c06\u539f\u5bf9\u8c61\u4e2d\u627e\u5230\u7684 \u5f15\u7528 \u63d2\u5165\u5176\u4e2d</li> <li>\u4e00\u4e2a \u6df1\u5c42\u590d\u5236 \u4f1a\u6784\u9020\u4e00\u4e2a\u65b0\u7684\u590d\u5408\u5bf9\u8c61\uff0c\u7136\u540e\u9012\u5f52\u5730\u5c06\u539f\u59cb\u5bf9\u8c61\u4e2d\u6240\u627e\u5230\u7684\u5bf9\u8c61\u7684 \u526f\u672c \u63d2\u5165</li> </ol> <p>\u6df1\u5ea6\u590d\u5236\u64cd\u4f5c\u901a\u5e38\u5b58\u5728\u4e24\u4e2a\u95ee\u9898, \u800c\u6d45\u5c42\u590d\u5236\u64cd\u4f5c\u5e76\u4e0d\u5b58\u5728\u8fd9\u4e9b\u95ee\u9898\uff1a</p> <ol> <li>\u9012\u5f52\u5bf9\u8c61 (\u76f4\u63a5\u6216\u95f4\u63a5\u5305\u542b\u5bf9\u81ea\u8eab\u5f15\u7528\u7684\u590d\u5408\u5bf9\u8c61) \u53ef\u80fd\u4f1a\u5bfc\u81f4\u9012\u5f52\u5faa\u73af\u3002</li> <li>\u7531\u4e8e\u6df1\u5c42\u590d\u5236\u4f1a\u590d\u5236\u6240\u6709\u5185\u5bb9\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u8fc7\u591a\u590d\u5236\uff08\u4f8b\u5982\u672c\u5e94\u8be5\u5728\u526f\u672c\u4e4b\u95f4\u5171\u4eab\u7684\u6570\u636e\uff09</li> </ol> <p>\u6df1\u5c42\u590d\u5236\u907f\u514d\u4ee5\u4e0a\u95ee\u9898\u65b9\u6cd5\uff1a\u4fdd\u7559\u5728\u5f53\u524d\u590d\u5236\u8fc7\u7a0b\u4e2d\u5df2\u590d\u5236\u7684\u5bf9\u8c61\u7684 \"\u5907\u5fd8\u5f55\"(memo)\u5b57\u5178\uff1b\u4ee5\u53ca\u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u7684\u7c7b\u91cd\u8f7d\u590d\u5236\u64cd\u4f5c\u6216\u590d\u5236\u7684\u7ec4\u4ef6\u96c6\u5408</p> <p>\u8be5\u6a21\u5757\u4e0d\u590d\u5236\u6a21\u5757\u3001\u65b9\u6cd5\u3001\u6808\u8ffd\u8e2a\uff08stack trace\uff09\u3001\u6808\u5e27\uff08stack frame\uff09\u3001\u6587\u4ef6\u3001\u5957\u63a5\u5b57\u3001\u7a97\u53e3\u3001\u6570\u7ec4\u4ee5\u53ca\u4efb\u4f55\u7c7b\u4f3c\u7684\u7c7b\u578b\u3002\u5b83\u901a\u8fc7\u4e0d\u6539\u53d8\u5730\u8fd4\u56de\u539f\u59cb\u5bf9\u8c61\u6765\uff08\u6d45\u5c42\u6216\u6df1\u5c42\u5730\uff09\u201c\u590d\u5236\u201d\u51fd\u6570\u548c\u7c7b\uff1b\u8fd9\u4e0e pickle \u6a21\u5757\u5904\u7406\u8fd9\u7c7b\u95ee\u9898\u7684\u65b9\u5f0f\u662f\u76f8\u4f3c\u7684</p>"},{"location":"coding/Python3/#pprint","title":"pprint\u6570\u636e\u8f93\u51fa\u7f8e\u5316","text":""},{"location":"coding/Python3/#mathmath","title":"math\u548cmath\u6a21\u5757","text":""},{"location":"coding/Python3/#numbers_1","title":"numbers\u6570\u5b57\u7684\u62bd\u8c61\u57fa\u7c7b","text":""},{"location":"coding/Python3/#math","title":"math\u6570\u5b66\u51fd\u6570","text":""},{"location":"coding/Python3/#cmath-","title":"cmath --- \u5173\u4e8e\u590d\u6570\u7684\u6570\u5b66\u51fd\u6570","text":""},{"location":"coding/Python3/#decimal-","title":"decimal --- \u5341\u8fdb\u5236\u5b9a\u70b9\u548c\u6d6e\u70b9\u8fd0\u7b97","text":""},{"location":"coding/Python3/#fractions-","title":"fractions --- \u5206\u6570","text":""},{"location":"coding/Python3/#random-","title":"random --- \u751f\u6210\u4f2a\u968f\u673a\u6570","text":""},{"location":"coding/Python3/#bookkeeping","title":"bookkeeping\u51fd\u6570","text":"seed() \u968f\u673a\u6570\u751f\u6210\u5668\u7684\u79cd\u5b50 getstate() \u8fd4\u56de\u6355\u83b7\u5230\u7684\u751f\u6210\u5668\u5f53\u524d\u5185\u90e8\u72b6\u6001\u7684\u5bf9\u8c61\uff0c\u6b64\u5bf9\u8c61\u53ef\u4f20\u9012\u7ed9setstate()\u6765\u6062\u590d\u72b6\u6001 setstate() \u5c06\u751f\u6210\u5668\u5185\u90e8\u72b6\u6001\u6062\u590d\u5230\u88abgetstate()\u8c03\u7528\u65f6\u7684\u72b6\u6001 getrandbits(k) \u8fd4\u56de\u5e26\u6709k\u4f4d\u7684\u968f\u673apython\u6574\u6570\uff0c\u53ef\u7528randrange()\u6765\u5904\u7406\u4efb\u610f\u5927\u8303\u56f4 Python<pre><code>random.seed(42)\nprint(random.sample(range(20), k=10))\nst = random.getstate()  # remeber this state\nprint(random.sample(range(20), k=20))  # print 20\nrandom.setstate(st)     # restore state\nprint(random.sample(range(20), k=12))  # print same first 10\n</code></pre>"},{"location":"coding/Python3/#_41","title":"\u7528\u4e8e\u6574\u6570\u7684\u51fd\u6570","text":"randrange() \u4ece range(start, stop, step) \u8fd4\u56de\u4e00\u4e2a\u968f\u673a\u9009\u62e9\u7684\u5143\u7d20\u76f8\u5f53\u4e8echoice(range(start, stop, step)) \uff0c\u4f46\u5b9e\u9645\u4e0a\u5e76\u6ca1\u6709\u6784\u5efa\u4e00\u4e2a range \u5bf9\u8c61 randint() \u8fd4\u56de\u968f\u673a\u6574\u6570 N \u6ee1\u8db3 a &lt;= N &lt;= b\u3002\u76f8\u5f53\u4e8e randrange(a, b+1)"},{"location":"coding/Python3/#_42","title":"\u7528\u4e8e\u5e8f\u5217\u7684\u51fd\u6570","text":"choice(seq) \u4ece\u975e\u7a7a\u5e8f\u5217 seq \u8fd4\u56de\u4e00\u4e2a\u968f\u673a\u5143\u7d20\u3002 \u5982\u679c seq \u4e3a\u7a7a\uff0c\u5219\u5f15\u53d1 IndexError choices(population, weights=None, *, cum_weights=None, k=1) \u4ece*population*\u4e2d\u9009\u62e9\u66ff\u6362\uff0c\u8fd4\u56de\u5927\u5c0f\u4e3a k \u7684\u5143\u7d20\u5217\u8868\u3002 \u5982\u679c population \u4e3a\u7a7a\uff0c\u5219\u5f15\u53d1 IndexError shuffe(x[, random]) \u5c06\u5e8f\u5217 x \u968f\u673a\u6253\u4e71\u4f4d\u7f6e"},{"location":"coding/Python3/#statistics-","title":"statistics --- \u6570\u5b66\u7edf\u8ba1\u51fd\u6570","text":""},{"location":"coding/Python3/#file-directory-access","title":"File &amp; Directory access","text":""},{"location":"coding/Python3/#_43","title":"\u6587\u4ef6\u5bf9\u8c61\u7684\u65b9\u6cd5","text":"<p>open()\u51fd\u6570\u6253\u5f00\u6587\u4ef6\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u6587\u4ef6\u5bf9\u8c61 \u8bed\u6cd5\u683c\u5f0f\u4e3a\uff1aopen(file, mode='r', buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</p> <ul> <li>file: \u5fc5\u9700\uff0c\u6587\u4ef6\u8def\u5f84\uff08\u76f8\u5bf9\u6216\u8005\u7edd\u5bf9\u8def\u5f84\uff09</li> <li>mode: \u53ef\u9009\uff0c\u51b3\u5b9a\u4e86\u6253\u5f00\u6587\u4ef6\u7684\u6a21\u5f0f\uff1a\u53ea\u8bfb\uff0c\u5199\u5165\uff0c\u8ffd\u52a0\u7b49\u3002\u53ef\u9009\u53c2\u6570\uff0c\u9ed8\u8ba4\u6a21\u5f0f\u53ea\u8bfb\u00ae</li> <li>buffering: \u7528\u4e8e\u8bbe\u7f6e\u7f13\u51b2\u7b56\u7565\u7684\u53ef\u9009\u6574\u6570\uff0c\u4f20\u90120\u6765\u5173\u95ed\u7f13\u51b2\uff08\u4ec5\u5728\u4e8c\u8fdb\u5236\u6a21\u5f0f\u4e0b\u5141\u8bb8\uff09\uff0c\u4f20\u90121\u6765\u9009\u62e9\u884c\u7f13\u51b2\uff08\u4ec5\u5728\u6587\u672c\u6a21\u5f0f\u4e0b\u53ef\u7528\uff09\uff0c\u4f20\u9012\u4e00\u4e2a\u5927\u4e8e1\u7684\u6574\u6570\u4ee5\u6307\u793a\u56fa\u5b9a\u5927\u5c0f\u7684\u5757\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5927\u5c0f</li> <li>encoding: \u7528\u4e8e\u89e3\u7801\u6216\u7f16\u7801\u6587\u4ef6\u7684\u7f16\u7801\u7684\u540d\u79f0\uff0c\u4ec5\u5728\u6587\u672c\u6a21\u5f0f\u4e0b\u4f7f\u7528</li> <li>errors: \u53ef\u9009\u5b57\u7b26\u4e32\uff0c\u6307\u5b9a\u5904\u7406\u7f16\u7801\u548c\u7f16\u7801\u9519\u8bef\u7684\u65b9\u5f0f\uff0c\u4e0d\u80fd\u5728\u4e8c\u8fdb\u5236\u6a21\u5f0f\u4e0b\u4f7f\u7528</li> <li>newline: \u63a7\u5236\u6362\u884c\uff0c\u4ec5\u7528\u4e8e\u6587\u672c\u6a21\u5f0f</li> <li>closefd: \u82e5closefd\u662fFalse\u5e76\u4e14\u7ed9\u51fa\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\u800c\u4e0d\u662f\u6587\u4ef6\u540d\uff0c\u5219\u5728\u5173\u95ed\u6587\u4ef6\u65f6\uff0c\u5e95\u5c42\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c06\u4fdd\u6301\u6253\u5f00\u72b6\u6001\u3002\u5982\u679c\u7ed9\u5b9a\u6587\u4ef6\u540d\uff0cclosefd\u5fc5\u987b\u4e3aTrue\uff08\u9ed8\u8ba4\uff09\uff0c\u5426\u5219\u5c06\u5f15\u53d1\u9519\u8bef</li> <li>opener:\u53ef\u4ee5\u901a\u8fc7\u4f20\u9012\u53ef\u8c03\u7528\u7684opener\u6765\u4f7f\u7528\u81ea\u5b9a\u4e49opener\u3002\u7136\u540e\u901a\u8fc7\u4f7f\u7528\uff08file,flags\uff09\u8c03\u7528opener\u83b7\u5f97\u6587\u4ef6\u5bf9\u8c61\u7684\u57fa\u7840\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002opener\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</li> </ul> <p>mode\u53ef\u7528\u6a21\u5f0f\u6709\uff1a</p> \u6a21\u5f0f \u63cf\u8ff0 r \u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u6587\u4ef6(\u9ed8\u8ba4\u6a21\u5f0f) rb \u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7528\u4e8e\u53ea\u8bfb r+ \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199 rb+ \u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199 w \u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u5199\u5165\u3002\u9996\u5148\u622a\u65ad\u6587\u4ef6\uff0c\u5373\u6709\u5185\u5bb9\u4f1a\u88ab\u6e05\u9664\u8986\u76d6 wb \u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u5199\u5165\u3002\u9996\u5148\u622a\u65ad\u6587\u4ef6\uff0c\u5373\u6709\u5185\u5bb9\u4f1a\u88ab\u6e05\u9664\u8986\u76d6 w+ \u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199\u3002\u9996\u5148\u622a\u65ad\u6587\u4ef6\uff0c\u5373\u6709\u5185\u5bb9\u4f1a\u88ab\u6e05\u9664\u8986\u4ef6 a \u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u8ffd\u52a0\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u65b0\u6587\u4ef6\u8fdb\u884c\u5199\u5165 ab \u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u8ffd\u52a0\u3002\u65b0\u7684\u5185\u5bb9\u5c06\u4f1a\u88ab\u5199\u5165\u5230\u5df2\u6709\u5185\u5bb9\u4e4b\u540e\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u65b0\u6587\u4ef6\u8fdb\u884c\u5199\u5165 a+ \u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199\u3002\u6587\u4ef6\u5df2\u5b58\u5728\u662f\u8ffd\u52a0\u6a21\u5f0f\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u65b0\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199 ab+ \u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u6253\u5f00\u6587\u4ef6\u7528\u4e8e\u8ffd\u52a0\u3002\u5982\u679c\u8be5\u6587\u4ef6\u5df2\u5b58\u5728\u5219\u8ffd\u52a0\uff0c\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u521b\u5efa\u65b0\u6587\u4ef6\u7528\u4e8e\u8bfb\u5199 <p>mode\u6a21\u5f0f\u53ca\u5bf9\u5e94\u652f\u6301\u64cd\u4f5c\u8868\uff1a</p> \u6a21\u5f0f r r+ w w+ a a+ \u8bfb yes yes yes yes \u5199 yes yes yes yes yes \u521b\u5efa yes yes yes yes \u8986\u76d6 yes yes \u4ece\u6587\u4ef6\u5f00\u5934\u8bfb\u5199 yes yes yes yes \u4ece\u6587\u4ef6\u7ed3\u5c3e\u8bfb\u5199 yes yes <p>\u6587\u4ef6\u5bf9\u8c61\u5e38\u7528\u65b9\u6cd5</p> file.close() \u5173\u95ed\u6587\u4ef6\u3002\u5173\u95ed\u540e\u6587\u4ef6\u4e0d\u80fd\u518d\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c file.flush() \u5237\u65b0\u6587\u4ef6\u5185\u90e8\u7f13\u51b2\uff0c\u76f4\u63a5\u628a\u5185\u90e8\u7f13\u51b2\u533a\u7684\u6570\u636e\u7acb\u523b\u5199\u5165\u6587\u4ef6, \u800c\u4e0d\u662f\u88ab\u52a8\u7684\u7b49\u5f85\u8f93\u51fa\u7f13\u51b2\u533a\u5199\u5165 file.fileno() \u8fd4\u56de\u4e00\u4e2a\u6574\u578b\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26(file descriptor FD \u6574\u578b, \u53ef\u4ee5\u7528\u5728\u5982os\u6a21\u5757\u7684read\u65b9\u6cd5\u7b49\u4e00\u4e9b\u5e95\u5c42\u64cd\u4f5c\u4e0a file.isatty() \u5982\u679c\u6587\u4ef6\u8fde\u63a5\u5230\u4e00\u4e2a\u7ec8\u7aef\u8bbe\u5907\u8fd4\u56de True\uff0c\u5426\u5219\u8fd4\u56de False file.next() \u8fd4\u56de\u6587\u4ef6\u4e0b\u4e00\u884c file.read([size]) \u4ece\u6587\u4ef6\u8bfb\u53d6\u6307\u5b9a\u7684\u5b57\u8282\u6570\uff0c\u5982\u679c\u672a\u7ed9\u5b9a\u6216\u4e3a\u8d1f\u5219\u8bfb\u53d6\u6240\u6709 file.readline([size]) \u8bfb\u53d6\u6574\u884c\uff0c\u5305\u62ec \"\\n\" \u5b57\u7b26 file.readlines([sizehint]) \u8bfb\u53d6\u6240\u6709\u884c\u5e76\u8fd4\u56de\u5217\u8868\uff0c\u82e5\u7ed9\u5b9asizeint&gt;0\uff0c\u8fd4\u56de\u603b\u548c\u5927\u7ea6\u4e3asizeint\u5b57\u8282\u7684\u884c,\u5b9e\u9645\u8bfb\u53d6\u503c\u53ef\u80fd\u6bd4sizeint\u8f83\u5927, \u56e0\u4e3a\u9700\u8981\u586b\u5145\u7f13\u51b2\u533a file.seek(offset[, whence]) \u8bbe\u7f6e\u6587\u4ef6\u5f53\u524d\u4f4d\u7f6e file.tell() \u8fd4\u56de\u6587\u4ef6\u5f53\u524d\u4f4d\u7f6e file.truncate([size]) \u622a\u53d6\u6587\u4ef6\uff0c\u622a\u53d6\u7684\u5b57\u8282\u901a\u8fc7size\u6307\u5b9a\uff0c\u9ed8\u8ba4\u4e3a\u5f53\u524d\u6587\u4ef6\u4f4d\u7f6e file.write(str) \u5c06\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6\uff0c\u8fd4\u56de\u7684\u662f\u5199\u5165\u7684\u5b57\u7b26\u957f\u5ea6 file.writelines(sequence) \u5411\u6587\u4ef6\u5199\u5165\u4e00\u4e2a\u5e8f\u5217\u5b57\u7b26\u4e32\u5217\u8868\uff0c\u5982\u679c\u9700\u8981\u6362\u884c\u5219\u8981\u81ea\u5df1\u52a0\u5165\u6bcf\u884c\u7684\u6362\u884c\u7b26 <p>OS\u6587\u4ef6\u6216\u76ee\u5f55\u65b9\u6cd5</p> \u65b9\u6cd5 \u63cf\u8ff0 os.access(path, mode) \u68c0\u9a8c\u6743\u9650\u6a21\u5f0f os.chdir(path) \u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 os.chflags(path, flags) \u8bbe\u7f6e\u8def\u5f84\u7684\u6807\u8bb0\u4e3a\u6570\u5b57\u6807\u8bb0 os.chmod(path, mode) \u66f4\u6539\u6743\u9650 os.chown(path, uid, gid) \u66f4\u6539\u6587\u4ef6\u6240\u6709\u8005 os.chroot(path) \u6539\u53d8\u5f53\u524d\u8fdb\u7a0b\u7684\u6839\u76ee\u5f55 os.close(fd) \u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26 fd os.closerange(fd_low, fd_high) \u5173\u95ed\u6240\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ece fd_low (\u5305\u542b\uff09\u5230 fd_high (\u4e0d\u5305\u542b\uff09\u9519\u8bef\u4f1a\u5ffd\u7565 os.dup(fd) \u590d\u5236\u6587\u4ef6\u63cf\u8ff0\u7b26 fd os.dup2(fd, fd2) \u5c06\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 fd \u590d\u5236\u5230\u53e6\u4e00\u4e2a fd2 os.fchdir(fd) \u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u6539\u53d8\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 os.fchmod(fd, mode) \u6539\u53d8\u4e00\u4e2a\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u8be5\u6587\u4ef6\u7531\u53c2\u6570fd\u6307\u5b9a\uff0c\u53c2\u6570mode\u662fUnix\u4e0b\u7684\u6587\u4ef6\u8bbf\u95ee\u6743\u9650 os.fchown(fd, uid, gid) \u4fee\u6539\u4e00\u4e2a\u6587\u4ef6\u7684\u6240\u6709\u6743\uff0c\u8fd9\u4e2a\u51fd\u6570\u4fee\u6539\u4e00\u4e2a\u6587\u4ef6\u7684\u7528\u6237ID\u548c\u7528\u6237\u7ec4ID\uff0c\u8be5\u6587\u4ef6\u7531\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u6307\u5b9a os.fdatasync(fd) \u5f3a\u5236\u5c06\u6587\u4ef6\u5199\u5165\u78c1\u76d8\uff0c\u8be5\u6587\u4ef6\u7531\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u6307\u5b9a\uff0c\u4f46\u662f\u4e0d\u5f3a\u5236\u66f4\u65b0\u6587\u4ef6\u7684\u72b6\u6001\u4fe1\u606f os.fdopen(fd[, mode[, bufsize]]) \u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26 fd \u521b\u5efa\u4e00\u4e2a\u6587\u4ef6\u5bf9\u8c61\uff0c\u5e76\u8fd4\u56de\u8fd9\u4e2a\u6587\u4ef6\u5bf9\u8c61 os.fpathconf(fd, name) \u8fd4\u56de\u4e00\u4e2a\u6253\u5f00\u7684\u6587\u4ef6\u7684\u7cfb\u7edf\u914d\u7f6e\u4fe1\u606f\u3002name\u4e3a\u68c0\u7d22\u7684\u7cfb\u7edf\u914d\u7f6e\u7684\u503c\uff0c\u5b83\u4e5f\u8bb8\u662f\u4e00\u4e2a\u5b9a\u4e49\u7cfb\u7edf\u503c\u7684\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e9b\u540d\u5b57\u5728\u5f88\u591a\u6807\u51c6\u4e2d\u6307\u5b9a\uff08POSIX.1, Unix 95, Unix 98, \u548c\u5176\u5b83\uff09 os.fstat(fd) \u8fd4\u56de\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u7684\u72b6\u6001\uff0c\u50cfstat( os.fstatvfs(fd) \u8fd4\u56de\u5305\u542b\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u7684\u6587\u4ef6\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u4fe1\u606f\uff0c\u50cf statvfs( os.fsync(fd) \u5f3a\u5236\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e3afd\u7684\u6587\u4ef6\u5199\u5165\u786c\u76d8 os.ftruncate(fd, length) \u88c1\u526a\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u5bf9\u5e94\u7684\u6587\u4ef6, \u6240\u4ee5\u5b83\u6700\u5927\u4e0d\u80fd\u8d85\u8fc7\u6587\u4ef6\u5927\u5c0f os.getcwd() \u8fd4\u56de\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55 os.getcwdu() \u8fd4\u56de\u4e00\u4e2a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u7684Unicode\u5bf9\u8c61 os.isatty(fd) \u5982\u679c\u6587\u4ef6\u63cf\u8ff0\u7b26fd\u662f\u6253\u5f00\u7684\uff0c\u540c\u65f6\u4e0etty(-like)\u8bbe\u5907\u76f8\u8fde\uff0c\u5219\u8fd4\u56detrue, \u5426\u5219False os.lchflags(path, flags) \u8bbe\u7f6e\u8def\u5f84\u7684\u6807\u8bb0\u4e3a\u6570\u5b57\u6807\u8bb0\uff0c\u7c7b\u4f3c chflags()\uff0c\u4f46\u662f\u6ca1\u6709\u8f6f\u94fe\u63a5 os.lchmod(path, mode) \u4fee\u6539\u8fde\u63a5\u6587\u4ef6\u6743\u9650 os.lchown(path, uid, gid) \u66f4\u6539\u6587\u4ef6\u6240\u6709\u8005\uff0c\u7c7b\u4f3c chown\uff0c\u4f46\u662f\u4e0d\u8ffd\u8e2a\u94fe\u63a5 os.link(src, dst) \u521b\u5efa\u786c\u94fe\u63a5\uff0c\u540d\u4e3a\u53c2\u6570 dst\uff0c\u6307\u5411\u53c2\u6570 src os.listdir(path) \u8fd4\u56depath\u6307\u5b9a\u7684\u6587\u4ef6\u5939\u5305\u542b\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u7684\u540d\u5b57\u7684\u5217\u8868 os.lseek(fd, pos, how) \u8bbe\u7f6e\u6587\u4ef6\u63cf\u8ff0\u7b26 fd\u5f53\u524d\u4f4d\u7f6e\u4e3apos, how\u65b9\u5f0f\u4fee\u6539: SEEK_SET \u6216\u8005 0 \u8bbe\u7f6e\u4ece\u6587\u4ef6\u5f00\u59cb\u7684\u8ba1\u7b97\u7684pos;SEEK_CUR\u6216\u8005 1 \u5219\u4ece\u5f53\u524d\u4f4d\u7f6e\u8ba1\u7b97; os.SEEK_END\u6216\u80052\u5219\u4ece\u6587\u4ef6\u5c3e\u90e8\u5f00\u59cb. \u5728unix\uff0cWindows\u4e2d\u6709\u6548 os.lstat(path) \u50cfstat() os.major(device) \u4ece\u539f\u59cb\u7684\u8bbe\u5907\u53f7\u4e2d\u63d0\u53d6\u8bbe\u5907major\u53f7\u7801,\u4f7f\u7528stat\u4e2d\u7684st_dev\u6216\u8005st_rdev field),\u4f46\u662f\u6ca1\u6709\u8f6f\u94fe\u63a5 os.makedev(major, minor) \u4ee5major\u548cminor\u8bbe\u5907\u53f7\u7ec4\u6210\u4e00\u4e2a\u539f\u59cb\u8bbe\u5907\u53f7 os.makedirs(path[, mode]) \u9012\u5f52\u6587\u4ef6\u5939\u521b\u5efa\u51fd\u6570\u3002\u50cfmkdir(), \u4f46\u521b\u5efa\u7684\u6240\u6709intermediate-level\u6587\u4ef6\u5939\u9700\u8981\u5305\u542b\u5b50\u6587\u4ef6\u5939 os.minor(device) \u4ece\u539f\u59cb\u7684\u8bbe\u5907\u53f7\u4e2d\u63d0\u53d6\u8bbe\u5907minor\u53f7\u7801,\u4f7f\u7528stat\u4e2d\u7684st_dev\u6216\u8005st_rdev field os.mkdir(path[, mode]) \u4ee5\u6570\u5b57mode\u7684mode\u521b\u5efa\u4e00\u4e2a\u540d\u4e3apath\u7684\u6587\u4ef6\u5939.\u9ed8\u8ba4\u7684 mode \u662f 0777 (\u516b\u8fdb\u5236) os.mkfifo(path[, mode]) \u521b\u5efa\u547d\u540d\u7ba1\u9053\uff0cmode \u4e3a\u6570\u5b57\uff0c\u9ed8\u8ba4\u4e3a 0666 (\u516b\u8fdb\u5236 os.mknod(filename[, mode=0600, device]) \u521b\u5efa\u4e00\u4e2a\u540d\u4e3afilename\u6587\u4ef6\u7cfb\u7edf\u8282\u70b9\uff08\u6587\u4ef6\uff0c\u8bbe\u5907\u7279\u522b\u6587\u4ef6\u6216\u8005\u547d\u540dpipe\uff09 os.open(file, flags[, mode]) \u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u4e14\u8bbe\u7f6e\u9700\u8981\u7684\u6253\u5f00\u9009\u9879\uff0cmode\u53c2\u6570\u662f\u53ef\u9009\u7684 os.openpty() \u6253\u5f00\u4e00\u4e2a\u65b0\u7684\u4f2a\u7ec8\u7aef\u5bf9\u3002\u8fd4\u56de pty \u548c tty\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26 os.pathconf(path, name) \u8fd4\u56de\u76f8\u5173\u6587\u4ef6\u7684\u7cfb\u7edf\u914d\u7f6e\u4fe1\u606f os.pipe() \u521b\u5efa\u4e00\u4e2a\u7ba1\u9053. \u8fd4\u56de\u4e00\u5bf9\u6587\u4ef6\u63cf\u8ff0\u7b26(r, w)\u5206\u522b\u4e3a\u8bfb\u548c\u5199 os.popen(command[, mode[, bufsize]]) \u4ece\u4e00\u4e2a command \u6253\u5f00\u4e00\u4e2a\u7ba1\u9053 os.read(fd, n) \u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26 fd \u4e2d\u8bfb\u53d6\u6700\u591a n \u4e2a\u5b57\u8282\uff0c\u8fd4\u56de\u5305\u542b\u8bfb\u53d6\u5b57\u8282\u7684\u5b57\u7b26\u4e32\uff0c\u6587\u4ef6\u63cf\u8ff0\u7b26 fd\u5bf9\u5e94\u6587\u4ef6\u5df2\u8fbe\u5230\u7ed3\u5c3e, \u8fd4\u56de\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32 os.readlink(path) \u8fd4\u56de\u8f6f\u94fe\u63a5\u6240\u6307\u5411\u7684\u6587\u4ef6 os.remove(path) \u5220\u9664\u8def\u5f84\u4e3apath\u7684\u6587\u4ef6\u3002\u5982\u679cpath \u662f\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u5c06\u629b\u51faOSError; \u67e5\u770b\u4e0b\u9762\u7684rmdir()\u5220\u9664\u4e00\u4e2a directory os.removedirs(path) \u9012\u5f52\u5220\u9664\u76ee\u5f55 os.rename(src, dst) \u91cd\u547d\u540d\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u4ece src \u5230 dst os.renames(old, new) \u9012\u5f52\u5730\u5bf9\u76ee\u5f55\u8fdb\u884c\u66f4\u540d\uff0c\u4e5f\u53ef\u4ee5\u5bf9\u6587\u4ef6\u8fdb\u884c\u66f4\u540d os.rmdir(path) \u5220\u9664path\u6307\u5b9a\u7684\u7a7a\u76ee\u5f55\uff0c\u5982\u679c\u76ee\u5f55\u975e\u7a7a\uff0c\u5219\u629b\u51fa\u4e00\u4e2aOSError\u5f02\u5e38 os.stat(path) \u83b7\u53d6path\u6307\u5b9a\u7684\u8def\u5f84\u7684\u4fe1\u606f\uff0c\u529f\u80fd\u7b49\u540c\u4e8eC API\u4e2d\u7684stat()\u7cfb\u7edf\u8c03\u7528 os.stat_float_times([newvalue]) \u51b3\u5b9astat_result\u662f\u5426\u4ee5float\u5bf9\u8c61\u663e\u793a\u65f6\u95f4\u6233 os.statvfs(path) \u83b7\u53d6\u6307\u5b9a\u8def\u5f84\u7684\u6587\u4ef6\u7cfb\u7edf\u7edf\u8ba1\u4fe1\u606f os.symlink(src, dst) \u521b\u5efa\u4e00\u4e2a\u8f6f\u94fe\u63a5 os.tcgetpgrp(fd) \u8fd4\u56de\u4e0e\u7ec8\u7aeffd\uff08\u4e00\u4e2a\u7531os.open()\u8fd4\u56de\u7684\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u5173\u8054\u7684\u8fdb\u7a0b\u7ec4 os.tcsetpgrp(fd, pg) \u8bbe\u7f6e\u4e0e\u7ec8\u7aeffd\uff08\u4e00\u4e2a\u7531os.open()\u8fd4\u56de\u7684\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u5173\u8054\u7684\u8fdb\u7a0b\u7ec4\u4e3apg os.tempnam([dir[, prefix]]) Python3 \u4e2d\u5df2\u5220\u9664\u3002\u8fd4\u56de\u552f\u4e00\u7684\u8def\u5f84\u540d\u7528\u4e8e\u521b\u5efa\u4e34\u65f6\u6587\u4ef6 os.tmpfile() Python3 \u4e2d\u5df2\u5220\u9664\u3002\u8fd4\u56de\u4e00\u4e2a\u6253\u5f00\u7684\u6a21\u5f0f\u4e3a(w+b)\u7684\u6587\u4ef6\u5bf9\u8c61 .\u8fd9\u6587\u4ef6\u5bf9\u8c61\u6ca1\u6709\u6587\u4ef6\u5939\u5165\u53e3\uff0c\u6ca1\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5c06\u4f1a\u81ea\u52a8\u5220\u9664 os.tmpnam() Python3 \u4e2d\u5df2\u5220\u9664\u3002\u4e3a\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u8fd4\u56de\u4e00\u4e2a\u552f\u4e00\u7684\u8def\u5f84 os.ttyname(fd) \u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5b83\u8868\u793a\u4e0e\u6587\u4ef6\u63cf\u8ff0\u7b26fd \u5173\u8054\u7684\u7ec8\u7aef\u8bbe\u5907\u3002\u5982\u679cfd \u6ca1\u6709\u4e0e\u7ec8\u7aef\u8bbe\u5907\u5173\u8054\uff0c\u5219\u5f15\u53d1\u4e00\u4e2a\u5f02\u5e38 os.unlink(path) \u5220\u9664\u6587\u4ef6\u8def\u5f84 os.utime(path, times) \u8fd4\u56de\u6307\u5b9a\u7684path\u6587\u4ef6\u7684\u8bbf\u95ee\u548c\u4fee\u6539\u7684\u65f6\u95f4 os.walk(top[, topdown=True[, onerror=None[, followlinks=False]]]) \u8f93\u51fa\u5728\u6587\u4ef6\u5939\u4e2d\u7684\u6587\u4ef6\u540d\u901a\u8fc7\u5728\u6811\u4e2d\u6e38\u8d70\uff0c\u5411\u4e0a\u6216\u8005\u5411\u4e0b os.write(fd, str) \u5199\u5165\u5b57\u7b26\u4e32\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26 fd\u4e2d. \u8fd4\u56de\u5b9e\u9645\u5199\u5165\u7684\u5b57\u7b26\u4e32\u957f\u5ea6 os.path \u6a21\u5757) \u83b7\u53d6\u6587\u4ef6\u7684\u5c5e\u6027\u4fe1\u606f"},{"location":"coding/Python3/#pythonjson","title":"python\u8bfb\u5199json","text":"Markdown<pre><code>\u5e8f\u5217\u5316\uff1a\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u9002\u5408\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u6216\u5b58\u50a8\u5728\u6587\u4ef6\u6216\u6570\u636e\u5e93\u4e2d\u7684\u7279\u6b8a\u683c\u5f0f\u7684\u8fc7\u7a0b\u79f0\u4e3a\u5e8f\u5217\u5316\n\u53cd\u5e8f\u5217\u5316\uff1a\u4e0e\u5e8f\u5217\u5316\u76f8\u53cd\u3002\u5b83\u5c06\u5e8f\u5217\u5316\u8fd4\u56de\u7684\u7279\u6b8a\u683c\u5f0f\u8f6c\u6362\u56de\u53ef\u7528\u7684\u5bf9\u8c61\n\n\u4f8b\u5982\u5904\u7406JSON\u683c\u5f0f\u65f6\uff0c\u5f53\u6211\u4eec\u5e8f\u5217\u5316\u5bf9\u8c61\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5c06Python\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32(dump()\u8fdb\u884c\u5e8f\u5217\u5316)\uff0c\n\u53cd\u5e8f\u5217\u5316\u5219\u901a\u8fc7\u5176JSON\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u6784\u5efaPython\u5bf9\u8c61(load()\u53cd\u5e8f\u5217\u5316)\n</code></pre>"},{"location":"coding/Python3/#dump","title":"dump()\u5e8f\u5217\u5316","text":"Python<pre><code>\"\"\"\ndump()\u51fd\u6570\u7528\u4e8e\u5e8f\u5217\u5316\u6570\u636e\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2apython\u5bf9\u8c61\uff0c\u5bf9\u5176\u8fdb\u884c\u5e8f\u5217\u5316\u7136\u540e\u8f93\u51fajson\u5b57\u7b26\u4e32\n\u8bed\u6cd5\uff1adump(obj, fp)\nobj\uff1a\u8981\u8fdb\u884c\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\nfp\uff1a\u7c7b\u4f3c\u6587\u4ef6\u7684\u5bf9\u8c61\uff0c\u5c06\u628a\u5e8f\u5217\u5316\u6570\u636e\u5199\u5165\u5230\u6b64\u5bf9\u8c61\n\"\"\"\nimport json\n\n\n# \u521b\u5efapython\u5b57\u5178\u7c7b\u578b\u53d8\u91cfperson\nperson = {\n    \"first_name\": \"John\",\n    \"isAlive\": True,\n    \"age\": 27,\n    \"address\": {\n        \"streetAddress\": \"21 2nd Street\",\n        \"city\": \"New York\",\n        \"state\": \"NY\",\n        \"postalCode\": \"10021-3100\"\n    },\n    \"hasMortgage\": None\n}\n\n# \u6ce8\u610f\u4e8b\u9879\uff1a\u5728\u5e8f\u5217\u5316\u5bf9\u8c61\u65f6\uff0cPython\u7684\u7c7b\u578bNone\u5c06\u8f6c\u6362\u4e3aJSON\u7684null\u7c7b\u578b\nwith open('person.json', 'w') as f:     # \u5c06json\u5bf9\u8c61person\u5199\u5165\u5230person.json\u6587\u4ef6\n    json.dump(person, f)\n\nopen('person.json', 'r').read()     # \u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8bfb\u53d6JSON\u5bf9\u8c61\n</code></pre> <p>\u5e8f\u5217\u5316\u6570\u636e\u65f6\u7c7b\u578b\u4e4b\u95f4\u7684\u8f6c\u6362\uff1a</p> PYTHON TYPE JSON TYPE dict object list,\u00a0tuple array int number float number str string TRUE TRUE FALSE FALSE None null <p>\u53cd\u5e8f\u5217\u5316\u6570\u636e\u65f6\u7c7b\u578b\u4e4b\u95f4\u7684\u8f6c\u6362\uff1a</p> JSON TYPE PYTHON TYPE object dict array list string str number\u00a0(int) int number\u00a0(real) float TRUE TRUE FALSE FALSE null None"},{"location":"coding/Python3/#load","title":"load()\u53cd\u5e8f\u5217\u5316","text":"Python<pre><code>import json\n# load()\u51fd\u6570\u4ece\u7c7b\u4f3c\u4e8eobject\u7684\u6587\u4ef6\u4e2d\u53cd\u5e8f\u5217\u5316JSON\u5bf9\u8c61\u5e76\u8fd4\u56de\nwith open('person.json', 'r') as f:\n    person = json.load(f)\n</code></pre>"},{"location":"coding/Python3/#dumpsloads","title":"dumps()\u548cloads()","text":"Python<pre><code># dumps()\u548cdump()\u51fd\u6570\u5de5\u4f5c\u65b9\u5f0f\u76f8\u540c\uff0c\u4f46\u4e0d\u662f\u5c06\u8f93\u51fa\u53d1\u9001\u5230\u7c7b\u6587\u4ef6\u7684\u5bf9\u8c61\uff0c\u800c\u662f\u5c06\u8f93\u51fa\u4f5c\u4e3a\u5b57\u7b26\u4e32\u8fd4\u56de\n# loads()\u548cload()\u51fd\u6570\u4e5f\u4e00\u6837\uff0c\u4f46\u4e0d\u662f\u4ece\u6587\u4ef6\u4e2d\u53cd\u5e8f\u5217\u5316json\u5b57\u7b26\u4e32\uff0c\u800c\u662f\u4ece\u53cd\u5e8f\u5217\u5316\u4e00\u4e2a\u5b57\u7b26\u4e32\n</code></pre>"},{"location":"coding/Python3/#pickle","title":"pickle","text":"Python<pre><code># pickle\u6a21\u5757\u4ee5\u4e8c\u8fdb\u5236\u683c\u5f0f\u5e8f\u5217\u5316\u6570\u636e\uff0c\u63d0\u4f9b\u63a5\u53e3\u548cjson\u6a21\u5757\u76f8\u540c\uff0cload\u548cdump\n# \u8bed\u6cd5\uff1adump(obj, file)\n# obj\uff1a\u9700\u8981\u5e8f\u5217\u5316\u7684\u6570\u636e\u5bf9\u8c61\n# file\uff1a\u5c06\u5e8f\u5217\u5316\u7684\u6570\u636e\u5bf9\u8c61\u5199\u5165\u5230\u6587\u4ef6\u5bf9\u8c61\n</code></pre>"},{"location":"coding/Python3/#_44","title":"\u5f00\u53d1\u8005\u5de5\u5177","text":""},{"location":"coding/Python3/#unittest","title":"unittest","text":"<p>unittest.TestCase\u7c7b\u4e2d\u63d0\u4f9b\u4e86\u5f88\u591a\u65ad\u8a00\u65b9\u6cd5\uff0c\u65ad\u8a00\u65b9\u6cd5\u7528\u4e8e\u68c0\u9a8c\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\u671f\u671b\u7684\u7ed3\u679c</p> <p>unittest\u7c7b\u7684\u65ad\u8a00\u65b9\u6cd5</p> \u65b9\u6cd5 \u7528\u9014 assertEqual(a, b) \u6838\u5b9ea == b assertNotEqual(a, b) \u6838\u5b9ea != b assertTrue(x) \u6838\u5b9ex\u4e3aTrue assertFalse(x) \u6838\u5b9ex\u4e3aFalse assertIn(item, list) \u6838\u5b9eitem\u5728list\u4e2d assertNotIn(item, list) \u6838\u5b9eitem\u4e0d\u5728list\u4e2d"},{"location":"coding/Python3/#_45","title":"\u591a\u7ebf\u7a0b","text":"Markdown<pre><code>\u7ebf\u7a0b\u662f\u4e00\u79cd\u7528\u4e8e\u89e3\u8026\u4e0e\u987a\u5e8f\u65e0\u5173\u7684\u4efb\u52a1\u7684\u6280\u672f\u3002\u7ebf\u7a0b\u53ef\u7528\u4e8e\u63d0\u9ad8\u5728\u540e\u53f0\u8fd0\u884c\u5176\u4ed6\u4efb\u52a1\u65f6\u63a5\u53d7\u7528\u6237\u8f93\u5165\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u54cd\u5e94\u80fd\u529b\u3002\n\u4e00\u4e2a\u76f8\u5173\u7684\u7528\u4f8b\u662f\u4e0e\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u7684\u8ba1\u7b97\u5e76\u884c\u8fd0\u884cI/O\n\n\u4ee5\u4e0b\u4ee3\u7801\u663e\u793a\u4e86\u9ad8\u7ea7threading\u6a21\u5757\u5982\u4f55\u5728\u4e3b\u7a0b\u5e8f\u7ee7\u7eed\u8fd0\u884c\u7684\u540c\u65f6\u5728\u540e\u53f0\u8fd0\u884c\u4efb\u52a1\uff1a\n\nimport threading, zipfile\n\nclass AsyncZip(threading.Thread):\n    def __init__(self, infile, outfile):\n        threading.Thread.__init__(self)\n        self.infile = infile\n        self.outfile = outfile\n\n    def run(self):\n        f = zipfile.ZipFile(self.outfile, 'w', zipfile.ZIP_DEFLATED)\n        f.write(self.infile)\n        f.close()\n        print('Finished background zip of:', self.infile)\n\nbackground = AsyncZip('mydata.txt', 'myarchive.zip')\nbackground.start()\nprint('The main program continues to run in foreground.')\n\nbackground.join()    # Wait for the background task to finish\nprint('Main program waited until background was done.')\n\n\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\u7684\u4e3b\u8981\u6311\u6218\u662f\u534f\u8c03\u5171\u4eab\u6570\u636e\u6216\u5176\u4ed6\u8d44\u6e90\u7684\u7ebf\u7a0b\u3002\u4e3a\u6b64\uff0c\u7ebf\u7a0b\u6a21\u5757\u63d0\u4f9b\u4e86\u8bb8\u591a\u540c\u6b65\u539f\u8bed\uff0c\u5305\u62ec\u9501\uff0c\u4e8b\u4ef6\uff0c\u6761\u4ef6\u53d8\u91cf\u548c\u4fe1\u53f7\u91cf\u3002\n\n\u5c3d\u7ba1\u8fd9\u4e9b\u5de5\u5177\u529f\u80fd\u5f3a\u5927\uff0c\u4f46\u662f\u8f83\u5c0f\u7684\u8bbe\u8ba1\u9519\u8bef\u53ef\u80fd\u4f1a\u5bfc\u81f4\u96be\u4ee5\u91cd\u73b0\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u4efb\u52a1\u534f\u8c03\u7684\u9996\u9009\u65b9\u6cd5\u662f\u5c06\u6240\u6709\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u96c6\u4e2d\u5728\u5355\u4e2a\u7ebf\u7a0b\u4e2d\uff0c\n\u7136\u540e\u4f7f\u7528\u8be5queue\u6a21\u5757\u4e3a\u8be5\u7ebf\u7a0b\u63d0\u4f9b\u6765\u81ea\u5176\u4ed6\u7ebf\u7a0b\u7684\u8bf7\u6c42\u3002\u4f7f\u7528Queue\u5bf9\u8c61\u8fdb\u884c\u7ebf\u7a0b\u95f4\u901a\u4fe1\u548c\u534f\u8c03\u7684\u5e94\u7528\u7a0b\u5e8f\u66f4\u6613\u4e8e\u8bbe\u8ba1\uff0c\u66f4\u5177\u53ef\u8bfb\u6027\u548c\u53ef\u9760\u6027\n</code></pre>"},{"location":"coding/Regex/","title":"\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5206\u7c7b","text":"<ul> <li>\u57fa\u672c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Basic Regular Expression \u53c8\u53ebBasic RegEx \u7b80\u79f0BREs\uff09</li> <li>\u6269\u5c55\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Extended Regular Expression \u53c8\u53ebExtended RegEx \u7b80\u79f0EREs\uff09</li> <li>Perl\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08Perl Regular Expression \u53c8\u53ebPerl RegEx \u7b80\u79f0PREs\uff09</li> </ul> <p>[]\u7b26\u53f7\u5339\u914d\u5b57\u7b26\u96c6\u5408\uff0c\u652f\u6301\u7a77\u4e3e\u65b9\u6cd5\u5339\u914d\u5b57\u7b26\u96c6\u5408\u7684\u6240\u6709\u5143\u7d20\u4e5f\u652f\u6301\u4f7f\u7528-\u7b26\u53f7\u8868\u793a\u96c6\u5408\u8303\u56f4\uff0c^\u7b26\u53f7\u5728[]\u4e2d\u8868\u793a\u53d6\u53cd</p> <p>\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f</p> \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\ \u8f6c\u4e49\u7b26\uff0c\u5c06\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49\uff0c\u5ffd\u7565\u5176\u7279\u6b8a\u610f\u4e49 a.b\u5339\u914da.b\uff0c\u4f46\u4e0d\u80fd\u5339\u914dajb\uff0c.\u88ab\u8f6c\u4e49\u4e3a\u7279\u6b8a\u610f\u4e49 \\ \\ \\ ^ \u5339\u914d\u884c\u9996\uff0cawk\u4e2d\uff0c^\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u5f00\u59cb ^tux\u5339\u914d\u4ee5tux\u5f00\u5934\u7684\u884c ^ ^ ^ $ \u5339\u914d\u884c\u5c3e\uff0cawk\u4e2d\uff0c$\u5219\u662f\u5339\u914d\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e tux$\u5339\u914d\u4ee5tux\u7ed3\u5c3e\u7684\u884c $ $ $ . \u5339\u914d\u9664\u6362\u884c\u7b26\\n\u4e4b\u5916\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff0cawk\u5219\u4e2d\u53ef\u4ee5 ab.\u5339\u914dabc\u6216bad\uff0c\u4e0d\u53ef\u5339\u914dabcd\u6216abde\uff0c\u53ea\u80fd\u5339\u914d\u5355\u5b57\u7b26,\u4f46\u540c\u4e00\u4e2a\u6b63\u5219\u53ef\u4f7f\u7528\u591a\u4e2a\u6765\u5339\u914d\u591a\u4e2a\u5b57\u7b26 . . . [] \u5339\u914d\u5305\u542b\u5728[\u5b57\u7b26]\u4e4b\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 coo[kl]\u53ef\u4ee5\u5339\u914dcook\u6216cool [] [] [] [^] \u5339\u914d[^\u5b57\u7b26]\u4e4b\u5916\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26 123[^45]\u4e0d\u53ef\u4ee5\u5339\u914d1234\u62161235\uff0c1236\u30011237\u90fd\u53ef\u4ee5 [^] [^] [^] [-] \u5339\u914d[]\u4e2d\u6307\u5b9a\u8303\u56f4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u8981\u5199\u6210\u9012\u589e [0-9]\u53ef\u4ee5\u5339\u914d1\u30012\u62163\u7b49\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 [-] [-] [-] ? \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u80050\u6b21 colou?r\u53ef\u4ee5\u5339\u914dcolor\u6216\u8005colour\uff0c\u4e0d\u80fd\u5339\u914dcolouur \u4e0d\u652f\u6301 ? ? + \u5339\u914d\u4e4b\u524d\u7684\u98791\u6b21\u6216\u8005\u591a\u6b21 sa-6+\u5339\u914dsa-6\u3001sa-666\uff0c\u4e0d\u80fd\u5339\u914dsa- \u4e0d\u652f\u6301 + + * \u5339\u914d\u4e4b\u524d\u7684\u98790\u6b21\u6216\u8005\u591a\u6b21 co*l\u5339\u914dcl\u3001col\u3001cool\u3001coool\u7b49 * * * () \u5339\u914d\u8868\u8fbe\u5f0f\uff0c\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u5339\u914d\u7684\u5b50\u4e32 matri?\u5339\u914dmax\u6216maxtrix \u4e0d\u652f\u6301 {n} \u5339\u914d\u4e4b\u524d\u7684\u9879n\u6b21\uff0cn\u662f\u53ef\u4ee5\u4e3a0\u7684\u6b63\u6574\u6570 [0-9]{3}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e09\u4f4d\u6570\uff0c\u53ef\u4ee5\u6269\u5c55\u4e3a[0-9][0-9][0-9] \u4e0d\u652f\u6301 {n} {n} {n,} \u4e4b\u524d\u7684\u9879\u81f3\u5c11\u9700\u8981\u5339\u914dn\u6b21 [0-9]{2,}\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u4e24\u4f4d\u6570\u6216\u66f4\u591a\u4f4d\u6570 \u4e0d\u652f\u6301 {n,} {n,} {n,m} \u6307\u5b9a\u4e4b\u524d\u7684\u9879\u81f3\u5c11\u5339\u914dn\u6b21\uff0c\u6700\u591a\u5339\u914dm\u6b21\uff0cn&lt;=m [0-9]{2,5}\u5339\u914d\u4ece\u4e24\u4f4d\u6570\u5230\u4e94\u4f4d\u6570\u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u4e2a\u6570\u5b57 \u4e0d\u652f\u6301 {n,m} {n,m} | \u4ea4\u66ff\u5339\u914d|\u4e24\u8fb9\u7684\u4efb\u610f\u4e00\u9879 abc d\u5339\u914dabc\u6216abd \u4e0d\u652f\u6301 <p>**POSIX\u5b57\u7b26\u7c7b**\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5[\uff1aCLASS\uff1a]\u5728\u65b9\u62ec\u53f7\u5185\u6307\u5b9a\u5b57\u7b26\u7c7b\uff0c\u5176\u4e2dCLASS\u5728POSIX\u6807\u51c6\u4e2d\u5b9a\u4e49\u5e76\u5177\u6709\u5176\u4e2d\u4e00\u4e2a\u503c \u4f8b\u5982\uff1als -ld [[:digit:]]*   # \u5339\u914d\u4ee5\u6570\u5b57\u547d\u540d\u7684\u6587\u4ef6\u5939</p> \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg [:alnum:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57\u5b57\u7b26 [[:alnum:]]+ [:alnum:] [:alnum:] [:alnum:] [:alpha:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u5b57\u7b26\uff08\u5305\u62ec\u5927\u5c0f\u5199\u5b57\u6bcd\uff09 [[:alpha:]]{4} [:alpha:] [:alpha:] [:alpha:] [:blank:] \u7a7a\u683c\u4e0e\u5236\u8868\u7b26\uff08\u6a2a\u5411\u548c\u7eb5\u5411\uff09 [[:blank:]]* [:blank:] [:blank:] [:blank:] [:digit:] \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u5b57\u7b26 [[:digit:]]? [:digit:] [:digit:] [:digit:] [:lower:] \u5339\u914d\u5c0f\u5199\u5b57\u6bcd [[:lower:]]{5,} [:lower:] [:lower:] [:lower:] [:upper:] \u5339\u914d\u5927\u5199\u5b57\u6bcd [[:upper:]]+? [:upper:] [:upper:] [:upper:] [:punct:] \u5339\u914d\u6807\u70b9\u7b26\u53f7 [[:punct:]] [:punct:] [:punct:] [:punct:] [:space:] \u5339\u914d\u4e00\u4e2a\u5305\u62ec\u6362\u884c\u7b26\u3001\u56de\u8f66\u7b49\u5728\u5185\u7684\u6240\u6709\u7a7a\u767d\u7b26 [[:space:]]+ [:space:] [:space:] [:space:] [:graph:] \u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u770b\u5f97\u89c1\u7684\u4e14\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:graph:]] [:graph:] [:graph:] [:graph:] [:xdigit:] \u4efb\u4f55\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u6570\uff08\u5373\uff1a0-9\uff0ca-f\uff0cA-F\uff09 [[:xdigit:]]+ [:xdigit:] [:xdigit:] [:xdigit: [:cntrl:] \u4efb\u4f55\u4e00\u4e2a\u63a7\u5236\u5b57\u7b26\uff08ASCII\u5b57\u7b26\u96c6\u4e2d\u7684\u524d32\u4e2a\u5b57\u7b26 [[:cntrl:]] [:cntrl:] [:cntrl:] [:cntrl:] [:print:] \u4efb\u4f55\u4e00\u4e2a\u53ef\u4ee5\u6253\u5370\u7684\u5b57\u7b26 [[:print:]] [:print:] [:print:] [:print:] <p>\u5143\u5b57\u7b26\uff08meta character\uff09\u662f\u4e00\u79cdPerl\u98ce\u683c\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ea\u6709\u4e00\u90e8\u5206\u6587\u672c\u5904\u7406\u5de5\u5177\u652f\u6301\u5b83\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6587\u672c\u5904\u7406\u5de5\u5177\u90fd\u652f\u6301</p> \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b Basic RegEx Extended RegEx Python Reg \\b \u5355\u8bcd\u8fb9\u754c \\bcool\\b \u5339\u914dcool\uff0c\u4e0d\u5339\u914dcoolant \\b \\b \\b \\B \u975e\u5355\u8bcd\u8fb9\u754c cool\\B \u5339\u914dcoolant\uff0c\u4e0d\u5339\u914dcool \\B \\B \\B \\d \u5355\u4e2a\u6216\u66f4\u591a\u8fde\u7eed\u7684\u6570\u5b57 b\\db \u5339\u914db2b\uff0c\u4e0d\u5339\u914dbcb \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\d \\D \u5355\u4e2a\u975e\u6570\u5b57\u5b57\u7b26 b\\Db \u5339\u914dbcb\uff0c\u4e0d\u5339\u914db2b \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\D \\w \u5355\u4e2a\u5355\u8bcd\u5b57\u7b26\uff08\u5b57\u6bcd\u3001\u6570\u5b57\u4e0e_\uff09 \\w \u5339\u914d1\u6216a\uff0c\u4e0d\u5339\u914d&amp; \\w \\w \\w \\W \u5339\u914d\u4efb\u610f\u4e0d\u662f\u5b57\u6bcd\uff0c\u6570\u5b57\uff0c\u4e0b\u5212\u7ebf\uff0c\u6c49\u5b57\u7684\u5b57\u7b26 \\W \u5339\u914d&amp;\uff0c\u4e0d\u5339\u914d1\u6216a \\W \\W \\W \\n \u6362\u884c\u7b26 \\n \u5339\u914d\u4e00\u4e2a\u65b0\u884c \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\n \\s \u5355\u4e2a\u7a7a\u767d\u5b57\u7b26 x\\sx \u5339\u914dx x\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\s \\S \u5355\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 x\\S\\x \u5339\u914dxkx\uff0c\u4e0d\u5339\u914dxx \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\S \\r \u56de\u8f66 \\r \u5339\u914d\u56de\u8f66 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\r \\t \u6a2a\u5411\u5236\u8868\u7b26 \\t \u5339\u914d\u4e00\u4e2a\u6a2a\u5411\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\t \\v \u5782\u76f4\u5236\u8868\u7b26 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\v \\f \u6362\u9875\u7b26 \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \\f <p>**\u540e\u5411\u5f15\u7528**\u7528\u4e8e\u91cd\u590d\u641c\u7d22\u524d\u9762\u67d0\u4e2a\u5206\u7ec4\u5339\u914d\u7684\u6587\u672c\uff0cexp(expression)\u4ee3\u8868\u8868\u8fbe\u5f0f,\u5e38\u7528\u5206\u7ec4\u8bed\u6cd5\u5982\u4e0b\uff1a | \u4ee3\u7801/\u8bed\u6cd5 | \u8bf4\u660e | | :------: | :------: | | [^x] | \u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 | | [^aeiou] | \u5339\u914d\u9664\u4e86aeiou\u8fd9\u51e0\u4e2a\u5b57\u6bcd\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 |</p>"},{"location":"coding/Regex/#_2","title":"\u5e38\u7528\u6b63\u5e38\u8868\u8fbe\u5f0f","text":"Text Only<pre><code>\u4ee5\u6c49\u5b57\u5f00\u5934\u7684\u884c\uff1a^[\\u4e00-\\u9fa5]    \u8be6\u89e3\uff1a[\\u4e00-\\u9fa5]\u4ee3\u8868\u4efb\u4f55\u4e00\u4e2a\u6c49\u5b57--\u539f\u7406\uff1aU4300-U9fa5\u4ee3\u8868\u4e86\u7b26\u5408\u6c49\u5b57GB18030\u89c4\u8303\u7684\u5b57\u7b26\u96c6\n\n\u5339\u914d\u81f3\u5c11\u4e00\u4e2a\u6c49\u5b57\uff1a[\\u4E00-\\u9FA5]+\n\n\u7a7a\u884c\u7684\u8868\u793a\u65b9\u6cd5:^$ \u6216\uff1a\\n[\\s|]*\\r\n\n\u5339\u914d\u5305\u542b\u4e00\u4e2a\u5b57\u7b26\u7684\u884c\uff1a^.$\n\n\u5339\u914d\u4e0d\u5728b~d\u8303\u56f4\u7684\u5b57\u7b26\uff1a[^b-d]\n\n\u5339\u914d\u9664\u4e86x\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26\uff1a[^x]\n\n\u5339\u914d\u6240\u6709\u82f1\u6587\u5355\u8bcd\uff1a[A-Za-z][A-Za-z]*\n\n\u7cbe\u786e\u5339\u914d\u5b57\u7b26\uff08\u4f8b\u5982\u7cbe\u786e\u5339\u914d\u5355\u8bcdthe\uff0c\u4e0d\u5339\u914d\u5305\u542bthe\u7684\u5355\u8bcd\uff0c\u5982them\uff0cthey\u7b49\uff09\uff1a\\&lt;the\\&gt;\n\n\u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u91cd\u590dn\u6b21\u7684\u5b57\u7b26\uff1a\\{n\\}\n\n\u4f8b\u5982\u5339\u914d\u503cjooob\uff1ajo\\{3\\}b\n\n\u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u81f3\u5c11\u51fa\u73b0n\u6b21\u7684\u5b57\u7b26\uff1a\\{n,\\}\n\n\u4f8b\u5982\uff1ajo\\{3,\\}b #jooob\u3001joooob\u7b49\u5b57\u7b26\u90fd\u7531\u6b64\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\n\n\u5339\u914d\u524d\u9762\u7684\u5b57\u7b26\u51fa\u73b0n~m\u6b21\u7684\u5b57\u7b26\uff1a\\{n,m\\}\n\n\u4f8b\u5982\uff1ajo{3,6\\}  #\u5339\u914djooob\u3001joooooob\u7b49\u5b57\u7b26\uff0c\u81f3\u5c113\u6b21\uff0c\u6700\u591a6\u6b21\n\n\u7cbe\u786e\u5339\u914d5\u4e2a\u5c0f\u5199\u5b57\u7b26\uff1a[a-z]\\{5\\} #\u5982hello\u3001house\u7b495\u4e2a\u5c0f\u5199\u5355\u8bcd\u6216\u5b57\u7b26\n\n\u5339\u914djob\u6216joob\uff1ajo?b\n\n+\u7b26\u53f7\u548c\u00d7\u7b26\u53f7\u7c7b\u4f3c\uff0c\u5339\u914d\u5176\u524d\u9762\u7684\u5b57\u7b26\u591a\u6b21\uff0c\u4f46\u662f\u00d7\u53ef\u4ee5\u5339\u914d0\u6b21\uff0c\u800c+\u81f3\u5c11\u8981\u5339\u914d1\u6b21\uff1ajo+b\u8868\u793a\uff1ajoob\u3001jooob\u7b49\u5b57\u7b26\uff0cjob\u4e0d\u80fd\u7528\u6b64\u6765\u5339\u914d\n\n()\u548c|\u7b26\u53f7\u7ec4\u5408\u4f7f\u7528\uff0c\u8868\u793a\u4e00\u7ec4\u53ef\u9009\u5b57\u7b26\u7684\u96c6\u5408\uff1are(a|e|o)d\u8868\u8fbe\u5f0f\u4e2d\u7684(a|e|o)\u8868\u793a\uff1a\u5728\u5b57\u7b26a\u3001e\u3001o\u4e2d\u4efb\u610f\u9009\u62e9\u4e00\u4e2a\u5b57\u7b26\uff0c\u5373read\u3001reed\u3001reod\u90fd\u53ef\u4ee5\u7531\u6b64\u8868\u8fbe\u5f0f\u5339\u914d\n()\u5f88\u5c11\u4f7f\u7528\uff0c\u56e0\u4e3a[]\u7b26\u53f7\u53ef\u4ee5\u5b8c\u5168\u66ff\u4ee3\uff0cre(a|e|o)d\u7b49\u4ef7\u4e8ere[aeo]d\n\n\u975e\u8d1f\u6574\u6570\uff1a^\\d+$\n\n\u6b63\u6574\u6570\uff1a^[0-9]*[1-9][0-9]*$\n\n\u975e\u6b63\u6574\u6570\uff1a^((-\\d+)|(0+))$\n\n\u8d1f\u6574\u6570\uff1a^-[0-9]*[1-9][0-9]*$\n\n\u6574\u6570\uff1a^-?\\d+$\n\n\u975e\u8d1f\u6d6e\u70b9\u6570\uff1a^\\d+(\\.\\d+)?$\n\n\u6b63\u6d6e\u70b9\u6570:^((0-9)+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)$\n\n\u975e\u6b63\u6d6e\u70b9\u6570\uff1a^((-\\d+\\.\\d+)?)|(0+(\\.0+)?))$\n\n\u8d1f\u6d6e\u70b9\u6570\uff1a^(-((\u6b63\u6d6e\u70b9\u6570\u6b63\u5219\u5f0f)))$\n\n\u82f1\u6587\u5b57\u7b26\u4e32\uff1a^[A-Za-z]+$\n\n\u82f1\u6587\u5927\u5199\u4e32\uff1a^[A-Z]+$\n\n\u82f1\u6587\u5c0f\u5199\u4e32\uff1a^[a-z]+$\n\n\u82f1\u6587\u5b57\u7b26\u6570\u5b57\u4e32\uff1a^[A-Za-z0-9]+$\n\n\u82f1\u6570\u5b57\u52a0\u4e0b\u5212\u7ebf\u4e32\uff1a^\\w+$\n\nE-mail\u5730\u5740\uff1a^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$ \u6216\uff1a\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*\n\nURL\uff1a^[a-zA-Z]+://(\\w+(-\\w+)*)(\\.(\\w+(-\\w+)*))*(\\?\\s*)?$\n\u6216\uff1a^http:\\/\\/[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&amp;_~`@[\\]\\':+!]*([^&lt;&gt;\\\"\\\"])*$\n\n\u90ae\u653f\u7f16\u7801\uff1a^[1-9]\\d{5}$\n\n\u4e2d\u6587\u5b57\u7b26\uff1a^[\\u0391-\\uFFE5]+$\n\n\u7535\u8bdd\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?(\\(0\\d{2,3}\\)|0\\d{2,3}-)?[1-9]\\d{6,7}(\\-\\d{1,4})?$\n\n\u624b\u673a\u53f7\u7801\uff1a^((\\(\\d{2,3}\\))|(\\d{3}\\-))?13\\d{9}$\n\n\u53cc\u5b57\u8282\u5b57\u7b26(\u5305\u62ec\u6c49\u5b57\u5728\u5185)\uff1a^\\x00-\\xff\n\n\u5339\u914d\u9996\u5c3e\u7a7a\u683c\uff1a(^\\s*)|(\\s*$)\uff08\u50cfvbscript\u90a3\u6837\u7684trim\u51fd\u6570\uff09\n\n\u5339\u914dHTML\u6807\u8bb0\uff1a&lt;(.*)&gt;.*&lt;\\/\\1&gt;|&lt;(.*)\\/&gt;\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u7f51\u7edc\u94fe\u63a5\uff1a(h|H)(r|R)(e|E)(f|F)*=*('|\")?(\\w|\\\\|\\/|\\.)+('|\"|*|&gt;)?\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u90ae\u4ef6\u5730\u5740\uff1a\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)* \u6216 [a-zA-Z0-9\\-_+]+@[A-Za-z]+\\.(com|cn|net)\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u56fe\u7247\u94fe\u63a5\uff1a(s|S)(r|R)(c|C)*=*('|\")?(\\w|\\\\|\\/|\\.)+('|\"|*|&gt;)?\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684IP\u5730\u5740\uff1a(\\d+)\\.(\\d+)\\.(\\d+)\\.(\\d+) \u6216\uff1a((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.){3}(2[0-4]\\d|25[0-5]|[01]?\\d\\d?) \u6216\uff1a^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u624b\u673a\u53f7\u7801\uff1a(86)*0*13\\d{9}\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u56fa\u5b9a\u7535\u8bdd\u53f7\u7801\uff1a(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{8}\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u7535\u8bdd\u53f7\u7801\uff08\u5305\u62ec\u79fb\u52a8\u548c\u56fa\u5b9a\u7535\u8bdd\uff09\uff1a(\\(\\d{3,4}\\)|\\d{3,4}-|\\s)?\\d{7,14}\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4e2d\u56fd\u90ae\u653f\u7f16\u7801\uff1a[1-9]{1}(\\d+){5}\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u6d6e\u70b9\u6570\uff08\u5373\u5c0f\u6570\uff09\uff1a(-?\\d*)\\.?\\d+\n\n\u63d0\u53d6\u4fe1\u606f\u4e2d\u7684\u4efb\u4f55\u6570\u5b57\uff1a(-?\\d*)(\\.\\d+)?\n\n\u7535\u8bdd\u533a\u53f7\uff1a/^0\\d{2,3}$/\n\n\u817e\u8bafQQ\u53f7\uff1a^[1-9]*[1-9][0-9]*$\n\n\u5e10\u53f7(\u5b57\u6bcd\u5f00\u5934\uff0c\u5141\u8bb85-16\u5b57\u8282\uff0c\u5141\u8bb8\u5b57\u6bcd\u6570\u5b57\u4e0b\u5212\u7ebf)\uff1a^[a-zA-Z][a-zA-Z0-9_]{4,15}$\n\n\u4e2d\u6587\u3001\u82f1\u6587\u3001\u6570\u5b57\u53ca\u4e0b\u5212\u7ebf\uff1a^[\\u4e00-\\u9fa5_a-zA-Z0-9]+$\n\nsql\u8bed\u53e5\uff1a^(select|drop|delete|create|update|insert).*$\n\n\u5339\u914d\u884c\u9996\u7a7a\u683c\uff1a^\\s*\n\n\u5339\u914d\u884c\u5c3e\u7a7a\u683c\uff1a\\s*$\n</code></pre> <p>\\&lt; \u5339\u914d\u8bcd\u9996</p> <p>&gt; \u5339\u914d\u8bcd\u5c3e</p> <p>\\b \u5339\u914d\u5355\u8bcd\u8fb9\u754c</p> <p>\u5bf9\u6bd4\u5982\u4e0b\uff1a</p> Bash<pre><code>line=\"cat dog sky\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&gt;\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&lt;\\(.*\\)/# |\\1|\\2|/p\"\necho\nline=\"cat  dog  sky\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&gt;\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&lt;\\(.*\\)/# |\\1|\\2|/p\"\necho\nline=\"cat  dog  sky  \"\necho \"$line\" | sed -n \"s/\\(.*\\)\\b\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&gt;\\(.*\\)/# |\\1|\\2|/p\"\necho \"$line\" | sed -n \"s/\\(.*\\)\\&lt;\\(.*\\)/# |\\1|\\2|/p\"\necho\n\n# \u8f93\u51fa\u5206\u522b\u662f\uff1a\n# |cat dog |sky|\n# |cat dog| sky|\n# |cat dog |sky|\n\n# |cat  dog  |sky|\n# |cat  dog|  sky|\n# |cat  dog  |sky|\n\n# |cat  dog  sky|  |\n# |cat  dog  sky|  |\n# |cat  dog  |sky  |\n</code></pre>"},{"location":"coding/Shell/","title":"shell\u7b14\u8bb0","text":"<p>bash shell\u672c\u8eab\u4e0d\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4f7f\u7528\u6b63\u5219\u7684\u662fshell\u547d\u4ee4\u548c\u5de5\u5177\uff0c\u5982grep\u3001sed\u7b49\u3002bash shell\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u7684\u4e00\u4e9b\u5143\u5b57\u7b26\u5b9e \u73b0\u901a\u914d(Globbing)\u529f\u80fd\u3002\u901a\u914d\u5c31\u662f\u628a\u4e00\u4e2a\u5305\u542b\u901a\u914d\u7b26\u7684\u975e\u5177\u4f53\u6587\u4ef6\u540d\u6269\u5c55\u5b58\u50a8\u5728\u8ba1\u7b97\u673a\u6216\u7f51\u7edc\u4e0a\u7684\u4e00\u6279\u5177\u4f53\u6587\u4ef6\u540d\u7684\u8fc7\u7a0b</p> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ul> <li>\u4e0d\u8981\u4f7f\u7528for\u5faa\u73af\u8bfb\u53d6\u6587\u4ef6\u7684\u884c\u3002\u8bf7\u6539\u7528while\u8bfb\u53d6\u5faa\u73af</li> <li>cat file | grep pattern   \u4e0d\u8981\u4f7f\u7528\u6b64\u65b9\u5f0f\uff0c\u800c\u5e94\u8be5\u4f7f\u7528grep 'pattern' file | sed 'expression'</li> <li>\u4f7f\u7528$(...)\u53d6\u4ee3<code>...</code></li> <li>bash\u6d4b\u8bd5\u65f6\u4f7f\u7528[[]]\u4ee3\u66ff[]\u66f4\u5b89\u5168</li> <li>ls -l | awk '{ print $8 }' \u4e0d\u8981\u89e3\u6790ls\u547d\u4ee4\u7684\u8f93\u51fa\uff0cls\u8f93\u51fa\u5e76\u975e\u5f88\u9760\u8c31</li> <li>for number in $(seq 1 10); do \u4e0d\u8981\u4f7f\u7528seq\u8ba1\u6570</li> <li> <p>i=<code>expr $i + 1</code> \u4e0d\u8981\u4f7f\u7528expr\uff0c\u7528i++\u4ee3\u66ff</p> </li> <li> <p>Reference List</p> </li> <li> <p>Bash Guide for Beginners</p> </li> <li>Advanced Bash-Scripting Guide</li> </ul>"},{"location":"coding/Shell/#shell_1","title":"shell\u591a\u884c\u6ce8\u91ca\u5b9e\u73b0\u65b9\u5f0f","text":"Bash<pre><code>\u65b9\u6cd5\u4e00\uff1a\n: &lt;&lt; \u5b57\u7b26(\u4e00\u822c\u4f7f\u7528comment\u4fbf\u4e8e\u8bc6\u522b)\n\u8bed\u53e5\n\u5b57\u7b26\n\n\u65b9\u6cd5\u4e8c\uff1a\n: '\n\u8bed\u53e5\n'\n</code></pre>"},{"location":"coding/Shell/#eof","title":"EOF\u5e38\u89c1\u7528\u6cd5","text":"Bash<pre><code># \u7f16\u5199SHELL\u663e\u793a\u591a\u4e2a\u4fe1\u606f\ncat &lt;&lt;EOF\n+--------------------------------------------------------------+\n|         === Welcome to Tunoff services ===                   |\n+--------------------------------------------------------------+\nEOF\n\n# \u5c06mongodbrepo\u5199\u5165\u5230mongodb.repo\u6587\u4ef6\ncat &lt;&lt; EOF &gt; /etc/yum.repos.d/mongodb.repo\n[mongodb-org-3.4]\nname=MongoDB 3.4 Repository\nbaseurl=https://mirrors.aliyun.com/mongodb/yum/redhat/\\$releasever/mongodb-org/3.4/\\$basearch/\ngpgcheck=0\nenabled=1\nEOF\n</code></pre>"},{"location":"coding/Shell/#shell_2","title":"shell\u7279\u6b8a\u53d8\u91cf\u57fa\u672c\u89e3\u91ca","text":"Markdown<pre><code>$*     # \u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\n$@     # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\uff0c\u548c$*\u7c7b\u4f3c\uff0c\u4f46\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77\uff0c\u4e14\u4ecd\u4fdd\u7559\u6bcf\u4e2a\u5f15\u7528\u53d8\u91cf\u7684\u533a\u6bb5\u542b\u4e49\n$#     # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u603b\u7684\u53c2\u6570\u6570\u76ee\n$*     # (\u5e38\u7528)\u4f20\u9012\u7ed9\u7a0b\u5e8f\u7684\u6240\u6709\u53c2\u6570\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\n$_     # \u83b7\u53d6\u5728\u6b64\u4e4b\u524d\u6267\u884c\u7684\u547d\u4ee4\u6216\u811a\u672c\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\n$?     # (\u5e38\u7528)\u4e0a\u4e00\u6761\u547d\u4ee4\u6267\u884c\u540e\u8fd4\u56de\u503c;\u6210\u529f\u8fd4\u56de0,\u5931\u8d25\u8fd4\u56de1\n\n# \u8fd4\u56de\u503c\u53c2\u8003\uff1a\n0      # \u8868\u793a\u8fd0\u884c\u6210\u529f\n2      # \u6743\u9650\u62d2\u7edd\n1~125  # \u8fd0\u884c\u5931\u8d25\u3001\u811a\u672c\u547d\u4ee4\u3001\u7cfb\u7edf\u547d\u4ee4\u9519\u8bef\u6216\u53c2\u6570\u4f20\u9012\u9519\u8bef\n126    # \u627e\u5230\u8be5\u547d\u4ee4\u4f46\u65e0\u6cd5\u6267\u884c\n127    # \u672a\u627e\u5230\u8981\u8fd0\u884c\u7684\u547d\u4ee4\n&gt;128   # \u547d\u4ee4\u88ab\u7cfb\u7edf\u5f3a\u5236\u7ed3\u675f\n$$     # \u5f53\u524dshell\u8fd0\u884c\u65f6\u7684\u8fdb\u7a0bID\n$!     # \u4e0a\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\n$@     # \u6240\u6709\u7684\u53c2\u6570\uff0c\u6bcf\u4e2a\u90fd\u7528\u53cc\u62ec\u53f7\u62ec\u8d77\n$n     # (\u5e38\u7528)\u4f4d\u7f6e\u53c2\u6570\u503c\uff0cn\u8868\u793a\u4f4d\u7f6e\uff0c\u83b7\u53d6\u5f53\u524d\u811a\u672c\u7b2cn\u4e2a\u53c2\u6570\u503c\uff0cn\u5927\u4e8e9\u65f6\u8981\u7528\u5927\u62ec\u53f7\uff0c\u4f8b${10}\uff0c\u63a5\u7684\u53c2\u6570\u4ee5\u7a7a\u683c\u9694\u5f00\n$0     # (\u5e38\u7528)\u5f53\u524dshell\u540d(\u5f53\u524d\u6267\u884c\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u540d\uff0c\u5982\u679c\u6267\u884c\u811a\u672c\u5305\u542b\u8def\u5f84\u5219\u8fd4\u56de\u4e5f\u5305\u542b\u811a\u672c\u8def\u5f84)\n\n# \u6570\u503c\u6bd4\u8f83\uff1a\n\n-eq     # \u7b49\u4e8e\n-ne     # \u4e0d\u7b49\u4e8e\n-gt     # \u5927\u4e8e\n-ge     # \u5927\u4e8e\u6216\u7b49\u4e8e\n-lt     # \u5c0f\u4e8e\n-le     # \u5c0f\u4e8e\u6216\u7b49\u4e8e\n\n# \u903b\u8f91\u6d4b\u8bd5\uff1a\n&amp;&amp;      # \u903b\u8f91\u4e0e\n||      # \u903b\u8f91\u6216\n!       # \u903b\u8f91\u5426\n</code></pre>"},{"location":"coding/Shell/#shell_3","title":"\u5728shell\u4e2d\u5e38\u7528\u7684\u7b26\u53f7\u4e00\u822c\u7528\u6cd5","text":"Markdown<pre><code># ;(Command separator)\u5206\u53f7\n\u5728shell\u4e2d\u62c5\u4efb\"\u8fde\u7eed\u6307\u4ee4\"\u529f\u80fd\u7684\u7b26\u53f7\u5c31\u662f\u5206\u53f7,\u5206\u53f7\u7b26\u5141\u8bb8\u5728\u540c\u4e00\u884c\u6709\u4e24\u4e2a\u6216\u591a\u4e2a\u547d\u4ee4\n\u4f8b\u5982\uff1acd ~/backup;mkdir startup;cp ~/.* startup/.  # \u8fdb\u5165\u5bb6\u76ee\u5f55\u4e0bbackup\u5e76\u521b\u5efa\u76ee\u5f55startup\uff0c\u590d\u5236\u5bb6\u76ee\u5f55\u4e0b\u6240\u6709\u5230startup\u4e0b\n\n# ;;(Terminator)\u8fde\u7eed\u5206\u53f7\n\u4e13\u7528\u5728case\u6d41\u7a0b\u63a7\u5236\u9009\u9879\uff0c\u62c5\u4efbTerminator\u89d2\u8272\u3002case\u8bed\u53e5\u5206\u652f\u7684\u7ed3\u675f\u7b26\u4f7f\u7528\u53cc\u5206\u53f7\uff0c\u5982\u4e0b\uff1a\ncase $variable in\n  [yY]|[Yy][Ee][Ss])\n    echo \"let's go\";;\n  [Nn]|[Nn][Oo])\n    echo \"poor man\";;\n  *)\n    echo \"you answer is false\";;\nesac\n\n# .(dot)\u82f1\u6587\u53e5\u53f7\nshell\u4e2d\u4e00\u4e2adot\u4ee3\u8868\u5f53\u524d\u76ee\u5f55\uff0c\u4e24\u4e2a\u4ee3\u8868\u4e0a\u5c42\u76ee\u5f55\n\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u5219\u4ee3\u8868\u4e00\u4e2a\u5b57\u7b26\n\u4f5c\u4e3a\u547d\u4ee4\u4f7f\u7528\u65f6\u7b49\u540c\u4e8esource\n\u6587\u4ef6\u540d\u524d\u7f00\u4f7f\u7528\u65f6\u8c61\u5f81\u4e3a\u9690\u85cf\u6587\u4ef6\n\n# 'string'(single quote)\u5355\u5f15\u53f7\n\u5355\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u4e14$\u7b26\u53f7\u4e5f\u88ab\u5f53\u505a\u4e00\u822c\u5b57\u7b26\u5904\u7406\n\n# \"string\"(double quote)\u53cc\u5f15\u53f7\n\u53cc\u5f15\u53f7\u62ec\u4f4f\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u5355\u4e00\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u9632\u6b62\u901a\u914d\u7b26\u6269\u5c55\uff0c\u4f46\u662f\u5141\u8bb8\u53d8\u91cf\u6269\u5c55\u3002\u6b64\u5904\u548c\u5355\u5f15\u53f7\u4e0d\u540c\n\n# `command`(backticks)\u5012\u5f15\u53f7\n\u5012\u5f15\u53f7\u5185\u7684command\u4f1a\u88ab\u5f53\u505a\u547d\u4ee4\u6765\u6267\u884c,\u6700\u597d\u4f7f\u7528$(command)\u6765\u4ee3\u66ff\n\n# ,(comma)\u82f1\u6587\u9017\u53f7\n\u6b64\u7b26\u53f7\u5e38\u7528\u5728\u8fd0\u7b97\u4e2d\uff0c\u7528\u4f5c\u533a\u57df\u9694\u79bb\u3002\u4f8b\u5982\uff1a\nlet \"t1 = ((a = 5 + 3, b = 7 - 1, c = 15 - 4))\";echo \"t1 = $t1, a = $a, b = $b\"\n\n# /(forward slash)\u659c\u7ebf\n\u8def\u5f84\u4e2d\u8868\u793a\u6587\u4ef6\u8def\u5f84\u5206\u9694\u7b26\uff0c\u56db\u5219\u8fd0\u7b97\u4e2d\u4ee3\u8868\u9664\u6cd5\u7b26\u53f7\u3002\u4f8b\u5982\uff1alet \"num1 = ((a = 10 / 2, b = 25 / 5))\";echo $num1,$a,$b\n\n# \\\\ \u5012\u659c\u7ebf\n\u4ea4\u4e92\u6a21\u5f0f\u4e0b\u7684escape\u5b57\u7b26\n\u4f5c\u7528\uff1a\u653e\u5728\u6307\u4ee4\u524d\u53d6\u6d88aliases\uff1b\u653e\u5728\u7279\u6b8a\u7b26\u53f7\u524d\u5219\u8be5\u7279\u6b8a\u7b26\u53f7\u4e0d\u518d\u6709\u7279\u6b8a\u610f\u4e49\uff1b\u653e\u5728\u6307\u4ee4\u6700\u672b\u7aef\u8868\u793a\u8fde\u63a5\u4e0b\u4e00\u884c\n\n# | (pipeline)\u7ba1\u9053\npipeline\u7528\u6765\u8fde\u63a5\u4e0a\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u4f5c\u4e3a\u4e0b\u4e2a\u6307\u4ee4\u7684\u6807\u51c6\u8f93\u5165\n\n# !(negate or reverse)\u82f1\u6587\u611f\u53f9\u53f7\n\u901a\u5e38\u4f5c\u4e3a\u53cd\u903b\u8f91\u4f7f\u7528\uff0c\u5982\u6761\u4ef6\u6d4b\u8bd5\u4e2d!=\u8868\u793a\u4e0d\u7b49\u4e8e,\u4f8b\u5982\u5224\u65ad\u4e0a\u4e2a\u6307\u4ee4\u662f\u5426\u6267\u884c\u6210\u529f\nif [ \"$?\" != 0 ]; then echo \"Executes error\"; fi\n\u8fd8\u7528\u6765\u8c03\u7528\u5c5e\u4e8e\u5386\u53f2\u547d\u4ee4\u673a\u5236\u7684\u8c03\u7528\uff0c\u4f46\u5728\u811a\u672c\u4e2d\u547d\u4ee4\u5386\u53f2\u673a\u5236\u662f\u88ab\u7981\u6b62\u7684\n\n# : \u82f1\u6587\u5192\u53f7\nbash\u4e2d\u4f5c\u4e3a\u5185\u5efa\u6307\u4ee4\u8868\u793a\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u4f46\u8fd4\u56de\u72b6\u6001\u503c0 \u4f8b\u5982\uff1a\n: ${HOSTNAME}${USER}    # \u68c0\u67e5\u8fd9\u4e24\u4e2a\u73af\u5883\u53d8\u91cf\u662f\u5426\u5df2\u8bbe\u7f6e\uff0c\u6ca1\u6709\u8bbe\u7f6e\u5219\u4ee5\u6807\u51c6\u9519\u8bef\u663e\u793a\u9519\u8bef\u4fe1\u606f\n\n# ? (wild card)\u95ee\u53f7\n\u6b63\u5219\u8868\u793a\u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4f46\u4e0d\u5305\u542bnull\n\u5728\u4e00\u4e9b\u8868\u8fbe\u5f0f\u4e2d\uff0c\u4f5c\u4e3a\u6d4b\u8bd5\u64cd\u4f5c\u7b26\uff0c\u95ee\u53f7\u8868\u793a\u4e00\u4e2a\u6761\u4ef6\u6d4b\u8bd5\uff0c\u5728\u53cc\u62ec\u53f7(())\u4e2d\u8868\u793aC\u98ce\u683c\u7684\u4e09\u5143\u64cd\u4f5c\u7b26\uff0c\u5728\u53c2\u6570\u66ff\u6362\u8868\u8fbe\u5f0f\u7528\u6765\u6d4b\u8bd5\u4e00\u4e2a\u53d8\u91cf\u662f\u5426\u88ab\u8d4b\u503c\n\n# * (wild card)\u661f\u53f7\n\u6b63\u5219\u4e2d\u8868\u793a\u4efb\u4f55\u5b57\u7b26\uff0c\u5305\u542bnull\uff1b\u56db\u5219\u8fd0\u7b97\u4e2d\u8868\u793a\u4e58\u6cd5\n\n# ** \u5e42\u8fd0\u7b97\nlet sum=2**3;echo $sum  # \u8f93\u51fa8\n\n# $ (dollar sign)dollar\u7b26\u53f7\n\u53d8\u91cf\u66ff\u6362\u4ee3\u8868\u7b26\u53f7\uff0c\u7528\u6765\u5f15\u7528\u4e00\u4e2a\u53d8\u91cf\u7684\u5185\u5bb9\uff1b\u6b63\u5219\u4e2d\u8868\u793a\u5339\u914d\u884c\u5c3e\n\n# ${}   \u53d8\u91cf\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\nbash\u4e2d\u5f88\u591a\u7528\u6cd5\uff0c\u8be6\u60c5\u89c1\u4e0b\u6587\uff0c\u53c2\u6570\u66ff\u6362\n\n# ()   (command group)\u6307\u4ee4\u7fa4\u7ec4\n\u7528\u62ec\u53f7\u5c06\u4e00\u4e32\u8fde\u7eed\u6307\u4ee4\u62ec\u8d77\u6765\uff0c\u79f0\u4f5c\u6307\u4ee4\u7fa4\u7ec4\uff0c\u4f8b\u5982\uff1a(cd ~ ; var=`pwd` ;echo $var)\n\u6570\u7ec4\u521d\u59cb\u5316\uff1aarray=(element1 element2 element3)\n\n# (())\n\u4f5c\u7528\u548clet\u547d\u4ee4\u76f8\u4f3c\uff0c\u7528\u5728\u7b97\u6570\u8fd0\u7b97\u4e2d\uff0c\u4f46\u6267\u884c\u6548\u7387\u7565\u9ad8.\u4f8b\u5982\uff1a\n((a = 10));echo -e \"\u521d\u59cb\u503c: a = $a \\n\";((a++));echo \"a++ \u540e\u7ed3\u679c: a=$a\"\n\n# { }   \u5927\u62ec\u53f7(block of code)\n\u7528\u6cd5\u4e00\uff1a\u662f\u4f5c\u4e3a\u4ee3\u7801\u5757\uff0c\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2a\u533f\u540d\u51fd\u6570\uff0c\u4e0e\u5c0f\u62ec\u53f7\u4e0d\u540c\u7684\u662f\u4e0d\u4f1a\u65b0\u521b\u5efa\u4e00\u4e2asub shell\u8fd0\u884c\u3002\u811a\u672c\u4f59\u4e0b\u90e8\u5206\u4ecd\u53ef\u4f7f\u7528\u62ec\u53f7\u5185\n\u53d8\u91cf\uff0c\u62ec\u53f7\u5185\u547d\u4ee4\u4e4b\u95f4\u7528\u5206\u53f7\u9694\u5f00\uff0c\u6700\u540e\u4e00\u4e2a\u4e5f\u5fc5\u987b\u6709\u5206\u53f7\uff0c{}\u7b2c\u4e00\u4e2a\u547d\u4ee4\u548c\u5de6\u8fb9\u7684\u5927\u62ec\u53f7\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\u3002\u4f8b\u5982\uff1a\na=one; { a=two; echo -e \"\\n$a \\n\";}; echo $a\n\n\u7528\u6cd5\u4e8c\uff1a\u5927\u62ec\u53f7\u62d3\u5c55\u3002(\u901a\u914d(globbing))\u5c06\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u6587\u4ef6\u540d\u505a\u6269\u5c55\u3002\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u4e0d\u5141\u8bb8\u6709\u7a7a\u767d\uff0c\u9664\u975e\u8fd9\u4e2a\u7a7a\u767d\u88ab\u5f15\u7528\u6216\u8f6c\u4e49\u3002\n\u7b2c\u4e00\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u7684\u4ee5\u9017\u53f7\u5206\u5272\u7684\u6587\u4ef6\u5217\u8868\u8fdb\u884c\u62d3\u5c55\u3002\u5982 touch {a,b}.txt \u7ed3\u679c\u4e3aa.txt b.txt\u3002\u7b2c\u4e8c\u79cd\uff1a\u5bf9\u5927\u62ec\u53f7\u4e2d\u4ee5\u70b9\u70b9\uff08..\uff09\n\u5206\u5272\u7684\u987a\u5e8f\u6587\u4ef6\u5217\u8868\u8d77\u62d3\u5c55\u4f5c\u7528\uff0c\u5982\uff1atouch {a..d}.txt \u7ed3\u679c\u4e3aa.txt b.txt c.txt d.txt\n\u8fd8\u53ef\u4ee5\u7528\u5728\u5b57\u7b26\u4e32\u7ec4\u5408\u4e0a\uff0c\u5982\uff1amkdir {a,b}-{1,2} \u7ed3\u679c\u4e3a\uff1aa-1 a-2 b-1 b-2\n\n# [] \u4e2d\u62ec\u53f7------\u5c3d\u91cf\u4f7f\u7528[[]]\u66ff\u4ee3[]\n\u4e0etest\u7b49\u540c\uff0c\u901a\u5e38\u7528\u4f5c\u6761\u4ef6\u5224\u65ad\uff0c\u53c2\u6570\u4f5c\u4e3a\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u6587\u4ef6\u6d4b\u8bd5\uff0c\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u72b6\u6001\u7801\ntest\u548c[]\u4e2d\u6bd4\u8f83\u8fd0\u7b97\u7b26\u53ea\u6709==\u548c!=\uff0c\u7528\u4e8e\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u6574\u6570\u6bd4\u8f83\u53ea\u80fd-gt,-eq\u7b49\n\u6b63\u5219\u4e2d\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u8303\u56f4\n\u5728\u4e00\u4e2aarray\u7ed3\u6784\u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4e2d\u62ec\u53f7\u7528\u4e8e\u5f15\u7528\u6570\u7ec4\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u7f16\u53f7\n\n# [[]]\n\u6b64\u62ec\u53f7\u4e4b\u95f4\u4efb\u4f55\u5b57\u7b26\u90fd\u4e0d\u4f1a\u53d1\u751f\u6587\u4ef6\u6269\u5c55\u540d\u6216\u8005\u5355\u8bcd\u7684\u5206\u5272\uff0c\u4f46\u4f1a\u6709\u53c2\u6570\u6269\u5c55\u548c\u547d\u4ee4\u66ff\u6362\n\u652f\u6301\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f\u5339\u914d\uff0c\u5b57\u7b26\u4e32\u6bd4\u8f83\u65f6\u53ef\u4ee5\u628a\u53f3\u8fb9\u5f53\u505a\u4e00\u4e2a\u6a21\u5f0f\n\u4f7f\u7528[[]]\u4f5c\u4e3a\u6761\u4ef6\u5224\u65ad\u53ef\u9632\u6b62\u811a\u672c\u4e2d\u903b\u8f91\u9519\u8bef\uff0c&amp;&amp;,||,&lt;,&gt;\u64cd\u4f5c\u7b26\u53ef\u5728[[]]\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u5728[]\u4e2d\u4f1a\u62a5\u9519\n\u4f8b\u5982\uff1aread ak; if [[ $ak &gt; 5 || $ak &lt; 2 ]]; then echo \"$ak\"; fi\n\n# \u8f93\u51fa/\u8f93\u5165\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\uff1a&gt; &gt;&gt; &lt; &lt;&lt; &amp;&gt; 2&amp;&gt; 2&lt;&gt;&gt;&amp; &gt;&amp;2\n\u6587\u4ef6\u63cf\u8ff0\u7b26(file descriptor\uff09\u901a\u5e38\u7528\u4e00\u4e2a\u6570\u5b57(0-9)\u8868\u793a\u6587\u4ef6\n\u5e38\u89c1\u63cf\u8ff0\u7b26\u5982\u4e0b\uff1a\n\u6587\u4ef6\u63cf\u8ff0\u7b26       \u540d\u79f0           \u7f29\u5199      \u9ed8\u8ba4\u503c\n    0          \u6807\u51c6\u8f93\u5165        stdin      \u952e\u76d8\n    1          \u6807\u51c6\u8f93\u51fa        stdout     \u5c4f\u5e55\n    2        \u6807\u51c6\u9519\u8bef\u8f93\u51fa      stderr     \u5c4f\u5e55\n\u7b80\u5355\u4f7f\u7528&lt;\u6216&gt;\u65f6\uff0c\u76f8\u5f53\u4e8e0&lt;\u62161&gt;\n\ncommand &gt; file      # command\u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u5230file\ncommand &gt;&gt; file     # command\u547d\u4ee4\u8f93\u51fa\u91cd\u5b9a\u5411\u8ffd\u52a0\u5230file\ncommand &lt; file      # command\u547d\u4ee4\u4ecefile\u8bfb\u53d6\ncommand &lt;&lt; file     # \u4ece\u547d\u4ee4\u884c\u8bfb\u53d6\u8f93\u5165\uff0c\u77e5\u9053\u4e0efile\u5339\u914d\u7684\u884c\u7ed3\u675f\uff0c\u9664\u975e\u4f7f\u7528\u5f15\u53f7\u5c06\u8f93\u5165\u62ec\u8d77\u6765\uff0c\u6b64\u6a21\u5f0f\u5c06\u5bf9\u8f93\u5165\u5185\u5bb9\u8fdb\u884cshell\u53d8\u91cf\u66ff\u6362\u5982\u679c\u4f7f\u7528&lt;&lt;-\u5219\u5ffd\u7565\u63a5\u4e0b\u6765\u8f93\u5165\u884c\u9996\u7684tab\ncommand &lt;&lt;&lt; word    # \u628a\u5b57\u7b26word\u548c\u540e\u9762\u7684\u6362\u884c\u4f5c\u4e3a\u8f93\u5165\u63d0\u4f9b\u7ed9command\ncommand &lt;&gt; file     # \u4ee5\u8bfb\u5199\u6a21\u5f0f\u5c06file\u91cd\u5b9a\u5411\u5230\u8f93\u5165\uff0cfile\u4e0d\u4f1a\u88ab\u7834\u574f\ncommand &gt;| file     # \u548c&gt;\u529f\u80fd\u76f8\u540c,\u5f3a\u8feb\u91cd\u5b9a\u5411\uff0c\u4f1a\u5f3a\u5236\u8986\u76d6\u4e00\u4e2a\u5df2\u5b58\u5728\u6587\u4ef6\n: &gt; file            # \u5c06file\u622a\u65ad\u4e3a0\u957f\u5ea6\ncommand &gt;&amp;n         # \u628a\u8f93\u51fa\u9001\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26n\uff0c\u6ce8\u610f\uff1a &gt;&amp;\u5b9e\u9645\u4e0a\u590d\u5236\u4e86\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4f7fcmd &gt; file 2&gt;&amp;1\u4e0ecmd 2&gt;&amp;1 &gt;file\u7684\u6548\u679c\u4e0d\u4e00\u6837\ncommand m&gt;&amp;n        # \u628a\u8f93\u51fa\u5230\u6587\u4ef6\u7b26m\u7684\u4fe1\u606f\u91cd\u5b9a\u5411\u5230\u6587\u4ef6\u63cf\u8ff0\u7b26n\ncommand &gt;&amp;-         # \u5173\u95ed\u6807\u51c6\u8f93\u51fa\ncommand &lt;&amp;n         # \u8f93\u5165\u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u7b26n\ncommand m&lt;&amp;n        # m\u6765\u81ea\u6587\u4ef6\u63cf\u8ff0\u5404\u4e2an\ncommand &lt;&amp;-         # \u5173\u95ed\u6807\u51c6\u8f93\u5165\ncommand &lt;&amp;n-        # \u79fb\u52a8\u8f93\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26n\u800c\u975e\u590d\u5236\u5b83\uff08\u9700\u8981\u89e3\u91ca\uff09\n&amp;&gt; file\u548c &gt; file 2&gt;&amp;1\u76f8\u540c # \u5c06stdout\u548cstderr\u7ec4\u5408\u8986\u76d6\u5230file\n\n# ~+\n\u8868\u793a\u5f53\u524d\u5de5\u4f5c\u8def\u5f84\uff0c\u4e0e\u53d8\u91cf$PWD\u4e00\u81f4\n</code></pre>"},{"location":"coding/Shell/#shell_4","title":"shell\u53d8\u91cf\u5b50\u4e32\u8bf4\u660e","text":"\u8868\u8fbe\u5f0f \u8bf4\u660e ${parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u7684\u5185\u5bb9 ${#parameter} \u8fd4\u56de\u53d8\u91cf$parameter\u5185\u5bb9\u7684\u5b57\u7b26\u957f\u5ea6 ${parameter:offset} \u5728\u53d8\u91cf$parameter\u4e2d\uff0c\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u5230\u7ed3\u5c3e ${parameter:offset:length} \u5728\u53d8\u91cf$parameter\u4e2d\u4ece\u4f4d\u7f6eoffset\u540e\u63d0\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3alength\u7684\u5b50\u4e32 ${parameter#word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter##word} \u4ece\u53d8\u91cf$parameter\u5f00\u5934\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u77ed\u5339\u914d\u7684word\u5b50\u4e32 ${parameter%%word} \u4ece\u53d8\u91cf$parameter\u7ed3\u5c3e\u5f00\u59cb\u5220\u9664\u6700\u957f\u5339\u914d\u7684word\u5b50\u4e32 ${parameter/pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u7b2c\u4e00\u4e2a\u5339\u914d\u7684pattern ${parameter//pattern/string} \u4f7f\u7528string\u4ee3\u66ff\u6240\u6709\u5339\u914d\u7684pattern ${parameter:-word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c ${parameter:=word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u8fd4\u56deword\u5b57\u7b26\u4e32\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c,\u4f4d\u7f6e\u53d8\u91cf\u548c\u7279\u6b8a\u53d8\u91cf\u4e0d\u9002\u7528 ${parameter:?word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219word\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff0c\u5426\u5219\u8f93\u51fa\u53d8\u91cf\u7684\u503c ${parameter:+word} \u5982\u679c\u53d8\u91cfparameter\u6ca1\u6709\u503c\u4e3a\u7a7a\u6216\u672a\u8d4b\u503c\u5219\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u5426\u5219word\u5b57\u7b26\u4e32\u66ff\u4ee3\u53d8\u91cf\u7684\u503c <p>word\u53ef\u4ee5\u8868\u793a\u4e3a\u4e00\u4e32\u5b57\u7b26\uff0c\u6bd4\u5982a*c\u8868\u793a\u5220\u9664\u4ece\u5b57\u7b26a\u5230c\u7684\u6240\u6709\u5b57\u7b26</p>"},{"location":"coding/Shell/#bash","title":"bash\u9000\u51fa\u548c\u9000\u51fa\u72b6\u6001","text":"Bash<pre><code>: &lt;&lt; comment\nexit\u547d\u4ee4\u4e00\u822c\u7528\u4e8e\u7ed3\u675f\u4e00\u4e2a\u811a\u672c\uff0c\u5b83\u4e5f\u80fd\u8fd4\u56de\u4e00\u4e2a\u503c\u7ed9\u7236\u8fdb\u7a0b,\u6bcf\u4e00\u4e2a\u547d\u4ee4\u90fd\u80fd\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\uff08\u6709\u65f6\u4e5f\u770b\u505a\u8fd4\u56de\u72b6\u6001).\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\n\u6210\u529f\u8fd4\u56de0\uff0c\u4e00\u4e2a\u6267\u884c\u4e0d\u6210\u529f\u7684\u547d\u4ee4\u5219\u8fd4\u56de\u4e00\u4e2a\u975e\u96f6\u503c\uff0c\u6b64\u503c\u901a\u5e38\u53ef\u4ee5\u88ab\u89e3\u91ca\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684\u9519\u8bef\u503c\u3002\u9664\u4e86\u4e00\u4e9b\u4f8b\u5916\u7684\u60c5\u51b5\uff0cUNIX\u547d\u4ee4\uff0c\u7a0b\n\u5e8f\u6216\u662f\u8f6f\u4ef6\u5305\u6267\u884c\u6210\u529f\u90fd\u662f\u4ee5\u8fd4\u56de0\u7684\u4f5c\u4e3a\u9000\u51fa\u7801\n\n\u540c\u6837\u7684\uff0c\u5728\u811a\u672c\u91cc\u7684\u51fd\u6570\u548c\u811a\u672c\u81ea\u8eab\u90fd\u4f1a\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u811a\u672c\u6216\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u5c06\u51b3\u5b9a\u9000\u51fa\u72b6\u6001\u7801\u3002\u5728\u4e00\u4e2a\u811a\u672c\u91cc\uff0cexit n\u547d\u4ee4\n\u5c06\u4f1a\u8fd4\u56deshell\u4e00\u4e2annn\u7684\u9000\u51fa\u72b6\u6001\u7801\u3002\uff08nnn\u5fc5\u987b\u662f\u4e00\u4e2a\u57280-255\u8303\u56f4\u7684\u5341\u8fdb\u5236\u6574\u6570\uff09\n\n\u5982\u679c\u4e00\u4e2a\u811a\u672c\u4ee5\u4e0d\u5e26\u53c2\u6570\u7684exit\u547d\u4ee4\u7ed3\u675f\uff0c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u5c06\u4f1a\u662f\u6267\u884cexit\u547d\u4ee4\u524d\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u7801\uff0c\u811a\u672c\u7ed3\u675f\u6ca1\u6709exit,\u4e0d\u5e26\n\u53c2\u6570\u7684exit\u548cexit $?\u4e09\u8005\u7b49\u4ef7\uff0c$?\u53d8\u91cf\u4fdd\u5b58\u4e86\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u540e\u7684\u9000\u51fa\u72b6\u6001\uff0c\u5f53\u4e00\u4e2a\u51fd\u6570\u8fd4\u56de\u65f6\uff0c$?\u4fdd\u5b58\u4e86\u51fd\u6570\u91cc\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\n\u51fa\u72b6\u6001\u7801\u3002\u8fd9\u5c31\u662fBash\u91cc\u51fd\u6570\u8fd4\u56de\u503c\u7684\u5904\u7406\u529e\u6cd5\u3002\u5f53\u4e00\u4e2a\u811a\u672c\u8fd0\u884c\u7ed3\u675f\uff0c$? \u53d8\u91cf\u4fdd\u5b58\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\uff0c\u800c\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u5219\u662f\u811a\u672c\u4e2d\u6700\n\u540e\u4e00\u4e2a\u5df2\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u3002\u5e76\u4e14\u4f9d\u7167\u60ef\u4f8b\uff0c0\u8868\u793a\u6267\u884c\u6210\u529f\uff0c1-255\u7684\u6574\u6570\u8303\u56f4\u8868\u793a\u9519\u8bef\u6216\u53cd\u5e38\u7684\u6761\u4ef6\n\n\u903b\u8f91\u975e\u64cd\u4f5c\u7b26!\uff0c\u53cd\u8f6c\u4e00\u4e2a\u547d\u4ee4\u6216\u4e00\u4e2a\u6d4b\u8bd5\u7684\u7ed3\u679c\u3002\u4e5f\u80fd\u53cd\u8f6c\u9000\u51fa\u72b6\u6001\ncomment\n</code></pre>"},{"location":"coding/Shell/#_1","title":"\u7279\u6b8a\u53d8\u91cf\u7c7b\u578b","text":"Bash<pre><code># \u5c40\u90e8\u53d8\u91cf\uff1a\u53ea\u5728\u4ee3\u7801\u5757\u6216\u4e00\u4e2a\u51fd\u6570\u4e2d\u6709\u6548\n# \u73af\u5883\u53d8\u91cf\uff1a\u5176\u4f1a\u5f71\u54cdshell\u7684\u884c\u4e3a\u548c\u7528\u6237\u63a5\u53e3\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u4e00\u4e2a\u73af\u5883\uff0c\u5176\u7531\u8fdb\u7a0b\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u7ec4\u6210\n# \u5206\u914d\u7ed9\u73af\u5883\u53d8\u91cf\u7684\u603b\u7a7a\u95f4\u6709\u9650\uff0c\u82e5\u521b\u5efa\u592a\u591a\u73af\u5883\u53d8\u91cf\u6216\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u7684\u503c\u592a\u957f\u800c\u5360\u7528\u8fc7\u591a\u7a7a\u95f4\u5219\u4f1a\u51fa\u9519\n# \u4f8b\u5982\uff1a\n: &lt;&lt;comment\n#eval\u547d\u4ee4\u5c06\u8fd9\u4e9b\u53c2\u6570\u4e32\u8054\u5728\u4e00\u8d77\u6210\u4e3a\u4e00\u4e2a\u547d\u4ee4\uff0c\u7136\u540e\u8bfb\u53d6\u5e76\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\uff0c\u5e76\u5c06\u5176\u9000\u51fa\u72b6\u6001\u4f5c\u4e3a\u7684\u9000\u51fa\u72b6\u6001\u8fd4\u56de\u3002\u5982\u679c\u6ca1\u6709\u53c2\u6570\u6216\u53ea\u6709\u7a7a\u53c2\u6570\uff0c\u5219\u8fd4\u56de\u72b6\u6001\u4e3a\u96f6\neval \"`seq 10000 | sed -e 's/.*/export var&amp;=ZZZZZZZZZZZZZZ/'`\"\ndu\n/usr/bin/du:Argument list too long\ncomment\n# \u5982\u679c\u4e00\u4e2a\u811a\u6b65\u8981\u8bbe\u7f6e\u4e00\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5219\u9700\u8981\u5c06\u5176\u5bfc\u51fa(export)\uff0c\u4e5f\u5c31\u662f\u8bb2\u9700\u901a\u77e5\u5230\u811a\u672c\u7684\u73af\u5883\u8868\uff0c\u8fd9\u662fexport\u547d\u4ee4\u529f\u80fd\n# \u4e00\u4e2a\u811a\u672c\u53ea\u80fd\u5bfc\u51fa\uff08export\uff09\u53d8\u91cf\u5230\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u80fd\u5bfc\u51fa\u5230\u7531\u6b64\u811a\u672c\u751f\u6210\u7684\u547d\u4ee4\u6216\u8fdb\u7a0b\u4e2d\u3002\u5728\u4e00\u4e2a\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u7684\u811a\u672c\u4e0d\u80fd\u5bfc\u51fa\n# \u4e00\u4e2a\u53d8\u91cf\u5f71\u54cd\u5230\u547d\u4ee4\u884c\u7684\u73af\u5883\u3002\u5b50\u8fdb\u7a0b\u4e0d\u80fd\u5bfc\u51fa\u53d8\u91cf\u5230\u751f\u6210\u5b83\u7684\u7236\u8fdb\u7a0b\u4e2d\u3002\n# \u4f4d\u7f6e\u53c2\u6570\n: &lt;&lt;comment\n\u547d\u4ee4\u884c\u4f20\u9012\u7ed9\u811a\u672c\u7684\u53c2\u6570\u662f$0,$1,$2....\n$0\u662f\u811a\u672c\u7684\u540d\u5b57\uff0c$1\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c$2\u662f\u7b2c\u4e8c\u4e2a\u53c2\u6570......\u5728\u4f4d\u7f6e\u53c2\u6570$9\u4e4b\u540e\u7684\u53c2\u6570\u5fc5\u987b\u7528\u5927\u62ec\u53f7\u62ec\u8d77\u6765\u3002\u5982\uff1a${10}\n\u7279\u6b8a\u53d8\u91cf$*\u548c$@\u8868\u793a\u6240\u6709\u7684\u4f4d\u7f6e\u53c2\u6570\ncomment\n\n: &lt;&lt;comment\n#!/bin/bash\n# \u4f4d\u7f6e\u53c2\u6570\u4f8b\u5b50\uff1a\n# \u81f3\u5c11\u4ee510\u4e2a\u53c2\u6570\u8fd0\u884c\u6b64\u811a\u672c\u3002\u4f8b\u5982\uff1a./script.sh 1 2 3 4 5 6 7 8 9 10\nmin_params=10\necho \"\u811a\u672c\u540d\u5b57\u662f\\\"$0\\\".\"\n# \u7528./\u8868\u793a\u5f53\u524d\u76ee\u5f55\necho \"\u811a\u672c\u540d\u5b57\u662f\\\"`basename $0`\\\".\"\ncomment\n</code></pre>"},{"location":"coding/Shell/#_2","title":"\u6d4b\u8bd5","text":""},{"location":"coding/Shell/#if","title":"if\u4f7f\u7528\u7684\u4e3b\u8981\u8868\u8fbe\u5f0f","text":"\u4e3b\u8981\u7684\u8868\u8fbe\u5f0f \u542b\u4e49 [ -a FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue\uff0c\u4e0e-e\u4e00\u6837\u4f46\u4e0d\u8d5e\u6210\u4f7f\u7528 [ -b FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u5757\u8bbe\u5907\u8fd4\u56deTrue(\u8f6f\u76d8,\u5149\u9a71\u7b49) [ -c FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u65f6\u5b57\u7b26\u8bbe\u5907\u8fd4\u56deTrue(\u952e\u76d8,\u8c03\u5236\u89e3\u8c03\u5668,\u58f0\u5361\u7b49) [ -d FILE ] \u5982\u679c\u662f\u76ee\u5f55\u8fd4\u56deTrue [ -e FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue [ -f FILE ] \u6587\u4ef6\u662f\u666e\u901a\u6587\u4ef6\u5e76\u4e14\u4e0d\u662f\u4e00\u4e2a\u76ee\u5f55\u6216\u662f\u4e00\u4e2a\u8bbe\u5907\u6587\u4ef6\u8fd4\u56deTrue [ -g FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u8bbe\u7f6e-\u7ec4-ID(sgid)\u6807\u8bb0\u88ab\u8bbe\u7f6e\u5219\u8fd4\u56deTrue\uff0c\u5982\u679c\u4e00\u4e2a\u76ee\u5f55\u7684sgid\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u521b\u5efa\u7684\u6587\u4ef6\u90fd\u5c5e\u4e8e\u62e5\u6709\u6b64\u76ee\u5f55\u7684\u7528\u6237\u7ec4\uff0c\u800c\u4e0d\u5fc5\u662f\u521b\u5efa\u6587\u4ef6\u7684\u7528\u6237\u6240\u5c5e\u7684\u7ec4\u3002\u8fd9\u4e2a\u7279\u6027\u5bf9\u5728\u4e00\u4e2a\u5de5\u4f5c\u7ec4\u91cc\u7684\u540c\u4eab\u76ee\u5f55\u5f88\u6709\u7528\u5904 [ -h FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -k FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u4e14\u7c98\u4f4f\u4f4d\u8bbe\u7f6e\u8fd4\u56deTrue\u3002\u4fd7\u79f0\u201c\u7c98\u6027\u4f4d\u201d\uff0c\u4fdd\u5b58\u6587\u672c\u6a21\u5f0f\u6807\u5fd7\u662f\u4e00\u79cd\u7279\u6b8a\u7c7b\u578b\u7684\u6587\u4ef6\u6743\u9650\u3002\u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u8bbe\u7f6e\u4e86\u8fd9\u4e2a\u6807\u5fd7\uff0c\u8be5\u6587\u4ef6\u5c06\u88ab\u4fdd\u5b58\u5728\u7f13\u5b58\u5185\u5b58\u4e2d\uff0c\u4ee5\u4fbf\u66f4\u5feb\u5730\u8bbf\u95ee\u3002\u30142\u3015\u5982\u679c\u8bbe\u7f6e\u5728\u76ee\u5f55\u4e0a\uff0c\u5219\u9650\u5236\u5199\u5165\u6743\u9650\u3002\u8bbe\u7f6e\u7c98\u6027\u4f4d\u5c06T\u6dfb\u52a0\u5230\u6587\u4ef6\u6216\u76ee\u5f55\u5217\u8868\u7684\u6743\u9650(drwxrwxrw**t**)\uff0c\u5982\u679c\u7528\u6237\u4e0d\u62e5\u6709\u8bbe\u7f6e\u4e86\u7c98\u6027\u4f4d\u7684\u76ee\u5f55\uff0c\u4f46\u5728\u8be5\u76ee\u5f55\u4e2d\u5177\u6709\u5199\u6743\u9650\uff0c\u5219\u4ed6\u53ea\u80fd\u5220\u9664\u5176\u62e5\u6709\u7684\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u7528\u6237\u5728\u516c\u5171\u53ef\u8bbf\u95ee\u76ee\u5f55\uff08\u5982/tMP\uff09\u4e2d\u65e0\u610f\u4e2d\u8986\u76d6\u6216\u5220\u9664\u5f7c\u6b64\u7684\u6587\u4ef6 [ -p FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u662f\u4e00\u4e2a\u7ba1\u9053\u8fd4\u56deTrue [ -r FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u53ef\u8bfb\u8fd4\u56deTrue(\u6307\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u8bfb\u6743\u9650) [ -s FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6587\u4ef6\u5927\u5c0f\u5927\u4e8e0\u8fd4\u56deTrue [ -t FD ] \u5982\u679c\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26FD(\u5bf9\u5e94\u51fd\u6570\u7684\u8fd4\u56de\u503c)\u6253\u5f00\u5e76\u5f15\u7528\u4e86\u7ec8\u7aef\u5219\u4e3aTrue\uff0c\u6587\u4ef6(\u63cf\u8ff0\u7b26)\u4e0e\u4e00\u4e2a\u7ec8\u7aef\u8bbe\u5907\u76f8\u5173\uff0c\u8fd9\u4e2a\u6d4b\u8bd5\u9009\u9879\u53ef\u4ee5\u7528\u4e8e\u68c0\u67e5\u811a\u672c\u4e2d\u662f\u5426\u6807\u51c6\u8f93\u5165 ([ -t 0 ])\u6216\u6807\u51c6\u8f93\u51fa([ -t 1 ])\u662f\u4e00\u4e2a\u7ec8\u7aef [ -u FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u8fd4\u56deTrue\uff0c\u6587\u4ef6\u7684\u8bbe\u7f6e-\u7528\u6237-ID(suid)\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u4e00\u4e2aroot\u7528\u6237\u62e5\u6709\u7684\u4e8c\u8fdb\u5236\u6267\u884c\u6587\u4ef6\u5982\u679c\u8bbe\u7f6e\u4e86\u8bbe\u7f6e-\u7528\u6237-ID\u4f4d(suid)\u6807\u5fd7\u666e\u901a\u7528\u6237\u53ef\u4ee5\u4ee5root\u6743\u9650\u8fd0\u884c\u3002[1] \u8fd9\u5bf9\u9700\u8981\u5b58\u53d6\u7cfb\u7edf\u786c\u4ef6\u7684\u6267\u884c\u7a0b\u5e8f\uff08\u6bd4\u5982\u8bf4pppd\u548ccdrecord\uff09\u5f88\u6709\u7528\u5982\u679c\u6ca1\u6709\u8bbe\u7f6esuid\u4f4d\uff0c\u5219\u8fd9\u4e9b\u4e8c\u8fdb\u5236\u6267\u884c\u7a0b\u5e8f\u4e0d\u80fd\u7531\u975eroot\u8c03\u7528\u3002\u88ab\u8bbe\u7f6e\u4e86suid\u6807\u5fd7\u7684\u6587\u4ef6\u5728\u6743\u9650\u5217\u4e2d\u4ee5s\u6807\u5fd7\u8868\u793a(-rw**s**r-xr-t) [ -w FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u53ef\u5199\u7684\u8fd4\u56deTrue(\u8fd0\u884c\u8fd9\u4e2a\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u5199\u6743\u9650) [ -x FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u53ef\u6267\u884c\u7684\u8fd4\u56deTrue(\u6d4b\u8bd5\u547d\u4ee4\u7684\u7528\u6237\u7684\u6267\u884c\u6743\u9650) [ -O FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u7531\u6709\u6548\u7528\u6237ID\u6240\u62e5\u6709\u7684\u8fd4\u56deTrue(\u4f60\u662f\u6587\u4ef6\u62e5\u6709\u8005) [ -G FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u4e0e\u7528\u6237\u7ec4ID\u76f8\u540c\u8fd4\u56deTrue(\u6587\u4ef6\u6240\u5728\u7684\u7ec4\u548c\u6587\u4ef6\u7684groupID\u4e00\u81f4) [ -L FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\u8fd4\u56deTrue [ -N FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u6700\u540e\u4e00\u6b21\u8bfb\u540e\u88ab\u4fee\u6539\u8fd4\u56deTrue [ -S FILE ] \u6587\u4ef6\u5982\u679c\u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2asocket\u8fd4\u56deTrue [ FILE1 -nt FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u66f4\u65b0\uff0c\u6216\u8005FILE1\u5b58\u5728\u4e14FILE2\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ot FILE2 ] \u5982\u679cFILE1\u6bd4FILE2\u65e7\uff0c\u6216\u8005FILE2\u5b58\u5728\u4e14FILE1\u4e0d\u5b58\u5728\uff0c\u5219\u4e3aTrue [ FILE1 -ef FILE2 ] \u5982\u679cFILE1\u548cFILE2\u5f15\u7528\u76f8\u540c\u7684\u8bbe\u5907\u548cinode\u7f16\u53f7(\u76f8\u540c\u7684\u6587\u4ef6\u786c\u94fe\u63a5)\uff0c\u5219\u4e3aTrue [ -o OPTIONNAME ] \u5982\u679c\u542f\u7528\u4e86shell\u9009\u9879\u201cOPTIONNAME\u201d(\u9009\u9879\u540d\u79f0)\uff0c\u5219\u4e3aTrue [ -z STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e3a0\u5219\u4e3aTrue [ -n STRING ] or [ STRING ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u4e3a0\u5219\u4e3aTrue [ STRING1 == STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u76f8\u7b49\u5219\u4e3aTrue\uff0c\u5bf9\u4e8e\u4e25\u683c\u7684POSIX\u5408\u89c4\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528\u201c=\u201d\u4ee3\u66ff\u201c==\u201d [ STRING1 != STRING2 ] \u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u76f8\u7b49\u5219\u4e3aTrue [ STRING1 &lt; STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u524d\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ STRING1 &gt; STRING2 ] \u5982\u679c\u201cSTRING1\u201d\u5728\u5f53\u524dlocale\u73af\u5883\u4e2d\u6309\u5b57\u5178\u987a\u5e8f\u5728\u201cSTRING2\u201d\u4e4b\u540e\u6392\u5e8f\uff0c\u5219\u4e3aTrue [ ARG1 OP ARG2 ] \u201cOP\u201d\u662f-eq\uff0c-ne\uff0c-lt\uff0c-le\uff0c-gt\u6216-ge\u4e4b\u4e00\u3002 \u5982\u679c\u201cARG1\u201d\u5206\u522b\u7b49\u4e8e\uff0c\u4e0d\u7b49\u4e8e\uff0c\u5c0f\u4e8e\uff0c\u5c0f\u4e8e\u6216\u7b49\u4e8e\uff0c\u5927\u4e8e\u6216\u5927\u4e8e\u6216\u7b49\u4e8e\u201cARG2\u201d\uff0c\u5219\u8fd9\u4e9b\u7b97\u672f\u4e8c\u5143\u8fd0\u7b97\u7b26\u8fd4\u56detrue\u3002 \u201cARG1\u201d\u548c\u201cARG2\u201d\u662f\u6574\u6570 <p>\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u8fd0\u7b97\u7b26\u7ec4\u5408\u8868\u8fbe\u5f0f\uff0c\u6309\u4f18\u5148\u7ea7\u9012\u51cf\u987a\u5e8f\u5217\u51fa\uff1a</p> \u7c7b\u522b \u4f8b\u5b50 [ ! EXPR ] \"\u975e\" -- \u53cd\u8f6c\u4e0a\u9762\u6240\u6709\u6d4b\u8bd5\u7684\u7ed3\u679c(\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6761\u4ef6\u5219\u8fd4\u56de\u771f),\u5982\u679cEXPR\u662ffalse\u5219\u4e3a\u771f [ ( EXPR ) ] \u8fd4\u56deEXPR\u7684\u503c\u3002 \u8fd9\u53ef\u4ee5\u7528\u4e8e\u8986\u76d6\u8fd0\u7b97\u7b26\u7684\u6b63\u5e38\u4f18\u5148\u7ea7 [ EXPR1 -a EXPR2 ] \u5982\u679cEXPR1\u548cEXPR2\u90fd\u4e3a\u771f\uff0c\u5219\u4e3a\u771f [ EXPR1 -o EXPR2 ] \u5982\u679cEXPR1\u6216EXPR2\u4e3a\u771f\uff0c\u5219\u4e3a\u771f Bash<pre><code># \u5927\u591a\u6570\u7a0b\u5e8f\u5458\u66f4\u559c\u6b22\u4f7f\u7528test\u5185\u7f6e\u547d\u4ee4\uff0c\u8fd9\u76f8\u5f53\u4e8e\u4f7f\u7528\u65b9\u62ec\u53f7\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u4e0b\u6240\u793a\ntest \"$(whoami)\" != 'root' &amp;&amp; (echo you are using a non-privileged account; exit 1)\n# \u5982\u679c\u5728\u5b50shell\u4e2d\u8c03\u7528exit\uff0c\u5219\u4e0d\u4f1a\u5c06\u53d8\u91cf\u4f20\u9012\u7ed9\u7236\u7ea7\u3002\u5982\u679c\u60a8\u4e0d\u5e0c\u671bBash\u6d3e\u751f\u5b50shell\uff0c\u8bf7\u4f7f\u7528{ }\u4ee3\u66ff()\n</code></pre>"},{"location":"coding/Shell/#if_1","title":"if\u8bed\u53e5[ ] [[ ]]\u6bd4\u8f83","text":"\u6d4b\u8bd5\u7c7b\u578b [ ] [[ ]] \u6570\u5b57\u6d4b\u8bd5 -eq -ne -lt -le -gt -ge \u540c[ ] \u6587\u4ef6\u6d4b\u8bd5 -r -l -w -x -f -d -s -nt -ot \u540c[ ] \u5b57\u7b26\u6d4b\u8bd5 = != -n -z ==(\u540c=) \u4e0d\u53ef\u4f7f\u7528&lt;= &gt;= \u540c[ ] \u903b\u8f91\u6d4b\u8bd5 -a -o ! &amp;&amp; || ! \u6570\u5b66\u8fd0\u7b97 \u4e0d\u53ef\u4ee5\u4f7f\u7528 + - * / % \u7ec4\u5408 \u7528\u5404\u81ea\u903b\u8f91\u7b26\u53f7\u8fde\u63a5\u7684\u6570\u5b57(\u8fd0\u7b97)\u6d4b\u8bd5\u3001\u6587\u4ef6\u6d4b\u8bd5\u3001\u5b57\u7b26\u6d4b\u8bd5 \u540c[ ] \u60c5\u51b5\u590d\u6742\u7684\u5b57\u7b26\u6d4b\u8bd5 [ ] [[ ]] &lt; &gt; \u6bd4\u8f83\u7ed3\u679c\u5f02\u5e38\uff0c\u5982:\\([ 12 &gt; 21 ]\u4e0e\\)[ 21 &gt; 12 ]\u3001\\([ a &gt; b ]\u4e0e\\)[ b &gt; a ]\u7684\u8fd4\u56de\u503c\u4e00\u6837 \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83(\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \\&gt; \\&lt; \u6839\u636e\u5bf9\u4e8eASCII\u7801\u8fdb\u884c\u6bd4\u8f83(\u82e5\u591a\u4e2a\u5b57\u6bcd\u548c\u6570\u5b57\u7ec4\u5408\uff0c\u5219\u5148\u6bd4\u8f83\u9996\u4e2a\uff0c\u76f8\u540c\u518d\u6bd4\u8f83\u4e0b\u4e00\u4e2a) \u4e0d\u53ef\u4ee5\u4f7f\u7528 Bash<pre><code># if then else\u7ed3\u6784\u6d4b\u8bd5\u65ad\u6389\u7684\u8fde\u63a5\n\n#!/bin/bash\n# broken-link.sh\n# \u7531Lee bigelow\u6240\u5199&lt;ligelowbee@yahoo.com&gt;\n\n# \u4e00\u4e2a\u7528\u4e8e\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u5e76\u4e14\u8f93\u51fa\u5b83\u4eec\u7684\u94fe\u63a5\u6587\u4ef6\u7684\u7eafshell\u7684\u811a\u672c\u3002\n# \u6240\u4ee5\u5b83\u4eec\u80fd\u628a\u8f93\u51fa\u63d0\u4f9b\u7ed9xargs\u5e76\u5904\u7406 :)\n# \u4f8b\u5982\uff1a broken-link.sh /somedir /someotherdir|xargs rm\n# \u4e0b\u9762\u662f\u66f4\u597d\u7684\u53d1\u73b0\u6b7b\u7b26\u53f7\u94fe\u63a5\u7684\u529e\u6cd5:\n# find \"somedir\" -type l -print0|\\\n# xargs -r0 file|\\\n# grep \"broken symbolic\"|\n# sed -e 's/^\\|: *broken symbolic.*$/\"/g'\n# \u4f46\u8fd9\u4e0d\u662f\u7eafbash\u811a\u672c\uff0c\u4e0b\u9762\u7684\u5219\u662f.\n# \u6ce8\u610f: \u8c28\u9632\u5728/proc\u6587\u4ef6\u7cfb\u7edf\u548c\u6b7b\u5faa\u73af\u94fe\u63a5\u4e2d\u4f7f\u7528!\n# \u5982\u679c\u6ca1\u6709\u53c2\u6570\u88ab\u4f20\u9012\u7ed9\u811a\u672c\u4f5c\u4e3a\u641c\u7d22\u76ee\u5f55\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\n[[ $# -eq 0 ]] &amp;&amp; directories=`pwd` || directories=$@\n\n#Setup the function link_chk to check the directory it is passed\n#for files that are links and don't exist, then print them quoted.\n#If one of the elements in the directory is a subdirectory then\n#send that send that subdirectory to the link_check function.\n########\nlink_chk () {\n    for element in $1/*; do\n    [[ -h \"$element\" -a ! -e \"$element\" ]] &amp;&amp; echo \\\"$element\\\"\n    [[ -d \"$element\" ]] &amp;&amp; linkchk $element\n    # Of course, '-h' tests for symbolic link, '-d' for directory.\n    done\n}\n\n#Send each arg that was passed to the script to the link_chk function\n#if it is a valid directory.  If not, then print the error message\n#and usage info.\n############\nfor directory in $directories; do\n    if [[ -d $directories ]]\n    then link_chk $directories\n    else\n        echo \"$directories is not a directory\"\n        echo \"Usage: $0 dir1 dir2 ...\"\n    fi\ndone\n\n# [1] \u4e00\u5b9a\u8981\u610f\u8bc6\u5230suid\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u80fd\u5f15\u8d77\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u5e76\u4e14\u5728shell\u811a\u672c\u4e2dsuid\u6807\u5fd7\u5df2\u7ecf\u4e0d\u8d77\u4f5c\u7528\u4e86\n# [2] \u5728\u73b0\u4ee3UNIX\u64cd\u4f5c\u7cfb\u7edf\uff0c\u7c98\u4f4f\u4f4d\u5df2\u7ecf\u4e0d\u5728\u6587\u4ef6\u4e2d\u518d\u4f7f\u7528\uff0c\u53ea\u7528\u5728\u76ee\u5f55\u4e2d\n</code></pre>"},{"location":"coding/Shell/#then","title":"then\u8bed\u53e5\u540e\u9762\u7684\u547d\u4ee4","text":"Bash<pre><code># then\u8bed\u53e5\u540e\u9762\u7684CONSEQUENT-COMMANDS\u5217\u8868\u53ef\u4ee5\u662f\u4efb\u4f55\u6709\u6548\u7684UNIX\u547d\u4ee4\uff0c\u4efb\u4f55\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u4efb\u4f55\u53ef\u6267\u884cshell\u811a\u672c\u6216\u4efb\u4f55shell\u8bed\u53e5\uff0c\u4f46\u7ed3\n# \u675ffi\u9664\u5916\u3002\u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0cthen\u548cfi\u88ab\u8ba4\u4e3a\u662fshell\u4e2d\u7684\u5206\u9694\u8bed\u53e5\u3002\u56e0\u6b64\uff0c\u5728\u547d\u4ee4\u884c\u4e0a\u53d1\u51fa\u65f6\uff0c\u5b83\u4eec\u7528\u5206\u53f7\u5206\u9694\n#\u7b2c\u4e00\u4e2a\u793a\u4f8b\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728\n#!/bin/bash\n\necho \"This scripts checks the existence of the messages file.\"\necho \"Checking...\"\nif [[ -f /var/log/messages ]]\n  then\n    echo \"/var/log/messages exists.\"\nfi\necho\necho \"...done.\"\n\n: &lt;&lt; comment\n\u4e00\u4e2aif/then\u7ed3\u6784\u6d4b\u8bd5\u4e00\u5217\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u662f\u5426\u4e3a0\uff08\u56e0\u4e3a\u4f9d\u7167\u60ef\u4f8b\uff0c0\u610f\u5473\u7740\u547d\u4ee4\u6267\u884c\u6210\u529f\uff09\uff0c\u5982\u679c\u662f0\u5219\u4f1a\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u547d\u4ee4\n\u6709\u4e00\u4e2a\u547d\u4ee4 [ (\u5de6\u65b9\u62ec\u662f\u7279\u6b8a\u5b57\u7b26). \u5b83\u548ctest\u662f\u540c\u4e49\u8bcd,\u56e0\u4e3a\u6548\u7387\u7684\u539f\u56e0\uff0c\u5b83\u88ab\u5185\u5efa\u5728shell\u91cc\u3002\u8fd9\u4e2a\u547d\u4ee4\u7684\u53c2\u6570\u662f\u6bd4\u8f83\u8868\u8fbe\u5f0f\u6216\u8005\n\u6587\u4ef6\u6d4b\u8bd5\uff0c\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u72b6\u6001\u6307\u793a\u6bd4\u8f83\u7684\u7ed3\u679c(0\u8868\u793a\u771f\uff0c1\u8868\u793a\u5047)\n\n#\u4e00\u4e2aif/then\u7ed3\u6784\u80fd\u5305\u542b\u5d4c\u5957\u7684\u6bd4\u8f83\u548c\u6d4b\u8bd5\nif echo \"Next *if* is part of the comparison for the first *if*.\"\n  if [[ $comparison = \"integer\" ]]\n    then (( a &lt; b ))\n  else\n    [[ $a &lt; $b ]]\n  fi\nthen\n  echo '$a is less than $b'\nfi\ncomment\n\n# \u5f53if\u548cthen\u5728\u540c\u4e00\u884c\u7684\u65f6\u5019\uff0c\u4e00\u4e2a\u5206\u53f7\uff08;\uff09\u5fc5\u987b\u7528\u5728if\u8bed\u53e5\u7684\u7ed3\u5c3e\u3002if\u548cthen\u90fd\u662f\u5173\u952e\u5b57.\u5173\u952e\u5b57\uff08\u6216\u547d\u4ee4\uff09\u5f00\u59cb\u4e00\u4e2a\u8bed\u53e5\uff0c\u5982\u679c\u5728\u540c\n# \u4e00\u884c\u5f00\u59cb\u53e6\u4e00\u4e2a\u65b0\u8bed\u53e5\u65f6\uff0c\u524d\u9762\u4e00\u4e2a\u8bed\u53e5\u5fc5\u987b\u7528\u5206\u53f7\uff08;\uff09\u7ed3\u675f  \u4f8b\u5982\uff1aif [ -x \"$filename\" ]; then\n\n#\u7b49\u4ef7\u7684\u6d4b\u8bd5\u547d\u4ee4\uff1atest,/usr/bin/test,[]\u548c/usr/bin/[\n#!/bin/bash\nif test -z \"$1\"\nthen\n  echo \"No command-line arguments.\"\nelse\n  echo \"First command-line argument is $1.\"\nfi\n\nif /usr/bin/test -z \"$1\"      # \u548c\u5185\u5efa\u7684\"test\"\u547d\u4ee4\u4e00\u6837.\nthen\n  echo \"No command-line arguments.\"\nelse\n  echo \"First command-line argument is $1.\"\nfi\n\nif [ -z \"$1\" ]                # \u548c\u4e0a\u9762\u4ee3\u7801\u5757\u7684\u529f\u80fd\u4e00\u6837\nthen\n  echo \"No command-line arguments.\"\nelse\n  echo \"First command-line argument is $1.\"\nfi\n\nif /usr/bin/[ -z \"$1\" ]       # \u540c\u6837\u548c\u4e0a\u9762\u7684\u4ee3\u7801\u5757\u4e00\u6837.\n# if /usr/bin/[ -z \"$1\"       # \u5de5\u4f5c, \u4f46\u8fd8\u662f\u7ed9\u51fa\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f.\u6ce8\u610f:\u8fd9\u4e2a\u5df2\u7ecf\u5728bash 3.x\u7248\u672c\u88ab\u4fee\u8865\u597d\u4e86\u3002\nthen\n  echo \"No command-line arguments.\"\nelse\n  echo \"First command-line argument is $1.\"\nfi\n\n# \u5728[[\u548c]]\u4e4b\u95f4\u7684\u6240\u6709\u7684\u5b57\u7b26\u90fd\u4e0d\u4f1a\u88ab\u6587\u4ef6\u6269\u5c55\u6216\u662f\u6807\u8bb0\u5206\u5272\uff0c\u4f46\u662f\u4f1a\u6709\u53c2\u6570\u5f15\u7528\u548c\u547d\u4ee4\u66ff\u6362\nfile=/etc/passwd\n\nif [[ -e $file ]]\nthen\n  echo \"Password file exists.\"\nfi\n\n# \u7528[[ .. ]]\u6d4b\u8bd5\u7ed3\u6784\u6bd4\u7528[ .. ]\u66f4\u80fd\u9632\u6b62\u811a\u672c\u903b\u8f91\u9519\u8bef\u3002\u4f8b\u5982\uff1a&amp;&amp;,||,&lt;\u548c&gt;\u64cd\u4f5c\u7b26\u80fd\u5728\u4e00\u4e2a[[]]\u6d4b\u8bd5\u91cc\u901a\u8fc7\uff0c\u4f46\u5728[]\u7ed3\u6784\u4f1a\u53d1\u751f\u9519\u8bef\n# \u5728\u4e00\u4e2aif\u7684\u540e\u9762\uff0c\u4e0d\u5fc5\u4e00\u5b9a\u662ftest\u547d\u4ee4\u6216\u662ftest\u7ed3\u6784\uff08[]\u6216\u662f[[]]\uff09\ndir=/home/bozo\n\nif cd \"$dir\" 2&gt;/dev/null; then   # \"2&gt;/dev/null\"\u4f1a\u9690\u85cf\u9519\u8bef\u7684\u4fe1\u606f.\n  echo \"Now in $dir.\"\nelse\n  echo \"Can't change to $dir.\"\nfi\n# \"if COMMAND\"\u7ed3\u6784\u4f1a\u8fd4\u56deCOMMAND\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801\n# \u540c\u6837\u7684\uff0c\u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u53f7\u91cc\u9762\u7684\u6761\u4ef6\u6d4b\u8bd5\u4e5f\u53ef\u4ee5\u7528\u5217\u8868\u7ed3\u6784(list construct)\u800c\u4e0d\u5fc5\u7528if\u3002\nvar1=20\nvar2=22\n[ \"$var1\" -ne \"$var2\" ] &amp;&amp; echo \"$var1 is not equal to $var2\"\n\nhome=/home/bozo\n[ -d \"$home\" ] || echo \"$home directory does not exist.\"\n</code></pre>"},{"location":"coding/Shell/#_3","title":"\u64cd\u4f5c\u7b26","text":""},{"location":"coding/Shell/#_4","title":"\u7b97\u672f\u8fd0\u7b97\u7b26","text":"\u7b97\u672f\u8fd0\u7b97\u7b26 \u63cf\u8ff0 bash\u65e0\u6cd5\u5904\u7406\u6d6e\u70b9\u8fd0\u7b97\uff0c\u9ed8\u8ba4\u4f1a\u628a\u5c0f\u6570\u70b9\u7684\u6570\u5b57\u4f5c\u4e3a\u5b57\u7b26\u4e32\uff0c\u811a\u672c\u4e2d\u4f7f\u7528bc\u8fdb\u884c\u6d6e\u70b9\u8ba1\u7b97\u6216\u6dfb\u52a0\u6570\u5b66\u5e93\u51fd\u6570\u7684\u652f\u6301 + - \u52a0\u6cd5 \u51cf\u6cd5(\u5e38\u7528) * / % \u4e58\u6cd5 \u9664\u6cd5 \u53d6\u6a21(\u5e38\u7528) ** \u5e42\u8fd0\u7b97(\u5e38\u7528) ++ -- \u81ea\u52a0 \u81ea\u51cf\uff0c\u53ef\u653e\u5728\u53d8\u91cf\u524d\u53d8\u91cf\u540e,\u53d8\u91cf\u4e4b\u524d\u8868\u793a\u5148\u81ea\u589e\u6216\u81ea\u51cf\u518d\u8d4b\u503c\u7ed9\u53d8\u91cf\uff0c\u4e4b\u540e\u8868\u793a\u5148\u8d4b\u503c\u518d\u81ea\u589e\u6216\u81ea\u51cf(\u5e38\u7528) ! &amp;&amp; || \u903b\u8f91\u975e\uff08\u53d6\u53cd\uff09 \u903b\u8f91\u4e0e\uff08and\uff09 \u903b\u8f91\u6216\uff08or\uff09 (\u5e38\u7528) &lt; &lt;= &gt; &gt;= \u6bd4\u8f83\u7b26\u53f7 == != = \u6bd4\u8f83\u7b26\u53f7 &lt;&lt; &gt;&gt; \u5411\u5de6\u4f4d\u79fb \u5411\u53f3\u4f4d\u79fb ~ &amp; ^ = += -= *= /= %= \u8d4b\u503c\u8fd0\u7b97\u7b26 \u7b97\u672f\u8fd0\u7b97\u8868\u8fbe\u5f0f\u548c\u8fd0\u7b97\u547d\u4ee4 \u63cf\u8ff0 (()) \u6574\u6570\u8fd0\u7b97\u7684\u5e38\u7528\u64cd\u4f5c\u7b26 let \u7528\u4e8e\u6574\u6570\u8fd0\u7b97\u548c(())\u7c7b\u4f3c expr \u901a\u5e38\u7528\u4e8e\u6574\u6570\u8ba1\u7b97\u4e5f\u6709\u5176\u4ed6\u989d\u5916\u529f\u80fd bc \u9002\u5408\u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 $[] \u7528\u4e8e\u6574\u6570\u8fd0\u7b97 awk \u6574\u6570\u548c\u5c0f\u6570\u8fd0\u7b97 declare \u5b9a\u4e49\u53d8\u91cf\u503c\u548c\u5c5e\u6027,-i\u53c2\u6570\u7528\u4e8e\u5b9a\u4e49\u6574\u578b\u53d8\u91cf"},{"location":"coding/Shell/#_5","title":"\u7b97\u672f\u6d4b\u8bd5","text":"Markdown<pre><code># (( ))\u7ed3\u6784\u6269\u5c55\u5e76\u8ba1\u7b97\u4e00\u4e2a\u7b97\u672f\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u5982\u679c\u8868\u8fbe\u5f0f\u503c\u4e3a0\uff0c\u4f1a\u8fd4\u56de1\u6216\u5047\u4f5c\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u3002\u4e00\u4e2a\u975e\u96f6\u503c\u7684\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a0\u6216\u771f\u4f5c\u4e3a\n# \u9000\u51fa\u72b6\u6001\u7801\u3002\u8fd9\u4e2a\u7ed3\u6784\u548c\u5148\u524dtest\u547d\u4ee4\u53ca[]\u7ed3\u6784\u7684\u8ba8\u8bba\u521a\u597d\u76f8\u53cd\n\n#\u7528(( ))\u8fdb\u884c\u7b97\u672f\u6d4b\u8bd5\n#!/bin/bash\n# \u7b97\u672f\u6d4b\u8bd5.(( ... ))\u7ed3\u6784\u4f1a\u6c42\u503c\u5e76\u6d4b\u8bd5\u8be5\u503c\u3002\u9000\u51fa\u72b6\u6001\u7801\u4e0e[ ... ]\u7ed3\u6784\u6b63\u597d\u76f8\u53cd!\u8fd4\u56de0\u4ee3\u8868\u771f\uff0c1\u4ee3\u8868\u5047\n\n(( 0 )); echo \"Exit status of \\\"(( 0 ))\\\" is $?.\"         # 1\n(( 1 )); echo \"Exit status of \\\"(( 1 ))\\\" is $?.\"         # 0\n(( 5 &gt; 4 )); echo \"Exit status of \\\"(( 5 &gt; 4 ))\\\" is $?.\"     # 0\n(( 5 &gt; 9 )); echo \"Exit status of \\\"(( 5 &gt; 9 ))\\\" is $?.\"     # 1\n(( 5 - 5 )); echo \"Exit status of \\\"(( 5 - 5 ))\\\" is $?.\"     # 1\n(( 5 / 4 )); echo \"Exit status of \\\"(( 5 / 4 ))\\\" is $?.\"     # 0\n(( 1 / 2 )); echo \"Exit status of \\\"(( 1 / 2 ))\\\" is $?.\"     # 1\n(( 1 / 0 )) 2&gt;/dev/null; echo \"Exit status of \\\"(( 1 / 0 ))\\\" is $?.\"     # 1\n</code></pre>"},{"location":"coding/Shell/#_6","title":"\u5176\u4ed6\u6bd4\u8f83\u64cd\u4f5c\u7b26","text":"<p>\u4e8c\u5143\u6bd4\u8f83\u64cd\u4f5c\u7b26\u6bd4\u8f83\u4e24\u4e2a\u53d8\u91cf\u6216\u662f\u6570\u503c\u3002\u6ce8\u610f\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83\u7684\u5206\u522b</p>"},{"location":"coding/Shell/#_7","title":"\u6574\u6570\u6bd4\u8f83","text":"\u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b -eq \u7b49\u4e8e if [ \"\\(a\" -eq \"\\)b\" ] -ne \u4e0d\u7b49\u4e8e if [ \"\\(a\" -ne \"\\)b\" ] -gt \u5927\u4e8e if [ \"\\(a\" -gt \"\\)b\" ] -ge \u5927\u4e8e\u7b49\u4e8e if [ \"\\(a\" -ge \"\\)b\" ] -lt \u5c0f\u4e8e if [ \"\\(a\" -lt \"\\)b\" ] -le \u5c0f\u4e8e\u7b49\u4e8e if [ \"\\(a\" -le \"\\)b\" ] &gt; \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u5185\u4f7f\u7528) ((\"\\(a\" &gt; \"\\)b\")) &gt;= \u5927\u4e8e\u7b49\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\"\\(a\" &gt;= \"\\)b\")) &lt; \u5c0f\u4e8e(\u5728\u53cc\u5c0f\u62ec\u53f7\u91cc\u4f7f\u7528) ((\"\\(a\" &lt; \"\\)b\")) &lt;= \u5c0f\u4e8e\u7b49\u4e8e (\u5728\u53cc\u62ec\u53f7\u91cc\u4f7f\u7528) ((\"\\(a\" &lt;= \"\\)b\"))"},{"location":"coding/Shell/#_8","title":"\u5b57\u7b26\u4e32\u6bd4\u8f83","text":"\u8868\u8fbe\u5f0f \u542b\u4e49 \u793a\u4f8b = \u7b49\u4e8e if [ \"\\(a\" = \"\\)b\" ] == \u7b49\u4e8e\u2460 if [ \"\\(a\" == \"\\)b\" ] != \u4e0d\u7b49\u4e8e if [ \"\\(a\" != \"\\)b\" ] &lt; \u5c0f\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \"\\(a\" &lt; \"\\)b\" ]]\u6216if [ \"\\(a\" \\&lt; \"\\)b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26&lt; &gt; \u5927\u4e8e,\u6309\u7167ASCII\u5b57\u7b26\u6392\u5e8f\u8fdb\u884c\u6bd4\u8f83 if [[ \"\\(a\" &gt; \"\\)b\" ]]\u6216if [ \"\\(a\" \\&gt; \"\\)b\" ]\uff0c\u5728[]\u8981\u6ce8\u610f\u8f6c\u4e49\u5b57\u7b26&gt; -z \u5b57\u7b26\u4e32\u4e3anull,\u5373\u6307\u5b9a\u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a\u96f6 -n \u5b57\u7b26\u4e32\u4e0d\u4e3anull,\u5373\u957f\u5ea6\u4e0d\u4e3a\u96f6 <p>\u2460\u533a\u522b\u89e3\u6790\uff1a</p> <ul> <li>==\u548c=\u540c\u4e49\u8bcd\uff0c\u4f46==\u6bd4\u8f83\u64cd\u4f5c\u7b26\u5728\u4e00\u4e2a\u53cc\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u548c\u4e00\u4e2a\u5355\u4e2d\u62ec\u53f7\u6d4b\u8bd5\u610f\u601d\u4e0d\u540c</li> <li>[[ \\(a == z* ]]    # \u5982\u679c\u53d8\u91cf\\)a\u4ee5\u5b57\u7b26\"z\"\u5f00\u59cb(\u6a21\u5f0f\u5339\u914d)\u5219\u4e3a\u771f</li> <li>[[ \\(a == \"z*\" ]]  # \u5982\u679c\u53d8\u91cf\\)a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f</li> <li>[ $a == z* ]      # \u6587\u4ef6\u6269\u5c55\u548c\u5355\u5143\u5206\u5272\u6709\u6548</li> <li>[ \"\\(a\" == \"z*\" ]  # \u5982\u679c\u53d8\u91cf\\)a\u4e0ez*(\u5b57\u9762\u4e0a\u7684\u5339\u914d)\u76f8\u7b49\u5219\u4e3a\u771f</li> </ul> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <p>\u5728\u65b9\u62ec\u53f7\u6d4b\u8bd5\u91cc\uff0c\u8fdb\u884c-n\u6d4b\u8bd5\u65f6\u5fc5\u987b\u628a\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff0c-z\u4e00\u822c\u4e0d\u5f15\u8d77\u6765\u90fd\u80fd\u5de5\u4f5c\uff0c\u4f46\u6700\u597d\u628a\u6d4b\u8bd5\u5b57\u7b26\u4e32\u7528\u5f15\u53f7\u62ec\u8d77\u6765\u3002\u5982\u679c$string \u53d8\u91cf\u4e3a\u7a7a\uff0c\u6b64\u5b57\u7b26\u4e32\u53d8\u91cf\u5f15\u8d77\u6765\u4f9d\u7136\u4f1a\u62a5\u9519\uff0c\u5b89\u5168\u7684\u65b9\u6cd5\u662f\u9644\u52a0\u4e00\u4e2a\u5916\u90e8\u5b57\u7b26\u4e32\u7ed9\u53ef\u80fd\u6709\u7a7a\u5b57\u7b26\u53d8\u91cf\u3002\u5982\uff1a</p> <p>[ \"x\\(string\" != x -o \"x\\)a\" = \"x$b\" ]\uff08x\u5b57\u7b26\u53ef\u4ee5\u4e92\u76f8\u62b5\u6d88\uff09</p>"},{"location":"coding/Shell/#_9","title":"\u6df7\u5408\u6bd4\u8f83","text":"\u8868\u8fbe\u5f0f \u542b\u4e49 -a \u903b\u8f91\u4e0e\uff0c\u5982\u679cexp1\u548cexp2\u90fd\u4e3a\u771f\uff0c\u5219exp1 -a exp2\u8fd4\u56de\u771f -o \u903b\u8f91\u6216\uff0c\u53ea\u8981exp1\u548cexp2\u4efb\u4f55\u4e00\u4e2a\u4e3a\u771f\uff0c\u5219exp1 -o exp2\u8fd4\u56de\u771f"},{"location":"coding/Shell/#_10","title":"\u7b97\u672f\u548c\u5b57\u7b26\u4e32\u6bd4\u8f83","text":"Bash<pre><code># a\u548cb\u65e2\u80fd\u88ab\u770b\u6210\u662f\u6574\u6570\u4e5f\u80fd\u88ab\u770b\u7740\u662f\u5b57\u7b26\u4e32\u3002\u5728\u5b57\u7b26\u4e32\u548c\u6570\u5b57\u4e4b\u95f4\u4e0d\u662f\u4e25\u683c\u754c\u5b9a\u7684\uff0cbash\u53d8\u91cf\u662f\u65e0\u7c7b\u578b\u7684\uff0cBash\u53d8\u91cf\u4e0d\u662f\u5f3a\u7c7b\u578b\u7684\n#  Bash\u5141\u8bb8\u53d8\u91cf\u7684\u6574\u6570\u64cd\u4f5c\u548c\u6bd4\u8f83\uff0c\u4f46\u8fd9\u4e9b\u53d8\u91cf\u5fc5\u987b\u53ea\u5305\u62ec\u6570\u5b57\u5b57\u7b26,\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u5e94\u8be5\u5c0f\u5fc3\u8003\u8651\u3002\u4f8b\u5982\uff1a\n#!/bin/bash\n# \u6b64\u4f8b\u5b50\u4e2d-ne\u548c!=\u5747\u80fd\u5de5\u4f5c\uff0c\u4ee5\u4e0b\u662f\u5177\u4f53\u6bd4\u8f83\na=4\nb=5\n\nif [[ \"$a\" -ne \"$b\" ]]; then echo \"$a \u4e0d\u7b49\u4e8e $b\"; echo \"(\u6574\u6570\u6bd4\u8f83)\"; fi   # ab\u4f5c\u4e3a\u6574\u6570\u6bd4\u8f83\nif [[ \"$a\" != \"$b\" ]]; then echo \"$a \u4e0d\u7b49\u4e8e $b\"; echo \"(\u5b57\u7b26\u4e32\u6bd4\u8f83)\"; fi    # ab\u4f5c\u4e3a\u5b57\u7b26\u4e32\u6bd4\u8f83\n\n# \u6d4b\u8bd5\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u662fnull\u503c\n#!/bin/bash\n\n# \u7528if [ ... ]\u7ed3\u6784,\u6d4b\u8bd5null\u5b57\u7b26\u4e32\u548c\u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u7684\u5b57\u7b26\u4e32\n# \u5982\u679c\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\u6ca1\u6709\u88ab\u521d\u59cb\u5316\uff0c\u5b83\u91cc\u9762\u7684\u503c\u672a\u5b9a\u4e49\u3002\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a\"null\"\u503c(\u4e0d\u540c\u4e8e\u96f6)\n\n# \u7b2c\u4e00\u6b21\uff0c$string1\u6ca1\u6709\u88ab\u58f0\u660e\u6216\u521d\u59cb\u5316\nif [[ -n $string1 ]]\n    then\n    echo \"String \\\"string1\\\" is not null.\"\nelse\n    echo \"String \\\"string1\\\" is null.\"\nfi\n# \u9519\u8bef\u7ed3\u679c.\n# Shows $string1 as not null, although it was not initialized.\n\n# \u7b2c\u4e8c\u6b21, $string1\u53d8\u91cf\u88ab\u5f15\u53f7\u5f15\u8d77\nif [[ -n \"$string1\" ]]\n    then\n    echo \"String \\\"string1\\\" is not null.\"\nelse\n    echo \"String \\\"string1\\\" is null.\"\nfi                    # \u5728\u4e00\u4e2a\u6d4b\u8bd5\u65b9\u62ec\u91cc\u7528\u5f15\u53f7\u5f15\u8d77\u53d8\u91cf!\n\n# \u7b2c\u4e09\u6b21,\u53d8\u91cf$string1\u4ec0\u4e48\u4e5f\u4e0d\u52a0\nif [[ $string1 ]]\n    then\n    echo \"String \\\"string1\\\" is not null.\"\nelse\n    echo \"String \\\"string1\\\" is null.\"\nfi\n# \u4ee5\u4e0a\u6b63\u5e38\u6267\u884c,[]\u6d4b\u8bd5\u8fd0\u7b97\u7b26\u5355\u72ec\u68c0\u6d4b\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a,\u4f46\u7528\u5f15\u53f7\u62ec\u8d77\u6765\"$string1\"\u624d\u662f\u66f4\u597d\u4e60\u60ef\n\nstring1=initialized\n\nif [ $string1 ]       # Again, $string1 stands naked.\nthen\necho \"String \\\"string1\\\" is not null.\"\nelse\necho \"String \\\"string1\\\" is null.\"\nfi\n# \u518d\u6b21\u663e\u793a\u6b63\u786e\u7ed3\u679c\uff0c\u7136\u800c\u66f4\u597d\u4ecd\u7136\u662f\u7528\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u4e14\u770b\u4ee5\u4e0b\u7684\u5217\u5b50\n\nstring1=\"a = b\"\n\nif [ $string1 ]       # \u6ca1\u6709\u7528\u5f15\u53f7\u5f15\u8d77\u6765\n    then\n    echo \"String \\\"string1\\\" is not null.\"\nelse\n    echo \"String \\\"string1\\\" is null.\"\nfi\n# $string1\u6ca1\u6709\u5f15\u53f7\u663e\u793a\u51fa\u9519\u8bef\u7684\u7ed3\u679c\n\n#!/bin/bash\n# \u7528more\u547d\u4ee4\u67e5\u770b\u88ab\u538b\u7f29\u8fc7\u7684\u6587\u4ef6\n\nNOARGS=65\nNOTFOUND=66\nNOTGZIP=67\n\nif [ $# -eq 0 ] # \u7b49\u540c\u4e8e:  if [ -z \"$1\" ]\n# $1\u53ef\u4ee5\u5b58\u5728,\u4f46\u4e3a\u7a7a:  zmore \"\" arg2 arg3\n    then\n    echo \"Usage: `basename $0` filename\" &gt;&amp;2\n# \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef.\nexit $NOARGS\n# \u8fd4\u56de65\u4f5c\u4e3a\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001(\u9519\u8bef\u7801).\nfi\n\nfilename=$1\n\nif [ ! -f \"$filename\" ]   # Quoting $filename allows for possible ces.\n    then\n    echo \"File $filename not found!\" &gt;&amp;2\n# \u9519\u8bef\u4fe1\u606f\u6253\u5370\u5230\u6807\u51c6\u9519\u8bef.\nexit $NOTFOUND\nfi\n\nif [ ${filename##*.} != \"gz\" ]\n# \u5728\u65b9\u62ec\u53f7\u91cc\u4f7f\u7528\u53d8\u91cf\u66ff\u6362.\n    then\n    echo \"File $1 is not a gzipped file!\"\nexit $NOTGZIP\nfi\n\nzcat $1 | more  # \u7528\u8fc7\u6ee4\u7a0b\u5e8fmore,\u4e5f\u53ef\u4ee5\u7528less\u4ee3\u66ff\n\nexit $?   # \u811a\u672c\u8fd4\u56de\u7ba1\u9053\u7684\u9000\u51fa\u72b6\u6001,\u5b9e\u9645\u4e0a\"exit $?\"\u662f\u591a\u4f59\u7684,\u56e0\u4e3a\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u4f1a\u8fd4\u56de\u6700\u540e\u4e00\u4e2a\u6267\u884c\u547d\u4ee4\u7684\u9000\u51fa\u7801\n</code></pre>"},{"location":"coding/Shell/#_11","title":"\u4f4d\u64cd\u4f5c\u7b26","text":"<p>\u5f88\u5c11\u5728\u811a\u672c\u4e2d\u4f7f\u7528\uff0c\u4e3b\u8981\u7528\u4e8e\u64cd\u4f5c\u548c\u6d4b\u8bd5\u4ece\u7aef\u53e3\u6216sockets\u4e2d\u8bfb\u53d6\u7684\u6570\u636e\uff0c\u4f4d\u8fd0\u7b97\u591a\u7528\u4e8e\u7f16\u8bd1\u578b\u8bed\u8a00\uff0c\u5982C\u3001C++\u8bed\u8a00</p> \u8868\u8fbe\u5f0f \u542b\u4e49 &lt;&lt; \u5de6\u4f4d\u79fb\uff0c\u6bcf\u79fb\u4e00\u4f4d\u76f8\u5f53\u4e8e\u4e58\u4ee52 &lt;&lt;= \u5de6\u4f4d\u79fb\u8d4b\u503c,\u5982\uff1alet \"var &lt;&lt;=2\" \u65f6var\u53d8\u91cf\u4e8c\u8fdb\u5236\u503c\u5de6\u79fb\u4e24\u4f4d\uff0c\u76f8\u5f53\u4e8e\u4e58\u4ee54 &gt;&gt; \u53f3\u4f4d\u79fb\uff0c\u6bcf\u79fb\u4e00\u4f4d\u76f8\u5f53\u9664\u4ee52 &gt;&gt;= \u53f3\u4f4d\u79fb\u8d4b\u503c &amp; \u4f4d\u4e0e &amp;= \u4f4d\u4e0e\u8d4b\u503c | \u4f4d\u6216 |= \u4f4d\u6216\u8d4b\u503c ~ \u4f4d\u53cd ! \u4f4d\u975e ^ \u4f4d\u6216 ^= \u4f4d\u6216\u8d4b\u503c"},{"location":"coding/Shell/#_12","title":"\u6570\u5b57\u5e38\u91cf","text":"<p>\u9664\u975e\u4e00\u4e2a\u6570\u5b57\u6709\u7279\u522b\u7684\u524d\u7f00\u6216\u7b26\u53f7\uff0c\u5426\u5219shell\u811a\u672c\u628a\u5b83\u5f53\u6210\u5341\u8fdb\u5236\u7684\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0\u7684\u6570\u5b57\u662f\u516b\u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u524d\u7f00\u4e3a0x\u7684\u6570\u5b57\u662f\u5341\u516d \u8fdb\u5236\u6570\u3002\u4e00\u4e2a\u6570\u7528\u5185\u5d4c\u7684#\u6765\u6c42\u503c\u5219\u770b\u6210BASE#NUMBER(\u6709\u8303\u56f4\u548c\u7b26\u53f7\u9650\u5236)(\u8bd1\u8005\u6ce8\uff1aBASE#NUMBER\u5373\uff1a\u57fa\u6570#\u6570\u503c\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u4f8b\u5b50)</p> Bash<pre><code>#\u6570\u5b57\u5e38\u91cf\u7684\u8868\u793a\u6cd5\n#!/bin/bash\n# numbers.sh: \u4e0d\u540c\u57fa\u6570\u7684\u6570\u5b57\u8868\u793a\u6cd5.\n\n# \u5341\u8fdb\u5236\u6570: \u5b83\u662f\u9ed8\u8ba4\u7684\nlet \"dec = 32\"; echo \"decimal number = $dec\"             # 32\n\n# \u516b\u8fdb\u5236\u6570: \u4ee5'0'(\u96f6)\u4e3a\u524d\u7f00\nlet \"oct = 032\"; echo \"octal number = $oct\"               # 26,\u7ed3\u679c\u8868\u793a\u4e3a\u5341\u8fdb\u5236.\n\n# \u5341\u516d\u8fdb\u5236: \u4ee5'0x'\u6216'0X'\u4e3a\u524d\u7f00\nlet \"hex = 0x32\"; echo \"hexadecimal number = $hex\"         # 50,\u4ee5\u5341\u8fdb\u5236\u7684\u5f62\u5f0f\u8868\u793a.\n\n# \u5176\u4ed6\u7684\u8fdb\u5236\u7684\u8868\u793a\u5f62\u5f0f: BASE#NUMBER\n# BASE\u503c\u57282\u548c64\u4e4b\u95f4.\n# NUMBER\u5fc5\u987b\u4f7f\u7528\u5728BASE\u8303\u56f4\u5185\u7684\u7b26\u53f7,\u770b\u4e0b\u9762\u7684\u793a\u4f8b.\n\nlet \"bin = 2#111100111001101\"; echo \"binary number = $bin\"              # 31181\nlet \"b32 = 32#77\"; echo \"base-32 number = $b32\"             # 231\nlet \"b64 = 64#@_\"; echo \"base-64 number = $b64\"             # 4031\n# \u8fd9\u4e2a\u7b26\u53f7\u53ea\u80fd\u5de5\u4f5c\u5728ASCII\u7801\u503c\u4e3a2-64\u7684\u8303\u56f4\u9650\u5236.\n# 10\u4e2a\u6570\u5b57+26\u4e2a\u5c0f\u5199\u5b57\u6bcd+26\u4e2a\u5927\u5199\u5b57\u6bcd+ @ + _\n\necho $((36#zz)) $((2#10101010)) $((16#AF16)) $((53#1aA))    # 1295 170 44822 3375\n\n#  \u63d0\u793a\uff1a\u4f7f\u7528\u4e00\u4e2a\u8d85\u51fa\u7ed9\u5b9a\u8fdb\u5236\u7684\u6570\u5b57\u5c06\u4f1a\u5f15\u8d77\u4e00\u4e2a\u9519\u8bef\u4fe1\u606f\uff0c\u4f8b\u5982\uff1a\nlet \"bad_oct = 081\"     # \u6b64\u4f8b\u5b50\u4f1a\u53d1\u751f\u9519\u8bef\uff0c\u56e0\u4e3a\u516b\u8fdb\u5236\u6570\u5b57\u53ea\u80fd\u4f7f\u7528\u6570\u5b570-7.\n</code></pre>"},{"location":"coding/Shell/#_13","title":"\u53d8\u91cf\u8bbf\u95ee","text":""},{"location":"coding/Shell/#_14","title":"\u53d8\u91cf\u95f4\u63a5\u5f15\u7528","text":"Bash<pre><code>a=b\nb=c\necho \"a=$a\" # a=1 \u76f4\u63a5\u5f15\u7528\necho \"a=\\$$a\"   # a=c   \u95f4\u63a5\u5f15\u7528\n</code></pre>"},{"location":"coding/Shell/#random","title":"$RANDOM\u968f\u673a\u6574\u6570","text":"<p>$RANDOM\u662fBash\u7684\u4e00\u4e2a\u8fd4\u56de\u4f2a\u968f\u673a[1]\u6574\u6570(\u8303\u56f4\u4e3a0-32767)\u7684\u5185\u90e8\u51fd\u6570(\u800c\u4e0d\u662f\u4e00\u4e2a\u5e38\u91cf\u6216\u53d8\u91cf)\uff0c\u4e0d\u5e94\u8be5\u7528\u4e8e\u4ea7\u751f\u52a0\u5bc6\u7684\u5bc6\u94a5</p>"},{"location":"coding/Shell/#_15","title":"\u5faa\u73af\u4e0e\u5206\u652f","text":"<p>\u5faa\u73af\u63a7\u5236\uff1abreak\u547d\u4ee4\u5c06\u4f1a\u8df3\u51fa\u5faa\u73af,continue\u547d\u4ee4\u5c06\u4f1a\u8df3\u8fc7\u672c\u6b21\u5faa\u73af\u4e0b\u8fb9\u7684\u8bed\u53e5,\u76f4\u63a5\u8fdb\u5165\u4e0b\u6b21\u5faa\u73af</p> Bash<pre><code>for i in {1..100}\ndo\n  echo \"\u81ea\u589e\u8ba1\u6570\u5faa\u73af\u793a\u4f8b---$i\"\ndone\n</code></pre>"},{"location":"coding/Shell/#_16","title":"\u5b9a\u4e49\u4e00\u4e2a\u989c\u8272\u8f93\u51fa\u5b57\u7b26\u4e32\u51fd\u6570","text":"Bash<pre><code># function\u5173\u952e\u5b57\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u52a0\u6216\u4e0d\u52a0\n\u65b9\u6cd5\u4e00\uff1a\nfunction echo_color(){\n if [$1 == \"green\"];then\n  echo -e \"\\033[32;40m$2\\033[0m\"\n elif [$1 == \"red\"0];then\n  echo -e \"\\\\033[31;40m$2\\033[0m\"\n fi\n}\n\n\u65b9\u6cd5\u4e8c\uff1a\nfunction echo_color(){\n case $1 in\n  green)\n   echo -e \"\\033[32;40m$2\\033[0m\"\n   ;;\n  red)\n   echo -e \"\\033[31;40m$2\\033[0m\"\n   ;;\n  *)\n   echo \"Example:echo_color red string\"\n  esac\n}\n</code></pre>"},{"location":"coding/Shell/#_17","title":"\u6279\u91cf\u521b\u5efa\u7528\u6237","text":"Bash<pre><code>#!/bin/bash\nDATE=$(date+%F_%T)\nUSER_FILE=user.txt\necho_color(){\n if [$1 == \"green\"];then\n  echo -e \"\\033[32;40m$2\\033[0m\"\n elif [$1 == \"red\"0];then\n  echo -e \"\\\\033[31;40m$2\\033[0m\"\n fi\n}\n# \u5982\u679c\u7528\u6237\u6587\u4ef6\u5b58\u5728\u5e76\u5927\u4e8e0\u5c31\u5907\u4efd\n if [-s $USER_FILE];then\n  mv $USER_FILE ${USER_FILE}-${DATE}.bak\n  echo_color green \"$USER_FILE exist,rename ${USER_FILE}-${DATE}.bak\"\n fi\n echo\n</code></pre>"},{"location":"coding/Shell/#_18","title":"\u521b\u5efa\u7279\u5b9a\u5927\u5c0f\u7684\u6587\u4ef6","text":"Bash<pre><code># \u521b\u5efa10M\u5927\u5c0f\u7684daygeek.txt\u6587\u4ef6\nfallocate -l 10M daygeek.txt\ntruncate -s 10M daygeek1.txt\nhead -c 10MB /dev/zero &gt; daygeek4.txt\n\ndd if=/dev/zero of=daygeek2.txt  bs=10M  count=1\n\u6216\ndd if=/dev/zero of=daygeek3.txt  bs=1M  count=10\n</code></pre>"},{"location":"coding/Shell/#shellcpu","title":"shell\u91c7\u96c6\u7cfb\u7edfcpu \u5185\u5b58 \u78c1\u76d8 \u7f51\u7edc\u4fe1\u606f","text":""},{"location":"coding/Shell/#cpu","title":"cpu\u4fe1\u606f\u91c7\u96c6","text":"Bash<pre><code># cpu\u4f7f\u7528\u7387\u91c7\u96c6\u7b97\u6cd5;\u901a\u8fc7/proc/stat\u6587\u4ef6\u91c7\u96c6\u5e76\u8ba1\u7b97CPU\u603b\u4f7f\u7528\u7387\u6216\u8005\u5355\u4e2a\u6838\u4f7f\u7528\u7387\u3002\u4ee5cpu0\u4e3a\u4f8b\uff0c\u7b97\u6cd5\u5982\u4e0b\uff1a\n: &lt;&lt; comment\ncat /proc/stat | grep \u2018cpu0\u2019 # \u5f97\u5230cpu0\u7684\u4fe1\u606f\ncpuTotal1=user+nice+system+idle+iowait+irq+softirq\ncpuUsed1=user+nice+system+irq+softirq\nsleep 30\u79d2\n# \u518d\u6b21cat /proc/stat | grep \u2018cpu0\u2019 \u5f97\u5230cpu\u7684\u4fe1\u606f\ncpuTotal2=user+nice+system+idle+iowait+irq+softirq\ncpuUsed2=user+nice+system+irq+softirq\n# \u5f97\u5230cpu0 \u572830\u79d2\u5185\u7684\u5355\u6838\u5229\u7528\u7387\uff1a(cpuUsed2 \u2013 cpuUsed1) * 100 / (cpuTotal2 \u2013 cpuTotal1)\n# \u76f8\u5f53\u4e8e\u4f7f\u7528top \u2013d 30\u547d\u4ee4\uff0c\u628auser\u3001nice\u3001system\u3001irq\u3001softirq\u4e94\u9879\u7684\u4f7f\u7528\u7387\u76f8\u52a0\ncomment\n\na=(`cat /proc/stat | grep -E \"cpu\\b\" | awk -v total=0 \\\n'{$1=\"\";for(i=2;i&lt;=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }END{print total,used}'`)\nsleep 30\nb=(`cat /proc/stat | grep -E \"cpu\\b\" | awk -v total=0 '{$1=\"\";for(i=2;i&lt;=NF;i++){total+=$i};used=$2+$3+$4+$7+$8 }\\\nEND{print total,used}'`)\ncpu_usage=(((${b[1]}-${a[1]})*100)/(${b[0]}-${a[0]})))  # \u6b64\u5904\u8bed\u6cd5\u6709\u95ee\u9898\uff0c\u6682\u672a\u4fee\u590d\n\n# cpu\u8d1f\u8f7d\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/loadavg\u5f97\u5230\u673a\u5668\u76841/5/15\u5206\u949f\u5e73\u5747\u8d1f\u8f7d\uff0c\u518d\u4e58\u4ee5100\n\ncpuload=(`cat /proc/loadavg | awk '{print $1,$2,$3}'`)\nload1=${cpuload[0]}\nload5=${cpuload[1]}\nload15=${cpuload[2]}\n</code></pre>"},{"location":"coding/Shell/#_19","title":"\u5185\u5b58\u91c7\u96c6","text":"Bash<pre><code># \u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0c(MemTotal \u2013 MemFree \u2013 Buffers \u2013 Cached)/1024\u5f97\u5230\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u5185\u5b58\u6570\n\nawk '/MemTotal/{total=$2}/MemFree/{free=$2}/Buffers/{buffers=$2}/^Cached/{cached=$2}END\\\n{print (total-free-buffers-cached)/1024}'  /proc/meminfo\n\n# MEM\u4f7f\u7528\u91cf\u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/meminfo\u6587\u4ef6\uff0cMemTotal \u2013 MemFree\u5f97\u5230MEM\u4f7f\u7528\u91cf\n\nawk '/MemTotal/{total=$2}/MemFree/{free=$2}END{print (total-free)/1024}'  /proc/meminfo\n\n# SWAP\u4f7f\u7528\u5927\u5c0f\u91c7\u96c6\u7b97\u6cd5\uff1a\u901a\u8fc7/proc/meminfo\u6587\u4ef6\uff0cSwapTotal \u2013 SwapFree\u5f97\u5230SWAP\u4f7f\u7528\u5927\u5c0f\n\nawk '/SwapTotal/{total=$2}/SwapFree/{free=$2}END{print (total-free)/1024}'  /proc/meminfo\n</code></pre>"},{"location":"coding/Shell/#_20","title":"\u78c1\u76d8\u4fe1\u606f\u91c7\u96c6","text":"Bash<pre><code># \u78c1\u76d8I/O\n# IN\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u786c\u76d8\u8bfb\u5230\u7269\u7406\u5185\u5b58\u7684\u6570\u636e\u91cf\n# \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgin\u7684\u589e\u91cf\uff0c\u628apgpgin\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf\n# \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bi\u4e00\u5217\u7684\u8f93\u51fa\n\na=`awk '/pgpgin/{print $2}' /proc/vmstat`\n#sleep 240\nb=`awk '/pgpgin/{print $2}' /proc/vmstat`\nioin=$((b-a)/240))\n\n# OUT\uff1a\u5e73\u5747\u6bcf\u79d2\u628a\u6570\u636e\u4ece\u7269\u7406\u5185\u5b58\u5199\u5230\u786c\u76d8\u7684\u6570\u636e\u91cf\n# \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/vmstat\u6587\u4ef6\u5f97\u51fa\u6700\u8fd1240\u79d2\u5185pgpgout\u7684\u589e\u91cf\uff0c\u628apgpgout\u7684\u589e\u91cf\u518d\u9664\u4ee5240\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u589e\u91cf\n# \u76f8\u5f53\u4e8evmstat 240\u547d\u4ee4bo\u4e00\u5217\u7684\u8f93\u51fa\n\na=`awk '/pgpgout/{print $2}' /proc/vmstat`\nsleep 240\nb=`awk '/pgpgout/{print $2}' /proc/vmstat`\nioout=$(((b-a)/240))\n</code></pre>"},{"location":"coding/Shell/#_21","title":"\u7f51\u7edc\u4fe1\u606f\u91c7\u96c6","text":"Bash<pre><code># \u6d41\u91cf:\u4ee5https://www.centos.bz/\u4e3a\u4f8b\uff0ceth0\u662f\u5185\u7f51\uff0ceth1\u5916\u7f51\uff0c\u83b7\u53d660\u79d2\u7684\u6d41\u91cf\n# \u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u6d41\u91cf\n# \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5b57\u8282\u6570\uff08KB\uff09\uff0c\u7136\u540e\u4e58\u4ee58\uff0c\u518d\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u6d41\u91cf\n\ntraffic_be=(`awk -F'[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev`)\nsleep 60\ntraffic_af=(`awk -F'[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $3,$10}/eth1/{print $3,$11}' /proc/net/dev`)\neth0_in=$(( (${traffic_af[0]}-${traffic_be[0]})/60 ))\neth0_out=$(( (${traffic_af[1]}-${traffic_be[1]})/60 ))\neth1_in=$(( (${traffic_af[2]}-${traffic_be[2]})/60 ))\neth1_out=$(( (${traffic_af[3]}-${traffic_be[3]})/60 ))\n\n# \u6570\u636e\u5305\u91cf\uff1a\u673a\u5668\u7f51\u5361\u7684\u5e73\u5747\u6bcf\u79d2\u5305\u91cf\n# \u91c7\u96c6\u7b97\u6cd5\uff1a\u8bfb\u53d6/proc/net/dev\u6587\u4ef6\uff0c\u5f97\u523060\u79d2\u5185\u53d1\u9001\u548c\u63a5\u6536\u7684\u5305\u91cf\uff0c\u7136\u540e\u9664\u4ee560\uff0c\u5f97\u5230\u6bcf\u79d2\u7684\u5e73\u5747\u5305\u91cf\n\npacket_be=(`awk -F'[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev`)\nsleep 60\npacket_af=(`awk -F'[: ]+' 'BEGIN{ORS=\" \"}/eth0/{print $4,$12}/eth1/{print $4,$12}' /proc/net/dev`)\neth0_in=$(( (${packet_af[0]}-${packet_be[0]})/60 ))\neth0_out=$(( (${packet_af[1]}- ${packet_be[1]})/60 ))\neth1_in=$(( (${packet_af[2]}- ${packet_be[2]})/60 ))\neth1_out=$(( (${packet_af[3]}- ${packet_be[3]})/60 ))\n</code></pre>"},{"location":"coding/Vim/","title":"Vim","text":"VimL<pre><code>\" \u67e5\u770b\u6587\u4ef6\u7f16\u7801\u683c\u5f0f\n:echo &amp;fileencoding\n\nvim \u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0cencoding\u3001fileencoding\u3001fileencodings\u3001termencoding (\u8fd9\u4e9b\u9009\u9879\u53ef\u80fd\u7684\u53d6\u503c\u8bf7\u53c2\u8003 vim \u5728\u7ebf\u5e2e\u52a9 :help encoding-names)\uff0c\u5b83\u4eec\u7684\u610f\u4e49\u5982\u4e0b:\n\nencoding: vim \u5185\u90e8\u4f7f\u7528\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5305\u62ec vim \u7684 buffer (\u7f13\u51b2\u533a)\u3001\u83dc\u5355\u6587\u672c\u3001\u6d88\u606f\u6587\u672c\u7b49\n\nfileencoding: vim \u4e2d\u5f53\u524d\u7f16\u8f91\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0cvim \u4fdd\u5b58\u6587\u4ef6\u65f6\u4e5f\u4f1a\u5c06\u6587\u4ef6\u4fdd\u5b58\u4e3a\u8fd9\u79cd\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f (\u4e0d\u7ba1\u662f\u5426\u65b0\u6587\u4ef6\u90fd\u5982\u6b64)\n\nfileencodings: vim \u542f\u52a8\u65f6\u4f1a\u6309\u7167\u5b83\u6240\u5217\u51fa\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u9010\u4e00\u63a2\u6d4b\u5373\u5c06\u6253\u5f00\u7684\u6587\u4ef6\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\uff0c\u5e76\u4e14\u5c06 fileencoding \u8bbe\u7f6e\u4e3a\u6700\u7ec8\u63a2\u6d4b\u5230\u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u56e0\u6b64\u6700\u597d\u5c06 unicode \u7f16\u7801\u65b9\u5f0f\u653e\u5230\u8fd9\u4e2a\u5217\u8868\u7684\u6700\u524d\u9762\uff0c\u5c06\u62c9\u4e01\u8bed\u7cfb\u7f16\u7801\u65b9\u5f0f latin1 \u653e\u5230\u6700\u540e\u9762\n\ntermencoding: vim \u6240\u5de5\u4f5c\u7684\u7ec8\u7aef (\u6216\u8005 windows \u7684 console \u7a97\u53e3) \u7684\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u3002\u8fd9\u4e2a\u9009\u9879\u5728 windows \u4e0b\u5bf9\u6211\u4eec\u5e38\u7528\u7684 gui \u6a21\u5f0f\u7684 gvim \u65e0\u6548\uff0c\u800c\u5bf9 console \u6a21\u5f0f\u7684 vim \u800c\u8a00\u5c31\u662f windows \u63a7\u5236\u53f0\u7684\u4ee3\u7801\u9875\uff0c\u5e76\u4e14\u901a\u5e38\u6211\u4eec\u4e0d\u9700\u8981\u6539\u53d8\u5b83\n\n\u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u6700\u597d\uff0c\u53ef\u4ee5\u514d\u53bb\u4e0b\u9762\u5bf9\u83dc\u5355\u548c\u63d0\u793a\u4fe1\u606f\uff08b\uff0cc\u90e8\u5206\uff09\u7684\u8bbe\u7f6e\n\n\u5982\u679c\u7528\u82f1\u6587\u83dc\u5355\u548c\u63d0\u793a\u5728\u5b89\u88c5gvim\u7684\u65f6\u5019\uff0c\u5c06\u652f\u6301\u672c\u5730\u8bed\u8a00\u7684\u9009\u9879\u53bb\u6389\n\n\u89e3\u51b3vim\u6587\u4ef6\u4e71\u7801\uff0c\u6253\u5f00\u6587\u4ef6\u4e71\u7801\uff0c\u83dc\u5355\uff0c\u63d0\u793a\u4fe1\u606f\u4e71\u7801\uff1a\n\n\u6709\u56db\u4e2a\u8ddf\u5b57\u7b26\u7f16\u7801\u65b9\u5f0f\u6709\u5173\u7684\u9009\u9879\uff0cencoding\u3001fileencoding\u3001fileencodings\u3001termencoding\n\n\u5728linux\u4e2d\u4fee\u6539.vimrc\uff08\u5728win\u4e2d\u662f_vimrc\uff09\n\nwindows\u7cfb\u7edf\u4e5f\u53ef\u4ee5\u5728vim\u83dc\u5355\u9879\u4e2d\uff1a\u7f16\u8f91&gt;\u542f\u52a8\u8bbe\u5b9a\uff0c\u76f4\u63a5\u6253\u5f00_vimrc\u6587\u4ef6\n\n\" \u8bbe\u7f6e\u6587\u4ef6\u7684\u4ee3\u7801\u5f62\u5f0f\n\nset encoding=utf-8\nset termencoding=utf-8\nset fileencoding=utf-8\nset fileencodings=ucs-bom,utf-8,chinese,cp936\n\n\" vim\u7684\u83dc\u5355\u4e71\u7801\u89e3\u51b3\uff1a\n\n\u540c\u6837\u5728 _vimrc\u6587\u4ef6\u91cc\u4ee5\u4e0a\u7684\u4e2d\u6587\u8bbe\u7f6e\u540e\u52a0\u4e0a\u4e0b\u5217\u547d\u4ee4\nsource $vimruntime/delmenu.vim\nsource $vimruntime/menu.vim\n\n\" vim\u63d0\u793a\u4fe1\u606f\u4e71\u7801\u7684\u89e3\u51b3\n\nlanguage messages zh_cn.utf-8\n</code></pre>"},{"location":"coding/Vim/#vim_1","title":"VIM\u4e3b\u5e2e\u52a9\u6587\u6863","text":"VimL<pre><code>\u5de5\u4f5c\u6a21\u5f0f\uff1a\u547d\u4ee4\u6a21\u5f0f\uff08\u9ed8\u8ba4\u754c\u9762\uff09\uff0c\u63d2\u5165\u6a21\u5f0f\uff0c\u53ef\u89c6\u5316\u6a21\u5f0f\n\n\u547d\u4ee4\u6a21\u5f0f\u73af\u5883\u4e2d\u7684\u64cd\u4f5c\uff1a\n\n\u83b7\u5f97\u7279\u5b9a\u5e2e\u52a9\uff1a\n\n| \u7c7b\u522b | \u4f8b\u5b50 |\n| :------: | :------: |\n| \u666e\u901a\u6a21\u5f0f\u547d\u4ee4 | :help x |\n|  |  |\n\" \u5168\u5c40\n:help keyword     \u5173\u952e\u5b57\u5e2e\u52a9\n\n\" \u6253\u5f00/\u4fdd\u5b58/\u9000\u51fa/\u6539\u53d8\u6587\u4ef6(\u7f13\u5b58\u533a)\n:e &lt;path/to/file&gt;   \u6253\u5f00\u6587\u4ef6\n:w                  \u4fdd\u5b58\n:saveas &lt;path/to/file&gt; \u4fdd\u5b58\u5230\n:x,ZZ\u6216:wq          \u4fdd\u5b58\u5e76\u9000\u51fa(:x\u53ea\u4fdd\u5b58\u4e0d\u9000\u51fa)\n:w !sudo tee %      \u4f7f\u7528sudo\u4fdd\u5b58\n:[range]w           \u53ea\u4fdd\u5b58[range]\u5185\u7684\n:q!                 \u4e0d\u4fdd\u5b58\u9000\u51fa(:qa!,\u5373\u4f7f\u6709\u4fee\u6539\u8fc7\u7684\u9690\u85cf\u7f13\u51b2\u533a\u4e5f\u4e0d\u4fdd\u5b58\u9000\u51fa)\n:bn,:bp             \u663e\u793a\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u6587\u4ef6buffer\n\n\" \u57fa\u672c\u79fb\u52a8\u547d\u4ee4\nh\u3001j\u3001k\u3001l  \u2190 \u2193 \u2191 \u2192\nb   \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e\nB   \u5230\u4e0a\u4e2a\u5355\u8bcd\u8bcd\u5c3e(\u5355\u8bcd\u542b\u6807\u70b9)\n0   \u5230\u7b2c\u4e00\u5217\n^   \u5230\u8be5\u884c\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26\n$   \u5230\u884c\u5c3e\ng_  \u5230\u8be5\u884c\u6700\u540e\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26\ngg  \u5230\u7b2c\u4e00\u884c\nG   \u5230\u6700\u540e\u4e00\u884c\nnG  \u5230\u7b2c\u51e0\u884c\n:n  \u5230\u7b2c\u51e0\u884c\nH   \u5230\u5c4f\u5e55\u4e0a\u7aefhigh\nM   \u5230\u5c4f\u5e55\u4e2d\u592emidden\nL   \u5230\u5c4f\u5e55\u4e0b\u7aeflow\nCtrl + e    \u5411\u4e0b\u6eda\u52a8\u4e00\u884c\nCtrl + y    \u5411\u4e0a\u6eda\u52a8\u4e00\u884c\nCtrl + b    \u5411\u540e\u6eda\u52a8\u4e00\u5c4f\nCtrl + f    \u5411\u524d\u6eda\u52a8\u4e00\u5c4f\nCtrl + d    \u5411\u524d\u6eda\u52a8\u534a\u5c4f\nCtrl + u    \u5411\u540e\u6eda\u52a8\u534a\u5c4f  \n\n\" insert\u547d\u4ee4\na \u5149\u6807\u540e\u63d2\u5165\nA \u672c\u884c\u884c\u672b\u63d2\u5165\u6587\u672c\ni \u5149\u6807\u524d\u63d2\u5165\u6587\u672c\nI \u5149\u6807\u672c\u884c\u5f00\u59cb\u63d2\u5165\u6587\u672c\no \u5149\u6807\u4e0b\u63d2\u5165\u65b0\u884c\nO \u5149\u6807\u4e0a\u63d2\u5165\u65b0\u884c\n\n\" \u590d\u5236\u548c\u526a\u5207\u547d\u4ee4\uff1a\nP,p     \u7c98\u8d34\u5728\u5149\u6807\u6240\u5728\u884c\u7684\u540e\u9762\u3001\u524d\u9762\nyy,Y    \u590d\u5236\u5f53\u524d\u884c\nnyy,nY  \u590d\u5236\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c\ndd      \u526a\u5207\u5f53\u524d\u884c\nndd     \u526a\u5207\u5f53\u524d\u884c\u4ee5\u4e0bn\u884c\nu       \u64a4\u9500\n&lt;C-r&gt;   \u6062\u590d\n\n\" \u5176\u4ed6\nr     \u66ff\u6362\u5f53\u524d\u5b57\u7b26\nJ     \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c\ngJ    \u5c06\u4e0b\u4e00\u884c\u5408\u5e76\u5230\u5f53\u524d\u884c(\u53bb\u9664\u7a7a\u683c)\ncc    \u6e05\u7a7a\u5f53\u524d\u884c\u5e76\u8fdb\u5165insert mode\nC     \u66ff\u6362\u5230\u884c\u5c3e\ns     \u5220\u9664\u5f53\u524d\u5b57\u7b26\u5e76\u8fdb\u5165insert mode\nxp    \u5f53\u524d\u5b57\u7b26\u540e\u79fb\n:%s/old/new/g     \u5168\u90e8\u66ff\u6362\n:%s/old/new/gc    \u9010\u4e2a\u66ff\u6362\n`.    \u8f6c\u5230\u4e0a\u6b21\u7f16\u8f91\u7684\u884c\n==    \u4fee\u590d\u884c\u7f29\u8fdb\n\n\" \u53ef\u89c6\u5316\u6a21\u5f0f\u547d\u4ee4\naw    \u9009\u62e9\u5f53\u524d\u5355\u8bcd\nab    \u9009\u62e9\u88ab()\u5305\u88f9\u7684\u533a\u57df(\u542b\u62ec\u53f7)\naB    \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df(\u542b\u62ec\u53f7)\nib    \u9009\u62e9()\u5305\u88f9\u7684\u533a\u57df(\u4e0d\u542b\u62ec\u53f7)\niB    \u9009\u62e9{}\u5305\u88f9\u7684\u533a\u57df(\u4e0d\u542b\u62ec\u53f7)\n&lt;&gt;    \u5411\u5de6 \u5411\u53f3\u7f29\u8fdb\n~     \u5927\u5c0f\u5199\u5207\u6362\n\n\" \u5bc4\u5b58\u5668\n:reg  \u663e\u793a\u5bc4\u5b58\u5668\u5185\u5bb9\n\"xy   \u590d\u5236\u5230\u5bc4\u5b58\u5668x\n\"xp   \u7c98\u8d34\u5bc4\u5b58\u5668x\u4e2d\u5185\u5bb9\n\" \u5bc4\u5b58\u5668\u5b58\u50a8\u5728~/.viminfo\u4e2d,\u4e0b\u6b21\u91cd\u542fvim\u4ecd\u4f1a\u52a0\u8f7d\n\" \u5bc4\u5b58\u56680\u5b58\u50a8\u4e0a\u4e00\u6b21\u590d\u5236\u7684\u503c\n\n\" \u6807\u7b7e\n:tabnew file      \u5728\u65b0\u6807\u7b7e\u6253\u5f00\u6587\u4ef6\ngt    \u5207\u6362\u5230\u4e0b\u4e2a\u6807\u7b7e\ngT    \u5207\u6362\u5230\u4e0a\u4e2a\u6807\u7b7e\nngt   \u5207\u6362\u5230\u7b2cn\u4e2a\u6807\u7b7e\n:tabc \u5173\u95ed\u5f53\u524d\u6807\u7b7e\n:tabo \u5173\u95ed\u5176\u4ed6\u6807\u7b7e\n</code></pre> <p>```vim .   \u91cd\u590d\u4e0a\u4e00\u4e2a\u64cd\u4f5c N  \u91cd\u590dN\u6b21 NG  \u8df3\u8f6c\u5230N\u884c gg  \u8df3\u8f6c\u5230\u6587\u4ef6\u5f00\u59cb G   \u8df3\u8f6c\u5230\u884c\u672b w   \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd W   \u5230\u4e0b\u4e2a\u5355\u8bcd(\u542b\u6807\u70b9) e   \u8df3\u8f6c\u5230\u5f53\u524d\u5355\u8bcd\u8bcd\u5c3e E   \u5230\u4e0b\u4e2a\u5355\u8bcd\u7ed3\u5c3e(\u542b\u6807\u70b9) <p>\" \u7406\u89e3ew\u548cEW\u79fb\u52a8\u533a\u522b</p> <p>\u5149\u6807\u4f4d\u7f6e ew         E W       |   ||         | | x = (name_1,vision_3); # this is a comment</p> <p>%    \u8df3\u8f6c\u5230\u5bf9\u5e94\u7684( { [ \u7b26\u53f7 * #  \u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u3001\u4e0a\u4e00\u4e2a\u5149\u6807\u4e0b\u6240\u5728\u7684\u5355\u8bcd</p> <p>\" \u5927\u591a\u6570\u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u683c\u5f0f\uff1a &lt;\u5f00\u59cb\u4f4d\u7f6e&gt;&lt;\u547d\u4ee4&gt;&lt;\u7ed3\u675f\u4f4d\u7f6e&gt; 0y$ \u590d\u5236\u6574\u884c ye  \u590d\u5236\u5230\u8bcd\u5c3e gU  \u5927\u5199    gu  \u5c0f\u5199...... dt\" \u79fb\u9664\u6240\u6709\u76f4\u5230\"\u7b26\u53f7</p> <p>move</p> <p>\" \u533a\u57df\u9009\u62e9   a"},{"location":"database/MongoDB/","title":"MongoDB-4.0.10","text":""},{"location":"database/MongoDB/#_1","title":"\u6162\u67e5\u8be2\u5206\u6790","text":"JavaScript<pre><code>show profile; # \u663e\u793a\u6700\u540e\u51e0\u6761\u6162\u67e5\u8be2\n\n// sort by natural order (time in)\ndb.system.profile.find({}).sort({$natural:-1})\n\n// sort by slow queries first\ndb.system.profile.find({}).sort({$millis:-1}).limit(10);\n\n// anything &gt; 20ms\ndb.system.profile.find({\"millis\":{$gt:20}})\n\n// single coll order by response time\ndb.system.profile.find({\"ns\":\"test.foo\"}).sort({\"millis\":-1})\n\n// regular expression on namespace\ndb.system.profile.find( { \"ns\": /test.foo/ } ).sort({millis:-1,$ts:-1})\n\n// anything thats moved\ndb.system.profile.find({\"moved\":true})\n\n// large scans\ndb.system.profile.find({\"nscanned\":{$gt:10000}})\n\n// anything doing range or full scans\ndb.system.profile.find({\"nreturned\":{$gt:1}})\n\n\n// using the agg framework\n// response time by operation type\ndb.system.profile.aggregate(\n{ $group : {\n   _id :\"$op\",\n   count:{$sum:1},\n   \"max response time\":{$max:\"$millis\"},\n   \"avg response time\":{$avg:\"$millis\"}\n}});\n\n// slowest by namespace\ndb.system.profile.aggregate(\n{ $group : {\n  _id :\"$ns\",\n  count:{$sum:1},\n  \"max response time\":{$max:\"$millis\"},\n  \"avg response time\":{$avg:\"$millis\"}\n}},\n{$sort: {\n \"max response time\":-1}\n});\n\n\n// slowest by client\ndb.system.profile.aggregate(\n{$group : {\n  _id :\"$client\",\n  count:{$sum:1},\n  \"max response time\":{$max:\"$millis\"},\n  \"avg response time\":{$avg:\"$millis\"}\n}},\n{$sort: {\n  \"max response time\":-1}\n});\n\n// summary moved vs non-moved\ndb.system.profile.aggregate(\n { $group : {\n   _id :\"$moved\",\n   count:{$sum:1},\n   \"max response time\":{$max:\"$millis\"},\n   \"avg response time\":{$avg:\"$millis\"}\n }});\n\ndb.system.profile.aggregate([\n  { $project : {\n      \"op\" : \"$op\",\n      \"millis\" : \"$millis\",\n      \"timeAcquiringMicrosrMS\" : { $divide : [ \"$lockStats.timeAcquiringMicros.r\", 1000 ] },\n      \"timeAcquiringMicroswMS\" : { $divide : [ \"$lockStats.timeAcquiringMicros.w\", 1000 ] },\n      \"timeLockedMicrosrMS\" : { $divide : [ \"$lockStats.timeLockedMicros.r\", 1000 ] },\n      \"timeLockedMicroswMS\" : { $divide : [ \"$lockStats.timeLockedMicros.w\", 1000 ] } }\n  },\n  { $project : {\n      \"op\" : \"$op\",\n      \"millis\" : \"$millis\",\n      \"total_time\" : { $add : [ \"$millis\", \"$timeAcquiringMicrosrMS\", \"$timeAcquiringMicroswMS\" ] },\n      \"timeAcquiringMicrosrMS\" : \"$timeAcquiringMicrosrMS\",\n      \"timeAcquiringMicroswMS\" : \"$timeAcquiringMicroswMS\",\n      \"timeLockedMicrosrMS\" : \"$timeLockedMicrosrMS\",\n      \"timeLockedMicroswMS\" : \"$timeLockedMicroswMS\" }\n  },\n  { $group : {\n      _id : \"$op\",\n      \"average response time\" : { $avg : \"$millis\" },\n      \"average response time + acquire time\": { $avg: \"$total_time\"},\n      \"average acquire time reads\" : { $avg : \"$timeAcquiringMicrosrMS\" },\n      \"average acquire time writes\" : { $avg : \"$timeAcquiringMicroswMS\" },\n      \"average lock time reads\" : { $avg : \"$timeLockedMicrosrMS\" },\n      \"average lock time writes\" : { $avg : \"$timeLockedMicroswMS\" } }\n  }\n]);\n</code></pre>"},{"location":"database/MongoDB/#_2","title":"\u57fa\u7840","text":"<p>views\u662f\u53ea\u8bfb\u7684\u4e14\u65e0\u6cd5\u91cd\u65b0\u547d\u540d\uff0c\u5bf9\u89c6\u56fe\u6267\u884c\u5199\u64cd\u4f5c\u4f1a\u62a5\u9519\uff0c\u89c6\u56fe\u652f\u6301\u7684\u8bfb\u64cd\u4f5c\u6709\uff1a</p> JavaScript<pre><code>db.collection.find();\ndb.collection.findOne();\ndb.collection.aggregate();\ndb.collection.countDocuments();\ndb.collection.estimatedDocumentCount();\ndb.collection.count();\ndb.collection.distinct();\n</code></pre> <p>\u89c6\u56fe\u4f7f\u7528\u57fa\u7840\u96c6\u5408\u7684\u7d22\u5f15\u3002\u7531\u4e8e\u7d22\u5f15\u4f4d\u4e8e\u57fa\u7840\u96c6\u5408\u4e0a\uff0c\u56e0\u6b64\u65e0\u6cd5\u76f4\u63a5\u5728\u89c6\u56fe\u4e0a\u521b\u5efa\uff0c\u5220\u9664\u6216\u91cd\u65b0\u6784\u5efa\u7d22\u5f15\uff0c\u4e5f\u65e0\u6cd5\u5728\u89c6\u56fe\u4e0a\u83b7\u53d6\u7d22\u5f15\u5217\u8868\u3002\u65e0\u6cd5\u5728\u89c6\u56fe\u4f7f\u7528 \\(natural\u6392\u5e8f,\u5982\u679c\u89c6\u56fe\u662f\u57fa\u4e8e\u5206\u7247\u521b\u5efa\uff0c\u5219\u89c6\u56fe\u4e5f\u88ab\u89c6\u4e3a\u5206\u7247\uff0c\u65e0\u6cd5\u4e3afrom\u5b57\u6bb5\\)lookup\u548c$graphlookup\u64cd\u4f5c\u6307\u5b9a\u5206\u7247\u89c6\u56fe</p> <p>\u521b\u5efa\u89c6\u56fe\u662f\u53ef\u4ee5\u6307\u5b9a\u6392\u5e8f\u89c4\u5219\uff0c\u9ed8\u8ba4\u89c4\u5219\u662f\u201c\u7b80\u5355\u201d\u4e8c\u8fdb\u5236\u6bd4\u8f83\u6392\u5e8f\u89c4\u5219\uff0c\u591a\u4e2a\u89c6\u56fe\u505a\u805a\u5408\u64cd\u4f5c\uff0c\u6392\u5e8f\u89c4\u5219\u5fc5\u987b\u76f8\u540c</p> <p>find()\u5bf9\u89c6\u56fe\u7684\u64cd\u4f5c\u4e0d\u652f\u6301\u4ee5\u4e0bProjection\u64cd\u4f5c\u7b26\uff1a</p> <ul> <li>$</li> <li>$elemMatch</li> <li>$slice</li> <li>$meta</li> </ul>"},{"location":"database/MongoDB/#capped-collections","title":"Capped Collections","text":"<p>Capped Collections\u662f\u56fa\u5b9a\u5927\u5c0f\u7684\u96c6\u5408\uff0c\u652f\u6301\u57fa\u4e8e\u63d2\u5165\u987a\u5e8f\u63d2\u5165\u548c\u68c0\u7d22\u6587\u6863\u7684\u9ad8\u541e\u5410\u91cf\u64cd\u4f5c\u3002\u4ee5\u7c7b\u4f3c\u4e8e\u5faa\u73af\u7f13\u51b2\u533a\u7684\u65b9\u5f0f\u5de5\u4f5c\uff1a\u4e00\u65e6\u96c6\u5408\u586b\u5145\u5176\u5206\u914d\u7684\u7a7a\u95f4\uff0c \u5b83\u901a\u8fc7\u81ea\u52a8\u5220\u9664\u96c6\u5408\u4e2d\u6700\u65e7\u7684\u6587\u6863\u4e3a\u65b0\u6587\u6863\u817e\u51fa\u7a7a\u95f4</p> <p>\u65e0\u6cd5\u4ececapped\u96c6\u5408\u5220\u9664\u6587\u6863\uff0c\u8981\u4ece\u96c6\u5408\u5220\u9664\u6587\u6863\u7684\u65b9\u6cd5\uff0c\u4f7f\u7528drop()\u65b9\u6cd5\u5220\u9664\u96c6\u5408\u5e76\u91cd\u65b0\u521b\u5efa\uff0ccapped\u96c6\u5408\u65e0\u6cd5\u5206\u7247\u3002\u521b\u5efacapped\u96c6\u5408\uff0c\u5fc5\u987b\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d \u6307\u5b9a\u96c6\u5408\u7684\u6700\u5927\u5927\u5c0f\u3002\u5982\u679csize\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e4096\uff0c\u5219\u96c6\u5408\u7684\u4e0a\u9650\u4e3a4096\u5b57\u8282\u3002\u5426\u5219\uff0cMongoDB\u5c06\u63d0\u9ad8\u63d0\u4f9b\u7684\u5927\u5c0f\uff0c\u4f7f\u5176\u6210\u4e3a256\u7684\u6574\u6570\u500d\uff1b\u8fd8\u53ef\u4ee5\u4f7f\u7528 \u8be5max\u5b57\u6bb5\u4e3a\u96c6\u5408\u6307\u5b9a\u6700\u5927\u6587\u6863\u6570\u3002\u8be5size\u53c2\u6570\u603b\u662f\u5fc5\u9700\u7684\uff0c\u5373\u4f7f\u4f60\u6307\u5b9amax\u7684\u6587\u4ef6\u6570\u91cf\u3002\u5982\u679c\u96c6\u5408\u5728\u8fbe\u5230\u6700\u5927\u6587\u6863\u8ba1\u6570\u4e4b\u524d\u8fbe\u5230\u6700\u5927\u5927\u5c0f\u9650\u5236\uff0cMongoDB\u5c06 \u5220\u9664\u65e7\u6587\u6863</p> <p>\u5c06\u96c6\u5408\u8f6c\u6362\u4e3acapped\u96c6\u5408:db.runCommand({\"convertToCapped\": \"collectionName\", size: 10000});\u5728\u64cd\u4f5c\u671f\u95f4\u4fdd\u5b58\u6570\u636e\u5e93\u72ec\u5360\u9501\u3002\u9501\u5b9a\u540c\u4e00 \u6570\u636e\u5e93\u7684\u5176\u4ed6\u64cd\u4f5c\u5c06\u88ab\u963b\u6b62\uff0c\u76f4\u5230\u64cd\u4f5c\u5b8c\u6210</p> <p>capped\u66ff\u4ee3\u65b9\u6848\uff1a\u4f7f\u7528TTL(\u751f\u5b58\u65f6\u95f4)\u7d22\u5f15\u4ece\u96c6\u5408\u5220\u9664\u8fc7\u671f\u6570\u636e\uff1b\u8fd9\u4e9b\u7d22\u5f15\u5141\u8bb8\u60a8\u6839\u636e\u65e5\u671f\u7c7b\u578b\u5b57\u6bb5\u7684\u503c\u548c\u7d22\u5f15\u7684TTL\u503c\u4f7f\u6b63\u5e38\u96c6\u5408\u4e2d\u7684\u6570\u636e\u5230\u671f\u548c\u5220\u9664\u3002 TTL\u7d22\u5f15\u4e0ecapped\u96c6\u5408\u4e0d\u517c\u5bb9</p> <p>\u6bcf\u79cdBSON\u7c7b\u578b\u90fd\u6709\u6574\u6570\u548c\u5b57\u7b26\u4e32\u6807\u8bc6\u7b26\uff0c\u5982\u4e0b\u8868\u6240\u793a | Type | Number | Alias | Notes | | :------: | :------: | :------: | :------: | | Double | 1 | \u201cdouble\u201d | | String | 2 | \u201cstring\u201d | | Object | 3 | \u201cobject\u201d | | Array | 4 | \u201carray\u201d | | Binary data | 5 | \u201cbinData\u201d | | Undefined | 6 | \u201cundefined\u201d | \u5df2\u5e9f\u5f03 | | ObjectId | 7 | \u201cobjectId\u201d | | Boolean | 8 | \u201cbool\u201d | | Date | 9 | \u201cdate\u201d | | Null | 10 | \u201cnull\u201d | | Regular Expression | 11 | \u201cregex\u201d | | DBPointer | 12 | \u201cdbPointer\u201d | \u5df2\u5e9f\u5f03 | | JavaScript | 13 | \u201cjavascript\u201d | | Symbol | 14 | \u201csymbol\u201d | \u5df2\u5e9f\u5f03 | | JavaScript (with scope) | 15 | \u201cjavascriptWithScope\u201d | | 32-bit integer | 16 | \u201cint\u201d | | Timestamp | 17 | \u201ctimestamp\u201d | | 64-bit integer | 18 | \u201clong\u201d | | Decimal128 | 19 | \u201cdecimal\u201d | New in version 3.4. | | Min key | -1 | \u201cminKey\u201d | | Max key | 127 | \u201cmaxKey\u201d |</p> <p>ObjectId\u503c\u753112\u4e2a\u5b57\u8282\u7ec4\u6210\uff1a</p> <ul> <li>\u4e00\u4e2a4\u5b57\u8282\u7684\u503c\uff0c\u8868\u793aUnix\u7eaa\u5143\u4ee5\u6765\u7684\u79d2\u6570</li> <li>\u4e00\u4e2a5\u5b57\u8282\u7684\u968f\u673a\u503c</li> <li>\u4e00\u4e2a3\u5b57\u8282\u7684\u8ba1\u6570\u5668\uff0c\u4ee5\u968f\u673a\u503c\u5f00\u59cb</li> </ul> <p>\u6bd4\u8f83\u4f1a\u5c06\u4e0d\u5b58\u5728\u7684\u5b57\u6bb5\u89c6\u4e3a\u7a7a\u7684BSON\u5bf9\u8c61\uff0c\u6bd4\u8f83\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u65f6\uff0cMongoDB\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1b\u7531\u4f4e\u5230\u9ad8\uff1a</p> <ol> <li>MinKey (internal type)</li> <li>Null</li> <li>Numbers (ints, longs, doubles, decimals)</li> <li>Symbol, String</li> <li>Object</li> <li>Array</li> <li>BinData</li> <li>ObjectId</li> <li>Boolean</li> <li>Date</li> <li>Timestamp</li> <li>Regular Expression</li> <li>MaxKey (internal type)</li> </ol> <p>Object\u6bd4\u8f83\u4f7f\u7528\u4ee5\u4e0b\u987a\u5e8f\uff1a</p> <ol> <li>\u6309\u7167\u5b83\u4eec\u5728BSON\u5bf9\u8c61\u4e2d\u51fa\u73b0\u7684\u987a\u5e8f\u9012\u5f52\u5730\u6bd4\u8f83\u952e\u503c\u5bf9</li> <li>\u6bd4\u8f83\u5173\u952e\u5b57\u6bb5\u540d\u79f0</li> <li>\u5982\u679c\u952e\u5b57\u6bb5\u540d\u79f0\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u5b57\u6bb5\u503c</li> <li>\u5982\u679c\u5b57\u6bb5\u503c\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u4e0b\u4e00\u4e2a\u952e/\u503c\u5bf9\uff08\u8fd4\u56de\u6b65\u9aa41\uff09\u3002\u6ca1\u6709\u8fdb\u4e00\u6b65\u5bf9\u7684\u5bf9\u8c61\u5c0f\u4e8e\u5177\u6709\u66f4\u591a\u5bf9\u7684\u5bf9\u8c61</li> </ol> <p>BinData\u6392\u5e8f\u987a\u5e8f\u4e3a\uff1a</p> <ol> <li>\u9996\u5148\uff0c\u6570\u636e\u7684\u957f\u5ea6\u6216\u5927\u5c0f</li> <li>\u7136\u540e\uff0c\u901a\u8fc7BSON\u4e00\u5b57\u8282\u5b50\u7c7b\u578b</li> <li>\u6700\u540e\uff0c\u901a\u8fc7\u6570\u636e\uff0c\u6267\u884c\u9010\u5b57\u8282\u6bd4\u8f83</li> </ol>"},{"location":"database/MongoDB/#_3","title":"\u914d\u7f6e\u6587\u4ef6\u53c2\u8003","text":"Text Only<pre><code>  # \u914d\u7f6e\u65e5\u5fd7\n    systemLog:\n      verbosity: 5  #\u65e5\u5fd7\u7ea7\u522b:\u8303\u56f4\u662f0-5,0\u662fMongoDB\u7684\u9ed8\u8ba4\u65e5\u5fd7\u7ea7\u522b\uff0c5\u5305\u542b\u4e86debug\u4fe1\u606f\n      quiet: false  #\u5b89\u9759\u6a21\u5f0f\uff0c\u662f\u5426\u8f93\u51fa\u65e5\u5fd7\n      traceAllExceptions: true  #\u662f\u5426\u6253\u5370\u8be6\u7ec6\u7684\u65e5\u5fd7\u4fe1\u606f\uff0c\u5f00\u542f\n    #  syslogFacility: &lt;string&gt; #\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7\u4e2d\uff0c\u5982\u679c\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u5219systemLog.destination=syslog.\n    #   path: &lt;string&gt;\n    #   logAppend: &lt;boolean&gt;\n    #   logRotate: &lt;string&gt;\n    #   destination: &lt;string&gt;\n    #   timeStampFormat: &lt;string&gt;\n    #   component:\n    #      accessControl:\n    #         verbosity: &lt;int&gt;\n    #      command:\n    #         verbosity: &lt;int&gt;\n      destination: file #mogodb\u65e5\u5fd7\u7684\u4ea7\u751f\u65b9\u5f0f:file=\u6307\u5b9a\u7684\u6587\u4ef6,syslog\u7cfb\u7edf\u65e5\u5fd7\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u6307\u5411\u6807\u51c6\u8f93\u51fa\u6d41\n      logAppend: true   #\u5728mongodb\u91cd\u542f\u65f6,\u7ee7\u7eed\u5f80\u5df2\u6709\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\u8ffd\u52a0\u5185\u5bb9\uff0c\u800c\u4e0d\u662f\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6.\n      path: /data/mongodb/mongod.log    #\u65e5\u5fd7\u6587\u4ef6\u7684\u8f93\u51fa\u8def\u5f84\uff0cmongo\u5c06\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e\u521b\u5efa\u65e5\u5fd7\u6587\u4ef6.\n      logRotate: reopen   #3.0.0,\u4e24\u4e2a\u503c:rename=\u91cd\u547d\u540d\u65e5\u5fd7\u6587\u4ef6\uff0creopen=\u5173\u95ed\u5e76\u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6.\n                          #\u5982\u679c\u4f7f\u7528reopen\u5219\u8981\u4f7fsystemLog.logAppend=true\n      timeStampFormat: iso8601-utc #\u65e5\u5fd7\u4e2d\u65f6\u95f4\u6233\u7684\u683c\u5f0f:ctime=Wed Dec 31 18:17:54.811,iso8601-utc=1970-01-01T00:00:00.000Z,\n                                   #iso8601-local=\u672c\u5730\u65f6\u95f4\u683c\u5f0f\n    #\u65e5\u5fd7\u7ec4\u4ef6\u7684\u5177\u4f53\u9009\u9879\n      component:\n       #\u7d22\u5f15\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        index:\n          verbosity: 5\n        #\u67e5\u8be2\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        query:\n          verbosity: 5\n        #\u590d\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        replication:\n          verbosity: 5\n          #\u5fc3\u8df3\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6\n          #heartbeats:\n            #verbosity: 5\n          #\u56de\u6eda\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.6\n          #heartbeats:\n            #verbosity: 5\n         #\u5199\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        write:\n          verbosity: 5\n        #\u8bbf\u95ee\u63a7\u5236\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        accessControl:\n          verbosity: 5\n        #\u547d\u4ee4\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        command:\n          verbosity: 5\n        #\u63a7\u5236\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        control:\n          verbosity: 5\n        #\u8bca\u65ad\u6d88\u606f\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.2\n        ftdc:\n          verbosity: 5\n        #\u5730\u7406\u7a7a\u95f4\u89e3\u6790\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        geo:\n          verbosity: 5\n        #\u7f51\u7edc\u64cd\u4f5c\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        network:\n          verbosity: 5\n        #\u5206\u7247\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        sharding:\n          verbosity: 5\n        #\u5b58\u50a8\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n        storage:\n          verbosity: 5\n          #\u65e5\u5fd7\u7ec4\u4ef6\u76f8\u5173\u7684\u65e5\u5fd7\u6d88\u606f\u7ea7\u522b\uff0c\u5206\u4e3a0-5\uff0c0\u8868\u793ainfo\u7ea7\u522b\u7684\u65e5\u5fd7\uff0c\u4f9d\u6b21\u589e\u52a0\uff0c5\u8868\u793a\u5305\u542bdebug\u4fe1\u606f.version:3.0\n          journal:\n            verbosity: 5\n\n    # \u8fdb\u7a0b\u7ba1\u7406\u914d\u7f6e\n    processManagement:\n      fork: true  # \u4ee5\u5b88\u62a4\u7ebf\u7a0b\u6a21\u5f0f\u5728\u540e\u53f0\u8fd0\u884c\n      pidFilePath: /data/mongodb/mongod.pid  # \u6307\u5b9a\u4fdd\u5b58PID\u7684\u6587\u4ef6\n      #\u65f6\u533a\u6587\u4ef6:https://downloads.mongodb.org/olson_tz_db/timezonedb-latest.zip\n      #timeZoneInfo:    #\u52a0\u8f7d\u6570\u636e\u5e93\u65f6\u533a\u7684\u5b8c\u6574\u8def\u5f84\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u91c7\u7528\u9ed8\u8ba4\u65f6\u533a\n\n    # \u7f51\u7edc\u914d\u7f6e\n    net:\n       port: 27017   #mongodb\u76d1\u542c\u7684TCP\u7aef\u53e3\n       bindIp: 0.0.0.0  #\u5141\u8bb8\u8bbf\u95ee\u7684IP\u5730\u5740\u96c6\u5408\uff0c\u4e0d\u8bbe\u7f6e\u9ed8\u8ba4\u662f127.0.0.1\uff0c\u5982\u679c\u9700\u8981\u8bbe\u7f6e\u591a\u4e2a\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7[,]\u5206\u5272\uff0c\u4f8b\u5982:A,B,C\n       #bindIpAll: true  #\u662f\u5426\u7ed1\u5b9a\u6240\u6709\u7684IP\uff0c\u5141\u8bb8\u8bbf\u95ee. version:3.6\n       maxIncomingConnections: 65536 #\u6700\u5927\u8fde\u63a5\u6570\uff0c\u9ed8\u8ba465536\n       wireObjectCheck: true    #\u9a8c\u8bc1\u5ba2\u6237\u7aef\u7684\u6240\u6709\u8bf7\u6c42\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u63d2\u5165\u6076\u610f\u6216\u8005\u65e0\u6548\u7684BSON\u6570\u636e\uff0c\u5bf9\u4e8e\u9ad8\u5ea6\u5d4c\u5957\u7684\u81ea\u95ee\u5f53\u5bf9\u8c61\uff0c\u6027\u80fd\u5f71\u54cd\u5f88\u5c0f.\n       ipv6: false   #\u542f\u7528\u6216\u7981\u7528ipv6\u652f\u6301.\n       #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c.\n       #unixDomainSocket:\n          #enabled: true #\u542f\u7528\u6216\u8005\u7981\u7528\u5728*UNIX\u5957\u63a5\u5b57\u8fdb\u884c\u4fa6\u542c.\n          #pathPrefix: &lt;string&gt;  #\u5957\u63a5\u5b57\u7684\u8def\u5f84\n          #filePermissions: &lt;int&gt;   #\u5957\u63a5\u5b57\u6587\u4ef6\u6743\u9650\n        #3.6\u7248\u672c\u5220\u9664http\u9009\u9879\uff0c\u6539\u4e3a\u4e86ssl.\n    #   ssl:\n          #sslOnNormalPorts: &lt;boolean&gt;  # \u88ab2.6\u7248\u672c\u542f\u7528\uff0c\u6539\u7528mode: requireSSL.\n          #\u542f\u7528TSL/SSL:\n          #     disabled=\u4e0d\u542f\u7528TLS/SSL,\n          #     allowSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl.\n          #     preferSSL=\u670d\u52a1\u5668\u4e4b\u95f4\u4e0d\u4f7f\u7528TLS/SSL,\u4f20\u5165\u94fe\u63a5\u53ef\u4ee5\u662fTLS/SSL\u6216\u8005\u975eTLS/SSl.\n          #     requireSSL=\u670d\u52a1\u5668\u4ec5\u4f7f\u7528\u5e76\u63a5\u53d7TLS/SSL\u52a0\u5bc6\u94fe\u63a5.\n          #mode: disabled\n          #PEMKeyFile: &lt;string&gt; #.pem\u8bc1\u4e66\u5b58\u653e\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84.\n          #PEMKeyPassword: &lt;string&gt; #\u7528\u4e8e\u89e3\u5bc6PEM\u7684\u5bc6\u94a5\u6587\u4ef6.\n          #clusterFile: &lt;string&gt;    #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u5185\u90e8\u8eab\u4efd\u9a8c\u8bc1\u7684PEM\u6587\u4ef6.\n          #clusterPassword: &lt;string&gt; #\u96c6\u7fa4\u6216\u526f\u672c\u96c6\u7528\u4e8e\u89e3\u5bc6\u5185\u90e8\u9a8c\u8bc1PEM\u6587\u4ef6\u7684\u5bc6\u94a5.\n          #CAFile: &lt;string&gt; #.pem\u5305\u542b\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u8ddf\u8bc1\u4e66\u94fe\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84.\n          #CRLFile: &lt;string&gt;    #.pem\u5305\u542b\u8bc1\u4e66\u540a\u9500\u5217\u8868\u7684\u6587\u4ef6\u7684\u76f8\u5bf9\u6216\u7edd\u5bf9\u8def\u5f84.\n          #allowConnectionsWithoutCertificates: false   #\u5f31\u8bc1\u4e66\u9a8c\u8bc1\n          #allowInvalidCertificates: &lt;boolean&gt;  #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u8bc1\u4e66\uff0c\u5173\u95ed\u8bc1\u4e66\u68c0\u67e5\n          #allowInvalidHostnames: &lt;boolean&gt; #\u5141\u8bb8\u4f7f\u7528\u65e0\u6548\u7684\u4e3b\u673a\u540d\uff0c\u7981\u7528\u4e3b\u673a\u540d\u6821\u9a8c\n          #disabledProtocols: &lt;string&gt;  #\u7981\u7528\u6307\u5b9a\u534f\u8bae\n          #FIPSMode: &lt;boolean&gt;  #\u542f\u7528\u6216\u7981\u7528\u4f7f\u7528\u5b89\u88c5OpenSSL\u5e93\u7684\u7684FIPS\u6a21\u5f0f\n       #zlib\u538b\u7f29\u5668\u7684\u652f\u6301\uff0cadd to Version:3.4,version:3.6,\u9ed8\u8ba4\u4f7f\u7528snappy.\n       #\u5982\u679c\u5404\u65b9\u4e0d\u5171\u7528\u81f3\u5c11\u4e00\u4e2a\u901a\u7528\u538b\u7f29\u5668\uff0c\u5219\u53cc\u65b9\u4e4b\u95f4\u7684\u6d88\u606f\u662f\u672a\u538b\u7f29\u7684.\n       #compression:\n          #compressors: snappy\n       #\u6307\u5b9a\u4f20\u8f93\u5c42\u901a\u77e5\u65b9\u5f0f,\u9ed8\u8ba4asio\uff0cversion:3.6\n       #transportLayer: asio\n       #\u6307\u5b9a\u7ebf\u7a0b\u5bf9\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6267\u884c\u6a21\u578b\uff1asynchronous=\u4f7f\u7528\u540c\u6b65\u7f51\u7edc\u5e76\u5728\u6bcf\u4e2a\u94fe\u63a5\u7684\u57fa\u7840\u4e0a\u7ba1\u7406\u5176\u7f51\u7edc\u7ebf\u7a0b\u6c60.\n       #adaptive:\u4f7f\u7528\u65b0\u7684\u5b9e\u9a8c\u6027\u7684\u5f02\u6b65\u7f51\u7edc\u6a21\u5f0f.\n       #\u5176\u4e2d\u5f53\u503c\u4e3aadaptive\uff0c\u8981\u6c42#transportLayer\u7684\u503c\u4e3aasio.\n       #serviceExecutor: &lt;string&gt;\n    #\u5b89\u5168\u7ba1\u7406\n    #security:\n       #keyFile: &lt;string&gt;   #\u5b58\u50a8\u5171\u4eab\u5bc6\u94a5\u7684\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84\n       #\u7528\u4e8e\u96c6\u7fa4\u8eab\u4efd\u9a8c\u8bc1\u7684\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5f0f\n       #  -  keyFile:\u4f7f\u7528\u5bc6\u94a5\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1.\n       #  - sendKeyFile: \u53d1\u9001\u5bc6\u94a5\u6587\u4ef6\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66.\n       #  - sendX509:\u53d1\u9001x.509\u6587\u4ef6\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u63a5\u53d7\u5bc6\u94a5\u6587\u4ef6\u548cx.509\u8bc1\u4e66.\n       #  - x509:\u63a8\u8350\u4f7f\u7528\uff0c\u53d1\u9001x.509\u8bc1\u4e66\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4e14\u53ea\u63a5\u53d7x.509\u8bc1\u4e66.\n       #clusterAuthMode: &lt;string&gt;\n       #\u542f\u7528\u6216\u7981\u7528\u57fa\u4e8e\u89d2\u8272\u7684\u63a7\u5236\u8bbf\u95ee(RBAC)\u6765\u63a7\u5236\u6bcf\u4e2a\u7528\u6237\u5bf9\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c\u7684\u8bbf\u95ee\n       #  -  enabled:\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u88ab\u6388\u6743\u7684\u6570\u636e\u5e93\u8d44\u6e90\u548c\u64cd\u4f5c.\n       #  -  disabled:\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u4efb\u4f55\u8d44\u6e90\u548c\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c.\n       #authorization: &lt;string&gt;\n       #transitionToAuth: &lt;boolean&gt; #\u7528\u6237\u53ef\u4ee5\u5728\u6ca1\u6709\u4efb\u4f55\u8bbf\u95ee\u63a7\u5236\u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u8bbf\u95ee\u673a\u5668\uff0c\u5e76\u8fdb\u884c\u8bfb\u5199\u548c\u7ba1\u7406\u64cd\u4f5c. version:3.4\n       #javascriptEnabled:  &lt;boolean&gt;    #\u542f\u7528\u6216\u7981\u7528\u670d\u52a1\u5668\u7aefjavascript\u7684\u6267\u884c.\n       #redactClientLogData: &lt;boolean&gt;   #\u8bb0\u5f55\u65e5\u5fd7\u7684\u65f6\u5019\uff0c\u5c06\u6570\u636e\u4e5f\u8bb0\u5f55\u4e0b\u6765. version:3.4 AND ONLY MongoDB Enterprise\n       #\u914d\u7f6eSASL\n       #sasl:\n          #hostName: &lt;string&gt;   #\u7528\u4e8e\u914d\u7f6eSASL\u548cKerberos\u8eab\u4efd\u9a8c\u8bc1\u7684\u5b8c\u5168\u9650\u5b9a\u670d\u52a1\u5668\u57df\u540d.\n          #serviceName: &lt;string&gt;    #\u4f7f\u7528SASL\u7684\u670d\u52a1\u7684\u6ce8\u518c\u540d\u79f0.\n          #saslauthdSocketPath: &lt;string&gt;    #UNIX\u57df\u5957\u63a5\u5b57\u6587\u4ef6\u7684\u8def\u5f84.\n       #enableEncryption: &lt;boolean&gt; #\u4e3aWiredTiger\u5b58\u50a8\u5f15\u64ce\u542f\u7528\u673a\u5bc6.\n       #encryptionCipherMode: &lt;string&gt;  #\u9759\u6001\u52a0\u5bc6\u7684\u5bc6\u7801\u6a21\u5f0f:AES256-CBC=\u5bc6\u7801\u5757\u94fe\u63a5\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6,\n       #AES256-GCM=Galois / Counter\u6a21\u5f0f\u4e0b\u7684256\u4f4d\u9ad8\u7ea7\u52a0\u5bc6\u6807\u51c6\n       #encryptionKeyFile: &lt;string&gt; #\u901a\u8fc7KMIP \u4ee5\u5916\u7684\u8fdb\u7a0b\u7ba1\u7406\u5bc6\u94a5\u65f6\uff0c\u672c\u5730\u5bc6\u94a5\u6587\u4ef6\u7684\u8def\u5f84[MongoDB Enterprise]\n       #\n       #\u6ce8\u610f:security.kmip\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.2.\n       #\n       #kmip:\n          #keyIdentifier: &lt;string&gt;   #KMIP\u670d\u52a1\u5668\u4e2d\u73b0\u6709\u79d8\u94a5\u7684\u552f\u4e00KNIP\u6807\u8bc6\u7b26.version:3.2\n          #rotateMasterKey: &lt;boolean&gt;   #\u65cb\u8f6c\u4e3b\u79d8\u94a5\u5e76\u91cd\u65b0\u52a0\u5bc6\u5185\u90e8\u79d8\u94a5\u5e93.version:3.2[MongoDB Enterprise]\n          #serverName: &lt;string&gt; #\u8fd0\u884cKMIP\u670d\u52a1\u5668\u7684\u5bc6\u94a5\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\u7684\u4e3b\u673a\u540d\u6216IP\u5730\u5740.[MongoDB Enterprise]\n          #port: &lt;string&gt; #KMIP\u670d\u52a1\u5668\u6b63\u5728\u76d1\u542c\u7684\u7aef\u53e3\u53f7\n          #clientCertificateFile: &lt;string&gt;  #\u5305\u542b\u7528\u4e8e\u5411KMIP\u670d\u52a1\u5668\u9a8c\u8bc1MongoDB\u7684\u5ba2\u6237\u7aef\u8bc1\u4e66\u8def\u5f84\u7684\u5b57\u7b26\u4e32\n          #clientCertificatePassword: &lt;string&gt;  #\u7528\u4e8e\u89e3\u5bc6\u5ba2\u6237\u7aef\u8bc1\u4e66\uff08\u5373security.kmip.clientCertificateFile\uff09\u7684\u5bc6\u7801\n          #serverCAFile: &lt;string&gt; #CA\u6587\u4ef6\u7684\u8def\u5f84\u3002\u7528\u4e8e\u9a8c\u8bc1\u4e0eKMIP\u670d\u52a1\u5668\u7684\u5b89\u5168\u5ba2\u6237\u7aef\u8fde\u63a5\n          #\n          #\u6ce8\u610f:security.ldap\u53ea\u80fd\u7528\u4e8emongodb\u7684\u4f01\u4e1a\u7248\u672c,\u4e14\u7248\u672c\u9700\u8981\u9ad8\u4e8e3.4.\n          #\n    #   ldap:\n    #      servers: &lt;string&gt;  #\u901a\u8fc7LDAP\u786e\u5b9a\u6267\u884c\u64cd\u4f5c\u7684\u7528\u6237\u662f\u5426\u88ab\u6388\u6743\uff0c\u591a\u4e2a\u670d\u52a1\u5668\u4e4b\u95f4\u53ef\u4ee5\u901a\u8fc7[,]\u5206\u5272.\n    #      bind:\n    #         method: &lt;string&gt;  #\u8be5\u65b9\u6cd5mongod\u6216mongos\u7528\u4e8e\u5411LDAP\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\n    #                                - simple- mongod\u6216mongos\u4f7f\u7528\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\n    #                                - sasl- mongod\u6216mongos\u4f7f\u7528SASL\u534f\u8bae\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\n    #         saslMechanisms: &lt;string&gt;  #\u4ee5\u9017\u53f7\u5206\u9694\u7684SASL\u673a\u5236\u5217\u8868.\n    #         queryUser: &lt;string&gt; #\u7ed1\u5b9aLADP\u67e5\u8be2\u7528\u6237.\n    #         queryPassword: &lt;string&gt; #\u7ed1\u5b9aLADP\u670d\u52a1\u5668\u7684\u5bc6\u7801.\n    #         useOSDefaults: &lt;boolean&gt;  #\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668\u65f6\uff0c\u5141\u8bb8mongod\u6216mongos\u4f7f\u7528Windows\u767b\u5f55\u51ed\u636e\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u7ed1\u5b9a\n    #      transportSecurity: &lt;string&gt;  #\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cmongod\u6216mongos\u521b\u5efa\u4e00\u4e2a\u5230LDAP\u670d\u52a1\u5668\u7684TLS / SSL\u5b89\u5168\u8fde\u63a5.\n    #      timeoutMS: &lt;int&gt; #\u7b49\u5f85LDAP\u670d\u52a1\u5668\u54cd\u5e94\u8bf7\u6c42\u65f6\u95f4(\u6beb\u79d2).\n    #      userToDNMapping: &lt;string&gt;  #\u7528\u4e8e\u9a8c\u8bc1\u7684\u7528\u6237\u540d\u6620\u5c04\u5230LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\n    #                                  -  match=ECMAScript\u683c\u5f0f\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u6b63\u5219\u8868\u8fbe\u5f0f\uff09\u4e0e\u63d0\u4f9b\u7684\u7528\u6237\u540d\u5339\u914d\n    #                                          \u6bcf\u4e2a\u62ec\u53f7\u5305\u56f4\u7684\u90e8\u5206\u8868\u793a\u7531substitutionor \u4f7f\u7528\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u6355\u83b7\u7ec4ldapQuery\n    #                                  - substitution=LDAP\u4e13\u6709\u540d\u79f0\uff08DN\uff09\u683c\u5f0f\u5316\u6a21\u677f\n    #                                  - ldapQuery=LDAP\u67e5\u8be2\u683c\u5f0f\u5316\u6a21\u677f.\n    #      authz:\n    #         queryTemplate: &lt;string&gt;   #\u4e00\u4e2a\u76f8\u5bf9\u7684LDAP\u67e5\u8be2URL.\n    #\n    # \u5c5e\u6027\u8bbe\u7f6e\u9009\u9879\n    #\n    #setParameter:\n    #     ldapUserCacheInvalidationInterval: &lt;int&gt; #\u7528\u4e8e\u4f7f\u7528LDAP\u6388\u6743mongod\u6216mongos\u4f7f\u7528LDAP\u6388\u6743\u7684\u670d\u52a1\u5668(\u79d2)\n    #   &lt;parameter1&gt;: &lt;value1&gt;\n    #   &lt;parameter2&gt;: &lt;value2&gt;\n\n    # \u5b58\u50a8\u8bbe\u7f6e\n    storage:\n       dbPath:  /data/mongodb #mongod\u5b9e\u4f8b\u5b58\u50a8\u6570\u636e\u7684\u76ee\u5f55,\u9ed8\u8ba4\u503c\uff1a/data/db.\n       indexBuildRetry: true #\u6307\u5b9amongodb\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u662f\u5426\u91cd\u5efa\u4e0d\u5b8c\u6574\u7684\u7d22\u5f15,\u9ed8\u8ba4:true.\n    #   repairPath: &lt;string&gt;\n    #          MongoDB\u5728--repair\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u5c06\u4f7f\u7528\u7684\u5de5\u4f5c\u76ee\u5f55\n    #          \u5f53--repair\u5b8c\u6210\u540e,storage.repairPath\u76ee\u5f55\u662f\u7a7a\u7684,\u5e76\u4e14 dbPath\u5305\u542b\u4e86\u4fee\u590d\u7684\u6587\u4ef6\n    #          \u8be5storage.repairPath\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\n    #          \u4ec5\u9002\u7528\u4e8emongod\u4f7f\u7528MMAPv1\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b\n       journal:\n          enabled: true #\u542f\u7528\u6216\u7981\u7528\u8010\u4e45\u6027\u65e5\u5fd7\u4ee5\u786e\u4fdd\u6570\u636e\u6587\u4ef6\u4fdd\u6301\u6709\u6548\u5e76\u53ef\u6062\u590d\u300264bit\u9ed8\u8ba4\u5f00\u542f,32bit\u9ed8\u8ba4\u5173\u95ed.\n    #                     \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b\n          commitIntervalMs: 100 #mongod\u65e5\u5fd7\u64cd\u4f5c\u4e4b\u95f4\u8fdb\u7a0b\u5141\u8bb8\u7684\u6700\u5927\u65f6\u95f4\u91cf(\u6beb\u79d2),\u8303\u56f4\u662f1-500,\u9ed8\u8ba4\u503c\u662f100\n    #                                  \u8be5\u503c\u592a\u4f4e\u4f1a\u589e\u52a0\u65e5\u5fd7\u7684\u6301\u4e45\u6027\uff0c\u4f46\u662f\u4f1a\u727a\u7272\u78c1\u76d8\u6027\u80fd.\n    #                                  \u8be5storage.journal.commitIntervalMs\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\n    #                                  \u4e0d\u9002\u7528\u4e8emongod\u4f7f\u7528\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u7684\u5b9e\u4f8b\n    #   directoryPerDB: &lt;boolean&gt;    #MongoDB\u4f7f\u7528\u5355\u72ec\u7684\u76ee\u5f55\u6765\u5b58\u50a8\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\n    #                                  \u76ee\u5f55\u4f4d\u4e8estorage.dbPath\u76ee\u5f55\u4e0b\uff0c\u5e76\u4e14\u6bcf\u4e2a\u5b50\u76ee\u5f55\u540d\u79f0\u90fd\u4e0e\u6570\u636e\u5e93\u540d\u79f0\u76f8\u5bf9\u5e94\n    #                                  3.0\u7248\u672c\u6709\u53d8\u66f4.\n    #   syncPeriodSecs: &lt;int&gt;  #\u5728MongoDB\u5c06\u6570\u636e\u901a\u8fc7sync\u64cd\u4f5c\u5237\u65b0\u5230\u6570\u636e\u6587\u4ef6\u4e4b\u524d\u53ef\u4ee5\u4f20\u9012\u7684\u65f6\u95f4\u91cf,\u9ed8\u8ba460s.\n    #                              \u4e0d\u8981\u5728\u751f\u4ea7\u7cfb\u7edf\u4e0a\u8bbe\u7f6e\u6b64\u503c\u3002\u5728\u51e0\u4e4e\u6240\u6709\u60c5\u51b5\u4e0b\uff0c\u60a8\u90fd\u5e94\u8be5\u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\n    #   engine: &lt;string&gt;  #mongod\u6570\u636e\u5e93\u7684\u5b58\u50a8\u5f15\u64ce\n    #                         \u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\uff0c3.0\u7248\u672c\u4e2d\u7684\u65b0\u529f\u80fd,\u4eceMongoDB 3.2\u5f00\u59cb\uff0cwiredTiger\u662f\u9ed8\u8ba4\u503c\n    #                         mmapv1=\u6307\u5b9aMMAPv1\u5b58\u50a8\u5f15\u64ce\n    #                         wiredTiger=\u6307\u5b9aWiredTiger\u5b58\u50a8\u5f15\u64ce\n    #                         inMemory=\u6307\u5b9a\u5185\u5b58\u4e2d\u5b58\u50a8\u5f15\u64ce\n       mmapv1:\n          preallocDataFiles: true  #\u542f\u7528\u6216\u7981\u7528\u6570\u636e\u6587\u4ef6\u7684\u9884\u5206\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cMongoDB\u4e0d\u9884\u5148\u5206\u914d\u6570\u636e\u6587\u4ef6\n          nsSize: 16 #\u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u9ed8\u8ba4\u5927\u5c0f\uff0c\u5b83\u662f\u4ee5\u6587\u4ef6\u7ed3\u5c3e\u7684\u6587\u4ef6.ns\u3002\u6bcf\u4e2a\u96c6\u5408\u548c\u7d22\u5f15\u90fd\u88ab\u89c6\u4e3a\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\n    #                        \u4f7f\u7528\u6b64\u8bbe\u7f6e\u63a7\u5236\u65b0\u521b\u5efa\u7684\u540d\u79f0\u7a7a\u95f4\u6587\u4ef6\u7684\u5927\u5c0f\u3002\u8be5\u9009\u9879\u5bf9\u73b0\u6709\u6587\u4ef6\u6ca1\u6709\u5f71\u54cd\n    #                        \u547d\u540d\u7a7a\u95f4\u6587\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u662f2047\u5146\u5b57\u8282\u3002\u9ed8\u8ba4\u503c16\u5146\u5b57\u8282\u63d0\u4f9b\u4e86\u5927\u7ea624,000\u4e2a\u540d\u79f0\u7a7a\u95f4\n          quota:\n             enforced: false  #\u542f\u7528\u6216\u7981\u7528\u5f3a\u5236\u6bcf\u4e2a\u6570\u636e\u5e93\u53ef\u80fd\u5177\u6709\u7684\u6570\u5b57\u6570\u636e\u6587\u4ef6\u7684\u6700\u5927\u9650\u5236\n    #                                 \u4f7f\u7528\u8be5storage.mmapv1.quota.enforced\u9009\u9879\u8fd0\u884c\u65f6\uff0cMongoDB\u6bcf\u4e2a\u6570\u636e\u5e93\u6700\u591a\u67098\u4e2a\u6570\u636e\u6587\u4ef6\n    #                                 \u901a\u8fc7\u8c03\u6574storage.quota.maxFilesPerDB\u6765\u8c03\u6574\u8fd9\u4e2a\u9650\u5236\n             maxFilesPerDB: 8 #\u6bcf\u4e2a\u6570\u636e\u5e93\u7684\u6570\u636e\u6587\u4ef6\u6570\u91cf\u9650\u5236\uff0c\u9ed8\u8ba4\u662f8.\u8be5\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8e\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod.\n          smallFiles: false #\u5982\u679c\u4f60\u6709\u5927\u91cf\u7684\u6570\u636e\u5e93\uff0c\u6bcf\u4e2a\u4fdd\u5b58\u5c11\u91cf\u6570\u636e\u3002MongoDB\u4f7f\u7528\u8f83\u5c0f\u7684\u9ed8\u8ba4\u6587\u4ef6\u5927\u5c0f\n    #                         \u8be5storage.mmapv1.smallFiles\u9009\u9879\u53ef\u51cf\u5c11\u6570\u636e\u6587\u4ef6\u7684\u521d\u59cb\u5927\u5c0f\uff0c\u5e76\u5c06\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a512\u5146\u5b57\u8282\n    #                         storage.mmapv1.smallFiles\u4e5f\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u5927\u5c0f\u4ece1\u5343\u5146\u5b57\u8282\u51cf\u5c11\u5230128\u5146\u5b57\u8282\n    #      journal:\n    #         debugFlags: &lt;int&gt;   #\u63d0\u4f9b\u6d4b\u8bd5\u529f\u80fd\u3002\u4e0d\u7528\u4e8e\u4e00\u822c\u7528\u9014\uff0c\u5e76\u4e14\u4f1a\u5728\u7cfb\u7edf\u5f02\u5e38\u5173\u95ed\u7684\u60c5\u51b5\u4e0b\u5f71\u54cd\u6570\u636e\u6587\u4ef6\u7684\u5b8c\u6574\u6027\n    #         commitIntervalMs: &lt;num&gt; #MongoDB 3.2\u5f03\u7528\u8be5 torage.mmapv1.journal.commitIntervalMs\u8bbe\u7f6e\n    #                                    \u6539\u4e3a\u4f7f\u7528storage.journal.commitIntervalMs\n    #   wiredTiger:\n    #      engineConfig:\n    #         cacheSizeGB: &lt;number&gt;    #WiredTiger\u5c06\u7528\u4e8e\u6240\u6709\u6570\u636e\u7684\u5185\u90e8\u7f13\u5b58\u7684\u6700\u5927\u5927\u5c0f,\u9ed8\u8ba4\u91c7\u7528RAB-1GB\u768450%\u548c256MB\u7684\u6700\u5927\u503c.\n    #                                      \u5c3d\u53ef\u80fd\u4e0d\u8981\u8d85\u8fc7\u6700\u5927\u503c.\n    #         journalCompressor: &lt;string&gt;  #\u7528\u4e8e\u538b\u7f29WiredTiger\u65e5\u5fd7\u6570\u636e\u7684\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0\n    #         directoryForIndexes: true #mongod\u5c06\u7d22\u5f15\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d index,\n    #                                        \u5e76\u5c06\u96c6\u5408\u6570\u636e\u5b58\u50a8\u5728\u540d\u4e3a\u7684\u5b50\u76ee\u5f55\u4e2d collection\n    #      collectionConfig:\n    #         blockCompressor: &lt;string&gt;  #\u7528\u4e8e\u538b\u7f29\u6536\u96c6\u6570\u636e\u7684\u9ed8\u8ba4\u538b\u7f29\u7c7b\u578b\u3002none,snappy,zlib.version:3.0\n          indexConfig:\n             prefixCompression: true #\u542f\u7528\u6216\u7981\u7528\u7d22\u5f15\u6570\u636e\u7684\u524d\u7f00\u538b\u7f29\n    #   inMemory:    #\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\n    #      engineConfig:\n    #         inMemorySizeGB: &lt;number&gt; #\u4e3a\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u6570\u636e\u5206\u914d\u7684\u6700\u5927\u5185\u5b58\u91cf\n    #                                      \u5305\u62ec\u7d22\u5f15\uff0coplog\uff08\u5982\u679c mongod\u662f\u526f\u672c\u96c6\uff0c\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u5143\u6570\u636e\u7684\u4e00\u90e8\u5206\uff09\u7b49\n    #                                       \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\u4f7f\u752850\uff05\u7684\u7269\u7406RAM\u51cf1 GB\n    #\u8fd0\u884c\u5206\u6790\u914d\u7f6e\n    operationProfiling:\n       mode: slowOp   #\u6307\u5b9a\u5e94\u8be5\u5206\u6790\u54ea\u4e9b\u64cd\u4f5c\uff0c\u5206\u6790\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5f71\u54cd\u6027\u80fd.\n    #                        - off=\u5206\u6790\u5668\u5df2\u5173\u95ed\uff0c\u5e76\u4e14\u4e0d\u6536\u96c6\u4efb\u4f55\u6570\u636e\u3002\u8fd9\u662f\u9ed8\u8ba4\u7684\u5206\u6790\u5668\u7ea7\u522b\n    #                        - slowOp=\u5206\u6790\u5668\u6536\u96c6\u6bd4\u82b1\u8d39\u65f6\u95f4\u66f4\u957f\u7684\u64cd\u4f5c\u7684\u6570\u636eslowms\n    #                        - all=\u5206\u6790\u5668\u6536\u96c6\u6240\u6709\u64cd\u4f5c\u7684\u6570\u636e\n       slowOpThresholdMs: 100 #\u6162\u64cd\u4f5c\u65f6\u95f4\u9608\u503c\uff0c\u9ed8\u8ba4100.\n    #   slowOpSampleRate: &lt;double&gt; #\u6162\u64cd\u4f5c\u91c7\u6837\u7387\uff0c0-1\u4e4b\u95f4\uff0c\u5305\u542b0,1.\n    #\n    #\u590d\u5236\u8bbe\u7f6e\n    #\n    #replication:\n    #   oplogSizeMB: &lt;int&gt; #\u590d\u5236\u64cd\u4f5c\u65e5\u5fd7\u7684\u6700\u5927\u5927\u5c0f\uff08MB\uff09\n    #   replSetName: &lt;string&gt;  #mongod\u4e00\u90e8\u5206\u7684\u526f\u672c\u96c6\u7684\u540d\u79f0\u3002\u526f\u672c\u96c6\u4e2d\u7684\u6240\u6709\u4e3b\u673a\u5fc5\u987b\u5177\u6709\u76f8\u540c\u7684\u96c6\u540d\u79f0\u3002\u4ec5\u9002\u7528\u4e8emongod.\n    #   secondaryIndexPrefetch: &lt;string&gt;  #\u4ec5\u9002\u7528\u4e8emmapv1 \u5b58\u50a8\u5f15\u64ce.\n    #                                        \u5728\u5e94\u7528oplog\u4e2d\u7684\u64cd\u4f5c\u4e4b\u524d\uff0c\u526f\u672c\u96c6\u7684\u6b21\u8981\u6210\u5458\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u7d22\u5f15\n    #                                       - none=\u8f85\u52a9\u7a0b\u5e8f\u4e0d\u4f1a\u5c06\u7d22\u5f15\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\n    #                                       - all=\u8f85\u52a9\u7a0b\u5e8f\u52a0\u8f7d\u4e0e\u64cd\u4f5c\u76f8\u5173\u7684\u6240\u6709\u7d22\u5f15\n    #                                       - _id_only=Secondaries\u4e0d\u4f1a\u5c06\u989d\u5916\u7684\u7d22\u5f15\u52a0\u8f7d\u5230\u5df2\u6709_id\u7d22\u5f15\u4e4b\u5916\u7684\u5185\u5b58\u4e2d\n    #   enableMajorityReadConcern: &lt;boolean&gt;  ## Deprecated in 3.6\n    #                                            \u4eceMongoDB 3.6\u5f00\u59cb\uff0c\"majority\"\u59cb\u7ec8\u542f\u7528\u8bfb\u53d6\u5173\u6ce8\uff0c\u5e76\u4e14\u6b64\u8bbe\u7f6e\u4e0d\u8d77\u4f5c\u7528\n    #    localPingThresholdMs: &lt;int&gt;  #mongos\u7528\u4e8e\u786e\u5b9a\u54ea\u4e9b\u8f85\u52a9\u526f\u672c\u96c6\u6210\u5458\u4ece\u5ba2\u6237\u7aef\u4f20\u9012\u8bfb\u53d6\u64cd\u4f5c\u7684ping\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\n    #                                    \u9ed8\u8ba4\u503c15\u5bf9\u5e94\u4e8e\u6240\u6709\u5ba2\u6237\u7aef\u9a71\u52a8\u7a0b\u5e8f\u4e2d\u7684\u9ed8\u8ba4\u503c\n    #\n    # \u5206\u7247\u8bbe\u7f6e\n    #\n    #sharding:\n    #   clusterRole: &lt;string&gt;    #mongod\u5b9e\u4f8b\u5728\u5206\u7247\u7fa4\u96c6\u4e2d\u626e\u6f14\u7684\u89d2\u8272\n    #                           - configsvr=\u5c06\u6b64\u5b9e\u4f8b\u4f5c\u4e3a\u914d\u7f6e\u670d\u52a1\u5668\u542f\u52a8\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827019\u7aef\u53e3\u4e0a\u542f\u52a8\n    #                           - shardsvr=\u542f\u52a8\u6b64\u5b9e\u4f8b\u4e3a\u788e\u7247\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u5b9e\u4f8b\u572827018\u7aef\u53e3\u4e0a\u542f\u52a8\n    #                            \u8bbe\u7f6esharding.clusterRole\u8981\u6c42mongod \u5b9e\u4f8b\u4e0e\u590d\u5236\u4e00\u8d77\u8fd0\u884c\n    #                            \u8981\u5c06\u5b9e\u4f8b\u90e8\u7f72\u4e3a\u526f\u672c\u96c6\u6210\u5458\uff0c\u8bf7\u4f7f\u7528\u8be5replSetName \u8bbe\u7f6e\u5e76\u6307\u5b9a\u526f\u672c\u96c6\u7684\u540d\u79f0\n    #   archiveMovedChunks: false  #\u4ece3.2\u5f00\u59cb\uff0cMongoDB false\u7528\u4f5c\u9ed8\u8ba4\u503c\u3002\u5728\u5757\u8fc1\u79fb\u671f\u95f4\uff0c\u5206\u7247\u4e0d\u4f1a\u4fdd\u5b58\u4ece\u5206\u7247\u8fc1\u79fb\u7684\u6587\u6863\n    #   configDB: &lt;configReplSetName&gt;/cfg1.example.net:27017, cfg2.example.net:27017,...   #\u8be5\u914d\u7f6e\u670d\u52a1\u5668\u7528\u4e8e \u5206\u7247\u7fa4\u96c6\n    #\n    # \u5ba1\u8ba1\u65e5\u5fd7\u8bbe\u7f6e,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\n    #\n    #auditLog:\n    #   destination: file  #\u8bbe\u7f6e\u540e\uff0cauditLog.destination\u542f\u7528\u4f7f\u7528\u6307\u5b9a\u683c\u5f0f\u5f80\u6307\u5b9a\u76ee\u6807\u53d1\u9001\u6240\u6709\u5ba1\u6838\u4e8b\u4ef6\n    ##                             - syslog=\u4ee5JSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\u5230\u7cfb\u7edf\u65e5\u5fd7.\n    ##                             - console=\u4ee5stdoutJSON\u683c\u5f0f\u8f93\u51fa\u5ba1\u8ba1\u4e8b\u4ef6\n    ##                             - file=\u5c06\u5ba1\u6838\u4e8b\u4ef6\u8f93\u51fa\u5230\u4ee5\u4e2d\u6307\u5b9aauditLog.path\u683c\u5f0fauditLog.format\u6307\u5b9a\u7684\u6587\u4ef6\n    #   format: JSON   #\u7528\u4e8e\u5ba1\u8ba1\u7684\u8f93\u51fa\u6587\u4ef6\u7684\u683c\u5f0f,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c(JSON/BSON).\n    #   path: &lt;string&gt; #\u8f93\u51fa\u6587\u4ef6\u7684\u7edd\u5bf9\u6216\u76f8\u5bf9\u8def\u5f84,\u5f53auditLog.destination=file\u65f6,\u53ef\u4ee5\u6307\u5b9a\u8be5\u503c.\n    #   filter: &lt;string&gt; #\u8fc7\u6ee4\u6307\u5b9a\u7c7b\u578b\u7684\u64cd\u4f5c\u7684\u8bb0\u5f55\n    #\n    # \u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u534f\u8bae\u914d\u7f6e\n    #\n    #snmp:\n    #   subagent: &lt;boolean&gt;  #\u8be5snmp.subagent\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8emongod\n    #                        \u5982\u679csnmp.subagent\u662ftrue\uff0cSNMP\u8fd0\u884c\u7684\u5b50\u4ee3\u7406\n    #   master: &lt;boolean&gt;    #\u5f53snmp.master\u662ftrue\uff0cSNMP\u8fd0\u884c\u4f5c\u4e3a\u4e00\u4e2a\u4e3b\u7ad9\u3002\u00b7\n    #\n    # \u6587\u672c\u641c\u7d22\u9009\u9879 ,\u4ec5\u5728MongoDB Enterprise\u4e2d\u53ef\u7528\n    #\n    #basisTech:\n    #   rootDirectory:&lt;string&gt; #\u6307\u5b9aBasis Technology Rosette\u8bed\u8a00\u5b66\u5e73\u53f0\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u4ee5\u652f\u6301\u7528\u4e8e\u6587\u672c\u641c\u7d22\u64cd\u4f5c\u7684\u5176\u4ed6\u8bed\u8a00\n</code></pre>"},{"location":"database/MongoDB/#mongo-shell","title":"mongo shell","text":"<p>\u5e38\u89c1\u7684mongoshell\u5e2e\u52a9\u4e0eJavaScript\u7b49\u6548\u9879\u8868</p> Shell Helpers JavaScript Equivalents show\u00a0dbs,\u00a0show\u00a0databases db.adminCommand('listDatabases') use &lt;[db]&gt; db = db.getSiblingDB('&lt;[db]&gt;') show collections db.getCollectionNames() show users db.getUsers() show roles db.getRoles({showBuiltinRoles: true}) show log &lt;[logname]&gt; db.adminCommand({ 'getLog' : '&lt;[logname]&gt;' }); show logs db.adminCommand({ 'getLog' : '*' }); it cursor = db.collection.find(); if ( cursor.hasNext(); );{ cursor.next();; }"},{"location":"database/MongoDB/#mongodb-crud","title":"MongoDB CRUD \u64cd\u4f5c","text":""},{"location":"database/MongoDB/#_4","title":"\u63d2\u5165\u6587\u4ef6","text":"JavaScript<pre><code>db.collection.insertOne();           // \u63d2\u5165\u4e00\u4e2a\u6587\u6863\ndb.collection.insertMany();          // \u63d2\u5165\u591a\u4e2a\u6587\u6863\ndb.collection.insert();              // \u63d2\u5165\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u6863\ndb.collection.update();              // when used with the **upsert: true** option\ndb.collection.updateOne();           // when used with the **upsert: true** option\ndb.collection.updateMany();          // when used with the **upsert: true** option\ndb.collection.findAndModify();       // when used with the **upsert: true** option\ndb.collection.findOneAndUpdate();    // when used with the **upsert: true** option\ndb.collection.findOneAndReplace();   // when used with the **upsert: true** option\ndb.collection.save();\ndb.collection.bulkWrite();\n</code></pre>"},{"location":"database/MongoDB/#_5","title":"\u67e5\u8be2\u6587\u6863","text":"JavaScript<pre><code>db.collection.find({person:{age:21,sex:\"male\"}});  // \u67e5\u8be2\u5d4c\u5165/\u5d4c\u5957\u5f0f\u6587\u6863\ndb.collection.find({\"person.sex\":\"male\"});  // \u5339\u914d\u5d4c\u5165\u5f0f\u6587\u6863\u67d0\u4e2a\u5b57\u6bb5\ndb.collection.find({tags: [\"blue\", \"red\"]});   // \u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u7684\u4e24\u4e2a\u5143\u7d20\ndb.collection.find({tags: {$all:[\"red\",\"blank\"]}});  // \u4e0d\u6309\u987a\u5e8f\u5339\u914d\u6570\u7ec4\u4e2d\u4e24\u4e2a\u5143\u7d20(\u67e5\u8be2\u53ea\u8981\u5305\u542b\u8fd9\u4e24\u4e2a\u5143\u7d20\u7684\u6240\u6709\u7ed3\u679c)\ndb.collection.find({age: {$gt: 1, $lt: 2}});   // \u96c6\u5408\u4e2dage\u6570\u7ec4\u4e2d\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5927\u4e8e1\uff0c\u53e6\u4e00\u4e2a\u5143\u7d20\u6ee1\u8db3\u5c0f\u4e8e2\uff0c\u6216\u8005\u5355\u4e2a\u5143\u7d20\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\ndb.collection.find({age: {$elemMatch: {$gt: 1, $lt: 2}}});   // \u4f7f\u7528$elemMatch\u8fd0\u7b97\u7b26\u5728\u6570\u7ec4\u7684\u5143\u7d20\u4e0a\u6307\u5b9a\u591a\u4e2a\u6761\u4ef6\uff0c\u4ee5\u4fbf\u81f3\u5c11\u4e00\u4e2a\u6570\u7ec4\u5143\u7d20\u6ee1\u8db3\u6240\u6709\u6307\u5b9a\u7684\u6761\u4ef6\u3002\u6b64\u67e5\u8be2\u6761\u4ef6\u8868\u793aage\u6570\u7ec4\u5305\u542b\u81f3\u5c11\u4e00\u4e2a\u5927\u4e8e1\u4e14\u5c0f\u4e8e2\u7684\u5143\u7d20\ndb.collection.find( { \"tags\": { $size: 3 } } );  // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u957f\u5ea6\u4e3a3\ndb.collection.find( { \"tags.2\": { \"$exists\": 1} } ); // \u67e5\u8be2\u6761\u4ef6\u4e3atags\u6570\u7ec4\u4e2d\u5143\u7d20\u6570\u91cf\u5927\u4e8e2(\u5b9e\u9645\u5229\u7528\u6570\u7ec4\u7d22\u5f15\u6765\u5b9e\u73b0\u7684)\n\n// \u67e5\u8be2\u5d4c\u5957\u5728\u6570\u7ec4\u4e2d\u7684\u6587\u6863\u793a\u4f8b\uff1a\ndb.inventory.insertMany( [\n   { item: \"journal\", instock: [ { warehouse: \"A\", qty: 5 }, { warehouse: \"C\", qty: 15 } ] },\n   { item: \"notebook\", instock: [ { warehouse: \"C\", qty: 5 } ] },\n   { item: \"paper\", instock: [ { warehouse: \"A\", qty: 60 }, { warehouse: \"B\", qty: 15 } ] },\n   { item: \"planner\", instock: [ { warehouse: \"A\", qty: 40 }, { warehouse: \"B\", qty: 5 } ] },\n   { item: \"postcard\", instock: [ { warehouse: \"B\", qty: 15 }, { warehouse: \"C\", qty: 35 } ] }\n]);\n\ndb.inventory.find( { \"instock\": { warehouse: \"A\", qty: 5 } } );  // \u5339\u914d\u5728invertory\u96c6\u5408\u4e2dinstock\u6570\u7ec4\u5143\u7d20\u4e0e\u6307\u5b9a\u6587\u6863\u5339\u914d\u7684\u6587\u6863\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u6587\u6863\u4f5c\u4e3a\u6570\u7ec4\u7684\u5143\u7d20\uff1b\u6ce8\u610f\uff1a\u6574\u4e2a\u5d4c\u5165/\u5d4c\u5957\u6587\u6863\u4e0a\u7684\u7b49\u5f0f\u5339\u914d\u9700\u8981\u6307\u5b9a\u6587\u6863\u7684\u5b8c\u5168\u5339\u914d\ndb.inventory.find( { \"instock\": { $elemMatch: { qty: 5, warehouse: \"A\" } } } );  // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863\u81f3\u5c11\u4e00\u4e2aqty\u503c\u4e3a5\uff0cwarehost\u503c\u4e3aA\ndb.inventory.find( { \"instock\": { $elemMatch: { qty: { $gt: 10, $lte: 20 } } } } );  // \u67e5\u8be2\u5d4c\u5165\u6587\u6863\u6570\u7ec4instock\uff0c\u5d4c\u5165\u7684\u5230\u6b64\u6570\u7ec4\u7684\u6587\u6863qty\u503c\u5927\u4e8e10\u4e14\u5c0f\u4e8e\u7b49\u4e8e20\ndb.inventory.find( { \"instock.qty\": { $gt: 10,  $lte: 20 } } );  // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\u7684qty\u5b57\u6bb5\u5927\u4e8e10\u5e76\u4e14\u6570\u7ec4\u4e2d\u7684\u4efb\u4f55\u6587\u6863\uff08\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5165\u6587\u6863\uff09\u7684qty\u5b57\u6bb5\u5c0f\u4e8e\u6216\u7b49\u4e8e20\ndb.inventory.find( { \"instock.qty\": 5, \"instock.warehouse\": \"A\" } ); // \u67e5\u8be2\u5d4c\u5957\u5728instock\u6570\u7ec4\u4e2d\u7684\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863\u5305\u542b\u5b57\u6bb5qty\u503c\u4e3a5\uff0c\u4e14\u81f3\u5c11\u4e00\u4e2a\u5d4c\u5957\u6587\u6863warehouse\u5b57\u6bb5\u503c\u4e3aA(\u4f46\u4e0d\u4e00\u5b9a\u662f\u76f8\u540c\u7684\u5d4c\u5957\u6587\u6863);\ndb.inventory.find({\"instock.qty\":{$lte:20}});  // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863\ndb.inventory.find({\"instock.0.qty\":{$lte:20}});  // \u67e5\u8be2\u5d4c\u5165\u5230instock\u6570\u7ec4\u7684\u6587\u6863\uff0c\u7d22\u5f15\u4e3a0\u4e14qty\u5b57\u6bb5\u503c\u5c0f\u4e8e20\u7684\u6587\u6863\n\ndb.inventory.find( { status: \"A\" }, { item: 1, status: 1 } );  // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u53ea\u8fd4\u56deitem\u3001status\u53ca_id\u5b57\u6bb5\ndb.inventory.find( { status: \"A\" }, { status: 0, instock: 0 } ); // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u6392\u9664status\u548cinstock\u5b57\u6bb5\ndb.inventory.find( { status: \"A\" }, { item: 1, status: 1, \"size.uom\": 1 } ); // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u503c\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u62ecitem\u3001status\u5b57\u6bb5\u53ca\u5d4c\u5165\u6587\u6863size\u7684uom\u5b57\u6bb5\ndb.inventory.find( { status: \"A\" }, { item: 1, status: 1, instock: { $slice: -1 } } );   // \u67e5\u8be2\u96c6\u5408\u4e2dstatus\u4e3aA\uff0c\u7ed3\u679c\u53ea\u5305\u542bitem\u3001status\u5b57\u6bb5instock\uff0c$slice\u8fd0\u7b97\u7b26\u8fd4\u56deinstock\u6570\u7ec4\u6700\u540e\u4e00\u4e2a\u5143\u7d20\n\ndb.inventory.find({item: null});  // \u67e5\u8be2item\u5b57\u6bb5\u4e3anull\uff0c\u6216\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863\ndb.inventory.find({item: {$type: 10}});  // \u53ea\u67e5\u8be2item\u5b57\u6bb5\u503c\u7c7b\u578b\u662f10(\u5373null\u7c7b\u578b);\u7684\u6587\u6863\ndb.inventory.find({item: {$exists: false}}) // \u53ea\u67e5\u8be2\u4e0d\u5305\u542bitem\u5b57\u6bb5\u7684\u6587\u6863\n</code></pre>"},{"location":"database/MongoDB/#_6","title":"\u66f4\u65b0\u6587\u6863","text":"JavaScript<pre><code>db.inventory.updateOne({ item: \"paper\" },{$set: { \"size.uom\": \"cm\", status: \"P\" },$currentDate: { lastModified: true }});    // \u66f4\u65b0\u4e00\u4e2a\u6587\u6863item\u5b57\u6bb5\u503c\u4e3apaper\uff0c\u5c06size\u6570\u7ec4\u4e2duom\u66f4\u65b0\u4e3acm\uff0cstatus\u66f4\u65b0\u4e3aP\ndb.inventory.updateMany({ \"qty\": { $lt: 50 }},{$set: { \"size.uom\": \"in\", status: \"Z\" },$currentDate: { lastModified: true }});   // \u66f4\u65b0qty\u5b57\u6bb5\u503c\u5c0f\u4e8e50\uff0c\u66f4\u65b0size\u6570\u7ec4uom\u5b57\u6bb5\u503c\u4e3ain\uff0cstatus\u5b57\u6bb5\u503c\u4e3aZ\uff0c\u7528$currentDate\u64cd\u4f5c\u66f4\u65b0lastModified\u5b57\u6bb5\u4e3a\u5f53\u524d\u65f6\u95f4\uff0c\u6ca1\u6709\u6b64\u5b57\u6bb5\ndb.collection.update()  // \u66f4\u65b0\u6216\u66ff\u6362\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u5355\u4e2a\u6587\u6863\uff0c\u6216\u66f4\u65b0\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863\n// \u4ee5\u4e0b\u51e0\u79cd\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u66f4\u65b0\u6587\u6863\ndb.collection.findOneAndReplace()\ndb.collection.findOneAndUpdate()\ndb.collection.findAndModify()\ndb.collection.save()\ndb.collection.bulkWrite()\n</code></pre>"},{"location":"database/MongoDB/#_7","title":"\u5220\u9664\u6587\u6863","text":"Markdown<pre><code>db.collection.deleteMany({})  // \u5220\u9664\u96c6\u5408\u6240\u6709\u6587\u6863\ndb.collection.deleteOne( { status: \"D\" } )   // \u5220\u9664status\u4e3aD\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\ndb.collection.remove()  // \u5220\u9664\u5355\u4e2a\u6587\u6863\u6216\u4e0e\u6307\u5b9a\u8fc7\u6ee4\u5668\u5339\u914d\u7684\u6240\u6709\u6587\u6863\n\u5220\u9664\u64cd\u4f5c\u4e0d\u4f1a\u5220\u9664\u7d22\u5f15\uff0c\u5373\u4f7f\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6240\u6709\u6587\u6863\uff01MongoDB\u4e2d\u7684\u6240\u6709\u5199\u5165\u64cd\u4f5c\u90fd\u662f\u5355\u4e2a\u6587\u6863\u7ea7\u522b\u7684\u539f\u5b50\u64cd\u4f5c\n\u4ee5\u4e0b\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\uff1a\ndb.collection.findOneAndDelete()  // findOneAndDelete()\u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879.\u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\ndb.collection.findAndModify()   // findAndModify()\u63d0\u4f9b\u4e00\u4e2a\u6392\u5e8f\u9009\u9879.\u8be5\u9009\u9879\u5141\u8bb8\u5220\u9664\u6309\u6307\u5b9a\u987a\u5e8f\u6392\u5e8f\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\ndb.collection.bulkWrite()\n</code></pre>"},{"location":"database/MongoDB/#_8","title":"\u6279\u91cf\u5199\u5165\u64cd\u4f5c","text":"Markdown<pre><code>db.collection.bulkWrite() // \u6b64\u65b9\u6cd5\u53ef\u4ee5\u6279\u91cf\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\u64cd\u4f5c\u3002\u6279\u91cf\u5199\u64cd\u4f5c\u53ef\u4ee5\u6709\u5e8f\u4e5f\u53ef\u65e0\u5e8f\n// \u901a\u8fc7\u6709\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0cMongoDB\u4ee5\u4e32\u884c\u65b9\u5f0f\u6267\u884c\u64cd\u4f5c\u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0cMongoDB\u5c06\u8fd4\u56de\u800c\u4e0d\u5904\u7406\u5217\u8868\u4e2d\u7684\u4efb\u4f55\u5269\u4f59\u5199\u64cd\u4f5c\n// \u4f7f\u7528\u65e0\u5e8f\u7684\u64cd\u4f5c\u5217\u8868\uff0cMongoDB\u53ef\u4ee5\u5e76\u884c\u6267\u884c\u64cd\u4f5c\uff0c\u4f46\u4e0d\u4fdd\u8bc1\u8fd9\u79cd\u884c\u4e3a\u3002\u5982\u679c\u5728\u5904\u7406\u5176\u4e2d\u4e00\u4e2a\u5199\u64cd\u4f5c\u671f\u95f4\u53d1\u751f\u9519\u8bef\uff0cMongoDB\u5c06\u7ee7\u7eed\u5904\u7406\u5217\u8868\u4e2d\u7684\u5269\u4f59\u5199\u64cd\u4f5c\n// \u5206\u7247\u96c6\u5408\u4e0a\uff0c\u6709\u5e8f\u64cd\u4f5c\u901a\u5e38\u6bd4\u65e0\u5e8f\u8981\u6162\uff0cbulk.Write()\u9ed8\u8ba4\u662f\u6709\u5e8f\u64cd\u4f5c\nbulkWrite()\u652f\u6301\u4ee5\u4e0b\u5199\u64cd\u4f5c\uff1a\ninsertOne\nupdateOne\nupdateMany\nreplaceOne\ndeleteOne\ndeleteMany\n\n\u6279\u91cf\u63d2\u5165\u5230\u5206\u7247\u96c6\u5408\u7684\u7b56\u7565\uff1a\n1. \u9884\u5206\u5272\u96c6\u5408\n2. \u65e0\u5e8f\u5199\u5165mongos\n3. \u907f\u514d\u5355\u8c03\u8282\u6d41--Avoid Monotonic Throttling(\u6b64\u5904\u5b58\u7591)\n</code></pre>"},{"location":"database/MongoDB/#_9","title":"\u53ef\u91cd\u8bd5\u7684\u5199\u5165","text":"Markdown<pre><code>\u53ef\u91cd\u8bd5\u5199\u5165\u8981\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6\uff1a\n1. \u9700\u8981\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\n2. \u652f\u6301\u6587\u6863\u9501\u5b9a\u7684\u5b58\u50a8\u5f15\u64ce\uff0c\u4f8b\u5982\uff1aWiredTiger\u6216inmemory\u5185\u5b58\u5b58\u50a8\u5f15\u64ce\n3. MongoDB 3.6+ \u7248\u672c\u9a71\u52a8\u7a0b\u5e8f\n4. \u96c6\u7fa4\u4e2dMongoDB\u7248\u672c\u5927\u4e8e\u7b49\u4e8e3.6\n5. \u5199\u64cd\u4f5c\u51fa\u9519\uff0cWrite Concern\u4e3a0\u7684\u4e0d\u91cd\u8bd5\n\ntransaction commit\u548cabort operations  \u5982\u679c\u63d0\u4ea4\u64cd\u4f5c\u6216\u4e2d\u6b62\u64cd\u4f5c\u9047\u5230\u9519\u8bef\uff0cMongoDB\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u91cd\u8bd5\u8be5\u64cd\u4f5c\u4e00\u6b21\uff0c\u65e0\u8bba\u662f\u5426retryWrites\u8bbe\u7f6e\u4e3atrue\n\u4e8b\u52a1\u5185\u7684\u5199\u64cd\u4f5c\u662f\u4e0d\u80fd\u5355\u72ec\u91cd\u8bd5\u5199\u5165\u7684\uff0c\u65e0\u8bbaretryWrites\u662f\u5426\u8bbe\u7f6e\u4e3atrue\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0d\u542f\u52a8\u91cd\u8bd5\u5199\u5165\n\n\n\u4ee5\u4e0b\u4e3a\u53ef\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c(Write Concern\u4e0d\u80fd\u662f{w: 0})\uff1a\n\n// \u63d2\u5165\u64cd\u4f5c\ndb.collection.insertOne()\ndb.collection.insert()\ndb.collection.insertMany()\n\n// \u5355\u6587\u6863\u66f4\u65b0\u64cd\u4f5c\ndb.collection.updateOne()\ndb.collection.replaceOne()\ndb.collection.save()\ndb.collection.update()\u8fd9\u91ccmulti\u662ffalse\n\n// \u5355\u4e2a\u6587\u6863\u5220\u9664\u64cd\u4f5c\ndb.collection.deleteOne()\ndb.collection.remove()\u8fd9\u91ccjustOne\u662ftrue\n\n// findAndModify\u64cd\u4f5c\u3002\u6240\u6709findAndModify\u64cd\u4f5c\u90fd\u662f\u5355\u6587\u6863\u64cd\u4f5c\ndb.collection.findAndModify()\ndb.collection.findOneAndDelete()\ndb.collection.findOneAndReplace()\ndb.collection.findOneAndUpdate()\n\n// \u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982updateMany\ndb.collection.bulkWrite()\u00a0\u4f7f\u7528\u4ee5\u4e0b\u5199\u64cd\u4f5c:\ninsertOne\nupdateOne\nreplaceOne\ndeleteOne\n\n// \u4ec5\u5305\u542b\u5355\u6587\u6863\u7684\u6279\u91cf\u5199\u5165\u64cd\u4f5c\uff0c\u4e00\u4e2a\u53ef\u91cd\u8bd5\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u6307\u5b9a\u5199\u5165\u64cd\u4f5c\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u7684\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982update\u6307\u5b9amulti\u9009\u9879\u4e3atrue\nBulk\u00a0\u8fd0\u4f5c\uff1a\u6279\u91cf\u5199\u5165\u64cd\u4f5c\u4ec5\u5305\u542b\u5355\u6587\u6863\u5199\u5165\u64cd\u4f5c\u3002\u53ef\u91cd\u8bd5\u7684\u6279\u91cf\u64cd\u4f5c\u53ef\u4ee5\u5305\u62ec\u6307\u5b9a\u7684\u5199\u5165\u64cd\u4f5c\u7684\u4efb\u4f55\u7ec4\u5408\uff0c\u4f46\u4e0d\u80fd\u5305\u62ec\u4efb\u4f55\u591a\u6587\u6863\u5199\u5165\u64cd\u4f5c\uff0c\u4f8b\u5982\u4e3a\u8be5\u9009\u9879update\u6307\u5b9a\u7684\u64cd\u4f5c\u3002truemulti\nBulk.find.removeOne()\nBulk.find.replaceOne()\nBulk.find.replaceOne()\n\n\u53ef\u91cd\u8bd5\u5199\u5165\u6709\u52a9\u4e8e\u89e3\u51b3\u77ac\u65f6\u7f51\u7edc\u9519\u8bef\u548c\u526f\u672c\u96c6\u9009\u4e3e\uff0c\u5e76\u4e0d\u80fd\u89e3\u51b3\u6301\u4e45\u6027\u7f51\u7edc\u9519\u8bef\uff0c\u56e0\u4e3a\u53ea\u8fdb\u884c\u4e00\u6b21\u91cd\u8bd5\u5c1d\u8bd5\n\u5982\u679c\u9a71\u52a8\u7a0b\u5e8f\u5728\u76ee\u6807\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u5206\u7247\u4e2d\u627e\u4e0d\u5230\u6b63\u5e38\u7684\u4e3b\u8282\u70b9\uff0c\u5219\u9a71\u52a8\u7a0b\u5e8f\u4f1a\u5728serverSelectionTimeoutMS\u5728\u91cd\u8bd5\u4e4b\u524d\u7b49\u5f85\u4ee5\u786e\u5b9a\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u53ef\u91cd\u8bd5\u5199\u5165\u4e0d\u80fd\u89e3\u51b3\u6545\u969c\u8f6c\u79fb\u671f\u95f4\uff0c\u65f6\u95f4\u8d85\u8fc7serverSelectionTimeoutMS\u7684\u5b9e\u4f8b\n\n\u6ce8\u610f\uff1a\u5982\u679c\u5ba2\u6237\u7aef\u53d1\u51fa\u5199\u5165\u64cd\u4f5c\u5728\u8d85\u8fc7serverSelectionTimeoutMS\u6ca1\u6709\u54cd\u5e94\uff0c\u6709\u53ef\u80fd\u5728\u5ba2\u6237\u7aef\u91cd\u65b0\u54cd\u5e94\u65f6(\u6ca1\u6709\u91cd\u65b0\u542f\u52a8)\uff0c\u5219\u53ef\u80fd\u4f1a\u518d\u91cd\u8bd5\u5199\u5165\u64cd\u4f5c\n\ndb.serverStatus()\u5305\u542b\u6709\u5173\u8be5transactions\u90e8\u5206\u4e2d\u53ef\u91cd\u8bd5\u5199\u5165\u7684\u7edf\u8ba1\u4fe1\u606f\n</code></pre>"},{"location":"database/MongoDB/#_10","title":"\u6587\u672c\u641c\u7d22","text":"<p>\u793a\u4f8b\u6587\u6863\u5982\u4e0b\u6240\u793a\uff1a | _id | description | name | | :------: | :------: | :------: | | _id | description | name | | 1 | Coffee and cakes | Java Hut | | 2 | Gourmet hamburgers | Burger Buns | | 3 | Just coffee | Coffee Shop | | 4 | Discount clothing | Clothes Clothes Clothes | | 5 | Indonesian goods | Java Shopping |</p> Markdown<pre><code>// \u89c6\u56fe\u4e0d\u652f\u6301\u6587\u672c\u641c\u7d22\uff1b\u6587\u672c\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5b57\u7b26\u4e32\u5185\u5bb9\u7684\u6587\u672c\u641c\u7d22\u67e5\u8be2\u3002text\u7d22\u5f15\u53ef\u4ee5\u5305\u62ec\u5176\u503c\u4e3a\u5b57\u7b26\u4e32\u6216\u5b57\u7b26\u4e32\u5143\u7d20\u6570\u7ec4\u7684\u4efb\u4f55\u5b57\u6bb5\n// \u8981\u6267\u884c\u6587\u672c\u641c\u7d22\u67e5\u8be2\uff0c\u60a8\u5fc5\u987btext\u5728\u96c6\u5408\u4e0a\u6709\u7d22\u5f15\u3002\u96c6\u5408\u53ea\u80fd\u6709\u4e00\u4e2a\u6587\u672c\u641c\u7d22\u7d22\u5f15\uff0c\u4f46\u8be5\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u591a\u4e2a\u5b57\u6bb5\n// \u4f7f\u7528$text\u67e5\u8be2\u8fd0\u7b97\u7b26\u5bf9\u5177\u6709\u6587\u672c\u7d22\u5f15\u7684\u96c6\u5408\u6267\u884c\u6587\u672c\u641c\u7d22\u3002$text\u5c06\u4f7f\u7528\u7a7a\u683c\u548c\u5927\u591a\u6570\u6807\u70b9\u7b26\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u6765\u6807\u8bb0\u641c\u7d22\u5b57\u7b26\u4e32\uff0c\u5e76OR\u5728\u641c\u7d22\u5b57\u7b26\u4e32\u4e2d\u6267\u884c\u6240\u6709\u6b64\u7c7b\u6807\u8bb0\u7684\u903b\u8f91\ndb.stores.find( { $text: { $search: \"java shop\" } } )  //\u67e5\u627estores\u96c6\u5408\u5305\u542bjava shop\u7684\u4efb\u4f55\u6587\u6863\ndb.stores.find( { $text: { $search: \"java -shop\" } } )  //\u67e5\u627estores\u96c6\u5408\u5305\u542bjava\u6392\u9664shop\u7684\u4efb\u4f55\u6587\u6863\ndb.stores.find( { $text: { $search: \"java coffee shop\" } }, { score: { $meta: \"textScore\" } } ).sort( { score: { $meta: \"textScore\" } } )   // \u8981\u6309\u76f8\u5173\u6027\u5f97\u5206\u7684\u987a\u5e8f\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\n\naggregation pipeline\u4e5f\u53ef\u4ee5\u8fdb\u884ctext\u641c\u7d22\ndb.stores.createIndex( { name: \"text\", description: \"text\" } )  // \u521b\u5efa\u7d22\u5f15,\u5141\u8bb8\u5728name\u548cdescription\u5b57\u6bb5\u4e0a\u8fdb\u884c\u6587\u672c\u641c\u7d22\n\u5728\u805a\u5408\u7ba1\u9053\u4e2d\u901a\u8fc7$text\u5728$match\u9636\u6bb5\u4f7f\u7528\u67e5\u8be2\u8fd0\u7b97\u7b26\u8fdb\u884c\u6587\u672c\u641c\u7d22\uff1b\u805a\u5408\u7ba1\u9053\u4e2d\u7684\u6587\u672c\u641c\u7d22\u5177\u6709\u4ee5\u4e0b\u9650\u5236\uff1a\n1. $match\u9636\u6bb5\u5305\u542b\u7684$text\u5fc5\u987b\u5728\u6d41\u6c34\u7ebf\u7684\u7b2c\u4e00\u9636\u6bb5\n2. \u4e00\u4e2atext\u64cd\u4f5c\u53ea\u80fd\u5728\u6d41\u6c34\u9636\u6bb5\u51fa\u73b0\u4e00\u6b21\n3. text\u64cd\u4f5c\u4e0d\u80fd\u51fa\u73b0\u5728$or\u6216$not\u8868\u8fbe\u5f0f\n4. \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6587\u672c\u641c\u7d22\u4e0d\u4f1a\u6309\u5339\u914d\u5206\u6570\u7684\u987a\u5e8f\u8fd4\u56de\u5339\u914d\u7684\u6587\u6863\uff0c\u5728$sort\u9636\u6bb5\u4f7f\u7528$meta\u805a\u5408\u8868\u8fbe\u5f0f\n</code></pre>"},{"location":"database/MongoDB/#_11","title":"\u5730\u7406\u7a7a\u95f4\u67e5\u8be2","text":"Markdown<pre><code>// \u6307\u5b9aGeoJSON\u6570\u636e,\u4f7f\u7528\u5d4c\u5165\u5f0f\u6587\u6863\uff1a\n1. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5\u540d\u4e3atype\uff0c\u6307\u5b9aGeoJSON\u5bf9\u8c61\u7c7b\u578b\n2. \u4e00\u4e2a\u540d\u4e3a\u5b57\u6bb5coordinates\uff0c\u7528\u4e8e\u6307\u5b9a\u5bf9\u8c61\u7684\u5750\u6807\uff0c\u6307\u5b9a\u7ecf\u7eac\u5ea6\u5750\u6807\uff0c\u6709\u6548\u7ecf\u5ea6-180\u81f3180(\u5305\u62ec\u4e24\u8005)\uff0c\u6709\u6548\u7eac\u5ea6-90\u523090(\u5305\u62ec\u4e24\u8005)\nlocation: {\n      type: \"Point\",\n      coordinates: [-73.856077, 40.848447]\n}\n\nMongoDB\u63d0\u4f9b\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\uff1a\n2dsphere\u7d22\u5f15\u652f\u6301\u5728\u7c7b\u4f3c\u5730\u7403\u7684\u7403\u4f53\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2\ndb.collection.createIndex({location field: \"2dsphere\"}) // \u521b\u5efa2dsphere\u7d22\u5f15\n\n2d\u7d22\u5f15\u652f\u6301\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u8ba1\u7b97\u51e0\u4f55\u7684\u67e5\u8be2,\u7d22\u5f15\u652f\u6301$nearSphere\u5728\u7403\u4f53\u4e0a\u8ba1\u7b97\u7684\u67e5\u8be2\uff0c\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u8fd8\u662f\u4f7f\u75282dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2\uff0c2d\u5bf9\u7403\u5f62\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u7684\u7ed3\u679c\uff0c\u5982\uff1a\u4f7f\u75282d\u5305\u56f4\u6781\u70b9\u7684\u7403\u5f62\u67e5\u8be2\u7d22\u5f15\n\n\u5206\u7247\u96c6\u5408\u65f6\uff0c\u4e0d\u80fd\u5c06\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u4f5c\u4e3a\u5206\u7247\u952e\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\u5728\u5206\u7247\u96c6\u5408\u4e0a\u521b\u5efa\u5730\u5740\u7a7a\u95f4\u7d22\u5f15\n\n\u5206\u7247\u96c6\u5408\u652f\u6301\u4ee5\u4e0b\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\uff1a\n1. $geoNear \u805a\u5408\u9636\u6bb5\n2. $near\u548c$nearSphere\u67e5\u8be2\u8fd0\u7b97\u7b26\n3. geoNear\u547d\u4ee4\n\n\u5728\u5206\u7247\u96c6\u7fa4\uff0c\u53ef\u4ee5\u4f7f\u7528$geoWithin\u548c$geoIntersect\u6765\u67e5\u8be2\u5730\u7406\u7a7a\u95f4\u6570\u636e\n\n\u4ee5\u4e0b\u4e3a\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\uff1a\n$geoIntersects    // \u9009\u62e9\u548cGeoJSON\u51e0\u4f55\u4f53\u76f8\u4ea4\u7684\u51e0\u4f55\uff0c\u8be52dsphere\u7d22\u5f15\u652f\u6301$geoIntersects\n$geoWithin        // \u9009\u62e9\u8fb9\u754cGeoJSON\u51e0\u4f55\u4f53\u5185\u7684\u51e0\u4f55,\u8be52dsphpere\u548c2d\u7d22\u5f15\u652f\u6301$geoWithin\n$near             // \u8fd4\u56de\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $near\n$nearSphere       // \u8fd4\u56de\u7403\u4f53\u4e0a\u67d0\u70b9\u9644\u8fd1\u7684\u5730\u7406\u7a7a\u95f4\u5bf9\u8c61\u3002\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u3002\u8be52dsphere\u548c2D\u7d22\u5f15\u652f\u6301 $nearSphere\n\n\u5730\u7406\u7a7a\u95f4\u547d\u4ee4\uff1a\ngeoNear\uff08\u5728MongoDB 4.0\u4e2d\u4e0d\u63a8\u8350\u4f7f\u7528\uff09  // \u6267\u884c\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\uff0c\u8fd4\u56de\u6700\u63a5\u8fd1\u7ed9\u5b9a\u70b9\u7684\u6587\u6863\u3002\u4e0d\u63a8\u8350\u4f7f\u7528\u7684geoNear\u547d\u4ee4\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\n\n\u5730\u7406\u7a7a\u95f4\u805a\u5408\u9636\u6bb5:\n$geoNear          // \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd $match\uff0c$sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002$geoNear\u9700\u8981\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\n\n\u5730\u7406\u7a7a\u95f4\u6a21\u578b:\nMongoDB\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u53ef\u4ee5\u89e3\u91ca\u5e73\u9762\u6216\u7403\u9762\u4e0a\u7684\u51e0\u4f55\u4f53\n2dsphere \u7d22\u5f15\u4ec5\u652f\u6301\u7403\u5f62\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u7403\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09\n2d\u7d22\u5f15\u652f\u6301\u5e73\u9762\u67e5\u8be2\uff08\u5373\u89e3\u91ca\u5e73\u9762\u4e0a\u51e0\u4f55\u7684\u67e5\u8be2\uff09\u548c\u4e00\u4e9b\u7403\u5f62\u67e5\u8be2\u3002\u867d\u71362d \u7d22\u5f15\u652f\u6301\u67d0\u4e9b\u7403\u5f62\u67e5\u8be2\uff0c\u4f46\u4f7f\u75282d\u8fd9\u4e9b\u7403\u5f62\u67e5\u8be2\u7684\u7d22\u5f15\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9519\u8bef\u3002\u5982\u679c\u53ef\u80fd\uff0c\u8bf7\u4f7f\u7528 2dsphere\u7d22\u5f15\u8fdb\u884c\u7403\u5f62\u67e5\u8be2\n\n\u4e0b\u8868\u5217\u51fa\u4e86\u6bcf\u4e2a\u5730\u7406\u7a7a\u95f4\u64cd\u4f5c\u4f7f\u7528\u7684\u5730\u7406\u7a7a\u95f4\u67e5\u8be2\u8fd0\u7b97\u7b26\u652f\u6301\u7684\u67e5\u8be2\uff1a[http://docs.mongodb.com/manual/geospatial-queries/]\n| \u64cd\u4f5c | \u7403\u5f62/\u5e73\u9762\u67e5\u8be2 | \u5907\u6ce8 |\n| :------: | :------: | :------: |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n|  |  |\n</code></pre> Markdown<pre><code>// write-concern\n{ w: &lt;value&gt;, j: &lt;boolean&gt;, wtimeot: &lt;number&gt; }\nw\u9009\u9879\uff1a\u786e\u8ba4\u5199\u5165\u8bf7\u6c42\u4f20\u9012\u7ed9mongod\u5b9e\u4f8b\u7684\u6570\u91cf\uff0c1\u8868\u793a\u4f20\u9012\u5199\u5165\u64cd\u4f5c\u7ed9\u4e00\u4e2astandalone\u6216\u526f\u672c\u7684\u4e00\u4e2a\u4e3b\u8282\u70b9\uff1b0\u5199\u5165\u64cd\u4f5c\u6ca1\u6709\u786e\u8ba4\uff0cw\u5927\u4e8e1\u662f\u56e0\u4e3a\u9700\u8981\u6765\u81ea\u5176\u4ed6\u8f85\u52a9\u6570\u636e\u8282\u70b9\u7684\u786e\u8ba4\nj\u9009\u9879\uff1a\u786e\u8ba4\u5199\u64cd\u4f5c\u5df2\u5199\u5165\u78c1\u76d8\u65e5\u5fd7(on-disk journal)\nwtimeout:\u5199\u5165\u7684\u65f6\u95f4\u9650\u5236(\u6beb\u79d2\u4e3a\u5355\u4f4d)\uff0cwtimeout\u4ec5\u9650\u4e8ew\u5927\u4e8e1\u7684\u60c5\u51b5\n</code></pre>"},{"location":"database/MongoDB/#mongodbcrud","title":"MongoDBCRUD\u6982\u5ff5","text":"Markdown<pre><code>// \u539f\u5b50\u6027\u548c\u4e8b\u52a1\n\u5f53\u5355\u4e2a\u5199\u64cd\u4f5c(\u5982\uff1adb.collection.updateMany())\u4fee\u6539\u591a\u4e2a\u6587\u4ef6\u65f6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u7684\u4fee\u6539\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u4f46\u662f\u6574\u4e2a\u64cd\u4f5c\u4e0d\u662f\uff01\n\n// \u5e76\u53d1\u63a7\u5236\n\u5e76\u53d1\u63a7\u5236\u5141\u8bb8\u591a\u4e2a\u7a0b\u5e8f\u540c\u65f6\u8fd0\u884c\uff0c\u800c\u4e0d\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\u6216\u51b2\u7a81\n\u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u5b57\u6bb5\u4e0a\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u8be5\u7d22\u5f15\u53ea\u6709\u552f\u4e00\u503c\u3002\u53ef\u4ee5\u9632\u6b62\u63d2\u5165\u3001\u66f4\u65b0\u521b\u5efa\u91cd\u590d\u6570\u636e\u3002\u5728\u591a\u4e2a\u5b57\u6bb5\u521b\u5efa\u552f\u4e00\u7d22\u5f15\uff0c\u4ee5\u5f3a\u5236\u8be5\u5b57\u6bb5\u7ec4\u5408\u7684\u552f\u4e00\u6027\n\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u5728\u4e3a\u5199\u64cd\u4f5c\u7684\u67e5\u8be2\u8c13\u8bcd\u4e2d\u6307\u5b9a\u5b57\u6bb5\u9884\u671f\u7684\u5f53\u524d\u503c\n\n// \u8bfb\u53d6\u9694\u79bb,\u4e00\u81f4\u6027\u548cRecency\n</code></pre>"},{"location":"database/MongoDB/#_12","title":"\u5206\u5e03\u5f0f\u67e5\u8be2\u3001\u67e5\u8be2\u4f18\u5316\u3001\u67e5\u8be2\u6027\u80fd\u3001\u4f18\u5316\u67e5\u8be2","text":"Markdown<pre><code>oplog\u662f\u5bf9\u6570\u636e\u96c6\u64cd\u4f5c\u7684\u53ef\u91cd\u73b0\u5e8f\u5217,\u7d22\u5f15\u53ef\u4ee5\u6db5\u76d6\u5d4c\u5165\u5f0f\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u67e5\u8be2\uff1b\u5982\u679c\u7d22\u5f15\u8ddf\u8e2a\u54ea\u4e2a\u6216\u54ea\u4e9b\u5b57\u6bb5\u5bfc\u81f4\u7d22\u5f15\u4e3a\u591a\u5efa\u7d22\u5f15\uff0c\u5219\u591a\u5efa\u7d22\u5f15\u53ef\u4ee5\u8986\u76d6\u975e\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2\u3002(\u591a\u5efa\u7d22\u5f15\u4e0d\u80fd\u8986\u76d6\u6570\u7ec4\u5b57\u6bb5\u4e0a\u7684\u67e5\u8be2)\uff1b\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u65e0\u6cd5\u8986\u76d6\u7d22\u5f15\u3002\u8981\u786e\u5b9a\u4e00\u4e2a\u67e5\u8be2\u662f\u5426\u4e3a\u8986\u76d6\u67e5\u8be2\uff0c\u4f7f\u7528db.collection.explain()\u6216explain()\n\n\u4f7f\u7528Database Profiler\u8bc4\u4f30\u5bf9\u6570\u636e\u5e93\u7684\u64cd\u4f5c\n\n// \u4f18\u5316\u67e5\u8be2\n1. \u521b\u5efa\u652f\u6301\u67e5\u8be2\u7684\u7d22\u5f15\n2. \u5982\u7ecf\u5e38\u5bf9timestamp\u5b57\u6bb5\u8fdb\u884c\u6392\u5e8f\u6027\u67e5\u8be2\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u5728timestamp\u5b57\u6bb5\u521b\u5efa\u7d22\u5f15\uff0c\u67e5\u8be2\u65f6\u4f7f\u7528db.collection.find().sort({ timestamp: -1})\u66f4\u5feb\u5f97\u5230\u7ed3\u679c\uff0c\u56e0\u4e3aMongoDB\u53ef\u4ee5\u6309\u7167\u5347\u5e8f\u6216\u964d\u5e8f\u8bfb\u53d6\u7d22\u5f15\n3. \u7d22\u5f15\u652f\u6301\u67e5\u8be2\u3001\u66f4\u65b0\u64cd\u4f5c\u548c\u805a\u5408\u7ba1\u9053\u7684\u67d0\u4e9b\u9636\u6bb5\uff1b\u5982\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\uff0c\u5219BinData\u7c7b\u578b\u7684\u7d22\u5f15\u5efa\u53ef\u4ee5\u66f4\u6709\u6548\u7684\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\n  * \u4e8c\u8fdb\u5236\u5b50\u7c7b\u578b\u503c\u5f97\u8303\u56f4\u4e3a0-7\u6216128-135\n  * \u5b57\u8282\u6570\u7ec4\u7684\u957f\u5ea6\u4e3a\uff1a0,1,2,3,4,5,6,7,8,10,12,14,16,20,24\u621632\n4. \u9650\u5236\u67e5\u8be2\u7ed3\u679c\u6570\uff0c\u901a\u8fc7limit()\u65b9\u6cd5\u51cf\u5c11\u67e5\u8be2\u5bf9\u7f51\u7edc\u8d44\u6e90\u7684\u6d88\u8017\u3002\u901a\u5e38\u548csort()\u7ed3\u5408\u4f7f\u7528\n5. \u4f7f\u7528\u9884\u6d4b\u8fd4\u56de\u5fc5\u8981\u7684\u6570\u636e\uff1b\u53ea\u9700\u8981\u6587\u6863\u7684\u90e8\u5206\u5b57\u6bb5\u65f6\uff0c\u53ea\u8fd4\u56de\u6240\u9700\u7684\u5b57\u6bb5\u53ef\u4ee5\u83b7\u53d6\u66f4\u597d\u7684\u6027\u80fd\n6. \u4f7f\u7528$hint\u9009\u62e9\u4e00\u4e2a\u7279\u5b9a\u7684\u6307\u6570\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u4f18\u5316\u5668\u4f1a\u4e3a\u7279\u5b9a\u64cd\u4f5c\u9009\u62e9\u6700\u4f73\u7684\u7d22\u5f15\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u4f7f\u7528$hint()\u65b9\u6cd5\u5f3a\u5236\u4f7f\u7528\u7279\u5b9a\u7d22\u5f15\u3002hint()\u652f\u6301\u6027\u80fd\u6d4b\u8bd5\u6216\u5728\u67d0\u4e9b\u67e5\u8be2\uff0c\u5728\u4e00\u4e9b\u67e5\u8be2\u4e2d\uff0c\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5fc5\u987b\u5305\u542b\u5728\u591a\u4e2a\u7d22\u5f15\u4e2d\n7. \u4f7f\u7528\u589e\u91cf\u8fd0\u7b97\u7b26\u6267\u884c\u64cd\u4f5c\u670d\u52a1\u7aef\uff0cMongoDB\u7684$inc\u8fd0\u7b97\u7b26\u6765\u589e\u52a0\u6216\u51cf\u5c11\u6587\u6863\u4e2d\u7684\u503c\uff0c\u8be5\u64cd\u4f5c\u589e\u52a0\u670d\u52a1\u7aef\u5b57\u6bb5\u7684\u503c\uff0c\u4f5c\u4e3a\u9009\u62e9\u6587\u6863\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0c\u5728\u5ba2\u6237\u7aef\u8fdb\u884c\u7b80\u5355\u4fee\u6539\uff0c\u7136\u540e\u5c06\u6574\u4e2a\u6587\u6863\u5199\u5165\u670d\u52a1\u5668\u3002$inc\u64cd\u4f5c\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u907f\u514d\u7ade\u4e89\u6761\u4ef6\uff0c\u8fd9\u5c06\u5bfc\u81f4\u4e24\u4e2a\u5e94\u7528\u5b9e\u4f8b\u5bf9\u540c\u4e00\u4e2a\u6587\u4ef6\u67e5\u8be2\u65f6\uff0c\u624b\u52a8\u589e\u52a0\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5e76\u4fdd\u5b58\u6574\u4e2a\u6587\u4ef6\u56de\u5230\u540c\u4e00\u65f6\u95f4\n\n// \u5199\u64cd\u4f5c\u6027\u80fd\n\n\u96c6\u5408\u4e2d\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u589e\u52a0\u6027\u80fd\u7684\u5f00\u9500\uff1b\u56e0\u96c6\u5408\u4e2d\u6bcf\u4e2ainsert\u548cdelete\u5199\u5165\u64cd\u4f5c\u3002MongoDB\u90fd\u4f1a\u4ece\u76ee\u6807\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u4e2d\u63d2\u5165\u6216\u5220\u9664\u5bf9\u5e94\u7684\u6587\u6863\u952e\u3002update\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u66f4\u65b0\u5728\u8fd9\u4e2a\u96c6\u5408\u4e2d\u7d22\u5f15\u7684\u5b50\u96c6\uff0c\u53d6\u51b3\u4e8e\u66f4\u65b0\u65f6\u8fd9\u4e2a\u952e\u7684\u5f71\u54cd\n// \u6ce8\u610f\uff1a\u5982\u679c\u5199\u5165\u64cd\u4f5c\u4e2d\u6d89\u53ca\u7684\u6587\u6863\u5305\u542b\u5728\u7d22\u5f15\u4e2d\uff0cMongoDB\u5219\u4ec5\u66f4\u65b0sparse\u6216partial\u7d22\u5f15(sparse\u548cpartial\u4e3aMongoDB\u7684\u7d22\u5f15\u7c7b\u578b)\n\n\u67d0\u4e9b\u66f4\u65b0\u64cd\u4f5c\u53ef\u80fd\u589e\u52a0\u6587\u6863\u7684\u5927\u5c0f\u3002\u5982:\u5411\u6587\u6863\u589e\u52a0\u5b57\u6bb5\u3002\u5bf9\u4e8eMMAPv1\u5f15\u64ce\uff0c\u5982\u679c\u66f4\u65b0\u64cd\u4f5c\u5bfc\u81f4\u6587\u6863\u8d85\u8fc7\u5f53\u524d\u5206\u914d\u7684\u8bb0\u5f55\u5927\u5c0f\u3002MongoDB\u4f1a\u5c06\u6587\u6863\u91cd\u65b0\u5b9a\u4f4d\u5230\u78c1\u76d8\u4e0a\u3002\u5e76\u7559\u6709\u8db3\u591f\u7684\u8fde\u7eed\u7a7a\u95f4\u6765\u4fdd\u5b58\u6587\u6863\u3002\u9700\u8981\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u6bd4\u6ca1\u6709\u91cd\u5b9a\u4f4d\u7684\u66f4\u65b0\u82b1\u8d39\u7684\u65f6\u95f4\u66f4\u957f\uff0c\u7279\u522b\u662f\u5728\u96c6\u5408\u5177\u6709\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\u3002\u5982\u679c\u96c6\u5408\u5177\u6709\u7d22\u5f15\uff0cMongoDB\u5fc5\u987b\u66f4\u65b0\u6240\u6709\u7d22\u5f15\u6761\u76ee\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u5177\u6709\u8bb8\u591a\u7d22\u5f15\u7684\u96c6\u5408\uff0c\u6b64\u79fb\u52a8\u5c06\u5f71\u54cd\u5199\u5165\u541e\u5410\u91cf\n\n// explain\u7ed3\u679c\nStages\u63cf\u8ff0\u4e86\u64cd\u4f5c--\u5982\uff1a\nCOLLSCAN          \u7528\u4e8e\u96c6\u5408\u626b\u63cf\nIXSCAN            \u7528\u4e8e\u626b\u63cf\u7d22\u5f15\u952e\nFETCH             \u7528\u4e8e\u68c0\u7d22\u6587\u6863\nSHARD_MERGE       \u7528\u4e8e\u5408\u5e76\u5206\u7247\u7684\u7ed3\u679c\nSHARDING_FILTER   \u7528\u4e8e\u4ece\u5206\u7247\u4e2d\u8fc7\u6ee4\u6389\u5b64\u7acb\u6587\u6863\n\n// explain result\nexplain.queryPlanner    // \u5305\u542b\u67e5\u8be2\u4f18\u5316\u5668\u9009\u62e9\u67e5\u8be2\u8ba1\u5212\u7684\u4fe1\u606f\nexplain.queryPlanner.namespace  //\n\n// \u5206\u6790\u67e5\u8be2\u6027\u80fd\n\u5229\u7528cursor.explain(\"executionStats\")\u548cdb.collection.explain(\"executionStats\")\u65b9\u6cd5\u67e5\u770b\u6709\u5173\u67e5\u8be2\u6027\u80fd\u7684\u7edf\u8ba1\u4fe1\u606f\n\n1. queryPlanner.winningPlan.stage // COLLSCAN\u8868\u793a\u96c6\u5408\u626b\u63cf\uff0c\u4e5f\u5c31\u8868\u660emongod\u5fc5\u987b\u626b\u63cf\u6574\u4e2a\u96c6\u5408\u6587\u6863\u6765\u8bc6\u522b\u7ed3\u679c\n2. executionStats.nReturned // \u663e\u793a3\uff0c\u8868\u660e\u67e5\u8be2\u5339\u914d\u5230\u4e09\u4e2a\u6587\u6863\n3. executionStats.totalKeysExamined   // \u663e\u793a0\uff0c\u8868\u660e\u6b64\u67e5\u8be2\u672a\u7528\u5230\u7d22\u5f15\n4. executionStats.totalDocsExamined   // \u663e\u793a10\uff0c\u8868\u660eMongoDB\u5fc5\u987b\u626b\u63cf\u7684\u6587\u6863\u6570\u91cf(\u6b64\u5904\u4e3a10\u4e2a)\u624d\u80fd\u67e5\u627e\u5230\u548c\u6761\u4ef6\u5339\u914d\u76f8\u7b26\u7684\u6587\u6863\n5. queryPlanner.winningPlan.inputStage.stage  // \u663e\u793aIXSCAN\u8868\u793a\u6b64\u67e5\u8be2\u4f7f\u7528\u7d22\u5f15\n\n// \u6bd4\u8f83\u7d22\u5f15\u6027\u80fd\n\u624b\u52a8\u6bd4\u8f83\u4f7f\u7528\u591a\u4e2a\u7d22\u5f15\u67e5\u8be2\u7684\u6027\u80fd\uff0c\u53ef\u4ee5hint()\u548cexplain()\u65b9\u6cd5\u7ed3\u5408\u4f7f\u7528\uff0c\u6dfb\u52a0\u590d\u5408\u7d22\u5f15\u65f6\uff0c\u5b57\u6bb5\u7684\u987a\u5e8f\u975e\u5e38\u91cd\u8981\uff1b\u987a\u5e8f\u4e0d\u540c\u53ef\u80fd\u4f1a\u5bf9\u67e5\u8be2\u9020\u6210\u7684\u5f71\u54cd\u4e0d\u540c\uff0c\u6027\u80fd\u4ea7\u751f\u5dee\u5f02\uff1b\u4f8b\u5982\uff1a\ndb.collection.createIndex( { quantity: 1, type: 1 } ) // \u7d22\u5f15\u5148\u6309quantity\u5b57\u6bb5\u6392\u5e8f\uff0c\u7136\u540e\u6309\u7167type\u5b57\u6bb5\u6392\u5e8f\ndb.collection.createIndex( { type: 1, quantity: 1 } ) // \u7d22\u5f15\u5148type\u5b57\u6bb5\u6392\u5e8f\uff0c\u518d\u6309quantity\u5b57\u6bb5\u6392\u5e8f\n\n// Tailable Cursors\n\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u67e5\u8be2\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u4f1a\u5173\u95ed\u8fd4\u56de\u7684\u6570\u636ecursor\uff0cTailable Cursors\u7c7b\u4f3c\u4e8etail -f\u547d\u4ee4\u3002\u4f5c\u7528\u5728capped\u96c6\u5408\u4e0a\uff0c\u5f53\u5ba2\u6237\u7aef\u6709\u65b0\u7684\u6587\u6863\u63d2\u5165\u5230capped\u96c6\u5408\u65f6\uff0ctailable\u6e38\u6807\u5c06\u7ee7\u7eed\u68c0\u7d22\u6587\u6863\u3002MongoDB\u526f\u672c\u96c6\u5c31\u4f7f\u7528tailable\u6e38\u6807\u6765\u8ddf\u8e2a\u4e3b\u8282\u70b9\u7684oplog\n\n\u6ce8\u610f\uff1a\u5982\u679c\u67e5\u8be2\u5b57\u6bb5\u4f4d\u4e8e\u7d22\u5f15\u5b57\u6bb5\uff0c\u4e0d\u8981\u4f7f\u7528tailable\u6e38\u6807\uff0c\u4f7f\u7528\u5e38\u89c4\u6e38\u6807\u5373\u53ef\uff0c\u8ddf\u8e2a\u67e5\u8be2\u8fd4\u56de\u7684\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002\u8981\u68c0\u7d22\u65b0\u6dfb\u52a0\u7684\u6587\u6863\uff0c\u8bf7\u4f7f\u7528\u67e5\u8be2\u6761\u4ef6\u4e2d\u7d22\u5f15\u5b57\u6bb5\u7684\u6700\u540e\u4e00\u4e2a\u503c\u518d\u6b21\u67e5\u8be2\u96c6\u5408\u3002\u4f8b\u5982\uff1adb.collection.find( { indexedField: { $gt: lastvalue } } )\n\n\u8003\u8651\u4ee5\u4e0b\u4e0etailable\u6e38\u6807\u76f8\u5173\u7684\u884c\u4e3a\uff1a\n1. Tailable\u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\u5e76\u6309\u81ea\u7136\u987a\u5e8f\u8fd4\u56de\u6587\u6863\n2. \u7531\u4e8etailable\u6e38\u6807\u4e0d\u4f7f\u7528\u7d22\u5f15\uff0c\u56e0\u6b64\u67e5\u8be2\u7684\u521d\u59cb\u626b\u63cf\u5f00\u9500\u5f88\u5927\uff0c\u4f46\u5728\u540e\u7eed\u7684\u65b0\u6dfb\u52a0\u6587\u6863\u68c0\u7d22\u6d88\u8017\u5f88\u5c0f\n3. \u4ee5\u4e0b\u60c5\u51b5Tailable\u6e38\u6807\u53ef\u80fd\u4f1a\u6b7b\u4ea1\u6216\u8005\u65e0\u6548\uff1a\n  * \u67e5\u8be2\u8fd4\u56de\u4e0d\u5339\u914d\n  * \u6e38\u6807\u8fd4\u56de\u96c6\u5408\"end\"\u5904\u7684\u6587\u6863\uff0c\u7136\u540e\u5e94\u7528\u7a0b\u5e8f\u5220\u9664\u4e86\u8be5\u6587\u6863\n  \u4e00\u4e2a\u6b7b\u4ea1\u7684cursor\u6709\u4e00\u4e2aid\u4e3a0\n</code></pre>"},{"location":"database/MongoDB/#aggregation","title":"\u805a\u5408(Aggregation)","text":"<p>\u805a\u5408\u64cd\u4f5c\u5c06\u6765\u81ea\u591a\u4e2a\u6587\u6863\u7684\u503c\u7ec4\u5408\u4e00\u8d77\uff0c\u5e76\u4e14\u5bf9\u5206\u7ec4\u6570\u636e\u6267\u884c\u5404\u79cd\u64cd\u4f5c\u540e\u8fd4\u56de\u5355\u4e2a\u7ed3\u679c\u3002MongoDB\u4e09\u79cd\u6267\u884c\u805a\u5408\u7684\u65b9\u5f0f\uff1a\u805a\u5408\u7ba1\u9053\u3001map-reduce\u51fd\u6570\u548c\u5355\u7528\u9014(single purpose)\u805a\u5408\u65b9\u6cd5</p>"},{"location":"database/MongoDB/#_13","title":"\u805a\u5408\u7ba1\u9053","text":"<p>\u6700\u57fa\u672c\u7684\u7ba1\u9053\u9636\u6bb5\u662f\u8fc7\u6ee4\u5668\uff0c\u64cd\u4f5c\u7c7b\u4f3c\u4e8e\u67e5\u8be2\u548c\u6587\u6863\u8f6c\u6362\u3002\u5176\u4ed6\u7ba1\u9053\u64cd\u4f5c\u63d0\u4f9b\u4e86\u6309\u7279\u5b9a\u5b57\u6bb5\u6216\u5b57\u6bb5\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\u548c\u6392\u5e8f\u7684\u5de5\u5177\u4ee5\u53ca\u7528\u4e8e\u805a\u5408\u6570\u7ec4\u5185\u5bb9\u7684\u5de5\u5177\uff0c\u5305\u62ec\u6587\u6863\u4e2d\u7684\u6570\u7ec4\u3002\u6b64\u65b9\u5f0f\u662fMongoDB\u6570\u636e\u805a\u5408\u7684\u9996\u9009\u65b9\u6cd5</p> <p>map-reduce\u51fd\u6570\uff1a\u901a\u5e38\uff0cmap-reduce\u64cd\u4f5c\u6709\u4e24\u4e2a\u9636\u6bb5\uff1a\u4e00\u4e2amap\u9636\u6bb5\uff0c\u5b83\u5904\u7406\u6bcf\u4e2a\u6587\u6863\u5e76\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u53d1\u51fa\u4e00\u4e2a\u6216\u591a\u4e2a\u5bf9\u8c61\uff0c\u5e76\u51cf\u5c11\u7ec4\u5408map\u64cd\u4f5c\u8f93\u51fa\u7684\u9636\u6bb5\u3002\u53ef\u9009\u5730\uff0cmap-reduce\u53ef\u4ee5\u5177\u6709 \u6700\u7ec8\u5316\u9636\u6bb5\u4ee5\u5bf9\u7ed3\u679c\u8fdb\u884c\u6700\u7ec8\u4fee\u6539\u3002\u4e0e\u5176\u4ed6\u805a\u5408\u64cd\u4f5c\u4e00\u6837\uff0cmap-reduce\u53ef\u4ee5\u6307\u5b9a\u67e5\u8be2\u6761\u4ef6\u4ee5\u9009\u62e9\u8f93\u5165\u6587\u6863\u4ee5\u53ca\u6392\u5e8f\u548c\u9650\u5236\u7ed3\u679c\u3002Map-reduce\u4f7f\u7528\u81ea\u5b9a\u4e49JavaScript\u51fd\u6570\u6765\u6267\u884c\u6620\u5c04\u548c\u51cf\u5c11\u64cd\u4f5c\uff0c\u4ee5\u53ca\u53ef\u9009\u7684finalize\u64cd\u4f5c\u3002\u867d\u7136\u81ea\u5b9a\u4e49JavaScript\u4e0e\u805a\u5408\u7ba1\u9053\u76f8\u6bd4\u63d0\u4f9b\u4e86\u6781\u5927\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u901a\u5e38\uff0cmap-reduce\u6bd4\u805a\u5408\u7ba1\u9053\u6548\u7387\u66f4\u4f4e\uff0c\u66f4\u590d\u6742 map-reduce</p> <p>\u5355\u7528\u9014\u805a\u5408\u64cd\u4f5c\uff1aMongoDB\u6709db.collection.estimatedDocumentCount()\uff0cdb.collection.count()\u548cdb.collection.distinct(),\u8fd9\u4e9b\u64cd\u4f5c\u805a\u5408\u90fd\u53ea\u80fd\u805a\u5408\u6765\u81ea\u5355\u4e2a\u96c6\u5408\u7684\u6587\u6863</p> Markdown<pre><code>\u805a\u5408\u7ba1\u9053\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\uff1a\u67d0\u4e9b\u9636\u6bb5\u5c06\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u64cd\u4f5c\u6570\uff0c\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u6307\u5b9a\u8981\u5e94\u7528\u4e8e\u8f93\u5165\u6587\u6863\u7684\u8f6c\u6362\u3002\u8868\u8fbe\u5f0f\u5177\u6709\u6587\u6863\u7ed3\u6784\u4e14\u5305\u542b\u5176\u4ed6\u8868\u8fbe\u5f0f\n\u6d41\u6c34\u7ebf\u8868\u8fbe\u5f0f\u53ea\u80fd\u64cd\u4f5c\u5728\u5f53\u524d\u6d41\u6c34\u7ebf\u7684\u6587\u6863\u5e76\u4e14\u4e0d\u80fd\u5f15\u7528\u5176\u4ed6\u6587\u6863\u4e2d\u7684\u6570\u636e\u3002\u8868\u8fbe\u5f0f\u63d0\u4f9b\u6587\u6863\u7684\u5185\u5b58\u4e2d\u8f6c\u6362\u64cd\u4f5c\u3002\u901a\u5e38\uff0c\u5f53\u805a\u5408\u8fc7\u7a0b\u5e26\u6709\u4e00\u4e2a\u4f8b\u5916\uff1aaccumulator\u8868\u8fbe\u5f0f\uff0c\u8868\u8fbe\u5f0f\u662f\u65e0\u72b6\u6001\u7684\u3002\u4ec5\u8fdb\u884c\u8bc4\u4f30\n\u8fd9\u4e2a\u7d2f\u52a0\u5668\u7528\u5728$group\u9636\u6bb5\uff0c\u4fdd\u6301\u5176\u72b6\u6001(\u4f8b\u5982\uff1atotals,maximums,minimums\u548crelated data)\u901a\u8fc7\u6d41\u6c34\u7ebf\u4f5c\u4e3a\u6587\u6863\u5904\u7406\u8fdb\u7a0b\n\u5728$project\u9636\u6bb5\u4f7f\u7528\u4e00\u4e9b\u7d2f\u52a0\u5668\uff0c\u4f46\u5728\u6b64\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u7d2f\u52a0\u5668\u4e0d\u4f1a\u5728\u6587\u6863\u4e2d\u4fdd\u6301\u5176\u72b6\u6001\n\n\u4f7f\u7528\u4ee5\u4e0b\u64cd\u4f5c\u53ef\u4ee5\u907f\u514d\u626b\u63cf\u6574\u4e2a\u96c6\u5408\uff1a\n\u6d41\u6c34\u7ebf\u64cd\u4f5c\u7b26\u548c\u7d22\u5f15\uff1a\u5f53$match\u548c$sort\u51fa\u73b0\u5728\u7ba1\u9053\u6d41\u6c34\u7ebf\u8d77\u59cb\u4f4d\u7f6e\u53ef\u4ee5\u5229\u7528\u7d22\u5f15\u7684\u4f18\u52bf\u3002$GeoNear\u7ba1\u9053\u5219\u53ef\u4ee5\u6709\u4e00\u4e2a\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u7684\u4f18\u52bf\uff0c\u5f53\u4f7f\u7528$geoNear\u65f6\uff0c\u5176\u5fc5\u987b\u5728\u805a\u5408\u7ba1\u9053\u64cd\u4f5c\u4e2d\u7684\u7b2c\u4e00\u4e2a\u9636\u6bb5\n\n\u9650\u5236\uff1a\u805a\u5408\u7ba1\u9053\u5bf9\u503c\u7c7b\u578b\u548c\u7ed3\u679c\u5927\u5c0f\u6709\u4e00\u5b9a\u7684\u9650\u5236\n\n \u805a\u5408\u7ba1\u9053\u4f18\u5316\uff1a\nProjection\u4f18\u5316\uff1a\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u786e\u5b9a\u5b83\u662f\u5426\u4ec5\u9700\u8981\u6587\u6863\u4e2d\u5b57\u6bb5\u7684\u5b50\u96c6\u6765\u83b7\u5f97\u7ed3\u679c\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u7ba1\u9053\u5c06\u53ea\u4f7f\u7528\u90a3\u4e9b\u5fc5\u9700\u7684\u5b57\u6bb5\uff0c\u51cf\u5c11\u901a\u8fc7\u7ba1\u9053\u7684\u6570\u636e\u91cf\n\u6d41\u6c34\u7ebf\u5e8f\u5217\u5316\u4f18\u5316\uff1a$project\u6216$addFields + $match\u5e8f\u5217\u4f18\u5316\uff1b\u5bf9\u4e8e\u5305\u542bprojection\u9636\u6bb5($project\u6216$addFields)\u540e\u9762\u8ddf\u7740\u4e00\u4e2a$match\u9636\u6bb5\u7684\u805a\u5408\u6d41\u6c34\u7ebf\uff0c\u5728projection\u4e4b\u524dMongoDB\u79fb\u52a8$match\u9636\u6bb5\u4e2d\u4efb\u4f55\u8fc7\u6ee4\u5668\u4e0d\u9700\u8981\u5728projection\u9636\u6bb5\u8ba1\u7b97\u7684\u503c\u7ed9\u4e00\u4e2a\u65b0\u7684$match\u9636\u6bb5\n\n\u805a\u5408\u7ba1\u9053\u9650\u5236\uff1a\n\u4f7f\u7528aggregate\u547d\u4ee4\u7684\u805a\u5408\u64cd\u4f5c\u5177\u6709\u4ee5\u4e0b\u9650\u5236\uff1a\n1. \u7ed3\u679c\u5927\u5c0f\u9650\u5236\uff1a\u6b64aggregate\u547d\u4ee4\u53ef\u4ee5\u8fd4\u56de\u6e38\u6807\u6216\u5c06\u7ed3\u679c\u5b58\u50a8\u5728\u96c6\u5408\u4e2d\u3002\u76ee\u524d16M\n2. \u5185\u5b58\u9650\u5236\uff1a\u7ba1\u9053\u9636\u6bb5\u7684RAM\u9650\u5236\u4e3a100M\uff0c\u5982\u679c\u67d0\u4e2a\u9636\u6bb5\u8d85\u8fc7\u6b64\u9650\u5236\uff0c\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u5141\u8bb8\u5904\u7406\u5927\u578b\u6570\u636e\u96c6\uff0c\u4f7f\u7528allowDishUse\u9009\u9879\u5c06\u6570\u636e\u5199\u5165\u5230\u4e34\u65f6\u6587\u4ef6\n\n$groupLookkup\u9636\u6bb5\u5fc5\u987b\u4fdd\u6301\u5728100M\u7684\u5185\u5b58\u9650\u5236\u4e2d\uff0c\u5982\u679callowDishUse: true\u6307\u5b9a\u5728aggregate()\u64cd\u4f5c\uff0c$graphLookup\u9636\u6bb5\u4f1a\u5ffd\u7565\u6b64\u9009\u9879\u3002\u5982\u679c\u6709\u5176\u4ed6\u9636\u6bb5\u5728aggregate()\u64cd\u4f5c\u4e2d\uff0callowDiskUse: true\u9009\u9879\u5c06\u5f71\u54cd\u8fd9\u4e9b\u9636\u6bb5\n\n\u805a\u5408\u7ba1\u9053\u548c\u5206\u7247\u96c6\u5408\uff1a\n\u5982\u679c\u7ba1\u9053\u7684\u5f00\u59cb\u5728\u5206\u7247\u952e\u6709\u4e00\u4e2a\u786e\u5207\u7684$match\uff0c\u5219\u6574\u4e2a\u7ba1\u9053\u4ec5\u5728\u5339\u914d\u7684\u5206\u7247\u4e0a\u8fd0\u884c\u3002\u5bf9\u4e8e\u5fc5\u987b\u5728\u591a\u4e2a\u5206\u7247\u4e0a\u8fd0\u884c\u7684\u805a\u5408\u64cd\u4f5c\u3002\u5982\u679c\u64cd\u4f5c\u4e0d\u9700\u8981\u5728\u6570\u636e\u5e93\u4e3b\u5206\u7247\u8fd0\u884c\uff0c\u5219\u8fd9\u4e9b\u64cd\u4f5c\u4f1a\u5c06\u7ed3\u679c\u8def\u7531\u5230\u968f\u673a\u7684\u5206\u7247\u4e0a\u6765\u5408\u5e76\u7ed3\u679c\uff0c\u907f\u514d\u4f7f\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u8d85\u8f7d\u3002$out\u548c$lookup\u9636\u6bb5\u9700\u8981\u5728\u6570\u636e\u5e93\u7684\u4e3b\u5206\u7247\u4e0a\u8fd0\u884c\n\n\u5728\u5c06\u805a\u5408\u7ba1\u9053\u5206\u6210\u4e24\u90e8\u5206\u65f6\uff0c\u7ba1\u9053\u88ab\u62c6\u5206\u4ee5\u786e\u4fdd\u5206\u7247\u5728\u8003\u8651\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u5c3d\u53ef\u80fd\u591a\u7684\u9636\u6bb5\uff1b\u4f18\u5316\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7248\u672c\u4e4b\u95f4\u53d1\u751f\u53d8\u5316\n</code></pre>"},{"location":"database/MongoDB/#map-reduce","title":"Map-Reduce","text":""},{"location":"database/MongoDB/#_14","title":"\u805a\u5408\u53c2\u8003","text":"<p>\u805a\u5408\u7ba1\u9053\u5feb\u901f\u53c2\u8003\uff1aStages(db.collection.aggregate)\u9664\u4e86\\(out\u548c\\)geoNear\u9636\u6bb5\u90fd\u53ef\u4ee5\u5728\u7ba1\u9053\u4e2d\u591a\u6b21\u51fa\u73b0</p>"},{"location":"database/MongoDB/#stagesdbcollectionaggregate","title":"Stages(db.collection.aggregate)","text":"\u9636\u6bb5 \u63cf\u8ff0 $addFields \u5411\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\u3002\u7c7b\u4f3c\u4e8e\u00a0\\(project\uff0c\\)addFields\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863;\u00a0\u5177\u4f53\u800c\u8a00\uff0c\u901a\u8fc7\u5411\u8f93\u51fa\u6587\u6863\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u8be5\u6587\u6863\u5305\u542b\u8f93\u5165\u6587\u6863\u7684\u73b0\u6709\u5b57\u6bb5\u548c\u65b0\u6dfb\u52a0\u5b57\u6bb5 $bucket \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u548c\u5b58\u50a8\u533a\u8fb9\u754c\uff0c\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7ec4\uff0c\u79f0\u4e3a\u5b58\u50a8\u6876 $bucketAuto \u6839\u636e\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5c06\u4f20\u5165\u7684\u6587\u6863\u5206\u7c7b\u4e3a\u7279\u5b9a\u6570\u91cf\u7684\u7ec4\uff08\u79f0\u4e3a\u5b58\u50a8\u6876\uff09\u3002\u81ea\u52a8\u786e\u5b9a\u5b58\u50a8\u6876\u8fb9\u754c\uff0c\u4ee5\u5c1d\u8bd5\u5c06\u6587\u6863\u5747\u5300\u5730\u5206\u914d\u5230\u6307\u5b9a\u6570\u91cf\u7684\u5b58\u50a8\u6876\u4e2d $collStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u6216\u89c6\u56fe\u7684\u7edf\u8ba1\u4fe1\u606f $count \u8fd4\u56de\u805a\u5408\u7ba1\u9053\u6b64\u9636\u6bb5\u7684\u6587\u6863\u6570\u91cf\u8ba1\u6570 $facet \u5728\u540c\u4e00\u7ec4\u8f93\u5165\u6587\u6863\u7684\u5355\u4e2a\u9636\u6bb5\u5185\u5904\u7406\u591a\u4e2a\u805a\u5408\u7ba1\u9053\u3002\u652f\u6301\u521b\u5efa\u80fd\u591f\u5728\u5355\u4e2a\u9636\u6bb5\u4e2d\u8de8\u591a\u4e2a\u7ef4\u5ea6\u6216\u65b9\u9762\u8868\u5f81\u6570\u636e\u7684\u591a\u9762\u805a\u5408 $geoNear \u57fa\u4e8e\u4e0e\u5730\u7406\u7a7a\u95f4\u70b9\u7684\u63a5\u8fd1\u5ea6\u8fd4\u56de\u6709\u5e8f\u7684\u6587\u6863\u6d41\u3002\u96c6\u6210\u7684\u529f\u80fd\u00a0\\(match\uff0c\\)sort\u4ee5\u53ca$limit\u5730\u7406\u7a7a\u95f4\u6570\u636e\u3002\u8f93\u51fa\u6587\u6863\u5305\u62ec\u9644\u52a0\u8ddd\u79bb\u5b57\u6bb5\uff0c\u5e76\u4e14\u53ef\u4ee5\u5305\u62ec\u4f4d\u7f6e\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 $graphLookup \u5bf9\u96c6\u5408\u6267\u884c\u9012\u5f52\u641c\u7d22\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\uff0c\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u6570\u7ec4\u5b57\u6bb5\uff0c\u5176\u4e2d\u5305\u542b\u8be5\u6587\u6863\u7684\u9012\u5f52\u641c\u7d22\u7684\u904d\u5386\u7ed3\u679c\u3002 $group \u6309\u6307\u5b9a\u7684\u6807\u8bc6\u7b26\u8868\u8fbe\u5f0f\u5bf9\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u5c06\u7d2f\u52a0\u5668\u8868\u8fbe\u5f0f\uff08\u5982\u679c\u5df2\u6307\u5b9a\uff09\u5e94\u7528\u4e8e\u6bcf\u4e2a\u7ec4\u3002\u6d88\u8017\u6240\u6709\u8f93\u5165\u6587\u6863\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u4e0d\u540c\u7684\u7ec4\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002\u8f93\u51fa\u6587\u6863\u4ec5\u5305\u542b\u6807\u8bc6\u7b26\u5b57\u6bb5\uff0c\u5982\u679c\u6307\u5b9a\uff0c\u5219\u5305\u542b\u7d2f\u79ef\u5b57\u6bb5\u3002 $indexStats \u8fd4\u56de\u6709\u5173\u96c6\u5408\u7684\u6bcf\u4e2a\u7d22\u5f15\u7684\u4f7f\u7528\u7684\u7edf\u8ba1\u4fe1\u606f\u3002 $limit \u5c06\u672a\u4fee\u6539\u7684\u524dn\u4e2a\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u9650\u5236\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u96f6\u6587\u6863\uff08\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $listSessions \u5217\u51fa\u6d3b\u52a8\u65f6\u95f4\u8db3\u4ee5\u4f20\u64ad\u5230system.sessions\u96c6\u5408\u7684\u6240\u6709\u4f1a\u8bdd\u3002 $lookup \u5bf9\u540c\u4e00\u6570\u636e\u5e93\u4e2d\u7684\u53e6\u4e00\u4e2a\u96c6\u5408\u6267\u884c\u5de6\u5916\u8fde\u63a5\uff0c\u4ee5\u00a0\u4ece\u201c\u5df2\u8fde\u63a5\u201d\u96c6\u5408\u4e2d\u8fc7\u6ee4\u6587\u6863\u4ee5\u8fdb\u884c\u5904\u7406\u3002 $match \u8fc7\u6ee4\u6587\u6863\u6d41\u4ee5\u4ec5\u5141\u8bb8\u5339\u914d\u7684\u6587\u6863\u672a\u7ecf\u4fee\u6539\u5730\u4f20\u9012\u5230\u4e0b\u4e00\u4e2a\u7ba1\u9053\u9636\u6bb5\u3002\u00a0$match\u4f7f\u7528\u6807\u51c6\u7684MongoDB\u67e5\u8be2\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\uff08\u5339\u914d\uff09\u6216\u96f6\u6587\u6863\uff08\u4e0d\u5339\u914d\uff09\u3002 $out \u5c06\u805a\u5408\u7ba1\u9053\u7684\u7ed3\u679c\u6587\u6863\u5199\u5165\u96c6\u5408\u3002\u8981\u4f7f\u7528$out\u821e\u53f0\uff0c\u5b83\u5fc5\u987b\u662f\u7ba1\u9053\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u9636\u6bb5\u3002 $project \u91cd\u65b0\u6574\u5f62\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\uff0c\u4f8b\u5982\u6dfb\u52a0\u65b0\u5b57\u6bb5\u6216\u5220\u9664\u73b0\u6709\u5b57\u6bb5\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $redact \u901a\u8fc7\u57fa\u4e8e\u6587\u6863\u672c\u8eab\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\u9650\u5236\u6bcf\u4e2a\u6587\u6863\u7684\u5185\u5bb9\u6765\u91cd\u5851\u6d41\u4e2d\u7684\u6bcf\u4e2a\u6587\u6863\u3002\u5305\u542b$project\u548c\u7684\u529f\u80fd\u00a0$match\u3002\u53ef\u7528\u4e8e\u5b9e\u73b0\u5b57\u6bb5\u7ea7\u522b\u7684\u7f16\u8f91\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6216\u96f6\u4e2a\u6587\u6863\u3002 $replaceRoot \u7528\u6307\u5b9a\u7684\u5d4c\u5165\u6587\u6863\u66ff\u6362\u6587\u6863\u3002\u8be5\u64cd\u4f5c\u5c06\u66ff\u6362\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6240\u6709\u73b0\u6709\u5b57\u6bb5\uff0c\u5305\u62ec_id\u5b57\u6bb5\u3002\u6307\u5b9a\u5d4c\u5165\u5728\u8f93\u5165\u6587\u6863\u4e2d\u7684\u6587\u6863\u4ee5\u5c06\u5d4c\u5165\u6587\u6863\u63d0\u5347\u5230\u9876\u5c42\u3002 $sample \u4ece\u8f93\u5165\u4e2d\u968f\u673a\u9009\u62e9\u6307\u5b9a\u6570\u91cf\u7684\u6587\u6863\u3002 $skip \u8df3\u8fc7\u524dn\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6307\u5b9a\u7684\u8df3\u8fc7\u7f16\u53f7\uff0c\u5e76\u5c06\u672a\u4fee\u6539\u7684\u5176\u4f59\u6587\u6863\u4f20\u9012\u7ed9\u7ba1\u9053\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u96f6\u6587\u6863\uff08\u5bf9\u4e8e\u524dn\u4e2a\u6587\u6863\uff09\u6216\u4e00\u4e2a\u6587\u6863\uff08\u5982\u679c\u5728\u524dn\u4e2a\u6587\u6863\u4e4b\u540e\uff09\u3002 $sort \u6309\u6307\u5b9a\u7684\u6392\u5e8f\u952e\u91cd\u65b0\u6392\u5e8f\u6587\u6863\u6d41\u3002\u53ea\u6709\u8ba2\u5355\u6539\u53d8;\u00a0\u6587\u4ef6\u4fdd\u6301\u4e0d\u53d8\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fa\u4e00\u4e2a\u6587\u6863\u3002 $sortByCount \u6839\u636e\u6307\u5b9a\u8868\u8fbe\u5f0f\u7684\u503c\u5bf9\u4f20\u5165\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u8ba1\u7b97\u6bcf\u4e2a\u4e0d\u540c\u7ec4\u4e2d\u7684\u6587\u6863\u8ba1\u6570\u3002 $unwind \u4ece\u8f93\u5165\u6587\u6863\u89e3\u6784\u6570\u7ec4\u5b57\u6bb5\u4ee5\u8f93\u51fa\u6bcf\u4e2a\u5143\u7d20\u7684\u6587\u6863\u3002\u6bcf\u4e2a\u8f93\u51fa\u6587\u6863\u90fd\u4f7f\u7528\u5143\u7d20\u503c\u66ff\u6362\u6570\u7ec4\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\uff0c\u8f93\u51fan\u4e2a\u6587\u6863\uff0c\u5176\u4e2dn\u662f\u6570\u7ec4\u5143\u7d20\u7684\u6570\u91cf\uff0c\u5bf9\u4e8e\u7a7a\u6570\u7ec4\uff0c\u53ef\u4ee5\u4e3a\u96f6\u3002"},{"location":"database/MongoDB/#stagesdbaggregate","title":"Stages(db.aggregate)","text":"<p>MongoDB\u8fd8\u63d0\u4f9bdb.aggregate\u65b9\u6cd5\uff1a</p> \u540d\u79f0 \u63cf\u8ff0 $currentOp \u8fd4\u56de\u6709\u5173MongoDB\u90e8\u7f72\u7684\u6d3b\u52a8 \u548c/\u6216 \u4f11\u7720\u64cd\u4f5c\u7684\u4fe1\u606f $listLocalSessions \u5217\u51fa\u6700\u8fd1\u5728\u5f53\u524d\u8fde\u63a5mongos\u6216mongod\u5b9e\u4f8b\u4e0a\u7684\u6240\u6709\u6d3b\u52a8\u56de\u8bdd\uff0c\u8fd9\u4e9b\u4f1a\u8bdd\u4e0d\u4e00\u5b9a\u90fd\u4f20\u5230system.sessions\u96c6\u5408\u4e2d <p>\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5305\u62ec\u5b57\u6bb5\u8def\u5f84\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u6587\u5b57\uff0c \u8868\u8fbe\u5f0f\u5bf9\u8c61\u548c \u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u3002\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5d4c\u5957</p>"},{"location":"database/MongoDB/#_15","title":"\u5e03\u5c14\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"<p>\u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u8ba1\u7b97\u4e3a\u5e03\u5c14\u503c\uff0c\u5e76\u8fd4\u56de\u5e03\u5c14\u503c\u4f5c\u4e3a\u7ed3\u679c\u3002\u9664\u4e86false\u5e03\u5c14\u503c\uff0c\u5e03\u5c14\u8868\u8fbe\u5f0f\u4e3afalse\u5982\u4e0b\uff1anull\uff0c0\uff0c\u548cundefined \u7684\u503c\u3002\u5e03\u5c14\u8868\u8fbe\u5f0f\u5c06\u6240\u6709\u5176\u4ed6\u503c\u8ba1\u7b97\u4e3atrue\uff0c\u5305\u62ec\u975e\u96f6\u6570\u503c\u548c\u6570\u7ec4</p> \u540d\u79f0 \u63cf\u8ff0 $and \u4ec5\u5728\u5176\u6240\u6709\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue,\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $not \u8fd4\u56de\u4e0e\u5176\u53c2\u6570\u8868\u8fbe\u5f0f\u76f8\u53cd\u7684\u5e03\u5c14\u503c\uff0c\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $or \u5f53\u4efb\u4f55\u8868\u8fbe\u5f0f\u6c42\u503c\u4e3atrue\u65f6\uff0c\u8fd4\u56detrue\uff0c\u5141\u8bb8\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f"},{"location":"database/MongoDB/#_16","title":"\u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"<p>\u6bd4\u8f83\u8868\u8fbe\u5f0f\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u9664\u4e86$cmp\u8fd4\u56de\u4e00\u4e2a\u6570\u5b57\u3002\u6bd4\u8f83\u8868\u8fbe\u5f0f\u91c7\u7528\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u5e76\u6bd4\u8f83\u503c\u548c\u7c7b\u578b\uff0c\u4f7f\u7528\u6307\u5b9a\u7684BSON\u6bd4\u8f83\u987a\u5e8f\u6765\u8868\u793a\u4e0d\u540c\u7c7b\u578b\u7684\u503c</p> \u540d\u79f0 \u63cf\u8ff0 $cmp \u8fd4\u56de0\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u76f8\u7b49\u7684\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6240\u8ff0\u7b2c\u4e8c\u503c\uff0c\u4ee5\u53ca-1\u6bd4\u6240\u8ff0\u7b2c\u4e8c\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u662f\u4ee5\u4e0b\u3002 $eq \u8fd4\u56detrue\u503c\u662f\u5426\u76f8\u7b49\u3002 $gt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $gte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lt true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $lte true\u5982\u679c\u7b2c\u4e00\u4e2a\u503c\u5c0f\u4e8e\u6216\u7b49\u4e8e\u7b2c\u4e8c\u4e2a\u503c\uff0c\u5219\u8fd4\u56de\u3002 $ne true\u5982\u679c\u503c\u4e0d\u76f8\u7b49\u5219\u8fd4\u56de\u3002"},{"location":"database/MongoDB/#_17","title":"\u6761\u4ef6\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $cond \u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\uff0c\u7528\u4e8e\u8ba1\u7b97\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u8fd4\u56de\u5176\u4ed6\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4e4b\u4e00\u7684\u503c\u3002\u63a5\u53d7\u6709\u5e8f\u5217\u8868\u4e2d\u7684\u4e09\u4e2a\u8868\u8fbe\u5f0f\u6216\u4e09\u4e2a\u547d\u540d\u53c2\u6570\u3002 $ifNull \u5982\u679c\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5bfc\u81f4null\u7ed3\u679c\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u975enull\u7ed3\u679c\u6216\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u7a7a\u7ed3\u679c\u5305\u542b\u672a\u5b9a\u4e49\u503c\u6216\u7f3a\u5c11\u5b57\u6bb5\u7684\u5b9e\u4f8b\u3002\u63a5\u53d7\u4e24\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u53c2\u6570\u3002\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u53ef\u4ee5\u4e3anull\u3002 $switch \u8bc4\u4f30\u4e00\u7cfb\u5217\u6848\u4f8b\u8868\u8fbe\u3002\u5f53\u5b83\u627e\u5230\u4e00\u4e2a\u6c42\u503c\u7684\u8868\u8fbe\u5f0f\u65f6true\uff0c$switch\u6267\u884c\u4e00\u4e2a\u6307\u5b9a\u7684\u8868\u8fbe\u5f0f\u5e76\u4e2d\u65ad\u63a7\u5236\u6d41\u3002"},{"location":"database/MongoDB/#_18","title":"\u65e5\u671f\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"<p>\u4ee5\u4e0b\u8fd0\u7b97\u7b26\u8fd4\u56de\u65e5\u671f\u5bf9\u8c61\u6216\u65e5\u671f\u5bf9\u8c61\u7684\u7ec4\u4ef6</p> \u540d\u79f0 \u63cf\u8ff0 $dateFromParts \u7ed9\u5b9a\u65e5\u671f\u7684\u7ec4\u6210\u90e8\u5206\u6784\u9020BSON Date\u5bf9\u8c61\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToParts \u8fd4\u56de\u5305\u542b\u65e5\u671f\u7ec4\u6210\u90e8\u5206\u7684\u6587\u6863\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $dayOfMonth \u4ee51\u523031\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4e2d\u67d0\u5929\u3002 $dayOfWeek \u8fd4\u56de\u65e5\u671f\u7684\u661f\u671f\u51e0\uff0c\u4f5c\u4e3a1\uff08\u661f\u671f\u65e5\uff09\u548c7\uff08\u661f\u671f\u516d\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $dayOfYear \u4ee51\u5230366\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u65e5\u671f\u3002 $hour \u4ee50\u523023\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5c0f\u65f6\u3002 $isoDayOfWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5de5\u4f5c\u65e5\u7f16\u53f7\uff0c\u8303\u56f4\u4ece\u00a01\uff08\u661f\u671f\u4e00\uff09\u52307\uff08\u661f\u671f\u65e5\uff09\u3002 $isoWeek \u8fd4\u56deISO 8601\u683c\u5f0f\u7684\u5468\u6570\uff0c\u4ece\u00a01\u523053\u3002\u5468\u6570\u4ece1\u5305\u542b\u5e74\u4efd\u7b2c\u4e00\u4e2a\u661f\u671f\u56db\u7684\u4e00\u5468\uff08\u661f\u671f\u4e00\u5230\u661f\u671f\u65e5\uff09\u5f00\u59cb\u3002 $isoWeekYear \u4ee5ISO 8601\u683c\u5f0f\u8fd4\u56de\u5e74\u4efd\u7f16\u53f7\u3002\u5e74\u4efd\u4ece\u7b2c1\u5468\u7684\u661f\u671f\u4e00\uff08ISO 8601\uff09\u5f00\u59cb\uff0c\u5230\u4e0a\u5468\u7684\u661f\u671f\u65e5\uff08ISO 8601\uff09\u7ed3\u675f\u3002 $millisecond \u4ee50\u5230999\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6beb\u79d2\u6570\u3002 $minute \u4ee50\u523059\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u5206\u949f\u3002 $month \u4ee51\uff081\u6708\uff09\u523012\uff0812\u6708\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u6708\u4efd\u3002 $second \u4ee50\u523060\uff08\u95f0\u79d2\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u8fd4\u56de\u65e5\u671f\u7684\u79d2\u6570\u3002 $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $week \u8fd4\u56de\u65e5\u671f\u7684\u5468\u6570\uff0c\u4f5c\u4e3a0\uff08\u5728\u4e00\u5e74\u7684\u7b2c\u4e00\u4e2a\u661f\u671f\u65e5\u4e4b\u524d\u7684\u90e8\u5206\u5468\uff09\u548c53\uff08\u95f0\u5e74\uff09\u4e4b\u95f4\u7684\u6570\u5b57\u3002 $year \u4ee5\u6570\u5b57\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u5e74\u4efd\uff08\u4f8b\u59822014\u5e74\uff09\u3002 <p>\u4ee5\u4e0b\u7b97\u672f\u8fd0\u7b97\u7b26\u53ef\u4ee5\u91c7\u7528\u65e5\u671f\u64cd\u4f5c\u6570</p> \u540d\u79f0 \u63cf\u8ff0 $add \u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\u4ee5\u8fd4\u56de\u65b0\u65e5\u671f\u3002\u5982\u679c\u6dfb\u52a0\u6570\u5b57\u548c\u65e5\u671f\uff0c\u8bf7\u5c06\u6570\u5b57\u89c6\u4e3a\u6beb\u79d2\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f\uff0c\u4f46\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u8868\u8fbe\u5f0f\u89e3\u6790\u4e3a\u65e5\u671f\u3002 $subtract \u8fd4\u56de\u4ece\u7b2c\u4e00\u4e2a\u503c\u4e2d\u51cf\u53bb\u7b2c\u4e8c\u4e2a\u503c\u7684\u7ed3\u679c\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\uff0c\u5219\u8fd4\u56de\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u5dee\u5f02\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u6570\u5b57\uff0c\u5219\u8fd4\u56de\u7ed3\u679c\u65e5\u671f\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u8fd9\u4e24\u4e2a\u503c\u662f\u65e5\u671f\u548c\u6570\u5b57\uff0c\u8bf7\u9996\u5148\u6307\u5b9a\u65e5\u671f\u53c2\u6570\uff0c\u56e0\u4e3a\u4ece\u6570\u5b57\u4e2d\u51cf\u53bb\u65e5\u671f\u6ca1\u6709\u610f\u4e49\u3002"},{"location":"database/MongoDB/#_19","title":"\u6587\u5b57\u8868\u8fbe\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $literal \u8fd4\u56de\u4e00\u4e2a\u6ca1\u6709\u89e3\u6790\u7684\u503c\u3002\u7528\u4e8e\u805a\u5408\u7ba1\u9053\u53ef\u4ee5\u5c06\u5176\u89e3\u91ca\u4e3a\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u4f8b\u5982\uff0c\u5c06\\(literal\u8868\u8fbe\u5f0f\u7528\u4e8e\u4ee5a\u5f00\u5934\u7684\u5b57\u7b26\u4e32\uff0c\\)\u4ee5\u907f\u514d\u5c06\u5176\u89e3\u6790\u4e3a\u5b57\u6bb5\u8def\u5f84"},{"location":"database/MongoDB/#_20","title":"\u5bf9\u8c61\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $mergeObjects \u5c06\u591a\u4e2a\u6587\u6863\u5408\u5e76\u4e3a\u4e00\u4e2a\u6587\u6863\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd) $objectToArray \u5c06\u6587\u6863\u8f6c\u6362\u4e3a\u8868\u793a\u952e\u503c\u5bf9\u7684\u6587\u6863\u6570\u7ec4\u3002(\u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd)"},{"location":"database/MongoDB/#set","title":"Set\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"<p>Set\u8868\u8fbe\u5f0f\u5bf9\u6570\u7ec4\u6267\u884cset\u64cd\u4f5c\uff0c\u5c06\u6570\u7ec4\u89c6\u4e3a\u96c6\u5408\u3002Set\u8868\u8fbe\u5f0f\u5ffd\u7565\u6bcf\u4e2a\u8f93\u5165\u6570\u7ec4\u4e2d\u7684\u91cd\u590d\u6761\u76ee\u4ee5\u53ca\u5143\u7d20\u7684\u987a\u5e8f\u3002\u5982\u679cset\u64cd\u4f5c\u8fd4\u56de\u4e00\u4e2aset\uff0c\u5219\u8be5\u64cd\u4f5c\u4f1a\u8fc7\u6ee4\u6389\u7ed3\u679c\u4e2d\u7684\u91cd\u590d\u9879\uff0c\u4ee5\u8f93\u51fa\u4ec5\u5305\u542b\u552f\u4e00\u6761\u76ee\u7684\u6570\u7ec4\u3002\u672a\u6307\u5b9a\u8f93\u51fa\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u987a\u5e8f</p> \u540d\u79f0 \u63cf\u8ff0 $allElementsTrue \u5982\u679c\u96c6\u5408\u7684\u6ca1\u6709\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3afalse\uff0c\u5219\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $anyElementTrue \u5982\u679c\u96c6\u5408\u7684\u4efb\u4f55\u5143\u7d20\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3atrue\uff0c\u00a0\u5219\u8fd4\u56detrue;\u00a0\u5426\u5219\u8fd4\u56defalse\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setDifference \u8fd4\u56de\u4e00\u4e2a\u96c6\u5408\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e00\u4e2a\u96c6\u5408\u4e2d\u4f46\u4e0d\u5728\u7b2c\u4e8c\u4e2a\u96c6\u5408\u4e2d;\u00a0\u5373\u6267\u884c\u7b2c\u4e8c\u7ec4\u76f8\u5bf9\u4e8e\u7b2c\u4e00\u7ec4\u7684\u76f8\u5bf9\u8865\u5145\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setEquals \u5982\u679c\u8f93\u5165\u96c6\u5408\u5177\u6709\u76f8\u540c\u7684\u4e0d\u540c\u5143\u7d20\u8fd4\u56detrue\u3002\u63a5\u53d7\u4e24\u4e2a\u6216\u591a\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setIntersection \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u6240\u6709\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f $setIsSubset \u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u51fa\u73b0\u5728\u7b2c\u4e8c\u7ec4\u4e2d\u8fd4\u56detrue\uff0c\u5305\u62ec\u7b2c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u5143\u7d20\u7b49\u4e8e\u7b2c\u4e8c\u7ec4\u65f6;\u00a0\u5373\u4e0d\u662f\u4e25\u683c\u7684\u5b50\u96c6\u3002\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f $setUnion \u8fd4\u56de\u5305\u542b\u51fa\u73b0\u5728\u4efb\u4f55\u8f93\u5165\u96c6\u4e2d\u7684\u5143\u7d20\u7684\u96c6\u5408"},{"location":"database/MongoDB/#string","title":"String\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"<p>\u65e0\u8bba\u4f7f\u7528\u4ec0\u4e48\u5b57\u7b26\uff0c$concat\u884c\u4e3a\u90fd\u662f\u660e\u786e\u5b9a\u4e49\u7684</p> \u540d\u79f0 \u63cf\u8ff0 $concat \u8fde\u63a5\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\u4e32\u3002 $dateFromString \u5c06\u65e5\u671f/\u65f6\u95f4\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u65e5\u671f\u5bf9\u8c61\u3002 $dateToString \u4ee5\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u5f62\u5f0f\u8fd4\u56de\u65e5\u671f\u3002 $indexOfBytes \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u5b57\u8282\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1\u3002 $indexOfCP \u641c\u7d22\u5b57\u7b26\u4e32\u4ee5\u67e5\u627e\u5b50\u5b57\u7b26\u4e32\u7684\u51fa\u73b0\u5e76\u8fd4\u56de\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684UTF-8\u4ee3\u7801\u70b9\u7d22\u5f15\u3002\u5982\u679c\u672a\u627e\u5230\u5b50\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56de-1 $ltrim \u4ece\u5b57\u7b26\u4e32\u7684\u5f00\u5934\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $rtrim \u4ece\u5b57\u7b26\u4e32\u672b\u5c3e\u5220\u9664\u7a7a\u683c\u6216\u6307\u5b9a\u7684\u5b57\u7b26\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $split \u6839\u636e\u5206\u9694\u7b26\u5c06\u5b57\u7b26\u4e32\u62c6\u5206\u4e3a\u5b50\u5b57\u7b26\u4e32\u3002\u8fd4\u56de\u4e00\u4e2a\u5b50\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\u5982\u679c\u5728\u5b57\u7b26\u4e32\u4e2d\u627e\u4e0d\u5230\u5206\u9694\u7b26\uff0c\u5219\u8fd4\u56de\u5305\u542b\u539f\u59cb\u5b57\u7b26\u4e32\u7684\u6570\u7ec4\u3002 $strLenBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8\u7f16\u7801\u5b57\u8282\u7684\u6570\u91cf\u3002 $strLenCP \u8fd4\u56de\u5b57\u7b26\u4e32\u4e2dUTF-8\u00a0\u4ee3\u7801\u70b9\u7684\u6570\u91cf\u3002 $strcasecmp \u6267\u884c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5b57\u7b26\u4e32\u6bd4\u8f83\u5e76\u8fd4\u56de\uff1a\u00a00\u5982\u679c\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u540c\uff0c1\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5927\u4e8e\u7b2c\u4e8c\u4e2a-1\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e32\u5c0f\u4e8e\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e32\u3002 $substr \u5df2\u8fc7\u65f6\u3002\u4f7f\u7528$substrBytes\u6216\u00a0$substrCP\u3002 $substrBytes \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ece\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8\u5b57\u8282\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u5b57\u8282\u6570\u3002 $substrCP \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u4ee5\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u7684UTF-8\u00a0\u4ee3\u7801\u70b9\uff08CP\uff09\u7d22\u5f15\uff08\u4ece\u96f6\u5f00\u59cb\uff09\u5904\u7684\u5b57\u7b26\u5f00\u59cb\uff0c\u5e76\u7ee7\u7eed\u6307\u5b9a\u7684\u4ee3\u7801\u70b9\u6570\u3002 $toLower \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u63a5\u53d7\u5355\u4e2a\u53c2\u6570\u8868\u8fbe\u5f0f\u3002 $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd)"},{"location":"database/MongoDB/#_21","title":"\u6587\u672c\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $meta \u8bbf\u95ee\u6587\u672c\u641c\u7d22\u5143\u6570\u636e"},{"location":"database/MongoDB/#type","title":"Type\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $convert \u5c06\u503c\u8f6c\u6362\u4e3a\u6307\u5b9a\u7684\u7c7b\u578b\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toBool \u5c06\u503c\u8f6c\u6362\u4e3a\u5e03\u5c14\u503c\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDate \u5c06\u503c\u8f6c\u6362\u4e3a\u65e5\u671f\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDecimal \u5c06\u503c\u8f6c\u6362\u4e3aDecimal128\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toDouble \u5c06\u503c\u8f6c\u6362\u4e3adouble\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toInt \u5c06\u503c\u8f6c\u6362\u4e3a\u6574\u6570\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toLong \u5c06\u503c\u8f6c\u6362\u4e3along\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toObjectId \u5c06\u503c\u8f6c\u6362\u4e3aObjectId\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $toString \u5c06\u503c\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd) $type \u8fd4\u56de\u8be5\u5b57\u6bb5\u7684BSON\u6570\u636e\u7c7b\u578b(4.0\u7248\u4e2d\u7684\u65b0\u529f\u80fd)"},{"location":"database/MongoDB/#accumulatorsgroup","title":"Accumulators(\u7d2f\u52a0\u5668)($group)","text":"<p>\u53ef\u4ee5\u5728\\(group\u9636\u6bb5\u4f7f\u7528\uff0c\u5176\u662f\u5728\u6587\u6863\u901a\u8fc7\u7ba1\u9053\u65f6\u4fdd\u6301\u5176\u72b6\u6001(\u5982\uff1a\u603b\u6570\u3001\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u548c\u76f8\u5173\u6570\u636e)\u7684\u8fd0\u7b97\u7b26\u3002\u5f53\u5728\\)group\u9636\u6bb5\u4e2d\u4f5c\u4e3a\u7d2f\u52a0\u5668\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u5c06\u5355\u4e2a\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u8f93\u5165\uff0c\u4e3a\u6bcf\u4e2a\u8f93\u5165\u6587\u6863\u8ba1\u7b97\u4e00\u6b21\u8868\u8fbe\u5f0f\uff0c\u5e76\u4e3a\u5171\u4eab\u76f8\u540c\u7ec4\u5bc6\u94a5\u7684\u6587\u6863\u7ec4\u4fdd\u6301\u5176\u9636\u6bb5</p> \u540d\u79f0 \u63cf\u8ff0 $addToSet \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u552f\u4e00\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4\u3002\u6570\u7ec4\u5143\u7d20\u7684\u987a\u5e8f\u672a\u5b9a\u4e49 $avg \u8fd4\u56de\u6570\u503c\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $first \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u7b2c\u4e00\u4e2a\u6587\u6863\u4e2d\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $last \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u540e\u4e00\u4e2a\u6587\u6863\u7684\u503c\u3002\u4ec5\u5728\u6587\u6863\u6309\u5b9a\u4e49\u7684\u987a\u5e8f\u5b9a\u4e49\u65f6\u624d\u5b9a\u4e49\u8ba2\u5355 $max \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u9ad8\u8868\u8fbe\u5f0f\u503c $mergeObjects \u8fd4\u56de\u901a\u8fc7\u7ec4\u5408\u6bcf\u4e2a\u7ec4\u7684\u8f93\u5165\u6587\u6863\u521b\u5efa\u7684\u6587\u6863 $min \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u6700\u4f4e\u8868\u8fbe\u5f0f\u503c $push \u8fd4\u56de\u6bcf\u4e2a\u7ec4\u7684\u8868\u8fbe\u5f0f\u503c\u6570\u7ec4 $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c"},{"location":"database/MongoDB/#accumulatorsprojectaddfields","title":"Accumulators(\u7d2f\u52a0\u5668)(\\(project\u548c\\)addFields)","text":"<p>\u4e00\u4e9b\u53ef\u7528\u7528\u4f5c\\(group\u9636\u6bb5\u7684\u7d2f\u52a0\u5668\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u7528\u4e8e\\)project\u548c\\(addFields\u9636\u6bb5\uff0c\u4f46\u4e0d\u80fd\u7528\u4f5c\u7d2f\u52a0\u5668\u3002\u5728\\)project\u548c$addFields\u9636\u6bb5\u4f7f\u7528\u65f6\uff0c\u8fd9\u4e9b\u8fd0\u7b97\u7b26\u4e0d\u4f1a\u4fdd\u6301\u5176\u72b6\u6001\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5355\u4e2a\u53c2\u6570\u6216\u591a\u4e2a\u53c2\u6570\u4f5c\u4e3a\u8f93\u5165</p> \u540d\u79f0 \u63cf\u8ff0 $avg \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u5e73\u5747\u503c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c $max \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5927\u503c $min \u8fd4\u56de\u6bcf\u4e2a\u6587\u6863\u7684\u6307\u5b9a\u8868\u8fbe\u5f0f\u6216\u8868\u8fbe\u5f0f\u5217\u8868\u7684\u6700\u5c0f\u503c $stdDevPop \u8fd4\u56de\u8f93\u5165\u503c\u7684\u603b\u4f53\u6807\u51c6\u504f\u5dee $stdDevSamp \u8fd4\u56de\u8f93\u5165\u503c\u7684\u6837\u672c\u6807\u51c6\u504f\u5dee $sum \u8fd4\u56de\u6570\u503c\u7684\u603b\u548c\u3002\u5ffd\u7565\u975e\u6570\u5b57\u503c"},{"location":"database/MongoDB/#_22","title":"\u53d8\u91cf\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26","text":"\u540d\u79f0 \u63cf\u8ff0 $let \u5b9a\u4e49\u5728\u5b50\u8868\u8fbe\u5f0f\u8303\u56f4\u5185\u4f7f\u7528\u7684\u53d8\u91cf\uff0c\u5e76\u8fd4\u56de\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u3002\u63a5\u53d7\u547d\u540d\u53c2\u6570\u3002\u63a5\u53d7\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u8868\u8fbe\u5f0f <p>\u8868\u8fbe\u5f0f\u8fd0\u7b97\u7b26\u7d22\u5f15</p>"},{"location":"database/MongoDB/#aggregation-commands","title":"aggregation-commands(\u805a\u5408\u547d\u4ee4)","text":""},{"location":"database/MongoDB/#_23","title":"\u805a\u5408\u547d\u4ee4","text":"\u540d\u79f0 \u63cf\u8ff0 aggregate \u4f7f\u7528\u805a\u5408\u6846\u67b6\u6267\u884c\u805a\u5408\u4efb\u52a1\uff0c\u4f8b\u5982\u7ec4 count \u8ba1\u7b97\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6587\u6863\u6570 distinct \u663e\u793a\u4e3a\u96c6\u5408\u6216\u89c6\u56fe\u4e2d\u7684\u6307\u5b9a\u952e\u627e\u5230\u7684\u4e0d\u540c\u503c group \u4e0d\u63a8\u8350\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 mapReduce \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408"},{"location":"database/MongoDB/#_24","title":"\u805a\u5408\u65b9\u6cd5","text":"\u540d\u79f0 \u63cf\u8ff0 \u540d\u79f0 \u63cf\u8ff0 db.collection.aggregate() \u63d0\u4f9b\u5bf9\u805a\u5408\u7ba1\u9053\u7684\u8bbf\u95ee db.collection.group() \u5df2\u8fc7\u65f6\u3002\u6309\u6307\u5b9a\u952e\u5bf9\u96c6\u5408\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6267\u884c\u7b80\u5355\u805a\u5408 db.collection.mapReduce() \u5bf9\u5927\u578b\u6570\u636e\u96c6\u6267\u884cmap-reduce\u805a\u5408"},{"location":"database/MongoDB/#_25","title":"\u805a\u5408\u8868\u8fbe\u5f0f\u4e2d\u7684\u53d8\u91cf","text":"<p>\u805a\u5408\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4f7f\u7528\u7528\u6237\u81ea\u5b9a\u4e49\u548c\u7cfb\u7edf\u53d8\u91cf\uff0c\u53d8\u91cf\u53ef\u4ee5\u4fdd\u5b58\u4efb\u4f55BSON\u7c7b\u578b\u7684\u6570\u636e\u3002\u8981\u8bbf\u95ee\u53d8\u91cf\u7684\u503c\uff0c\u4f7f\u7528\u5e26\u6709\u524d\u7f00\u53ccdollar\u7b26(\\(\\()\u7684\u53d8\u91cf\u540d\u79f0\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u53d8\u91cf\u5f15\u7528\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u8981\u8bbf\u95ee\u8be5\u5bf9\u8c61\u4e2d\u7279\u5b9a\u5b57\u6bb5\uff0c\u8981\u4f7f\u7528\"\\)\\)variable.field\"\u8868\u793a\u6cd5</p>"},{"location":"database/MongoDB/#_26","title":"\u7528\u6237\u53d8\u91cf","text":"<p>\u7528\u6237\u53d8\u91cf\u540d\u79f0\u53ef\u4ee5\u5305\u542bASCII\u5b57\u7b26[_a-zA-Z0-9]\u548c\u4efb\u4f55\u975eASCII\u5b57\u7b26\uff0c\u7528\u6237\u53d8\u91cf\u540d\u5fc5\u987b\u4ee5\u5c0f\u5199\u7684ASCII\u5b57\u7b26[a-z]\u6216\u975eASCII\u5b57\u7b26\u5f00\u5934</p>"},{"location":"database/MongoDB/#_27","title":"\u7cfb\u7edf\u53d8\u91cf","text":"\u53d8\u91cf \u63cf\u8ff0 ROOT \u5f15\u7528\u5f53\u524d\u6b63\u5728\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u5904\u7406\u7684\u6839\u6587\u6863\uff0c\u5373\u9876\u7ea7\u6587\u6863 CURRENT \u5f15\u7528\u805a\u5408\u7ba1\u9053\u9636\u6bb5\u4e2d\u6b63\u5728\u5904\u7406\u7684\u5b57\u6bb5\u8def\u5f84\u7684\u5f00\u59cb\u3002\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u6240\u6709\u9636\u6bb5\u90fd\u4ee5CURRENT\u76f8\u540c\u7684\u00a0\u65b9\u5f0f\u5f00\u5934ROOT CURRENT\u662f\u53ef\u4ee5\u4fee\u6539\u7684\u3002\u4f46\u662f\uff0c\u7531\u4e8e\\(field\u7b49\u540c\u4e8e\\)\\(CURRENT.field\uff0c\u91cd\u65b0\u7ed1\u5b9a\u4f1aCURRENT\u6539\u53d8\\)\u8bbf\u95ee\u7684\u542b\u4e49 REMOVE \u4e00\u4e2a\u8ba1\u7b97\u7f3a\u5931\u503c\u7684\u53d8\u91cf\u3002\u5141\u8bb8\u6761\u4ef6\u6392\u9664\u5b57\u6bb5\u3002\u5728a\u4e2d$projection\uff0cREMOVE\u4ece\u8f93\u51fa\u4e2d\u6392\u9664\u8bbe\u7f6e\u4e3a\u53d8\u91cf\u7684\u5b57\u6bb5 \u6709\u5173\u5176\u7528\u6cd5\u7684\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6709\u6761\u4ef6\u6392\u9664\u5b57\u6bb5 \u7248\u672c3.6\u4e2d\u7684\u65b0\u529f\u80fd DESCEND $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 PRUNE $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00 KEEP $redact\u8868\u8fbe\u5f0f\u7684\u5141\u8bb8\u7ed3\u679c\u4e4b\u4e00"},{"location":"database/MongoDB/#sqlaggregation","title":"SQL\u548caggregation(\u805a\u5408)\u7684\u6bd4\u8f83","text":"<p>sql-aggregation</p>"},{"location":"database/MongoDB/#_28","title":"\u6570\u636e\u6a21\u578b","text":"<p>\u521b\u5efa\u7d22\u5f15\u5e94\u8003\u8651\u4ee5\u4e0b\uff1a</p> <ul> <li>\u6bcf\u4e2a\u7d22\u5f15\u81f3\u5c11\u5360\u75288kb\u7684\u6570\u636e\u7a7a\u95f4</li> <li>\u6dfb\u52a0\u7d22\u5f15\u4f1a\u5bf9\u5199\u5165\u64cd\u4f5c\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\uff0c\u56e0\u6bcf\u4e2a\u63d2\u5165\u4e5f\u5fc5\u987b\u66f4\u65b0\u7d22\u5f15</li> <li>\u5177\u6709\u9ad8\u8bfb\u5199\u6bd4\u7387\u7684\u96c6\u5408\u901a\u5e38\u53d7\u76ca\u4e8e\u5176\u4ed6\u7d22\u5f15\uff0c\u7d22\u5f15\u4e0d\u5f71\u54cd\u672a\u521b\u5efa\u7d22\u5f15\u7684\u64cd\u4f5c</li> <li>\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u65f6\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u4f1a\u5360\u7528\u78c1\u76d8\u7a7a\u95f4\u548c\u5185\u5b58</li> </ul>"},{"location":"database/MongoDB/#transactions","title":"Transactions","text":"<p>\u53ef\u4ee5\u8de8\u591a\u4e2a\u64cd\u4f5c\u3001\u96c6\u5408\u3001\u6570\u636e\u5e93\u548c\u6587\u6863\u4f7f\u7528\u591a\u6587\u6863\u4e8b\u52a1</p> <p>\u591a\u6587\u6863\u4e8b\u52a1\u662f\u539f\u5b50\u6027\u7684\uff1a</p> <ul> <li>\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u88ab\u4fdd\u5b58\u5e76\u5728\u4e8b\u52a1\u5916\u90e8\u53ef\u89c1\uff0c\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u524d\uff0c\u4e8b\u52a1\u4e2d\u53d1\u751f\u7684\u6570\u636e\u66f4\u6539\u4e8b\u52a1\u5916\u90e8\u4e0d\u53ef\u89c1</li> <li>\u4e8b\u52a1\u4e2d\u6b62\u65f6\uff0c\u4e8b\u52a1\u4e2d\u6240\u6709\u7684\u6570\u636e\u66f4\u6539\u90fd\u4f1a\u88ab\u4e22\u5f03\u4f46\u4e0d\u4f1a\u4e0d\u53ef\u89c1</li> </ul>"},{"location":"database/MongoDB/#_29","title":"\u7d22\u5f15","text":"<p>\u7d22\u5f15\u7684\u6392\u5e8f\u652f\u6301\u6709\u6548\u7684\u7b49\u5f0f\u5339\u914d\u548c\u57fa\u4e8e\u8303\u56f4\u7684\u67e5\u8be2\u64cd\u4f5c\uff0cmongodb\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\u4e2d\u7684\u987a\u5e8f\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c</p> <p>\u5206\u7247\u96c6\u7fa4\u4e2d\uff0c\u5982\u679c\u4e0d\u5c06_id\u5b57\u6bb5\u4f5c\u4e3a\u7247\u952e\uff0c\u5219\u5e94\u7528\u7a0b\u5e8f\u5fc5\u987b\u786e\u4fdd_id\u5b57\u6bb5\u503c\u7684\u552f\u4e00\u6027\u4ee5\u9632\u51fa\u9519</p>"},{"location":"database/MongoDB/#_30","title":"\u7d22\u5f15\u7c7b\u578b","text":"<p>\u5355\u5b57\u6bb5\u7d22\u5f15\uff1a\u5bf9\u4e8e\u5355\u5b57\u6bb5\u7d22\u5f15\u548c\u6392\u5e8f\u64cd\u4f5c\uff0c\u7d22\u5f15\u952e\u7684\u6392\u5e8f\u987a\u5e8f\u65e0\u5173\u7d27\u8981</p> <p>\u590d\u5408\u7d22\u5f15\uff1aMongoDB\u652f\u6301\u591a\u5b57\u6bb5\u7684\u7528\u6237\u5b9a\u4e49\u7d22\u5f15\uff0c\u590d\u5408\u7d22\u5f15\u4e2d\u5b57\u6bb5\u7684\u987a\u5e8f\u5177\u6709\u91cd\u8981\u610f\u4e49</p> <p>\u591a\u952e\u7d22\u5f15\uff1aMongoDB\u4f7f\u7528\u591a\u952e\u7d22\u5f15\u6765\u7d22\u5f15\u5b58\u50a8\u5728\u6570\u7ec4\u4e2d\u7684\u5185\u5bb9\uff0c\u5982\u679c\u7d22\u5f15\u5305\u542b\u6570\u7ec4\u7684\u5b57\u6bb5\uff0c\u5219\u4f1a\u4e3a\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u521b\u5efa\u5355\u72ec\u7684\u7d22\u5f15\u6761\u76ee</p> <p>\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\uff1amongodb\u63d0\u4f9b\u4e24\u4e2a\u7279\u6b8a\u7d22\u5f15\u4ee5\u652f\u6301\u5bf9\u5730\u7406\u7a7a\u95f4\u5750\u6807\u6570\u636e\u7684\u67e5\u8be2\uff0c2d\u7d22\u5f15\u4f7f\u7528\u5e73\u9762\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c\uff1b2dsphere\u7d22\u5f15\u4f7f\u7528\u7403\u5f62\u51e0\u4f55\u8fd4\u56de\u7ed3\u679c</p> <p>\u6587\u672c\u7d22\u5f15\uff1amongodb\u63d0\u4f9btext\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u5b57\u7b26\u4e32\u67e5\u8be2</p> <p>\u6563\u5217\u7d22\u5f15\uff1aMongoDB\u63d0\u4f9b\u6563\u5217\u7d22\u5f15\u7c7b\u578b\u4ee5\u652f\u6301\u57fa\u4e8e\u6563\u5217\u7684\u5206\u7247\uff0c\u8be5\u7c7b\u578b\u7d22\u5f15\u662f\u4e00\u4e2a\u5b57\u6bb5\u503c\u7684hash\uff0c\u7d22\u5f15\u5728\u5176\u8303\u56f4\u5185\u6709\u76f8\u5f53\u591a\u968f\u673a\u503c\u5206\u914d\uff0c\u4ec5\u652f\u6301\u76f8\u7b49\u5339\u914d\u4e0d\u652f\u6301\u8303\u56f4\u67e5\u8be2</p>"},{"location":"database/MongoDB/#_31","title":"\u7d22\u5f15\u5c5e\u6027","text":"<p>\u7d22\u5f15\u5177\u6709\u552f\u4e00\u6027\uff0cMongoDB\u62d2\u7edd\u7d22\u5f15\u5b57\u6bb5\u7684\u91cd\u590d\u503c\uff0c\u552f\u4e00\u7d22\u5f15\u53ef\u4e0e\u5176\u4ed6MongoDB\u7d22\u5f15\u4e92\u6362</p> <p>\u90e8\u5206\u7d22\u5f15\u4ec5\u7d22\u5f15\u7b26\u5408\u6307\u5b9a\u8fc7\u6ee4\u5668\u8868\u8fbe\u5f0f\u7684\u96c6\u5408\u4e2d\u7684\u6587\u6863</p> <p>\u7d22\u5f15\u7684\u7a00\u758f\u5c5e\u6027\u53ef\u786e\u4fdd\u7d22\u5f15\u4ec5\u5305\u542b\u5177\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863\u7684\u6761\u76ee\u3002\u7d22\u5f15\u4f1a\u8df3\u8fc7\u6ca1\u6709\u7d22\u5f15\u5b57\u6bb5\u7684\u6587\u6863</p> <p>TTL\u7d22\u5f15\u662fMongoDB\u53ef\u7528\u4e8e\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\u81ea\u52a8\u4ece\u96c6\u5408\u4e2d\u5220\u9664\u6587\u6863\u7684\u7279\u6b8a\u7d22\u5f15\u3002\u8fd9\u5bf9\u4e8e\u67d0\u4e9b\u7c7b\u578b\u7684\u4fe1\u606f\u975e\u5e38\u7406\u60f3\uff0c\u4f8b\u5982\u673a\u5668\u751f\u6210\u7684\u4e8b\u4ef6\u6570\u636e\uff0c\u65e5\u5fd7\u548c\u4f1a\u8bdd\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u53ea\u9700\u8981\u5728\u6570\u636e\u5e93\u4e2d\u6301\u7eed\u6709\u9650\u7684\u65f6\u95f4</p>"},{"location":"database/MongoDB/#_32","title":"\u6587\u672c\u7d22\u5f15","text":"<p>\u4e00\u4e2a\u96c6\u5408\u5bf9\u591a\u53ea\u80fd\u6709\u4e00\u4e2atext\u7d22\u5f15,\u5bf9\u4e8etext\u7d22\u5f15\uff0c\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\u8868\u793a\u5b57\u6bb5\u76f8\u5bf9\u4e8e\u5176\u4ed6\u7d22\u5f15\u5b57\u6bb5\u5728\u6587\u672c\u641c\u7d22\u5206\u6570\u65b9\u9762\u7684\u91cd\u8981\u6027\uff0c\u5bf9\u4e8e\u6587\u6863\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u5b57\u6bb5\uff0cMongoDB\u5c06\u5339\u914d\u6570\u4e58\u4ee5\u6743\u91cd\u5e76\u5c06\u7ed3\u679c\u76f8\u52a0\u3002\u4f7f\u7528\u6b64\u603b\u548c\uff0cMongoDB\u7136\u540e\u8ba1\u7b97\u6587\u6863\u7684\u5206\u6570\u3002\u7d22\u5f15\u5b57\u6bb5\u7684\u9ed8\u8ba4\u6743\u91cd\u4e3a1\u3002\u8981\u8c03\u6574\u7d22\u5f15\u5b57\u6bb5\u7684\u6743\u91cd\uff0c\u8bf7weights\u5728db.collection.createIndex()\u65b9\u6cd5\u4e2d\u5305\u542b\u8be5\u9009\u9879</p> <p>db.collection.createIndex( { field: \"text\" } )</p> <p>text\u5728\u591a\u4e2a\u5b57\u6bb5\u4e0a\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\uff08\\(**\uff09\u3002\u4f7f\u7528\u901a\u914d\u7b26\u6587\u672c\u7d22\u5f15\uff0cMongoDB\u4f1a\u4e3a\u5305\u542b\u96c6\u5408\u4e2d\u6bcf\u4e2a\u6587\u6863\u7684\u5b57\u7b26\u4e32\u6570\u636e\u7684\u6bcf\u4e2a\u5b57\u6bb5\u7f16\u5236\u7d22\u5f15\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528\u901a\u914d\u7b26\u8bf4\u660e\u7b26\u521b\u5efa\u6587\u672c\u7d22\u5f15 db.collection.createIndex( { \"\\)**\": \"text\" } )</p> <p>\u6307\u5b9atext\u7d22\u5f15\u540d\u79f0\uff1a\u7d22\u5f15\u7684\u9ed8\u8ba4\u540d\u79f0\u7531\u6bcf\u4e2a\u7d22\u5f15\u540d\u79f0\u52a0_text\u7ec4\u6210\uff0c\u53ef\u81ea\u5b9a\u4e49\u7d22\u5f15\u540d\u79f0;db.collection.createIndex( { content: \"text\", \"user.comments\": \"text\"}, { name: \"myTextName\"} ) \u7528\u6743\u91cd\u63a7\u5236\u641c\u7d22\u7ed3\u679c\uff1a\u4ee5\u4e0b\u4e3a\u8bbe\u7f6econtent\u548ckeywords\u7d22\u5f15\u6743\u91cd\u5206\u522b\u4e3a10\u548c5\uff0cabout\u9ed8\u8ba4\u4e3a1 db.blog.createIndex(  content: \"text\", keywords: \"text\", about: \"text\" }, { weights: { content: 10, keywords: 5 }, name: \"TextIndex\" } ) \u9650\u5236\u6587\u6863\u626b\u63cf\u6570\u91cf\uff1a\u6587\u6863\u7ed3\u6784\u5982\u4e0b</p> Markdown<pre><code>{ _id: 1, dept: \"tech\", description: \"lime green computer\" }\n{ _id: 2, dept: \"tech\", description: \"wireless red mouse\" }\n{ _id: 3, dept: \"kitchen\", description: \"green placemat\" }\n{ _id: 4, dept: \"kitchen\", description: \"red peeler\" }\n{ _id: 5, dept: \"food\", description: \"green apple\" }\n{ _id: 6, dept: \"food\", description: \"red potato\" }\n</code></pre>"},{"location":"database/MongoDB/#_33","title":"\u5b89\u5168","text":""},{"location":"database/MongoDB/#change-streams","title":"Change Streams","text":""},{"location":"database/MongoDB/#replication","title":"\u590d\u5236(Replication)","text":""},{"location":"database/MongoDB/#sharding","title":"\u5206\u7247(Sharding)","text":""},{"location":"database/MongoDB/#administration","title":"\u7ba1\u7406(Administration)","text":""},{"location":"database/MongoDB/#storage","title":"\u5b58\u50a8\u5f15\u64ce(Storage)","text":""},{"location":"database/MongoDB/#mongodb-kafka","title":"MongoDB\u2192kafka","text":"Text Only<pre><code>Debezium\u7684MongoDB Connector\u53ef\u4ee5\u76d1\u89c6MongoDB\u526f\u672c\u96c6\u6216MongoDB\u5206\u7247\u96c6\u7fa4\uff1bMongoDB\u590d\u5236\u7684\u5de5\u4f5c\u539f\u7406\u662f\u8ba9Master\u8bb0\u5f55\u5176oplog\uff08\u6216\u64cd\u4f5c\u65e5\u5fd7\uff09\u4e2d\u7684\u66f4\u6539\uff0c\u7136\u540e\u6bcf\u4e2aSlave\u8282\u70b9\u8bfb\u53d6\u4e3b\u8981\u7684oplog\u5e76\u6309\u987a\u5e8f\u5e94\u7528\u6240\u6709\u64cd\u4f5c\u5230\u4ed6\u4eec\u81ea\u5df1\u7684\u6587\u6863\u3002\u5c06\u65b0\u670d\u52a1\u5668\u6dfb\u52a0\u5230\u526f\u672c\u96c6\u65f6\uff0c\u8be5\u670d\u52a1\u5668\u9996\u5148\u6267\u884c\u521d\u59cb\u540c\u6b65\u4e3b\u6570\u636e\u5e93\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93\u548c\u96c6\u5408\uff0c\u7136\u540e\u8bfb\u53d6\u4e3b\u6570\u636e\u5e93\u7684oplog\u4ee5\u5e94\u7528\u81ea\u5f00\u59cb\u540c\u6b65\u4ee5\u6765\u53ef\u80fd\u5df2\u7ecf\u8fdb\u884c\u7684\u6240\u6709\u66f4\u6539\u3002\u8fd9\u4e2a\u65b0\u670d\u52a1\u5668\u5728\u8d76\u4e0aMaster\u8282\u70b9oplog\u7684\u5c3e\u90e8\u65f6\u6210\u4e3aSlave\u670d\u52a1\u5668\uff08\u5e76\u4e14\u80fd\u591f\u5904\u7406\u67e5\u8be2\uff09\n\nDebezium MongoDB Connector\u4f7f\u7528\u76f8\u540c\u7684\u590d\u5236\u673a\u5236\uff0c\u4f46\u5b83\u5b9e\u9645\u4e0a\u5e76\u4e0d\u6210\u4e3a\u526f\u672c\u96c6\u7684\u6210\u5458\uff0cConnector\u59cb\u7ec8\u8fde\u63a5\u526f\u672c\u96c6\u7684\u4e3b\u8282\u70b9\u6765\u8ddf\u8e2aoplog\uff0cMongoDB\u91cd\u65b0\u9009\u4e3e\u4e3b\u8282\u70b9\u540e\uff0cConnector\u4f1a\u81ea\u52a8\u5207\u6362\u5230\u65b0\u7684\u4e3b\u8282\u70b9\u3002Connector\u4f1a\u8bb0\u5f55oplog\u7684\u4f4d\u7f6e\uff0c\u6765\u5b9e\u73b0\u589e\u91cf\u540c\u6b65\n\nDebezium MongoDB Connector\u548c\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u53ea\u9700\u5c06\u526f\u672c\u96c6\u7684\u5730\u5740\u4f5c\u4e3aConnector\u7684seed\u5730\u5740mongodb.hosts\u5373\u53ef\u3002Connector\u4f7f\u7528seed\u8fde\u63a5\u526f\u672c\u96c6\uff0c\u83b7\u53d6\u5230\u5b8c\u6574\u7684\u6210\u5458\u96c6\u53ca\u786e\u5b9a\u4e3b\u8282\u70b9\u540e\u3002Connector\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u5e76\u4ece\u5176oplog\u6355\u83b7\u66f4\u6539\n\nConnector\u548c\u5206\u7247\u96c6\u7fa4\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u4f7f\u7528config\u670d\u52a1\u5668\u7684\u5730\u5740\u914d\u7f6eConnector\u8fde\u63a5\u3002\u9488\u5bf9\u5206\u7247\u7fa4\u96c6\u8fd0\u884c\u8fde\u63a5\u5668\u65f6\uff0c\u8bf7\u4f7f\u7528tasks.max\u5927\u4e8e\u526f\u672c\u96c6\u6570\u91cf\u7684\u503c,\u8fd9\u5c06\u5141\u8bb8\u8fde\u63a5\u5668\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u521b\u5efa\u4e00\u4e2a\u4efb\u52a1\uff0c\u5e76\u8ba9Kafka Connect\u5728\u6240\u6709\u53ef\u7528\u7684\u5de5\u4f5c\u8fdb\u7a0b\u4e2d\u534f\u8c03\uff0c\u5206\u53d1\u548c\u7ba1\u7406\u4efb\u52a1\n\nmongodb.name\uff0c\u5b83\u5145\u5f53MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u96c6\u7fa4\u7684\u903b\u8f91\u540d\u79f0,\u8fde\u63a5\u5668\u4ee5\u591a\u79cd\u65b9\u5f0f\u4f7f\u7528\u903b\u8f91\u540d\u79f0\uff1a\u4f5c\u4e3a\u6240\u6709\u4e3b\u9898\u540d\u79f0\u7684\u524d\u7f00\uff0c\u4ee5\u53ca\u8bb0\u5f55\u6bcf\u4e2a\u526f\u672c\u96c6\u7684oplog\u4f4d\u7f6e\u65f6\u7684\u552f\u4e00\u6807\u8bc6\u7b26\n</code></pre>"},{"location":"database/MongoDB/#topics-name","title":"topics name","text":"Bash<pre><code>Connector\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\u7684insert\u3001update\u3001delete\u6587\u6863\u64cd\u4f5c\u5199\u5165\u4e8b\u4ef6\u5230\u6bcf\u4e2akafka topic\u3002kafka topic\u7684\u540d\u5b57\u89c4\u5219logicalName.databaseName.collectionName\uff0clogicalName\u662f\u914d\u7f6e\u5c5e\u6027mongodb.name\u6307\u5b9a\u7684\u8fde\u63a5\u5668\u7684\u540d\u79f0,databaseName\u662f\u53d1\u751f\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u540d\u79f0,collectionName\u662f\u53d7\u5f71\u54cd\u6587\u6863\u6240\u5728\u7684MongoDB\u96c6\u5408\u7684\u540d\u79f0\u3002\u4f8b\u5982\uff1a\n\nMongoDB\u6570\u636e\u5e93inventory\u5305\u542b\u56db\u4e2a\u96c6\u5408\uff1aproducts,product_on_hand,customers,orders\u3002\u5047\u8bbe\u76d1\u89c6\u6b64\u6570\u636e\u5e93\u7684\u8fde\u63a5\u5668\u903b\u8f91\u540d\u79f0\u662ffulfillment\uff0c\u5219\u8fde\u63a5\u5668\u751f\u6210\u7684\u56db\u4e2akafka topic\u4e8b\u4ef6\u4e3a\uff1a\nfulfillment.inventory.products\nfulfillment.inventory.products_on_hand\nfulfillment.inventory.customers\nfulfillment.inventory.orders\n</code></pre>"},{"location":"database/MongoDB/#partitions","title":"Partitions","text":"Bash<pre><code>MongoDB\u8fde\u63a5\u5668\u4e0d\u4f1a\u660e\u786e\u786e\u5b9a\u4e8b\u4ef6\u7684topic\u5206\u533a,\u76f8\u53cd\uff0c\u5b83\u5141\u8bb8Kafka\u6839\u636e\u5bc6\u94a5\u786e\u5b9a\u5206\u533a\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728Kafka Connect\u5de5\u4f5c\u7a0b\u5e8f\u914d\u7f6e\u4e2d\u5b9a\u4e49Partitioner\u5b9e\u73b0\u7684\u540d\u79f0\u6765\u66f4\u6539Kafka\u7684\u5206\u533a\u903b\u8f91\n</code></pre>"},{"location":"database/MongoDB/#events","title":"Events","text":"Bash<pre><code>MongoDB\u8fde\u63a5\u5668\u751f\u6210\u7684\u6570\u636e\u66f4\u6539\u4e8b\u4ef6\u90fd\u6709\u4e00\u4e2akey\u548cvalue\u3002\u4e0b\u9762\u6982\u8ff0\u4e86\u8fd9\u4e9bkey\u548cvalue\u7684\u7ed3\u6784\n\u4ecekafka0.10\u5f00\u59cb\uff0c\u53ef\u4ee5\u4f7f\u7528\u6d88\u606f\u5bc6\u94a5\u8fdb\u884c\u8bb0\u5f55\u5e76\u521b\u5efa\u6d88\u606f\u7684\u65f6\u95f4\u6233(\u7531\u751f\u4ea7\u8005\u8bb0\u5f55)\u6216\u7531kafka\u5199\u5165\u65e5\u5fd7\u7684\u503c\u8fdb\u884c\u8bc4\u4f30\n\u5982\u679c\u4e8b\u4ef6\u7684\u6765\u6e90\u5728\u7ed3\u6784\u4e0a\u53d1\u751f\u53d8\u5316\u6216\u8fde\u63a5\u5668\u6539\u53d8\uff0c\u4e8b\u4ef6\u7684\u7ed3\u6784\u53ef\u80fd\u4f1a\u968f\u7740\u65f6\u95f4\u63a8\u79fb\u800c\u53d1\u751f\u53d8\u5316\u3002\u5bf9\u4e8e\u6d88\u8d39\u8005\u53ef\u80fd\u5f88\u96be\u5904\u7406\u3002\u56e0\u6b64kafka\u6bcf\u4e2a\u4e8b\u4ef6\u90fd\u81ea\u6210\u4e00\u4f53\uff0c\u6bcf\u4e2a\u6d88\u606f\u952e\u503c\u90fd\u6709\u4e24\u90e8\u5206:a schema\u548cpayload\u3002\u5f53payload\u5305\u542b\u6570\u636e\u65f6\uff0cschema\u63cf\u8ff0payload\u7684\u7ed3\u6784\n\n\u66f4\u6539\u4e8b\u4ef6\u7684key\uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u96c6\u5408\uff0c\u66f4\u6539\u4e8b\u4ef6\u7684key\u5c06\u662f\u5305\u542b\u5355\u4e2aid\u5b57\u6bb5\u7684\u7ed3\u6784\u3002\u5b83\u7684\u503c\u662f\u6587\u6863\u7684\u6807\u8bc6\u7b26\u8868\u793a\u4e3a\u5b57\u7b26\u4e32\n</code></pre> <p>MongoDB\u4e0d\u53ef\u7528\u65f6\uff0c\u91cd\u65b0\u5c1d\u8bd5\u8fde\u63a5\u7531\u4e09\u4e2a\u5c5e\u6027\u63a7\u5236\uff1a</p> <ul> <li>connect.backoff.initial.delay.ms -- \u7b2c\u4e00\u6b21\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09</li> <li>connect.backoff.max.delay.ms --- \u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u4e4b\u524d\u7684\u6700\u5927\u5ef6\u8fdf\uff0c\u9ed8\u8ba4\u503c\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09</li> <li>connect.max.attempts ------------ \u4ea7\u751f\u9519\u8bef\u4e4b\u524d\u7684\u6700\u5927\u5c1d\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a16</li> </ul>"},{"location":"database/MongoDB/#connector","title":"Connector\u5c5e\u6027","text":"\u5c5e\u6027 \u9ed8\u8ba4 \u63cf\u8ff0 name \u8fde\u63a5\u5668\u7684\u552f\u4e00\u540d\u79f0\u3002\u5c1d\u8bd5\u518d\u6b21\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u6ce8\u518c\u5c06\u5931\u8d25\u3002\uff08\u6240\u6709Kafka Connect\u8fde\u63a5\u5668\u90fd\u9700\u8981\u6b64\u5c5e\u6027\u3002\uff09 connector.class \u8fde\u63a5\u5668\u7684Java\u7c7b\u7684\u540d\u79f0\u3002\u59cb\u7ec8\u4f7f\u7528io.debezium.connector.mongodb.MongoDbConnectorMongoDB\u8fde\u63a5\u5668\u7684\u503c\u3002 mongodb.hosts \u526f\u672c\u96c6\u4e2dMongoDB\u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\uff08\u683c\u5f0f\u4e3a\u201chost\u201d\u6216\u201chost\uff1aport\u201d\uff09\u7684\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u8be5\u5217\u8868\u53ef\u4ee5\u5305\u542b\u5355\u4e2a\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5bf9\u3002\u5982\u679cmongodb.members.auto.discover\u8bbe\u7f6e\u4e3afalse\uff0c\u5219\u4e3b\u673a\u548c\u7aef\u53e3\u5bf9\u5e94\u4ee5\u526f\u672c\u96c6\u540d\u79f0\u4e3a\u524d\u7f00\uff08\u4f8b\u5982\uff0crs0/localhost:27017\uff09\u3002 mongodb.name \u4e00\u4e2a\u552f\u4e00\u540d\u79f0\uff0c\u7528\u4e8e\u6807\u8bc6\u6b64\u8fde\u63a5\u5668\u76d1\u89c6\u7684\u8fde\u63a5\u5668\u548c/\u6216MongoDB\u526f\u672c\u96c6\u6216\u5206\u7247\u7fa4\u96c6\u3002\u6bcf\u4e2a\u670d\u52a1\u5668\u6700\u591a\u5e94\u7531\u4e00\u4e2aDebezium\u8fde\u63a5\u5668\u76d1\u63a7\uff0c\u56e0\u4e3a\u6b64\u670d\u52a1\u5668\u540d\u79f0\u524d\u7f00\u662fMongoDB\u526f\u672c\u96c6\u6216\u96c6\u7fa4\u53d1\u51fa\u7684\u6240\u6709\u6301\u4e45\u6027Kafka\u4e3b\u9898\u3002 mongodb.user \u8fde\u63a5\u5230MongoDB\u65f6\u8981\u4f7f\u7528\u7684\u6570\u636e\u5e93\u7528\u6237\u7684\u540d\u79f0\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.password \u8fde\u63a5MongoDB\u65f6\u4f7f\u7528\u7684\u5bc6\u7801\u3002\u4ec5\u5f53MongoDB\u914d\u7f6e\u4e3a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u65f6\u624d\u9700\u8981\u8fd9\u6837\u505a\u3002 mongodb.ssl.enabled false Connector\u5c06\u4f7f\u7528SSL\u8fde\u63a5\u5230MongoDB\u5b9e\u4f8b\u3002 mongodb.ssl.invalid.hostname.allowed false \u542f\u7528S\u200b\u200bSL\u65f6\uff0c\u6b64\u8bbe\u7f6e\u63a7\u5236\u5728\u8fde\u63a5\u9636\u6bb5\u662f\u5426\u7981\u7528\u4e25\u683c\u4e3b\u673a\u540d\u68c0\u67e5\u3002\u5982\u679ctrue\u8fde\u63a5\u4e0d\u4f1a\u963b\u6b62\u4e2d\u95f4\u4eba\u653b\u51fb\u3002 database.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u76d1\u89c6\u7684\u6570\u636e\u5e93\u540d\u79f0; \u672a\u5217\u5165\u767d\u540d\u5355\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u90fd\u5c06\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5c06\u76d1\u89c6\u6240\u6709\u6570\u636e\u5e93\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.blacklist\u3002 database.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u7528\u4e8e\u5339\u914d\u8981\u4ece\u76d1\u89c6\u4e2d\u6392\u9664\u7684\u6570\u636e\u5e93\u540d\u79f0; \u5c06\u76d1\u63a7\u9ed1\u540d\u5355\u4e2d\u672a\u5305\u542b\u7684\u4efb\u4f55\u6570\u636e\u5e93\u540d\u79f0\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528database.whitelist\u3002 collection.whitelist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914d\u8981\u76d1\u89c6\u7684MongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4; \u4efb\u4f55\u672a\u5305\u542b\u5728\u767d\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u88ab\u6392\u9664\u5728\u76d1\u63a7\u4e4b\u5916\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fde\u63a5\u5668\u5c06\u76d1\u89c6\u9664local\u548cadmin\u6570\u636e\u5e93\u4e2d\u7684\u96c6\u5408\u4e4b\u5916\u7684\u6240\u6709\u96c6\u5408\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.blacklist\u3002 collection.blacklist \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\uff0c\u5b83\u4eec\u5339\u914dMongoDB\u96c6\u5408\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u4ece\u76d1\u89c6\u4e2d\u6392\u9664; \u4efb\u4f55\u672a\u5305\u542b\u5728\u9ed1\u540d\u5355\u4e2d\u7684\u96c6\u5408\u90fd\u5c06\u53d7\u5230\u76d1\u63a7\u3002\u6bcf\u4e2a\u6807\u8bc6\u7b26\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002\u4e0d\u5f97\u4e0e\u4e4b\u914d\u5408\u4f7f\u7528collection.whitelist\u3002 \" snapshot.mode 0.9.2\u53ca\u66f4\u9ad8\u7248\u672c initial \u6307\u5b9a\u5728\u542f\u52a8\u8fde\u63a5\u5668\u65f6\u8fd0\u884c\u5feb\u7167\u7684\u6761\u4ef6\uff08\u4f8b\u5982\uff0c\u521d\u59cb\u540c\u6b65\uff09\u3002\u9ed8\u8ba4\u503c\u4e3ainitial\uff0c\u5e76\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u672a\u627e\u5230\u504f\u79fb\u91cf\u6216oplog\u4e0d\u518d\u5305\u542b\u5148\u524d\u504f\u79fb\u91cf\u65f6\u8bfb\u53d6\u5feb\u7167\u3002\u5728\u4ece\u4e0d\u9009\u9879\u6307\u5b9a\u8fde\u63a5\u5668\u4e0d\u5e94\u8be5\u4f7f\u7528\u5feb\u7167\uff0c\u800c\u4e0d\u662f\u8fde\u63a5\u5668\u5e94\u7740\u624b\u5c3e\u65e5\u5fd7\u3002 \" field.blacklist 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u5e94\u8be5\u4ece\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u6392\u9664\u7684\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u53ef\u9009\u9017\u53f7\u5206\u9694\u5217\u8868\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\u3002 \" field.renames 0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u7a7a\u5b57\u7b26\u4e32 \u53ef\u9009\u7684\u4ee5\u9017\u53f7\u5206\u9694\u7684\u5b8c\u6574\u9650\u5b9a\u5b57\u6bb5\u66ff\u6362\u5217\u8868\uff0c\u7528\u4e8e\u91cd\u547d\u540d\u66f4\u6539\u4e8b\u4ef6\u6d88\u606f\u503c\u4e2d\u7684\u5b57\u6bb5\u3002\u5b57\u6bb5\u7684\u5b8c\u5168\u9650\u5b9a\u66ff\u6362\u7684\u683c\u5f0f\u4e3adatabaseName\u3002collectionName\u3002fieldName\u3002nestedFieldName\uff1anewNestedFieldName\uff0c\u5176\u4e2ddatabaseName\u548ccollectionName\u53ef\u4ee5\u5305\u542b\u5339\u914d\u4efb\u4f55\u5b57\u7b26\u7684\u901a\u914d\u7b26\uff08*\uff09\uff0c\u5192\u53f7\u5b57\u7b26\uff08:)\u7528\u4e8e\u786e\u5b9a\u5b57\u6bb5\u7684\u91cd\u547d\u540d\u6620\u5c04\u3002\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u5c06\u5e94\u7528\u4e8e\u5217\u8868\u4e2d\u4e0a\u4e00\u4e2a\u5b57\u6bb5\u66ff\u6362\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u5728\u91cd\u547d\u540d\u540c\u4e00\u8def\u5f84\u4e2d\u7684\u591a\u4e2a\u5b57\u6bb5\u65f6\u8bf7\u8bb0\u4f4f\u8fd9\u4e00\u70b9\u3002 tasks.max 1 \u5e94\u4e3a\u6b64\u8fde\u63a5\u5668\u521b\u5efa\u7684\u6700\u5927\u4efb\u52a1\u6570\u3002MongoDB\u8fde\u63a5\u5668\u5c06\u5c1d\u8bd5\u4e3a\u6bcf\u4e2a\u526f\u672c\u96c6\u4f7f\u7528\u5355\u72ec\u7684\u4efb\u52a1\uff0c\u56e0\u6b64\u5728\u5c06\u8fde\u63a5\u5668\u4e0e\u5355\u4e2aMongoDB\u526f\u672c\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u9ed8\u8ba4\u503c\u662f\u53ef\u63a5\u53d7\u7684\u3002\u5c06\u8fde\u63a5\u5668\u4e0eMongoDB\u5206\u7247\u7fa4\u96c6\u4e00\u8d77\u4f7f\u7528\u65f6\uff0c\u5efa\u8bae\u6307\u5b9a\u4e00\u4e2a\u7b49\u4e8e\u6216\u5927\u4e8e\u7fa4\u96c6\u4e2d\u5206\u7247\u6570\u7684\u503c\uff0c\u4ee5\u4fbfKafka Connect\u53ef\u4ee5\u5206\u914d\u6bcf\u4e2a\u526f\u672c\u96c6\u7684\u5de5\u4f5c\u3002 initial.sync.max.threads 1 \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u7528\u4e8e\u5728\u526f\u672c\u96c6\u4e2d\u6267\u884c\u96c6\u5408\u7684\u521d\u59cb\u540c\u6b65\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002\u9ed8\u8ba4\u4e3a1\u3002 \" tombstones.on.delete 0.7.3\u53ca\u4ee5\u540e true \u63a7\u5236\u662f\u5426\u5e94\u5728\u5220\u9664\u4e8b\u4ef6\u540e\u751f\u6210\u903b\u8f91\u5220\u9664\u4e8b\u4ef6 \u5f53true\u5220\u9664\u64cd\u4f5c\u662f\u901a\u8fc7\u5220\u9664\u4e8b\u4ef6\u548c\u968f\u540e\u7684\u5893\u7891\u4e8b\u4ef6\u8868\u793a\u3002\u5982\u679cfalse\u53ea\u53d1\u9001\u5220\u9664\u4e8b\u4ef6 \u53d1\u9001\u903b\u8f91\u5220\u9664\u4e8b\u4ef6\uff08\u9ed8\u8ba4\u884c\u4e3a\uff09\u5141\u8bb8Kafka\u5728\u5220\u9664\u6e90\u8bb0\u5f55\u540e\u5b8c\u5168\u5220\u9664\u4e0e\u7ed9\u5b9a\u5bc6\u94a5\u6709\u5173\u7684\u6240\u6709\u4e8b\u4ef6\u3002 \" snapshot.delay.ms0.9.0\u53ca\u66f4\u9ad8\u7248\u672c \u8fde\u63a5\u5668\u5728\u542f\u52a8\u540e\u62cd\u6444\u5feb\u7167\u4e4b\u524d\u5e94\u7b49\u5f85\u7684\u95f4\u9694\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09;\u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u542f\u52a8\u591a\u4e2a\u8fde\u63a5\u5668\u65f6\u907f\u514d\u5feb\u7167\u4e2d\u65ad\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8fde\u63a5\u5668\u91cd\u65b0\u5e73\u8861 <p>\u4ee5\u4e0b\u9ad8\u7ea7\u914d\u7f6e\u5c5e\u6027\u5177\u6709\u826f\u597d\u7684\u9ed8\u8ba4\u503c\uff0c\u53ef\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u56e0\u6b64\u5f88\u5c11\u9700\u8981\u5728\u8fde\u63a5\u5668\u7684\u914d\u7f6e\u4e2d\u6307\u5b9a | \u5c5e\u6027 | \u9ed8\u8ba4 | \u63cf\u8ff0 | | :------: | :------: | :------: | | max.queue.size | 8192 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u5c06\u6570\u636e\u5e93\u65e5\u5fd7\u5199\u5165Kafka\u4e4b\u524d\u5c06\u66f4\u6539\u4e8b\u4ef6\u4ece\u6570\u636e\u5e93\u65e5\u5fd7\u4e2d\u8bfb\u53d6\u7684\u963b\u585e\u961f\u5217\u7684\u6700\u5927\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u5f53\u5199\u5165Kafka\u8f83\u6162\u6216\u8005Kafka\u4e0d\u53ef\u7528\u65f6\uff0c\u6b64\u961f\u5217\u53ef\u4ee5\u5411oplog\u8bfb\u53d6\u5668\u63d0\u4f9b\u53cd\u538b\u3002\u961f\u5217\u4e2d\u51fa\u73b0\u7684\u4e8b\u4ef6\u4e0d\u5305\u542b\u5728\u6b64\u8fde\u63a5\u5668\u5b9a\u671f\u8bb0\u5f55\u7684\u504f\u79fb\u4e2d\u3002\u9ed8\u8ba4\u4e3a8192\uff0c\u5e76\u4e14\u5e94\u59cb\u7ec8\u5927\u4e8emax.batch.size\u5c5e\u6027\u4e2d\u6307\u5b9a\u7684\u6700\u5927\u6279\u91cf\u5927\u5c0f\u3002 | | max.batch.size | 2048 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u6b64\u8fde\u63a5\u5668\u7684\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u5904\u7406\u7684\u6bcf\u6279\u4e8b\u4ef6\u7684\u6700\u5927\u5927\u5c0f\u3002\u9ed8\u8ba4\u4e3a2048\u3002 | | poll.interval.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u8fde\u63a5\u5668\u5728\u6bcf\u6b21\u8fed\u4ee3\u671f\u95f4\u5e94\u51fa\u73b0\u7684\u6beb\u79d2\u6570\uff0c\u4ee5\u663e\u793a\u65b0\u7684\u66f4\u6539\u4e8b\u4ef6\u3002\u9ed8\u8ba4\u4e3a1000\u6beb\u79d2\u62161\u79d2\u3002 | | connect.backoff.initial.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u7b2c\u4e00\u6b21\u5c1d\u8bd5\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u521d\u59cb\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a1\u79d2\uff081000\u6beb\u79d2\uff09\u3002 | | connect.backoff.max.delay.ms | 1000 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u91cd\u590d\u5931\u8d25\u7684\u8fde\u63a5\u5c1d\u8bd5\u540e\u6216\u6ca1\u6709\u4e3b\u8282\u70b9\u53ef\u7528\u65f6\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\u7684\u6700\u5927\u5ef6\u8fdf\u3002\u9ed8\u8ba4\u4e3a120\u79d2\uff08120,000\u6beb\u79d2\uff09\u3002 | | connect.max.attempts | 16 | \u6b63\u6574\u6570\u503c\uff0c\u6307\u5b9a\u5728\u53d1\u751f\u5f02\u5e38\u5e76\u4e14\u4efb\u52a1\u4e2d\u6b62\u4e4b\u524d\uff0c\u5bf9\u526f\u672c\u96c6\u4e3b\u8981\u8fde\u63a5\u5c1d\u8bd5\u5931\u8d25\u7684\u6700\u5927\u6b21\u6570\u3002\u7f3a\u7701\u503c\u4e3a16\uff0c\u5176\u4e0e\u9ed8\u8ba4\u503cconnect.backoff.initial.delay.ms\u548cconnect.backoff.max.delay.ms\u5931\u6548\u4e4b\u524d\u5bfc\u81f4\u4ec5\u670920\u591a\u5206\u949f\u7684\u5c1d\u8bd5\u3002 | | mongodb.members.auto.discover | true | \u5e03\u5c14\u503c\uff0c\u6307\u5b9a'mongodb.hosts'\u4e2d\u7684\u5730\u5740\u662f\u5426\u5e94\u8be5\u7528\u4e8e\u53d1\u73b0\u96c6\u7fa4\u6216\u526f\u672c\u96c6\uff08true\uff09\u7684\u6240\u6709\u6210\u5458\u7684\u79cd\u5b50\uff0c\u6216\u8005\u662f\u5426mongodb.hosts\u5e94\u8be5\u6309\u539f\u6837\u4f7f\u7528\u5730\u5740\uff08false\uff09\u3002\u9ed8\u8ba4\u503c\u662ftrue\u5e76\u4e14\u5e94\u8be5\u5728\u6240\u6709\u60c5\u51b5\u4e0b\u4f7f\u7528\uff0c\u9664\u975eMongoDB \u7531\u4ee3\u7406\u63d0\u4f9b |</p> Markdown<pre><code>\u5b89\u88c5debezium-connector-mongodb\n\u542f\u52a8zookeeper   zookeeper-server-start zookeeper.properties\n\n\u542f\u52a8kafka       kafka-server-start    server.properties\n\n\u542f\u52a8schema-registry-start schema-registry.properties\n\nexport CLASSPATH=/path/to/my/connectors/*\n\u542f\u52a8connect-standalone  /schema-registry/\nconnect-avro-standalone.properties kafka/connect-mongo-source.properties\n\n\u542f\u52a8kafka consumer  kafka-console-consumer --zookeeper localhost:2181 --topic test.test.test --from-beginning\n\nschema-registry/connect-avro-distributed.properties\u6dfb\u52a0debezium-connector-mongodb\u7684plugin.path=\n\n\u914d\u7f6eDebezium MongoDB connector\nconnect.json\n{\n  \"name\": \"inventory-connector\",  (1)\n  \"config\": {\n    \"connector.class\": \"io.debezium.connector.mongodb.MongoDbConnector\", (2)\n    \"mongodb.hosts\": \"rs0/192.168.99.100:27017\", (3)\n    \"mongodb.name\": \"fullfillment\", (4)\n    \"collection.whitelist\": \"inventory[.]*\", (5)\n  }\n}\n1 \u6211\u4eec\u4f7f\u7528Kafka Connect\u670d\u52a1\u6ce8\u518c\u65f6\u7684\u8fde\u63a5\u5668\u540d\u79f0\n2 MongoDB\u8fde\u63a5\u5668\u7c7b\u7684\u540d\u79f0\n3 \u7528\u4e8e\u8fde\u63a5MongoDB\u526f\u672c\u96c6\u7684\u4e3b\u673a\u5730\u5740\n4 \u8be5MongoDB\u7684\u526f\u672c\u96c6\u903b\u8f91\u540d\u79f0\uff0c\u5f62\u6210\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u4ea7\u751f\u7684\u4e8b\u4ef6\uff0c\u5e76\u5728kafka\u7684topics\uff0ckafka\u8fde\u63a5\u67b6\u6784\u540d\u79f0\u4e2d\u7684\u6240\u6709\u540d\u79f0\u4f7f\u7528\uff0c\u4ee5\u53ca\u76f8\u5e94\u7684Avro\u67b6\u6784\u7684\u547d\u540d\u7a7a\u95f4\u65f6\u7684Avro\u4f7f\u7528\n5 \u4e0e\u8981\u76d1\u89c6\u7684\u6240\u6709\u96c6\u5408\u7684\u96c6\u5408\u540d\u79f0\u7a7a\u95f4\uff08\u4f8b\u5982\uff0cdbName collectionName\uff09\u5339\u914d\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5217\u8868\u3002\u8fd9\u662f\u53ef\u9009\u7684\n\n\u52a0\u8f7d\u8fde\u63a5\u5c31\u662f\u914d\u7f6econnect-mongo-source.properties\ncurl -i -X POST -H \"Accept:application/json\" -H  \"Content-Type:application/json\" http://localhost:8084/connectors/ -d @/etc/kafka/mongodb.json\n\n\u67e5\u770bkafka\u7684topics\nkafka-topics --zookeeper localhost:2181 --list\n\ndb.getCollection(\"rent_houses\").find({\n    \"price\": { \"$lte\": 2000 },\n    \"title\": { \"$in\": [ /\u8f6c\u79df/,/\u6574\u79df/ ] }\n     })\n</code></pre>"},{"location":"database/MySQL/","title":"MySQL","text":"Markdown<pre><code>\u6570\u636e\u5b9a\u4e49\u8bed\u8a00(DDL \uff0cData Defintion Language)\u8bed\u53e5\uff1a\u6570\u636e\u5b9a\u4e49\u8bed\u53e5\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540c\u7684\u6570\u636e\u6bb5\u3001\u6570\u636e\u5e93\u3001\u8868\u3001\u5217\u3001\u7d22\u5f15\u7b49\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62eccreate\u3001drop\u3001alter\u7b49\n\u6570\u636e\u64cd\u4f5c\u8bed\u8a00(DML \uff0c Data Manipulation Language)\u8bed\u53e5\uff1a\u6570\u636e\u64cd\u7eb5\u8bed\u53e5\uff0c\u7528\u4e8e\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u65b0\u548c\u67e5\u8be2\u6570\u636e\u5e93\u8bb0\u5f55\uff0c\u5e76\u68c0\u67e5\u6570\u636e\u7684\u5b8c\u6574\u6027\u3002\u5e38\u7528\u7684\u8bed\u53e5\u5173\u952e\u5b57\u4e3b\u8981\u5305\u62ecinsert\u3001delete\u3001update\u548cselect\u7b49\n\u6570\u636e\u63a7\u5236\u8bed\u8a00(DCL\uff0c Data Control Language)\u8bed\u53e5\uff1a\u6570\u636e\u63a7\u5236\u8bed\u53e5\uff0c\u7528\u4e8e\u63a7\u5236\u4e0d\u540c\u6570\u636e\u6bb5\u76f4\u63a5\u7684\u8bb8\u53ef\u548c\u8bbf\u95ee\u7ea7\u522b\u7684\u8bed\u53e5\u3002\u8fd9\u4e9b\u8bed\u53e5\u5b9a\u4e49\u4e86\u6570\u636e\u5e93\u3001\u8868\u3001\u5b57\u6bb5\u3001\u7528\u6237\u7684\u8bbf\u95ee\u6743\u9650\u548c\u5b89\u5168\u7ea7\u522b\u3002\u4e3b\u8981\u7684\u8bed\u53e5\u5173\u952e\u5b57\u5305\u62ecgrant\u3001revoke\u7b49\n</code></pre>"},{"location":"database/MySQL/#mysql_1","title":"\u5b89\u88c5mysql","text":"Markdown<pre><code>MySQL 5.7.6 and later:\nALTER USER 'root'@'localhost' IDENTIFIED BY '857f946d1cb5d3c5bab78cddeac22dbc7879a813';\n\nMySQL 5.7.5 and earlier:\nSET PASSWORD FOR 'root'@'localhost' = PASSWORD('MyNewPass');\n\nflush privileges\n\u4ece\u4efb\u4f55\u4e3b\u673a\u4e0a\u4f7f\u7528root\u7528\u6237\uff0c\u5bc6\u7801\uff1ayoupassword\uff08\u4f60\u7684root\u5bc6\u7801\uff09\u8fde\u63a5\u5230mysql\u670d\u52a1\u5668\uff1a\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'youpassword' WITH GRANT OPTION;\n</code></pre>"},{"location":"database/MySQL/#mysql_2","title":"MySQL\u914d\u7f6e\u6587\u4ef6","text":"Markdown<pre><code>[client]\n#password   = your_password\nport        = 3306\nsocket        = /tmp/mysql.sock\n\n[mysqld]\nuser        = mysql\nport        = 3306\nsocket        = /tmp/mysql.sock\ndatadir = /www/server/data\n#default_storage_engine = MyISAM\ndefault_storage_engine = InnoDB\n#skip-external-locking\n#loose-skip-innodb\nkey_buffer_size = 8M\nmax_allowed_packet = 100G\ntable_open_cache = 32\nsort_buffer_size = 256K\njoin_buffer_size = 256k\nnet_buffer_length = 4K\nread_buffer_size = 128K\nread_rnd_buffer_size = 256K\nmyisam_sort_buffer_size = 4M\nthread_cache_size = 4\nthread_concurrency = 2\nthread_stack = 192k\nquery_cache_size = 4M\nquery_cache_limit = 1M\nquery_cache_min_res_unit = 2k\nlong_query_time = 1\ntmp_table_size = 8M\nmax_head_table_size = 2M\nbinlog_cache_size = 1M\nmax_binlog_cache_size = 1M\nmax_binlog_size = 2M\nexternal-locking = FALSE\nbulk_insert_buffer_size = 1M\nlower_case_table_names = 1\nslave-skip-errors = 1032,1062\nreplicate-ignore-db = mysql\n\n\n#skip-networking\n#skip-name-resolve\nmax_connections = 500\nmax_connect_errors = 100\nopen_files_limit = 65535\nback_log = 600\ntable_cache = 614\n\nlog-bin=mysql-bin   # \u6ce8\u610f\u8981\u5728[mysqld]\u4e2d\u914d\u7f6e\nbinlog_format=mixed\nserver-id   = 1     # \u4e3b\u4ece\u590d\u5236\u591a\u5b9e\u4f8b\u4e2did\u5747\u4e0d\u80fd\u76f8\u540c\u4e5f\u8981\u5728[mysqld]\u4e2d\u914d\u7f6e\nexpire_logs_days = 10\n\ndefault_storage_engine = InnoDB\ninnodb_data_home_dir = /www/server/data\ninnodb_data_file_path = ibdata1:10M:autoextend\ninnodb_log_group_home_dir = /www/server/data\ninnodb_buffer_pool_size = 16M\ninnodb_additional_mem_pool_size = 2M\ninnodb_log_file_size = 5M\ninnodb_log_buffer_size = 8M\ninnodb_flush_log_at_trx_commit = 1\ninnodb_lock_wait_timeout = 50\ninnodb_file_io_threads = 4\ninnodb_thread_concurrency = 8\ninnodb_log_files_in_group = 3\ninnodb_max_dirty_pages_pct= 90\ninnodb_file_per_table = 0\n\n[mysqldump]\nquick\nmax_allowed_packet = 16M\n\n[mysql]\nno-auto-rehash\n\n[myisamchk]\nkey_buffer_size = 20M\nsort_buffer_size = 20M\nread_buffer = 2M\nwrite_buffer = 2M\n\n[mysqlhotcopy]\ninteractive-timeout\n</code></pre>"},{"location":"database/MySQL/#mysql_3","title":"mysql\u76f8\u5173\u547d\u4ee4","text":""},{"location":"database/MySQL/#mysql_4","title":"mysql","text":"Markdown<pre><code>Usage: mysql [OPTIONS] [database]\n  -?, --help          Display this help and exit.\n  -I, --help          Synonym for -?\n  --auto-rehash       Enable automatic rehashing. One doesn't need to use\n                      'rehash' to get table and field completion, but startup\n                      and reconnecting may take a longer time. Disable with\n                      --disable-auto-rehash.\n                      (Defaults to on; use --skip-auto-rehash to disable.)\n  -A, --no-auto-rehash\n                      No automatic rehashing. One has to use 'rehash' to get\n                      table and field completion. This gives a quicker start of\n                      mysql and disables rehashing on reconnect.\n  --auto-vertical-output\n                      Automatically switch to vertical output mode if the\n                      result is wider than the terminal width.\n  -B, --batch         Don't use history file. Disable interactive behavior.\n                      (Enables --silent.)\n  --bind-address=name IP address to bind to.\n  --binary-as-hex     Print binary data as hex\n  --character-sets-dir=name\n                      Directory for character set files.\n  --column-type-info  Display column type information.\n  -c, --comments      Preserve comments. Send comments to the server. The\n                      default is --skip-comments (discard comments), enable\n                      with --comments.\n  -C, --compress      Use compression in server/client protocol.\n  -#, --debug[=#]     This is a non-debug version. Catch this and exit.\n  --debug-check       This is a non-debug version. Catch this and exit.\n  -T, --debug-info    This is a non-debug version. Catch this and exit.\n  -D, --database=name Database to use.\n  --default-character-set=name\n                      Set the default character set.\n  --delimiter=name    Delimiter to be used.\n  --enable-cleartext-plugin\n                      Enable/disable the clear text authentication plugin.\n  -e, --execute=name  Execute command and quit. (Disables --force and history\n                      file.)\n  -E, --vertical      Print the output of a query (rows) vertically.\n  -f, --force         Continue even if we get an SQL error.\n  --histignore=name   A colon-separated list of patterns to keep statements\n                      from getting logged into syslog and mysql history.\n  -G, --named-commands\n                      Enable named commands. Named commands mean this program's\n                      internal commands; see mysql&gt; help . When enabled, the\n                      named commands can be used from any line of the query,\n                      otherwise only from the first line, before an enter.\n                      Disable with --disable-named-commands. This option is\n                      disabled by default.\n  -i, --ignore-spaces Ignore space after function names.\n  --init-command=name SQL Command to execute when connecting to MySQL server.\n                      Will automatically be re-executed when reconnecting.\n  --local-infile      Enable/disable LOAD DATA LOCAL INFILE.\n  -b, --no-beep       Turn off beep on error.\n  -h, --host=name     Connect to host.\n  -H, --html          Produce HTML output.\n  -X, --xml           Produce XML output.\n  --line-numbers      Write line numbers for errors.\n                      (Defaults to on; use --skip-line-numbers to disable.)\n  -L, --skip-line-numbers\n                      Don't write line number for errors.\n  -n, --unbuffered    Flush buffer after each query.\n  --column-names      Write column names in results.\n                      (Defaults to on; use --skip-column-names to disable.)\n  -N, --skip-column-names\n                      Don't write column names in results.\n  --sigint-ignore     Ignore SIGINT (CTRL-C).\n  -o, --one-database  Ignore statements except those that occur while the\n                      default database is the one named at the command line.\n  --pager[=name]      Pager to use to display results. If you don't supply an\n                      option, the default pager is taken from your ENV variable\n                      PAGER. Valid pagers are less, more, cat [&gt; filename],\n                      etc. See interactive help (\\h) also. This option does not\n                      work in batch mode. Disable with --disable-pager. This\n                      option is disabled by default.\n  -p, --password[=name]\n                      Password to use when connecting to server. If password is\n                      not given it's asked from the tty.\n  -P, --port=#        Port number to use for connection or 0 for default to, in\n                      order of preference, my.cnf, $MYSQL_TCP_PORT,\n                      /etc/services, built-in default (3306).\n  --prompt=name       Set the mysql prompt to this value.\n  --protocol=name     The protocol to use for connection (tcp, socket, pipe,\n                      memory).\n  -q, --quick         Don't cache result, print it row by row. This may slow\n                      down the server if the output is suspended. Doesn't use\n                      history file.\n  -r, --raw           Write fields without conversion. Used with --batch.\n  --reconnect         Reconnect if the connection is lost. Disable with\n                      --disable-reconnect. This option is enabled by default.\n                      (Defaults to on; use --skip-reconnect to disable.)\n  -s, --silent        Be more silent. Print results with a tab as separator,\n                      each row on new line.\n  -S, --socket=name   The socket file to use for connection.\n  --ssl-mode=name     SSL connection mode.\n  --ssl               Deprecated. Use --ssl-mode instead.\n                      (Defaults to on; use --skip-ssl to disable.)\n  --ssl-verify-server-cert\n                      Deprecated. Use --ssl-mode=VERIFY_IDENTITY instead.\n  --ssl-ca=name       CA file in PEM format.\n  --ssl-capath=name   CA directory.\n  --ssl-cert=name     X509 cert in PEM format.\n  --ssl-cipher=name   SSL cipher to use.\n  --ssl-key=name      X509 key in PEM format.\n  --ssl-crl=name      Certificate revocation list.\n  --ssl-crlpath=name  Certificate revocation list path.\n  --tls-version=name  TLS version to use, permitted values are: TLSv1, TLSv1.1\n  -t, --table         Output in table format.\n  --tee=name          Append everything into outfile. See interactive help (\\h)\n                      also. Does not work in batch mode. Disable with\n                      --disable-tee. This option is disabled by default.\n  -u, --user=name     User for login if not current user.\n  -U, --safe-updates  Only allow UPDATE and DELETE that uses keys.\n  -U, --i-am-a-dummy  Synonym for option --safe-updates, -U.\n  -v, --verbose       Write more. (-v -v -v gives the table output format).\n  -w, --wait          Wait and retry if connection is down.\n  --connect-timeout=# Number of seconds before connection timeout.\n  --max-allowed-packet=#\n                      The maximum packet length to send to or receive from\n                      server.\n  --net-buffer-length=#\n                      The buffer size for TCP/IP and socket communication.\n  --select-limit=#    Automatic limit for SELECT when using --safe-updates.\n  --max-join-size=#   Automatic limit for rows in a join when using\n                      --safe-updates.\n  --secure-auth       Refuse client connecting to server if it uses old\n                      (pre-4.1.1) protocol. Deprecated. Always TRUE\n  --server-arg=name   Send embedded server this as a parameter.\n  --show-warnings     Show warnings after every statement.\n  -j, --syslog        Log filtered interactive commands to syslog. Filtering of\n                      commands depends on the patterns supplied via histignore\n                      option besides the default patterns.\n  --plugin-dir=name   Directory for client-side plugins.\n  --default-auth=name Default authentication client-side plugin to use.\n  --binary-mode       By default, ASCII '\\0' is disallowed and '\\r\\n' is\n                      translated to '\\n'. This switch turns off both features,\n                      and also turns off parsing of all clientcommands except\n                      \\C and DELIMITER, in non-interactive mode (for input\n                      piped to mysql or loaded using the 'source' command).\n                      This is necessary when processing output from mysqlbinlog\n                      that may contain blobs.\n  --connect-expired-password\n                      Notify the server that this client is prepared to handle\n                      expired password sandbox mode.\n\nDefault options are read from the following files in the given order:\n/etc/my.cnf /etc/mysql/my.cnf ~/.my.cnf\nThe following groups are read: mysql client\nThe following options may be given as the first argument:\n--print-defaults        Print the program argument list and exit.\n--no-defaults           Don't read default options from any option file,\n                        except for login file.\n--defaults-file=#       Only read default options from the given file #.\n--defaults-extra-file=# Read this file after the global files are read.\n--defaults-group-suffix=#\n                        Also read groups with concat(group, suffix)\n--login-path=#          Read this path from the login file.\n\nVariables (--variable-name=value)\nand boolean options {FALSE|TRUE}  Value (after reading options)\n--------------------------------- ----------------------------------------\nauto-rehash                       FALSE\nauto-vertical-output              FALSE\nbind-address                      (No default value)\nbinary-as-hex                     FALSE\ncharacter-sets-dir                (No default value)\ncolumn-type-info                  FALSE\ncomments                          FALSE\ncompress                          FALSE\ndatabase                          (No default value)\ndefault-character-set             utf8\ndelimiter                         ;\nenable-cleartext-plugin           FALSE\nvertical                          FALSE\nforce                             FALSE\nhistignore                        (No default value)\nnamed-commands                    FALSE\nignore-spaces                     FALSE\ninit-command                      (No default value)\nlocal-infile                      FALSE\nno-beep                           FALSE\nhost                              (No default value)\nhtml                              FALSE\nxml                               FALSE\nline-numbers                      TRUE\nunbuffered                        FALSE\ncolumn-names                      TRUE\nsigint-ignore                     FALSE\nport                              3306\nprompt                            mysql&gt;\nquick                             FALSE\nraw                               FALSE\nreconnect                         TRUE\nsocket                            /var/run/mysqld/mysqld.sock\nssl                               TRUE\nssl-verify-server-cert            FALSE\nssl-ca                            (No default value)\nssl-capath                        (No default value)\nssl-cert                          (No default value)\nssl-cipher                        (No default value)\nssl-key                           (No default value)\nssl-crl                           (No default value)\nssl-crlpath                       (No default value)\ntls-version                       (No default value)\ntable                             FALSE\nuser                              (No default value)\nsafe-updates                      FALSE\ni-am-a-dummy                      FALSE\nconnect-timeout                   0\nmax-allowed-packet                16777216\nnet-buffer-length                 16384\nselect-limit                      1000\nmax-join-size                     1000000\nsecure-auth                       TRUE\nshow-warnings                     FALSE\nplugin-dir                        (No default value)\ndefault-auth                      (No default value)\nbinary-mode                       FALSE\nconnect-expired-password          FALSE\n</code></pre>"},{"location":"database/MySQL/#mysqladmin","title":"mysqladmin","text":"Markdown<pre><code>create databasename\uff1a\u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u636e\u5e93\ndrop databasename\uff1a\u5220\u9664\u4e00\u4e2a\u6570\u636e\u5e93\u53ca\u5176\u6240\u6709\u8868\nextended-status\uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u4e00\u4e2a\u6269\u5c55\u72b6\u6001\u6d88\u606f\nflush-hosts\uff1a\u6e05\u7a7a\u6240\u6709\u7f13\u5b58\u7684\u4e3b\u673a\nflush-logs\uff1a\u6e05\u7a7a\u6240\u6709\u65e5\u5fd7\nflush-tables\uff1a\u6e05\u7a7a\u6240\u6709\u8868\nflush-privileges\uff1a\u518d\u6b21\u88c5\u8f7d\u6388\u6743\u8868(\u540creload)\nkill id,id,...\uff1a\u6740\u6b7bmysql\u7ebf\u7a0b\npassword \u65b0\u53e3\u4ee4\uff1a\u5c06\u8001\u5bc6\u7801\u6539\u4e3a\u65b0\u5bc6\u7801\nping\uff1a\u68c0\u67e5mysqld\u662f\u5426\u6d3b\u7740\nprocesslist\uff1a\u663e\u793a\u670d\u52a1\u5176\u4e2d\u6d3b\u8dc3\u7ebf\u7a0b\u5217\u8868\nreload\uff1a\u91cd\u8f7d\u6388\u6743\u8868\nrefresh\uff1a\u6e05\u7a7a\u6240\u6709\u8868\u5e76\u5173\u95ed\u548c\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\nshutdown\uff1a\u5173\u6389\u670d\u52a1\u5668\nstatus\uff1a\u7ed9\u51fa\u670d\u52a1\u5668\u7684\u7b80\u77ed\u72b6\u6001\u6d88\u606f\nvariables\uff1a\u6253\u5370\u51fa\u53ef\u7528\u53d8\u91cf\nversion\uff1a\u5f97\u5230\u670d\u52a1\u5668\u7684\u7248\u672c\u4fe1\u606f\n</code></pre>"},{"location":"database/MySQL/#mysqlshow","title":"mysqlshow","text":"Markdown<pre><code>-h\uff1aMySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d\n-u\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d\n-p\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801\n--count\uff1a\u663e\u793a\u6bcf\u4e2a\u6570\u636e\u8868\u4e2d\u6570\u636e\u7684\u884c\u6570\n-k\uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7d22\u5f15\n-t\uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u7c7b\u578b\n-i\uff1a\u663e\u793a\u6570\u636e\u8868\u7684\u989d\u5916\u4fe1\u606f\n</code></pre>"},{"location":"database/MySQL/#mysqlimport","title":"mysqlimport","text":"Markdown<pre><code>-D\uff1a\u5bfc\u5165\u6570\u636e\u524d\u6e05\u7a7a\u8868\n-f\uff1a\u51fa\u73b0\u9519\u8bef\u65f6\u7ee7\u7eed\u5904\u7406\u5269\u4f59\u7684\u64cd\u4f5c\n-h\uff1aMySQL\u670d\u52a1\u5668\u7684ip\u5730\u5740\u6216\u4e3b\u673a\u540d\n-u\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d\n-p\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801\n</code></pre>"},{"location":"database/MySQL/#mysqldump","title":"mysqldump","text":"Markdown<pre><code>--add-drop-table\uff1a\u5728\u6bcf\u4e2a\u521b\u5efa\u6570\u636e\u5e93\u8868\u8bed\u53e5\u524d\u6dfb\u52a0\u5220\u9664\u6570\u636e\u5e93\u8868\u7684\u8bed\u53e5\n--add-locks\uff1a\u5907\u4efd\u6570\u636e\u5e93\u8868\u65f6\u9501\u5b9a\u6570\u636e\u5e93\u8868\n--all-databases\uff1a\u5907\u4efdMySQL\u670d\u52a1\u5668\u4e0a\u7684\u6240\u6709\u6570\u636e\u5e93\n--comments\uff1a\u6dfb\u52a0\u6ce8\u91ca\u4fe1\u606f\n--compact\uff1a\u538b\u7f29\u6a21\u5f0f\uff0c\u4ea7\u751f\u66f4\u5c11\u7684\u8f93\u51fa\n--complete-insert\uff1a\u8f93\u51fa\u5b8c\u6210\u7684\u63d2\u5165\u8bed\u53e5\n--databases\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u7684\u6570\u636e\u5e93\n--default-character-set\uff1a\u6307\u5b9a\u9ed8\u8ba4\u5b57\u7b26\u96c6\n--force\uff1a\u5f53\u51fa\u73b0\u9519\u8bef\u65f6\u4ecd\u7136\u7ee7\u7eed\u5907\u4efd\u64cd\u4f5c\n--host\uff1a\u6307\u5b9a\u8981\u5907\u4efd\u6570\u636e\u5e93\u7684\u670d\u52a1\u5668\n--lock-tables\uff1a\u5907\u4efd\u524d\uff0c\u9501\u5b9a\u6240\u6709\u6570\u636e\u5e93\u8868\n--no-create-db\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u8bed\u53e5\n--no-create-info\uff1a\u7981\u6b62\u751f\u6210\u521b\u5efa\u6570\u636e\u5e93\u5e93\u8868\u8bed\u53e5\n--password\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u5bc6\u7801\n--port\uff1aMySQL\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7\n--user\uff1a\u8fde\u63a5MySQL\u670d\u52a1\u5668\u7684\u7528\u6237\u540d\n</code></pre> Bash<pre><code>mysqldump -u linuxde -p smgp_apps_linuxde &gt; linuxde.sql     # \u5bfc\u51fa\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d &gt; \u5bfc\u51fa\u7684\u6587\u4ef6\u540d\nmysqldump -u linuxde -p smgp_apps_linuxde users &gt; linuxde_users.sql     # \u5bfc\u51fa\u4e00\u4e2a\u8868\uff0c\u683c\u5f0f\uff1amysqldump -u \u7528\u6237\u540d -p \u6570\u636e\u5e93\u540d \u8868\u540d&gt; \u5bfc\u51fa\u7684\u6587\u4ef6\u540d\nmysqldump -u linuxde -p -d --add-drop-table smgp_apps_linuxde &gt; linuxde_db.sql      # \u5bfc\u51fa\u4e00\u4e2a\u6570\u636e\u5e93\u7ed3\u6784\n</code></pre>"},{"location":"database/MySQL/#mysql_5","title":"MySQL\u6162\u65e5\u5fd7","text":"SQL<pre><code>\u6162\u65e5\u5fd7\u5f00\u542f\u65b9\u5f0f\u548c\u5b58\u50a8\u683c\u5f0f\uff1a\n\u524d\u671f\u51c6\u5907-\u67e5\u8be2\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1ashow variables like '%log_queri%';\n\u8bb0\u5f55\u672a\u4f7f\u7528\u7d22\u5f15\u7684\u67e5\u8be2\uff1aset global log_queries_not_using_indexes=on;\n\u67e5\u8be2\u6162\u65e5\u5fd7\u5f00\u542f\u72b6\u6001\uff1ashow variables like 'slow_query_log';\n\u5f00\u542f\u6162\u65e5\u5fd7\uff1aset global slow_query_log=on;\n\u628a\u5927\u4e8e10\u6beb\u79d2\u7684\u67e5\u8be2\u8bb0\u5f55\u5230\u65e5\u5fd7\u91cc\uff1ashow variables like 'long_query_time';\n\u67e5\u770b\u6162\u65e5\u5fd7\u4f4d\u7f6e\uff1ashow variables like 'slow_query_log_file%';\n\u67e5\u770bmysql\u5404\u5185\u5b58\u7684\u5206\u914d\u60c5\u51b5\uff1ashow variables like 'innodb_%_size';\n\u67e5\u770binnodb_buffer_pool\u7684\u8fd0\u884c\u72b6\u6001\uff1ashow engine innodb status;\n\u901a\u8fc7\u8bed\u53e5\u67e5\u770bMySQL\u6570\u636e\u50a8\u5b58\u4f4d\u7f6e\uff1ashow global variables like \"%datadir%\";\n\u4e3a\u4e86\u9632\u6b62\u67e5\u8be2\u7f13\u5b58\u7ecf\u5e38\u88ab\u638f\u7a7a(Potentially Undersized)\uff0c\u6700\u597d\u662f\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf\uff0c\u6539\u53d8\u53d8\u91cf\u4e4b\u524d\uff0c\u5148\u67e5\u770b\u53d8\u91cf\u58f0\n\u660e\u7684\u5f53\u524d\u503c\uff1ashow variables like 'query_cache%';\n</code></pre> SQL<pre><code>\u6388\u6743\u7528\u6237\u4ece\u8fdc\u7a0b\u767b\u5f55:\n1\u3001\u6539\u8868\u6cd5\u3002\u53ef\u80fd\u662f\u4f60\u7684\u5e10\u53f7\u4e0d\u5141\u8bb8\u4ece\u8fdc\u7a0b\u767b\u9646\uff0c\u53ea\u80fd\u5728localhost\u3002\u8fd9\u4e2a\u65f6\u5019\u53ea\u8981\u5728localhost\u7684\u90a3\u53f0\u7535\u8111\uff0c\u767b\n\u5165mysql\u540e\uff0c\u66f4\u6539 \"mysql\" \u6570\u636e\u5e93\u91cc\u7684 \"user\" \u8868\u91cc\u7684 \"host\" \u9879\uff0c\u4ece\"localhost\"\u6539\u79f0\"%\"\nmysql -u root -pvmware;\nmysql&gt;use mysql;\nmysql&gt;update user set host = '%' where user = 'root';\nmysql&gt;select host, user from user;\n2\u3001\u6388\u6743\u6cd5\u3002\u4f8b\u5982\uff0c\u4f60\u60f3myuser\u4f7f\u7528mypassword\u4ece\u4efb\u4f55\u4e3b\u673a\u8fde\u63a5\u5230mysql\u670d\u52a1\u5668\u7684\u8bdd\nGRANT ALL PRIVILEGES ON *.* TO 'myuser'@'%' IDENTIFIED BY 'mypassword' WITH GRANT OPTION;\n\u5982\u679c\u4f60\u60f3\u5141\u8bb8\u7528\u6237myuser\u4eceip\u4e3a192.168.1.3\u7684\u4e3b\u673a\u8fde\u63a5\u5230mysql\u670d\u52a1\u5668\uff0c\u5e76\u4f7f\u7528mypassword\u4f5c\u4e3a\u5bc6\u7801\nGRANT ALL PRIVILEGES ON *.* TO 'myuser'@'192.168.1.3' IDENTIFIED BY 'mypassword' WITH GRANT\nOPTION;\n\u3010\u4e0b\u9762\u8fd9\u4e00\u53e5\u4e00\u5b9a\u8981\u6267\u884c\uff0c\u5426\u5219\u8fd8\u662f\u65e0\u6cd5\u767b\u9646\u3011\nmysql&gt;flush privileges ;\n\u5982\u679croot\u7528\u6237\u65e0\u6cd5\u4ece\u672c\u5730\u767b\u9646\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u6267\u884c\u5982\u4e0b\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost.localdomain' IDENTIFIED BY '\u5bc6\u7801' WITH GRANT\nOPTION;\n\u67e5\u770b\u67e5\u8be2\u7f13\u5b58\u7cfb\u7edf\u5c5e\u6027\uff1ashow variables like '%_cache_%';\n\u8bbe\u7f6e\u67e5\u8be2\u7f13\u5b58\u7c7b\u578b\uff1aquery_cache_type\n0\u6216OFF\uff1a\u4e0d\u542f\u52a8\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\n1\u6216ON\uff1a\u7f13\u5b58\u9664\u4e86\u4ee5SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u6240\u6709\u67e5\u8be2\u7ed3\u679c\n2\u6216DEMAND\uff1a\u53ea\u7f13\u5b58\u4ee5SELECT SQL_NO_CACHE\u5f00\u5934\u7684\u67e5\u8be2\u7ed3\u679c\n\u4e0d\u7f13\u5b58\u5927\u4e8e\u8be5\u503c\u7684\u7ed3\u679c\u3002\u9ed8\u8ba4\u503c\u662f1048576(1MB)\u3002\uff1aquery_cache_limit\n\u7f13\u5b58\u67e5\u8be2\u7ed3\u679c\u5206\u914d\u7684\u5185\u5b58\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f0\uff0c\u5373\u7981\u7528\u67e5\u8be2\u7f13\u5b58\u3002\uff1aquery_cache_size\n\u67e5\u8be2\u7f13\u5b58\u5206\u914d\u7684\u6700\u5c0f\u5757\u7684\u5927\u5c0f(\u5b57\u8282)\u3002 \u9ed8\u8ba4\u503c\u662f4096(4KB)\u3002\uff1aquery_cache_min_res_unit\nquery_cache_wlock_invalidate\n0\u6216OFF\uff1a\u5f53\u67e5\u8be2\u7ed3\u679c\u4f4d\u4e8e\u67e5\u8be2\u7f13\u5b58\u4e2d\uff0c\u5ba2\u6237\u7aef\u5bf9MyISAM\uff08\u9ed8\u8ba4\u5b58\u50a8\u5f15\u64ce\uff09\u8868\u8fdb\u884cWRITE\u9501\u5b9a\u65f6\uff0c\u5176\u4ed6\u5ba2\n\u6237\u7aef\u53ef\u4ee5\u5bf9\u8be5\u8868\u67e5\u8be2\n1\u6216ON\uff1a\u9501\u5b9a\u751f\u6548\u65f6\uff0c\u67e5\u8be2\u7f13\u5b58\u5185\u6240\u6709\u5bf9\u8be5\u8868\u8fdb\u884c\u7684\u67e5\u8be2\u53d8\u5f97\u975e\u6cd5\uff0c\u5f3a\u5236\u8bbf\u95ee\u8be5\u8868\u7684\u5176\u4ed6\u5ba2\u6237\u7aef\u8fdb\u884c\u7b49\n\u5f85\n\u67e5\u770b\u6700\u5927\u8fde\u63a5\u6570\uff1ashow variables like '%CONNECTION%';\nMySQL\u5efa\u8868\u8bed\u53e5\u5927\u5168\n1. \u521b\u5efa\u8868\uff08\u542b\u6709\u7ea6\u675f\uff09\n/**\u521b\u5efa\u7ec4\u8868**/\ncreate table t_group(\nid int(11) auto_increment primary key,\nname varchar(50),\nvalue varchar(255)\n)engine=InnoDB default charset=utf8;\n/**\u521b\u5efa\u7528\u6237\u8868**/\ncreate table t_user(\nid int(11) auto_increment primary key,\nname varchar(50) unique,\nvalue varchar(255) default '0',\nemail varchar(100) not null,\nsex varchar(1) check(user_sex=1 or user_sex=2),\ngroup_id int(11),\ncreate_time timestamp,\nconstraint foreign key(group_id) references t_group(id) on delete cascade\n)engine=InnoDB default charset=utf8;\n/**\u67e5\u770b\u8868\u4fe1\u606f**/\ndesc t_group;\nshow create table t_group;\ndesc t_user;\nshow create table t_user;\n\u81ea\u52a8\u589e\u957f\uff1aauto_increment \u521b\u5efa\u4e3b\u952e\uff1aprimary key \u552f\u4e00\u7ea6\u675f: unique \u975e\u7a7a\u7ea6\u675f\uff1anot null\n\u68c0\u67e5\u7ea6\u675f: check(user_sex=1 or user_sex=2)\n\u521b\u5efa\u5916\u952e\uff1aconstraint foreign key(group_id) references t_group(id) on delete cascade\n2\u3001\u521b\u5efa\u8868\uff08\u4e0d\u542b\u7ea6\u675f\uff09\n/**\u521b\u5efa\u7ec4\u8868**/\ncreate table t_group(\nid int(11),\nname varchar(50),\nvalue varchar(255)\n)engine=InnoDB default charset=utf8;\n/**\u521b\u5efa\u7528\u6237\u8868**/\ncreate table t_user(\nid int(11),\nname varchar(50),\nvalue varchar(255) default '0',\nemail varchar(100),\nsex varchar(1),\ngroup_id int(11),\ncreate_time timestamp\n)engine=InnoDB default charset=utf8;\n/**\u67e5\u770b\u8868\u4fe1\u606f**/\ndesc t_group;\nshow create table t_group;\ndesc t_user;\nshow create table t_user;\n3. \u521b\u5efa\u7ea6\u675f\n/**\u521b\u5efa\u4e3b\u952e\u7ea6\u675f**/\nalter table t_group add constraint group_id_pk primary key(id);\nalter table t_user add constraint user_id_pk primary key(id);\n/**\u81ea\u52a8\u589e\u957f**/\nalter table t_group modify id int(11) auto_increment;\nalter table t_user modify id int(11) auto_increment;\n/**\u521b\u5efa\u5916\u952e\u7ea6\u675f**/\nalter table t_user add constraint user_group_id_fk foreign key(group_id) references t_group(id);\n/**\u521b\u5efa\u552f\u4e00\u7ea6\u675f**/\nalter table t_group add constraint group_name_uk unique(name);\nalter table t_user add constraint user_name_uk unique(name);\n/**\u521b\u5efa\u975e\u7a7a\u7ea6\u675f**/\nalter table t_user add constraint user_email_nk check(email is not null);\n/**\u521b\u5efa\u68c0\u67e5\u7ea6\u675f**/\nalter table t_user add constraint user_gender_ck check(user_sex=1 or user_sex=2);\n4. \u5220\u9664\u7ea6\u675f\n/**\u5220\u9664\u552f\u4e00\u7ea6\u675f**/\nalter table t_user drop unique key user_name_uk;\n/**\u5220\u9664\u5916\u952e\u7ea6\u675f**/\nalter table t_user drop foreign key user_group_id_fk;\n5. \u4fee\u6539\u8868\u5b57\u6bb5\n/**\u589e\u52a0\u5b57\u6bb5**/\nalter table t_group add description varchar(255);\nalter table t_user add description varchar(255);\n/**\u4fee\u6539\u5b57\u6bb5**/\nalter table t_group modify description varchar(20);\nalter table t_user modify description varchar(20);\n/**\u5220\u9664\u5b57\u6bb5**/\nalter table t_group drop description;\nalter table t_user drop description;\n6.\u5220\u9664\u8868\ndrop table t_user;\ndrop table t_group;\n\n\n\n```bash\n\nMySQL\u6570\u636e\u5e93\u5907\u4efd\u548c\u8fd8\u539f\u7684\u5e38\u7528\u547d\u4ee4\n\n\u5907\u4efdMySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4\n\nmysqldump -hhostname -uusername -ppassword databasename &gt; backupfile.sql\n\n\u5907\u4efdMySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f\n\u5907\u4efdMySQL\u6570\u636e\u5e93\u4e3a\u5e26\u5220\u9664\u8868\u7684\u683c\u5f0f\uff0c\u80fd\u591f\u8ba9\u8be5\u5907\u4efd\u8986\u76d6\u5df2\u6709\u6570\u636e\u5e93\u800c\u4e0d\u9700\u8981\u624b\u52a8\u5220\u9664\u539f\u6709\u6570\u636e\u5e93\n\nmysqldump -\u2013add-drop-table -uusername -ppassword databasename &gt; backupfile.sql\n\n\u76f4\u63a5\u5c06MySQL\u6570\u636e\u5e93\u538b\u7f29\u5907\u4efd\n\nmysqldump -hhostname -uusername -ppassword databasename | gzip &gt; backupfile.sql.gz\n\n\u5907\u4efdMySQL\u6570\u636e\u5e93\u67d0\u4e2a(\u4e9b)\u8868\n\nmysqldump -hhostname -uusername -ppassword databasename specific_table1 specific_table2 &gt; backupfile.sql\n\n\u540c\u65f6\u5907\u4efd\u591a\u4e2aMySQL\u6570\u636e\u5e93\n\nmysqldump -hhostname -uusername -ppassword \u2013databases databasename1 databasename2 databasename3 &gt; multibackupfile.sql\n\n\u4ec5\u4ec5\u5907\u4efd\u6570\u636e\u5e93\u7ed3\u6784\n\nmysqldump \u2013no-data \u2013databases databasename1 databasename2 databasename3 &gt; structurebackupfile.sql\n\n\u5907\u4efd\u670d\u52a1\u5668\u4e0a\u6240\u6709\u6570\u636e\u5e93\n\nmysqldump \u2013all-databases &gt; allbackupfile.sql\n\n\u8fd8\u539fMySQL\u6570\u636e\u5e93\u7684\u547d\u4ee4\n\nmysql -hhostname -uusername -ppassword databasename &lt; backupfile.sql\n\n\u8fd8\u539f\u538b\u7f29\u7684MySQL\u6570\u636e\u5e93\n\ngunzip &lt; backupfile.sql.gz | mysql -uusername -ppassword databasename\n\n\u5c06\u6570\u636e\u5e93\u8f6c\u79fb\u5230\u65b0\u670d\u52a1\u5668\n\nmysqldump -uusername -ppassword databasename | mysql \u2013host=*.*.*.* -C databasename\n</code></pre> <p>\u4e0b\u9762\u7b80\u5355\u63cf\u8ff0MySQL Repl ica tion\u7684\u590d\u5236\u539f\u7406\u8fc7\u7a0b 1)\u5728Slave\u670d\u52a1\u5668\u4e0a\u6267\u884cstartslave\u547d\u4ee4\u5f00\u542f\u4e3b\u4ece\u590d\u5236\u5f00\u5173\uff0c \u5f00\u59cb\u8fdb\u884c\u4e3b\u4ece\u590d\u5236 2)\u6b64\u65f6 Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u4f1a\u901a\u8fc7\u5728Master\u4e0a\u5df2\u7ecf\u6388\u6743\u7684\u590d\u5236\u7528\u6237\u6743\u9650\u8bf7\u6c42\u8fde\u63a5Master\u670d\u52a1\u5668\uff0c \u5e76\u8bf7\u6c42\u4ece\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u7684\u6307\u5b9a \u4f4d\u7f6e\uff08\u65e5\u5fd7\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u5c31\u662f\u5728\u914d\u7f6e\u4e3b\u4ece\u590d\u5236\u670d\u52a1\u65f6\u6267\u884cchangemaster\u547d\u4ee4\u6307\u5b9a\u7684\uff09\u4e4b\u540e\u5f00\u59cb\u53d1\u9001binlog\u65e5\u5fd7\u5185\u5bb9 3) Master\u670d\u52a1\u5668\u63a5\u6536\u5230\u6765\u81eaSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u7684\u8bf7\u6c42\u540e\uff0c \u5176\u4e0a\u8d1f\u8d23\u590d\u5236\u7684l/0\u7ebf\u7a0b\u4f1a\u6839\u636eSlave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u8bf7\u6c42\u7684\u4fe1\u606f\u5206\u6279\u8bfb \u53d6\u6307\u5b9abinlog\u65e5\u5fd7\u6587\u4ef6\u6307\u5b9a\u4f4d\u767b\u4e4b\u540e\u7684binlog\u65e5\u5fd7\u4fe1\u606f\uff0c \u7136\u540e\u8fd4\u56de\u7ed9Slave\u7aef\u76841/0\u7ebf\u7a0b\u3002 \u8fd4\u56de\u7684\u4fe1\u606f\u4e2d\u9664\u4e86binlog\u65e5 \u5fd7\u5185\u5bb9\u5916\uff0c \u8fd8\u6709 \u5728Master\u670d\u52a1\u5668\u7aef\u8bb0\u5f55\u7684\u65b0\u7684binlog\u6587\u4ef6\u540d\u79f0\uff0c \u4ee5\u53ca\u5728\u65b0\u7684binlog\u4e2d\u7684\u4e0b\u4e00\u4e2a\u6307\u5b9a\u66f4\u65b0\u4f4d\u7f6e 4)\u5f53Slave\u670d\u52a1\u5668\u76841/0\u7ebf\u7a0b\u83b7\u53d6\u5230Master\u670d\u52a1\u5668\u4e0a1/0\u7ebf\u7a0b\u53d1\u9001\u7684\u65e5\u5fd7\u5185\u5bb9\u3001\u65e5\u5fd7\u6587\u4ef6\u53ca\u4f4d\u7f6e\u70b9\u540e\uff0c \u4f1a\u5c06binlog\u65e5\u5fd7\u5185\u5bb9\u4f9d\u6b21\u5199\u5230Slave \u7aef\u81ea\u8eab\u7684Relay Log (\u5373\u4e2d\u7ee7\u65e5\u5fd7\uff09\u6587\u4ef6(MySQL-relay-bin.xxxxxx)\u7684\u6700\u672b\u7aef\uff0c \u5e76\u5c06\u65b0\u7684binlog\u6587\u4ef6\u540d\u548c\u4f4d\u7f6e\u8bb0\u5f55\u5230 master-info\u6587\u4ef6\u4e2d \u4ee5\u4fbf\u4e0b\u4e00\u6b21\u8bfb\u53d6Master\u7aef\u65b0biolog\u65e5\u5fd7\u65f6\u80fd\u591f\u544a\u8bc9Master\u670d\u52a1\u5668 \u4ece\u65b0binlog\u65e5\u5fd7\u7684\u6307\u5b9a\u6587\u4ef6\u53ca\u4f4d\u7f6e\u5f00\u59cb\u8bf7\u6c42\u65b0\u7684binlog\u65e5\u5fd7\u5185\u5bb9 5) Slave\u670d\u52a1\u5668\u7aef\u7684SQL\u7ebf\u7a0b\u4f1a\u5b9e\u65f6\u68c0\u6d4b\u672c\u5730RelayLog\u4e2d1/0\u7ebf\u7a0b\u65b0\u589e\u52a0\u7684\u65e5\u5fd7\u5185\u5bb9\uff0c \u7136\u540e\u53ca\u65f6\u5730\u628aRelay Log\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u89e3\u6790\u6210SQL\u8bed\u53e5 \u5e76\u5728\u81ea\u8eabSlave\u670d\u52a1\u5668\u4e0a\u6309\u89e3\u6790SQL\u8bed\u53e5\u7684\u4f4d\u7f6e\u987a\u5e8f\u6267\u884c\u5e94\u7528\u8fd9\u4e9bSQL\u8bed\u53e5\uff0c \u5e76\u5728relay- log.info\u4e2d\u8bb0\u5f55\u5f53\u524d\u5e94\u7528\u4e2d\u7ee7\u65e5\u5fd7\u7684\u6587\u4ef6\u540d\u53ca\u4f4d\u7f6e\u70b9 \u7ecf\u8fc7\u4e86\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c \u5c31\u53ef\u4ee5\u786e\u4fdd\u5728Master\u7aef\u548cSlave\u7aef\u6267\u884c\u4e86\u540c\u6837\u7684SQL\u8bed\u53e5\u3002\u5f53\u590d\u5236\u72b6\u6001\u6b63\u5e38\u65f6\uff0c Master\u7aef\u548cSlave\u7aef\u7684\u6570\u636e\u662f\u5b8c\u5168\u4e00\u6837\u7684</p> <p>MySQL\u4e3b\u4ece\u590d\u5236\u539f\u7406\u91cd\u70b9\u5c0f\u7ed3 \u25a1   \u4e3b\u4ece\u590d\u5236\u662f\u5f02\u6b65\u7684\u903b\u8f91\u7684SQL\u8bed\u53e5\u7ea7\u7684\u590d\u5236 D\u590d\u5236\u65f6\uff0c \u4e3b\u5e93\u6709\u4e00\u4e2aVO\u7ebf\u7a0b\uff0c \u4ece\u5e93\u6709\u4e24\u4e2a\u7ebf\u7a0b\uff0c \u53731/0\u548cSQL\u7ebf\u7a0b \u25a1   \u5b9e\u73b0\u4e3b\u4ece\u590d\u5236\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u4e3b\u5e93\u8981\u5f00\u542f\u8bb0\u5f55binlog\u529f\u80fd D\u4f5c\u4e3a\u590d\u5236\u7684\u6240\u6709MySQL\u8282\u70b9\u7684server-id\u90fd\u4e0d\u80fd\u76f8\u540c \u25a1 binlog\u6587\u4ef6\u53ea\u8bb0\u5f55\u5bf9\u6570\u636e\u5e93\u6709\u66f4\u6539\u7684SQL\u8bed\u53e5\uff08\u6765\u81ea\u4e3b\u6570\u636e\u5e93\u5185\u5bb9\u7684\u53d8\u66f4\uff09\uff0c \u4e0d\u8bb0\u5f55\u4efb\u4f55\u67e5\u8be2\uff08\u5982select\u3001show)\u8bed\u53e5</p>"},{"location":"database/Redis/","title":"Redis","text":"Markdown<pre><code>Redis\u63d0\u4f9b\u4e86\u4e0d\u540c\u8303\u56f4\u7684\u6301\u4e45\u6027\u9009\u9879\uff1a\n\nRDB\uff08Redis\u6570\u636e\u5e93\uff09\uff1aRDB\u6301\u4e45\u6027\u6309\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694\u6267\u884c\u6570\u636e\u96c6\u7684\u65f6\u95f4\u70b9\u5feb\u7167\u3002\nAOF\uff08\u4ec5\u9644\u52a0\u6587\u4ef6\uff09\uff1aAOF\u6301\u4e45\u6027\u8bb0\u5f55\u670d\u52a1\u5668\u63a5\u6536\u7684\u6bcf\u4e2a\u5199\u5165\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u5c06\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u518d\u6b21\u64ad\u653e\uff0c\u4ee5\u91cd\u5efa\u539f\u59cb\u6570\u636e\u96c6\u3002\u4f7f\u7528\u4e0eRedis\u534f\u8bae\u672c\u8eab\u76f8\u540c\u7684\u683c\u5f0f\u8bb0\u5f55\u547d\u4ee4\uff0c\u5e76\u4e14\u91c7\u7528\u4ec5\u8ffd\u52a0\u65b9\u5f0f\u3002\u5f53\u65e5\u5fd7\u592a\u5927\u65f6\uff0cRedis\u53ef\u4ee5\u5728\u540e\u53f0\u91cd\u5199\u65e5\u5fd7\u3002\n\u65e0\u6301\u4e45\u6027\uff1a\u5982\u679c\u5e0c\u671b\uff0c\u53ea\u8981\u670d\u52a1\u5668\u6b63\u5728\u8fd0\u884c\uff0c\u6570\u636e\u5c31\u4e00\u76f4\u5b58\u5728\uff0c\u5219\u53ef\u4ee5\u5b8c\u5168\u7981\u7528\u6301\u4e45\u6027\u3002\nRDB + AOF\uff1a\u53ef\u4ee5\u5728\u540c\u4e00\u5b9e\u4f8b\u4e2d\u540c\u65f6\u5408\u5e76AOF\u548cRDB\u3002\u8bf7\u6ce8\u610f\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53Redis\u91cd\u65b0\u542f\u52a8\u65f6\uff0cAOF\u6587\u4ef6\u5c06\u7528\u4e8e\u91cd\u5efa\u539f\u59cb\u6570\u636e\u96c6\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4fdd\u8bc1\u662f\u6700\u5b8c\u6574\u7684\n\n\nredis sentinel\u54e8\u5175\u6a21\u5f0f\u4e3b\u4ece\u590d\u5236\u673a\u5236\n1.\u4e00\u4e2a master \u5b9e\u4f8b\u548c\u4e00\u4e2a slave \u5b9e\u4f8b\u8fde\u63a5\u6b63\u5e38\u65f6\uff0c master \u4f1a\u53d1\u9001\u4e00\u8fde\u4e32\u7684\u547d\u4ee4\u6d41\u6765\u4fdd\u6301\u5bf9 slave \u7684\u66f4\u65b0\uff0c\u4ee5\u4fbf\u4e8e\u5c06\u81ea\u8eab\u6570\u636e\u96c6\u7684\u6539\u53d8\u590d\u5236\u7ed9 slave \uff0c \uff1a\u5305\u62ec\u5ba2\u6237\u7aef\u7684\u5199\u5165\u3001key \u7684\u8fc7\u671f\u6216\u88ab\u9010\u51fa\u7b49\u7b49\n2.master \u548c slave \u4e4b\u95f4\u7684\u8fde\u63a5\u65ad\u5f00\u4e4b\u540e\uff0c\u56e0\u4e3a\u7f51\u7edc\u95ee\u9898\u3001\u6216\u8005\u662f\u4e3b\u4ece\u610f\u8bc6\u5230\u8fde\u63a5\u8d85\u65f6\uff0c slave \u91cd\u65b0\u8fde\u63a5\u4e0a master \u5e76\u4f1a\u5c1d\u8bd5\u8fdb\u884c\u90e8\u5206\u91cd\u540c\u6b65\uff1a\u8fd9\u610f\u5473\u7740\u5b83\u4f1a\u5c1d\u8bd5\u53ea\u83b7\u53d6\u5728\u65ad\u5f00\u8fde\u63a5\u671f\u95f4\u5185\u4e22\u5931\u7684\u547d\u4ee4\u6d41\n3.\u65e0\u6cd5\u8fdb\u884c\u90e8\u5206\u91cd\u540c\u6b65\u65f6\uff0c slave \u4f1a\u8bf7\u6c42\u8fdb\u884c\u5168\u91cf\u91cd\u540c\u6b65\u3002\u8fd9\u4f1a\u6d89\u53ca\u5230\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u4f8b\u5982 master \u9700\u8981\u521b\u5efa\u6240\u6709\u6570\u636e\u7684\u5feb\u7167\uff0c\u5c06\u4e4b\u53d1\u9001\u7ed9 slave \uff0c\u4e4b\u540e\u5728\u6570\u636e\u96c6\u66f4\u6539\u65f6\u6301\u7eed\u53d1\u9001\u547d\u4ee4\u6d41\u5230 slave\n\nRDB\u6301\u4e45\u5316\u65b9\u5f0f\u80fd\u591f\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u95f4\u9694\u80fd\u5bf9\u4f60\u7684\u6570\u636e\u8fdb\u884c\u5feb\u7167\u5b58\u50a8.\nAOF\u6301\u4e45\u5316\u65b9\u5f0f\u8bb0\u5f55\u6bcf\u6b21\u5bf9\u670d\u52a1\u5668\u5199\u7684\u64cd\u4f5c,\u5f53\u670d\u52a1\u5668\u91cd\u542f\u7684\u65f6\u5019\u4f1a\u91cd\u65b0\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\u6765\u6062\u590d\u539f\u59cb\u7684\u6570\u636e,AOF\u547d\u4ee4\u4ee5redis\u534f\u8bae\u8ffd\u52a0\u4fdd\u5b58\u6bcf\u6b21\u5199\u7684\u64cd\u4f5c\u5230\u6587\u4ef6\u672b\u5c3e.Redis\u8fd8\u80fd\u5bf9AOF\u6587\u4ef6\u8fdb\u884c\u540e\u53f0\u91cd\u5199,\u4f7f\u5f97AOF\u6587\u4ef6\u7684\u4f53\u79ef\u4e0d\u81f3\u4e8e\u8fc7\u5927.\n\u5982\u679c\u4f60\u53ea\u5e0c\u671b\u4f60\u7684\u6570\u636e\u5728\u670d\u52a1\u5668\u8fd0\u884c\u7684\u65f6\u5019\u5b58\u5728,\u4f60\u4e5f\u53ef\u4ee5\u4e0d\u4f7f\u7528\u4efb\u4f55\u6301\u4e45\u5316\u65b9\u5f0f.\n\u4f60\u4e5f\u53ef\u4ee5\u540c\u65f6\u5f00\u542f\u4e24\u79cd\u6301\u4e45\u5316\u65b9\u5f0f, \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b, \u5f53redis\u91cd\u542f\u7684\u65f6\u5019\u4f1a\u4f18\u5148\u8f7d\u5165AOF\u6587\u4ef6\u6765\u6062\u590d\u539f\u59cb\u7684\u6570\u636e,\u56e0\u4e3a\u5728\u901a\u5e38\u60c5\u51b5\u4e0bAOF\u6587\u4ef6\u4fdd\u5b58\u7684\u6570\u636e\u96c6\u8981\u6bd4RDB\u6587\u4ef6\u4fdd\u5b58\u7684\u6570\u636e\u96c6\u8981\u5b8c\u6574\nRDB\u7684\u4f18\u70b9\nRDB\u662f\u4e00\u4e2a\u975e\u5e38\u7d27\u51d1\u7684\u6587\u4ef6,\u5b83\u4fdd\u5b58\u4e86\u67d0\u4e2a\u65f6\u95f4\u70b9\u5f97\u6570\u636e\u96c6,\u975e\u5e38\u9002\u7528\u4e8e\u6570\u636e\u96c6\u7684\u5907\u4efd,\u6bd4\u5982\u4f60\u53ef\u4ee5\u5728\u6bcf\u4e2a\u5c0f\u65f6\u62a5\u4fdd\u5b58\u4e00\u4e0b\u8fc7\u53bb24\u5c0f\u65f6\u5185\u7684\u6570\u636e,\u540c\u65f6\u6bcf\u5929\u4fdd\u5b58\u8fc7\u53bb30\u5929\u7684\u6570\u636e,\u8fd9\u6837\u5373\u4f7f\u51fa\u4e86\u95ee\u9898\u4f60\u4e5f\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u6062\u590d\u5230\u4e0d\u540c\u7248\u672c\u7684\u6570\u636e\u96c6.\nRDB\u662f\u4e00\u4e2a\u7d27\u51d1\u7684\u5355\u4e00\u6587\u4ef6,\u5f88\u65b9\u4fbf\u4f20\u9001\u5230\u53e6\u4e00\u4e2a\u8fdc\u7aef\u6570\u636e\u4e2d\u5fc3\u6216\u8005\u4e9a\u9a6c\u900a\u7684S3\uff08\u53ef\u80fd\u52a0\u5bc6\uff09\uff0c\u975e\u5e38\u9002\u7528\u4e8e\u707e\u96be\u6062\u590d.\nRDB\u5728\u4fdd\u5b58RDB\u6587\u4ef6\u65f6\u7236\u8fdb\u7a0b\u552f\u4e00\u9700\u8981\u505a\u7684\u5c31\u662ffork\u51fa\u4e00\u4e2a\u5b50\u8fdb\u7a0b,\u63a5\u4e0b\u6765\u7684\u5de5\u4f5c\u5168\u90e8\u7531\u5b50\u8fdb\u7a0b\u6765\u505a\uff0c\u7236\u8fdb\u7a0b\u4e0d\u9700\u8981\u518d\u505a\u5176\u4ed6IO\u64cd\u4f5c\uff0c\u6240\u4ee5RDB\u6301\u4e45\u5316\u65b9\u5f0f\u53ef\u4ee5\u6700\u5927\u5316redis\u7684\u6027\u80fd.\n\u4e0eAOF\u76f8\u6bd4,\u5728\u6062\u590d\u5927\u7684\u6570\u636e\u96c6\u7684\u65f6\u5019\uff0cRDB\u65b9\u5f0f\u4f1a\u66f4\u5feb\u4e00\u4e9b.\nRDB\u7684\u7f3a\u70b9\n\u5982\u679c\u4f60\u5e0c\u671b\u5728redis\u610f\u5916\u505c\u6b62\u5de5\u4f5c\uff08\u4f8b\u5982\u7535\u6e90\u4e2d\u65ad\uff09\u7684\u60c5\u51b5\u4e0b\u4e22\u5931\u7684\u6570\u636e\u6700\u5c11\u7684\u8bdd\uff0c\u90a3\u4e48RDB\u4e0d\u9002\u5408\u4f60.\u867d\u7136\u4f60\u53ef\u4ee5\u914d\u7f6e\u4e0d\u540c\u7684save\u65f6\u95f4\u70b9(\u4f8b\u5982\u6bcf\u96945\u5206\u949f\u5e76\u4e14\u5bf9\u6570\u636e\u96c6\u6709100\u4e2a\u5199\u7684\u64cd\u4f5c),\u662fRedis\u8981\u5b8c\u6574\u7684\u4fdd\u5b58\u6574\u4e2a\u6570\u636e\u96c6\u662f\u4e00\u4e2a\u6bd4\u8f83\u7e41\u91cd\u7684\u5de5\u4f5c,\u4f60\u901a\u5e38\u4f1a\u6bcf\u96945\u5206\u949f\u6216\u8005\u66f4\u4e45\u505a\u4e00\u6b21\u5b8c\u6574\u7684\u4fdd\u5b58,\u4e07\u4e00\u5728Redis\u610f\u5916\u5b95\u673a,\u4f60\u53ef\u80fd\u4f1a\u4e22\u5931\u51e0\u5206\u949f\u7684\u6570\u636e.\nRDB \u9700\u8981\u7ecf\u5e38fork\u5b50\u8fdb\u7a0b\u6765\u4fdd\u5b58\u6570\u636e\u96c6\u5230\u786c\u76d8\u4e0a,\u5f53\u6570\u636e\u96c6\u6bd4\u8f83\u5927\u7684\u65f6\u5019,fork\u7684\u8fc7\u7a0b\u662f\u975e\u5e38\u8017\u65f6\u7684,\u53ef\u80fd\u4f1a\u5bfc\u81f4Redis\u5728\u4e00\u4e9b\u6beb\u79d2\u7ea7\u5185\u4e0d\u80fd\u54cd\u5e94\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42.\u5982\u679c\u6570\u636e\u96c6\u5de8\u5927\u5e76\u4e14CPU\u6027\u80fd\u4e0d\u662f\u5f88\u597d\u7684\u60c5\u51b5\u4e0b,\u8fd9\u79cd\u60c5\u51b5\u4f1a\u6301\u7eed1\u79d2,AOF\u4e5f\u9700\u8981fork,\u4f46\u662f\u4f60\u53ef\u4ee5\u8c03\u8282\u91cd\u5199\u65e5\u5fd7\u6587\u4ef6\u7684\u9891\u7387\u6765\u63d0\u9ad8\u6570\u636e\u96c6\u7684\u8010\u4e45\u5ea6.\nAOF \u4f18\u70b9\n\u4f7f\u7528AOF \u4f1a\u8ba9\u4f60\u7684Redis\u66f4\u52a0\u8010\u4e45: \u4f60\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684fsync\u7b56\u7565\uff1a\u65e0fsync,\u6bcf\u79d2fsync,\u6bcf\u6b21\u5199\u7684\u65f6\u5019fsync.\u4f7f\u7528\u9ed8\u8ba4\u7684\u6bcf\u79d2fsync\u7b56\u7565,Redis\u7684\u6027\u80fd\u4f9d\u7136\u5f88\u597d(fsync\u662f\u7531\u540e\u53f0\u7ebf\u7a0b\u8fdb\u884c\u5904\u7406\u7684,\u4e3b\u7ebf\u7a0b\u4f1a\u5c3d\u529b\u5904\u7406\u5ba2\u6237\u7aef\u8bf7\u6c42),\u4e00\u65e6\u51fa\u73b0\u6545\u969c\uff0c\u4f60\u6700\u591a\u4e22\u59311\u79d2\u7684\u6570\u636e.\nAOF\u6587\u4ef6\u662f\u4e00\u4e2a\u53ea\u8fdb\u884c\u8ffd\u52a0\u7684\u65e5\u5fd7\u6587\u4ef6,\u6240\u4ee5\u4e0d\u9700\u8981\u5199\u5165seek,\u5373\u4f7f\u7531\u4e8e\u67d0\u4e9b\u539f\u56e0(\u78c1\u76d8\u7a7a\u95f4\u5df2\u6ee1\uff0c\u5199\u7684\u8fc7\u7a0b\u4e2d\u5b95\u673a\u7b49\u7b49)\u672a\u6267\u884c\u5b8c\u6574\u7684\u5199\u5165\u547d\u4ee4,\u4f60\u4e5f\u4e5f\u53ef\u4f7f\u7528redis-check-aof\u5de5\u5177\u4fee\u590d\u8fd9\u4e9b\u95ee\u9898.\nRedis \u53ef\u4ee5\u5728 AOF \u6587\u4ef6\u4f53\u79ef\u53d8\u5f97\u8fc7\u5927\u65f6\uff0c\u81ea\u52a8\u5730\u5728\u540e\u53f0\u5bf9 AOF \u8fdb\u884c\u91cd\u5199\uff1a \u91cd\u5199\u540e\u7684\u65b0 AOF \u6587\u4ef6\u5305\u542b\u4e86\u6062\u590d\u5f53\u524d\u6570\u636e\u96c6\u6240\u9700\u7684\u6700\u5c0f\u547d\u4ee4\u96c6\u5408\u3002 \u6574\u4e2a\u91cd\u5199\u64cd\u4f5c\u662f\u7edd\u5bf9\u5b89\u5168\u7684\uff0c\u56e0\u4e3a Redis \u5728\u521b\u5efa\u65b0 AOF \u6587\u4ef6\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u7ee7\u7eed\u5c06\u547d\u4ee4\u8ffd\u52a0\u5230\u73b0\u6709\u7684 AOF \u6587\u4ef6\u91cc\u9762\uff0c\u5373\u4f7f\u91cd\u5199\u8fc7\u7a0b\u4e2d\u53d1\u751f\u505c\u673a\uff0c\u73b0\u6709\u7684 AOF \u6587\u4ef6\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002 \u800c\u4e00\u65e6\u65b0 AOF \u6587\u4ef6\u521b\u5efa\u5b8c\u6bd5\uff0cRedis \u5c31\u4f1a\u4ece\u65e7 AOF \u6587\u4ef6\u5207\u6362\u5230\u65b0 AOF \u6587\u4ef6\uff0c\u5e76\u5f00\u59cb\u5bf9\u65b0 AOF \u6587\u4ef6\u8fdb\u884c\u8ffd\u52a0\u64cd\u4f5c\u3002\nAOF \u6587\u4ef6\u6709\u5e8f\u5730\u4fdd\u5b58\u4e86\u5bf9\u6570\u636e\u5e93\u6267\u884c\u7684\u6240\u6709\u5199\u5165\u64cd\u4f5c\uff0c \u8fd9\u4e9b\u5199\u5165\u64cd\u4f5c\u4ee5 Redis \u534f\u8bae\u7684\u683c\u5f0f\u4fdd\u5b58\uff0c \u56e0\u6b64 AOF \u6587\u4ef6\u7684\u5185\u5bb9\u975e\u5e38\u5bb9\u6613\u88ab\u4eba\u8bfb\u61c2\uff0c \u5bf9\u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff08parse\uff09\u4e5f\u5f88\u8f7b\u677e\u3002 \u5bfc\u51fa\uff08export\uff09 AOF \u6587\u4ef6\u4e5f\u975e\u5e38\u7b80\u5355\uff1a \u4e3e\u4e2a\u4f8b\u5b50\uff0c \u5982\u679c\u4f60\u4e0d\u5c0f\u5fc3\u6267\u884c\u4e86 FLUSHALL \u547d\u4ee4\uff0c \u4f46\u53ea\u8981 AOF \u6587\u4ef6\u672a\u88ab\u91cd\u5199\uff0c \u90a3\u4e48\u53ea\u8981\u505c\u6b62\u670d\u52a1\u5668\uff0c \u79fb\u9664 AOF \u6587\u4ef6\u672b\u5c3e\u7684 FLUSHALL \u547d\u4ee4\uff0c \u5e76\u91cd\u542f Redis \uff0c \u5c31\u53ef\u4ee5\u5c06\u6570\u636e\u96c6\u6062\u590d\u5230 FLUSHALL \u6267\u884c\u4e4b\u524d\u7684\u72b6\u6001\u3002\nAOF \u7f3a\u70b9\n\u5bf9\u4e8e\u76f8\u540c\u7684\u6570\u636e\u96c6\u6765\u8bf4\uff0cAOF \u6587\u4ef6\u7684\u4f53\u79ef\u901a\u5e38\u8981\u5927\u4e8e RDB \u6587\u4ef6\u7684\u4f53\u79ef\u3002\n\u6839\u636e\u6240\u4f7f\u7528\u7684 fsync \u7b56\u7565\uff0cAOF \u7684\u901f\u5ea6\u53ef\u80fd\u4f1a\u6162\u4e8e RDB \u3002 \u5728\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c \u6bcf\u79d2 fsync \u7684\u6027\u80fd\u4f9d\u7136\u975e\u5e38\u9ad8\uff0c \u800c\u5173\u95ed fsync \u53ef\u4ee5\u8ba9 AOF \u7684\u901f\u5ea6\u548c RDB \u4e00\u6837\u5feb\uff0c \u5373\u4f7f\u5728\u9ad8\u8d1f\u8377\u4e4b\u4e0b\u4e5f\u662f\u5982\u6b64\u3002 \u4e0d\u8fc7\u5728\u5904\u7406\u5de8\u5927\u7684\u5199\u5165\u8f7d\u5165\u65f6\uff0cRDB \u53ef\u4ee5\u63d0\u4f9b\u66f4\u6709\u4fdd\u8bc1\u7684\u6700\u5927\u5ef6\u8fdf\u65f6\u95f4\uff08latency\uff09\n\n\u4f18\u5316\n\u4f7f\u7528\u4ee5\u4e0b redis.conf \u6307\u4ee4\u8c03\u6574\u7279\u6b8a\u7f16\u7801\u7c7b\u578b\u7684\u6700\u5927\u5143\u7d20\u6570\u548c\u6700\u5927\u5143\u7d20\u5927\u5c0f\nhash-max-ziplist-entries 512\nhash-max-ziplist-value 64\nzset-max-ziplist-entries 128\nzset-max-ziplist-value 64\nset-max-intset-entries 512\n\n\u786e\u4fdd\u6dfb\u52a0vm.overcommit_memory = 1\u5230/etc/sysctl.conf\nfs.file-max=100000\n\u786e\u4fddRedis\u4e0d\u4f1a\u53d7\u5230Linux\u5185\u6838\u900f\u660e\u5927\u9875\u9762\u7279\u6027\u7684\u5f71\u54cd\uff0c\u5426\u5219\u4f1a\u5bf9\u5185\u5b58\u4f7f\u7528\u548c\u5ef6\u8fdf\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\u3002\n\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u5b8c\u6210\u7684\uff1aecho madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled\n\u5982\u679c\u60a8\u4f7f\u7528\u590d\u5236\uff0c\u8bf7\u786e\u4fdd\u60a8\u7684 master \u542f\u7528\u4e86\u6301\u4e45\u6027\uff0c\u6216\u8005\u5b83\u4e0d\u4f1a\u5728\u5d29\u6e83\u65f6\u81ea\u52a8\u91cd\u65b0\u542f\u52a8\uff1a\u526f\u672c\u5c06\u5c1d\u8bd5\u6210\u4e3a master \u7684\u7cbe\u786e\u526f\u672c\uff0c\u56e0\u6b64\u5982\u679c master \u4ee5\u7a7a\u6570\u636e\u96c6\u91cd\u65b0\u542f\u52a8\uff0c\u526f\u672c\u4e5f\u4f1a\u88ab\u62b9\u6389\n\n\u9a71\u9010\u653f\u7b56\n\u5f53maxmemory\u8fbe\u5230\u9650\u5236\u65f6\uff0cRedis \u7684\u786e\u5207\u884c\u4e3a\u662f\u4f7f\u7528maxmemory-policy\u914d\u7f6e\u6307\u4ee4\u914d\u7f6e\u7684\u3002\n\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u653f\u7b56\uff1a\nnoeviction\uff1a\u5f53\u8fbe\u5230\u5185\u5b58\u9650\u5236\u5e76\u4e14\u5ba2\u6237\u7aef\u5c1d\u8bd5\u6267\u884c\u53ef\u80fd\u5bfc\u81f4\u4f7f\u7528\u66f4\u591a\u5185\u5b58\u7684\u547d\u4ee4\u65f6\u8fd4\u56de\u9519\u8bef\uff08\u5927\u591a\u6570\u5199\u547d\u4ee4\uff0c\u4f46DEL\u548c\u4e00\u4e9b\u4f8b\u5916\uff09\u3002\nallkeys-lru\uff1a\u901a\u8fc7\u9996\u5148\u5c1d\u8bd5\u5220\u9664\u6700\u8fd1\u8f83\u5c11\u4f7f\u7528\u7684 (LRU) \u952e\u6765\u9a71\u9010\u952e\uff0c\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\u3002\nvolatile-lru\uff1a\u901a\u8fc7\u9996\u5148\u5c1d\u8bd5\u5220\u9664\u6700\u8fd1\u4f7f\u7528\u7684 (LRU) \u952e\u6765\u9a71\u9010\u952e\uff0c\u4f46\u4ec5\u9650\u4e8e\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u952e\uff0c\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\u3002\nallkeys-random\uff1a\u968f\u673a\u9a71\u9010\u5bc6\u94a5\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\u3002\nvolatile-random\uff1a\u968f\u673a\u9a71\u9010\u5bc6\u94a5\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\uff0c\u4f46\u4ec5\u9a71\u9010\u5177\u6709\u8fc7\u671f\u8bbe\u7f6e\u7684\u5bc6\u94a5\u3002\nvolatile-ttl\uff1a\u9a71\u9010\u8bbe\u7f6e\u4e86\u8fc7\u671f\u65f6\u95f4\u7684\u952e\uff0c\u5e76\u5c1d\u8bd5\u9996\u5148\u9a71\u9010\u5177\u6709\u8f83\u77ed\u751f\u5b58\u65f6\u95f4\uff08TTL\uff09\u7684\u952e\uff0c\u4ee5\u4fbf\u4e3a\u6dfb\u52a0\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\n\nRedis LRU \u7b97\u6cd5\u7684\u91cd\u8981\u4e4b\u5904\u5728\u4e8e\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u66f4\u6539\u6837\u672c\u6570\u91cf\u6765\u8c03\u6574\u7b97\u6cd5\u7684\u7cbe\u5ea6\uff0c\u4ee5\u68c0\u67e5\u6bcf\u6b21\u9a71\u9010\u3002\u6b64\u53c2\u6570\u7531\u4ee5\u4e0b\u914d\u7f6e\u6307\u4ee4\u63a7\u5236\uff1a\nmaxmemory-samples 5\n\nDISCARD\u53ef\u7528\u4e8e\u4e2d\u6b62\u4e8b\u52a1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u6267\u884c\u4efb\u4f55\u547d\u4ee4\uff0c\u8fde\u63a5\u72b6\u6001\u6062\u590d\u6b63\u5e38\n\n\u5ba2\u6237\u7aef\u7f13\u5b58\u7684Redis\u5b9e\u73b0\nRedis \u5ba2\u6237\u7aef\u7f13\u5b58\u652f\u6301\u79f0\u4e3aTracking\uff0c\u6709\u4e24\u79cd\u6a21\u5f0f\uff1a\n\u5728\u9ed8\u8ba4\u6a21\u5f0f\u4e0b\uff0c\u670d\u52a1\u5668\u8bb0\u4f4f\u7ed9\u5b9a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4e86\u54ea\u4e9b\u952e\uff0c\u5e76\u5728\u4fee\u6539\u76f8\u540c\u952e\u65f6\u53d1\u9001\u65e0\u6548\u6d88\u606f\u3002\u8fd9\u4f1a\u6d88\u8017\u670d\u52a1\u5668\u7aef\u7684\u5185\u5b58\uff0c\u4f46\u53ea\u4f1a\u4e3a\u5ba2\u6237\u7aef\u53ef\u80fd\u5728\u5185\u5b58\u4e2d\u62e5\u6709\u7684\u4e00\u7ec4\u5bc6\u94a5\u53d1\u9001\u5931\u6548\u6d88\u606f\u3002\n\u76f8\u53cd\uff0c\u5728\u5e7f\u64ad\u6a21\u5f0f\u4e0b\uff0c\u670d\u52a1\u5668\u4e0d\u4f1a\u5c1d\u8bd5\u8bb0\u4f4f\u7ed9\u5b9a\u5ba2\u6237\u7aef\u8bbf\u95ee\u4e86\u54ea\u4e9b\u952e\uff0c\u56e0\u6b64\u8fd9\u79cd\u6a21\u5f0f\u5728\u670d\u52a1\u5668\u7aef\u6839\u672c\u4e0d\u6d88\u8017\u4efb\u4f55\u5185\u5b58\u3002\u76f8\u53cd\uff0c\u5ba2\u6237\u7aef\u8ba2\u9605\u8bf8\u5982object:\u6216 \u4e4b\u7c7b\u7684\u952e\u524d\u7f00user:\uff0c\u5e76\u4e14\u6bcf\u6b21\u89e6\u6478\u5339\u914d\u6b64\u7c7b\u524d\u7f00\u7684\u952e\u65f6\u90fd\u4f1a\u6536\u5230\u901a\u77e5\u6d88\u606f\n\nredis-cli\u5b9e\u7528\u7a0b\u5e8f\u652f\u6301\u4e00\u79cd\u79f0\u4e3a\u7ba1\u9053\u6a21\u5f0f\u7684\u65b0\u6a21\u5f0f\uff0c\u8be5\u6a21\u5f0f\u65e8\u5728\u6267\u884c\u6279\u91cf\u63d2\u5165\uff0credis-cli \u5b9e\u7528\u7a0b\u5e8f\u8fd8\u5c06\u786e\u4fdd\u4ec5\u5c06\u4ece Redis \u5b9e\u4f8b\u6536\u5230\u7684\u9519\u8bef\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u8f93\u51fa\n(data.txt\u5185\u5bb9\u5982\uff1a\nset key0 value0\n......\nset keyN value)\n\u547d\u4ee4\uff1acat data.txt | redis-cli --pipe\n\nRedis \u4e2d\u7684\u5206\u533a\u6709\u4e24\u4e2a\u4e3b\u8981\u76ee\u6807\uff1a\n\u5b83\u5141\u8bb8\u4f7f\u7528\u591a\u53f0\u8ba1\u7b97\u673a\u5185\u5b58\u7684\u603b\u548c\u6765\u521b\u5efa\u66f4\u5927\u7684\u6570\u636e\u5e93\u3002\u5982\u679c\u4e0d\u8fdb\u884c\u5206\u533a\uff0c\u60a8\u5c06\u53d7\u5230\u5355\u4e2a\u8ba1\u7b97\u673a\u53ef\u4ee5\u652f\u6301\u7684\u5185\u5b58\u91cf\u7684\u9650\u5236\u3002\n\u5b83\u5141\u8bb8\u5c06\u8ba1\u7b97\u80fd\u529b\u6269\u5c55\u5230\u591a\u6838\u548c\u591a\u53f0\u8ba1\u7b97\u673a\uff0c\u5e76\u5c06\u7f51\u7edc\u5e26\u5bbd\u6269\u5c55\u5230\u591a\u53f0\u8ba1\u7b97\u673a\u548c\u7f51\u7edc\u9002\u914d\u5668\n\u5206\u533a\u65b9\u6cd5\uff1a\u8303\u56f4\u5206\u533a\u548c\u6563\u5217\u5206\u533a\n\n\u5c3d\u7ba1 Redis \u4e2d\u7684\u5206\u533a\u5728\u6982\u5ff5\u4e0a\u662f\u76f8\u540c\u7684\uff0c\u65e0\u8bba\u662f\u5c06 Redis \u7528\u4f5c\u6570\u636e\u5b58\u50a8\u8fd8\u662f\u7f13\u5b58\uff0c\u4f46\u5c06\u5176\u7528\u4f5c\u6570\u636e\u5b58\u50a8\u65f6\u5b58\u5728\u91cd\u5927\u9650\u5236\u3002\u5f53 Redis \u7528\u4f5c\u6570\u636e\u5b58\u50a8\u65f6\uff0c\u7ed9\u5b9a\u7684\u952e\u5fc5\u987b\u59cb\u7ec8\u6620\u5c04\u5230\u540c\u4e00\u4e2a Redis \u5b9e\u4f8b\u3002\u5f53Redis\u7528\u4f5c\u7f13\u5b58\u65f6\uff0c\u5982\u679c\u7ed9\u5b9a\u8282\u70b9\u4e0d\u53ef\u7528\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u8282\u70b9\u4e5f\u4e0d\u662f\u5927\u95ee\u9898\uff0c\u6539\u53d8key-instance\u6620\u5c04\uff0c\u56e0\u4e3a\u6211\u4eec\u5e0c\u671b\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u7528\u6027\uff08\u5373\u63d0\u9ad8\u7cfb\u7edf\u53ef\u7528\u6027\u7684\u80fd\u529b\uff09\u7cfb\u7edf\u56de\u590d\u6211\u4eec\u7684\u67e5\u8be2\uff09\u3002\n\u5982\u679c\u7ed9\u5b9a\u952e\u7684\u9996\u9009\u8282\u70b9\u4e0d\u53ef\u7528\uff0c\u5219\u4e00\u81f4\u7684\u6563\u5217\u5b9e\u73b0\u901a\u5e38\u80fd\u591f\u5207\u6362\u5230\u5176\u4ed6\u8282\u70b9\u3002\u540c\u6837\uff0c\u5982\u679c\u6dfb\u52a0\u65b0\u8282\u70b9\uff0c\u90e8\u5206\u65b0\u5bc6\u94a5\u5c06\u5f00\u59cb\u5b58\u50a8\u5728\u65b0\u8282\u70b9\u4e0a\u3002\n\n\u8fd9\u91cc\u7684\u4e3b\u8981\u6982\u5ff5\u5982\u4e0b\uff1a\n\u5982\u679c\u5c06 Redis \u7528\u4f5c\u7f13\u5b58\uff0c\u5219\u4f7f\u7528\u4e00\u81f4\u6563\u5217\u6269\u5c55\u548c\u7f29\u51cf\u662f\u5f88\u5bb9\u6613\u7684\u3002\n\u5982\u679c\u4f7f\u7528Redis\u4f5c\u4e3a\u5b58\u50a8\uff0c\u5219\u4f7f\u7528\u56fa\u5b9a\u7684key-to-nodes\u6620\u5c04\uff0c\u56e0\u6b64\u8282\u70b9\u6570\u5fc5\u987b\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u80fd\u53d8\u5316\u3002\u5426\u5219\uff0c\u9700\u8981\u4e00\u4e2a\u80fd\u591f\u5728\u6dfb\u52a0\u6216\u5220\u9664\u8282\u70b9\u65f6\u5728\u8282\u70b9\u4e4b\u95f4\u91cd\u65b0\u5e73\u8861\u952e\u7684\u7cfb\u7edf\uff0c\u76ee\u524d\u53ea\u6709 Redis Cluster \u80fd\u591f\u505a\u5230\u8fd9\u4e00\u70b9\n\n\u4e3a\u4ec0\u4e48 Redis \u4e0e\u5176\u4ed6\u952e\u503c\u5b58\u50a8\u4e0d\u540c\uff1f\n\u6709\u4e24\u4e2a\u4e3b\u8981\u539f\u56e0\u3002\nRedis \u662f\u952e\u503c\u6570\u636e\u5e93\u4e2d\u4e0d\u540c\u7684\u8fdb\u5316\u8def\u5f84\uff0c\u5176\u4e2d\u503c\u53ef\u4ee5\u5305\u542b\u66f4\u590d\u6742\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5e76\u5728\u8fd9\u4e9b\u6570\u636e\u7c7b\u578b\u4e0a\u5b9a\u4e49\u539f\u5b50\u64cd\u4f5c\u3002Redis \u6570\u636e\u7c7b\u578b\u4e0e\u57fa\u672c\u6570\u636e\u7ed3\u6784\u5bc6\u5207\u76f8\u5173\uff0c\u56e0\u6b64\u5411\u7a0b\u5e8f\u5458\u516c\u5f00\uff0c\u65e0\u9700\u989d\u5916\u7684\u62bd\u8c61\u5c42\u3002\nRedis \u662f\u4e00\u4e2a\u5185\u5b58\u4e2d\u4f46\u6301\u4e45\u5316\u5728\u78c1\u76d8\u4e0a\u7684\u6570\u636e\u5e93\uff0c\u56e0\u6b64\u5b83\u4ee3\u8868\u4e86\u4e00\u79cd\u4e0d\u540c\u7684\u6743\u8861\uff0c\u5728\u65e0\u6cd5\u5927\u4e8e\u5185\u5b58\u7684\u6570\u636e\u96c6\u7684\u9650\u5236\u4e0b\u5b9e\u73b0\u4e86\u975e\u5e38\u9ad8\u7684\u5199\u5165\u548c\u8bfb\u53d6\u901f\u5ea6\u3002\u5185\u5b58\u6570\u636e\u5e93\u7684\u53e6\u4e00\u4e2a\u4f18\u70b9\u662f\uff0c\u4e0e\u78c1\u76d8\u4e0a\u7684\u76f8\u540c\u6570\u636e\u7ed3\u6784\u76f8\u6bd4\uff0c\u590d\u6742\u6570\u636e\u7ed3\u6784\u7684\u5185\u5b58\u8868\u793a\u66f4\u6613\u4e8e\u64cd\u4f5c\uff0c\u56e0\u6b64 Redis \u53ef\u4ee5\u505a\u5f88\u591a\u4e8b\u60c5\uff0c\u800c\u5185\u90e8\u590d\u6742\u6027\u5f88\u5c0f\u3002\u540c\u65f6\u8fd9\u4e24\u79cd\u78c1\u76d8\u5b58\u50a8\u683c\u5f0f\uff08RDB \u548c AOF\uff09\u4e0d\u9700\u8981\u9002\u5408\u968f\u673a\u8bbf\u95ee\uff0c\u6240\u4ee5\u5b83\u4eec\u5f88\u7d27\u51d1\u5e76\u4e14\u603b\u662f\u4ee5 append-only \u7684\u65b9\u5f0f\u751f\u6210\uff08\u5373\u4f7f AOF \u65e5\u5fd7\u8f6e\u6362\u4e5f\u662f\u4e00\u4e2a append-\u552f\u4e00\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a\u65b0\u7248\u672c\u662f\u4ece\u5185\u5b58\u4e2d\u7684\u6570\u636e\u526f\u672c\u751f\u6210\u7684\uff09\u3002\u7136\u800c\uff0c\u4e0e\u4f20\u7edf\u7684\u78c1\u76d8\u5b58\u50a8\u76f8\u6bd4\uff0c\u8fd9\u79cd\u8bbe\u8ba1\u4e5f\u6d89\u53ca\u4e0d\u540c\u7684\u6311\u6218\u3002\u4f5c\u4e3a\u5185\u5b58\u4e0a\u7684\u4e3b\u8981\u6570\u636e\u8868\u793a\uff0cRedis \u64cd\u4f5c\u5fc5\u987b\u5c0f\u5fc3\u5904\u7406\uff0c\u4ee5\u786e\u4fdd\u78c1\u76d8\u4e0a\u59cb\u7ec8\u6709\u6570\u636e\u96c6\u7684\u66f4\u65b0\u7248\u672c\n\n\u53ef\u4ee5\u5728\u4e0d\u505c\u6b62\u548c\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u7684\u60c5\u51b5\u4e0b\u52a8\u6001\u91cd\u65b0\u914d\u7f6e Redis\uff0c\u6216\u8005\u4f7f\u7528\u7279\u6b8a\u547d\u4ee4CONFIG SET\u548c CONFIG GET \u4ee5\u7f16\u7a0b\u65b9\u5f0f\u67e5\u8be2\u5f53\u524d\u914d\u7f6e\n\u5e76\u975e\u6240\u6709\u914d\u7f6e\u6307\u4ee4\u90fd\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u652f\u6301\uff0c\u4f46\u5927\u591a\u6570\u90fd\u6309\u9884\u671f\u652f\u6301\uff0c\u6b64\u4fee\u6539\u5bf9redis.conf\u6587\u4ef6\u6ca1\u5f71\u54cd\uff0c\u91cd\u542f\u6062\u590d\u65e7\u914d\u7f6e\uff0cCONFIG REWRITE\u547d\u4ee4\u53ef\u4ee5\u4fee\u6539redis.conf\u6587\u4ef6\u914d\u7f6e\n\n\u590d\u5236\n\u5728 Redis \u590d\u5236\u7684\u57fa\u7840\u4e0a\uff08\u4e0d\u5305\u62ec\u7531 Redis Cluster \u6216 Redis Sentinel \u4f5c\u4e3a\u9644\u52a0\u5c42\u63d0\u4f9b\u7684\u9ad8\u53ef\u7528\u6027\u529f\u80fd\uff09\uff0c\u6709\u4e00\u4e2a\u975e\u5e38\u6613\u4e8e\u4f7f\u7528\u548c\u914d\u7f6e\u7684\u9886\u5bfc\u8005\u8ddf\u968f\u8005\uff08\u4e3b\u4ece\uff09\u590d\u5236\uff1a\u5b83\u5141\u8bb8\u526f\u672c Redis \u5b9e\u4f8b\u7cbe\u786e\u4e3b\u5b9e\u4f8b\u7684\u526f\u672c\u3002\u6bcf\u6b21\u94fe\u63a5\u65ad\u5f00\u65f6\uff0c\u526f\u672c\u90fd\u4f1a\u81ea\u52a8\u91cd\u65b0\u8fde\u63a5\u5230\u4e3b\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u65e0\u8bba\u4e3b\u670d\u52a1\u5668\u53d1\u751f\u4ec0\u4e48\u60c5\u51b5\uff0c\u90fd\u5c06\u5c1d\u8bd5\u6210\u4e3a\u5b83\u7684\u7cbe\u786e\u526f\u672c\u3002\n\n\u8be5\u7cfb\u7edf\u4f7f\u7528\u4e09\u79cd\u4e3b\u8981\u673a\u5236\u5de5\u4f5c\uff1a\n\u5f53\u4e3b\u5b9e\u4f8b\u548c\u526f\u672c\u5b9e\u4f8b\u8fde\u63a5\u826f\u597d\u65f6\uff0c\u4e3b\u5b9e\u4f8b\u901a\u8fc7\u5411\u526f\u672c\u53d1\u9001\u547d\u4ee4\u6d41\u6765\u4fdd\u6301\u526f\u672c\u66f4\u65b0\uff0c\u4ee5\u590d\u5236\u7531\u4e8e\u4ee5\u4e0b\u539f\u56e0\u5728\u4e3b\u7aef\u53d1\u751f\u7684\u5bf9\u6570\u636e\u96c6\u7684\u5f71\u54cd\uff1a\u5ba2\u6237\u7aef\u5199\u5165\u3001\u5bc6\u94a5\u8fc7\u671f\u6216\u9a71\u9010\uff0c\u4efb\u4f55\u5176\u4ed6\u66f4\u6539\u4e3b\u6570\u636e\u96c6\u7684\u64cd\u4f5c\u3002\n\u5f53 master \u548c\u526f\u672c\u4e4b\u95f4\u7684\u94fe\u63a5\u65ad\u5f00\u65f6\uff0c\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u6216\u56e0\u4e3a\u5728 master \u6216\u526f\u672c\u4e2d\u68c0\u6d4b\u5230\u8d85\u65f6\uff0c\u526f\u672c\u5c06\u91cd\u65b0\u8fde\u63a5\u5e76\u5c1d\u8bd5\u8fdb\u884c\u90e8\u5206\u91cd\u65b0\u540c\u6b65\uff1a\u8fd9\u610f\u5473\u7740\u5b83\u5c06\u5c1d\u8bd5\u4ec5\u83b7\u53d6\u90e8\u5206\u5b83\u5728\u65ad\u5f00\u8fde\u63a5\u671f\u95f4\u9519\u8fc7\u7684\u547d\u4ee4\u6d41\u3002\n\u5f53\u90e8\u5206\u91cd\u65b0\u540c\u6b65\u4e0d\u53ef\u80fd\u65f6\uff0c\u526f\u672c\u5c06\u8981\u6c42\u5b8c\u5168\u91cd\u65b0\u540c\u6b65\u3002\u8fd9\u5c06\u6d89\u53ca\u4e00\u4e2a\u66f4\u590d\u6742\u7684\u8fc7\u7a0b\uff0c\u5176\u4e2d\u4e3b\u8282\u70b9\u9700\u8981\u4e3a\u5176\u6240\u6709\u6570\u636e\u521b\u5efa\u5feb\u7167\uff0c\u5c06\u5176\u53d1\u9001\u5230\u526f\u672c\uff0c\u7136\u540e\u968f\u7740\u6570\u636e\u96c6\u7684\u53d8\u5316\u7ee7\u7eed\u53d1\u9001\u547d\u4ee4\u6d41\n\nRedis \u590d\u5236\u7684\u4e00\u4e9b\u975e\u5e38\u91cd\u8981\u7684\u4e8b\u5b9e\uff1a\nRedis \u4f7f\u7528\u5f02\u6b65\u590d\u5236\uff0c\u5f02\u6b65\u590d\u5236\u5230\u4e3b\u8282\u70b9\u786e\u8ba4\u5904\u7406\u7684\u6570\u636e\u91cf\u3002\n\u4e00\u4e2a\u4e3b\u8282\u70b9\u53ef\u4ee5\u6709\u591a\u4e2a\u526f\u672c\u3002\n\u526f\u672c\u80fd\u591f\u63a5\u53d7\u6765\u81ea\u5176\u4ed6\u526f\u672c\u7684\u8fde\u63a5\u3002\u9664\u4e86\u5c06\u591a\u4e2a\u526f\u672c\u8fde\u63a5\u5230\u540c\u4e00\u4e2a\u4e3b\u8282\u70b9\u4e4b\u5916\uff0c\u526f\u672c\u8fd8\u53ef\u4ee5\u4ee5\u7c7b\u4f3c\u7ea7\u8054\u7684\u7ed3\u6784\u8fde\u63a5\u5230\u5176\u4ed6\u526f\u672c\u3002\u4ece Redis 4.0 \u5f00\u59cb\uff0c\u6240\u6709\u5b50\u526f\u672c\u90fd\u5c06\u4ece\u4e3b\u526f\u672c\u63a5\u6536\u5b8c\u5168\u76f8\u540c\u7684\u590d\u5236\u6d41\u3002\nRedis \u590d\u5236\u5728\u4e3b\u7aef\u662f\u975e\u963b\u585e\u7684\u3002\u8fd9\u610f\u5473\u7740\u5f53\u4e00\u4e2a\u6216\u591a\u4e2a\u526f\u672c\u6267\u884c\u521d\u59cb\u540c\u6b65\u6216\u90e8\u5206\u91cd\u65b0\u540c\u6b65\u65f6\uff0c\u4e3b\u8282\u70b9\u5c06\u7ee7\u7eed\u5904\u7406\u67e5\u8be2\u3002\n\u590d\u5236\u5728\u526f\u672c\u7aef\u4e5f\u5f88\u5927\u7a0b\u5ea6\u4e0a\u662f\u975e\u963b\u585e\u7684\u3002\u5f53\u526f\u672c\u6267\u884c\u521d\u59cb\u540c\u6b65\u65f6\uff0c\u5b83\u53ef\u4ee5\u4f7f\u7528\u65e7\u7248\u672c\u7684\u6570\u636e\u96c6\u5904\u7406\u67e5\u8be2\uff0c\u5047\u8bbe\u60a8\u5728 redis.conf \u4e2d\u5c06 Redis \u914d\u7f6e\u4e3a\u8fd9\u6837\u505a\u3002\u5426\u5219\uff0c\u60a8\u53ef\u4ee5\u5c06 Redis \u526f\u672c\u914d\u7f6e\u4e3a\u5728\u590d\u5236\u6d41\u5173\u95ed\u65f6\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u9519\u8bef\u3002\u4f46\u662f\uff0c\u5728\u521d\u59cb\u540c\u6b65\u540e\uff0c\u5fc5\u987b\u5220\u9664\u65e7\u6570\u636e\u96c6\u5e76\u52a0\u8f7d\u65b0\u6570\u636e\u96c6\u3002\u526f\u672c\u5c06\u5728\u6b64\u77ed\u6682\u7a97\u53e3\u671f\u95f4\u963b\u6b62\u4f20\u5165\u8fde\u63a5\uff08\u5bf9\u4e8e\u975e\u5e38\u5927\u7684\u6570\u636e\u96c6\u53ef\u80fd\u957f\u8fbe\u6570\u79d2\uff09\u3002\u4ece Redis 4.0 \u5f00\u59cb\uff0c\u53ef\u4ee5\u914d\u7f6e Redis \u4f7f\u65e7\u6570\u636e\u96c6\u7684\u5220\u9664\u53d1\u751f\u5728\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\uff0c\u4f46\u662f\u52a0\u8f7d\u65b0\u7684\u521d\u59cb\u6570\u636e\u96c6\u4ecd\u5c06\u53d1\u751f\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u5e76\u963b\u585e\u526f\u672c\u3002\n\u590d\u5236\u65e2\u53ef\u4ee5\u7528\u4e8e\u53ef\u6269\u5c55\u6027\uff0c\u4ee5\u4fbf\u4e3a\u53ea\u8bfb\u67e5\u8be2\u63d0\u4f9b\u591a\u4e2a\u526f\u672c\uff08\u4f8b\u5982\uff0c\u53ef\u4ee5\u5c06\u6162\u901fO(N)\u64cd\u4f5c\u5378\u8f7d\u5230\u526f\u672c\uff09\uff0c\u4e5f\u53ef\u4ee5\u4ec5\u7528\u4e8e\u63d0\u9ad8\u6570\u636e\u5b89\u5168\u6027\u548c\u9ad8\u53ef\u7528\u6027\u3002\n\u53ef\u4ee5\u4f7f\u7528\u590d\u5236\u6765\u907f\u514d\u8ba9 master \u5c06\u5b8c\u6574\u6570\u636e\u96c6\u5199\u5165\u78c1\u76d8\u7684\u6210\u672c\uff1a\u4e00\u4e2a\u5178\u578b\u7684\u6280\u672f\u5305\u62ec\u914d\u7f6e\u4f60\u7684 masterredis.conf\u6765\u5b8c\u5168\u907f\u514d\u6301\u4e45\u5316\u5230\u78c1\u76d8\uff0c\u7136\u540e\u8fde\u63a5\u4e00\u4e2a\u914d\u7f6e\u4e3a\u4e0d\u65f6\u4fdd\u5b58\u7684\u526f\u672c\uff0c\u6216\u8005\u4f7f\u7528\u542f\u7528 AOF\u3002\u4f46\u662f\uff0c\u5fc5\u987b\u5c0f\u5fc3\u5904\u7406\u6b64\u8bbe\u7f6e\uff0c\u56e0\u4e3a\u91cd\u65b0\u542f\u52a8\u7684\u4e3b\u670d\u52a1\u5668\u5c06\u4ece\u4e00\u4e2a\u7a7a\u6570\u636e\u96c6\u5f00\u59cb\uff1a\u5982\u679c\u526f\u672c\u5c1d\u8bd5\u4e0e\u5176\u540c\u6b65\uff0c\u526f\u672c\u4e5f\u5c06\u88ab\u6e05\u7a7a\n\nRedis \u590d\u5236\u7684\u5de5\u4f5c\u539f\u7406\n\u6bcf\u4e2a Redis \u4e3b\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u590d\u5236 ID\uff1a\u5b83\u662f\u4e00\u4e2a\u5927\u578b\u4f2a\u968f\u673a\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u6807\u8bb0\u6570\u636e\u96c6\u7684\u7ed9\u5b9a\u6545\u4e8b\u3002\u6bcf\u4e2a master \u8fd8\u91c7\u7528\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c\u8be5\u504f\u79fb\u91cf\u968f\u7740\u5b83\u751f\u6210\u7684\u590d\u5236\u6d41\u7684\u6bcf\u4e2a\u5b57\u8282\u800c\u589e\u52a0\u4ee5\u53d1\u9001\u5230\u526f\u672c\uff0c\u4ee5\u4fbf\u4f7f\u7528\u4fee\u6539\u6570\u636e\u96c6\u7684\u65b0\u66f4\u6539\u6765\u66f4\u65b0\u526f\u672c\u7684\u72b6\u6001\u3002\u5373\u4f7f\u5b9e\u9645\u4e0a\u6ca1\u6709\u8fde\u63a5\u526f\u672c\uff0c\u590d\u5236\u504f\u79fb\u4e5f\u4f1a\u589e\u52a0\uff0c\u6240\u4ee5\u57fa\u672c\u4e0a\u6bcf\u4e2a\u7ed9\u5b9a\u7684\u5bf9\uff1a\nReplication ID, offset\n\u6807\u8bc6\u4e3b\u6570\u636e\u96c6\u7684\u786e\u5207\u7248\u672c\u3002\n\u5f53\u526f\u672c\u8fde\u63a5\u5230\u4e3b\u8282\u70b9\u65f6\uff0c\u5b83\u4eec\u4f7f\u7528PSYNC\u547d\u4ee4\u6765\u53d1\u9001\u5b83\u4eec\u7684\u65e7\u4e3b\u526f\u672c ID \u548c\u5b83\u4eec\u5230\u76ee\u524d\u4e3a\u6b62\u5904\u7406\u7684\u504f\u79fb\u91cf\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cmaster \u53ef\u4ee5\u53ea\u53d1\u9001\u6240\u9700\u7684\u589e\u91cf\u90e8\u5206\u3002\u4f46\u662f\uff0c\u5982\u679c\u4e3b\u7f13\u51b2\u533a\u4e2d\u6ca1\u6709\u8db3\u591f\u7684\u79ef\u538b\uff0c\u6216\u8005\u5982\u679c\u526f\u672c\u5f15\u7528\u4e0d\u518d\u5df2\u77e5\u7684\u5386\u53f2\u8bb0\u5f55\uff08\u590d\u5236 ID\uff09\uff0c\u5219\u4f1a\u53d1\u751f\u5b8c\u5168\u91cd\u65b0\u540c\u6b65\uff1a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u526f\u672c\u5c06\u83b7\u5f97\u6570\u636e\u96c6\u7684\u5b8c\u6574\u526f\u672c\uff0c\u4ece\u5934\u5f00\u59cb\u200b\u200b\u3002\n\u8fd9\u662f\u5b8c\u6574\u540c\u6b65\u7684\u8be6\u7ec6\u5de5\u4f5c\u65b9\u5f0f\uff1a\n\u4e3b\u673a\u542f\u52a8\u540e\u53f0\u4fdd\u5b58\u8fc7\u7a0b\u4ee5\u751f\u6210 RDB \u6587\u4ef6\u3002\u540c\u65f6\uff0c\u5b83\u5f00\u59cb\u7f13\u51b2\u4ece\u5ba2\u6237\u7aef\u63a5\u6536\u5230\u7684\u6240\u6709\u65b0\u5199\u547d\u4ee4\u3002\u5f53\u540e\u53f0\u4fdd\u5b58\u5b8c\u6210\u540e\uff0cmaster \u5c06\u6570\u636e\u5e93\u6587\u4ef6\u4f20\u8f93\u5230\u526f\u672c\uff0c\u526f\u672c\u5c06\u5176\u4fdd\u5b58\u5728\u78c1\u76d8\u4e0a\uff0c\u7136\u540e\u5c06\u5176\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002\u4e3b\u670d\u52a1\u5668\u7136\u540e\u5c06\u6240\u6709\u7f13\u51b2\u7684\u547d\u4ee4\u53d1\u9001\u5230\u526f\u672c\u3002\u8fd9\u662f\u4f5c\u4e3a\u547d\u4ee4\u6d41\u5b8c\u6210\u7684\uff0c\u5e76\u4e14\u4e0e Redis \u534f\u8bae\u672c\u8eab\u7684\u683c\u5f0f\u76f8\u540c\u3002\n\u60a8\u53ef\u4ee5\u901a\u8fc7 telnet \u81ea\u5df1\u5c1d\u8bd5\u3002\u5f53\u670d\u52a1\u5668\u6b63\u5728\u505a\u4e00\u4e9b\u5de5\u4f5c\u65f6\u8fde\u63a5\u5230 Redis \u7aef\u53e3\u5e76\u53d1\u51faSYNC\u547d\u4ee4\u3002\u60a8\u5c06\u770b\u5230\u6279\u91cf\u4f20\u8f93\uff0c\u7136\u540e\u4e3b\u673a\u6536\u5230\u7684\u6bcf\u4e2a\u547d\u4ee4\u90fd\u5c06\u5728 telnet \u4f1a\u8bdd\u4e2d\u91cd\u65b0\u53d1\u51fa\u3002\u5b9e\u9645\u4e0aSYNC\u662f\u4e00\u4e2a\u65e7\u534f\u8bae\uff0c\u4e0d\u518d\u88ab\u8f83\u65b0\u7684 Redis \u5b9e\u4f8b\u4f7f\u7528\uff0c\u4f46\u4e3a\u4e86\u5411\u540e\u517c\u5bb9\uff0c\u5b83\u4ecd\u7136\u5b58\u5728\uff1a\u5b83\u4e0d\u5141\u8bb8\u90e8\u5206\u91cd\u65b0\u540c\u6b65\uff0c\u6240\u4ee5\u73b0\u5728\u4f7f\u7528PSYNC\u3002\n\u5982\u524d\u6240\u8ff0\uff0c\u5f53\u4e3b\u526f\u672c\u94fe\u63a5\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u526f\u672c\u80fd\u591f\u81ea\u52a8\u91cd\u65b0\u8fde\u63a5\u3002\u5982\u679c master \u6536\u5230\u591a\u4e2a\u5e76\u53d1\u526f\u672c\u540c\u6b65\u8bf7\u6c42\uff0c\u5b83\u4f1a\u6267\u200b\u200b\u884c\u5355\u4e2a\u540e\u53f0\u4fdd\u5b58\u4ee5\u670d\u52a1\u6240\u6709\u8fd9\u4e9b\u8bf7\u6c42\n\n\u914d\u7f6e\u57fa\u672c\u7684 Redis \u590d\u5236\u5f88\u7b80\u5355\uff1a\u53ea\u9700\u5728\u526f\u672c\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff1a\nreplicaof 192.168.1.1 6379\n\n\u526f\u672c\u652f\u6301\u9ed8\u8ba4\u542f\u7528\u7684\u53ea\u8bfb\u6a21\u5f0f\u3002\u6b64\u884c\u4e3a\u7531redis.conf\u6587\u4ef6\u4e2d\u7684replica-read-only\u9009\u9879\u63a7\u5236\uff0c\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u4f7f\u7528CONFIG SET\u542f\u7528\u548c\u7981\u7528\n\n\u5982\u679c\u60a8\u7684\u4e3b\u670d\u52a1\u5668\u901a\u8fc7 \u8bbe\u7f6e\u4e86\u5bc6\u7801requirepass\uff0c\u90a3\u4e48\u5c06\u526f\u672c\u914d\u7f6e\u4e3a\u5728\u6240\u6709\u540c\u6b65\u64cd\u4f5c\u4e2d\u4f7f\u7528\u8be5\u5bc6\u7801\u5c31\u5f88\u7b80\u5355\u4e86\u3002\n\u8981\u5728\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u8bf7\u4f7f\u7528redis-cli\u5e76\u952e\u5165\uff1a\nconfig set masterauth &lt;password&gt;\n\u8981\u6c38\u4e45\u8bbe\u7f6e\u5b83\uff0c\u8bf7\u5c06\u5176\u6dfb\u52a0\u5230\u60a8\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1a\nmasterauth &lt;password&gt;\n\nRedis \u8fc7\u671f\u5141\u8bb8\u5bc6\u94a5\u5177\u6709\u6709\u9650\u7684\u751f\u5b58\u65f6\u95f4 (TTL)\u3002\u8fd9\u6837\u7684\u529f\u80fd\u53d6\u51b3\u4e8e\u5b9e\u4f8b\u8ba1\u7b97\u65f6\u95f4\u7684\u80fd\u529b\uff0c\u4f46\u662f Redis \u526f\u672c\u4f1a\u6b63\u786e\u590d\u5236\u8fc7\u671f\u7684\u952e\uff0c\u5373\u4f7f\u4f7f\u7528 Lua \u811a\u672c\u66f4\u6539\u4e86\u8fd9\u4e9b\u952e\u3002\n\u4e3a\u4e86\u5b9e\u73b0\u8fd9\u6837\u7684\u7279\u6027\uff0cRedis \u4e0d\u80fd\u4f9d\u8d56\u4e3b\u4ece\u540c\u6b65\u65f6\u949f\u7684\u80fd\u529b\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u65e0\u6cd5\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u4f1a\u5bfc\u81f4\u7ade\u4e89\u6761\u4ef6\u548c\u6570\u636e\u96c6\u53d1\u6563\uff0c\u56e0\u6b64 Redis \u4f7f\u7528\u4e86\u4e09\u79cd\u4e3b\u8981\u6280\u672f\u6765\u5b9e\u73b0\u4f7f\u8fc7\u671f\u5bc6\u94a5\u7684\u590d\u5236\u80fd\u591f\u5de5\u4f5c\uff1a\n\u526f\u672c\u4e0d\u4f1a\u4f7f\u5bc6\u94a5\u8fc7\u671f\uff0c\u800c\u662f\u7b49\u5f85\u4e3b\u670d\u52a1\u5668\u4f7f\u5bc6\u94a5\u8fc7\u671f\u3002\u5f53 master \u4f7f\u5bc6\u94a5\u8fc7\u671f\uff08\u6216\u7531\u4e8e LRU \u5c06\u5176\u9a71\u9010\uff09\u65f6\uff0c\u5b83\u4f1a\u5408\u6210\u4e00\u4e2aDEL\u547d\u4ee4\uff0c\u5e76\u5c06\u5176\u4f20\u8f93\u5230\u6240\u6709\u526f\u672c\u3002\n\u7136\u800c\uff0c\u7531\u4e8e master-driven expire\uff0c\u6709\u65f6\u526f\u672c\u53ef\u80fd\u4ecd\u7136\u5728\u5185\u5b58\u4e2d\u5b58\u5728\u903b\u8f91\u4e0a\u5df2\u7ecf\u8fc7\u671f\u7684\u952e\uff0c\u56e0\u4e3a master \u65e0\u6cd5\u53ca\u65f6\u63d0\u4f9bDEL\u547d\u4ee4\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u526f\u672c\u4f7f\u7528\u5176\u903b\u8f91\u65f6\u949f\u6765\u62a5\u544a\u5bc6\u94a5\u4e0d\u5b58\u5728\uff0c\u4ec5\u7528\u4e8e\u4e0d\u8fdd\u53cd\u6570\u636e\u96c6\u4e00\u81f4\u6027\u7684\u8bfb\u53d6\u64cd\u4f5c\uff08\u56e0\u4e3a\u6765\u81ea\u4e3b\u670d\u52a1\u5668\u7684\u65b0\u547d\u4ee4\u5c06\u5230\u8fbe\uff09\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u526f\u672c\u907f\u514d\u62a5\u544a\u903b\u8f91\u4e0a\u8fc7\u671f\u7684\u952e\u4ecd\u7136\u5b58\u5728\u3002\u5b9e\u9645\u4e0a\uff0c\u4f7f\u7528\u526f\u672c\u8fdb\u884c\u7f29\u653e\u7684 HTML \u7247\u6bb5\u7f13\u5b58\u5c06\u907f\u514d\u8fd4\u56de\u5df2\u7ecf\u6bd4\u9884\u671f\u751f\u5b58\u65f6\u95f4\u65e9\u7684\u9879\u76ee\u3002\n\u5728 Lua \u811a\u672c\u6267\u884c\u671f\u95f4\uff0c\u4e0d\u4f1a\u6267\u884c\u5bc6\u94a5\u5230\u671f\u3002\u5f53 Lua \u811a\u672c\u8fd0\u884c\u65f6\uff0c\u4ece\u6982\u5ff5\u4e0a\u8bb2\uff0cmaster \u4e2d\u7684\u65f6\u95f4\u662f\u51bb\u7ed3\u7684\uff0c\u56e0\u6b64\u5728\u811a\u672c\u8fd0\u884c\u7684\u6240\u6709\u65f6\u95f4\u91cc\uff0c\u7ed9\u5b9a\u7684\u952e\u8981\u4e48\u5b58\u5728\u8981\u4e48\u4e0d\u5b58\u5728\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u5bc6\u94a5\u5728\u811a\u672c\u4e2d\u95f4\u8fc7\u671f\uff0c\u5e76\u4e14\u9700\u8981\u4ee5\u4fdd\u8bc1\u5728\u6570\u636e\u96c6\u4e2d\u5177\u6709\u76f8\u540c\u6548\u679c\u7684\u65b9\u5f0f\u5c06\u76f8\u540c\u7684\u811a\u672c\u53d1\u9001\u5230\u526f\u672c\u3002\n\u4e00\u65e6\u4e00\u4e2a\u526f\u672c\u88ab\u63d0\u5347\u4e3a\u4e00\u4e2a\u4e3b\u8282\u70b9\uff0c\u5b83\u5c31\u4f1a\u5f00\u59cb\u72ec\u7acb\u5730\u4f7f\u5bc6\u94a5\u8fc7\u671f\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u65e7\u4e3b\u8282\u70b9\u7684\u4efb\u4f55\u5e2e\u52a9\n\nappendonly\u7684\u6301\u4e45\u6027\u5982\u4f55\n\u53ef\u4ee5\u914d\u7f6e Redis \u5c06 fsync\u6570\u636e\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6b21\u6570\u3002\u5171\u6709\u4e09\u4e2a\u9009\u9879\uff1a\nappendfsync always\uff1afsync\u6bcf\u6b21\u5c06\u65b0\u547d\u4ee4\u9644\u52a0\u5230 AOF \u65f6\u3002\u975e\u5e38\u975e\u5e38\u7f13\u6162\uff0c\u975e\u5e38\u5b89\u5168\u3002\u8bf7\u6ce8\u610f\uff0c\u5728\u6267\u884c\u6765\u81ea\u591a\u4e2a\u5ba2\u6237\u7aef\u6216\u7ba1\u9053\u7684\u4e00\u6279\u547d\u4ee4\u4e4b\u540e\uff0c\u8fd9\u4e9b\u547d\u4ee4\u4f1a\u9644\u52a0\u5230 AOF\uff0c\u56e0\u6b64\u8fd9\u610f\u5473\u7740\u5355\u4e2a\u5199\u5165\u548c\u5355\u4e2a fsync\uff08\u5728\u53d1\u9001\u56de\u590d\u4e4b\u524d\uff09\nappendfsync everysec:fsync\u6bcf\u4e00\u79d2\u3002\u8db3\u591f\u5feb\uff08\u5728 2.4 \u4e2d\u53ef\u80fd\u548c\u5feb\u7167\u4e00\u6837\u5feb\uff09\uff0c\u5982\u679c\u53d1\u751f\u707e\u96be\uff0c\u60a8\u53ef\u80fd\u4f1a\u4e22\u5931 1 \u79d2\u7684\u6570\u636e\u3002\nappendfsync no\uff1a\u6c38\u8fdc\u4e0d\u8981fsync\uff0c\u53ea\u9700\u5c06\u60a8\u7684\u6570\u636e\u4ea4\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u624b\u4e2d\u3002\u66f4\u5feb\u3001\u66f4\u4e0d\u5b89\u5168\u7684\u65b9\u6cd5\u3002\u901a\u5e38 Linux \u4f1a\u4f7f\u7528\u8fd9\u79cd\u914d\u7f6e\u6bcf 30 \u79d2\u5237\u65b0\u4e00\u6b21\u6570\u636e\uff0c\u4f46\u8fd9\u53d6\u51b3\u4e8e\u5185\u6838\u7684\u7cbe\u786e\u8c03\u6574\u3002\n\u5efa\u8bae\uff08\u548c\u9ed8\u8ba4\uff09\u7b56\u7565\u662ffsync\u6bcf\u79d2\u3002\u5b83\u65e2\u975e\u5e38\u5feb\u53c8\u975e\u5e38\u5b89\u5168\u3002\u8be5always\u7b56\u7565\u5728\u5b9e\u8df5\u4e2d\u5f88\u6162\uff0c\u4f46\u5b83\u652f\u6301\u7ec4\u63d0\u4ea4\uff0c\u56e0\u6b64\u5982\u679c\u6709\u591a\u4e2a\u5e76\u884c\u5199\u5165\uff0cRedis \u4f1a\u5c1d\u8bd5\u6267\u884c\u5355\u4e2afsync\u64cd\u4f5c\n\nAOF\u6587\u4ef6\u88ab\u622a\u65ad\uff0c\u5c1d\u8bd5redis-check-aof --fix\u4fee\u590d\uff0c\u6587\u4ef6\u635f\u574f\uff0c\u5c1d\u8bd5redis-check-aof\u547d\u4ee4\u4e86\u89e3\u95ee\u9898\u6216\u624b\u52a8\u4fee\u590d\n\n\u65e5\u5fd7\u91cd\u5199\u4f7f\u7528\u5df2\u7528\u4e8e\u5feb\u7167\u7684\u76f8\u540c\u7684\u5199\u65f6\u590d\u5236\u6280\u5de7\u3002\u8fd9\u662f\u5b83\u7684\u5de5\u4f5c\u539f\u7406\uff1a\nRedis fork\uff0c\u6240\u4ee5\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u548c\u4e00\u4e2a\u7236\u8fdb\u7a0b\u3002\n\u5b69\u5b50\u5f00\u59cb\u5728\u4e34\u65f6\u6587\u4ef6\u4e2d\u5199\u5165\u65b0\u7684 AOF\u3002\n\u7236\u7ea7\u5728\u5185\u5b58\u7f13\u51b2\u533a\u4e2d\u7d2f\u79ef\u6240\u6709\u65b0\u66f4\u6539\uff08\u4f46\u540c\u65f6\u5b83\u5c06\u65b0\u66f4\u6539\u5199\u5165\u65e7\u7684\u4ec5\u9644\u52a0\u6587\u4ef6\u4e2d\uff0c\u56e0\u6b64\u5982\u679c\u91cd\u5199\u5931\u8d25\uff0c\u6211\u4eec\u662f\u5b89\u5168\u7684\uff09\u3002\n\u5f53\u5b50\u8fdb\u7a0b\u5b8c\u6210\u91cd\u5199\u6587\u4ef6\u65f6\uff0c\u7236\u8fdb\u7a0b\u6536\u5230\u4e00\u4e2a\u4fe1\u53f7\uff0c\u5e76\u5c06\u5185\u5b58\u7f13\u51b2\u533a\u9644\u52a0\u5230\u5b50\u8fdb\u7a0b\u751f\u6210\u7684\u6587\u4ef6\u7684\u672b\u5c3e\u3002\n\u73b0\u5728 Redis \u539f\u5b50\u5730\u5c06\u65e7\u6587\u4ef6\u91cd\u547d\u540d\u4e3a\u65b0\u6587\u4ef6\uff0c\u5e76\u5f00\u59cb\u5c06\u65b0\u6570\u636e\u9644\u52a0\u5230\u65b0\u6587\u4ef6\u4e2d\n\n\u5b89\u5168\n\u4ece 3.2.0 \u7248\u672c\u5f00\u59cb\uff0c\u5f53 Redis \u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\uff08\u7ed1\u5b9a\u6240\u6709\u63a5\u53e3\uff09\u5e76\u4e14\u6ca1\u6709\u4efb\u4f55\u5bc6\u7801\u8bbf\u95ee\u5b83\u65f6\uff0c\u5b83\u4f1a\u8fdb\u5165\u4e00\u79cd\u79f0\u4e3a\u4fdd\u62a4\u6a21\u5f0f\u7684\u7279\u6b8a \u6a21\u5f0f\u3002\u5728\u8fd9\u79cd\u6a21\u5f0f\u4e0b\uff0cRedis \u53ea\u56de\u590d\u6765\u81ea\u73af\u56de\u63a5\u53e3\u7684\u67e5\u8be2\uff0c\u5e76\u56de\u590d\u4ece\u5176\u4ed6\u5730\u5740\u8fde\u63a5\u7684\u5176\u4ed6\u5ba2\u6237\u7aef\u6709\u9519\u8bef\uff0c\u4f46\u662f\u7cfb\u7edf\u7ba1\u7406\u5458\u4ecd\u7136\u53ef\u4ee5\u5ffd\u7565 Redis \u7ed9\u51fa\u7684\u9519\u8bef\uff0c\u53ea\u9700\u7981\u7528\u4fdd\u62a4\u6a21\u5f0f\u6216\u624b\u52a8\u7ed1\u5b9a\u6240\u6709\u63a5\u53e3\u5373\u53ef\n\n1\u3001\u914d\u7f6erequirepass\n2\u3001\u6dfb\u52a0tls\u8ba4\u8bc1(\u5b89\u88c5openssl\u5f00\u53d1\u5e93\uff0c\u9700\u8981\u7f16\u8bd1\u65f6make BUILD_TLS=yes\uff0cTLS \u76ee\u524d\u4e0d\u652f\u6301 I/O \u7ebf\u7a0b)\n\u4f7f\u7528 Redis Cluster \u65f6\uff0c\u7528\u4e8etls-cluster yes\u4e3a\u96c6\u7fa4\u603b\u7ebf\u548c\u8de8\u8282\u70b9\u8fde\u63a5\u542f\u7528 TLS\nSentinel\u4e3b\u4ece\u6a21\u5f0f\u65f6\uff0c\u8fde\u63a5\u5230\u4e3b\u670d\u52a1\u5668\u65f6\uff0cSentinel \u5c06\u4f7f\u7528\u8be5tls-replication \u6307\u4ee4\u6765\u786e\u5b9a\u662f\u5426\u9700\u8981 TLS \u6216\u975e TLS \u8fde\u63a5\n    * \u8fd0\u884c./utils/gen-test-certs.sh\u4ee5\u751f\u6210\u6839 CA \u548c\u670d\u52a1\u5668\u8bc1\u4e66\u3002\n    * \u8fd0\u884c./runtest --tls\u6216./runtest-cluster --tls\u5728 TLS \u6a21\u5f0f\u4e0b\u8fd0\u884c Redis \u548c Redis \u96c6\u7fa4\u6d4b\u8bd5\n3\u3001\u7981\u7528\u7279\u5b9a\u547d\u4ee4\n\u4f8b\u5982\u91cd\u547d\u540dCONFIG\u547d\u4ee4\uff1arename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52\n\u7981\u7528CONFIG\u547d\u4ee4\uff1arename-command CONFIG \"\"\n\n\u8bbf\u95ee\u63a7\u5236\nRedis AUTH\u547d\u4ee4\u5728 Redis 6 \u4e2d\u5f97\u5230\u4e86\u6269\u5c55\uff0c\u6240\u4ee5\u73b0\u5728\u53ef\u4ee5\u4ee5\u4e24\u4e2a\u53c2\u6570\u7684\u5f62\u5f0f\u4f7f\u7528\u5b83\uff1a\nAUTH &lt;username&gt; &lt;password&gt;\n\u6309\u65e7\u5f62\u5f0f\u4f7f\u7528\u65f6\uff0c\u5373\uff1a\nAUTH &lt;password&gt;\n\nACL\u89c4\u5219\n\u4ee5\u4e0b\u662f\u6709\u6548 ACL \u89c4\u5219\u7684\u5217\u8868\u3002\u67d0\u4e9b\u89c4\u5219\u53ea\u662f\u5355\u4e2a\u5355\u8bcd\uff0c\u7528\u4e8e\u6fc0\u6d3b\u6216\u5220\u9664\u6807\u5fd7\uff0c\u6216\u5bf9\u7528\u6237 ACL \u6267\u884c\u7ed9\u5b9a\u7684\u66f4\u6539\u3002\u5176\u4ed6\u89c4\u5219\u662f\u4e0e\u547d\u4ee4\u6216\u7c7b\u522b\u540d\u79f0\u6216\u952e\u6a21\u5f0f\u7b49\u8fde\u63a5\u7684\u5b57\u7b26\u524d\u7f00\n\u542f\u7528\u548c\u7981\u7528\u7528\u6237\uff1a\non\uff1a\u542f\u7528\u7528\u6237\uff1a\u53ef\u4ee5\u4f5c\u4e3a\u8be5\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\noff: \u7981\u7528\u7528\u6237\uff1a\u4e0d\u518d\u53ef\u4ee5\u4f7f\u7528\u6b64\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4f46\u662f\u5df2\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fde\u63a5\u4ecd\u7136\u6709\u6548\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u9ed8\u8ba4\u7528\u6237\u88ab\u6807\u8bb0\u4e3aoff\uff0c\u5219\u65b0\u8fde\u63a5\u5c06\u4e0d\u901a\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u542f\u52a8\uff0c\u5e76\u4e14\u5c06\u8981\u6c42\u7528\u6237\u53d1\u9001\u5e26\u6709 AUTH \u9009\u9879\u7684AUTH\u6216HELLO\u4ee5\u4fbf\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u65e0\u8bba\u9ed8\u8ba4\u7528\u6237\u914d\u7f6e\u5982\u4f55\u3002\n\u5141\u8bb8\u548c\u7981\u6b62\u547d\u4ee4\uff1a\n\n+&lt;command&gt;\uff1a\u5c06\u547d\u4ee4\u6dfb\u52a0\u5230\u7528\u6237\u53ef\u4ee5\u8c03\u7528\u7684\u547d\u4ee4\u5217\u8868\u4e2d\u3002\n-&lt;command&gt;\uff1a\u5c06\u547d\u4ee4\u79fb\u5230\u7528\u6237\u53ef\u4ee5\u8c03\u7528\u7684\u547d\u4ee4\u5217\u8868\u4e2d\u3002\n+@&lt;category&gt;\uff1a\u6dfb\u52a0\u8be5\u7c7b\u522b\u4e2d\u6240\u6709\u7528\u6237\u8c03\u7528\u7684\u547d\u4ee4\uff0c\u6709\u6548\u7c7b\u522b\u5982@admin\u3001@set\u3001@sortedset\u3001...\u7b49\uff0c\u901a\u8fc7\u8c03\u7528ACL CAT\u547d\u4ee4\u67e5\u770b\u5b8c\u6574\u5217\u8868\u3002\u7279\u6b8a\u7c7b\u522b@all \u8868\u793a\u6240\u6709\u547d\u4ee4\uff0c\u5305\u62ec\u5f53\u524d\u5b58\u5728\u4e8e\u670d\u52a1\u5668\u4e2d\u7684\u547d\u4ee4\uff0c\u4ee5\u53ca\u5c06\u6765\u901a\u8fc7\u6a21\u5757\u52a0\u8f7d\u7684\u547d\u4ee4\u3002\n-@&lt;category&gt;: \u559c\u6b22+@&lt;category&gt;\u4f46\u4ece\u5ba2\u6237\u7aef\u53ef\u4ee5\u8c03\u7528\u7684\u547d\u4ee4\u5217\u8868\u4e2d\u5220\u9664\u547d\u4ee4\u3002\n+&lt;command&gt;|subcommand\uff1a\u5141\u8bb8\u5176\u4ed6\u7981\u7528\u547d\u4ee4\u7684\u7279\u5b9a\u5b50\u547d\u4ee4\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u79cd\u5f62\u5f0f\u4e0d\u5141\u8bb8\u50cf \u4e00\u6837\u5426\u5b9a-DEBUG|SEGFAULT\uff0c\u800c\u53ea\u80fd\u4ee5\u201c+\u201d\u5f00\u5934\u3002\u5982\u679c\u8be5\u547d\u4ee4\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\u5df2\u7ecf\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff0c\u5219\u6b64 ACL \u5c06\u5bfc\u81f4\u9519\u8bef\u3002\nallcommands: +@all \u7684\u522b\u540d\u3002\u8bf7\u6ce8\u610f\uff0c\u5b83\u610f\u5473\u7740\u80fd\u591f\u6267\u884c\u901a\u8fc7\u6a21\u5757\u7cfb\u7edf\u52a0\u8f7d\u7684\u6240\u6709\u672a\u6765\u547d\u4ee4\u3002\nnocommands: -@all \u7684\u522b\u540d\u3002\n\u5141\u8bb8\u548c\u7981\u6b62\u67d0\u4e9b\u952e\uff1a\n\n~&lt;pattern&gt;\uff1a\u6dfb\u52a0\u53ef\u4ee5\u4f5c\u4e3a\u547d\u4ee4\u7684\u4e00\u90e8\u5206\u63d0\u53ca\u7684\u952e\u6a21\u5f0f\u3002\u4f8b\u5982~*\u5141\u8bb8\u6240\u6709\u952e\u3002\u8be5\u6a21\u5f0f\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eKEYS\u7684\u5168\u5c40\u6837\u5f0f\u6a21\u5f0f\u3002\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u6a21\u5f0f\u3002\nallkeys: \u522b\u540d~*\u3002\nresetkeys\uff1a\u5237\u65b0\u5141\u8bb8\u7684\u952e\u6a21\u5f0f\u5217\u8868\u3002\u4f8b\u5982 ACL ~foo:* ~bar:* resetkeys ~objects:*\uff0c\u5c06\u5bfc\u81f4\u5ba2\u6237\u7aef\u53ea\u80fd\u8bbf\u95ee\u5339\u914d\u6a21\u5f0f\u7684\u5bc6\u94a5objects:*\u3002\n\u5141\u8bb8\u548c\u7981\u6b62\u53d1\u5e03/\u8ba2\u9605\u9891\u9053\uff1a\n\n&amp;&lt;pattern&gt;\uff1a\u6dfb\u52a0\u53ef\u4f9b\u7528\u6237\u8bbf\u95ee\u7684 Pub/Sub \u9891\u9053\u7684 glob \u6837\u5f0f\u6a21\u5f0f\u3002\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\u901a\u9053\u6a21\u5f0f\u3002\u8bf7\u6ce8\u610f\uff0c\u6a21\u5f0f\u5339\u914d\u4ec5\u9488\u5bf9PUBLISH\u548cSUBSCRIBE\u63d0\u5230\u7684\u9891\u9053\u8fdb\u884c\uff0c\u800cPSUBSCRIBE\u9700\u8981\u5176\u9891\u9053\u6a21\u5f0f\u4e0e\u7528\u6237\u5141\u8bb8\u7684\u9891\u9053\u6a21\u5f0f\u4e4b\u95f4\u7684\u6587\u5b57\u5339\u914d\u3002\nallchannels\uff1a\u522b\u540d&amp;*\u5141\u8bb8\u7528\u6237\u8bbf\u95ee\u6240\u6709\u53d1\u5e03/\u8ba2\u9605\u9891\u9053\u3002\nresetchannels\uff1a\u5982\u679c\u7528\u6237\u7684 Pub/Sub \u5ba2\u6237\u7aef\u4e0d\u518d\u80fd\u591f\u8bbf\u95ee\u5176\u5404\u81ea\u7684\u9891\u9053\u548c/\u6216\u9891\u9053\u6a21\u5f0f\uff0c\u5219\u5237\u65b0\u5141\u8bb8\u7684\u9891\u9053\u6a21\u5f0f\u5217\u8868\u5e76\u65ad\u5f00\u5b83\u4eec\u7684\u8fde\u63a5\u3002\n\u4e3a\u7528\u6237\u914d\u7f6e\u6709\u6548\u5bc6\u7801\uff1a\n&gt;&lt;password&gt;\uff1a\u5c06\u6b64\u5bc6\u7801\u6dfb\u52a0\u5230\u7528\u6237\u7684\u6709\u6548\u5bc6\u7801\u5217\u8868\u4e2d\u3002\u4f8b\u5982\uff0c&gt;mypass\u5c06\u201cmypass\u201d\u6dfb\u52a0\u5230\u6709\u6548\u5bc6\u7801\u5217\u8868\u4e2d\u3002\u8be5\u6307\u4ee4\u6e05\u9664nopass\u6807\u5fd7\uff08\u89c1\u4e0b\u6587\uff09\u3002\u6bcf\u4e2a\u7528\u6237\u53ef\u4ee5\u6709\u4efb\u610f\u6570\u91cf\u7684\u5bc6\u7801\u3002\n&lt;&lt;password&gt;\uff1a\u4ece\u6709\u6548\u5bc6\u7801\u5217\u8868\u4e2d\u5220\u9664\u6b64\u5bc6\u7801\u3002\u5982\u679c\u60a8\u5c1d\u8bd5\u5220\u9664\u7684\u5bc6\u7801\u5b9e\u9645\u4e0a\u672a\u8bbe\u7f6e\uff0c\u5219\u4f1a\u53d1\u51fa\u9519\u8bef\u3002\n#&lt;hash&gt;\uff1a\u5c06\u6b64 SHA-256 \u54c8\u5e0c\u503c\u6dfb\u52a0\u5230\u7528\u6237\u7684\u6709\u6548\u5bc6\u7801\u5217\u8868\u4e2d\u3002\u8be5\u6563\u5217\u503c\u5c06\u4e0e\u4e3a ACL \u7528\u6237\u8f93\u5165\u7684\u5bc6\u7801\u7684\u6563\u5217\u8fdb\u884c\u6bd4\u8f83\u3002\u8fd9\u5141\u8bb8\u7528\u6237\u5728acl.conf\u6587\u4ef6\u4e2d\u5b58\u50a8\u54c8\u5e0c\u503c\uff0c\u800c\u4e0d\u662f\u5b58\u50a8\u660e\u6587\u5bc6\u7801\u3002\u53ea\u63a5\u53d7 SHA-256 \u54c8\u5e0c\u503c\uff0c\u56e0\u4e3a\u5bc6\u7801\u54c8\u5e0c\u5fc5\u987b\u662f 64 \u4e2a\u5b57\u7b26\uff0c\u5e76\u4e14\u53ea\u80fd\u662f\u5bb9\u5668\u5c0f\u5199\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u3002\n!&lt;hash&gt;\uff1a\u4ece\u6709\u6548\u5bc6\u7801\u5217\u8868\u4e2d\u5220\u9664\u6b64\u54c8\u5e0c\u503c\u3002\u5f53\u60a8\u4e0d\u77e5\u9053\u54c8\u5e0c\u503c\u6307\u5b9a\u7684\u5bc6\u7801\u4f46\u60f3\u8981\u4ece\u7528\u6237\u4e2d\u5220\u9664\u5bc6\u7801\u65f6\uff0c\u8fd9\u5f88\u6709\u7528\u3002\nnopass\uff1a\u7528\u6237\u8bbe\u7f6e\u7684\u6240\u6709\u5bc6\u7801\u90fd\u88ab\u5220\u9664\uff0c\u5e76\u4e14\u7528\u6237\u88ab\u6807\u8bb0\u4e3a\u4e0d\u9700\u8981\u5bc6\u7801\uff1a\u8fd9\u610f\u5473\u7740\u6bcf\u4e2a\u5bc6\u7801\u90fd\u5c06\u5bf9\u8be5\u7528\u6237\u8d77\u4f5c\u7528\u3002\u5982\u679c\u6b64\u6307\u4ee4\u7528\u4e8e\u9ed8\u8ba4\u7528\u6237\uff0c\u5219\u6bcf\u4e2a\u65b0\u8fde\u63a5\u5c06\u7acb\u5373\u4f7f\u7528\u9ed8\u8ba4\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u800c\u65e0\u9700\u4efb\u4f55\u660e\u786e\u7684 AUTH \u547d\u4ee4\u3002\u8bf7\u6ce8\u610f\uff0cresetpass\u6307\u4ee4\u5c06\u6e05\u9664\u6b64\u6761\u4ef6\u3002\nresetpass\uff1a\u5237\u65b0\u5141\u8bb8\u7684\u5bc6\u7801\u5217\u8868\u3002\u6b64\u5916\uff0c\u8fd8\u5220\u9664\u4e86nopass\u72b6\u6001\u3002\u5728resetpass\u4e4b\u540e\uff0c\u7528\u6237\u6ca1\u6709\u5173\u8054\u7684\u5bc6\u7801\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0\u4e00\u4e9b\u5bc6\u7801\uff08\u6216\u7a0d\u540e\u5c06\u5176\u8bbe\u7f6e\u4e3anopass\uff09\uff0c\u5c31\u65e0\u6cd5\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\n\u6ce8\u610f\uff1a\u6ca1\u6709\u7528 nopass \u6807\u8bb0\u5e76\u4e14\u6ca1\u6709\u6709\u6548\u5bc6\u7801\u5217\u8868\u7684\u4f7f\u7528\u5b9e\u9645\u4e0a\u662f\u4e0d\u53ef\u80fd\u4f7f\u7528\u7684\uff0c\u56e0\u4e3a\u5c06\u65e0\u6cd5\u4ee5\u8fd9\u6837\u7684\u7528\u6237\u8eab\u4efd\u767b\u5f55\u3002\n\n\u91cd\u7f6e\u7528\u6237\uff1a\nreset\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1aresetpass\u3001resetkeys\u3001resetchannels\u3001off\u3001-@all\u3002\u7528\u6237\u5728\u521b\u5efa\u540e\u7acb\u5373\u8fd4\u56de\u5230\u76f8\u540c\u7684\u72b6\u6001\n\n\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u4e3b\u8981\u65b9\u5f0f\u521b\u5efa\u548c\u4fee\u6539\u7528\u6237\uff1a\n\u4f7f\u7528 ACL \u547d\u4ee4\u53ca\u5176ACL SETUSER\u5b50\u547d\u4ee4\u3002\n\u4fee\u6539\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u5728\u90a3\u91cc\u53ef\u4ee5\u5b9a\u4e49\u7528\u6237\uff0c\u5e76\u91cd\u65b0\u542f\u52a8\u670d\u52a1\u5668\uff0c\u6216\u8005\u5982\u679c\u6211\u4eec\u4f7f\u7528\u5916\u90e8 ACL \u6587\u4ef6\uff0c\u53ea\u9700\u53d1\u51faACL LOAD\n\n\u5b9a\u4e49\u7528\u6237(\u7528\u6237\u540d\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684)\uff0c\u4f7f\u5176\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\uff0c\u5177\u6709\u5bc6\u7801\uff0c\u5e76\u4e14\u53ef\u4ee5\u4ec5\u4f7f\u7528GET\u547d\u4ee4\u8bbf\u95ee\u4ee5\u5b57\u7b26\u4e32\u201ccached:\u201d\u5f00\u5934\u7684\u952e\u540d\uff1a\nACL SETUSER alice on &gt;p1pp0 ~cached:* +get\n\nACL GENPASS\u4f7f\u7528\u7cfb\u7edf\u52a0\u5bc6\u4f2a\u968f\u673a\u751f\u6210\u5668\u751f\u6210\u5bc6\u7801\n\n\u4e24\u79cd\u65b9\u6cd5\u5b58\u50a8\u7528\u6237\u5728redis\u914d\u7f6e\u4e2d\u3002\n1. user &lt;username&gt; ... acl rules ...\n\u4f8b\u5982\uff1a\nuser worker +@list +@connection ~jobs:* on &gt;ffa9203c493aa99\n\n2. \u4f7f\u7528\u5916\u90e8 ACL \u6587\u4ef6\u65f6\uff0c\u5982\u4e0b\u6240\u793a\uff1a\naclfile /etc/redis/users.acl\n\n\u54e8\u5175\u548c\u526f\u672c\u7684 ACL \u89c4\u5219\n\u5982\u679c\u60a8\u4e0d\u60f3\u63d0\u4f9b Redis \u526f\u672c\u548c Redis Sentinel \u5b9e\u4f8b\u5bf9\u60a8\u7684 Redis \u5b9e\u4f8b\u7684\u5b8c\u5168\u8bbf\u95ee\u6743\u9650\uff0c\u4ee5\u4e0b\u662f\u5fc5\u987b\u5141\u8bb8\u7684\u4e00\u7ec4\u547d\u4ee4\uff0c\u4ee5\u4fbf\u4e00\u5207\u6b63\u5e38\u5de5\u4f5c\n\u5bf9\u4e8e Sentinel\uff0c\u5141\u8bb8\u7528\u6237\u5728\u4e3b\u5b9e\u4f8b\u548c\u526f\u672c\u5b9e\u4f8b\u4e2d\u8bbf\u95ee\u4ee5\u4e0b\u547d\u4ee4\uff1a\nAUTH\u3001CLIENT\u3001SUBSCRIBE\u3001SCRIPT\u3001PUBLISH\u3001PING\u3001INFO\u3001MULTI\u3001SLAVEOF\u3001CONFIG\u3001CLIENT\u3001EXEC\u3002\nSentinel \u4e0d\u9700\u8981\u8bbf\u95ee\u6570\u636e\u5e93\u4e2d\u7684\u4efb\u4f55\u952e\uff0c\u4f46\u4f1a\u4f7f\u7528 Pub/Sub\uff0c\u56e0\u6b64 ACL \u89c4\u5219\u5982\u4e0b\uff08\u6ce8\u610f\uff1aAUTH \u4e0d\u9700\u8981\uff0c\u56e0\u4e3a\u603b\u662f\u5141\u8bb8\u7684\uff09\uff1a\nACL SETUSER sentinel-user on &gt;somepassword allchannels +multi +slaveof +ping +exec +subscribe +config|rewrite +role +publish +info +client|setname +client|kill +script|kill\n\nRedis \u526f\u672c\u9700\u8981\u5728\u4e3b\u5b9e\u4f8b\u4e0a\u5c06\u4ee5\u4e0b\u547d\u4ee4\u5217\u5165\u767d\u540d\u5355\uff1a\nPSYNC\u3001REPLCONF\u3001PING\n\u4e0d\u9700\u8981\u8bbf\u95ee\u5bc6\u94a5\uff0c\u56e0\u6b64\u8fd9\u8f6c\u5316\u4e3a\u4ee5\u4e0b\u89c4\u5219\uff1a\nACL setuser replica-user on &gt;somepassword +psync +replconf +ping\n\nRedis Sentinel\nSentinel\u529f\u80fd\u7684\u5b8c\u6574\u5217\u8868\uff1a\n\u76d1\u63a7\u3002Sentinel \u4f1a\u4e0d\u65ad\u68c0\u67e5\u60a8\u7684\u4e3b\u5b9e\u4f8b\u548c\u526f\u672c\u5b9e\u4f8b\u662f\u5426\u6309\u9884\u671f\u5de5\u4f5c\u3002\n\u901a\u77e5\u3002Sentinel \u53ef\u4ee5\u901a\u8fc7 API \u901a\u77e5\u7cfb\u7edf\u7ba1\u7406\u5458\u6216\u5176\u4ed6\u8ba1\u7b97\u673a\u7a0b\u5e8f\uff0c\u5176\u4e2d\u4e00\u4e2a\u53d7\u76d1\u63a7\u7684 Redis \u5b9e\u4f8b\u51fa\u73b0\u95ee\u9898\u3002\n\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u3002\u5982\u679c master \u6ca1\u6709\u6309\u9884\u671f\u5de5\u4f5c\uff0cSentinel \u53ef\u4ee5\u542f\u52a8\u4e00\u4e2a\u6545\u969c\u8f6c\u79fb\u8fc7\u7a0b\uff0c\u5176\u4e2d\u4e00\u4e2a\u526f\u672c\u88ab\u63d0\u5347\u4e3a master\uff0c\u5176\u4ed6\u989d\u5916\u7684\u526f\u672c\u88ab\u91cd\u65b0\u914d\u7f6e\u4e3a\u4f7f\u7528\u65b0\u7684 master\uff0c\u5e76\u4e14\u4f7f\u7528 Redis \u670d\u52a1\u5668\u7684\u5e94\u7528\u7a0b\u5e8f\u4f1a\u88ab\u544a\u77e5\u8981\u4f7f\u7528\u7684\u65b0\u5730\u5740\u8fde\u63a5\u65f6\u3002\n\u914d\u7f6e\u63d0\u4f9b\u7a0b\u5e8f\u3002Sentinel \u5145\u5f53\u5ba2\u6237\u7aef\u670d\u52a1\u53d1\u73b0\u7684\u6743\u5a01\u6765\u6e90\uff1a\u5ba2\u6237\u7aef\u8fde\u63a5\u5230 Sentinel \u4ee5\u8bf7\u6c42\u8d1f\u8d23\u7ed9\u5b9a\u670d\u52a1\u7684\u5f53\u524d Redis \u4e3b\u8282\u70b9\u7684\u5730\u5740\u3002\u5982\u679c\u53d1\u751f\u6545\u969c\u8f6c\u79fb\uff0cSentinels \u5c06\u62a5\u544a\u65b0\u5730\u5740\n\nSentinel \u672c\u8eab\u65e8\u5728\u8fd0\u884c\u5728\u591a\u4e2a Sentinel \u8fdb\u7a0b\u534f\u540c\u5de5\u4f5c\u7684\u914d\u7f6e\u4e2d\u3002\u591a\u4e2a Sentinel \u8fdb\u7a0b\u534f\u4f5c\u7684\u4f18\u52bf\u5982\u4e0b\uff1a\n\u5f53\u591a\u4e2a Sentinel \u540c\u610f\u7ed9\u5b9a\u4e3b\u670d\u52a1\u5668\u4e0d\u518d\u53ef\u7528\u7684\u4e8b\u5b9e\u65f6\uff0c\u5c06\u6267\u884c\u6545\u969c\u68c0\u6d4b\u3002\u8fd9\u964d\u4f4e\u4e86\u8bef\u62a5\u7684\u53ef\u80fd\u6027\u3002\n\u5373\u4f7f\u5e76\u975e\u6240\u6709 Sentinel \u8fdb\u7a0b\u90fd\u5728\u5de5\u4f5c\uff0cSentinel \u4e5f\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u80fd\u591f\u62b5\u5fa1\u6545\u969c\n\nSentinel \u7684\u57fa\u672c\u77e5\u8bc6\n\u60a8\u81f3\u5c11\u9700\u8981\u4e09\u4e2a Sentinel \u5b9e\u4f8b\u624d\u80fd\u8fdb\u884c\u7a33\u5065\u7684\u90e8\u7f72\u3002\n\u5e94\u8be5\u5c06\u4e09\u4e2a Sentinel \u5b9e\u4f8b\u653e\u7f6e\u5728\u88ab\u8ba4\u4e3a\u4ee5\u72ec\u7acb\u65b9\u5f0f\u53d1\u751f\u6545\u969c\u7684\u8ba1\u7b97\u673a\u6216\u865a\u62df\u673a\u4e2d\u3002\u4f8b\u5982\uff0c\u5728\u4e0d\u540c\u7684\u53ef\u7528\u533a\u57df\u4e0a\u6267\u884c\u7684\u4e0d\u540c\u7269\u7406\u670d\u52a1\u5668\u6216\u865a\u62df\u673a\u3002\nSentinel + Redis \u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0d\u4fdd\u8bc1\u5728\u6545\u969c\u671f\u95f4\u4fdd\u7559\u5df2\u786e\u8ba4\u7684\u5199\u5165\uff0c\u56e0\u4e3a Redis \u4f7f\u7528\u5f02\u6b65\u590d\u5236\u3002\u7136\u800c\uff0c\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u90e8\u7f72 Sentinel\uff0c\u4f7f\u4e22\u5931\u5199\u5165\u7684\u7a97\u53e3\u9650\u4e8e\u67d0\u4e9b\u65f6\u523b\uff0c\u800c\u8fd8\u6709\u5176\u4ed6\u4e0d\u592a\u5b89\u5168\u7684\u90e8\u7f72\u65b9\u6cd5\u3002\n\u60a8\u7684\u5ba2\u6237\u9700\u8981 Sentinel \u652f\u6301\u3002\u6d41\u884c\u7684\u5ba2\u6237\u7aef\u5e93\u6709 Sentinel \u652f\u6301\uff0c\u4f46\u4e0d\u662f\u5168\u90e8\u3002\n\u5982\u679c\u60a8\u4e0d\u5728\u5f00\u53d1\u73af\u5883\u4e2d\u4e0d\u65f6\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5219\u6ca1\u6709\u5b89\u5168\u7684 HA \u8bbe\u7f6e\uff0c\u6216\u8005\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u5982\u679c\u5b83\u4eec\u53ef\u4ee5\u5de5\u4f5c\uff0c\u5219\u66f4\u597d\u3002\u60a8\u53ef\u80fd\u6709\u4e00\u4e2a\u9519\u8bef\u914d\u7f6e\uff0c\u53ea\u6709\u5728\u4e3a\u65f6\u5df2\u665a\uff08\u5728\u60a8\u7684\u4e3b\u4eba\u505c\u6b62\u5de5\u4f5c\u7684\u51cc\u6668 3 \u70b9\uff09\u65f6\u624d\u4f1a\u53d8\u5f97\u660e\u663e\u3002\nSentinel\u3001Docker \u6216\u5176\u4ed6\u5f62\u5f0f\u7684\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u6216\u7aef\u53e3\u6620\u5c04\u5e94\u5c0f\u5fc3\u6df7\u5408\uff1aDocker \u6267\u884c\u7aef\u53e3\u91cd\u65b0\u6620\u5c04\uff0c\u7834\u574f\u5176\u4ed6 Sentinel \u8fdb\u7a0b\u7684 Sentinel \u81ea\u52a8\u53d1\u73b0\u4ee5\u53ca\u4e3b\u670d\u52a1\u5668\u7684\u526f\u672c\u5217\u8868\u3002\u67e5\u770b\u672c\u6587\u6863\u540e\u9762\u6709\u5173 Sentinel \u548c Docker \u7684\u90e8\u5206\u4ee5\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\n\n\u5178\u578b\u7684\u6700\u5c0f\u914d\u7f6e\u6587\u4ef6sentinel.conf\u5982\u4e0b\u6240\u793a\uff1a\nsentinel monitor mymaster 127.0.0.1 6379 2\nsentinel down-after-milliseconds mymaster 60000\nsentinel failover-timeout mymaster 180000\nsentinel parallel-syncs mymaster 1\n\nsentinel monitor resque 192.168.1.3 6380 4\nsentinel down-after-milliseconds resque 10000\nsentinel failover-timeout resque 180000\nsentinel parallel-syncs resque 5\n\n\u9010\u884c\u68c0\u67e5\u914d\u7f6e\u9009\u9879\u7684\u542b\u4e49\uff1a\n\u7b2c\u4e00\u884c\u7528\u4e8e\u544a\u8bc9 Redis \u76d1\u89c6\u540d\u4e3amymaster\u7684\u4e3b\u8282\u70b9\uff0c\u8be5\u4e3b\u8282\u70b9\u4f4d\u4e8e\u5730\u5740 127.0.0.1 \u548c\u7aef\u53e3 6379\uff0c\u4ef2\u88c1\u4e3a 2\u3002\u4e00\u5207\u90fd\u5f88\u660e\u663e\uff0c\u4f46\u4ef2\u88c1\u53c2\u6570\uff1a\n\u8be5\u4ef2\u88c1\u662f\u9700\u8981\u540c\u610f\u7684\u4e8b\u5b9e\u4e3b\u4eba\u662f\u4e0d\u53ef\u8fbe\u7684\uff0c\u8fd9\u6837\u624d\u80fd\u771f\u6b63\u7eaa\u5ff5\u4e3b\u4e3a\u5931\u8d25\uff0c\u5e76\u5728\u53ef\u80fd\u6700\u7ec8\u5f00\u59cb\u6545\u969c\u8f6c\u79fb\u8fc7\u7a0b\u54e8\u5175\u7684\u6570\u91cf\u3002\n\u7136\u800c\uff0c\u4ef2\u88c1\u4ec5\u7528\u4e8e\u68c0\u6d4b\u6545\u969c\u3002\u4e3a\u4e86\u5b9e\u9645\u6267\u884c\u6545\u969c\u8f6c\u79fb\uff0c\u5176\u4e2d\u4e00\u4e2a\u54e8\u5175\u9700\u8981\u88ab\u9009\u4e3a\u6545\u969c\u8f6c\u79fb\u7684\u9886\u5bfc\u8005\u5e76\u88ab\u6388\u6743\u7ee7\u7eed\u3002\u8fd9\u53ea\u53d1\u751f\u5728\u5927\u591a\u6570 Sentinel \u8fdb\u7a0b\u7684\u6295\u7968\u4e2d\u3002\n\u56e0\u6b64\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u6709 5 \u4e2a Sentinel \u8fdb\u7a0b\uff0c\u5e76\u4e14\u7ed9\u5b9a master \u7684\u4ef2\u88c1\u8bbe\u7f6e\u4e3a\u503c 2\uff0c\u5219\u4f1a\u53d1\u751f\u4ee5\u4e0b\u60c5\u51b5\uff1a\n\u5982\u679c\u4e24\u4e2a Sentinel \u540c\u65f6\u540c\u610f master \u65e0\u6cd5\u8bbf\u95ee\uff0c\u5219\u4e24\u8005\u4e4b\u4e00\u5c06\u5c1d\u8bd5\u542f\u52a8\u6545\u969c\u8f6c\u79fb\u3002\n\u5982\u679c\u603b\u5171\u81f3\u5c11\u6709\u4e09\u4e2a Sentinel \u53ef\u8bbf\u95ee\uff0c\u5219\u6545\u969c\u8f6c\u79fb\u5c06\u88ab\u6388\u6743\u5e76\u5b9e\u9645\u5f00\u59cb\u3002\n\u5b9e\u9645\u4e0a\uff0c\u8fd9\u610f\u5473\u7740\u5728\u6545\u969c\u671f\u95f4\uff0c\u5982\u679c\u5927\u591a\u6570 Sentinel \u8fdb\u7a0b\u65e0\u6cd5\u901a\u4fe1\uff08\u4e5f\u5c31\u662f\u5c11\u6570\u5206\u533a\u4e2d\u6ca1\u6709\u6545\u969c\u8f6c\u79fb\uff09\uff0c\u5219Sentinel \u6c38\u8fdc\u4e0d\u4f1a\u542f\u52a8\u6545\u969c\u8f6c\u79fb\n\ndown-after-milliseconds \u662f Sentinel \u5f00\u59cb\u8ba4\u4e3a\u5b83\u5df2\u5173\u95ed\u7684\u5b9e\u4f8b\u4e0d\u5e94\u8be5\u53ef\u8fbe\u7684\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\uff08\u8981\u4e48\u4e0d\u56de\u590d\u6211\u4eec\u7684 PING\uff0c\u8981\u4e48\u56de\u590d\u9519\u8bef\uff09\u3002\nparallel-syncs\u8bbe\u7f6e\u53ef\u4ee5\u5728\u6545\u969c\u8f6c\u79fb\u540e\u540c\u65f6\u91cd\u65b0\u914d\u7f6e\u4e3a\u4f7f\u7528\u65b0\u4e3b\u670d\u52a1\u5668\u7684\u526f\u672c\u6570\u3002\u6570\u5b57\u8d8a\u5c0f\uff0c\u5b8c\u6210\u6545\u969c\u8f6c\u79fb\u8fc7\u7a0b\u6240\u9700\u7684\u65f6\u95f4\u5c31\u8d8a\u957f\uff0c\u4f46\u662f\u5982\u679c\u5c06\u526f\u672c\u914d\u7f6e\u4e3a\u63d0\u4f9b\u65e7\u6570\u636e\uff0c\u60a8\u53ef\u80fd\u4e0d\u5e0c\u671b\u6240\u6709\u526f\u672c\u540c\u65f6\u4e0e\u4e3b\u670d\u52a1\u5668\u91cd\u65b0\u540c\u6b65\u3002\u867d\u7136\u590d\u5236\u8fc7\u7a0b\u5bf9\u4e8e\u526f\u672c\u6765\u8bf4\u5927\u591a\u662f\u975e\u963b\u585e\u7684\uff0c\u4f46\u6709\u65f6\u5b83\u4f1a\u505c\u6b62\u4ece\u4e3b\u670d\u52a1\u5668\u52a0\u8f7d\u6279\u91cf\u6570\u636e\u3002\u60a8\u53ef\u80fd\u5e0c\u671b\u901a\u8fc7\u5c06\u6b64\u9009\u9879\u8bbe\u7f6e\u4e3a\u503c 1 \u6765\u786e\u4fdd\u4e00\u6b21\u53ea\u80fd\u8bbf\u95ee\u4e00\u4e2a\u526f\u672c\n\n\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u4fee\u6539\u914d\u7f6e\u53c2\u6570\uff1a\n\u4f7f\u7528SENTINEL SET\n\u5168\u5c40\u914d\u7f6e\u53c2\u6570\u4f7f\u7528SENTINEL CONFIG SET\n\n\u5c06\u65b0 Sentinel \u6dfb\u52a0\u5230\u60a8\u7684\u90e8\u7f72\u4e2d\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8fc7\u7a0b\u3002\u60a8\u9700\u8981\u505a\u7684\u5c31\u662f\u542f\u52a8\u914d\u7f6e\u4e3a\u76d1\u89c6\u5f53\u524d\u6d3b\u52a8\u4e3b\u7ad9\u7684\u65b0 Sentinel\u3002\u5728 10 \u79d2\u5185\uff0cSentinel \u5c06\u83b7\u53d6\u5176\u4ed6 Sentinel \u7684\u5217\u8868\u4ee5\u53ca\u9644\u52a0\u5230 master \u7684\u526f\u672c\u96c6\n\n\u79fb\u9664 Sentinel \u6709\u70b9\u590d\u6742\uff1aSentinels \u6c38\u8fdc\u4e0d\u4f1a\u5fd8\u8bb0\u5df2\u7ecf\u89c1\u8fc7\u7684 Sentinels\uff0c\u5373\u4f7f\u5b83\u4eec\u5f88\u957f\u65f6\u95f4\u65e0\u6cd5\u8bbf\u95ee\uff0c\u56e0\u4e3a\u6211\u4eec\u4e0d\u60f3\u52a8\u6001\u66f4\u6539\u6388\u6743\u6545\u969c\u8f6c\u79fb\u548c\u521b\u5efa\u65b0\u914d\u7f6e\u6240\u9700\u7684\u591a\u6570\u6570\u5b57\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u5220\u9664 Sentinel\uff0c\u5e94\u5728\u6ca1\u6709\u7f51\u7edc\u5206\u533a\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a\n\u505c\u6b62\u8981\u5220\u9664\u7684 Sentinel \u7684 Sentinel \u8fdb\u7a0b\u3002\nSENTINEL RESET *\u5411\u6240\u6709\u5176\u4ed6 Sentinel \u5b9e\u4f8b\u53d1\u9001\u547d\u4ee4\uff08*\u5982\u679c\u60a8\u53ea\u60f3\u91cd\u7f6e\u4e00\u4e2a\u4e3b\u670d\u52a1\u5668\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u786e\u5207\u7684\u4e3b\u670d\u52a1\u5668\u540d\u79f0\uff09\u3002\u4e00\u4e2a\u63a5\u4e00\u4e2a\uff0c\u5b9e\u4f8b\u4e4b\u95f4\u81f3\u5c11\u7b49\u5f85 30 \u79d2\u3002\n\u901a\u8fc7\u68c0\u67e5SENTINEL MASTER mastername\u6bcf\u4e2a Sentinel\u7684\u8f93\u51fa\uff0c\u68c0\u67e5\u6240\u6709 Sentinel \u662f\u5426\u540c\u610f\u5f53\u524d\u6d3b\u52a8\u7684 Sentinel \u6570\u91cf\n\n\u5220\u9664\u65e7\u7684 master \u6216\u65e0\u6cd5\u8bbf\u95ee\u7684\u526f\u672c\nSentinel \u6c38\u8fdc\u4e0d\u4f1a\u5fd8\u8bb0\u7ed9\u5b9a master \u7684\u526f\u672c\uff0c\u5373\u4f7f\u5b83\u4eec\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u90fd\u65e0\u6cd5\u8bbf\u95ee\u3002\u8fd9\u5f88\u6709\u7528\uff0c\u56e0\u4e3a\u54e8\u5175\u5e94\u8be5\u80fd\u591f\u5728\u7f51\u7edc\u5206\u533a\u6216\u6545\u969c\u4e8b\u4ef6\u540e\u6b63\u786e\u5730\u91cd\u65b0\u914d\u7f6e\u8fd4\u56de\u7684\u526f\u672c\u3002\n\u6b64\u5916\uff0c\u5728\u6545\u969c\u8f6c\u79fb\u4e4b\u540e\uff0c\u6545\u969c\u8f6c\u79fb\u7684\u4e3b\u670d\u52a1\u5668\u5b9e\u9645\u4e0a\u88ab\u6dfb\u52a0\u4e3a\u65b0\u4e3b\u670d\u52a1\u5668\u7684\u526f\u672c\uff0c\u8fd9\u6837\u4e00\u65e6\u65b0\u4e3b\u670d\u52a1\u5668\u518d\u6b21\u53ef\u7528\uff0c\u5b83\u5c06\u88ab\u91cd\u65b0\u914d\u7f6e\u4e3a\u4e0e\u65b0\u4e3b\u670d\u52a1\u5668\u8fdb\u884c\u590d\u5236\u3002\n\u4f46\u662f\uff0c\u6709\u65f6\u60a8\u5e0c\u671b\u4ece Sentinels \u76d1\u63a7\u7684\u526f\u672c\u5217\u8868\u4e2d\u6c38\u8fdc\u5220\u9664\u4e00\u4e2a\u526f\u672c\uff08\u53ef\u80fd\u662f\u65e7\u7684 master\uff09\u3002\n\u4e3a\u6b64\uff0c\u60a8\u9700\u8981\u5411SENTINEL RESET mastername\u6240\u6709 Sentinel\u53d1\u9001\u4e00\u4e2a\u547d\u4ee4\uff1a\u5b83\u4eec\u5c06\u5728\u63a5\u4e0b\u6765\u7684 10 \u79d2\u5185\u5237\u65b0\u526f\u672c\u5217\u8868\uff0c\u53ea\u6dfb\u52a0\u4ece\u5f53\u524d\u4e3bINFO\u8f93\u51fa\u4e2d\u5217\u4e3a\u6b63\u786e\u590d\u5236\u7684\u526f\u672c\n\nRedis \u5b9e\u4f8b\u6709\u4e00\u4e2a\u540d\u4e3areplica-priority. \u6b64\u4fe1\u606f\u7531 Redis \u526f\u672c\u5b9e\u4f8b\u5728\u5176INFO\u8f93\u51fa\u4e2d\u516c\u5f00\uff0cSentinel \u4f7f\u7528\u5b83\u4ece\u53ef\u7528\u4e8e\u6545\u969c\u8f6c\u79fb\u4e3b\u670d\u52a1\u5668\u7684\u526f\u672c\u4e2d\u9009\u62e9\u4e00\u4e2a\u526f\u672c\uff1a\n\u5982\u679c\u526f\u672c\u4f18\u5148\u7ea7\u8bbe\u7f6e\u4e3a 0\uff0c\u5219\u526f\u672c\u6c38\u8fdc\u4e0d\u4f1a\u63d0\u5347\u4e3a\u4e3b\u670d\u52a1\u5668\u3002\nSentinel \u9996\u9009\u5177\u6709\u8f83\u4f4e\u4f18\u5148\u7ea7\u7f16\u53f7\u7684\u526f\u672c\n\n\u4ece Redis 6 \u5f00\u59cb\uff0c\u7528\u6237\u8eab\u4efd\u9a8c\u8bc1\u548c\u6743\u9650\u7531\u8bbf\u95ee\u63a7\u5236\u5217\u8868 (ACL) \u7ba1\u7406\u3002\n\u4e3a\u4e86\u8ba9 Sentinel \u5728\u914d\u7f6e\u4e86 ACL \u65f6\u8fde\u63a5\u5230 Redis \u670d\u52a1\u5668\u5b9e\u4f8b\uff0cSentinel \u914d\u7f6e\u5fc5\u987b\u5305\u542b\u4ee5\u4e0b\u6307\u4ee4\uff1a\nsentinel auth-user &lt;master-group-name&gt; &lt;username&gt;\nsentinel auth-pass &lt;master-group-name&gt; &lt;password&gt;\n\n\u542f\u7528\u5ef6\u8fdf\u76d1\u63a7\uff0c\u8bb0\u5f55\u6240\u6709\u963b\u585e\u670d\u52a1\u5668\u7684\u65f6\u95f4\u7b49\u4e8e\u6216\u5927\u4e8e 100 \u6beb\u79d2\u7684\u4e8b\u4ef6\nCONFIG SET latency-monitor-threshold 100\n\nLATENCY LATEST - \u8fd4\u56de\u6240\u6709\u4e8b\u4ef6\u7684\u6700\u65b0\u5ef6\u8fdf\u6837\u672c\u3002\nLATENCY HISTORY - \u8fd4\u56de\u7ed9\u5b9a\u4e8b\u4ef6\u7684\u5ef6\u8fdf\u65f6\u95f4\u5e8f\u5217\u3002\nLATENCY RESET - \u91cd\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2a\u4e8b\u4ef6\u7684\u5ef6\u8fdf\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002\nLATENCY GRAPH - \u5448\u73b0\u4e8b\u4ef6\u5ef6\u8fdf\u6837\u672c\u7684 ASCII \u827a\u672f\u56fe\u3002\nLATENCY DOCTOR - \u56de\u590d\u4eba\u7c7b\u53ef\u8bfb\u7684\u5ef6\u8fdf\u5206\u6790\u62a5\u544a\n\nRedis Cluster\nRedis Cluster\u6570\u636e \u5728\u591a\u4e2a Redis \u8282\u70b9\u4e4b\u95f4\u81ea\u52a8\u5206\u7247\uff0c\u5f53\u90e8\u5206\u8282\u70b9\u51fa\u73b0\u6545\u969c\u6216\u65e0\u6cd5\u4e0e\u96c6\u7fa4\u7684\u5176\u4f59\u90e8\u5206\u901a\u4fe1\u65f6\u7ee7\u7eed\u64cd\u4f5c\u7684\u80fd\u529b\nRedis Cluster \u4e0d\u652f\u6301\u50cf Redis \u7684\u72ec\u7acb\u7248\u672c\u90a3\u6837\u652f\u6301\u591a\u4e2a\u6570\u636e\u5e93\u3002\u53ea\u6709\u6570\u636e\u5e93 0 \u5e76\u4e14\u4e0d\u5141\u8bb8\u4f7f\u7528SELECT\u547d\u4ee4\n\n\u4e3a\u4e86\u4f7f Docker \u517c\u5bb9 Redis Cluster\uff0c\u9700\u8981\u4f7f\u7528Docker\u7684\u4e3b\u673a\u7ec4\u7f51\u65b9\u5f0f\nRedis Cluster \u4e0d\u4f7f\u7528\u4e00\u81f4\u6027\u6563\u5217\uff0c\u800c\u662f\u4e00\u79cd\u4e0d\u540c\u5f62\u5f0f\u7684\u5206\u7247\uff0c\u5176\u4e2d\u6bcf\u4e2a\u952e\u5728\u6982\u5ff5\u4e0a\u90fd\u662f\u6211\u4eec\u6240\u8c13\u7684\u6563\u5217\u69fd\u7684\u4e00\u90e8\u5206\uff0c\u96c6\u7fa4\u4e2d\u6709 16384 \u4e2a\u54c8\u5e0c\u69fd\n\nRedis Cluster\u5728redis.conf\u6587\u4ef6\u4e2d\u5f15\u5165\u7684\u914d\u7f6e\u53c2\u6570\ncluster-enabled&lt;yes/no&gt;\uff1a\u5982\u679c\u662f\uff0c\u5219\u5728\u7279\u5b9a Redis \u5b9e\u4f8b\u4e2d\u542f\u7528 Redis Cluster \u652f\u6301\u3002\u5426\u5219\uff0c\u8be5\u5b9e\u4f8b\u50cf\u5f80\u5e38\u4e00\u6837\u4f5c\u4e3a\u72ec\u7acb\u5b9e\u4f8b\u542f\u52a8\u3002\ncluster-config-file&lt;filename&gt;\uff1a\u6ce8\u610f\uff0c\u5c3d\u7ba1\u8fd9\u4e2a\u9009\u9879\u7684\u540d\u79f0\uff0c\u8fd9\u4e0d\u662f\u4e00\u4e2a\u7528\u6237\u53ef\u7f16\u8f91\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u662f\u4e00\u4e2aRedis Cluster\u8282\u70b9\u5728\u6bcf\u6b21\u6709\u53d8\u5316\u65f6\u81ea\u52a8\u6301\u4e45\u5316\u96c6\u7fa4\u914d\u7f6e\uff08\u72b6\u6001\uff0c\u57fa\u672c\u4e0a\uff09\u7684\u6587\u4ef6\uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u542f\u52a8\u65f6\u91cd\u65b0\u8bfb\u53d6\u5b83\u3002\u8be5\u6587\u4ef6\u5217\u51fa\u4e86\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6\u8282\u70b9\u3001\u5b83\u4eec\u7684\u72b6\u6001\u3001\u6301\u4e45\u53d8\u91cf\u7b49\u5185\u5bb9\u3002\u7531\u4e8e\u67d0\u4e9b\u6d88\u606f\u63a5\u6536\uff0c\u6b64\u6587\u4ef6\u901a\u5e38\u4f1a\u88ab\u91cd\u5199\u5e76\u5237\u65b0\u5230\u78c1\u76d8\u4e0a\u3002\ncluster-node-timeout&lt;milliseconds&gt;\uff1aRedis \u96c6\u7fa4\u8282\u70b9\u4e0d\u53ef\u7528\u7684\u6700\u957f\u65f6\u95f4\uff0c\u800c\u4e0d\u88ab\u89c6\u4e3a\u5931\u8d25\u3002\u5982\u679c\u4e3b\u8282\u70b9\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5b83\u5c06\u7531\u5176\u4ece\u5c5e\u8282\u70b9\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\u3002\u8be5\u53c2\u6570\u63a7\u5236Redis Cluster\u4e2d\u5176\u4ed6\u91cd\u8981\u7684\u4e8b\u60c5\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u65e0\u6cd5\u8bbf\u95ee\u5927\u591a\u6570\u4e3b\u8282\u70b9\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u5c06\u505c\u6b62\u63a5\u53d7\u67e5\u8be2\u3002\ncluster-slave-validity-factor&lt;factor&gt;\uff1a\u5982\u679c\u8bbe\u7f6e\u4e3a\u96f6\uff0c\u5219\u4ece\u7ad9\u5c06\u59cb\u7ec8\u8ba4\u4e3a\u81ea\u5df1\u6709\u6548\uff0c\u56e0\u6b64\u5c06\u59cb\u7ec8\u5c1d\u8bd5\u5bf9\u4e3b\u7ad9\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\uff0c\u65e0\u8bba\u4e3b\u7ad9\u548c\u4ece\u7ad9\u4e4b\u95f4\u7684\u94fe\u63a5\u4fdd\u6301\u65ad\u5f00\u8fde\u63a5\u7684\u65f6\u95f4\u957f\u77ed\u3002\u5982\u679c\u503c\u4e3a\u6b63\uff0c\u5219\u8ba1\u7b97\u6700\u5927\u65ad\u5f00\u65f6\u95f4\u4e3a\u8282\u70b9\u8d85\u65f6\u503c\u4e58\u4ee5\u6b64\u9009\u9879\u63d0\u4f9b\u7684\u56e0\u5b50\uff0c\u5982\u679c\u8282\u70b9\u662f\u4ece\u8282\u70b9\uff0c\u5982\u679c\u4e3b\u94fe\u63a5\u65ad\u5f00\u7684\u65f6\u95f4\u8d85\u8fc7\u6307\u5b9a\u7684\u65f6\u95f4\uff0c\u5b83\u5c06\u4e0d\u4f1a\u5c1d\u8bd5\u542f\u52a8\u6545\u969c\u8f6c\u79fb\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8282\u70b9\u8d85\u65f6\u8bbe\u7f6e\u4e3a 5 \u79d2\uff0c\u5e76\u4e14\u6709\u6548\u6027\u56e0\u5b50\u8bbe\u7f6e\u4e3a 10\uff0c\u5219\u4ece\u7ad9\u4e0e\u4e3b\u7ad9\u65ad\u5f00\u8fde\u63a5\u8d85\u8fc7 50 \u79d2\u7684\u4ece\u7ad9\u5c06\u4e0d\u4f1a\u5c1d\u8bd5\u5bf9\u5176\u4e3b\u7ad9\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u6ca1\u6709\u80fd\u591f\u5bf9\u5176\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\u7684\u4ece\u5c5e\u670d\u52a1\u5668\uff0c\u5219\u4efb\u4f55\u975e\u96f6\u503c\u90fd\u53ef\u80fd\u5bfc\u81f4 Redis \u96c6\u7fa4\u5728\u4e3b\u670d\u52a1\u5668\u6545\u969c\u540e\u4e0d\u53ef\u7528\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u53ea\u6709\u5f53\u539f\u59cb\u4e3b\u8282\u70b9\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\u65f6\uff0c\u96c6\u7fa4\u624d\u4f1a\u6062\u590d\u53ef\u7528\u3002\ncluster-migration-barrier&lt;count&gt;\uff1a\u4e00\u4e2a\u4e3b\u7ad9\u5c06\u4fdd\u6301\u8fde\u63a5\u7684\u6700\u5c0f\u4ece\u7ad9\u6570\u91cf\uff0c\u4ee5\u4fbf\u53e6\u4e00\u4e2a\u4ece\u7ad9\u8fc1\u79fb\u5230\u4e0d\u518d\u88ab\u4efb\u4f55\u4ece\u7ad9\u8986\u76d6\u7684\u4e3b\u7ad9\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u672c\u6559\u7a0b\u4e2d\u6709\u5173\u526f\u672c\u8fc1\u79fb\u7684\u76f8\u5e94\u90e8\u5206\u3002\ncluster-require-full-coverage&lt;yes/no&gt;\uff1a\u5982\u679c\u5c06\u5176\u8bbe\u7f6e\u4e3a yes\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4efb\u4f55\u8282\u70b9\u672a\u8986\u76d6\u4e00\u5b9a\u767e\u5206\u6bd4\u7684\u5bc6\u94a5\u7a7a\u95f4\uff0c\u5219\u96c6\u7fa4\u5c06\u505c\u6b62\u63a5\u53d7\u5199\u5165\u3002\u5982\u679c\u8be5\u9009\u9879\u8bbe\u7f6e\u4e3a no\uff0c\u5373\u4f7f\u53ea\u80fd\u5904\u7406\u6709\u5173\u5bc6\u94a5\u5b50\u96c6\u7684\u8bf7\u6c42\uff0c\u96c6\u7fa4\u4ecd\u5c06\u63d0\u4f9b\u67e5\u8be2\u670d\u52a1\u3002\ncluster-allow-reads-when-down&lt;yes/no&gt;\uff1a\u5982\u679c\u8bbe\u7f6e\u4e3a no\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u96c6\u7fa4\u88ab\u6807\u8bb0\u4e3a\u5931\u8d25\u65f6\uff0cRedis \u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u5c06\u505c\u6b62\u4e3a\u6240\u6709\u6d41\u91cf\u63d0\u4f9b\u670d\u52a1\uff0c\u6216\u8005\u5f53\u8282\u70b9\u65e0\u6cd5\u8bbf\u95ee\u65f6\u8fbe\u5230\u6cd5\u5b9a\u4eba\u6570\u6216\u672a\u8fbe\u5230\u5b8c\u5168\u8986\u76d6\u65f6\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u4ece\u4e0d\u77e5\u9053\u96c6\u7fa4\u53d8\u5316\u7684\u8282\u70b9\u8bfb\u53d6\u6f5c\u5728\u7684\u4e0d\u4e00\u81f4\u6570\u636e\u3002\u53ef\u4ee5\u5c06\u6b64\u9009\u9879\u8bbe\u7f6e\u4e3a yes \u4ee5\u5141\u8bb8\u5728\u5931\u8d25\u72b6\u6001\u671f\u95f4\u4ece\u8282\u70b9\u8bfb\u53d6\uff0c\u8fd9\u5bf9\u4e8e\u5e0c\u671b\u4f18\u5148\u8003\u8651\u8bfb\u53d6\u53ef\u7528\u6027\u4f46\u4ecd\u5e0c\u671b\u9632\u6b62\u4e0d\u4e00\u81f4\u5199\u5165\u7684\u5e94\u7528\u7a0b\u5e8f\u975e\u5e38\u6709\u7528\u3002\u5b83\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4f7f\u7528\u53ea\u6709\u4e00\u4e2a\u6216\u4e24\u4e2a\u5206\u7247\u7684 Redis Cluster \u65f6\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u8282\u70b9\u5728\u4e3b\u8282\u70b9\u53d1\u751f\u6545\u969c\u4f46\u65e0\u6cd5\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u65f6\u7ee7\u7eed\u63d0\u4f9b\u5199\u5165\u670d\u52a1\n\n\u5feb\u901f\u65b9\u6cd5\u53ef\u4f7f\u7528 create-cluster \u811a\u672c\u521b\u5efa Redis \u96c6\u7fa4\n\u53ea\u9700\u952e\u5165\u4ee5\u4e0b\u547d\u4ee4\n1\u3001create-cluster start\n2\u3001create-cluster create\n\u5b8c\u6210\u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u505c\u6b62\u96c6\u7fa4\uff1a\ncreate-cluster stop\n\n\u4ee5\u4e0b\u624b\u52a8\u521b\u5efa\u96c6\u7fa4\u7b80\u5355\u793a\u4f8b\n\u6700\u5c0f\u7684Redis\u96c6\u7fa4\u914d\u7f6e\u6587\u4ef6\uff1a\nport 7000\ncluster-enabled yes\ncluster-config-file nodes.conf\ncluster-node-timeout 5000\nappendonly yes\n\u542f\u7528\u96c6\u7fa4\u6a21\u5f0f\u7684\u53ea\u662fcluster-enabled \u6307\u4ee4\u3002\u6bcf\u4e2a\u5b9e\u4f8b\u8fd8\u5305\u542b\u5b58\u50a8\u6b64\u8282\u70b9\u914d\u7f6e\u7684\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3anodes.conf. \u8fd9\u4e2a\u6587\u4ef6\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u4eba\u7c7b\u89e6\u53ca\uff1b\u5b83\u53ea\u662f\u5728 Redis \u96c6\u7fa4\u5b9e\u4f8b\u542f\u52a8\u65f6\u751f\u6210\uff0c\u5e76\u5728\u6bcf\u6b21\u9700\u8981\u65f6\u66f4\u65b0\n\n\u6309\u9884\u671f\u5de5\u4f5c\u7684\u6700\u5c0f\u96c6\u7fa4\u9700\u8981\u5305\u542b\u81f3\u5c11\u4e09\u4e2a\u4e3b\u8282\u70b9\u3002\u5bf9\u4e8e\u60a8\u7684\u7b2c\u4e00\u6b21\u6d4b\u8bd5\uff0c\u5f3a\u70c8\u5efa\u8bae\u542f\u52a8\u4e00\u4e2a\u5177\u6709\u4e09\u4e2a\u4e3b\u8282\u70b9\u548c\u4e09\u4e2a\u4ece\u8282\u70b9\u7684\u516d\u8282\u70b9\u96c6\u7fa4\n\u8981\u4e3a Redis 5\u7248\u672c\u521b\u5efa\u96c6\u7fa4\uff0credis-cli\u53ea\u9700\u952e\u5165\uff1a\nredis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 \\\n127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 \\\n--cluster-replicas 1\n\n\u4f7f\u7528redis-trib.rb\u7528\u4e8eRedis\u76844\u62163\u7248\u672c\uff1a\n./redis-trib.rb create --replicas 1 127.0.0.1:7000 127.0.0.1:7001 \\\n127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005\n\nRedis Cluster \u4f7f\u7528CLUSTER FAILOVER \u547d\u4ee4\u652f\u6301\u624b\u52a8\u6545\u969c\u8f6c\u79fb\uff0c\u8be5\u547d\u4ee4\u5fc5\u987b\u5728\u8981\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\u7684\u4e3b\u7ad9\u7684\u4ece\u7ad9\u4e4b\u4e00\u4e2d\u6267\u884c\n\n\u4f7f\u7528redis-cli\u5c06\u8282\u70b9\u6dfb\u52a0\u5230\u73b0\u6709\u96c6\u7fa4\u4e2d\nredis-cli --cluster add-node 127.0.0.1:7006 127.0.0.1:7000\n\n\u6dfb\u52a0\u65b0\u8282\u70b9\u4f5c\u4e3a\u526f\u672c\nredis-cli --cluster add-node 127.0.0.1:7006 127.0.0.1:7000 --cluster-slave\n\u6b64\u5904\u7684\u547d\u4ee4\u884c\u4e0e\u6211\u4eec\u7528\u4e8e\u6dfb\u52a0\u65b0\u4e3b\u670d\u52a1\u5668\u7684\u547d\u4ee4\u884c\u5b8c\u5168\u76f8\u540c\uff0c\u56e0\u6b64\u6211\u4eec\u6ca1\u6709\u6307\u5b9a\u8981\u5c06\u526f\u672c\u6dfb\u52a0\u5230\u54ea\u4e2a\u4e3b\u670d\u52a1\u5668\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0credis-cli \u4f1a\u5728\u526f\u672c\u8f83\u5c11\u7684\u4e3b\u8282\u70b9\u4e2d\u6dfb\u52a0\u65b0\u8282\u70b9\u4f5c\u4e3a\u968f\u673a\u4e3b\u8282\u70b9\u7684\u526f\u672c\u3002\n\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u884c\u51c6\u786e\u6307\u5b9a\u8981\u4f7f\u7528\u65b0\u526f\u672c\u5b9a\u4f4d\u7684\u4e3b\u670d\u52a1\u5668\nredis-cli --cluster add-node 127.0.0.1:7006 127.0.0.1:7000 --cluster-slave --cluster-master-id 3c3a0c74aae0b56170ccb03a76b60cfe7dc1912e\n\u5c06\u526f\u672c\u6dfb\u52a0\u5230\u7279\u5b9a\u4e3b\u8282\u70b9\u7684\u66f4\u624b\u52a8\u65b9\u6cd5\u662f\u5c06\u65b0\u8282\u70b9\u6dfb\u52a0\u4e3a\u7a7a\u4e3b\u8282\u70b9\uff0c\u7136\u540e\u4f7f\u7528CLUSTER REPLICATE\u547d\u4ee4\u5c06\u5176\u8f6c\u6362\u4e3a\u526f\u672c\nredis 127.0.0.1:7006&gt; cluster replicate 3c3a0c74aae0b56170ccb03a76b60cfe7dc1912e\n\n\u5220\u9664\u8282\u70b9\nredis-cli --cluster del-node 127.0.0.1:7000 `&lt;node-id&gt;`\n\n\u5347\u7ea7Redis\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\n\u5347\u7ea7\u4ece\u8282\u70b9\u5f88\u5bb9\u6613\uff0c\u56e0\u4e3a\u60a8\u53ea\u9700\u8981\u505c\u6b62\u8282\u70b9\u5e76\u4f7f\u7528\u66f4\u65b0\u7248\u672c\u7684 Redis \u91cd\u65b0\u542f\u52a8\u5b83\u3002\u5982\u679c\u6709\u5ba2\u6237\u7aef\u4f7f\u7528\u4ece\u8282\u70b9\u6269\u5c55\u8bfb\u53d6\uff0c\u5982\u679c\u7ed9\u5b9a\u7684\u4ece\u8282\u70b9\u4e0d\u53ef\u7528\uff0c\u5b83\u4eec\u5e94\u8be5\u80fd\u591f\u91cd\u65b0\u8fde\u63a5\u5230\u4e0d\u540c\u7684\u4ece\u8282\u70b9\u3002\n\n\u5347\u7ea7masters\u6709\u70b9\u590d\u6742\uff0c\u5efa\u8bae\u7684\u7a0b\u5e8f\u662f\uff1a\n\u4f7f\u7528 CLUSTER FAILOVER \u89e6\u53d1\u4e3b\u4ece\u624b\u52a8\u6545\u969c\u8f6c\u79fb\u5230\u5176\u4ece\u5c5e\u4e4b\u4e00\uff08\u8bf7\u53c2\u9605\u672c\u6587\u6863\u7684\u201c\u624b\u52a8\u6545\u969c\u8f6c\u79fb\u201d\u90e8\u5206\uff09\u3002\n\u7b49\u5f85\u4e3b\u4eba\u53d8\u6210\u5974\u96b6\u3002\n\u6700\u540e\u50cf\u5347\u7ea7\u4ece\u8282\u70b9\u4e00\u6837\u5347\u7ea7\u8282\u70b9\u3002\n\u5982\u679c\u60a8\u5e0c\u671b master \u6210\u4e3a\u60a8\u521a\u521a\u5347\u7ea7\u7684\u8282\u70b9\uff0c\u8bf7\u89e6\u53d1\u65b0\u7684\u624b\u52a8\u6545\u969c\u8f6c\u79fb\uff0c\u4ee5\u4fbf\u5c06\u5347\u7ea7\u540e\u7684\u8282\u70b9\u6062\u590d\u4e3a master\n</code></pre>"},{"location":"lbha/Haproxy/","title":"Haproxy","text":""},{"location":"lbha/Haproxy/#intro","title":"Intro","text":"<p>\u4ecb\u7ecd\u8d1f\u8f7d\u5e73\u8861\u7684\u57fa\u7840\u77e5\u8bc6\uff0cHAProxy\u4f5c\u4e3a\u4e00\u79cd\u4ea7\u54c1\uff0c\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e0d\u7528\u6765\u505a\u4ec0\u4e48\uff0c\u4e00\u4e9b\u5df2\u77e5\u7684\u9677\u9631\u907f\u514d\uff0c\u4e00\u4e9b\u7279\u5b9a\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u9650\u5236\uff0c\u83b7\u53d6\u3001\u53d1\u5c55\u53ca\u66f4\u65b0\u5b83\uff0c\u5982\u4f55\u786e\u4fdd\u60a8\u8fd0\u884c\u6240\u6709\u5df2\u77e5\u7684\u4fee\u8865\u7a0b\u5e8f\uff0c\u5173\u4e8e\u5b83\u7684\u8865\u5145\u548c\u66ff\u4ee3\u54c1</p> <p>HAProxy\u662f\uff1a</p> <ul> <li>TCP\u4ee3\u7406\uff1a\u5b83\u53ef\u4ee5\u63a5\u53d7\u6765\u81ea\u4fa6\u542c\u5957\u63a5\u5b57\u7684TCP\u8fde\u63a5\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5e76\u5c06\u8fd9\u4e9b\u63d2\u5ea7\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5141\u8bb8\u6d41\u91cf\u4e24\u4e2a\u65b9\u5411\u6d41\u52a8;</li> <li>HTTP\u53cd\u5411\u4ee3\u7406\uff08\u5728HTTP\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u7f51\u5173\u201d\uff09\uff1a\u5b83\u672c\u8eab\u4f5c\u4e3a\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u63a5\u53d7\u7684\u8fde\u63a5\u63a5\u6536HTTP\u8bf7\u6c42\u4fa6\u542cTCP\u5957\u63a5\u5b57\uff0c\u5e76\u5c06\u6765\u81ea\u8fd9\u4e9b\u8fde\u63a5\u7684\u8bf7\u6c42\u4f20\u9012\u7ed9\u4f7f\u7528\u4e0d\u540c\u8fde\u63a5\u7684\u670d\u52a1\u5668</li> <li>SSL\u7ec8\u7ed3\u5668/\u542f\u52a8\u5668/\u5378\u8f7d\u5668\uff1a\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u53ef\u4ee5\u4f7f\u7528SSL/TLS\uff0c\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u751a\u81f3\u53cc\u5411\u8fde\u63a5</li> <li>TCP\u89c4\u8303\u5316\u5668\uff1a\u7531\u4e8e\u64cd\u4f5c\u5728\u672c\u5730\u7ec8\u6b62\u8fde\u63a5\u7cfb\u7edf\uff0c\u53cc\u65b9\u6ca1\u6709\u5173\u7cfb\uff0c\u6240\u4ee5\u4ea4\u901a\u4e0d\u6b63\u5e38\u7b49\u65e0\u6548\u6570\u636e\u5305\uff0c\u6807\u5fd7\u7ec4\u5408\uff0c\u7a97\u53e3\u5e7f\u544a\uff0c\u5e8f\u5217\u53f7\uff0c\u4e0d\u5b8c\u6574\u7684\u8fde\u63a5\uff08SYN floods\uff09\uff0c\u6216\u8005\u4e0d\u4f1a\u4f20\u9012\u7ed9\u53e6\u4e00\u4e2a\u4fa7\u3002\u8fd9\u53ef\u4ee5\u4fdd\u62a4\u8106\u5f31\u7684TCP\u5806\u6808\u514d\u53d7\u534f\u8bae\u653b\u51fb\u5141\u8bb8\u4e0e\u5ba2\u6237\u7aef\u4f18\u5316\u8fde\u63a5\u53c2\u6570\u800c\u65e0\u9700\u4fee\u6539\u670d\u52a1\u5668\u7684TCP\u5806\u6808\u8bbe\u7f6e</li> <li>HTTP\u89c4\u8303\u5316\u7a0b\u5e8f\uff1a\u914d\u7f6e\u4e3a\u5904\u7406HTTP\u6d41\u91cf\u65f6\uff0c\u4ec5\u6709\u6548\u5b8c\u6210\u8bf7\u6c42\u5df2\u901a\u8fc7\u3002\u8fd9\u53ef\u4ee5\u9632\u6b62\u8bb8\u591a\u57fa\u4e8e\u534f\u8bae\u7684\u653b\u51fb\u3002\u53e6\u5916\uff0c\u5b58\u5728\u5bb9\u5dee\u7684\u534f\u8bae\u504f\u5dee\u5728\u89c4\u8303\u4e2d\u662f\u56fa\u5b9a\u7684\uff0c\u8fd9\u6837\u5b83\u4eec\u5c31\u4e0d\u4f1a\u5f15\u8d77\u95ee\u9898\u670d\u52a1\u5668\uff08\u4f8b\u5982\u591a\u884c\u6807\u9898\uff09</li> <li>HTTP\u4fee\u590d\u5de5\u5177\uff1a\u5b83\u53ef\u4ee5\u4fee\u6539/\u4fee\u590d/\u6dfb\u52a0/\u5220\u9664/\u91cd\u5199URL\u6216\u4efb\u4f55\u8bf7\u6c42\u6216\u54cd\u5e94\u6807\u5934\u3002\u8fd9\u6709\u52a9\u4e8e\u89e3\u51b3\u4e92\u64cd\u4f5c\u6027\u95ee\u9898\u5728\u590d\u6742\u7684\u73af\u5883\u4e2d</li> <li>\u57fa\u4e8e\u5185\u5bb9\u7684\u4ea4\u6362\u673a\uff1a\u5b83\u53ef\u4ee5\u8003\u8651\u8bf7\u6c42\u4e2d\u7684\u4efb\u4f55\u5143\u7d20\u51b3\u5b9a\u5c06\u8bf7\u6c42\u6216\u8fde\u63a5\u4f20\u9012\u7ed9\u54ea\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\u6709\u53ef\u80fd\u901a\u8fc7\u540c\u4e00\u7aef\u53e3\u5904\u7406\u591a\u4e2a\u534f\u8bae\uff08\u4f8b\u5982HTTP\uff0cHTTPS\uff0cSSH\uff09</li> <li>\u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u53ef\u4ee5\u5e73\u8861TCP\u8fde\u63a5\u548cHTTP\u8981\u6c42\u3002\u5728TCP\u6a21\u5f0f\u4e0b\uff0c\u6574\u4f53\u91c7\u7528\u8d1f\u8f7d\u5e73\u8861\u51b3\u7b56\u8fde\u63a5\u3002\u5728HTTP\u6a21\u5f0f\u4e0b\uff0c\u6839\u636e\u8bf7\u6c42\u505a\u51fa\u51b3\u5b9a</li> <li>\u4ea4\u901a\u76d1\u7ba1\u673a\u6784\uff1a\u5b83\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u70b9\u5e94\u7528\u4e00\u4e9b\u901f\u7387\u9650\u5236\uff0c\u4fdd\u62a4\u670d\u52a1\u5668\u514d\u53d7\u8fc7\u8f7d\uff0c\u6839\u636e\u9700\u8981\u8c03\u6574\u6d41\u91cf\u4f18\u5148\u7ea7\u5185\u5bb9\uff0c\u751a\u81f3\u5c06\u8fd9\u4e9b\u4fe1\u606f\u4f20\u9012\u7ed9\u4e0b\u5c42\u548c\u5916\u5c42\u7f51\u7edc\u7ec4\u4ef6\u901a\u8fc7\u6807\u8bb0\u6570\u636e\u5305</li> <li>\u9488\u5bf9DDoS\u548c\u670d\u52a1\u6ee5\u7528\u7684\u4fdd\u62a4\uff1a\u5b83\u53ef\u4ee5\u4fdd\u6301\u5e7f\u6cdb\u7684\u6570\u91cf\u6bcf\u4e2aIP\u5730\u5740\uff0cURL\uff0ccookie\u7b49\u7684\u7edf\u8ba1\u4fe1\u606f\uff0c\u5e76\u68c0\u6d4b\u4f55\u65f6\u6ee5\u7528\u53d1\u751f\uff0c\u7136\u540e\u91c7\u53d6\u884c\u52a8\uff08\u51cf\u6162\u8fdd\u6cd5\u8005\uff0c\u963b\u6b62\u4ed6\u4eec\uff0c\u53d1\u9001\u4ed6\u4eec\u8fc7\u65f6\u7684\u5185\u5bb9\u7b49\uff09</li> <li>\u7f51\u7edc\u6545\u969c\u6392\u9664\u7684\u89c2\u5bdf\u70b9\uff1a\u7531\u4e8e\u7cbe\u5ea6\u5728\u65e5\u5fd7\u4e2d\u62a5\u544a\u7684\u4fe1\u606f\uff0c\u901a\u5e38\u7528\u4e8e\u7f29\u5c0f\u4e00\u4e9b\u4e0e\u7f51\u7edc\u6709\u5173\u7684\u95ee\u9898</li> <li>HTTP\u538b\u7f29\u5378\u8f7d\u7a0b\u5e8f\uff1a\u5b83\u53ef\u4ee5\u538b\u7f29\u4e0d\u662f\u7531\u670d\u52a1\u5668\u538b\u7f29\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u51cf\u5c11\u5ba2\u6237\u7aef\u7684\u9875\u9762\u52a0\u8f7d\u65f6\u95f4\u8fde\u63a5\u4e0d\u826f\u6216\u4f7f\u7528\u9ad8\u5ef6\u8fdf\u7684\u79fb\u52a8\u7f51\u7edc</li> </ul> <p>HAProxy\u4e0d\u662f\uff1a</p> <ul> <li>\u4e00\u4e2a\u663e\u5f0f\u7684HTTP\u4ee3\u7406\uff0c\u5373\u6d4f\u89c8\u5668\u7528\u6765\u8bbf\u95ee\u7684\u4ee3\u7406\u4e92\u8054\u7f51\u3002\u6709\u4e13\u95e8\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u4f18\u79c0\u5f00\u6e90\u8f6f\u4ef6\uff0c\u6bd4\u5982Squid\u3002\u4f46\u662fHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u8fd9\u6837\u7684\u4ee3\u7406\u524d\u9762\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027</li> <li>\u7f13\u5b58\u4ee3\u7406\uff1a\u5b83\u5c06\u6309\u539f\u6837\u8fd4\u56de\u4ece\u670d\u52a1\u5668\u6536\u5230\u7684\u5185\u5bb9\u5e76\u4e14\u4e0d\u4f1a\u5e72\u6270\u4efb\u4f55\u7f13\u5b58\u7b56\u7565\u3002\u6709\u4f18\u79c0\u7528\u4e8e\u6b64\u4efb\u52a1\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Varnish\u3002\u53ef\u4ee5\u5b89\u88c5HAProxy\u5728\u8fd9\u6837\u7684\u7f13\u5b58\u524d\u9762\u63d0\u4f9bSSL\u5378\u8f7d\uff0c\u5e76\u901a\u8fc7\u53ef\u4f38\u7f29\u6027\u667a\u80fd\u8d1f\u8f7d\u5e73\u8861</li> <li>\u6570\u636e\u6e05\u7406\u5668\uff1a\u5b83\u4e0d\u4f1a\u4fee\u6539\u8bf7\u6c42\u4f53\u548c\u54cd\u5e94\u4f53</li> <li>\u4e00\u4e2aWeb\u670d\u52a1\u5668\uff1a\u5728\u542f\u52a8\u671f\u95f4\uff0c\u5b83\u5c06\u81ea\u5df1\u9694\u79bb\u5728\u4e00\u4e2achroot jail\u548c\u5220\u9664\u5176\u6743\u9650\uff0c\u4ee5\u4fbf\u5b83\u4e0d\u4f1a\u6267\u884c\u4efb\u4f55\u5355\u4e2a\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\u4e00\u65e6\u5f00\u59cb\u3002\u56e0\u6b64\uff0c\u5b83\u65e0\u6cd5\u8f6c\u53d8\u4e3aWeb\u670d\u52a1\u5668\u3002\u90a3\u91cc\u662f\u975e\u5e38\u597d\u7684\u5f00\u6e90\u8f6f\u4ef6\uff0c\u5982Apache\u6216Nginx\uff0c\u4ee5\u53caHAProxy\u53ef\u4ee5\u5b89\u88c5\u5728\u5b83\u4eec\u524d\u9762\uff0c\u4ee5\u63d0\u4f9b\u8d1f\u8f7d\u5e73\u8861\u548c\u9ad8\u53ef\u7528\u6027</li> <li>\u57fa\u4e8e\u6570\u636e\u5305\u7684\u8d1f\u8f7d\u5747\u8861\u5668\uff1a\u5b83\u4e0d\u4f1a\u770b\u5230IP\u6570\u636e\u5305\uff0c\u4e5f\u4e0d\u4f1a\u770b\u5230UDP\u6570\u636e\u62a5\uff0c\u4e0d\u4f1a\u6267\u884cNAT\u751a\u81f3\u66f4\u5c11\u7684DSR\u3002\u8fd9\u4e9b\u662f\u8f83\u4f4e\u5c42\u7684\u4efb\u52a1\u3002\u4e00\u4e9b\u57fa\u4e8e\u5185\u6838\u7684\u7ec4\u4ef6\uff0c\u5982IPVS\uff08Linux\u865a\u62df\u670d\u52a1\u5668\uff09\u5df2\u7ecf\u505a\u5230\u4e86\u975e\u5e38\u597d\uff0c\u4e0eHAProxy\u5b8c\u7f8e\u642d\u914d</li> </ul> <p>HAProxy\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\uff0c\u4e8b\u4ef6\u9a71\u52a8\uff0c\u975e\u963b\u585e\u5f15\u64ce\u3002\u53ef\u4ee5\u4f7fHAProxy\u5728\u591a\u4e2a\u8fdb\u7a0b\u4e0a\u8fd0\u884c\uff0c\u4f46\u5b83\u968f\u4e4b\u800c\u6765 \u4e00\u4e9b\u9650\u5236\u3002\u901a\u5e38\uff0c\u5b83\u5728HTTP\u5173\u95ed\u6216TCP\u6a21\u5f0f\u4e0b\u6ca1\u6709\u610f\u4e49\uff0c\u56e0\u4e3a\u5185\u6838\u7aef\u4e0d\u80fd\u5f88\u597d\u5730\u6269\u5c55\u67d0\u4e9b\u64cd\u4f5c\uff0c\u4f8b\u5982connect()\uff0c\u5b83\u53ef\u4ee5\u5f88\u597d\u5730\u6269\u5c55HTTP\u4fdd\u6301\u6d3b\u52a8\u6a21\u5f0f\u4f46\u6027\u80fd\u53ef\u4ee5\u901a\u8fc7\u5355\u4e00\u6d41\u7a0b\u5b9e\u73b0\u7684\u5de5\u4f5c\u901a\u5e38\u4f18\u4e8e\u5e38\u89c1\u9700\u6c42\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\u4f46\u662f\uff0c\u5f53\u7528\u4f5cSSL\u65f6\uff0c\u5b83\u786e\u5b9e\u6709\u610f\u4e49offloader\uff0c\u5728\u591a\u8fdb\u7a0b\u6a21\u5f0f\u4e0b\u5f88\u597d\u5730\u652f\u6301\u6b64\u529f\u80fd</p>"},{"location":"lbha/Haproxy/#_1","title":"\u57fa\u672c\u529f\u80fd\uff1a\u4ee3\u7406","text":"<ul> <li>\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5e72\u51c0\u7684\u8fde\u63a5\uff0c\u9632\u6b62\u5ba2\u6237\u7aef\u8fde\u63a5\u7f3a\u9677\u548c\u653b\u51fb</li> <li>\u76d1\u542c\u591a\u4e2aIP\u5730\u5740\u6216\u7aef\u53e3\uff0c\u751a\u81f3\u7aef\u53e3\u8303\u56f4</li> <li>Transparent accept\uff1a\u62e6\u622a\u4efb\u610fIP\u5730\u5740\u6d41\u91cf\uff0c\u5c3d\u7ba1\u4e0d\u5c5e\u4e8e\u672c\u5730\u7cfb\u7edf</li> <li>\u670d\u52a1\u5668\u7aef\u53e3\u4e0d\u9700\u8981\u548c\u4fa6\u542c\u7aef\u53e3\u76f8\u5173\uff0c\u751a\u81f3\u662f\u7531\u56fa\u5b9a\u504f\u79fb\u91cf\u8f6c\u6362(\u5bf9\u8303\u56f4\u6709\u7528)</li> <li>\u4e3a\u591a\u7ad9\u70b9LB\u4e2d\u7684\u670d\u52a1\u5668\u63d0\u4f9b\u53ef\u9760\u7684\u8fd4\u56deIP\u5730\u5740</li> <li>\u7531\u4e8e\u7f13\u51b2\u533a\u548c\u53ef\u80fd\u7684\u77ed\u6682\u8fde\u63a5\uff0c\u4e0b\u7ebf\u670d\u52a1\u5668\u6765\u51cf\u5c11\u5e76\u53d1\u8fde\u63a5\u6570\u548c\u5185\u5b58\u5360\u7528\u91cf</li> <li>\u4f18\u5316TCP\u5806\u6808(\u5982:SACK)\u62e5\u585e\u63a7\u5236\u548c\u51cf\u5c11RTT\u5f71\u54cd</li> <li>\u652f\u6301\u53cc\u65b9\u4e0d\u540c\u7684\u534f\u8bae\u7cfb\u5217(IPv4,IPv6,Unix)</li> <li>\u5f3a\u5236\u8d85\u65f6\uff1a\u5728\u8fde\u63a5\u7684\u4e0d\u540c\u9636\u6bb5\u652f\u6301\u591a\u7ea7\u522b\u7684\u8d85\u65f6\u8fde\u63a5\uff0c\u4ee5\u4fbf\u4e8e\u5df2\u6b7b\u4ea1\u7684\u5ba2\u6237\u7aef\u3001\u670d\u52a1\u5668\u6216\u653b\u51fb\u8005\u5360\u7528\u8d44\u6e90\u65f6\u95f4\u592a\u957f</li> <li>\u534f\u8bae\u9a8c\u8bc1\uff1a\u68c0\u67e5HTTP\u3001SSL\u3001Playload\u5e76\u62d2\u7edd\u65e0\u6548\u534f\u8bae\u6210\u5206\uff0c\u9664\u975e\u6307\u5b9aaccept\u4ed6\u4eec</li> <li>\u5f3a\u5236\u7b56\u7565\uff1a\u786e\u4fdd\u53ea\u8f6c\u53d1\u5141\u8bb8\u7684\u5185\u5bb9</li> <li>\u4f20\u5165\u548c\u4f20\u51fa\u8fde\u63a5\u90fd\u53ef\u80fd\u9650\u4e8e\u67d0\u4e9b\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\uff08\u4ec5\u9650Linux\uff09\uff0c\u53ef\u4ee5\u8f7b\u677e\u6784\u5efa\u8de8\u5bb9\u5668\uff0c\u591a\u79df\u6237\u8d1f\u8f7d\u5747\u8861\u5668;</li> <li>Proxy\u534f\u8bae\u5c06\u5ba2\u6237\u7aefIP\u5730\u5740\u5448\u73b0\u7ed9\u670d\u52a1\u5668\u5c3d\u7ba1\u975eHTTP\u6d41\u91cf\uff0c\u8fd9\u662fhaproxy\u6269\u5c55\uff0c\u76ee\u524d\u7b2c\u4e09\u65b9\u4ea7\u54c1\u6709\uff1a</li> <li>client : haproxy, hitch, stunnel, exaproxy, ELB, squid</li> <li>server : haproxy, hitch, postfix, exim, nginx, squid, node.js, varnish</li> </ul>"},{"location":"lbha/Haproxy/#ssl","title":"\u57fa\u672c\u529f\u80fd\uff1aSSL","text":"<ul> <li>\u57fa\u4e8eSNI\u7684\u4e13\u6ce8\u4e8e\u6027\u80fd\u6ca1\u6709\u7ad9\u70b9\u9650\u5236\u7684\u591a\u4e3b\u673a</li> <li>\u652f\u6301\u7528\u6b63\u5219\u901a\u914d\u7b26\u5339\u914d\u8bc1\u4e66</li> <li>\u5177\u6709\u53ef\u914d\u7f6e\u7b56\u7565\u7684\u57fa\u4e8e\u8bc1\u4e66\u7684\u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1\u672a\u80fd\u51fa\u793a\u6709\u6548\u8bc1\u4e66\uff0c\u5c06\u5141\u8bb8\u4e0d\u540c\u7684\u670d\u52a1\u5668\u91cd\u65b0\u751f\u6210\u5ba2\u6237\u7aef\u8bc1\u4e66</li> <li>\u540e\u7aef\u670d\u52a1\u5668\u8eab\u4efd\u9a8c\u8bc1\u786e\u4fdd\u540e\u7aef\u670d\u52a1\u5668\u4e0d\u662f\u4e2d\u95f4\u4eba</li> <li>\u4f7f\u7528\u540e\u7aef\u670d\u52a1\u5668\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u53ef\u4ee5\u8ba9\u540e\u7aef\u670d\u52a1\u5668\u77e5\u9053\u5b83\u8fde\u63a5\u7684\u662f\u9884\u671f\u7684haproxy\u8282\u70b9</li> <li>TLS NPN\u548cALPN\u6269\u5c55\u53ef\u4ee5\u53ef\u9760\u7684\u5378\u8f7dSPDY/HTTP2\u8fde\u63a5\u5e76\u4ee5\u660e\u6587\u5f62\u5f0f\u4f20\u9012\u7ed9\u540e\u7aef\u670d\u52a1\u5668</li> <li>\u5f53\u5ba2\u6237\u7aef\u53d1\u9001\u4ee5\u8bc1\u4e66\u9a8c\u8bc1\u7684\u8bf7\u6c42\u65f6\uff0cOCSP\u88c5\u8ba2\u901a\u8fc7\u5185\u8054\u6765\u8fdb\u4e00\u6b65\u51cf\u5c11\u9996\u9875\u52a0\u8f7d\u65f6\u95f4</li> <li>\u52a8\u6001\u8bb0\u5f55\u5927\u5c0f\u8c03\u6574\u63d0\u4f9b\u9ad8\u6027\u80fd\u4f4e\u5ef6\u8fdf\u53ca\u901a\u8fc7\u8ba9\u6d4f\u89c8\u5668\u83b7\u53d6\u65b0object\u6765\u663e\u8457\u51cf\u5c11\u9875\u9762\u52a0\u8f7d</li> <li>\u6c38\u4e45\u8bbf\u95ee\u6240\u6709\u76f8\u5173\u7684SSL/TLS\u5c42\u4fe1\u606f\u4ee5\u8fdb\u884c\u65e5\u5fd7\u8bb0\u5f55\u3001\u8bbf\u95ee\u63a7\u5236\u3001\u62a5\u544a\u7b49\u3002\u8fd9\u4e9b\u5143\u7d20\u53ef\u4ee5\u5d4c\u5165\u5230HTTP Header\u751a\u81f3\u4f5c\u4e3aProxy\u534f\u8bae\u6269\u5c55</li> <li>\u5373\u4f7f\u5728\u6613\u53d7\u653b\u51fb\u7684SSL\u5e93\u4e2d\u4e5f\u80fd\u68c0\u6d4b\uff0c\u8bb0\u5f55\u548c\u963b\u6b62\u67d0\u4e9b\u5df2\u77e5\u653b\u51fb\uff0c\u4f8b\u5982\u5f71\u54cdOpenSSL\u67d0\u4e9b\u7248\u672c\u7684Heartbleed\u653b\u51fb</li> <li>\u652f\u6301\u65e0\u72b6\u6001\u4f1a\u8bdd\u6062\u590d\uff0c\u53ef\u4ee5\u4eceCLI\u66f4\u65b0TLS\u51ed\u8bc1</li> </ul>"},{"location":"lbha/Haproxy/#_2","title":"\u57fa\u672c\u529f\u80fd\uff1a\u76d1\u63a7","text":"<ul> <li>\u5229\u7528per-server\u53c2\u6570\u6301\u7eed\u76d1\u63a7\u670d\u52a1\u5668\u72b6\u6001\uff0c\u8fd9\u4e2a\u786e\u4fdd\u670d\u52a1\u5668\u7684\u8def\u5f84\u662f\u6b63\u5e38\u6d41\u91cf</li> <li>\u72b6\u6001\u68c0\u67e5\u652f\u6301up\u6216down\u6ede\u540e\u6309\u987a\u5e8f\u5207\u6362\uff0c\u9632\u6b62\u72b6\u6001\u9519\u4e71</li> <li>\u53ef\u4ee5\u5c06\u68c0\u67e5\u53d1\u9001\u5230\u4e0d\u540c\u7684\u5730\u5740/\u7aef\u53e3/\u534f\u8bae:\u8fd9\u6837\u5f88\u5bb9\u6613\u88ab\u8ba4\u4e3a\u4ee3\u8868\u591a\u4e2a\u7684\u5355\u4e2a\u670d\u52a1\uff0c\u5982\uff1aHTTP+HTTPS\u670d\u52a1\u5668\u7684HTTPS\u7aef\u53e3</li> <li>\u670d\u52a1\u5668\u53ef\u4ee5\u8ddf\u8e2a\u5176\u4ed6\u670d\u52a1\u5668\u5e76\u540c\u65f6\u5173\u95ed\uff0c\u53ef\u4ee5\u786e\u4fdd\u6258\u7ba1\u591a\u4e2a\u670d\u52a1\u7684\u670d\u52a1\u5668\u4ee5\u539f\u5b50\u65b9\u5f0f\u5931\u8d25\u800c\u6ca1\u6709\u4e00\u4e2a\u4f1a\u53d1\u9001\u5230\u5931\u8d25\u7684\u670d\u52a1\u5668</li> <li>\u53ef\u4ee5\u5728\u670d\u52a1\u5668\u90e8\u7f72\u4ee3\u7406\u6765\u76d1\u63a7\u8d1f\u8f7d\u548c\u8fd0\u884c\u72b6\u6001</li> <li>\u63d0\u4f9b\u5404\u79cd\u68c0\u67e5\u65b9\u6cd5\uff1aTCP\u8fde\u63a5\u3001HTTP\u8bf7\u6c42\u3001SMTP\u95ee\u5019\u3001SSL hello\uff0cLDAP\u3001SQL\u3001Redis\u3001send/expect\u811a\u672c\uff0c\u5168\u90e8\u5e26\u6216\u4e0d\u5e26ssl\u8fde\u63a5</li> <li>\u72b6\u6001\u66f4\u6539\u5c06\u5728\u65e5\u5fd7\u548c\u7edf\u8ba1\u4fe1\u606f\u9875\u9762\u901a\u77e5\u5931\u8d25\u539f\u56e0\uff0c\u4e5f\u53ef\u53d1\u9001\u5230\u914d\u7f6e\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740</li> <li>\u670d\u52a1\u5668\u72b6\u6001\u4e5f\u4f1a\u5728\u7edf\u8ba1\u4fe1\u606f\u754c\u9762\u663e\u793a\uff0c\u5e76\u53ef\u7528\u4e8e\u6267\u884c\u8def\u7531\u51b3\u7b56\uff0c\u4ee5\u4fbf\u4e8e\u5c06\u6d41\u91cf\u53d1\u9001\u5230\u4e0d\u540c\u7684farms</li> <li>haproxy\u53ef\u4ee5\u4f7f\u7528\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u8bf7\u6c42\u5c06\u4fe1\u606f\u4f20\u9012\u7ed9\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u670d\u52a1\u5668name\u3001weight\u3001\u5176\u4ed6\u670d\u52a1\u5668\u5728farm\u7684number(\u6570\u91cf)\u7b49\u3002\u6240\u4ee5\u670d\u52a1\u5668\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u6765\u8c03\u6574\u54cd\u5e94\u548c\u51b3\u7b56(\u4f8b\u5982\u63a8\u8fdf\u5907\u4efd\u4fdd\u6301\u66f4\u591a\u7684\u53ef\u7528CPU)</li> <li>\u670d\u52a1\u5668\u53ef\u4ee5\u7528\u5065\u5eb7\u68c0\u67e5\u62a5\u544a\u66f4\u8be6\u7ec6\u7684\u72b6\u6001\uff0c\u4e0d\u4ec5\u4ec5\u662fon\u6216off</li> <li>\u670d\u52a1\u5668\u81ea\u8eab\u53ef\u4ee5\u62a5\u544a\u72b6\u6001\u7ed9\u5176\u4ed6\u7ec4\u4ef6\uff0c\u5982\u8def\u7531\u5668\u6216\u5176\u4ed6\u8d1f\u8f7d\u5747\u8861\u5668\uff0c\u5141\u8bb8\u6784\u5efa\u975e\u5e38\u5b8c\u6574\u7684\u591a\u8def\u5f84\u548c\u591a\u5c42\u57fa\u7840\u8bbe\u65bd</li> </ul>"},{"location":"lbha/Haproxy/#_3","title":"\u57fa\u672c\u529f\u80fd\uff1a\u9ad8\u53ef\u7528","text":"<ul> <li>\u4ec5\u4f7f\u7528\u6709\u6548\u7684\u670d\u52a1\u5668\uff0c\u5176\u4ed6\u81ea\u52a8\u9a71\u9010\u51fa\u8d1f\u8f7d\u5747\u8861\u519c\u573a</li> <li>\u652f\u6301\u6b63\u5e38\u5173\u95ed\uff0c\u4ee5\u4fbf\u4e8e\u4e0d\u5f71\u54cd\u6709\u4efb\u4f55\u5173\u7cfb\u7684\u519c\u573a</li> <li>\u5f53\u6d3b\u52a8\u670d\u52a1\u5668\u5173\u95ed\u65f6\uff0c\u5c06\u81ea\u52a8\u4f7f\u7528\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4fbf\u4e8e\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u4e0d\u4e22\u5931\u4f1a\u8bdd\uff0c\u8fd9\u4e5f\u5141\u8bb8\u6784\u5efa\u591a\u6761\u8def\u5f84\u5230\u8fbe\u540c\u4e00\u4e2a\u670d\u52a1\u5668(\u4f8b\u5982\u591a\u4e2a\u63a5\u53e3)</li> <li>\u5f53\u4e00\u4e2a\u519c\u573a\u670d\u52a1\u5668\u592a\u591a\u65f6\uff0c\u80fd\u8fd4\u56de\u670d\u52a1\u5668\u5931\u8d25\u72b6\u6001\uff0c\u8fd9\u548c\u76d1\u63a7\u529f\u80fd\u7ed3\u5408\u4f7f\u7528\uff0c\u8ba9\u5176\u4e3a\u4e0a\u6e38\u7ec4\u4ef6\u9009\u62e9\u7ed9\u5b9a\u670d\u52a1\u7684\u4e0d\u540cLB\u8282\u70b9</li> <li>\u65e0\u72b6\u6001\u8bbe\u8ba1\u4f7f\u6784\u5efa\u96c6\u7fa4\u53d8\u5f97\u5bb9\u6613\uff0chaproxy\u53ef\u4ee5\u6700\u597d\u7684\u786e\u4fdd\u670d\u52a1\u8fde\u7eed\u6027\u800c\u65e0\u9700\u5b58\u50a8\u5728\u53d1\u751f\u6545\u969c\u65f6\u53ef\u80fd\u4e22\u5931\u7684\u4fe1\u606f</li> <li>\u4e0e\u6807\u51c6\u7684VRRP\u5b88\u62a4\u8fdb\u7a0b\u826f\u597d\u7684\u96c6\u6210\uff0chaproxy\u53ef\u4ee5\u8f7b\u677e\u7684\u5bf9\u72b6\u6001\u8fde\u63a5\u4fdd\u6301\u5e76\u4e8e\u6d6e\u52a8\u865a\u62dfIP\u5f88\u597d\u7684\u5bf9\u5e94</li> </ul>"},{"location":"lbha/Haproxy/#_4","title":"\u57fa\u672c\u529f\u80fd\uff1a\u8d1f\u8f7d\u5747\u8861","text":"<ul> <li>\u652f\u6301\u4e0d\u5c11\u4e8e9\u949f\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0c\u5176\u4e2d\u4e00\u4e9b\u9002\u7528\u4e8e\u8f93\u5165\u6570\u636e\u4ee5\u63d0\u4f9b\u65e0\u9650\u7684\u53ef\u80fd\u6027\u5217\u8868\u3002\u6700\u666e\u904d\u7684\u662f</li> <li>round-robin (\u5bf9\u4e8e\u77ed\u8fde\u63a5\uff0c\u4f9d\u6b21\u9009\u62e9\u6bcf\u4e2a\u670d\u52a1\u5668)</li> <li>leastconn (\u5bf9\u4e8e\u957f\u8fde\u63a5\u9009\u62e9\u6700\u8fd1\u5f88\u5c11\u4f7f\u7528\u3001\u6700\u4f4e\u8fde\u63a5\u6570\u7684\u670d\u52a1\u5668)</li> <li>source (\u7528\u4e8eSSL farms\u6216\u7ec8\u7aef\u670d\u52a1\u5668farms)\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8e\u5ba2\u6237\u7aef\u6e90\u5730\u5740</li> <li>URI (\u7528\u4e8eHTTP\u7f13\u5b58\uff0c\u670d\u52a1\u5668\u76f4\u63a5\u4f9d\u8d56\u4e8eHTTP\u3000URI)</li> <li>HDR (\u670d\u52a1\u5668\u4f9d\u8d56\u4e8e\u7279\u5b9a\u7684HTTP hearder\u5b57\u6bb5\u7684\u5185\u5bb9)</li> <li>\u4ee5\u4e0a\u7b97\u6cd5\u90fd\u652f\u6301per-server\u6743\u91cd\uff0c\u4ee5\u4fbf\u9002\u5e94\u519c\u573a\u4e2d\u4e0d\u540c\u670d\u52a1\u5668\uff0c\u6216\u8005\u4f5c\u7528\u4e8e\u6d41\u91cf\u6bd4\u8f83\u5c0f\u7684\u7279\u5b9a\u670d\u52a1\u5668(debug,\u5728\u4e0b\u4e00\u4e2a\u8f6f\u4ef6\u7248\u672c)</li> <li>\u52a8\u6001\u6743\u91cd\u652f\u6301round-robin leastconn \u4e00\u81f4\u6027hashing\uff0c\u8fd9\u5141\u8bb8\u4eceCLI\u52a8\u6001\u4fee\u6539\u670d\u52a1\u5668\u6743\u91cd\u751a\u81f3\u662f\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7684\u4ee3\u7406</li> <li>\u53ea\u8981\u652f\u6301\u52a8\u6001\u6743\u91cd\uff0c\u5c31\u652f\u6301\u6162\u542f\u52a8\uff0c\u8fd9\u5141\u8bb8\u670d\u52a1\u5668\u9010\u6b65\u83b7\u53d6\u6d41\u91cf\uff0c\u8fd9\u662f\u4e2a\u91cd\u8981\u7279\u5f81\uff0c\u5bf9\u4e8e\u9700\u8981\u5728\u8fd0\u884c\u65f6\u7f16\u8bd1\u7c7b\u7684\u8106\u5f31\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5668\u4ee5\u53ca\u9700\u8981\u5728\u5b8c\u5168\u8fd0\u884c\u4e4b\u524d\u586b\u6ee1\u51b7\u7f13\u5b58</li> <li>hashing(\u6563\u5217)\u53ef\u4ee5\u7528\u4e8e\u5404\u79cd\u5143\u7d20\uff0c\u5982\u5ba2\u6237\u7aef\u6e90\u5730\u5740\uff0cURL\u7ec4\u4ef6\uff0c\u67e5\u8be2\u5b57\u7b26\u4e32\u5143\u7d20\uff0cheader\u5b57\u7b26\u4e32\u503c\uff0cPOST\u53c2\u6570\uff0cRDP cookie</li> <li>\u4e00\u81f4\u6027\u6563\u5217\u53ef\u4ee5\u4fdd\u62a4\u670d\u52a1\u5668farm\u514d\u53d7\u5927\u91cf\u91cd\u65b0\u5206\u53d1\u7684\u5f71\u54cd\uff0c\u5728\u670d\u52a1\u5668farm\u949f\u6dfb\u52a0\u6216\u5220\u9664\u670d\u52a1\u5668\uff0c\u8fd9\u5728\u5927\u578b\u7f13\u5b58farm\u4e2d\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u5141\u8bb8\u6162\u542f\u52a8\u7528\u4e8e\u8865\u5145cold caches</li> <li>\u8bb8\u591a\u5185\u90e8\u6307\u6807\uff0c\u5982\u6bcf\u53f0\u670d\u52a1\u5668\u8fde\u63a5\u6570\u3001\u6bcf\u4e2a\u540e\u7aef\u53ef\u7528\u8fde\u63a5\u63d2\u69fd\u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u6784\u5efa\u975e\u5e38\u5148\u8fdb\u7684\u8d1f\u8f7d\u5e73\u8861\u7b56\u7565</li> </ul>"},{"location":"lbha/Haproxy/#stickiness","title":"\u57fa\u672c\u7279\u5f81\uff1a\u7c98\u6027(Stickiness)","text":"<p>haproxy\u63d0\u4f9b\u76f8\u5f53\u5168\u9762\u7684\u53ef\u80fd\u6027\u4fdd\u6301\u8bbf\u5ba2\u8bbf\u95ee\u76f8\u540c\u670d\u52a1\u5668\u751a\u81f3\u8de8\u8d8a\u5404\u79cd\u4e8b\u4ef6\uff0c\u5982\u670d\u52a1\u5668\u6dfb\u52a0/\u5220\u9664\uff0cdown/up\u5faa\u73af\uff0c\u5e76\u8bbe\u8ba1\u65b9\u6cd5\u62b5\u6297\u4e4b\u95f4\u7684\u8ddd\u79bb\u591a\u4e2a\u8d1f\u8f7d\u5747\u8861\u8282\u70b9\uff0c\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u590d\u5236</p> <ul> <li>\u7c98\u6027\u4fe1\u606f\u53ef\u4ee5\u5355\u72ec\u5339\u914d\u548c\u5b66\u4e60\u4e0d\u540c\u7684\u5730\u65b9\uff0c\u5982\uff1a\u53ef\u4ee5\u5339\u914dJSESSIONID cookie \u5728cookie\u548cURL\u90fd\u6709\uff0c\u6700\u591a\u540c\u4e00\u65f6\u95f4\u53ef\u5b66\u4e608\u4e2a\u5e76\u884c\u6e90\uff0c\u6bcf\u4e2a\u53ef\u80fd\u6307\u5411\u4e0d\u540c\u7684stick-table</li> <li>\u4ee5\u591a\u4e3b\u65b9\u5f0f\u5728\u6240\u6709\u8282\u70b9\u590d\u5236stick-tables</li> <li>\u5e38\u7528\u7684\u5143\u7d20\uff0c\u5982SSL-ID\u6216RDP cookie(\u7528\u4e8eTSE farm)\u76f4\u63a5\u6613\u4e8e\u64cd\u4f5c</li> <li>\u6240\u6709sticking rules\u53ef\u7531ACL\u52a8\u6001\u8c03\u8282</li> <li>\u53ef\u4ee5\u51b3\u5b9a\u4e0dstick\u67d0\u4e9b\u670d\u52a1\u5668\uff0c\u4f8b\u5982\u5907\u4efd\u670d\u52a1\u5668\uff0c\u4ee5\u4fbf\u4e8e\u5f53\u89c4\u5b9a\u7684\u670d\u52a1\u5668\u8fd4\u56de\u65f6\uff0c\u53ef\u4ee5\u81ea\u52a8\u8fdb\u884cload back\uff0c\u901a\u5e38\u7528\u4e8e\u591a\u8def\u5f84\u73af\u5883</li> <li>\u5728</li> </ul>"},{"location":"lbha/Haproxy/#configuration","title":"Configuration","text":"<p>\u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6240\u6709\u914d\u7f6e\u5173\u952e\u5b57\u548c\u4ed6\u4eec\u7684\u9009\u62e9\u3002\u5b83\u5728\u9700\u8981\u66f4\u6539\u914d\u7f6e\u65f6\u4f7f\u7528</p>"},{"location":"lbha/Haproxy/#http","title":"\u5173\u4e8eHTTP\u7684\u5feb\u901f\u63d0\u9192","text":"<p>\u5f53HAproxy\u5728HTTP\u6a21\u5f0f\u4e0b\u8fd0\u884c\u65f6\uff0c\u8bf7\u6c42\u548c\u76f8\u5e94\u90fd\u662f\u5b8c\u5168\u5206\u6790\u548c\u7d22\u5f15\uff0c\u56e0\u6b64\u51e0\u4e4e\u5728contents\u7684\u4efb\u4f55\u5185\u5bb9\u90fd\u53ef\u4ee5\u5efa\u7acb\u5339\u914d\u3002\u4e86\u89e3http\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u5f62\u6210\u7684\u65b9\u5f0f\u975e\u5e38\u91cd\u8981\uff0c\u53cahaproxy\u5982\u4f55\u5206\u89e3\u5b83\u4eec\uff0c\u7136\u540e\u5c31\u4f1a\u53d8\u5f97\u66f4\u5bb9\u6613\u7f16\u5199\u6b63\u786e\u7684\u89c4\u5219\u548c\u8c03\u8bd5\u73b0\u6709\u914d\u7f6e</p> <p>http\u4e8b\u52a1\u6a21\u578b\uff1ahttp\u534f\u8bae\u662f\u4e8b\u52a1\u9a71\u52a8\u7684\uff0c\u610f\u5473\u7740\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u9886\u5148\u4e00\u4e2a\u56de\u5e94</p> <p>HAProxy\u652f\u63015\u79cd\u8fde\u63a5\u6a21\u5f0f\uff1a</p> <ul> <li>\u4fdd\u6301\u6d3b\u8dc3\uff1a\u5904\u7406\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\uff08\u9ed8\u8ba4\uff09</li> <li>\u96a7\u9053\uff1a\u53ea\u5904\u7406\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u548c\u54cd\u5e94\uff0c\u5176\u4ed6\u4e00\u5207\u90fd\u6ca1\u6709\u5206\u6790\u8f6c\u53d1</li> <li>\u88ab\u52a8\u5173\u95ed\uff1a\u5728\u4e24\u4e2a\u65b9\u5411\u4e0a\u6dfb\u52a0\u201c\u8fde\u63a5\uff1a\u5173\u95ed\u201d\u7684\u96a7\u9053</li> <li>\u670d\u52a1\u5668\u5173\u95ed\uff1a\u54cd\u5e94\u540e\u5173\u95ed\u9762\u5411\u670d\u52a1\u5668\u7684\u8fde\u63a5</li> <li>\u5f3a\u5236\u5173\u95ed\uff1a\u54cd\u5e94\u7ed3\u675f\u540e\uff0c\u4e3b\u52a8\u5173\u95ed\u8fde\u63a5</li> </ul> <p>\u5bf9\u4e8eHTTP/2\uff0c\u8fde\u63a5\u6a21\u5f0f\u7c7b\u4f3c\u4e8e\u201c\u670d\u52a1\u5668\u5173\u95ed\u201d\u6a21\u5f0f\uff1a\u7ed9\u5b9a\u6240\u6709\u6d41\u7684\u72ec\u7acb\u6027\uff0c\u76ee\u524d\u6ca1\u6709\u5730\u65b9\u53ef\u4ee5\u6302\u7a7a\u95f2\u54cd\u5e94\u540e\u7684\u670d\u52a1\u5668\u8fde\u63a5\uff0c\u56e0\u6b64\u5728\u54cd\u5e94\u540e\u5173\u95ed\u3002HTTP/2\u4ec5\u652f\u6301\u4f20\u5165\u8fde\u63a5\uff0c\u800c\u4e0d\u652f\u6301\u8fde\u63a5\u670d\u52a1\u5668</p> Text Only<pre><code>HAProxy\u7684\u914d\u7f6e\u8fc7\u7a0b\u6d89\u53ca3\u4e2a\u4e3b\u8981\u53c2\u6570\u6765\u6e90\n1.\u6765\u81ea\u547d\u4ee4\u884c\u7684\u53c2\u6570\uff0c\u5b83\u59cb\u7ec8\u4f18\u5148\n2.\u201c\u5168\u5c40\u201d\u90e8\u5206\uff0c\u7528\u4e8e\u8bbe\u7f6e\u6d41\u7a0b\u8303\u56f4\u7684\u53c2\u6570\n3.\u4ee3\u7406\u90e8\u5206\u53ef\u4ee5\u91c7\u53d6\u201c\u9ed8\u8ba4\u201d\uff0c\u201c\u542c\u201d\u7684\u5f62\u5f0f\uff0c\u201c\u524d\u7aef\u201d\u548c\u201c\u540e\u7aef\u201d\n\n\u914d\u7f6e\u6587\u4ef6\u652f\u63013\u949f\u7c7b\u578b\uff1a\u8f6c\u4e49\u53cd\u659c\u6760\u3001\u53cc\u5f15\u53f7\u5f31\u5f15\u7528\u3001\u5355\u5f15\u53f7\u5f3a\u5f15\u7528\n\u5982\u679c\u5fc5\u987b\u5728\u5b57\u7b26\u4e32\u8f93\u5165\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u901a\u8fc7\u53cd\u659c\u6760\u8fdb\u884c\u8f6c\u4e49\n\n\\\u6807\u8bb0\u7a7a\u683c\u5e76\u5c06\u5176\u4e0e\u5206\u9694\u7b26\u533a\u5206\u5f00\u6765\n\\\uff03\u6807\u8bb0\u54c8\u5e0c\u5e76\u5c06\u5176\u4e0e\u6ce8\u91ca\u533a\u5206\u5f00\u6765\n\\\\\u4f7f\u7528\u53cd\u659c\u6760\n''\u4f7f\u7528\u5355\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f3a\u5f15\u7528\u533a\u5206\u5f00\u6765\n\"\"\u4f7f\u7528\u53cc\u5f15\u53f7\u5e76\u5c06\u5176\u4e0e\u5f31\u5f15\u7528\u533a\u5206\u5f00\u6765\n</code></pre>"},{"location":"lbha/Haproxy/#management","title":"Management","text":"<p>\u5982\u4f55\u542f\u52a8haproxy\uff0c\u5982\u4f55\u8fd0\u884c\u65f6\u7ba1\u7406\u5b83\uff0c\u5982\u4f55\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\u7ba1\u7406\u5b83\uff0c\u4ee5\u53ca\u5982\u4f55\u65e0\u7f1d\u5347\u7ea7</p> Text Only"},{"location":"lbha/Haproxy/#architecture","title":"Architecture","text":"<p>\u5982\u4f55\u6784\u5efa\u4e00\u4e2a\u6700\u597d\u7684\u8d1f\u8f7d\u5747\u8861\u57fa\u7840\u67b6\u6784\u4ee5\u53ca\u5982\u4f55\u4e0e\u7b2c\u4e09\u65b9\u4ea7\u54c1\u8fdb\u884c\u96c6\u6210</p> Text Only <p>\u662f\u7528\u4e8e\u5728\u6267\u884c\u52a0\u8f7d\u65f6\u9009\u62e9\u670d\u52a1\u5668\u7684\u7b97\u6cd5             \u5e73\u8861\u3002\u4ec5\u5728\u6ca1\u6709\u6301\u4e45\u6027\u4fe1\u606f\u65f6\u9002\u7528             \u53ef\u7528\uff0c\u6216\u5c06\u8fde\u63a5\u91cd\u65b0\u5206\u914d\u7ed9\u53e6\u4e00\u4e2a\u8fde\u63a5\u65f6             \u670d\u52a1\u5668\u3002\u53ef\u80fd\u662f\u4ee5\u4e0b\u4e4b\u4e00\uff1a <p>roundrobin\u6bcf\u4e2a\u670d\u52a1\u5668\u6839\u636e\u5176\u6743\u91cd\u4f9d\u6b21\u4f7f\u7528\u3002               \u5f53\u670d\u52a1\u5668\u7684               \u5904\u7406\u65f6\u95f4\u4fdd\u6301\u5e73\u5747\u5206\u914d\u3002\u8fd9\u4e2a\u7b97\u6cd5               \u662f\u52a8\u6001\u7684\uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u8c03\u6574\u670d\u52a1\u5668\u6743\u91cd               \u4f8b\u5982\uff0c\u6162\u901f\u542f\u52a8\u3002\u53d7\u9650\u4e8e               \u6bcf\u4e2a\u540e\u7aef\u6700\u591a\u53ef\u8bbe\u8ba14095\u4e2a\u6d3b\u52a8\u670d\u52a1\u5668\u3002\u8bf7\u6ce8\u610f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b               \u5927\u578b\u670d\u52a1\u5668\u573a\uff0c\u5f53\u670d\u52a1\u5668\u5173\u95ed\u540e\u53c8\u542f\u52a8\u65f6               \u5728\u5f88\u77ed\u7684\u65f6\u95f4\u5185\uff0c\u6709\u65f6\u53ef\u80fd\u9700\u8981\u6570\u767e               \u8981\u6c42\u5c06\u5176\u91cd\u65b0\u96c6\u6210\u5230\u670d\u52a1\u5668\u573a\u4e2d\u5e76\u5f00\u59cb               \u63a5\u6536\u6d41\u91cf\u3002\u8fd9\u5f88\u6b63\u5e38\uff0c\u5c3d\u7ba1\u975e\u5e38\u7f55\u89c1\u3002\u8fd9\u662f               \u5982\u679c\u60a8\u6709\u673a\u4f1a\u89c2\u5bdf\u5230\uff0c\u8bf7\u5728\u6b64\u5904\u6307\u793a               \u5b83\uff0c\u8fd9\u6837\u60a8\u5c31\u4e0d\u5fc5\u62c5\u5fc3\u3002</p> <p>static-rr\u6bcf\u4e2a\u670d\u52a1\u5668\u6839\u636e\u5176\u6743\u91cd\u4f9d\u6b21\u4f7f\u7528\u3002               \u8be5\u7b97\u6cd5\u4e0e\u8f6e\u8be2\u7b97\u6cd5\u76f8\u4f3c\uff0c\u9664\u4e86\u5b83\u662f               \u9759\u6001\uff0c\u8fd9\u610f\u5473\u7740\u66f4\u6539\u670d\u52a1\u5668\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6743\u91cd               \u98de\u4e0d\u4f1a\u6709\u4efb\u4f55\u6548\u679c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5b83\u6ca1\u6709\u8bbe\u8ba1               \u670d\u52a1\u5668\u6570\u91cf\u7684\u9650\u5236\uff0c\u4ee5\u53ca\u670d\u52a1\u5668\u4f55\u65f6\u8fd0\u884c               \u8d77\u6765\uff0c\u4e00\u65e6\u88ab\u7acb\u5373\u91cd\u65b0\u5f15\u5165\u519c\u573a               \u5b8c\u6574\u7684\u5730\u56fe\u5c06\u91cd\u65b0\u8ba1\u7b97\u3002\u5b83\u8fd8\u4f7f\u7528\u66f4\u5c11\u7684CPU               \u8fd0\u884c\uff08\u5927\u7ea6-1\uff05\uff09\u3002</p> <p>minimumconn\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\u6536\u5230               \u8054\u7cfb\u3002\u5faa\u73af\u5728\u670d\u52a1\u5668\u7ec4\u5185\u6267\u884c               \u5177\u6709\u76f8\u540c\u7684\u8d1f\u8f7d\uff0c\u4ee5\u786e\u4fdd\u5c06\u4f7f\u7528\u6240\u6709\u670d\u52a1\u5668\u3002\u7528               \u5982\u679c\u4f1a\u8bdd\u65f6\u95f4\u5f88\u957f\uff0c\u5efa\u8bae\u4f7f\u7528\u6b64\u7b97\u6cd5               \u9884\u671f\uff0c\u4f8b\u5982LDAP\uff0cSQL\uff0cTSE\u7b49...\uff0c\u4f46\u4e0d\u662f\u5f88\u597d               \u9002\u7528\u4e8e\u4f7f\u7528\u7b80\u77ed\u4f1a\u8bdd\uff08\u4f8b\u5982HTTP\uff09\u7684\u534f\u8bae\u3002\u8fd9               \u7b97\u6cd5\u662f\u52a8\u6001\u7684\uff0c\u8fd9\u610f\u5473\u7740\u670d\u52a1\u5668\u6743\u91cd\u53ef\u80fd\u662f               \u4f8b\u5982\uff0c\u9488\u5bf9\u6162\u901f\u542f\u52a8\u8fdb\u884c\u4e86\u52a8\u6001\u8c03\u6574\u3002\u5b83\u4f1a               \u9664\u4e86\u8003\u8651\u6392\u961f\u8fde\u63a5\u7684\u6570\u91cf\u5916               \u5efa\u7acb\u7684\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u6392\u961f\u3002</p> <p>\u9996\u5148\uff0c\u5177\u6709\u53ef\u7528\u8fde\u63a5\u63d2\u69fd\u7684\u7b2c\u4e00\u53f0\u670d\u52a1\u5668\u63a5\u6536               \u8054\u7cfb\u3002\u4ece\u6700\u4f4e\u7684\u6570\u5b57\u4e2d\u9009\u62e9\u670d\u52a1\u5668               \u6700\u9ad8\u7684\u6807\u8bc6\u7b26\uff08\u8bf7\u53c2\u9605\u670d\u52a1\u5668\u53c2\u6570\u201c id\u201c\uff09\uff0c \u54ea\u4e00\u4e2a               \u9ed8\u8ba4\u4e3a\u670d\u52a1\u5668\u5728\u670d\u52a1\u5668\u573a\u4e2d\u7684\u4f4d\u7f6e\u3002\u4e00\u65e6\u670d\u52a1\u5668               \u8fbe\u5230\u5176maxconn\u503c\uff0c\u5219\u4f7f\u7528\u4e0b\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u786e\u5b9e               \u5728\u4e0d\u8bbe\u7f6emaxconn\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u6b64\u7b97\u6cd5\u6ca1\u6709\u4efb\u4f55\u610f\u4e49\u3002               \u8be5\u7b97\u6cd5\u7684\u76ee\u7684\u662f\u59cb\u7ec8\u4f7f\u7528\u6700\u5c0f\u7684               \u670d\u52a1\u5668\u6570\u91cf\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5173\u95ed\u989d\u5916\u7684\u670d\u52a1\u5668               \u5728\u975e\u5bc6\u96c6\u65f6\u95f4\u3002\u8be5\u7b97\u6cd5\u5ffd\u7565\u670d\u52a1\u5668               \u91cd\u91cf\uff0c\u5e76\u4e3aRDP\u7b49\u957f\u671f\u4f1a\u8bae\u5e26\u6765\u66f4\u591a\u597d\u5904               \u6216IMAP\u800c\u4e0d\u662fHTTP\uff0c\u5c3d\u7ba1\u5b83\u5728\u8fd9\u91cc\u4e5f\u5f88\u6709\u7528\u3002\u5728               \u4e3a\u4e86\u6709\u6548\u5730\u4f7f\u7528\u6b64\u7b97\u6cd5\uff0c\u5efa\u8bae               \u4e91\u63a7\u5236\u5668\u5b9a\u671f\u68c0\u67e5\u670d\u52a1\u5668\u4f7f\u7528\u60c5\u51b5\u4ee5\u5c06               \u5b83\u4eec\u5728\u4e0d\u4f7f\u7528\u65f6\u5173\u95ed\uff0c\u5e76\u5b9a\u671f\u68c0\u67e5\u540e\u7aef\u961f\u5217\u4ee5               \u961f\u5217\u81a8\u80c0\u65f6\u6253\u5f00\u65b0\u670d\u52a1\u5668\u3002\u6216\u8005\uff0c               \u4f7f\u7528\u201c http-check send-state \u201d\u53ef\u80fd\u4f1a\u901a\u77e5\u670d\u52a1\u5668\u8d1f\u8f7d\u3002</p> <p>source\u5bf9\u6e90IP\u5730\u5740\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\u5e76\u9664\u4ee5\u603b\u6570               \u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u7684\u6743\u91cd\uff0c\u4ee5\u6307\u5b9a\u54ea\u4e2a\u670d\u52a1\u5668\u5c06               \u6536\u5230\u8bf7\u6c42\u3002\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u76f8\u540c\u7684\u5ba2\u6237\u7aefIP               \u53ea\u8981\u6ca1\u6709\uff0c\u5730\u5740\u5c06\u59cb\u7ec8\u5230\u8fbe\u540c\u4e00\u670d\u52a1\u5668               \u670d\u52a1\u5668\u5173\u95ed\u6216\u542f\u52a8\u3002\u5982\u679c\u54c8\u5e0c\u7ed3\u679c\u7531\u4e8e               \u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u6570\u91cf\u53d1\u751f\u53d8\u5316\uff0c\u8bb8\u591a\u5ba2\u6237\u7aef\u5c06               \u5b9a\u5411\u5230\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u3002\u8fd9\u4e2a\u7b97\u6cd5\u4e00\u822c               \u5728\u4e0d\u63d2\u5165Cookie\u7684TCP\u6a21\u5f0f\u4e0b\u4f7f\u7528\u3002\u4e5f\u53ef\u80fd               \u5728Internet\u4e0a\u4f7f\u7528\u4ee5\u63d0\u4f9b\u6700\u5927\u52aa\u529b\u7684\u7c98\u6027               \u7ed9\u62d2\u7edd\u4f1a\u8bddcookie\u7684\u5ba2\u6237\u3002\u8fd9\u4e2a\u7b97\u6cd5\u662f               \u9ed8\u8ba4\u4e3a\u9759\u6001\uff0c\u8fd9\u610f\u5473\u7740\u66f4\u6539\u670d\u52a1\u5668\u7684               \u98de\u884c\u4e2d\u7684\u91cd\u91cf\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\uff0c\u4f46\u8fd9\u53ef\u4ee5\u662f               \u4f7f\u7528\u201c\u54c8\u5e0c\u7c7b\u578b\u201d\u66f4\u6539\u3002</p> <p>uri\u6b64\u7b97\u6cd5\u5bf9URI\u7684\u5de6\u4fa7\u90e8\u5206\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\uff08               \u95ee\u53f7\uff09\u6216\u6574\u4e2aURI\uff08\u5982\u679c\u662f\u201c whole\u201d\u53c2\u6570\uff09               \u5b58\u5728\uff09\uff0c\u7136\u540e\u5c06\u54c8\u5e0c\u503c\u9664\u4ee5               \u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u3002\u7ed3\u679c\u6307\u5b9a\u54ea\u4e2a\u670d\u52a1\u5668\u5c06               \u6536\u5230\u8bf7\u6c42\u3002\u8fd9\u6837\u53ef\u4ee5\u786e\u4fdd\u76f8\u540c\u7684URI\u5c06               \u53ea\u8981\u6ca1\u6709\u670d\u52a1\u5668\uff0c\u59cb\u7ec8\u5c06\u5176\u5b9a\u5411\u5230\u540c\u4e00\u670d\u52a1\u5668               \u4e0a\u5347\u6216\u4e0b\u964d\u3002\u8fd9\u4e0e\u4ee3\u7406\u7f13\u5b58\u4e00\u8d77\u4f7f\u7528\uff0c\u5e76\u4e14               \u9632\u75c5\u6bd2\u4ee3\u7406\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u63d0\u9ad8\u7f13\u5b58\u547d\u4e2d\u7387\u3002               \u8bf7\u6ce8\u610f\uff0c\u6b64\u7b97\u6cd5\u53ea\u80fd\u5728HTTP\u540e\u7aef\u4e2d\u4f7f\u7528\u3002               \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u7b97\u6cd5\u4e3a\u9759\u6001\u7b97\u6cd5\uff0c\u8fd9\u610f\u5473\u7740               \u5373\u65f6\u66f4\u6539\u670d\u52a1\u5668\u7684\u6743\u91cd\u5c06\u65e0\u6548\uff0c               \u4f46\u8fd9\u53ef\u4ee5\u4f7f\u7528\u201c hash-type \u201d\u8fdb\u884c\u66f4\u6539\u3002</p> Text Only<pre><code>          \u8be5\u7b97\u6cd5\u652f\u6301\u4e24\u4e2a\u53ef\u9009\u53c2\u6570\u201c len\u201d\u548c\n          \u201c\u6df1\u5ea6\u201d\uff0c\u5747\u8ddf\u4e00\u4e2a\u6b63\u6574\u6570\u3002\u8fd9\u4e9b\n          \u5f53\u9700\u8981\u5e73\u8861\u670d\u52a1\u5668\u65f6\uff0c\u9009\u9879\u53ef\u80fd\u4f1a\u6709\u6240\u5e2e\u52a9\n          \u4ec5\u57fa\u4e8eURI\u7684\u5f00\u5934\u3002\u201c len\u201d\u53c2\u6570\n          \u8868\u793a\u8be5\u7b97\u6cd5\u53ea\u5e94\u8003\u8651\n          URI\u5f00\u5934\u7684\u5b57\u7b26\u4ee5\u8ba1\u200b\u200b\u7b97\u54c8\u5e0c\u503c\u3002\n          \u8bf7\u6ce8\u610f\uff0c\u5c06\u201c len\u201d\u8bbe\u7f6e\u4e3a1\u51e0\u4e4e\u6ca1\u6709\u9053\u7406\uff0c\u56e0\u4e3a\u5927\u591a\u6570\n          URI\u4ee5\u201c /\u201d\u5f00\u5934\u3002\n\n          \u201c depth\u201d\u53c2\u6570\u8868\u793a\u6700\u5927\u76ee\u5f55\u6df1\u5ea6\n          \u7528\u4e8e\u8ba1\u7b97\u54c8\u5e0c\u3002\u6bcf\u4e2a\u7ea7\u522b\u8ba1\u4e00\u6b21\n          \u5728\u8bf7\u6c42\u4e2d\u659c\u6760\u3002\u5982\u679c\u540c\u65f6\u6307\u5b9a\u4e86\u4e24\u4e2a\u53c2\u6570\uff0c\u5219\n          \u8fbe\u5230\u4e24\u8005\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u65f6\uff0c\u8bc4\u4f30\u90fd\u5c06\u505c\u6b62\u3002\n\n          \u201c\u4ec5\u8def\u5f84\u201d\u53c2\u6570\u8868\u793a\u54c8\u5e0c\u5bc6\u94a5\u5f00\u59cb\n          \u5728\u8def\u5f84\u7684\u7b2c\u4e00\u4e2a\u201c /\u201d\u4f4d\u7f6e\u3002\u8fd9\u53ef\u4ee5\u7528\u6765\u5ffd\u7565\n          \u7edd\u5bf9URI\u7684\u6388\u6743\u90e8\u5206\uff0c\u5e76\u786e\u4fddHTTP / 1\n          \u548cHTTP / 2 URI\u5c06\u63d0\u4f9b\u76f8\u540c\u7684\u54c8\u5e0c\u503c\u3002\n</code></pre> <p>url_param\u53c2\u6570\u4e2d\u6307\u5b9a\u7684URL\u53c2\u6570\u5c06\u5728               \u6bcf\u4e2aHTTP GET\u8bf7\u6c42\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u3002</p> Text Only<pre><code>          \u5982\u679c\u4f7f\u7528\u4fee\u9970\u7b26\u201c check_post\u201d\uff0c\u5219\u4f7f\u7528HTTP POST\n          \u5c06\u5728\u8bf7\u6c42\u5b9e\u4f53\u4e2d\u641c\u7d22\u53c2\u6570\u5b9e\u53c2\uff0c\n          \u5728\u95ee\u53f7\u540e\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u627e\u4e0d\u5230\u8be5\u5b57\u7b26\u65f6\n          \uff08'\uff1f'\uff09\u5728\u7f51\u5740\u4e2d\u3002\u90ae\u4ef6\u6b63\u6587\u53ea\u4f1a\u5f00\u59cb\u662f\n          \u4e00\u65e6\u516c\u5e03\u7684\u6570\u636e\u91cf\u5df2\u88ab\u5206\u6790\n          \u6536\u5230\u6216\u8bf7\u6c42\u7f13\u51b2\u533a\u5df2\u6ee1\u3002\u5728\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\n          \u4f7f\u7528\u5206\u5757\u7f16\u7801\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u5757\u662f\n          \u626b\u63cf\u3002\u7531\u5757\u8fb9\u754c\u5206\u9694\u7684\u53c2\u6570\u503c\u53ef\u4ee5\n          \u5b8c\u5168\u968f\u673a\u5730\u5e73\u8861\u3002\u6b64\u5173\u952e\u5b57\u7528\u4e8e\u652f\u6301\n          \u53ef\u9009\u7684&lt;max_wait&gt;\u53c2\u6570\uff0c\u73b0\u5728\u5c06\u5ffd\u7565\u5b83\u3002\n\n          \u5982\u679c\u627e\u5230\u8be5\u53c2\u6570\uff0c\u540e\u8ddf\u4e00\u4e2a\u7b49\u53f7\uff08'='\uff09\uff0c\u7136\u540e\n          \u4e00\u4e2a\u503c\uff0c\u7136\u540e\u5c06\u8be5\u503c\u6563\u5217\u5e76\u9664\u4ee5\u603b\u6570\n          \u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u7684\u91cd\u91cf\u3002\u7ed3\u679c\u6307\u5b9a\n          \u670d\u52a1\u5668\u5c06\u6536\u5230\u8bf7\u6c42\u3002\n\n          \u8fd9\u7528\u4e8e\u8ddf\u8e2a\u8bf7\u6c42\u4e2d\u7684\u7528\u6237\u6807\u8bc6\u7b26\u5e76\u786e\u4fdd\n          \u76f8\u540c\u7684\u7528\u6237ID\u5c06\u59cb\u7ec8\u53d1\u9001\u5230\u4e0e\n          \u53ea\u8981\u6ca1\u6709\u670d\u52a1\u5668\u51fa\u73b0\u6545\u969c\u5373\u53ef\u3002\u5982\u679c\u627e\u4e0d\u5230\u503c\uff0c\u6216\u8005\n          \u627e\u4e0d\u5230\u53c2\u6570\uff0c\u5219\u5faa\u73af\u7b97\u6cd5\u4e3a\n          \u5e94\u7528\u3002\u8bf7\u6ce8\u610f\uff0c\u6b64\u7b97\u6cd5\u53ea\u80fd\u5728HTTP\u4e2d\u4f7f\u7528\n          \u540e\u7aef\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u7b97\u6cd5\u662f\u9759\u6001\u7684\uff0c\u8fd9\u610f\u5473\u7740\n          \u5373\u65f6\u66f4\u6539\u670d\u52a1\u5668\u7684\u6743\u91cd\u4e0d\u4f1a\n          \u6548\u679c\uff0c\u4f46\u662f\u53ef\u4ee5\u4f7f\u7528\u201c hash-type \u201d\u8fdb\u884c\u66f4\u6539\u3002\n</code></pre> <p>hdr\uff08\uff09\u5c06\u5728\u6bcf\u4e2aHTTP\u4e2d\u67e5\u627eHTTP\u6807\u5934               \u8981\u6c42\u3002\u5c31\u50cf\u7b49\u6548\u7684ACL'hdr\uff08\uff09'\u51fd\u6570\u4e00\u6837\uff0c               \u62ec\u53f7\u4e2d\u7684\u6807\u9898\u540d\u79f0\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002\u5982\u679c               \u6807\u5934\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u5982\u679c\u6807\u5934\u4e0d\u5305\u542b\u4efb\u4f55\u503c\uff0c\u5219               \u800c\u662f\u4f7f\u7528roundrobin\u7b97\u6cd5\u3002 Text Only<pre><code>          \u53ef\u9009\u7684'use_domain_only'\u53c2\u6570\u53ef\u7528\uff0c\u7528\u4e8e\n          \u5c06\u54c8\u5e0c\u7b97\u6cd5\u51cf\u5c11\u5230\u4e3b\u57df\u90e8\u5206\n          \u7279\u5b9a\u7684\u6807\u5934\uff0c\u4f8b\u5982\u201c\u4e3b\u673a\u201d\u3002\u4f8b\u5982\uff0c\u5728\u4e3b\u673a\u4e2d\n          \u503c\u201c haproxy.1wt.eu\u201d\uff0c\u5219\u4ec5\u8003\u8651\u201c 1wt\u201d\u3002\n\n          \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u7b97\u6cd5\u4e3a\u9759\u6001\u7b97\u6cd5\uff0c\u8fd9\u610f\u5473\u7740\n          \u5373\u65f6\u66f4\u6539\u670d\u52a1\u5668\u7684\u6743\u91cd\u5c06\u65e0\u6548\uff0c\n          \u4f46\u8fd9\u53ef\u4ee5\u4f7f\u7528\u201c hash-type \u201d\u8fdb\u884c\u66f4\u6539\u3002\n</code></pre> <p>\u968f\u673a\u7684   \u968f\u673a\uff08\uff09               \u968f\u673a\u6570\u5c06\u7528\u4f5c\u4fdd\u6301\u4e00\u81f4\u7684\u952e               \u54c8\u5e0c\u51fd\u6570\u3002\u8fd9\u610f\u5473\u7740\u670d\u52a1\u5668\u7684\u6743\u91cd\u662f               \u53d7\u5c0a\u656c\u7684\u662f\uff0c\u52a8\u6001\u4f53\u91cd\u53d8\u5316\u7acb\u5373\u751f\u6548\uff0c\u56e0\u4e3a               \u4ee5\u53ca\u65b0\u670d\u52a1\u5668\u7684\u6dfb\u52a0\u3002\u53ef\u4ee5\u8fdb\u884c\u968f\u673a\u8d1f\u8f7d\u5e73\u8861               \u5728\u5927\u578b\u670d\u52a1\u5668\u573a\u6216\u9891\u7e41\u6dfb\u52a0\u670d\u52a1\u5668\u65f6\u5f88\u6709\u7528               \u6216\u5c06\u5176\u79fb\u9664\uff0c\u56e0\u4e3a\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u9524\u51fb\u4f5c\u7528\uff0c               \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7531roundrobin\u6216lessconn\u5bfc\u81f4\u3002\u8fd9               hash-balance-factor\u6307\u4ee4\u53ef\u7528\u4e8e\u8fdb\u4e00\u6b65\u6539\u8fdb               \u8d1f\u8f7d\u5e73\u8861\u7684\u516c\u5e73\u6027\uff0c\u5c24\u5176\u662f\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b               \u670d\u52a1\u5668\u7684\u54cd\u5e94\u65f6\u95f4\u53d8\u5316\u5f88\u5927\u3002\u5f53\u4e00\u4e2a               \u53c2\u6570\u5b58\u5728\uff0c\u5fc5\u987b\u4e3a\u6574\u65701               \u6216\u66f4\u5927\uff0c\u6307\u793a\u9009\u62e9\u4e4b\u524d\u7684\u62bd\u5956\u6b21\u6570               \u8fd9\u4e9b\u670d\u52a1\u5668\u4e2d\u8d1f\u8f7d\u6700\u5c11\u7684\u670d\u52a1\u5668\u3002\u786e\u5b9e\u8bc1\u660e\u4e86               \u9009\u62e9\u4e24\u4e2a\u670d\u52a1\u5668\u4e2d\u8d1f\u8f7d\u6700\u5c0f\u7684\u4e00\u4e2a\u5c31\u8db3\u591f\u4e86               \u901a\u8fc7\u663e\u7740\u63d0\u9ad8\u7b97\u6cd5\u7684\u516c\u5e73\u6027               \u59cb\u7ec8\u907f\u514d\u9009\u62e9\u670d\u52a1\u5668\u573a\u4e2d\u8d1f\u8f7d\u6700\u5927\u7684\u670d\u52a1\u5668               \u5e76\u6446\u8131\u7531               \u5206\u914d\u4e0d\u5747\u7684\u4e00\u81f4\u6e05\u5355\u3002\u8f83\u9ad8\u7684\u503cN               \u5c06\u593a\u8d70N-1\u4e2a\u8d1f\u8f7d\u6700\u9ad8\u7684\u670d\u52a1\u5668               \u727a\u7272\u6027\u80fd\u3002\u5177\u6709\u975e\u5e38\u9ad8\u7684\u503c\uff0c\u8be5\u7b97\u6cd5               \u4f1a\u6536\u655b\u5230minimumconn\u7684\u7ed3\u679c\uff0c\u4f46\u901f\u5ea6\u8981\u6162\u5f97\u591a\u3002               \u9ed8\u8ba4\u503c\u4e3a2\uff0c\u901a\u5e38\u663e\u793a\u975e\u5e38\u597d               \u5206\u5e03\u548c\u6027\u80fd\u3002\u6b64\u7b97\u6cd5\u4e5f\u79f0\u4e3a               \u4e24\u79cd\u968f\u673a\u9009\u62e9\u7684\u529b\u91cf\uff0c\u5e76\u5728\u6b64\u5904\u8fdb\u884c\u63cf\u8ff0\uff1a               http://www.eecs.harvard.edu/~michaelm/postscripts/handbook2001.pdf <p>rdp cookie   rdp-cookie\uff08&lt;\u540d\u79f0&gt;\uff09               RDP Cookie &lt;\u540d\u79f0&gt;\uff08\u5982\u679c\u7701\u7565\uff0c\u5219\u4e3a\u201c mstshash\u201d\uff09               \u67e5\u627e\u5e76\u4e3a\u6bcf\u4e2a\u4f20\u5165\u7684TCP\u8bf7\u6c42\u8fdb\u884c\u54c8\u5e0c\u5904\u7406\u3002\u5c31\u50cf               \u5e26\u6709\u7b49\u6548\u7684ACL'req_rdp_cookie\uff08\uff09'\u51fd\u6570\u7684\u540d\u79f0               \u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002\u6b64\u673a\u5236\u53ef\u7528\u4f5c\u964d\u7ea7               \u6301\u7eed\u6027\u6a21\u5f0f\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u59cb\u7ec8\u53d1\u9001               \u540c\u4e00\u7528\u6237\uff08\u6216\u540c\u4e00\u4f1a\u8bddID\uff09\u5230\u540c\u4e00\u670d\u52a1\u5668\u3002\u5982\u679c               \u627e\u4e0d\u5230cookie\uff0c\u6b63\u5e38\u7684\u8f6e\u5faa\u7b97\u6cd5\u662f               \u4ee3\u66ff\u3002</p> Text Only<pre><code>          \u8bf7\u6ce8\u610f\uff0c\u8981\u4f7f\u5176\u6b63\u5e38\u5de5\u4f5c\uff0c\u524d\u7aef\u5fc5\u987b\u786e\u4fdd\n          RDP cookie\u5df2\u7ecf\u5b58\u5728\u4e8e\u8bf7\u6c42\u7f13\u51b2\u533a\u4e2d\u3002\u4e3a\u4e86\u8fd9\n          \u60a8\u5fc5\u987b\u7ed3\u5408\u4f7f\u7528\u201c tcp-request\u5185\u5bb9\u63a5\u53d7\u201d\u89c4\u5219\n          \u4e00\u4e2a\u201c req_rdp_cookie_cnt\u201d ACL\u3002\n\n          \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u7b97\u6cd5\u4e3a\u9759\u6001\u7b97\u6cd5\uff0c\u8fd9\u610f\u5473\u7740\n          \u5373\u65f6\u66f4\u6539\u670d\u52a1\u5668\u7684\u6743\u91cd\u5c06\u65e0\u6548\uff0c\n          \u4f46\u8fd9\u53ef\u4ee5\u4f7f\u7528\u201c hash-type \u201d\u8fdb\u884c\u66f4\u6539\u3002\n\n          \u53e6\u8bf7\u53c2\u89c1rdp_cookie\u6a21\u5f0f\u83b7\u53d6\u529f\u80fd\u3002\n</code></pre> <p>\u662f\u67d0\u4e9b\u4eba\u53ef\u80fd\u9700\u8981\u7684\u53ef\u9009\u53c2\u6570\u5217\u8868             \u7b97\u6cd5\u3002\u76ee\u524d\uff0c\u53ea\u6709\u201c url_param \u201d\u548c\u201c uri\u201d\u652f\u6301             \u53ef\u9009\u53c2\u6570\u3002"},{"location":"lbha/LVS/","title":"Linux Virtual Server","text":"Markdown<pre><code>Linux\u865a\u62df\u670d\u52a1\u5668\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u6269\u5c55\u4e14\u9ad8\u5ea6\u53ef\u7528\u7684\u670d\u52a1\u5668\uff0c\u6784\u5efa\u5728\u771f\u5b9e\u670d\u52a1\u5668\u96c6\u7fa4\u4e0a\u3002\u670d\u52a1\u5668\u7fa4\u96c6\u7684\u4f53\u7cfb\u7ed3\u6784\u5bf9\u6700\u7ec8\u7528\u6237\u5b8c\u5168\u900f\u660e\uff0c\u7528\u6237\u4e0e\u7fa4\u96c6\u7cfb\u7edf\u8fdb\u884c\u4ea4\u4e92\n\u5c31\u597d\u50cf\u5b83\u53ea\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u865a\u62df\u670d\u52a1\u5668\u4e00\u6837\n</code></pre> Text Only<pre><code>\u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5e73\u8861\u5668\u53ef\u4ee5\u901a\u8fc7\u9ad8\u901fLAN\u6216\u5730\u7406\u4e0a\u5206\u6563\u7684WAN\u4e92\u8fde\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u53ef\u4ee5\u5c06\u8bf7\u6c42\u5206\u6d3e\u7ed9\u4e0d\u540c\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4f7f\u7fa4\u96c6\u7684\u5e76\u884c\u670d\u52a1\u5728\u5355\u4e2aIP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1\uff0c\u8bf7\u6c42\u5206\u6d3e\u53ef\u4ee5\u4f7f\u7528IP\u8d1f\u8f7d\u5e73\u8861\u6280\u672f\u6216\u5e94\u7528\u7ea7\u8d1f\u8f7d\u5747\u8861\u6280\u672f\u3002\u901a\u8fc7\u900f\u660e\u5730\u6dfb\u52a0\u6216\u5220\u9664\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u6765\u5b9e\u73b0\u7cfb\u7edf\u7684\u53ef\u4f38\u7f29\u6027\u3002\u901a\u8fc7\u68c0\u6d4b\u8282\u70b9\u6216\u5b88\u62a4\u7a0b\u5e8f\u6545\u969c\u5e76\u9002\u5f53\u5730\u91cd\u65b0\u914d\u7f6e\u7cfb\u7edf\u6765\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\n</code></pre> Text Only<pre><code>\u6784\u5efa\u670d\u52a1\u5668\u96c6\u7fa4\u65b9\u6cd5\uff1a\nDNS\u8d1f\u8f7d\u5e73\u8861\uff1a\n\u7b80\u5355\uff0c\u5229\u7528\u57df\u540d\u7cfb\u7edf\u5c06\u57df\u540d\u89e3\u6790\u5230\u670d\u52a1\u5668\u4e0d\u540c\u7684IP\u6765\u5206\u53d1\u8bf7\u6c42\uff0cDNS\u670d\u52a1\u5668\u6839\u636e\u8c03\u5ea6\u7b56\u7565(\u5982\u5faa\u73af\u65b9\u5f0f)\u53d1\u51fa\u670d\u52a1\u5668IP\u5730\u5740\uff0c\u7136\u540e\u4f7f\u7528\u76f8\u540c\u7684\u672c\u5730\u7f13\u5b58\u57df\u540d\u670d\u52a1\u5668\u5728\u6307\u5b9a\u7684\u57df\u540d\u89e3\u6790\u751f\u5b58\u65f6\u95f4(TTL)\u4e2d\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u670d\u52a1\u5668\n\u4f46\u662f\uff0c\u7531\u4e8e\u5ba2\u6237\u7aef\u548c\u5206\u5c42DNS\u7cfb\u7edf\u7684\u7f13\u5b58\u7279\u6027\uff0c\u5f88\u5bb9\u6613\u5bfc\u81f4\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u6b64\u670d\u52a1\u5668\u4e0d\u5bb9\u6613\u5904\u7406\u5176\u5cf0\u503c\u8d1f\u8f7d\u3002\u5728DNS\u670d\u52a1\u5668\u4e0a\u65e0\u6cd5\u5f88\u597d\u5730\u9009\u62e9\u540d\u79f0\u6620\u5c04\u7684TTL\u503c\uff0c\u5c0f\u503cDNS\u6d41\u91cf\u5f88\u9ad8\u4e14DNS\u670d\u52a1\u5668\u5c06\u6210\u4e3a\u74f6\u9888\uff0c\u5e76\u4e14\u5177\u6709\u9ad8\u503c\uff0c\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u5c06\u53d8\u5f97\u66f4\u7cdf\u3002\u5373\u4f7fTTL\u503c\u8bbe\u7f6e\u4e3a\u96f6\uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u6bcf\u4e2a\u4e3b\u673a\uff0c\u4e0d\u540c\u7528\u6237\u7684\u8bbf\u95ee\u6a21\u5f0f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\uff0c\u56e0\u4e3a\u6709\u4e9b\u4eba\u53ef\u80fd\u4ece\u7f51\u7ad9\u4e0a\u62bd\u53d6\u5927\u91cf\u9875\u9762\uff0c\u800c\u5176\u4ed6\u4eba\u53ef\u80fd\u53ea\u662f\u6d4f\u89c8\u51e0\u9875\u7136\u540e\u53bb\u8fdc\u3002\u6b64\u5916\uff0c\u5b83\u4e0d\u592a\u53ef\u9760\uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u53d1\u751f\u6545\u969c\u65f6\uff0c\u5c06\u540d\u79f0\u6620\u5c04\u5230IP\u5730\u5740\u7684\u5ba2\u6237\u7aef\u5c06\u53d1\u73b0\u670d\u52a1\u5668\u5df2\u5173\u95ed\n\n\u57fa\u4e8e\u8c03\u5ea6\u7a0b\u5e8f\u7684\u8d1f\u8f7d\u5e73\u8861\u7fa4\u96c6\uff1a\n\u53ef\u7528\u4e8e\u5728\u7fa4\u96c6\u4e2d\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5206\u914d\u8d1f\u8f7d\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u7684\u5e76\u884c\u670d\u52a1\u53ef\u4ee5\u5728\u5355\u4e2aIP\u5730\u5740\u4e0a\u663e\u793a\u4e3a\u865a\u62df\u670d\u52a1\uff0c\u5e76\u4e14\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u50cf\u5355\u4e2a\u670d\u52a1\u5668\u4e00\u6837\u8fdb\u884c\u4ea4\u4e92\u4e0d\u77e5\u9053\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u670d\u52a1\u5668\u3002\u4e0e\u57fa\u4e8eDNS\u7684\u8d1f\u8f7d\u5e73\u8861\u76f8\u6bd4\uff0c\u8c03\u5ea6\u7a0b\u5e8f\u53ef\u4ee5\u4ee5\u7cbe\u7ec6\u7684\u7c92\u5ea6\uff08\u4f8b\u5982\u6bcf\u4e2a\u8fde\u63a5\uff09\u8c03\u5ea6\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5728\u670d\u52a1\u5668\u4e4b\u95f4\u5b9e\u73b0\u66f4\u597d\u7684\u8d1f\u8f7d\u5e73\u8861\u3002\u5f53\u4e00\u53f0\u6216\u591a\u53f0\u670d\u52a1\u5668\u53d1\u751f\u6545\u969c\u65f6\uff0c\u53ef\u4ee5\u5c4f\u853d\u6545\u969c\u3002\u670d\u52a1\u5668\u7ba1\u7406\u53d8\u5f97\u8d8a\u6765\u8d8a\u5bb9\u6613\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u968f\u65f6\u4f7f\u7528\u670d\u52a1\u5668\u6216\u66f4\u591a\u670d\u52a1\u5668\uff0c\u8fd9\u4e0d\u4f1a\u4e2d\u65ad\u6700\u7ec8\u7528\u6237\u7684\u670d\u52a1\n\n\u8d1f\u8f7d\u5747\u8861\u53ef\u4ee5\u5728\u4e24\u4e2a\u7ea7\u522b\u5b8c\u6210\uff0c\u5373\u5e94\u7528\u7ea7\u548cIP\u7ea7\u3002\u5c06HTTP\u8bf7\u6c42\u8f6c\u53d1\u5230\u96c6\u7fa4\u4e2d\u7684\u4e0d\u540cWeb\u670d\u52a1\u5668\uff0c\u83b7\u53d6\u7ed3\u679c\uff0c\u7136\u540e\u5c06\u5176\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u7531\u4e8e\u5728\u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\u5904\u7406HTTP\u8bf7\u6c42\u548c\u56de\u590d\u7684\u5f00\u9500\u5f88\u9ad8\uff0c\u5f53\u670d\u52a1\u5668\u8282\u70b9\u6570\u91cf\u589e\u52a0\u52305\u6216\u66f4\u591a\u65f6\uff0c\u5e94\u7528\u7a0b\u5e8f\u7ea7\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6210\u4e3a\u65b0\u7684\u74f6\u9888\uff0c\u8fd9\u53d6\u51b3\u4e8e\u6bcf\u4e2a\u670d\u52a1\u5668\u8282\u70b9\u7684\u541e\u5410\u91cf\u670d\u52a1\u5668\n</code></pre> Text Only<pre><code>LinuxVirtualServer\u4ee5\u4e09\u79cdIP\u8d1f\u8f7d\u5747\u8861\u6280\u672f(\u6570\u636e\u5305\u8f6c\u53d1\u65b9\u6cd5)\u5b9e\u73b0\n1. NAT\u65b9\u5f0f\n2. IP\u96a7\u9053\n3. \u76f4\u63a5\u8def\u7531\n</code></pre> <p>VS/NAT\uff0cVS/TUN\u548cVS/DR\u7684\u6bd4\u8f83\uff1a |      \u5bf9\u6bd4\u65b9\u9762       |   VS/NAT   |  VS/TUN   |   VS/DR    | | :--------: | :--------: | :-------: | :--------: | |     realserver      |    \u4efb\u4f55    |   \u96a7\u9053    | \u975eARP\u8bbe\u5907  | | realserver network  |    \u79c1\u6709    |  lan/wan  |    lan     | | realserver numbers  | low(10-20) |   high    |    high    | | realserver gateway  |  director  | ownrouter | own router | | client connnects to |    VIP     |    VIP    |    VIP     |</p> <p>LVS\u96c6\u7fa4\u901a\u5e38\u91c7\u7528\u4e09\u8fde\u63a5\u67b6\u6784\uff1a </p> <p>\u4e09\u8fde\u63a5\u7ed3\u6784\u5305\u62ec\uff1a</p> <p>**\u8d1f\u8f7d\u5747\u8861\u5668**\u5b83\u662f\u6574\u4e2a\u96c6\u7fa4\u7cfb\u7edf\u7684\u524d\u7aef\u673a\u5668\uff0c\u5e76\u5728\u4e00\u7ec4\u670d\u52a1\u5668\u4e4b\u95f4\u5e73\u8861\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u8ba4\u4e3a\u6240\u6709\u670d\u52a1\u90fd\u6765\u81ea\u5355\u4e2aIP\u5730\u5740</p> <p>**\u670d\u52a1\u5668\u7fa4\u96c6**\u5b83\u662f\u4e00\u7ec4\u8fd0\u884c\u5b9e\u9645\u7f51\u7edc\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u4f8b\u5982Web\uff0c\u90ae\u4ef6\uff0cFTP\uff0cDNS\u548c\u5a92\u4f53\u670d\u52a1</p> <p>**\u5171\u4eab\u5b58\u50a8**\u4e3a\u670d\u52a1\u5668\u63d0\u4f9b\u5171\u4eab\u5b58\u50a8\u7a7a\u95f4\uff0c\u4ee5\u4fbf\u670d\u52a1\u5668\u53ef\u4ee5\u8f7b\u677e\u62e5\u6709\u76f8\u540c\u7684\u5185\u5bb9\u5e76\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1</p> <p>NAT: NAT(Network Address Translation)\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u5373\u5c06IP\u5730\u5740\u4ece\u4e00\u4e2a\u7ec4\u6620\u5c04\u5230\u53e6\u4e00\u4e2a\u7ec4\u7684\u529f\u80fd\u3002\u5f53\u5730\u5740\u6620\u5c04\u4e3aN\u5230N\u65f6\uff0c\u79f0\u4e3a\u9759\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362; \u5f53\u6620\u5c04\u662fM\u5230N\uff08M&gt; N\uff09\u65f6\uff0c\u5b83\u88ab\u79f0\u4e3a\u52a8\u6001\u7f51\u7edc\u5730\u5740\u8f6c\u6362\u3002\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u662f\u57fa\u672cNAT\u7684\u6269\u5c55\uff0c\u56e0\u4e3a\u8bb8\u591a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u88ab\u8f6c\u6362\u4e3a\u5355\u4e2a\u7f51\u7edc\u5730\u5740\u53ca\u5176TCP/UDP\u7aef\u53e3\u3002\u8fd9\u662fN-to-1\u6620\u5c04\uff0c\u5b9e\u73b0\u4e86Linux IP Masquerading(\u4f2a\u88c5)\u3002Linux\u4e0a\u7684NAT\u865a\u62df\u670d\u52a1\u5668\u662f\u901a\u8fc7\u7f51\u7edc\u5730\u5740\u7aef\u53e3\u8f6c\u6362\u5b8c\u6210\u7684  \u5f53\u7528\u6237\u8bbf\u95ee\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u670d\u52a1\u65f6\uff0c\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u8bf7\u6c42\u6570\u636e\u5305\uff08\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u5916\u90e8IP\u5730\u5740\uff09\u5230\u8fbe\u8d1f\u8f7d\u5747\u8861\u5668\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u5982\u679c\u6839\u636e\u865a\u62df\u670d\u52a1\u5668\u89c4\u5219\u8868\u5339\u914d\u865a\u62df\u670d\u52a1\u5668\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u96c6\u7fa4\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u5c06\u76ee\u6807\u5730\u5740\u548c\u6570\u636e\u5305\u7684\u7aef\u53e3\u91cd\u5199\u4e3a\u6240\u9009\u670d\u52a1\u5668\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\uff0c\u5e76\u5c06\u6570\u636e\u5305\u8f6c\u53d1\u5230\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u91cd\u5199\u8be5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u56de\u590d\u6570\u636e\u5305\u8fd4\u56de\u65f6\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u91cd\u5199\u4e3a\u865a\u62df\u670d\u52a1\u7684\u6e90\u5730\u5740\u548c\u7aef\u53e3\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u5728\u54c8\u5e0c\u8868\u4e2d\u5220\u9664</p> <p>IP\u96a7\u9053\uff1a IP\u96a7\u9053\uff08IP\u5c01\u88c5\uff09\u662f\u4e00\u79cd\u5c06IP\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\u7684\u6280\u672f\uff0c\u5b83\u5141\u8bb8\u5c06\u53d1\u5f80\u4e00\u4e2aIP\u5730\u5740\u7684\u6570\u636e\u62a5\u5305\u88c5\u5e76\u91cd\u5b9a\u5411\u5230\u53e6\u4e00\u4e2aIP\u5730\u5740\u3002IP\u5c01\u88c5\u73b0\u5728\u901a\u5e38\u7528\u4e8e\u5916\u8054\u7f51\uff0c\u79fb\u52a8IP\uff0cIP\u591a\u64ad\uff0c\u96a7\u9053\u4e3b\u673a\u6216\u7f51\u7edc  \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u6839\u636e\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u5c06\u6570\u636e\u5305\u5c01\u88c5\u5728IP\u6570\u636e\u62a5\u4e2d\uff0c\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u5c06\u518d\u6b21\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5c06\u5176\u8f6c\u53d1\u5230\u8be5\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u5c01\u88c5\u7684\u6570\u636e\u5305\u65f6\uff0c\u5b83\u4f1a\u89e3\u5c01\u88c5\u6570\u636e\u5305\u5e76\u5904\u7406\u8bf7\u6c42\uff0c\u6700\u540e\u6839\u636e\u81ea\u5df1\u7684\u8def\u7531\u8868\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664</p> <p>\u76f4\u63a5\u8def\u7531: \u6b64\u8bf7\u6c42\u8c03\u5ea6\u65b9\u6cd5\u7c7b\u4f3c\u4e8eIBM\u7684NetDispatcher\u4e2d\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002\u865a\u62dfIP\u5730\u5740\u7531\u771f\u5b9e\u670d\u52a1\u5668\u548c\u8d1f\u8f7d\u5747\u8861\u5668\u5171\u4eab\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u7684\u63a5\u53e3\u4e5f\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u7528\u4e8e\u63a5\u53d7\u8bf7\u6c42\u6570\u636e\u5305\uff0c\u5e76\u76f4\u63a5\u5c06\u6570\u636e\u5305\u8def\u7531\u5230\u9009\u5b9a\u7684\u670d\u52a1\u5668\u3002\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u7684\u975earp\u522b\u540d\u63a5\u53e3\u90fd\u914d\u7f6e\u4e86\u865a\u62dfIP\u5730\u5740\uff0c\u6216\u8005\u5c06\u53d1\u5f80\u865a\u62dfIP\u5730\u5740\u7684\u6570\u636e\u5305\u91cd\u5b9a\u5411\u5230\u672c\u5730\u5957\u63a5\u5b57\uff0c\u4ee5\u4fbf\u771f\u5b9e\u670d\u52a1\u5668\u53ef\u4ee5\u5728\u672c\u5730\u5904\u7406\u6570\u636e\u5305\u3002\u8d1f\u8f7d\u5747\u8861\u5668\u548c\u771f\u5b9e\u670d\u52a1\u5668\u5fc5\u987b\u901a\u8fc7HUB / Switch\u7269\u7406\u8fde\u63a5\u5176\u4e2d\u4e00\u4e2a\u63a5\u53e3\u3002\u901a\u8fc7\u76f4\u63a5\u8def\u7531\u7684\u865a\u62df\u670d\u52a1\u5668\u7684\u4f53\u7cfb\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a  \u5f53\u7528\u6237\u8bbf\u95ee\u7531\u670d\u52a1\u5668\u96c6\u7fa4\u63d0\u4f9b\u7684\u865a\u62df\u670d\u52a1\u65f6\uff0c\u5230\u8fbe\u865a\u62dfIP\u5730\u5740\u7684\u5206\u7ec4\uff08\u865a\u62df\u670d\u52a1\u5668\u7684IP\u5730\u5740\uff09\u5230\u8fbe\u3002\u8d1f\u8f7d\u5747\u8861\u5668\uff08LinuxDirector\uff09\u68c0\u67e5\u6570\u636e\u5305\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002\u5982\u679c\u5b83\u4eec\u5339\u914d\u865a\u62df\u670d\u52a1\uff0c\u5219\u901a\u8fc7\u8c03\u5ea6\u7b97\u6cd5\u4ece\u7fa4\u96c6\u4e2d\u9009\u62e9\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fde\u63a5\u6dfb\u52a0\u5230\u8bb0\u5f55\u8fde\u63a5\u7684\u54c8\u5e0c\u8868\u4e2d\u3002\u7136\u540e\uff0c\u8d1f\u8f7d\u5747\u8861\u5668\u76f4\u63a5\u5c06\u5176\u8f6c\u53d1\u5230\u6240\u9009\u670d\u52a1\u5668\u3002\u5f53\u4f20\u5165\u6570\u636e\u5305\u5c5e\u4e8e\u6b64\u8fde\u63a5\u5e76\u4e14\u53ef\u4ee5\u5728\u54c8\u5e0c\u8868\u4e2d\u627e\u5230\u6240\u9009\u670d\u52a1\u5668\u65f6\uff0c\u8be5\u6570\u636e\u5305\u5c06\u518d\u6b21\u76f4\u63a5\u8def\u7531\u5230\u670d\u52a1\u5668\u3002\u5f53\u670d\u52a1\u5668\u6536\u5230\u8f6c\u53d1\u7684\u6570\u636e\u5305\u65f6\uff0c\u670d\u52a1\u5668\u53d1\u73b0\u8be5\u6570\u636e\u5305\u662f\u7528\u4e8e\u5176\u522b\u540d\u63a5\u53e3\u4e0a\u7684\u5730\u5740\u6216\u672c\u5730\u5957\u63a5\u5b57\u7684\u5730\u5740\uff0c\u6240\u4ee5\u5b83\u5904\u7406\u8bf7\u6c42\u5e76\u6700\u7ec8\u5c06\u7ed3\u679c\u76f4\u63a5\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u8fde\u63a5\u7ec8\u6b62\u6216\u8d85\u65f6\u540e\uff0c\u8fde\u63a5\u8bb0\u5f55\u5c06\u4ece\u54c8\u5e0c\u8868\u4e2d\u5220\u9664</p> <p>\u4f5c\u4e1a\u8c03\u5ea6\u7b97\u6cd5\uff1a \u5faa\u73af\u8c03\u5ea6Round Robin PR \u52a0\u6743\u5faa\u73af\u8c03\u5ea6Weighted Round Robin WPR \u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Least Connections LC \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6Weighted Least Connections WLC \u57fa\u4e8e\u5c40\u90e8\u6027\u7684\u6700\u5c11\u94fe\u63a5Locality-Based Least Connections LBLC \u5e26\u590d\u5236\u7684\u57fa\u4e8e\u5c40\u90e8\u6027\u6700\u5c11\u94fe\u63a5Locality-Based Least Connections with Replication LBLCR \u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6Destination Hashing DH \u6e90\u54c8\u5e0c\u8c03\u5ea6Source Hashing SH \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6Shortest Expected Delay Scheduling SED \u4ece\u4e0d\u6392\u961f\u8c03\u5ea6Never Queue Scheduling NQ</p> <p>\u5faa\u73af\u8c03\u5ea6 \u5faa\u73af\u8c03\u5ea6\u7b97\u6cd5\u5c06\u6bcf\u4e2a\u4f20\u5165\u8bf7\u6c42\u53d1\u9001\u5230\u5176\u5217\u8868\u4e2d\u7684\u4e0b\u4e00\u4e2a\u670d\u52a1\u5668\u3002\u56e0\u6b64\uff0c\u5728\u4e09\u670d\u52a1\u5668\u96c6\u7fa4\uff08\u670d\u52a1\u5668A\uff0cB\u548cC\uff09\u4e2d\uff0c\u8bf7\u6c421\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u8bf7\u6c422\u5c06\u8f6c\u5230\u670d\u52a1\u5668B\uff0c\u8bf7\u6c423\u5c06\u8f6c\u5230\u670d\u52a1\u5668C\uff0c\u8bf7\u6c424\u5c06\u8f6c\u5230\u670d\u52a1\u5668A\uff0c\u4ece\u800c\u5b8c\u6210\u9a91\u81ea\u884c\u8f66\u6216\u670d\u52a1\u5668'\u5faa\u73af'\u3002\u65e0\u8bba\u6bcf\u4e2a\u670d\u52a1\u5668\u9047\u5230\u7684\u4f20\u5165\u8fde\u63a5\u6570\u6216\u54cd\u5e94\u65f6\u95f4\u5982\u4f55\uff0c\u5b83\u90fd\u5c06\u6240\u6709\u771f\u5b9e\u670d\u52a1\u5668\u89c6\u4e3a\u76f8\u7b49\u3002\u4e0e\u4f20\u7edf\u7684\u5faa\u73afDNS\u76f8\u6bd4\uff0cVirtual Server\u5177\u6709\u4e00\u4e9b\u4f18\u52bf\u3002\u5faa\u73afDNS\u5c06\u5355\u4e2a\u57df\u89e3\u6790\u4e3a\u4e0d\u540c\u7684IP\u5730\u5740\uff0c\u8c03\u5ea6\u7c92\u5ea6\u662f\u57fa\u4e8e\u4e3b\u673a\u7684\uff0c\u5e76\u4e14DNS\u67e5\u8be2\u7684\u7f13\u5b58\u963b\u788d\u4e86\u57fa\u672c\u7b97\u6cd5\uff0c\u8fd9\u4e9b\u56e0\u7d20\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u663e\u7740\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861</p> <p>\u52a0\u6743\u5faa\u73af\u8c03\u5ea6 \u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u65e8\u5728\u66f4\u597d\u5730\u5904\u7406\u5177\u6709\u4e0d\u540c\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u3002\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u670d\u52a1\u5668\u5206\u914d\u4e00\u4e2a\u6743\u91cd\uff0c\u4e00\u4e2a\u8868\u793a\u5904\u7406\u80fd\u529b\u7684\u6574\u6570\u503c\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u9996\u5148\u63a5\u6536\u65b0\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u6743\u91cd\u8f83\u5c0f\u7684\u670d\u52a1\u5668\uff0c\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u7684\u670d\u52a1\u5668\u6bd4\u5177\u6709\u8f83\u5c11\u6743\u91cd\u7684\u670d\u52a1\u5668\u83b7\u5f97\u66f4\u591a\u8fde\u63a5\uff0c\u5177\u6709\u76f8\u540c\u6743\u91cd\u7684\u670d \u4f8b\u5982\uff0c\u771f\u5b9e\u670d\u52a1\u5668A\uff0cB\u548cC\u5206\u522b\u5177\u6709\u6743\u91cd4,3,2\uff0c\u5728\u8c03\u5ea6\u5468\u671f\uff08mod sum\uff08Wi\uff09\uff09\u4e2d\uff0c\u826f\u597d\u7684\u8c03\u5ea6\u5e8f\u5217\u5c06\u662fAABABCABC\u3002\u5728\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u5b9e\u73b0\u4e2d\uff0c\u5728\u4fee\u6539\u865a\u62df\u670d\u52a1\u5668\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u5c06\u6839\u636e\u670d\u52a1\u5668\u6743\u91cd\u751f\u6210\u8c03\u5ea6\u5e8f\u5217</p> <p>\u5f53\u771f\u5b9e\u670d\u52a1\u5668\u7684\u5904\u7406\u80fd\u529b\u4e0d\u540c\u65f6\uff0c\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u4f18\u4e8e\u5faa\u73af\u8c03\u5ea6\u3002\u4f46\u662f\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u771f\u5b9e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u52a8\u6001\u8d1f\u8f7d\u4e0d\u5e73\u8861\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u5927\u591a\u6570\u9700\u8981\u5927\u54cd\u5e94\u7684\u8bf7\u6c42\u53ef\u80fd\u4f1a\u88ab\u5f15\u5bfc\u5230\u540c\u4e00\u4e2a\u771f\u5b9e\u670d\u52a1\u5668</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5faa\u73af\u8c03\u5ea6\u662f\u52a0\u6743\u5faa\u73af\u8c03\u5ea6\u7684\u4e00\u4e2a\u7279\u6b8a\u5b9e\u4f8b\uff0c\u5176\u4e2d\u6240\u6709\u6743\u91cd\u90fd\u76f8\u7b49</p> <p>\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u5c06\u7f51\u7edc\u8fde\u63a5\u5b9a\u5411\u5230\u5177\u6709\u6700\u5c11\u6570\u91cf\u7684\u5df2\u5efa\u7acb\u8fde\u63a5\u7684\u670d\u52a1\u5668\u3002\u8fd9\u662f\u52a8\u6001\u8c03\u5ea6\u7b97\u6cd5\u4e4b\u4e00; \u56e0\u4e3a\u5b83\u9700\u8981\u52a8\u6001\u8ba1\u7b97\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u5bf9\u4e8e\u7ba1\u7406\u5177\u6709\u7c7b\u4f3c\u6027\u80fd\u7684\u670d\u52a1\u5668\u96c6\u5408\u7684\u865a\u62df\u670d\u52a1\u5668\uff0c\u5f53\u8bf7\u6c42\u7684\u8d1f\u8f7d\u53d8\u5316\u5f88\u5927\u65f6\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u53ef\u4ee5\u5e73\u6ed1\u5206\u53d1\u3002\u865a\u62df\u670d\u52a1\u5668\u5c06\u4f7f\u7528\u6700\u5c11\u7684\u6d3b\u52a8\u8fde\u63a5\u5c06\u8bf7\u6c42\u5b9a\u5411\u5230\u771f\u5b9e\u670d\u52a1\u5668</p> <p>\u4e4d\u4e00\u770b\uff0c\u5373\u4f7f\u5b58\u5728\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e5f\u53ef\u80fd\u8868\u73b0\u826f\u597d\uff0c\u56e0\u4e3a\u66f4\u5feb\u7684\u670d\u52a1\u5668\u5c06\u83b7\u5f97\u66f4\u591a\u7684\u7f51\u7edc\u8fde\u63a5\u3002\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8eTCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u5b83\u65e0\u6cd5\u5f88\u597d\u5730\u6267\u884c\u3002TCP\u7684TIME_WAIT\u901a\u5e38\u662f2\u5206\u949f\uff0c\u5728\u8fd92\u5206\u949f\u5185\uff0c\u4e00\u4e2a\u7e41\u5fd9\u7684\u7f51\u7ad9\u7ecf\u5e38\u6536\u5230\u6570\u5343\u4e2a\u8fde\u63a5\uff0c\u4f8b\u5982\uff0c\u670d\u52a1\u5668A\u7684\u529f\u80fd\u662f\u670d\u52a1\u5668B\u7684\u4e24\u500d\uff0c\u670d\u52a1\u5668A\u5904\u7406\u6570\u5343\u4e2a\u8bf7\u6c42\u5e76\u5c06\u5b83\u4eec\u4fdd\u5b58\u5728TCP\u7684TIME_WAIT\u72b6\u6001\uff0c\u4f46\u670d\u52a1\u5668B\u6b63\u5728\u722c\u884c\u4ee5\u5b8c\u6210\u5176\u6570\u5343\u4e2a\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u4e0d\u80fd\u5728\u5177\u6709\u5404\u79cd\u5904\u7406\u80fd\u529b\u7684\u670d\u52a1\u5668\u4e4b\u95f4\u5f88\u597d\u5730\u5e73\u8861\u8d1f\u8f7d</p> <p>\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u662f\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u8d85\u96c6\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6027\u80fd\u6743\u91cd\u3002\u5177\u6709\u8f83\u9ad8\u6743\u91cd\u503c\u7684\u670d\u52a1\u5668\u5728\u4efb\u4f55\u65f6\u5019\u90fd\u5c06\u83b7\u5f97\u66f4\u5927\u6bd4\u4f8b\u7684\u5b9e\u65f6\u8fde\u63a5\u3002\u865a\u62df\u670d\u52a1\u5668\u7ba1\u7406\u5458\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\u5206\u914d\u6743\u91cd\uff0c\u5e76\u4e14\u5c06\u7f51\u7edc\u8fde\u63a5\u5b89\u6392\u5230\u6bcf\u4e2a\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u6bcf\u4e2a\u670d\u52a1\u5668\u7684\u5f53\u524d\u6d3b\u52a8\u8fde\u63a5\u6570\u7684\u767e\u5206\u6bd4\u662f\u4e0e\u5176\u6743\u91cd\u7684\u6bd4\u7387\u3002\u9ed8\u8ba4\u6743\u91cd\u4e3a1</p> <p>\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a \u5047\u8bbe\u6709n\u4e2a\u771f\u5b9e\u670d\u52a1\u5668\uff0c\u6bcf\u4e2a\u670d\u52a1\u5668i\u7684\u6743\u91cd\u4e3aW i\uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u800c\u6d3b\u52a8\u8fde\u63a5C i \uff08i = 1\uff0c..\uff0cn\uff09\uff0cALL_CONNECTIONS\u662fC i\u7684\u603b\u548c \uff08i = 1\uff0c..\uff0cn\uff09\uff0c\u4e0b\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u5c06\u88ab\u5b9a\u5411\u5230\u670d\u52a1\u5668j\uff0c\u5176\u4e2d \uff08C j / ALL_CONNECTIONS\uff09/ W j = min {\uff08C i / ALL_CONNECTIONS\uff09/ W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u7531\u4e8eALL_CONNECTIONS\u5728\u6b64\u67e5\u627e\u4e2d\u662f\u5e38\u91cf\uff0c\u56e0\u6b64\u65e0\u9700\u5c06C i\u9664\u4ee5ALL_CONNECTIONS\uff0c\u5b83\u53ef\u4ee5\u4f18\u5316\u4e3a C j / W j = min {C i / W i }\uff08i = 1\uff0c..\uff0cn\uff09 \u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u9700\u8981\u6bd4\u6700\u5c0f\u8fde\u63a5\u66f4\u591a\u7684\u5212\u5206\u3002\u4e3a\u4e86\u5728\u670d\u52a1\u5668\u5177\u6709\u76f8\u540c\u7684\u5904\u7406\u80fd\u529b\u65f6\u6700\u5c0f\u5316\u8c03\u5ea6\u7684\u5f00\u9500\uff0c\u5b9e\u73b0\u6700\u5c11\u8fde\u63a5\u8c03\u5ea6\u548c\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5</p> <p>\u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u8c03\u5ea6\u7b97\u6cd5\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5982\u679c\u670d\u52a1\u5668\u5904\u4e8e\u6d3b\u52a8\u72b6\u6001\u4e14\u8d1f\u8f7d\u4e0d\u8db3\uff0c\u6b64\u7b97\u6cd5\u901a\u5e38\u4f1a\u5c06\u53d1\u5f80IP\u5730\u5740\u7684\u6570\u636e\u5305\u5b9a\u5411\u5230\u5176\u670d\u52a1\u5668\u3002\u5982\u679c\u670d\u52a1\u5668\u8fc7\u8f7d\uff08\u5176\u6d3b\u52a8\u8fde\u63a5\u6570\u5927\u4e8e\u5176\u6743\u91cd\uff09\u5e76\u4e14\u670d\u52a1\u5668\u5904\u4e8e\u534a\u8d1f\u8f7d\u72b6\u6001\uff0c\u5219\u5c06\u52a0\u6743\u6700\u5c0f\u8fde\u63a5\u670d\u52a1\u5668\u5206\u914d\u7ed9\u6b64IP\u5730\u5740</p> <p>\u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6 \u57fa\u4e8e\u4f4d\u7f6e\u7684\u6700\u5c0f\u8fde\u63a5\u4e0e\u590d\u5236\u8c03\u5ea6\u7b97\u6cd5\u4e5f\u7528\u4e8e\u76ee\u6807IP\u8d1f\u8f7d\u5e73\u8861\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u7f13\u5b58\u96c6\u7fa4\u3002\u5b83\u4e0eLBLC\u8c03\u5ea6\u7684\u4e0d\u540c\u4e4b\u5904\u5982\u4e0b\uff1a\u8d1f\u8f7d\u5747\u8861\u5668\u7ef4\u62a4\u4ece\u76ee\u6807\u5230\u53ef\u4ee5\u4e3a\u76ee\u6807\u670d\u52a1\u7684\u4e00\u7ec4\u670d\u52a1\u5668\u8282\u70b9\u7684\u6620\u5c04\u3002\u5bf9\u76ee\u6807\u7684\u8bf7\u6c42\u5c06\u5206\u914d\u7ed9\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6700\u5c0f\u8fde\u63a5\u8282\u70b9\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u8fc7\u8f7d\uff0c\u5b83\u5c06\u5728\u96c6\u7fa4\u4e2d\u83b7\u53d6\u6700\u5c11\u8fde\u63a5\u8282\u70b9\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u5230\u76ee\u6807\u670d\u52a1\u5668\u96c6\u4e2d\u3002\u5982\u679c\u670d\u52a1\u5668\u96c6\u672a\u5728\u6307\u5b9a\u65f6\u95f4\u5185\u8fdb\u884c\u4fee\u6539\uff0c\u5219\u4f1a\u4ece\u670d\u52a1\u5668\u96c6\u4e2d\u5220\u9664\u8d1f\u8f7d\u6700\u591a\u7684\u8282\u70b9\uff0c\u4ee5\u907f\u514d\u9ad8\u5ea6\u590d\u5236</p> <p>\u76ee\u7684\u5730\u54c8\u5e0c\u8c03\u5ea6 \u76ee\u6807\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u76ee\u6807IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5</p> <p>\u6e90\u54c8\u5e0c\u8c03\u5ea6 \u6e90\u54c8\u5e0c\u8c03\u5ea6\u7b97\u6cd5\u901a\u8fc7\u6309\u6e90IP\u5730\u5740\u67e5\u627e\u9759\u6001\u5206\u914d\u7684\u54c8\u5e0c\u8868\u6765\u4e3a\u670d\u52a1\u5668\u5206\u914d\u7f51\u7edc\u8fde\u63a5</p> <p>\u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6 \u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\u4ee5\u6700\u77ed\u7684\u9884\u671f\u5ef6\u8fdf\u5c06\u7f51\u7edc\u8fde\u63a5\u5206\u914d\u7ed9\u670d\u52a1\u5668\u3002\u5982\u679c\u53d1\u9001\u5230\u7b2ci\u4e2a\u670d\u52a1\u5668\uff0c\u4f5c\u4e1a\u5c06\u7ecf\u5386\u7684\u9884\u671f\u5ef6\u8fdf\u662f\uff08Ci + 1\uff09/ Ui\uff0c\u5176\u4e2dCi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u4e0a\u7684\u8fde\u63a5\u6570\uff0cUi\u662f\u7b2ci\u4e2a\u670d\u52a1\u5668\u7684\u56fa\u5b9a\u670d\u52a1\u901f\u7387\uff08\u6743\u91cd\uff09</p> <p>\u4ece\u4e0d\u6392\u961f\u8c03\u5ea6 \u6c38\u4e0d\u6392\u961f\u8c03\u5ea6\u7b97\u6cd5\u91c7\u7528\u53cc\u901f\u6a21\u578b\u3002\u5f53\u6709\u7a7a\u95f2\u670d\u52a1\u5668\u53ef\u7528\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u7a7a\u95f2\u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u5feb\u901f\u670d\u52a1\u5668\u3002\u5f53\u6ca1\u6709\u53ef\u7528\u7684\u7a7a\u95f2\u670d\u52a1\u5668\u65f6\uff0c\u4f5c\u4e1a\u5c06\u88ab\u53d1\u9001\u5230\u670d\u52a1\u5668\uff0c\u4ee5\u6700\u5c0f\u5316\u5176\u9884\u671f\u5ef6\u8fdf\uff08\u6700\u77ed\u9884\u671f\u5ef6\u8fdf\u8c03\u5ea6\u7b97\u6cd5\uff09</p> <p>LVS\u4e2dIP\u6216\u7f51\u7edc\u7684\u540d\u79f0</p> Text Only<pre><code>\u5178\u578b\u7684LVS-NAT\u8bbe\u7f6e\uff1aLVS-NAT: no arp problem (the realservers don't have the VIP)\n                        ________\n                       |        |\n                       | client | (local or on internet)\n                       |________|\n                          CIP\n                           |\n                        (router)\n                          DGW--DIRECTOR-gateway\n                           | outside network\n                           |\n                          VIP--Virtual IP\n                       ____|_____\n                      |          | (director can have 1 or 2 NICs)\n                      | director |\n                      |__________|\n                      DIP (and PIP)--primary director IP = PIP (the director which will be the master on bootup)\n                           |       --secondary director IP = SIP (the director which will be the backup on bootup)\n                           | DRIP network\n          ----------------------------------\n          |                |               |\n          |                |               |\n         RIP1             RIP2            RIP3\n     _____________   _____________   _____________\n    |             | |             | |             |\n    | realserver1 | | realserver2 | | realserver3 |\n    |_____________| |_____________| |_____________|\n\n\u5178\u578b\u7684LVS-DR or LVS-Tun\u8bbe\u7f6e\n                        ________\n                       |        |\n                       | client | (local or on internet)\n                       |________|\n                           |\n                        (router)-----------\n                           |    SERVER_GW  |\n                           |               |\n                          VIP              |\n                       ____|_____          |\n                      |          | (director can have 1 or 2 NICs)\n                      | director |         |\n                      |__________|         |\n                          DIP              |\n                           |               |\n                           |               |\n          -----------------+----------------\n          |                |               |\n          |                |               |\n       RIP1,VIP         RIP2,VIP        RIP3,VIP\n    ____________     ____________     ____________\n   |            |   |            |   |            |\n   | realserver |   | realserver |   | realserver |\n   |____________|   |____________|   |____________|\n\nclient IP     = CIP\nvirtual IP    = VIP - the IP on the director that the client connects to)\ndirector IP   = DIP - the IP on the director in the DIP/RIP (DRIP) network\n   (this is the realserver gateway for LVS-NAT)\nrealserver IP = RIP (and RIP1, RIP2...) the IP on the realserver\ndirector GW   = DGW - the director's gw (only needed for LVS-NAT)\n   (this can be the realserver gateway for LVS-DR and LVS-Tun)\n\nVIP\u548cDIP\u8bbe\u7f6e\u4e3a\u8f85\u52a9IP\uff08\u5373\u8be5NIC(\u7f51\u5361)\u4e0a\u6709\u53e6\u4e00\u4e2a\u4e3bIP\uff09\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728director\u6545\u969c\u8f6c\u79fb\u540e\u5c06\u5b83\u4eec\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u590d\u5236\u7684director\u3002\u5bf9\u4e8e\u4f7f\u7528\u5355\u4e2adirector\u7684\u521d\u59cb\u8bbe\u7f6e\uff0c\u5c06VIP\u548cDIP\u8bbe\u7f6e\u4e3a\u6b21\u8981IP\u5c06\u4f7f\u6545\u969c\u8f6c\u79fb\u8bbe\u7f6e\u66f4\u52a0\u5bb9\u6613\n</code></pre> DGW \u516c\u7f51IP\u7684\u9ed8\u8ba4\u7f51\u5173 VIP \u5ba2\u6237\u7aef\u8bbf\u95ee\u7684\u516c\u7f51IP\uff0cDirector\u7684\u865a\u62dfIP DIP Director\u7684\u771f\u5b9eIP RIP realserver\u7684IP RIP \u5ba2\u6237\u7aefIP <p>\u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-NAT\u8f6c\u53d1</p> Text Only<pre><code>\u5728direcotor\u4f7f\u7528\u4e00\u4e2a\u7f51\u5361\uff0c\u4e5f\u53ef\u4f7f\u7528\u4e24\u4e2a\uff0c\u4f46\u8981\u6539\u53d8\u8bbe\u7f6e\n                      ________\n                     |        |\n                     | client |\n                     |________|\n                  CIP=DGW=192.168.2.254 (eth0)\n                         |\n                         |\n           __________    |\n          |          |   |   (VIP=192.168.2.110,eth0:110)\n          | director |---|\n          |__________|   |   DIP=SGW=192.168.1.9(eth0)\n                         |\n                         |\n        -----------------------------------\n        |                                 |\n        |                                 |\nRIP=192.168.1.11(eth0)              RIP=192.168.1.12(eth0)\n   ____________                        ____________\n  |            |                      |            |\n  | realserver |                      | realserver |\n  |____________|                      |____________|\n</code></pre> <p>\u4f8b\u5b50\uff1aLVS\u4f7f\u7528LVS-DR\u8f6c\u53d1</p> Text Only<pre><code>\u5728\u5177\u6709\u5355\u4e2aNIC\u7684\u8ba1\u7b97\u673a\u4e0a\u4f7f\u7528\u5355\u4e2a\u7f51\u7edc\uff08\u6b64\u5904\u4e3a192.168.1.0/24\uff09\u8bbe\u7f6eLVS\u3002\u4ee5\u592a\u7f51\u522b\u540d\u4e0a\u7684IP\uff08\u4f8b\u5982eth0\uff1a110\uff0clo\uff1a0\uff09\u7531configure\u811a\u672c\u8bbe\u7f6e\u3002\u6ca1\u6709\u9ed8\u8ba4\u8def\u7531\uff0c\u5e76\u4e14\u6240\u6709\u8ba1\u7b97\u673a\u90fd\u5e94\u8be5\u80fd\u591f\u76f8\u4e92ping\u901a\n                        ________\n                       |        |\n                       | client |\n                       |________|\n                   CIP=SGW=192.168.1.254 (eth0)\n                           |\n                           |\n             __________    |\n            |          |   |   (VIP=192.168.1.110, eth0:110)\n            | director |---|\n            |__________|   |   DIP=192.168.1.9 (eth0)\n                           |\n                           |\n          -----------------------------------\n          |                                 |\n          |                                 |\n RIP=192.168.1.11(eth0)             RIP=192.168.1.12(eth0)\n(VIP=192.168.1.110, lo:0)          (VIP=192.168.1.110, lo:0)\n    ____________                       ____________\n   |            |                     |            |\n   | realserver |                     | realserver |\n   |____________|                     |____________|\n</code></pre>"},{"location":"lbha/LVS/#lvskeepalived","title":"LVS+Keepalived\u89e3\u51b3\u65b9\u6848\u5b98\u65b9\u793a\u4f8b","text":"<p>\u4f7f\u7528keepalived\u6784\u5efa\u4e00\u4e2a\u5177\u6709\u4e24\u4e2a\u8d1f\u8f7d\u5e73\u8861\u5668\u548c\u4e09\u4e2aWeb\u670d\u52a1\u5668\u7684\u9ad8\u53ef\u7528\u6027VS/NAT Web\u96c6\u7fa4\uff0c\u62d3\u6251\u56fe\u5982\u4e0b\uff1a  \u5728\u672c\u4f8b\u4e2d\uff0cVIP\u5730\u5740\u548cDIP\u5730\u5740\u5206\u522b\u4e3a10.23.8.80\u548c172.18.1.254\u5747\u4e3a\u6d6e\u52a8IP\uff0c\u5b83\u4eec\u5728\u4e24\u4e2a\u8d1f\u8f7d\u5747\u8861\u5668\uff08LD1\u548cLD2\uff09\u4e4b\u95f4\u6d6e\u52a8\uff0c\u4e09\u4e2arealserver\u7684IP\u5730\u5740\u4e3a172.18.1.11,172.18.1.12\u548c172.18.1.13 float IP\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\u56fe\uff1a  LD1\u4e0a\u7684keepalived\u914d\u7f6e\u6587\u4ef6\uff08/etc/keepalived/keepalived.conf\uff09\u5982\u4e0b:</p> Text Only<pre><code>vrrp_sync_group VG1 {\n    group {\n        VI_1\n        VI_2\n    }\n}\n\nvrrp_instance VI_1 {\n    state MASTER\n    interface eth0\n    virtual_router_id 51\n    priority 100\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n        10.23.8.80\n    }\n}\n\nvrrp_instance VI_2 {\n    state MASTER\n    interface eth1\n    virtual_router_id 51\n    priority 100\n    advert_int 1\n    authentication {\n        auth_type PASS\n        auth_pass 1111\n    }\n    virtual_ipaddress {\n        172.18.1.254\n    }\n}\n\nvirtual_server 10.23.8.80 80 {\n    delay_loop 6\n    lb_algo wlc\n    lb_kind NAT\n    persistence_timeout 600\n    protocol TCP\n\n    real_server 172.18.1.11 80 {\n        weight 100\n        TCP_CHECK {\n            connect_timeout 3\n        }\n    }\n    real_server 172.18.1.12 80 {\n        weight 100\n        TCP_CHECK {\n            connect_timeout 3\n        }\n    }\n    real_server 172.18.1.13 80 {\n        weight 100\n        TCP_CHECK {\n            connect_timeout 3\n        }\n    }\n}\nLD2\u7684\u548cLD1\u76f8\u4f3c\uff0c\u53ea\u9700\u5c06VI_1\u548cVI_2\u7684\u72b6\u6001\u4ecemaster\u6539\u4e3abackup\n</code></pre>"},{"location":"lbha/LVS/#keepalived","title":"Keepalived\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3","text":"Text Only<pre><code># \u5168\u5c40\u5b9a\u4e49\u6a21\u5757\nglobal_defs {\n   notification_email {\n     acassen@firewall.loc\n     failover@firewall.loc\n     sysadmin@firewall.loc #\u90ae\u4ef6\u62a5\u8b66\n   }\n   notification_email_from Alexandre.Cassen@firewall.loc \u6307\u5b9a\u53d1\u4ef6\u4eba\n   smtp_server 192.168.200.1  #\u6307\u5b9asmtp\u670d\u52a1\u5668\u5730\u5740\n   smtp_connect_timeout 30    \u6307\u5b9asmtp\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\n   router_id LVS_DEVEL  #\u8d1f\u8f7d\u5747\u8861\u6807\u8bc6\uff0c\u5728\u5c40\u57df\u7f51\u5185\u5e94\u8be5\u662f\u552f\u4e00\u7684\n   vrrp_skip_check_adv_addr\n   vrrp_strict\n   vrrp_garp_interval 0\n   vrrp_gna_interval 0\n}\n\n\u8bf4\u660e\uff1a\nnotification_email\uff1a\u6307\u5b9a\u5f53keepalived\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u53d1\u9001\u90ae\u4ef6\u7ed9\u54ea\u4e9b\u7528\u6237\nnotification_emai_from\uff1a\u53d1\u9001\u90ae\u4ef6\u65f6\uff0c\u90ae\u4ef6\u7684\u6765\u6e90\u5730\u5740\nsmtp_server &lt;DOMAIN|IP&gt; [&lt;PORT&gt;]\uff1asmtp\u670d\u52a1\u5668\u7684\u5730\u5740\u6216\u57df\u540d\u3002\u9ed8\u8ba4\u7aef\u53e3\u4e3a25.\u5982\uff1asmtp_server smtp.felix.com 25\nsmtp_helo_name &lt;HOST_NAME&gt;\uff1a\u6307\u5b9a\u5728HELO\u6d88\u606f\u4e2d\u6240\u4f7f\u7528\u7684\u540d\u79f0\u3002\u9ed8\u8ba4\u4e3a\u672c\u5730\u4e3b\u673a\u540d\nsmtp_connect_timeout\uff1a\u6307\u5b9asmtp\u670d\u52a1\u5668\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u5355\u4f4d\u662f\u79d2\n\nrouter_id\uff1a\u6307\u5b9a\u6807\u8bc6\u8be5\u673a\u5668\u7684route_id. \u5982\uff1aroute_id LVS_01\nvrrp_mcast_group4 224.0.0.18\uff1a\u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u4f7f\u7528\u7684IPV4\u7ec4\u64ad\u5730\u5740\u3002\u9ed8\u8ba4\u662f224.0.0.18\nvrrp_mcast_group6 ff02::12 \u6307\u5b9a\u53d1\u9001VRRP\u7ec4\u64ad\u6d88\u606f\u6240\u4f7f\u7528\u7684IPV6\u7ec4\u64ad\u5730\u5740\u3002\u9ed8\u8ba4\u662fff02::12\ndefault_interface eth0\uff1a\u8bbe\u7f6e\u9759\u6001\u5730\u5740\u9ed8\u8ba4\u7ed1\u5b9a\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u662feth0\nlvs_sync_daemon &lt;INTERFACE&gt; &lt;VRRP_INSTANCE&gt; [id &lt;SYNC_ID&gt;] [maxlen &lt;LEN&gt;] [port &lt;PORT&gt;] [ttl &lt;TTL&gt;] [group &lt;IP ADDR&gt;]\n    \u8bbe\u7f6eLVS\u540c\u6b65\u670d\u52a1\u7684\u76f8\u5173\u5185\u5bb9\u3002\u53ef\u4ee5\u540c\u6b65LVS\u7684\u72b6\u6001\u4fe1\u606f\n    INTERFACE\uff1a\u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684\u63a5\u53e3\n    VRRP_INSTANCE\uff1a\u6307\u5b9a\u540c\u6b65\u670d\u52a1\u7ed1\u5b9a\u7684VRRP\u5b9e\u4f8b\n    id &lt;SYNC_ID&gt;\uff1a\u6307\u5b9a\u540c\u6b65\u670d\u52a1\u6240\u4f7f\u7528\u7684SYNCID\uff0c\u53ea\u6709\u76f8\u540c\u7684SYNCID\u624d\u4f1a\u540c\u6b65\u3002\u8303\u56f4\u662f0-255.\n    maxlen\uff1a\u6307\u5b9a\u6570\u636e\u5305\u7684\u6700\u5927\u957f\u5ea6\u3002\u8303\u56f4\u662f1-65507\n    port\uff1a\u6307\u5b9a\u540c\u6b65\u6240\u4f7f\u7528\u7684UDP\u7aef\u53e3\n    group\uff1a\u6307\u5b9a\u7ec4\u64adIP\u5730\u5740\n\nlvs_flush\uff1a\u5728keepalived\u542f\u52a8\u65f6\uff0c\u5237\u65b0\u6240\u6709\u5df2\u7ecf\u5b58\u5728\u7684LVS\u914d\u7f6e\nvrrp_garp_master_delay 10\uff1a\u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6\uff0c\u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP\u3002\u9ed8\u8ba4\u4e3a5s\uff0c0\u8868\u793a\u4e0d\u53d1\u9001\u7b2c\u4e8c\u7ec4\u514d\u7684\u514d\u8d39ARP\nvrrp_garp_master_repeat 1\uff1a\u5f53\u8f6c\u6362\u4e3aMASTER\u72b6\u6001\u65f6\uff0c\u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf\u3002\u9ed8\u8ba4\u662f5.\nvrrp_garp_lower_prio_delay 10\uff1a\u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6\uff0c\u5ef6\u8fdf\u591a\u5c11\u79d2\u53d1\u9001\u7b2c\u4e8c\u7ec4\u7684\u514d\u8d39ARP\nvrrp_garp_lower_prio_repeat 1\uff1a\u5f53MASTER\u6536\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\u65f6\uff0c\u5728\u4e00\u7ec4\u4e2d\u4e00\u6b21\u53d1\u9001\u7684\u514d\u8d39ARP\u6570\u91cf\nvrrp_garp_master_refresh 60\uff1a\u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e\uff0c\u5237\u65b0\u514d\u8d39ARP\u7684\u6700\u5c0f\u65f6\u95f4\u95f4\u9694(\u4f1a\u518d\u6b21\u53d1\u9001\u514d\u8d39ARP)\u3002\u9ed8\u8ba4\u662f0\uff0c\u8868\u793a\u4e0d\u4f1a\u5237\u65b0\nvrrp_garp_master_refresh_repeat 2\uff1a \u5f53keepalived\u6210\u4e3aMASTER\u4ee5\u540e\uff0c\u6bcf\u6b21\u5237\u65b0\u4f1a\u53d1\u9001\u591a\u5c11\u4e2a\u514d\u8d39ARP\u3002\u9ed8\u8ba4\u662f1.\nvrrp_garp_interval 0.001\uff1a\u5728\u4e00\u4e2a\u63a5\u53e3\u53d1\u9001\u7684\u4e24\u4e2a\u514d\u8d39ARP\u4e4b\u95f4\u7684\u5ef6\u8fdf\u3002\u53ef\u4ee5\u7cbe\u786e\u5230\u6beb\u79d2\u7ea7\u3002\u9ed8\u8ba4\u662f0.\nvrrp_lower_prio_no_advert true|false\uff1a\u9ed8\u8ba4\u662ffalse\u3002\u5982\u679c\u6536\u5230\u4f4e\u4f18\u5148\u7ea7\u7684\u901a\u544a\uff0c\u4e0d\u53d1\u9001\u4efb\u4f55\u901a\u544a\nvrrp_version 2|3\uff1a\u8bbe\u7f6e\u9ed8\u8ba4\u7684VRRP\u7248\u672c\u3002\u9ed8\u8ba4\u662f2.\nvrrp_check_unicast_src\uff1a\u5728\u5355\u64ad\u6a21\u5f0f\u4e2d\uff0c\u5f00\u542f\u5bf9VRRP\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u505a\u68c0\u67e5\uff0c\u6e90\u5730\u5740\u5fc5\u987b\u662f\u5355\u64ad\u90bb\u5c45\u4e4b\u4e00\nvrrp_skip_check_adv_addr\uff1a\u9ed8\u8ba4\u662f\u4e0d\u8df3\u8fc7\u68c0\u67e5\u3002\u68c0\u67e5\u6536\u5230\u7684VRRP\u901a\u544a\u4e2d\u7684\u6240\u6709\u5730\u5740\u53ef\u80fd\u4f1a\u6bd4\u8f83\u8017\u65f6\uff0c\u8bbe\u7f6e\u6b64\u547d\u4ee4\u7684\u610f\u601d\u662f\uff0c\u5982\u679c\u901a\u544a\u4e0e\u63a5\u6536\u7684\u4e0a\u4e00\u4e2a\u901a\u544a\u6765\u81ea\u76f8\u540c\u7684master\u8def\u7531\u5668\uff0c\u5219\u4e0d\u6267\u884c\u68c0\u67e5(\u8df3\u8fc7\u68c0\u67e5)\nvrrp_strict\uff1a\u4e25\u683c\u9075\u5b88VRRP\u534f\u8bae\u3002\u4e0b\u5217\u60c5\u51b5\u5c06\u4f1a\u963b\u6b62\u542f\u52a8Keepalived\uff1a1. \u6ca1\u6709VIP\u5730\u5740\u30022. \u5355\u64ad\u90bb\u5c45\u30023. \u5728VRRP\u7248\u672c2\u4e2d\u6709IPv6\u5730\u5740\n\nvrrp_iptables\uff1a\u4e0d\u6dfb\u52a0\u4efb\u4f55iptables\u89c4\u5219\u3002\u9ed8\u8ba4\u662f\u6dfb\u52a0iptables\u89c4\u5219\u7684\n\n\u5982\u679cvrrp\u8fdb\u7a0b\u6216check\u8fdb\u7a0b\u8d85\u65f6\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u76844\u4e2a\u9009\u9879\u3002\u53ef\u4ee5\u4f7f\u5904\u4e8eBACKUP\u72b6\u6001\u7684VRRP\u5b9e\u4f8b\u53d8\u6210MASTER\u72b6\u6001\uff0c\u5373\u4f7fMASTER\u5b9e\u4f8b\u4f9d\u7136\u5728\u8fd0\u884c\u3002\u56e0\u4e3aMASTER\u6216BACKUP\u7cfb\u7edf\u6bd4\u8f83\u6162\uff0c\u4e0d\u80fd\u53ca\u65f6\u5904\u7406VRRP\u6570\u636e\u5305\nvrrp_priority &lt;-20 -- 19&gt;\uff1a\u8bbe\u7f6eVRRP\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\nchecker_priority &lt;-20 -- 19&gt;\uff1a\u8bbe\u7f6echecker\u8fdb\u7a0b\u7684\u4f18\u5148\u7ea7\nvrrp_no_swap\uff1avrrp\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362\nchecker_no_swap\uff1achecker\u8fdb\u7a0b\u4e0d\u80fd\u591f\u88ab\u4ea4\u6362\n\nscript_user &lt;username&gt; [groupname]\uff1a\u8bbe\u7f6e\u8fd0\u884c\u811a\u672c\u9ed8\u8ba4\u7528\u6237\u548c\u7ec4\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\uff0c\u5219\u9ed8\u8ba4\u7528\u6237\u4e3akeepalived_script(\u9700\u8981\u8be5\u7528\u6237\u5b58\u5728)\uff0c\u5426\u5219\u4e3aroot\u7528\u6237\u3002\u9ed8\u8ba4groupname\u540cusername\nenable_script_security\uff1a\u5982\u679c\u811a\u672c\u8def\u5f84\u7684\u4efb\u4e00\u90e8\u5206\u5bf9\u4e8e\u975eroot\u7528\u6237\u6765\u8bf4\uff0c\u90fd\u5177\u6709\u53ef\u5199\u6743\u9650\uff0c\u5219\u4e0d\u4f1a\u4ee5root\u8eab\u4efd\u8fd0\u884c\u811a\u672c\nnopreempt \u9ed8\u8ba4\u662f\u62a2\u5360\u6a21\u5f0f \u8981\u662f\u7528\u975e\u62a2\u5360\u5f0f\u7684\u5c31\u52a0\u4e0anopreempt\n\u6ce8\u610f\uff1a\u4e0a\u8ff0\u4e3aglobal_defs\u4e2d\u7684\u6307\u4ee4\n</code></pre>"},{"location":"lbha/LVS/#vrrpd","title":"VRRPD\u914d\u7f6e\u5305\u542b\u5982\u4e0b\u5b50\u5757","text":"<ol> <li>vrrp_script</li> <li>vrrp_sync_group</li> <li>vrrp_instance</li> </ol> Text Only<pre><code>\u4f5c\u7528\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5468\u671f\u6027\u6267\u884c\u7684\u811a\u672c\u3002\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u7801\u4f1a\u88ab\u8c03\u7528\u5b83\u7684\u6240\u6709\u7684VRRP Instance\u8bb0\u5f55\n\u6ce8\u610f\uff1a\u81f3\u5c11\u6709\u4e00\u4e2aVRRP\u5b9e\u4f8b\u8c03\u7528\u5b83\u5e76\u4e14\u4f18\u5148\u7ea7\u4e0d\u80fd\u4e3a0.\u4f18\u5148\u7ea7\u8303\u56f4\u662f1-254.\nvrrp_script &lt;SCRIPT_NAME&gt; {\n          ...\n    }\n\n\u9009\u9879\u8bf4\u660e\uff1a\nscrip \"/path/to/somewhere\"\uff1a\u6307\u5b9a\u8981\u6267\u884c\u7684\u811a\u672c\u7684\u8def\u5f84\ninterval &lt;INTEGER&gt;\uff1a\u6307\u5b9a\u811a\u672c\u6267\u884c\u7684\u95f4\u9694\u3002\u5355\u4f4d\u662f\u79d2\u3002\u9ed8\u8ba4\u4e3a1s\ntimeout &lt;INTEGER&gt;\uff1a\u6307\u5b9a\u5728\u591a\u5c11\u79d2\u540e\uff0c\u811a\u672c\u88ab\u8ba4\u4e3a\u6267\u884c\u5931\u8d25\nweight &lt;-254 --- 254&gt;\uff1a\u8c03\u6574\u4f18\u5148\u7ea7\u3002\u9ed8\u8ba4\u4e3a2.\nrise &lt;INTEGER&gt;\uff1a\u6267\u884c\u6210\u529f\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u662f\u6210\u529f\nfall &lt;INTEGER&gt;\uff1a\u6267\u884c\u5931\u8d25\u591a\u5c11\u6b21\u624d\u8ba4\u4e3a\u5931\u8d25\nuser &lt;USERNAME&gt; [GROUPNAME]\uff1a\u8fd0\u884c\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4\ninit_fail\uff1a\u5047\u8bbe\u811a\u672c\u521d\u59cb\u72b6\u6001\u662f\u5931\u8d25\u72b6\u6001\n\n\u89e3\u91ca\uff1a\nweight\uff1a\n1. \u5982\u679c\u811a\u672c\u6267\u884c\u6210\u529f(\u9000\u51fa\u72b6\u6001\u7801\u4e3a0)\uff0cweight\u5927\u4e8e0\uff0c\u5219priority\u589e\u52a0\n2. \u5982\u679c\u811a\u672c\u6267\u884c\u5931\u8d25(\u9000\u51fa\u72b6\u6001\u7801\u4e3a\u975e0)\uff0cweight\u5c0f\u4e8e0\uff0c\u5219priority\u51cf\u5c11\n3. \u5176\u4ed6\u60c5\u51b5\u4e0b\uff0cpriority\u4e0d\u53d8\n</code></pre> Text Only<pre><code>\u4f5c\u7528\uff1a\u5c06\u6240\u6709\u76f8\u5173\u7684VRRP\u5b9e\u4f8b\u5b9a\u4e49\u5728\u4e00\u8d77\uff0c\u4f5c\u4e3a\u4e00\u4e2aVRRP Group\uff0c\u5982\u679c\u7ec4\u5185\u7684\u4efb\u610f\u4e00\u4e2a\u5b9e\u4f8b\u51fa\u73b0\u95ee\u9898\uff0c\u90fd\u53ef\u4ee5\u5b9e\u73b0Failover\n vrrp_sync_group VG_1 {\n    group {\n     inside_network     # vrrp instance name\n     outside_network    # vrrp instance name\n     ...\n    }\n    ...\n}\n\n\u8bf4\u660e\uff1a\n\u5982\u679cusername\u548cgroupname\u6ca1\u6709\u6307\u5b9a\uff0c\u5219\u4ee5\u9ed8\u8ba4\u7684script_user\u6240\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\n1. notify_master /path/to_master.sh [username [groupname]]\n    \u4f5c\u7528\uff1a\u5f53\u6210\u4e3aMASTER\u65f6\uff0c\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c\n2. notify_backup /path/to_backup.sh [username [groupname]]\n    \u4f5c\u7528\uff1a\u5f53\u6210\u4e3aBACKUP\u65f6\uff0c\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c\n3. notify_fault \"/path/fault.sh VG_1\" [username [groupname]]\n    \u4f5c\u7528\uff1a\u5f53\u8be5\u540c\u6b65\u7ec4Fault\u65f6\uff0c\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c\n4. notify /path/notify.sh [username [groupname]]\n    \u4f5c\u7528\uff1a\u5728\u4efb\u4f55\u72b6\u6001\u90fd\u4f1a\u4ee5\u6307\u5b9a\u7684\u7528\u6237\u548c\u7ec4\u6267\u884c\u811a\u672c\n    \u8bf4\u660e\uff1a\u8be5\u811a\u672c\u4f1a\u5728notify_*\u811a\u672c\u540e\u6267\u884c\n    notify\u53ef\u4ee5\u4f7f\u75283\u4e2a\u53c2\u6570\uff0c\u5982\u4e0b\uff1a\n    $1\uff1a\u53ef\u4ee5\u662fGROUP\u6216INTANCE\uff0c\u8868\u660e\u540e\u9762\u662f\u7ec4\u8fd8\u662f\u5b9e\u4f8b\n    $2\uff1a\u7ec4\u540d\u6216\u5b9e\u4f8b\u540d\n    $3\uff1a\u8f6c\u6362\u540e\u7684\u76ee\u6807\u72b6\u6001\u3002\u6709\uff1aMASTER\u3001BACKUP\u3001FAULT\n\n5. smtp_alert\uff1a\u5f53\u72b6\u6001\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u53d1\u9001\u90ae\u4ef6\n6. global_tracking\uff1a\u6240\u6709\u7684VRRP\u5b9e\u4f8b\u5171\u4eab\u76f8\u540c\u7684tracking\u914d\u7f6e\n\n\u6ce8\u610f\uff1a\u811a\u672c\u6587\u4ef6\u8981\u52a0\u4e0ax\u6743\u9650\uff0c\u540c\u65f6\u6307\u4ee4\u6700\u597d\u5199\u7edd\u5bf9\u8def\u5f84\n</code></pre> Text Only<pre><code>\u547d\u4ee4\u8bf4\u660e\uff1a\nstate MASTER|BACKUP\uff1a\u6307\u5b9a\u8be5keepalived\u8282\u70b9\u7684\u521d\u59cb\u72b6\u6001\ninterface eth0\uff1avrrp\u5b9e\u4f8b\u7ed1\u5b9a\u7684\u63a5\u53e3\uff0c\u7528\u4e8e\u53d1\u9001VRRP\u5305\nuse_vmac [&lt;VMAC_INTERFACE&gt;]\uff1a\u5728\u6307\u5b9a\u7684\u63a5\u53e3\u4ea7\u751f\u4e00\u4e2a\u5b50\u63a5\u53e3\uff0c\u5982vrrp.51\uff0c\u8be5\u63a5\u53e3\u7684MAC\u5730\u5740\u4e3a\u7ec4\u64ad\u5730\u5740\uff0c\u901a\u8fc7\u8be5\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u5305\nvmac_xmit_base\uff1a\u901a\u8fc7\u57fa\u672c\u63a5\u53e3\u5411\u5916\u53d1\u9001\u548c\u63a5\u6536VRRP\u6570\u636e\u5305\uff0c\u800c\u4e0d\u662f\u901a\u8fc7VMAC\u63a5\u53e3\nnative_ipv6\uff1a\u5f3a\u5236VRRP\u5b9e\u4f8b\u4f7f\u7528IPV6.(\u5f53\u540c\u65f6\u914d\u7f6e\u4e86IPV4\u548cIPV6\u7684\u65f6\u5019)\ndont_track_primary\uff1a\u5ffd\u7565VRRP\u63a5\u53e3\u7684\u9519\u8bef\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u914d\u7f6e\u7684\n\ntrack_interface {\n  eth0\n  eth1 weight &lt;-254-254&gt;\n  ...\n}\uff1a\u5982\u679ctrack\u7684\u63a5\u53e3\u6709\u4efb\u4f55\u4e00\u4e2a\u51fa\u73b0\u6545\u969c\uff0c\u90fd\u4f1a\u8fdb\u5165FAULT\u72b6\u6001\n\ntrack_script {\n  &lt;SCRIPT_NAME&gt;\n  &lt;SCRIPT_NAME&gt; weight &lt;-254-254&gt;\n}\uff1a\u6dfb\u52a0\u4e00\u4e2atrack\u811a\u672c(vrrp_script\u914d\u7f6e\u7684\u811a\u672c\u3002)\n\nmcast_src_ip &lt;IPADDR&gt;\uff1a\u6307\u5b9a\u53d1\u9001\u7ec4\u64ad\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740\u3002\u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740\nunicast_src_ip &lt;IPADDR&gt;\uff1a\u6307\u5b9a\u53d1\u9001\u5355\u8584\u6570\u636e\u5305\u7684\u6e90IP\u5730\u5740\u3002\u9ed8\u8ba4\u662f\u7ed1\u5b9aVRRP\u5b9e\u4f8b\u7684\u63a5\u53e3\u7684\u4e3bIP\u5730\u5740\nversion 2|3\uff1a\u6307\u5b9a\u8be5\u5b9e\u4f8b\u6240\u4f7f\u7528\u7684VRRP\u7248\u672c\n\nunicast_peer {\n   &lt;IPADDR&gt;\n   ...\n}\uff1a\u91c7\u7528\u5355\u64ad\u7684\u65b9\u5f0f\u53d1\u9001VRRP\u901a\u544a\uff0c\u6307\u5b9a\u5355\u64ad\u90bb\u5c45\u7684IP\u5730\u5740\n\nvirtual_router_id 51\uff1a\u6307\u5b9aVRRP\u5b9e\u4f8bID\uff0c\u8303\u56f4\u662f0-255.\npriority 100\uff1a\u6307\u5b9a\u4f18\u5148\u7ea7\uff0c\u4f18\u5148\u7ea7\u9ad8\u7684\u5c06\u6210\u4e3aMASTER\nadvert_int 1\uff1a\u6307\u5b9a\u53d1\u9001VRRP\u901a\u544a\u7684\u95f4\u9694\u3002\u5355\u4f4d\u662f\u79d2\nauthentication {\n  auth_type PASS|AH\uff1a\u6307\u5b9a\u8ba4\u8bc1\u65b9\u5f0f\u3002PASS\u7b80\u5355\u5bc6\u7801\u8ba4\u8bc1(\u63a8\u8350),AH:IPSEC\u8ba4\u8bc1(\u4e0d\u63a8\u8350)\n  auth_pass 1234\uff1a\u6307\u5b9a\u8ba4\u8bc1\u6240\u4f7f\u7528\u7684\u5bc6\u7801\u3002\u6700\u591a8\u4f4d\n}\n\nvirtual_ipaddress {\n   &lt;IPADDR&gt;/&lt;MASK&gt; brd &lt;IPADDR&gt; dev &lt;STRING&gt; scope &lt;SCOPE&gt; label &lt;LABEL&gt;\n   192.168.200.17/24 dev eth1\n   192.168.200.18/24 dev eth2 label eth2:1\n}\uff1a\u6307\u5b9aVIP\u5730\u5740\n\nnopreempt\uff1a\u8bbe\u7f6e\u4e3a\u4e0d\u62a2\u5360\u3002\u9ed8\u8ba4\u662f\u62a2\u5360\u7684\uff0c\u5f53\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6062\u590d\u540e\uff0c\u4f1a\u62a2\u5360\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u6210\u4e3aMASTER\uff0c\u800c\u4e0d\u62a2\u5360\uff0c\u5219\u5141\u8bb8\u4f4e\u4f18\u5148\u7ea7\u7684\u673a\u5668\u7ee7\u7eed\u6210\u4e3aMASTER\uff0c\u5373\u4f7f\u9ad8\u4f18\u5148\u7ea7\u7684\u673a\u5668\u5df2\u7ecf\u4e0a\u7ebf\u3002\u5982\u679c\u8981\u4f7f\u7528\u8fd9\u4e2a\u529f\u80fd\uff0c\u5219\u521d\u59cb\u5316\u72b6\u6001\u5fc5\u987b\u4e3aBACKUP\npreempt_delay\uff1a\u8bbe\u7f6e\u62a2\u5360\u5ef6\u8fdf\u3002\u5355\u4f4d\u662f\u79d2\uff0c\u8303\u56f4\u662f0---1000\uff0c\u9ed8\u8ba4\u662f0.\u53d1\u73b0\u4f4e\u4f18\u5148\u7ea7\u7684MASTER\u540e\u591a\u5c11\u79d2\u5f00\u59cb\u62a2\u5360\n\n\n\u901a\u77e5\u811a\u672c\uff1a\nnotify_master &lt;STRING&gt;|&lt;QUOTED-STRING&gt; [username [groupname]]\nnotify_backup &lt;STRING&gt;|&lt;QUOTED-STRING&gt; [username [groupname]]\nnotify_fault &lt;STRING&gt;|&lt;QUOTED-STRING&gt; [username [groupname]]\nnotify &lt;STRING&gt;|&lt;QUOTED-STRING&gt; [username [groupname]]\n\n# \u5f53\u505c\u6b62VRRP\u65f6\u6267\u884c\u7684\u811a\u672c\nnotify_stop &lt;STRING&gt;|&lt;QUOTED-STRING&gt; [username [groupname]]\nsmtp_alert\n</code></pre>"},{"location":"lbha/LVS/#lvs","title":"LVS\u914d\u7f6e","text":"Text Only<pre><code>virtual_server IP Port | virtual_server fwmark int | virtual_server group string {\n  delay_loop &lt;INT&gt;\uff1a\u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4\u95f4\u9694\n  lb_argo rr|wrr|lc|wlc|lblc|sh|dh\uff1aLVS\u8c03\u5ea6\u7b97\u6cd5\n  lb_kind NAT|DR|TUN\uff1aLVS\u6a21\u5f0f\n  persistence_timeout 360\uff1a\u6301\u4e45\u5316\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2\u3002\u9ed8\u8ba4\u662f6\u5206\u949f\n  persistence_granularity\uff1a\u6301\u4e45\u5316\u8fde\u63a5\u7684\u9897\u7c92\u5ea6\n  protocol TCP|UDP|SCTP\uff1a4\u5c42\u534f\u8bae\n  ha_suspend\uff1a\u5982\u679cvirtual server\u7684IP\u5730\u5740\u6ca1\u6709\u8bbe\u7f6e\uff0c\u5219\u4e0d\u8fdb\u884c\u540e\u7aef\u670d\u52a1\u5668\u7684\u5065\u5eb7\u68c0\u67e5\n  virtualhost &lt;STRING&gt;\uff1a\u4e3aHTTP_GET\u548cSSL_GET\u6267\u884c\u8981\u68c0\u67e5\u7684\u865a\u62df\u4e3b\u673a\u3002\u5982virtualhost www.felix.com\n  sorry_server &lt;IPADDR&gt; &lt;PORT&gt;\uff1a\u6dfb\u52a0\u4e00\u4e2a\u5907\u7528\u670d\u52a1\u5668\u3002\u5f53\u6240\u6709\u7684RS\u90fd\u6545\u969c\u65f6\n  sorry_server_inhibit\uff1a\u5c06inhibit_on_failure\u6307\u4ee4\u5e94\u7528\u4e8esorry_server\u6307\u4ee4\n\n  alpha\uff1a\u5728keepalived\u542f\u52a8\u65f6\uff0c\u5047\u8bbe\u6240\u6709\u7684RS\u90fd\u662fdown\uff0c\u4ee5\u53ca\u5065\u5eb7\u68c0\u67e5\u662f\u5931\u8d25\u7684\u3002\u6709\u52a9\u4e8e\u9632\u6b62\u542f\u52a8\u65f6\u7684\u8bef\u62a5\u3002\u9ed8\u8ba4\u662f\u7981\u7528\u7684\n  omega\uff1a\u5728keepalived\u7ec8\u6b62\u65f6\uff0c\u4f1a\u6267\u884cquorum_down\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u811a\u672c\n\n  quorum &lt;INT&gt;\uff1a\u9ed8\u8ba4\u503c1. \u6240\u6709\u7684\u5b58\u6d3b\u7684\u670d\u52a1\u5668\u7684\u603b\u7684\u6700\u5c0f\u6743\u91cd\n  quorum_up &lt;STRING&gt;\uff1a\u5f53quorum\u589e\u957f\u5230\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c\n  quorum_down &lt;STRING&gt;\uff1a\u5f53quorum\u51cf\u5c11\u5230\u4e0d\u6ee1\u8db3quorum\u6240\u5b9a\u4e49\u7684\u503c\u65f6\uff0c\u6267\u884c\u8be5\u811a\u672c\n}\n</code></pre> Text Only<pre><code>real_server IP Port {\n  weight &lt;INT&gt;\uff1a\u7ed9\u670d\u52a1\u5668\u6307\u5b9a\u6743\u91cd\u3002\u9ed8\u8ba4\u662f1.\n  inhibit_on_failure\uff1a\u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6\uff0c\u5c06\u5176weight\u8bbe\u7f6e\u4e3a0\uff0c\u800c\u4e0d\u662f\u4eceVirtual Server\u4e2d\u79fb\u9664\n  notify_up &lt;STRING&gt;\uff1a\u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u6210\u529f\u65f6\uff0c\u6267\u884c\u7684\u811a\u672c\n  notify_down &lt;STRING&gt;\uff1a\u5f53\u670d\u52a1\u5668\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\u65f6\uff0c\u6267\u884c\u7684\u811a\u672c\n  uthreshold &lt;INT&gt;\uff1a\u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5927\u8fde\u63a5\u6570\n  lthreshold &lt;INT&gt;\uff1a\u5230\u8fd9\u53f0\u670d\u52a1\u5668\u7684\u6700\u5c0f\u8fde\u63a5\u6570\n}\n\n# real_server\u4e2d\u7684\u5065\u5eb7\u68c0\u67e5\nHTTP_GET | SSL_GET {\nurl {\n  path &lt;STRING&gt;\uff1a\u6307\u5b9a\u8981\u68c0\u67e5\u7684URL\u7684\u8def\u5f84\u3002\u5982path / or path /mrtg2\n  digest &lt;STRING&gt;\uff1a\u6458\u8981\u3002\u8ba1\u7b97\u65b9\u5f0f\uff1agenhash -s 172.17.100.1 -p 80 -u /index.html\n  status_code &lt;INT&gt;\uff1a\u72b6\u6001\u7801\n}\nnb_get_retry &lt;INT&gt;\uff1aget\u5c1d\u8bd5\u6b21\u6570\ndelay_before_retry &lt;INT&gt;\uff1a\u5728\u5c1d\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u957f\u65f6\u95f4\n\nconnect_ip &lt;IP ADDRESS&gt;\uff1a\u8fde\u63a5\u7684IP\u5730\u5740\u3002\u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740\nconnect_port &lt;PORT&gt;\uff1a\u8fde\u63a5\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3\nbindto &lt;IP ADDRESS&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740\nbind_port &lt;PORT&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3\nconnect_timeout &lt;INT&gt;\uff1a\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba4\u662f5s\nfwmark &lt;INTEGER&gt;\uff1a\u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0\nwarmup &lt;INT&gt;\uff1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf\uff0c\u6700\u5927\u4e3aN\u79d2\u3002\u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e\u3002\u5982\u679c\u4e3a0\uff0c\u5219\u5173\u95ed\u8be5\u529f\u80fd\n}\n\nTCP_CHECK {\nconnect_ip &lt;IP ADDRESS&gt;\uff1a\u8fde\u63a5\u7684IP\u5730\u5740\u3002\u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740\nconnect_port &lt;PORT&gt;\uff1a\u8fde\u63a5\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3\nbindto &lt;IP ADDRESS&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740\nbind_port &lt;PORT&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3\nconnect_timeout &lt;INT&gt;\uff1a\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba4\u662f5s\nfwmark &lt;INTEGER&gt;\uff1a\u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0\nwarmup &lt;INT&gt;\uff1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf\uff0c\u6700\u5927\u4e3aN\u79d2\u3002\u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e\u3002\u5982\u679c\u4e3a0\uff0c\u5219\u5173\u95ed\u8be5\u529f\u80fd\nretry &lt;INIT&gt;\uff1a\u91cd\u8bd5\u6b21\u6570\u3002\u9ed8\u8ba4\u662f1\u6b21\ndelay_before_retry &lt;INT&gt;\uff1a\u9ed8\u8ba4\u662f1\u79d2\u3002\u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2\n}\n\n\nSMTP_CHECK {\nconnect_ip &lt;IP ADDRESS&gt;\uff1a\u8fde\u63a5\u7684IP\u5730\u5740\u3002\u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740\nconnect_port &lt;PORT&gt;\uff1a\u8fde\u63a5\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3\u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3\nbindto &lt;IP ADDRESS&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740\nbind_port &lt;PORT&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3\nconnect_timeout &lt;INT&gt;\uff1a\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba4\u662f5s\nfwmark &lt;INTEGER&gt;\uff1a\u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0\nwarmup &lt;INT&gt;\uff1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf\uff0c\u6700\u5927\u4e3aN\u79d2\u3002\u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e\u3002\u5982\u679c\u4e3a0\uff0c\u5219\u5173\u95ed\u8be5\u529f\u80fd\n\nretry &lt;INT&gt;\uff1a\u91cd\u8bd5\u6b21\u6570\ndelay_before_retry &lt;INT&gt;\uff1a\u5728\u91cd\u8bd5\u4e4b\u524d\u5ef6\u8fdf\u591a\u5c11\u79d2\nhelo_name &lt;STRING&gt;\uff1a\u7528\u4e8eSMTP HELO\u8bf7\u6c42\u7684\u5b57\u7b26\u4e32\n}\n\n\nDNS_CHECK {\nconnect_ip &lt;IP ADDRESS&gt;\uff1a\u8fde\u63a5\u7684IP\u5730\u5740\u3002\u9ed8\u8ba4\u662freal server\u7684ip\u5730\u5740\nconnect_port &lt;PORT&gt;\uff1a\u8fde\u63a5\u7684\u7aef\u53e3\u3002\u9ed8\u8ba4\u662freal server\u7684\u7aef\u53e3\u3002 \u9ed8\u8ba4\u662f25\u7aef\u53e3\nbindto &lt;IP ADDRESS&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u63a5\u53e3\u7684\u5730\u5740\nbind_port &lt;PORT&gt;\uff1a\u53d1\u8d77\u8fde\u63a5\u7684\u6e90\u7aef\u53e3\nconnect_timeout &lt;INT&gt;\uff1a\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba4\u662f5s\nfwmark &lt;INTEGER&gt;\uff1a\u4f7f\u7528fwmark\u5bf9\u6240\u6709\u51fa\u53bb\u7684\u68c0\u67e5\u6570\u636e\u5305\u8fdb\u884c\u6807\u8bb0\nwarmup &lt;INT&gt;\uff1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf\uff0c\u6700\u5927\u4e3aN\u79d2\u3002\u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e\u3002\u5982\u679c\u4e3a0\uff0c\u5219\u5173\u95ed\u8be5\u529f\u80fd\n\nretry &lt;INT&gt;\uff1a\u91cd\u8bd5\u6b21\u6570\u3002\u9ed8\u8ba4\u662f3\u6b21\ntype &lt;STRING&gt;\uff1aDNS query type\u3002A/NS/CNAME/SOA/MX/TXT/AAAA\nname &lt;STRING&gt;\uff1aDNS\u67e5\u8be2\u7684\u57df\u540d\u3002\u9ed8\u8ba4\u662f(.)\n}\n\n\n\nMISC_CHECK {\n misc_path &lt;STRING&gt;\uff1a\u5916\u90e8\u7684\u811a\u672c\u6216\u7a0b\u5e8f\u8def\u5f84\n misc_timeout &lt;INT&gt;\uff1a\u811a\u672c\u6267\u884c\u8d85\u65f6\u65f6\u95f4\n user USERNAME [GROUPNAME]\uff1a\u6307\u5b9a\u8fd0\u884c\u8be5\u811a\u672c\u7684\u7528\u6237\u548c\u7ec4\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9aGROUPNAME\uff0c\u5219GROUPNAME\u540cUSERNAME\n misc_dynamic\uff1a\u6839\u636e\u9000\u51fa\u72b6\u6001\u7801\u52a8\u6001\u8c03\u6574\u6743\u91cd\n  0\uff0c\u5065\u5eb7\u68c0\u67e5\u6210\u529f\uff0c\u6743\u91cd\u4e0d\u53d8\n  1\uff0c\u5065\u5eb7\u68c0\u67e5\u5931\u8d25\n  2-255\uff0c\u5065\u5eb7\u68c0\u67e5\u6210\u529f\u3002\u6743\u91cd\u8bbe\u7f6e\u4e3a\u9000\u51fa\u72b6\u6001\u7801\u51cf\u53bb2.\u5982\u9000\u51fa\u72b6\u6001\u7801\u662f250\uff0c\u5219\u6743\u91cd\u8c03\u6574\u4e3a248\n   warmup &lt;INT&gt;\uff1a\u6307\u5b9a\u4e00\u4e2a\u968f\u673a\u5ef6\u8fdf\uff0c\u6700\u5927\u4e3aN\u79d2\u3002\u53ef\u9632\u6b62\u7f51\u7edc\u963b\u585e\u3002\u5982\u679c\u4e3a0\uff0c\u5219\u5173\u95ed\u8be5\u529f\u80fd\n}\n</code></pre>"},{"location":"lbha/LVS/#keepalived_1","title":"\u4fee\u6539Keepalived\u65e5\u5fd7","text":"Text Only<pre><code># keepalived \u9ed8\u8ba4\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u7cfb\u7edf\u65e5\u5fd7/var/log/messages\u4e2d\nvi /etc/sysconfig/keepalived\n\n# Options for keepalived. See `keepalived --help'output and keepalived(8) and\n# keepalived.conf(5) man pages for a list of all options. Here are the most\n# common ones :\n#\n# --vrrp               -P    Only run with VRRP subsystem.\n# --check              -C    Only run with Health-checker subsystem.\n# --dont-release-vrrp  -V    Dont remove VRRP VIPs &amp; VROUTEs on daemon stop.\n# --dont-release-ipvs  -I    Dont remove IPVS topology on daemon stop.\n# --dump-conf          -d    Dump the configuration data.\n# --log-detail         -D    Detailed log messages.\n# --log-facility       -S    0-7 Set local syslog facility (default=LOG_DAEMON)(\u65e5\u5fd7\u7684\u7ea7\u522b)\n#\n\n# \u628a KEEPALIVED_OPTIONS=\u201d-D\u201d \u4fee\u6539\u4e3a KEEPALIVED_OPTIONS=\u201d-D -d -S 0\u201d\uff0c\u5176\u4e2d -S \u6307\u5b9a syslog \u7684 facility\nKEEPALIVED_OPTIONS=\"-D -d -S 0\"\n\n# \u4fee\u6539 /etc/rsyslog.conf \u672b\u5c3e\u6dfb\u52a0\nvi /etc/rsyslog.conf\nlocal0.*                                                /var/log/keepalived.log\n\n# \u91cd\u542f\u65e5\u5fd7\u8bb0\u5f55\u670d\u52a1\nsystemctl restart rsyslog\n\n# \u91cd\u542f keepalived\nsystemctl restart keepalived\n\n\u65e5\u5fd7\u7ea7\u522b\uff1a\u6307\u5b9a\u89e6\u53d1\u65e5\u5fd7\u4e8b\u4ef6\u7684\u7ea7\u522b\n</code></pre>"},{"location":"lbha/LVS/#lvs-natkeepalived","title":"LVS-NAT+Keepalived\u4e3b\u4ece\u90e8\u7f72\u793a\u4f8b","text":"<p>LVS-DR\u4fee\u6539virtual_server\u4e0blb_kind NAT\u53c2\u6570\u4e3alb_kind DR(LVS-DR\u4e3a\u5e38\u7528\u65b9\u5f0f)</p> IP\u5730\u5740 \u4e3b\u673a\u540d \u7c7b\u578b 1.1.1.10 LVS-Master VIP 192.168.1.10 LVS-Master DIP 1.1.1.20 LVS-Backup VIP 192.168.1.20 LVS-Backup DIP 192.168.1.100 Web-node1 realserver1 192.168.1.200 Web-node2 realserver2 1.1.1.131 client client <p>\u516c\u7f51\u6d6e\u52a8IP\uff1a1.1.1.1 \u5185\u7f51\u6d6e\u52a8IP\uff1a192.168.1.1</p> <p>eth0:1.1.1.10   ___________            ___________ VIP            |           |         |           |                | LVS-Master|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node1 |192.168.1.100                |___________|       /|_________| eth1:192.168.1.10  |               /| DIP                |              /  ________          |             / |        |         |            \\/ | client |\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014            /\\ |________|         |           /  \\                    |          /    \\                    |         /      \\ eth0:1.1.1.20   |____ /       \\/__________ VIP            |           |         |           |                | LVS-Backup|\u2014\u2014 \u2014\u2014 \u2014\u2014 \u2014| Web-node2 |192.168.1.200 DIP            |___________|         /|___________| eth1:192.168.1.20</p>"},{"location":"lbha/LVS/#lvsip","title":"LVS\u670d\u52a1\u5668\u4e0a\u914d\u7f6eIP","text":"Bash<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-eth0\nvim /etc/sysconfig/network-scripts/ifcfg-eth1\n\n# \u4fee\u6539\u5185\u6838\u53c2\u6570\nvim /etc/sysctl.conf\nnet.ipv4.ip_forward = 1\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.eth0.send_redirects = 0\nsysctl -p\n\n# realserver\u5206\u522b\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\n# \u7ed1\u5b9avip(centos6)\nifconfig lo:0 1.1.1.1 netmask 255.255.255.255 broadcast 1.1.1.1\n# (centos7)\nip a a 1.1.1.1/24 dev lo:0\n\n# arp\u6291\u5236\necho \"1\" &gt;/proc/sys/net/ipv4/conf/lo/arp_ignore\necho \"2\" &gt;/proc/sys/net/ipv4/conf/lo/arp_announce\necho \"1\" &gt;/proc/sys/net/ipv4/conf/all/arp_ignore\necho \"2\" &gt;/proc/sys/net/ipv4/conf/all/arp_announce\n# arp_ignore:\u5b9a\u4e49\u63a5\u6536\u5230ARP\u8bf7\u6c42\u65f6\u7684\u54cd\u5e94\u7ea7\u522b\n0\uff1a\u53ea\u8981\u672c\u5730\u914d\u7f6e\u7684\u6709\u5bf9\u5e94\u5730\u5740\uff0c\u5c31\u7ed9\u4e88\u56de\u5e94\uff1b\u9ed8\u8ba4\n1\uff1a\u4ec5\u5728\u8bf7\u6c42\u7684\u76ee\u7684\u5730\u5740\u914d\u7f6e\u5728\u5230\u8fbe\u7684\u63a5\u53e3\u4e0a\u65f6\uff0c\u624d\u7ed9\u4e88\u56de\u5e94\n\n# arp_announce\uff1a\u5b9a\u4e49\u5c06\u81ea\u5df1\u7684\u5730\u5740\u5411\u5916\u901a\u544a\u65f6\u7684\u901a\u544a\u7ea7\u522b\n0\uff1a\u5c06\u672c\u5730\u4efb\u4f55\u63a5\u53e3\u4e0a\u7684\u4efb\u4f55\u5730\u5740\u5411\u5916\u901a\u544a\uff1b\u9ed8\u8ba4\n1\uff1a\u8bd5\u56fe\u4ec5\u5411\u76ee\u6807\u7f51\u7edc\u901a\u544a\u5176\u7f51\u7edc\u5339\u914d\u7684\u5730\u5740\n2\uff1a\u4ec5\u5411\u4e0e\u672c\u5730\u63a5\u53e3\u4e0a\u5730\u5740\u5339\u914d\u7684\u7f51\u7edc\u8fdb\u884c\u901a\u544a\n\n# \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u76f8\u540c\u7684\u914d\u7f6e\u9879\nvrrp_instance VI_1\nvirtual_router_id 51\nauth_type PASS\nauth_pass 1111\nvirtual_ipaddress\n\n# \u5355\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u4e0d\u76f8\u540c\u7684\u914d\u7f6e\u9879\nrouter_id id1\nstate MASTER\npriority 100\n\n# \u4e0a\u8ff0\u7b80\u5316\u8bbe\u7f6e--\u5728realserver\u521b\u5efa\u811a\u672crs.sh\n#!/bin/bash\n#\u9002\u7528\u4e8ecentos6\nvip1=1.1.1.10\nvip2=1.1.1.20\ndev1=lo:1\ndev2=lo:2\ncase $1 in\nstart)\n    echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore\n    echo 1 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore\n    echo 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce\n    echo 2 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce\n    ifconfig $dev1 $vip1 netmask 255.255.255.255 broadcast $vip up\n    ifconfig $dev2 $vip2 netmask 255.255.255.255 broadcast $vip2 up\n    sysctl -p &gt;/dev/null 2&gt;&amp;1\n    echo \"VS Server is Ready!\"\n    ;;\nstop)\n    ifconfig $dev down\n    echo 0 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore\n    echo 0 &gt; /proc/sys/net/ipv4/conf/lo/arp_ignore\n    echo 0 &gt; /proc/sys/net/ipv4/conf/all/arp_announce\n    echo 0 &gt; /proc/sys/net/ipv4/conf/lo/arp_announce\n    echo \"VS Server is Cancel!\"\n    ;;\n*)\n    echo \"Usage `basename $0` start|stop\"\n    exit 1\n    ;;\nesac\n</code></pre>"},{"location":"lbha/LVS/#lvskeepalived_1","title":"LVS\u670d\u52a1\u5668\u4e0a\u5206\u522b\u5b89\u88c5\u5e76\u914d\u7f6ekeepalived","text":""},{"location":"lbha/LVS/#lvskeepalivedconf","title":"\u4e3bLVS\u914d\u7f6ekeepalived.conf","text":"Bash<pre><code>global_defs {\n    notification_email {\n         your_email@qq.com   # \u90ae\u4ef6\u53d1\u751f\u76ee\u7684\u4eba\n       }\n    notification_email_from keepalived@localhost\n    smtp_server 127.0.0.1 #\u672c\u673a\u90ae\u4ef6\u670d\u52a1\u5668\n    smtp_connect_timeout 30 #\u8d85\u65f6\u65f6\u95f4\n    router_id LVS_R1  # \u6807\u8bc6\u670d\u52a1\u5668ID\n}\n\nvrrp_sync_group VG1 {   # \u8bbe\u7f6e\u5b9e\u4f8b\u7ec4\n    group {\n        VI_1\n        VI_2\n    }\n}\n\nvrrp_instance VI_1 {    # \u5b9e\u4f8b\u540d\u79f0\uff0c\u5b9e\u4f8b\u53ef\u4ee5\u4e00\u4e2a\uff0c\u4e5f\u53ef\u591a\u4e2a\nstate MASTER    # \u4e3bLVS\u670d\u52a1\u5668\ninterface eth0  # \u7f51\u5361\u63a5\u53e3\nvirtual_router_id 1 # \u670d\u52a1\u5668id\npriority 100    # \u4f18\u5148\u7ea7(0~255)\nadvert_int 1    # \u5fc3\u8df3\u68c0\u6d4b1\u79d2\u6bcf\u6b21\nauthentication {    # \u8bbe\u7f6e\u9a8c\u8bc1\uff0cmaster\u548cbackup\u5fc5\u987b\u76f8\u540c\n    auth_type PASS  # \u57fa\u4e8e\u5bc6\u7801\u9a8c\u8bc1\u7c7b\u578b\n    auth_pass 1111  # \u5bc6\u7801\n}\nvirtual_ipaddress {\n    1.1.1.1 # \u516c\u7f51\u6d6e\u52a8IP\n }\n}\nvrrp_instance VI_2 {\nstate MASTER\ninterface eth1\nvirtual_router_id 1\npriority 100\nadvert_int 1\nauthentication {\n    auth_type PASS\n    auth_pass 1111\n}\nvirtual_ipaddress {\n    192.168.1.1 # \u5185\u7f51\u6d6e\u52a8IP\n }\n}\nvirtual_server 1.1.1.1 80 {\ndelay_loop 15   # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4\nlb_algo rr      # \u8c03\u5ea6\u7b97\u6cd5\nlb_kind NAT      # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u8c03\u5ea6\u65b9\u5f0f\nprotocol TCP\n    real_server 192.168.1.100 80 {\n        weight 1    # \u6743\u91cd\u503c\n        TCP_CHECK { # \u5065\u5eb7\u68c0\u67e5\u65b9\u5f0f\n            connect_port 80     # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3\n            connect_timeout 3   # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4\n            nb_get_retry 3      # \u91cd\u8bd5\u6b21\u6570\n            delay_before_retry 4  # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4\n        }\n    }\n    real_server 192.168.1.200 80 {\n        weight 1\n        TCP_CHECK {\n            connect_port 80\n            connect_timeout 3\n            nb_get_retry 3\n            delay_before_retry 4\n        }\n    }\n}\n</code></pre>"},{"location":"lbha/LVS/#lvs_1","title":"\u4eceLVS\u914d\u7f6e","text":"Bash<pre><code>global_defs {\nrouter_id LVS_R1\n}\n\nvrrp_sync_group VG1 {\n    group {\n        VI_1\n        VI_2\n    }\n}\n\nvrrp_instance VI_1 {\nstate BACKUP\ninterface eth0\nvirtual_router_id 1\npriority 90\nadvert_int 1\nauthentication {\n    auth_type PASS\n    auth_pass 1111\n}\nvirtual_ipaddress {\n    1.1.1.1\n }\n}\nvrrp_instance VI_2 {\nstate BACKUP\ninterface eth1\nvirtual_router_id 1\npriority 90\nadvert_int 1\nauthentication {\n    auth_type PASS\n    auth_pass 1111\n}\nvirtual_ipaddress {\n    192.168.1.1\n }\n}\nvirtual_server 1.1.1.1 80 {\ndelay_loop 15   # \u5065\u5eb7\u68c0\u67e5\u7684\u65f6\u95f4\nlb_algo rr      # \u8c03\u5ea6\u7b97\u6cd5\nlb_kind NAT      # \u8d1f\u8f7d\u5747\u8861\u7fa4\u96c6\u7684\u6a21\u5f0f\nprotocol TCP\n    real_server 192.168.1.100 80 {\n        weight 1    # \u6743\u91cd\u503c\n        TCP_CHECK {\n            connect_port 80     # \u68c0\u67e5\u76ee\u6807\u7aef\u53e3\n            connect_timeout 3   # \u94fe\u63a5\u8d85\u65f6\u65f6\u95f4\n            nb_get_retry 3      # \u91cd\u8bd5\u6b21\u6570\n            delay_before_retry 4  # \u91cd\u8bd5\u95f4\u9694\u65f6\u95f4\n        }\n    }\n    real_server 192.168.1.200 80 {\n        weight 1\n        TCP_CHECK {\n            connect_port 80\n            connect_timeout 3\n            nb_get_retry 3\n            delay_before_retry 4\n        }\n    }\n}\n</code></pre>"},{"location":"lbha/LVS/#lvs_notifysh","title":"\u521b\u5efa\u901a\u7528\u5355\u72ec\u7684\u68c0\u67e5\u90ae\u4ef6\u63d0\u9192\u811a\u672clvs_notify.sh","text":"Bash<pre><code>#!/bin/bash\ncontact='your_email_address'\n\nnotify() {\n    local mailsubject=\"$(hostname) to be $1, vip floating\"\n    local mailbody=\"$(date +'%F %T'): vrrp transition, $(hostname) changed to be $1\"\n    echo \"$mailbody\" | mail -s \"$mailsubject\" $contact\n}\n\ncase $1 in\nmaster)\n    notify master\n    ;;\nbackup)\n    notify backup\n    ;;\nfault)\n    notify fault\n    ;;\n*)\n    echo \"Usage: $(basename $0) {master|backup|fault}\"\n    exit 1\n    ;;\nesac\n</code></pre>"},{"location":"monitor/Elk/","title":"ELK Stack","text":"<p>Elasticsearch\u8fd1\u4e4e\u5b9e\u65f6(NRT)\u7684\u641c\u7d22\u5e73\u53f0\uff0c\u4ece\u7d22\u5f15\u6587\u6863\u5230\u53ef\u641c\u7d22\u6587\u6863\u7684\u65f6\u95f4\u6709\u4e00\u70b9\u5ef6\u8fdf(\u901a\u5e38\u662f\u4e00\u79d2)</p> <p>\u96c6\u7fa4\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\uff08\u670d\u52a1\u5668\uff09\u7684\u96c6\u5408\uff0c\u5b83\u4eec\u5171\u540c\u4fdd\u5b58\u60a8\u7684\u6574\u4e2a\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u8de8\u6240\u6709\u8282\u70b9\u7684\u8054\u5408\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u7fa4\u96c6\u7531\u552f\u4e00\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e3a\u201celasticsearch\u201d\u3002\u6b64\u540d\u79f0\u5f88\u91cd\u8981\uff0c\u56e0\u4e3a\u5982\u679c\u8282\u70b9\u8bbe\u7f6e\u4e3a\u6309\u540d\u79f0\u52a0\u5165\u7fa4\u96c6\uff0c\u5219\u8be5\u8282\u70b9\u53ea\u80fd\u662f\u7fa4\u96c6\u7684\u4e00\u90e8\u5206</p> <p>\u8282\u70b9\u662f\u4f5c\u4e3a\u7fa4\u96c6\u4e00\u90e8\u5206\u7684\u5355\u4e2a\u670d\u52a1\u5668\uff0c\u5b58\u50a8\u6570\u636e\u5e76\u53c2\u4e0e\u7fa4\u96c6\u7684\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u4e0e\u96c6\u7fa4\u4e00\u6837\uff0c\u8282\u70b9\u7531\u540d\u79f0\u6807\u8bc6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u540d\u79f0\u662f\u5728\u542f\u52a8\u65f6\u5206\u914d\u7ed9\u8282\u70b9\u7684\u968f\u673a\u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26\uff08UUID\uff09</p> <p>\u7d22\u5f15\u662f\u5177\u6709\u67d0\u4e9b\u7c7b\u4f3c\u7279\u5f81\u7684\u6587\u6863\u96c6\u5408\u3002\u6587\u6863\u662f\u53ef\u4ee5\u7f16\u5236\u7d22\u5f15\u7684\u57fa\u672c\u4fe1\u606f\u5355\u5143\u3002\u7d22\u5f15\u53ef\u80fd\u5b58\u50a8\u5927\u91cf\u53ef\u80fd\u8d85\u8fc7\u5355\u4e2a\u8282\u70b9\u7684\u786c\u4ef6\u9650\u5236\u7684\u6570\u636e\u3002\u521b\u5efa\u7d22\u5f15\u65f6\uff0c\u53ea\u9700\u5b9a\u4e49\u6240\u9700\u7684\u5206\u7247\u6570\u5373\u53ef\u3002\u6bcf\u4e2a\u5206\u7247\u672c\u8eab\u90fd\u662f\u4e00\u4e2a\u529f\u80fd\u9f50\u5168\u4e14\u72ec\u7acb\u7684\u201c\u7d22\u5f15\u201d\uff0c\u53ef\u4ee5\u6258\u7ba1\u5728\u96c6\u7fa4\u4e2d\u7684\u4efb\u4f55\u8282\u70b9\u4e0a</p> <p>\u5206\u7247Sharding\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a</p> <ul> <li>\u5b83\u5141\u8bb8\u60a8\u6c34\u5e73\u5206\u5272/\u7f29\u653e\u5185\u5bb9\u91cf</li> <li>\u5b83\u5141\u8bb8\u60a8\u8de8\u5206\u7247\uff08\u53ef\u80fd\u5728\u591a\u4e2a\u8282\u70b9\u4e0a\uff09\u5206\u5e03\u548c\u5e76\u884c\u5316\u64cd\u4f5c\uff0c\u4ece\u800c\u63d0\u9ad8\u6027\u80fd/\u541e\u5410\u91cf</li> </ul> <p>\u590d\u5236Replication\u5f88\u91cd\u8981\uff0c\u4e3b\u8981\u6709\u4e24\u4e2a\u539f\u56e0\uff1a</p> <ul> <li>\u5b83\u5728\u788e\u7247/\u8282\u70b9\u51fa\u73b0\u6545\u969c\u65f6\u63d0\u4f9b\u9ad8\u53ef\u7528\u6027\u3002\u56e0\u6b64\uff0c\u8bf7\u52a1\u5fc5\u6ce8\u610f\uff0c\u526f\u672c\u5206\u7247\u6c38\u8fdc\u4e0d\u4f1a\u5728\u4e0e\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb/\u4e3b\u5206\u7247\u76f8\u540c\u7684\u8282\u70b9\u4e0a\u5206\u914d</li> <li>\u5b83\u5141\u8bb8\u60a8\u6269\u5c55\u641c\u7d22\u91cf/\u541e\u5410\u91cf\uff0c\u56e0\u4e3a\u53ef\u4ee5\u5728\u6240\u6709\u526f\u672c\u4e0a\u5e76\u884c\u6267\u884c\u641c\u7d22</li> </ul> <p>\u603b\u800c\u8a00\u4e4b\uff0c\u6bcf\u4e2a\u7d22\u5f15\u53ef\u4ee5\u62c6\u5206\u4e3a\u591a\u4e2a\u5206\u7247\u3002\u7d22\u5f15\u4e5f\u53ef\u4ee5\u590d\u5236\u4e3a\u96f6\uff08\u8868\u793a\u6ca1\u6709\u526f\u672c\uff09\u6216\u66f4\u591a\u6b21\u3002\u590d\u5236\u540e\uff0c\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5c06\u5177\u6709\u4e3b\u5206\u7247\uff08\u4ece\u4e2d\u590d\u5236\u7684\u539f\u59cb\u5206\u7247\uff09\u548c\u526f\u672c\u5206\u7247\uff08\u4e3b\u5206\u7247\u7684\u526f\u672c\uff09\u3002\u53ef\u4ee5\u5728\u521b\u5efa\u7d22\u5f15\u65f6\u4e3a\u6bcf\u4e2a\u7d22\u5f15\u5b9a\u4e49\u5206\u7247\u548c\u526f\u672c\u7684\u6570\u91cf\u3002\u521b\u5efa\u7d22\u5f15\u540e\uff0c\u60a8\u53ef\u4ee5\u968f\u65f6\u52a8\u6001\u66f4\u6539\u526f\u672c\u6570\uff0c\u4f46\u4e0d\u80fd\u5728\u4e8b\u540e\u66f4\u6539\u5206\u7247\u6570</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cElasticsearch\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u90fd\u5206\u914d\u4e865\u4e2a\u4e3b\u5206\u7247\u548c1\u4e2a\u526f\u672c\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u7fa4\u96c6\u4e2d\u81f3\u5c11\u6709\u4e24\u4e2a\u8282\u70b9\uff0c\u5219\u7d22\u5f15\u5c06\u5305\u542b5\u4e2a\u4e3b\u5206\u7247\u548c\u53e6\u59165\u4e2a\u526f\u672c\u5206\u7247\uff081\u4e2a\u5b8c\u6574\u526f\u672c\uff09\uff0c\u603b\u8ba1\u4e3a\u6bcf\u4e2a\u7d22\u5f1510\u4e2a\u5206\u7247</p> Bash<pre><code>curl -X PUT \"localhost:9200/customer?pretty\"    #\u521b\u5efa\u540d\u4e3acustomer\u7684\u7d22\u5f15\n\ncurl -X GET \"localhost:9200/_cat/indices?v\"     #\u5217\u51fa\u6240\u6709\u7d22\u5f15\n</code></pre>"},{"location":"monitor/Monitors/","title":"\u5176\u4ed6\u76d1\u63a7\u5de5\u5177","text":""},{"location":"monitor/Monitors/#_2","title":"\u5c0f\u5de5\u5177\u96c6","text":"<p>htop--iftop--ntop</p>"},{"location":"monitor/Monitors/#opentsdb","title":"OpenTSDB","text":""},{"location":"monitor/Monitors/#tick","title":"TICK","text":""},{"location":"monitor/Prometheus/","title":"Prometheus","text":"Markdown<pre><code>prometheus\u7ec4\u4ef6\uff1a\nprometheus server\uff1a\u522e\u53d6\u5e76\u5b58\u50a8\u65f6\u95f4\u5e8f\u5217\u6570\u636e\nclient libraries\uff1a\u5ba2\u6237\u7aef\u5e93\u7528\u4e8e\u68c0\u6d4b\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\npushgateway\uff1a\u7528\u4e8e\u652f\u6301\u77ed\u671f\u5de5\u4f5c\u7684jobs\nexporters\uff1a\u7528\u4e8e\u8bf8\u5982Haproxy\u3001statsD\u3001Graphite\u7b49\u670d\u52a1\nalertmanager\uff1a\u5904\u7406\u8b66\u62a5\n\u5404\u79cd\u652f\u6301\u5de5\u5177\n</code></pre>"},{"location":"monitor/Zabbix/","title":"Zabbix","text":"Markdown<pre><code>zabbix\u51e0\u4e2a\u4e3b\u8981\u529f\u80fd\u7ec4\u4ef6\u5982\u4e0b\uff1a\nzabbix server\uff1a\u662f\u5176\u6838\u5fc3\u7ec4\u4ef6\uff0cagent \u5411\u5176\u62a5\u544a\u53ef\u7528\u6027\u3001\u7cfb\u7edf\u5b8c\u6574\u6027\u4fe1\u606f\u548c\u7edf\u8ba1\u4fe1\u606f\u3002server\u4e5f\u662f\u5b58\u50a8\u6240\u6709\u914d\u7f6e\u4fe1\u606f\u3001\u7edf\u8ba1\u4fe1\u606f\u548c\u64cd\u4f5c\u4fe1\u606f\u7684\u6838\u5fc3\u5b58\u50a8\u5e93\n\u6570\u636e\u5e93\uff1azabbix\u91c7\u96c6\u5230\u7684\u6570\u636e\u90fd\u5b58\u50a8\u5728\u6570\u636e\u5e93\nweb\u754c\u9762\uff1a\u8be5\u754c\u9762\u5c5e\u4e8ezabbix server\u7684\u4e00\u90e8\u5206\uff0c\u901a\u5e38(\u4e0d\u4e00\u5b9a)\u548czabbix server\u5728\u4e00\u53f0\u673a\u5668\u4e0a\u90e8\u7f72\nzabbix proxy\uff1a\u53ef\u4ee5\u4ee3\u7406zabbix server\u91c7\u96c6\u6027\u80fd\u548c\u53ef\u7528\u6027\u6570\u636e\uff0cproxy\u53ef\u4ee5\u5206\u62c5zabbix server\u7684\u8d1f\u8f7d\nzabbix agent\uff1a\u90e8\u7f72\u5728\u88ab\u76d1\u63a7\u76ee\u6807\u4e2d\uff0c\u7528\u4e8e\u4e3b\u52a8\u76d1\u63a7\u672c\u5730\u8d44\u6e90\u548c\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5c06\u6536\u96c6\u7684\u6570\u636e\u53d1\u9001\u7ed9zabbix server\u6216proxy\n\n\u4e86\u89e3\u4e0b Zabbix \u5185\u90e8\u7684\u6570\u636e\u6d41\u5bf9Zabbix\u7684\u4f7f\u7528\u4e5f\u5f88\u91cd\u8981\u3002\u9996\u5148\uff0c\u4e3a\u4e86\u521b\u5efa\u4e00\u4e2a\u91c7\u96c6\u6570\u636e\u7684\u76d1\u63a7\u9879\uff0c\u60a8\u5c31\u5fc5\u987b\u5148\u521b\u5efa\u4e3b\u673a\u3002\u5176\u6b21\uff0c\u5728\u4efb\u52a1\u7684\u53e6\u5916\u4e00\u7aef\uff0c\u5fc5\u987b\u8981\u6709\u76d1\u63a7\u9879\u624d\u80fd\u521b\u5efa\u89e6\u53d1\u5668\uff08trigger\uff09\uff0c\u5fc5\u987b\u8981\u6709\u89e6\u53d1\u5668\u6765\u521b\u5efa\u52a8\u4f5c\uff08action\uff09\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u60f3\u8981\u6536\u5230\u7c7b\u4f3c\u201cX\u4e2aserver\u4e0aCPU\u8d1f\u8f7d\u8fc7\u9ad8\u201d\u8fd9\u6837\u7684\u544a\u8b66\uff0c\u60a8\u5fc5\u987b\u9996\u5148\u4e3a Server X \u521b\u5efa\u4e00\u4e2a\u4e3b\u673a\u6761\u76ee\uff0c\u5176\u6b21\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u76d1\u63a7\u5176 CPU\u7684\u76d1\u63a7\u9879\uff0c\u6700\u540e\u521b\u5efa\u4e00\u4e2a\u89e6\u53d1\u5668\uff0c\u7528\u6765\u89e6\u53d1 CPU\u8d1f\u8f7d\u8fc7\u9ad8\u8fd9\u4e2a\u52a8\u4f5c\uff0c\u5e76\u5c06\u5176\u53d1\u9001\u5230\u60a8\u7684\u90ae\u7bb1\u91cc\u3002\u867d\u7136\u8fd9\u4e9b\u6b65\u9aa4\u770b\u8d77\u6765\u5f88\u7e41\u7410\uff0c\u4f46\u662f\u4f7f\u7528\u6a21\u677f\u7684\u8bdd\uff0c\u5b9e\u9645\u64cd\u4f5c\u975e\u5e38\u7b80\u5355\u3002\u4e5f\u6b63\u662f\u7531\u4e8e\u8fd9\u79cd\u8bbe\u8ba1\uff0c\u4f7f\u5f97 Zabbix \u7684\u914d\u7f6e\u53d8\u5f97\u66f4\u52a0\u7075\u6d3b\u6613\u7528\n\n\n\u4e3a\u4e86\u907f\u514d\u8017\u5c3d\u5185\u5b58\uff0c \u5f53Zabbix server\u4f7f\u7528 Zabbix protocol \u534f\u8bae\u65f6\u4e00\u6b21\u8fde\u63a5\u53ea\u63a5\u53d7128M\n\u88ab\u52a8\u68c0\u67e5\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u636e\u8bf7\u6c42\u3002Zabbix\u670d\u52a1\u5668\u6216proxy\u8bf7\u6c42\u4e00\u4e9b\u6570\u636e(\u4f8b\u5982\uff0cCPU\u8d1f\u8f7d)\uff0cZabbix agent\u5c06\u7ed3\u679c\u53d1\u9001\u56de\u670d\u52a1\u5668\n\n\u4e3b\u52a8\u68c0\u67e5\u9700\u8981\u66f4\u590d\u6742\u7684\u5904\u7406\uff0cagent \u5fc5\u987b\u9996\u5148\u4eceserver\u7aef\u68c0\u7d22\u72ec\u7acb\u5904\u7406\u76d1\u63a7\u9879\u7684\u5217\u8868\n</code></pre>"},{"location":"system/Iptables/","title":"iptables","text":"<ul> <li>\u9009\u9879\u8be6\u89e3</li> <li>iptables\u5de5\u4f5c\u673a\u5236</li> <li>\u57fa\u672c\u67b6\u6784\u6d41\u7a0b\u56fe</li> <li>\u57fa\u672c\u53c2\u6570</li> <li>iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f</li> <li>\u9632\u706b\u5899\u7684\u7b56\u7565</li> <li>\u5b9e\u4f8b</li> <li>\u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570</li> <li>\u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5</li> <li>\u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528</li> <li>\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219</li> <li>\u914d\u7f6e\u767d\u540d\u5355</li> <li>\u5f00\u542f\u76f8\u5e94\u7684\u670d\u52a1\u7aef\u53e3</li> <li>\u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d</li> <li>\u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219</li> <li>\u6e05\u9664\u5df2\u6709\u89c4\u5219</li> <li>\u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219</li> <li>\u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3</li> <li>\u5c4f\u853dIP</li> <li>\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3</li> <li>\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219</li> <li>\u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219</li> <li>\u7aef\u53e3\u6620\u5c04</li> <li>\u5b57\u7b26\u4e32\u5339\u914d</li> <li>\u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb</li> <li>\u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb</li> </ul>"},{"location":"system/Iptables/#iptables_1","title":"iptables\u5de5\u4f5c\u673a\u5236","text":"<p>iptables \u8868\u662f\u6309\u7167\u5bf9\u6570\u636e\u5305\u7684\u64cd\u4f5c\u533a\u5206\u7684\uff0c\u94fe\u4e5f\u88ab\u79f0\u4e3a\u94a9\u5b50\u51fd\u6570(hook functions)\u662f\u6309\u7167\u4e0d\u540c\u7684Hook\u51fd\u6570\u6765\u533a\u5206\u7684</p> \u8868 filter \u8d1f\u8d23\u5305\u8fc7\u6ee4\uff0c\u7528\u4e8e\u9632\u706b\u5899\u89c4\u5219 nat nat\u529f\u80fd(\u7aef\u53e3\u6620\u5c04\uff0c\u5730\u5740\u6620\u5c04,\u7f51\u5173\u8def\u7531\u7b49\uff09 mangle \u8d1f\u8d23IP\u6570\u636e\u5305\u5904\u7406\uff0c\u5982\uff1aTos\uff0c\u670d\u52a1\u7c7b\u578b\u7b49\uff0c\u7528\u4e8e\u5b9e\u73b0\u670d\u52a1\u8d28\u91cf raw \u8d1f\u8d23\u8fde\u63a5\u8ddf\u8e2a,\u5982:\u7f51\u5740\u8fc7\u6ee4 security \u7528\u4e8e\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236(SELinux\u7b49)\u7f51\u7edc\u89c4\u5219 \u94fe\u540d\u89c4\u5219 INPUT \u63a5\u6536\u6570\u636e\u5305 OUTPUT \u8f93\u51fa\u6570\u636e\u5305 FORWARD \u5728\u5185\u6838\u7a7a\u95f4\u4e2d\uff0c\u4ece\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u8fdb\u5165\uff0c\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u53bb\u3002\u8f6c\u53d1\u8fc7\u6ee4 PREROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u8868\u4e4b\u524d(DNAT) POSTROUTING \u6570\u636e\u5305\u4f5c\u8def\u7531\u9009\u62e9\u4e4b\u540e(SNAT) \u52a8\u4f5c ACCEPT \u63a5\u6536\u6570\u636e\u5305 DROP \u4e22\u5f03\u6570\u636e\u5305 REDIRECT \u91cd\u5b9a\u5411\u3001\u6620\u5c04\u3001\u900f\u660e\u4ee3\u7406 DNAT \u76ee\u6807\u5730\u5740\u8f6c\u6362 SNAT \u6e90\u5730\u5740\u8f6c\u6362 MASQUERADE IP\u4f2a\u88c5\uff08NAT\uff09\uff0c\u7528\u4e8eADSL LOG \u65e5\u5fd7\u8bb0\u5f55 <p>\u4e0b\u8868\u4e3a\uff1a\u4ece\u5de6\u5230\u53f3\u6bcf\u4e2a\u8868(Table)\u53ef\u7528\u7684\u94fe(Chains),\u5f53\u4ece\u4e0a\u5230\u4e0b\u663e\u793a\u5728\u89e6\u53d1\u5173\u8054\u7684netfilter\u6302\u94a9\u65f6\u8c03\u7528\u6bcf\u4e2a\u94fe\u7684\u987a\u5e8f</p> Tables\u2193/Chains\u2192 PREROUTING INPUT FORWARD OUTPUT POSTROUTING (routing decision) \u2713 raw \u2713 \u2713 (connection tracking enabled) \u2713 \u2713 mangle \u2713 \u2713 \u2713 \u2713 \u2713 nat(DNAT) \u2713 \u2713 (routing decision) \u2713 \u2713 filter \u2713 \u2713 \u2713 security \u2713 \u2713 \u2713 nat(SNAT) \u2713 \u2713"},{"location":"system/Iptables/#iptables_2","title":"iptables\u6570\u636e\u5305\u6d41\u7a0b","text":"<p>\u53c2\u8003\u94fe\u63a5</p> Markdown<pre><code># \u4ee5\u4e0b\u4e3a\u7b80\u6613\u6d41\u7a0b\uff1b\u5927\u591a\u6570\u4f7f\u7528\u60c5\u51b5\u4e0b\u90fd\u4e0d\u4f1a\u7528\u5230raw\uff0cmangle\u548csecurity\u8868\uff1b\u6ce8\u610f\uff1aIPv6\u6ca1\u6709nat\n                                      \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513\n                                      \u2503    Network    \u2503\n                                      \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2533\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n                                              |\n                                              |\n                                              \u25bc\n                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                            \u2502 table: raw,mangle,nat(destination)        \u2502\n                            \u2502 chain: PREROUTING                         \u2502\n                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                              |\n                                              \u25bc\n                                    \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n                                    route outing decision\n                \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u5224\u65ad\u5f53\u524d\u6570\u636e\u5305\u76ee\u7684IP\u5730\u5740\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                |                   \u662f\u5426\u4e3a\u672c\u673a\u7f51\u53e3\u7684IP\u5730\u5740                             |\n                |                   \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014                          \u2502\u76ee\u7684IP\u975e\u672c\u673a\u7f51\u53e3IP\n                |                                                                   \u2502\u5982\u679c\u672c\u673a\u5f00\u542fIP_forward\n                \u2502 \u76ee\u7684IP\u4e3a\u672c\u5730\u7f51\u53e3IP                                                  |\u5219\u6570\u636e\u5305\u8fdb\u5165\u8f6c\u53d1\u6d41\u7a0b\n                \u2502 \u8fdb\u5165\u672c\u673a\u5904\u7406INPUT                                                   \u2502\n                \u2502                                                                   \u2502\n                \u25bc                                                                  \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Table:mangle,filter\uff0csecurity         |                            \u2502table: mangle,filter      |\n\u2502   Chain:INPUT                          \u2502                             \u2502chain: FORWARD            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                |                                                                   |\n                |                                                                   |\n                \u25bc                                                                  |\n         \u250c             \u2510                                                            |\n         \u2502local process\u2502                                                            |\n         \u2514             \u2518                                                            |\n                \u2502                                                                   |\n                \u25bc                                                                   |\n        \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014                                                          |\n         Routing decision  \u5224\u65ad\u6570\u636e\u5305\u53d1\u5f80\u54ea\u4e2a\u7f51\u53e3                                       |\n        \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014                                                           |\n                \u2502                                                                    |\n                \u25bc                                                                   |\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                     |\n\u2502 table: raw,mangle,nat(destination),filter,security          \u2502                      |\n\u2502 chain: OUTPUT                                               \u2502                      |\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                     |\n                   \u2502                                                                 |\n                   |                                                                 |\n                   |                                                                 |\n                   |                          \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014                     |\n                   +\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25b6 routing decision  \u25c0\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                              \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n                                                       \u2502\n                                                       \u2502\n                                                       \u25bc\n                                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                                        \u2502 table: mangle,nat(source)      \u2502\n                                        \u2502 chain: PREROUTING              \u2502\n                                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                                         \u2502\u6570\u636e\u94fe\u8def\u5c42\u5c01\u88c5\uff0c\u53d1\u9001\u5230\u7f51\u7edc\n                                                         |\n                                                         \u25bc\n                                                  \u250f\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u254d\u2513\n                                                  \u2503    Network    \u2503\n                                                  \u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\n\n\n\u8865\u5145\uff1a`-A` \u4ee3\u8868\u8ffd\u52a0\uff0c`-I` \u4ee3\u8868\u63d2\u5165\uff0c`-D` \u4ee3\u8868\u5220\u6389\uff0c`-R` \u4ee3\u8868\u66ff\u6362\uff0c`-L` \u4ee3\u8868\u5217\u8868\uff0c`-p` \u4ee3\u8868\u534f\u8bae\uff0c`-s` \u4ee3\u8868\u6e90\u5730\u5740\uff0c\u5fc5\u987b\u662f IP \uff0c`-j` \u4ee3\u8868\u52a8\u4f5c\uff0c`-d` \u4ee3\u8868\u76ee\u6807\u5730\u5740\uff0c`-i` \u7f51\u5361\u8fdb\u5165\u662f\u6570\u636e\uff0c`-o` \u4ee3\u8868\u7f51\u5361\u8f93\u51fa\u7684\u6570\u636e\n\niptables\u6ce8\u610f\u4e8b\u9879\uff1a\n\u4e13\u8868\u4e13\u7528\uff1afilter\u3001nat\u3001mangle\uff1b\u6ce8\u610f\u6570\u636e\u5305\u8d70\u5411\uff1aPREROUTING\u3001INPUT\u3001FORWARD\u3001OUTPUT\u3001POSTROUTING\n\u6240\u6709\u94fe\u540d\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u8868\u540d\u5fc5\u987b\u5c0f\u5199\uff0c\u6240\u6709\u52a8\u4f5c\u5fc5\u987b\u5927\u5199\uff0c\u6240\u6709\u5339\u914d\u5fc5\u987b\u5c0f\u5199\n</code></pre>"},{"location":"system/Iptables/#iptables_3","title":"iptables\u547d\u4ee4\u8f93\u5165\u987a\u5e8f","text":"Bash<pre><code>iptables -t \u8868\u540d &lt;-A/I/D/R&gt; \u89c4\u5219\u94fe\u540d [\u89c4\u5219\u53f7] &lt;-i/o \u7f51\u5361\u540d&gt; -p \u534f\u8bae\u540d &lt;-s \u6e90IP/\u6e90\u5b50\u7f51&gt; --sport \u6e90\u7aef\u53e3 &lt;-d \u76ee\u6807IP/\u76ee\u6807\u5b50\u7f51&gt; --dport \u76ee\u6807\u7aef\u53e3 -j \u52a8\u4f5c\n</code></pre>"},{"location":"system/Iptables/#_1","title":"\u57fa\u672c\u53c2\u6570","text":"\u53c2\u6570 \u4f5c\u7528 -P \u8bbe\u7f6e\u9ed8\u8ba4\u7b56\u7565:iptables -P INPUT (DROP -F \u6e05\u7a7a\u89c4\u5219\u94fe -L \u67e5\u770b\u89c4\u5219\u94fe -A \u5728\u89c4\u5219\u94fe\u7684\u672b\u5c3e\u52a0\u5165\u65b0\u89c4\u5219 -I num  \u5728\u89c4\u5219\u94fe\u7684\u5934\u90e8\u52a0\u5165\u65b0\u89c4\u5219 -D num  \u5220\u9664\u67d0\u4e00\u6761\u89c4\u5219 -s \u5339\u914d\u6765\u6e90\u5730\u5740IP/MASK\uff0c\u52a0\u53f9\u53f7\"!\"\u8868\u793a\u9664\u8fd9\u4e2aIP\u5916\u3002 -d \u5339\u914d\u76ee\u6807\u5730\u5740 -i \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u5165\u7684\u6570\u636e -o \u7f51\u5361\u540d\u79f0 \u5339\u914d\u4ece\u8fd9\u5757\u7f51\u5361\u6d41\u51fa\u7684\u6570\u636e -p \u5339\u914d\u534f\u8bae,\u5982tcp,udp,icmp --dport num \u5339\u914d\u76ee\u6807\u7aef\u53e3\u53f7 --sport num \u5339\u914d\u6765\u6e90\u7aef\u53e3\u53f7 Bash<pre><code># \u901a\u7528\u5339\u914d\uff1a\u6e90\u5730\u5740\u76ee\u6807\u5730\u5740\u7684\u5339\u914d\n-t,--table table ---&gt;\uff1a\u5bf9\u6307\u5b9a\u7684\u8868 table \u8fdb\u884c\u64cd\u4f5c\uff0c table \u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u6b64\u9009\u9879\uff0c\u9ed8\u8ba4\u7684\u662f filter \u8868\n\n-p ---&gt;\uff1a\u6307\u5b9a\u8981\u5339\u914d\u7684\u6570\u636e\u5305\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662fTCP\u3001UDP\u3001ICMP\u7b49\n\n# \u6309\u7167\u6765\u6e90\u76ee\u7684\u5730\u5740\u5339\u914d\uff0c\u53ef\u4ee5\u662fIP\u3001NET\u3001DOMAIN\uff0c\u4e5f\u53ef\u4e3a\u7a7a\n-s, --source [!] address[/mask] ---&gt;\uff1a\u5339\u914d\u6765\u6e90\u5730\u5740\uff1b\u628a\u6307\u5b9a\u7684\u4e00\u4e2a\uff0f\u4e00\u7ec4\u5730\u5740\u4f5c\u4e3a\u6e90\u5730\u5740\uff0c\u6309\u6b64\u89c4\u5219\u8fdb\u884c\u8fc7\u6ee4\u3002\u5f53\u540e\u9762\u6ca1\u6709 mask \u65f6\uff0caddress \u662f\u4e00\u4e2a\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.1\uff1b\u5f53 mask \u6307\u5b9a\u65f6\uff0c\u53ef\u4ee5\u8868\u793a\u4e00\u7ec4\u8303\u56f4\u5185\u7684\u5730\u5740\uff0c\u6bd4\u5982\uff1a192.168.1.0/255.255.255.0\n\n-d, --destination [!] address[/mask] ---&gt;\uff1a\u5339\u914d\u76ee\u7684\u5730\u5740\uff1b\u5730\u5740\u683c\u5f0f\u540c\u4e0a\uff0c\u4f46\u8fd9\u91cc\u662f\u6307\u5b9a\u5730\u5740\u4e3a\u76ee\u7684\u5730\u5740\uff0c\u6309\u6b64\u8fdb\u884c\u8fc7\u6ee4\n\n# \u6309\u7167\u7f51\u7edc\u63a5\u53e3\u5339\u914d\n-i, --in-interface [!] &lt;\u7f51\u7edc\u63a5\u53e3name&gt; ---&gt;\uff1a\u5339\u914d\u6570\u636e\u8fdb\u5165\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u7684\u6765\u81ea\u6765\u81ea\u7f51\u7edc\u63a5\u53e3\uff0c\u6bd4\u5982\u6700\u5e38\u89c1\u7684 eth0 \u3002\u6ce8\u610f\uff1a\u5b83\u53ea\u5bf9 INPUT\uff0cFORWARD\uff0cPREROUTING \u8fd9\u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u6b64\u9009\u9879\uff0c \u8bf4\u660e\u53ef\u4ee5\u6765\u81ea\u4efb\u4f55\u4e00\u4e2a\u7f51\u7edc\u63a5\u53e3\u3002\u540c\u524d\u9762\u7c7b\u4f3c\uff0c\"!\" \u8868\u793a\u53d6\u53cd\n\n-o, --out-interface [!] &lt;\u7f51\u7edc\u63a5\u53e3name&gt; ---&gt;\uff1a\u5339\u914d\u6570\u636e\u6d41\u51fa\u7684\u7f51\u7edc\u63a5\u53e3\uff1b\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3\u3002\u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528\n\n# \u6309\u7aef\u53e3\u5339\u914d\uff0c--sport\u548c--dport\u5fc5\u987b\u914d\u5408-p\u53c2\u6570\u4f7f\u7528\uff0c\u4e14\u5fc5\u987b\u6307\u660e\u534f\u8bae\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u4e2a\u522b\u7aef\u53e3\u6216\u7aef\u53e3\u8303\u56f4\n--sport &lt;\u5339\u914d\u6e90\u7aef\u53e3&gt;\n--dport &lt;\u5339\u914d\u76ee\u7684\u7aef\u53e3&gt;\n\n# \u67e5\u770b\u7ba1\u7406\u547d\u4ee4\n-L, --list [chain] \u5217\u51fa\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u5217\u51fa\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1bv:\u663e\u793a\u6bcf\u6761\u89c4\u5219\u7684\u5339\u914d\u5305\u6570\u91cf\u548c\u5339\u914d\u5b57\u8282\u6570\uff1bx:\u5728v\u9009\u9879\u57fa\u7840\u4e0a\u7981\u6b62\u81ea\u52a8\u5355\u4f4d\u6362\u7b97(K\u3001M);n:\u53ea\u663e\u793aIP\u5730\u5740\u548c\u7aef\u53e3\uff0c\u4e0d\u663e\u793a\u57df\u540d\u548c\u670d\u52a1\u540d\u79f0\n\n# \u89c4\u5219\u7ba1\u7406\u547d\u4ee4\n-A, --append chain rule-specification ---&gt;\uff1a\u5728\u6307\u5b9a\u94fe chain \u7684\u672b\u5c3e\u63d2\u5165\u6307\u5b9a\u7684\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u6761\u89c4\u5219\u4f1a\u88ab\u653e\u5230\u6700\u540e\uff0c\u6700\u540e\u624d\u4f1a\u88ab\u6267\u884c\u3002\u89c4\u5219\u662f\u7531\u540e\u9762\u7684\u5339\u914d\u6765\u6307\u5b9a\n\n-I, --insert chain [rulenum] rule-specification ---&gt;\uff1a\u5728\u94fechain\u4e2d\u7684\u6307\u5b9a\u4f4d\u7f6e\u63d2\u5165\u4e00\u6761\u6216\u591a\u6761\u89c4\u5219\u3002\u9ed8\u8ba4\u89c4\u5219\u53f7\u662f1\uff0c\u8868\u793a\u5728\u94fe\u7684\u5934\u90e8\u63d2\u5165\u3002\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264(\u5df2\u6709\u89c4\u5219\u6570+1)\uff0c\u5426\u5219\u62a5\u9519\n\n-D, --delete chain rule-specification -D, --delete chain rulenum ---&gt;\uff1a\u5728\u6307\u5b9a\u7684\u94fe chain \u4e2d\u5220\u9664\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u5b9a\u89c4\u5219\u6216\u6307\u5b9a\u89c4\u5219\u53f7\u3002\u82e5\u89c4\u5219\u5217\u8868\u6709\u591a\u6761\u76f8\u540c\u89c4\u5219\uff0c\u5219\u6309\u5185\u5bb9\u5339\u914d\u53ea\u5220\u9664\u5e8f\u53f7\u6700\u5c0f\u4e00\u6761\uff1b\u6309\u53f7\u7801\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519\uff1b\u6309\u5185\u5bb9\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u5b58\u5728\uff0c\u5426\u5219\u62a5\u9519\n\n-R num ---&gt;\uff1aReplays\u66ff\u6362/\u4fee\u6539\u7b2c\u51e0\u6761\u89c4\u5219\uff1b\u786e\u4fdd\u89c4\u5219\u53f7\u7801\u2264\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519\n\n# \u94fe\u7ba1\u7406\u547d\u4ee4\uff08\u8fd9\u90fd\u662f\u7acb\u5373\u751f\u6548\u7684\uff09\n-P, --policy chain target ---&gt;\uff1a\u4e3a\u6307\u5b9a\u7684\u94fechain\u8bbe\u7f6e\u7b56\u7565 target\u3002\u6ce8\u610f\uff0c\u53ea\u6709\u5185\u7f6e\u7684\u94fe\u624d\u5141\u8bb8\u6709\u7b56\u7565\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u662f\u4e0d\u5141\u8bb8\u7684\u3002\u5f53\u6570\u636e\u5305\u6ca1\u6709\u88ab\u89c4\u5219\u5217\u8868\u7684\u4efb\u4f55\u89c4\u5219\u76f8\u5339\u914d\uff0c\u5219\u6309\u9ed8\u8ba4\u89c4\u5219\u5904\u7406\uff0c\u52a8\u4f5c\u524d\u4e0d\u80fd\u52a0-j\uff0c\u4e5f\u662f\u552f\u4e00\u5339\u914d\u52a8\u4f5c\u524d\u4e0d\u52a0-j\u9009\u62e9\u7684\u60c5\u51b5\n\n-F, --flush [chain] ---&gt;\uff1a\u6e05\u7a7a\u6307\u5b9a\u94fechain\u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\uff0c\u6e05\u7a7a\u8be5\u8868\u4e0a\u6240\u6709\u94fe\u7684\u6240\u6709\u89c4\u5219\uff1b-F\u4ec5\u4ec5\u6e05\u7a7a\u94fe\u4e2d\u89c4\u5219\uff0c\u4e0d\u5f71\u54cd-P\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u89c4\u5219\uff1b-P\u8bbe\u7f6e\u4e86DROP\u540e\uff0c\u4f7f\u7528-F\u4f1a\u5c06\u5176\u6e05\u9664\u6389\n\n-N, --new-chain chain ---&gt;\uff1a\u7528\u6307\u5b9a\u7684\u540d\u5b57\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u94fe\n\n-X, --delete-chain [chain] ---&gt;\uff1a\u5220\u9664\u6307\u5b9a\u7684\u94fe\uff0c\u8fd9\u4e2a\u94fe\u5fc5\u987b\u6ca1\u6709\u88ab\u5176\u5b83\u4efb\u4f55\u89c4\u5219\u5f15\u7528\uff0c\u800c\u4e14\u8fd9\u6761\u4e0a\u5fc5\u987b\u6ca1\u6709\u4efb\u4f55\u89c4\u5219\u3002\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u94fe\u540d\uff0c\u5219\u4f1a\u5220\u9664\u8be5\u8868\u4e2d\u6240\u6709\u975e\u5185\u7f6e\u7684\u94fe\n\n-E, --rename-chain old-chain new-chain ---&gt;\uff1a\u7528\u6307\u5b9a\u7684\u65b0\u540d\u5b57\u53bb\u91cd\u547d\u540d\u6307\u5b9a\u7684\u94fe\u3002\u8fd9\u5e76\u4e0d\u4f1a\u5bf9\u94fe\u5185\u90e8\u7167\u6210\u4efb\u4f55\u5f71\u54cd\n\n-Z, --zero [chain] ---&gt;\uff1a\u628a\u6307\u5b9a\u94fe\uff0c\u6216\u8005\u8868\u4e2d\u7684\u6240\u6709\u94fe\u4e0a\u7684\u6240\u6709\u8ba1\u6570\u5668\u6e05\u96f6\n\n-j, --jump target &lt;\u6307\u5b9a\u76ee\u6807&gt; ---&gt;\uff1a\u5373\u6ee1\u8db3\u67d0\u6761\u4ef6\u65f6\u8be5\u6267\u884c\u4ec0\u4e48\u6837\u7684\u52a8\u4f5c\u3002target \u53ef\u4ee5\u662f\u5185\u7f6e\u7684\u76ee\u6807\uff0c\u6bd4\u5982 ACCEPT\uff0c\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u94fe\n\n# iptables\u5177\u4f53&lt;\u52a8\u4f5c&gt;\u8be6\u89e3\uff1aACCEPT\u3001DROP\u3001SNAT\u3001DNAT\u3001MASQUERADE\n-j ACCEPT   # \u5141\u8bb8\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684permit)\n-j DROP     # \u963b\u6b62\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe\u800c\u4e22\u5f03\u5b83(\u7c7b\u4f3cCisco\u4e2dACL\u91cc\u7684deny)\n-j DNAT --to IP[-IP][:\u7aef\u53e3-\u7aef\u53e3](nat\u8868\u7684PREROUTING\u94fe)   # \u76ee\u7684\u5730\u5740\u8f6c\u6362\uff0cDNAT\u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP\u5730\u5740\u6c60(\u4e00\u7ec4\u8fde\u7eed\u7684IP\u5730\u5740)\n-j SNAT --to IP[-IP][:\u7aef\u53e3-\u7aef\u53e3]\uff08nat\u8868\u7684POSTROUTING \u94fe\uff09# \u6e90\u5730\u5740\u8f6c\u6362\uff0cSNAT \u652f\u6301\u8f6c\u6362\u4e3a\u5355IP\uff0c\u4e5f\u652f\u6301\u8f6c\u6362\u5230IP \u5730\u5740\u6c60(\u4e00\u7ec4\u8fde\u7eed\u7684IP \u5730\u5740)\n-j MASQUERADE   # \u52a8\u6001\u6e90\u5730\u5740\u8f6c\u6362(\u52a8\u6001IP\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528)\n\n# \u9644\u52a0\u6a21\u5757\n\u6309\u5305\u72b6\u6001\u5339\u914d----(state)\n\u6309\u6765\u6e90MAC \u5339\u914d--(mac)\n\u6309\u5305\u901f\u7387\u5339\u914d----(limit)\n\u591a\u7aef\u53e3\u5339\u914d------(multiport)\n\n-m state --state \u72b6\u6001   # \u72b6\u6001\uff1aNEW\u3001RELATED\u3001ESTABLISHED\u3001INVALID\nNEW\uff1a\u6709\u522b\u4e8etcp\u7684syn\nESTABLISHED\uff1a\u8fde\u63a5\u6001\nRELATED\uff1a\u884d\u751f\u6001\uff0c\u4e0econntrack \u5173\u8054\uff08FTP\uff09\nINVALID\uff1a\u4e0d\u80fd\u88ab\u8bc6\u522b\u5c5e\u4e8e\u54ea\u4e2a\u8fde\u63a5\u6216\u6ca1\u6709\u4efb\u4f55\u72b6\u6001\n\n-m mac --mac-source MAC   # \u5339\u914d\u67d0\u4e2aMAC \u5730\u5740\u3002\u62a5\u6587\u7ecf\u8fc7\u8def\u7531\u540e\uff0c\u6570\u636e\u5305\u4e2d\u539f\u6709\u7684mac \u4fe1\u606f\u4f1a\u88ab\u66ff\u6362\uff0c\u6240\u4ee5\u5728\u8def\u7531\u540e\u7684iptables \u4e2d\u4f7f\u7528mac \u6a21\u5757\u662f\u6ca1\u6709\u610f\u4e49\u7684\n\n-m limit --limit \u5339\u914d\u901f\u7387[--burst \u7f13\u51b2\u6570\u91cf]   # \u7528\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u6570\u636e\u5305\u3002limit \u82f1\u8bed\u4e0a\u770b\u662f\u9650\u5236\u7684\u610f\u601d\uff0c\u4f46\u5b9e\u9645\u4e0a\u53ea\u662f\u6309\u4e00\u5b9a\u901f\u7387\u53bb\u5339\u914d\u800c\u5df2\uff0c\u8981\u60f3\u9650\u5236\u7684\u8bdd\u540e\u9762\u8981\u518d\u8ddf\u4e00\u6761DROP\n\n-m multiport &lt;--sports|--dports|--ports&gt; \u7aef\u53e31[,\u7aef\u53e32,..,\u7aef\u53e3n]    # \u4e00\u6b21\u6027\u5339\u914d\u591a\u4e2a\u7aef\u53e3\uff0c\u53ef\u4ee5\u533a\u5206\u6e90\u7aef\u53e3\uff0c\u76ee\u7684\u7aef\u53e3\u6216\u4e0d\u6307\u5b9a\u7aef\u53e3\u3002\u5fc5\u987b\u4e0e-p \u53c2\u6570\u4e00\u8d77\u4f7f\u7528\n\nman iptables-extensions\u4e2d\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684\u652f\u6301\u7684module;iptables-extensions\u7531\u591a\u4e2amach module\u548c\u591a\u4e2atarget module\u7ec4\u6210\uff0c\u6bcf\u4e2amodule\u90fd\u6709\u81ea\u5df1\u7684\u53c2\u6570\n</code></pre>"},{"location":"system/Iptables/#_2","title":"\u9632\u706b\u5899\u7684\u7b56\u7565","text":"<p>\u9632\u706b\u5899\u7b56\u7565\u4e00\u822c\u5206\u4e3a\u4e24\u79cd\uff0c\u4e00\u79cd\u53eb<code>\u901a</code>\u7b56\u7565\uff0c\u4e00\u79cd\u53eb<code>\u5835</code>\u7b56\u7565\uff0c\u901a\u7b56\u7565\uff0c\u9ed8\u8ba4\u95e8\u662f\u5173\u7740\u7684\uff0c\u5fc5\u987b\u8981\u5b9a\u4e49\u8c01\u80fd\u8fdb\u3002\u5835\u7b56\u7565\u5219\u662f\uff0c\u5927\u95e8\u662f\u6d1e\u5f00\u7684\uff0c\u4f46\u662f\u4f60\u5fc5\u987b\u6709\u8eab\u4efd\u8ba4\u8bc1\uff0c\u5426\u5219\u4e0d\u80fd\u8fdb\uff0c<code>\u6240\u4ee5\u901a\uff0c\u662f\u8981\u5168\u901a\uff0c\u800c\u5835\uff0c\u5219\u662f\u8981\u9009\u62e9</code>\u3002\u5f53\u6211\u4eec\u5b9a\u4e49\u7684\u7b56\u7565\u7684\u65f6\u5019\uff0c\u8981\u5206\u522b\u5b9a\u4e49\u591a\u6761\u529f\u80fd\uff0c\u5176\u4e2d\uff1a\u5b9a\u4e49\u6570\u636e\u5305\u4e2d\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\u7b56\u7565\uff0cfilter\u8fc7\u6ee4\u7684\u529f\u80fd\uff0c\u800c\u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\u529f\u80fd\u7684\u5219\u662fnat\u9009\u9879\u3002\u4e3a\u4e86\u8ba9\u8fd9\u4e9b\u529f\u80fd\u4ea4\u66ff\u5de5\u4f5c\uff0c\u6211\u4eec\u5236\u5b9a\u51fa\u4e86\u201c\u8868\u201d\u8fd9\u4e2a\u5b9a\u4e49\uff0c\u6765\u5b9a\u4e49\u3001\u533a\u5206\u5404\u79cd\u4e0d\u540c\u7684\u5de5\u4f5c\u529f\u80fd\u548c\u5904\u7406\u65b9\u5f0f</p> <p>\u6211\u4eec\u73b0\u5728\u7528\u7684\u6bd4\u8f83\u591a\u7684\u529f\u80fd\u67093\u4e2a\uff1a</p> <ol> <li>filter \u5b9a\u4e49\u5141\u8bb8\u6216\u8005\u4e0d\u5141\u8bb8\u7684\uff0c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT</li> <li>nat \u5b9a\u4e49\u5730\u5740\u8f6c\u6362\u7684\uff0c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING</li> <li>mangle\u529f\u80fd:\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\uff0c\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING</li> </ol> <p>\u6211\u4eec\u4fee\u6539\u62a5\u6587\u539f\u6570\u636e\u5c31\u662f\u6765\u4fee\u6539TTL\u7684\u3002\u80fd\u591f\u5b9e\u73b0\u5c06\u6570\u636e\u5305\u7684\u5143\u6570\u636e\u62c6\u5f00\uff0c\u5728\u91cc\u9762\u505a\u6807\u8bb0/\u4fee\u6539\u5185\u5bb9\u7684\u3002\u800c\u9632\u706b\u5899\u6807\u8bb0\uff0c\u5176\u5b9e\u5c31\u662f\u9760mangle\u6765\u5b9e\u73b0\u7684</p> <p>\u5c0f\u6269\u5c55:</p> <ul> <li>\u5bf9\u4e8efilter\u6765\u8bb2\u4e00\u822c\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aINPUT \uff0cFORWARD \uff0cOUTPUT</li> <li>\u5bf9\u4e8enat\u6765\u8bb2\u4e00\u822c\u4e5f\u53ea\u80fd\u505a\u57283\u4e2a\u94fe\u4e0a\uff1aPREROUTING \uff0cOUTPUT \uff0cPOSTROUTING</li> <li>\u800cmangle\u5219\u662f5\u4e2a\u94fe\u90fd\u53ef\u4ee5\u505a\uff1aPREROUTING\uff0cINPUT\uff0cFORWARD\uff0cOUTPUT\uff0cPOSTROUTING</li> </ul> <p>iptables/netfilter\uff08\u8fd9\u6b3e\u8f6f\u4ef6\uff09\u662f\u5de5\u4f5c\u5728\u7528\u6237\u7a7a\u95f4\u7684\uff0c\u5b83\u53ef\u4ee5\u8ba9\u89c4\u5219\u8fdb\u884c\u751f\u6548\u7684\uff0c\u672c\u8eab\u4e0d\u662f\u4e00\u79cd\u670d\u52a1\uff0c\u800c\u4e14\u89c4\u5219\u662f\u7acb\u5373\u751f\u6548\u7684\u3002\u800c\u6211\u4eeciptables\u73b0\u5728\u88ab\u505a\u6210\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u53ef\u4ee5\u8fdb\u884c\u542f\u52a8\uff0c\u505c\u6b62\u7684\u3002\u542f\u52a8\uff0c\u5219\u5c06\u89c4\u5219\u76f4\u63a5\u751f\u6548\uff0c\u505c\u6b62\uff0c\u5219\u5c06\u89c4\u5219\u64a4\u9500</p> <p>iptables\u8fd8\u652f\u6301\u81ea\u5df1\u5b9a\u4e49\u94fe\u3002\u4f46\u662f\u81ea\u5df1\u5b9a\u4e49\u7684\u94fe\uff0c\u5fc5\u987b\u662f\u8ddf\u67d0\u79cd\u7279\u5b9a\u7684\u94fe\u5173\u8054\u8d77\u6765\u7684\u3002\u5728\u4e00\u4e2a\u5173\u5361\u8bbe\u5b9a\uff0c\u6307\u5b9a\u5f53\u6709\u6570\u636e\u7684\u65f6\u5019\u4e13\u95e8\u53bb\u627e\u67d0\u4e2a\u7279\u5b9a\u7684\u94fe\u6765\u5904\u7406\uff0c\u5f53\u90a3\u4e2a\u94fe\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u518d\u8fd4\u56de\u3002\u63a5\u7740\u5728\u7279\u5b9a\u7684\u94fe\u4e2d\u7ee7\u7eed\u68c0\u67e5</p> <p>\u6ce8\u610f\uff1a\u89c4\u5219\u7684\u6b21\u5e8f\u975e\u5e38\u5173\u952e\uff0c<code>\u8c01\u7684\u89c4\u5219\u8d8a\u4e25\u683c\uff0c\u5e94\u8be5\u653e\u7684\u8d8a\u9760\u524d</code>\uff0c\u800c\u68c0\u67e5\u89c4\u5219\u7684\u65f6\u5019\uff0c\u662f\u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\u7684\u65b9\u5f0f\u8fdb\u884c\u68c0\u67e5\u7684</p>"},{"location":"system/Iptables/#_3","title":"\u5b9e\u4f8b","text":"Bash<pre><code># \u4fdd\u5b58\u89c4\u5219\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d,\u4efb\u4f55\u6539\u52a8\u4e4b\u524d\u5148\u5907\u4efd\uff0c\u8bf7\u4fdd\u6301\u8fd9\u4e00\u4f18\u79c0\u7684\u4e60\u60ef\ncp /etc/sysconfig/iptables /etc/sysconfig/iptables.bak\niptables-save &gt; /etc/sysconfig/iptables\n\n# \u6e05\u7a7a\u5f53\u524d\u7684\u6240\u6709\u89c4\u5219\u548c\u8ba1\u6570\niptables -F  # \u6e05\u7a7a\u6240\u6709\u7684\u9632\u706b\u5899\u89c4\u5219\niptables -X  # \u5220\u9664\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u7a7a\u94fe\niptables -Z  # \u6e05\u7a7a\u8ba1\u6570\n\niptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT  # \u914d\u7f6e\u5141\u8bb8ssh\u7aef\u53e3\u8fde\u63a5,22\u4e3a\u4f60\u7684ssh\u7aef\u53e3\uff0c -s 192.168.1.0/24\u8868\u793a\u5141\u8bb8\u8fd9\u4e2a\u7f51\u6bb5\u7684\u673a\u5668\u6765\u8fde\u63a5\uff0c\u5176\u5b83\u7f51\u6bb5\u7684ip\u5730\u5740\u662f\u767b\u9646\u4e0d\u4e86\u4f60\u7684\u673a\u5668\u7684\u3002 -j ACCEPT\u8868\u793a\u63a5\u53d7\u8fd9\u6837\u7684\u8bf7\u6c42\n\n# \u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528;\u672c\u5730\u56de\u73af\u5730\u5740\u5c31\u662f\u90a3\u4e2a127.0.0.1\uff0c\u662f\u672c\u673a\u4e0a\u4f7f\u7528\u7684,\u5b83\u8fdb\u4e0e\u51fa\u90fd\u8bbe\u7f6e\u4e3a\u5141\u8bb8\niptables -A INPUT -i lo -j ACCEPT\niptables -A OUTPUT -o lo -j ACCEPT\n\n# \u8bbe\u7f6e\u9ed8\u8ba4\u7684\u89c4\u5219\niptables -P INPUT DROP # \u914d\u7f6e\u9ed8\u8ba4\u4e0d\u8ba9\u8fdb\niptables -P FORWARD DROP # \u9ed8\u8ba4\u4e0d\u5141\u8bb8\u8f6c\u53d1\niptables -P OUTPUT ACCEPT # \u9ed8\u8ba4\u53ef\u4ee5\u51fa\u53bb\n\n# \u914d\u7f6e\u767d\u540d\u5355;\u9ed1\u540d\u5355\u5c31\u662f\u540e\u9762\u6362\u6210DROP\niptables -A INPUT -p all -s 192.168.1.0/24 -j ACCEPT  # \u5141\u8bb8192.168.1.0\u7f51\u6bb5\u4e92\u76f8\u53ef\u4ee5\u8bbf\u95ee\niptables -A INPUT -m mac --mac-source 00:00:00:00:00:00 -j ACCEPT  # \u5141\u8bb8mac\u5730\u5740\u4e3a00:00:00:00:00:00\u8bbf\u95ee\niptables -A INPUT -p tcp -s 183.121.3.7 --dport 3380 -j ACCEPT # \u5141\u8bb8183.121.3.7\u8bbf\u95ee\u672c\u673a\u76843380\u7aef\u53e3\niptables -A INPUT  -p tcp -m multiport --dports 22,80,443 -j ACCEPT     # \u5f00\u542f22,80,443\u7aef\u53e3\niptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT # \u5141\u8bb8\u88abping\niptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT    # \u5141\u8bb8\u5df2\u5efa\u7acb\u7684\u6216\u76f8\u5173\u8fde\u63a5\u7684\u901a\u884c\n\n# \u7981\u6b62\u5176\u4ed6\u672a\u5141\u8bb8\u7684\u89c4\u5219\u8bbf\u95ee\niptables -A INPUT -j REJECT\niptables -A FORWARD -j REJECT\n\niptables -t nat -A PREROUTING -i eth0 -p tcp --dport 25 -j REDIRECT --to-port 2525  # \u672c\u573025\u7aef\u53e3\u8f6c\u53d1\u52302525\niptables -A INPUT -p tcp --dport 80 -m limit --limit 100/minute --limit-burst 200 -j ACCEPT  # \u9650\u5236\u8fde\u63a5\u901f\u7387\uff0c\u6bcf\u5206\u949f100\u4e2a\uff0c\u4e0a\u9650200\niptables -A INPUT -p tcp --syn --dport 22 -m connlimit --connlimit-above 3 -j REJECT    # \u9650\u523622\u7aef\u53e3\u5e76\u53d1\u8fde\u63a5\n\n# \u5217\u51fa\u5df2\u8bbe\u7f6e\u7684\u89c4\u5219\niptables -L [-t \u8868\u540d] [\u94fe\u540d]\n\n- \u56db\u4e2a\u8868\u540d `raw`\uff0c`nat`\uff0c`filter`\uff0c`mangle`\n- \u4e94\u4e2a\u89c4\u5219\u94fe\u540d `INPUT`\u3001`OUTPUT`\u3001`FORWARD`\u3001`PREROUTING`\u3001`POSTROUTING`\n- filter\u8868\u5305\u542b`INPUT`\u3001`OUTPUT`\u3001`FORWARD`\u4e09\u4e2a\u89c4\u5219\u94fe\n\n```bash\niptables -L -t nat                  # \u5217\u51fa nat \u4e0a\u9762\u7684\u6240\u6709\u89c4\u5219\n#            ^ -t \u53c2\u6570\u6307\u5b9a\uff0c\u5fc5\u987b\u662f raw\uff0c nat\uff0cfilter\uff0cmangle \u4e2d\u7684\u4e00\u4e2a\niptables -L -t nat  --line-numbers  # \u89c4\u5219\u5e26\u7f16\u53f7\niptables -L INPUT\n\niptables -L -nv  # \u67e5\u770b\uff0c\u8fd9\u4e2a\u5217\u8868\u770b\u8d77\u6765\u66f4\u8be6\u7ec6\n</code></pre>"},{"location":"system/Iptables/#_4","title":"\u5220\u9664\u5df2\u6dfb\u52a0\u7684\u89c4\u5219","text":"Bash<pre><code># \u6dfb\u52a0\u4e00\u6761\u89c4\u5219\niptables -A INPUT -s 192.168.1.5 -j DROP\n\n\u5c06\u6240\u6709iptables\u4ee5\u5e8f\u53f7\u6807\u8bb0\u663e\u793a\uff0c\u6267\u884c\uff1a\niptables -L -n --line-numbers\n</code></pre> <p>\u6bd4\u5982\u8981\u5220\u9664INPUT\u91cc\u5e8f\u53f7\u4e3a8\u7684\u89c4\u5219\uff0c\u6267\u884c\uff1a</p> Bash<pre><code>iptables -D INPUT 8\n</code></pre>"},{"location":"system/Iptables/#_5","title":"\u5f00\u653e\u6307\u5b9a\u7684\u7aef\u53e3","text":"Bash"},{"location":"system/Iptables/#ip","title":"\u5c4f\u853dIP","text":"Bash<pre><code>iptables -A INPUT -p tcp -m tcp -s 192.168.0.8 -j DROP  # \u5c4f\u853d\u6076\u610f\u4e3b\u673a\uff08\u6bd4\u5982\uff0c192.168.0.8\niptables -I INPUT -s 123.45.6.7 -j DROP       #\u5c4f\u853d\u5355\u4e2aIP\u7684\u547d\u4ee4\niptables -I INPUT -s 123.0.0.0/8 -j DROP      #\u5c01\u6574\u4e2a\u6bb5\u5373\u4ece123.0.0.1\u5230123.255.255.254\u7684\u547d\u4ee4\niptables -I INPUT -s 124.45.0.0/16 -j DROP    #\u5c01IP\u6bb5\u5373\u4ece123.45.0.1\u5230123.45.255.254\u7684\u547d\u4ee4\niptables -I INPUT -s 123.45.6.0/24 -j DROP    #\u5c01IP\u6bb5\u5373\u4ece123.45.6.1\u5230123.45.6.254\u7684\u547d\u4ee4\u662f\n</code></pre>"},{"location":"system/Iptables/#_6","title":"\u6307\u5b9a\u6570\u636e\u5305\u51fa\u53bb\u7684\u7f51\u7edc\u63a5\u53e3","text":"<p>\u53ea\u5bf9 OUTPUT\uff0cFORWARD\uff0cPOSTROUTING \u4e09\u4e2a\u94fe\u8d77\u4f5c\u7528</p> Bash<pre><code>iptables -A FORWARD -o eth0\n</code></pre>"},{"location":"system/Iptables/#_7","title":"\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219","text":"Bash<pre><code>iptables -L -n -v\nChain INPUT (policy DROP 48106 packets, 2690K bytes)\n pkts bytes target     prot opt in     out     source               destination\n 5075  589K ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0\n 191K   90M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:22\n1499K  133M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80\n4364K 6351M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED\n 6256  327K ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0\n\nChain FORWARD (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target     prot opt in     out     source               destination\n\nChain OUTPUT (policy ACCEPT 3382K packets, 1819M bytes)\n pkts bytes target     prot opt in     out     source               destination\n 5075  589K ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0\n</code></pre>"},{"location":"system/Iptables/#_8","title":"\u542f\u52a8\u7f51\u7edc\u8f6c\u53d1\u89c4\u5219","text":"<p>\u516c\u7f51<code>210.14.67.7</code>\u8ba9\u5185\u7f51<code>192.168.188.0/24</code>\u4e0a\u7f51</p> Bash<pre><code>iptables -t nat -A POSTROUTING -s 192.168.188.0/24 -j SNAT --to-source 210.14.67.127\n</code></pre>"},{"location":"system/Iptables/#_9","title":"\u7aef\u53e3\u6620\u5c04","text":"<p>\u672c\u673a\u7684 2222 \u7aef\u53e3\u6620\u5c04\u5230\u5185\u7f51 \u865a\u62df\u673a\u768422 \u7aef\u53e3</p> Bash<pre><code>iptables -t nat -A PREROUTING -d 210.14.67.127 -p tcp --dport 2222  -j DNAT --to-dest 192.168.188.115:22\n</code></pre>"},{"location":"system/Iptables/#_10","title":"\u5b57\u7b26\u4e32\u5339\u914d","text":"<p>\u6bd4\u5982\uff0c\u6211\u4eec\u8981\u8fc7\u6ee4\u6240\u6709TCP\u8fde\u63a5\u4e2d\u7684\u5b57\u7b26\u4e32<code>test</code>\uff0c\u4e00\u65e6\u51fa\u73b0\u5b83\u6211\u4eec\u5c31\u7ec8\u6b62\u8fd9\u4e2a\u8fde\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u505a\uff1a</p> Bash<pre><code>iptables -A INPUT -p tcp -m string --algo kmp --string \"test\" -j REJECT --reject-with tcp-reset\niptables -L\n\n# Chain INPUT (policy ACCEPT)\n# target     prot opt source               destination\n# REJECT     tcp  --  anywhere             anywhere            STRING match \"test\" ALGO name kmp TO 65535 reject-with tcp-reset\n#\n# Chain FORWARD (policy ACCEPT)\n# target     prot opt source               destination\n#\n# Chain OUTPUT (policy ACCEPT)\n# target     prot opt source               destination\n</code></pre>"},{"location":"system/Iptables/#windows","title":"\u963b\u6b62Windows\u8815\u866b\u7684\u653b\u51fb","text":"Bash<pre><code>iptables -I INPUT -j DROP -p tcp -s 0.0.0.0/0 -m string --algo kmp --string \"cmd.exe\"\n</code></pre>"},{"location":"system/Iptables/#syn","title":"\u9632\u6b62SYN\u6d2a\u6c34\u653b\u51fb","text":"Bash<pre><code>iptables -A INPUT -p tcp --syn -m limit --limit 5/second -j ACCEPT\n</code></pre>"},{"location":"system/Iptables/#_11","title":"\u66f4\u591a\u5b9e\u4f8b","text":"Bash<pre><code># \u7528iptables\u642d\u5efa\u4e00\u5957\u5f3a\u5927\u7684\u5b89\u5168\u9632\u62a4\u76fe http://www.imooc.com/learn/389\n\niptables: linux \u4e0b\u5e94\u7528\u5c42\u9632\u706b\u5899\u5de5\u5177\n\niptables 5\u94fe: \u5bf9\u5e94 Hook point\nnetfilter: linux \u64cd\u4f5c\u7cfb\u7edf\u6838\u5fc3\u5c42\u5185\u90e8\u7684\u4e00\u4e2a\u6570\u636e\u5305\u5904\u7406\u6a21\u5757\nHook point: \u6570\u636e\u5305\u5728 netfilter \u4e2d\u7684\u6302\u8f7d\u70b9; `PRE_ROUTING / INPUT / OUTPUT / FORWARD / POST_ROUTING`\n\niptables &amp; netfilter\n![](http://7xq89b.com1.z0.glb.clouddn.com/netfilter&amp;iptables.jpg)\n\niptables 4\u88685\u94fe\n![](http://7xq89b.com1.z0.glb.clouddn.com/iptables-data-stream.jpg)\n\niptables rules\n![](http://7xq89b.com1.z0.glb.clouddn.com/iptables-rules.jpg)\n\n- 4\u8868\n\n**filter**: \u8bbf\u95ee\u63a7\u5236 / \u89c4\u5219\u5339\u914d\n**nat**: \u5730\u5740\u8f6c\u53d1\n mangle / raw\n\n - \u89c4\u5219\n\n\u6570\u636e\u8bbf\u95ee\u63a7\u5236: ACCEPT / DROP / REJECT\n\u6570\u636e\u5305\u6539\u5199(nat -&gt; \u5730\u5740\u8f6c\u6362): snat / dnat\n\u4fe1\u606f\u8bb0\u5f55: log\n\n## \u4f7f\u7528\u573a\u666f\u5b9e\u4f8b\n- \u573a\u666f\u4e00\n\n\u5f00\u653e tcp 10-22/80 \u7aef\u53e3\n\u5f00\u653e icmp\n\u5176\u4ed6\u672a\u88ab\u5141\u8bb8\u7684\u7aef\u53e3\u7981\u6b62\u8bbf\u95ee\n\n\u5b58\u5728\u7684\u95ee\u9898: \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u672c\u673a; \u672c\u673a\u65e0\u6cd5\u8bbf\u95ee\u5176\u4ed6\u4e3b\u673a\n\n- \u573a\u666f\u4e8c\n\nftp: \u9ed8\u8ba4\u88ab\u52a8\u6a21\u5f0f(\u670d\u52a1\u5668\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u544a\u8bc9\u5ba2\u6237\u7aef, \u5ba2\u6237\u7aef\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u62c9\u53d6\u6570\u636e)\nvsftpd: \u4f7f ftp \u652f\u6301\u4e3b\u52a8\u6a21\u5f0f(\u5ba2\u6237\u7aef\u4ea7\u751f\u968f\u673a\u7aef\u53e3\u901a\u77e5\u670d\u52a1\u5668, \u670d\u52a1\u5668\u4e3b\u52a8\u8fde\u63a5\u8fd9\u4e2a\u7aef\u53e3\u53d1\u9001\u6570\u636e)\n\n- \u573a\u666f\u4e09\n\n\u5141\u8bb8\u5916\u7f51\u8bbf\u95ee:\nweb\nhttp -&gt; 80/tcp; https -&gt; 443/tcp\nmail\nsmtp -&gt; 25/tcp; smtps -&gt; 465/tcp\npop3 -&gt; 110/tcp; pop3s -&gt; 995/tcp\nimap -&gt; 143/tcp\n\n\u5185\u90e8\u4f7f\u7528:\nfile\nnfs -&gt; 123/udp\nsamba -&gt; 137/138/139/445/tcp\nftp -&gt; 20/21/tcp\nremote\nssh -&gt; 22/tcp\nsql\nmysql -&gt; 3306/tcp\noracle -&gt; 1521/tcp\n\n- \u573a\u666f\u56db\n\nnat \u8f6c\u53d1\n\n- \u573a\u666f\u4e94\n\n\u9632CC\u653b\u51fb\niptables -L -F -A -D # list flush append delete\n# \u573a\u666f\u4e00\niptables -I INPUT -p tcp --dport 80 -j ACCEPT # \u5141\u8bb8 tcp 80 \u7aef\u53e3\niptables -I INPUT -p tcp --dport 10:22 -j ACCEPT # \u5141\u8bb8 tcp 10-22 \u7aef\u53e3\niptables -I INPUT -p icmp -j ACCEPT # \u5141\u8bb8 icmp\niptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709\n\n# \u4f18\u5316\u573a\u666f\u4e00\niptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee\niptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51\niptables -I INPUT -p tcp --dport 80 -s 10.10.188.233 -j ACCEPT # \u53ea\u5141\u8bb8\u56fa\u5b9aip\u8bbf\u95ee80\n\n# \u573a\u666f\u4e8c\nvi /etc/vsftpd/vsftpd.conf # \u4f7f\u7528 vsftpd \u5f00\u542f ftp \u4e3b\u52a8\u6a21\u5f0f\nport_enable=yes\nconnect_from_port_20=YES\niptables -I INPUT -p tcp --dport 21 -j ACCEPT\n\nvi /etc/vsftpd/vsftpd.conf # \u5efa\u8bae\u4f7f\u7528 ftp \u88ab\u52a8\u6a21\u5f0f\npasv_min_port=50000\npasv_max_port=60000\niptables -I INPUT -p tcp --dport 21 -j ACCEPT\niptables -I INPUT -p tcp --dport 50000:60000 -j ACCEPT\n\n# \u8fd8\u53ef\u4ee5\u4f7f\u7528 iptables \u6a21\u5757\u8ffd\u8e2a\u6765\u81ea\u52a8\u5f00\u53d1\u5bf9\u5e94\u7684\u7aef\u53e3\n\n# \u573a\u666f\u4e09\niptables -I INPUT -i lo -j ACCEPT # \u5141\u8bb8\u672c\u673a\u8bbf\u95ee\niptables -I INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # \u5141\u8bb8\u8bbf\u95ee\u5916\u7f51\niptables -I INPUT -s 10.10.155.0/24 -j ACCEPT # \u5141\u8bb8\u5185\u7f51\u8bbf\u95ee\niptables -I INPUT -p tcp -m multiport --dports 80,1723 -j ACCEPT # \u5141\u8bb8\u7aef\u53e3, 80 -&gt; http, 1723 -&gt; vpn\niptables -A INPUT -j REJECT # \u6dfb\u52a0\u4e00\u6761\u89c4\u5219, \u4e0d\u5141\u8bb8\u6240\u6709\n\niptables-save # \u4fdd\u5b58\u8bbe\u7f6e\u5230\u914d\u7f6e\u6587\u4ef6\n\n# \u573a\u666f\u56db\niptables -t nat -L # \u67e5\u770b nat \u914d\u7f6e\n\niptables -t nat -A POST_ROUTING -s 10.10.177.0/24 -j SNAT --to 10.10.188.232 # SNAT\nvi /etc/sysconfig/network # \u914d\u7f6e\u7f51\u5173\n\niptables -t nat -A POST_ROUTING -d 10.10.188.232 -p tcp --dport 80 -j DNAT --to 10.10.177.232:80 # DNAT\n\n#\u573a\u666f\u4e94\niptables -I INPUT -p tcp --syn --dport 80 -m connlimit --connlimit-above 100 -j REJECT # \u9650\u5236\u5e76\u53d1\u8fde\u63a5\u8bbf\u95ee\u6570\niptables -I INPUT -m limit --limit 3/hour --limit-burst 10 -j ACCEPT # limit\u6a21\u5757; --limit-burst \u9ed8\u8ba4\u4e3a5\n</code></pre> <p>\u6682\u672a\u6574\u7406</p>"},{"location":"system/Iptables/#_12","title":"\u5355\u670d\u52a1\u5668\u9632\u62a4","text":"Bash<pre><code># \u601d\u8def\uff1a\u786e\u5b9a\u5bf9\u5916\u670d\u52a1\u5bf9\u8c61\uff0c\u5bf9\u7f51\u7edc\u63a5\u53e3\u5904\u7406\uff0c\u72b6\u6001\u68c0\u6d4b\u5904\u7406\uff0c\u534f\u8bae\u548c\u7aef\u53e3\u5904\u7406\u3002\u4f8b\u5982\uff1a\u666e\u901aWEB\u670d\u52a1\u5668\niptables -A INPUT -i lo -j ACCEPT   # \u5f00\u653e\u672c\u5730\u8bbf\u95ee\niptables -A INPUT -p tcp -m multiport --dports 22,80,8080 -j ACCEPT   # \u5f00\u653e22,80,8080tcp\u7aef\u53e3\niptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT  # \u5f00\u653e\u72b6\u6001\u4e3aRELATED,ESTABLISHED\u7684\niptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\niptables -P INPUT DROP  # \u5173\u6389\u5168\u90e8input\u94fe\n# \u6ce8\u610f\uff1a\u786e\u4fdd\u89c4\u5219\u987a\u5e8f\u6b63\u786e\uff0c\u5f04\u6e05\u903b\u8f91\u5173\u7cfb\uff0c\u5b66\u4f1a\u65f6\u523b\u4f7f\u7528-vnL\n</code></pre>"},{"location":"system/Iptables/#_13","title":"\u5173\u4e8e\u7f51\u5173","text":"Bash<pre><code># \u601d\u8def\uff1a\u641e\u6e05\u7f51\u7edc\u62d3\u6251\uff0c\u672c\u673a\u4e0a\u7f51\uff0c\u8bbe\u7f6enat\u542f\u7528\u8def\u7531\u8f6c\u53d1\uff0c\u5730\u5740\u4f2a\u88c5SNAT/MASQUERADE\n# ADSL\u62e8\u53f7\u4e0a\u7f51\u7684\u62d3\u6251\u5b9e\u4f8b\u5982\u4e0b\necho \"1\" &gt; /proc/sys/net/ipv4/ip_forward    # \u5f00\u542f\u8f6c\u53d1\niptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE\n</code></pre>"},{"location":"system/Iptables/#_14","title":"\u9650\u5236\u5185\u7f51\u7528\u6237","text":"Bash<pre><code># \u601d\u8def\uff1a\u8fc7\u6ee4\u4f4d\u7f6efilter\u8868FORWARD\u94fe\uff0c\u5339\u914d\u6761\u4ef6-s -d -p --s/dport;\u5904\u7406\u52a8\u4f5cACCEPT DROP\niptables -A FORWARD -s 192.168.0.3 -j DROP\niptables -A FORWARD -m mac --mac-source 11:22:33:44:55:66 -j DROP\niptables -A FORWARD -d www.baidu.com -j DROP\n</code></pre>"},{"location":"system/Iptables/#_15","title":"\u5185\u7f51\u505a\u5bf9\u5916\u670d\u52a1\u5668","text":"Bash<pre><code># \u601d\u8def\uff1a\u670d\u52a1\u534f\u8bae(TCP/UDP)\uff1b\u5bf9\u5916\u670d\u52a1\u7aef\u53e3\uff0c\u5185\u90e8\u670d\u52a1\u5668\u79c1\u7f51IP\uff1b\u5185\u90e8\u771f\u6b63\u670d\u52a1\u7aef\u53e3\niptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to 192.168.1.1\niptables -t nat -A PREROUTING -i eth0 -p tcp --dport 81 -j DNAT --to 192.168.1.2:80\n</code></pre> Bash<pre><code>iptables -I INPUT -s ip -j DROP   #\u5c4f\u853d\u6307\u5b9a ip \u8bbf\u95ee\niptables -A INPUT -p tcp --dport 2222 -j ACCEPT    #\u5141\u8bb8 2222 \u7aef\u53e3\u8bbf\u95ee\niptables -A INPUT -p icmp --icmp-type 8 -s 0/0 -j DROP #\u5c4f\u853d icmp \u534f\u8bae\uff0c\u5373\u5173\u95ed ping \u670d\u52a1\niptables -L -n --line-numbers #\u67e5\u770b\u5df2\u6dfb\u52a0\u7684\u89c4\u5219\u5e76\u4ee5\u5e8f\u53f7\u663e\u793a\niptables -D INPUT 8 #\u5220\u9664\u5e8f\u53f7\u4e3a 8 \u7684\u89c4\u5219\n\n# ip_conntrack: table full, dropping packet\u95ee\u9898\u5904\u7406\niptables -t raw -A PREROUTING -d 1.2.3.4 -p tcp --dport 80 -j NOTRACK\niptables -A FORWARD -m state --state UNTRACKED -j ACCEPT\n</code></pre>"},{"location":"system/Networking/","title":"Iproute2&amp;Net-tools","text":"<p>NET-TOOLS VS IPROUTE\u5bf9\u7167</p> NET-TOOLS COMMANDS IPROUTE COMMANDS arp -a ip neigh arp -v ip -s neigh arp -s 192.168.1.1 1:2:3:4:5:6 ip neigh add 192.168.1.1 lladdr 1:2:3:4:5:6 dev eth1 arp -i eth1 -d 192.168.1.1 ip neigh del 192.168.1.1 dev eth1 ifconfig -a ip addr ifconfig eth0 down ip link set eth0 down ifconfig eth0 up ip link set eth0 up ifconfig eth0 192.168.1.1 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 netmask 255.255.255.0 ip addr add 192.168.1.1/24 dev eth0 ifconfig eth0 mtu 9000 ip link set eth0 mtu 9000 ifconfig eth0:0 192.168.1.2 ip addr add 192.168.1.2/24 dev eth0 netstat ss netstat -neopa ss -neopa netstat -g ip maddr route ip route route add -net 192.168.1.0 netmask 255.255.255.0 dev eth0 ip route add 192.168.1.0/24 dev eth0 route add default gw 192.168.1.1 ip route add default via 192.168.1.1"},{"location":"system/Networking/#iproute2","title":"Iproute2","text":""},{"location":"system/Networking/#_1","title":"\u9009\u578b","text":"<p>Bash<pre><code>ip [ OPTIONS ] OBJECT { COMMAND | help }\nip [ -force ] -batch filename\nwhere  OBJECT := { link | address | addrlabel | route | rule | neigh | ntable |\n                   tunnel | tuntap | maddress | mroute | mrule | monitor | xfrm |\n                   netns | l2tp | fou | macsec | tcp_metrics | token | netconf | ila }\n       OPTIONS := { -V[ersion] | -s[tatistics] | -d[etails] | -r[esolve] |\n                    -h[uman-readable] | -iec |\n                    -f[amily] { inet | inet6 | ipx | dnet | mpls | bridge | link } |\n                    -4 | -6 | -I | -D | -B | -0 |\n                    -l[oops] { maximum-addr-flush-attempts } | -br[ief] |\n                    -o[neline] | -t[imestamp] | -ts[hort] | -b[atch] [filename] |\n                    -rc[vbuf] [size] | -n[etns] name | -a[ll] |?-c[olor]}\n-s\uff1a\u8f93\u51fa\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\n-f\uff1a\u5f3a\u5236\u4f7f\u7528\u6307\u5b9a\u7684\u534f\u8bae\u65cf\n-4\uff1a\u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv4\u534f\u8bae\n-6\uff1a\u6307\u5b9a\u4f7f\u7528\u7684\u7f51\u7edc\u5c42\u534f\u8bae\u662fIPv6\u534f\u8bae\n-0\uff1a\u8f93\u51fa\u4fe1\u606f\u6bcf\u6761\u8bb0\u5f55\u8f93\u51fa\u4e00\u884c\uff0c\u5373\u4f7f\u5185\u5bb9\u8f83\u591a\u4e5f\u4e0d\u6362\u884c\u663e\u793a\n-r\uff1a\u663e\u793a\u4e3b\u673a\u65f6\uff0c\u4e0d\u4f7f\u7528IP\u5730\u5740\uff0c\u800c\u4f7f\u7528\u4e3b\u673a\u7684\u57df\u540d\n</code></pre> Text Only<pre><code>-h, --help      \u5e2e\u52a9\u4fe1\u606f\n-V, --version   \u7a0b\u5e8f\u7248\u672c\u4fe1\u606f\n-n, --numeric   \u4e0d\u89e3\u6790\u670d\u52a1\u540d\u79f0\n-r, --resolve   \u89e3\u6790\u4e3b\u673a\u540d\n-a, --all       \u663e\u793a\u6240\u6709\u5957\u63a5\u5b57\uff08sockets\uff09\n-l, --listening \u663e\u793a\u76d1\u542c\u72b6\u6001\u7684\u5957\u63a5\u5b57\uff08sockets\uff09\n-o, --options   \u663e\u793a\u8ba1\u65f6\u5668\u4fe1\u606f\n-e, --extended  \u663e\u793a\u8be6\u7ec6\u7684\u5957\u63a5\u5b57\uff08sockets\uff09\u4fe1\u606f\n-m, --memory    \u663e\u793a\u5957\u63a5\u5b57\uff08socket\uff09\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\n-p, --processes \u663e\u793a\u4f7f\u7528\u5957\u63a5\u5b57\uff08socket\uff09\u7684\u8fdb\u7a0b\n-i, --info      \u663e\u793a TCP\u5185\u90e8\u4fe1\u606f\n-s, --summary   \u663e\u793a\u5957\u63a5\u5b57\uff08socket\uff09\u4f7f\u7528\u6982\u51b5\n-4, --ipv4      \u4ec5\u663e\u793aIPv4\u7684\u5957\u63a5\u5b57\uff08sockets\uff09\n-6, --ipv6      \u4ec5\u663e\u793aIPv6\u7684\u5957\u63a5\u5b57\uff08sockets\uff09\n-0, --packet    \u663e\u793a PACKET \u5957\u63a5\u5b57\uff08socket\uff09\n-t, --tcp       \u4ec5\u663e\u793a TCP\u5957\u63a5\u5b57\uff08sockets\uff09\n-u, --udp       \u4ec5\u663e\u793a UCP\u5957\u63a5\u5b57\uff08sockets\uff09\n-d, --dccp      \u4ec5\u663e\u793a DCCP\u5957\u63a5\u5b57\uff08sockets\uff09\n-w, --raw       \u4ec5\u663e\u793a RAW\u5957\u63a5\u5b57\uff08sockets\uff09\n-x, --unix      \u4ec5\u663e\u793a Unix\u5957\u63a5\u5b57\uff08sockets\uff09\n-f, --family=FAMILY  \u663e\u793a FAMILY\u7c7b\u578b\u7684\u5957\u63a5\u5b57\uff08sockets\uff09\uff0cFAMILY\u53ef\u9009\uff0c\u652f\u6301  unix, inet, inet6, link, netlink\n-A, --query=QUERY, --socket=QUERY\n      QUERY := {all|inet|tcp|udp|raw|unix|packet|netlink}[,QUERY]\n-D, --diag=FILE     \u5c06\u539f\u59cbTCP\u5957\u63a5\u5b57\uff08sockets\uff09\u4fe1\u606f\u8f6c\u50a8\u5230\u6587\u4ef6\n -F, --filter=FILE  \u4ece\u6587\u4ef6\u4e2d\u90fd\u53bb\u8fc7\u6ee4\u5668\u4fe1\u606f\n       FILTER := [ state TCP-STATE ] [ EXPRESSION ]\n</code></pre></p>"},{"location":"system/Networking/#_2","title":"\u5b9e\u4f8b","text":"Bash<pre><code>ss -t -a    # \u663e\u793aTCP\u8fde\u63a5\nss -s       # \u663e\u793a Sockets \u6458\u8981\nss -l       # \u5217\u51fa\u6240\u6709\u6253\u5f00\u7684\u7f51\u7edc\u8fde\u63a5\u7aef\u53e3\nss -pl      # \u67e5\u770b\u8fdb\u7a0b\u4f7f\u7528\u7684socket\nss -lp | grep 3306  # \u627e\u51fa\u6253\u5f00\u5957\u63a5\u5b57/\u7aef\u53e3\u5e94\u7528\u7a0b\u5e8f\nss -u -a    \u663e\u793a\u6240\u6709UDP Sockets\nss -o state established '( dport = :smtp or sport = :smtp )' # \u663e\u793a\u6240\u6709\u72b6\u6001\u4e3aestablished\u7684SMTP\u8fde\u63a5\nss -o state established '( dport = :http or sport = :http )' # \u663e\u793a\u6240\u6709\u72b6\u6001\u4e3aEstablished\u7684HTTP\u8fde\u63a5\nss -o state fin-wait-1 '( sport = :http or sport = :https )' dst 193.233.7/24  # \u5217\u4e3e\u51fa\u5904\u4e8e FIN-WAIT-1\u72b6\u6001\u7684\u6e90\u7aef\u53e3\u4e3a 80\u6216\u8005 443\uff0c\u76ee\u6807\u7f51\u7edc\u4e3a 193.233.7/24\u6240\u6709 tcp\u5957\u63a5\u5b57\n\n# ss \u548c netstat \u6548\u7387\u5bf9\u6bd4\ntime netstat -at\ntime ss\n\n# \u5339\u914d\u8fdc\u7a0b\u5730\u5740\u548c\u7aef\u53e3\u53f7\n# ss dst ADDRESS_PATTERN\nss dst 192.168.1.5\nss dst 192.168.119.113:http\nss dst 192.168.119.113:smtp\nss dst 192.168.119.113:443\n\n# \u5339\u914d\u672c\u5730\u5730\u5740\u548c\u7aef\u53e3\u53f7\n# ss src ADDRESS_PATTERN\nss src 192.168.119.103\nss src 192.168.119.103:http\nss src 192.168.119.103:80\nss src 192.168.119.103:smtp\nss src 192.168.119.103:25\n</code></pre> <p>\u5c06\u672c\u5730\u6216\u8005\u8fdc\u7a0b\u7aef\u53e3\u548c\u4e00\u4e2a\u6570\u6bd4\u8f83</p> Bash<pre><code># ss dport OP PORT \u8fdc\u7a0b\u7aef\u53e3\u548c\u4e00\u4e2a\u6570\u6bd4\u8f83\n# ss sport OP PORT \u672c\u5730\u7aef\u53e3\u548c\u4e00\u4e2a\u6570\u6bd4\u8f83\n# OP \u53ef\u4ee5\u4ee3\u8868\u4ee5\u4e0b\u4efb\u610f\u4e00\u4e2a:\n# &lt;= or le : \u5c0f\u4e8e\u6216\u7b49\u4e8e\u7aef\u53e3\u53f7\n# &gt;= or ge : \u5927\u4e8e\u6216\u7b49\u4e8e\u7aef\u53e3\u53f7\n# == or eq : \u7b49\u4e8e\u7aef\u53e3\u53f7\n# != or ne : \u4e0d\u7b49\u4e8e\u7aef\u53e3\u53f7\n# &lt; or gt : \u5c0f\u4e8e\u7aef\u53e3\u53f7\n# &gt; or lt : \u5927\u4e8e\u7aef\u53e3\u53f7\nss  sport = :http\nss  dport = :http\nss  dport \\&gt; :1024\nss  sport \\&gt; :1024\nss sport \\&lt; :32000\nss  sport eq :22\nss  dport != :22\nss  state connected sport = :http\nss \\( sport = :http or sport = :https \\)\nss -o state fin-wait-1 \\( sport = :http or sport = :https \\) dst 192.168.1/24\n</code></pre> <p>\u7528TCP \u72b6\u6001\u8fc7\u6ee4Sockets</p> Bash<pre><code>ss -4 state closing\n# ss -4 state FILTER-NAME-HERE\n# ss -6 state FILTER-NAME-HERE\n# FILTER-NAME-HERE \u53ef\u4ee5\u4ee3\u8868\u4ee5\u4e0b\u4efb\u4f55\u4e00\u4e2a\uff1a\n# established\u3001 syn-sent\u3001 syn-recv\u3001 fin-wait-1\u3001 fin-wait-2\u3001 time-wait\u3001 closed\u3001 close-wait\u3001 last-ack\u3001 listen\u3001 closing\u3001\n# all : \u6240\u6709\u4ee5\u4e0a\u72b6\u6001\n# connected : \u9664\u4e86listen and closed\u7684\u6240\u6709\u72b6\u6001\n# synchronized :\u6240\u6709\u5df2\u8fde\u63a5\u7684\u72b6\u6001\u9664\u4e86syn-sent\n# bucket : \u663e\u793a\u72b6\u6001\u4e3amaintained as minisockets,\u5982\uff1atime-wait\u548csyn-recv.\n# big : \u548cbucket\u76f8\u53cd.\n</code></pre> <p>\u663e\u793aICP\u8fde\u63a5</p> <p>Text Only<pre><code>[root@localhost ~]# ss -t -a\n\n\n **\u663e\u793a Sockets \u6458\u8981**\n</code></pre> [root@localhost ~]# ss -s</p> <p>\u5217\u51fa\u5f53\u524d\u7684established, closed, orphaned and waiting TCP sockets</p> <p>\u5217\u51fa\u6240\u6709\u6253\u5f00\u7684\u7f51\u7edc\u8fde\u63a5\u7aef\u53e3</p> <p>Text Only<pre><code>[root@localhost ~]# ss -l\n\n\n **\u67e5\u770b\u8fdb\u7a0b\u4f7f\u7528\u7684socket**\n</code></pre> [root@localhost ~]# ss -pl</p> <p>\u627e\u51fa\u6253\u5f00\u5957\u63a5\u5b57/\u7aef\u53e3\u5e94\u7528\u7a0b\u5e8f</p> Text Only<pre><code>[root@localhost ~]# ss -pl | grep 3306\n0      0                            *:3306                          *:*        users:((\"mysqld\",1718,10))\n</code></pre> <p>\u663e\u793a\u6240\u6709UDP Sockets</p> Text Only<pre><code>[root@localhost ~]# ss -u -a\n</code></pre>"},{"location":"system/Networking/#22ssh","title":"\u51fa\u6240\u6709\u7aef\u53e3\u4e3a 22\uff08ssh\uff09\u7684\u8fde\u63a5","text":"<p>Bash<pre><code>ss state all sport = :ssh\n</code></pre> Bash<pre><code>OBJECT # \u7f51\u7edc\u5bf9\u8c61\nlink # \u6307\u7f51\u7edc\u8bbe\u5907\uff0c\u901a\u8fc7\u6b64\u5bf9\u8c61\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u53ca\u66f4\u6539\u7f51\u7edc\u8bbe\u5907\u7684\u5c5e\u6027\naddr # \u5730\u5740\u7ba1\u7406\nneigh # arp\u8868\u7ba1\u7406\nroute # \u8def\u7531\u7ba1\u7406\nrule # \u8def\u7531\u7b56\u7565\nmaddr # \u591a\u5740\u5e7f\u64ad\u5730\u5740\nmroute # \u591a\u64ad\u8def\u7531\u7f13\u5b58\u7ba1\u7406\ntunnel # \u901a\u9053\u7ba1\u7406\n\nip link # \u663e\u793a\u94fe\u8def\u4fe1\u606f\nip link show dev eth0 # \u663e\u793aeth0\u63a5\u53e3\u94fe\u8def\u4fe1\u606f\n\n# \u663e\u793a\u8def\u7531ip route [\u7c7b\u4f3croute -n]\nip route | column -t\nip route del 192.168.0.0/24 dev eth1\nip route add 192.168.0.0/24 dev eth1\nip route del via 10.2.255.254  # \u5220\u9664\u9ed8\u8ba4\u8def\u7531\nip route add via 10.2.255.254  # \u589e\u52a0\u9ed8\u8ba4\u8def\u7531\nip route add 192.168.1.0/24 via 192.168.0.1  # \u589e\u52a0\u9759\u6001\u8def\u7531\uff0c192.168.0.1\u4e3a\u4e0b\u4e00\u8df3\u5730\u5740\nip route del 192.168.1.0/24 via 192.168.0.1  # \u5220\u9664\u9759\u6001\u8def\u7531\n\n\u663e\u793aarp\u4fe1\u606fip neigh [\u53ef\u4ee5\u53d6\u4ee3arp -n]\n\u5220\u9664\u5219\u662fip neigh del IP\u5730\u5740 dev \u8bbe\u5907\u540d\n\n\u8def\u7531\u7b56\u7565\u6570\u636e\u5e93:\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u5927\u89c4\u6a21\u7684\u8def\u7531\u5668\uff0c\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u5bf9\u4e8e\u8def\u7531\u7684\u4e0d\u901a\u9700\u6c42\uff0c\u8def\u7531\u7b56\u7565\u6570\u636e\u5e93\u53ef\u4ee5\u5e2e\u4f60\u901a\u8fc7\u591a\u8def\u7531\u8868\u6280\u672f\u6765\u5b9e\u73b0\u3002\u5f53\u5185\u6838\u9700\u8981\u505a\u51fa\u8def\u7531\u9009\u62e9\u65f6\uff0c\u5b83\u4f1a\u627e\u51fa\u5e94\u8be5\u53c2\u8003\u54ea\u4e00\u5f20\u8def\u7531\u8868\u3002\u9664\u4e86ip\u5916,route\u4e5f\u53ef\u4ee5\u4fee\u6539main\u548clocal\u8868\n\n\u9ed8\u8ba4\u89c4\u5219\n    # ip rule\n    \u4e0a\u9762\u5217\u51fa\u4e86\u89c4\u5219\u7684\u4f18\u5148\u987a\u5e8f\u3002ip route\u547d\u4ee4\u9ed8\u8ba4\u663e\u793a\u7684\u5c31\u662fmain\u8868\u3002ip route show table all\u663e\u793a\u6240\u6709\u89c4\u5219\u4e2d\u7684\u8868\n    # ip route list table local\n    broadcast 192.168.0.255 dev eth0  proto kernel  scope link  src 192.168.0.10\n    broadcast 10.2.0.0 dev eth1  proto kernel  scope link  src 10.2.0.217\n    broadcast 127.255.255.255 dev lo  proto kernel  scope link  src 127.0.0.1\n    ... ...\n    default\u8868\u4e3a\u7a7a\n\u4f8b \u7b80\u5355\u7b56\u7565\u8def\u7531\u6dfb\u52a0 [\u5f15\u7528\u81eaLinux\u9ad8\u7ea7\u8def\u7531\u4e2d\u6587HOWTO]\n\u8ba9\u6211\u4eec\u518d\u6765\u4e00\u4e2a\u771f\u5b9e\u7684\u4f8b\u5b50\u3002\u6211\u6709\u4e24\u4e2aCable Modem\uff0c\u8fde\u63a5\u5230\u4e86\u4e00\u4e2a Linux\u7684NAT (\u201c\u4f2a\u88c5\u201d) \u8def\u7531\u5668\u4e0a\u3002\u8fd9\u91cc\u7684\u5ba4\u53cb\u4eec\u5411\u6211\u4ed8\u8d39\u4f7f\u7528Internet\u3002\u5047\u5982\u6211\u5176\u4e2d\u7684\u4e00\u4e2a\u5ba4\u53cb\u56e0\u4e3a\u53ea\u60f3\u8bbf\u95ee hotmail \u800c\u5e0c\u671b\u5c11\u4ed8\u4e00\u4e9b\u94b1\u3002\u5bf9\u6211\u6765\u8bf4\u8fd9\u6ca1\u6709\u95ee\u9898,\u4ed6\u4eec\u80af\u5b9a\u53ea\u80fd\u4f7f\u7528\u90a3\u4e2a\u6bd4\u8f83\u6b21\u7684Cable Modem\n\u90a3\u4e2a\u6bd4\u8f83\u5feb\u7684cable modem \u7684IP\u5730\u5740\u662f 212.64.94.251\uff0cPPP \u94fe\u8def\uff0c\u5bf9\u7aefIP\u662f212.64.94.1\u3002\u800c\u90a3\u4e2a\u6bd4\u8f83\u6162\u7684cable modem\u7684IP\u5730\u5740\u662f212.64.78.148\uff0c\u5bf9\u7aef\u662f195.96.98.253\nlocal \u8868\uff1a\n    #ip route list table local\n\n\u67e5\u770b\u201cmain\u201d\u8def\u7531\u8868\uff1a\n    #ip route list table main\n\n\u6211\u4eec\u73b0\u5728\u4e3a\u6211\u4eec\u7684\u670b\u53cb\u521b\u5efa\u4e86\u4e00\u4e2a\u53eb\u505a\u201cJohn\u201d\u7684\u89c4\u5219\u3002\u5176\u5b9e\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u7eaf\u6570\u5b57\u8868\u793a\u89c4\u5219\uff0c\u4f46\u662f\u4e0d\u65b9\u4fbf\u3002\u6211\u4eec\u53ef\u4ee5\u5411/etc/iproute2/rt_tables\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6570\u5b57\u4e0e\u540d\u5b57\u7684\u5173\u8054\uff1a\n# echo 200 John &gt;&gt; /etc/iproute2/rt_tables\n# ip rule add from 10.0.0.10 table John\n# ip rule\n\n\u73b0\u5728\uff0c\u5269\u4e0b\u7684\u4e8b\u60c5\u5c31\u662f\u4e3a John \u7684\u8def\u7531\u8868\u521b\u5efa\u8def\u7531\u9879\u4e86\u3002\u522b\u5fd8\u4e86\u5237\u65b0\u8def\u7531\u7f13\u5b58\uff1a\n# ip route add default via 195.96.98.253 dev ppp2 table John\n# ip route flush cache\n\u603b\u7ed3\u4e3b\u8981\u662f\u4ee5\u4e0b\u51e0\u6b65\uff1a\n    echo 200 John &gt;&gt; /etc/iproute2/rt_tables #\u65b9\u4fbf\u8868\u793a\uff0c\u628a\u89c4\u5219\u540d\u5b57\u548c\u6570\u5b57\u5bf9\u5e94\u52a0\u5165\u5230/etc/iproute2/rt_tables\u6587\u4ef6\n    ip rule add from 10.0.0.10 table John #\u65b0\u589e\u89c4\u5219\n    ip route add default via 195.96.98.253 dev ppp2 table John #\u89c4\u5219\u4e2d\u6dfb\u52a0\u8def\u7531\u8868\n    ip route flush cache #\u5237\u65b0\u8def\u7531\u8868\niproute2 ip \u5e38\u7528\u547d\u4ee4\u5907\u5fd8\n1.\u663e\u793aip\u5730\u5740\n    ip a\n    ip address show\n    ip addr show dev eth0\n    ip a sh eth0\n2.\u589e\u52a0\u5220\u9664\u5730\u5740\n    ip address add 192.0.2.1/24 dev eth0\n    ip addr del 192.0.2.2/24 dev eth0\n3.\u663e\u793a\u63a5\u53e3\u7edf\u8ba1\n    ip -s link ls eth0\n\n\u7f51\u5361\u548c\u94fe\u8def\u914d\u7f6e\n4.\u663e\u793a\u94fe\u8def\n    ip link show\n    ip link sh eth0\n4.\u4fee\u6539\u63a5\u53e3\u72b6\u6001\n    ip link set eth0 up\n    ip link s gre01 down\n\u8def\u7531\u8868\u7ba1\u7406\n5.\u663e\u793a\u8def\u7531\u8868\n    ip route\n    ip ro show dev gre01\n6.\u589e\u52a0\u65b0\u8def\u7531\n    ip route add 10.2.2.128/27 dev gre01\n7.\u589e\u52a0\u9ed8\u8ba4\u8def\u7531\n    ip route add default via 192.168.1.1\n8.\u4fee\u6539\u9ed8\u8ba4\u8def\u7531\n    ip route chg default via 192.168.1.2\n9.\u5220\u9664\u9ed8\u8ba4\u8def\u7531\n    ip route del default\n\u96a7\u9053\u914d\u7f6e\n10.\u589e\u52a0\u5220\u9664GRE\u96a7\u9053\n    ip tunnel add gre01 mode gre local 10.1.1.1 remote 20.2.2.1 ttl 255\n    ip tunnel del gre01\n11.IPIP\u96a7\u9053\n    ip tunl a ipip01 mode ipip local 10.1.1.1 remote 20.2.2.1 ttl 255\n12.\u663e\u793a\u96a7\u9053\n    ip tunnel show\n13.\u663e\u793a\u96a7\u9053\u7edf\u8ba1\n    ip -s tunl ls gre01\n\u90bb\u5c45\u548carp\u8868\u7ba1\u7406\n13.\u67e5\u770barp\u8868\n    ip neigh show\n14.\u624b\u5de5\u589e\u52a0\u5220\u9664arp\u9879\n    ip neighbor add 10.2.2.2 dev eth0\n    ip neigh del 10.2.2.1 dev eth0\n\nsocket\u7edf\u8ba1\n15.\u663e\u793a\u5f53\u524d\u76d1\u542c\n    ss -l\n16.\u663e\u793a\u5f53\u524d\u76d1\u542c\u7684\u8fdb\u7a0b\n    ss -p\n</code></pre></p> <p>\u5730\u5740\u7ba1\u7406 \u5728\u672c\u8282\u4e2d\uff0c$ {address}\u503c\u5e94\u8be5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u683c\u5f0f\u7684\u4e3b\u673a\u5730\u5740\uff0c$ {mask}\u53ef\u4ee5\u662f\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u6216\u524d\u7f00\u957f\u5ea6\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.10/24\u548c192.0.2.10/255.255.255.0\u540c\u6837\u53ef\u4ee5\u63a5\u53d7</p> <p>\u5982\u679c\u60a8\u4e0d\u786e\u5b9a\u67d0\u4e9b\u4e1c\u897f\u662f\u5426\u4e3a\u6b63\u786e\u7684\u4e3b\u673a\u5730\u5740\uff0c\u8bf7\u4f7f\u7528ipcalc\u6216\u7c7b\u4f3c\u7a0b\u5e8f\u8fdb\u884c\u68c0\u67e5</p> <p>\u663e\u793a\u6240\u6709\u5730\u5740 ip\u5730\u5740\u663e\u793a \u6240\u6709show\u547d\u4ee4\u90fd\u53ef\u4ee5\u4e0e-4\u6216-6\u9009\u9879\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u4ec5\u663e\u793aIPv4\u6216IPv6\u5730\u5740 \u663e\u793a\u5355\u4e2a\u754c\u9762\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u663e\u793aeth0 \u4ec5\u663e\u793a\u6b63\u5728\u8fd0\u884c\u7684\u63a5\u53e3\u7684\u5730\u5740 IP\u5730\u5740\u663e\u793a \u4ec5\u663e\u793a\u9759\u6001\u6216\u52a8\u6001IPv6\u5730\u5740 \u4ec5\u663e\u793a\u9759\u6001\u914d\u7f6e\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}]\u6c38\u4e45 \u4ec5\u663e\u793a\u901a\u8fc7\u81ea\u52a8\u914d\u7f6e\u5b66\u4e60\u7684\u5730\u5740\uff1a ip address show [dev $ {interface}] dynamic \u5411\u63a5\u53e3\u6dfb\u52a0\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} \u4f8b\u5b50\uff1a ip address add 192.0.2.10/27 dev eth0 ip address add 2001\uff1adb8\uff1a1 :: / 48 dev tun10 \u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u6dfb\u52a0\u4efb\u610f\u6570\u91cf\u7684\u5730\u5740</p> <p>\u5982\u679c\u60a8\u6dfb\u52a0\u591a\u4e2a\u5730\u5740\uff0c\u5219\u60a8\u7684\u673a\u5668\u5c06\u63a5\u53d7\u6240\u6709\u6570\u636e\u5305\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u60a8\u6dfb\u52a0\u7684\u7b2c\u4e00\u4e2a\u5730\u5740\u5c06\u7528\u4f5c\u4f20\u51fa\u6d41\u91cf\u7684\u6e90\u5730\u5740\uff0c\u5b83\u88ab\u79f0\u4e3a\u4e3b\u5730\u5740</p> <p>\u60a8\u8bbe\u7f6e\u7684\u6240\u6709\u5176\u4ed6\u5730\u5740\u90fd\u5c06\u6210\u4e3a\u6b21\u8981\u5730\u5740</p> <p>\u6dfb\u52a0\u5177\u6709\u4eba\u7c7b\u53ef\u8bfb\u63cf\u8ff0\u7684\u5730\u5740 ip address add $ {address} / $ {mask} dev $ {interface name} label $ {interface name}\uff1a$ {description} \u4f8b\u5b50\uff1a ip address add 192.0.2.1/24 dev eth0 label eth0\uff1aWANaddress \u7531\u4e8e\u4e00\u4e9b\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u6807\u7b7e\u5fc5\u987b\u4ee5\u63a5\u53e3\u540d\u79f0\u5f00\u5934\uff0c\u540e\u8ddf\u5192\u53f7\uff0c\u5426\u5219\u4f1a\u51fa\u9519\u3002 \u4fdd\u6301\u6807\u7b7e\u77ed\u4e8e\u5341\u516d\u4e2a\u5b57\u7b26\uff0c\u5426\u5219\u4f60\u4f1a\u5f97\u5230\u8fd9\u4e2a\u9519\u8bef\uff1a RTNETLINK\u56de\u7b54\uff1a\u6570\u5b57\u7ed3\u679c\u8d85\u51fa\u8303\u56f4 \u7b14\u8bb0 \u5bf9\u4e8eIPv6\u5730\u5740\uff0c\u6b64\u547d\u4ee4\u4e0d\u8d77\u4f5c\u7528\uff08\u5c06\u6dfb\u52a0\u5730\u5740\uff0c\u4f46\u6ca1\u6709\u6807\u7b7e\uff09</p> <p>\u5220\u9664\u5730\u5740 ip address delete $ {address} / $ {prefix} dev $ {interface name} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5220\u9664192.0.2.1/24 dev eth0 ip address delete 2001\uff1adb8 :: 1/64 dev tun1 \u63a5\u53e3\u540d\u79f0\u662f\u5fc5\u9700\u7684\u3002Linux\u786e\u5b9e\u5141\u8bb8\u5728\u591a\u4e2a\u63a5\u53e3\u4e0a\u914d\u7f6e\u76f8\u540c\u7684\u5730\u5740\uff0c\u5e76\u4e14\u5b83\u5177\u6709\u6709\u6548\u7684\u7528\u4f8b \u4ece\u63a5\u53e3\u4e2d\u5220\u9664\u6240\u6709\u5730\u5740 IP\u5730\u5740\u5237\u65b0\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip\u5730\u5740\u5237\u65b0dev eth1 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u547d\u4ee4\u5220\u9664IPv4\u548cIPv6\u5730\u5740\u3002\u5982\u679c\u60a8\u53ea\u60f3\u79fb\u9664IPv4\u6216IPv6\u5730\u5740\uff0c\u8bf7\u4f7f\u7528\u201cip-4\u5730\u5740\u5237\u65b0\u201d\u6216\u201cip-6\u5730\u5740\u5237\u65b0\u201d</p> <p>\u7b14\u8bb0 \u65e0\u6cd5\u4ea4\u6362\u4e3b\u5730\u5740\u548c\u8f85\u52a9\u5730\u5740\uff0c\u4e5f\u65e0\u6cd5\u663e\u5f0f\u8bbe\u7f6e\u65b0\u7684\u4e3b\u5730\u5740\u3002\u5c1d\u8bd5\u59cb\u7ec8\u9996\u5148\u8bbe\u7f6e\u4e3b\u5730\u5740</p> <p>\u4f46\u662f\uff0c\u5982\u679csysctl\u53d8\u91cfnet.ipv4.conf\u3002$ {interface} .promote_secondaries\u8bbe\u7f6e\u4e3a1\uff0c\u90a3\u4e48\u5f53\u60a8\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u7b2c\u4e00\u4e2a\u8f85\u52a9\u5730\u5740\u5c06\u6210\u4e3a\u65b0\u7684\u4e3b\u5730\u5740</p> <p>\u8bf7\u6ce8\u610f\uff0cnet.ipv4.conf.default.promote_secondaries = 1 \u4e0d\u662f\u6240\u6709Linux\u53d1\u884c\u7248\u4e2d\u7684\u901a\u7528\u9ed8\u8ba4\u8bbe\u7f6e\uff0c\u56e0\u6b64\u8bf7\u5728\u5c1d\u8bd5\u4e4b\u524d\u68c0\u67e5\u60a8\u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5b83\u8bbe\u7f6e\u4e3a0\uff0c\u90a3\u4e48\u5f53\u4f60\u5220\u9664\u4e3b\u5730\u5740\u65f6\uff0c\u6240\u6709\u7684\u5730\u5740\u90fd\u5c06\u4ece\u63a5\u53e3\u4e2d\u5220\u9664</p> <p>\u5982\u679c\u4e3b\u5730\u5740\u88ab\u5220\u9664\uff0c\u5219\u8f85\u52a9IPv6\u5730\u5740\u603b\u662f\u88ab\u63d0\u5347\u4e3a\u4e3b\u5730\u5740\uff0c\u56e0\u6b64\u60a8\u4e0d\u5fc5\u62c5\u5fc3sysctl\u8bbe\u7f6e</p> <p>\u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u7ba1\u7406 \u5bf9\u4e8e\u559c\u6b22\u82f1\u56fd\u62fc\u5199\u7684\u5973\u58eb\u4eec\uff0c\u5148\u751f\u4eec\uff0c\u8fd9\u4e2a\u6307\u6325\u5bb6\u5ead\u4e5f\u652f\u6301\u201c\u90bb\u5c45\u201d\u62fc\u5199</p> <p>\u67e5\u770b\u90bb\u5c45\u8868 IP\u90bb\u5c45\u79c0 \u6240\u6709\u201cshow\u201d\u547d\u4ee4\u90fd\u652f\u6301-4\u548c-6\u9009\u9879\uff0c\u4ee5\u4ec5\u67e5\u770bIPv4\uff08ARP\uff09\u6216IPv6\uff08NDP\uff09\u90bb\u5c45\u3002\u9ed8\u8ba4\u663e\u793a\u6240\u6709\u7684\u90bb\u5c45</p> <p>\u67e5\u770b\u5355\u4e2a\u754c\u9762\u7684\u90bb\u5c45 ip neighbor show dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor show dev eth0 \u5237\u65b0\u63a5\u53e3\u7684\u8868\u683c ip neighbor flush dev $ {interface name} \u4f8b\u5b50\uff1a IP\u90bb\u5c45\u5237\u65b0\u5f00\u53d1eth1 \u6dfb\u52a0\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip neighbor add $ {\u7f51\u7edc\u5730\u5740} lladdr $ {link layer address} dev $ {interface name} \u4f8b\u5b50\uff1a ip neighbor add 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5176\u4e2d\u4e00\u4e2a\u7528\u4f8b\u662f\u4e3a\u5177\u6709\u7981\u7528ARP\u7684\u63a5\u53e3\u6dfb\u52a0\u9759\u6001\u6761\u76ee\uff0c\u4ee5\u9650\u5236\u5177\u6709\u7279\u5b9aMAC\u5730\u5740\u7684\u4e3b\u673a\u7684\u63a5\u53e3\u4f7f\u7528\u60c5\u51b5</p> <p>\u5220\u9664\u4e00\u4e2a\u90bb\u5c45\u8868\u9879 ip\u90bb\u5c45\u5220\u9664$ {\u7f51\u7edc\u5730\u5740} lladdr $ {\u94fe\u63a5\u5c42\u5730\u5740}\u5f00\u53d1$ {\u63a5\u53e3\u540d\u79f0} \u4f8b\u5b50\uff1a ip neighbor delete 192.0.2.1 lladdr 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f dev eth0 \u5141\u8bb8\u5220\u9664\u9759\u6001\u6761\u76ee\uff0c\u6216\u8005\u5728\u4e0d\u5237\u65b0\u8868\u683c\u7684\u60c5\u51b5\u4e0b\u6446\u8131\u81ea\u52a8\u5b66\u4e60\u7684\u6761\u76ee</p> <p>\u94fe\u63a5\u7ba1\u7406 \u94fe\u63a5\u662f\u7f51\u7edc\u754c\u9762\u7684\u53e6\u4e00\u4e2a\u672f\u8bed\u3002\u6765\u81ea\u201cip link\u201d\u7cfb\u5217\u7684\u547d\u4ee4\u6267\u884c\u6240\u6709\u63a5\u53e3\u7c7b\u578b\u901a\u7528\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u67e5\u770b\u94fe\u63a5\u4fe1\u606f\u6216\u66f4\u6539MTU</p> <p>\u4ece\u5386\u53f2\u4e0a\u770b\uff0c\u201cip link\u201d\u547d\u4ee4\u53ef\u4ee5\u521b\u5efa\u9664\u96a7\u9053\uff08IPIP\uff0cGRE\u7b49\uff09\uff0cL2TPv3\u548cVXLAN\u63a5\u53e3\uff08\u5b83\u4eec\u5404\u81ea\u5177\u6709\u547d\u4ee4\uff09\u4e4b\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\u3002\u5728\u8f83\u65b0\u7684iproute2\u7248\u672c\u4e2d\uff08\u81f3\u5c113.16\uff09\uff0c\u5b83\u4eec\u53ef\u4ee5\u521b\u5efa\u9664L2TPv3\u4ee5\u5916\u7684\u6240\u6709\u7c7b\u578b\u7684\u63a5\u53e3\uff0c\u5c3d\u7ba1\u4f7f\u7528\u7279\u6b8a\u547d\u4ee4\u7cfb\u5217\u5bf9\u5176\u4e2d\u7684\u4e00\u4e9b\u66f4\u52a0\u65b9\u4fbf</p> <p>\u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528\u201cip link add\u201d\u548c\u201cip link set\u201d\u547d\u4ee4\u7684\u201cname $ {name}\u201d\u53c2\u6570\u8bbe\u7f6e\u7684\u63a5\u53e3\u540d\u79f0\u53ef\u80fd\u662f\u4efb\u610f\u7684\uff0c\u751a\u81f3\u53ef\u80fd\u5305\u542bunicode\u5b57\u7b26\u3002\u4f46\u662f\uff0c\u6700\u597d\u575a\u6301\u4f7f\u7528ASCII\uff0c\u56e0\u4e3a\u5176\u4ed6\u7a0b\u5e8f\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u5904\u7406unicode</p> <p>\u53e6\u8bf7\u6ce8\u610f\uff0c\u5176\u4ed6\u7a0b\u5e8f\uff08\u5982iptables\uff09\u53ef\u80fd\u6709\u81ea\u5df1\u7684\u94fe\u63a5\u540d\u79f0\u683c\u5f0f\u548c\u957f\u5ea6\u9650\u5236\uff0c\u6240\u4ee5\u6700\u597d\u4f7f\u7528\u77ed\u7684\u5b57\u6bcd\u6570\u5b57\u540d\u79f0\uff0c\u5e76\u5728\u94fe\u63a5\u522b\u540d\u4e2d\u63d0\u4f9b\u5176\u4ed6\u4fe1\u606f</p> <p>\u663e\u793a\u6709\u5173\u6240\u6709\u94fe\u63a5\u7684\u4fe1\u606f IP\u94fe\u63a5\u663e\u793a IP\u94fe\u63a5\u5217\u8868 \u8fd9\u4e9b\u547d\u4ee4\u662f\u7b49\u4ef7\u7684\uff0c\u53ef\u4ee5\u7528\u4e8e\u76f8\u540c\u7684\u53c2\u6570 \u663e\u793a\u6709\u5173\u7279\u5b9a\u94fe\u63a5\u7684\u4fe1\u606f ip link show dev $ {interface name} \u4f8b\u5b50\uff1a ip link show dev eth0 ip link show dev tun10 \u5355\u8bcd\u201cdev\u201d\u53ef\u4ee5\u7701\u7565 \u4e0a\u4e0b\u94fe\u63a5 ip link set dev $ {interface name} up ip link set dev $ {interface name} down \u4f8b\u5b50\uff1a ip link set dev eth0 down ip\u94fe\u8def\u8bbe\u7f6edev br0 up \u6ce8\u610f\uff1a\u4e0b\u9762\u63cf\u8ff0\u7684\u865a\u62df\u94fe\u8def\uff0c\u5982VLAN\u548c\u7f51\u6865\u5728\u521b\u5efa\u540e\u7acb\u5373\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u4f60\u9700\u8981\u63d0\u9192\u4ed6\u4eec\u5f00\u59cb\u4f7f\u7528\u5b83\u4eec</p> <p>\u8bbe\u7f6e\u4eba\u7c7b\u53ef\u8bfb\u7684\u94fe\u63a5\u63cf\u8ff0 ip link set dev $ {interface name}\u522b\u540d\u201c$ {description}\u201d \u4f8b\u5b50\uff1a ip link set dev eth0\u522b\u540d\u201cLAN\u63a5\u53e3\u201d \u94fe\u63a5\u522b\u540d\u663e\u793a\u5728\u201cip link show\u201d\u8f93\u51fa\u4e2d\uff0c\u5982\uff1a 2\uff1aeth0\uff1a mtu 1500 qdisc mq\u72b6\u6001UP\u6a21\u5f0fDEFAULT qlen 1000     link / ether 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f brd ff\uff1aff\uff1aff\uff1aff\uff1aff\uff1aff     \u522b\u540dLAN\u63a5\u53e3 <p>\u91cd\u547d\u540d\u4e00\u4e2a\u63a5\u53e3 ip link set dev $ {old interface name} name $ {new interface name} \u4f8b\u5b50\uff1a ip link set dev eth0 name lan \u8bf7\u6ce8\u610f\uff0c\u60a8\u4e0d\u80fd\u91cd\u547d\u540d\u6d3b\u52a8\u754c\u9762\u3002\u5728\u505a\u4e4b\u524d\u4f60\u9700\u8981\u628a\u5b83\u653e\u4e0b</p> <p>\u66f4\u6539\u94fe\u8def\u5c42\u5730\u5740\uff08\u901a\u5e38\u662fMAC\u5730\u5740\uff09 ip link set dev $ {interface name} address $ {address} \u94fe\u8def\u5c42\u5730\u5740\u662f\u4e00\u4e2a\u76f8\u5f53\u5e7f\u6cdb\u7684\u6982\u5ff5\u3002\u6700\u7740\u540d\u7684\u4f8b\u5b50\u662f\u4ee5\u592a\u7f51\u8bbe\u5907\u7684MAC\u5730\u5740\u3002\u8981\u6539\u53d8MAC\u5730\u5740\uff0c\u4f60\u9700\u8981\u8fd9\u6837\u7684\u4e1c\u897f\uff1a</p> <p>ip link set dev eth0 address 22\uff1ace\uff1ae0\uff1a99\uff1a63\uff1a6f \u66f4\u6539\u94fe\u63a5MTU ip link set dev $ {interface name} mtu $ {MTU value} \u4f8b\u5b50\uff1a ip link set dev tun0 mtu 1480 MTU\u4ee3\u8868\u201c\u6700\u5927\u4f20\u8f93\u5355\u4f4d\u201d\uff0c\u5373\u63a5\u53e3\u4e00\u6b21\u53ef\u4ee5\u4f20\u8f93\u7684\u6700\u5927\u5e27\u6570</p> <p>\u9664\u4e86\u50cf\u4e0a\u9762\u4f8b\u5b50\u90a3\u6837\u51cf\u5c11\u96a7\u9053\u4e2d\u7684\u5206\u6bb5\u4e4b\u5916\uff0c\u8fd9\u4e5f\u7528\u4e8e\u63d0\u9ad8\u652f\u6301\u6240\u8c13\u7684\u201c\u5de8\u578b\u5e27\u201d\uff08\u6700\u591a9000\u4e2a\u5b57\u8282\u7684\u5e27\uff09\u7684\u5343\u5146\u4ee5\u592a\u7f51\u94fe\u8def\u7684\u6027\u80fd\u3002\u5982\u679c\u4f60\u6240\u6709\u7684\u8bbe\u5907\u90fd\u652f\u6301\u5343\u5146\u4ee5\u592a\u7f51\uff0c\u4f60\u53ef\u80fd\u60f3\u8981\u505a\u7c7b\u4f3c\u7684\u4e8b\u60c5</p> <p>ip link set dev eth0 mtu 9000 \u8bf7\u6ce8\u610f\uff0c\u60a8\u53ef\u80fd\u8fd8\u9700\u8981\u5728L2\u4ea4\u6362\u673a\u4e0a\u914d\u7f6e\u5b83\uff0c\u5176\u4e2d\u4e00\u4e9b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5df2\u5c06\u5176\u7981\u7528</p> <p>\u5220\u9664\u94fe\u63a5 ip link delete dev $ {interface name} \u663e\u7136\uff0c\u53ea\u80fd\u5220\u9664\u50cfVLAN\u6216\u7f51\u6865\u8fd9\u6837\u7684\u865a\u62df\u94fe\u8def</p> <p>\u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u591a\u64ad ip link\u8bbe\u7f6e$ {interface name}\u7ec4\u64ad\u5173\u95ed \u9664\u975e\u4f60\u771f\u7684\u660e\u767d\u4f60\u5728\u505a\u4ec0\u4e48\uff0c\u6700\u597d\u4e0d\u8981\u78b0\u8fd9\u4e2a</p> <p>\u5728\u63a5\u53e3\u4e0a\u542f\u7528\u6216\u7981\u7528ARP ip link\u8bbe\u7f6e$ {interface name} arp ip link\u8bbe\u7f6e$ {interface name} arp off \u4eba\u4eec\u53ef\u80fd\u5e0c\u671b\u7981\u7528ARP\u6765\u5f3a\u5236\u6267\u884c\u5b89\u5168\u7b56\u7565\uff0c\u5e76\u53ea\u5141\u8bb8\u7279\u5b9a\u7684MAC\u4e0e\u63a5\u53e3\u8fdb\u884c\u901a\u4fe1\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u767d\u540d\u5355MAC\u7684\u90bb\u5c45\u8868\u6761\u76ee\u5e94\u624b\u52a8\u521b\u5efa\uff08\u8bf7\u53c2\u89c1\u90bb\u5c45\u8868\u7ba1\u7406 \u90e8\u5206\uff09\uff0c\u5426\u5219\u4ec0\u4e48\u90fd\u4e0d\u80fd\u4e0e\u8be5\u63a5\u53e3\u901a\u4fe1</p> <p>\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6700\u597d\u5728\u63a5\u5165\u5c42\u4ea4\u6362\u673a\u4e0a\u914d\u7f6eMAC\u7b56\u7565\u3002\u9664\u975e\u4f60\u786e\u5b9a\u4f60\u8981\u505a\u4ec0\u4e48\u4ee5\u53ca\u4e3a\u4ec0\u4e48\uff0c\u5426\u5219\u4e0d\u8981\u6539\u53d8\u8fd9\u4e2a\u6807\u5fd7</p> <p>\u521b\u5efa\u4e00\u4e2aVLAN\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {VLAN\u63a5\u53e3\u540d\u79f0}\u94fe\u63a5$ {\u7236\u63a5\u53e3\u540d\u79f0}\u952e\u5165vlan id $ {tag} \u4f8b\u5b50\uff1a ip link add name eth0.110 link eth0 type vlan id 110 Linux\u652f\u6301\u7684\u552f\u4e00VLAN\u7c7b\u578b\u662fIEEE 802.1q VLAN\uff0c\u4e0d\u652f\u6301ISL\u7b49\u4f20\u7edf\u5b9e\u73b0</p> <p>\u4e00\u65e6\u521b\u5efa\u4e86\u4e00\u4e2aVLAN\u63a5\u53e3\uff0c\u6240\u6709\u7531$ {parent interface}\u63a5\u6536\u7684id\u9009\u9879\u4e2d\u6307\u5b9a\u7684$ {tag}\u6807\u8bb0\u7684\u5e27\u5c06\u7531\u8be5VLAN\u63a5\u53e3\u5904\u7406</p> <p>eth0.100\u540d\u79f0\u683c\u5f0f\u662f\u4f20\u7edf\u7684\uff0c\u4f46\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u547d\u540d\u8be5\u63a5\u53e3\uff0c\u5c31\u50cf\u4f7f\u7528\u5176\u4ed6\u63a5\u53e3\u7c7b\u578b\u4e00\u6837</p> <p>VLAN\u53ef\u4ee5\u901a\u8fc7\u7f51\u6865\uff0c\u7ed1\u5b9a\u548c\u5176\u4ed6\u80fd\u591f\u5904\u7406\u4ee5\u592a\u7f51\u5e27\u7684\u63a5\u53e3\u6765\u521b\u5efa</p> <p>\u521b\u5efaQinQ\u63a5\u53e3\uff08VLAN\u5806\u53e0\uff09 ip link add name $ {service interface} link $ {physical interface} type vlan proto 802.1ad id $ {service tag} ip link add name $ {client interface} link $ {service interface}\u8f93\u5165vlan proto 802.1q id $ {client tag} \u4f8b\uff1a ip link add name eth0.100 link eth0 type vlan proto 802.1ad id 100\uff03\u521b\u5efa\u670d\u52a1\u6807\u7b7e\u63a5\u53e3 ip link add name eth0.100.200 link eth0.100 type vlan proto 802.1q id 200\uff03\u521b\u5efa\u5ba2\u6237\u7aef\u6807\u7b7e\u63a5\u53e3 VLAN\u5806\u53e0\uff08\u53c8\u540d802.1ad QinQ\uff09\u662f\u4e00\u79cd\u5728\u53e6\u4e00\u4e2aVLAN\u4e0a\u4f20\u8f93\u5e26VLAN\u6807\u8bb0\u7684\u6d41\u91cf\u7684\u65b9\u6cd5\u3002\u5e38\u89c1\u7684\u7528\u4f8b\u5982\u4e0b\u6240\u793a\uff1a\u5047\u8bbe\u60a8\u662f\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u5e76\u4e14\u60a8\u6709\u4e00\u4f4d\u5ba2\u6237\u60f3\u8981\u4f7f\u7528\u60a8\u7684\u7f51\u7edc\u57fa\u7840\u67b6\u6784\u5c06\u5176\u7f51\u7edc\u7684\u90e8\u5206\u8fde\u63a5\u5230\u5f7c\u6b64\u3002\u4ed6\u4eec\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528\u591a\u4e2aVLAN\uff0c\u56e0\u6b64\u666e\u901a\u7684\u79df\u7528VLAN\u4e0d\u662f\u4e00\u79cd\u9009\u62e9\u3002\u901a\u8fc7\u4f7f\u7528QinQ\uff0c\u60a8\u53ef\u4ee5\u5728\u5ba2\u6237\u6d41\u91cf\u8fdb\u5165\u7f51\u7edc\u65f6\u6dfb\u52a0\u7b2c\u4e8c\u4e2a\u6807\u7b7e\uff0c\u5e76\u5728\u9000\u51fa\u65f6\u5220\u9664\u8be5\u6807\u7b7e\uff0c\u56e0\u6b64\u4e0d\u5b58\u5728\u51b2\u7a81\uff0c\u60a8\u4e0d\u9700\u8981\u6d6a\u8d39VLAN\u7f16\u53f7</p> <p>\u670d\u52a1\u6807\u7b7e\u662f\u63d0\u4f9b\u5546\u7528\u6765\u901a\u8fc7\u7f51\u7edc\u627f\u8f7d\u5ba2\u6237\u7aef\u6d41\u91cf\u7684VLAN\u6807\u7b7e\u3002\u5ba2\u6237\u6807\u7b7e\u662f\u5ba2\u6237\u8bbe\u5b9a\u7684\u6807\u7b7e</p> <p>\u8bf7\u6ce8\u610f\uff0c\u5ba2\u6237\u7aefVLAN\u63a5\u53e3\u7684\u94fe\u8defMTU\u4e0d\u4f1a\u81ea\u52a8\u8c03\u6574\uff0c\u60a8\u9700\u8981\u4eb2\u81ea\u5904\u7406\uff0c\u5e76\u5c06\u5ba2\u6237\u7aef\u63a5\u53e3MTU\u51cf\u5c11\u81f3\u5c114\u4e2a\u5b57\u8282\uff0c\u6216\u76f8\u5e94\u5730\u589e\u52a0\u7236\u6bcdMTU</p> <p>\u7b26\u5408\u6807\u51c6\u7684QinQ\u81eaLinux 3.10\u8d77\u53ef\u7528</p> <p>\u521b\u5efa\u4f2a\u4ee5\u592a\u7f51\uff08aka macvlan\uff09\u63a5\u53e3 ip link add name $ {macvlan interface name} link $ {parent interface}\u952e\u5165macvlan \u4f8b\u5b50\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0peth0\u94fe\u63a5eth0\u7c7b\u578bmacvlan \u60a8\u53ef\u4ee5\u5c06macvlan\u63a5\u53e3\u89c6\u4e3a\u7236\u63a5\u53e3\u4e0a\u7684\u9644\u52a0\u865a\u62dfMAC\u5730\u5740\u3002\u4ece\u7528\u6237\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5b83\u4eec\u770b\u8d77\u6765\u50cf\u666e\u901a\u7684\u4ee5\u592a\u7f51\u63a5\u53e3\uff0c\u5e76\u5904\u7406\u6240\u6709\u901a\u4fe1\u7684MAC\u5730\u5740\uff0c\u8fd9\u4e9bMAC\u5730\u5740\u662f\u901a\u8fc7\u5176\u7236\u63a5\u53e3\u5206\u914d\u7684</p> <p>\u8fd9\u901a\u5e38\u7528\u4e8e\u6d4b\u8bd5\uff0c\u6216\u8005\u5f53\u53ea\u6709\u4e00\u4e2a\u7269\u7406\u63a5\u53e3\u53ef\u7528\u65f6\uff0c\u4f7f\u7528\u7531MAC\u6807\u8bc6\u7684\u591a\u4e2a\u670d\u52a1\u5b9e\u4f8b</p> <p>\u5b83\u4eec\u4e5f\u53ef\u4ee5\u7528\u4e8eIP\u5730\u5740\u5206\u9694\uff0c\u800c\u4e0d\u662f\u5c06\u591a\u4e2a\u5730\u5740\u5206\u914d\u7ed9\u76f8\u540c\u7684\u7269\u7406\u63a5\u53e3\uff0c\u7279\u522b\u662f\u5982\u679c\u67d0\u4e9b\u670d\u52a1\u65e0\u6cd5\u6b63\u786e\u64cd\u4f5c\u8f85\u52a9\u5730\u5740</p> <p>\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u63a5\u53e3 ip link add name $ {dummy interface name} type dummy \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0dummy0\u7c7b\u578b\u865a\u62df Dummy\u63a5\u53e3\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e0eLoopback\u63a5\u53e3\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u9700\u8981\u5c3d\u53ef\u80fd\u591a\u7684\u63a5\u53e3\u5373\u53ef</p> <p>\u5b83\u4eec\u7684\u7b2c\u4e00\u4e2a\u76ee\u7684\u662f\u5728\u4e3b\u673a\u5185\u90e8\u8fdb\u884c\u7a0b\u5e8f\u7684\u901a\u4fe1</p> <p>\u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\u5229\u7528\u4ed6\u4eec\u603b\u662f\u8d77\u6765\u7684\u4e8b\u5b9e\uff08\u9664\u975e\u5728\u884c\u653f\u4e0a\u88ab\u5265\u593a\uff09\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u5728\u5177\u6709\u591a\u4e2a\u7269\u7406\u63a5\u53e3\u7684\u8def\u7531\u5668\u4e0a\u4e3a\u5b83\u4eec\u5206\u914d\u670d\u52a1\u5730\u5740\u3002\u53ea\u8981\u5206\u914d\u7ed9\u56de\u9001\u6216\u4f2a\u63a5\u53e3\u7684\u5730\u5740\u7684\u6d41\u91cf\u8def\u7531\u5230\u62e5\u6709\u5b83\u7684\u673a\u5668\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u7684\u4efb\u4f55\u63a5\u53e3\u8bbf\u95ee\u5b83</p> <p>\u521b\u5efa\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u6865\u540d\u79f0}\u7c7b\u578b\u6865 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0br0\u7c7b\u578b\u6865 \u7f51\u6865\u63a5\u53e3\u662f\u865a\u62df\u4ee5\u592a\u7f51\u4ea4\u6362\u673a\u3002\u5b83\u4eec\u53ef\u4ee5\u7528\u4e8e\u5728\u4ee5\u592a\u7f51\u63a5\u53e3\u4e4b\u95f4\u900f\u660e\u5730\u4e2d\u7ee7\u6d41\u91cf\uff0c\u5e76\u4e14\u8d8a\u6765\u8d8a\u666e\u904d\u5730\u7528\u4f5c\u8fd0\u884c\u5728\u7ba1\u7406\u7a0b\u5e8f\u5185\u90e8\u7684\u865a\u62df\u673a\u7684\u4ee5\u592a\u7f51\u4ea4\u6362\u673a</p> <p>\u60a8\u53ef\u4ee5\u5c06\u4e00\u4e2aIP\u5730\u5740\u5206\u914d\u7ed9\u4e00\u4e2a\u7f51\u6865\uff0c\u5e76\u4e14\u5b83\u5c06\u4ece\u6240\u6709\u7f51\u6865\u7aef\u53e3\u53ef\u89c1</p> <p>\u5982\u679c\u6b64\u547d\u4ee4\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u662f\u5426\u52a0\u8f7d\u4e86\u201c\u7f51\u6865\u201d\u6a21\u5757</p> <p>\u6dfb\u52a0\u4e00\u4e2a\u6865\u63a5\u63a5\u53e3 ip link set dev $ {interface name} master $ {bridge name} \u4f8b\u5b50\uff1a ip link set dev eth0 master br0 \u60a8\u6dfb\u52a0\u5230\u7f51\u6865\u7684\u63a5\u53e3\u5c06\u6210\u4e3a\u865a\u62df\u4ea4\u6362\u673a\u7aef\u53e3\u3002\u5b83\u4ec5\u5728\u6570\u636e\u94fe\u8def\u5c42\u4e0a\u8fd0\u884c\u5e76\u505c\u6b62\u6240\u6709\u7f51\u7edc\u5c42\u7684\u64cd\u4f5c</p> <p>\u4ece\u6865\u4e0a\u5220\u9664\u63a5\u53e3 ip link set dev $ {interface name} nomaster \u4f8b\u5b50\uff1a ip link set dev eth0 nomaster \u521b\u5efa\u4e00\u4e2a\u7ed1\u5b9a\u754c\u9762 IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u540d\u79f0}\u952e\u5165\u503a\u5238 \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0bond1\u7c7b\u578b\u7684\u503a\u5238 \u6ce8\u610f\uff1a\u8fd9\u4e0d\u8db3\u4ee5\u4ee5\u4efb\u4f55\u6709\u610f\u4e49\u7684\u65b9\u5f0f\u914d\u7f6e\u7ed1\u5b9a\uff08\u94fe\u63a5\u805a\u5408\uff09\u3002\u60a8\u9700\u8981\u6839\u636e\u60a8\u7684\u60c5\u51b5\u8bbe\u7f6e\u7c98\u5408\u53c2\u6570\u3002\u8fd9\u8fdc\u8fdc\u8d85\u51fa\u4e86\u5907\u5fd8\u5355\u8303\u56f4\uff0c\u56e0\u6b64\u8bf7\u67e5\u9605\u6587\u6863</p> <p>\u63a5\u53e3\u4ee5\u4e0e\u6865\u63a5\u7ec4\u76f8\u540c\u7684\u65b9\u5f0f\u6dfb\u52a0\u5230\u7ed1\u5b9a\u7ec4\uff0c\u8bf7\u6ce8\u610f\uff0c\u9664\u975e\u60a8\u5c06\u5176\u5173\u95ed\uff0c\u5426\u5219\u65e0\u6cd5\u6dfb\u52a0\u5b83</p> <p>\u521b\u5efa\u4e00\u4e2a\u4e2d\u95f4\u529f\u80fd\u5757\u63a5\u53e3 ip link add $ {interface name}\u952e\u5165ifb \u4f8b\uff1a ip\u94fe\u63a5\u6dfb\u52a0ifb10\u7c7b\u578bifb \u4e2d\u95f4\u529f\u80fd\u5757\u8bbe\u5907\u4e0etc\u4e00\u8d77\u7528\u4e8e\u6d41\u91cf\u91cd\u5b9a\u5411\u548c\u955c\u50cf\u3002\u8fd9\u4e5f\u8d85\u51fa\u4e86\u672c\u6587\u6863\u7684\u8303\u56f4\uff0c\u8bf7\u53c2\u9605tc\u6587\u6863</p> <p>\u521b\u5efa\u4e00\u5bf9\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907 \u865a\u62df\u4ee5\u592a\u7f51\uff08veth\uff09\u8bbe\u5907\u603b\u662f\u6210\u5bf9\u51fa\u73b0\uff0c\u5e76\u4e14\u4f5c\u4e3a\u53cc\u5411\u7ba1\u9053\u5de5\u4f5c\uff0c\u4e0d\u7ba1\u8fdb\u5165\u5176\u4e2d\u7684\u54ea\u4e00\u4e2a\uff0c\u90fd\u4f1a\u4ece\u53e6\u4e00\u4e2a\u7ba1\u9053\u51fa\u6765\u3002\u5b83\u4eec\u4e0e\u7cfb\u7edf\u5206\u533a\u529f\u80fd\uff08\u5982\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u548c\u5bb9\u5668\uff08OpenVZ\u548cLXC\uff09\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u4e00\u4e2a\u5206\u533a\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u5206\u533a</p> <p>IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0$ {\u7b2c\u4e00\u4e2a\u8bbe\u5907\u540d\u79f0}\u7c7b\u578bveth peer name $ {\u7b2c\u4e8c\u4e2a\u8bbe\u5907\u540d\u79f0} \u4f8b\u5b50\uff1a IP\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth-host\u7c7b\u578bveth\u5bf9\u7b49\u540d\u79f0veth-guest \u6ce8\u610f\uff1a\u865a\u62df\u4ee5\u592a\u7f51\u8bbe\u5907\u662f\u5728UP\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u4e0d\u9700\u8981\u5728\u521b\u5efa\u540e\u624b\u52a8\u542f\u52a8\u5b83\u4eec</p> <p>\u94fe\u63a5\u7ec4\u7ba1\u7406 \u94fe\u63a5\u7ec4\u4e0e\u7ba1\u7406\u578b\u4ea4\u6362\u673a\u4e2d\u7684\u7aef\u53e3\u8303\u56f4\u7c7b\u4f3c\u3002\u60a8\u53ef\u4ee5\u5c06\u7f51\u7edc\u63a5\u53e3\u6dfb\u52a0\u5230\u7f16\u53f7\u7ec4\uff0c\u5e76\u7acb\u5373\u5728\u8be5\u7ec4\u7684\u6240\u6709\u63a5\u53e3\u4e0a\u6267\u884c\u64cd\u4f5c</p> <p>\u672a\u5206\u914d\u7ed9\u4efb\u4f55\u7ec4\u7684\u94fe\u63a5\u5c5e\u4e8e\u7ec40\uff0c\u4e5f\u79f0\u4e3a\u201c\u9ed8\u8ba4\u201d</p> <p>\u5c06\u754c\u9762\u6dfb\u52a0\u5230\u7ec4 ip link set dev $ {interface name} group $ {group number} \u4f8b\u5b50\uff1a ip link set dev eth0 group 42 ip link set dev eth1 group 42 \u4ece\u7ec4\u4e2d\u5220\u9664\u4e00\u4e2a\u63a5\u53e3 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176\u5206\u914d\u7ed9\u9ed8\u8ba4\u7ec4\u6765\u5b8c\u6210</p> <p>ip link set dev $ {interface name} group 0 ip link set dev $ {interface}\u7ec4\u9ed8\u8ba4\u503c \u4f8b\u5b50\uff1a ip link set dev tun10 group 0 \u4e3a\u7ec4\u5206\u914d\u4e00\u4e2a\u7b26\u53f7\u540d\u79f0 \u7ec4\u540d\u5b58\u50a8\u5728/ etc / iproute2 / group\u6587\u4ef6\u4e2d\u3002\u7ec40\u7684\u7b26\u53f7\u540d\u79f0\u201cdefault\u201d\u6070\u597d\u6765\u81ea\u90a3\u91cc\u3002\u60a8\u53ef\u4ee5\u6309\u7167\u76f8\u540c\u7684\u201c$ {number} $ {name}\u201d\u683c\u5f0f\u6dfb\u52a0\u60a8\u81ea\u5df1\u7684\uff0c\u6bcf\u884c\u4e00\u4e2a\u3002\u60a8\u6700\u591a\u53ef\u4ee5\u6709255\u4e2a\u547d\u540d\u7ec4</p> <p>\u4e00\u65e6\u914d\u7f6e\u4e86\u7ec4\u540d\uff0c\u5728ip\u547d\u4ee4\u4e2d\u53ef\u4ee5\u4ea4\u6362\u4f7f\u7528\u6570\u5b57\u548c\u540d\u79f0</p> <p>\u4f8b\uff1a echo\u201c10 customer-vlans\u201d&gt;&gt; / etc / iproute2 / group \u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u6240\u6709\u64cd\u4f5c\u4e2d\u4f7f\u7528\u8be5\u540d\u79f0\uff0c\u4f8b\u5982 ip link set dev eth0.100 group customer-vlans \u5bf9\u7ec4\u6267\u884c\u64cd\u4f5c ip link set group $ {group number} $ {operation and arguments} \u4f8b\u5b50\uff1a IP\u94fe\u8def\u8bbe\u7f6e\u7ec442\u5411\u4e0b ip\u94fe\u8def\u8bbe\u7f6e\u7ec4\u4e0a\u884c\u94fe\u8defmtu 1200 \u67e5\u770b\u6765\u81ea\u7279\u5b9a\u7ec4\u7684\u94fe\u63a5\u7684\u4fe1\u606f \u4f7f\u7528\u901a\u5e38\u7684\u4fe1\u606f\u67e5\u770b\u547d\u4ee4\u548c\u201cgroup $ {group}\u201d\u4fee\u9970\u7b26</p> <p>\u4f8b\u5b50\uff1a IP\u94fe\u8def\u5217\u8868\u7ec442 IP\u5730\u5740\u663e\u793a\u7ec4\u5ba2\u6237 Tun\u548cTap\u8bbe\u5907 Tun\u548ctap\u8bbe\u5907\u5141\u8bb8\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6a21\u62df\u7f51\u7edc\u8bbe\u5907\u3002\u5f53\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u6253\u5f00\u5b83\u4eec\u65f6\uff0c\u5b83\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4ece\u5185\u6838\u7f51\u7edc\u5806\u6808\u8def\u7531\u5230\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e2d\u8bfb\u53d6\uff0c\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5199\u5165\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u6570\u636e\u5c06\u4f5c\u4e3a\u672c\u5730\u4f20\u51fa\u6570\u636e\u5305\u6ce8\u5165\u5230\u7f51\u7edc\u5806\u6808\u4e2d\u3002\u4e24\u8005\u7684\u533a\u522b\u5728\u4e8e\uff1a</p> <p>\u70b9\u51fb\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cb\u4ee5\u592a\u7f51\u5e27 tun\u53d1\u9001\u5e76\u63a5\u6536\u539f\u59cbIP\u6570\u636e\u5305 \u6709\u4e24\u79cd\u7c7b\u578b\u7684tun / tap\u8bbe\u5907\uff1apersistent\u548ctransient\u3002\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u5728\u6253\u5f00\u7279\u6b8a\u8bbe\u5907\u65f6\u521b\u5efa\u77ac\u65f6tun / tap\u8bbe\u5907\uff0c\u5e76\u5728\u5173\u8054\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5173\u95ed\u65f6\u81ea\u52a8\u9500\u6bc1\u3002\u8fd9\u91cc\u5217\u51fa\u7684\u547d\u4ee4\u64cd\u7eb5\u6301\u4e45\u6027\u8bbe\u5907</p> <p>\u67e5\u770btun / tap\u8bbe\u5907 ip tuntap\u663e\u793a \u6ce8\u610f\uff1a\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7f29\u5199\u4e3a\u201cip tuntap\u201d</p> <p>\u8be5\u547d\u4ee4\u662f\u67e5\u660e\u67d0\u4e2a\u8bbe\u5907\u662f\u5904\u4e8etun\u8fd8\u662ftap\u6a21\u5f0f\u7684\u552f\u4e00\u65b9\u6cd5</p> <p>\u6dfb\u52a0\u53ef\u4f9broot\u7528\u6237\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} \u4f8b\u5b50\uff1a ip tuntap add dev tun0\u6a21\u5f0f ip tuntap add dev tap9\u6a21\u5f0f\u70b9\u51fb \u6dfb\u52a0\u666e\u901a\u7528\u6237\u53ef\u4f7f\u7528\u7684tun / tap\u8bbe\u5907 ip tuntap add dev $ {interface name} mode $ {mode} user $ {user} group $ {group} \u4f8b\uff1a ip tuntap add dev tun1\u6a21\u5f0ftun\u7528\u6237\u6211\u7ec4mygroup ip tuntap add dev tun2 mode tun user 1000 group 1001 \u4f7f\u7528\u5907\u7528\u6570\u636e\u5305\u683c\u5f0f\u6dfb\u52a0tun / tap\u8bbe\u5907 \u5c06\u5143\u4fe1\u606f\u6dfb\u52a0\u5230\u901a\u8fc7\u6587\u4ef6\u63cf\u8ff0\u7b26\u63a5\u6536\u7684\u6bcf\u4e2a\u6570\u636e\u5305\u3002\u5f88\u5c11\u6709\u7a0b\u5e8f\u671f\u671b\u8fd9\u4e9b\u4fe1\u606f\uff0c\u5305\u62ec\u5b83\u5728\u4e0d\u671f\u671b\u7684\u60c5\u51b5\u4e0b\u4f1a\u7834\u574f\u4e8b\u60c5</p> <p>ip tuntap add dev $ {interface name} mode $ {mode} pi \u4f8b\uff1a ip tuntap add dev tun1 mode tun pi \u6dfb\u52a0\u5ffd\u7565\u6d41\u91cf\u63a7\u5236\u7684tun / tap \u901a\u5e38\uff0c\u53d1\u9001\u5230tun / tap\u8bbe\u5907\u7684\u6570\u636e\u5305\u4ee5\u4e0e\u53d1\u9001\u5230\u4efb\u4f55\u5176\u4ed6\u8bbe\u5907\u7684\u6570\u636e\u5305\u76f8\u540c\u7684\u65b9\u5f0f\u4f20\u64ad\uff1a\u5b83\u4eec\u88ab\u7f6e\u4e8e\u7531\u6d41\u91cf\u63a7\u5236\u5f15\u64ce\uff08\u7531tc\u547d\u4ee4\u914d\u7f6e\uff09\u5904\u7406\u7684\u961f\u5217\u4e2d\u3002\u8fd9\u53ef\u4ee5\u88ab\u7ed5\u8fc7\uff0c\u4ece\u800c\u7981\u7528\u8be5tun / tap\u8bbe\u5907\u7684\u6d41\u91cf\u63a7\u5236\u5f15\u64ce</p> <p>ip tuntap add dev $ {interface name} mode $ {mode} one_queue \u4f8b\uff1a ip tuntap add dev tun1 mode tun one_queue \u5220\u9664tun / tap\u8bbe\u5907 ip tuntap del dev $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0f$ {mode} \u4f8b\u5b50\uff1a ip tuntap\u5220\u9664dev tun0\u6a21\u5f0ftun ip tuntap\u5220\u9664dev tap1\u6a21\u5f0f\u70b9\u51fb \u6ce8\u610f\uff1a\u60a8\u5fc5\u987b\u6307\u5b9a\u6a21\u5f0f\u3002\u8be5\u6a21\u5f0f\u4e0d\u4f1a\u663e\u793a\u5728\u201cip link show\u201d\u4e2d\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u5b83\u662fTUN\u8fd8\u662fTAP\uff0c\u8bf7\u53c2\u9605\u201cip tuntap show\u201d\u7684\u8f93\u51fa</p> <p>\u96a7\u9053\u7ba1\u7406 \u96a7\u9053\u662f\u770b\u8d77\u6765\u50cf\u666e\u901a\u63a5\u53e3\u7684\u201c\u7f51\u7edc\u866b\u6d1e\u201d\uff0c\u4f46\u901a\u8fc7\u5b83\u4eec\u53d1\u9001\u7684\u6570\u636e\u5305\u88ab\u5c01\u88c5\u5230\u53e6\u4e00\u4e2a\u534f\u8bae\u4e2d\uff0c\u5e76\u901a\u8fc7\u591a\u4e2a\u4e3b\u673a\u53d1\u9001\u5230\u96a7\u9053\u7684\u53e6\u4e00\u7aef\uff0c\u7136\u540e\u6309\u7167\u901a\u5e38\u7684\u65b9\u5f0f\u8fdb\u884c\u89e3\u5c01\u88c5\u548c\u5904\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5047\u88c5\u4e24\u53f0\u673a\u5668\u6709\u76f4\u63a5\u7684\u8fde\u901a\u6027\uff0c\u800c\u4ed6\u4eec\u5b9e\u9645\u4e0a\u6ca1\u6709</p> <p>\u8fd9\u901a\u5e38\u7528\u4e8e\u865a\u62df\u4e13\u7528\u7f51\u7edc\uff08\u4e0eIPsec\u4e4b\u7c7b\u7684\u52a0\u5bc6\u4f20\u8f93\u534f\u8bae\u7ed3\u5408\u4f7f\u7528\uff09\uff0c\u6216\u901a\u8fc7\u4e0d\u4f7f\u7528\u5b83\u7684\u4e2d\u95f4\u7f51\u7edc\u8fde\u63a5\u4f7f\u7528\u67d0\u79cd\u534f\u8bae\u7684\u7f51\u7edc\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4ec5\u652f\u6301IPv4\u7684\u7f51\u6bb5\u5206\u9694\u7684IPv6\u7f51\u7edc\uff09</p> <p>\u6ce8\u610f\uff1a\u96a7\u9053\u81ea\u5df1\u63d0\u4f9b\u96f6\u5b89\u5168\u6027\u3002\u5b83\u4eec\u4e0e\u5176\u5e95\u5c42\u7f51\u7edc\u4e00\u6837\u5b89\u5168\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u9700\u8981\u5b89\u5168\u6027\uff0c\u8bf7\u901a\u8fc7\u52a0\u5bc6\u4f20\u8f93\uff08\u4f8b\u5982IPsec\uff09\u4f7f\u7528\u5b83\u4eec</p> <p>Linux\u76ee\u524d\u652f\u6301IPIP\uff08IPv4\u4e2d\u7684IPv4\uff09\uff0cSIT\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cIP6IP6\uff08IPv6\u4e2d\u7684IPv6\uff09\uff0cIPIP6\uff08IPv4\u4e2d\u7684IPv6\uff09\uff0cGRE\uff08\u51e0\u4e4e\u4efb\u4f55\u4e1c\u897f\uff09\u4ee5\u53ca\u6700\u8fd1\u7684\u7248\u672c\u4e2d\u7684VTI IPsec\uff09\u7684</p> <p>\u8bf7\u6ce8\u610f\uff0c\u96a7\u9053\u662f\u5728DOWN\u72b6\u6001\u4e0b\u521b\u5efa\u7684\uff0c\u60a8\u9700\u8981\u5c06\u5b83\u4eec\u63d0\u8d77</p> <p>\u5728\u672c\u8282\u4e2d\uff0c$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u548c$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u662f\u6307\u5206\u914d\u7ed9\u7aef\u70b9\u7269\u7406\u63a5\u53e3\u7684\u5730\u5740\u3002$ {address}\u662f\u6307\u5206\u914d\u7ed9tunnel\u63a5\u53e3\u7684\u5730\u5740</p> <p>\u521b\u5efa\u4e00\u4e2aIPIP\u96a7\u9053 ip tunnel add $ {interface name}\u6a21\u5f0fipip local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun0 mode ipip local 192.0.2.1 remote 198.51.100.3 ip link set dev tun0 up ip address add 10.0.0.1/30 dev tun0 \u521b\u5efa\u4e00\u4e2aSIT\u96a7\u9053 sudo ip tunnel add $ {interface name}\u6a21\u5f0f\u5750\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun9\u6a21\u5f0f\u5750\u672c\u5730192.0.2.1\u8fdc\u7a0b198.51.100.3 ip link set dev tun9 up ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun9 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u901a\u5e38\u7528\u4e8e\u4e3aIPv4\u8fde\u63a5\u7684\u7f51\u7edc\u63d0\u4f9bIPv6\u8fde\u63a5\u3002\u6709\u6240\u8c13\u7684\u201c\u96a7\u9053\u7ecf\u7eaa\u4eba\u201d\u63d0\u4f9b\u7ed9\u6240\u6709\u611f\u5174\u8da3\u7684\u4eba\uff0c\u5982Hurricane Electric tunnelbroker.net</p> <p>\u521b\u5efa\u4e00\u4e2aIPIP6\u96a7\u9053  ip -6 tunnel add $ {interface name}\u6a21\u5f0fipip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun8 mode ipip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u5728\u4e2d\u8f6c\u8fd0\u8425\u5546\u5206\u9636\u6bb5IPv4\uff08\u5373\u4e0d\u4f1a\u5f88\u5feb\uff09\u65f6\u5e7f\u6cdb\u4f7f\u7528</p> <p>\u521b\u5efa\u4e00\u4e2aIP6IP6\u96a7\u9053 ip -6 tunnel add $ {interface name}\u6a21\u5f0fip6ip6 local $ {\u672c\u5730\u7aef\u70b9\u5730\u5740} remote $ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip -6 tunnel add tun3 mode ip6ip6 local 2001\uff1adb8\uff1a1 :: 1 remote 2001\uff1adb8\uff1a1 :: 2 ip\u94fe\u63a5\u8bbe\u7f6edev tun3 up ip address add 2001\uff1adb8\uff1a2\uff1a2 :: 1/64 dev tun3 \u5c31\u50cfIPIP6\u4e00\u6837\uff0c\u8fd9\u4e9b\u4e0d\u4f1a\u5f88\u5feb\u6709\u7528</p> <p>\u521b\u5efa\u4e00\u4e2agretap\uff08\u4ee5\u592a\u7f51over GRE\uff09\u8bbe\u5907 IP\u94fe\u63a5\u6dfb\u52a0$ {\u63a5\u53e3\u540d\u79f0}\u7c7b\u578bgretap\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip link add gretap0 type gretap local 192.0.2.1 remote 203.0.113.3 \u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5c06\u4ee5\u592a\u7f51\u5e27\u5c01\u88c5\u4e3aIPv4\u6570\u636e\u5305</p> <p>\u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u4e5f\u652f\u6301IPv6\u4e0a\u7684gretap\uff0c\u4f60\u9700\u8981\u7528\u201cip6gretap\u201d\u66ff\u6362\u6a21\u5f0f\u6765\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8eIPv6\u7684\u94fe\u63a5</p> <p>\u8fd9\u53ef\u80fd\u5e94\u8be5\u662f\u5728\u201c\u94fe\u63a5\u7ba1\u7406\u201d\u90e8\u5206\uff0c\u4f46\u7531\u4e8e\u5b83\u6d89\u53ca\u5c01\u88c5\uff0c\u5b83\u5728\u8fd9\u91cc\u3002\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u7684\u96a7\u9053\u63a5\u53e3\u770b\u8d77\u6765\u50cf\u4e00\u4e2aL2\u94fe\u8def\uff0c\u5e76\u4e14\u53ef\u4ee5\u5c06\u5176\u6dfb\u52a0\u5230\u6865\u7ec4\u3002\u8fd9\u7528\u4e8e\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u8fde\u63a5L2\u6bb5</p> <p>\u521b\u5efa\u4e00\u4e2aGRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip tunnel add tun6 mode gre local 192.0.2.1 remote 203.0.113.3 ip\u94fe\u63a5\u8bbe\u7f6edev tun6 up ip address add 192.168.0.1/30 dev tun6 ip address add 2001\uff1adb8\uff1a1 :: 1/64 dev tun6 GRE\u53ef\u4ee5\u540c\u65f6\u5c01\u88c5IPv4\u548cIPv6\u3002\u4f46\u662f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f7f\u7528IPv4\u8fdb\u884c\u4f20\u8f93\uff0c\u5bf9\u4e8e\u57fa\u4e8eIPv6\u7684GRE\uff0c\u5b58\u5728\u5355\u72ec\u7684\u96a7\u9053\u6a21\u5f0f\u201cip6gre\u201d</p> <p>\u521b\u5efa\u591a\u4e2aGRE\u96a7\u9053\u5230\u540c\u4e00\u4e2a\u7aef\u70b9 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u952e$ {\u952e\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun4 mode gre local 192.0.2.1 remote 203.0.113.6 key 123 ip tunnel add tun5 mode gre local 192.0.2.1 remote 203.0.113.6 key 124 \u952e\u63a7\u96a7\u9053\u4e5f\u53ef\u4ee5\u540c\u65f6\u4f7f\u7528\u6765\u89e3\u9664\u5bc6\u7801\u3002\u5bc6\u94a5\u53ef\u80fd\u91c7\u7528\u70b9\u5206\u5341\u8fdb\u5236IPv4\u7c7b\u683c\u5f0f</p> <p>\u8bf7\u6ce8\u610f\uff0c\u5bc6\u94a5\u4e0d\u4f1a\u4e3a\u96a7\u9053\u6dfb\u52a0\u4efb\u4f55\u5b89\u5168\u6027\u3002\u8fd9\u53ea\u662f\u4e00\u4e2a\u7528\u6765\u533a\u5206\u4e00\u6761\u96a7\u9053\u548c\u53e6\u4e00\u6761\u96a7\u9053\u7684\u6807\u8bc6\u7b26</p> <p>\u521b\u5efa\u4e00\u4e2a\u70b9\u5bf9\u591a\u70b9\u7684GRE\u96a7\u9053 ip tunnel add $ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fgre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740}\u5bc6\u94a5$ {\u5bc6\u94a5\u503c} \u4f8b\u5b50\uff1a ip tunnel add tun8 mode gre local 192.0.2.1 key 1234 ip\u94fe\u63a5\u8bbe\u7f6edev tun8 up ip address add 10.0.0.1/27 dev tun8 \u8bf7\u6ce8\u610f\u7f3a\u5c11$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740}\u3002\u8fd9\u4e0eCisco IOS\u4e2d\u6240\u8c13\u7684\u201cmode gre multipoint\u201d\u76f8\u540c</p> <p>\u5728\u6ca1\u6709\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\u7684\u60c5\u51b5\u4e0b\uff0c\u5bc6\u94a5\u662f\u8bc6\u522b\u96a7\u9053\u6d41\u91cf\u7684\u552f\u4e00\u65b9\u6cd5\uff0c\u56e0\u6b64\u9700\u8981$ {key value}</p> <p>\u8fd9\u79cd\u7c7b\u578b\u7684\u96a7\u9053\u5141\u8bb8\u60a8\u901a\u8fc7\u4f7f\u7528\u76f8\u540c\u7684\u96a7\u9053\u63a5\u53e3\u4e0e\u591a\u4e2a\u7aef\u70b9\u8fdb\u884c\u901a\u4fe1\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5177\u6709\u591a\u4e2a\u7aef\u70b9\u7684\u590d\u6742VPN\u8bbe\u7f6e\uff08\u5728\u601d\u79d1\u672f\u8bed\u4e2d\u79f0\u4e3a\u201c\u52a8\u6001\u591a\u70b9VPN\u201d\uff09</p> <p>\u7531\u4e8e\u6ca1\u6709\u660e\u786e\u7684\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740\uff0c\u663e\u7136\u4ec5\u4ec5\u521b\u5efa\u96a7\u9053\u662f\u4e0d\u591f\u7684\u3002\u4f60\u7684\u7cfb\u7edf\u9700\u8981\u77e5\u9053\u5176\u4ed6\u7aef\u70b9\u5728\u54ea\u91cc</p> <p>\u5728\u73b0\u5b9e\u751f\u6d3b\u4e2d\uff0c\u4f7f\u7528NHRP\uff08\u4e0b\u4e00\u8df3\u89e3\u6790\u534f\u8bae\uff09\u3002\u5bf9\u4e8e\u6d4b\u8bd5\uff0c\u60a8\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u5bf9\u7b49\u7aef\uff08\u7ed9\u5b9a\u8fdc\u7a0b\u7aef\u70b9\u5728\u5176\u7269\u7406\u63a5\u53e3\u4e0a\u4f7f\u7528203.0.113.6\u5730\u5740\uff0c\u5728\u96a7\u9053\u4e0a\u4f7f\u752810.0.0.2\uff09\uff1a</p> <p>ip neighbor add 10.0.0.2 lladdr 203.0.113.6 dev tun8 \u60a8\u4e5f\u5fc5\u987b\u5728\u8fdc\u7a0b\u7aef\u70b9\u4e0a\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u4f8b\u5982\uff1a</p> <p>ip neighbor add 10.0.0.1 lladdr 192.0.2.1 dev tun8 \u8bf7\u6ce8\u610f\uff0c\u94fe\u8def\u5c42\u5730\u5740\u548c\u90bb\u5c45\u5730\u5740\u90fd\u662fIP\u5730\u5740\uff0c\u56e0\u6b64\u5b83\u4eec\u4f4d\u4e8e\u540c\u4e00\u4e2aOSI\u5c42\u3002\u94fe\u8def\u5c42\u5730\u5740\u6982\u5ff5\u53d8\u5f97\u6709\u8da3\u7684\u60c5\u51b5\u4e4b\u4e00</p> <p>\u901a\u8fc7IPv6\u521b\u5efaGRE\u96a7\u9053 \u6700\u8fd1\u7684\u5185\u6838\u548ciproute2\u7248\u672c\u652f\u6301GRE over IPv6\u3002\u6ca1\u6709\u5bc6\u94a5\u7684\u70b9\u5bf9\u70b9\uff1a</p> <p>ip-6\u96a7\u9053\u6dfb\u52a0\u540d\u79f0$ {\u63a5\u53e3\u540d\u79f0}\u6a21\u5f0fip6gre\u672c\u5730$ {\u672c\u5730\u7aef\u70b9}\u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9} \u5b83\u5e94\u8be5\u652f\u6301\u4e0a\u8ff0IPv4 GRE\u652f\u6301\u7684\u6240\u6709\u9009\u9879\u548c\u529f\u80fd</p> <p>\u5220\u9664\u96a7\u9053 ip tunnel del $ {interface name} \u4f8b\u5b50\uff1a ip tunnel del gre1 \u8bf7\u6ce8\u610f\uff0c\u5728\u8f83\u65e7\u7684iproute2\u7248\u672c\u4e2d\uff0c\u6b64\u547d\u4ee4\u4e0d\u652f\u6301\u5b8c\u6574\u7684\u201c\u5220\u9664\u201d\u5b57\uff0c\u53ea\u6709\u201cdel\u201d\u3002\u6700\u8fd1\u7684\u7248\u672c\u5141\u8bb8\u5168\u90e8\u548c\u7f29\u5199\u5f62\u5f0f\uff08\u5728iproute2-ss131122\u4e2d\u6d4b\u8bd5\uff09</p> <p>\u4fee\u6539\u96a7\u9053 IP\u96a7\u9053\u66f4\u6539$ {\u63a5\u53e3\u540d\u79f0} $ {\u9009\u9879} \u4f8b\u5b50\uff1a ip tunnel change tun0 remote 203.0.113.89 ip\u96a7\u9053\u66f4\u6539tun10\u5bc6\u94a523456 \u6ce8\u610f\uff1a\u663e\u7136\uff0c\u60a8\u65e0\u6cd5\u5c06\u5bc6\u94a5\u6dfb\u52a0\u5230\u4e4b\u524d\u672a\u52a0\u5bc6\u7684\u96a7\u9053\u3002\u4e0d\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u9519\u8bef\u8fd8\u662f\u4e00\u4e2a\u529f\u80fd\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u663e\u800c\u6613\u89c1\u7684\u539f\u56e0\uff0c\u60a8\u65e0\u6cd5\u5373\u65f6\u66f4\u6539\u96a7\u9053\u6a21\u5f0f</p> <p>\u67e5\u770b\u96a7\u9053\u4fe1\u606f IP\u96a7\u9053\u8868\u6f14 ip tunnel show $ {interface name} \u4f8b\u5b50\uff1a $ ip tun show tun99 tun99\uff1agre / ip remote 10.46.1.20 local 10.91.19.110 ttl inherit</p> <p>L2TPv3\u4f2a\u7ebf\u7ba1\u7406 L2TPv3\u662fL2\u4f2a\u7ebf\u901a\u5e38\u4f7f\u7528\u7684\u96a7\u9053\u534f\u8bae</p> <p>\u5728\u8bb8\u591a\u53d1\u884c\u7248\u4e2d\uff0cL2TPv3\u88ab\u7f16\u8bd1\u4e3a\u6a21\u5757\uff0c\u5e76\u4e14\u53ef\u80fd\u4e0d\u4f1a\u9ed8\u8ba4\u52a0\u8f7d\u3002\u5982\u679c\u4f60\u5f97\u5230\u4e00\u4e2a\u201cRTNETLINK\u7b54\u6848\uff1a\u6ca1\u6709\u8fd9\u6837\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u201d\u548c\u201c\u9519\u8bef\u7684\u5bf9\u5185\u6838\u201d\u6d88\u606f\u7ed9\u4efb\u4f55\u201cip l2tp\u201d\u547d\u4ee4\uff0c\u60c5\u51b5\u53ef\u80fd\u5982\u6b64\u3002\u52a0\u8f7dl2tp_netlink\u548c l2tp_eth\u6a21\u5757\u3002\u5982\u679c\u4f60\u60f3\u901a\u8fc7IP\u800c\u4e0d\u662fUDP\u4f7f\u7528L2TPv3\uff0c\u8fd8\u9700\u8981\u52a0\u8f7d l2tp_ip</p> <p>\u4e0eLinux\u4e2d\u7684\u5176\u4ed6\u96a7\u9053\u534f\u8bae\u5b9e\u73b0\u76f8\u6bd4\uff0cL2TPv3\u672f\u8bed\u6709\u6240\u9006\u8f6c\u3002\u60a8\u521b\u5efa\u4e00\u4e2a\u96a7\u9053\uff0c\u7136\u540e\u7ed1\u5b9a\u4f1a\u8bdd\u5427\u3002\u60a8\u53ef\u4ee5\u5c06\u5177\u6709\u4e0d\u540c\u6807\u8bc6\u7b26\u7684\u591a\u4e2a\u4f1a\u8bdd\u7ed1\u5b9a\u5230\u76f8\u540c\u7684\u96a7\u9053\u3002\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff08\u9ed8\u8ba4\u540d\u79f0\u4e3al2tpethX\uff09\u4e0e\u4f1a\u8bdd\u76f8\u5173\u8054</p> <p>\u6ce8\u610f\uff1a Linux\u5185\u6838\u4ec5\u5b9e\u73b0\u6570\u636e\u5e27\u7684\u5904\u7406\uff0c\u56e0\u6b64\u60a8\u53ea\u80fd\u521b\u5efa\u5e26\u6709iproute2\u7684\u975e\u6258\u7ba1\u96a7\u9053\uff0c\u5e76\u4e14\u53cc\u65b9\u90fd\u624b\u52a8\u914d\u7f6e\u6240\u6709\u8bbe\u7f6e\u3002\u5982\u679c\u60a8\u60f3\u8981\u4f7f\u7528L2TP\u8fdb\u884c\u8fdc\u7a0b\u8bbf\u95eeVPN\u6216\u5176\u4ed6\u975e\u56fa\u5b9a\u4f2a\u7ebf\uff0c\u5219\u9700\u8981\u7528\u6237\u7a7a\u95f4\u5b88\u62a4\u7a0b\u5e8f\u6765\u5904\u7406\u5b83\u3002\u8fd9\u8d85\u51fa\u4e86\u672c\u6587\u6863\u8303\u56f4</p> <p>\u901a\u8fc7UDP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id $ {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ udp_sport $ {\u6e90\u7aef\u53e3} \\ udp_dport $ {\u76ee\u6807\u7aef\u53e3} \\ encap udp \\ \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} \\ \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \u4f8b\u5b50\uff1a ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id 1 \\ peer_tunnel_id 1 \\ udp_sport 5000 \\ udp_dport 5000 \\ encap udp \\ \u672c\u5730192.0.2.1 \\ \u8fdc\u7a0b203.0.113.2 \u6ce8\u610f\uff1a\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u96a7\u9053\u6807\u8bc6\u7b26\u548c\u5176\u4ed6\u8bbe\u7f6e\u5fc5\u987b\u5339\u914d</p> <p>\u901a\u8fc7IP\u521b\u5efaL2TPv3\u96a7\u9053 ip l2tp\u6dfb\u52a0\u96a7\u9053\\ tunnel_id $ {\u672c\u5730\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_tunnel_id {\u8fdc\u7a0b\u96a7\u9053\u6570\u5b57\u6807\u8bc6\u7b26} \\ encap ip \\ \u672c\u5730192.0.2.1 \\ \u8fdc\u7a0b203.0.113.2</p> <p>\u76f4\u63a5\u5c01\u88c5\u6210IP\u7684L2TPv3\u63d0\u4f9b\u8f83\u5c11\u7684\u5f00\u9500\uff0c\u4e00\u822c\u65e0\u6cd5\u901a\u8fc7NAT</p> <p>\u521b\u5efa\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp add session tunnel_id $ {local tunnel identifier} \\ session_id $ {\u672c\u5730\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26} \\ peer_session_id $ {\u8fdc\u7a0b\u4f1a\u8bdd\u6570\u5b57\u6807\u8bc6\u7b26}</p> <p>\u4f8b\u5b50\uff1a ip l2tp add session tunnel_id 1 \\ session_id 10 \\ peer_session_id 10</p> <p>\u6ce8\u610f\uff1a tunnel_id\u503c\u5fc5\u987b\u5339\u914d\u5148\u524d\u521b\u5efa\u7684\u96a7\u9053\u7684\u503c\u3002\u4e24\u4e2a\u7aef\u70b9\u4e0a\u7684\u4f1a\u8bdd\u6807\u8bc6\u7b26\u5fc5\u987b\u5339\u914d</p> <p>\u4e00\u65e6\u4f60\u521b\u5efa\u4e86\u4e00\u4e2a\u96a7\u9053\u548c\u4e00\u4e2a\u4f1a\u8bdd\uff0cl2tpethX\u754c\u9762\u5c31\u4f1a\u51fa\u73b0\uff0c\u5904\u4e8e\u5173\u95ed\u72b6\u6001\u3002\u5c06\u72b6\u6001\u66f4\u6539\u4e3a\u542f\u52a8\u5e76\u5c06\u5176\u4e0e\u53e6\u4e00\u4e2a\u754c\u9762\u6865\u63a5\u6216\u5206\u914d\u5730\u5740</p> <p>\u5220\u9664\u4e00\u4e2aL2TPv3\u4f1a\u8bdd ip l2tp del session tunnel_id $ {tunnel identifier} \\ session_id $ {\u4f1a\u8bdd\u6807\u8bc6\u7b26}</p> <p>\u4f8b\u5b50 ip l2tp del session tunnel_id 1 session_id 1 \u5220\u9664L2TPv3\u96a7\u9053 ip l2tp del tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50 ip l2tp del tunnel tunnel_id 1 \u6ce8\u610f\uff1a\u5220\u9664\u4e4b\u524d\uff0c\u60a8\u9700\u8981\u5220\u9664\u4e0e\u96a7\u9053\u76f8\u5173\u7684\u6240\u6709\u4f1a\u8bdd</p> <p>\u67e5\u770bL2TPv3\u96a7\u9053\u4fe1\u606f ip l2tp\u663e\u793a\u96a7\u9053 ip l2tp show tunnel tunnel_id $ {tunnel identifier} \u4f8b\u5b50\uff1a ip l2tp show tunnel tunnel_id 12 \u67e5\u770bL2TPv3\u4f1a\u8bdd\u4fe1\u606f ip l2tp\u663e\u793a\u4f1a\u8bdd ip l2tp show session session_id $ {session identifier} \\ tunnel_id $ {\u96a7\u9053\u6807\u8bc6\u7b26}</p> <p>\u4f8b\u5b50\uff1a ip l2tp show session session_id 1 tunnel_id 12 VXLAN\u7ba1\u7406 VXLAN\u662f\u7b2c2\u5c42\u96a7\u9053\u534f\u8bae\uff0c\u901a\u5e38\u4e0e\u865a\u62df\u5316\u7cfb\u7edf\uff08\u5982KVM\uff09\u7ed3\u5408\u4f7f\u7528\uff0c\u4ee5\u5c06\u8fd0\u884c\u5728\u4e0d\u540c\u865a\u62df\u673a\u7ba1\u7406\u7a0b\u5e8f\u8282\u70b9\u4e0a\u7684\u865a\u62df\u673a\u5f7c\u6b64\u8fde\u63a5\u5e76\u8fde\u63a5\u5230\u5916\u90e8\u4e16\u754c</p> <p>\u4e0e\u70b9\u5bf9\u70b9\u7684GRE\u6216L2TPv3\u4e0d\u540c\uff0cVXLAN\u901a\u8fc7\u4f7f\u7528IP\u591a\u64ad\u6765\u590d\u5236\u591a\u8def\u8bbf\u95ee\u4ea4\u6362\u7f51\u7edc\u7684\u4e00\u4e9b\u5c5e\u6027\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u901a\u8fc7\u4e0e\u5e27\u4e00\u8d77\u53d1\u9001\u7f51\u7edc\u6807\u8bc6\u7b26\u6765\u652f\u6301\u865a\u62df\u7f51\u7edc\u5206\u79bb</p> <p>\u7f3a\u70b9\u662f\u60a8\u9700\u8981\u4f7f\u7528\u591a\u64ad\u8def\u7531\u534f\u8bae\uff08\u901a\u5e38\u662fPIM-SM\uff09\u624d\u80fd\u4f7f\u5176\u901a\u8fc7\u8def\u7531\u7f51\u7edc\u5de5\u4f5c</p> <p>VXLAN\u7684\u5e95\u5c42\u5c01\u88c5\u534f\u8bae\u662fUDP</p> <p>\u521b\u5efa\u5355\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan \\    id &lt;0-16777215&gt; \\    dev $ {source interface} \\    \u8fdc\u7a0b$ {\u8fdc\u7a0b\u7aef\u70b9\u5730\u5740} \\    \u672c\u5730$ {\u672c\u5730\u7aef\u70b9\u5730\u5740} \\    dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan \\    ID 42 dev eth0\u8fdc\u7a0b203.0.113.6\u672c\u5730192.0.2.1 dstport 4789 \u6ce8\u610f\uff1a id\u9009\u9879\u8868\u793aVXLAN\u7f51\u7edc\u6807\u8bc6\u7b26\uff08VNI\uff09</p> <p>\u521b\u5efa\u7ec4\u64adVXLAN\u94fe\u8def ip link add name $ {interface name}\u952e\u5165vxlan \\    id &lt;0-16777215&gt; \\    dev $ {source interface} \\    \u7ec4$ {\u591a\u64ad\u5730\u5740} \\    dstport $ {VXLAN\u76ee\u6807\u7aef\u53e3} \u4f8b\uff1a ip link add name vxlan0 type vxlan \\    id 42 dev eth0\u7ec4239.0.0.1 dstport 4789 \u4e4b\u540e\uff0c\u60a8\u9700\u8981\u5c06\u94fe\u63a5\u4e0e\u5176\u4ed6\u63a5\u53e3\u6865\u63a5\u6216\u5206\u914d\u5730\u5740</p> <p>\u8def\u7531\u7ba1\u7406 \u5bf9\u4e8eIPv4\u8def\u7531\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u524d\u7f00\u957f\u5ea6\u6216\u70b9\u5206\u5341\u8fdb\u5236\u5b50\u7f51\u63a9\u7801\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c192.0.2.0/24\u548c192.0.2.0/255.255.255.0\u90fd\u53ef\u4ee5\u63a5\u53d7</p> <p>\u6ce8\u610f\uff1a\u6839\u636e\u4e0b\u9762\u7684\u90e8\u5206\uff0c\u5982\u679c\u60a8\u8bbe\u7f6e\u4e86\u9759\u6001\u8def\u7531\uff0c\u5e76\u4e14\u7531\u4e8e\u94fe\u63a5\u5173\u95ed\u800c\u65e0\u6cd5\u8bbf\u95ee\uff0c\u5b83\u5c06\u88ab\u5220\u9664\uff0c\u5e76\u4e14 \u6c38\u8fdc\u4e0d\u4f1a\u81ea\u884c\u6062\u590d\u3002\u60a8\u53ef\u80fd\u6ca1\u6709\u6ce8\u610f\u5230\u8fd9\u79cd\u884c\u4e3a\uff0c\u56e0\u4e3a\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u9644\u52a0\u8f6f\u4ef6\uff08\u4f8b\u5982NetworkManager\u6216rp-pppoe\uff09\u8d1f\u8d23\u5728\u94fe\u63a5\u4e0a\u4e0b\u65f6\u6062\u590d\u8def\u7531</p> <p>\u5982\u679c\u60a8\u6253\u7b97\u5c06\u60a8\u7684Linux\u673a\u5668\u7528\u4f5c\u8def\u7531\u5668\uff0c\u8bf7\u8003\u8651\u5b89\u88c5\u8bf8\u5982Quagga \u6216BIRD\u4e4b\u7c7b\u7684\u8def\u7531\u534f\u8bae\u5957\u4ef6\u3002\u5b83\u4eec\u8ddf\u8e2a\u63a5\u53e3\u72b6\u6001\u5e76\u5728\u8def\u7531\u5668\u65ad\u5f00\u540e\u6062\u590d\u8def\u7531\u65f6\u6062\u590d\u8def\u7531\u3002\u5f53\u7136\uff0c\u4ed6\u4eec\u4e5f\u5141\u8bb8\u4f60\u4f7f\u7528\u52a8\u6001\u8def\u7531\u534f\u8bae\uff0c\u5982OSPF\u548cBGP</p> <p>\u8fde\u63a5\u7684\u8def\u7ebf \u67d0\u4e9b\u8def\u7ebf\u5728\u7cfb\u7edf\u4e2d\u663e\u793a\uff0c\u6ca1\u6709\u660e\u786e\u7684\u914d\u7f6e\uff08\u8fdd\u80cc\u60a8\u7684\u610f\u613f\uff09</p> <p>\u4e00\u65e6\u4e3a\u63a5\u53e3\u5206\u914d\u5730\u5740\uff0c\u7cfb\u7edf\u5c06\u8ba1\u7b97\u5176\u7f51\u7edc\u5730\u5740\u5e76\u4e3a\u5176\u521b\u5efa\u8def\u7531\uff08\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u9700\u8981\u5b50\u7f51\u63a9\u7801\uff09\u3002\u8fd9\u4e9b\u8def\u7531\u88ab\u79f0\u4e3a\u8fde\u63a5\u8def\u7531</p> <p>\u4f8b\u5982\uff0c\u5982\u679c\u5c06203.0.113.25/24\u5206\u914d\u7ed9eth0\uff0c\u5219\u4f1a\u521b\u5efa\u5230203.0.113.0/24\u7f51\u7edc\u7684\u5df2\u8fde\u63a5\u8def\u7531\uff0c\u5e76\u4e14\u7cfb\u7edf\u5c06\u77e5\u9053\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u8be5\u7f51\u7edc\u4e2d\u7684\u4e3b\u673a</p> <p>\u5f53\u63a5\u53e3\u51fa\u73b0\u6545\u969c\u65f6\uff0c\u4e0e\u5176\u5173\u8054\u7684\u8fde\u63a5\u8def\u7531\u5c06\u88ab\u5220\u9664\u3002\u8fd9\u7528\u4e8e\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u68c0\u6d4b\uff0c\u56e0\u6b64\u901a\u8fc7\u4e0d\u53ef\u8bbf\u95ee\u7684\u7f51\u5173\u7684\u8def\u7531\u88ab\u5220\u9664\u3002\u76f8\u540c\u7684\u673a\u5236\u963b\u6b62\u60a8\u901a\u8fc7\u65e0\u6cd5\u8bbf\u95ee\u7684\u7f51\u5173\u521b\u5efa\u8def\u7531</p> <p>\u67e5\u770b\u6240\u6709\u8def\u7ebf ip\u8def\u7531 ip\u8def\u7531\u663e\u793a \u60a8\u53ef\u4ee5\u4f7f\u7528-4\u548c-6\u9009\u9879\u4ec5\u67e5\u770bIPv4\u6216IPv6\u8def\u7531\u3002\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u9009\u9879\uff0c\u5219\u663e\u793aIPv4\u8def\u7531\u3002\u8981\u67e5\u770bIPv6\u8def\u7531\uff0c\u8bf7\u4f7f\u7528\uff1a ip-6\u8def\u7531 \u67e5\u770b\u5230\u7f51\u7edc\u53ca\u5176\u6240\u6709\u5b50\u7f51\u7684\u8def\u7531 ip route show to root $ {address} / $ {mask} \u4f8b\u5982\uff0c\u5982\u679c\u5728\u7f51\u7edc\u4e2d\u4f7f\u7528192.168.0.0/24\u5b50\u7f51\uff0c\u5e76\u4e14\u8be5\u5b50\u7f51\u5206\u4e3a192.168.0.0/25\u548c192.168.0.128/25\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u6240\u6709\u8fd9\u4e9b\u8def\u7531\uff1a ip route\u663e\u793a\u4e3a\u6839192.168.0.0/24 \u6ce8\u610f\uff1a\u8fd9\u4e2a\u548c\u5176\u4ed6show\u547d\u4ee4\u4e2d\u7684\u201cto\u201d\u662f\u53ef\u9009\u7684 \u67e5\u770b\u5230\u7f51\u7edc\u548c\u6240\u6709\u8d85\u7f51\u7684\u8def\u7531 ip route show to match $ {address} / $ {mask} \u5982\u679c\u8981\u67e5\u770b\u8def\u7531\u5230192.168.0.0/24\u548c\u6240\u6709\u66f4\u5927\u7684\u5b50\u7f51\uff0c\u8bf7\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u5339\u914d192.168.0.0/24 \u7531\u4e8e\u8def\u7531\u5668\u66f4\u504f\u5411\u4e8e\u66f4\u5177\u4f53\u7684\u8def\u7531\uff0c\u56e0\u6b64\u901a\u5e38\u7528\u4e8e\u8c03\u8bd5\u7279\u5b9a\u5b50\u7f51\u7684\u6d41\u91cf\u53d1\u9001\u9519\u8bef\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u7f3a\u5c11\u8def\u7531\u4f46\u5b58\u5728\u5230\u8f83\u5927\u5b50\u7f51\u7684\u8def\u7531 \u67e5\u770b\u8def\u7531\u5230\u786e\u5207\u7684\u5b50\u7f51 ip route\u663e\u793a\u7cbe\u786e$ {address} / $ {mask} \u5982\u679c\u60a8\u60f3\u67e5\u770b192.168.0.0/24\u7684\u8def\u7531\uff0c\u4f46\u4e0d\u60f3\u67e5\u770b\u8def\u7531192.168.0.0/25\u548c192.168.0.0/16\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\uff1a IP\u8def\u7531\u663e\u793a\u786e\u5207\u7684192.168.0.0/24 \u4ec5\u67e5\u770b\u5185\u6838\u5b9e\u9645\u4f7f\u7528\u7684\u8def\u7ebf ip route get $ {address} / $ {mask} \u4f8b\uff1a ip route\u83b7\u5f97192.168.0.0/24 \u8bf7\u6ce8\u610f\uff0c\u5728\u590d\u6742\u8def\u7531\u573a\u666f\uff08\u5982\u591a\u8def\u5f84\u8def\u7531\uff09\u4e2d\uff0c\u7ed3\u679c\u53ef\u80fd\u201c\u6b63\u786e\u4f46\u4e0d\u5b8c\u6574\u201d\uff0c\u56e0\u4e3a\u5b83\u603b\u662f\u663e\u793a\u9996\u5148\u4f7f\u7528\u7684\u4e00\u6761\u8def\u7531\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e0d\u662f\u95ee\u9898\uff0c\u4f46\u4e0d\u8981\u5fd8\u8bb0\u67e5\u770b\u76f8\u5e94\u7684\u201cshow\u201d\u547d\u4ee4\u8f93\u51fa \u67e5\u770b\u8def\u7531\u7f13\u5b58\uff08\u4ec5\u9650\u4e8e3.6\u5185\u6838\u4e4b\u524d\uff09 IP\u8def\u7531\u663e\u793a\u7f13\u5b58 \u5728\u7248\u672c3.6\u4e4b\u524d\uff0cLinux\u4f7f\u7528\u8def\u7531\u7f13\u5b58\u3002\u5728\u8f83\u65e9\u7684\u5185\u6838\u4e2d\uff0c\u6b64\u547d\u4ee4\u663e\u793a\u8def\u7531\u7f13\u5b58\u7684\u5185\u5bb9\u3002\u5b83\u53ef\u4ee5\u4e0e\u4e0a\u8ff0\u7684\u4fee\u9970\u7b26\u4e00\u8d77\u4f7f\u7528\u3002\u5728\u8f83\u65b0\u7684\u5185\u6838\u4e2d\uff0c\u5b83\u4ec0\u4e48\u90fd\u4e0d\u505a \u901a\u8fc7\u7f51\u5173\u6dfb\u52a0\u8def\u7531 ip route\u901a\u8fc7$ {next hop}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7192.0.2.1\u6dfb\u52a0192.0.2.128/25 ip route add 2001\uff1adb8\uff1a1 :: / 48 via 2001\uff1adb8\uff1a1 :: 1 \u901a\u8fc7\u754c\u9762\u6dfb\u52a0\u8def\u7ebf ip route add $ {address} / $ {mask} dev $ {interface name} \u4f8b\uff1a ip route add 192.0.2.0/25 dev ppp0 \u63a5\u53e3\u8def\u7531\u901a\u5e38\u7528\u4e8e\u70b9\u5bf9\u70b9\u63a5\u53e3\uff0c\u5982PPP\u96a7\u9053\uff0c\u5176\u4e2d\u4e0d\u9700\u8981\u4e0b\u4e00\u8df3\u5730\u5740 \u66f4\u6539\u6216\u66ff\u6362\u8def\u7ebf \u60a8\u53ef\u4ee5\u4f7f\u7528\u201c\u66f4\u6539\u201d\u547d\u4ee4\u6765\u66f4\u6539\u73b0\u6709\u8def\u7ebf\u7684\u53c2\u6570\u3002\u201c\u66ff\u6362\u201d\u547d\u4ee4\u53ef\u7528\u4e8e\u6dfb\u52a0\u65b0\u8def\u7531\u6216\u4fee\u6539\u73b0\u6709\u8def\u7531\uff08\u5982\u679c\u4e0d\u5b58\u5728\uff09\u3002\u4f8b\u5b50\uff1a</p> <p>IP\u8def\u7531\u901a\u8fc710.0.0.1\u66f4\u6539192.168.2.0/24 ip route\u66ff\u6362192.0.2.1/27 dev tun0 \u5220\u9664\u8def\u7ebf ip route delete $ {\u8def\u7531\u8bed\u53e5\u7684\u5176\u4f59\u90e8\u5206} \u4f8b\u5b50\uff1a IP\u8def\u7531\u901a\u8fc710.0.0.1\u5220\u966410.0.1.0/25 ip route\u5220\u9664\u9ed8\u8ba4dev ppp0 \u9ed8\u8ba4\u8def\u7531</p> <p>\u6709\u4e00\u4e2a\u6dfb\u52a0\u9ed8\u8ba4\u8def\u7531\u7684\u5feb\u6377\u65b9\u5f0f ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a0\u9ed8\u8ba4\u503c ip route add default dev $ {interface name} \u8fd9\u4e9b\u76f8\u5f53\u4e8e\uff1a ip route\u901a\u8fc7$ {address} / $ {mask}\u6dfb\u52a00.0.0.0/0 ip route add 0.0.0.0/0 dev $ {interface name} \u5bf9\u4e8eIPv6\u8def\u7531\uff0c\u5b83\u4e5f\u53ef\u4ee5\u5de5\u4f5c\uff0c\u76f8\u5f53\u4e8e:: / 0 ip-6\u8def\u7531\u901a\u8fc72001\uff1adb8 :: 1\u6dfb\u52a0\u9ed8\u8ba4\u503c \u9ed1\u6d1e\u8def\u7ebf ip route add blackhole $ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route add blackhole 192.0.2.1/32 \u4e0e\u9ed1\u6d1e\u8def\u7ebf\u76f8\u5339\u914d\u7684\u76ee\u7684\u5730\u7684\u4ea4\u901a\u6d41\u88ab\u65e0\u58f0\u5730\u4e22\u5f03</p> <p>\u9ed1\u6d1e\u8def\u7ebf\u6709\u53cc\u91cd\u76ee\u7684\u3002\u9996\u5148\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4e22\u5f03\u53d1\u9001\u5230\u4e0d\u60f3\u8981\u7684\u76ee\u7684\u5730\u7684\u6d41\u91cf\uff0c\u4f8b\u5982\u5df2\u77e5\u7684\u6076\u610f\u4e3b\u673a</p> <p>\u7b2c\u4e8c\u4e2a\u4e0d\u592a\u660e\u663e\uff0c\u6309\u7167RFC1812\u4f7f\u7528\u201c\u6700\u957f\u5339\u914d\u89c4\u5219\u201d\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u8def\u7531\u5668\u8ba4\u4e3a\u5b83\u5177\u6709\u901a\u5f80\u66f4\u5927\u5b50\u7f51\u7684\u8def\u7531\uff0c\u800c\u4e0d\u662f\u6574\u4f53\u4f7f\u7528\u5b83\uff0c\u4f8b\u5982\uff0c\u901a\u8fc7\u52a8\u6001\u8def\u7531\u534f\u8bae\u901a\u544a\u6574\u4e2a\u5b50\u7f51\u65f6\u3002\u5927\u578b\u5b50\u7f51\u901a\u5e38\u4f1a\u5206\u6210\u8f83\u5c0f\u7684\u90e8\u5206\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u7684\u5b50\u7f51\u662f192.0.2.0/24\uff0c\u5e76\u4e14\u60a8\u5df2\u5c06192.0.2.1/25\u548c192.0.2.129/25\u5206\u914d\u7ed9\u60a8\u7684\u63a5\u53e3\uff0c\u5219\u7cfb\u7edf\u4f1a\u521b\u5efa\u8fde\u63a5\u5230/ 25\u7684\u8fde\u63a5\u8def\u7531\uff0c\u4f46\u4e0d\u662f\u6574\u4e2a/ 24\uff0c\u5e76\u4e14\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u53ef\u80fd\u4e0d\u60f3\u901a\u544a/ 24\uff0c\u56e0\u4e3a\u60a8\u6ca1\u6709\u8def\u7531\u5230\u8be5\u786e\u5207\u7684\u5b50\u7f51\u3002\u89e3\u51b3\u65b9\u6848\u662f\u5c06\u9ed1\u6d1e\u8def\u7531\u8bbe\u7f6e\u4e3a192.0.2.0/24</p> <p>\u5176\u4ed6\u7279\u6b8a\u8def\u7ebf ip route add unreachable $ {address} / $ {mask} ip route add prohibit $ {address} / $ {mask} ip route add throw $ {address} / $ {mask} \u8fd9\u4e9b\u8def\u7531\u4f7f\u7cfb\u7edf\u4e22\u5f03\u6570\u636e\u5305\uff0c\u5e76\u5411\u53d1\u4ef6\u4eba\u56de\u590dICMP\u9519\u8bef\u6d88\u606f \u65e0\u6cd5\u8bbf\u95ee \u53d1\u9001ICMP\u201c\u4e3b\u673a\u4e0d\u53ef\u8fbe\u201d \u7981\u6b62 \u53d1\u9001ICMP\u201c\u7ba1\u7406\u7981\u6b62\u201d \u6254 \u53d1\u9001\u201c\u7f51\u7edc\u4e0d\u53ef\u8fbe\u201d \u4e0e\u9ed1\u6d1e\u8def\u7531\u4e0d\u540c\uff0c\u8fd9\u4e9b\u4e0d\u80fd\u7528\u4e8e\u963b\u6b62\u4e0d\u9700\u8981\u7684\u6d41\u91cf\uff08\u4f8b\u5982DDoS\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u4f1a\u4e3a\u6bcf\u4e2a\u4e22\u5f03\u7684\u6570\u636e\u5305\u751f\u6210\u4e00\u4e2a\u56de\u590d\u6570\u636e\u5305\uff0c\u4ece\u800c\u521b\u5efa\u66f4\u5927\u7684\u6d41\u91cf\u3002\u5b83\u4eec\u53ef\u4ee5\u5f88\u597d\u5730\u5b9e\u65bd\u5185\u90e8\u8bbf\u95ee\u7b56\u7565\uff0c\u4f46\u9996\u5148\u8003\u8651\u7528\u4e8e\u6b64\u76ee\u7684\u7684\u9632\u706b\u5899</p> <p>\u201c\u629b\u51fa\u201d\u8def\u7531\u53ef\u7528\u4e8e\u5b9e\u65bd\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff0c\u5728\u975e\u9ed8\u8ba4\u8868\u4e2d\u5b83\u4eec\u4f1a\u505c\u6b62\u5f53\u524d\u8868\u67e5\u627e\uff0c\u4f46\u4e0d\u53d1\u9001ICMP\u9519\u8bef\u6d88\u606f</p> <p>\u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u7684\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u516c\u5236$ {number}\u6dfb\u52a0$ {address} / $ {mask} \u4f8b\u5b50\uff1a ip route\u901a\u8fc710.0.1.1 metric\u6dfb\u52a0192.168.2.0/24 ip route add 192.168.2.0 dev ppp0 metric 10 \u5982\u679c\u6709\u591a\u6761\u8def\u7531\u901a\u5411\u5177\u6709\u4e0d\u540c\u5ea6\u91cf\u503c\u7684\u540c\u4e00\u4e2a\u7f51\u7edc\uff0c\u5219\u5177\u6709\u6700\u4f4e\u5ea6\u91cf\u503c\u7684\u8def\u7531\u5c06\u662f\u9996\u9009</p> <p>\u8fd9\u4e2a\u6982\u5ff5\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\u662f\uff0c\u5f53\u4e00\u4e2a\u63a5\u53e3\u5173\u95ed\u65f6\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u65e0\u7528\u7684\u8def\u7531\u4ece\u8def\u7531\u8868\u4e2d\u6d88\u5931\uff08\u53c2\u89c1\u8fde\u63a5\u8def\u7531\u90e8\u5206\uff09\uff0c\u7cfb\u7edf\u5c06\u56de\u9000\u5230\u66f4\u9ad8\u7684\u5ea6\u91cf\u8def\u7531</p> <p>\u6b64\u529f\u80fd\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u5230\u91cd\u8981\u76ee\u7684\u5730\u7684\u5907\u4efd\u8fde\u63a5</p> <p>\u591a\u8def\u5f84\u8def\u7531 ip route\u901a\u8fc7$ {gateway}\u6dfb\u52a0$ {addresss} / $ {mask} nexthop\u901a\u8fc7$ {number} nexthop\u901a\u8fc7$ {gateway 2}\u52a0\u6743$ {number} \u591a\u8def\u5f84\u8def\u7531\u4f7f\u5f97\u7cfb\u7edf\u6839\u636e\u6743\u91cd\u5728\u591a\u4e2a\u94fe\u8def\u4e0a\u5e73\u8861\u6570\u636e\u5305\uff08\u8f83\u9ad8\u7684\u6743\u91cd\u662f\u9996\u9009\uff0c\u6240\u4ee5\u6743\u91cd\u4e3a2\u7684\u7f51\u5173/\u63a5\u53e3\u5c06\u6bd4\u53e6\u4e00\u4e2a\u6743\u91cd\u4e3a1\u7684\u7f51\u5173/\u63a5\u53e3\u5927\u7ea6\u591a\u4e24\u500d\uff09\u3002\u60a8\u53ef\u4ee5\u6839\u636e\u9700\u8981\u914d\u7f6e\u5c3d\u53ef\u80fd\u591a\u7684\u7f51\u5173\uff0c\u5e76\u6df7\u5408\u7f51\u5173\u548c\u63a5\u53e3\u8def\u7531\uff0c\u5982\uff1a</p> <p>ip route\u6dfb\u52a0\u9ed8\u8ba4nexthop\u901a\u8fc7192.168.1.1\u6743\u91cd1 nexthop dev ppp0\u6743\u91cd10 \u8b66\u544a\uff1a\u8fd9\u79cd\u5e73\u8861\u7684\u7f3a\u70b9\u662f\u6570\u636e\u5305\u4e0d\u80fd\u4fdd\u8bc1\u901a\u8fc7\u5b83\u4eec\u8fdb\u5165\u7684\u76f8\u540c\u94fe\u8def\u53d1\u56de\u3002\u8fd9\u79f0\u4e3a\u201c\u4e0d\u5bf9\u79f0\u8def\u7531\u201d\u3002\u5bf9\u4e8e\u7b80\u5355\u5730\u8f6c\u53d1\u6570\u636e\u5305\u800c\u4e0d\u505a\u4efb\u4f55\u672c\u5730\u6d41\u91cf\u5904\u7406\uff08\u5982NAT\uff09\u7684\u8def\u7531\u5668\uff0c\u8fd9\u901a\u5e38\u662f\u6b63\u5e38\u7684\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u751a\u81f3\u662f\u4e0d\u53ef\u907f\u514d\u7684</p> <p>\u5982\u679c\u60a8\u7684\u7cfb\u7edf\u9664\u4e86\u5728\u63a5\u53e3\u4e4b\u95f4\u8f6c\u53d1\u6570\u636e\u5305\u4e4b\u5916\u4ec0\u4e48\u90fd\u505a\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4f20\u5165\u8fde\u63a5\u51fa\u73b0\u95ee\u9898\uff0c\u5e94\u91c7\u53d6\u4e00\u4e9b\u63aa\u65bd\u6765\u9632\u6b62\u5b83\u4eec</p> <p>\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531 Linux\u4e2d\u57fa\u4e8e\u7b56\u7565\u7684\u8def\u7531\uff08PBR\uff09\u7684\u8bbe\u8ba1\u65b9\u5f0f\u5982\u4e0b\uff1a\u9996\u5148\u521b\u5efa\u81ea\u5b9a\u4e49\u8def\u7531\u8868\uff0c\u7136\u540e\u521b\u5efa\u89c4\u5219\u4ee5\u544a\u77e5\u5185\u6838\u5e94\u8be5\u4f7f\u7528\u8fd9\u4e9b\u8868\u800c\u4e0d\u662f\u9ed8\u8ba4\u8868\u8fdb\u884c\u7279\u5b9a\u6d41\u91cf</p> <p>\u4e00\u4e9b\u8868\u683c\u662f\u9884\u5b9a\u4e49\u7684\uff1a</p> <p>\u672c\u5730\uff08\u8868255\uff09 \u5305\u542b\u63a7\u5236\u8def\u7531\u672c\u5730\u548c\u5e7f\u64ad\u5730\u5740 \u4e3b\u8981\uff08\u8868254\uff09 \u5305\u542b\u6240\u6709\u975ePBR\u8def\u7531\u3002\u5982\u679c\u60a8\u5728\u6dfb\u52a0\u8def\u7ebf\u65f6\u672a\u6307\u5b9a\u8868\u683c\uff0c\u5219\u4f1a\u663e\u793a\u5728\u6b64\u5904 \u9ed8\u8ba4\uff08\u8868253\uff09 \u4fdd\u7559\u7528\u4e8e\u540e\u671f\u5904\u7406\uff0c\u901a\u5e38\u672a\u4f7f\u7528 \u7528\u6237\u5b9a\u4e49\u7684\u8868\u683c\u4f1a\u5728\u60a8\u5411\u5176\u6dfb\u52a0\u7b2c\u4e00\u6761\u8def\u7ebf\u65f6\u81ea\u52a8\u521b\u5efa</p> <p>\u521b\u5efa\u4e00\u4e2a\u7b56\u7565\u8def\u7531 ip route add $ {route options} table $ {table id or name} \u4f8b\u5b50\uff1a ip route\u901a\u8fc7203.0.113.1\u886810\u6dfb\u52a0192.0.2.0/27 ip route\u901a\u8fc7192.168.0.1\u8868ISP2\u6dfb\u52a00.0.0.0/0 ip route add 2001\uff1adb8 :: / 48 dev eth1 table 100 \u6ce8\u610f\uff1a\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7b56\u7565\u8def\u7531\u4e2d\u7684\u201c\u8def\u7531\u7ba1\u7406\u201d\u90e8\u5206\u4e2d\u63cf\u8ff0\u7684\u4efb\u4f55\u8def\u7531\u9009\u9879\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u6700\u540e\u7684\u201c\u8868$ {\u8868id /\u540d\u79f0}\u201d\u90e8\u5206</p> <p>\u6570\u5b57\u8868\u683c\u6807\u8bc6\u7b26\u548c\u540d\u79f0\u53ef\u4ee5\u4e92\u6362\u4f7f\u7528\u3002\u8981\u521b\u5efa\u60a8\u81ea\u5df1\u7684\u7b26\u53f7\u540d\u79f0\uff0c\u8bf7\u7f16\u8f91/ etc / iproute2 / rt_tables\u914d\u7f6e\u6587\u4ef6</p> <p>\u201c\u5220\u9664\u201d\uff0c\u201c\u66f4\u6539\u201d\uff0c\u201c\u66ff\u6362\u201d\u6216\u4efb\u4f55\u5176\u4ed6\u8def\u7531\u64cd\u4f5c\u4e5f\u53ef\u4ee5\u4e0e\u4efb\u4f55\u8868\u4e00\u8d77\u4f7f\u7528</p> <p>\u201cip route ... table main\u201d\u6216\u201cip route ... table 254\u201d\u5bf9\u6ca1\u6709\u8868\u683c\u90e8\u5206\u7684\u547d\u4ee4\u5177\u6709\u5b8c\u5168\u76f8\u540c\u7684\u6548\u679c</p> <p>\u67e5\u770b\u7b56\u7565\u8def\u7531 ip route show table $ {\u8868ID\u6216\u540d\u79f0} \u4f8b\u5b50\uff1a ip route show table 100 ip route show table test \u6ce8\u610f\uff1a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u60a8\u9700\u8981\u201c\u663e\u793a\u201d\u5b57\uff0c\u50cf\u201cip route table 120\u201d\u8fd9\u6837\u7684\u7b80\u5199\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u8be5\u547d\u4ee4\u4e0d\u660e\u786e</p> <p>\u4e00\u822c\u89c4\u5219\u8bed\u6cd5 ip rule add $ {options}  \u5982\u679c\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\uff0c\u5339\u914d$ {options}\uff08\u5982\u4e0b\u6240\u8ff0\uff09\u7684\u6d41\u91cf\u5c06\u6839\u636e\u5177\u6709\u6307\u5b9a\u540d\u79f0/ id\u7684\u8868\u8fdb\u884c\u8def\u7531\uff0c\u800c\u4e0d\u662f\u201c\u4e3b\u201d/ 254\u8868 <p>\u201c\u9ed1\u6d1e\u201d\uff0c\u201c\u7981\u6b62\u201d\u548c\u201c\u65e0\u6cd5\u8bbf\u95ee\u201d\u7684\u52a8\u4f5c\uff0c\u5176\u5de5\u4f5c\u65b9\u5f0f\u4e0e\u4f7f\u7528\u76f8\u540c\u540d\u79f0\u7684\u7c7b\u578b\u76f8\u540c\u3002\u5728\u5927\u591a\u6570\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5c06\u4f7f\u7528\u201c\u67e5\u627e\u201d\u64cd\u4f5c\u4f5c\u4e3a\u6700\u5e38\u89c1\u7684\u64cd\u4f5c</p> <p>\u5bf9\u4e8eIPv6\u89c4\u5219\uff0c\u4f7f\u7528\u201cip -6\u201d\uff0c\u5176\u4f59\u8bed\u6cd5\u662f\u76f8\u540c\u7684</p> <p>\u201ctable $ {table id or name}\u201d\u53ef\u4ee5\u7528\u4f5c\u201c\u67e5\u627e$ {\u8868id\u6216\u540d\u79f0}\u201d\u7684\u522b\u540d</p> <p>\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u6e90\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u4ece$ {\u6e90\u7f51\u7edc} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e10 \u4ece2001\u5e74ip-6\u89c4\u5219\u6dfb\u52a0\uff1adb8 :: / 32\u7981\u6b62 \u6ce8\u610f\uff1a \u201call\u201d\u53ef\u4ee5\u7528\u4f5c0.0.0.0/0\u6216\u8005:: / 0\u7684\u7b80\u5199</p> <p>\u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914d\u76ee\u6807\u7f51\u7edc ip\u89c4\u5219\u6dfb\u52a0\u5230$ {\u76ee\u6807\u7f51\u7edc} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u5230192.0.2.0/24\u9ed1\u6d1e ip -6\u89c4\u5219\u6dfb\u52a0\u52302001\uff1adb8 :: / 32\u67e5\u627e100 \u521b\u5efa\u4e00\u4e2a\u89c4\u5219\u4ee5\u5339\u914dToS\u5b57\u6bb5\u503c ip rule add tos $ {ToS value} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0tos 0x10\u67e5\u627e110 \u521b\u5efa\u4e00\u4e2a\u5339\u914d\u9632\u706b\u5899\u6807\u8bb0\u503c\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0fwmark $ {mark} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0fwmark 0x11\u67e5\u627e100 \u6ce8\u610f\uff1a\u8bf7\u53c2\u9605iptables\u6587\u6863\u4ee5\u4e86\u89e3\u5982\u4f55\u8bbe\u7f6e\u6807\u8bb0</p> <p>\u521b\u5efa\u4e00\u4e2a\u5339\u914d\u5165\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip\u89c4\u5219\u6dfb\u52a0IIF $ {\u63a5\u53e3\u540d\u79f0} $ {\u52a8\u4f5c} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0iif eth0\u67e5\u627e10 ip\u89c4\u5219\u6dfb\u52a0iif\u67e5\u627e20 \u201ciif lo\u201d\uff08\u56de\u9001\uff09\u89c4\u5219\u5c06\u5339\u914d\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf</p> <p>\u521b\u5efa\u4e00\u4e2a\u5339\u914d\u51fa\u7ad9\u63a5\u53e3\u7684\u89c4\u5219 ip rule add oif $ {interface name} $ {action} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0oif eth0\u67e5\u627e10 \u6ce8\u610f\uff1a\u8fd9\u4ec5\u9002\u7528\u4e8e\u672c\u5730\u751f\u6210\u7684\u6d41\u91cf</p> <p>\u8bbe\u7f6e\u89c4\u5219\u4f18\u5148\u7ea7 ip\u89c4\u5219\u6dfb\u52a0$ {options} $ {action}\u4f18\u5148\u7ea7$ {value} \u4f8b\u5b50\uff1a ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/25\u67e5\u627e10\u4f18\u5148\u7ea710 ip\u89c4\u5219\u6dfb\u52a0\u4ece192.0.2.0/24\u67e5\u627e20\u4f18\u5148\u7ea720 \u6ce8\u610f\uff1a\u7531\u4e8e\u89c4\u5219\u4ece\u6700\u4f4e\u4f18\u5148\u7ea7\u5230\u6700\u9ad8\u4f18\u5148\u7ea7\u8fdb\u884c\u904d\u5386\uff0c\u5e76\u4e14\u5904\u7406\u5728\u7b2c\u4e00\u6b21\u5339\u914d\u65f6\u505c\u6b62\uff0c\u6240\u4ee5\u60a8\u9700\u8981\u5728\u4e0d\u592a\u5177\u4f53\u7684\u60c5\u51b5\u4e0b\u653e\u7f6e\u66f4\u5177\u4f53\u7684\u89c4\u5219\u3002\u4ee5\u4e0a\u793a\u4f8b\u6f14\u793a\u4e86192.0.2.0/24\u53ca\u5176\u5b50\u7f51192.0.2.0/25\u7684\u89c4\u5219\u3002\u5982\u679c\u4f18\u5148\u987a\u5e8f\u88ab\u98a0\u5012\u8fc7\u6765\uff0c\u800c\u4e14/ 25\u7684\u89c4\u5219\u88ab\u7f6e\u4e8e24\u7684\u89c4\u5219\u4e4b\u540e\uff0c\u90a3\u6c38\u8fdc\u4e0d\u4f1a\u8fbe\u5230</p> <p>\u663e\u793a\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u663e\u793a ip-6\u89c4\u5219\u663e\u793a \u5220\u9664\u89c4\u5219 ip rule del $ {options} $ {action} \u4f8b\u5b50\uff1a ip rule del 192.0.2.0/24\u67e5\u627e10 \u6ce8\u610f\uff1a\u60a8\u53ef\u4ee5\u4ece\u201cip rule show\u201d/\u201cip -6 rule show\u201d\u7684\u8f93\u51fa\u590d\u5236/\u7c98\u8d34</p> <p>\u5220\u9664\u6240\u6709\u89c4\u5219 ip\u89c4\u5219\u5237\u65b0 ip-6\u89c4\u5219\u5237\u65b0 \u6ce8\uff1a\u6b64\u64cd\u4f5c\u5177\u6709\u9ad8\u5ea6\u7834\u574f\u6027\u3002\u5373\u4f7f\u60a8\u6ca1\u6709\u914d\u7f6e\u4efb\u4f55\u89c4\u5219\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u521d\u59cb\u5316\u201c\u4ece\u6240\u6709\u4e3b\u67e5\u627e\u201d\u89c4\u5219\u3002\u5728\u672a\u914d\u7f6e\u7684\u673a\u5668\u4e0a\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\uff1a</p> <p>$ ip\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 32767\uff1a\u4ece\u6240\u6709\u67e5\u627e\u9ed8\u8ba4</p> <p>$ ip -6\u89c4\u5219\u663e\u793a 0\uff1a\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730 32766\uff1a\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981 \u201c\u4ece\u6240\u6709\u67e5\u627e\u672c\u5730\u201d\u89c4\u5219\u662f\u7279\u6b8a\u7684\uff0c\u4e0d\u80fd\u88ab\u5220\u9664\u3002\u201c\u4ece\u6240\u6709\u67e5\u627e\u4e3b\u8981\u201d\u4e0d\u662f\uff0c\u53ef\u80fd\u6709\u6ca1\u6709\u5b83\u7684\u6b63\u5f53\u7406\u7531\uff0c\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u53ea\u60f3\u8def\u7531\u4f60\u521b\u5efa\u663e\u5f0f\u89c4\u5219\u7684\u6d41\u91cf\u3002\u4f5c\u4e3a\u4e00\u4e2a\u526f\u4f5c\u7528\uff0c\u5982\u679c\u4f60\u505a\u201cip rule flush\u201d\uff0c\u8fd9\u4e2a\u89c4\u5219\u5c06\u88ab\u5220\u9664\uff0c\u8fd9\u5c06\u4f7f\u7cfb\u7edf\u505c\u6b62\u8def\u7531\u4efb\u4f55\u6d41\u91cf\uff0c\u76f4\u5230\u4f60\u6062\u590d\u4f60\u7684\u89c4\u5219</p> <p>\u7f51\u7edc\u547d\u540d\u7a7a\u95f4\u7ba1\u7406 \u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u662f\u5355\u4e2a\u673a\u5668\u4e2d\u9694\u79bb\u7684\u7f51\u7edc\u5806\u6808\u5b9e\u4f8b\u3002\u5b83\u4eec\u53ef\u7528\u4e8e\u5b89\u5168\u57df\u5206\u79bb\uff0c\u7ba1\u7406\u865a\u62df\u673a\u4e4b\u95f4\u7684\u6d41\u91cf\u7b49</p> <p>\u6bcf\u4e2a\u547d\u540d\u7a7a\u95f4\u90fd\u662f\u5177\u6709\u81ea\u5df1\u7684\u63a5\u53e3\uff0c\u5730\u5740\uff0c\u8def\u7531\u7b49\u7684\u7f51\u7edc\u5806\u6808\u7684\u5b8c\u6574\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u4e2d\u8fd0\u884c\u8fdb\u7a0b\uff0c\u5e76\u5c06\u547d\u540d\u7a7a\u95f4\u6865\u63a5\u5230\u7269\u7406\u63a5\u53e3</p> <p>\u521b\u5efa\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4 ip netns\u6dfb\u52a0$ {\u547d\u540d\u7a7a\u95f4\u540d\u79f0} \u4f8b\u5b50\uff1a ip netns\u6dfb\u52a0foo \u5217\u51fa\u73b0\u6709\u7684\u547d\u540d\u7a7a\u95f4 ip netns\u5217\u8868 \u5220\u9664\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4 ip netns\u5220\u9664$ {namespace name} \u4f8b\u5b50\uff1a ip netns\u5220\u9664foo \u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4e00\u4e2a\u8fdb\u7a0b ip netns exec $ {namespace name} $ {command} \u4f8b\u5b50\uff1a ip netns exec foo / bin / sh \u6ce8\u610f\uff1a\u5c06\u8fdb\u7a0b\u5206\u914d\u7ed9\u975e\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u9700\u8981root\u6743\u9650</p> <p>\u4f60\u53ef\u4ee5\u5728\u547d\u540d\u7a7a\u95f4\u5185\u8fd0\u884c\u4efb\u4f55\u8fdb\u7a0b\uff0c\u7279\u522b\u662f\u4f60\u53ef\u4ee5\u8fd0\u884c\u201cip\u201d\u672c\u8eab\uff0c\u672c\u8282\u4e2d\u7684\u547d\u4ee4\u201cip netns exec foo ip link list\u201d\u4e0d\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u8bed\u6cd5\uff0c\u800c\u662f\u7b80\u5355\u5730\u6267\u884c\u53e6\u4e00\u4e2a\u201cip\u201d\u526f\u672c\u4e00\u4e2a\u540d\u5b57\u7a7a\u95f4\u3002\u60a8\u4e5f\u53ef\u4ee5\u5728\u540d\u79f0\u7a7a\u95f4\u5185\u8fd0\u884c\u4ea4\u4e92\u5f0fshell</p> <p>\u5217\u51fa\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4\u7684\u6240\u6709\u8fdb\u7a0b ip netns pids $ {namespace name} \u8f93\u51fa\u5c06\u662f\u4e00\u4e2aPID\u5217\u8868</p> <p>\u786e\u5b9a\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4 ip netns\u6807\u8bc6$ {pid} \u4f8b\u5b50\uff1a ip netns\u8bc6\u522b9000 \u5c06\u7f51\u7edc\u63a5\u53e3\u5206\u914d\u7ed9\u540d\u79f0\u7a7a\u95f4 ip link set dev $ {interface name} netns $ {namespace name} ip link set dev $ {interface name} netns $ {pid} \u4f8b\u5b50\uff1a ip link set dev eth0.100 netns foo \u6ce8\u610f\uff1a\u4e00\u65e6\u4f60\u7ed9\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u5206\u914d\u4e86\u4e00\u4e2a\u63a5\u53e3\uff0c\u5b83\u5c06\u4ece\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u6d88\u5931\uff0c\u4f60\u5c06\u4e0d\u5f97\u4e0d\u901a\u8fc7\u201cip netns exec $ {netspace name}\u201d\u6267\u884c\u6240\u6709\u7684\u64cd\u4f5c\uff0c\u5982\u201cip netns exec $ {netspace name} ip link set dev dummy0 down\u201c</p> <p>\u800c\u4e14\uff0c\u5f53\u60a8\u5c06\u63a5\u53e3\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u540d\u79f0\u7a7a\u95f4\u65f6\uff0c\u5b83\u4f1a\u4e22\u5931\u6240\u6709\u5df2\u914d\u7f6e\u7684\u914d\u7f6e\uff0c\u4f8b\u5982\u914d\u7f6e\u7684IP\u5730\u5740\u5e76\u8fdb\u5165DOWN\u72b6\u6001\u3002\u60a8\u9700\u8981\u5c06\u5176\u6062\u590d\u5e76\u91cd\u65b0\u914d\u7f6e</p> <p>\u5982\u679c\u60a8\u6307\u5b9a\u4e00\u4e2aPID\u800c\u4e0d\u662f\u547d\u540d\u7a7a\u95f4\u540d\u79f0\uff0c\u5219\u8be5\u63a5\u53e3\u5c06\u88ab\u5206\u914d\u5230\u5177\u6709\u8be5PID\u7684\u8fdb\u7a0b\u7684\u4e3b\u540d\u79f0\u7a7a\u95f4\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4f8b\u5982\u201cip netns exec $ {namespace name} ip link set dev $ {intf} netns 1\u201d\u5c06\u63a5\u53e3\u91cd\u65b0\u5206\u914d\u56de\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\uff08\u56e0\u4e3a\u521d\u59cb\u5316\u6216\u5176\u4ed6PID 1\u7684\u8fdb\u7a0b\u51e0\u4e4e\u53ef\u4ee5\u4fdd\u8bc1\u5904\u4e8e\u9ed8\u8ba4\u72b6\u6001\u547d\u540d\u7a7a\u95f4\uff09</p> <p>\u5c06\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a \u8fd9\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u4e24\u4e2aveth\u94fe\u63a5\u5e76\u4e3a\u5b83\u4eec\u5206\u914d\u4e24\u4e2a\u4e0d\u540c\u7684\u540d\u79f0\u7a7a\u95f4\u6765\u5b8c\u6210\u3002\u5047\u8bbe\u4f60\u60f3\u5c06\u547d\u540d\u7a7a\u95f4\u201cfoo\u201d\u8fde\u63a5\u5230\u9ed8\u8ba4\u7684\u547d\u540d\u7a7a\u95f4</p> <p>\u521b\u5efa\u4e00\u5bf9veth\u8bbe\u5907\uff1a ip\u94fe\u63a5\u6dfb\u52a0\u540d\u79f0veth1\u7c7b\u578bveth peer name veth2 \u5c06veth2\u79fb\u52a8\u5230\u540d\u79f0\u7a7a\u95f4foo\uff1a ip link set dev veth2 netns foo \u5e26\u4e0aveth2\u5e76\u5728\u201cfoo\u201d\u547d\u540d\u7a7a\u95f4\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff1a ip netns exec foo ip link set dev veth2 up ip netns exec foo ip address add 10.1.1.1/24 dev veth2 \u5411veth1\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff0c\u8be5\u5730\u5740\u4fdd\u7559\u5728\u9ed8\u8ba4\u540d\u79f0\u7a7a\u95f4\u4e2d\uff1a ip address add 10.1.1.2/24 dev veth1 \u73b0\u5728\uff0c\u60a8\u53ef\u4ee5ping 10.1.1.1\uff0c\u5982\u679c\u5728foo\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5e76\u4e14\u8bbe\u7f6e\u8def\u7531\u5230\u5728\u8be5\u547d\u540d\u7a7a\u95f4\u7684\u5176\u4ed6\u63a5\u53e3\u4e2d\u914d\u7f6e\u7684\u5b50\u7f51\u7684\u8def\u7531</p> <p>\u5982\u679c\u60a8\u60f3\u8981\u5207\u6362\u800c\u4e0d\u662f\u8def\u7531\uff0c\u5219\u53ef\u4ee5\u5c06\u8fd9\u4e9bveth\u63a5\u53e3\u4e0e\u76f8\u5e94\u540d\u79f0\u7a7a\u95f4\u4e2d\u7684\u5176\u4ed6\u63a5\u53e3\u8fdb\u884c\u6865\u63a5\u3002\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u6280\u672f\u5c06\u540d\u79f0\u7a7a\u95f4\u8fde\u63a5\u5230\u7269\u7406\u7f51\u7edc</p> <p>\u76d1\u89c6\u7f51\u7edc\u540d\u79f0\u7a7a\u95f4\u5b50\u7cfb\u7edf\u4e8b\u4ef6 ip netns\u76d1\u89c6\u5668 \u663e\u793a\u4e8b\u4ef6\uff0c\u4f8b\u5982\u521b\u5efa\u548c\u5220\u9664\u540d\u79f0\u7a7a\u95f4</p> <p>\u591a\u64ad\u7ba1\u7406 \u591a\u64ad\u4e3b\u8981\u7531\u5e94\u7528\u7a0b\u5e8f\u548c\u8def\u7531\u5b88\u62a4\u8fdb\u7a0b\u5904\u7406\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u505a\u7684\u5e76\u4e0d\u591a\uff0c\u800c\u4e14\u5e94\u8be5\u5728\u8fd9\u91cc\u624b\u52a8\u5b8c\u6210\u3002\u591a\u64ad\u76f8\u5173\u7684ip\u547d\u4ee4\u4e3b\u8981\u7528\u4e8e\u8c03\u8bd5</p> <p>\u67e5\u770b\u591a\u64ad\u7ec4 ip maddress\u8282\u76ee ip maddress show $ {interface name} \u4f8b\uff1a $ ip maddress show dev lo 1\uff1alo     inet 224.0.0.1     inet6 ff02 :: 1     inet6 ff01 :: 1 \u6dfb\u52a0\u94fe\u8def\u5c42\u591a\u64ad\u5730\u5740 \u60a8\u4e0d\u80fd\u624b\u52a8\u52a0\u5165IP\u591a\u64ad\u7ec4\uff0c\u4f46\u53ef\u4ee5\u6dfb\u52a0\u591a\u64adMAC\u5730\u5740\uff08\u5c3d\u7ba1\u5f88\u5c11\u9700\u8981\uff09</p> <p>ip maddress add $ {MAC\u5730\u5740} dev $ {\u63a5\u53e3\u540d\u79f0} \u4f8b\uff1a ip maddress\u6dfb\u52a001\uff1a00\uff1a5e\uff1a00\uff1a00\uff1aab dev eth0 \u67e5\u770b\u7ec4\u64ad\u8def\u7531 \u7ec4\u64ad\u8def\u7531\u65e0\u6cd5\u624b\u52a8\u6dfb\u52a0\uff0c\u56e0\u6b64\u6b64\u547d\u4ee4\u53ea\u80fd\u663e\u793a\u7531\u8def\u7531\u5b88\u62a4\u7a0b\u5e8f\u5b89\u88c5\u7684\u7ec4\u64ad\u8def\u7531\u3002\u5b83\u652f\u6301\u76f8\u540c\u7684\u4fee\u9970\u7b26\u6765\u5355\u64ad\u8def\u7531\u67e5\u770b\u547d\u4ee4\uff08iif\uff0ctable\uff0cfrom\u7b49\uff09</p> <p>ip mroute\u663e\u793a \u7f51\u7edc\u4e8b\u4ef6\u76d1\u63a7 \u60a8\u53ef\u4ee5\u4f7f\u7528iproute2\u76d1\u89c6\u67d0\u4e9b\u7f51\u7edc\u4e8b\u4ef6\uff0c\u4f8b\u5982\u7f51\u7edc\u914d\u7f6e\uff0c\u8def\u7531\u8868\u548cARP / NDP\u8868\u4e2d\u7684\u66f4\u6539</p> <p>\u76d1\u63a7\u6240\u6709\u4e8b\u4ef6 \u60a8\u53ef\u4ee5\u4e0d\u5e26\u53c2\u6570\u5730\u8c03\u7528\u8be5\u547d\u4ee4\uff0c\u6216\u8005\u660e\u786e\u6307\u5b9a\u201c\u5168\u90e8\u201d</p> <p>IP\u76d1\u89c6\u5668 ip\u76d1\u89c6\u6240\u6709 \u76d1\u89c6\u7279\u5b9a\u4e8b\u4ef6 ip monitor $ {event type} \u4e8b\u4ef6\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a</p> <p>\u94fe\u63a5 \u94fe\u8def\u72b6\u6001\uff1a\u63a5\u53e3\u4e0a\u4e0b\uff0c\u865a\u62df\u63a5\u53e3\u88ab\u521b\u5efa\u6216\u9500\u6bc1\u7b49 \u5730\u5740 \u94fe\u63a5\u5730\u5740\u66f4\u6539 \u8def\u7ebf \u8def\u7531\u8868\u66f4\u6539 mroute \u7ec4\u64ad\u8def\u7531\u66f4\u6539 \u5636 \u90bb\u5c45\uff08ARP\u548cNDP\uff09\u8868\u4e2d\u7684\u66f4\u6539 \u5f53\u5b58\u5728\u4e0d\u540c\u7684IPv4\u548cIPv6\u5b50\u7cfb\u7edf\u65f6\uff0c\u901a\u5e38\u7684\u201c-4\u201d\u548c\u201c-6\u201d\u9009\u9879\u5141\u8bb8\u60a8\u4ec5\u663e\u793a\u6307\u5b9a\u534f\u8bae\u7684\u4e8b\u4ef6\u3002\u5982\uff1a</p> <p>ip -4\u76d1\u63a7\u8def\u7531 ip-6\u76d1\u89c6\u5668\u90bb\u5c45 ip -4\u76d1\u89c6\u5668\u5730\u5740 \u9605\u8bfbrtmon\u751f\u6210\u7684\u65e5\u5fd7\u6587\u4ef6 iproute2\u5305\u542b\u4e00\u4e2a\u540d\u4e3a\u201crtmon\u201d\u7684\u7a0b\u5e8f\uff0c\u5176\u529f\u80fd\u57fa\u672c\u76f8\u540c\uff0c\u4f46\u5c06\u4e8b\u4ef6\u5199\u5165\u4e8c\u8fdb\u5236\u65e5\u5fd7\u6587\u4ef6\u800c\u4e0d\u662f\u663e\u793a\u5b83\u4eec\u3002\u201cip monitor\u201d\u547d\u4ee4\u5141\u8bb8\u60a8\u8bfb\u53d6\u7531\u7a0b\u5e8f\u521b\u5efa\u7684\u6587\u4ef6\u201c</p> <p>ip monitor $ {event type}\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84} rtmon\u8bed\u6cd5\u4e0e\u201cip monitor\u201d\u7c7b\u4f3c\uff0c\u9664\u4e86\u4e8b\u4ef6\u7c7b\u578b\u4ec5\u9650\u4e8e\u94fe\u63a5\uff0c\u5730\u5740\uff0c\u8def\u7531\u548c\u5168\u90e8; \u548c\u5730\u5740\u65cf\u5728\u201c-family\u201d\u9009\u9879\u4e2d\u6307\u5b9a</p> <p>rtmon [-family ] [&lt;\u8def\u7531|\u94fe\u63a5|\u5730\u5740|\u6240\u6709&gt;]\u6587\u4ef6$ {\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84} netconf\uff08sysctl\u914d\u7f6e\u67e5\u770b\uff09 \u67e5\u770b\u6240\u6709\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf\u663e\u793a \u67e5\u770b\u7279\u5b9a\u63a5\u53e3\u7684sysctl\u914d\u7f6e ip netconf show dev $ {interface} \u4f8b\u5b50\uff1a ip netconf show dev eth0"},{"location":"system/Networking/#net-tools","title":"Net-tools","text":""},{"location":"system/Networking/#netstat","title":"netstat","text":"Markdown<pre><code>netstat [-vWeenNcCF] [&lt;Af&gt;] -r\nnetstat [-vWnNcaeol] [&lt;Socket&gt; ...]\nnetstat { [-vWeenNac] -i | [-cnNe] -M | -s [-6tuw] }\n\n&lt;Socket&gt;={-t|--tcp} {-u|--udp} {-U|--udplite} {-S|--sctp} {-w|--raw}\n         {-x|--unix} --ax25 --ipx --netrom\n&lt;AF&gt;=Use '-6|-4' or '-A &lt;af&gt;' or '--&lt;af&gt;'\uff1b\u9ed8\u8ba4\uff1a inet\n\u5217\u51fa\u6240\u6709\u652f\u6301\u7684\u534f\u8bae\uff1a\n  inet (DARPA Internet) inet6 (IPv6) ax25 (AMPR AX.25)\n  netrom (AMPR NET/ROM) ipx (Novell IPX) ddp (Appletalk DDP)\n  x25 (CCITT X.25)\n\n-r,--route              \u663e\u793a\u8def\u7531\u8868\n-i,--interfaces         \u663e\u793a\u7f51\u7edc\u63a5\u53e3\u8868\n-g,--groups             \u663e\u793a\u7ec4\u64ad\u7ec4\u6210\u5458\u5173\u7cfb\n-s,--statistics         display networking statistics (like SNMP)\n-t,--tcp                \u663e\u793aTCP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\n-u,--udp                \u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\n-M,--masquerade         \u663e\u793a\u4f2a\u88c5\u7684\u7f51\u7edc\u8fde\u63a5\n-v,--verbose            \u663e\u793a\u8be6\u7ec6\u4fe1\u606f\n-w,--raw                \u663e\u793aRAW\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\n-W,--wide               don't truncate IP addresses\n-n,--numeric            \u4e0d\u89e3\u6790\u540d\u79f0,\u76f4\u63a5\u4f7f\u7528IP\n   --numeric-hosts      \u4e0d\u89e3\u6790\u4e3b\u673a\u540d\n   --numeric-ports      \u5ffd\u7565\u7aef\u53e3\u540d\u79f0\n   --numeric-users      \u5ffd\u7565\u7528\u6237\u540d\n-A,--protocol=family    \u5217\u51fa\u5bf9\u5e94\u534f\u8bae\u7c7b\u578b\u8fde\u7ebf\u4e2d\u7684\u76f8\u5173\u5730\u5740(family\uff1ainet\uff0cinet6\uff0cunix\uff0cipx\uff0cax25\uff0cnetrom\uff0ceconet\uff0cddp\u548cbluetooth)\n-x,--unix               \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A unix\"\u53c2\u6570\u76f8\u540c\n--ip,--inet             \u6b64\u53c2\u6570\u7684\u6548\u679c\u548c\u6307\u5b9a\"-A inet\"\u53c2\u6570\u76f8\u540c\n-N,--symbolic           \u89e3\u6790\u786c\u4ef6\u3001\u5916\u56f4\u8bbe\u5907\u7684\u7b26\u53f7\u8fde\u63a5\u540d\u79f0\n-e,--extend             \u663e\u793a\u7f51\u7edc\u4e2d\u5176\u4ed6\u66f4\u591a\u4fe1\u606f\n-p,--programs           \u663e\u793a\u6b63\u5728\u4f7f\u7528Socket\u7684\u8fdb\u7a0bPID\u548c\u7a0b\u5e8f\u540d\u79f0\n-o,--timers             display timers(\u663e\u793a\u8ba1\u65f6\u5668)\n-c,--continuous         \u6301\u7eed\u5217\u51fa\u7f51\u7edc\u72b6\u6001(\u9ed8\u8ba41s)\n-l,--listening          \u663e\u793a\u4fa6\u542c\u670d\u52a1\u5668sockets\n-a,--all                \u663e\u793a\u6240\u6709\u8fde\u7ebf\u4e2d\u7684Socket(default: connected)\n-F,--fib                \u4eceFIB(forwarding information base)\u6253\u5370\u8def\u7531\u4fe1\u606f(default)\n-C,--cache              \u4ece\u8def\u7531\u7f13\u5b58\u4e2d\u6253\u5370\u8def\u7531\u4fe1\u606f\n-Z,--context            \u663e\u793asockets\u7684SELinux security context\n</code></pre>"},{"location":"system/Networking/#netstat_1","title":"netstat\u5b9e\u4f8b","text":"Bash<pre><code># \u5217\u51fa\u6240\u6709\u7aef\u53e3 (\u5305\u62ec\u76d1\u542c\u548c\u672a\u76d1\u542c\u7684)\nnetstat -a     #\u5217\u51fa\u6240\u6709\u7aef\u53e3\nnetstat -at    #\u5217\u51fa\u6240\u6709tcp\u7aef\u53e3\nnetstat -au    #\u5217\u51fa\u6240\u6709udp\u7aef\u53e3\nnetstat -ng    #\u67e5\u770b\u7ec4\u64ad\u60c5\u51b5\n\n# \u5217\u51fa\u6240\u6709\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u7684 Sockets\nnetstat -l        #\u53ea\u663e\u793a\u76d1\u542c\u7aef\u53e3\nnetstat -lt       #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c tcp \u7aef\u53e3\nnetstat -lu       #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c udp \u7aef\u53e3\nnetstat -lx       #\u53ea\u5217\u51fa\u6240\u6709\u76d1\u542c UNIX \u7aef\u53e3\n\n# \u663e\u793a\u6bcf\u4e2a\u534f\u8bae\u7684\u7edf\u8ba1\u4fe1\u606f\nnetstat -s   \u663e\u793a\u6240\u6709\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f\nnetstat -st   \u663e\u793aTCP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f\nnetstat -su   \u663e\u793aUDP\u7aef\u53e3\u7684\u7edf\u8ba1\u4fe1\u606f\n\nnetstat -pt     # \u5728netstat\u8f93\u51fa\u4e2d\u663e\u793a PID \u548c\u8fdb\u7a0b\u540d\u79f0\n</code></pre> <p><code>netstat -p</code>\u53ef\u4ee5\u4e0e\u5176\u5b83\u5f00\u5173\u4e00\u8d77\u4f7f\u7528\uff0c\u5c31\u53ef\u4ee5\u6dfb\u52a0\u201cPID/\u8fdb\u7a0b\u540d\u79f0\u201d\u5230netstat\u8f93\u51fa\u4e2d\uff0c\u8fd9\u6837debugging\u7684\u65f6\u5019\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u53d1\u73b0\u7279\u5b9a\u7aef\u53e3\u8fd0\u884c\u7684\u7a0b\u5e8f</p>"},{"location":"system/Networking/#netstathost-port-or-user","title":"\u5728netstat\u8f93\u51fa\u4e2d\u4e0d\u663e\u793a\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d(host, port or user)","text":"Bash<pre><code># \u5f53\u4f60\u4e0d\u60f3\u8ba9\u4e3b\u673a\uff0c\u7aef\u53e3\u548c\u7528\u6237\u540d\u663e\u793a\uff0c\u4f7f\u7528`netstat -n`\u3002\u5c06\u4f1a\u4f7f\u7528\u6570\u5b57\u4ee3\u66ff\u90a3\u4e9b\u540d\u79f0\u3002\u540c\u6837\u53ef\u4ee5\u52a0\u901f\u8f93\u51fa\uff0c\u56e0\u4e3a\u4e0d\u7528\u8fdb\u884c\u6bd4\u5bf9\u67e5\u8be2\nnetstat -an\n\n# \u5982\u679c\u53ea\u662f\u4e0d\u60f3\u8ba9\u8fd9\u4e09\u4e2a\u540d\u79f0\u4e2d\u7684\u4e00\u4e2a\u88ab\u663e\u793a\uff0c\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4:\nnetsat -a --numeric-ports\nnetsat -a --numeric-hosts\nnetsat -a --numeric-users\n\n# \u627e\u51fa\u7a0b\u5e8f\u8fd0\u884c\u7684\u7aef\u53e3,\u5e76\u4e0d\u662f\u6240\u6709\u7684\u8fdb\u7a0b\u90fd\u80fd\u627e\u5230\uff0c\u6ca1\u6709\u6743\u9650\u7684\u4f1a\u4e0d\u663e\u793a\uff0c\u4f7f\u7528 root \u6743\u9650\u67e5\u770b\u6240\u6709\u7684\u4fe1\u606f\nnetstat -ap | grep ssh\n\n# \u627e\u51fa\u8fd0\u884c\u5728\u6307\u5b9a\u7aef\u53e3\u7684\u8fdb\u7a0b\nnetstat -an | grep ':80'\n</code></pre> \u547d\u4ee4\u62c6\u5206 \u8be6\u89e3 /^tcp/ \u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\uff0c\u201c^\u201d\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u7528\u6cd5\uff0c\u4ee5...\u5f00\u5934\uff0c\u8fd9\u91cc\u662f\u8fc7\u6ee4\u51fa\u4ee5tcp\u5f00\u5934\u7684\u884c\u3002 S[] \u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u53ebS\u7684\u6570\u7ec4\uff0c\u5728awk\u4e2d\uff0c\u6570\u7ec4\u4e0b\u6807\u901a\u5e38\u4ece\u00a01\u00a0\u5f00\u59cb\uff0c\u800c\u4e0d\u662f\u00a00\u3002 NF \u5f53\u524d\u8bb0\u5f55\u91cc\u57df\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4ee5\u7a7a\u683c\u5206\u9694\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0cNF\u57df\u4e2a\u6570\u7b49\u4e8e6 $NF \u8868\u793a\u4e00\u884c\u7684\u6700\u540e\u4e00\u4e2a\u57df\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\\(NF\u4e5f\u5c31\u662f\\)6\uff0c\u8868\u793a\u7b2c6\u4e2a\u5b57\u6bb5\u7684\u503c\uff0c\u4e5f\u5c31\u662fSYN_RECV\u6216TIME_WAIT\u7b49\u3002 S[$NF] \u8868\u793a\u6570\u7ec4\u5143\u7d20\u7684\u503c\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662fS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570 ++S[$NF] \u8868\u793a\u628a\u67d0\u4e2a\u6570\u52a0\u4e00\uff0c\u5982\u4e0a\u6240\u793a\u7684\u8bb0\u5f55\uff0c\u5c31\u662f\u628aS[TIME_WAIT]\u72b6\u6001\u7684\u8fde\u63a5\u6570\u52a0\u4e00 END \u7ed3\u675f forkey in S \u904d\u5386S[]\u6570\u7ec4 print key,\u201d\\t\u201d,S[key] \u6253\u5370\u6570\u7ec4\u7684\u952e\u548c\u503c\uff0c\u4e2d\u95f4\u7528\\t\u5236\u8868\u7b26\u5206\u5272\uff0c\u663e\u793a\u597d\u4e00\u4e9b\u3002"},{"location":"system/Networking/#iptcp","title":"IP\u548cTCP\u5206\u6790","text":"Bash<pre><code>#\u67e5\u770b\u8fde\u63a5\u67d0\u670d\u52a1\u7aef\u53e3\u524d20\u4e2aIP\u5730\u5740\u53ca\u8fde\u63a5\u6570\uff1a\nnetstat -ntu | grep :80 | awk '{print $5}' | cut -d: -f1 | awk '{++ip[$1]} END {for(i in ip) print ip[i],\"\\t\",i}' | sort -nr | head -n 20\nnetstat -anlp|grep 80|grep tcp|awk '{print $5}'|awk -F: '{print $1}'|sort|uniq -c|sort -nr | head -n 20\nnetstat -nat |awk '/:80/{split($5,ip,\":\");++A[ip[1]]}END{for(i in A) print A[i],i}' |sort -rn | head -n 20\nnetstat -nat | grep \":80\" | grep ESTABLISHED | awk '{printf \"%s %s\\n\",$5,$6}' | sort -rn | head -n 20\n\n# \u6839\u636e\u7aef\u53e3\u5217\u51fa\u8fdb\u7a0b\nnetstat -ntlp | grep 80 | awk '{print $7}' | cut -d: -f1\n\n# \u7528tcpdump\u55c5\u63a280\u7aef\u53e3\u524d\u7684\u8bbf\u95ee\u91cf\ntcpdump -i eth0 -tnn dst port 80 -c 1000 | awk -F\".\" '{print $1\".\"$2\".\"$3\".\"$4}' | sort | uniq -c | sort -nr | head -20\n\n# \u67e5\u770bphpcgi\u8fdb\u7a0b\u6570\uff0c\u5982\u679c\u63a5\u8fd1\u9884\u8bbe\u503c\uff0c\u8bf4\u660e\u4e0d\u591f\u7528\uff0c\u9700\u8981\u589e\u52a0\nnetstat -anpo | grep \"php-cgi\" | wc -l\n\n# \u67e5\u770bTCP\u8fde\u63a5\u72b6\u6001\u3001\u5e76\u53d1\u53ca\u8fde\u63a5\u6570\u7684\u547d\u4ee4\nnetstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'\nnetstat -nat | awk '{print $NF}' | grep -v '[a-z]' | sort | uniq -c | sort -rn\nnetstat -n | awk '/^tcp/ {++state[$NF]}; END {for(key in state) print key,\"\\t\",state[key]}'\nnetstat -n | awk '/^tcp/ {++arr[$NF]};END {for(k in arr) print k,\"\\t\",arr[k]}'\nnetstat -nt | grep -e 127.0.0.1 -e 0.0.0.0 -e ::: -v | awk '/^tcp/ {++state[$NF]} END {for(i in state) print i,\"\\t\",state[i]}'\n\n# \u67e5\u627e\u524d20\u7684time_wait\u8fde\u63a5\nnetstat -n|grep TIME_WAIT|awk '{print $5}'|sort|uniq -c|sort -rn | head -n 20\n\n# \u67e5\u627e\u67e5\u524d20\u7684SYN\u8fde\u63a5\nnetstat -an | grep SYN | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr | head -n 20\n\n# \u7edf\u8ba1\u670d\u52a1\u5668\u5f53\u524d\u5355IP\u8fde\u63a5\u6570\u6700\u5927\u7684IP\u5730\u5740\u524d\u5341\nnetstat -an | grep EST | awk -F '[ :]+' '{++S[$6]} END {for (key in S) print \"ip:\"key\"-----&gt;\",S[key]}' | sort -rn -k2\n</code></pre>"},{"location":"system/Networking/#tcp","title":"TCP\u72b6\u6001\u8bf4\u660e","text":"\u72b6\u6001 \u63cf\u8ff0 CLOSED \u65e0\u8fde\u63a5\u662f\u6d3b\u52a8\u7684\u6216\u6b63\u5728\u8fdb\u884c LISTEN \u670d\u52a1\u5668\u5728\u7b49\u5f85\u8fdb\u5165\u547c\u53eb SYN_RECV \u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42\u5df2\u7ecf\u5230\u8fbe SYN_SENT \u5e94\u7528\u5df2\u7ecf\u5f00\u59cb ESTABLISHED \u6b63\u5e38\u6570\u636e\u4f20\u8f93\u72b6\u6001 FIN_WAIT1 \u5e94\u7528\u8bf4\u5b83\u5df2\u7ecf\u5b8c\u6210 FIN_WAIT2 \u53e6\u4e00\u8fb9\u5df2\u540c\u610f\u91ca\u653e ITMED_WAIT \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389 CLOSING \u4e24\u8fb9\u540c\u65f6\u5c1d\u8bd5\u5173\u95ed TIME_WAIT \u53e6\u4e00\u8fb9\u5df2\u521d\u59cb\u5316\u4e00\u4e2a\u91ca\u653e LAST_ACK \u7b49\u5f85\u6240\u6709\u5206\u7ec4\u6b7b\u6389"},{"location":"system/Networking/#tcpnetstat","title":"tcp\u8fde\u63a5\u72b6\u6001\u7684\u63cf\u8ff0\u8bf4\u660e(netstat\u8f93\u51fa)","text":"<p>Active Internet connections (w/o servers)</p> <p>Proto Recv-Q Send-Q Local AddressForeign AddressState</p> <p>Proto</p> <p>The protocol (tcp, udp, raw) used by the socket.</p> <p>\u7b2c\u4e00\u5217\u4e3asocket\u4f7f\u7528\u7684\u534f\u8bae</p> <p>Recv-Q</p> <p>The count of bytes not copied by the user program connected to this socket.</p> <p>\u7b2c\u4e8c\u5217\u4e3a\u63a5\u5230\u7684\u4f46\u662f\u8fd8\u6ca1\u5904\u7406\u7684\u5b57\u8282\u6570</p> <p>Send-Q</p> <p>The count of bytes not acknowledged by the remote host.</p> <p>\u7b2c\u4e09\u5217\u4e3a\u5df2\u7ecf\u53d1\u9001\u7684\u4f46\u662f\u6ca1\u6709\u88ab\u8fdc\u7a0b\u4e3b\u673a\u786e\u8ba4\u6536\u5230\u7684\u5b57\u8282\u6570</p> <p>Local Address</p> <p>Address and port number of the local end of the socket.Unless the --numeric(-n)</p> <p>optionisspecified,thesocketaddress is resolved to its canonical host name</p> <p>(FQDN), and the port number is translated into the corresponding service name.</p> <p>\u7b2c\u56db\u5217\u4e3a \u672c\u5730\u7684\u5730\u5740\u53ca\u7aef\u53e3</p> <p>Foreign Address</p> <p>Address and port number of the remote endofthesocket.Analogousto\"Local Address.\"</p> <p>\u7b2c\u4e94\u5217\u4e3a\u5916\u90e8\u7684\u5730\u5740\u53ca\u7aef\u53e3</p> <p>State</p> <p>Thestateofthesocket.Sincethere are no states in raw mode and usually no</p> <p>states used in UDP, this column may be left blank. Normally this can be one of sev-</p> <p>eral values:</p> <p>\u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217</p> <p>netstat\u7b2c\u516d\u5217State\u7684\u72b6\u6001\u4fe1\u606f</p> <p>State</p> <p>Thestateofthesocket.Sincethere are no states in raw mode and usually no</p> <p>states used in UDP, this column may be left blank. Normally this can be one of sev-</p> <p>eral values:</p> <p>\u7b2c\u516d\u5217\u4e3asocket\u7684\u72b6\u6001\uff0c\u901a\u5e38\u4ec5\u4ec5\u6709tcp\u7684\u72b6\u6001\uff0c\u72b6\u6001\u503c\u53ef\u80fd\u6709ESTABLISHED\uff0cSYN_SENT\uff0cSYN_RECV FIN_WAIT1\uff0cFIN_WAIT2\uff0cTIME_WAIT\u7b49\uff0c\u8be6\u89c1\u4e0b\u6587\u3002\u5176\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u662f\u7b2c\u516d\u5217</p> <p>ESTABLISHED</p> <p>The socket has an established connection.</p> <p>socket\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\uff0c\u8868\u793a\u5904\u4e8e\u8fde\u63a5\u7684\u72b6\u6001\uff0c\u4e00\u822c\u8ba4\u4e3a\u6709\u4e00\u4e2aESTABLISHED\u8ba4\u4e3a\u662f\u4e00\u4e2a\u670d\u52a1\u7684\u5e76\u53d1\u8fde\u63a5\u3002\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8</p> <p>SYN_SENT</p> <p>The socket is actively attempting to establish a connection.</p> <p>socket\u6b63\u5728\u79ef\u6781\u5c1d\u8bd5\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u5373\u5904\u4e8e\u53d1\u9001\u540e\u8fde\u63a5\u524d\u7684\u4e00\u4e2a\u7b49\u5f85\u4f46\u672a\u5339\u914d\u8fdb\u5165\u8fde\u63a5\u7684\u72b6\u6001</p> <p>SYN_RECV</p> <p>A connection request has been received from the network.</p> <p>\u5df2\u7ecf\u4ece\u7f51\u7edc\u4e0a\u6536\u5230\u4e00\u4e2a\u8fde\u63a5\u8bf7\u6c42</p> <p>FIN_WAIT1</p> <p>The socket is closed, and the connection is shutting down.</p> <p>socket\u5df2\u5173\u95ed\uff0c\u8fde\u63a5\u6b63\u5728\u6216\u6b63\u8981\u5173\u95ed</p> <p>FIN_WAIT2</p> <p>Connectionisclosed,andthesocket is waiting for a shutdown from the remote end.</p> <p>\u8fde\u63a5\u5df2\u5173\u95ed\uff0c\u5e76\u4e14socket\u6b63\u5728\u7b49\u5f85\u8fdc\u7aef\u7ed3\u675f</p> <p>TIME_WAIT</p> <p>The socket is waiting after close to handle packets still in the network.</p> <p>socket\u6b63\u5728\u7b49\u5f85\u5173\u95ed\u5904\u7406\u4ecd\u5728\u7f51\u7edc\u4e0a\u7684\u6570\u636e\u5305\uff0c\u8fd9\u4e2a\u8fde\u63a5\u72b6\u6001\u5728\u751f\u4ea7\u573a\u666f\u5f88\u91cd\u8981\uff0c\u8981\u91cd\u70b9\u5173\u6ce8</p> <p>CLOSED The socket is not being used.| socket\u4e0d\u5728\u88ab\u5360\u7528\u4e86</p> <p>CLOSE_WAIT</p> <p>The remote end has shutdown, waiting for the socket to close.</p> <p>\u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u7b49\u5f85socket\u5173\u95ed</p> <p>LAST_ACK</p> <p>The remote end has shut down, and the socket is closed. Waiting for acknowl-edgement.|</p> <p>\u8fdc\u7aef\u5df2\u7ecf\u7ed3\u675f\uff0c\u5e76\u4e14socket\u4e5f\u5df2\u5173\u95ed\uff0c\u7b49\u5f85acknowl-edgement</p> <p>LISTEN Thesocketislisteningforincoming connections.Such sockets are not</p> <p>included in the output unless you specify the --listening (-l) or --all (-a)</p> <p>option.</p> <p>socket\u6b63\u5728\u76d1\u542c\u8fde\u63a5\u8bf7\u6c42</p> <p>CLOSING</p> <p>Both sockets are shut down but we still don\u2019t have all our data sent.</p> <p>sockets\u5173\u95ed\uff0c\u4f46\u662f\u6211\u4eec\u4ecd\u65e7\u6ca1\u6709\u53d1\u9001\u6570\u636e</p> <p>UNKNOWN</p> <p>The state of the socket is unknown</p> <p>\u672a\u77e5\u7684\u72b6\u6001</p> Bash<pre><code># \u65e5\u5fd7\u5206\u6790\u7bc7(Apache)\uff1a\n# \u5f97\u8bbf\u95ee\u524d10\u4f4d\u7684ip\u5730\u5740\ncat access.log|awk '{print $1}'|sort|uniq -c|sort -nr|head -10\ncat access.log|awk '{counts[$(11)]+=1}; END {for(url in counts) print counts[url], url}'\n\n# \u95ee\u6b21\u6570\u6700\u591a\u7684\u6587\u4ef6\u6216\u9875\u9762,\u53d6\u524d20\ncat access.log|awk '{print $11}'|sort|uniq -c|sort -nr|head -20\n\n# \u51fa\u4f20\u8f93\u6700\u5927\u7684\u51e0\u4e2aexe\u6587\u4ef6\uff08\u5206\u6790\u4e0b\u8f7d\u7ad9\u7684\u65f6\u5019\u5e38\u7528\uff09\ncat access.log |awk '($7~/\\.exe/){print $10 \" \" $1 \" \" $4 \" \" $7}'|sort -nr|head -20\n\n# \u51fa\u8f93\u51fa\u5927\u4e8e200000byte(\u7ea6200kb)\u7684exe\u6587\u4ef6\u4ee5\u53ca\u5bf9\u5e94\u6587\u4ef6\u53d1\u751f\u6b21\u6570\ncat access.log |awk '($10 &gt; 200000 &amp;&amp; $7~/\\.exe/){print $7}'|sort -n|uniq -c|sort -nr|head -100\n\n# \u679c\u65e5\u5fd7\u6700\u540e\u4e00\u5217\u8bb0\u5f55\u7684\u662f\u9875\u9762\u6587\u4ef6\u4f20\u8f93\u65f6\u95f4\uff0c\u5219\u6709\u5217\u51fa\u5230\u5ba2\u6237\u7aef\u6700\u8017\u65f6\u7684\u9875\u9762\ncat access.log |awk  '($7~/\\.php/){print $NF \" \" $1 \" \" $4 \" \" $7}'|sort -nr|head -100\n\n# \u51fa\u6700\u6700\u8017\u65f6\u7684\u9875\u9762(\u8d85\u8fc760\u79d2\u7684)\u7684\u4ee5\u53ca\u5bf9\u5e94\u9875\u9762\u53d1\u751f\u6b21\u6570\ncat access.log |awk '($NF &gt; 60 &amp;&amp; $7~/\\.php/){print $7}'|sort -n|uniq -c|sort -nr|head -100\n\n# \u51fa\u4f20\u8f93\u65f6\u95f4\u8d85\u8fc7 30 \u79d2\u7684\u6587\u4ef6\ncat access.log |awk '($NF &gt; 30){print $7}'|sort -n|uniq -c|sort -nr|head -20\n\n# \u8ba1\u7f51\u7ad9\u6d41\u91cf\uff08G)\ncat access.log |awk '{sum+=$10} END {print sum/1024/1024/1024}'\n\n# \u8ba1404\u7684\u8fde\u63a5\nawk '($9 ~/404/)' access.log | awk '{print $9,$7}' | sort\n\n# \u8ba1http status.\ncat access.log |awk '{counts[$(9)]+=1}; END {for(code in counts) print code, counts[code]}'\ncat access.log |awk '{print $9}'|sort|uniq -c|sort -rn\n\n# \u86db\u5206\u6790--\u67e5\u770b\u662f\u54ea\u4e9b\u8718\u86db\u5728\u6293\u53d6\u5185\u5bb9\n/usr/sbin/tcpdump -i eth0 -l -s 0 -w - dst port 80 | strings | grep -i user-agent | grep -i -E 'bot|crawler|slurp|spider'\n\n# \u65e5\u5fd7\u5206\u6790\u7bc7(Squid)\n# \u6309\u57df\u7edf\u8ba1\u6d41\u91cf\nzcat squid_access.log.tar.gz| awk '{print $10,$7}' |awk 'BEGIN{FS=\"[ /]\"}{trfc[$4]+=$1}END{for(domain in trfc){printf \"%s\\t%d\\n\",domain,trfc[domain]}}'\n\n# \u6570\u636e\u5e93\u7bc7\n# \u67e5\u770b\u6570\u636e\u5e93\u6267\u884c\u7684sql\n/usr/sbin/tcpdump -i eth0 -s 0 -l -w - dst port 3306 | strings | egrep -i 'SELECT|UPDATE|DELETE|INSERT|SET|COMMIT|ROLLBACK|CREATE|DROP|ALTER|CALL'\n</code></pre>"},{"location":"system/Windows/","title":"Windows","text":""},{"location":"system/Windows/#powershell","title":"Powershell","text":"Text Only<pre><code>oh-my-posh --init --shell pwsh --config D:/paradox.omp.json | Invoke-Expression\noh-my-posh --init --shell pwsh --config D:/ohmyposhv3-2.json | Invoke-Expression\n. $PROFILE\nnotpad $PROFILE\ncode $PROFILE\nGet-PoshThemes\nSet-PoshPrompt -Theme nu4a\nExport-PoshTheme -FilePath ~/.mytheme.omp.json -Format json\nC:\\Users\\Administrator\\AppData\\Local\\oh-my-posh\\themes\nC:\\Users\\Administrator\\Documents\\PowerShell\\Microsoft.PowerShell_profile.ps1\n\nGet-Command -list\nGet-Command -Module PowerShellGet\nSet-PSRepository -Name PSGallery -InstallationPolicy Trusted\nGet-Module -Name PowerShellGet -ListAvailable\n</code></pre>"},{"location":"system/Windows/#docker-desktop","title":"docker-desktop","text":"Markdown<pre><code>start /w \"\" \"Docker Desktop Installer.exe\" install --no-windows-containers --backend=wsl-2 --installation-dir=D:\\Docker\n\n\u81ea\u5b9a\u4e49docker-desktop\u548cdocker-desktop-data\u6570\u636e\u76ee\u5f55\nwsl --shutdown\nwsl --export docker-desktop \"E:\\dockerwsl\\distro\\docker-desktop.tar\"\nwsl --export docker-desktop-data \"E:\\dockerwsl\\data\\docker-desktop-data.tar\"\nwsl --unregister docker-desktop\nwsl --unregister docker-desktop-data\nwsl --import docker-desktop \"E:\\dockerwsl\\distro\" \"E:\\dockerwsl\\distro\\docker-desktop.tar\" --version 2\nwsl --import docker-desktop-data \"E:\\dockerwsl\\data\" \"E:\\dockerwsl\\data\\docker-desktop-data.tar\" --version 2\n</code></pre>"},{"location":"system/Windows/#wsl","title":"wsl","text":"Markdown<pre><code>\u5b98\u65b9\u6559\u7a0b\u94fe\u63a5\uff1ahttps://learn.microsoft.com/en-us/windows/wsl/install-manual#downloading-distributions\nGet-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux\n\u624b\u52a8\u4e0b\u8f7d\u53d1\u884c\u5305\nhttps://learn.microsoft.com/zh-cn/windows/wsl/install-manual\n\u5c06WSL\u53d1\u884c\u7248\u5b89\u88c5\u5230\u81ea\u5b9a\u4e49\u4f4d\u7f6e\n1. dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\n2. Invoke-WebRequest -Uri https://aka.ms/wslubuntu2004 -OutFile Ubuntu.appx -UseBasicParsing\n3. move .\\Ubuntu.appx .\\Ubuntu.zip\n4. Expand-Archive .\\Ubuntu.zip\n5. \u8fdb\u5165\u89e3\u538b\u540e\u7684\u76ee\u5f55\uff0c\u6267\u884c\u5bf9\u5e94\u7248\u672c\u7684exe\u8fdb\u884c\u521d\u59cb\u5316\n6. wsl.exe --import Debian D:\\Debian .\\install.tar.gz\n7. \u5c06\"D:\\Debian\"\u8def\u5f84\u6dfb\u52a0\u5230Path\u4e2d\u4ee5\u4ece\u4efb\u4f55\u5730\u65b9\u8c03\u7528\u5b83\n\n\u4e00\u822c\u51fa\u9519\u5904\u7406\u6267\u884c\u547d\u4ee4\uff1anetsh winsock reset\n</code></pre>"},{"location":"system/Windows/#_1","title":"\u81ea\u52a8\u5173\u673a","text":"Batchfile<pre><code>sleep 3600; shutdown -s\n\u6216\nat 00:00:00PM shutdown -s\n\u6216\nschtasks /create /sc once /tn \"auto shutdown my computer\" /tr \"shutdown -s\" /st 15:30\n\n* Schedule daily shutdown *\n\nAt 11:00:00PM /every:M,T,W,TH,F,SA,SU shutdown -s\n\n* Schedule automatic resart *\n\nat 11:00:00PM shutdown -r\n\n* For Sleep *\n\nsleep number_of_seconds_to_wait; shutdown -r\n</code></pre> <p>serial number for RAM, motherboard, hard disk,Changing Computer Name</p> Batchfile<pre><code>wmic memorychip get serialnumber\nwmic diskdrive get serialnumber\nwmic baseboard get serialnumber\nwmic cdrom where drive='d:' get SerialNumber\n\nWMIC computersystem where caption='currentname' rename newname\n</code></pre> <p>Disable WiFi connection</p> Batchfile<pre><code>netsh interface set interface name=\"Wireless Network Connection\" admin=DISABLED\n</code></pre> <p>Enable/Disable Firewall</p> Batchfile<pre><code>* For XP/Server 2003 *\n\nnetsh firewall set opmode mode=ENABLE\nnetsh firewall set opmode mode=DISABLE\n\n* For later versions *\n\nnetsh advfirewall set currentprofile state on\nnetsh advfirewall set  currentprofile state off\n\nnetsh advfirewall set domainprofile state on\nnetsh advfirewall set domainprofile state off\n\nnetsh advfirewall set privateprofile state on\nnetsh advfirewall set privateprofile state off\n\nnetsh advfirewall set publicprofile state on\nnetsh advfirewall set publicprofile state off\n\nnetsh advfirewall set  allprofiles state on\nnetsh advfirewall set  allprofiles state off\n</code></pre> <p>Join or remove a Computer to Domain</p> Batchfile<pre><code>netdom.exe join %computername% /domain:DomainName /UserD:DomainName\\UserName /PasswordD:Password\n\nnetdom.exe remove %computername% /domain:Domainname /UserD:DomainName\\UserName /PasswordD:Password\n</code></pre> <p>@echo off&amp;setlocal enabledelayedexpansion rem \u6839\u636e\u5f53\u524d\u65e5\u671f\u83b7\u53d6\uff0c\u5e74\u6708\u65e5\u4e32 set yyyy=%date:~0,4% set mm=%date:~5,2% set day=%date:~8,2% set \"Ymd=%yyyy%-%mm%-%day%\"</p> <p>rem \u628a\u5e74\u6708\u65e5\u4e32\u4e2d\u672b\u5c3e\u7a7a\u683c\u66ff\u6362\u6389 set \"Ymd=%Ymd: =%\" echo %Ymd%</p> <p>rem \u83b7\u53d6n\u5929\u524d\u7684\u65e5\u671f for /f \"tokens=1-3 delims=-:/ \" %%a in (\"%date%\") do (set Y=%%a&amp;set M=%%b&amp;set D=%%c&amp;if \"!M:~0,1!\"\"0\" set M=!M:~1! if \"!D:~0,1!\"\"0\" set D=!D:~1!) rem \u60f3\u83b7\u53d6n\u5929\u524d\uff0c\u5c31\u4fee\u6539set/a D-=n\u5929\u6570\u5c31\u884c set/a D-=1&amp;if !D! leq 0 (set/a M-=1&amp;if !M!==0 set/a Y-=1,M=12 set/a \"T=<sup>!(M-2)\",\"R=(</sup>!(Y%%4)&amp;<sup>!</sup>!(Y%%100))|<sup>!(Y%%400)\",\"C=</sup>!(M-4)|<sup>!(M-6)|</sup>!(M-9)|<sup>!(M-11)\",\"D=T*(28+R)+C*30+(</sup>!T&amp;^!C)*31\"+D) set M=0%M%&amp;set D=0%D% set previousdate=%Y%-%M:<sub>-2%-%D:</sub>-2% echo %previousdate%</p> <p>rem \u5220\u9664\u524d\u4e00\u5929\u7684\u538b\u7f29\u6587\u4ef6 del E:\\compresed\\%previousdate%.7z /q</p> <p>rem \u538b\u7f29\u4eca\u5929\u7684\u65e5\u5fd7\u6587\u4ef6 cd /d D: cd D:\\7-Zip 7z.exe a -r E:\\compresed\\%Ymd%.7z E:\\log_%Ymd%.csv -m0=LZMA2 -mx=9 -aoa -y</p> <p>java \u73af\u5883</p> <p>\u53d8\u91cf\u540d\uff1aPath \u53d8\u91cf\u503c\uff1a%java_home%\\bin \u65b0\u5efa\u53d8\u91cf\u540d\uff1aJAVA_HOME \u53d8\u91cf\u503c\uff1aD:\\jdk1.8.0_111\uff08\u8fd9\u91cc\u662fjdk\u7684\u5b89\u88c5\u76ee\u5f55\uff09</p> Text Only<pre><code>VMware Workstation 15.x\nFU512-2DG1H-M85QZ-U7Z5T-PY8ZD\nCU3MA-2LG1N-48EGQ-9GNGZ-QG0UD\nGV7N2-DQZ00-4897Y-27ZNX-NV0TD\nYZ718-4REEQ-08DHQ-JNYQC-ZQRD0\nGZ3N0-6CX0L-H80UP-FPM59-NKAD4\nYY31H-6EYEJ-480VZ-VXXZC-QF2E0\nZG51K-25FE1-H81ZP-95XGT-WV2C0\nVG30H-2AX11-H88FQ-CQXGZ-M6AY4\nCU7J2-4KG8J-489TY-X6XGX-MAUX2\nFY780-64E90-0845Z-1DWQ9-XPRC0\nUF312-07W82-H89XZ-7FPGE-XUH80\nAA3DH-0PYD1-0803P-X4Z7V-PGHR4\n\nvisio\u5bc6\u94a5\nW9WC2-JN9W2-H4CBV-24QR7-M4HB8\n</code></pre>"},{"location":"system/Windows/#windows_1","title":"windows\u66f4\u6539\u8fdc\u7a0b\u684c\u9762\u7aef\u53e3","text":"Batchfile<pre><code>regedit\u6253\u5f00\u6ce8\u518c\u8868\uff0c\u5206\u522b\u66f4\u6539\u5176\u4e0b\u7684PortNumber\u952e\u503c\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\n\nbat\u811a\u672c\u8fdc\u7a0b\u8fde\u63a5\uff1b\u811a\u672c\u5982\u4e0b\u3002\u4f7f\u7528\u793a\u4f8b\uff1ardp.bat \"my.host.name.de\" \"port\" \"username\" \"password\"\n\n:: RDP connection without password prompt ------------\n:: %1 = hostname\n:: %2 = port\n:: %3 = username\n:: %4 = password\n:: ---------------------------------------------------\ncmdkey /add:\"%~1\" /user:\"%~3\" /pass:\"%~4\"\nstart /wait mstsc /v:\"%~1:%~2\"\ncmdkey /delete:\"%~1\"\n\nrem \u5237\u65b0\u7ec4\u7b56\u7565\ngpupdate/force\ngpupdate /target:computer\n</code></pre> <p>windows\u670d\u52a1\u7ed1\u5b9aIP\u95ee\u9898 netsh\u2192&gt;http\u2192&gt;show iplisten delete iplisten ipaddress=x.x.x.x</p> <p>choice /t 5 /d y /n &gt;nul    # \u6279\u5904\u7406\u547d\u4ee4\u5ef6\u8fdf\u65b9\u6cd5</p>"},{"location":"system/Windows/#windows-commands","title":"Windows Commands\u8be6\u89e3\u5927\u5168","text":"<p>\u8fdc\u7a0b\u684c\u9762\u670d\u52a1\u67092\u79cd\u5de5\u4f5c\u6a21\u5f0f\uff0cAdministration Mode\u548cApplication Mode\u3002\u8fd9\u4e24\u79cd\u5de5\u4f5c\u6a21\u5f0f\u5206\u522b\u9002\u5e94\u4e0d\u540c\u7684\u573a\u666f\u9700\u6c42</p> <p>Administration Mode \u9ed8\u8ba4\u7684Windows Server\u5b89\u88c5\u540e\u5c31\u5904\u4e8e\u8be5\u6a21\u5f0f\uff0c\u670d\u52a1\u5668\u4e0d\u8981\u6c42\u5ba2\u6237\u7aef\u63d0\u4f9bLicense\uff0c\u4f46\u662f\u4ec5\u4ec5\u5141\u8bb82\u4e2a\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5</p> <p>Application Mode \u5fae\u8f6f\u7684Windows Server\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u590d\u6742\u7684\u8fdc\u7a0b\u8fde\u63a5\u7684\u573a\u666f\u9700\u8981\uff0c\u63d0\u4f9b\u4e86\u7c7b\u4f3c\u4e8eCitrix\u57fa\u4e8e\u8fdc\u7a0b\u684c\u9762\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u7528\u6237\u5728\u5b89\u88c5\u8fdc\u7a0b\u684c\u9762\u4f1a\u8bdd\u670d\u52a1(Remote Desktop  Session Host)\u540e\uff0c\u670d\u52a1\u5668\u8f6c\u6362\u4e3aapplication mode\uff0c\u624d\u53ef\u4ee5\u4e0d\u9650\u5236\u7528\u6237\u6570\u8fdb\u884c\u8fde\u63a5</p> <p>\u6b64\u65f6\uff0c\u670d\u52a1\u5668\u9ed8\u8ba4\u6709120\u5929\u7684Grace Period\uff0c\u5141\u8bb8\u4e0d\u9650\u5236\u7528\u6237\u6570\u7684\u8fdc\u7a0b\u8fde\u63a5\u3002\u5728120\u5929\u540e\uff0c\u60a8\u5fc5\u987b\u6307\u5b9a\u4e00\u53f0\u5df2\u7ecf\u5b89\u88c5Remote Desktop License\u7684\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u624d\u53ef\u4ee5\u591a\u7528\u6237\u7ee7\u7eed\u8fde\u63a5\uff0c\u5426\u5219\u4f1a\u63d0\u793a\u201c\u7531\u4e8e\u6ca1\u6709\u8fdc\u7a0b\u684c\u9762\u6388\u6743\u670d\u52a1\u5668\u53ef\u4ee5\u63d0\u4f9b\u8bb8\u53ef\u8bc1\uff0c\u8fdc\u7a0b\u4f1a\u8bdd\u88ab\u4e2d\u65ad\u201c\u7684\u62a5\u9519\u3002\u4f46\u662f\u6b64\u65f6\u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7mstsc /admin\u547d\u4ee4\u8fde\u63a5\u5230\u8fdc\u7a0b\u684c\u9762</p> <p>1.\u7eafcmdlet\u547d\u4ee4 Get-Process -Name notepad | Stop-Process</p> <p>2.cmdlet+\u904d\u5386 Get-Process -Name notepad | foreach-object{$_.Kill()}</p> <p>3.WMI \u5bf9\u8c61 + \u904d\u5386 + \u5bf9\u8c61\u65b9\u6cd5 Get-WmiObject Win32_Process -Filter \"name = 'notepad.exe'\" | ForEach-Object{$_.Terminate()  | Out-Null }</p> <p>4.WMI \u5bf9\u8c61 + \u904d\u5386 + cmdlet\u65b9\u6cd5 Get-WmiObject Win32_Process -Filter \"name = 'notepad.exe'\" | Invoke-WmiMethod -Name Terminate | Out-Null</p>"},{"location":"system/linux/Centos/","title":"Linux","text":"<p>I. stunnel -&gt; varnish -&gt; HAProxy -&gt; nginx -&gt; nodeJS -&gt; memcached(redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8])</p> <p>II. Apache Traffic Server/Squid/Vanish + HAProxy + Nginx + memcached(Redis) (for session storage[Session \u5bf9\u8c61\u5b58\u50a8])</p> <p>III. nginx (for HTTP compression) \u2013&gt; Varnish cache (for caching) \u2013&gt; HTTP level load balancer (HAProxy, or nginx, or the Varnish built-in) \u2013&gt; webservers</p>"},{"location":"system/linux/Centos/#_1","title":"\u4f20\u7edf\u5206\u533a\u65b9\u6848\u53c2\u8003","text":"\u670d\u52a1\u5668\u7c7b\u578b \u57fa\u672craid\u65b9\u6848 \u5355\u673a\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\uff0c\u4e00\u822c\u53ef\u91c7\u7528raid5\u6298\u4e2d \u8d1f\u8f7d\u5747\u8861\u5668\uff08\u5982LVS\u7b49\uff09 \u6570\u636e\u91cf\u5c0f\uff0c\u91cd\u8981\u6027\u9ad8\uff0c\u53ef\u91c7\u7528RAID1 \u8d1f\u8f7d\u5747\u8861\u4e0b\u7684RS server \u6570\u636e\u91cf\u5927\uff0c\u91cd\u8981\u6027\u4e0d\u9ad8\uff0c\u6709\u6027\u80fd\u8981\u6c42\uff0c\u6570\u636e\u8981\u6c42\u4f4e\uff0c\u53ef\u91c7\u7528RAID0 \u6570\u636e\u5e93\u670d\u52a1\u5668 \u89c6\u6570\u636e\u53ca\u6027\u80fd\u8981\u6c42\u4e3b\u5e93\u53ef\u91c7\u53d6raid10/raid5\uff0c\u4ece\u5e93\u53ef\u91c7\u7528raid0\u63d0\u9ad8\u6027\u80fd\uff08\u8bfb\u5199\u5206\u79bb\u7684\u60c5\u51b5\u4e0b\uff09 \u5b58\u50a8\u670d\u52a1\u5668 \u53ef\u91c7\u53d6sata\u76d8\uff0craid5 \u5171\u4eab\u5b58\u50a8\u670d\u52a1\u5668\uff08\u5982NFS\uff09 \u89c6\u6027\u80fd\u53ca\u8bbf\u95ee\u8981\u6c42\u53ef\u4ee5raid5,raid10,\u751a\u81f3raid0\uff08\u8981\u6709\u9ad8\u53ef\u7528\u6216\u53cc\u5199\u65b9\u6848\uff09 \u76d1\u63a7\u670d\u52a1\u5668 \u5355\u76d8\u6216\u53cc\u76d8raid1\u5373\u53ef\u3002\u4e09\u76d8\u5c31RAID5\uff0c\u770b\u5bb9\u91cf\u8981\u6c42\u52a0\u76d8\u5373\u53ef"},{"location":"system/linux/Centos/#linux_1","title":"Linux\u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"system/linux/Centos/#linux_2","title":"linux\u78c1\u76d8\u8be6\u89e3","text":"Markdown<pre><code>\u78c1\u76d8\u5206\u533a\u6709\u4e3b\u5206\u533a\u3001\u6269\u5c55\u5206\u533a\u3001\u903b\u8f91\u5206\u533a\uff0c\u4e00\u5757\u786c\u76d8\u6700\u591a\u53ef\u4ee5\u6709\u56db\u4e2a\u4e3b\u5206\u533a\uff0c\u5176\u4e2d\u4e00\u4e2a\u4e3b\u5206\u533a\u7684\u4f4d\u7f6e\u53ef\u4ee5\u7528\u4e00\u4e2a\u6269\u5c55\u5206\u533a\u66ff\u6362\uff0c\u4e14\u4e00\u5757\u786c\u76d8\u53ea\u80fd\u6709\u4e00\u4e2a\u6269\u5c55\n\u5206\u533a\uff0c\u5728\u8fd9\u4e2a\u6269\u5c55\u5206\u533a\u5185\u53ef\u4ee5\u5212\u5206\u591a\u4e2a\u903b\u8f91\u5206\u533a\n\u9884\u8ba1\u8d85\u8fc7\u56db\u4e2a\u5206\u533a\uff0c\u81f3\u5c11\u4e00\u4e2a\u6269\u5c55\u5206\u533a\uff1a3p+1e\u30012p+1e\u30011p+1e-----p\uff1a\u4e3b\u5206\u533a\u3001e\uff1a\u6269\u5c55\u5206\u533a\n\n\u78c1\u76d8\u5206\u533a\u7684\u8bbe\u5907\u540d\uff1a\n\u5728linux\u4e2d\uff0c\u901a\u8fc7\u8bbe\u5907\u540d\u8bbf\u95ee\u8bbe\u5907\uff0c\u8bbe\u5907\u540d\u5b58\u653e\u5728/dev\u76ee\u5f55\n* \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a/dev/hda\n* \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757IDE\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a/dev/hdb\n* \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a/dev/sda\n* \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757SCSI\u63a5\u53e3\u7684\u786c\u76d8\u540d\u79f0\u4e3a/dev/sdb\n\n\u5206\u533a\u5219\u4f7f\u7528\u6570\u5b57\u7f16\u53f7\u6807\u8bc6\uff1a\n* \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a/dev/hda1\n* \u7cfb\u7edf\u7684\u7b2c\u4e8c\u5757IDE\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a/dev/hdb1\n* \u7cfb\u7edf\u7684\u7b2c\u4e00\u5757SCSI\u63a5\u53e3\u7684\u786c\u76d8\u7b2c\u4e00\u4e2a\u5206\u533a\u540d\u79f0\u4e3a/dev/sdb1\n\n\u6ce8\u610f\uff1a\n\u78c1\u76d8\u5206\u533a\u683c\u5f0f\u5316\u6587\u4ef6\u7cfb\u7edf\u540e\uff0c\u4f1a\u5206\u4e3ainode\u548cblock\u4e24\u90e8\u5206\ninode\u5b58\u653e\u6587\u4ef6\u7684\u5c5e\u6027\u548c\u6267\u884c\u6587\u4ef6\u5b9e\u4f53\u7684\u6307\u9488\uff0c\u6587\u4ef6\u540d\u4e0d\u5728inode\u5185\u4e00\u822c\u5728\u4e0a\u7ea7\u76ee\u5f55\u7684block\u4e2d\ndf -i\u67e5\u770binode\u6570\u91cf\u548c\u60c5\u51b5\uff0c\u4e00\u4e2a\u6587\u4ef6\u81f3\u5c11\u5360\u7528\u4e00\u4e2ainode\u548c\u4e00\u4e2ablock\n\u683c\u5f0f\u5316\u65f6\uff0c\u53ef\u4ee5\u6539\u53d8inode\u548cblock\n\u5206\u533a\u6570\u5b57\u7f16\u53f71-4\u7559\u7ed9\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\u4f7f\u7528\uff0c\u903b\u8f91\u5206\u533a\u662f\u5728\u6269\u5c55\u5206\u533a\u7684\u57fa\u7840\u4e0a\u7f16\u53f7\u4ece5\u5f00\u59cb\nSCSI/SAS/SATA/USB\u63a5\u53e3\u7684\u786c\u76d8\u7684\u8bbe\u5907\u540d\u5747\u4ee5/dev/sd\u5f00\u5934\uff0c\u4e0d\u540c\u786c\u76d8\u7f16\u53f7\u4f9d\u6b21\u662f/dev/sda\u3001/dev/sdb\nSAS/SATA\u662f\u4e3b\u6d41\u786c\u76d8\u63a5\u53e3\uff0cSSD\u56fa\u6001\u786c\u76d8\uff0c\u901f\u5ea6\u6027\u80fdSSD&gt;SAS&gt;SATA\n</code></pre>"},{"location":"system/linux/Centos/#linux_3","title":"linux\u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\u89e3\u6790","text":"Markdown<pre><code>\u7cfb\u7edf\u5f15\u5bfc\u6d41\u7a0b\uff1a\n\u56fa\u4ef6firmware (CMOS/BIOS)  post\u52a0\u7535\u81ea\u68c0\n\u5bf9\u4e8e\u56fa\u4ef6\u7684\u7406\u89e3\uff0c\u662f\u4ecb\u4e8e\u8f6f\u4ef6\u548c\u786c\u4ef6\u4e4b\u95f4\u7684\u8f6f\u4ef6\u4ee3\u7801\uff0c\u4f46\u540c\u65f6\u70e7\u5f55\u5230\u786c\u4ef6\u5f53\u4e2d\uff1bCMOS\u56fa\u5316\u5728\u786c\u4ef6\u4e2d\uff0c\u4f5c\u4e3a\u56fa\u4ef6\u7684\u5e73\u53f0\uff0cBIOS\u662f\u7ba1\u7406CMOS\u7684\u7ba1\u7406\u754c\u9762\n\n\u63a5\u7740\uff0c\u81ea\u4e3e\u7a0b\u5e8fbootloader (GRUB),\u8f7d\u5165\u5185\u6838\n\u7b2c\u4e00\u6b65\u7684\u6700\u540e\u8981\u8bfb\u53d6\u786c\u76d8\u4e2d\u7684MBR\uff0c\u5305\u542b\u4e86BootLoader,\u5728MBR\u4e2d\u8fd8\u5305\u542b\u4e86\u5206\u533a\u8868\u7b49\u4fe1\u606f\n\n\u5185\u6838\u7684\u5de5\u4f5c\uff0c\u9a71\u52a8\u786c\u4ef6\uff0c\u542f\u52a8\u521d\u59cb\u8fdb\u7a0binit;\u5728kernel\u4e2d\u5927\u90e8\u5206\u90fd\u662f\u7a0b\u5e8f\uff1binit\u542f\u52a8\u540e\u8bfb\u53d6inittab\u6587\u4ef6\uff0c\u6267\u884c\u7f3a\u7701\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\uff0c\u4ece\u800c\u7ee7\u5f15\u5bfc\u8fc7\u7a0b\n\u5728linux\u7cfb\u7edf\u4e2d\uff0cinit\u662f\u7b2c\u4e00\u4e2a\u5b58\u5728\u7684\u8fdb\u7a0b\uff0c\u5b83\u7684PID\u6052\u4e3a\u4e00\uff0c\u4f46\u4e5f\u5fc5\u987b\u5411\u4e00\u4e2a\u66f4\u9ad8\u7ea7\u7684\u529f\u80fd\u8d1f\u8d23\uff1aPID\u4e3a\u96f6\u7684\u5185\u6838\u8c03\u5ea6\u5668\uff0c\u4ece\u800c\u83b7\u5f97cpu\u65f6\u95f4\n\n\u5173\u952e\u70b9\uff1a\u5bf9\u4e8e\u7236\u5b50\u8fdb\u7a0b\u7684\u5173\u7cfb\u3002\u9996\u5148\uff0c\u7236\u8fdb\u7a0b\u4e2d\u65ad\uff0c\u5b50\u8fdb\u7a0b\u540c\u6837\u4f1a\u4e2d\u65ad\uff1b\u5982\u679c\u7236\u8fdb\u7a0b\u4e2d\u65ad\u540e\uff0c\u5b50\u8fdb\u7a0b\u6ca1\u6709\u4e2d\u65ad\uff0c\u8fd9\u79cd\u5173\u7cfb\u5f62\u8c61\u79f0\u4e4b\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u7cfb\u7edf\u53d1\u73b0\u540e\n\u4f1a\u5c06\u5b64\u513f\u8fdb\u7a0b\u6307\u5411\u7236\u8fdb\u7a0binit;\u5982\u679c\u7236\u8fdb\u7a0b\u6b63\u5e38\uff0c\u800c\u5b50\u8fdb\u7a0b\u4e2d\u65ad\u7684\u8bdd\uff0c\u8fd9\u6837\u6ef4\u5173\u7cfb\u79f0\u4e4b\u4e3a\u50f5\u5c38\u8fdb\u7a0b\uff1b\u8fd9\u4e24\u79cd\u8fdb\u7a0b\u5728\u7cfb\u7edf\u4e2d\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684\n\n\u5907\u6ce8\uff1alinux\u4e2d\u7684\u8fd0\u884c\u7ea7\u522b\u7c7b\u4f3c\u4e8ewindows\u5e73\u53f0\u4e2d\u7684F8\u529f\u80fd\n\u5355\u7528\u6237\u6a21\u5f0f\uff08\u7ea7\u522b1\uff09\u7c7b\u4f3cwindos\u5e73\u53f0\u4e2dF8\u7684\u5b89\u5168\u6a21\u5f0f\uff0c\u533a\u522b\u662f\u6ca1\u6709\u56fe\u5f62\u754c\u9762\uff0c\u53ea\u6709\u547d\u4ee4\u8f93\u5165\n\u8fd0\u884c\u7ea7\u522b2 \u548c 3\u7684\u533a\u522b\u5c31\u662f2\u7ea7\u522b\u6ca1\u6709NFS\u529f\u80fd\uff0c\u540c\u65f6\u90fd\u662f\u591a\u7528\u6237\u6a21\u5f0f\n\u67e5\u770b\u5f53\u524d\u7684\u8fd0\u884c\u7ea7\u522b\uff1arunlevel\n\u8fd0\u884c\u7ea7\u522b\u7684\u5207\u6362\uff1ainit 0 1 2 3 4 5  S \u6216\u8005 telinit 0 1 2 3 4 5\n\n\u6269\u5c55\uff1a\u5b9e\u9645\u5927\u5bb6\u901a\u8fc7\u547d\u4ee4ls -l `which telinit`\u5f97\u77e5telinit\u540d\u662finit\u547d\u4ee4\u7684\u4e00\u4e2a\u8f6f\u8fde\u63a5\u800c\u5df2\n\ngrep -v \"^#\" /etc/inittabl #\u63d0\u53d6\u6709\u6548\u884c\uff0c\u4f5c\u4e3a\u5206\u6790\u6570\u636e\n\u6587\u4ef6\u683c\u5f0f\u5206\u6790\uff1a\uff08\u5b57\u6bb5\u7ec4\u6210\u7ed3\u6784\u5982\u4e0b\u6240\u793a\uff1a\uff09\nid:runlevels    action:process\nid              \u6807\u793a\u7b26,\u4e00\u822c\u90fd\u662f\u4e24\u4f4d\u5b57\u6bcd\u6216\u8005\u6570\u5b57\nrunlevels       \u6307\u5b9a\u8fd0\u884c\u7ea7\u522b\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u4e2a\uff1b\u4f8b\u5982::\u4ee3\u88680-6\naction          \u6307\u5b9a\u8fd0\u884c\u72b6\u6001\nprocess         \u6307\u5b9a\u8981\u8fd0\u884c\u7684\u811a\u672c\u6216\u8005\u547d\u4ee4\n\naction\u53d6\u503c\uff1a\ninitdefault     \u8868\u793a\u7cfb\u7edf\u7f3a\u7701\u7684\u542f\u52a8\u8fd0\u884c\u7ea7\u522b\nsysinit         \u7cfb\u7edf\u542f\u52a8\u65f6\u6267\u884cprocess\u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\nwait            \u6267\u884cprocess\u4e2d\u6307\u5b9a\u547d\u4ee4\uff0c\u5e76\u7b49\u5230\u7ed3\u675f\u540e\u5728\u8fd0\u884c\u5176\u4ed6\u7684\u547d\u4ee4\none             \u6267\u884cprocess\u4e2d\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u4e0d\u9700\u8981\u7b49\u5f85\u7ed3\u675f\nctrlaltdel      \u6309\u4e0b\u7ec4\u5408\u952e\u6267\u884cprocess\u6307\u5b9a\u7684\u547d\u4ee4\uff1b(\u5173\u673a\u7684\u64cd\u4f5c)\n\n\u5148\u540e\u987a\u5e8f\uff1a\n1. id:3:initdefault\uff1a\n2. l3:3:wait:/etc/rc.d/rc\n3. /etc/rc.d/rc3.d\n\n\u5224\u65ad\u9ed8\u8ba4\u7684\u8fd0\u884c\u7ea7\u522b\u8c03\u7528/etc/rc.d/rc\u811a\u672c\uff0c\u6267\u884c\u76f8\u5173\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e2d\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u5b8c\u6210\u76f8\u5e94\u8fd0\u884c\u7ea7\u522b\u7684\u521d\u59cb\u5316\u914d\u7f6e\uff1b\u4e4b\u540e\u627e\u5230/etc/rc.d/rc3.d\u811a\u672c\n\u5b8c\u6210\u7cfb\u7edf\u540e\u7eed\u7684\u5f15\u5bfc\u8fc7\u7a0b\uff0c\u5176\u4f5c\u7528\u662f\u5206\u522b\u5b58\u653e\u5bf9\u5e94\u4e8e\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c\u7684\u7b26\u53f7\u94fe\u63a5\uff0c\u94fe\u63a5\u5230init.d\u76ee\u5f55\u4e2d\u7684\u76f8\u5e94\u811a\u672c\n/etc/rc.d/r3.d \u76ee\u5f55\u5305\u542b\u4e86\u4e24\u79cd\u6587\u4ef6\u5f88\u91cd\u8981\uff0c\u4e00\u79cd\u5927\u5199S\u5f00\u5934\uff0c\u53e6\u4e00\u79cd\u662f\u5927\u5199\u7684K\u5f00\u5934\n\nS  start   K  kill  number \u8868\u793a\u542f\u52a8\u7684\u987a\u5e8f\uff0c\u6570\u5b57\u8d8a\u5c0f\u4f18\u5148\u542f\u52a8\uff1b\u5982\u679c\u6570\u5b57\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u4f1a\u6309\u7167\u521b\u5efa\u7684\u65f6\u95f4\n\nFirmware\n   |\nBootLoader\n   |\nKernel\n   |\n init\n   |\n/etc/inittab\n   |\ninitdefault\n   |\n/etc/rc.d/rc.sysinit\n   |\n/etc/rc.d/rc\n   |\n/etc/rc.d/rcN.d\n   |\nLogin(username ,password)\n\n\u542f\u52a8\u7cfb\u7edf\u9996\u5148\u56fa\u4ef6\u7684\u52a0\u7535\u81ea\u68c0\uff1b\u5178\u578b\u4e3aPC\u4e2dcmos/bios\u4f5c\u7528\u662f\u5728\u7269\u5c42\u6b21\u9762\u4e0a\u68c0\u6d4b\u6240\u6709\u7684\u786c\u4ef6\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1b\u5982\u679c\u786c\u4ef6\u6b63\u5e38\u7684\u8bdd\uff0c\u4f1a\u8bfb\u53d6\u786c\u76d8\u7684\u4e0a\u5b58\u653e\n\u7269\u7406\u6570\u636e\u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6eMBR\uff0cMBR\u4e3b\u8981\u662f\u5b58\u653e\u81ea\u4e3e\u7a0b\u5e8fBootLoader\uff0c\u5728linux\u7cfb\u7edf\u4e2d\u6211\u4eec\u5927\u591a\u6570\u91c7\u7528\u7684\u662fGRUB\uff0cGRUB\u7684\u4e3b\u8981\u4f5c\u7528\u5c31\u662f\u8f7d\u5165\u5185\u6838\uff1b\u8f7d\u5165\n\u5185\u6838\u540e\uff0c\u4e24\u4e2a\u4f5c\u7528\uff0c\u7b2c\u4e00\u662f\u5728linux\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u4e0a\u662f\u9a71\u52a8\u786c\u4ef6\u548c\u542f\u52a8init\u8fdb\u7a0b\uff1b\u7136\u540e\u8bfb\u53d6/etc/inittab\u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u7f6e\u6587\u4ef6\u4f1a\u5224\u65ad\u7cfb\u7edf\u7f3a\u7701\u7684\u8fd0\u884c\n\u7ea7\u522b\u7136\u540e\u6267\u884c\u811a\u672c/etc/rc.d/rc.sysinit\u52a0\u8f7d\u57fa\u672c\u7684\u7cfb\u7edf\u670d\u52a1\uff1b\u63a5\u7740\u6839\u636e\u8bbe\u7f6e\u7684\u7f3a\u7701\u7cfb\u7edf\u8fd0\u884c\u7ea7\u522b\uff08id:3,5:initdefault:\uff09\u6267\u884c/etc/rc.d/rc\n\u811a\u672c\uff0c\u6b64\u811a\u672c\u4f1a\u5224\u65adinitdefault\uff0c\u7136\u540e\u542f\u52a8\u5bf9\u5e94\u7684\u8fd0\u884c\u7ea7\u522b\u76ee\u5f55\u4e0b\u9762\u7684\u7a0b\u5e8f/etc/rc.d/rcN.d\uff0c\u6700\u540e\u51fa\u73b0\u767b\u9646\u754c\u9762\u4e86\uff0c\u8f93\u5165\u6b63\u786e\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u5373\u53ef\n\u767b\u5f55\u7cfb\u7edf\u7ee7\u800c\u7ba1\u7406\u670d\u52a1\u5668\n\n/etc/rc.d/init.d\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u4e86\u5404\u4e2a\u8fd0\u884c\u7ea7\u522b\u7684\u670d\u52a1\u7a0b\u5e8f\u811a\u672c\n/etc/init.d \u53d1\u73b0\u6b64\u6587\u4ef6\u662f/etc/rc.d/init.d\u7684\u8f6f\u8fde\u63a5\n</code></pre>"},{"location":"system/linux/Centos/#_2","title":"\u6dfb\u52a0\u786c\u76d8\u6216\u5206\u533a\u8be6\u7ec6\u6b65\u9aa4","text":"Bash<pre><code>dmesg | grep sdb    # \u68c0\u67e5\u786c\u76d8\u8bbe\u5907sdb\u662f\u5426\u5b58\u5728\nfdisk -l /dev/sdb   # \u67e5\u770b\u6b64\u786c\u76d8\u8bbe\u5907\u4fe1\u606f\nfdisk /dev/sdb      # \u5bf9\u786c\u76d8\u8fdb\u884c\u5206\u533a\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u65f6ext4\u7c7b\u578b\uff0cid=83\uff0cid=82\u662fswap\n\n: &lt;&lt; comment\n\u8f93\u5165`m`\u5217\u51fa\u53ef\u4ee5\u6267\u884c\u7684\u547d\u4ee4\uff1a\ncommand (m for help): m\n\n\u8f93\u5165`p`\u5217\u51fa\u78c1\u76d8\u76ee\u524d\u7684\u5206\u533a\u60c5\u51b5\uff1a\nCommand (m for help): p\n\n\u8f93\u5165`d`\u7136\u540e\u9009\u62e9\u5206\u533a\uff0c\u5220\u9664\u73b0\u6709\u5206\u533a\uff1a\nCommand (m for help): d\nPartition number (1-4): 1\n\nCommand (m for help): d\nSelected partition 2\n\n\u67e5\u770b\u5206\u533a\u60c5\u51b5\uff0c\u786e\u8ba4\u5206\u533a\u5df2\u7ecf\u5220\u9664(\u5bf9\u5e94\u5206\u533a\u5220\u9664\u540e\uff0c\u4e0d\u4f1a\u518d\u663e\u793a)\uff1a\nCommand (m for help): p\n\n\u8f93\u5165`n`\u5efa\u7acb\u65b0\u7684\u78c1\u76d8\u5206\u533a\uff0c\u9996\u5148\u5efa\u7acb\u4e24\u4e2a\u4e3b\u78c1\u76d8\u5206\u533a\uff1a\nCommand (m for help): n\nCommand action\n   e   extended\n   p   primary partition (1-4)\np    //\u5efa\u7acb\u4e3b\u5206\u533a\nPartition number (1-4): 1  //\u5206\u533a\u53f7\nFirst cylinder (1-391, default 1):  //\u5206\u533a\u8d77\u59cb\u4f4d\u7f6e\nUsing default value 1\nlast cylinder or +size or +sizeM or +sizeK (1-391, default 391): 100  //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3a\u6247\u533a\n\nCommand (m for help): n  //\u518d\u5efa\u7acb\u4e00\u4e2a\u5206\u533a\nCommand action\n   e   extended\n   p   primary partition (1-4)\np\nPartition number (1-4): 2  //\u5206\u533a\u53f7\u4e3a2\nFirst cylinder (101-391, default 101):\nUsing default value 101\nLast cylinder or +size or +sizeM or +sizeK (101-391, default 391): +200M  //\u5206\u533a\u7ed3\u675f\u4f4d\u7f6e\uff0c\u5355\u4f4d\u4e3aM\n\n\u786e\u8ba4\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a\nCommand (m for help): p\n\n\u518d\u5efa\u7acb\u4e00\u4e2a\u903b\u8f91\u5206\u533a\uff1a\nCommand (m for help): n\nCommand action\n   e   extended\n   p   primary partition (1-4)\ne  //\u9009\u62e9\u6269\u5c55\u5206\u533a\nPartition number (1-4): 3\nFirst cylinder (126-391, default 126):\nUsing default value 126\nLast cylinder or +size or +sizeM or +sizeK (126-391, default 391):\nUsing default value 391\n\n\u786e\u8ba4\u6269\u5c55\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a\nCommand (m for help): p\n\n\u5728\u6269\u5c55\u5206\u533a\u4e0a\u5efa\u7acb\u4e24\u4e2a\u903b\u8f91\u5206\u533a\uff1a\nCommand (m for help): n\nCommand action\n   l   logical (5 or over)\n   p   primary partition (1-4)\nl //\u9009\u62e9\u903b\u8f91\u5206\u533a\nFirst cylinder (126-391, default 126):\nUsing default value 126\nLast cylinder or +size or +sizeM or +sizeK (126-391, default 391): +400M\n\nCommand (m for help): n\nCommand action\n   l   logical (5 or over)\n   p   primary partition (1-4)\nl\nFirst cylinder (176-391, default 176):\nUsing default value 176\nLast cylinder or +size or +sizeM or +sizeK (176-391, default 391):\nUsing default value 391\n\n\u786e\u8ba4\u903b\u8f91\u5206\u533a\u5efa\u7acb\u6210\u529f\uff1a\nCommand (m for help): p\n\n\u6700\u540e\u5bf9\u5206\u533a\u64cd\u4f5c\u8fdb\u884c\u5199\u5165\u4fdd\u5b58\uff1a\nCommand (m for help): w\n\n# \u5efa\u7acb\u597d\u5206\u533a\u4e4b\u540e\u6211\u4eec\u8fd8\u9700\u8981\u5bf9\u5206\u533a\u8fdb\u884c\u683c\u5f0f\u5316\u624d\u80fd\u5728\u7cfb\u7edf\u4e2d\u4f7f\u7528\u78c1\u76d8\nmkfs.ext4 /dev/sdb1     # \u5728sdb1\u4e0a\u5efa\u7acbext4\u5206\u533a\n\n\u786c\u76d8sdb\u6211\u4eec\u5efa\u7acb\u4e862\u4e2a\u4e3b\u5206\u533a\uff08sdb1\uff0csdb2\uff09\uff0c1\u4e2a\u6269\u5c55\u5206\u533a\uff08sdb3\uff09\uff0c2\u4e2a\u903b\u8f91\u5206\u533a\uff08sdb5\uff0csdb6\uff09\n\u6ce8\u610f\uff1a\u4e3b\u5206\u533a\u548c\u6269\u5c55\u5206\u533a\u7684\u78c1\u76d8\u53f7\u4f4d1-4\uff0c\u4e5f\u5c31\u662f\u8bf4\u6700\u591a\u67094\u4e2a\u4e3b\u5206\u533a\u6216\u8005\u6269\u5c55\u5206\u533a\uff0c\u903b\u8f91\u5206\u533a\u5f00\u59cb\u7684\u78c1\u76d8\u53f7\u4e3a5\uff0c\u56e0\u6b64\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u4e2d\u6ca1\u6709sdb4\n\n# \u5efa\u7acb\u4e24\u4e2a\u76ee\u5f55`/oracle`\u548c`/web`\uff0c\u5c06\u65b0\u5efa\u597d\u7684\u4e24\u4e2a\u5206\u533a\u6302\u8f7d\u5230\u7cfb\u7edf\nmkdir /oracle\nmkdir /web\nmount /dev/sdb1 /oracle\nmount /dev/sdb6 /web\n\n\u5982\u679c\u9700\u8981\u6bcf\u6b21\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\u5219\u9700\u8981\u4fee\u6539`/etc/fstab`\u6587\u4ef6\uff0c\u52a0\u5165\u4e24\u884c\u914d\u7f6e\uff1a\n/dev/sdb1               /oracle                 ext4    defaults        0 0\n/dev/sdb6               /web                    ext4    defaults        0 0\ncomment\n</code></pre>"},{"location":"system/linux/Centos/#linuxfhs","title":"Linux\u76ee\u5f55\u7ed3\u6784FHS","text":"Markdown<pre><code>\u57fa\u672c\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\uff1a(\u53ef\u4ee5\u7528file\u547d\u4ee4\u6765\u8bc6\u522b)\n* \u666e\u901a\u6587\u4ef6\uff1a\u5982\u6587\u672c\u6587\u4ef6\u3001c\u8bed\u8a00\u6e90\u4ee3\u7801\u3001shell\u811a\u672c\u7b49\uff0c\u53ef\u4ee5\u7528cat\u3001less\u3001more\u3001vi\u7b49\u6765\u5bdf\u770b\u5185\u5bb9\uff0c\u7528mv\u6765\u6539\u540d\n* \u76ee\u5f55\u6587\u4ef6\uff1a\u5305\u62ec\u6587\u4ef6\u540d\u3001\u5b50\u76ee\u5f55\u540d\u53ca\u5176\u6307\u9488\uff0c\u53ef\u4ee5\u7528ls\u5217\u51fa\u76ee\u5f55\u6587\u4ef6\n* \u94fe\u63a5\u6587\u4ef6\uff1a\u662f\u6307\u5411\u4e00\u7d22\u5f15\u8282\u70b9\u7684\u90a3\u4e9b\u76ee\u5f55\u6761\u76ee\uff0c\u7528ls\u6765\u67e5\u770b\u65f6\uff0c\u94fe\u63a5\u6587\u4ef6\u7684\u6807\u5fd7\u7528l\u5f00\u5934\uff0c\u800c\u6587\u4ef6\u540e\u4ee5\"-&gt;\"\u6307\u5411\u6240\u94fe\u63a5\u7684\u6587\u4ef6\n* \u7279\u6b8a\u6587\u4ef6\uff1a\u5982\u78c1\u76d8\u3001\u7ec8\u7aef\u3001\u6253\u5370\u673a\u7b49\u90fd\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u8868\u793a\u51fa\u6765\uff0c\u5e38\u653e\u5728/dev\u76ee\u5f55\u5185\n\n~\uff1a\u4ee3\u8868\u7528\u6237\u81ea\u5df1\u7684\u5bbf\u4e3b\u76ee\u5f55\n.\uff1a\u8868\u793a\u5f53\u524d\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528./\u8868\u793a\n..\uff1a\u8868\u793a\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u7528../\u8868\u793a\n\n/bin      \u4fdd\u5b58\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u53ef\u6267\u884c\u7684\u6307\u4ee4\uff09\u6743\u9650\u5bf9\u6240\u6709\u7528\u6237\u5f00\u653e\n\n/boot     \u5b58\u653e\u5f00\u673a\u542f\u52a8\u52a0\u8f7d\u7a0b\u5e8f\u7684\u6838\u5fc3\u6587\u4ef6,\u5305\u62ec\u5f15\u5bfc\u6587\u4ef6\u3001\u5185\u6838\u6587\u4ef6\u3001\u9a71\u52a8\u3001 \u63d2\u4ef6\u3001\u6a21\u5757\u7b49\uff1b(\u5982kernel\u548cgrup)\n\n/dev      \u5b58\u653e\u4e86\u6240\u6709\u7684\u786c\u4ef6\u8bbe\u5907\u6587\u4ef6\uff1b\u7f51\u5361\uff0c\u58f0\u5361\uff0c\u786c\u76d8\uff0c\u5149\u9a71\uff1btty1,tty2\u7ec8\u7aef\uff0c\u8bbe\u5907\u6587\u4ef6\u76ee\u5f55\uff0c\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u5b58\u653e\u6240\u6709\u7cfb\u7edf\u4e2ddevice\u7684\u76f8\u5173\n          \u4fe1\u606f\uff0c\u4e0d\u8bba\u662f\u4f7f\u7528\u7684\u6216\u672a\u4f7f\u7528\u7684\u8bbe\u5907\uff0c\u53ea\u8981\u6709\u53ef\u80fd\u4f7f\u7528\u5230\uff0c\u5c31\u4f1a\u5728/dev\u4e2d\u5efa\u7acb\u4e00\u4e2a\u76f8\u5bf9\u5e94\u7684\u8bbe\u5907\u6587\u4ef6\uff1b\u8bbe\u5907\u6587\u4ef6\u5206\u4e3a2\u79cd\u7c7b\u578b\uff1a\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\u548c\n          \u5757\u8bbe\u5907\u6587\u4ef6(\u76ee\u5f55\u4e2d\u57fa\u672c\u4e0a\u90fd\u662f\u8bbe\u5907\u6587\u4ef6\uff0c\u5982\u786c\u76d8\u8bbe\u5907\u6587\u4ef6/dev/sda)\n    /dev/console    \u7cfb\u7edf\u63a7\u5236\u53f0\uff0c\u4e5f\u5c31\u662f\u76f4\u63a5\u548c\u7cfb\u7edf\u8fde\u63a5\u7684\u76d1\u89c6\u5668\n    /dev/hd         IDE\u8bbe\u5907\u6587\u4ef6\n    /dev/sd         sata\u3001usb\u3001scsi\u7b49\u8bbe\u5907\u6587\u4ef6\n    /dev/fd         \u8f6f\u9a71\u8bbe\u5907\u6587\u4ef6\n    /dev/tty        \u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6\n    /dev/pty        \u63d0\u4f9b\u8fdc\u7a0b\u865a\u62df\u63a7\u5236\u53f0\u8bbe\u5907\u6587\u4ef6\n    /dev/null       \u6240\u8c13\"\u9ed1\u6d1e\"\uff0c\u6240\u6709\u5199\u5165\u8be5\u8bbe\u5907\u7684\u4fe1\u606f\u90fd\u5c06\u6d88\u5931\uff0c\u5982\u5f53\u60f3\u5c06\u5c4f\u5e55\u4e0a\u7684\u8f93\u51fa\u4fe1\u606f\u9690\u85cf\u8d77\u6765\u65f6\uff0c\u53ea\u8981\u5c06\u8f93\u51fa\u4fe1\u606f\u8f93\u5165\u5230/dev/null\u5373\u53ef\n\n/etc    \u7cfb\u7edf\u3001\u7f51\u7edc\u6216\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u7b80\u5355\u7684\u5c06/etc\u76ee\u5f55\u5206\u4e3a\u4ee5\u4e0b\u51e0\u7c7b\uff1a\n    \u57fa\u672c\u6587\u4ef6\uff1a\u6240\u6709\u76f4\u63a5\u653e\u5728/etc\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u5f52\u7c7b\u4e3a\u57fa\u672c\u6587\u4ef6\n            aliases\uff1a\u7528\u4e8e\u8bbe\u7f6e\u90ae\u4ef6\u522b\u540d\n            auto.* \uff1a\u4ee3\u8868\u7684\u662f\u4e00\u7cfb\u5217autofs\u670d\u52a1\u6240\u9700\u8981\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e2a\u670d\u52a1\u4e3b\u8981\u662f\u8ba9\u7ba1\u7406\u5458\u53ef\u4ee5\u4e8b\u5148\u5b9a\u4e49\u51fa\u4e00\u4e9b\u7f51\u7edc\u3001\u672c\u673a\u6216\u5149\u9a71\u7b49\u9ed8\u8ba4\u7684\u8def\u5f84\n            auto.master\uff1a\u8d1f\u8d23\u89c4\u5212\u76ee\u5f55\u7684\u5206\u914d\u4e0e\u4f7f\u7528\uff0c\u76ee\u524d\u9ed8\u8ba4\u63d0\u4f9b\u4e09\u79cd\u81ea\u52a8\u6302\u8f7d\u6a21\u5f0f\n            auto.misc\uff1a\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u90fd\u4ee5\u5b9e\u4f53\u8fde\u63a5\u672c\u673a\u7684\u78c1\u76d8\u9a71\u52a8\u5668\u4e3a\u4e3b\n            auto.net\uff1a\u5e76\u4e0d\u662f\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u800c\u662f\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c\u5728\u4f7f\u7528\u4e0a\u5176\u5b9e\u4e0d\u987b\u505a\u4efb\u4f55\u8c03\u6574\n            auto.smb\uff1a\u4e0eauto.net\u4e00\u6837\uff0c\u90fd\u662f\u4ee5\u4e2a\u811a\u672c\u6587\u4ef6\n            bashrc\uff1a\u7528\u6237\u767b\u5f55\u529f\u80fd\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u522b\u540d\n            profile\uff1a\u4e0e\u7cfb\u7edf\u73af\u5883\u914d\u7f6e\u6216\u521d\u59cb\u5316\u8f6f\u4ef6\u7684\u76f8\u5173\u914d\u7f6e\uff0c\u5168\u5c40\u914d\u7f6e\uff0c\u5bf9\u6240\u6709\u7528\u6237\u751f\u6548\uff0c\u4e3b\u8981\u914d\u7f6e\u53d8\u91cf\n            DIR_COLORS\uff1a\u7528\u4e8e\u914d\u7f6els\u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9tty\u767b\u5f55\u7684\u7528\u6237\n            DIR_COLORS.xterm\uff1a\u7528\u4e8e\u914d\u7f6els\u547d\u4ee4\u7684\u989c\u8272\uff0c\u4e3b\u8981\u9488\u5bf9xterm\u767b\u5f55\u7684\u7528\u6237\n            fstab\uff1a\u7cfb\u7edf\u542f\u52a8\u65f6\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u7684\u914d\u7f6e\u6587\u4ef6\n            inittab\uff1a\u542f\u52a8\u65f6\u7cfb\u7edf\u6240\u9700\u8981\u7684\u7b2c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1b\u4e5f\u5373\u662finit\u8fdb\u7a0b\u7684\u914d\u7f6e\u6587\u4ef6\n            issue\uff1a\u7528\u6237\u672c\u673a\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f\n            issue.net\uff1a\u7528\u6237\u7f51\u7edc\u767b\u5f55\u65f6\uff0c\u770b\u5230\u7684\u6b22\u8fce\u4fe1\u606f\n            ld.so.conf\uff1a\u5305\u542bld.so.conf.d/*.conf\u914d\u7f6e\uff1b\u4e3b\u8981\u662fld.so.conf.d/*.conf\u76ee\u5f55\u7684\u4f5c\u7528\n            localtime\uff1a\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u65f6\u533a\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u5bf9\u5e94\u7684\u65f6\u533a\u6587\u4ef6\u90fd\u5b58\u5728\u4e8e/usr/share/zoneinfo/\n            motd\uff1a\u767b\u5f55\u6210\u529f\u7684\u7528\u6237\u663e\u793a\u7684\u4fe1\u606f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\n            mtab\uff1a\u53ef\u4ee5\u5f53\u505a\u662f\u68c0\u67e5\u5f53\u524d\u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u60c5\u51b5\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u4e0emount\u547d\u4ee4\u7ed3\u679c\u4e00\u81f4\n            prelink.conf\uff1a\u5b9a\u4e49\u54ea\u4e9b\u6267\u884c\u6587\u4ef6\u548c\u51fd\u6570\u5e93\u662f\u9700\u8981\u9884\u5148\u8fde\u63a5\u7684\n            securetty\uff1a\u4e3b\u8981\u662flogin\u7a0b\u5e8f\u5728\u4f7f\u7528\u7684\uff0c\u53ea\u8981\u662f\u5217\u5728\u8be5\u6587\u4ef6\u4e2d\u7684\u63a5\u53e3\uff0c\u5c31\u8868\u793a\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u63a5\u53e3\uff0c\u76f8\u53cd\uff0c\u82e5\u4ece\u5217\u8868\u4e2d\u5220\u9664\uff0c\u5219\u65e0\u6cd5\u4f7f\u7528\u8be5\u63a5\u53e3\n            shells\uff1a\u8bb0\u5f55\u76ee\u524d\u7cfb\u7edf\u6240\u62e5\u6709shell\u79cd\u7c7b\u7684\u8def\u5f84\uff0c\u901a\u8fc7cssh\u547d\u4ee4\u4f7f\u7528\n            sudoers\uff1asudo\u547d\u4ee4\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u4e8e\u914d\u7f6e\u6743\u9650\u7684\u5206\u914d\u65b9\u5f0f\n            sysctl.conf\uff1a\u4e3b\u8981\u662f\u5e2e\u52a9\u7528\u6237\u914d\u7f6e/proc/sys\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u7684\u503c\uff0c\u4e0esysctl\u547d\u4ee4\u5bf9\u5e94\n            syslogd.conf\uff1a\u662fsyslogd\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\n            host.conf\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u8bf4\u660e\u89e3\u6790\u7684\u65b9\u5f0f\u53ca\u987a\u5e8f\n            hosts\uff1a\u4e3b\u673a\u540d\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u5217\u51fa\u6240\u6709\u9700\u8981\u672c\u5730\u89e3\u6790\u7684\u4e3b\u673a\u540d\u4e0eIP\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb\n            hosts.allow\u548chosts.deny\uff1alinux\u7f51\u7edc\u5b89\u5168\u673a\u5236TCP Wrapper\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\n            nsswitch.conf\uff1a\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u5e94\u5982\u4f55\u67e5\u8be2\u4e3b\u673a\u540d\u3001\u5bc6\u7801\u3001\u7528\u6237\u7ec4\u3001\u7f51\u7edc\u7b49\uff0c\u6216\u662f\u67e5\u8be2\u987a\u5e8f\u7684\u7f16\u6392\n            resolv.conf\uff1a\u8bb0\u5f55DNS\u670d\u52a1\u5668\u5730\u5740\uff0c\u7528\u4e8eDNS\u57df\u540d\u89e3\u6790\n            services\uff1a\u5b9a\u4e49\u4e86\u7f51\u7edc\u670d\u52a1\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\n            xinetd.conf\uff1axinetd\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u76ee\u7684\u662f\u4e3axinetd.d\u4e0b\u7684\u6240\u6709\u5b50\u670d\u52a1\u5efa\u7acb\u4e00\u4e2a\u6807\u51c6\u7684\u89c4\u8303\u4f7f\u5176\u53ef\u4ee5\u9075\u5faa\n            anacrontab\uff1a\u5c5e\u4e8e\u4e00\u79cd\u4efb\u52a1\u8ba1\u5212\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0canacrontab\u8f6f\u4ef6\u548ccrond\u5176\u5b9e\u6709\u70b9\u76f8\u8f85\u76f8\u6210\uff0ccrond\u8d1f\u8d23\u4efb\u52a1\u8ba1\u5212\uff0c\u800canacrontab\u5219\u662f\n                        \u8d1f\u8d23\u4ee5\"\u95f4\u9694\u591a\u4e45\"\u4e3a\u4e3b\u8981\u7684\u76ee\u6807\n            at.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528at\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1\n            at.allow\uff1a\u4e0eat.deny\u521a\u597d\u76f8\u53cd\n            crontab\uff1acrontab\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0ccrond\u9ed8\u8ba4\u4f1a\u6267\u884c\u7684\u6587\u4ef6\u53ef\u4ee5\u53c2\u8003\u6b64\u914d\u7f6e\u6587\u4ef6\n            cron.deny\uff1a\u8be5\u6587\u4ef6\u5c5e\u4e8e\u62d2\u7edd\u5217\u8868\uff0c\u53ea\u8981\u88ab\u8bb0\u5f55\u5728\u5176\u4e2d\u7684\u7528\u6237\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528crond\u6240\u63d0\u4f9b\u7684\u4efb\u52a1\u8ba1\u5212\u670d\u52a1\n            cron.allow\uff1a\u4e0ecron.deny\u521a\u597d\u76f8\u53cd\n            exports\uff1a\u662fNFS\u670d\u52a1\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\uff0c\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u5c06\u672c\u673a\u7684\u76ee\u5f55\u5171\u4eab\u5230\u7f51\u7edc\u4e0a\uff0c\u4f9b\u5176\u4ed6\u4eba\u4f7f\u7528\n            group\u4e0egshadow\uff1a\u7528\u6237\u7ec4\u914d\u7f6e\u6587\u4ef6\uff0cgroup\u4e3b\u8981\u4fdd\u5b58\u7528\u6237\u7ec4\u4fe1\u606f\uff0cgshadow\u4e3b\u8981\u4fdd\u5b58\u7fa4\u7ec4\u5bc6\u7801\n            login.defs\uff1a\u8bbe\u7f6e\u7cfb\u7edf\u5728\u5efa\u7acb\u8d26\u53f7\u65f6\u6240\u53c2\u8003\u7684\u914d\u7f6e\n            passwd\uff1a\u4e3b\u8981\u4fdd\u5b58\u7cfb\u7edf\u7528\u6237\u8d26\u53f7\u7684\u4fe1\u606f\n            shadow\uff1alinux\u7cfb\u7edf\u901a\u5e38\u5305\u7ecf\u8fc7\"hash\"\u5904\u7406\u540e\u7684\u5bc6\u7801\u5b58\u50a8\u5728\u8fd9\u4e2a\u6587\u4ef6\u4e2d\n            protocols\uff1a\u901a\u4fe1\u534f\u8bae\u5bf9\u5e94\u7aef\u53e3\u53f7\u7684\u4e00\u4e2a\u5bf9\u7167\u8868\uff0c\u5305\u542b\u534f\u8bae\u540d\u79f0\u3001\u534f\u8bae\u53f7\u7801\u3001\u6ce8\u91ca\u7b49\n            wgetrc\uff1awget\u7a0b\u5e8f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u4e2d\u6709quota\u3001mail header\u3001\u91cd\u4f20\u6587\u4ef6\u7684\u9884\u8bbe\u6b21\u6570\u3001firewall\u548cproxy\u7b49\u76f8\u5173\u8bbe\u7f6e\n            init.d\uff1aRHEL\u4e2d\u6240\u6709\u670d\u52a1\u7684\u9ed8\u8ba4\u542f\u52a8\u811a\u672c\u90fd\u5b58\u653e\u5728\u8fd9\u91cc\uff1b\u8fd9\u4e2a\u662f\u94fe\u63a5\u6587\u4ef6\uff0c\u94fe\u63a5\u5230/etc/rc.d/init.d\n            csh.cshrc\u548ccsh.login\uff1a \u7528\u6237\u542f\u52a8c shells\u6267\u884c\u7684\u521d\u59cb\u5316\u914d\u7f6e\u6587\u4ef6\n            printcap\uff1alinux\u7cfb\u7edf\u4e2d\u6253\u5370\u673a\u8bbe\u5907\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\n    \u670d\u52a1\u5668\u76ee\u5f55\uff1a\u5982samba\u3001http\u3001vsftpd\u7b49\u670d\u52a1\u5668\u914d\u7f6e\u76f8\u5173\u76ee\u5f55\n            cups\uff1alinux\u4e0b\u7684\u6253\u5370\u673a\u670d\u52a1\u5668\uff0c\u76ee\u5f55\u4e0b\u5b58\u653e\u7684\u662f\u6253\u5370\u673a\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\n            dnsmasq.d\uff1adnsmasq\u662f\u4e00\u79cdDNS\u7684\"\u8f7b\u8584\u673a\u79cd\"\uff0c\u8f6c\u4e3a\u533a\u57df\u6216\u5c0f\u578b\u7f51\u7edc\u6240\u8bbe\u8ba1\uff0c\u62e5\u6709\u6bd4\u4e00\u822cDNS\u66f4\u4e3a\u65b9\u4fbf\u7b80\u6613\u7684\u914d\u7f6e\n            httpd\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u76ee\u5f55\n            mail\uff1aMail Server\u7ec4\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5982sendmail\n            ntp\uff1a\u7f51\u7edc\u65f6\u95f4\u670d\u52a1\u5668\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u4e3a/etc/ntp.conf\n            openldap\uff1a\u76ee\u5f55\u660e\u663e\u662fLDAP\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u8f6f\u4ef6\u540d\u79f0\u4e3aOpenLDAP\n            postfix\uff1apostfix\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\n            samba\uff1a\u6587\u4ef6\u5171\u4eab\u670d\u52a1samba\u7684\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\n            smrsh\uff1a\u8fd9\u662fsendmail\u4e3a\u4e86\u9650\u5236\u7528\u6237\u53ef\u4f7f\u7528\u7684\u547d\u4ee4\u8bbe\u8ba1\u7684\u7a0b\u5e8f\uff0c\u5c06\u539f\u672c\u7528\u6237\u6240\u4f7f\u7528\u7684/bin/sh\u66ff\u6362\u4e3a/usr/sbin/smrsh\n            snmp\uff1a\u7b80\u5355\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u5b58\u5728snmpd.conf\u4e3b\u914d\u7f6e\u6587\u4ef6\n            squid\uff1a\u8fd9\u662flinux\u4e0b\u7684\u4ee3\u7406\u670d\u52a1\u5668squid\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsquid.conf\n            ssh\uff1aSSH\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fsshd_config\n            vsftpd\uff1avsftpd\u670d\u52a1\u5668\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fvsftpd.conf\n            xinetd.d\uff1axinetd\u662f\u4e00\u4e2a\u7ba1\u7406\u591a\u4e2a\u670d\u52a1\u7684daemon\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u5217\u51fa\u7684\u670d\u52a1\u90fd\u662f\u7531xinetd\u8fdb\u7a0b\u7ba1\u7406\u7684\uff0c\u5176\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/xinetd.conf\n    \u7cfb\u7edf\u76ee\u5f55\uff1a\u5982sysconfig\u3001xen\u6216\u7f51\u7edc\u914d\u7f6e\u7b49\u4e0e\u7cfb\u7edf\u8fd0\u884c\u76f8\u5173\u7684\u76ee\u5f55\n            blkid\uff1a\u6b64\u76ee\u5f55\u6240\u5b58\u653e\u4e00\u4e2a\u5757\u8bbe\u5907ID\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u4e3b\u8981\u8bb0\u5f55\u7cfb\u7edf\u4e2d\u6240\u6709\u533a\u5757\u8bbe\u5907\u7684\u6807\u7b7e\u540d\u79f0\u3001\u786c\u4ef6\u7684\u552f\u4e00\u8bc6\u522b\u7801\u3001\u6587\u4ef6\u7cfb\u7edf\u7684\u683c\u5f0f\u7b49\u57fa\u672c\u4fe1\u606f\n            bluetooth\uff1alinux\u4e0b\u4f7f\u7528\u84dd\u7259\u8bbe\u5907\u6240\u9700\u7684\u914d\u7f6e\u6587\u4ef6\uff1b\u542f\u52a8\u84dd\u7259\u68c0\u6d4b\u7684\u4e3b\u8981\u670d\u52a1\u4ecd\u662f/etc/rc.d/init.d/bluetooth\uff0c\u8be5\u7a0b\u5e8f\u4f7f\u7528\u7684\u662f\n                       hcid.conf\u914d\u7f6e\u6587\u4ef6\n            cron.X\uff1acron.X\u7684\u76ee\u5f55\u90fd\u662f\u7ed9cron\u8f6f\u4ef6\u5b58\u653e\u5176\u9700\u8981\u4efb\u52a1\u8ba1\u5212\u7684\u6587\u4ef6\u6240\u4f7f\u7528\u7684\uff0c\u6309\u4efb\u52a1\u8ba1\u5212\u65f6\u95f4\u7684\u957f\u77ed\u53ca\u914d\u7f6e\u7279\u6027\u5206\u4e3acron.d\u3001cron.daily\u3001\n                    cron.hourly\u3001cron.monthly\u3001cron.weekly\u4e94\u4e2a\u4e3b\u8981\u76ee\u5f55\n            dbus-1\uff1aD-BUS\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0cD-BUS\u4e5f\u662f\u4e00\u79cdIPC\u4ea4\u6d41\u7684\u65b9\u5f0f\n            default\uff1a\u8fd9\u91cc\u662f\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u8f6f\u4ef6\u9ed8\u8ba4\u503c\u7684\u76ee\u5f55\uff0c\u5b58\u653e\u67d0\u4e9b\u8f6f\u4ef6\u6267\u884c\u65f6\u7684\u57fa\u672c\u53c2\u6570\n            firmware\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u5b58\u653e\u7684\u4e1c\u897f\u662f\u975e\u5e38\u5e95\u5c42\u7684\u4fe1\u606f\uff0c\u662fCPU\u6240\u9700\u7684microcode\u7684\u5b9e\u4f53\u6587\u4ef6\n            foomatic\uff1a\u4e0e\u6253\u5370\u673a\u76f8\u5173\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5b9e\u73b0\u6253\u5370\u4e00\u5bf9\u591a\u7684\u65b9\u5f0f\uff0c\u5728foomatic\u4e2d\uff0c\u53ef\u4ee5\u8bb0\u5f55\u591a\u6761\u6253\u5370\u673a\u6570\u636e\uff0c\u8ba9\u7528\u6237\u53ea\u5728\u4f7f\u7528\u524d\u5148\u884c\u914d\u7f6e\u6240\u6709\n                      \u9700\u8981\u4f7f\u7528\u7684\u6253\u5370\u673a\u5373\u53ef\n            hal\uff1a\u5168\u540dHardware Abstraction Layer\uff0c\u662flinux\u4e00\u79cd\u7ba1\u7406\u786c\u4ef6\u7684\u673a\u5236\uff0c\u5b83\u4f1a\u5e2e\u6240\u6709\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u7528\u6237\u641c\u96c6\u6240\u6709PCI\u53caUSB\u7b49\u786c\u4ef6\u4fe1\u606f\n                \u56e0\u6b64\u7528\u6237\u53ef\u4ee5\u5f88\u7b80\u5355\u5e76\u5b9e\u65f6\u5730\u901a\u8fc7HAL\u7684\u65b9\u5f0f\u53d6\u5f97\u786c\u4ef6\u7684\u76f8\u5173\u6570\u636e\n            isdn\uff1aISDN\u670d\u52a1\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u91cc\u9762\u5305\u542b\u53ef\u62e8\u53f7\u7684\u7528\u6237\u3001\u7535\u8bdd\u3001\u8054\u673a\u65b9\u5f0f\u7b49\n            ld.so.conf.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fldconfig\u6240\u4f7f\u7528\u7684\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\uff0c\u5b83\u662f\u7531/etc/ld.so.conf\u6587\u4ef6\u6240\u51b3\u5b9a\u7684\uff1bldconfig\u547d\u4ee4\u7684\u76ee\u7684\u5728\u4e8e\u5c06\u7cfb\u7edf\n                          \u4e2d\u7684\u4e00\u4e9b\u51fd\u6570\u5e93\u9884\u5148\u5b58\u653e\u5230\u5185\u5b58\u4e2d\uff0c\u8ba9\u7cfb\u7edf\u4f7f\u7528\u65f6\u53ef\u4ee5\u6bd4\u4ee5\u5f80\u901a\u8fc7\u786c\u76d8\u7684\u8bfb\u53d6\u901f\u5ea6\u6765\u7684\u66f4\u5feb\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u63d0\u9ad8\u7cfb\u7edf\u6027\u80fd\n                          \u5c24\u5176\u5f53\u8981\u91cd\u590d\u8bfb\u53d6\u65f6\u66f4\u660e\u663e\uff1bldconfig\u8981\u5c06\u54ea\u4e9b\u51fd\u6570\u5e93\u4e22\u5230\u5185\u5b58\u4e2d\uff0c\u5219\u987b\u770b/etc/ld.so.conf\u6587\u4ef6\u4e2d\u6240\u8bb0\u5f55\u7684\u4fe1\u606f\n            logrotate.d\uff1a\u6b64\u76ee\u5f55\u5bf9\u7cfb\u7edf\u7ba1\u7406\u5458\u6765\u8bf4\uff0c\u662f\u5341\u5206\u91cd\u8981\u7684\u4e00\u4e2a\u76ee\u5f55\uff0c\u56e0\u4e3a\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\uff0c\u8bb0\u5f55\u4e86\u5982\u4f55\u5b9a\u671f\u5907\u4efd\u7cfb\u7edf\u6240\u9700\u8981\u5907\u4efd\u7684\u7cfb\u7edf\u6216\u8f6f\u4ef6\n                         \u65e5\u5fd7\u6587\u4ef6\u53ca\u5907\u4efd\u65b9\u5f0f\uff0c\u76ee\u5f55\u662f\u7531logrotate\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0c\u800c\u91cc\u9762\u6240\u6709\u6587\u4ef6\u662f\u7531\u5404\u8f6f\u4ef6\u5404\u81ea\u4ea7\u751f\u7684\uff1b\u5176\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662f\n                         /etc/logrotate.conf\n            logwatch\uff1alogrotate\u4e3b\u8981\u662f\u5b9e\u73b0\u5982\u4f55\u5907\u4efd\u65e5\u5fd7\u6587\u4ef6\uff0c\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662f\u8bb0\u8f7d\u5982\u4f55\u5206\u6790\u65e5\u5fd7\u6587\u4ef6\u5e76\u544a\u8bc9\u7528\u6237\u7684\u8f6f\u4ef6logwatch\u7684\u914d\u7f6e\u76ee\u5f55\n            lsb-release.d\uff1aLSB\u662f\u4e00\u4e2a\u7531\u5f88\u591a\u4eba\u6240\u6267\u884c\u7684\u9879\u76ee\uff0c\u5176\u76ee\u7684\u662f\u5c06\u6240\u6709\u7684Linux\u53d1\u884c\u7248\u5b9a\u4e49\u4e3a\u4e00\u4e9b\u5171\u540c\u7684\u6807\u51c6\n            lvm\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662fLVM\u7684\u57fa\u672c\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u914d\u7f6e\u6216\u64cd\u4f5c\u4e00\u822c\u90fd\u53ea\u9700\u8981\u901a\u8fc7LVM\u63d0\u4f9b\u7684\u547d\u4ee4\uff0c\u800c\u4e0d\u4f1a\u7528\u5230\u8fd9\u4e2a\u76ee\u5f55\uff0c\u9664\u975e\u8981\u4f7f\u7528\u5230\u5f88\u9ad8\u7ea7\u7684\u914d\u7f6e\n                \u624d\u4f1a\u66f4\u6539\u6b64\u6587\u4ef6\n            makedev.d\uff1aMAKEDEV\u8f6f\u4ef6\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cMAKEDEV\u4e3b\u8981\u7528\u6765\u4ea7\u751f\u8bbe\u5907\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728/dev\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u7531\u8fd9\u4e2a\u547d\u4ee4\u4ea7\u751f\u7684\n                       \u6b64\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e3b\u8981\u662f\u9488\u5bf9\u8bbe\u5907\u6587\u4ef6\u7684\u5b9a\u4e49\u6216\u5c5e\u6027\uff0c\u76ee\u5f55\u4e2d\u5b58\u5728\u7684\u8bbe\u5907\u6587\u4ef6\u53ef\u4ee5\u7531MAKEDEV\u6765\u521b\u5efa\uff0c\u5426\u5219\u9700\u8981\u4f7f\u7528mknod\u547d\u4ee4\n            modprobe.d\uff1a\u662fmodprobe\u547d\u4ee4\u7684\u4f4f\u914d\u7f6e\u76ee\u5f55\uff0c\u4e00\u822c\u7cfb\u7edf\u542f\u52a8\u9ed8\u8ba4\u8981\u52a0\u8f7d\u7684\u6a21\u5757\u653e\u5728/etc/modprobe.conf\u4e2d\n            netplug\u548cnetplug.d\uff1a\u8fd9\u4e24\u4e2a\u76ee\u5f55\u548c\u7f51\u7edc\u63a5\u53e3\u7684\u8054\u673a\u4e0e\u5426\u7531\u76f4\u63a5\u5173\u7cfb\uff0c\u56e0\u4e3a\u4e3b\u8981\u662f\u63a7\u5236\u8054\u673a\u65f6\u7684\u63a5\u53e3\u64cd\u4f5c\n            opt\uff1a\u6b64\u76ee\u5f55\u539f\u672c\u662f\u5b9a\u4e49\u4e3a\u5b58\u653e\u6240\u6709\u989d\u5916\u5b89\u88c5\u8f6f\u4ef6\u7684\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u76ee\u524d\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\uff0c\u6b64\u76ee\u5f55\u4e3a\u7a7a\n            pcmcia\uff1a\u8fd9\u662fPCMCIA\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\uff0cPCMCIA\u662f\u7b14\u8bb0\u672c\u7535\u8111\u4e0d\u53ef\u6216\u7f3a\u7684\u63a5\u53e3\uff0c\u9700\u8981\u5373\u63d2\u5373\u7528\u7684\u65b9\u5f0f\uff0c\u6b64\u63a5\u53e3\u4f7f\u7528\u8f83\u5c11\n            pm\uff1a\u7531pm-utils\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\u76ee\u5f55\uff0cpm-utils\u662f\u4e00\u5957\u7535\u6e90\u7ba1\u7406\u7684\u5de5\u5177\u8f6f\u4ef6\uff0c\u5176\u4e2d/usr/lib/pm-utils\u4e5f\u662f\u4e3b\u8981\u76ee\u5f55\u4e4b\u4e00\n            ppp\uff1appp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u90fd\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\n            profile.d\uff1a\u76ee\u5f55\u5b58\u653e\u7cfb\u7edf\u90e8\u5206\u7684\u8f6f\u4ef6\u914d\u7f6e\uff0c\u4f46\u6309\u4e0d\u540c\u7684shell\u6267\u884c\u4e0d\u540c\u6587\u4ef6\uff0c\u9ed8\u8ba4\u6240\u4f7f\u7528bash\u4f1a\u76f4\u63a5\u6267\u884c\u8be5\u76ee\u5f55\u4e0b\u6240\u6709\u6269\u5c55\u540d\u4e3a.sh\u7684\u6587\u4ef6\n            rc.d\uff1a\u4e3b\u8981\u7528\u6765\u5b9a\u4e49\u5728\u6bcf\u4e00\u4e2a\u6267\u884c\u9636\u6bb5\u5fc5\u987b\u8981\u6267\u884c\u54ea\u4e9b\u7cfb\u7edf\u670d\u52a1\u6216\u7a0b\u5e8f\uff0c\u5728\u76ee\u5f55\u4e2d\u4e3b\u8981\u5206\u4e3a\u4e09\u4e2a\u91cd\u8981\u7684\u90e8\u5206\uff1a\n                    --rc.sysinit\uff1a\u7cfb\u7edf\u4e00\u5f00\u59cb\u542f\u52a8\u65f6\u6240\u9047\u5230\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\uff0c\u6b64\u811a\u672c\u8bb0\u5f55\u670d\u52a1\u542f\u52a8\u4e4b\u524d\u6240\u9700\u51c6\u5907\u7684\u6240\u6709\u4e8b\u60c5\uff0c\u5305\u62ec\u542f\u52a8\u65f6\u7684\u6b22\u8fce\u753b\u9762\n                    --rcX.d\uff1a\u5728rc.sysinit\u6587\u4ef6\u4e4b\u540e\u6240\u8981\u6267\u884c\u7684\uff0cX\u662f\u7cfb\u7edf\u542f\u52a8\u65f6\u7684initdefault\u503c\uff0c\u503c\u4e3a\u51e0\u5219\u4f1a\u8f6c\u5230\u90a3\u4e2a\u76ee\u5f55\u4e0b\uff0c\u5e76\u6267\u884c\u5176\u4e2d\u7684\n                             \u6240\u6709\u6587\u4ef6\uff0c\u5728\u6b64\u76ee\u5f55\u4e2d\uff0c\u6587\u4ef6\u4e00\u5f8b\u90fd\u7531\u4e24\u4e2a\u82f1\u6587\u5b57\u6bcd\u5f00\u59cbK\u548cS\uff0cK\u4ee3\u8868kill\uff0cS\u4ee3\u8868Start\n                    --rc.local\uff1a\u7cfb\u7edf\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\u6700\u540e\u4e00\u4e2a\u6267\u884c\u7684\u811a\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u5f00\u673a\u542f\u52a8\u7684\u7a0b\u5e8f\u6216\u811a\u672c\u653e\u7f6e\u5728\u8fd9\u4e2a\u811a\u672c\u6587\u4ef6\u4e2d\uff0c\u4ee5\u5b9e\u73b0\u81ea\u52a8\n                                \u8fd0\u884c\u7684\u76ee\u7684\n            readahead.d\uff1a\u662freadahead\u7a0b\u5e8f\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3a\u4e86\u52a0\u901f\u64cd\u4f5c\u7cfb\u7edf\u7684\u4f7f\u7528\u901f\u5ea6\uff0creadahead_early\u548creadahead_later\u8fd9\u4e24\u4e2a\u8fdb\u7a0b\u5728\n                         \u7cfb\u7edf\u52a0\u8f7d\u65f6\uff0c\u76f4\u63a5\u5c06\u65e5\u5e38\u6240\u9700\u8981\u7684\u4e00\u4e9b\u6587\u4ef6\uff0c\u5168\u90e8\u5148\u653e\u5230\u786c\u76d8\u7684\u9ad8\u901f\u7f13\u5b58\u4e2d\n            redhat-lsb\uff1a\u90fdlsb-release.d\u76ee\u5f55\u90fd\u662f\u7531\u7a0b\u5e8fredhat-lsb\u6240\u63d0\u4f9b\u7684\n            rwtab.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u4e00\u4e2a\u5728\u542f\u52a8\u65f6\u4f1a\u53bb\u53c2\u8003\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u7684\u6587\u4ef6\u5728/etc/rwtab\uff1b\u8fd9\u662f\u4e00\u4e2a\u7cfb\u7edf\u521d\u671f\u7684\u5907\u4efd\u673a\u5236\n            sane.d\uff1a\u8fd9\u662f\u5728\u7cfb\u7edf\u4e0b\u8981\u4f7f\u7528\u626b\u63cf\u4eea\u6240\u9700\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u4e3b\u8981\u914d\u7f6e\u6587\u4ef6\u662fsane.conf\uff0csane\u4e3a\u4e86\u65b9\u4fbf\u7528\u6237\u5728\u5404\u5f0f\u7684\u626b\u63cf\u4eea\u8fde\u63a5\u65f6\u90fd\u53ef\u4ee5\u4f7f\u7528\n                    \u56e0\u6b64\u5728\u8fd9\u4e00\u76ee\u5f55\u4e2d\u653e\u7f6e\u4e86\u5f88\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u626b\u63cf\u4eea\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u8ba9\u7cfb\u7edf\u5728\u68c0\u6d4b\u5230\u626b\u63cf\u4eea\u65f6\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\n            setuptool.d\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\"setup\"\u7cfb\u7edf\u914d\u7f6e\u5de5\u5177\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\n            skel\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u7528\u6237\u5bbf\u4e3b\u76ee\u5f55\u7684\u914d\u7f6e\u76ee\u5f55\uff0c\u5f53\u5efa\u7acb\u4e00\u4e2a\u7528\u6237\u65f6\uff0c\u4f1a\u628a\u6b64\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u590d\u5236\u4e00\u4efd\u5230\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55\uff0c\u4f5c\u4e3a\u7528\u6237\u7684\u521d\u59cb\u5316\u914d\u7f6e\n            sysconfig\uff1a\u975e\u5e38\u91cd\u8981\u7684\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u7684\u5b58\u653e\u76ee\u5f55\uff0c\u91cc\u9762\u653e\u7f6e\u4e86\u5927\u91cf\u7cfb\u7edf\u542f\u52a8\u53ca\u8fd0\u884c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\n            sysconfig/network-scripts/ifcfg-eth0\uff1a\u7f51\u5361eth0\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8bbe\u7f6e\u5185\u5bb9\u5305\u62ec\u8bbe\u5907\u540d\u79f0\u3001IP\u5730\u5740\u3001\u5e7f\u64ad\u5730\u5740\u3001\u7f51\u5173\u5730\u5740\u3001\u7f51\u6bb5\u3001\n                                                  \u5f00\u673a\u662f\u5426\u6fc0\u6d3b\u7b49\u53c2\u6570\n            udev\uff1audev\u7a0b\u5e8f\u672c\u8eab\u662f\u4e00\u5957\u8bbe\u5907\u7684\u7ba1\u7406\u673a\u5236\uff0cudev\u901a\u8fc7sysfs\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u6b63\u786e\u5730\u638c\u63e1\u76ee\u524d\u7cfb\u7edf\u4e0a\u5b58\u5728\u7684\u786c\u4ef6\u8bbe\u5907\uff0c\u4ee5\u53ca\u9488\u5bf9\u6bcf\u4e00\u4e2a\u786c\u4ef6\n                  \u8bbe\u5907\u505a\u51fa\u4e0d\u540c\u7684\u5224\u65ad\u4e0e\u6267\u884c\n            yum\u548cyum.repos.d\uff1a\u4e24\u4e2a\u90fd\u662fyum\u914d\u7f6e\u76ee\u5f55\uff0c\u53ef\u7528\u6765\u66ff\u4ee3rpm\u5305\u7ba1\u7406\u65b9\u5f0f\uff0c\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/yum.conf\uff1byum\u662f\u66f4\u65b0\u65b9\u5f0f\u53ca\u5916\u6302\u7a0b\u5e8f\u7684\n                             \u914d\u7f6e\u76ee\u5f55\uff0cyum.repos.d\u662f\u5b58\u653e\u5b9a\u671f\u66f4\u65b0\u7ec4\u4ef6\u5185\u5bb9\u7684\u4fe1\u606f\n    \u5b89\u5168\u6027\u76ee\u5f55\uff1a\u5982selinux\u6216pam.d\u7b49\u7ba1\u7406\u7cfb\u7edf\u5b89\u5168\u6027\u7684\u76ee\u5f55\n            audit\uff1a\u8fd9\u4e2a\u76ee\u5f55\u6240\u4ee3\u8868\u7684\u662f\u4e00\u79cd\u548c\u76ee\u5f55\u540d\u79f0\u4e00\u81f4\u7684audit\u5b89\u5168\u673a\u5236\uff0c\u4e3b\u8981\u4ee5\u670d\u52a1\u7684\u65b9\u5f0f\u534f\u52a9\u7ba1\u7406\u5458\u6301\u7eed\u76d1\u63a7\u5404\u6587\u4ef6\u88ab\u5b58\u53d6\u7684\u60c5\u51b5\uff1b\u76ee\u5f55\u4e0b\u7684\n                   audit.rules\u6587\u4ef6\u4e3b\u8981\u662f\u5b9a\u4e49\u4e00\u4e9b\u5fc5\u8981\u7684\u76d1\u63a7\u89c4\u5219\n            pam.d\uff1a\u6b64\u76ee\u5f55\u662fLinux-PAM\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\uff0c\u914d\u5408/lib/security\u76ee\u5f55\u4e2d\u6240\u6709\u89c9\u5f97\u51fd\u6570\u5e93\uff0c\u63d0\u4f9bLinux\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u8ba4\u8bc1\u7684\u673a\u5236\n            pam_pkcs11\uff1aPAM\u673a\u5236\u4e2d\u7684\u4e00\u79cd\u767b\u5f55\u6a21\u5757\uff0c\u53ef\u4ee5\u8ba9\u7528\u6237\u901a\u8fc7smart card\u505a\u767b\u5f55\u7684\u64cd\u4f5c\n            pki\uff1aPKI\u662f\u4e00\u79cd\u516c\u5f00\u5bc6\u94a5\u7684\u7ba1\u7406\u65b9\u5f0f\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u7ba1\u7406\u6a21\u5f0f\uff0c\u53ef\u4ee5\u8ba9\u6240\u6709\u7f51\u7edc\u4f20\u8f93\u6709\u66f4\u591a\u4fdd\u969c\n            racoon\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531ipsec-tools\u7ec4\u4ef6\u6240\u63d0\u4f9b\u7684\uff0cipsec\u7684\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u5b9e\u73b0VPN\u7684\u7f51\u8def\u6280\u672f\uff0c\u5728racoon\u76ee\u5f55\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\n                    racoon.conf\u4e2d\uff0c\u5b9a\u4e49\u5728ipsec\u64cd\u4f5c\u4e2d\u6240\u9700\u8981\u7684\u52a0\u5bc6\u7b97\u6cd5\u79cd\u7c7b\u4ee5\u53ca\u5176\u4ed6\u7ec6\u8282\u7684\u914d\u7f6e\n            security\uff1a\u4e0epam.d\u76ee\u5f55\u76f8\u8f85\u76f8\u6210\uff0cpam.d\u4e2d\u7684\u6240\u6709PAM\u7684\u89c4\u5219\u90fd\u8981\u7528\u5230/lib/security\u4e0b\u7684PAM\u51fd\u6570\u5e93\uff0c\u800c/etc/security\u76ee\u5f55\u4e2d\uff0c\u5c31\u662f\n                      \u9488\u5bf9\u8fd9\u4e9b\u51fd\u6570\u5e93\uff0c\u63d0\u4f9b\u4ee5\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec6\u8282\u914d\u7f6e\uff0c\u5bf9\u5e0c\u671b\u8c03\u6574\u7cfb\u7edf\u5b89\u5168\u6027\u90e8\u5206\u589e\u52a0\u4e86\u975e\u5e38\u5927\u7684\u65b9\u4fbf\u6027\n            selinux\uff1aselinux\u662f\u4e00\u4e2a\u5f88\u65b0\u7684\u5b89\u5168\u6027\u65b9\u6848\uff0c\u5b83\u662f\u4e00\u79cd\u9488\u5bf9\u5404\u79cd\u6587\u4ef6\u3001\u76ee\u5f55\u3001\u8bbe\u5907\u6216daemon\u7b49\u5728linux\u6240\u9700\u4f7f\u7528\u5230\u7684\u5b89\u5168\u6027\u673a\u5236\uff0c\u800c\u4e14\u5176\n                     \u5b89\u5168\u6027\u7684\u6570\u636e\u65f6\u76f4\u63a5\u8bb0\u5f55\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\n            wpa_supplicant\uff1a\u8fd9\u4e2a\u76ee\u5f55\u88ab\u5f52\u7c7b\u5230\u5b89\u5168\u6027\u76ee\u5f55\u4e2d\uff0c\u662f\u56e0\u4e3a\u5176\u5c5e\u4e8e\u65e0\u7ebf\u4e2d\u5b89\u5168\u8ba4\u8bc1\u7684\u90e8\u5206\uff0c\u5b58\u5728wpa_supplicant.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u7528\u6237\n                            \u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u52a0\u5165\u5df2\u77e5\u53ef\u767b\u9646\u7684AP\n    X Windows\u76ee\u5f55\uff1a\u5982X11\u6216gdm\u7ba1\u7406X windows\u542f\u52a8\u6216\u4f7f\u7528\u4e0a\u7684\u914d\u7f6e\u76ee\u5f55\n            alternatives\uff1alinux\u4e0b\u53ef\u8fa8\u8bc6\u6269\u5c55\u540d\u7684\"\u6587\u4ef6\u7c7b\u578b\"\u9009\u9879\uff0c\u53ef\u4ee5\u9488\u5bf9\u540c\u4e00\u7c7b\u578b\u7684\u6587\u4ef6\uff0c\u9009\u51fa\u4e00\u4e2a\u9ed8\u8ba4\u7528\u6237\u6240\u8981\u4f7f\u7528\u7684\u7a0b\u5e8f\u53bb\u6267\u884c\n                          /etc/alternatives\u76ee\u5f55\u4e0b\u6709\u6240\u6709\u76ee\u524d\u5df2\u7ecf\u5b9a\u4e49\u7684\u7a0b\u5e8f\u540d\u79f0\uff0c\u90fd\u4ee5\u8f6f\u94fe\u63a5\u7684\u65b9\u5f0f\u5b58\u5728\uff0c\u91cc\u9762\u6bcf\u4e00\u4e2a\u6587\u4ef6\u5176\u5b9e\u90fd\u6709\u5b9a\u4e49\u597d\u7684\n                          \u9ed8\u8ba4\u6267\u884c\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528alternatives\u547d\u4ee4\u67e5\u770b\u53ca\u4fee\u6539\u914d\u7f6e\n            fonts\uff1a\u8fd9\u4e2a\u76ee\u5f55\u5c31\u662ffontconfig\u8f6f\u4ef6\u7684\u6700\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u5176\u4e2d/etc/fonts/fonts.conf\u5c31\u662f\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0c/etc/fonts\u76ee\u5f55\u4e0b\u7684\u914d\u7f6e\n                   \u90fd\u662f\u4ee5XML\u7684\u65b9\u5f0f\u914d\u7f6e\u7684\n            gconf\uff1a\u8fd9\u4e00\u76ee\u5f55\u662fGConf2\u7684\u7ec4\u4ef6\u6240\u5efa\u7acb\u7684\uff0cGConf\u7684\u4f5c\u7528\u5c31\u662f\u63d0\u4f9bGNOME\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u6ce8\u518c\u7684\u673a\u5236\uff0c\u6709\u4e9b\u7c7b\u4f3c\u4e8ewindows\u4e0b\u7684regedit\n            gdm\uff1a\u5168\u540d\u4e3aGNOME Display Manger\uff0c\u4e5f\u5c31\u662f\u534f\u52a9X Windows\u542f\u52a8\u7684\u7ba1\u7406\u8f6f\u4ef6\uff0c\u5728GDM\u4e2d\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fcustom.conf\uff0c\u5728X windows\u4e0b\n                 \u53ef\u4ee5\u5229\u7528gdmsetup\u547d\u4ee4\u5bf9\u8fd9\u4e2a\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\n            gnome-vfs-2.0\uff1aGNOME VFS\u673a\u5236\uff0c\u8ba9GNOME\u7684\u7cfb\u7edf\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e00\u79cd\u6587\u4ef6\u683c\u5f0f\u8981\u5982\u4f55\u5f00\u542f\u6216\u6d4f\u89c8\uff0c\u800c\u6240\u6709\u7684\u914d\u7f6e\u90fd\u9700\u8981\u6709\u76f8\u5bf9\u5e94\u7684\u51fd\u6570\u5e93\n            gtk-2.0\uff1a\u7531gtk+\u7ec4\u4ef6\u63d0\u4f9b\u7684\u76ee\u5f55\uff0c\u4e3b\u8981\u662f\u63d0\u4f9bX Windows\u7a97\u53e3\u7684\u989c\u8272\u3001\u6309\u94ae\u6216\u56fe\u6848\uff0c\u5305\u542b\u8f6f\u4ef6\u9009\u9879\u7684\u753b\u9762\u3001\u9009\u9879\u7684\u6309\u94ae\u3001\u6eda\u52a8\u8f74\u7684\u6837\u5f0f\u7b49\n            kde\uff1aKDE Desktop Manager\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff1b\u4e3b\u914d\u7f6e\u6587\u4ef6\u662fkdmrc\n            NetworkManager\uff1a\u6b64\u76ee\u5f55\u7684\u76ee\u7684\u662f\u8ba9\u7528\u6237\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u64cd\u4f5c\u548c\u914d\u7f6e\uff0c\u53ea\u8981\u7528\u6237\u66fe\u7ecf\u767b\u9646\u8fc7\u65e0\u7ebfAP\uff0c\u7cfb\u7edf\u5c31\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u6765\uff0c\u4ee5\u540e\u518d\u6b21\u767b\u9646\u65f6\u5c31\n                            \u53ef\u4ee5\u65b9\u4fbf\u7684\u767b\u9646\n            pango\uff1apango\u662f\u4e00\u5957\u534f\u52a9GTK+\u5c06\u5b57\u4f53\u63cf\u7ed8\u51fa\u6765\u7684\u51fd\u6570\u5e93\uff0c\u4e0d\u8bba\u4efb\u4f55\u7684\u5b57\u4f53\u6216\u8bed\u8a00\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7pango\u63cf\u7ed8\u51fa\u6765\n            rhgb\uff1a\u7cfb\u7edf\u5728\u8fdb\u5165X Windows\u4e4b\u524d\uff0c\u6709\u4e00\u4e2a\u524d\u7f6e\u914d\u7f6e\u7684\u56fe\u5f62\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u5c31\u662frhgb\uff0c\u5176\u4e3b\u8981\u76ee\u7684\u662f\u8ba9\u7cfb\u7edf\u542f\u52a8\u53d8\u5f97\u6f02\u4eae\n            scim\uff1a\u662fLinux\u4e0b\u76ee\u524d\u5f88\u597d\u7528\u7684\u8f93\u5165\u6cd5\n            sound\uff1aGNOME\u4e0b\u6709\u8bb8\u591a\u7684\u5e94\u7528\u8f6f\u4ef6\uff0c\u5f88\u591a\u90fd\u4f1a\u6709\u5176\u7279\u6b8a\u7684\u58f0\u97f3\uff0c\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u5b58\u653e\u6240\u6709\u58f0\u97f3\u7684\u547d\u4ee4\u8def\u5f84\n            X11\uff1aX windows\u7684\u6838\u5fc3\u914d\u7f6e\u76ee\u5f55\uff1b\u8be5\u76ee\u5f55\u4e0b\u6bd4\u8f83\u91cd\u8981\u7684\u6587\u4ef6\u6709prefdm(\u5224\u65adX windows\u4f7f\u7528\u54ea\u4e00\u4e2aDisplay Manager)\u3001\u4e3b\u914d\u7f6e\u6587\u4ef6\n                   xorg.conf(\u5b9a\u4e86X windows\u6240\u9700\u4f7f\u7528\u7684\u952e\u76d8\u3001\u9f20\u6807\u3001\u663e\u5361\u7b49\u76f8\u5173\u786c\u4ef6\u8bbe\u5907\uff0c\u91cd\u70b9\u662f\u5173\u4e8e\u663e\u5361\u7684\u914d\u7f6e)\u3001xinit\u5b50\u76ee\u5f55\n                   (\u91cc\u9762\u90fd\u662f\u4e00\u4e9bX windows\u8d44\u6e90\u76f8\u5173\u7684\u914d\u7f6e)\n            xdg\uff1aX windows\u4e0a\u7684\u83dc\u5355\u753b\u9762\uff0c\u5c31\u662f\u4ece\u8fd9\u91cc\u51fa\u6765\u7684\uff0c\u6240\u6709\u5728X windows\u4e2d\u4f7f\u7528\u7684\u83dc\u5355\u6587\u5b57\u53ca\u5206\u7c7b\uff0c\u90fd\u53ef\u4ee5\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u505a\u914d\u7f6e\uff0c\u5176\u4e0b\u7684\u5b50\u76ee\u5f55\n                 menu\uff0c\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u91cc\u9762\u7684\u6587\u4ef6\u81ea\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u3001\u7cfb\u7edf\u7ba1\u7406\u3001\u5916\u89c2\u7b49\u83dc\u5355\u5185\u5bb9\n    \u5176\u4ed6\u76ee\u5f55\uff1a\u9488\u5bf9\u5355\u4e00\u7279\u6b8a\u8f6f\u4ef6\u7684\u914d\u7f6e\u6216\u672a\u80fd\u6309\u4ee5\u4e0a\u5206\u7c7b\u65b9\u5f0f\u5219\u653e\u5728\u6b64\u76ee\u5f55\u4e2d\n            a2ps.cfg\u548ca2ps-site.cfg\uff1a\u7528\u4e8e\u5c06\u4e00\u4efd\u6587\u4ef6\u683c\u5f0f\u8f6c\u6362\u4e3apostscript\u7684\u683c\u5f0f\uff0c\u5728\u67d0\u4e9b\u6253\u5370\u673a\u6216\u5c06\u6587\u4ef6\u8f93\u51fa\u6210\u4e00\u4efd\u6807\u51c6\u683c\u5f0f\u6587\u4ef6\u65f6\uff0c\u4f1a\u88ab\u7528\u5230\n            alsa\uff1a\u4e3b\u8981\u4efb\u52a1\u5728\u4e8e\u63d0\u4f9blinux\u58f0\u97f3\u53ca\u58f0\u97f3\u7684\u529f\u80fd\uff0c\u5e76\u8bd5\u7740\u8ba9\u5176\u6027\u80fd\u8fbe\u5230\u6700\u4f73\u5316\n            ghostscript\uff1alinux\u4e0b\u8bfb\u53d6Adobe\u683c\u5f0f\u6587\u4ef6(\u5982pdf)\uff0c\u5c31\u662f\u4f7f\u7528ghostscript\u547d\u4ee4\uff0c\u6b64\u76ee\u5f55\u4e3b\u8981\u7528\u4e8e\u8bbe\u7f6e\u5728\u663e\u793a\u65f6\u4f7f\u7528\u54ea\u79cd\u5b57\u4f53\u4f5c\u4e3a\u9ed8\u8ba4\u5b57\u4f53\n            gre.d\uff1aGRE\u662fMozilla\u6ce8\u518c\u7684\u4e00\u79cd\u673a\u5236\uff0c\u76ee\u5f55\u4e2d\u7684\u914d\u7f6e\u6587\u4ef6gre.conf\u4f1a\u6ce8\u660e\u6240\u4f7f\u7528\u7684Mozilla\u8f6f\u4ef6\u7684\u8def\u5f84\u548c\u7248\u672c\n            iproute2\uff1aiproute2\u662f\u4e00\u5957\u975e\u5e38\u5f3a\u5927\u7684\u7f51\u7edc\u7ba1\u7406\u8f6f\u4ef6\uff0ciproute2\u63d0\u4f9b\u7684\u529f\u80fd\u6709\u5f88\u591a\u79cd\uff0c\u6b64\u76ee\u5f55\u4e2d\u5b58\u653e\u4e00\u4e9b\u7f51\u7edc\u7684\u57fa\u672c\u914d\u7f6e\u503c\n            java\uff1a\u8fd9\u4e2a\u76ee\u5f55\u662f\u7531jpackage-utils\u8f6f\u4ef6\u63d0\u4f9b\u7684\uff0c\u8fd9\u4e2a\u76ee\u5f55\u662f\u8fd9\u4e2a\u8f6f\u4ef6\u7684\u4e3b\u8981\u914d\u7f6e\u76ee\u5f55\uff0c\u9664\u6b64\u4e4b\u5916\u8fd8\u6709maven\u3001jvm\u3001jvm-common\u90fd\u662f\u7531\n                  jpackage-utils\u8f6f\u4ef6\u4ea7\u751f\u7684\uff0cjpackage\u662f\u4e00\u4e2a\u4e13\u95e8\u4e3a\u4e86\u63d0\u4f9bjava\u7a0b\u5e8f\u4e0e\u51fd\u6570\u5e93\u6240\u5b58\u5728\u7684\u8f6f\u4ef6\n            mgetty+sendfax\uff1a\u4e3b\u8981\u7528\u4e8e\u4f7f\u7528linux\u67b6\u6784\u4e00\u53f0fax server\uff0c\u53ef\u4ee5\u4f7f\u7528mgetty.config\u6765\u914d\u7f6e\u9700\u8981\u6709\u5173\u4f20\u771f\u63a5\u6536\u548c\u53d1\u9001\u7684\u64cd\u4f5c\n            php.d\uff1a\u4e3b\u8981\u5b58\u653e\u7684\u5404\u8f6f\u4ef6(\u5982dbase\u3001ldap\u3001mysql\u7b49)\u4e0ephp\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\n            reader.conf.d\uff1a\u5b58\u653esmart card\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u7531\u7a0b\u5e8fpcsc-lite\u63d0\u4f9b\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/reader.conf\n            dumpdates\uff1a\u5b58\u653edump\u547d\u4ee4\u7684\u6267\u884c\u65e5\u671f\uff0cdump\u547d\u4ee4\u53ef\u4ee5\u5bf9ext2/ext3\u6587\u4ef6\u7cfb\u7edf\u8fdb\u884c\u68c0\u67e5\u5907\u4efd\n\n/home      \u9ed8\u8ba4\u5b58\u653e\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55(\u9664\u4e86root\u7528\u6237)\n     /home/~/.bashrc\uff1a\u63d0\u4f9bbash\u73af\u5883\u4e2d\u6240\u9700\u4f7f\u7528\u7684\u522b\u540d\n     /home/~/.bash_profile\uff1a\u63d0\u4f9bbash\u73af\u5883\u6240\u9700\u7684\u53d8\u91cf\uff1b\u4e00\u822c\u5148\u6267.bashrc\u540e\uff0c\u624d\u4f1a\u518d\u6267\u884c.bash_profile\n     /home/~/.bash_history\uff1a\u7528\u6237\u5386\u53f2\u547d\u4ee4\u6587\u4ef6\uff0c\u8bb0\u5f55\u7528\u6237\u66fe\u7ecf\u8f93\u5165\u7684\u6240\u6709\u547d\u4ee4\uff1b(\u9ed8\u8ba4\u4e3a1000\u6761\uff0c\u53ef\u4ee5\u901a\u8fc7HISTSIZE\u53d8\u91cf\u66f4\u6539)\n     /home/~/.bash_logout\uff1a\u5f53\u7528\u6237\u6ce8\u9500\u7684\u540c\u65f6\uff0c\u7cfb\u7edf\u81ea\u52a8\u751f\u6210.bash_logout\u6587\u4ef6\uff0c\u5982\u9700\u8981\u8bb0\u5f55\u7528\u6237\u6ce8\u9500\u7684\u5176\u4ed6\u4fe1\u606f\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u673a\u5236\u53bb\u5b8c\u6210\n\n/root     \u7ba1\u7406\u5458root\u7684\u5bbf\u4e3b\u76ee\u5f55\n\n/lib      \u9700\u8981\u5171\u4eab\u7684\u51fd\u6570\u5e93\u4e0ekernel\u6a21\u5757\uff0c\u7cfb\u7edfkernel\u542f\u52a8\u6240\u4f7f\u7528\u7684\u51fd\u6570\u5e93\uff0c\u6216\u8005\u5f53\u6267\u884c\u4e00\u4e9b\u5728/bin\u548c/sbin\u4e2d\u7684\u547d\u4ee4\u65f6\u4f7f\u7528\u7684\u51fd\u6570\u5e93\n\n/mnt      \u6302\u8f7d\u70b9\u76ee\u5f55\uff1b\u4e00\u822c\u7684\u81ea\u52a8\u6302\u5728/media\u76ee\u5f55(\u5982\u78c1\u76d8\u5206\u533a\uff0c\u7f51\u7edc\u5171\u4eab)\n\n/media    \u79fb\u52a8\u5b58\u50a8\u8bbe\u5907\u9ed8\u8ba4\u6302\u8f7d\u70b9\uff1b(\u5982\u5149\u76d8)\n\n/opt      \u5e38\u7528\u4e8e\u653e\u7f6e\u5927\u578b\u7684\u5e94\u7528\u8f6f\u4ef6\uff1b\u6570\u636e\u5e93\u6587\u4ef6\n\n/proc     \u53ea\u5b58\u5728\u4e8e\u5185\u5b58\u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4fdd\u5b58\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5185\u5b58\u4fe1\u606f\uff0cCPU\u4fe1\u606f\uff0c\u865a\u62df\u5185\u5b58\u4fe1\u606f\uff0c\u7535\u6e90\u4fe1\u606f\uff1bcpuinfo ,meminfo ,acpi,scsi,\n         vmstat,uptime;\u6bcf\u6b21\u542f\u52a8\u64cd\u4f5c\u7cfb\u7edf\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u65b0\u7684/porc\u6587\u4ef6\uff0c\u6765\u8bb0\u5f55\u7cfb\u7edf\u7684\u5b9e\u65f6\u4fe1\u606f\uff1b\u5e76\u4e0d\u662f\u5b58\u653e\u5728\u786c\u76d8\u4e0a\uff0c\u800c\u662f\u5185\u5b58\u955c\u50cf\u4e2d\u7684\n         \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u6b64\u76ee\u5f55\u662fkernel\u52a0\u8f7d\u540e\uff0c\u5728\u5185\u5b58\u91cc\u9762\u5efa\u7acb\u7684\u4e00\u4e2a\u865a\u62df\u76ee\u5f55\uff0c\u6709\u4e13\u5c5e\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e3b\u8981\u63d0\u4f9b\u7cfb\u7edf\u4e00\u4e9b\u5b9e\u65f6\u7684\u4fe1\u606f\uff0c\u6b64\u76ee\u5f55\u4e0b\u4e0d\u80fd\n         \u5efa\u7acb\u548c\u5220\u9664\u6587\u4ef6\uff1b(\u67d0\u4e9b\u6587\u4ef6\u53ef\u4ee5\u4fee\u6539)\n         /proc\u4e3b\u8981\u4f5c\u7528\u53ef\u4ee5\u6574\u7406\u4e3a\uff1a\n                \u6574\u7406\u7cfb\u7edf\u5185\u90e8\u7684\u4fe1\u606f\n                \u5b58\u653e\u4e3b\u673a\u786c\u4ef6\u4fe1\u606f\n                \u8c03\u6574\u7cfb\u7edf\u6267\u884c\u65f6\u7684\u53c2\u6570\n                \u68c0\u67e5\u53ca\u4fee\u6539\u7f51\u7edc\u548c\u4e3b\u673a\u7684\u53c2\u6570\n                \u68c0\u67e5\u53ca\u8c03\u6574\u7cfb\u7edf\u7684\u5185\u5b58\u548c\u6027\u80fd\n    /proc\u4e0b\u5e38\u7528\u7684\u4fe1\u606f\u6587\u4ef6\u6709\uff1a\n    /proc/cpuinfo\uff1acpu\u7684\u786c\u4ef6\u4fe1\u606f\uff0c\u5982\u7c7b\u578b\u3001\u5382\u5bb6\u3001\u578b\u53f7\u548c\u6027\u80fd\u7b49\n    /proc/devices\uff1a\u8bb0\u5f55\u6240\u6709\u5728/dev\u76ee\u5f55\u4e2d\u76f8\u5173\u7684\u8bbe\u5907\u6587\u4ef6\u5206\u7c7b\u65b9\u5f0f\n    /proc/filesystems\uff1a\u5f53\u524d\u8fd0\u884c\u5185\u6838\u6240\u914d\u7f6e\u7684\u6587\u4ef6\u7cfb\u7edf\n    /proc/interrupts\uff1a\u53ef\u4ee5\u67e5\u770b\u6bcf\u4e00\u4e2aIRQ\u7684\u7f16\u53f7\u5bf9\u5e94\u5230\u54ea\u4e00\u4e2a\u786c\u4ef6\u5907\n    /proc/loadavg\uff1a\u7cfb\u7edf\"\u5e73\u5747\u8d1f\u8f7d\"\uff0c3\u4e2a\u6570\u636e\u6307\u51fa\u7cfb\u7edf\u5f53\u524d\u7684\u5de5\u4f5c\u8d1f\u8f7d\n    /proc/dma\uff1a\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684DMA\u901a\u9053\n    /proc/ioports\uff1a\u5c06\u76ee\u524d\u7cfb\u7edf\u4e0a\u6240\u6709\u53ef\u770b\u5230\u7684\u786c\u4ef6\u5bf9\u5e94\u5230\u5185\u5b58\u4f4d\u7f6e\u7684\u914d\u8868\u7684\u8be6\u7ec6\u4fe1\u606f\u5448\u73b0\u51fa\u6765\n    /proc/kcore\uff1a\u7cfb\u7edf\u4e0a\u53ef\u4ee5\u68c0\u6d4b\u5230\u7684\u7269\u7406\u5185\u5b58\uff0c\u4e3b\u673a\u5185\u5b58\u591a\u5927\uff0c\u8fd9\u4e2a\u4ef6\u5c31\u6709\u591a\u5927\n    /proc/kmsg\uff1a\u5728\u7cfb\u7edf\u5c1a\u672a\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\u9636\u6bb5\uff0c\u628a\u52a0\u8f7dkernel\u548cinitr\u7684\u4fe1\u606f\u5148\u8bb0\u5f55\u5230\u8be5\u6587\u4ef6\u4e2d\uff0c\u540e\u7eed\u4f1a\u5c06\u65e5\u5fd7\u4fe1\u606f\u5199\u5165/var/log/messag\u6587\u4ef6\u4e2d\n    /proc/meminfo\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u5185\u5b58\u4fe1\u606f\n    /proc/modules\uff1a\u4e0elsmod\u547d\u4ee4\u67e5\u770b\u5230\u7684\u6a21\u5757\u4fe1\u606f\u5b8c\u5168\u4e00\u81f4\n    /proc/mtrr\uff1a\u8d1f\u8d23\u5185\u5b58\u914d\u7f6e\u7684\u673a\u5236\n    /proc/iomem\uff1a\u4e3b\u8981\u7528\u4e8e\u50a8\u5b58\u914d\u7f6e\u540e\u6240\u6709\u5185\u5b58\u50a8\u5b58\u7684\u660e\u7ec6\u4fe1\u606f\n    /proc/partitions\uff1a\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u5b9e\u65f6\u5448\u73b0\u7cfb\u7edf\u76ee\u524d\u770b\u5230\u7684\u5206\u533a\n    /proc/\u6570\u5b57\u76ee\u5f55\uff1a\u6570\u5b57\u76ee\u5f55\u5f88\u591a\uff0c\u5b83\u4eec\u4ee3\u8868\u6240\u6709\u76ee\u524d\u6b63\u5728\u7cfb\u7edf\u4e2d\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f\n    /proc/bus\uff1a\u6709\u5173\u8be5\u4e3b\u673a\u4e0a\u73b0\u6709\u603b\u7ebf\u7684\u6240\u6709\u4fe1\u606f\uff0c\u5982\u8f93\u5165\u8bbe\u5907\u3001PCI\u53e3\u3001PCMCIA\u6269\u5c55\u5361\u53caUSB\u63a5\u53e3\u4fe1\u606f\n    /proc/net\u76ee\u5f55\uff1a\u5b58\u653e\u7684\u90fd\u662f\u4e00\u4e9b\u7f51\u7edc\u76f8\u5173\u7684\u865a\u62df\u914d\u7f6e\u6587\u4ef6\uff0c\u90fdASCII\u6587\u4ef6\uff0c\u53ef\u4ee5\u67e5\u770b(\u4e0eifconfig\u3001arp\u3001netstat\u7b49\u6709\u5173)\n    /proc/scsi\uff1a\u4fdd\u5b58\u7cfb\u7edf\u4e0a\u6240\u6709\u7684scsi\u8bbe\u5907\u4fe1\u606f(\u5305\u62ecsata\u548cusb\u8bbe\u5907\u4fe1\u606f)\n    /proc/sys\u76ee\u5f55\uff1a\u5b58\u653e\u7cfb\u7edf\u6838\u5fc3\u6240\u4f7f\u7528\u7684\u4e00\u4e9b\u53d8\u91cf\uff0c\u6839\u636e\u4e0d\u540c\u6027\u8d28\u7684\u4ef6\u800c\u5b58\u653e\u5728\u4e0d\u540c\u7684\u5b50\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7/etc/sysctl.conf\u6587\u4ef6\u8bbe\u7f6e\u66f4\u6539\u5176\u9ed8\u8ba4\u503c\n                  \u53d8\u91cf\u65f6\u5b9e\u65f6\u7684\u53d8\u66f4\uff0c\u6709\u5f88\u591a\u8bbe\u7f6e\u5f88\u8c61\u662f\u5f00\u5173\uff0c\u8bbe\u7f6e\u540e\u4e0a\u751f\u6548\n    /proc/tty\uff1a\u5b58\u653e\u6709\u5173\u76ee\u524d\u53ef\u7528\u7684\u6b63\u5728\u4f7f\u7528\u7684tty\u8bbe\u5907\u7684\u4fe1\u606f\n    /proc/self\uff1a\u5b58\u653e\u5230\u67e5\u770b/proc\u7684\u7a0b\u5e8f\u7684\u8fdb\u7a0b\u76ee\u5f55\u7684\u7b26\u53f7\u8fde\u63a5\uff0c\u5f532\u8fdb\u7a0b\u67e5\u770bproc\u65f6\uff0c\u8fd9\u5c06\u4f1a\u662f\u4e0d\u540c\u7684\u8fde\u63a5\uff1b\u4e3b\u8981\u4fbf\u4e8e\u7a0b\u5e8f\u5f97\u5230\u5b83\u81ea\u5df1\u7684\u7a0b\u76ee\u5f55\n    /proc/stat\uff1a\u7cfb\u7edf\u7684\u4e0d\u540c\u72b6\u6001\u4fe1\u606f\n    /proc/uptime\uff1a\u7cfb\u7edf\u542f\u52a8\u7684\u65f6\u95f4\u957f\u5ea6\n    /proc/version\uff1a\u7cfb\u7edf\u6838\u5fc3\u7248\u672c\n\n/sbin    \u5b58\u653e\u7279\u6743\u7ea7\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u7279\u6743\u7ea7\u53ef\u6267\u884c\u547d\u4ee4\uff09\u53ea\u6709root\u7528\u6237\u53ef\u4ee5\u6267\u884c\uff1b\u8f83\u5371\u9669\u7684\u547d\u4ee4\u4fdd\u5b58\u5176\u4e2d\uff1b(\u591a\u6570\u7ba1\u7406\u547d\u4ee4\u9ed8\u8ba4\u53ea\u6709\u7ba1\u7406\u5458\u53ef\u4ee5\u4f7f\u7528)\n\n/usr\uff1a\u5b89\u88c5\u9664\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u5916\u7684\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u6216\u7ec4\u4ef6\uff0c\u4e00\u822c\u53ef\u4ee5\u8ba4\u4e3alinux\u7cfb\u7edf\u4e0a\u5b89\u88c5\u7684\u5e94\u7528\u7a0b\u5e8f\u9ed8\u8ba4\u90fd\u5b89\u88c5\u5728\u6b64\u76ee\u5f55\u4e2d\n    /usr/bin\uff1a\u4e00\u822c\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u5230\u7684\u7a0b\u5e8f\uff0c\u6216\u8005\u8be5\u8f6f\u4ef6\u9ed8\u8ba4\u5c31\u662f\u8981\u6240\u6709\u7528\u6237\u4f7f\u7528\u624d\u4f1a\u653e\u5728\u8be5\u76ee\u5f55\u4e2d\n    /usr/sbin\uff1a\u4e00\u4e9b\u7cfb\u7edf\u6709\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u7cfb\u7edf\u547d\u4ee4\uff0c\u4e0e/sbin\u6bd4\u8d77\u6765\uff0c\u662f\u4e00\u4e9b\u8f83\u6b21\u8981\u7684\u6587\u4ef6\n    /usr/etc\uff1a\u81ea\u884c\u5b89\u88c5\u6216\u975e\u7cfb\u7edf\u4e3b\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\n    /usr/games\uff1a\u53ea\u8981\u662f\u7535\u8111\u6e38\u620f\u76f8\u5173\u7684\u8f6f\u4ef6\uff0c\u5c31\u90fd\u5b89\u88c5\u5230\u8fd9\u4e2a\u76ee\u5f55\n    /usr/include\uff1a\u5b58\u653e\u7684\u6587\u4ef6\u90fd\u662f\u4e00\u4e9b\u7cfb\u7edf\u4e2d\u7528\u6237\u6240\u4f1a\u4f7f\u7528\u5230\u7684C\u8bedheader\u6587\u4ef6\uff0c\u4fdd\u5b58\u7684\u90fd\u662f\".h\"\u7684\u6587\u4ef6\n    /usr/kerberos\uff1akerberos\u662f\u4e00\u79cd\u5b89\u5168\u673a\u5236\uff0c\u8ba9\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6301kerberos\u673a\u5236\u7cfb\u7edf\u4e0a\u7684\u90e8\u5206\u8d44\u6e90\n    /usr/lib\uff1a\u5b58\u653e\u4e00\u4e9b\u51fd\u6570\u5e93\u3001\u6267\u884c\u6587\u4ef6\u53ca\u8fde\u63a5\u6587\u4ef6\uff0c\u7279\u522b\u7684\u662f\uff0c\u5b58\u5728\u8fd9\u91cc\u9762\u7684\u6587\u4ef6\u90fd\u662f\u4e0d\u5e0c\u671b\u76f4\u63a5\u88ab\u7528\u6237\u6216shell\u811a\u672c\u6240\u4f7f\u7528\u7684\u6587\u4ef6\uff0c/usr/lib\u4e2d\u6709\n              \u975e\u5e38\u591a\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e00\u4e2a\u8f6f\u4ef6\u90fd\u6709\u5176\u5404\u81ea\u6240\u9700\u7684\u51fd\u5e93\n    /usr/libexec\uff1a\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u53ca\u6587\u4ef6\u5939\u5e94\u8be5\u90fd\u53ef\u4ee5\u653e\u7f6e/usr/lib\u4e0b\n    /usr/local\uff1alinux\u7cfb\u7edf\u4e2d\u5b89\u88c5\u7684\u5171\u4eab\u8f6f\u4ef6\u7a0b\u5e8f\u6700\u597d\u7684\u65b9\u5f0f\u662f\u5b89\u88c5/usr/local\u4e0b\uff0c\u6309\u7167linux\u6807\u51c6\u76ee\u5f55\u7ed3\u6784\uff0c\u65b0\u5efa\u7acb\u7684\u8f6f\u4ef6\u90fd\u5e94\u8be5\u653e/usr/local\u4e0b\n        /usr/local/bin\uff1a\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55\n        /usr/local/sbin\uff1a\u540c\u6837\u5b58\u653e\u8f6f\u4ef6\u6267\u884c\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f46\u6b64\u76ee\u5f55\u95e8\u9488\u5bf9\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u6587\u4ef6\n        /usr/local/lib\uff1a\u8f6f\u4ef6\u76f8\u5173\u7684\u51fd\u6570\u5e93\n        /usr/local/share\uff1a\u5f53\u6587\u4ef6\u6027\u8d28\u4e0d\u597d\u5f52\u5c5e\u65f6\u5c31\u4f1a\u653e\u5728\u6b64\uff0cman\u518c\u5c31\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\n        /usr/local/src\uff1a\u6240\u5b89\u88c5\u8f6f\u4ef6\u7684\u6e90\u4ee3\u7801\u653e\u7f6e\u5728\u6b64\n    /usr/share\uff1a\u6b64\u76ee\u5f55\u90fd\u662f\u4e00\u4e9b\u5171\u4eab\u4fe1\u606f\uff0c\u6700\u5e38\u88ab\u7528\u5230\u7684\u5c31/usr/share/man\u8fd9\u4e2a\u76ee\u5f55\uff0c/usr/share\u91cc\u7684\u4fe1\u606f\u65f6\u8de8\u5e73\u53f0\u7684\n    /usr/share/doc\uff1a\u653e\u7f6e\u4e00\u4e9b\u7cfb\u7edf\u5e2e\u52a9\u6587\u4ef6\u7684\u5730\u65b9\n    /usr/share/man\uff1amanpage\u7684\u6587\u4ef6\u5b58\u653e\u76ee\u5f55\uff0c\u4e5f\u662f\u4f7f\u7528man\u67e5\u770b\u624b\u518c\u65f6\u67e5\u8be2\u7684\u8def\u5f84\n    /usr/src\uff1a\u4e3b\u8981\u50a8\u5b58\u5185\u6838\u6e90\u4ee3\u7801\u7684\u6587\u4ef6\n    /usr/X11R6\uff1a\u5b58\u653e\u4e00\u4e9bX windows\u7cfb\u7edf\u7684\u76f8\u5173\u6587\u4ef6\n\n/var    \u52a8\u6001\u6587\u4ef6\u6216\u6570\u636e\u5b58\u653e\u76ee\u5f55\uff0c\u9ed8\u8ba4\u65e5\u5fd7\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u4e00\u822c\u5efa\u8bae\u628a\u6b64\u76ee\u5f55\u5355\u72ec\u5212\u5206\u4e00\u4e2a\u5206\u533a\n    /var/account\uff1a\u662flinux\u7cfb\u7edf\u4e0b\u7684\u5ba1\u6838\u673a\u5236(psacct)\u5bf9\u5e94\u7684\u76ee\u5f55\n    /var/cache\uff1a\u8be5\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u65f6\u6240\u6709\u7a0b\u5e8f\u6240\u4ea7\u751f\u7684\u7f13\u5b58\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u5f53\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u4f1a\u5c06\u6570\u636e\u7559\u4e00\u4efd\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\n    /var/empty\uff1a\u9ed8\u8ba4\u662fsshd\u7a0b\u5e8f\u7528\u5230\u7684\u8fd9\u4e2a\u76ee\u5f55\uff0c\u5f53\u5efa\u7acbssh\u8fde\u63a5\uff0cssh\u670d\u52a1\u5668\u5fc5\u987b\u4f7f\u7528\u8be5\u76ee\u5f55\u4e0b\u7684sshd\u5b50\u76ee\u5f55\n    /var/ftp\uff1aftp\u670d\u52a1\u5668\u8f6f\u4ef6\u4e00\u822c\u9ed8\u8ba4\u4f1a\u5c06\u533f\u540d\u767b\u9646\u7684\u7528\u6237\u7684\u5bbf\u4e3b\u76ee\u5f55\n    /var/gdm\uff1agdm\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u4e00\u4e9b\u7cfb\u7edf\u5f53\u524d\u6240\u5360\u7528\u7684console\u8bb0\u5f55\u53ca\u901a\u8fc7gdm\u6267\u884c\u7684X windows\u8bb0\u5f55\uff0c\u53ea\u6709\u901a\u8fc7gdm\u7a97\u53e3\u7684\u65e5\u5fd7\u624d\u4f1a\u5b58\u653e\u5728\u6b64\n    /var/lib\uff1a\u8be5\u76ee\u5f55\u4e0b\u5b58\u653e\u5f88\u591a\u4e0e\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0\u540c\u540d\u7684\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e2a\u5b50\u76ee\u5f55\u4e0b\u90fd\u662f\u5e94\u7528\u6267\u884c\u7684\u72b6\u6001\u4fe1\u606f\n    /var/lock\uff1a\u6bcf\u4e2a\u670d\u52a1\u4e00\u5f00\u59cb\u90fd\u4f1a\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\u4ea7\u751f\u4e00\u4e2a\u8be5\u670d\u52a1\u7684\u7a7a\u6587\u4ef6\uff0c\u4e3b\u8981\u662f\u907f\u514d\u670d\u52a1\u542f\u52a8\u51b2\u7a81\n    /var/log\uff1a\u5e38\u7528\u76ee\u5f55\uff0c\u4e13\u95e8\u7528\u6765\u5b58\u653e\u6240\u6709\u65e5\u5fd7\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u91cc\u9762\u5b58\u653e\u5f88\u591a\u7cfb\u7edf\u3001\u8f6f\u4ef6\u3001\u7528\u6237\u7b49\u76f8\u5173\u7684\u65e5\u5fd7\u4fe1\u606f\uff1b\u91cc\u9762\u6709\u4e00\u4e9b\u6587\u4ef6\u662f\u6bd4\u8f83\u5e38\u7528\u7684\n        lastlog\uff1a\u8bb0\u5f55\u7528\u6237\u6700\u540e\u4e00\u6b21\u767b\u5f55\u7684\u4fe1\u606f\uff0c\u4f7f\u7528lastlog\u547d\u4ee4\u8bfb\u53d6\n        message\uff1a\u8bb0\u5f55\u7cfb\u7edf\u7684\u51e0\u4e4e\u6240\u6709\u4fe1\u606f\uff0c\u4e3b\u8981\u5305\u62ec\u542f\u52a8\u4fe1\u606f\uff0csyslogd\u670d\u52a1\u8bb0\u5f55\u7684\u4fe1\u606f\u7b49\n        wtmp\uff1a\u8bb0\u5f55\u6240\u6709\u7528\u6237\u767b\u9646\u53ca\u6ce8\u9500\u7684\u4fe1\u606f\uff0c\u4f7f\u7528last\u547d\u4ee4\u8bfb\u53d6\n        secure\uff1a\u8bb0\u5f55\u767b\u5f55\u7cfb\u7edf\u8bbf\u95ee\u6570\u636e\u7684\u6587\u4ef6\uff0c\u5982ssh pop3 telnet ftp\u7b49\u90fd\u4f1a\u8bb0\u5f55\u5728\u6b64\u6587\u4ef6\u4e2d\n        /var/log/httpd/access_log\uff1ahttpd\u8bbf\u95ee\u65e5\u5fd7\n        /var/log/httpd/error_log\uff1ahttpd\u9519\u8bef\u65e5\u5fd7\n        btmp\uff1a\u8bb0\u5f55\u5931\u8d25\u7684\u7528\u6237\u767b\u5f55\n        utmp\uff1a \u7eaa\u5f55\u5f53\u524d\u767b\u5f55\u7684\u6bcf\u4e2a\u7528\u6237\n        xferlog\uff1aftp\u4f1a\u8bdd\u65e5\u5fd7\n        boot.log\uff1a\u8bb0\u5f55\u5f00\u673a\u6216\u4e00\u4e9b\u670d\u52a1\u542f\u52a8\u65f6\u6240\u663e\u793a\u7684\u542f\u52a8\u548c\u5173\u95ed\u4fe1\u606f\n        /var/log/maillog\u6216/var/log/mail/*\uff1a\u8bb0\u5f55\u90ae\u4ef6\u8bbf\u95ee\u6216\u5f80\u6765\u7684\u7528\u6237\u4fe1\u606f\n        cron\uff1a \u8bb0\u5f55crontab\u4f8b\u884c\u6027\u670d\u52a1\u7684\u5185\u5bb9\n        dmesg\uff1a\u5f00\u673a\u5f15\u5bfc\u65e5\u5fd7\u4fe1\u606f\n        sudolog\uff1a\u7eaa\u5f55\u4f7f\u7528sudo\u53d1\u51fa\u7684\u547d\u4ee4\n        sulog\uff1a \u7eaa\u5f55\u4f7f\u7528su\u547d\u4ee4\u7684\u4f7f\u7528\n    /var/named\uff1abind\u8f6f\u4ef6\u5b9e\u73b0\u7684DNS\u670d\u52a1\u5668\u7684\u533a\u57df\u6570\u636e\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\n    /var/nis\u548c/var/yp\uff1a\u90fd\u662fNIS\u670d\u52a1\u673a\u5236\u6240\u4f7f\u7528\u7684\u76ee\u5f55\uff0cnis\u4e3b\u8981\u8bb0\u5f55\u6240\u6709\u7f51\u7edc\u4e2d\u6bcf\u4e00\u4e2aclient\u7684\u8fde\u63a5\u4fe1\u606f\uff1byp\u662flinux\u7684nis\u670d\u52a1\u7684\u65e5\u5fd7\u6587\u4ef6\u5b58\u653e\u7684\u76ee\u5f55\n    /var/run\uff1a\u6b64\u76ee\u5f55\u4e2d\u7684\u5927\u90e8\u5206\u6587\u4ef6\u90fd\u8bb0\u8f7d\u76ee\u524d\u7cfb\u7edf\u6b63\u5728\u6267\u884c\u7a0b\u5e8f\u7684PID\u503c\uff0c\u6bcf\u4e00\u4e2a\u6587\u4ef6\u90fd\u662f\u4ee5\u4e2a\u72ec\u7acb\u7684PID\u8bb0\u5f55\uff1b\u6b64\u76ee\u5f55\u4e0b\u5b58\u653e\u4e00\u4e2a\u7279\u6b8a\u6587\u4ef6utmp\uff0c\u6b64\u6587\u4ef6\u8bb0\u5f55\u76ee\u524d\u8c01\u5728\u4f7f\u7528\u7cfb\u7edf\uff0c\u5fc5\u987b\u4f7f\u7528utmpdump\u547d\u4ee4\u624d\u80fd\u770b\u5230\u5176\u4e2d\u7684\u5185\u5bb9\n    /var/spool\uff1a\u91cc\u9762\u4e3b\u8981\u90fd\u662f\u4e00\u4e9b\u4e34\u65f6\u5b58\u653e\uff0c\u968f\u65f6\u4f1a\u88ab\u7528\u6237\u6240\u8c03\u7528\u7684\u6570\u636e\uff1b\u6253\u5370\u673a\u3001\u90ae\u4ef6\u3001\u4ee3\u7406\u670d\u52a1\u5668\u7b49\u5047\u8131\u673a\u76ee\u5f55\u5b58\u653e\u5728\u8be5\u76ee\u5f55\u4e0b\n    /var/tmp\uff1a\u4e13\u95e8\u4e3a\u4e86\u4e00\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5728\u5b89\u88c5\u6216\u6267\u884c\u65f6\uff0c\u9700\u8981\u5728\u91cd\u542f\u540e\u4f7f\u7528\u7684\u67d0\u4e9b\u6587\u4ef6\u65f6\uff0c\u80fd\u5c06\u8be5\u6587\u4ef6\u6682\u65f6\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\uff0c\u5b8c\u6210\u540e\u518d\u884c\u5220\u9664\n    /var/www\uff1aapache\u7f51\u9875\u670d\u52a1\u5668\u7684\u5bbf\u4e3b\u76ee\u5f55\n\n/lost+found:\u5b58\u653e\u4e86\u4e00\u4e9b\u7cfb\u7edf\u51fa\u9519\u7684\u68c0\u67e5\u7ed3\u679c\uff1b\u5f02\u5e38\u65ad\u7535\u60c5\u51b5\u3001\u6b7b\u673a\uff1b\u9ed8\u8ba4\u76ee\u5f55\u662f\u7a7a\u7684,\u901a\u5e38\u4f7f\u7528fsck\u8fdb\u884c\u6587\u4ef6\u4fee\u590d\uff0c\u4fee\u590d\u540e\u6587\u4ef6\u5219\u88ab\u5b58\u653e\u4e8e\u6b64\u76ee\u5f55\n\n/misc\uff1a\u81ea\u52a8\u6302\u8f7d\u670d\u52a1\u76ee\u5f55\uff0c\u5bf9\u5e94autofs\u670d\u52a1\n\n/srv\uff1a\u9ed8\u8ba4\u4e3a\u7a7a\uff0c\u4e3b\u8981\u7528\u4e8e\u5b58\u653e\u4e00\u4e9b\u8f6f\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u67d0\u4e9b\u8f6f\u4ef6\u53ef\u80fd\u4f1a\u628a\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u5b58\u653e\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e0b\uff0c\u591a\u6570\u90fd\u662f/etc\u76ee\u5f55\u4e0b\uff0c\u6b64\u76ee\u5f55\u6ca1\u6709\u88ab\u5177\u4f53\u7684\u5b9a\u4e49\n\n/temp  \u4e34\u65f6\u6587\u4ef6\u5b58\u653e\u70b9\uff1b\u6b64\u76ee\u5f55\u6709\u7279\u6b8a\u7684\u6743\u9650\u4f4d\u7c98\u6ede\u4f4d\uff1a1777\n\n/tftpboot\uff1a\u8fdc\u7a0b\u542f\u52a8tftpserver\u7684\u6839\u76ee\u5f55\uff0c\u8fd9\u4e2a\u76ee\u5f55\u53ea\u6709\u5b89\u88c5\u4e86tftp-server\u8f6f\u4ef6\u540e\u624d\u4f1a\u4ea7\u751f\n\n\u5907\u6ce8\uff1a\u5982\u679c\u8981\u505a\u7cfb\u7edf\u7ea7\u5907\u4efd\u7684\u8bdd\uff0c/etc ,/boot\u662f\u5fc5\u987b\u8981\u5907\u4efd\u7684\u76ee\u5f55\uff0c\u5907\u4efd\u5206\u4e3a\uff1a\u7cfb\u7edf\u5907\u4efd\u548c\u7528\u6237\u5907\u4efd\n/sbin   /usr/sbin\u662froot\u8d26\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84\n/bin    /usr/bin\u5bf9\u4e8e\u666e\u901a\u7528\u6237\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u7684\u5b58\u653e\u8def\u5f84\n        bin\u4ee3\u8868binnary \uff1bsbin \u4ee3\u8868super binnary\n/usr\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u548cwindows\u7cfb\u7edf\u4e0a\u7684windows\u76ee\u5f55\u7684\u91cd\u8981\u6027\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u6838\u5fc3\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\n</code></pre>"},{"location":"system/linux/Centos/#grub","title":"GRUB\u914d\u7f6e\u6587\u4ef6\u8bb2\u89e3","text":"Markdown<pre><code>\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\uff1a/etc/grub.conf\u662f\u4e2a\u8f6f\u8fde\u63a5\u6587\u4ef6\n\u539f\u59cb\u6587\u4ef6/boot/grub/grub.conf\ngrep -v \"^#\" /boot/grub/grub.conf | more\n\u5b57\u6bb5\uff1a\ndefault\u5b9a\u4e49\u7f3a\u7701\u542f\u52a8\u7cfb\u7edf,0\u8868\u793a\u7b2c\u4e00\u4e2a\uff0c1\u8868\u793a\u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8\n-------------------------------------------------\ntimeout     \u5b9a\u4e49\u4e86\u7f3a\u7701\u7b49\u5f85\u65f6\u95f4\uff1b\u9ed8\u8ba45\u79d2\n-------------------------------------------------\nsplashimage \u5b9a\u4e49\u4e86GRUB\u542f\u52a8\u65f6\u7684\u754c\u9762\u56fe\u7247\n-------------------------------------------------\nhiddenmenu  \u9690\u85cf\u83dc\u5355\n-------------------------------------------------\ntitle       \u5b9a\u4e49\u4e86\u83dc\u5355\u9879\u540d\u79f0\n-------------------------------------------------\nroot        \u4f5c\u7528\u662f\u8bbe\u7f6eGRUB\u7684\u6839\u8bbe\u5907\u4e5f\u5c31\u662f\u5185\u6838\u6240\u5728\u7684\u5206\u533a\n-------------------------------------------------\nkernel      \u5b9a\u4e49\u4e86\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e\n-------------------------------------------------\ninitrd      \u547d\u4ee4\u52a0\u8f7d\u955c\u50cf\u6587\u4ef6\u4ee5\u53ca\u663e\u793a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e\n-------------------------------------------------\n\nGRUB\u8bbe\u7f6e\u5bc6\u7801\n\n\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u4f7f\u7528GRUB\u81ea\u5e26\u7684grub-md5-crypt\u547d\u4ee4\ngrub-md5-crypt\n\u5728\u56fe\u5f62\u754c\u9762\u6211\u53ef\u4ee5\u9009\u62e9\u590d\u5236\u9009\u9879\u8fdb\u884c\u590d\u5236\uff0c\u5728\u5b57\u7b26\u7ec8\u7aef\u754c\u9762\u4e0a\u4f7f\u7528\u9f20\u6807\u53f3\u952e\u590d\u5236\u52a0\u5bc6\u5b57\u7b26\n\u7f16\u8f91/etc/grub.conf\u914d\u7f6e\u6587\u4ef6\uff0c\u5728hiddenmenu\u5b57\u6bb5\u4e0b\u9762\u63d2\u5165\u5173\u4e8e\u63d2\u5165\u4f4d\u7f6e\u6ca1\u6709\u4e25\u683c\u7684\u8981\u6c42\uff09\npassword --md5 \u52a0\u5bc6\u5b57\u7b26\uff08-md5\u8868\u793a\u53e3\u4ee4\u662fmd5\u52a0\u5bc6\u7684\uff09\n\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u63d2\u5165\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\uff1b\u7136\u540e\u9000\u51fa\u4fdd\u6301\u5373\u53ef\n\n\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u662f\u5728GRUB\u4ea4\u4e92\u547d\u4ee4\u884c\u754c\u9762\u4f7f\u7528md5crypt\u547d\u4ee4\uff0c\u6548\u679c\u662f\u4e00\u6837\u7684\ngrub\ngrub&gt;md5crypt\npassword:\n\nGRUB\u7684\u7cfb\u7edf\u4fee\u590d\uff1a\uff08\u624b\u5de5\u4fee\u590d\uff09\u6545\u610f\u4fee\u6539kernel\u6307\u5b9a\u7684\u5185\u6838\u6587\u4ef6\ngrub&gt; cat /grub/grub.conf  \u4e3a\u4ec0\u4e48\u6ca1\u6709/boot\u539f\u56e0\u5c31\u662fgrub\u5b58\u653e\u5728/boot\u5206\u533a\ngrub&gt; \u6307\u5b9a\u5185\u6838\u6240\u5728\u7684\u5206\u533a root (hd0,0)\ngrub&gt; \u6307\u5b9a\u5185\u6838\u6587\u4ef6\u6240\u5728\u7684\u4f4d\u7f6e\ngrub&gt; \u6307\u5b9a\u955c\u50cf\u6587\u4ef6\u7684\u4f4d\u7f6e\ngrub&gt; boot\n\u624b\u5de5\u4fee\u590d\u5c5e\u4e8e\u547d\u4ee4\u884c\u64cd\u4f5c\uff1b\u5982\u4fee\u6539\u4e86/etc/inittab\u4e2d\u7684\u9ed8\u8ba4\u542f\u52a8\u7ea7\u522b\u7684\u8bdd\uff0c\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7grub\u542f\u52a8\u83dc\u5355\u6765\u8fdb\u884c\u4fee\u590d\uff1a\u5728kernel\u884c\u76f4\u63a5\u52a0\u5165\u542f\u52a8\u7ea7\u522b\n\n\u7ec8\u6781\u4fee\u590d\u6a21\u5f0f\uff1a\u5149\u76d8\u4fee\u590d\n\u5149\u76d8\u5f15\u5bfc\uff0cF5\u952e\uff0c\u952e\u5165linux rescue\n\u6848\u4f8b1\uff1a\u5c1d\u8bd5\u5220\u9664/etc/inittab\uff0c\u4e4b\u524d\u5148\u505a\u597d\u5907\u4efd\ncp /etc/inittab /etc/inittab.bak\nrm -rf /etc/inittab\n\n\u6848\u4f8b2\uff1a\u5982\u679c\u5fd8\u8bb0\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u540c\u65f6\u4e5f\u5fd8\u8bb0\u4e86GRUB\u7684\u4fdd\u62a4\u5bc6\u7801\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528GRUB\u7684\u7cfb\u7edf\u4fee\u590d\u6216\u8005\u4f7f\u7528\u5149\u76d8\u7684\u5f15\u5bfc\u4fee\u590d\u6765\u89e3\u51b3\u6b64\u95ee\u9898\n</code></pre>"},{"location":"system/linux/Centos/#fstab","title":"fstab\u6587\u4ef6\u542b\u4e49\u5982\u4e0b","text":"<ul> <li>\u7269\u7406\u5206\u533a/\u5377\u6807\uff1b\u53ef\u4ee5\u4f7f\u7528UUID\u3001\u8bbe\u5907\u8def\u5f84/dev/\u3001\u534f\u8bae/\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\u6216\u7f51\u7edc\u5171\u4eab\u540d\u79f0\u8868\u793a</li> <li>\u6302\u8f7d\u70b9(\u6ce8\u610f\uff1aswap\u6ca1\u6709\u6302\u8f7d\u70b9)</li> <li>\u6587\u4ef6\u7cfb\u7edf,auto\u901a\u5e38\u7528\u4e8e\u53ef\u79fb\u52a8\u8bbe\u5907\uff0c\u7279\u5b9a\u6587\u4ef6\u7cfb\u7edf\u6216\u7f51\u7edc\u5171\u4eab\u7f51\u7edc\u534f\u8bae</li> <li>\u6302\u8f7d\u65f6\u4f7f\u7528\u7684\u53c2\u6570\uff1b\u6b64\u9009\u9879\u53d6\u51b3\u4e8e\u6587\u4ef6\u7cfb\u7edf\uff0cdefault=rw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\u548casync</li> <li>sync/async     \u6587\u4ef6\u7cfb\u7edf\u7684\u6240\u6709I/O\u540c\u6b65\u6216\u5f02\u6b65\u5b8c\u6210</li> <li>auto           \u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u81ea\u52a8\u6302\u8f7d\uff08\u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u9009\u9879\u4f20\u9012\u6302\u8f7d\u65f6\uff09\u3002\u786e\u5b9e\u6ca1\u6709\u5fc5\u8981\uff0c\u56e0\u4e3a\u65e0\u8bba\u5982\u4f55\u8fd9\u662fmount -a\u7684\u9ed8\u8ba4\u64cd\u4f5c</li> <li>noauto         \u5728\u542f\u52a8\u65f6\u6216\u901a\u8fc7-a\u6302\u8f7d\u65f6\u4e0d\u4f1a\u81ea\u52a8\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u60a8\u5fc5\u987b\u663e\u5f0f\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf</li> <li>dev/nodev      \u89e3\u91ca\u6216\u4e0d\u89e3\u91ca\u5b57\u7b26\u6216\u963b\u6b62\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u7279\u6b8a\u8bbe\u5907</li> <li>exec/noexec    \u5141\u8bb8\u6216\u963b\u6b62\u4ece\u6587\u4ef6\u7cfb\u7edf\u6267\u884c\u4e8c\u8fdb\u5236\u6587\u4ef6</li> <li>suid/nosuid    \u5141\u8bb8\u6216\u963b\u6b62suid\u548csgid\u4f4d\u7684\u64cd\u4f5c</li> <li>ro             \u6302\u8f7d\u4e3a\u53ea\u8bfb</li> <li>rw             \u6302\u8f7d\u4e3a\u8bfb\u5199</li> <li>user           \u5141\u8bb8\u4efb\u4f55\u7528\u6237\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u9664\u975e\u88ab\u8986\u76d6\uff0c\u8fd9\u5c06\u81ea\u52a8\u8868\u793anoexec\uff0cnosuid\uff0cnodev\u9664\u975e\u88ab\u989d\u5916\u9009\u9879\u8986\u76d6</li> <li>nouser         \u4ec5\u5141\u8bb8root\u6302\u8f7d\u6587\u4ef6\u7cfb\u7edf\u3002\u8fd9\u4e5f\u662f\u9ed8\u8ba4\u8bbe\u7f6e</li> <li>defaults       \u4f7f\u7528\u9ed8\u8ba4\u8bbe\u7f6e\u3002\u7b49\u6548\u4e8erw\uff0csuid\uff0cdev\uff0cexec\uff0cauto\uff0cnouser\uff0casync</li> <li>_netdev        \u8fd9\u662f\u4e00\u4e2a\u7f51\u7edc\u8bbe\u5907\uff0c\u5728\u542f\u52a8\u7f51\u7edc\u540e\u5c06\u5176\u5b89\u88c5\u3002\u4ec5\u5bf9fstype nfs\u6709\u6548</li> <li>noatime,nodiratime \u7981\u6b62\u8bb0\u5f55\u6700\u8fd1\u8bbf\u95ee\u65f6\u95f4\u6233\uff0c\u8bbe\u7f6enoatime\u53ef\u4e0d\u5fc5\u518d\u8bbe\u7f6enodiratime</li> <li>relatime       \u5b9e\u65f6\u66f4\u65b0inode\u8bbf\u95ee\u8bb0\u5f55\u65f6\u95f4\u6233</li> <li>owner          \u5141\u8bb8\u8bbe\u5907\u88ab\u90a3\u4e2a\u6240\u6709\u8005\u6302\u8f7d</li> <li>\u542f\u7528\u6216\u7981\u7528\u8bbe\u5907/\u5206\u533a\u7684\u5907\u4efd(dump\u662f\u5907\u4efd\u5de5\u5177)\uff0c1\u8868\u793a\u5f00\u542f\uff0c0\u8868\u793a\u5ffd\u7565</li> <li>\u63a7\u5236fsck\u5728\u5f15\u5bfc\u65f6\u68c0\u67e5\u8bbe\u5907/\u5206\u533a\u7684\u9519\u8bef\u7684\u987a\u5e8f\uff0c\u6839\u8bbe\u5907\u5e94\u4e3a1\u3002\u5176\u4ed6\u5206\u533a\u5e94\u4e3a2\u62160\u4ee5\u7981\u7528\u68c0\u67e5</li> </ul>"},{"location":"system/linux/Centos/#linux_","title":"Linux_\u7528\u6237\u3001\u7ec4\u548c\u6743\u9650","text":""},{"location":"system/linux/Centos/#linux_4","title":"Linux\u7528\u6237\u548c\u7528\u6237\u7ec4","text":"Markdown<pre><code># \u67e5\u770b\u7cfb\u7edf\u4e2d\u6709\u591a\u5c11\u7684\u7528\u6237\u6570\u91cf\nwc -l /etc/passwd\ncut -d \" : \" -f 1 /etc/passwd\n\n# \u7528\u6237\u548c\u7ec4\u7684\u6587\u4ef6\n/etc/passwd\n/etc/group\n\n# \u5f71\u5b50\u53e3\u4ee4\uff1a\uff08\u771f\u6b63\u53e3\u4ee4\u6587\u4ef6\u8def\u5f84\uff09\n\u7528\u6237\uff1a/etc/shadow\n\u7ec4\uff1a/etc/gshadow\n\n# /etc/passwd\u4e2d7\u6bb5\u610f\u4e49\uff1a\u7528\u6237\u540d\uff1a\u5bc6\u7801\uff1aUID:GID\uff1a\u7528\u6237\u63cf\u8ff0\u4fe1\u606f\uff1a\u5bb6\u76ee\u5f55\uff1a\u9ed8\u8ba4SHELL\naccount: \u7528\u6237\u540d\npassword: \u5bc6\u7801\nUID\uff1a\u7528\u6237ID\uff0c\u5206\u4e3a\u4e09\u7c7b\uff1aroot\u7528\u6237\uff1a0\uff0c\u666e\u901a\u7528\u6237\uff1a500-60000\uff0c\u4f2a\u7528\u6237\uff1a1-499\nGID\uff1a\u7ec4ID\uff0c\u6bcf\u4e2a\u7528\u6237\u81f3\u5c11\u5c5e\u4e8e\u4e00\u4e2a\u7ec4\uff0c\u6bcf\u4e2a\u7ec4\u53ef\u4ee5\u6709\u591a\u4e2a\u7528\u6237\uff0c\u540c\u4e00\u7528\u6237\u7ec4\u7684\u7528\u6237\u7ee7\u627f\u6539\u7ec4\u7684\u6743\u9650\n\u7528\u6237\u63cf\u8ff0\u4fe1\u606f:\u9488\u5bf9\u7528\u6237\u7684\u7b80\u4ecb\nHOME DIR\uff1a\u5bb6\u76ee\u5f55\nSHELL\uff1a\u7528\u6237\u7684\u9ed8\u8ba4shell\n\n# /etc/group\u4e2d4\u6bb5\u610f\u4e49\uff1a\u7ec4\u540d\uff1a\u5bc6\u7801\uff1aGID:\u4ee5\u6b64\u7ec4\u4e3a\u5176\u9644\u52a0\u7ec4\u7684\u7528\u6237\u5217\u8868\n\n# /etc/shadow\u4e2d8\u6bb5\u610f\u4e49\uff1a\n\u5b57\u6bb51\uff1a\u7528\u6237\u5e10\u53f7\u7684\u540d\u79f0\n\u5b57\u6bb52\uff1a\u52a0\u5bc6\u7684\u5bc6\u7801\u5b57\u4e32\u4fe1\u606f\n\u5b57\u6bb53\uff1a\u4e0a\u6b21\u4fee\u6539\u5bc6\u7801\u7684\u65f6\u95f4\uff081970/1/1\u8ddd\u4fee\u6539\u65f6\u95f4\u7684\u5929\u6570\uff09\n\u5b57\u6bb54\uff1a\u5bc6\u7801\u7684\u6700\u77ed\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a0\n\u5b57\u6bb55\uff1a\u5bc6\u7801\u7684\u6700\u957f\u6709\u6548\u5929\u6570\uff0c\u9ed8\u8ba4\u503c\u4e3a99999\n\u5b57\u6bb56\uff1a\u63d0\u524d\u591a\u5c11\u5929\u8b66\u544a\u7528\u6237\u53e3\u4ee4\u5c06\u8fc7\u671f\uff0c\u9ed8\u8ba4\u503c\u4e3a7\n\u5b57\u6bb57\uff1a\u5728\u5bc6\u7801\u8fc7\u671f\u4e4b\u540e\u591a\u5c11\u5929\u7981\u7528\u6b64\u7528\u6237\n\u5b57\u6bb58\uff1a\u5e10\u53f7\u5931\u6548\u65f6\u95f4\uff0c\u9ed8\u8ba4\u503c\u4e3a \u7a7a\n\u5b57\u6bb59\uff1a\u4fdd\u7559\u5b57\u6bb5\uff08\u672a\u4f7f\u7528)\n\n# \u4f2a\u7528\u6237\uff1a\n\u4f2a\u7528\u6237\u5c31\u662f\u7cfb\u7edf\u548c\u7a0b\u5e8f\u64cd\u4f5c\u65f6\u8c03\u7528\u7684\u7528\u6237\uff0c\u4e0e\u7cfb\u7edf\u548c\u7a0b\u5e8f\u670d\u52a1\u76f8\u5173\u3002\u4f8b\u5982\uff1abin\u3001daemon\u3001shutdown\u3001halt\u7b49\uff0c\u4efb\u4f55linux\u64cd\u4f5c\u7cfb\u7edf\u90fd\u9ed8\u8ba4\n\u6709\u8fd9\u4e9b\u4f2a\u7528\u6237\uff0c\u662f\u7cfb\u7edf\u81ea\u52a8\u751f\u6210\u7684\uff0c\u4f8b\u5982\uff1amail\u3001apache\u3001ftp\u7b49\uff0c\u4e0elinux\u7cfb\u7edf\u7684\u8fdb\u7a0b\u76f8\u5173\uff0c\u800c\u4e14\u6b64\u7c7b\u7684\u7528\u6237\u4e0d\u9700\u8981\u767b\u5f55\u6216\u8005\u662f\u65e0\u6cd5\u767b\u5f55\n\u7cfb\u7edf\u5f53\u4e2d\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6ca1\u6709\u76f8\u5e94\u7684\u5bbf\u4e3b\u76ee\u5f55\n\n# \u6269\u5c55\u77e5\u8bc6\u70b9\uff1a\n\u5173\u4e8e\u5efa\u7acb\u7528\u6237\u8bbe\u7f6e\u5bc6\u7801\u7684\u8fc7\u7a0b\u5206\u6790\uff1a\u5bc6\u7801\u5148\u5199\u5165/etc/passwd\u6587\u4ef6\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5\uff0c\u63a5\u7740\u901a\u8fc7\u6307\u4ee4\u8f6c\u5230/etc/shadow\u6587\u4ef6\u4e2d\uff0c\u8f6c\u5316\u7684\u547d\u4ee4\u662fpsconv\n\u8fc7\u7a0b\u662f\u81ea\u52a8\u5b8c\u6210\uff0c\u56de\u5199\u7684\u547d\u4ee4\u662fpwunconv\uff0c\u6267\u884c\u6b64\u547d\u4ee4\u540e\u5bc6\u7801\u4f1a\u5728/etc/passwd\u4e2d\u7684\u7b2c\u4e8c\u4e2a\u5b57\u6bb5X\u4e2d\u51fa\u73b0\u4e14\u662f\u52a0\u5bc6\u7684\uff0c\u8fd9\u4e5f\u8bf4\u660e\u4e86\u5bc6\u7801\u4f4d\u4fdd\u7559\u7684\u539f\u56e0\n\n\u767b\u9646\u4fe1\u606f\u6587\u4ef6\uff1a/etc/motd  \u767b\u5f55\u6210\u529f\u540e\u4f1a\u770b\u5230\u63d0\u793a\u4fe1\u606f\n\u4fee\u6539/etc/issue\u6587\u4ef6\u7684\u8bdd\uff0c\u662f\u5728\u767b\u5f55\u4e4b\u524d\u5c31\u53ef\u4ee5\u770b\u5230\uff1b\u4e3a\u4e86\u5b89\u5168\u8d77\u89c1\uff0c\u9632\u6b62\u770b\u5230\u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c\u4fe1\u606f\uff0c\u53ef\u4ee5\u4fee\u6539/etc/issue\u6587\u4ef6\u7684\u5185\u5bb9\u6216\u8005\u76f4\u63a5\u5220\u9664\u5373\u53ef\n/etc/issue.net\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f\u662f\u4f5c\u4e3atelnet\u670d\u52a1\u7684\u63d0\u793a\u4fe1\u606f\n\nissue \u5185\u7684\u5404\u4ee3\u7801\u610f\u4e49\u8868\u793a\u5982\u4e0b\u6240\u793a\uff1a\uff08\u7ba1\u7406\u4eba\u5458\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0\uff09\n/l \u663e\u793a\u7b2c\u51e0\u4e2a\u7ec8\u7aef\u673a\u63a5\u53e3\n/m \u663e\u793a\u786c\u4ef6\u7684\u7b49\u7ea7 (i386/i486/i586/i686...)\n/n \u663e\u793a\u4e3b\u673a\u7684\u7f51\u7edc\u540d\u79f0\n/o \u663e\u793a domain name\n/r \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c (\u76f8\u5f53\u4e8e uname -r)\n/t \u663e\u793a\u672c\u5730\u7aef\u65f6\u95f4\u7684\u65f6\u95f4\n/s \u64cd\u4f5c\u7cfb\u7edf\u7684\u540d\u79f0\n/v \u64cd\u4f5c\u7cfb\u7edf\u7684\u7248\u672c\n</code></pre>"},{"location":"system/linux/Centos/#r-w-x","title":"\u6743\u9650\uff1ar, w, x","text":"Markdown<pre><code># \u6587\u4ef6\u6743\u9650\uff1a\nr--4\uff1a\u53ef\u8bfb\nw--2\uff1a\u53ef\u5199\nx--1: \u53ef\u6267\u884c\uff0ceXacutable\n# \u76ee\u5f55\u6743\u9650\uff1a\nw: \u53ef\u4ee5\u5728\u6b64\u76ee\u5f55\u521b\u5efa\u6587\u4ef6\nr: \u53ef\u4ee5\u5bf9\u6b64\u76ee\u5f55\u6267\u884cls\u4ee5\u5217\u51fa\u5185\u90e8\u7684\u6240\u6709\u6587\u4ef6\nx: \u53ef\u4ee5\u4f7f\u7528cd\u5207\u6362\u8fdb\u6b64\u76ee\u5f55\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528ls -l\u67e5\u770b\u5185\u90e8\u6587\u4ef6\u7684\u8be6\u7ec6\u4fe1\u606f\n# \u6743\u9650\u4e09\u4f4d\u4e00\u4f53\uff1a\nrwx:\u53ef\u8bfb\u53ef\u5b66\u53ef\u6267\u884c\nr--:\u53ea\u8bfb\nr-x:\u8bfb\u548c\u6267\u884c\n---\uff1a\u65e0\u6743\u9650\n# \u516b\u8fdb\u5236\u8868\u793a\uff1a\n0 000 ---\uff1a\u65e0\u6743\u9650\n1 001 --x: \u6267\u884c\n2 010 -w-: \u5199\n3 011 -wx: \u5199\u548c\u6267\u884c\n4 100 r--: \u53ea\u8bfb\n5 101 r-x: \u8bfb\u548c\u6267\u884c\n6 110 rw-: \u8bfb\u5199\n7 111 rwx: \u8bfb\u5199\u6267\u884c\n# \u4f8b\u5982\uff1a\nrw-r-----: 640\nrw-r--r--: 644\nrw-rw----: 660\nrwxr-xr-x: 755\nrwxrwxr-x: 775\n</code></pre>"},{"location":"system/linux/Centos/#_3","title":"\u4e09\u3001\u7279\u6b8a\u6743\u9650","text":"Markdown<pre><code>\u7279\u6b8a\u6743\u9650\uff1as,s,t\n1. SUID: \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u4e3b\uff0c\u800c\u4e0d\u662f\u52a8\u8005\n\u683c\u5f0f\uff1achmod u+s FILE  \uff0cchmod u-s FILE\n\u6ce8\u610f\uff1a\u5982\u679cFILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650\uff0c\u5219SUID\u663e\u793a\u4e3as\uff1b\u5426\u5219\u663e\u793aS\n\n2. SGID: \u8fd0\u884c\u67d0\u7a0b\u5e8f\u65f6\uff0c\u76f8\u5e94\u8fdb\u7a0b\u7684\u5c5e\u7ec4\u662f\u7a0b\u5e8f\u6587\u4ef6\u81ea\u8eab\u7684\u5c5e\u7ec4\uff0c\u800c\u4e0d\u662f\u52a8\u8005\u6240\u5c5e\u7684\u57fa\u672c\u7ec4\n\u683c\u5f0f\uff1achmod g+s FILE  \uff0c chmod g-s FILE\n\u6ce8\u610f\uff1a\u5982\u679cFILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650\uff0c\u5219SUID\u663e\u793a\u4e3as\uff1b\u5426\u5219\u663e\u793aS\n\n3. Sticky bit(\u7c98\u6ede\u4f4d): \u5728\u4e00\u4e2a\u516c\u5171\u76ee\u5f55\uff0c\u6bcf\u4e2a\u90fd\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\uff0c\u5220\u9664\u81ea\u5df1\u7684\u6587\u4ef6\uff0c\u4f46\u4e0d\u80fd\u5220\u9664\u522b\u4eba\u7684\u6587\u4ef6\n                      \u5f53\u2f6c\u5f55\u88ab\u8bbe\u7f6e\u4e86\u7c98\u6ede\u4f4d\u6743\u9650\u4ee5\u540e\uff0c\u5373\u4fbf\u2f64\u6237\u5bf9\u8be5\u2f6c\u5f55\u6709\u5199\u2f0a\u6743\u9650\uff0c\u4e5f\u4e0d\u80fd\u5220\u9664\u8be5\u2f6c\u5f55\n                      \u4e2d\u5176\u4ed6\u2f64\u6237\u7684\u2f42\u4ef6\u6570\u636e\uff0c\u2f7d\u662f\u53ea\u6709\u8be5\u2f42\u4ef6\u7684\u6240\u6709\u8005\u548croot\u2f64\u6237\u624d\u6709\u6743\u5c06\u5176\u5220\u9664\n\u683c\u5f0f\uff1achmod o+t DIR  \uff0c chmod o-t DIR\n\u6ce8\u610f\uff1a\u5982\u679cFILE\u672c\u8eab\u539f\u6765\u5c31\u6709\u6267\u884c\u6743\u9650\uff0c\u5219SUID\u663e\u793a\u4e3at\uff1b\u5426\u5219\u663e\u793aT\uff1b\u7c98\u6ede\u4f4d\u6743\u9650\u662f\u9488\u5bf9\u76ee\u5f55\u7684\uff0c\u5bf9\u6587\u4ef6\u65e0\u6548\n\n4. umask\uff1a\n\u6587\u4ef6\u9ed8\u8ba4\u6743\u9650\uff1a666-umask\n\u6587\u4ef6\u5939\u9ed8\u8ba4\u6743\u9650\uff1a777-umask\n\u7279\u6b8a\u6743\u9650\u9ed8\u8ba4\u4e3a0\n\u9ed8\u8ba4umask\uff1aumask=0022\n\u66f4\u6539umask\uff1aumask 0023\n\u6ce8\u610f\uff1a\u6587\u4ef6\u9ed8\u8ba4\u4e0d\u80fd\u5177\u6709\u6267\u884c\u6743\u9650\uff0c\u5982\u679c\u7b97\u5f97\u7684\u7ed3\u679c\u4e2d\u6709\u6267\u884c\u6743\u9650\uff0c\u5219\u5c06\u6743\u9650\u52a01\n</code></pre>"},{"location":"system/linux/Centos/#_4","title":"\u7cfb\u7edf\u547d\u4ee4\u884c\u5feb\u6377\u952e","text":"Markdown<pre><code># \u8bf4\u660e\nCtrl \u2013 k      # \u5148\u6309\u4f4f Ctrl \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e\nAlt \u2013 k       # \u5148\u6309\u4f4f Alt \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e\nM \u2013 k         # \u5148\u5355\u51fb Esc \u952e\uff0c\u7136\u540e\u518d\u6309 k \u952e\n\n# \u79fb\u52a8\u5149\u6807\nCtrl - \u5de6\u53f3\u952e  # \u5728\u5355\u8bcd\u4e4b\u95f4\u8df3\u8f6c\nCtrl \u2013 a      # \u79fb\u5230\u884c\u9996\nCtrl \u2013 e      # \u79fb\u5230\u884c\u5c3e\nCtrl \u2013 xx     # \u5728\u547d\u4ee4\u884c\u5c3e\u548c\u5149\u6807\u4e4b\u95f4\u79fb\u52a8\nCtrl \u2013 b      # \u5f80\u524d(\u5de6)\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\nCtrl \u2013 f      # \u5f80\u540e(\u53f3)\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\nAlt \u2013 b       # \u5f80\u524d(\u5de6)\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd\nAlt \u2013 f       # \u5f80\u540e(\u53f3)\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd\nM-b           # \u5f80\u524d(\u5de6)\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd\nM-f           # \u5f80\u540e(\u53f3)\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd\n\n# \u7f16\u8f91\u547d\u4ee4\nCtrl \u2013 h      # \u5220\u9664\u5149\u6807\u5de6\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26\nCtrl \u2013 d      # \u5220\u9664\u5149\u6807\u53f3\u65b9\u4f4d\u7f6e\u7684\u5b57\u7b26\uff08\u6ce8\u610f\u5f53\u524d\u547d\u4ee4\u884c\u6ca1\u6709\u4efb\u4f55\u5b57\u7b26\u65f6\uff0c\u4f1a\u6ce8\u9500\u7cfb\u7edf\u6216\u7ed3\u675f\u7ec8\u7aef\uff09\nCtrl \u2013 w      # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u5de6\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u9996\u5220\nAlt \u2013 d       # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5f80\u53f3\u5220\u9664\u5355\u8bcd\u3002\u5f80\u884c\u5c3e\u5220\nM \u2013 d         # \u7531\u5149\u6807\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5355\u8bcd\uff0c\u76f4\u5230\u8be5\u5355\u8bcd\u7ed3\u675f\nCtrl \u2013 k      # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u53f3\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u7ed3\u675f\nCtrl \u2013 u      # \u7531\u5149\u6807\u6240\u5728\u4f4d\u7f6e\u5f00\u59cb\uff0c\u5220\u9664\u5de6\u65b9\u6240\u6709\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u8be5\u884c\u5f00\u59cb\nCtrl \u2013 y      # \u7c98\u8d34Ctrl+u\u6216ctrl+k\u526a\u5207\u7684\u5185\u5bb9\nctrl \u2013 t      # \u4ea4\u6362\u5149\u6807\u5904\u548c\u4e4b\u524d\u4e24\u4e2a\u5b57\u7b26\u7684\u4f4d\u7f6e\nAlt + .       # \u4f7f\u7528\u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\nCtrl \u2013 _      # \u56de\u590d\u4e4b\u524d\u7684\u72b6\u6001\u3002\u64a4\u9500\u64cd\u4f5c\nCtrl -a + Ctrl -k \u6216 Ctrl -e + Ctrl -u \u6216 Ctrl -k + Ctrl -u # \u7ec4\u5408\u53ef\u5220\u9664\u6574\u884c\n\n# \u63a7\u5236\u547d\u4ee4\nCtrl \u2013 l      # \u6e05\u9664\u5c4f\u5e55\uff0c\u7136\u540e\uff0c\u5728\u6700\u4e0a\u9762\u91cd\u65b0\u663e\u793a\u76ee\u524d\u5149\u6807\u6240\u5728\u7684\u8fd9\u4e00\u884c\u7684\u5185\u5bb9\nCtrl \u2013 o      # \u6267\u884c\u5f53\u524d\u547d\u4ee4\uff0c\u5e76\u9009\u62e9\u4e0a\u4e00\u6761\u547d\u4ee4\nCtrl \u2013 s      # \u963b\u6b62\u5c4f\u5e55\u8f93\u51fa\nCtrl \u2013 q      # \u5141\u8bb8\u5c4f\u5e55\u8f93\u51fa\nCtrl \u2013 c      # \u7ec8\u6b62\u547d\u4ee4\nCtrl \u2013 z      # \u6302\u8d77\u547d\u4ee4\n\n# Bang(!)\u547d\u4ee4\n!!            # \u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4\n^foo^bar      # \u628a\u4e0a\u4e00\u6761\u547d\u4ee4\u91cc\u7684foo\u66ff\u6362\u4e3abar\uff0c\u5e76\u6267\u884c\n!wget         # \u6267\u884c\u6700\u8fd1\u7684\u4ee5wget\u5f00\u5934\u7684\u547d\u4ee4\n!wget p       # \u4ec5\u6253\u5370\u6700\u8fd1\u7684\u4ee5wget\u5f00\u5934\u7684\u547d\u4ee4\uff0c\u4e0d\u6267\u884c\n!$            # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff0c \u4e0e Alt - . \u548c $_ \u76f8\u540c\n!*            # \u4e0a\u4e00\u6761\u547d\u4ee4\u7684\u6240\u6709\u53c2\u6570\n!* p          # \u6253\u5370\u4e0a\u4e00\u6761\u547d\u4ee4\u662f\u6240\u6709\u53c2\u6570\uff0c\u4e5f\u5373 !*\u7684\u5185\u5bb9\n^abc          # \u5220\u9664\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684abc\n^foo^bar      # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar\n^foo^bar^     # \u5c06\u4e0a\u4e00\u6761\u547d\u4ee4\u4e2d\u7684 foo \u66ff\u6362\u4e3a bar\n!-n           # \u6267\u884c\u524dn\u6761\u547d\u4ee4\uff0c\u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4      !-1\uff0c \u6267\u884c\u524d5\u6761\u547d\u4ee4\u7684\u683c\u5f0f\u662f!-5\n\n# \u67e5\u627e\u5386\u53f2\u547d\u4ee4\nCtrl \u2013 r      # \u641c\u7d22\u5386\u53f2\u547d\u4ee4\uff0c\u8f93\u5165\u540e\u663e\u793a\u5386\u53f2\u547d\u4ee4\u4e2d\u4e00\u6761\u5339\u914d\u547d\u4ee4\uff0cEnter\u952e\u6267\u884c\u5339\u914d\u547d\u4ee4\uff1bESC\u952e\u5728\u547d\u4ee4\u884c\u663e\u793a\u800c\u4e0d\u6267\u884c\u5339\u914d\u547d\u4ee4\nCtrl \u2013 g      # \u4ece\u5386\u53f2\u641c\u7d22\u6a21\u5f0f\uff08Ctrl \u2013 r\uff09\u9000\u51fa\nCtrl \u2013 p      # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0a\u4e00\u6761\u5386\u53f2\u547d\u4ee4\nCtrl \u2013 n      # \u663e\u793a\u5f53\u524d\u547d\u4ee4\u7684\u4e0b\u4e00\u6761\u5386\u53f2\u547d\u4ee4\n\n# \u91cd\u590d\u6267\u884c\u64cd\u4f5c\u52a8\u4f5c\nM \u2013 \u64cd\u4f5c\u6b21\u6570 \u64cd\u4f5c\u52a8\u4f5c   # \u6307\u5b9a\u64cd\u4f5c\u6b21\u6570\uff0c\u91cd\u590d\u6267\u884c\u6307\u5b9a\u7684\u64cd\u4f5c\n</code></pre>"},{"location":"system/linux/Centos/#ubuntu-desktop","title":"ubuntu Desktop\u76f8\u5173\u8bbe\u7f6e","text":"Bash<pre><code>xdotool mouseup 1 # \u6302\u8d77\u540e\u8fdb\u5165\u7cfb\u7edf\u8f93\u5165,\u7136\u540e\u6ce8\u9500\u91cd\u65b0\u767b\u5f55\ngsettings set com.canonical.unity.launcher launcher-position bottom # \u5c06ubuntu\u542f\u52a8\u680f\u79fb\u52a8\u5230\u6700\u4e0b\u65b9\ngsettings get com.canonical.unity.launcher launcher-position    # \u5f97\u5230\u542f\u52a8\u680f\u4f4d\u7f6e\n\n# \u8bbe\u7f6e\u4e34\u65f6\u6587\u4ef6\u4e0d\u518d\u653e\u7f6e\u5728\u786c\u76d8\u52a0\u5feb\u901f\u5ea6\uff0c\u800c\u653e\u5728\u865a\u62dfRAM\u78c1\u76d8\u4e0a\u3002\u603b\u5185\u5b58\u5fc5\u987b\u5927\u4e8e4G\ncp -v /usr/share/systemd/tmp.mount /etc/systemd/system/\nsystemctl enable tmp.mount\nsystemctl reload tmp.mount # \u4e0d\u751f\u6548\u53ef\u91cd\u542f\u8ba1\u7b97\u673a\u3002systemctl status tmp.mount\u68c0\u67e5\u72b6\u6001\n# \u53d6\u6d88tmpfs,\u5220\u9664\u540e\u91cd\u542f\u751f\u6548\nrm -v /etc/systemd/system/tmp.mount\n\n: &lt;&lt; comment\n# \u51cf\u5c11\u6587\u4ef6\u5199\u5165(\u5f53\u7528\u4e8e\u975e\u670d\u52a1\u5668\u65f6)\u5728/etc/fstab\u5199\u5165\u4ee5\u4e0b\u5185\u5bb9\uff1a\ntmpfs    /tmp        tmpfs    defaults    0  0\ntmpfs    /var/tmp    tmpfs    defaults    0  0\ntmpfs    /var/log    tmpfs    defaults    0  0\ncomment\n\n# \u81ea\u5b9a\u4e49terminal\u4f4d\u7f6e\u548c\u5927\u5c0f\ncp /usr/share/applications/gnome-terminal.desktop ~/.local/share/applications\nsed -i 's/^Exec=gnome-terminal$/&amp; --geometry=80x24+100+100/' ~/.local/share/applications/gnome-terminal.desktop\ngsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal --geometry=80x24+100+100'\n# \u5220\u9664\u81ea\u5b9a\u4e49\nrm ~/.local/share/applications/gnome-terminal.desktop\ngsettings set org.gnome.desktop.default-applications.terminal exec 'gnome-terminal'\n</code></pre>"},{"location":"system/linux/Centos/#bash","title":"BASH\u73af\u5883\u53d8\u91cf\u7684\u8bbe\u7f6e\u65b9\u6cd5","text":"Bash<pre><code># \u65b9\u6cd5\u4e00\uff1a\u4fee\u6539\u7528\u6237\u4e3b\u76ee\u5f55\u4e0b\u7684.profile\u6216.bashrc\u6587\u4ef6(\u63a8\u8350)\uff0c\u5728\u6587\u4ef6\u672b\u5c3e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u53ea\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548\nexport PATH=\"$PATH:your path1:your path2\"\n\n# \u65b9\u6cd5\u4e8c\uff1a\u4fee\u6539\u7f16\u8f91\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684profile\u6587\u4ef6(\u8c28\u614e)\uff1a\u5728\u6700\u540e\u52a0\u5165PATH\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a\u8be5\u65b9\u5f0f\u6dfb\u52a0\u7684\u53d8\u91cf\u5bf9\u6240\u6709\u7684\u7528\u6237\u90fd\u6709\u6548\nexport PATH=\"$PATH:your path1:your path2\"\n\n# \u65b9\u6cd5\u4e09\uff1a\u4fee\u6539\u7cfb\u7edf\u76ee\u5f55\u4e0b\u7684 environment \u6587\u4ef6\u7684PATH\u53d8\u91cf(\u8c28\u614e),\u5404\u4e2apath\u4e4b\u95f4\u5192\u53f7\u5206\u5272\uff0c\u5f71\u54cd\u6240\u6709\u7528\u6237\n\n# \u65b9\u6cd5\u56db\uff1a\u76f4\u63a5\u5728\u7ec8\u7aef\u4e0b\u8f93\u5165,\u8fd9\u79cd\u65b9\u5f0f\u53d8\u91cf\u7acb\u5373\u751f\u6548\uff0c\u4f46\u7528\u6237\u6ce8\u9500\u6216\u7cfb\u7edf\u91cd\u542f\u540e\u8bbe\u7f6e\u53d8\u6210\u65e0\u6548\uff0c\u9002\u5408\u4e34\u65f6\u53d8\u91cf\u7684\u8bbe\u7f6e\nexport PATH=\"$PATH:your path1:your path2\"\n\n# \u4fdd\u5b58\u540e\u6267\u884csource\u547d\u4ee4\u751f\u6548\n</code></pre>"},{"location":"system/linux/Centos/#linuxjava","title":"Linux\u5b89\u88c5\u8bbe\u7f6ejava\u73af\u5883","text":"Markdown<pre><code># \u5728CentOS7\u5b89\u88c5Oracle Java JDK8\nrpm -qa | grep -E '^open[jre|jdk]|j[re|dk]'    # \u67e5\u627e\u5df2\u5b89\u88c5\u7684jdk\u7ec4\u4ef6\nyum remove java-$Version   # \u5378\u8f7d\u4e4b\u524d\u5df2\u5b89\u88c5\u7684jdk\n# \u5728/usr\u76ee\u5f55\u521b\u5efajava\u6587\u4ef6\u5939\uff0c\u4e0b\u8f7djdk\u5305http://www.oracle.com/technetwork/java/javase/downloads/index.html\nmkdir /usr/java\nwget http://download.oracle.com/otn-pub/java/jdk/8u161-b12/...tar.gz\ntar -zxvf jdk..\n# \u7f16\u8f91.bashrc\u6587\u4ef6\uff0c\u5728export PATH USER LOGNAME MAIL HOSTNAME HISTSIZE HISTCONTROL\u4e0b\u9762\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a\nexport JAVA_HOME=/usr/java/jdk-$version\nexport PATH=$JAVA_HOME/bin:$PATH\n# \u914d\u7f6e\u751f\u6548\u5e76\u9a8c\u8bc1\nsource .bashrc &amp;&amp; java -version\n</code></pre>"},{"location":"system/linux/Centos/#ssh","title":"SSH\u76f8\u5173\u547d\u4ee4\u548c\u914d\u7f6e","text":""},{"location":"system/linux/Centos/#ssh_1","title":"ssh\u57fa\u672c\u52a0\u56fa\u5efa\u8bae","text":"Markdown<pre><code>\u4f7f\u7528\u975e\u5bc6\u7801\u767b\u9646\u65b9\u5f0f\u5982\u5bc6\u94a5\u5bf9\uff0c\u8bf7\u5ffd\u7565\u6b64\u9879\u3002\u5728 /etc/login.defs \u4e2d\u5c06 PASS_MAX_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a 60-180\u4e4b\u95f4\n\u5982 PASS_MAX_DAYS 90\u3002\u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4\u8bbe\u7f6eroot\u5bc6\u7801\u5931\u6548\u65f6\u95f4\uff1a chage --maxdays 90 root\n\n\u5728 /etc/login.defs \u4e2d\u5c06 PASS_MIN_DAYS \u53c2\u6570\u8bbe\u7f6e\u4e3a7-14\u4e4b\u95f4,\u5efa\u8bae\u4e3a7\uff1a PASS_MIN_DAYS 7 \u9700\u540c\u65f6\u6267\u884c\u547d\u4ee4\n\u4e3aroot\u7528\u6237\u8bbe\u7f6e\uff1a chage --mindays 7 root\n\n\u7f16\u8f91/etc/security/pwquality.conf\uff0c\u628aminlen\uff08\u5bc6\u7801\u6700\u5c0f\u957f\u5ea6\uff09\u8bbe\u7f6e\u4e3a9-32\u4f4d\uff0c\u628aminclass\uff08\u81f3\u5c11\u5305\u542b\u5c0f\u5199\u5b57\u6bcd\u3001\n\u5927\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7279\u6b8a\u5b57\u7b26\u7b494\u7c7b\u5b57\u7b26\u4e2d\u7b493\u7c7b\u62164\u7c7b\uff09\u8bbe\u7f6e\u4e3a3\u62164\u3002\u5982\uff1a minlen=10 minclass=3\n</code></pre>"},{"location":"system/linux/Centos/#sedssh","title":"sed\u547d\u4ee4\u66f4\u6539\u9ed8\u8ba4ssh\u8fde\u63a5\u7aef\u53e3","text":"Bash<pre><code>iptables -I INPUT -p tcp --dport 22 -j ACCEPT # iptables\u5f00\u653e22\u7aef\u53e3\nsed -i \"/A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT/d\" /etc/sysconfig/iptables\niptables save\nservice iptables restart\n\nsed -i 's/#Port 22/Port 2121/' /etc/ssh/sshd_config     # \u4fee\u6539sshd_config\u6587\u4ef6\uff0c\u5c06#Port 22\u76f4\u63a5\u66ff\u6362\u6210Port 2121\nsed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config   # \u5141\u8bb8root\u7528\u6237\u8fdc\u7a0bssh\u767b\u5f55\nsed -i 's/PasswordAuthentication no/PasswordAuthentication yes/g' /etc/ssh/sshd_config # \u5141\u8bb8\u4f7f\u7528\u5bc6\u7801\u8fde\u63a5ssh\u670d\u52a1\n</code></pre>"},{"location":"system/linux/Centos/#sshd_configetcsshsshd_config","title":"sshd_config\u914d\u7f6e\u8be6\u89e3\uff08/etc/ssh/sshd_config\uff09","text":"Markdown<pre><code># The strategy used for options in the default sshd_config shipped with\n# OpenSSH is to specify options with their default value where\n# possible, but leave them commented.  Uncommented options override the\n# default value\n\n#\n# AddressFamily\u6307\u5b9asshd\u5e94\u5f53\u4f7f\u7528\u54ea\u79cd\u5730\u5740\u65cf\u3002\u53d6\u503c\u8303\u56f4\u662f\uff1a\"any\"(\u9ed8\u8ba4)\u3001\"inet\"(\u4ec5IPv4)\u3001\"inet6\"(\u4ec5IPv6)\n#AddressFamily any\n\n# \u6307\u5b9asshd\u76d1\u542c\u7684\u7f51\u7edc\u5730\u5740\uff0c\u9ed8\u8ba4\u76d1\u542c\u6240\u6709\u5730\u5740\u3002\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u683c\u5f0f\uff1a\n# ListenAddress host|IPv4_addr|IPv6_addr\n# ListenAddress host|IPv4_addr:port\n# ListenAddress [host|IPv6_addr]:port\n# \u5982\u679c\u672a\u6307\u5b9a port \uff0c\u90a3\u4e48\u5c06\u4f7f\u7528 Port \u6307\u4ee4\u7684\u503c\n# \u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a ListenAddress \u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u5730\u5740\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n\n# HostKey\n# \u4e3b\u673a\u79c1\u94a5\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u6743\u9650\u4e0d\u5bf9\uff0csshd\u53ef\u80fd\u4f1a\u62d2\u7edd\u542f\u52a8\n# SSH-1\u9ed8\u8ba4\u662f /etc/ssh/ssh_host_key\n# SSH-2\u9ed8\u8ba4\u662f /etc/ssh/ssh_host_rsa_key \u548c /etc/ssh/ssh_host_dsa_key\n# \u4e00\u53f0\u4e3b\u673a\u53ef\u4ee5\u62e5\u6709\u591a\u4e2a\u4e0d\u540c\u7684\u79c1\u94a5\u3002\"rsa1\"\u4ec5\u7528\u4e8eSSH-1\uff0c\"dsa\"\u548c\"rsa\"\u4ec5\u7528\u4e8eSSH-2\n#HostKey /etc/ssh/ssh_host_rsa_key\n#HostKey /etc/ssh/ssh_host_ecdsa_key\n#HostKey /etc/ssh/ssh_host_ed25519_key\n\n# \u6307\u5b9aSSH-2\u5141\u8bb8\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002\u591a\u4e2a\u7b97\u6cd5\u4e4b\u95f4\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u53ef\u4ee5\u4f7f\u7528\u7684\u7b97\u6cd5\u5982\u4e0b\uff1a\n# \"aes128-cbc\", \"aes192-cbc\", \"aes256-cbc\", \"aes128-ctr\", \"aes192-ctr\", \"aes256-ctr\",\n# \"3des-cbc\", \"arcfour128\", \"arcfour256\", \"arcfour\", \"blowfish-cbc\", \"cast128-cbc\"\n# \u9ed8\u8ba4\u503c\u662f\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u6240\u6709\u7b97\u6cd5\n# Ciphers and keying\n#RekeyLimit default none\n\n# \u6307\u5b9asshd\u5c06\u65e5\u5fd7\u6d88\u606f\u901a\u8fc7\u54ea\u4e2a\u65e5\u5fd7\u5b50\u7cfb\u7edf(facility)\u53d1\u9001\u3002\u6709\u6548\u503c\u662f\uff1aDAEMON, USER, AUTH(\u9ed8\u8ba4), LOCAL0, LOCAL1, LOCAL2, LOCAL3,\n# LOCAL4, LOCAL5, LOCAL6, LOCAL7\n# Logging\n#SyslogFacility AUTH\n\n# \u6307\u5b9a sshd(8) \u7684\u65e5\u5fd7\u7b49\u7ea7(\u8be6\u7ec6\u7a0b\u5ea6)\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a\n# QUIET, FATAL, ERROR, INFO(\u9ed8\u8ba4), VERBOSE, DEBUG, DEBUG1, DEBUG2, DEBUG3\n# DEBUG \u4e0e DEBUG1 \u7b49\u4ef7\uff1bDEBUG2 \u548c DEBUG3 \u5219\u5206\u522b\u6307\u5b9a\u4e86\u66f4\u8be6\u7ec6\u3001\u66f4\u7f57\u55e6\u7684\u65e5\u5fd7\u8f93\u51fa\n# \u6bd4 DEBUG \u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\u53ef\u80fd\u4f1a\u6cc4\u6f0f\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f\uff0c\u56e0\u6b64\u53cd\u5bf9\u4f7f\u7528\n#LogLevel INFO\n\n# Authentication:\n\n# \u9650\u5236\u7528\u6237\u5fc5\u987b\u5728\u6307\u5b9a\u7684\u65f6\u9650\u5185\u8ba4\u8bc1\u6210\u529f\uff0c0 \u8868\u793a\u65e0\u9650\u5236\u3002\u9ed8\u8ba4\u503c\u662f 120 \u79d2\n#LoginGraceTime 2m\n\n# \u662f\u5426\u5141\u8bb8 root \u767b\u5f55\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a\n# \"yes\"(\u9ed8\u8ba4) \u8868\u793a\u5141\u8bb8\u3002\"no\"\u8868\u793a\u7981\u6b62\n# \"without-password\"\u8868\u793a\u7981\u6b62\u4f7f\u7528\u5bc6\u7801\u8ba4\u8bc1\u767b\u5f55\n# \"forced-commands-only\"\u8868\u793a\u53ea\u6709\u5728\u6307\u5b9a\u4e86command\u9009\u9879\u65f6\u624d\u5141\u8bb8\u4f7f\u7528\u516c\u94a5\u8ba4\u8bc1\u767b\u5f55\u3002\u540c\u65f6\u5176\u5b83\u8ba4\u8bc1\u65b9\u6cd5\u5168\u90e8\u88ab\u7981\u6b62\u3002\u8be5\u503c\u5e38\u7528\u4e8e\u505a\u8fdc\u7a0b\u5907\u4efd\u4e4b\u7c7b\u7684\u4e8b\u60c5\n#PermitRootLogin prohibit-password\n\n# \u6307\u5b9a\u662f\u5426\u8981\u6c42sshd\u5728\u63a5\u53d7\u8fde\u63a5\u8bf7\u6c42\u524d\u5bf9\u7528\u6237\u4e3b\u76ee\u5f55\u548c\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u5bbf\u4e3b\u548c\u6743\u9650\u68c0\u67e5\u3002\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c\"yes\"\u6765\u9884\u9632\u53ef\u80fd\u51fa\u73b0\u7684\u4f4e\u7ea7\u9519\u8bef\n#StrictModes yes\n\n# \u6307\u5b9a\u6bcf\u4e2a\u8fde\u63a5\u6700\u5927\u5141\u8bb8\u7684\u8ba4\u8bc1\u6b21\u6570\u3002\u9ed8\u8ba4\u503c\u662f 6\n# \u5982\u679c\u5931\u8d25\u8ba4\u8bc1\u7684\u6b21\u6570\u8d85\u8fc7\u8fd9\u4e2a\u6570\u503c\u7684\u4e00\u534a\uff0c\u8fde\u63a5\u5c06\u88ab\u5f3a\u5236\u65ad\u5f00\uff0c\u4e14\u4f1a\u751f\u6210\u989d\u5916\u7684\u5931\u8d25\u65e5\u5fd7\u6d88\u606f\n#MaxAuthTries 6\n\n#MaxSessions 10\n\n# \u662f\u5426\u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\u3002\u4ec5\u53ef\u4ee5\u7528\u4e8eSSH-2\u3002\u9ed8\u8ba4\u503c\u4e3a\"yes\"\n#PubkeyAuthentication yes\n\n######################################################################################################################\n\n# \u5b58\u653e\u8be5\u7528\u6237\u53ef\u4ee5\u7528\u6765\u767b\u5f55\u7684 RSA/DSA \u516c\u94a5\n# \u8be5\u6307\u4ee4\u4e2d\u53ef\u4ee5\u4f7f\u7528\u4e0b\u5217\u6839\u636e\u8fde\u63a5\u65f6\u7684\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u5c55\u5f00\u7684\u7b26\u53f7\uff1a\n# %% \u8868\u793a'%'\u3001%h \u8868\u793a\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3001%u \u8868\u793a\u8be5\u7528\u6237\u7684\u7528\u6237\u540d\n# \u7ecf\u8fc7\u6269\u5c55\u4e4b\u540e\u7684\u503c\u5fc5\u987b\u8981\u4e48\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u8981\u4e48\u662f\u76f8\u5bf9\u4e8e\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\n# \u9ed8\u8ba4\u503c\u662f\".ssh/authorized_keys\"\n# Expect .ssh/authorized_keys2 to be disregarded by default in future\n#AuthorizedKeysFile .ssh/authorized_keys .ssh/authorized_keys2\n\n######################################################################################################################\n\n#AuthorizedPrincipalsFile none\n\n#AuthorizedKeysCommand none\n#AuthorizedKeysCommandUser nobody\n\n# \u662f\u5426\u4f7f\u7528\u5f3a\u53ef\u4fe1\u4e3b\u673a\u8ba4\u8bc1(\u901a\u8fc7\u68c0\u67e5\u8fdc\u7a0b\u4e3b\u673a\u540d\u548c\u5173\u8054\u7684\u7528\u6237\u540d\u8fdb\u884c\u8ba4\u8bc1)\u3002\u4ec5\u7528\u4e8eSSH-1\n# \u8fd9\u662f\u901a\u8fc7\u5728RSA\u8ba4\u8bc1\u6210\u529f\u540e\u518d\u68c0\u67e5 ~/.rhosts \u6216 /etc/hosts.equiv \u8fdb\u884c\u8ba4\u8bc1\u7684\n# \u51fa\u4e8e\u5b89\u5168\u8003\u8651\uff0c\u5efa\u8bae\u4f7f\u7528\u9ed8\u8ba4\u503c\"no\"\n#RhostsRSAAuthentication\n\n# \u8fd9\u4e2a\u6307\u4ee4\u4e0e RhostsRSAAuthentication \u7c7b\u4f3c\uff0c\u4f46\u662f\u4ec5\u53ef\u4ee5\u7528\u4e8eSSH-2\u3002\u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c\"no\"\n# \u63a8\u8350\u4f7f\u7528\u9ed8\u8ba4\u503c\"no\"\u7981\u6b62\u8fd9\u79cd\u4e0d\u5b89\u5168\u7684\u8ba4\u8bc1\u65b9\u5f0f\n# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts\n#HostbasedAuthentication no\n\n#HostbasedUsesNameFromPacketOnly\n# \u5728\u5f00\u542f HostbasedAuthentication \u7684\u60c5\u51b5\u4e0b\n# \u6307\u5b9a\u670d\u52a1\u5668\u5728\u4f7f\u7528 ~/.shosts ~/.rhosts /etc/hosts.equiv \u8fdb\u884c\u8fdc\u7a0b\u4e3b\u673a\u540d\u5339\u914d\u65f6\uff0c\u662f\u5426\u8fdb\u884c\u53cd\u5411\u57df\u540d\u67e5\u8be2\n# \"yes\"\u8868\u793asshd\u4fe1\u4efb\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4e3b\u673a\u540d\u800c\u4e0d\u8fdb\u884c\u53cd\u5411\u67e5\u8be2\u3002\u9ed8\u8ba4\u503c\u662f\"no\"\n\n# \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565\u7528\u6237\u7684 ~/.ssh/known_hosts \u6587\u4ef6\n# \u9ed8\u8ba4\u503c\u662f\"no\"\u3002\u4e3a\u4e86\u63d0\u9ad8\u5b89\u5168\u6027\uff0c\u53ef\u4ee5\u8bbe\u4e3a\"yes\"\n# Change to yes if you don't trust ~/.ssh/known_hosts for\n# HostbasedAuthentication\n#IgnoreUserKnownHosts no\n\n# \u662f\u5426\u5728 RhostsRSAAuthentication \u6216 HostbasedAuthentication \u8fc7\u7a0b\u4e2d\u5ffd\u7565 .rhosts \u548c .shosts \u6587\u4ef6\n# \u4e0d\u8fc7 /etc/hosts.equiv \u548c /etc/shosts.equiv \u4ecd\u5c06\u88ab\u4f7f\u7528\u3002\u63a8\u8350\u8bbe\u4e3a\u9ed8\u8ba4\u503c\"yes\"\n# Don't read the user's ~/.rhosts and ~/.shosts files\n#IgnoreRhosts yes\n\n\n# To disable tunneled clear text passwords, change to no here!\n\n# \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e\u5bc6\u7801\u7684\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u4e3a\"yes\"\n#PasswordAuthentication yes\n\n# \u662f\u5426\u5141\u8bb8\u5bc6\u7801\u4e3a\u7a7a\u7684\u7528\u6237\u8fdc\u7a0b\u767b\u5f55\u3002\u9ed8\u8ba4\u4e3a\"no\"\n#PermitEmptyPasswords no\n\n# \u662f\u5426\u5141\u8bb8\u8d28\u7591-\u5e94\u7b54(challenge-response)\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\n# \u6240\u6709 login.conf(5) \u4e2d\u5141\u8bb8\u7684\u8ba4\u8bc1\u65b9\u5f0f\u90fd\u88ab\u652f\u6301\n# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication no\n\n# Kerberos options\n\n# \u662f\u5426\u8981\u6c42\u7528\u6237\u4e3a PasswordAuthentication \u63d0\u4f9b\u7684\u5bc6\u7801\u5fc5\u987b\u901a\u8fc7 Kerberos KDC \u8ba4\u8bc1\uff0c\u4e5f\u5c31\u662f\u662f\u5426\u4f7f\u7528Kerberos\u8ba4\u8bc1\n# \u8981\u4f7f\u7528Kerberos\u8ba4\u8bc1\uff0c\u670d\u52a1\u5668\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u6821\u9a8c KDC identity \u7684 Kerberos servtab \u3002\u9ed8\u8ba4\u503c\u662f\"no\"\n#KerberosAuthentication no\n\n# \u5982\u679c Kerberos \u5bc6\u7801\u8ba4\u8bc1\u5931\u8d25\uff0c\u90a3\u4e48\u8be5\u5bc6\u7801\u8fd8\u5c06\u8981\u901a\u8fc7\u5176\u5b83\u7684\u8ba4\u8bc1\u673a\u5236(\u6bd4\u5982 /etc/passwd)\n# \u9ed8\u8ba4\u503c\u4e3a\"yes\"\n#KerberosOrLocalPasswd yes\n\n# \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u7684 ticket \u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\n#KerberosTicketCleanup yes\n\n# \u5982\u679c\u4f7f\u7528\u4e86 AFS \u5e76\u4e14\u8be5\u7528\u6237\u6709\u4e00\u4e2a Kerberos 5 TGT\uff0c\u90a3\u4e48\u5f00\u542f\u8be5\u6307\u4ee4\u540e\n# \u5c06\u4f1a\u5728\u8bbf\u95ee\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u524d\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a AFS token \u3002\u9ed8\u8ba4\u4e3a\"no\"\n#KerberosGetAFSToken no\n\n# GSSAPI options\n\n# \u662f\u5426\u5141\u8bb8\u4f7f\u7528\u57fa\u4e8e GSSAPI \u7684\u7528\u6237\u8ba4\u8bc1\u3002\u9ed8\u8ba4\u503c\u4e3a\"no\"\u3002\u4ec5\u7528\u4e8eSSH-2\n#GSSAPIAuthentication no\n\n# \u662f\u5426\u5728\u7528\u6237\u9000\u51fa\u767b\u5f55\u540e\u81ea\u52a8\u9500\u6bc1\u7528\u6237\u51ed\u8bc1\u7f13\u5b58\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\u3002\u4ec5\u7528\u4e8eSSH-2\n#GSSAPICleanupCredentials yes\n\n\n#GSSAPIStrictAcceptorCheck yes\n#GSSAPIKeyExchange no\n\n# Set this to 'yes' to enable PAM authentication, account processing,\n# and session processing. If this is enabled, PAM authentication will\n# be allowed through the ChallengeResponseAuthentication and\n# PasswordAuthentication.  Depending on your PAM configuration,\n# PAM authentication via ChallengeResponseAuthentication may bypass\n# the setting of \"PermitRootLogin without-password\"\n# If you just want the PAM account and session checks to run without\n# PAM authentication, then enable this but set PasswordAuthentication\n# and ChallengeResponseAuthentication to 'no'\nUsePAM yes\n\n#AllowAgentForwarding yes\n\n# \u662f\u5426\u5141\u8bb8TCP\u8f6c\u53d1\uff0c\u9ed8\u8ba4\u503c\u4e3a\"yes\"\n# \u7981\u6b62TCP\u8f6c\u53d1\u5e76\u4e0d\u80fd\u589e\u5f3a\u5b89\u5168\u6027\uff0c\u9664\u975e\u7981\u6b62\u4e86\u7528\u6237\u5bf9shell\u7684\u8bbf\u95ee\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668\nAllowTcpForwarding yes\n\n######################################################################################################################\n\n# \u662f\u5426\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u672c\u5730\u7684\u8f6c\u53d1\u7aef\u53e3\u3002\u9ed8\u8ba4\u503c\u662f\"no\"\n# sshd(8) \u9ed8\u8ba4\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230loopback\u5730\u5740\u3002\u8fd9\u6837\u5c06\u963b\u6b62\u5176\u5b83\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230\u8f6c\u53d1\u7aef\u53e3\n# GatewayPorts \u6307\u4ee4\u53ef\u4ee5\u8ba9 sshd \u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u975eloopback\u5730\u5740\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u4e86\n# \"no\"\u8868\u793a\u4ec5\u5141\u8bb8\u672c\u5730\u8fde\u63a5\uff0c\"yes\"\u8868\u793a\u5f3a\u5236\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u7edf\u914d\u5730\u5740(wildcard address)\n# \"clientspecified\"\u8868\u793a\u5141\u8bb8\u5ba2\u6237\u7aef\u9009\u62e9\u5c06\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u5230\u54ea\u4e2a\u5730\u5740\nGatewayPorts yes\n\n######################################################################################################################\n\n# \u662f\u5426\u5141\u8bb8\u8fdb\u884c X11 \u8f6c\u53d1\u3002\u9ed8\u8ba4\u503c\u662f\"no\"\uff0c\u8bbe\u4e3a\"yes\"\u8868\u793a\u5141\u8bb8\n# \u5982\u679c\u5141\u8bb8X11\u8f6c\u53d1\u5e76\u4e14sshd(8)\u4ee3\u7406\u7684\u663e\u793a\u533a\u88ab\u914d\u7f6e\u4e3a\u5728\u542b\u6709\u901a\u914d\u7b26\u7684\u5730\u5740(X11UseLocalhost)\u4e0a\u76d1\u542c\n# \u90a3\u4e48\u5c06\u53ef\u80fd\u6709\u989d\u5916\u7684\u4fe1\u606f\u88ab\u6cc4\u6f0f\u3002\u7531\u4e8e\u4f7f\u7528X11\u8f6c\u53d1\u7684\u53ef\u80fd\u5e26\u6765\u7684\u98ce\u9669\uff0c\u6b64\u6307\u4ee4\u9ed8\u8ba4\u503c\u4e3a\"no\"\n# \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7981\u6b62X11\u8f6c\u53d1\u5e76\u4e0d\u80fd\u7981\u6b62\u7528\u6237\u8f6c\u53d1X11\u901a\u4fe1\uff0c\u56e0\u4e3a\u7528\u6237\u53ef\u4ee5\u5b89\u88c5\u4ed6\u4eec\u81ea\u5df1\u7684\u8f6c\u53d1\u5668\n# \u5982\u679c\u542f\u7528\u4e86 UseLogin \uff0c\u90a3\u4e48X11\u8f6c\u53d1\u5c06\u88ab\u81ea\u52a8\u7981\u6b62\nX11Forwarding yes\n\n# \u6307\u5b9asshdX11 \u8f6c\u53d1\u7684\u7b2c\u4e00\u4e2a\u53ef\u7528\u7684\u663e\u793a\u533a(display)\u6570\u5b57\u3002\u9ed8\u8ba4\u503c\u662f 10\n# \u8fd9\u4e2a\u53ef\u4ee5\u7528\u4e8e\u9632\u6b62 sshd \u5360\u7528\u4e86\u771f\u5b9e\u7684 X11 \u670d\u52a1\u5668\u663e\u793a\u533a\uff0c\u4ece\u800c\u53d1\u751f\u6df7\u6dc6\n#X11DisplayOffset 10\n\n# sshd\u662f\u5426\u5e94\u5f53\u5c06X11\u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730loopback\u5730\u5740\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\n# sshd \u9ed8\u8ba4\u5c06\u8f6c\u53d1\u670d\u52a1\u5668\u7ed1\u5b9a\u5230\u672c\u5730loopback\u5730\u5740\u5e76\u5c06 DISPLAY \u73af\u5883\u53d8\u91cf\u7684\u4e3b\u673a\u540d\u90e8\u5206\u8bbe\u4e3a\"localhost\"\n# \u8fd9\u53ef\u4ee5\u9632\u6b62\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u5230 proxy display \u3002\u4e0d\u8fc7\u67d0\u4e9b\u8001\u65e7\u7684X11\u5ba2\u6237\u7aef\u4e0d\u80fd\u5728\u6b64\u914d\u7f6e\u4e0b\u6b63\u5e38\u5de5\u4f5c\n# \u4e3a\u4e86\u517c\u5bb9\u8fd9\u4e9b\u8001\u65e7\u7684X11\u5ba2\u6237\u7aef\uff0c\u4f60\u53ef\u4ee5\u8bbe\u4e3a\"no\"\n#X11UseLocalhost yes\n#PermitTTY yes\n\n# \u6307\u5b9asshd\u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370 /etc/motd \u6587\u4ef6\u7684\u5185\u5bb9\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\nPrintMotd no\n\n# \u6307\u5b9asshd\u662f\u5426\u5728\u6bcf\u4e00\u6b21\u4ea4\u4e92\u5f0f\u767b\u5f55\u65f6\u6253\u5370\u6700\u540e\u4e00\u4f4d\u7528\u6237\u7684\u767b\u5f55\u65f6\u95f4\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\n#PrintLastLog yes\n\n# \u6307\u5b9a\u7cfb\u7edf\u662f\u5426\u5411\u5ba2\u6237\u7aef\u53d1\u9001TCPkeepalive\u6d88\u606f\u3002\u9ed8\u8ba4\"yes\"\u3002\u6d88\u606f\u53ef\u4ee5\u68c0\u6d4b\u5230\u6b7b\u8fde\u63a5\u3001\u8fde\u63a5\u4e0d\u5f53\u5173\u95ed\u3001\u5ba2\u6237\u7aef\u5d29\u6e83\u7b49\u5f02\u5e38\u3002\u53ef\u4ee5\u8bbe\u4e3a\"no\"\u5173\u95ed\u8fd9\u4e2a\u7279\u6027\n#TCPKeepAlive yes\n\n# \u662f\u5426\u5728\u4ea4\u4e92\u5f0f\u4f1a\u8bdd\u7684\u767b\u5f55\u8fc7\u7a0b\u4e2d\u4f7f\u7528 login(1) \u3002\u9ed8\u8ba4\u503c\u662f\"no\"\n# \u5982\u679c\u5f00\u542f\u6b64\u6307\u4ee4\uff0c\u90a3\u4e48 X11Forwarding \u5c06\u4f1a\u88ab\u7981\u6b62\uff0c\u56e0\u4e3a login(1) \u4e0d\u77e5\u9053\u5982\u4f55\u5904\u7406 xauth(1) cookies\n# \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0clogin(1) \u662f\u7981\u6b62\u7528\u4e8e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u7684\n# \u5982\u679c\u6307\u5b9a\u4e86 UsePrivilegeSeparation \uff0c\u90a3\u4e48\u5b83\u5c06\u5728\u8ba4\u8bc1\u5b8c\u6210\u540e\u88ab\u7981\u7528\n#UseLogin no\n\n# \u662f\u5426\u8ba9sshd\u901a\u8fc7\u521b\u5efa\u975e\u7279\u6743\u5b50\u8fdb\u7a0b\u5904\u7406\u63a5\u5165\u8bf7\u6c42\u7684\u65b9\u6cd5\u6765\u8fdb\u884c\u6743\u9650\u5206\u79bb\u3002\u9ed8\u8ba4\u503c\u662f\"yes\"\n# \u8ba4\u8bc1\u6210\u529f\u540e\uff0c\u5c06\u4ee5\u8be5\u8ba4\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u521b\u5efa\u53e6\u4e00\u4e2a\u5b50\u8fdb\u7a0b,\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u901a\u8fc7\u6709\u7f3a\u9677\u7684\u5b50\u8fdb\u7a0b\u63d0\u5347\u6743\u9650\uff0c\u4ece\u800c\u4f7f\u7cfb\u7edf\u66f4\u52a0\u5b89\u5168\n#UsePrivilegeSeparation sandbox\n\n# \u6307\u5b9a\u662f\u5426\u5141\u8bb8 sshd(8) \u5904\u7406 ~/.ssh/environment \u4ee5\u53ca ~/.ssh/authorized_keys \u4e2d\u7684 environment= \u9009\u9879\n# \u9ed8\u8ba4\u503c\u662f\"no\"\u3002\u5982\u679c\u8bbe\u4e3a\"yes\"\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7528\u6237\u6709\u673a\u4f1a\u4f7f\u7528\u67d0\u4e9b\u673a\u5236(\u6bd4\u5982 LD_PRELOAD)\u7ed5\u8fc7\u8bbf\u95ee\u63a7\u5236\uff0c\u9020\u6210\u5b89\u5168\u6f0f\u6d1e\n#PermitUserEnvironment no\n\n# \u662f\u5426\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29\uff0c\u8fd8\u662f\u5ef6\u8fdf\u5230\u8ba4\u8bc1\u6210\u529f\u4e4b\u540e\u518d\u5bf9\u901a\u4fe1\u6570\u636e\u8fdb\u884c\u538b\u7f29\n# \u53ef\u7528\u503c\uff1a\"yes\", \"delayed\"(\u9ed8\u8ba4), \"no\"\n#Compression delayed\n\n######################################################################################################################\n\n# \u8bbe\u7f6e\u4e00\u4e2a\u4ee5\u79d2\u8bb0\u7684\u65f6\u957f\uff0c\u5982\u679c\u8d85\u8fc7\u8fd9\u4e48\u957f\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u4efb\u4f55\u6570\u636e\n# sshd(8) \u5c06\u901a\u8fc7\u5b89\u5168\u901a\u9053\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a\"alive\"\u6d88\u606f\uff0c\u5e76\u7b49\u5019\u5e94\u7b54\n# \u9ed8\u8ba4\u503c 0 \u8868\u793a\u4e0d\u53d1\u9001\"alive\"\u6d88\u606f\u3002\u8fd9\u4e2a\u9009\u9879\u4ec5\u5bf9SSH-2\u6709\u6548\n#ClientAliveInterval 0\n\n######################################################################################################################\n\n# sshd\u5728\u672a\u6536\u5230\u4efb\u4f55\u5ba2\u6237\u7aef\u56de\u5e94\u524d\u6700\u591a\u5141\u8bb8\u53d1\u9001\u591a\u5c11\u4e2a\"alive\"\u6d88\u606f\u3002\u9ed8\u8ba4\u503c\u662f 3\n# \u5230\u8fbe\u8fd9\u4e2a\u4e0a\u9650\u540e\uff0csshd(8) \u5c06\u5f3a\u5236\u65ad\u5f00\u8fde\u63a5\u3001\u5173\u95ed\u4f1a\u8bdd\n# \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\"alive\"\u6d88\u606f\u4e0e TCPKeepAlive \u6709\u5f88\u5927\u5dee\u5f02\n# \"alive\"\u6d88\u606f\u662f\u901a\u8fc7\u52a0\u5bc6\u8fde\u63a5\u53d1\u9001\u7684\uff0c\u56e0\u6b64\u4e0d\u4f1a\u88ab\u6b3a\u9a97\uff1b\u800c TCPKeepAlive \u5374\u662f\u53ef\u4ee5\u88ab\u6b3a\u9a97\u7684\n# \u5982\u679c ClientAliveInterval \u88ab\u8bbe\u4e3a 15 \u5e76\u4e14\u5c06 ClientAliveCountMax \u4fdd\u6301\u4e3a\u9ed8\u8ba4\u503c\n# \u90a3\u4e48\u65e0\u5e94\u7b54\u7684\u5ba2\u6237\u7aef\u5927\u7ea6\u4f1a\u572845\u79d2\u540e\u88ab\u5f3a\u5236\u65ad\u5f00\u3002\u8fd9\u4e2a\u6307\u4ee4\u4ec5\u53ef\u4ee5\u7528\u4e8eSSH-2\u534f\u8bae\n#ClientAliveCountMax 3\n\n######################################################################################################################\n\n# \u6307\u5b9asshd\u662f\u5426\u5e94\u8be5\u5bf9\u8fdc\u7a0b\u4e3b\u673a\u540d\u8fdb\u884c\u53cd\u5411\u89e3\u6790\uff0c\u4ee5\u68c0\u67e5\u6b64\u4e3b\u673a\u540d\u662f\u5426\u4e0e\u5176IP\u5730\u5740\u771f\u5b9e\u5bf9\u5e94\u3002\u9ed8\u8ba4\u503c\u4e3a\"yes\"\n#UseDNS no\n\n# \u6307\u5b9a\u5728\u54ea\u4e2a\u6587\u4ef6\u4e2d\u5b58\u653eSSH\u5b88\u62a4\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\uff0c\u9ed8\u8ba4\u4e3a /var/run/sshd.pid \u6587\u4ef6\n#PidFile /var/run/sshd.pid\n\n# \u6700\u5927\u5141\u8bb8\u4fdd\u6301\u591a\u5c11\u4e2a\u672a\u8ba4\u8bc1\u7684\u8fde\u63a5\u3002\u9ed8\u8ba4\u503c\u662f 10\n# \u5230\u8fbe\u9650\u5236\u540e\uff0c\u5c06\u4e0d\u518d\u63a5\u53d7\u65b0\u8fde\u63a5\uff0c\u9664\u975e\u5148\u524d\u7684\u8fde\u63a5\u8ba4\u8bc1\u6210\u529f\u6216\u8d85\u51fa LoginGraceTime \u7684\u9650\u5236\n#MaxStartups 10:30:100\n\n# \u662f\u5426\u5141\u8bb8 tun(4) \u8bbe\u5907\u8f6c\u53d1\u3002\u53ef\u7528\u503c\u5982\u4e0b\uff1a\n# \"yes\", \"point-to-point\"(layer 3), \"ethernet\"(layer 2), \"no\"(\u9ed8\u8ba4)\n# \"yes\"\u540c\u65f6\u8574\u542b\u7740\"point-to-point\"\u548c\"ethernet\"\n#PermitTunnel no\n\n#ChrootDirectory none\n#VersionAddendum none\n\n# \u8fd9\u4e2a\u7279\u6027\u4ec5\u80fd\u7528\u4e8eSSH-2\uff0c\u9ed8\u8ba4\u4ec0\u4e48\u5185\u5bb9\u4e5f\u4e0d\u663e\u793a\u3002\"none\"\u8868\u793a\u7981\u7528\u8fd9\u4e2a\u7279\u6027\n# no default banner path\n#Banner none\n\n######################################################################################################################\n# AcceptEnv\n# \u6307\u5b9a\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u54ea\u4e9b\u73af\u5883\u53d8\u91cf\u5c06\u4f1a\u88ab\u4f20\u9012\u5230\u4f1a\u8bdd\u73af\u5883\u4e2d\u3002[\u6ce8\u610f]\u53ea\u6709SSH-2\u534f\u8bae\u652f\u6301\u73af\u5883\u53d8\u91cf\u7684\u4f20\u9012\n# \u7ec6\u8282\u53ef\u4ee5\u53c2\u8003/etc/ssh/ssh_config\u4e2d\u7684 SendEnv \u914d\u7f6e\u6307\u4ee4\n# \u6307\u4ee4\u7684\u503c\u662f\u7a7a\u683c\u5206\u9694\u7684\u53d8\u91cf\u540d\u5217\u8868(\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528'*'\u548c'?'\u4f5c\u4e3a\u901a\u914d\u7b26)\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a AcceptEnv \u8fbe\u5230\u540c\u6837\u7684\u76ee\u7684\n# \u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6709\u4e9b\u73af\u5883\u53d8\u91cf\u53ef\u80fd\u4f1a\u88ab\u7528\u4e8e\u7ed5\u8fc7\u7981\u6b62\u7528\u6237\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\u3002\u7531\u4e8e\u8fd9\u4e2a\u539f\u56e0\uff0c\u8be5\u6307\u4ee4\u5e94\u5f53\u5c0f\u5fc3\u4f7f\u7528\n# \u9ed8\u8ba4\u662f\u4e0d\u4f20\u9012\u4efb\u4f55\u73af\u5883\u53d8\u91cf\n# Allow client to pass locale environment variables\nAcceptEnv LANG LC_*\n\n######################################################################################################################\n\n# \u7cfb\u7edf\u5185\u5f00\u542fssh\u670d\u52a1\u548csftp\u670d\u52a1\u90fd\u662f\u901a\u8fc7/usr/sbin/sshd\u8fd9\u4e2a\u540e\u53f0\u7a0b\u5e8f\u76d1\u542c22\u7aef\u53e3\uff0c\u800csftp\u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u5b50\u670d\u52a1\uff0c\u662f\u901a\u8fc7/etc/ssh/sshd_config\u914d\u7f6e\n# \u6587\u4ef6\u4e2d\u7684Subsystem\u5b9e\u73b0\u7684\uff0c\u5982\u679c\u6ca1\u6709\u914d\u7f6eSubsystem\u53c2\u6570\uff0c\u5219\u7cfb\u7edf\u662f\u4e0d\u80fdsftp\u8bbf\u95ee\u7684\n# override default of no subsystems\nSubsystem   sftp    /usr/lib/openssh/sftp-server\n\n# AllowGroups\n# \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868(\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528\"*\"\u548c\"?\"\u901a\u914d\u7b26)\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55\n# \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7ec4\n# \u8fd9\u91cc\u7684\"\u7ec4\"\u662f\u6307\"\u4e3b\u7ec4\"(primary group)\uff0c\u4e5f\u5c31\u662f/etc/passwd\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4\n# \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528GID\u3002\u76f8\u5173\u7684 allow/deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a\n# DenyUsers, AllowUsers, DenyGroups, AllowGroups\n#AllowGroups&lt;\u7ec4\u540d1&gt; &lt;\u7ec4\u540d2&gt; &lt;\u7ec4\u540d3&gt; ..\n##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00\u3002\u5f53\u591a\u4e2a\u7528\u6237\u9700\u8981\u901a\u8fc7ssh\u767b\u5f55\u7cfb\u7edf\u65f6\uff0c\u53ef\u5c06\u6240\u6709\u7528\u6237\u52a0\u5165\u4e00\u4e2a\u7ec4\u4e2d\n\n# DenyGroups\n# \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7ec4\u540d\u5217\u8868(\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528\"*\"\u548c\"?\"\u901a\u914d\u7b26)\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7ec4\u767b\u5f55\n# \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7ec4\u4e2d\u7684\u6210\u5458\u5c06\u88ab\u62d2\u7edd\u767b\u5f55\n# \u8fd9\u91cc\u7684\"\u7ec4\"\u662f\u6307\"\u4e3b\u7ec4\"(primary group)\uff0c\u4e5f\u5c31\u662f/etc/passwd\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7ec4\n# \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7ec4\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528GID\u3002\u76f8\u5173\u7684 allow/deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a\n# DenyUsers, AllowUsers, DenyGroups, AllowGroups\n#DenyGroups&lt;\u7ec4\u540d1&gt; &lt;\u7ec4\u540d2&gt; &lt;\u7ec4\u540d3&gt; ..\n##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7ec4\uff0c\u591a\u4e2a\u7ec4\u4ee5\u7a7a\u683c\u9694\u5f00\n\n######################################################################################################################\n\n# AllowUsers\n# \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868(\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528\"*\"\u548c\"?\"\u901a\u914d\u7b26)\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55\n# \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u5c06\u4ec5\u5141\u8bb8\u8fd9\u4e9b\u7528\u6237\u767b\u5f55\uff0c\u800c\u62d2\u7edd\u5176\u5b83\u6240\u6709\u7528\u6237\n# \u5982\u679c\u6307\u5b9a\u4e86 USER@HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5\u3002# override default of no subsystems\n# \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528UID\u3002\u76f8\u5173\u7684 allow/deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1aSubsystem sftp /usr/lib/openssh/sftp-server\n# DenyUsers, AllowUsers, DenyGroups, AllowGroups\n#AllowUsers&lt;\u7528\u6237\u540d1&gt; &lt;\u7528\u6237\u540d2&gt; &lt;\u7528\u6237\u540d3&gt; ..\n##\u6307\u5b9a\u5141\u8bb8\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00\n\n# DenyUsers\n# \u8fd9\u4e2a\u6307\u4ee4\u540e\u9762\u8ddf\u7740\u4e00\u4e32\u7528\u7a7a\u683c\u5206\u9694\u7684\u7528\u6237\u540d\u5217\u8868(\u5176\u4e2d\u53ef\u4ee5\u4f7f\u7528\"*\"\u548c\"?\"\u901a\u914d\u7b26)\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u7528\u6237\u767b\u5f55\n# \u5982\u679c\u4f7f\u7528\u4e86\u8fd9\u4e2a\u6307\u4ee4\uff0c\u90a3\u4e48\u8fd9\u4e9b\u7528\u6237\u5c06\u88ab\u62d2\u7edd\u767b\u5f55\n# \u5982\u679c\u6307\u5b9a\u4e86 USER@HOST \u6a21\u5f0f\u7684\u7528\u6237\uff0c\u90a3\u4e48 USER \u548c HOST \u5c06\u540c\u65f6\u88ab\u68c0\u67e5\n# \u8fd9\u91cc\u53ea\u5141\u8bb8\u4f7f\u7528\u7528\u6237\u7684\u540d\u5b57\u800c\u4e0d\u5141\u8bb8\u4f7f\u7528UID\u3002\u76f8\u5173\u7684 allow/deny \u6307\u4ee4\u6309\u7167\u4e0b\u5217\u987a\u5e8f\u5904\u7406\uff1a\n# DenyUsers, AllowUsers, DenyGroups, AllowGroups\n#DenyUsers&lt;\u7528\u6237\u540d1&gt; &lt;\u7528\u6237\u540d2&gt; &lt;\u7528\u6237\u540d3&gt; ..\n##\u6307\u5b9a\u7981\u6b62\u901a\u8fc7\u8fdc\u7a0b\u8bbf\u95ee\u7684\u7528\u6237\uff0c\u591a\u4e2a\u7528\u6237\u4ee5\u7a7a\u683c\u9694\u5f00\n\n######################################################################################################################\n\n# Match\n# \u5f15\u5165\u4e00\u4e2a\u6761\u4ef6\u5757\u3002\u5757\u7684\u7ed3\u5c3e\u6807\u5fd7\u662f\u53e6\u4e00\u4e2a Match \u6307\u4ee4\u6216\u8005\u6587\u4ef6\u7ed3\u5c3e\n# \u5982\u679c Match \u884c\u4e0a\u6307\u5b9a\u7684\u6761\u4ef6\u90fd\u6ee1\u8db3\uff0c\u90a3\u4e48\u968f\u540e\u7684\u6307\u4ee4\u5c06\u8986\u76d6\u5168\u5c40\u914d\u7f6e\u4e2d\u7684\u6307\u4ee4\n# Match \u7684\u503c\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\"\u6761\u4ef6-\u6a21\u5f0f\"\u5bf9\u3002\u53ef\u7528\u7684\"\u6761\u4ef6\"\u662f\uff1aUser, Group, Host, Address\n# \u53ea\u6709\u4e0b\u5217\u6307\u4ee4\u53ef\u4ee5\u5728 Match \u5757\u4e2d\u4f7f\u7528\uff1aAllowTcpForwarding, Banner,\n# ForceCommand, GatewayPorts, GSSApiAuthentication,\n# KbdInteractiveAuthentication, KerberosAuthentication,\n# PasswordAuthentication, PermitOpen, PermitRootLogin,\n# RhostsRSAAuthentication, RSAAuthentication, X11DisplayOffset,\n# X11Forwarding, X11UseLocalHost\n\n# \u6307\u5b9aTCP\u7aef\u53e3\u8f6c\u53d1\u5141\u8bb8\u7684\u76ee\u7684\u5730\uff0c\u53ef\u4ee5\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u591a\u4e2a\u8f6c\u53d1\u76ee\u6807\u3002\u9ed8\u8ba4\u5141\u8bb8\u6240\u6709\u8f6c\u53d1\u8bf7\u6c42\n# \u5408\u6cd5\u7684\u6307\u4ee4\u683c\u5f0f\u5982\u4e0b\uff1a\n# PermitOpen host:port\n# PermitOpen IPv4_addr:port\n# PermitOpen [IPv6_addr]:port\n# \"any\"\u53ef\u4ee5\u7528\u4e8e\u79fb\u9664\u6240\u6709\u9650\u5236\u5e76\u5141\u8bb8\u4e00\u5207\u8f6c\u53d1\u8bf7\u6c42\n\n# Example of overriding settings on a per-user basis\n#Match User anoncvs\n#   X11Forwarding no\n#   AllowTcpForwarding no\n#   PermitTTY no\n\n#   ForceCommand cvs server\n#   ForceCommand\n#   \u5f3a\u5236\u6267\u884c\u8fd9\u91cc\u6307\u5b9a\u7684\u547d\u4ee4\u800c\u5ffd\u7565\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u4efb\u4f55\u547d\u4ee4\u3002\u8fd9\u4e2a\u547d\u4ee4\u5c06\u4f7f\u7528\u7528\u6237\u7684\u767b\u5f55shell\u6267\u884c(shell -c)\n#   \u8fd9\u53ef\u4ee5\u5e94\u7528\u4e8e shell \u3001\u547d\u4ee4\u3001\u5b50\u7cfb\u7edf\u7684\u5b8c\u6210\uff0c\u901a\u5e38\u7528\u4e8e Match \u5757\u4e2d\n#   \u8fd9\u4e2a\u547d\u4ee4\u6700\u521d\u662f\u5728\u5ba2\u6237\u7aef\u901a\u8fc7 SSH_ORIGINAL_COMMAND \u73af\u5883\u53d8\u91cf\u6765\u652f\u6301\u7684\n\nPermitRootLogin yes\n\n# \u6307\u5b9asshd\u5b88\u62a4\u8fdb\u7a0b\u76d1\u542c\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u4e3a 22 \u3002\u53ef\u4ee5\u4f7f\u7528\u591a\u6761\u6307\u4ee4\u76d1\u542c\u591a\u4e2a\u7aef\u53e3\n# \u9ed8\u8ba4\u5c06\u5728\u672c\u673a\u7684\u6240\u6709\u7f51\u7edc\u63a5\u53e3\u4e0a\u76d1\u542c\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7 ListenAddress \u6307\u5b9a\u53ea\u5728\u67d0\u4e2a\u7279\u5b9a\u7684\u63a5\u53e3\u4e0a\u76d1\u542c\nPort 22\n</code></pre>"},{"location":"system/linux/Centos/#ssh_2","title":"SSH\u7aef\u53e3\u8f6c\u53d1","text":"<p>SSH\u7aef\u53e3\u8f6c\u53d1\u5c06\u5176\u4ed6TCP\u7aef\u53e3\u7684\u7f51\u7edc\u6570\u636e\u901a\u8fc7SSH\u94fe\u8def\u8f6c\u53d1\uff0c\u5e76\u81ea\u52a8\u52a0\u5bc6\u548c\u89e3\u5bc6</p>"},{"location":"system/linux/Centos/#_5","title":"\u672c\u5730\u8f6c\u53d1\u5b9e\u4f8b","text":"Markdown<pre><code># \u547d\u4ee4\u683c\u5f0f\uff1assh -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;\n\n# \u5b9e\u4f8b\uff1a\u4e00\u53f0LDAP server\uff0c\u4f46\u9650\u5236\u8fdc\u7a0b\u673a\u5668\u8fde\u63a5\uff0c\u6b64\u65f6\u5229\u7528ssh\u7aef\u53e3\u8f6c\u53d1\u5b9e\u73b0\u4ece\u8fdc\u7a0b\u673a\u5668\u6d4b\u8bd5server\u7684\u76ee\u7684(\u8fd9\u91cc\u7684\u8fdc\u7a0b\u673a\u5668\u662f\u76f8\u5bf9\u4e8eserver\u6765\u8bb2\u7684)\n# LDAP client\u6267\u884c\u6b64\u547d\u4ee4\u5efa\u7acbssh\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\uff0c\u5b9e\u73b0\u901a\u8fc7ssh\u96a7\u9053\u4ece\u672c\u57307001\u7aef\u53e3\u8fde\u63a5\u8fdc\u7aef\u7684389\u7aef\u53e3\nssh -L 7001:localhost:389 LDAPServer\n\n# SSH \u540c\u65f6\u63d0\u4f9b\u4e86 GatewayPorts \u5173\u952e\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u5b83\u4e0e\u5176\u4ed6\u673a\u5668\u5171\u4eab\u8fd9\u4e2a\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\nssh -g -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;\n\n......................|||.........................\n......LDAP Client.....|||......LDAP Server........\n......................|||.........................\n.......########.......|||.........................\n.......########.......|||.....############........\n.......########.......|||.....############........\n......@@@@@@@@@@......|||.....#@@@@#######........\n.....############.....|||.....############........\n.....############.....|||.....############........\n...Local Port 7001....|||.......LDAP Port 389.....\n........\u2198.............|||..............\u2197..........\n.....SSH Clinet...\u2592\u2592\u2592\u2592\u2592\u2592\u2592.....SSH Server.....\n...................SSH tunnel.....................\n..................................................\n\n# \u672c\u5730\u670d\u52a1\u5668LDAP Client\u82e5\u63d0\u793a\u65e0\u6cd5\u89e3\u6790hostname LDAPServer,\u5219\u5728/etc/hosts\u6587\u4ef6\u6dfb\u52a0localhost LDAPServer\u5373\u53ef\n# \u5728\u9009\u62e9\u7aef\u53e3\u53f7\u65f6\u8981\u6ce8\u610f\u975e\u7ba1\u7406\u5458\u5e10\u53f7\u662f\u65e0\u6743\u7ed1\u5b9a 1-1023 \u7aef\u53e3\u7684\uff0c\u6240\u4ee5\u4e00\u822c\u662f\u9009\u7528\u4e00\u4e2a 1024-65535 \u4e4b\u95f4\u7684\u5e76\u4e14\u5c1a\u672a\u4f7f\u7528\u7684\u7aef\u53e3\u53f7\u5373\u53ef\n# \u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5c06\u8fdc\u7a0b\u673a\u5668\uff08LDAP Client\uff09\u4e0a\u7684\u5e94\u7528\u76f4\u63a5\u914d\u7f6e\u5230\u672c\u673a\u7684 7001 \u7aef\u53e3\u4e0a\uff08\u800c\u4e0d\u662f LDAP \u670d\u52a1\u5668\u7684 389 \u7aef\u53e3\u4e0a\uff09\n</code></pre>"},{"location":"system/linux/Centos/#_6","title":"\u8fdc\u7a0b\u8f6c\u53d1\u5b9e\u4f8b","text":"Markdown<pre><code>\u5047\u8bbe\u7531\u4e8e\u7f51\u7edc\u6216\u9632\u706b\u5899\u7684\u539f\u56e0\u6211\u4eec\u4e0d\u80fd\u7528SSH\u76f4\u63a5\u4eceLDAP Client Host\u8fde\u63a5\u5230LDAP\u670d\u52a1\u5668\uff08Ldap Server Host\uff09\uff0c\u4f46\u662f\u53cd\u5411\u8fde\u63a5\u5374\u662f\u88ab\u5141\u8bb8\u7684,\n\u6b64\u65f6\u6211\u4eec\u7684\u9009\u62e9\u81ea\u7136\u5c31\u662f\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1\u4e86\n# \u547d\u4ee4\u683c\u5f0f\uff1a\nssh -R &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;\n# \u5728LDAP\u670d\u52a1\u5668\uff08LdapServertHost\uff09\u7aef\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\n# -n\u963b\u6b62\u4ecestdin\u8bfb\u53d6\uff0c\u56e0\u4e3a\u60a8\u4e0d\u60f3\u4ece\u547d\u4ee4\u884c\u4f7f\u7528\u96a7\u9053\n# -N\u8868\u793a\u60a8\u4e0d\u60f3\u6267\u884c\u8fdc\u7a0b\u547d\u4ee4\uff0c\u53ea\u9700\u6267\u884c\u7aef\u53e3\u8f6c\u53d1\nssh -nN -R 7001:localhost:389 LdapClientHost\n\n......................|||.........................\n......LDAP Client.....|||......LDAP Server........\n......................|||.........................\n.......########.......|||.........................\n.......########.......|||.....############........\n.......########.......|||.....############........\n......@@@@@@@@@@......|||.....#@@@@#######........\n.....############.....|||.....############........\n.....############.....|||.....############........\n...Local Port 7001....|||.......LDAP Port 389.....\n........\u2198.............|||..............\u2197..........\n.....SSH Server...\u2592\u2592\u2592\u2592\u2592\u2592\u2592.....SSH Client.....\n...................SSH tunnel.....................\n..................................................\n</code></pre>"},{"location":"system/linux/Centos/#_7","title":"\u591a\u4e3b\u673a\u8f6c\u53d1\u5e94\u7528\u5b9e\u4f8b","text":"Markdown<pre><code># \u672c\u5730\u8f6c\u53d1\u547d\u4ee4\u4e2d\u7684&lt;remote host&gt;\u548c&lt;SSH hostname&gt;\u53ef\u4ee5\u662f\u4e0d\u540c\u7684\u673a\u5668\nssh -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;\n# \u770b\u4e00\u4e2a\u6d89\u53ca\u5230\u56db\u53f0\u673a\u5668 (A,B,C,D) \u7684\u4f8b\u5b50,\u5728 SSH Client(C) \u6267\u884c\u4e0b\u5217\u547d\u4ee4\u6765\u5efa\u7acb SSH \u8fde\u63a5\u4ee5\u53ca\u7aef\u53e3\u8f6c\u53d1\uff1a\nssh -g -L 7001:&lt;B&gt;:389 &lt;D&gt;\n\n\u7136\u540e\u5e94\u7528\u5ba2\u6237\u7aef\uff08A\uff09\u4e0a\u914d\u7f6e\u8fde\u63a5\u673a\u5668\uff08C \uff09\u7684 7001 \u7aef\u53e3\u5373\u53ef,\u5728\u4e0a\u8ff0\u8fde\u63a5\u4e2d\uff0c\uff08A\uff09&lt;-&gt; (C) \u4ee5\u53ca (B)&lt;-&gt;(D) \u4e4b\u95f4\u7684\u8fde\u63a5\u5e76\u4e0d\u662f\u5b89\u5168\u8fde\u63a5\n\u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u7ecf\u8fc7 SSH \u7684\u52a0\u5bc6\u53ca\u89e3\u5bc6\n\n........................................................................................\n......................................|||...............................................\n......................................|||...............................................\n.............#############............|||...............................................\n.............#############............|||...............................................\n.............LDAP Clinet(A)...........|||...........LADP Server(B)......................\n.............#############............|||...............................................\n.............#############............|||..........#################....................\n.............@@@@@@@@@@@@@............|||..........##@@@@@@#########....................\n...........#################..........|||..........#################....................\n...........#################..........|||..........#################....................\n..............LDAP App................|||.............LDAP Port 389.....................\n..................\u2191...................|||...................\u2191...........................\n..................\u2193...................|||...................\u2193...........................\n..............SSH Client(C)...........|||..............SSH Server(D)....................\n...........@@@@@@@@@@@@@@@@@..........|||............@@@@@@@@@@@@@@@@@..................\n...........#################..........|||............#################..................\n...........#################..........|||............#################..................\n............Local Port 7001...........|||...............................................\n..............SSH Client...\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592...SSH Server........................\n....................................SSH tunnel..........................................\n........................................................................................\n</code></pre>"},{"location":"system/linux/Centos/#_8","title":"\u52a8\u6001\u8f6c\u53d1\u5b9e\u4f8b","text":"Markdown<pre><code># \u5f53\u6211\u4eec\u5728\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684 WiFi \u73af\u5883\u4e0b\u4e0a\u7f51\uff0c\u7528 SSH \u52a8\u6001\u8f6c\u53d1\u6765\u4fdd\u62a4\u6211\u4eec\u7684\u7f51\u9875\u6d4f\u89c8\u53ca MSN \u4fe1\u606f\u65e0\u7591\u662f\u5341\u5206\u5fc5\u8981\u7684\u3002\u5b9e\u9645\u662f\u521b\u5efa\u4e86\u4e00\u4e2asocks\u4ee3\u7406\u670d\u52a1\n# \u547d\u4ee4\u683c\u5f0f\uff1assh -D &lt;local port&gt; &lt;SSH Server&gt;\n\u6b64\u65f6\u76f4\u63a5\u4f7f\u7528 localhost:7001 \u6765\u4f5c\u4e3a\u6b63\u5e38\u7684 SOCKS \u4ee3\u7406\u6765\u4f7f\u7528,SSH \u6240\u5305\u62a4\u7684\u8303\u56f4\u53ea\u5305\u62ec\u4ece\u6d4f\u89c8\u5668\u7aef\uff08SSH Client \u7aef\uff09\u5230 SSH Server \u7aef\u7684\u8fde\u63a5\n\u5e76\u4e0d\u5305\u542b\u4ece SSH Server \u7aef \u5230\u76ee\u6807\u7f51\u7ad9\u7684\u8fde\u63a5\u3002\u5982\u679c\u540e\u534a\u622a\u8fde\u63a5\u7684\u5b89\u5168\u4e0d\u80fd\u5f97\u5230\u5145\u5206\u7684\u4fdd\u8bc1\u7684\u8bdd\uff0c\u8fd9\u79cd\u65b9\u5f0f\u4ecd\u4e0d\u662f\u5408\u9002\u7684\u89e3\u51b3\u65b9\u6848\n\n...........................................................................................\n.....................................|||...................................................\n.....................................|||...................................................\n...........Brower\u3001MSN Client........|||.......________________________________............\n............@############@...........|||.......|::::::::::::::::::::::::::::::|............\n............@############@...........|||.......|::::::::WEB Site,MSN...:::::::|............\n............@############@...........|||.......|::::::::::::::::::::::::::::::|............\n..........@################@.........|||.......|::::::::::::::::::::::::::::::|............\n..........@################@.........|||.......|::::::::::::::::::::::::::::::|............\n..........@################@.........|||.......--------------------------------............\n..............Port 7001..............|||.............Dynamic Port(\u52a8\u6001\u7aef\u53e3).................\n..............SSH Clinet....\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592.....SSH Server...........................\n...................................SSH tunnel..............................................\n.....................................|||...................................................\n.....................................|||...................................................\n...........................................................................................\n</code></pre>"},{"location":"system/linux/Centos/#x","title":"X\u534f\u8bae\u8f6c\u53d1\u5b9e\u4f8b","text":"Markdown<pre><code># \u53ef\u7528\u4f5c\u8fdc\u7a0b\u684c\u9762\u8fde\u63a5\uff0c\u88ab\u8fdc\u7a0b\u7aef\u662fWindows\u53ef\u5b89\u88c5xming\u4f5c\u4e3axserver\u3002ssh client\u53ef\u4ee5\u9009\u62e9putty\u914d\u7f6essh\u8bbf\u95ee\u5e76\u5efa\u7acbx-forward\uff08\u8f6c\u53d1\uff09\n\u5728X Server\u7aef\u6267\u884c\u4e00\u4e0b\u547d\u4ee4\uff0c\u53d1\u8d77\u4e00\u4e2aSSH\u8fde\u63a5\u3002\u7136\u540e\u5728X Client\u7aef\u8fd0\u884c\u8fdc\u7a0bX\u684c\u9762\u8fde\u63a5\u5ba2\u6237\u7aef\nssh -X &lt;SSH Server&gt;\n\n..................................................\n......X Server........|||......X Clinet...........\n......................|||.........................\n.......########.......|||.........................\n.......########.......|||.....############........\n.......########.......|||.....############........\n......@@@@@@@@@@......|||.....#@@@@#######........\n.....############.....|||.....############........\n.....############.....|||.....############........\n..........\u2191...........|||..DISPLAY=locahost:10.1..\n..........\u2193...........|||..............\u2193..........\n.....SSH Client...\u2592\u2592\u2592\u2592\u2592\u2592\u2592.....SSH Server.....\n...................SSH tunnel.....................\n..................................................\n</code></pre>"},{"location":"system/linux/Centos/#esnet","title":"\u4e3b\u673a\u8c03\u6574 [es.net]","text":"<p>\u7f51\u7edc\u6545\u969c\u6392\u67e5\u53c2\u8003</p> Markdown<pre><code>## \u5173\u4e8e\u8d85\u5927\u578b\u6570\u636e\u96c6\u4f20\u8f93\u95ee\u9898(\u5f15\u7528es.net)\n\u5728Unix\u73af\u5883\u4e2d\uff0cscp\uff0csftp\u548crsync\u901a\u5e38\u7528\u4e8e\u5728\u4e3b\u673a\u4e4b\u95f4\u590d\u5236\u6570\u636e\u3002\u867d\u7136\u8fd9\u4e9b\u5de5\u5177\u5728\u672c\u5730\u73af\u5883\u4e2d\u8fd0\u884c\u826f\u597d\uff0c\u4f46\u5b83\u4eec\u5728WAN\u4e0a\u7684\u6027\u80fd\u5f88\u5dee\u3002scp\u548csftp\n\u7684openssh\u7248\u672c\u5177\u6709\u5185\u7f6e\u76841MB\u7f13\u51b2\u533a\uff0c\u4e25\u91cd\u9650\u5236\u4e86WAN\u4e0a\u7684\u6027\u80fd\u3002\u5c3d\u7ba1rsync\u4e0d\u662fopenssh\u53d1\u884c\u7248\u7684\u4e00\u90e8\u5206\uff0c\u4f46rsync\u901a\u5e38\u4f7f\u7528ssh\u4f5c\u4e3a\u4f20\u8f93\uff0c\u56e0\u6b64\n\u53d7\u5230\u5e95\u5c42ssh\u5b9e\u73b0\u6240\u65bd\u52a0\u7684\u9650\u5236\u3002 \u5982\u679c\u60a8\u9700\u8981\u5728RTT\u8d85\u8fc720\u6beb\u79d2\u7684\u7f51\u7edc\u8def\u5f84\u4e0a\u4f20\u8f93\u5927\u578b\u6570\u636e\u96c6\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\n\u5339\u5179\u5821\u8d85\u7ea7\u8ba1\u7b97\u673a\u4e2d\u5fc3\u63d0\u4f9b\u4e86\u89e3\u51b3scp\u548csftp\u5173\u4e8e\u8fd9\u4e2a\u95ee\u9898\u7684\u8865\u4e01\uff1aHPN-SSH\uff1ahttps://www.psc.edu/hpn-ssh\n\n# \u6839\u636ees net\u5b98\u7f51TCP\u6ce8\u610f\u4e8b\u9879\n\u6ce8\u610f\uff1a\u5e94\u8be5\u5355\u72ec\u4f7f\u7528net.tcp_mem\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u8bbe\u7f6e\u6ca1\u95ee\u9898\u3002\u4e00\u4e9b\u6027\u80fd\u4e13\u5bb6\u8bf4\uff0c\u8fd8\u8981\u589e\u52a0net.core.optmem_max\u4ee5\u5339\u914dnet.core.rmem_max\n\u548cnet.core.wmem_max\uff0c\u4f46\u6211\u4eec\u6ca1\u6709\u53d1\u73b0\u8fd9\u6709\u4efb\u4f55\u533a\u522b\u3002\u4e00\u4e9b\u4e13\u5bb6\u8fd8\u8bf4\u5c06net.ipv4.tcp_timestamps\u548cnet.ipv4.tcp_sack\u8bbe\u7f6e\u4e3a0\n\u8fd9\u6837\u505a\u53ef\u4ee5\u51cf\u5c11CPU\u8d1f\u8f7d\uff0c\u4f46\u9ed8\u8ba4\u503c\u662f1\u5bf9\u4e8e\u6027\u80fd\u5176\u5b9e\u66f4\u6709\u5e2e\u52a9\n\n\u5bf9\u4e8e\u8f83\u65e7\u7684\u64cd\u4f5c\u7cfb\uff08\u4f8b\u5982CentOS5/6\uff09\uff0c\u589e\u52a0net.core.netdev_max_backlog\u503c\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\n\n# UDP\u8c03\u6574\n\n1. \u4f7f\u7528jumbo frames\u57289k MTUs\u4e0b\u53ef\u4ee5\u4f7f\u6027\u80fd\u63d0\u9ad84-5\u500d\n2. \u6570\u636e\u5305\u5927\u5c0f\uff1a\u6700\u597d\u7684\u6027\u80fd\u662fMTU\u5927\u5c0f\u51cf\u53bb\u6570\u636e\u5305\u5934\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a9000Byte MTU\uff0cipv4\u662f8972\uff0cipv6\u662f8952\n3. socket\u7f13\u5b58\u5927\u5c0f\uff1a\u5bf9\u4e8eUDP\uff0c\u7f13\u51b2\u533a\u5927\u5c0f\u4e0eTCP\u7684\u65b9\u5f0f\u65e0\u5173\uff0c\u4f46\u9ed8\u8ba4\u503c\u4ecd\u7136\u4e0d\u591f\u5927\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5c06\u5957\u63a5\u5b57\u7f13\u51b2\u533a\u8bbe\u7f6e\u4e3a4M\u4f3c\u4e4e\u6709\u5f88\u5927\u5e2e\u52a9\n4. CPU\u9009\u62e9\uff1a10G\u7684UDP\u901a\u5e38\u662fCPU\u9650\u5236\uff0c\u56e0\u6b64\u9700\u8981\u8003\u8651\u5185\u6838\uff0c\u5c24\u5176\u5728Sandy\u6216lvy Bridge\u4e3b\u677f\n\n# \u865a\u62df\u673a\u8c03\u6574\n\n## XEN\u3001KVM\u7c7b\u578b\n\u8981\u5c06\u6240\u6709\u7684\u4e3b\u673a\u5904\u7406\u5668\u529f\u80fd\u4f20\u9012\u7ed9guest\u865a\u62df\u673a\u6267\u884c\nqemu -cpu host\n\n\u5982\u679c\u5e0c\u671b\u4fdd\u7559\u517c\u5bb9\u6027\uff0c\u5219\u53ef\u4ee5\u5411guest\u865a\u62df\u673a\u516c\u5f00\u6240\u9009\u529f\u80fd\u3002\u5982\u679c\u6240\u6709\u4e3b\u673a\u90fd\u5177\u6709\u8fd9\u4e9b\u529f\u80fd\uff0c\u5219\u4f1a\u4fdd\u7559\u517c\u5bb9\u6027\nqemu -cpu qemu64,+ssse3,+sse4.1,+sse4.2,+x2apic\n\n\u8981\u67e5\u770b\u4e3b\u673aCPU\u4e0eguest\u865a\u62df\u673a\u529f\u80fd\u4e4b\u95f4\u7684\u533a\u522b\uff0c\u53ea\u9700\u6bd4\u8f83\u6bcf\u4e2a\u7cfb\u7edf\u4e0a\u4ee5\u4e0b\u547d\u4ee4\u7684\u8f93\u51fa\ngrep flags /proc/cpuinfo | uniq\n\nqemu\u9ed8\u8ba4\u4f7f\u7528\u7528\u6237\u6a21\u5f0f\u7f51\u7edc(slirp)\uff0c\u65e0\u9700\u4e8b\u5148\u5b89\u88c5\u5373\u53ef\u5728\u4e3b\u673a\u4f7f\u7528\u7ba1\u7406\u6743\u9650\uff0c\u4f46\u662f\u5f88\u6162\uff0c\u83b7\u5f97\u9ad8\u6027\u80fd\u53ef\u901a\u8fc7-net tap\u547d\u4ee4\u884c\u5f00\u5173\u5207\u6362\u5230\u6865\u63a5\u6a21\u5f0f\nqemu -net nic,model = virtio,mac=...-net tap,ifname=...\n\u6216\nqemu -net nic,model = virtio,mac=... -net bridge,br=...,helper=/usr/local/libexec/qemu-bridge-helper\n\n\u9664\u4e86virtio\u4e4b\u5916\uff0cvt-d passthrough\u65b9\u6cd5\u53ef\u63d0\u4f9b\u66f4\u9ad8\u7684\u6027\u80fd\nqemu -net none -device vfio-pci,host=...\n\nQEMU\u652f\u6301\u5404\u79cd\u5b58\u50a8\u683c\u5f0f\u548c\u540e\u7aef\u3002\u6700\u5bb9\u6613\u4f7f\u7528\u7684\u662fraw\u548cqcow2\u683c\u5f0f\uff0c\u4f46\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u6700\u597d\u4f7f\u7528\u539f\u59cb\u5206\u533a\u3002\u521b\u5efa\u903b\u8f91\u5377\u6216\u5206\u533a\u5e76\u5c06\u5176\u5206\u914d\u7ed9guest\u865a\u62df\u673a\uff1a\nqemu -drive file=/dev/mapper/ImagesVolumeGroup-Guest1,cache=none,if=virtio\n\nQEMU\u8fd8\u652f\u6301\u5404\u79cd\u7f13\u5b58\u6a21\u5f0f\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u539f\u59cb\u5377\u6216\u5206\u533a\uff0c\u6700\u597d\u5b8c\u5168\u907f\u514d\u7f13\u5b58\uff0c\u8fd9\u4f1a\u51cf\u5c11\u6570\u636e\u526f\u672c\u548c\u603b\u7ebf\u6d41\u91cf\n\nqemu -drive file=/dev/mapper/ImagesVolumeGroup-Guest1,cache=none,if=virtio\n\n\u4e0e\u7f51\u7edc\u4e00\u6837\uff0cQEMU\u652f\u6301\u591a\u79cd\u5b58\u50a8\u63a5\u53e3\u3002\u9ed8\u8ba4\u503cIDE\u53d7\u5230\u6765\u5bbe\u7684\u9ad8\u5ea6\u652f\u6301\uff0c\u4f46\u53ef\u80fd\u5f88\u6162\uff0c\u5c24\u5176\u662f\u78c1\u76d8\u9635\u5217\u3002\u5982\u679c\u60a8\u7684guest\u865a\u62df\u673a\u652f\u6301\u5b83\uff0c\u8bf7\u4f7f\u7528virtio\u63a5\u53e3\n\u4e0d\u8981\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528linux\u6587\u4ef6\u7cfb\u7edfbtrfs\u6765\u83b7\u53d6\u56fe\u50cf\u6587\u4ef6\u3002\u8fd9\u5c06\u5bfc\u81f4\u4f4eIO\u6027\u80fd\u3002\u5f53\u5ba2\u6237\u7aef\u8fdb\u884c\u9ad8IO\u6d41\u91cf\u65f6\uff0ckvm guest\u865a\u62df\u673a\u751a\u81f3\u53ef\u80fd\u4f1a\u51bb\u7ed3\n\nqemu -drive file=/dev/mapper/ImagesVolumeGroup-Guest1,cache=none,if=virtio\n\n## VMware\u7c7b\u578b\n\n[VMware\u517c\u5bb9\u6027\u6307\u5357](http://www.vmware.com/resources/compatibility/search.php)\n</code></pre>"},{"location":"system/linux/Centos/#_9","title":"\u4f18\u5316\u5185\u6838\u53c2\u6570 [\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574]","text":"<p>\u4fee\u6539\u5185\u6838\u53c2\u6570\u65b9\u6cd5:</p> <p>echo\u8ffd\u52a0\u5230\u6587\u4ef6\u91cc\u5982\uff1aecho \"1\" &gt;/proc/sys/net/ipv4/tcp_syn_retries\uff0c\u6216\u4f7f\u7528sysctl -w\u547d\u4ee4\uff0c\u4f46\u91cd\u542f\u540e\u5931\u6548,\u628a\u53c2\u6570\u6dfb\u52a0\u5230 /etc/sysctl.conf\u4e2d\uff0c\u7136\u540e\u6267\u884csysctl -p\u4f7f\u53c2\u6570\u751f\u6548\uff0c\u6c38\u4e45\u751f\u6548\u3002\u5185\u6838\u751f\u4ea7\u73af\u5883\u5e38\u7528\u4f18\u5316\u53c2\u6570\u53c2\u8003\uff0c\u5177\u4f53\u4f18\u5316\u503c\u8981\u53c2\u8003\u5e94\u7528\u573a\u666f\u548c\u8bbe\u5907</p> Markdown<pre><code># \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a/proc/sys/kernel/\n\n# \u5f00\u542fexecshield,\u5373\u5185\u5b58\u7f13\u51b2\u533a\u6ea2\u51fa\u4fdd\u62a4\nkernel.exec-shield = 1\nkernel.randomize_va_space = 1\n\nkernel.sysrq = 0    # \u63a7\u5236\u5185\u6838\u7684\u7cfb\u7edf\u8bf7\u6c42\u8c03\u8bd5\u529f\u80fd\uff0c\u4e3a\u5b89\u5168\u8d77\u89c1\u8bbe\u4e3a0\u5173\u95ed\nkernel.core_uses_pid = 1    # \u63a7\u5236\u6838\u5fc3\u8f6c\u50a8\u662f\u5426\u5c06PID\u9644\u52a0\u5230\u6838\u5fc3\u6587\u4ef6\u540d,\u7528\u4e8e\u8c03\u8bd5\u591a\u7ebf\u7a0b\u5e94\u7528\u7a0b\u5e8f\nkernel.msgmnb = 65536   # \u6bcf\u4e2a\u6d88\u606f\u961f\u5217\u7684\u5927\u5c0f\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\u9650\u5236\nkernel.msgmax = 65536   # \u6574\u4e2a\u7cfb\u7edf\u6700\u5927\u6d88\u606f\u961f\u5217\u6570\u91cf\u9650\u5236\nkernel.shmmax = 67108864 # \u589e\u52a0\u5206\u914d\u7ed9shm(\u5355\u4e2a\u5171\u4eab\u5185\u5b58\u6bb5)\u7684\u6700\u5927\u5185\u5b58\u91cf(\u5355\u4f4d\uff1a\u5b57\u8282)\u9650\u5236\uff0c\u8ba1\u7b97\u516c\u5f0f64G * 1024 * 1024 * 1024(\u5b57\u8282)\nkernel.shmall = 4294967296  # \u6240\u6709\u5185\u5b58\u5927\u5c0f(\u5355\u4f4d\uff1a\u9875\uff0c1\u9875 = 4Kb)\uff0c\u8ba1\u7b97\u516c\u5f0f16G * 1024 * 1024 * 1024/4KB(\u9875)\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a/proc/sys/net/bridge/\n\n# bridge-nf\u4f7f\u5f97netfilter\u53ef\u4ee5\u5bf9Linux\u7f51\u6865\u4e0a\u7684IPv4/ARP/IPv6\u5305\u8fc7\u6ee4\uff0c\u4ee5\u4e0b\u662f\u5e38\u7528\u914d\u7f6e\uff0c1\u4ee3\u8868\u542f\u7528\uff0c0\u4ee3\u8868\u4e0d\u542f\u7528\nnet.bridge.bridge-nf-call-arptables = 0     # \u662f\u5426\u542f\u7528\u5728arptables\u7684FORWARD\u4e2d\u8fc7\u6ee4\u7f51\u6865\u7684ARP\u5305(\u9ed8\u8ba4\uff1a0)\nnet.bridge.bridge-nf-call-ip6tables = 0     # \u662f\u5426\u542f\u7528\u5728ip6tables\u94fe\u4e2d\u8fc7\u6ee4IPv6\u5305(\u9ed8\u8ba4\uff1a0)\nnet.bridge.bridge-nf-call-iptables = 0      # \u662f\u5426\u542f\u7528\u5728iptables\u94fe\u4e2d\u8fc7\u6ee4IPv4\u5305(\u9ed8\u8ba4\uff1a0)\nnet.bridge.bridge-nf-filter-vlan-tagged = 0 # \u662f\u5426\u542f\u7528\u5728iptables/arptables\u4e2d\u8fc7\u6ee4\u6253\u4e86vlan\u6807\u7b7e\u7684\u5305(\u9ed8\u8ba4\uff1a0)\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a/proc/sys/net/core/\n\nnet.core.rmem_default = 65535   # \u4e3aTCP socket\u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\nnet.core.rmem_max = 25165824     # \u4e3aTCP socket\u9884\u7559\u7528\u4e8e\u63a5\u6536\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09(24MB)\nnet.core.wmem_default = 65535   # \u4e3aTCP socket\u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u9ed8\u8ba4\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\nnet.core.wmem_max = 25165824     # \u4e3aTCP socket\u9884\u7559\u7528\u4e8e\u53d1\u9001\u7f13\u51b2\u7684\u5185\u5b58\u6700\u5927\u503c\uff08\u5355\u4f4d\uff1a\u5b57\u8282\uff09\nnet.core.hot_list_length = 256  # \u589e\u52a0\u8981\u7f13\u5b58\u7684skb-heads\u6570\u76ee\nnet.core.optmem_max = 40960     # \u589e\u52a0\u5185\u5b58\u7f13\u51b2\u533a\u7684\u6700\u5927\u6570\u91cf(\u9ed8\u8ba4\uff1a20480)\nnet.core.busy_poll = 50 # \u8f6e\u8be2\u6709\u52a9\u4e8e\u51cf\u5c11\u7f51\u7edc\u63a5\u6536\u8def\u5f84\u4e2d\u7684\u5ef6\u8fdf,\u5141\u8bb8\u5957\u63a5\u5b57\u5c42\u4ee3\u7801\u8f6e\u8be2\u7f51\u7edc\u8bbe\u5907\u7684\u63a5\u6536\u961f\u5217\uff0c\u5e76\u7981\u7528\u7f51\u7edc\u4e2d\u65ad(\u9ed8\u8ba4\uff1a0)\nnet.core.netdev_max_backlog = 16384 # \u5f53\u63a5\u53e3\u63a5\u6536\u6570\u636e\u5305\u7684\u901f\u5ea6\u8d85\u8fc7\u5185\u6838\u53ef\u4ee5\u5904\u7406\u7684\u901f\u5ea6\u65f6\uff0c\u589e\u52a0incoming\u8fde\u63a5\u7684\u6570\u91cf\uff0cbacklog\u961f\u5217\u8bbe\u7f6e\n                                    \u5728INPUT\u7aef\u6392\u961f\u7684\u6700\u5927\u6570\u636e\u5305\u6570,\u9ad8\u8d1f\u8f7d\u53ef\u4ee5\u589e\u52a0\u8be5\u503c(\u9ed8\u8ba4\uff1a1000)\nnet.core.somaxconn = 1024  # \u589e\u52a0incoming\u8fde\u63a5\u6570,somaxconn\u5b9a\u4e49\u6bcf\u4e2alisten\u8c03\u7528\u5206\u914d\u7684request_sock\u7ed3\u6784\u7684\u6570\u91cf\u3002\u6b64\u961f\u5217\u5728\u76d1\u542c\u5957\u63a5\u5b57\u7684\n                           \u751f\u547d\u5468\u671f\u4e2d\u662f\u6301\u4e45\u6027\u7684,web\u5e94\u7528\u73af\u5883\u975e\u5e38\u6709\u5fc5\u8981\u8c03\u6574\u6b64\u503c\n\nnet.core.default_qdisc = fq     # \u63a8\u8350\u7528\u4e8eCentos7\u3001Debian8\u4e3b\u673a\n                                \u5728centos5\u62166\u4e3b\u673a\u9700\u8981\u5728/etc/rc.local\u6dfb\u52a0\uff1a/sbin/ifconfig ethN txqueuelen 10000\n                                (N\u4ee3\u886810G NIC\u7684\u7f16\u53f7\uff0c\u5373\u4e07\u5146\u7f51\u5361\u7684\u7cfb\u7edf\u7f16\u53f7)\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a/proc/sys/fs/\n\nfs.file-max = 2097152    # \u589e\u52a0\u6587\u4ef6\u53e5\u67c4\u548cinode\u7f13\u5b58\u7684\u5927\u5c0f\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e3a\uff1a/proc/sys/net/ipv4/\n\nnet.ipv4.ip_forward = 1 # \u503c\u4e3a0\u8868\u793a\u7981\u6b62\u6570\u636e\u8f6c\u53d1\uff0c1\u5219\u5f00\u542f\nnet.ipv4.tcp_no_metrics_save = 1    # \u4e0d\u8981\u5728\u5173\u95ed\u8fde\u63a5\u65f6\u7f13\u5b58metrics\nnet.ipv4.tcp_congestion_control = cubic # \u8bbe\u7f6e\u9ed8\u8ba4\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u662fcubic,(\u63a8\u8350\u4f7f\u7528htcp)\nnet.ipv4.tcp_mtu_probing = 1    # \u8bbe\u7f6e\u4e3b\u673a\u542f\u7528jumbo frames\uff0c\u907f\u514dMTU\u9ed1\u6d1e\u95ee\u9898\nnet.ipv4.tcp_rfc1337 = 1    # \u9632\u6b62TCP\u65f6\u95f4\u7b49\u5f85\nnet.ipv4.icmp_echo_ignore_broadcasts = 1     # \u8bbe\u7f6e\u4e3a1\u8868\u793a\u5ffd\u7565icmp\u5e7f\u64ad\u8bf7\u6c42,\u907f\u514d\u653e\u5927\u653b\u51fb\nnet.ipv4.icmp_echo_ignore_all = 1    # \u5ffd\u7565\u6240\u6709icmp\u8bf7\u6c42,\u5373\u5173\u95edping\nnet.ipv4.icmp_ignore_bogus_error_responses = 1      # \u5f00\u542f\u6076\u610ficmp\u9519\u8bef\u6d88\u606f\u4fdd\u62a4\nnet.ipv4.tcp_keepalive_time = 600   # TCP\u53d1\u9001keepalive\u6d88\u606f\u7684\u9891\u7387(\u5355\u4f4d\uff1a\u79d2),\u7528\u4e8e\u786e\u8ba4TCP\u8fde\u63a5\u662f\u5426\u6709\u6548\uff0c\u9632\u6b62\u5efa\u7acb\u8fde\u63a5\u4f46\u4e0d\u53d1\u9001\u6570\u636e\u7684\u653b\u51fb\nnet.ipv4.tcp_keepalive_probes = 5   # \u53d1\u9001keepalive\u6d88\u606f\u8d85\u65f6\u4e4b\u524d\u7684\u63a2\u6d4b\u6b21\u6570    # \u9ed8\u8ba4\u503c\uff1a9\uff0c\u63a8\u83505\nnet.ipv4.tcp_keepalive_intvl = 15   # \u786e\u5b9a\u4e86isAlive\u95f4\u9694\u63a2\u6d4b\u4e4b\u95f4\u7684\u7b49\u5f85\u65f6\u95f4   (\u9ed8\u8ba475s,\u5efa\u8bae15-30s)\nnet.ipv4.tcp_retries1 = 3   # \u653e\u5f03\u56de\u5e94\u4e00\u4e2aTCP\u8fde\u63a5\u8bf7\u6c42\u524d\u8fdb\u884c\u91cd\u8bd5\u7684\u6b21\u6570\u3002RFC\u89c4\u5b9a\u503c\u6700\u4f4e\u4e3a3\uff0c\u9ed8\u8ba4\u503c\u4e3a3\nnet.ipv4.tcp_retries2 = 5   # \u5728\u4e22\u5f03\u6fc0\u6d3b\u5df2\u5efa\u7acb\u901a\u8baf\u72b6\u51b5\u7684TCP\u8fde\u63a5\u4e4b\u524d\ufe50\u9700\u8981\u8fdb\u884c\u591a\u5c11\u6b21\u91cd\u8bd5\u3002\u9ed8\u8ba4\u503c\u4e3a15\nnet.ipv4.tcp_orphan_retries = 3 # \u672c\u5730\u4e22\u5f03TCP\u8fde\u63a5\u524d\u8fdb\u884c\u7684\u91cd\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba47\nnet.ipv4.tcp_abort_on_overflow = 0  # \u5b88\u62a4\u8fdb\u7a0b\u8fc7\u4e8e\u7e41\u5fd9\u4e0d\u80fd\u63a5\u53d7\u65b0\u7684\u8fde\u63a5\u65f6\uff0c\u5c31\u53d1\u9001reset\u4fe1\u606f\uff0c\u9ed8\u8ba40\nnet.ipv4.tcp_stdurg = 0 # \u9ed8\u8ba4\u4f7f\u7528tcp urg pointer\u5b57\u6bb5\u4e2d\u7684\u4e3b\u673a\u8bf7\u6c42\u89e3\u91ca\u529f\u80fd\uff0c\u6253\u5f00\u53ef\u80fd\u5bfc\u81f4\u4e0d\u80fd\u6b63\u5e38\u901a\u4fe1(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.tcp_window_scaling = 1 # \u652f\u6301\u66f4\u5927\u7684TCP/ip\u4f1a\u8bdd\u7684\u6ed1\u52a8\u7a97\u53e3,\u5982\u679cTCP\u7a97\u53e3\u6700\u5927\u8d85\u8fc765535(64K), \u5fc5\u987b\u8bbe\u7f6e\u8be5\u6570\u503c\u4e3a1\nnet.ipv4.tcp_timestamps = 1 # \u53ef\u9632\u8303\u4f2a\u9020\u7684sequence\u53f7\u7801\uff0c\u542f\u7528\u5b9e\u73b0\u66f4\u597d\u7684\u7f51\u7edc\u6027\u80fd(\u9ed8\u8ba4\uff1a1)\nnet.ipv4.tcp_sack = 1   # \u5f00\u542f\u6709\u9009\u62e9\u7684\u5e94\u7b54,\u7528\u4e8e\u67e5\u770b\u7279\u5b9a\u7684\u9057\u5931\u6570\u636e\u5305\uff0c\u7528\u4e8e\u5feb\u901f\u6062\u590d\u8fde\u63a5\u72b6\u6001(\u9ed8\u8ba41)\nnet.ipv4.tcp_fack = 1  # \u6253\u5f00fack\u62e5\u585e\u907f\u514d\u548c\u5feb\u901f\u91cd\u4f20\u529f\u80fd\uff0c\u6ce8\u610f\uff1a\u5f53tcp_sack\u8bbe\u7f6e\u4e3a0\u65f6\uff0c\u6b64\u503c\u8bbe\u7f6e1\u4e5f\u662f\u65e0\u6548\u7684(\u9ed8\u8ba4\uff1a1)\nnet.ipv4.tcp_dsack = 1 # \u5141\u8bb8TCP\u53d1\u9001\"\u4e24\u4e2a\u5b8c\u5168\u76f8\u540c\"\u7684SACK(\u9ed8\u8ba4\uff1a1)\nnet.ipv4.tcp_ecn = 0   # TCP\u7684\u76f4\u63a5\u62e5\u585e\u901a\u544a\u529f\u80fd(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.tcp_reordering = 5 # TCP\u6d41\u4e2d\u91cd\u6392\u5e8f\u7684\u6570\u636e\u62a5\u6700\u5927\u6570\u91cf\u3002\u4e00\u822c\u63a8\u8350\u628a\u8fd9\u4e2a\u6570\u503c\u7565\u5fae\u8c03\u6574\u5927\u4e00\u4e9b(\u9ed8\u8ba4\uff1a3)\nnet.ipv4.tcp_retrans_collapse = 0  # \u5bf9\u4e8e\u67d0\u4e9b\u6709bug\u7684\u6253\u5370\u673a\u63d0\u4f9b\u9488\u5bf9\u5176bug\u7684\u517c\u5bb9\u6027\u3002\u4e00\u822c\u4e0d\u9700\u8981\u8fd9\u4e2a\u652f\u6301,\u53ef\u4ee5\u5173\u95ed\u5b83(\u9ed8\u8ba4\uff1a1)\nnet.ipv4.tcp_app_win = 31   # \u4fdd\u7559max_window/2^tcp_app_win\u6570\u91cf\u7684\u7528\u4e8e\u5e94\u7528\u7f13\u5b58\uff0c0\u8868\u793a\u4e0d\u9700\u8981\u7f13\u5b58(\u9ed8\u8ba4\uff1a31)\nnet.ipv4.tcp_adv_win_scale = 2  # \u8ba1\u7b97\u7f13\u51b2\u5f00\u9500(\u9ed8\u8ba4\uff1a2)\nnet.ipv4.tcp_low_latency = 0    # \u5141\u8bb8tcp/ip\u6808\u5728\u9ad8\u541e\u5410\u4e0b\u4f4e\u5ef6\u8fdf\uff0c\u4e00\u822c\u7981\u7528\uff0c\u4f46\u5728beowulf\u96c6\u7fa4\u4e2d\u6253\u5f00\u5f88\u6709\u5e2e\u52a9(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.tcp_westwood = 0   # \u542f\u7528\u53d1\u9001\u7aef\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\uff0c\u53ef\u5bf9\u5e26\u5bbd\u5229\u7528\u60c5\u51b5\u8fdb\u884c\u4f18\u5316(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.tcp_bic = 0    # \u4e3a\u5feb\u901f\u957f\u8ddd\u79bb\u7f51\u7edc\u542f\u7528binary increase congestion\uff1b\u53ef\u66f4\u597d\u5229\u7528(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.ip_local_port_range = 1024 65000   # \u5bf9\u5916\u8fde\u63a5\u7aef\u53e3\u8303\u56f4\uff0cRHEL 7 default: 32768 61000\nnet.ipv4.ip_conntrack_max = 65536   # \u7cfb\u7edf\u6700\u5927\u652f\u6301\u7684ipv4\u8fde\u63a5\u6570(\u9ed8\u8ba4\uff1a65536)\uff0c\u4f46\u5982\u679c\u5185\u5b58128M\u4ee5\u4e0b\uff0c\u6700\u5927\u53ea\u67098192\nnet.ipv4.tcp_syncookies = 1 # \u5f00\u542fSYN Cookies\uff0c\u5f53\u51fa\u73b0SYN\u7b49\u5f85\u961f\u5217\u6ea2\u51fa\u65f6\uff0c\u542f\u7528cookies\u6765\u5904\u7406\uff0c\u53ef\u4ee5\u505aSYN\u6d2a\u6c34\u653b\u51fb\u4fdd\u62a4(\u9ed8\u8ba4\uff1a0)\nnet.ipv4.tcp_syn_retries = 3        # \u5728\u5185\u6838\u653e\u5f03\u5efa\u7acb\u8fde\u63a5\u4e4b\u524d\u53d1\u9001SYN\u5305\u7684\u6570\u91cf,\u6b64\u503c\u4e0d\u5e94\u5927\u4e8e255\uff0c\u9ed8\u8ba4\u662f5\uff0c\u9ad8\u8d1f\u8f7d\u7269\u7406\n                                    \u901a\u4fe1\u826f\u597d\u65f6\uff0c\u5efa\u8bae\u4e3a2\uff0c\u6b64\u503c\u4ec5\u9488\u5bf9\u5bf9\u5916\u8fde\u63a5\uff0c\u5bf9\u8fdb\u6765\u7684\u8fde\u63a5\u5219\u7531tcp_retries\u51b3\u5b9a\nnet.ipv4.tcp_synack_retries = 2 # \u5bf9\u4e8e\u8fdc\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42SYN\uff0c\u5185\u6838\u4f1a\u53d1\u9001SYN+ACK\u6570\u636e\u5305\u4ee5\u786e\u8ba4\u6536\u5230\u4e0a\u4e00\u4e2aSYN\u8bf7\u6c42\u3002\u5373\u4e09\u6b21\u63e1\u624b\u7684\u7b2c\u4e8c\u6b21\u63e1\u624b\n                                \u6b64\u8bbe\u7f6e\u51b3\u5b9a\u5185\u6838\u653e\u5f03\u8fde\u63a5\u4e4b\u524d\u53d1\u9001SYN+ACK\u5305\u7684\u6570\u91cf\uff0c\u4e0d\u5e94\u5927\u4e8e255\uff0c\u9ed8\u8ba4\u4e3a5\nnet.ipv4.tcp_fin_timeout = 15   # \u6b64\u53c2\u6570\u51b3\u5b9a\u4e86TCP\u8fde\u63a5\u4fdd\u6301\u5728FIN-WAIT-2\u72b6\u6001\u7684\u65f6\u95f4\uff0c(\u9ed8\u8ba460s\uff0c\u5efa\u8bae15-30s)\u5bf9\u4e8e\u751f\u6210\u6216\u652f\u6301\u9ad8\u7ea7\u522b\u7f51\u7edc\n                                \u6d41\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u7cfb\u7edf\uff0c\u6b64\u503c\u8bbe\u7f6e\u523010\u79d2\u4ee5\u4e0b\nnet.ipv4.tcp_max_syn_backlog = 2048 # \u8bb0\u5f55\u5c1a\u672a\u6536\u5230\u5ba2\u6237\u7aef\u786e\u8ba4\u4fe1\u606f\u7684\u8fde\u63a5\u8bf7\u6c42\u7684\u6700\u5927\u503c\uff0c\u5185\u5b58\u5927\u4e8e128Mb\u9ed8\u8ba41024\uff0c\u5185\u5b58\u5c0f\u4e8e128\u65f6\uff0c\u5219\u503c\n                                      \u9ed8\u8ba4\u65f6128,\u670d\u52a1\u5668\u8fc7\u8f7d\u65f6\u53ef\u589e\u52a0\u6b64\u503c\nnet.ipv4.tcp_limit_output_bytes = 131072 # \u9ed8\u8ba4\u662f262144\u5b57\u8282\uff1b\u9650\u5236\u8bbe\u5907\u4e0a\u7684\u5b57\u8282\u6570\uff0c\u4ee5\u51cf\u5c11\u8f83\u5927\u961f\u5217\u5927\u5c0f\u5bfc\u81f4\u7684\u5ef6\u8fdf\u6548\u5e94\uff1b\u5bf9\u4e8e\u5ef6\u8fdf\u4f18\u5148\n                                         \u7ea7\u9ad8\u4e8e\u541e\u5410\u91cf\u7684\u5de5\u4f5c\u8d1f\u8f7d\u6216\u73af\u5883\uff0c\u964d\u4f4e\u6b64\u503c\u53ef\u4ee5\u6539\u5584\u5ef6\u8fdf\uff0c\u63a8\u8350131072\u5b57\u8282\n\n# \u589e\u52a0time-wait\u5b58\u50a8\u6c60\u5927\u5c0f\u53ef\u9632\u6b62\u7b80\u5355DOS\u653b\u51fb\nnet.ipv4.tcp_max_tw_buckets = 1440000 # \u6307\u5b9a\u5141\u8bb8\u5728\u4efb\u4f55\u65f6\u95f4\u5b58\u5728\u7684\u201ctime-wait\u201d\u72b6\u6001\u7684\u6700\u5927sockets\u6570\u3002\u5982\u679c\u8d85\u8fc7\u6700\u5927\u503c\uff0c\u5219\u4f1a\u7acb\u5373\u9500\u6bc1\u5904\u4e8e\n                                    \u201ctime-wait\u201d\u72b6\u6001\u7684\u5957\u63a5\u5b57\u5e76\u663e\u793a\u8b66\u544a\u3002\u6b64\u8bbe\u7f6e\u7528\u4e8e\u963b\u6b62\u67d0\u4e9b\u7c7b\u578b\u7684\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\u5728\u964d\u4f4e\u6b64\u503c\u4e4b\u524d\u5e94\u5c0f\u5fc3\n                                    \u8c28\u614e\u3002\u66f4\u6539\u540e\uff0c\u5e94\u589e\u52a0\u5176\u503c\uff0c\u5c24\u5176\u662f\u5728\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e86\u66f4\u591a\u5185\u5b58\u6216\u7f51\u7edc\u9700\u6c42\u8f83\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5916\u90e8\u5a01\u80c1\u5f71\u54cd\u65f6\n                                    \u9ed8\u8ba4262144\uff0c\u5f53\u7f51\u7edc\u9700\u6c42\u5f88\u9ad8\u4e14\u73af\u5883\u8f83\u5c11\u53d7\u5230\u5916\u90e8\u5a01\u80c1\u65f6\uff0c\u53ef\u4ee5\u589e\u52a0\u5230450000\nnet.ipv4.tcp_tw_recycle = 1 # \u5f00\u542fTCP\u8fde\u63a5\u4e2dtime_wait sockets\u7684\u5feb\u901f\u56de\u6536,\u9ed8\u8ba4\u4e3a0\nnet.ipv4.tcp_tw_reuse = 1   # \u5f00\u542fTCP\u8fde\u63a5\u590d\u7528\uff0c\u5141\u8bb8\u5c06time_wait sockets\u91cd\u65b0\u7528\u4e8e\u65b0\u7684TCP\u8fde\u63a5(\u4e3b\u8981\u9488\u5bf9time_wait\u8fde\u63a5)\u542f\u7528\u540e\uff0c\u6b64\u53c2\u6570\n                            \u53ef\u4ee5\u7ed5\u8fc7\u901a\u5e38\u4e0e\u5957\u63a5\u5b57\u521b\u5efa\u76f8\u5173\u7684\u5206\u914d\u548c\u521d\u59cb\u5316\u5f00\u9500\uff0c\u4ece\u800c\u8282\u7701CPU\u5468\u671f\uff0c\u7cfb\u7edf\u8d1f\u8f7d\u548c\u65f6\u95f4\nnet.ipv4.tcp_max_orphans = 32768  # \u544a\u8bc9\u5185\u6838\u6709\u591a\u5c11TCP\u5957\u63a5\u5b57\u672a\u9644\u52a0\u5230\u7cfb\u7edf\u4fdd\u7559\u7684\u4efb\u4f55\u7528\u6237\u6587\u4ef6\u53e5\u67c4\u7684\u6700\u5927\u6570\u91cf,\u5982\u679c\u8d85\u8fc7\u6b64\u6570\u91cf\uff0c\u5219\u7acb\u5373\u91cd\u7f6e\n                                    \u5b64\u7acb\u8fde\u63a5\u5e76\u6253\u5370\u8b66\u544a\u3002\u6b64\u9650\u5236\u4ec5\u7528\u4e8e\u9632\u6b62\u7b80\u5355\u7684DoS\u653b\u51fb\uff0c\u4f46\u4e0d\u80fd\u4eba\u4e3a\u5730\u4f9d\u8d56\u6b64\u9650\u5236\u6216\u964d\u4f4e\u9650\u5236\uff0c\u800c\u662f\u589e\u52a0\n                                    \u5b83\uff08\u53ef\u80fd\u5728\u589e\u52a0\u5df2\u5b89\u88c5\u7684\u5185\u5b58\u4e4b\u540e\uff09\uff0c\u5982\u679c\u7f51\u7edc\u6761\u4ef6\u9700\u8981\u8d85\u8fc7\u9ed8\u8ba4\u503c\uff0c\u8c03\u6574\u7f51\u7edc\u670d\u52a1\u4ee5\u5ef6\u8fdf\u5e76\u66f4\u79ef\u6781\u5730\u6740\u6b7b\n                                    \u8fd9\u4e9b\u72b6\u6001\u3002\u518d\u6b21\u63d0\u9192\uff1a\u6bcf\u4e2aorphan\u90fd\u4f1a\u5403\u6389\u5927\u7ea664K\u7684unswappable\u5185\u5b58(\u9ed8\u8ba4\uff1a8192)\n\n# \u589e\u52a0\u8bfb\u53d6\u7f13\u51b2\u533a\u7a7a\u95f4\nnet.ipv4.udp_rmem_min = 16384\nnet.ipv4.tcp_rmem = 4096 87380 25165824 # \u4e09\u4e2a\u503c\u8868\u793aTCP\u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684\u6700\u5c0f\u503c\u3001\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c\n\n# \u589e\u52a0\u53ef\u5206\u914d\u7684\u5199\u7f13\u51b2\u533a\u7a7a\u95f4\nnet.ipv4.udp_wmem_min = 16384\nnet.ipv4.tcp_wmem = 4096 65536 25165824 # \u4e09\u4e2a\u53c2\u6570\u4f9d\u6b21\u4e3a\uff1a\u6700\u5c0f\u503c\uff0c\u9ed8\u8ba4\u503c\u548c\u6700\u5927\u503c\uff1b\u6700\u5c0f\u503c\u8868\u793a\u65b0\u521b\u5efa\u7684\n                                            \u5957\u63a5\u5b57\u4f5c\u4e3a\u5176\u521b\u5efa\u7684\u4e00\u90e8\u5206\u6709\u6743\u83b7\u5f97\u7684\u6700\u5c0f\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff1b\u9ed8\u8ba4\u503c\u8868\u793aTCP\u5957\u63a5\u5b57\u63a5\u6536\u7f13\u51b2\u533a\u7684\n                                            \u521d\u59cb\u5927\u5c0f\uff1b\u6700\u5927\u503c\u8868\u793aTCP\u5957\u63a5\u5b57\u7684\u81ea\u52a8\u8c03\u6574\u53d1\u9001\u7f13\u51b2\u533a\u7684\u6700\u5927\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f\uff0c\u8be5\u503c\u4e0d\u4f1a\u8986\u76d6\n                                            net.core.rmem_max\u3002\u6839\u636e\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684\u5185\u5b58\u91cf\uff0c\u6b64\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\u4ecb\u4e8e64K\u5b57\u8282\u548c4M\u5b57\u8282\u4e4b\u95f4\n                                            \u5efa\u8bae\u4f7f\u752816M\u5b57\u8282\u6216\u66f4\u9ad8\u7684\u6700\u5927\u503c\uff08\u53d6\u51b3\u4e8e\u5185\u6838\u7ea7\u522b\uff09\uff0c\u5c24\u5176\u662f10\u5343\u5146\u4f4d\u9002\u914d\u5668\n\n# \u589e\u52a0\u53ef\u5206\u914d\u7684\u6700\u5927\u603b\u7f13\u51b2\u533a\u7a7a\u95f4,\u6b64\u4e3a\u4ee5page\u4e3a\u5355\u4f4d\uff084096\u5b57\u8282\uff09\u6d4b\u91cf\nnet.ipv4.udp_mem = 65536 131072 262144\nnet.ipv4.tcp_mem = 65536 131072 262144  # \u7b2c\u4e00\u6b21\u4f4e\u4e8e\u6b64\u503c,TCP\u6ca1\u6709\u5185\u5b58\u538b\u529b,\u7b2c\u4e8c\u6b21\u8fdb\u5165\u5185\u5b58\u538b\u529b\u9636\u6bb5,\n                                        \u7b2c\u4e09\u6b21TCP\u62d2\u7edd\u5206\u914dsocket(\u9ed8\u8ba4\uff1a5814 7754 11628)\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ca\u5176\u76ee\u5f55\u4e0b\uff1a/proc/sys/net/ipv4/conf/\n\n#\u542f\u7528\u6e90\u8def\u7531\u6838\u67e5\u529f\u80fd\uff0c\u53cd\u5411\u8def\u5f84\u8fc7\u6ee4\n# 0 \u2014\u2014\u672a\u8fdb\u884c\u6e90\u9a8c\u8bc1\n# 1 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u4e25\u683c\u6a21\u5f0f\n# 2 \u2014\u2014\u5904\u4e8e\u5982 RFC3704 \u6240\u5b9a\u4e49\u7684\u677e\u6563\u6a21\u5f0f\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\n# \u786e\u4fdd\u65e0\u4eba\u80fd\u4fee\u6539\u8def\u7531\u8868\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0  # \u7981\u6b62icmp\u91cd\u5b9a\u5411\u68c0\u67e5\nnet.ipv4.conf.default.secure_redirects = 0\n\n# \u4e0d\u5145\u5f53\u8def\u7531\u5668\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n# \u8bb0\u5f55\u5728\u4e0d\u53ef\u8fbe\u7684\u5730\u5740\u7684\u6570\u636e\u5305(\u9519\u8bef\u7684\u8def\u7531)\uff1b\u5f00\u542f\u5e76\u8bb0\u5f55\u6b3a\u9a97\u3001\u6e90\u8def\u7531\u3001\u91cd\u5b9a\u5411\u6570\u636e\u5305\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nnet.ipv4.conf.all.accept_source_route = 0   # \u5904\u7406\u65e0\u6e90\u8def\u7531\u7684\u5305\nnet.ipv4.conf.default.accept_source_route = 0   # \u7981\u7528\u6240\u6709IP\u6e90\u8def\u7531\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\uff1a/proc/sys/net/ipv4/route/\n\nnet.ipv4.route.gc_timeout = 100     # \u8def\u7531\u5237\u65b0\u9891\u7387\n\n# \u4e0b\u5217\u53c2\u6570\u8bbe\u7f6e\u540e\uff0c\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b(\u9632\u706b\u5899\u76f8\u5173)\uff1a/proc/sys/net/netfilter/\n\n# nf_conntrack\u662fLinux\u5185\u6838\u8fde\u63a5\u8ddf\u8e2a\u7684\u6a21\u5757\uff1a\u4e0enf_conntrack\u76f8\u5173\u7684\u5185\u6838\u53c2\u6570\u6709\u4e09\u4e2a\uff1a\n# 1\u3001nf_conntrack_max\uff1a\u8fde\u63a5\u8ddf\u8e2a\u8868\u7684\u5927\u5c0f\uff0c\u5efa\u8bae\u6839\u636e\u5185\u5b58\u8ba1\u7b97\u8be5\u503cCONNTRACK_MAX = RAMSIZE (in bytes) / 16384 / (x / 32)\n     \u5e76\u6ee1\u8db3nf_conntrack_max=4*nf_conntrack_buckets\uff0c\u9ed8\u8ba4262144\n# 2\u3001nf_conntrack_buckets\uff1a\u54c8\u5e0c\u8868\u7684\u5927\u5c0f\uff0c(nf_conntrack_max/nf_conntrack_buckets\u5c31\u662f\u6bcf\u6761\u54c8\u5e0c\u8bb0\u5f55\u94fe\u8868\u7684\u957f\u5ea6)\uff0c\u9ed8\u8ba465536\n# 3\u3001nf_conntrack_tcp_timeout_established\uff1atcp\u4f1a\u8bdd\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\uff1a432000 (5\u5929)\n\n# \u4ee5\u4e0b\u4e3a64\u5185\u5b58\u63a8\u8350\u914d\u7f6e\nnet.nf_conntrack_max = 262144\nnet.netfilter.nf_conntrack_max = 65536   # \u7cfb\u7edf\u652f\u6301\u7684\u6700\u5927ipv4\u8fde\u63a5\u6570(\u9ed8\u8ba4\uff1a65536)\nnet.netfilter.nf_conntrack_tcp_timeout_established = 300 # \u5df2\u5efa\u7acb\u7684tcp\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4(\u9ed8\u8ba4\uff1a43200\uff0c\u53735\u5929)\nnet.netfilter.nf_conntrack_buckets = 1048576(\u9ed8\u8ba4\uff1a65535)\nnet.netfilter.nf_conntrack_tcp_timeout_time_wait = 30  # time_wait\u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5(\u9ed8\u8ba4\uff1a120)\nnet.netfilter.nf_conntrack_tcp_timeout_close_wait = 60  # close_wait\u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5(\u9ed8\u8ba4\uff1a60)\nnet.netfilter.nf_conntrack_tcp_timeout_fin_wait = 30    # fin_wait\u72b6\u6001\u8d85\u65f6\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u5c31\u6e05\u9664\u8be5\u8fde\u63a5(\u9ed8\u8ba4\uff1a120)\n</code></pre>"},{"location":"system/linux/Centos/#_10","title":"\u4e0d\u5e38\u7528\u8bbe\u7f6e\u548c\u8bb0\u5f55","text":""},{"location":"system/linux/Centos/#_11","title":"\u670d\u52a1\u5668\u914d\u7f6e\u53cc\u673a\u4e92\u4fe1","text":"Bash<pre><code># \u670d\u52a1\u56681\u7684IP\uff1a192.168.1.1   \u670d\u52a1\u56682\u7684IP\uff1a192.168.1.2\n# \u5728\u4e24\u53f0\u670d\u52a1\u5668\u4e0a\u5206\u522b\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\nssh-keygen -t rsa -b 4096   # \u521b\u5efa\u516c\u94a5\u548c\u5bc6\u94a5\ncat ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys    # \u5c06\u81ea\u5df1\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5\n\n# \u5c06\u516c\u94a5\u4e92\u76f8\u590d\u5236\u5230\u5bf9\u5e94\u7684\u4e3b\u673a\n# \u65b9\u6cd5\u4e00:\u4f7f\u7528ssh-copy-id\u547d\u4ee4\nssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.2 # \u57281\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.2,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys\nssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.1.1 # \u57282\u4e3b\u673a\u6267\u884c\uff0c\u590d\u5236\u516c\u94a5\u5230\u8fdc\u7a0b\u4e3b\u673a192.168.1.1,cat\u8ffd\u52a0\u516c\u94a5\u5230authorized_keys\n\n# \u65b9\u6cd5\u4e8c\uff1a\u4f7f\u7528ssh\u547d\u4ee4\u5e76\u7528cat\u8ffd\u52a0\u5230authorized_keys\u4e2d\nssh 192.168.1.2 cat ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys    # \u5728\u670d\u52a1\u56681\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56682\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5\nssh 192.168.1.1 cat ~/.ssh/id_rsa.pub &gt;&gt; authorized_keys    # \u5728\u670d\u52a1\u56682\u4e0a\u64cd\u4f5c\uff0c\u5c06\u670d\u52a1\u56681\u7684\u516c\u94a5\u8ffd\u52a0\u5230\u8ba4\u8bc1\u516c\u94a5\nssh 192.168.1.2 ifconfig    # \u6d4b\u8bd5,\u5728\u670d\u52a1\u56681\u4e0a\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u7684\u8bdd\u5c31\u65e0\u9700\u8f93\u5165\u5bc6\u7801\u4e5f\u80fd\u663e\u793a\u670d\u52a1\u56682\u7684\u7f51\u5361\u4fe1\u606f\n</code></pre>"},{"location":"system/linux/Centos/#centospythonyum","title":"centos\u5b8c\u5168\u91cd\u88c5python\u548cyum","text":"Bash<pre><code># \u5220\u9664\u73b0\u6709Python\nrpm -qa|grep python| xargs rpm -ev --allmatches --nodeps # \u5f3a\u5236\u5220\u9664\u5df2\u5b89\u88c5\u7a0b\u5e8f\u53ca\u5176\u5173\u8054\nwhereis python | xargs rm -frv # \u5220\u9664\u6240\u6709\u6b8b\u4f59\u6587\u4ef6,xargs\uff0c\u5141\u8bb8\u4f60\u5bf9\u8f93\u51fa\u6267\u884c\u5176\u4ed6\u67d0\u4e9b\u547d\u4ee4\nwhereis python # \u9a8c\u8bc1\u5220\u9664\uff0c\u8fd4\u56de\u65e0\u7ed3\u679c\n\n# \u5220\u9664\u73b0\u6709\u7684yum\nrpm -qa|grep yum| xargs rpm -ev --allmatches --nodeps\nwhereis yum | xargs rm -frv\n\n# \u4ecehttp://mirrors.aliyun.com/centos/7/os/x86_64/Packages/\u4e0b\u8f7d\u76f8\u5e94\u7684\u5305,\u7531\u4e8e\u6e90\u4e2d\u7248\u672c\u4f1a\u66f4\u65b0\uff0c\u5177\u4f53\u8bf7\u67e5\u770bURL\u4e2d\u7684\u7248\u672c\uff01\nrpm -Uvh --replacepkgs *.rpm    # \u53ef\u80fd\u4e4b\u95f4\u8fd8\u9700\u8981zlib\u548czlib-devel\u5305\uff0c\u6839\u636e\u60c5\u51b5\u4e0b\u8f7d\u5e76\u5b89\u88c5\uff01\u5b89\u88c5\u5b8c\u8fdb\u884c\u6d4b\u8bd5\n\n# \u6e90\u7801\u7f16\u8bd1\u5b89\u88c5yum\nwget http://yum.baseurl.org/download/3.4/yum-3.4.3.tar.gz\ntar xvf yum-3.4.3.tar.gz &amp;&amp; cd yum-3.4.3\nyummain.py install yum\n# \u5982\u679c\u7ed3\u679c\u63d0\u793a\u9519\u8bef\uff1a CRITICAL:yum.cli:Config Error: Error accessing file for config file:///etc/\u7f3a\u5c11\u914d\u7f6e\u6587\u4ef6\n# \u5728etc\u76ee\u5f55\u4e0b\u9762\u65b0\u5efayum.conf\u6587\u4ef6\uff0c\u7136\u540e\u518d\u6b21\u8fd0\u884c yummain.py install yum\uff0c\u987a\u5229\u5b8c\u6210\u5b89\u88c5\n</code></pre>"},{"location":"system/linux/Centos/#root","title":"\u666e\u901a\u8d26\u53f7\u8d4b\u4e88root\u6743\u9650","text":"Bash<pre><code># \u5efa\u8bae\u4f7f\u7528\u65b9\u6cd5\u4e8c\uff0c\u4e0d\u8981\u8f7b\u6613\u4f7f\u7528\u65b9\u6cd5\u4e09\n: &lt;&lt; comment\n# \u65b9\u6cd5\u4e00\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230%wheel\u4e00\u884c\uff0c\u628a\u524d\u9762\u7684\u6ce8\u91ca\uff08#\uff09\u53bb\u6389\nAllows people in group wheel to run all commands\n%wheel    ALL=(ALL)    ALL\n\u7136\u540e\u4fee\u6539\u7528\u6237\uff0c\u4f7f\u5176\u5c5e\u4e8eroot\u7ec4\uff08wheel\uff09\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a\n#usermod -g root tommy\n\u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c\ncomment\n\n: &lt;&lt; comment\n# \u65b9\u6cd5\u4e8c\uff1a \u4fee\u6539 /etc/sudoers \u6587\u4ef6\uff0c\u627e\u5230root\u4e00\u884c\uff0c\u5728root\u4e0b\u9762\u6dfb\u52a0\u4e00\u884c\uff0c\u5982\u4e0b\u6240\u793a\uff1a\nAllow root to run any commands anywhere\nroot    ALL=(ALL)     ALL\ntommy   ALL=(ALL)     ALL\n\u4fee\u6539\u5b8c\u6bd5\uff0c\u73b0\u5728\u53ef\u4ee5\u7528tommy\u5e10\u53f7\u767b\u5f55\uff0c\u7136\u540e\u7528\u547d\u4ee4 sudo su - \uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u8fdb\u884c\u64cd\u4f5c\ncomment\n\n: &lt;&lt; comment\n# \u65b9\u6cd5\u4e09\uff1a \u4fee\u6539 /etc/passwd \u6587\u4ef6\uff0c\u627e\u5230\u5982\u4e0b\u884c\uff0c\u628a\u7528\u6237ID\u4fee\u6539\u4e3a 0 \uff0c\u5982\u4e0b\u6240\u793a\uff1a\ntommy:x:500:500:tommy:/home/tommy:/bin/bash\n\u4fee\u6539\u540e\u5982\u4e0b\ntommy:x:0:500:tommy:/home/tommy:/bin/bash\n\u4fdd\u5b58\uff0c\u7528tommy\u8d26\u6237\u767b\u5f55\u540e\uff0c\u76f4\u63a5\u83b7\u53d6\u7684\u5c31\u662froot\u5e10\u53f7\u7684\u6743\u9650\ncomment\n</code></pre>"},{"location":"system/linux/Centos/#-float-ipip","title":"\u672a\u91c7\u7528\u53cc\u673a\u70ed\u5907\u9632\u6b62\u670d\u52a1\u4e2d\u65ad--float IP(\u6d6e\u52a8IP\u914d\u7f6e)","text":"Bash<pre><code>: &lt;&lt; comment\n\u6709\u4e24\u53f0Linux\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u4e00\u53f0\u4e3b\u673a\uff08IP\uff1a192.168.2.2\uff09\u5bf9\u5916\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u53e6\u4e00\u53f0\u4ece\u673a\uff08IP\uff1a192.168.2.3\uff09\u80fd\u63d0\u4f9b\u76f8\u540c\u7684\u670d\u52a1\uff0c\u4f46IP\u5730\u5740\n\u6ca1\u6709\u5bf9\u5916\u90e8\u516c\u5f00,\u5ba2\u6237\u7aef\u8fde\u63a5\u7684\u90fd\u662f192.168.2.2\u8fd9\u4e2aIP\u5730\u5740\uff0c\u5982\u679c\u4e3b\u673a\u6545\u969c\uff0c\u5219\u4f1a\u4f7f\u7f51\u7edc\u670d\u52a1\u6682\u65f6\u4e2d\u65ad\n\u7531\u4e8e\u6ca1\u6709\u91c7\u7528\u53cc\u673a\u70ed\u5907\u4efd\u6280\u672f,\u8003\u8651\u7528Linux\u811a\u672c\u6765\u5b9e\u73b0\u7b80\u5355\u7684\u6d6e\u52a8IP\u6280\u672f\uff0c\u5f53\u4e3b\u673a\u6545\u969c\u65f6\u4ece\u673a\u83b7\u5f97192.168.2.2\u8fd9\u4e2aIP\uff0c\u6682\u65f6\u66ff\u4ee3\u4e3b\u673a\u63d0\u4f9b\u670d\u52a1\uff0c\u5f53\u4e3b\u673a\n\u6062\u590d\u65f6\uff0c\u4ece\u673a\u81ea\u52a8\u91ca\u653e\u8fd9\u4e2aIP\n\u601d\u8def\uff1a\n\u5229\u7528\u5355\u4e2a\u7f51\u5361\u7ed1\u5b9a\u591a\u4e2aIP\u5730\u5740\u7684\u6280\u672f\u548ccrontab\u81ea\u52a8\u6267\u884c\u6280\u672f\n\u4e3a\u4e3b\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u9759\u6001IP\uff0c\u5982192.168.2.8,\u8fd9\u4e2a\u5730\u5740\u4fbf\u4e8e\u4ece\u673a\u5224\u65ad\u7684\n\u4e3a\u4ece\u673a\u7684\u7f51\u5361\u591a\u7ed1\u5b9a\u4e00\u4e2a\u52a8\u6001IP\uff0c127.0.0.1\uff0c\u5b83\u5728\u4e3b\u673a\u6545\u969c\u65f6\u5c06\u4f1a\u88ab\u811a\u672c\u4fee\u6539\u4e3a192.168.2.2\n\u5728\u4ece\u673a\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u811a\u672c /root/autoFloatIP.sh\uff0c\u4f7f\u7528crontab\u6280\u672f\u8ba9\u8fd9\u4e2a\u811a\u672c\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u8fd9\u4e2a\u811a\u672c\u7684\u4f5c\u7528\u662f\u5224\u65ad\u4e3b\u673a\u7684\u5730\u5740192.168.2.8\u80fd\u5426\nPing\u901a\uff0c\u4e00\u65e6\u4e0d\u6b63\u5e38\u5219\u5c06\u8ba9\u81ea\u5df1\u7684\u7f51\u5361\u591a\u4f59\u7684\u90a3\u4e2aIP\u5730\u5740\u6539\u4e3a192.168.2.2\uff0c\u5982\u679c\u4e3b\u673a\u6062\u590d\uff0c\u5219\u5c06\u8fd9\u4e2a\u5730\u5740\u6539\u56de\u4e3a127.0.0.1\ncomment\n# \u6b65\u9aa4\u5982\u4e0b\uff1a\n# 1. \u4e3a\u4e3b\u673a\u6dfb\u52a0\u4e00\u4e2a\u9759\u6001IP192.168.2.8\uff0c\u5728/etc/sysconfig/network-scripts\u76ee\u5f55\u4fee\u6539\u7c7b\u4f3cifcfg-eth0:1\u7684\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a:\nDEVICE=eth0:1\nIPADDR=139.24.214.82\nNETMASK= 255.255.255.0\nONBOOT= yes\n\n# 2. \u5728\u4ece\u673a\u4e0a\uff0c\u5728/root\u4e0b\u5efa\u7acb\u4e00\u4e2a\u811a\u672cautoFloatIP.sh,\u5185\u5bb9\u5982\u4e0b\uff1a\n\n#!/bin/bash\nc1=$(ping 139.24.214.82 -c 1|grep Unreachable|wc -l)\nif [ $c1 -gt 0 ] ; then\nc2=$(ping 139.24.214.82 -c 10|grep Unreachable|wc -l)\nif [ $c2 -gt 9 ] ; then\n    c3=$(ping 139.24.214.22 -c 10|grep Unreachable|wc -l)\n      if [ $c3 -gt 9 ] ; then\n         /sbin/ifconfig eth0:1 139.24.214.22 netmask 255.255.254.0\necho \"float ip to 22\"\n      fi\nfi\necho \"can not connect\"\nelse\nc4=$(/sbin/ifconfig|grep 139.24.214.22|wc -l)\nif [ $c4 -gt 0 ] ; then\n    /sbin/ifconfig eth0:2 127.0.0.1 netmask 255.255.254.0\n    echo \"reset ip\"\nfi\necho \"connection is ok\"\nfi\n\n# \u5176\u4e2d\u5173\u952e\u7684\u547d\u4ee4\u5982\u4e0b\uff0c\u7528\u8fd9\u4e2a\u65b9\u6cd5\u6765\u52a8\u6001\u4fee\u6539IP\uff0c\u52a8\u6001IP\u5728\u7535\u8111\u91cd\u542f\u4f1a\u6d88\u5931\n/sbin/ifconfig eth0:1 139.24.214.22 netmask 255.255.254.0\n/sbin/ifconfig eth0:2 127.0.0.1 netmask 255.255.254.0\n\n# 3. \u4ece\u673a\u4e0a\u5efa\u7acbcrontab\uff0c\u52a0\u4e0a\u5982\u4e0b\u4e00\u884c\u5e76\u4fdd\u5b58\n* * * * * /root/autoFloatIP.sh &gt; /dev/null 2&gt;&amp;1\n</code></pre>"},{"location":"system/linux/Centos/#centosip","title":"\u5b89\u88c5\u6700\u65b0\u7a33\u5b9acentos\u5185\u6838&amp;\u66f4\u6539\u4e3a\u9759\u6001ip\u3001\u7f51\u5361\u540d\u79f0","text":"Bash<pre><code># \u5728CentOS\u4e3b\u673a\u4e0a\u5b89\u88c5\u6700\u65b0\u7684\u7a33\u5b9a\u5185\u6838\n# \u5bfc\u5165key\uff08\u5185\u68383.0\u4ee5\u4e0a\u9700\u8981\u5bfc\u5165key\uff09,\u5982\u679c\u5df2\u7ecf\u4fee\u6539\u4e86repo\u7684gpgcheck=0\u4e5f\u53ef\u4ee5\u4e0d\u5bfc\u5165key\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\n# To install ELRepo for RHEL-6, SL-6 or CentOS-6\nrpm -Uvh http://www.elrepo.org/elrepo-release-6-8.el6.elrepo.noarch.rpm\n# \u5b89\u88c5elrepo\u7684yum\u6e90,To install ELRepo for RHEL-7, SL-7 or CentOS-7\nrpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm\n# \u5b89\u88c5\u5185\u6838,\u5728yum\u7684ELRepo\u6e90\u4e2d\uff0c\u6709mainline\u9881\u5e03\u7684\uff0c\u53ef\u4ee5\u8fd9\u6837\u5b89\u88c5\nyum --enablerepo=elrepo-kernel install  kernel-ml-devel kernel-ml -y\n\nyum --enablerepo=elrepo-kernel  install  kernel-lt -y   # \u5b89\u88c5long term\u7684\u5185\u6838\n\n# \u914d\u7f6eGrub\u4f7f\u7528\u65b0\u5185\u6838\uff0c\u914d\u7f6e\u5b8c\u540e\u91cd\u542f\u542f\u7528\u65b0\u5185\u6838\n## CentOS 6\u914d\u7f6e\uff0c\u4fee\u6539/boot/grub/grub.conf\n  default=0 # \u66f4\u6539\u4e3a 0\n  fallback=1 # \u6dfb\u52a0\u6b64\u9879\n\n## CentOS 7\ngrub2-set-default 0\ngrub2-install /dev/sda\ngrub2-mkconfig -o /boot/grub2/grub.cfg\n\n# \u66f4\u6539\u4e3a\u9759\u6001IP\uff1a/etc/sysconfig/network-scripts/ifcfg-ens33\nBOOTPROTO=\"static\" #dhcp\u6539\u4e3astatic\nONBOOT=\"yes\" #\u5f00\u673a\u542f\u7528\u672c\u914d\u7f6e\nIPADDR=192.168.7.106 #\u9759\u6001IP\nGATEWAY=192.168.7.1 #\u9ed8\u8ba4\u7f51\u5173\nNETMASK=255.255.255.0 #\u5b50\u7f51\u63a9\u7801\nDNS1=192.168.7.1 #DNS \u914d\u7f6e\n\nvim /etc/sysconfig/grub     # \u7f16\u8f91 grub \u914d\u7f6e\u6587\u4ef6,\u5b9e\u9645\u662f/etc/default/grub\u7684\u8f6f\u8fde\u63a5\n# \u4e3aGRUB_CMDLINE_LINUX\u53d8\u91cf\u589e\u52a02\u4e2a\u53c2\u6570\uff0c\u5177\u4f53\u5185\u5bb9\u5982\u4e0b(\u52a0\u7c97)\uff1a\nGRUB_CMDLINE_LINUX=\"crashkernel=auto rd.lvm.lv=cl/root rd.lvm.lv=cl/swap net.ifnames=0 biosdevname=0 rhgb quiet\"\n# \u91cd\u65b0\u751f\u6210 grub \u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8 Linux \u64cd\u4f5c\u7cfb\u7edf\uff0c\u901a\u8fc7 ip addr \u53ef\u4ee5\u770b\u5230\u7f51\u5361\u540d\u79f0\u5df2\u7ecf\u53d8\u4e3a eth0\ngrub2-mkconfig -o /boot/grub2/grub.cfg\n# \u4fee\u6539\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\uff0c\u539f\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u4e3a ifcfg-ens33\uff0c\u8fd9\u91cc\u9700\u8981\u4fee\u6539\u4e3aethx\u7684\u683c\u5f0f\uff0c\u5e76\u9002\u5f53\u8c03\u6574\u7f51\u5361\u914d\u7f6e\u6587\u4ef6\nmv /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-eth0\n# \u4fee\u6539ifcfg-eth0\u6587\u4ef6\u5982\u4e0b\u5185\u5bb9(\u5176\u5b83\u5185\u5bb9\u4e0d\u53d8)\nNAME=eth0\nDEVICE=eth0\n\nsystemctl restart network.service    # \u91cd\u542f\u7f51\u7edc\u670d\u52a1\uff0c\u6ce8\u610f\uff1aifcfg-ens33 \u6587\u4ef6\u6700\u597d\u5220\u9664\u6389\uff0c\u5426\u5219\u91cd\u542f network \u670d\u52a1\u65f6\u5019\u4f1a\u62a5\u9519\n</code></pre>"},{"location":"system/linux/Centos/#linux_5","title":"Linux\u6570\u636e\u6062\u590d\uff1a\u6700\u597d\u662f\u5907\u4efd\u800c\u4e0d\u662f\u5c1d\u8bd5\u6062\u590d","text":""},{"location":"system/linux/Centos/#systemrescuecd","title":"SystemRescueCd","text":"Bash<pre><code># \u5b98\u7f51\uff1ahttp://www.system-rescue-cd.org/\n</code></pre>"},{"location":"system/linux/Centos/#_12","title":"\u5176\u4ed6","text":"Markdown<pre><code># \u53c2\u8003\u94fe\u63a5\uff1ahttps://help.ubuntu.com/community/DataRecovery\n\n\u60c5\u51b5\u4e00\uff1a\u4e22\u5931\u5206\u533a\uff1a\u5982\u679c\u5206\u533a\u51fa\u9519\u4e14\u5206\u533a\u8868\u4e0d\u663e\u793a\u8be5\u5206\u533a\uff0c\u53ea\u8981\u672a\u5411\u8be5\u7a7a\u95f4\u5199\u5165\u6570\u636e\uff0c\u5219\u6570\u636e\u4ecd\u4f1a\u5b58\u5728\n# GNU Parted\n1. \u4f7f\u7528live cd\u6216\u989d\u5916\u7cfb\u7edf\uff0c\u8fdb\u5165\u7cfb\u7edf\u7ec8\u7aef\u9996\u5148\u6267\u884c\uff0cswapoff -a\uff0c\u6302\u8f7d\u95ee\u9898\u78c1\u76d8\n2. \u8fd0\u884cpartted\uff0cparted /dev/sda,\u8fd9\u91cc/dev/sda\u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907\n3. \u8fd0\u884c\u6062\u590d\u9009\u9879\uff1arescue START END\uff0c\u5982\u679c\u627e\u5230\u6f5c\u5728\u7684\u5206\u533a\u5219\u4f1a\u63d0\u793a\u662f\u5426\u6dfb\u52a0\u5230\u5206\u533a\u8868\u4e2d\n\n# Testdisk\ntestdisk\u4e5f\u53ef\u4ee5\u6062\u590d\u5206\u533a\u3002\u5b89\u88c5testdisk\u8f6f\u4ef6\u5305\u3002 \u8fd0\u884ctestdisk\uff0c\u5b83\u5c06\u626b\u63cf\u60a8\u7684\u8ba1\u7b97\u673a\u4e2d\u7684\u4ecb\u8d28\uff0c\u5e76\u4e3a\u60a8\u63d0\u4f9b\u83dc\u5355\u9a71\u52a8\u7684\u65b9\u6cd5\u6765\u6062\u590d\u5206\u533a\n\n# Gpart\n\u5b89\u88c5gpart\uff0c\u6267\u884cgpart /dev/sda\uff0c/dev/sda\u8868\u793a\u9700\u8981\u6062\u590d\u7684\u8bbe\u5907,\u6700\u597d\u662fgpart -W /dev/sda /dev/sdb\u5199\u5165\u5230\u53e6\u4e00\u4e2a\u8bbe\u5907\n\n\n\u60c5\u51b5\u4e8c\uff1a\u6620\u50cf\u635f\u574f\u7684\u8bbe\u5907\uff0c\u6587\u4ef6\u7cfb\u7edf\u6216\u9a71\u52a8\u5668\n# GNU ddrescue(\u5b89\u88c5\u540e\u547d\u4ee4\u4e3addrescue)\n\u7f51\u5740\uff1ahttp://www.gnu.org/software/ddrescue/ddrescue.html\n\n# dd_rescue\n\u7f51\u5740\uff1ahttp://www.garloff.de/kurt/linux/ddrescue/\n\n\u5982\u679c\u60a8\u6b63\u5728\u6210\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u5927\u5c0f\u5927\u4e8e4 gig\uff0c\u5219\u5c06\u65e0\u6cd5\u4f7f\u7528MSDOS\uff08VFAT\uff09\u6587\u4ef6\u7cfb\u7edf\uff08\u901a\u5e38\u5728USB\u9a71\u52a8\u5668\u4e0a\u627e\u5230\uff09\u6765\u5b58\u50a8\u56fe\u50cf\uff0c\u56e0\u4e3a\u6700\u5927\u5927\u5c0f\u9650\u5236\u4e3a4G\n\u8fd9\u6837\u7684\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u6587\u4ef6\u3002 \u4f7f\u7528EXT3\u6216\u5176\u4ed6\u53ef\u4ee5\u5904\u7406\u6b64\u7c7b\u6587\u4ef6\u5927\u5c0f\u7684\u6587\u4ef6\u7cfb\u7edf\n\n# \u5c06\u5728/dev/hd2\u7684\u5206\u533a\u6062\u590d\u5230/dev/hdb2\nddrescue -r3 /dev/hda2 /dev/hdb2 logfie\ne2fsck -v -f /dev/hdb2\nmount -t ext2 -o ro /dev/hdb2 /mnt\n\n# \u6062\u590d\u5728/dev/cdrom\u4e2d\u7684\u4e00\u4e2aCD-ROM,\u5c06cdimage\u5199\u5165\u7a7a\u767d\u7684CD-ROM\nddrescue -b 2048 /dev/cdrom cdimage logfie\n\n\u4ece\u6062\u590d\u7684\u6620\u50cf\u63d0\u53d6\u6587\u4ef6\u7cfb\u7edf\u6765\u6062\u590d\u6587\u4ef6\n\u5b89\u88c5sleuthkit\u8f6f\u4ef6\nmmls file -b    \u6b64\u547d\u4ee4\u6765\u663e\u793a\u5728\u6620\u50cf\u4e2d\u627e\u5230\u7684\u5206\u533a\nmount -o loop,offset=16384 file mnt \u663e\u793a\u591a\u4e2a\u5206\u533a\uff0c\u6b64\u793a\u4f8b\u4ece\u575732\u5904\u5b89\u88c5dos\u5206\u533a\uff0c\u8ba1\u7b97\u5b57\u8282\u6570\u9700\u8981\u4e58512\uff0c\u5f97\u51fa16384\nmount -t ntfs -or,force,loop,offset=32256 file mnt  \u6302\u8f7dwindows\u521b\u5efa\u7684ntfs\u5206\u533a(63\u4e58512=32256)\n\n\u5229\u7528foremost\u6062\u590d\u6587\u4ef6,\u5047\u8bbe\u9700\u8981\u6062\u590d\u7684\u662f/dev/hda\nforemost -i /dev/hda -o /recovery/foremost\nforemost -t jpg -i /dev/hda -o /recovery/foremost  \u6062\u590d\u7279\u5b9a\u7c7b\u578b\u6587\u4ef6\n\nscalpel\u8f6f\u4ef6\u4e5f\u53ef\u7528\u6765\u6062\u590d\uff1ascalpel File -o dir  File\u662f\u6620\u50cf\u6587\u4ef6\u6216\u8bbe\u5907\uff0cdir\u662f\u8f93\u51fa\u76ee\u5f55\n\nmagicrescue\u4f7f\u7528magic bytes\u626b\u63cf\u6587\u4ef6\u6765\u8bc6\u522b\u6587\u4ef6\u7684\u5b58\u5728\u548c\u7c7b\u578b\n\u4ece/dev/sda1\u5206\u533a\u6062\u590dgzip\u548cpng\u6587\u4ef6\uff1amagicrescue -r gzip -r png -d~/output /dev/sda1\n\nPhotorec\u65e8\u5728\u4ece\u6570\u7801\u76f8\u673a\u7684\u5185\u5b58\u6216\u786c\u76d8\u4e2d\u6062\u590d\u4e22\u5931\u7684\u7167\u7247\uff0c\u5df2\u6269\u5c55\u652f\u630180\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u6587\u4ef6\uff0cphotorec\u662ftestdisk\u8f6f\u4ef6\u5305\u7684\u4e00\u90e8\u5206\n\nntfsprogs\u53ef\u4ee5\u4eceNTFS\u7cfb\u7edf\u6062\u590d\u5df2\u5220\u9664\u6587\u4ef6\uff0cWindows\u548clinux\u4e0b\u90fd\u6709\u6b64\u8f6f\u4ef6\uff0c\u5927\u81f4\u6709\u4e09\u79cd\u6a21\u5f0f\uff1a\n1. \u626b\u63cf\uff1a\u641c\u7d22\u5df2\u5220\u9664\u7684\u6587\u4ef6\u5e76\u67e5\u627e\u6709\u5173\u5b83\u4eec\u7684\u4fe1\u606f\uff0cnftsundelete /dev/sda1\n2. \u53d6\u6d88\u5220\u9664\uff1antfsundelete /dev/sda1 -u -i 3689 -o work.doc -d~/output\n3. \u590d\u5236\uff1antfsdelete /dev/sda1 -u -m *.jpg\nntfsundelete /dev/sda1 -u -i 14159  \u6839\u636e\u6587\u4ef6\u7684inode\u6062\u590d\n\nsleuth kit\u548cautopsy\u662f\u4e24\u4e2a\u57fa\u4e8eGUI\u7684\u6062\u590d\u8f6f\u4ef6\n\n# extundelete \u4e3b\u9875\uff1ahttp://extundelete.sourceforge.net/\n\u4e0b\u8f7d\u5730\u5740\uff1ahttp://nchc.dl.sourceforge.net/project/extundelete/extundelete/0.2.0/extundelete-0.2.0.tar.bz2\nubuntu\u7528\u6237\u53ef\u76f4\u63a5\u5b89\u88c5: apt-get install extundelete\n./configure &amp;&amp; make &amp;&amp; make install    # \u5982\u679c\u63d0\u793a\u627e\u4e0d\u5230ext2fs\u5e93\uff0c\u4f7f\u7528 yum -y install e2fsprogs* \u5b89\u88c5\n\n# \u6570\u636e\u6062\u590d\n1. \u5378\u8f7d\u9700\u8981\u6062\u590d\u6587\u4ef6\u7684\u5206\u533a\nfuser -k /mnt/test/               &lt;-- \u7ed3\u675f\u4f7f\u7528\u67d0\u5206\u533a\u7684\u8fdb\u7a0b\u6811\numount /mnt/test                  &lt;-- \u5378\u8f7d\u5206\u533a\n\n2. \u4f7f\u7528extundelete\u67e5\u770b\u5206\u533a\u4e0a\u5b58\u5728\u7684\u6587\u4ef6\nextundelete --inode 2 /dev/sdb1    # --inode\u4e3a\u67e5\u627e\u67d0i\u8282\u70b9\u4e2d\u7684\u5185\u5bb9\uff0c\u4f7f\u75282\u5219\u8bf4\u660e\u4e3a\u641c\u7d22\uff0c\u5982\u679c\u9700\u8fdb\u5165\u76ee\u5f55\u641c\u7d22\uff0c\u53ea\u987b\u8981\u6307\u5b9a\u76ee\u5f55I\u8282\u70b9\u5373\u53ef\n\n# --restore-inode \u6062\u590d\u6307\u5b9a\u7684I\u8282\u70b9\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5168\u5c06\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6\u653e\u5728\u5f53\u524d\u8def\u5f84RECOVERED_FILES/ \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a file.I\u8282\u70b9\u53f7\nextundelete --restore-inode 13 /dev/sdb1\n\nls RECOVERED_FILES/\nmount /dev/sdb1 /mnt/test/\nmv RECOVERED_FILES/file.13 /mnt/test/resolv.conf\nmv RECOVERED_FILES/file.14 /mnt/test/hosts\ncat /mnt/test/hosts            # \u67e5\u770b\u88ab\u6062\u590d\u51fa\u6765\u7684\u6587\u4ef6 \u662f\u5426\u4e0e\u6e90\u6587\u4ef6\u4e00\u81f4\ncat /mnt/test/resolv.conf\n</code></pre>"},{"location":"system/linux/Centos/#_13","title":"\u57fa\u672c\u670d\u52a1\u642d\u5efa","text":""},{"location":"system/linux/Centos/#_14","title":"\u65f6\u95f4\u540c\u6b65","text":"Markdown<pre><code>http://www.ntp.org\nhttps://chrony.tuxfamily.org\n\n## ntp\u914d\u7f6e\n\ndriftfile /var/lib/ntp/drift\n\n# Permit time synchronization with our time source, but do not\n# permit the source to query or modify the service on this system.\nrestrict default nomodify notrap nopeer noquery\n\n# Permit all access over the loopback interface.  This could\n# be tightened as well, but to do so would effect some of\n# the administrative functions.\nrestrict 127.0.0.1\nrestrict ::1\n\n# Hosts on local network are less restricted.\n#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap\n\n# Use public servers from the pool.ntp.org project.\n# Please consider joining the pool (http://www.pool.ntp.org/join.html).\nserver 0.centos.pool.ntp.org iburst\nserver 1.centos.pool.ntp.org iburst\nserver 2.centos.pool.ntp.org iburst\nserver 3.centos.pool.ntp.org iburst\n\n#broadcast 192.168.1.255 autokey        # broadcast server\n#broadcastclient                        # broadcast client\n#broadcast 224.0.1.1 autokey            # multicast server\n#multicastclient 224.0.1.1              # multicast client\n#manycastserver 239.255.254.254         # manycast server\n#manycastclient 239.255.254.254 autokey # manycast client\n\n# Enable public key cryptography.\n#crypto\n\nincludefile /etc/ntp/crypto/pw\n\n# Key file containing the keys and key identifiers used when operating\n# with symmetric key cryptography.\nkeys /etc/ntp/keys\n\n# Specify the key identifiers which are trusted.\n#trustedkey 4 8 42\n\n# Specify the key identifier to use with the ntpdc utility.\n#requestkey 8\n\n# Specify the key identifier to use with the ntpq utility.\n#controlkey 8\n\n# Enable writing of statistics records.\n#statistics clockstats cryptostats loopstats peerstats\n\n# Disable the monitoring facility to prevent amplification attacks using ntpdc\n# monlist command when default restrict does not include the noquery flag. See\n# CVE-2013-5211 for more details.\n# Note: Monitoring will not be disabled with the limited restriction flag.\ndisable monitor\n\n----------------------------------------------------------------------------------------------------------------------\n\n## \u5185\u5916\u7f51\u9694\u79bb\u60c5\u51b5chrony master client\u914d\u7f6e\n# Master,\u5047\u8bbe\u7f51\u6bb5\u4e3a192.168.165.x\ninitstepslew 1 client1 client3 client6\ndriftfile /var/lib/chrony/drift\nlocal stratum 8\nmanual\nallow 192.168.165.0/24\nsmoothtime 400 0.01\nrtcsync\n\n# Client,\u5ba2\u6237\u7aef\u5747\u662f\u76f8\u540c\u914d\u7f6e\nserver master iburst\ndriftfile /var/lib/chrony/drift\nallow 192.168.165.0/24\nmakestep 1.0 3\nrtcsync\n\n\n\u5982\u679c\u6ca1\u6709\u5408\u9002\u7684\u8ba1\u7b97\u673a\u88ab\u6307\u5b9a\u4e3a\u4e3b\u670d\u52a1\u5668\uff0c\u6216\u8005\u8981\u6c42\u5373\u4f7f\u5ba2\u6237\u7aef\u51fa\u73b0\u6545\u969c\u4e5f\u8981\u4f7f\u5ba2\u6237\u7aef\u4fdd\u6301\u540c\u6b65 \uff0c\u5219\u672c\u5730\u6307\u4ee4\u7684orphan\u9009\u9879\u5c06\u542f\u7528\u4e00\u79cd\u7279\u6b8a\u6a21\u5f0f\uff0c\n\u5728\u8be5\u6a21\u5f0f\u4e0b\uff0c\u53ef\u4ee5\u4ece\u591a\u53f0\u8ba1\u7b97\u673a\u4e2d\u81ea\u52a8\u9009\u62e9\u4e3b\u670d\u52a1\u5668\u3002\u4ed6\u4eec\u90fd\u9700\u8981\u4f7f\u7528\u76f8\u540c\u7684 \u672c\u5730\u914d\u7f6e\u5e76\u76f8\u4e92\u8f6e\u8be2\u3002\u5177\u6709\u6700\u5c0f\u5f15\u7528ID\uff08\u57fa\u4e8e\u5176IP\u5730\u5740\uff09\u7684\u670d\u52a1\u5668\u5c06\n\u5145\u5f53\u4e3b\u670d\u52a1\u5668\u7684\u89d2\u8272\uff0c\u5176\u4ed6\u670d\u52a1\u5668\u5c06\u4e0e\u5176\u540c\u6b65\u3002\u5f53\u5b83\u5931\u8d25\u65f6\uff0c\u5177\u6709\u7b2c\u4e8c\u5c0f\u7684\u53c2\u8003ID\u7684\u670d\u52a1\u5668\u5c06\u63a5\u7ba1\u7b49\n\n\u7b2c\u4e00\u4e2a\u670d\u52a1\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u53ef\u80fd\u662f(\u5047\u8bbe\u6709\u4e09\u4e2a\u670d\u52a1\u5668\u5206\u522b\u79f0\u4e3amaster1\uff0cmaster2\u548cmaster3)\u3002\n\u5176\u4ed6\u670d\u52a1\u5668\u5c06\u662f\u76f8\u540c\u7684\uff0c`\u4f46\u8981\u4fee\u6539initstepslew\u548cserver\u6307\u4ee4\u4e2d\u7684\u4e3b\u673a\u540d\u4ee5\u6307\u5b9a\u5176\u4ed6\u670d\u52a1\u5668`\u3002\u4ed6\u4eec\u7684\u5ba2\u6237\u7aef\u53ef\u80fd\u914d\u7f6e\u4e3a\u8f6e\u8be2\u6240\u6709\u4e09\u53f0\u670d\u52a1\u5668\ninitstepslew 1 master2 master3\nserver master2\nserver master3\ndriftfile /var/lib/chrony/drift\nlocal stratum 8 orphan\nmanual\nallow 192.168.165.0/24\nrtcsync\n\n-----------------------------------------------------------------------------------------------------------------------\n\n## chrony\u914d\u7f6e\n\n# Use public servers from the pool.ntp.org project.\n# Please consider joining the pool (http://www.pool.ntp.org/join.html).[\u5fc5\u987b\u8981\u6709]\nserver 0.centos.pool.ntp.org iburst\nserver 1.centos.pool.ntp.org iburst\nserver 2.centos.pool.ntp.org iburst\nserver 3.centos.pool.ntp.org iburst\n\n# Record the rate at which the system clock gains/losses time.[\u5fc5\u987b\u8981\u6709]\ndriftfile /var/lib/chrony/drift\n\n# Allow the system clock to be stepped in the first three updates\n# if its offset is larger than 1 second.[\u5fc5\u987b\u8981\u6709]\nmakestep 1.0 3\n\n# Enable kernel synchronization of the real-time clock (RTC).[\u5fc5\u987b\u8981\u6709]\nrtcsync\n\n# Enable hardware timestamping on all interfaces that support it.\n#hwtimestamp *\n\n# Increase the minimum number of selectable sources required to adjust\n# the system clock.\n#minsources 2\n\n# Allow NTP client access from local network.\n#allow 192.168.0.0/16\n\n# Serve time even if not synchronized to a time source.\n#local stratum 10\n\n# Specify file containing keys for NTP authentication.\n#keyfile /etc/chrony.keys\n\n# Specify directory for log files.\nlogdir /var/log/chrony\n\n# Select which information is logged.\n#log measurements statistics tracking\n</code></pre>"},{"location":"system/linux/Centos/#vsftp","title":"Vsftp","text":"Markdown<pre><code>VSFTPv3.0.3\u7248\u672c\u914d\u7f6evsftpd.conf\u6587\u4ef6\u8be6\u89e3\n\u5b98\u7f51\u94fe\u63a5\uff1ahttps://security.appspot.com/vsftpd/vsftpd_conf.html\n\nvsftpd.conf\u7684\u683c\u5f0f\u975e\u5e38\u7b80\u5355\u3002\u6bcf\u4e00\u884c\u90fd\u662f\u6ce8\u91ca\u6216\u6307\u4ee4\u3002\u6ce8\u91ca\u884c\u4ee5\uff03\u5f00\u5934\u5e76\u88ab\u5ffd\u7565\u3002\u6307\u4ee4\u884c\u7684\u683c\u5f0f\u4e3a\uff1a\u9009\u9879=\u503c\n\u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\u5728\u9009\u9879\u548c\u503c\u4e4b\u95f4\u7684=\u653e\u7f6e\u4efb\u4f55\u7a7a\u683c\u662f\u9519\u8bef\u7684\u3002\u6bcf\u4e2a\u8bbe\u7f6e\u90fd\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7f16\u8bd1\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\n\n/etc/rc.d/init.d/vsftpd # \u542f\u52a8\u811a\u672c\n/etc/pam.d/vsftpd   # PAM\u8ba4\u8bc1\u6587\u4ef6\n/etc/vsftpd/ftpusers    # \u7981\u6b62\u4f7f\u7528Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6\n/etc/vsftpd/user_list   # \u7981\u6b62\u6216\u5141\u8bb8\u4f7f\u7528Vsftpd\u7684\u7528\u6237\u5217\u8868\u6587\u4ef6\n/var/ftp    # \u533f\u540d\u7528\u6237\u4e3b\u76ee\u5f55\n\n## \u57fa\u672c\u53c2\u6570\n\n# \u63a5\u53d7\u533f\u540d\u7528\u6237\nanonymous_enable=YES\n\n# \u533f\u540d\u7528\u6237login\u65f6\u4e0d\u8be2\u95ee\u53e3\u4ee4,\u533f\u540d\u7528\u6237\u76f4\u63a5\u767b\u5f55\nno_anon_password=YES\n\n# \u533f\u540d\u7528\u6237\u4e3b\u76ee\u5f55\nanon_root=(none)\n\n# \u662f\u5426\u5141\u8bb8\u672c\u5730\u767b\u5f55\uff0c\u82e5\u542f\u7528\u5219\u53ef\u4ee5\u4f7f\u7528/etc/passwd\u4e2d\u666e\u901a\u7528\u6237\u8d26\u53f7\u767b\u5f55\n# \u5fc5\u987b\u542f\u7528\u6b64\u529f\u80fd\u624d\u80fd\u662f\u4efb\u4f55\u975e\u533f\u540d\u7528\u6237\u767b\u5f55\uff0c\u5305\u62ec\u865a\u62df\u7528\u6237\nlocal_enable=YES\n\n# \u672c\u5730\u7528\u6237(\u5373\u975e\u533f\u540d\u7528\u6237)\u4e3b\u76ee\u5f55\nlocal_root=(none)\n\n# \u5982\u679c\u533f\u540d\u7528\u6237\u9700\u8981\u5bc6\u7801,\u90a3\u4e48\u4f7f\u7528banned_email_file\u91cc\u9762\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u7684\u7528\u6237\u4e0d\u80fd\u767b\u5f55\n# \u8bbe\u7f6e\u4e3aYES\u5219\u4f7f\u7528/etc/vsftpd.banned_emails\u4e2d\u6307\u5b9a\u7684\u7535\u5b50\u90ae\u4ef6\u5bc6\u7801\u7684\u6240\u6709\u533f\u540d\u7528\u6237\u90fd\u5c06\u88ab\u62d2\u7edd\u8bbf\u95ee\u670d\u52a1\u5668\n# \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5305\u542b\u6b64\u5217\u8868\u7684\u6587\u4ef6\u4e3a/etc/vsftpd.banned_emails,\u8bbe\u7f6e\u4e3aYES\u65f6\uff0c\u5fc5\u987b\u5b58\u5728\u6b64\u6587\u4ef6\ndeny_email_enable=YES\n\n# \u4ec5\u5728\u6ca1\u6709pam\u9a8c\u8bc1\u7248\u672c\u65f6\u6709\u7528,\u662f\u5426\u68c0\u67e5\u7528\u6237\u5728/etc/shell\u6709\u4e00\u4e2a\u6709\u6548\u7684shell\u6765\u767b\u5f55\ncheck_shell=YES\n\n# userlist_enable=YES,userlist_deny=YES\u65f6,ftpusers\u548cuser_list\u5747\u4e0d\u80fd\u8bbf\u95ee,\u53ea\u80fd\u672c\u5730\u7528\u6237\u8bbf\u95ee\n# userlist_enable=YES,userlist_deny=NO\u65f6,\u53ea\u5141\u8bb8userlist\u4e2d\u7528\u6237\u8bbf\u95ee\n# userlist_enable=NO,userlist_deny=YES\u65f6,\u7981\u6b62ftpusers\u53ea\u5141\u8bb8userlist\u548c\u672c\u5730\u7528\u6237\nuserlist_enable=YES\nuserlist_deny=NO\n\n# \u5982\u679c\u548cchroot_local_user\u4e00\u8d77\u5f00\u542f,\u5219\u53ef\u4ee5\u57fa\u4e8e\u6bcf\u4e2a\u7528\u6237\u6307\u5b9achroot()\u7684\u76d1\u7981\u76ee\u5f55\uff0c\u6bcf\u4e2a\u7528\u6237\u7684\u76d1\u7981\u90fd\u662f\u4ece/etc/passwd\u4e2d\u7684\u4e3b\u76ee\u5f55\u5b57\u7b26\u4e32\u6d3e\u751f\npasswd_chroot_enable=NO\n\n# \u5b9a\u4e49\u533f\u540d\u767b\u5165\u7684\u4f7f\u7528\u8005\u540d\u79f0\u3002\u9ed8\u8ba4\u503c\u4e3aftp\nftp_username=ftp\n\n## vsFTPd\u7528\u6237\u6743\u9650\u63a7\u5236\n\n# \u63a7\u5236\u662f\u5426\u5141\u8bb8\u4efb\u4f55\u66f4\u6539\u6587\u4ef6\u7cfb\u7edf\u7684ftp\u547d\u4ee4\uff0c\u8fd9\u4e9b\u547d\u4ee4\u662f\uff1aSTOR\uff0cDELE\uff0cRNFR\uff0cRNTO\uff0cMKD\uff0cRMD\uff0cAPPE\u548cSITE\uff1b\u5373\u53ef\u4ee5\u4e0a\u4f20(\u5168\u5c40\u63a7\u5236)\nwrite_enable=YES\n\n# \u672c\u5730\u7528\u6237\u4e0a\u4f20\u6587\u4ef6\u7684umask\uff0c\u82e5\u8981\u6307\u5b9a\u516b\u8fdb\u5236\u503c\uff0c\u5219\u524d\u7f00\u52a00\uff0c\u5426\u5219\u89c6\u4e3a\u5341\u8fdb\u5236\u6574\u6570\nlocal_umask=022 # \u6743\u9650755\uff1b\u8ba1\u7b97\u65b9\u6cd5777-022=755\n\n# \u4e0a\u4f20\u6587\u4ef6\u7684\u6743\u9650\u914d\u5408umask\u4f7f\u7528\n# file_open_mode=0666\n\n# \u533f\u540d\u7528\u6237\u53ef\u4ee5\u4e0a\u4f20\uff0c\u8bbe\u4e3aYES\u65f6\u5fc5\u987b\u6fc0\u6d3bwrite_enable\u9009\u9879\nanon_upload_enable=NO\n\n# \u533f\u540d\u7528\u6237\u53ef\u4ee5\u5efa\u76ee\u5f55\uff0c\u8bbe\u4e3aYES\u65f6\u5fc5\u987b\u6fc0\u6d3bwrite_enable\u9009\u9879\nanon_mkdir_write_enable=NO\n\n\u533f\u540d\u7528\u6237\u5176\u5b83\u7684\u5199\u6743\u5229(\u66f4\u6539\u6743\u9650),\u4f8b\u5982\u5220\u9664\u548c\u91cd\u547d\u540d\nanon_other_write_enable=NO\n\n\u5982\u679c\u8bbe\u4e3aYES\uff0c\u533f\u540d\u767b\u5165\u8005\u4f1a\u88ab\u5141\u8bb8\u4e0b\u8f7d\u53ef\u9605\u8bfb\u7684\u6863\u6848\u3002\u9ed8\u8ba4\u503c\u4e3aYES\nanon_world_visible_only=YES\n\n# \u5982\u679c\u5f00\u542f,\u90a3\u4e48\u6240\u6709\u975e\u533f\u540d\u767b\u9646\u7684\u7528\u6237\u540d\u90fd\u4f1a\u88ab\u5207\u6362\u6210guest_username\u6307\u5b9a\u7684\u7528\u6237\u540d,\u5373\u90fd\u88ab\u8ba4\u4e3a\u65f6\u8bbf\u5ba2\u767b\u5f55\nguest_enable=NO\n\n# \u6240\u6709\u533f\u540d\u4e0a\u4f20\u7684\u6587\u4ef6\u7684\u6240\u5c5e\u7528\u6237\u5c06\u4f1a\u88ab\u66f4\u6539\u6210chown_username\u4e2d\u6307\u5b9a\u7528\u6237\nchown_uploads=YES\n\n# \u533f\u540d\u4e0a\u4f20\u6587\u4ef6\u6240\u5c5e\u7528\u6237\u540d\uff0c\u8bbe\u7f6echown_uploads\u65f6\u6b64\u9009\u9879\u624d\u751f\u6548\nchown_username=lightwiter\n\n# \u5982\u679c\u542f\u52a8\u8fd9\u9879\u529f\u80fd\uff0c\u5219\u6240\u6709\u5217\u5728chroot_list_file\u4e4b\u4e2d\u7684\u4f7f\u7528\u8005\u4e0d\u80fd\u66f4\u6539\u6839\u76ee\u5f55\n# \u9ed8\u8ba4\u5305\u542b\u6b64\u5217\u8868\u6587\u4ef6/etc/vsftpd.chroot_list\u4f46\u53ef\u4ee5\u901a\u8fc7chroot_list_file\u8bbe\u7f6e\u8986\u76d6\nchroot_list_enable=YES\n\n# \u8bbe\u7f6e\u4e3aYES\u8868\u793a\u5141\u8bb8\u4f7f\u7528\"async ABOR\"\u547d\u4ee4,\u4e00\u822c\u4e0d\u7528,\u5bb9\u6613\u51fa\u95ee\u9898\nasync_abor_enable=NO\n\n# \u7ba1\u63a7\u662f\u5426\u53ef\u7528ASCII \u6a21\u5f0f\u4e0a\u4f20\u3002\u9ed8\u8ba4\u503c\u4e3aNO\nascii_upload_enable=YES\n\n# \u7ba1\u63a7\u662f\u5426\u53ef\u7528ASCII \u6a21\u5f0f\u4e0b\u8f7d\u3002\u9ed8\u8ba4\u503c\u4e3aNO\nascii_download_enable=YES\n\n# \u8fd9\u4e2a\u9009\u9879\u5fc5\u987b\u6307\u5b9a\u4e00\u4e2a\u7a7a\u7684\u76ee\u5f55\u540d\u79f0\u4e14\u4efb\u4f55\u767b\u5165\u8005\u90fd\u4e0d\u80fd\u6709\u5199\u5165\u7684\u6743\u9650\uff0c\u5f53vsftpd\u4e0d\u9700\u8981\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\u65f6\uff0c\u53ef\u7528\u4f5c\u5b89\u5168\u7684chroot()\u76d1\u72f1\u3002\u9ed8\u8ba4\u503c\u4e3a/usr/share/empty\nsecure_chroot_dir=/usr/share/empty\n\n## vsFTPd\u8d85\u65f6\u8bbe\u7f6e\n\n# \u7a7a\u95f2\u8fde\u63a5\u8d85\u65f6(\u4ee5\u79d2\u4e3a\u5355\u4f4d)\nidle_session_timeout=600\n\n# \u6570\u636e\u4f20\u8f93\u8d85\u65f6\uff0c\u5141\u8bb8\u6570\u636e\u4f20\u8f93\u6682\u505c\u800c\u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c\u7684\u6700\u957f\u65f6\u95f4\ndata_connection_timeout=300\n\n# PAVS\u8bf7\u6c42\u8d85\u65f6\nACCEPT_TIMEOUT=60\n\n# PROT\u6a21\u5f0f\u8fde\u63a5\u8d85\u65f6\nconnect_timeout=60\n\n## vsFTPd \u670d\u52a1\u5668\u529f\u80fd\u9009\u9879\n\n# \u5f00\u542f\u65e5\u8bb0\u529f\u80fd\nxferlog_enable=YES\n\n# \u4f7f\u7528\u6807\u51c6\u683c\u5f0f\nxferlog_std_format=YES\n\n# \u5f53xferlog_std_format\u5173\u95ed\u4e14\u672c\u9009\u9879\u5f00\u542f\u65f6,\u8bb0\u5f55\u6240\u6709ftp\u8bf7\u6c42\u548c\u56de\u590d,\u5f53\u8c03\u8bd5\u6bd4\u8f83\u6709\u7528\nlog_ftp_protocol=NO\n\n# \u5141\u8bb8\u4f7f\u7528pasv\u6a21\u5f0f\npasv_enable=YES\n\n# \u5173\u95ed\u5b89\u5168\u68c0\u67e5\n# pasv_promiscuous+NO\n\n# \u5141\u8bb8\u4f7f\u7528port\u6a21\u5f0f\nport_enable=YES\n\n# \u5f00\u542ftcp_wrappers\u652f\u6301\ntcp_wrappers=YES\n\n# \u5b9a\u4e49PAM \u6240\u4f7f\u7528\u7684\u540d\u79f0\uff0c\u9884\u8bbe\u4e3avsftpd\npam_service_name=vsftpd\n\n# \u5f53\u670d\u52a1\u5668\u8fd0\u884c\u4e8e\u6700\u5e95\u5c42\u65f6\u4f7f\u7528\u7684\u7528\u6237\u540d\nnopriv_user=nobody\n\n# \u4f7fvsftpd\u5728pasv\u547d\u4ee4\u56de\u590d\u65f6\u8df3\u8f6c\u5230\u6307\u5b9a\u7684IP\u5730\u5740.(\u670d\u52a1\u5668\u8fde\u63a5\u8df3\u8f6c)\npasv_address=(none)\n\n## vsFTPd \u670d\u52a1\u5668\u6027\u80fd\u9009\u9879\n\n# \u662f\u5426\u80fd\u4f7f\u7528ls -R\u547d\u4ee4\u4ee5\u9632\u6b62\u6d6a\u8d39\u5927\u91cf\u7684\u670d\u52a1\u5668\u8d44\u6e90\nls_recurse_enable=NO\n\n# \u662f\u5426\u4f7f\u7528\u5355\u8fdb\u7a0b\u6a21\u5f0f\none_process_model=NO\n\n# \u5f53\u4f7f\u7528\u8005\u767b\u5165\u540e\u4f7f\u7528ls -al \u4e4b\u7c7b\u7684\u6307\u4ee4\u67e5\u8be2\u8be5\u6863\u6848\u7684\u7ba1\u7406\u6743\u65f6\uff0c\u9884\u8bbe\u4f1a\u51fa\u73b0\u62e5\u6709\u8005\u7684UID\uff0c\u800c\u4e0d\u662f\u8be5\u6863\u6848\u62e5\u6709\u8005\u7684\u540d\u79f0\u3002\u82e5\u662f\u5e0c\u671b\u51fa\u73b0\u62e5\u6709\u8005\u7684\u540d\u79f0\uff0c\u5219\u5c06\u6b64\u529f\u80fd\u5f00\u542f\u3002\ntext_userdb_names=NO\n\n# \u663e\u793a\u76ee\u5f55\u6e05\u5355\u65f6\u662f\u7528\u672c\u5730\u65f6\u95f4\u8fd8\u662fGMT\u65f6\u95f4,\u53ef\u4ee5\u901a\u8fc7mdtm\u547d\u4ee4\u6765\u8fbe\u5230\u4e00\u6837\u7684\u6548\u679c\nuse_localtime=NO\n\n# \u6d4b\u8bd5\u5e73\u53f0\u4f18\u5316\nuse_sendfile=YES\n\n## vsFTPd \u4fe1\u606f\u7c7b\u8bbe\u7f6e\n\n# login\u65f6\u663e\u793a\u6b22\u8fce\u4fe1\u606f.\u5982\u679c\u8bbe\u7f6e\u4e86banner_file\u5219\u6b64\u8bbe\u7f6e\u65e0\u6548\nftpd_banner=\u6b22\u8fce\u6765\u5230FTP \u7f51\u7ad9\n\n# \u5141\u8bb8\u4e3a\u76ee\u5f55\u914d\u7f6e\u663e\u793a\u4fe1\u606f,\u663e\u793a\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u9762\u7684.message\u6587\u4ef6\u5185\u5bb9\uff0c\u8bbe\u7f6emessage_file\u66f4\u6539\u6b64\u8bbe\u7f6e\ndirmessage_enable=YES\n\n# \u663e\u793a\u4f1a\u8bdd\u72b6\u6001\u4fe1\u606f\nsetproctitle_enable=YES\n\n## vsFTPd \u6587\u4ef6\u5b9a\u4e49\n\n# \u5b9a\u4e49\u4e0d\u80fd\u66f4\u6539\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u6587\u4ef6\nchroot_list_file=/etc/vsftpd/vsftpd.chroot_list\n\n# \u5b9a\u4e49\u9650\u5236/\u5141\u8bb8\u7528\u6237\u767b\u5f55\u7684\u6587\u4ef6\nuserlist_file=/etc/vsftpd/vsftpd.user_list\n\n# \u5b9a\u4e49\u767b\u5f55\u4fe1\u606f\u6587\u4ef6\u7684\u4f4d\u7f6e\nbanner_file=/etc/vsftpd/banner\n\n# \u7981\u6b62\u4f7f\u7528\u7684\u533f\u540d\u7528\u6237\u767b\u9646\u65f6\u4f5c\u4e3a\u5bc6\u7801\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\nbanned_email_file=/etc/vsftpd.banned_emails\n\n# \u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\nxferlog_file=/var/log/vsftpd.log\n\n# \u76ee\u5f55\u4fe1\u606f\u6587\u4ef6\nmessage_file=.message\n\n## vsFTPd \u76ee\u5f55\u5b9a\u4e49\n\n# \u5b9a\u4e49\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\nuser_config_dir=/etc/vsftpd/userconf\n\n# \u5b9a\u4e49\u672c\u5730\u7528\u6237\u767b\u9646\u7684\u6839\u76ee\u5f55,\u6ce8\u610f\u5b9a\u4e49\u6839\u76ee\u5f55\u53ef\u4ee5\u662f\u76f8\u5bf9\u8def\u5f84\u4e5f\u53ef\u4ee5\u662f\u7edd\u5bf9\u8def\u5f84.\u76f8\u5bf9\u8def\u5f84\u662f\u9488\u5bf9\u7528\u6237\u5bb6\u76ee\u5f55\u6765\u8bf4\u7684\nlocal_root=webdisk # \u6b64\u9879\u8bbe\u7f6e\u6bcf\u4e2a\u7528\u6237\u767b\u9646\u540e\u5176\u6839\u76ee\u5f55\u4e3a/home/username/webdisk\n\n# \u533f\u540d\u7528\u6237\u767b\u9646\u540e\u7684\u6839\u76ee\u5f55\nanon_root=/var/ftp\n\n## vsFTPd \u7528\u6237\u8fde\u63a5\u9009\u9879\n\n# \u53ef\u63a5\u53d7\u7684\u6700\u5927client\u6570\u76ee\nmax_clients=100\n\n# \u6bcf\u4e2aip\u7684\u6700\u5927client\u6570\u76ee\nmax_per_ip=12\n\n# \u4f7f\u7528\u6807\u51c6\u768420\u7aef\u53e3\u6765\u8fde\u63a5ftp\nconnect_from_port_20=NO\n\n# \u7ed1\u5b9a\u5230\u67d0\u4e2aIP,\u5176\u5b83IP\u4e0d\u80fd\u8bbf\u95ee\nlisten_address=192.168.0.2\n\n# \u7ed1\u5b9a\u5230\u67d0\u4e2a\u7aef\u53e3\nlisten_port=2121\n\n# \u6570\u636e\u4f20\u8f93\u7aef\u53e3\nftp_data_port=2020\n\n# pasv\u8fde\u63a5\u6a21\u5f0f\u65f6\u53ef\u4ee5\u4f7f\u7528port \u8303\u56f4\u7684\u4e0a\u754c\uff0c0 \u8868\u793a\u4efb\u610f\u3002\u9ed8\u8ba4\u503c\u4e3a0\npasv_max_port=0\n\n# pasv\u8fde\u63a5\u6a21\u5f0f\u65f6\u53ef\u4ee5\u4f7f\u7528port \u8303\u56f4\u7684\u4e0b\u754c\uff0c0 \u8868\u793a\u4efb\u610f\u3002\u9ed8\u8ba4\u503c\u4e3a0\npasv_min_port=0\n\n## vsFTPd \u6570\u636e\u4f20\u8f93\u9009\u9879\n\n# \u533f\u540d\u7528\u6237\u7684\u4f20\u8f93\u6bd4\u7387(bytes/s),0\u8868\u793a\u65e0\u9650\u5236\nanon_max_rate=51200\n\n# \u672c\u5730\u7528\u6237\u7684\u4f20\u8f93\u6bd4\u7387(bytes/s),0\u8868\u793a\u65e0\u9650\u5236\nlocal_max_rate=5120000\n</code></pre>"},{"location":"system/linux/Centos/#rsync","title":"rsync","text":""},{"location":"system/linux/Centos/#_15","title":"\u9009\u9879","text":"Markdown<pre><code>rsync [OPTION]... SRC DEST\nrsync [OPTION]... SRC [USER@]host:DEST\nrsync [OPTION]... [USER@]HOST:SRC DEST\nrsync [OPTION]... [USER@]HOST::SRC DEST\nrsync [OPTION]... SRC [USER@]HOST::DEST\nrsync [OPTION]... rsync://[USER@]HOST[:PORT]/SRC [DEST]\n\n\u5bf9\u5e94\u4e8e\u4ee5\u4e0a\u516d\u79cd\u547d\u4ee4\u683c\u5f0f\uff0crsync\u6709\u516d\u79cd\u4e0d\u540c\u7684\u5de5\u4f5c\u6a21\u5f0f\uff1a\n\n* \u540c\u6b65\u672c\u5730\u76ee\u5f55\u3002\u5f53SRC\u548cDES\u8def\u5f84\u4fe1\u606f\u90fd\u4e0d\u5305\u542b\u6709\u5355\u4e2a\u5192\u53f7\":\"\u5206\u9694\u7b26\u65f6\u5c31\u542f\u52a8\u8fd9\u79cd\u5de5\u4f5c\u6a21\u5f0f\n  \u5982\uff1a`rsync -a /data /backup`\n\n* \u4f7f\u7528\u4e00\u4e2a\u8fdc\u7a0bshell\u7a0b\u5e8f(\u5982rsh\u3001ssh)\u6765\u5b9e\u73b0\u5c06\u672c\u5730\u673a\u5668\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u8fdc\u7a0b\u673a\u5668\u3002\u5f53DST\u8def\u5f84\u5730\u5740\u5305\u542b\u5355\u4e2a\u5192\u53f7\":\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\n  \u5982\uff1a`rsync -avz *.c foo:src`\n\n* \u4f7f\u7528\u4e00\u4e2a\u8fdc\u7a0bshell\u7a0b\u5e8f(\u5982rsh\u3001ssh)\u6765\u5b9e\u73b0\u5c06\u8fdc\u7a0b\u673a\u5668\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u672c\u5730\u673a\u5668\u3002\u5f53SRC\u5730\u5740\u8def\u5f84\u5305\u542b\u5355\u4e2a\u5192\u53f7\":\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\n  \u5982\uff1a`rsync -avz foo:src/bar /data`\n\n* \u62c9\u53d6\uff1a\u4ece\u8fdc\u7a0brsync\u670d\u52a1\u5668\u4e2d\u62f7\u8d1d\u6587\u4ef6\u5230\u672c\u5730\u673a\u3002\u5f53SRC\u8def\u5f84\u4fe1\u606f\u5305\u542b\"::\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\n  \u5982\uff1a`rsync -av root@192.168.78.192::www /databack`\n\n* \u63a8\u9001\uff1a\u4ece\u672c\u5730\u673a\u5668\u62f7\u8d1d\u6587\u4ef6\u5230\u8fdc\u7a0brsync\u670d\u52a1\u5668\u4e2d\u3002\u5f53DST\u8def\u5f84\u4fe1\u606f\u5305\u542b\"::\"\u5206\u9694\u7b26\u65f6\u542f\u52a8\u8be5\u6a21\u5f0f\n  \u5982\uff1a`rsync -av /databack root@192.168.78.192::www`\n  rsync -av --exclude={one,two} /data root@xxxx::www    \u6392\u9664one\u548ctwo\u76ee\u5f55\n\n* \u5217\u8fdc\u7a0b\u673a\u7684\u6587\u4ef6\u5217\u8868\u3002\u8fd9\u7c7b\u4f3c\u4e8ersync\u4f20\u8f93\uff0c\u4e0d\u8fc7\u53ea\u8981\u5728\u547d\u4ee4\u4e2d\u7701\u7565\u6389\u672c\u5730\u673a\u4fe1\u606f\u5373\u53ef\n  \u5982\uff1a`rsync -v rsync://192.168.78.192/www`\n\nhttps://rsync.samba.org/resources.html\n\u539f\u7406\u8bba\u6587\uff1ahttps://www.samba.org//~tridge/phd_thesis.pdf\nhow_rsync_works:https://rsync.samba.org/how-rsync-works.html\nhttps://rsync.samba.org/examples.html\n</code></pre> Markdown<pre><code>-v, --verbose               \u8be6\u7ec6\u6a21\u5f0f\u8f93\u51fa\n    --info=FLAGS            \u7ec6\u7c92\u5ea6\u7684info\u8f93\u51fa\n    --debug=FLAGS           \u7ec6\u7c92\u5ea6\u7684debug\u8f93\u51fa\n    --msgs2stderr           special output handling for debugging\n-q, --quiet                 suppress non-error messages\n    --no-motd               suppress daemon-mode MOTD (see manpage caveat)\n-c, --checksum              \u6839\u636echecksum\u8df3\u8fc7\u6587\u4ef6\uff0c\u800c\u4e0d\u662fmod-time\u548csize\n-a, --archive               \u5f52\u6863\u6a21\u5f0f;\u7b49\u540c\u4e8e-rlptgoD (no -H,-A,-X)\n    --no-OPTION             turn off an implied OPTION (e.g. --no-D)\n-r, --recursive             \u5bf9\u5b50\u76ee\u5f55\u8fdb\u884c\u9012\u5f52\u5904\u7406\n-R, --relative              \u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u7684\u540d\u79f0\n    --no-implied-dirs       don't send implied dirs with --relative\n-b, --backup                make backups (see --suffix &amp; --backup-dir)\n    --backup-dir=DIR        make backups into hierarchy based in DIR\n    --suffix=SUFFIX         set backup suffix (default ~ w/o --backup-dir)\n-u, --update                \u8df3\u8fc7\u63a5\u6536\u65b9\u6bd4\u53d1\u9001\u65b9\u8f83\u65b0\u7684\u6587\u4ef6\uff0c\u5373\u8df3\u8fc7\u6240\u6709\u5df2\u5b58\u5728\u4e8eDST\u4e14\u6587\u4ef6\u65f6\u95f4\u665a\u4e8eSRC\u7684\u6587\u4ef6\n    --inplace               update destination files in-place (SEE MAN PAGE)\n    --append                append data onto shorter files\n    --append-verify         like --append, but with old data in file checksum\n-d, --dirs                  transfer directories without recursing\n-l, --links                 \u4fdd\u7559\u8f6f\u94fe\u63a5\n-L, --copy-links            \u5c06\u7b26\u53f7\u94fe\u63a5\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u5f15\u7528\u6587\u4ef6\u6216\u5f15\u7528\u76ee\u5f55\n    --copy-unsafe-links     only \"unsafe\" symlinks are transformed\n    --safe-links            ignore symlinks that point outside the source tree\n    --munge-links           munge symlinks to make them safer (but unusable)\n-k, --copy-dirlinks         transform symlink to a dir into referent dir\n-K, --keep-dirlinks         treat symlinked dir on receiver as dir\n-H, --hard-links            \u4fdd\u7559\u786c\u94fe\u63a5\n-p, --perms                 \u4fdd\u7559\u6587\u4ef6\u6743\u9650\n-E, --executability         preserve the file's executability\n    --chmod=CHMOD           affect file and/or directory permissions\n-A, --acls                  preserve ACLs (implies --perms)\n-X, --xattrs                preserve extended attributes\n-o, --owner                 \u4fdd\u7559\u6587\u4ef6\u5c5e\u4e3b\u4fe1\u606f(super-user only)\n-g, --group                 \u4fdd\u7559\u6587\u4ef6\u5c5e\u7ec4\u4fe1\u606f\n    --devices               preserve device files (super-user only)\n    --copy-devices          copy device contents as regular file\n    --specials              preserve special files\n-D                          same as --devices --specials\n-t, --times                 \u4fdd\u7559\u6587\u4ef6\u4fee\u6539\u4fe1\u606f\n-O, --omit-dir-times        omit directories from --times\n-J, --omit-link-times       omit symlinks from --times\n    --super                 receiver attempts super-user activities\n    --fake-super            store/recover privileged attrs using xattrs\n-S, --sparse                \u5bf9\u7a00\u758f\u6587\u4ef6(\u5b83\u80fd\u5c1d\u8bd5\u5728\u6587\u4ef6\u5185\u5bb9\u5927\u591a\u4e3a\u7a7a\u65f6\u66f4\u6709\u6548\u7387\u5730\u4f7f\u7528\u6587\u4ef6\u7cfb\u7edf\u7684\u7a7a\u95f4)\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u4ee5\u8282\u7701DST\u7a7a\u95f4\n    --preallocate           allocate dest files before writing them\n-n, --dry-run               \u4e0d\u8fdb\u884c\u5b9e\u9645\u7684\u4f20\u8f93\uff0c\u53ea\u4f5c\u4e3a\u6d4b\u8bd5\u8fd0\u884c\n-W, --whole-file            copy files whole (without delta-xfer algorithm)\n-x, --one-file-system       don't cross filesystem boundaries\n-B, --block-size=SIZE       \u5f3a\u5236\u6821\u68c0\u5757\u5927\u5c0f\n-e, --rsh=COMMAND           \u6307\u5b9arsh\u3001ssh\u65b9\u5f0f\u8fdb\u884c\u4f20\u8f93\n    --rsync-path=PROGRAM    \u6307\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5668rsync\u547d\u4ee4\u6240\u5728\u8def\u5f84\n    --existing              skip creating new files on receiver\n    --ignore-existing       skip updating files that already exist on receiver\n    --remove-source-files   sender removes synchronized files (non-dirs)\n    --del                   an alias for --delete-during\n    --delete                \u4eceDST\u5220\u9664\u5728SRC\u4e2d\u6ca1\u6709\u7684\u6587\u4ef6(\u614e\u7528)\n    --delete-before         receiver deletes before transfer, not during\n    --delete-during         receiver deletes during the transfer\n    --delete-delay          find deletions during, delete after\n    --delete-after          receiver deletes after transfer, not during\n    --delete-excluded       also delete excluded files from destination dirs\n    --ignore-missing-args   ignore missing source args without error\n    --delete-missing-args   delete missing source args from destination\n    --ignore-errors         delete even if there are I/O errors\n    --force                 force deletion of directories even if not empty\n    --max-delete=NUM        don't delete more than NUM files\n    --max-size=SIZE         don't transfer any file larger than SIZE\n    --min-size=SIZE         don't transfer any file smaller than SIZE\n    --partial               keep partially transferred files\n    --partial-dir=DIR       put a partially transferred file into DIR\n    --delay-updates         put all updated files into place at transfer's end\n-m, --prune-empty-dirs      prune empty directory chains from the file-list\n    --numeric-ids           don't map uid/gid values by user/group name\n    --usermap=STRING        custom username mapping\n    --groupmap=STRING       custom groupname mapping\n    --chown=USER:GROUP      simple username/groupname mapping\n    --timeout=SECONDS       set I/O timeout in seconds\n    --contimeout=SECONDS    set daemon connection timeout in seconds\n-I, --ignore-times          \u4e0d\u8df3\u8fc7\u90a3\u4e9b\u5177\u6709\u76f8\u540csize\u548cmod-time\u7684\u6587\u4ef6\n-M, --remote-option=OPTION  send OPTION to the remote side only\n    --size-only             skip files that match in size\n    --modify-window=NUM     compare mod-times with reduced accuracy\n-T, --temp-dir=DIR          \u5728DIR\u4e2d\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\n-y, --fuzzy                 find similar file for basis if no dest file\n    --compare-dest=DIR      also compare destination files relative to DIR\n    --copy-dest=DIR         ... and include copies of unchanged files\n    --link-dest=DIR         hardlink to files in DIR when unchanged\n-z, --compress              \u4f20\u8f93\u8fc7\u7a0b\u4e2d\u5bf9\u6587\u4ef6\u6570\u636e\u8fdb\u884c\u538b\u7f29\u5904\u7406\n    --compress-level=NUM    explicitly set compression level\n    --skip-compress=LIST    skip compressing files with a suffix in LIST\n-C, --cvs-exclude           \u50cfCVS\u4e00\u6837\u81ea\u52a8\u5ffd\u7565\u6587\u4ef6\n-f, --filter=RULE           add a file-filtering RULE\n-F                          same as --filter='dir-merge /.rsync-filter'\n                            repeated: --filter='- .rsync-filter'\n    --exclude=PATTERN       \u6392\u9664\u4e0ePATTERN\u76f8\u5339\u914d\u7684\u6587\u4ef6\n    --exclude-from=FILE     \u6392\u9664\u4e0eFILE\u6587\u4ef6\u4e2dpattern\u5339\u914d\u7684\u6587\u4ef6\n    --include=PATTERN       \u4e0d\u6392\u9664\u4e0ePATTERN\u76f8\u5339\u914d\u7684\u6587\u4ef6\n    --include-from=FILE     \u4e0d\u6392\u9664FILE\u6587\u4ef6\u4e2d\u6307\u5b9apattern\u5339\u914d\u7684\u6587\u4ef6\n    --files-from=FILE       \u4eceFILE\u8bfb\u53d6\u6e90\u6587\u4ef6\u540d\u5217\u8868\u5339\u914d\u8981\u4f20\u8f93\u7684\u6587\u4ef6\n-0, --from0                 all *-from/filter files are delimited by 0s\n-s, --protect-args          no space-splitting; only wildcard special-chars\n    --address=ADDRESS       bind address for outgoing socket to daemon\n    --port=PORT             \u6307\u5b9a\u5176\u4ed6\u7684rsync\u670d\u52a1\u7aef\u53e3\n    --sockopts=OPTIONS      specify custom TCP options\n    --blocking-io           use blocking I/O for the remote shell\n    --stats                 give some file-transfer stats\n-8, --8-bit-output          leave high-bit chars unescaped in output\n-h, --human-readable        output numbers in a human-readable format\n    --progress              \u663e\u793a\u4f20\u8f93\u8fc7\u7a0b\n-P                          same as --partial --progress\n-i, --itemize-changes       output a change-summary for all updates\n    --out-format=FORMAT     output updates using the specified FORMAT\n    --log-file=FILE         log what we're doing to the specified FILE\n    --log-file-format=FMT   log updates using the specified FMT\n    --password-file=FILE    \u4eceFILE\u6587\u4ef6\u8bfb\u53d6rsync\u540e\u53f0\u7a0b\u5e8f\u8bbf\u95ee\u5bc6\u7801\n    --list-only             list the files instead of copying them\n    --bwlimit=RATE          \u9650\u5236socket I/O\u5e26\u5bbd\n    --outbuf=N|L|B          set output buffering to None, Line, or Block\n    --write-batch=FILE      write a batched update to FILE\n    --only-write-batch=FILE like --write-batch but w/o updating destination\n    --read-batch=FILE       read a batched update from FILE\n    --protocol=NUM          force an older protocol version to be used\n    --iconv=CONVERT_SPEC    request charset conversion of filenames\n    --checksum-seed=NUM     set block/file checksum seed (advanced)\n-4, --ipv4                  prefer IPv4\n-6, --ipv6                  prefer IPv6\n\n--checksum\u8be6\u89e3\uff1a\u6539\u53d8\u4e86rsync\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5df2\u66f4\u6539\u4ee5\u53ca\u662f\u5426\u9700\u8981\u4f20\u8f93\u7684\u65b9\u5f0f\u3002\u5982\u679c\u6ca1\u6709\u6b64\u9009\u9879\uff0crsync\u5c06\u4f7f\u7528\u201c\u5feb\u901f\u68c0\u67e5\u201d\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\uff0c\u68c0\u67e5\u6bcf\u4e2a\n\u6587\u4ef6\u7684\u5927\u5c0f\u548c\u4e0a\u6b21\u4fee\u6539\u65f6\u95f4\u5728\u53d1\u9001\u65b9\u548c\u63a5\u6536\u65b9\u4e4b\u95f4\u662f\u5426\u5339\u914d\u3002\u6b64\u9009\u9879\u5c06\u5176\u66f4\u6539\u4e3a\u6bd4\u8f83\u6bcf\u4e2a\u5177\u6709\u5339\u914d\u5927\u5c0f\u7684\u6587\u4ef6\u7684128\u4f4d\u6821\u9a8c\u548c\u3002\u751f\u6210\u6821\u9a8c\u548c\u610f\u5473\u7740\u53cc\u65b9\u5c06\n\u82b1\u8d39\u5927\u91cf\u7684\u78c1\u76d8I / O\u6765\u8bfb\u53d6\u4f20\u8f93\u4e2d\u6587\u4ef6\u4e2d\u7684\u6240\u6709\u6570\u636e\uff08\u8fd9\u662f\u5728\u8fdb\u884c\u4efb\u4f55\u8bfb\u53d6\u4ee5\u4f20\u8f93\u66f4\u6539\u7684\u6587\u4ef6\u4e4b\u524d\uff09\uff0c\u56e0\u6b64\u8fd9\u4f1a\u51cf\u6162\u901f\u5ea6\u663e\u8457\n</code></pre>"},{"location":"system/linux/Centos/#_16","title":"\u5b9e\u4f8b","text":"Bash<pre><code>: &lt;&lt; comment\n\u6ce8\u610f\u4e8b\u9879\uff1a\n# \u521b\u5efa\u5bc6\u7801\u6587\u4ef6\uff0c\u7528\u6237\u540d\u53ef\u4ee5\u548c\u5bc6\u7801\u53ef\u4ee5\u968f\u4fbf\u5b9a\u4e49,\u670d\u52a1\u7aef\u9700\u8981user:pass\u5f62\u5f0f\uff0c\u5ba2\u6237\u7aef\u53ea\u9700\u8981pass\u5c31\u884c\necho \"work:abc123\" &gt; /etc/rsyncd.passwd\nchmod 600 /etc/rsyncd.passwd\n\nwindows\u4e0brsync\u6743\u9650\u6ce8\u610f\u4e8b\u9879\uff1a\u5bc6\u7801\u6587\u4ef6\u6267\u884c\uff1achmod 600 rsync.passwd,\u7528\u5f53\u524d\u7528\u6237\u6267\u884c\uff1achown \u7528\u6237\u540d rsync.passwd\n\n\u5c06\u6587\u4ef6\u53d1\u9001\u5230Microsoft\u6587\u4ef6\u7cfb\u7edf\uff1a\u5982\u679c\u6587\u4ef6\u7684\u4fee\u6539\u65f6\u95f4\u662f\u4e00\u4e2a\u5947\u6570\u503c\uff0c\u4f46\u662f\u63a5\u6536\u6587\u4ef6\u7cfb\u7edf\u53ea\u80fd\u5b58\u50a8\u5076\u6570\u503c\uff0c\n\u90a3\u4e48rsync\u5c06\u91cd\u65b0\u4f20\u8f93\u592a\u591a\u6587\u4ef6\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a--modify-window = 1\u9009\u9879\u6765\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\ncomment\n\n# \u4f7f\u7528SSH\u65b9\u5f0frsync\u8fdb\u884c\u540c\u6b65\nrsync -vzrtopg --progress -e ssh --delete work@172.16.78.192:/www/* /databack/experiment/rsync\n</code></pre>"},{"location":"system/linux/Centos/#_17","title":"\u540e\u53f0\u670d\u52a1\u65b9\u5f0f","text":"Markdown<pre><code>https://download.samba.org/pub/rsync/rsyncd.conf.html\n# \u9ed8\u8ba4\u5b89\u88c5\u597drsync\u7a0b\u5e8f\u540e\uff0c\u914d\u7f6e\u6587\u4ef6\u4e3a\u201c/etc/rsyncd.conf\u201d\n# \u5168\u5c40\u53c2\u6570\uff0c\u4f7f\u7528[global]\u6a21\u5757\u540d\u79f0\u6307\u793a\u4e00\u4e2a\u6216\u591a\u4e2a\u5168\u5c40\u53c2\u6570\u7684\u5f00\u59cb\uff0c\u540d\u79f0\u5fc5\u987b\u5c0f\u5199\n[global]\nmotd file = path_to_file  # \u6307\u5b9a\u6bcf\u6b21\u8fde\u63a5\u65f6\u663e\u793a\u7ed9\u5ba2\u6237\u7aef\u7684\u6d88\u606f\n# pid file = /var/run/rsyncd.pid    # \u5c06\u8fdb\u7a0bid\u5199\u5165\u6b64\u6587\u4ef6\nport = PORT # \u6307\u5b9arsync\u8fdb\u7a0b\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4873\naddress = x # \u901a\u8fc7\u6307\u5b9a\u6b64\u503c\u6765\u8986\u76d6\u5b88\u62a4\u7a0b\u5e8f\u9ed8\u8ba4\u76d1\u542c\u7684IP\u5730\u5740\nsocket options = xx # \u8bbe\u7f6e\u5404\u79cd\u5957\u63a5\u5b57\u9009\u9879\uff0c\u8fd9\u4e9b\u9009\u9879\u53ef\u80fd\u4f1a\u4f7f\u4f20\u8f93\u66f4\u5feb\u6216\u66f4\u6162,\u5177\u4f53\u53c2\u8003setsockopt()\u7cfb\u7edf\u8c03\u7528\u7684\u624b\u518c\u9875\nlisten backlog = x  # \u8986\u76d6rsync\u8fdb\u7a0b\u5bf9\u4e8e\u8fde\u63a5\u7684backlog value\uff0c\u9ed8\u8ba4\u4e3a5\n\n# \u6a21\u5757\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u659c\u6760\u6216\u53f3\u65b9\u62ec\u53f7,\u540d\u79f0\u5185\u90e8\u5305\u542b\u591a\u4e2a\u7a7a\u683c\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u7a7a\u683c\u5bf9\u5f85\uff0c\u9996\u5c3e\u7a7a\u683c\u4f1a\u88ab\u4e22\u5f03\n[module]\ncomment = x  #  \u5f53\u5ba2\u6237\u7aef\u83b7\u53d6\u53ef\u7528\u6a21\u5757\u5217\u8868\u65f6\uff0c\u6b64\u53c2\u6570\u6307\u5b9a\u5728\u6a21\u5757\u540d\u79f0\u65c1\u8fb9\u663e\u793a\u7684\u63cf\u8ff0\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u6ca1\u6ce8\u91ca\npath = x    # \u6307\u5b9arsync\u5b88\u62a4\u7a0b\u5e8f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\uff0c\u5fc5\u987b\u4e3a\u6bcf\u4e2amodule\u6307\u5b9a\u6b64\u53c2\u6570\u3002\u53ef\u4ee5\u4f7f\u7528\u767e\u5206\u53f7\u5c06\u53d8\u91cf\u540d\u79f0\u62ec\u8d77\u6765\uff0c\u4ece\u800c\u4f7f\u8def\u5f84\u7684\u503c\u57fa\u4e8e\u73af\u5883\u53d8\u91cf\u3002\n              \u4e5f\u53ef\u4ee5\u5f15\u7528\u7528\u6237\u8fde\u63a5\u65f6\u7531rsync\u8bbe\u7f6e\u7684\u53d8\u91cf\u3002\u4f8b\u5982\u5728\u8def\u5f84\u4e2d\u4f7f\u7528\u6388\u6743\u7528\u6237\u7684\u540d\u79f0\uff1apath = /home/%RSYNC_USER_NAME%\nuse chroot = yes  # \u503c\u4e3ayes\u65f6\uff0crsync\u5b88\u62a4\u7a0b\u5e8f\u5c06chroot\u5230\u201c path\u201d\uff0c\u7136\u540e\u518d\u5f00\u59cb\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u6587\u4ef6\u4f20\u8f93\u3002\u597d\u5904\u662f\u53ef\u4ee5\u63d0\u4f9b\u989d\u5916\u7684\u4fdd\u62a4\uff0c\u4ee5\u9632\u6b62\u53ef\u80fd\u7684\n                    \u5b89\u5168\u6f0f\u6d1e\uff0c\u4f46\u662f\u5b83\u7684\u7f3a\u70b9\u662f\u9700\u8981\u8d85\u7ea7\u7528\u6237\u7279\u6743\ndaemon chroot = x   # \u6b64\u53c2\u6570\u6307\u5b9a\u5b88\u62a4\u7a0b\u5e8f\u5728\u5f00\u59cb\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u4e4b\u524d\u5c06\u5176\u66f4\u6539\u4e3achroot\u7684\u8def\u5f84\nnumeric ids = x # \u542f\u7528\u6b64\u53c2\u6570\u5c06\u7981\u7528\u5f53\u524d\u5b88\u62a4\u7a0b\u5e8f\u6a21\u5757\u7684\u6309\u540d\u79f0\u6620\u5c04\u7528\u6237\u548c\u7ec4\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u5b88\u62a4\u7a0b\u5e8f\u5c1d\u8bd5\u52a0\u8f7d\u4efb\u4f55\u4e0e\u7528\u6237/\u7ec4\u76f8\u5173\u7684\u6587\u4ef6\u6216\u5e93\u3002\n                  \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u53c2\u6570\u5bf9chroot\u6a21\u5757\u542f\u7528\uff0c\u5bf9\u975echroot\u6a21\u5757\u7981\u7528\u3002\u542f\u7528chroot\u7684\u6a21\u5757\u4e0d\u5e94\u542f\u7528\u6b64\u53c2\u6570\ncharset = x # \u6307\u5b9a\u4e86\u5b58\u50a8\u6a21\u5757\u6587\u4ef6\u540d\u7684\u5b57\u7b26\u96c6\u3002\u5982\u679c\u5ba2\u6237\u7aef\u4f7f\u7528--iconv\u9009\u9879\uff0c\u5219\u5b88\u62a4\u7a0b\u5e8f\u5c06\u4f7f\u7528\u201c\u5b57\u7b26\u96c6\u201d\u53c2\u6570\u7684\u503c\uff0c\u800c\u4e0e\u5ba2\u6237\u7aef\u5b9e\u9645\u4f20\u9012\u7684\u5b57\u7b26\u96c6\u65e0\u5173\u3002\n              \u8fd9\u4f7f\u5b88\u62a4\u8fdb\u7a0brsync\u53ef\u4ee5\u5728chroot\u6a21\u5757\u4e2d\u652f\u6301\u5b57\u7b26\u96c6\u8f6c\u6362\u4e14\u8fd8\u53ef\u4ee5\u786e\u4fdd\u4ee5\u4e00\u81f4\u7684\u65b9\u5f0f\u5b8c\u6210\u540d\u79f0\u8f6c\u6362\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u201c charset\u201d\u53c2\u6570\uff0c\n              \u5219--iconv\u9009\u9879\u5c06\u88ab\u62d2\u7edd\nmax connections = x #\n\n# uid = nobody\n# gid = nobody\n# max connections = 4\n# exclude = lost+found/\n# transfer logging = yes\n# timeout = 900\n# ignore nonreadable = yes\n# dont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2\n\n# [ftp]\n#        path = /home/ftp\n#        comment = ftp export area\n#\n#\n</code></pre>"},{"location":"system/linux/Centos/#inotify-tools","title":"inotify-tools","text":"Markdown<pre><code>https://github.com/rvoicilas/inotify-tools/wiki\n\ninotifywait [-hcmrq] [-e &lt;event&gt; ] [-t &lt;seconds&gt; ] [--format &lt;fmt&gt; ] [--timefmt &lt;fmt&gt; ] &lt;file&gt; [ ... ]\n\n\u5404\u4e2a\u53c2\u6570\u7684\u542b\u4e49\ninotifywait\u53c2\u6570\u542b\u4e49\u8bf4\u660e\n-m --monitor   \u59cb\u7ec8\u4fdd\u6301\u4e8b\u4ef6\u76d1\u542c\u72b6\u6001\n-r --recursive  \u9012\u5f52\u67e5\u8be2\u76ee\u5f55\n-q --quiet      \u6253\u5370\u5f88\u5c11\u7684\u4fe1\u606f\uff0c\u4ec5\u4ec5\u6253\u5370\u76d1\u63a7\u4e8b\u4ef6\u7684\u4fe1\u606f\n--exclude       \u6392\u9664\u6587\u4ef6\u6216\u76ee\u5f55\u65f6\uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002\n--timefmt       \u6307\u5b9a\u65f6\u95f4\u8f93\u51fa\u7684\u683c\u5f0f\n--format        \u6253\u5370\u4f7f\u7528\u6307\u5b9a\u7684\u8f93\u51fa\u7c7b\u4f3c\u683c\u5f0f\u5b57\u7b26\u4e32\n-e\uff0c--event     \u901a\u8fc7\u6b64\u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u9700\u8981\u76d1\u63a7\u7684\u4e8b\u4ef6\uff0c\u5982\u4e0b\u4e00\u4e2a\u5217\u8868\u6240\u793a\n\n-e \uff1a--event\u7684\u5404\u79cd\u4e8b\u4ef6\u542b\u4e49\naccess      \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u8bfb\u53d6\nmodify      \u6587\u4ef6\u6216\u76ee\u5f55\u5185\u5bb9\u88ab\u4fee\u6539\nattrib      \u6587\u4ef6\u6216\u76ee\u5f55\u5c5e\u6027\u88ab\u6539\u53d8\nclose       \u6587\u4ef6\u6216\u76ee\u5f55\u5c01\u95ed\uff0c\u65e0\u8bba\u8bfb/\u5199\u6a21\u5f0f\nopen        \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u6253\u5f00\nmoved_to    \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u79fb\u52a8\u81f3\u53e6\u5916\u4e00\u4e2a\u76ee\u5f55\nmove        \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u76ee\u5f55\u6216\u4ece\u53e6\u4e00\u4e2a\u76ee\u5f55\u79fb\u52a8\u81f3\u5f53\u524d\u76ee\u5f55\ncreate      \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u521b\u5efa\u5728\u5f53\u524d\u76ee\u5f55\ndelete      \u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u5220\u9664\numount      \u6587\u4ef6\u7cfb\u7edf\u88ab\u5378\u8f7d\n</code></pre>"},{"location":"system/linux/Centos/#samba","title":"samba","text":"Markdown"},{"location":"system/linux/Centos/#bind-dns","title":"Bind-DNS","text":"Bash<pre><code># DNS-bind\u5b89\u88c5\u548c\u914d\u7f6e\n: &lt;&lt; comment\nhttps://ftp.isc.org/\nhttp://www.isc.org/downloads/\n\n\u89e3\u51b3bind9 dumping master file tmp-xxxx open permission denied\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6cd5\u5982\u4e0b\uff1a\n\u5bf9\u4e8eRedhat Linux\uff0c\u53ea\u8981\u5728slave\u90a3\u53f0\u7684dns\u4e3b\u673a\u4e0a\u4fee\u6539/etc/sysconfig/named\u52a0\u4e0aENABLE_ZONE_WRITE=yes\uff0c\u91cd\u542fnamed\u5373\u53ef\n\u5bf9\u4e8eUbuntu\u7cfb\u7edf\uff0c\u4fee\u6539/etc/apparmor.d/usr.sbin.named\uff0c\u67e5\u627e/etc/bind/** r\uff0c\u4fee\u6539\u6210/etc/bind/** rw\n\u7136\u540e\u91cd\u542fapparmor\uff1a/etc/init.d/apparmor rstart\u6216\u8005reload\u914d\u7f6e\uff1acat /etc/apparmor.d/usr.sbin.named | sudo apparmor_parser -r\ncomment\n\nwget https://www.isc.org/downloads/file/bind-9-10-6-p1/?version=tar-gz\ntar -zxvf\n./configure --with-openssl --enable-threads --with-libxml2\nmake &amp;&amp; make install\ntouch /etc/named.conf\nnamed -V\nnamed -g\n</code></pre>"},{"location":"system/linux/Centos/#bind-dhcp","title":"Bind-DHCP","text":"Markdown<pre><code>https://www.isc.org/dhcp/\nhttps://www.isc.org/kea/\n</code></pre>"},{"location":"system/linux/Centos/#mail-server","title":"mail server","text":"<ul> <li>Postfix\uff08MTA\uff0c\u90ae\u4ef6\u4f20\u8f93\u4ee3\u7406\uff09\u901a\u8fc7SMTP\u534f\u8bae\uff08\u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\u5c06\u90ae\u4ef6\u4ece\u60a8\u7684\u670d\u52a1\u5668\u4f20\u8f93\u5230\u5176\u4ed6\u670d\u52a1\u5668</li> <li>Dovecot\uff08MDA\uff0c\u90ae\u4ef6\u4f20\u9012\u4ee3\u7406\uff09\u901a\u8fc7IMAP\uff08Internet\u90ae\u4ef6\u8bbf\u95ee\u534f\u8bae\uff09\u6216POP3\u534f\u8bae\uff08\u90ae\u5c40\u534f\u8bae3\uff09\u5c06\u90ae\u4ef6\u4ece\u670d\u52a1\u5668\u4f20\u9012\u5230</li> <li>Thunderbird\uff08MUA\uff0c\u90ae\u4ef6\u7528\u6237\u4ee3\u7406\uff09</li> </ul> <p>\u90ae\u4ef6\u670d\u52a1\u5668\u6bd4\u8f83\u53c2\u8003</p> Bash<pre><code># PostFix Dovecot\u90ae\u4ef6\u670d\u52a1\u5668\u548c\u540e\u53f0\u7ba1\u7406\ndovecot.org\npostfix.org\n</code></pre>"},{"location":"system/linux/Centos/#email","title":"email\u5b89\u88c5\u8fc7\u7a0b\u76f8\u5173\u95ee\u9898\u548c\u914d\u7f6e","text":"Bash<pre><code># \u51fa\u73b0Maildir\u6743\u9650\u95ee\u9898\u89e3\u51b3\u65b9\u6cd5\n# \u68c0\u67e5selinux\u72b6\u6001\u5e76\u5173\u95ed\nsestatus -v # \u68c0\u67e5selinux\u72b6\u6001\n\ngetenforce 0 #  \u8bbe\u7f6eselinux\u4e3apermissive\u6a21\u5f0f()\u4e34\u65f6\u5173\u95ed\uff0c\u4e0d\u7528\u91cd\u542f\uff0c\u91cd\u542f\u540e\u5931\u6548\n# \u6c38\u4e45\u751f\u6548\u65b9\u6cd5\uff1a\u4fee\u6539/etc/selinux/config\u6587\u4ef6\uff0cSELINUX=enforcing\u66f4\u6539\u4e3aSELINUX=disabled\n</code></pre>"},{"location":"web/Apache/","title":"Apache&amp;PHP-FPM","text":""},{"location":"web/Apache/#apachectl","title":"apachectl\u9009\u578b","text":"<ul> <li>configtest\uff1a\u68c0\u67e5\u8bbe\u7f6e\u6587\u4ef6\u4e2d\u7684\u8bed\u6cd5\u662f\u5426\u6b63\u786e</li> <li>fullstatus\uff1a\u663e\u793a\u670d\u52a1\u5668\u5b8c\u6574\u7684\u72b6\u6001\u4fe1\u606f</li> <li>graceful\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668\uff0c\u4f46\u4e0d\u4f1a\u4e2d\u65ad\u539f\u6709\u7684\u8fde\u63a5</li> <li>help\uff1a\u663e\u793a\u5e2e\u52a9\u4fe1\u606f</li> <li>restart\uff1a\u91cd\u65b0\u542f\u52a8Apache\u670d\u52a1\u5668</li> <li>start\uff1a\u542f\u52a8Apache\u670d\u52a1\u5668</li> <li>status\uff1a\u663e\u793a\u670d\u52a1\u5668\u6458\u8981\u7684\u72b6\u6001\u4fe1\u606f</li> <li>stop\uff1a\u505c\u6b62Apache\u670d\u52a1\u5668</li> </ul> <p>php\u79bb\u7ebf\u5b89\u88c5\uff1a</p> Bash<pre><code>cannot find config.m4.\nmake sure that you run '/usr/local/php/bin/phpize' in the top level source directory of the module\n\u5176\u5b9e\u62a5\u8fd9\u4e2a\u9519\u7684\u539f\u56e0\u662f\uff0c\u5728\u6267\u884cphpize\u65f6\uff0c\u4e00\u5b9a\u8981\u5728\u9700\u8981\u6269\u5c55\u7f16\u8bd1\u7684php\u6a21\u5757\u76ee\u5f55\u4e2d\u8fdb\u884c/usr/local/php/bin/phpize \u8fd9\u6837\u624d\u4e0d\u4f1a\u62a5\u9519\n\u5b89\u88c5php-ldap\u6a21\u5757\nphp-ldap\u6a21\u5757\u4f5c\u7528\u5c31\u662f\u5b9e\u73b0ldap\u8ba4\u8bc1\uff0c\u56e0\u6b64\u9700\u8981\u5b89\u88c5\n1\u3001\u5b89\u88c5\u8f6f\u4ef6\u5305\u89e3\u51b3\u4f9d\u8d56\nyum install openldap\nyum install openldap-devel\n2\u3001\u62f7\u8d1d\u5e93\u6587\u4ef6\ncp -frp /usr/lib64/libldap* /usr/lib/\n3\u3001\u7f16\u8bd1\u5b89\u88c5php-ldap\u6a21\u5757\ncd /usr/local/src/php-7.0.21/ext/ldap/\u3000\u3000(\u6e90\u7801\u5305\u8def\u5f84)\n/usr/local/php/bin/phpize \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000(php\u5b89\u88c5\u8def\u5f84)\n./configure --with-php-config=/usr/local/php/bin/php-config  (php\u5b89\u88c5\u8def\u5f84)\nmake\nmake install\n4\u3001\u7136\u540e\u5728php\u7684php.ini\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0http://120.76.120.248\n\n\u5f00\u542fPHP\u7f13\u5b58 - \u4fee\u6539php.ini\u4e2d\uff1a\nrealpath_cache_size = 4096k\nrealpath_cache_ttl = 120\n\n\u5f00\u542fNGINX\u7684GZIP\u5e76\u9690\u85cf\u7248\u672c\u53f7 - \u4fee\u6539nginx.conf\u4e2d\uff1a\nserver_tokens    off;\ngzip              on;\ngzip_min_length  20k;\ngzip_buffers   4 16k;\ngzip_comp_level    4;\ngzip_types         text/plain text/css text/javascript application/x-javascript application/xml application/x-httpd-php;\nserver {\n        listen    80 default;\n        return    444;\n}\n</code></pre> <p>php-fpm.conf\u91cd\u8981\u53c2\u6570\u8be6\u89e3</p> <p>pid = run/php-fpm.pid</p>"},{"location":"web/Apache/#pidvarrunphp-fpmpid","title":"pid\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/run/php-fpm.pid\uff0c\u5efa\u8bae\u5f00\u542f","text":"<p>error_log = log/php-fpm.log</p>"},{"location":"web/Apache/#varlogphp-fpmlog","title":"\u9519\u8bef\u65e5\u5fd7\uff0c\u9ed8\u8ba4\u5728\u5b89\u88c5\u76ee\u5f55\u4e2d\u7684var/log/php-fpm.log","text":"<p>log_level = notice</p>"},{"location":"web/Apache/#alert-error-warning-notice-debug-notice","title":"\u9519\u8bef\u7ea7\u522b. \u53ef\u7528\u7ea7\u522b\u4e3a: alert\uff08\u5fc5\u987b\u7acb\u5373\u5904\u7406\uff09, error\uff08\u9519\u8bef\u60c5\u51b5\uff09, warning\uff08\u8b66\u544a\u60c5\u51b5\uff09, notice\uff08\u4e00\u822c\u91cd\u8981\u4fe1\u606f\uff09, debug\uff08\u8c03\u8bd5\u4fe1\u606f\uff09. \u9ed8\u8ba4: notice.","text":"<p>emergency_restart_threshold = 60 emergency_restart_interval = 60s</p>"},{"location":"web/Apache/#emergency_restart_intervalsigsegvsigbusphp-cgi-emergency_restart_thresholdphp-fpm","title":"\u8868\u793a\u5728emergency_restart_interval\u6240\u8bbe\u503c\u5185\u51fa\u73b0SIGSEGV\u6216\u8005SIGBUS\u9519\u8bef\u7684php-cgi\u8fdb\u7a0b\u6570\u5982\u679c\u8d85\u8fc7 emergency_restart_threshold\u4e2a\uff0cphp-fpm\u5c31\u4f1a\u4f18\u96c5\u91cd\u542f\u3002\u8fd9\u4e24\u4e2a\u9009\u9879\u4e00\u822c\u4fdd\u6301\u9ed8\u8ba4\u503c","text":"<p>process_control_timeout = 0</p>"},{"location":"web/Apache/#s-m-h-d-s-0","title":"\u8bbe\u7f6e\u5b50\u8fdb\u7a0b\u63a5\u53d7\u4e3b\u8fdb\u7a0b\u590d\u7528\u4fe1\u53f7\u7684\u8d85\u65f6\u65f6\u95f4. \u53ef\u7528\u5355\u4f4d: s(\u79d2), m(\u5206), h(\u5c0f\u65f6), \u6216\u8005 d(\u5929) \u9ed8\u8ba4\u5355\u4f4d: s(\u79d2). \u9ed8\u8ba4\u503c: 0.","text":"<p>daemonize = yes</p>"},{"location":"web/Apache/#fpmyesnofpm","title":"\u540e\u53f0\u6267\u884cfpm,\u9ed8\u8ba4\u503c\u4e3ayes\uff0c\u5982\u679c\u4e3a\u4e86\u8c03\u8bd5\u53ef\u4ee5\u6539\u4e3ano\u3002\u5728FPM\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u8bbe\u7f6e\u6765\u8fd0\u884c\u591a\u4e2a\u8fdb\u7a0b\u6c60\u3002 \u8fd9\u4e9b\u8bbe\u7f6e\u53ef\u4ee5\u9488\u5bf9\u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u5355\u72ec\u8bbe\u7f6e","text":"<p>listen = 127.0.0.1:9000</p>"},{"location":"web/Apache/#fpmnginxphp-ipport-port-pathtounixsocket","title":"fpm\u76d1\u542c\u7aef\u53e3\uff0c\u5373nginx\u4e2dphp\u5904\u7406\u7684\u5730\u5740\uff0c\u4e00\u822c\u9ed8\u8ba4\u503c\u5373\u53ef\u3002\u53ef\u7528\u683c\u5f0f\u4e3a: 'ip:port', 'port', '/path/to/unix/socket'. \u6bcf\u4e2a\u8fdb\u7a0b\u6c60\u90fd\u9700\u8981\u8bbe\u7f6e.","text":"<p>listen.backlog = -1</p>"},{"location":"web/Apache/#backlog-1backloghttpwww3gyouccp41","title":"backlog\u6570\uff0c-1\u8868\u793a\u65e0\u9650\u5236\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u51b3\u5b9a\uff0c\u6b64\u884c\u6ce8\u91ca\u6389\u5c31\u884c\u3002backlog\u542b\u4e49\u53c2\u8003\uff1ahttp://www.3gyou.cc/?p=41","text":"<p>listen.allowed_clients = 127.0.0.1</p>"},{"location":"web/Apache/#fastcgiipanyipnginxfpmlistenipany","title":"\u5141\u8bb8\u8bbf\u95eeFastCGI\u8fdb\u7a0b\u7684IP\uff0c\u8bbe\u7f6eany\u4e3a\u4e0d\u9650\u5236IP\uff0c\u5982\u679c\u8981\u8bbe\u7f6e\u5176\u4ed6\u4e3b\u673a\u7684nginx\u4e5f\u80fd\u8bbf\u95ee\u8fd9\u53f0FPM\u8fdb\u7a0b\uff0clisten\u5904\u8981\u8bbe\u7f6e\u6210\u672c\u5730\u53ef\u88ab\u8bbf\u95ee\u7684IP\u3002\u9ed8\u8ba4\u503c\u662fany\u3002\u6bcf\u4e2a\u5730\u5740\u662f\u7528\u9017\u53f7\u5206\u9694. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u6216\u8005\u4e3a\u7a7a\uff0c\u5219\u5141\u8bb8\u4efb\u4f55\u670d\u52a1\u5668\u8bf7\u6c42\u8fde\u63a5","text":"<p>listen.owner = www listen.group = www listen.mode = 0666</p>"},{"location":"web/Apache/#unix-sockettcp","title":"unix socket\u8bbe\u7f6e\u9009\u9879\uff0c\u5982\u679c\u4f7f\u7528tcp\u65b9\u5f0f\u8bbf\u95ee\uff0c\u8fd9\u91cc\u6ce8\u91ca\u5373\u53ef","text":"<p>user = www group = www</p>"},{"location":"web/Apache/#_1","title":"\u542f\u52a8\u8fdb\u7a0b\u7684\u5e10\u6237\u548c\u7ec4","text":"<p>pm = dynamic #\u5bf9\u4e8e\u4e13\u7528\u670d\u52a1\u5668\uff0cpm\u53ef\u4ee5\u8bbe\u7f6e\u4e3astatic</p>"},{"location":"web/Apache/#staticdynamicstaticpmmax_childrendynamic","title":"\u5982\u4f55\u63a7\u5236\u5b50\u8fdb\u7a0b\uff0c\u9009\u9879\u6709static\u548cdynamic\u3002\u5982\u679c\u9009\u62e9static\uff0c\u5219\u7531pm.max_children\u6307\u5b9a\u56fa\u5b9a\u7684\u5b50\u8fdb\u7a0b\u6570\u3002\u5982\u679c\u9009\u62e9dynamic\uff0c\u5219\u7531\u4e0b\u5f00\u53c2\u6570\u51b3\u5b9a\uff1a","text":"<p>pm.max_children #\uff0c\u5b50\u8fdb\u7a0b\u6700\u5927\u6570 pm.start_servers #\uff0c\u542f\u52a8\u65f6\u7684\u8fdb\u7a0b\u6570 pm.min_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5c0f\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5c0f\u4e8e\u6b64\u503c\uff0c\u5219\u521b\u5efa\u65b0\u7684\u5b50\u8fdb\u7a0b pm.max_spare_servers #\uff0c\u4fdd\u8bc1\u7a7a\u95f2\u8fdb\u7a0b\u6570\u6700\u5927\u503c\uff0c\u5982\u679c\u7a7a\u95f2\u8fdb\u7a0b\u5927\u4e8e\u6b64\u503c\uff0c\u6b64\u8fdb\u884c\u6e05\u7406</p> <p>pm.max_requests = 1000</p>"},{"location":"web/Apache/#0-php_fcgi_max_requests-0","title":"\u8bbe\u7f6e\u6bcf\u4e2a\u5b50\u8fdb\u7a0b\u91cd\u751f\u4e4b\u524d\u670d\u52a1\u7684\u8bf7\u6c42\u6570. \u5bf9\u4e8e\u53ef\u80fd\u5b58\u5728\u5185\u5b58\u6cc4\u6f0f\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u6765\u8bf4\u662f\u975e\u5e38\u6709\u7528\u7684. \u5982\u679c\u8bbe\u7f6e\u4e3a '0' \u5219\u4e00\u76f4\u63a5\u53d7\u8bf7\u6c42. \u7b49\u540c\u4e8e PHP_FCGI_MAX_REQUESTS \u73af\u5883\u53d8\u91cf. \u9ed8\u8ba4\u503c: 0.","text":"<p>pm.status_path = /status</p>"},{"location":"web/Apache/#fpm-none-munin","title":"FPM\u72b6\u6001\u9875\u9762\u7684\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95ee\u72b6\u6001\u9875\u9762. \u9ed8\u8ba4\u503c: none. munin\u76d1\u63a7\u4f1a\u4f7f\u7528\u5230","text":"<p>ping.path = /ping</p>"},{"location":"web/Apache/#fpmping-ping-fpm","title":"FPM\u76d1\u63a7\u9875\u9762\u7684ping\u7f51\u5740. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219\u65e0\u6cd5\u8bbf\u95eeping\u9875\u9762. \u8be5\u9875\u9762\u7528\u4e8e\u5916\u90e8\u68c0\u6d4bFPM\u662f\u5426\u5b58\u6d3b\u5e76\u4e14\u53ef\u4ee5\u54cd\u5e94\u8bf7\u6c42. \u8bf7\u6ce8\u610f\u5fc5\u987b\u4ee5\u659c\u7ebf\u5f00\u5934 (/)","text":"<p>ping.response = pong</p>"},{"location":"web/Apache/#ping-http-200-textplain-pong","title":"\u7528\u4e8e\u5b9a\u4e49ping\u8bf7\u6c42\u7684\u8fd4\u56de\u76f8\u5e94. \u8fd4\u56de\u4e3a HTTP 200 \u7684 text/plain \u683c\u5f0f\u6587\u672c. \u9ed8\u8ba4\u503c: pong.","text":"<p>request_terminate_timeout = 0</p>"},{"location":"web/Apache/#phpinimax_execution_time-0-off502","title":"\u8bbe\u7f6e\u5355\u4e2a\u8bf7\u6c42\u7684\u8d85\u65f6\u4e2d\u6b62\u65f6\u95f4. \u8be5\u9009\u9879\u53ef\u80fd\u4f1a\u5bf9php.ini\u8bbe\u7f6e\u4e2d\u7684'max_execution_time'\u56e0\u4e3a\u67d0\u4e9b\u7279\u6b8a\u539f\u56e0\u6ca1\u6709\u4e2d\u6b62\u8fd0\u884c\u7684\u811a\u672c\u6709\u7528. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off'.\u5f53\u7ecf\u5e38\u51fa\u73b0502\u9519\u8bef\u65f6\u53ef\u4ee5\u5c1d\u8bd5\u66f4\u6539\u6b64\u9009\u9879","text":"<p>request_slowlog_timeout = 10s</p>"},{"location":"web/Apache/#php-0-off","title":"\u5f53\u4e00\u4e2a\u8bf7\u6c42\u8be5\u8bbe\u7f6e\u7684\u8d85\u65f6\u65f6\u95f4\u540e\uff0c\u5c31\u4f1a\u5c06\u5bf9\u5e94\u7684PHP\u8c03\u7528\u5806\u6808\u4fe1\u606f\u5b8c\u6574\u5199\u5165\u5230\u6162\u65e5\u5fd7\u4e2d. \u8bbe\u7f6e\u4e3a '0' \u8868\u793a 'Off'","text":"<p>slowlog = log/$pool.log.slow</p>"},{"location":"web/Apache/#request_slowlog_timeout","title":"\u6162\u8bf7\u6c42\u7684\u8bb0\u5f55\u65e5\u5fd7,\u914d\u5408request_slowlog_timeout\u4f7f\u7528","text":"<p>rlimit_files = 1024</p>"},{"location":"web/Apache/#rlimit-1024-ulimit-nulimit-n-2048","title":"\u8bbe\u7f6e\u6587\u4ef6\u6253\u5f00\u63cf\u8ff0\u7b26\u7684rlimit\u9650\u5236. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c\u9ed8\u8ba4\u53ef\u6253\u5f00\u53e5\u67c4\u662f1024\uff0c\u53ef\u4f7f\u7528 ulimit -n\u67e5\u770b\uff0culimit -n 2048\u4fee\u6539","text":"<p>rlimit_core = 0</p>"},{"location":"web/Apache/#rlimit-unlimited-0","title":"\u8bbe\u7f6e\u6838\u5fc3rlimit\u6700\u5927\u9650\u5236\u503c. \u53ef\u7528\u503c: 'unlimited' \u30010\u6216\u8005\u6b63\u6574\u6570. \u9ed8\u8ba4\u503c: \u7cfb\u7edf\u5b9a\u4e49\u503c.","text":"<p>chroot =</p>"},{"location":"web/Apache/#chroot-chroot","title":"\u542f\u52a8\u65f6\u7684Chroot\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, \u5219chroot\u4e0d\u88ab\u4f7f\u7528.","text":"<p>chdir =</p>"},{"location":"web/Apache/#chdir-chroot","title":"\u8bbe\u7f6e\u542f\u52a8\u76ee\u5f55\uff0c\u542f\u52a8\u65f6\u4f1a\u81ea\u52a8Chdir\u5230\u8be5\u76ee\u5f55. \u6240\u5b9a\u4e49\u7684\u76ee\u5f55\u9700\u8981\u662f\u7edd\u5bf9\u8def\u5f84. \u9ed8\u8ba4\u503c: \u5f53\u524d\u76ee\u5f55\uff0c\u6216\u8005/\u76ee\u5f55\uff08chroot\u65f6\uff09","text":"<p>catch_workers_output = yes</p>"},{"location":"web/Apache/#stdoutstderr-stdout-stderr-fastcgi-devnull","title":"\u91cd\u5b9a\u5411\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684stdout\u548cstderr\u5230\u4e3b\u8981\u7684\u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\u4e2d. \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e, stdout \u548c stderr \u5c06\u4f1a\u6839\u636eFastCGI\u7684\u89c4\u5219\u88ab\u91cd\u5b9a\u5411\u5230 /dev/null . \u9ed8\u8ba4\u503c: \u7a7a.","text":""},{"location":"web/Nginx/","title":"Nginx&amp;&amp;Unit","text":""},{"location":"web/Nginx/#centos","title":"centos\u5b89\u88c5","text":"Bash<pre><code># To set up the yum repository for RHEL/CentOS, create the file named /etc/yum.repos.d/nginx.repo with the following contents:\n# Replace \u201cOS\u201d with \u201crhel\u201d or \u201ccentos\u201d, depending on the distribution used, and \u201cOSRELEASE\u201d with \u201c6\u201d or \u201c7\u201d, for 6.x or 7.x versions, respectively.\ncat &lt;&lt; EOF &gt; /etc/yum.repos.d/nginx.repo\n[nginx-stable]\nname=nginx stable repo\nbaseurl=http://nginx.org/packages/OS/OSRELEASE/$basearch/\ngpgcheck=1\nenabled=1\ngpgkey=https://nginx.org/keys/nginx_signing.key\nEOF\n\n\n# \u5bf9\u4e8eDebian / Ubuntu\uff0c\u4e3a\u4e86\u9a8c\u8bc1nginx\u5b58\u50a8\u5e93\u7b7e\u540d\u5e76\u5728\u5b89\u88c5nginx\u8f6f\u4ef6\u5305\u65f6\u6d88\u9664\u6709\u5173\u4e22\u5931PGP\u5bc6\u94a5\u7684\u8b66\u544a\uff0c\u6709\u5fc5\u8981\u5c06\u7528\u4e8e\u7b7e\u7f72nginx\u8f6f\u4ef6\u5305\u548c\u5b58\u50a8\u5e93\u7684\u5bc6\u94a5\u6dfb\u52a0\u5230apt\u7a0b\u5e8f\u5bc6\u94a5\u73af\u4e2d\u3002\u8bf7\u4ece\u6211\u4eec\u7684\u7f51\u7ad9\u4e0b\u8f7d\u6b64\u5bc6\u94a5\uff0c\u5e76apt \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06\u5176\u6dfb\u52a0\u5230\u7a0b\u5e8f\u5bc6\u94a5\u73af\uff1a\nwget -c http://nginx.org/keys/nginx_signing.key\nsudo apt-key add nginx_signing.key\n\n# \u5bf9\u4e8eDebian\uff0c\u7528Debian\u5206\u53d1\u4ee3\u53f7\u53d6\u4ee3codename\ncat &lt;&lt; EOF &gt; /etc/apt/sources.list\ndeb http://nginx.org/packages/debian/ codename nginx\ndeb-src http://nginx.org/packages/debian/ codename nginx\nEOF\n\napt-get update &amp;&amp; apt-get install nginx\n\n# Mainline\u7248\u672c\u7684\u9884\u6784\u5efa\u5305;\u5229\u7528rpm\u5305\u5b89\u88c5\nrpm --import nginx_signing.key\nwget http://nginx.org/packages/mainline/centos/7/x86_64/RPMS/nginx-1.13.9-1.el7_4.ngx.x86_64.rpm\nrpm -ivh nginx-1.13.9-1.el7_4.ngx.x86_64.rpm\nsystemctl enable nginx &amp;&amp; systemctl start nginx\n</code></pre> <p>2.\u4ece\u6e90\u4ee3\u7801\u6784\u5efanginx</p> Bash<pre><code>wget -c http://nginx.org/download/nginx-1.12.2.tar.gz\n# \u6784\u5efa\u4f7f\u7528configure\u547d\u4ee4\u8fdb\u884c\u914d\u7f6e\u3002\u5b83\u5b9a\u4e49\u4e86\u7cfb\u7edf\u7684\u5404\u4e2a\u65b9\u9762\uff0c\u5305\u62ecnginx\u5141\u8bb8\u7528\u4e8e\u8fde\u63a5\u5904\u7406\u7684\u65b9\u6cd5\u3002\u6700\u540e\u5b83\u521b\u5efa\u4e00\u4e2aMakefile\u3002\u8be5configure\u547d\u4ee4\u652f\u6301\u4ee5\u4e0b\u53c2\u6570\uff1a\n\n--prefix=path - \u5b9a\u4e49\u4e00\u4e2a\u5c06\u4fdd\u7559\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\u3002\u8fd9\u4e2a\u76f8\u540c\u7684\u76ee\u5f55\u4e5f\u5c06\u88ab\u7528\u4e8e\u6240\u6709\u76f8\u5173\u7684\u8def\u5f84 configure\uff08\u9664\u4e86\u6e90\u8d44\u6e90\u7684\u8def\u5f84\uff09\u548cnginx.conf\u914d\u7f6e\u6587\u4ef6\u3002\u5b83/usr/local/nginx\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a\u76ee\u5f55\n\n--sbin-path=path - \u8bbe\u7f6e\u4e00\u4e2anginx\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u5b57\u3002\u8be5\u540d\u79f0\u4ec5\u5728\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix/sbin/nginx\n\n--conf-path=path - \u8bbe\u7f6enginx.conf\u914d\u7f6e\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0cnginx\u53ef\u4ee5\u59cb\u7ec8\u4f7f\u7528\u4e0d\u540c\u7684\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\uff0c\u53ea\u8981\u5728\u547d\u4ee4\u884c\u53c2\u6570\u4e2d\u6307\u5b9a\u5373\u53ef \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d \u3002 -c fileprefix/conf/nginx.conf\n\n--pid-path=path - \u8bbe\u7f6e\u5c06\u5b58\u50a8\u4e3b\u8fdb\u7a0b\u7684\u8fdb\u7a0bID\u7684nginx.pid\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5nginx.conf\u4f7f\u7528pid\u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix/logs/nginx.pid\n\n--error-log-path=path - \u8bbe\u7f6e\u4e3b\u8981\u9519\u8bef\u7684\u540d\u79f0\uff0c\u8b66\u544a\u548c\u8bca\u65ad\u6587\u4ef6\u3002\u5b89\u88c5\u4e4b\u540e\uff0c\u53ef\u4ee5nginx.conf\u4f7f\u7528error_log\u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix/logs/error.log\n\n--http-log-path=path - \u8bbe\u7f6eHTTP\u670d\u52a1\u5668\u7684\u4e3b\u8981\u8bf7\u6c42\u65e5\u5fd7\u6587\u4ef6\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5nginx.conf\u4f7f\u7528access_log\u6307\u4ee4\u968f\u65f6\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u6587\u4ef6\u540d \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8be5\u6587\u4ef6\u88ab\u547d\u540d prefix/logs/access.log\n\n--build=name - \u8bbe\u7f6e\u4e00\u4e2a\u53ef\u9009\u7684nginx\u6784\u5efa\u540d\u79f0\n\n--user=name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5nginx.conf\u4f7f\u7528user\u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u7684\u7528\u6237\u540d\u662fnobody\n\n--group=name - \u8bbe\u7f6e\u5de5\u4f5c\u8fdb\u7a0b\u5c06\u4f7f\u7528\u5176\u51ed\u636e\u7684\u7ec4\u7684\u540d\u79f0\u3002\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5nginx.conf\u4f7f\u7528user\u6307\u4ee4\u59cb\u7ec8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d \u66f4\u6539\u540d\u79f0 \u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7ec4\u540d\u79f0\u8bbe\u7f6e\u4e3a\u975e\u7279\u6743\u7528\u6237\u7684\u540d\u79f0\n\n--with-select_module\n--without-select_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5select()\u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982kqueue\uff0cepoll\u6216/ dev / poll\uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\n\n--with-poll_module\n--without-poll_module - \u542f\u7528\u6216\u7981\u7528\u6784\u5efa\u5141\u8bb8\u670d\u52a1\u5668\u4f7f\u7528\u8be5poll()\u65b9\u6cd5\u7684\u6a21\u5757 \u3002\u5982\u679c\u5e73\u53f0\u4e0d\u652f\u6301\u66f4\u5408\u9002\u7684\u65b9\u6cd5\uff08\u5982kqueue\uff0cepoll\u6216/ dev / poll\uff09\uff0c\u5219\u81ea\u52a8\u6784\u5efa\u6b64\u6a21\u5757\n\n--without-http_gzip_module - \u7981\u7528\u6784\u5efa\u538b\u7f29 HTTP\u670d\u52a1\u5668\u54cd\u5e94\u7684\u6a21\u5757\u3002zlib\u5e93\u662f\u5efa\u7acb\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\u6240\u5fc5\u9700\u7684\n\n--without-http_rewrite_module - \u7981\u7528\u6784\u5efa\u5141\u8bb8HTTP\u670d\u52a1\u5668 \u91cd\u5b9a\u5411\u8bf7\u6c42\u5e76\u66f4\u6539\u8bf7\u6c42URI\u7684\u6a21\u5757\u3002PCRE\u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\n\n--without-http_proxy_module - \u7981\u7528\u6784\u5efaHTTP\u670d\u52a1\u5668\u4ee3\u7406\u6a21\u5757\n\n--with-http_ssl_module - \u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u6a21\u5757\uff0c\u5c06HTTPS\u534f\u8bae\u652f\u6301\u6dfb\u52a0\u5230HTTP\u670d\u52a1\u5668\u3002\u8be5\u6a21\u5757\u4e0d\u662f\u9ed8\u8ba4\u751f\u6210\u7684\u3002OpenSSL\u5e93\u9700\u8981\u6784\u5efa\u548c\u8fd0\u884c\u8fd9\u4e2a\u6a21\u5757\n\n--with-pcre=path - \u8bbe\u7f6ePCRE\u5e93\u6e90\u7684\u8def\u5f84\u3002\u56fe\u4e66\u9986\u53d1\u884c\uff08\u7248\u672c4.4 - 8.41\uff09\u9700\u8981\u4ecePCRE\u7f51\u7ad9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531nginx\u7684./configure\u548c make\u3002\u5728\u4f4d\u7f6e\u6307\u4ee4\u548c ngx_http_rewrite_module \u6a21\u5757\u4e2d\uff0c\u8be5\u5e93\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u652f\u6301\u6240\u5fc5\u9700\u7684\n\n--with-pcre-jit - \u7528\u201c\u5373\u65f6\u7f16\u8bd1\u201d\u652f\u6301\uff081.1.12\uff0cpcre_jit\u6307\u4ee4\uff09\u6784\u5efaPCRE\u5e93\n\n--with-zlib=path - \u8bbe\u7f6ezlib\u5e93\u7684\u6e90\u7684\u8def\u5f84\u3002\u5e93\u53d1\u884c\u7248\uff08\u7248\u672c1.1.3 - 1.2.11\uff09\u9700\u8981\u4ecezlib\u7ad9\u70b9\u4e0b\u8f7d \u5e76\u63d0\u53d6\u3002\u5176\u4f59\u7684\u662f\u7531nginx\u7684./configure\u548c make\u3002\u8be5\u5e93\u662fngx_http_gzip_module\u6a21\u5757\u6240\u5fc5\u9700\u7684\n\n--with-cc-opt=parameters - \u8bbe\u7f6e\u5c06\u88ab\u6dfb\u52a0\u5230CFLAGS\u53d8\u91cf\u7684\u9644\u52a0\u53c2\u6570\u3002\u5728FreeBSD\u4e0b\u4f7f\u7528\u7cfb\u7edfPCRE\u5e93\u65f6\uff0c --with-cc-opt=\"-I /usr/local/include\" \u5e94\u8be5\u6307\u5b9a\u3002\u5982\u679cselect()\u9700\u8981\u589e\u52a0\u652f\u6301\u7684\u6587\u4ef6\u6570\u91cf\uff0c\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u6307\u5b9a\u5982\u4e0b\uff1a --with-cc-opt=\"-D FD_SETSIZE=2048\"\n\n--with-ld-opt=parameters - \u8bbe\u7f6e\u5c06\u5728\u94fe\u63a5\u671f\u95f4\u4f7f\u7528\u7684\u5176\u4ed6\u53c2\u6570\u3002\u5728FreeBSD\u4e0b\u4f7f\u7528\u7cfb\u7edfPCRE\u5e93\u65f6\uff0c --with-ld-opt=\"-L /usr/local/lib\" \u5e94\u8be5\u6307\u5b9a\n\n\u53c2\u6570\u4f7f\u7528\u793a\u4f8b\uff08\u6240\u6709\u8fd9\u4e9b\u90fd\u9700\u8981\u8f93\u5165\u4e00\u884c\uff09\uff1a\n\n./configure --sbin-path=/usr/local/nginx/nginx --conf-path=/usr/local/nginx/nginx.conf --pid-path=/usr/local/nginx/nginx.pid --with-http_ssl_module --with-pcre=../pcre-8.41 --with-zlib=../zlib-1.2.11\n\u914d\u7f6e\u5b8c\u6210\u540e\uff0cmake &amp;&amp; make install\u5b89\u88c5\n\n\u9a8c\u8bc1nginx\u662f\u5426\u8fd0\u884c\uff1acurl -I 127.0.0.1\n</code></pre>"},{"location":"web/Nginx/#_1","title":"\u5173\u4e8e\u6784\u5efa\u6a21\u5757","text":"Bash<pre><code>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u5305\u62ec\u7684\u6a21\u5757\u4ee5\u53ca\u7b2c\u4e09\u65b9\u6a21\u5757\u5fc5\u987b\u5728configure\u811a\u672c\u4e2d\u4e0e\u5176\u4ed6\u6784\u5efa\u9009\u9879\u4e00\u8d77\u663e\u5f0f\u6307\u5b9a\u3002\u8fd9\u4e9b\u6a21\u5757\u53ef\u4ee5\u9759\u6001\u94fe\u63a5\u5230NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08\u6bcf\u6b21NGINX\u542f\u52a8\u65f6\u52a0\u8f7d\u5b83\u4eec\uff09\u6216\u52a8\u6001\u52a0\u8f7d\uff08\u53ea\u6709\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u5305\u542b\u76f8\u5173\u6307\u4ee4\u65f6\u624d\u52a0\u8f7d\u5b83\u4eec\n\n\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\n\u5982\u679c\u60a8\u4e0d\u9700\u8981\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u811a\u672c--without-&lt;MODULE-NAME&gt;\u4e0a\u7684\u9009\u9879\u547d\u540d\u5b83\u6765\u7981\u7528\u5b83configure\uff0c\u5982\u6b64\u793a\u4f8b\u4e2d\u7981\u7528Empty GIF\u6a21\u5757\uff08\u5e94\u8be5\u952e\u5165\u4e3a\u5355\u884c\uff09\uff1a\n</code></pre> <p>\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757\u5982\u4e0b\uff1a | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | http_access_module | \u63a5\u53d7\u6216\u62d2\u7edd\u6765\u81ea\u6307\u5b9a\u5ba2\u6237\u7aef\u5730\u5740\u7684\u8bf7\u6c42\u3002 | | http_auth_basic_module | \u901a\u8fc7\u4f7f\u7528HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u9650\u5236\u5bf9\u8d44\u6e90\u7684\u8bbf\u95ee\u3002 | | http_autoindex_module | \u5904\u7406\u4ee5\u6b63\u659c\u6760\u5b57\u7b26\uff08/\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u751f\u6210\u76ee\u5f55\u5217\u8868\u3002 | | http_browser_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8eUser-Agent\u8bf7\u6c42\u6807\u5934\u503c\u7684\u53d8\u91cf\u3002 | | http_charset_module | \u5c06\u6307\u5b9a\u7684\u5b57\u7b26\u96c6\u6dfb\u52a0\u5230Content-Type\u54cd\u5e94\u6807\u5934\u3002\u53ef\u4ee5\u5c06\u6570\u636e\u4ece\u4e00\u4e2a\u5b57\u7b26\u96c6\u8f6c\u6362\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u96c6 | | http_empty_gif_module | \u53d1\u51fa\u5355\u50cf\u7d20\u900f\u660eGIF\u3002 | | http_fastcgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u3002 | | http_geo_module | \u4f7f\u7528\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u503c\u521b\u5efa\u53d8\u91cf\u3002 | | http_gzip_module | \u4f7f\u7528gzip\u538b\u7f29\u54cd\u5e94\uff0c\u5c06\u4f20\u8f93\u6570\u636e\u91cf\u51cf\u5c11\u4e00\u534a\u6216\u66f4\u591a\u3002 | | http_limit_conn_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8fde\u63a5\u6570\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8fde\u63a5\u6570\u3002 | | http_limit_req_module | \u9650\u5236\u6bcf\u4e2a\u5b9a\u4e49\u5bc6\u94a5\u7684\u8bf7\u6c42\u5904\u7406\u901f\u7387\uff0c\u7279\u522b\u662f\u6765\u81ea\u5355\u4e2aIP\u5730\u5740\u7684\u8bf7\u6c42\u7684\u5904\u7406\u901f\u7387\u3002 | | http_map_module | \u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5176\u4ed6\u53d8\u91cf\u503c\u7684\u53d8\u91cf\u3002 | | http_memcached_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9memcached\u670d\u52a1\u5668\u3002 | | http_proxy_module | \u5c06HTTP\u8bf7\u6c42\u4f20\u9012\u7ed9\u53e6\u4e00\u53f0\u670d\u52a1\u5668\u3002 | | http_referer_module | \u5728Referer\u6807\u5934\u4e2d\u963b\u6b62\u5177\u6709\u65e0\u6548\u503c\u7684\u8bf7\u6c42\u3002 | | http_rewrite_module | \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u66f4\u6539\u8bf7\u6c42URI\u5e76\u8fd4\u56de\u91cd\u5b9a\u5411; \u6709\u6761\u4ef6\u5730\u9009\u62e9\u914d\u7f6e\u3002\u9700\u8981PCRE\u5e93\u3002 | | http_scgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9SCGI\u670d\u52a1\u5668\u3002 | | http_ssi_module | \u5728\u901a\u8fc7\u5b83\u7684\u54cd\u5e94\u4e2d\u5904\u7406SSI\uff08\u670d\u52a1\u5668\u7aef\u5305\u542b\uff09\u547d\u4ee4\u3002 | | http_split_clients_module | \u521b\u5efa\u9002\u5408A / B\u6d4b\u8bd5\u7684\u53d8\u91cf\uff0c\u4e5f\u79f0\u4e3a\u62c6\u5206\u6d4b\u8bd5\u3002 | | http_upstream_hash_module | \u542f\u7528\u901a\u7528\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_ip_hash_module | \u542f\u7528IP\u54c8\u5e0c\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_keepalive_module | \u542f\u7528keepalive\u8fde\u63a5\u3002 | | http_upstream_least_conn_module | \u542f\u7528\u6700\u5c11\u8fde\u63a5\u8d1f\u8f7d\u5e73\u8861\u65b9\u6cd5\u3002 | | http_upstream_zone_module | \u542f\u7528\u5171\u4eab\u5185\u5b58\u533a\u57df\u3002 | | http_userid_module | \u8bbe\u7f6e\u9002\u5408\u5ba2\u6237\u8bc6\u522b\u7684cookie\u3002 | | http_uwsgi_module | \u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9uwsgi\u670d\u52a1\u5668\u3002 |</p>"},{"location":"web/Nginx/#_2","title":"\u5305\u62ec\u975e\u9ed8\u8ba4\u6784\u5efa\u7684\u6a21\u5757","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u6784\u5efa\u8bb8\u591aNGINX\u6a21\u5757\uff0c\u5fc5\u987b\u5728configure\u8981\u6784\u5efa\u7684\u547d\u4ee4\u884c\u4e2d\u5217\u51fa | \u6a21\u5757\u540d\u79f0 | \u63cf\u8ff0 | | :------: | :------: | | --with-cpp_test_module | \u6d4b\u8bd5\u5934\u6587\u4ef6\u7684C ++\u517c\u5bb9\u6027\u3002 | | --with-debug | \u542f\u7528\u8c03\u8bd5\u65e5\u5fd7\u3002 | | --with-file-aio | \u542f\u7528\u5f02\u6b65I / O. | | --with-google_perftools_module | \u5141\u8bb8\u4f7f\u7528Google Performance\u5de5\u5177\u5e93 | | -- \u4e0e-http_addition_module | \u5728\u54cd\u5e94\u4e4b\u524d\u548c\u4e4b\u540e\u6dfb\u52a0\u6587\u672c\u3002 | | -- \u4e0e-http_auth_request_module | \u6839\u636e\u5b50\u8bf7\u6c42\u7684\u7ed3\u679c\u5b9e\u73b0\u5ba2\u6237\u7aef\u6388\u6743\u3002 | | -- \u4e0e-http_dav_module | \u4f7f\u7528WebDAV\u534f\u8bae\u542f\u7528\u6587\u4ef6\u7ba1\u7406\u81ea\u52a8\u5316\u3002 | | --with-http_degradation_module | \u5141\u8bb8\u5728\u5185\u5b58\u5927\u5c0f\u8d85\u8fc7\u5b9a\u4e49\u7684\u503c\u65f6\u8fd4\u56de\u9519\u8bef\u3002 | | -- \u4e0e-http_flv_module | \u4e3aFlash Video\uff08FLV\uff09\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_geoip_module | \u5141\u8bb8\u521b\u5efa\u5176\u503c\u53d6\u51b3\u4e8e\u5ba2\u6237\u7aefIP\u5730\u5740\u7684\u53d8\u91cf\u3002\u8be5\u6a21\u5757\u4f7f\u7528MaxMind GeoIP\u6570\u636e\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a-with-http_geoip_module = dynamic\u3002 | | -- \u4e0e-http_gunzip_module | \u4f7f\u7528Content-Encoding\u89e3\u538b\u7f29\u54cd\u5e94\uff1agzip\u7528\u4e8e\u4e0d\u652f\u6301_zip_ encoding\u65b9\u6cd5\u7684\u5ba2\u6237\u7aef\u3002 | | -- \u4e0e-http_gzip_static_module | \u5141\u8bb8\u4f7f\u7528.gz\u6587\u4ef6\u6269\u5c55\u540d\u800c\u4e0d\u662f\u5e38\u89c4\u6587\u4ef6\u53d1\u9001\u9884\u538b\u7f29\u6587\u4ef6\u3002 | | -- \u4e0e-http_image_filter_module | \u4ee5JPEG\uff0cGIF\u548cPNG\u683c\u5f0f\u8f6c\u6362\u56fe\u50cf\u3002\u8be5\u6a21\u5757\u9700\u8981LibGD\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_image_filter_module=dynamic\u3002 | | -- \u4e0e-http_mp4_module | \u4e3aMP4\u6587\u4ef6\u63d0\u4f9b\u4f2a\u6d41\u670d\u52a1\u5668\u7aef\u652f\u6301\u3002 | | -- \u4e0e-http_perl_module | \u7528\u4e8e\u5728Perl\u4e2d\u5b9e\u73b0\u4f4d\u7f6e\u548c\u53d8\u91cf\u5904\u7406\u7a0b\u5e8f\uff0c\u5e76\u5c06Perl\u8c03\u7528\u63d2\u5165SSI\u3002\u9700\u8981PERL\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_perl_module=dynamic\u3002 | | -- \u4e0e-http_random_index_module | \u5904\u7406\u4ee5\u659c\u6760\u5b57\u7b26\uff08'/'\uff09\u7ed3\u5c3e\u7684\u8bf7\u6c42\uff0c\u5e76\u5728\u76ee\u5f55\u4e2d\u9009\u62e9\u4e00\u4e2a\u968f\u673a\u6587\u4ef6\u4f5c\u4e3a\u7d22\u5f15\u6587\u4ef6\u3002 | | -- \u4e0e-http_realip_module | \u5c06\u5ba2\u6237\u7aef\u5730\u5740\u66f4\u6539\u4e3a\u5728\u6307\u5b9a\u7684\u6807\u5934\u5b57\u6bb5\u4e2d\u53d1\u9001\u7684\u5730\u5740\u3002 | | -- \u4e0e-http_secure_link_module | \u7528\u4e8e\u68c0\u67e5\u8bf7\u6c42\u7684\u94fe\u63a5\u7684\u771f\u5b9e\u6027\uff0c\u4fdd\u62a4\u8d44\u6e90\u514d\u53d7\u672a\u7ecf\u6388\u6743\u7684\u8bbf\u95ee\uff0c\u5e76\u9650\u5236\u94fe\u63a5\u7684\u751f\u547d\u5468\u671f\u3002 | | -- \u4e0e-http_slice_module | \u5141\u8bb8\u5c06\u8bf7\u6c42\u62c6\u5206\u4e3a\u5b50\u8bf7\u6c42\uff0c\u6bcf\u4e2a\u5b50\u8bf7\u6c42\u8fd4\u56de\u4e00\u5b9a\u8303\u56f4\u7684\u54cd\u5e94\u3002\u63d0\u4f9b\u66f4\u6709\u6548\u7684\u5927\u6587\u4ef6\u7f13\u5b58\u3002 | | -- \u4e0e-http_ssl_module | \u542f\u7528HTTPS\u652f\u6301\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e-http_stub_status_module | \u63d0\u4f9b\u5bf9\u57fa\u672c\u72b6\u6001\u4fe1\u606f\u7684\u8bbf\u95ee\u3002\u8bf7\u6ce8\u610f\uff0cNGINX Plus\u5ba2\u6237\u4e0d\u9700\u8981\u6b64\u6a21\u5757\uff0c\u56e0\u4e3a\u5b83\u4eec\u5df2\u7ecf\u63d0\u4f9b\u4e86\u6269\u5c55\u72b6\u6001\u6307\u6807\u548c\u4ea4\u4e92\u5f0f\u4eea\u8868\u677f\u3002 | | -- \u4e0e-http_sub_module | \u901a\u8fc7\u5c06\u4e00\u4e2a\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u66ff\u6362\u4e3a\u53e6\u4e00\u4e2a\u6765\u4fee\u6539\u54cd\u5e94\u3002 | | -- \u4e0e-http_xslt_module | \u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aXSLT\u6837\u5f0f\u8868\u8f6c\u6362XML\u54cd\u5e94\u3002\u8be5\u6a21\u5757\u9700\u8981Libxml2\u548cXSLT\u5e93\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-http_xslt_module=dynamic\u3002 | | -- \u4e0e-http_v2_module | \u542f\u7528\u5bf9HTTP / 2\u7684\u652f\u6301\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX\u535a\u5ba2\u4e0aNGINX\u4e2d\u7684HTTP / 2\u6a21\u5757\u3002 | | -- \u7528\u90ae\u4ef6 | \u542f\u7528\u90ae\u4ef6\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-mail=dynamic\u3002 | | -- \u4e0e-mail_ssl_module | \u4e3a\u90ae\u4ef6\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | -- \u4e0e\u6d41 | \u542f\u7528TCP\u548cUDP\u4ee3\u7406\u529f\u80fd\u3002\u8981\u7f16\u8bd1\u4e3a\u5355\u72ec\u7684\u52a8\u6001\u6a21\u5757\uff0c\u8bf7\u5c06\u9009\u9879\u66f4\u6539\u4e3a--with-stream=dynamic\u3002 | | -- \u4e0e-stream_ssl_module | \u4e3a\u6d41\u4ee3\u7406\u670d\u52a1\u5668\u63d0\u4f9b\u652f\u6301\u4ee5\u4f7f\u7528SSL / TLS\u534f\u8bae\u3002\u9700\u8981\u4e00\u4e2aSSL\u5e93\uff0c\u5982OpenSSL\u3002 | | --with-threads | \u4f7fNGINX\u80fd\u591f\u4f7f\u7528\u7ebf\u7a0b\u6c60\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605NGINX Boost Performance 9x\u4e2d\u7684\u7ebf\u7a0b\u6c60\uff01\u5728NGINX\u535a\u5ba2\u4e0a\u3002 |</p>"},{"location":"web/Nginx/#_3","title":"\u5176\u4ed6\u6a21\u5757","text":"Text Only<pre><code>\u9759\u6001\u94fe\u63a5\u6a21\u5757\nNGINX\u5f00\u6e90\u4e2d\u5185\u7f6e\u7684\u5927\u591a\u6570\u6a21\u5757\u90fd\u662f\u9759\u6001\u94fe\u63a5\u7684\uff1a\u5b83\u4eec\u5728\u7f16\u8bd1\u65f6\u5185\u7f6e\u4e8eNGINX\u5f00\u6e90\u4e2d\uff0c\u5e76\u9759\u6001\u94fe\u63a5\u5230NGINX\u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 \u53ea\u80fd\u901a\u8fc7\u91cd\u65b0\u7f16\u8bd1NGINX\u6765\u7981\u7528\u8fd9\u4e9b\u6a21\u5757\u3002[NGINX Wiki](https://nginx.com/resources/wiki/modules/)\u4e2d   \u5217\u51fa\u4e86\u4e00\u4e9b\u7b2c\u4e09\u65b9\u6a21\u5757\n\u8981\u4f7f\u7528\u9759\u6001\u94fe\u63a5\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1NGINX Open Source\uff0c\u8bf7--add-module=&lt;PATH&gt;\u5728configure\u547d\u4ee4\u4e2d\u5305\u542b\u9009\u9879\uff0c   \u5176\u4e2d&lt;PATH&gt;\u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff08\u6b64\u793a\u4f8b\u9002\u7528\u4e8eRTMP \u6a21\u5757\uff09\uff1a\n./configure ... --add-module = / usr / build / nginx-rtmp-module\n\n\u52a8\u6001\u94fe\u63a5\u6a21\u5757\nNGINX\u6a21\u5757\u4e5f\u53ef\u4ee5\u7f16\u8bd1\u4e3a\u5171\u4eab\u5bf9\u8c61\uff08* .so\u6587\u4ef6\uff09\uff0c\u7136\u540e\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u52a0\u8f7d\u5230NGINX Open Source\u4e2d\u3002\u8fd9\u63d0\u4f9b\u4e86\u66f4\u5927\u7684   \u7075\u6d3b\u6027\uff0c\u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7load_module\u5728NGINX\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6216\u5220\u9664\u5173\u8054\u6307\u4ee4\u5e76\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6765\u968f\u65f6\u52a0\u8f7d\u6216\u5378\u8f7d\u6a21\u5757\u3002 \u8bf7\u6ce8\u610f\uff0c\u6a21\u5757\u672c\u8eab\u5fc5\u987b\u652f\u6301\u52a8\u6001\u94fe\u63a5\n\u8981\u4f7f\u7528\u52a8\u6001\u52a0\u8f7d\u7684\u7b2c\u4e09\u65b9\u6a21\u5757\u7f16\u8bd1NGINX Open Source\uff0c\u8bf7--add-dynamic-module=&lt;PATH&gt;\u5728configure\u547d\u4ee4\u4e2d \u5305\u542b\u9009\u9879\uff0c\u5176\u4e2d&lt;PATH&gt;\u662f\u6e90\u4ee3\u7801\u7684\u8def\u5f84\uff1a\n./configure ... --add-dynamic-module = &lt;PATH&gt;\n\u751f\u6210\u7684* .so\u6587\u4ef6\u5c06\u5199\u5165\u524d\u7f00/ modules /\u76ee\u5f55\uff0c\u5176\u4e2d\u524d\u7f00\u662f\u670d\u52a1\u5668\u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u4f8b\u5982/ usr / local / nginx /\n\u8981\u52a0\u8f7d\u52a8\u6001\u6a21\u5757\uff0c\u8bf7load_module\u5728\u5b89\u88c5\u540e\u5c06\u6307\u4ee4\u6dfb\u52a0\u5230NGINX\u914d\u7f6e\uff1a\nload_module modules / ngx_mail_module.so;\n</code></pre>"},{"location":"web/Nginx/#nginx","title":"nginx\u5185\u6838\u76f8\u5173\u53c2\u6570","text":"Markdown<pre><code># /etc/sysctl.conf\n# Avoid a smurf attack\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\n# Turn on protection for bad icmp error messages\nnet.ipv4.icmp_ignore_bogus_error_responses = 1\n\n# Turn on syncookies for SYN flood attack protection\nnet.ipv4.tcp_syncookies = 1\n\n# Turn on and log spoofed, source routed, and redirect packets\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\n# No source routed packets here\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\n\n# Turn on reverse path filtering\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\n# Make sure no one can alter the routing tables\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\n# Don't act as a router\nnet.ipv4.ip_forward = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\n\n# Turn on execshild\nkernel.exec-shield = 1\nkernel.randomize_va_space = 1\n\n# Tuen IPv6\nnet.ipv6.conf.default.router_solicitations = 0\nnet.ipv6.conf.default.accept_ra_rtr_pref = 0\nnet.ipv6.conf.default.accept_ra_pinfo = 0\nnet.ipv6.conf.default.accept_ra_defrtr = 0\nnet.ipv6.conf.default.autoconf = 0\nnet.ipv6.conf.default.dad_transmits = 0\nnet.ipv6.conf.default.max_addresses = 1\n\n# Optimization for port usefor LBs\n# Increase system file descriptor limit\nfs.file-max = 65535\n\n# Allow for more PIDs (to reduce rollover problems); may break some programs 32768\nkernel.pid_max = 65536\n\n# Increase system IP port limits\nnet.ipv4.ip_local_port_range = 2000 65000\n\n# Increase TCP max buffer size setable using setsockopt()\nnet.ipv4.tcp_rmem = 4096 87380 8388608\nnet.ipv4.tcp_wmem = 4096 87380 8388608\n\n# Increase Linux auto tuning TCP buffer limits\n# min, default, and max number of bytes to use\n# set max to at least 4MB, or higher if you use very high BDP paths\n# Tcp Windows etc\nnet.core.rmem_max = 8388608\nnet.core.wmem_max = 8388608\nnet.core.netdev_max_backlog = 5000\nnet.ipv4.tcp_window_scaling = 1\n</code></pre>"},{"location":"web/Nginx/#_4","title":"\u521d\u5b66\u8005\u6307\u5357","text":"Bash<pre><code>\u8981\u542f\u52a8nginx\uff0c\u8bf7\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u3002\u542f\u52a8nginx\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528-s\u53c2\u6570\u8c03\u7528\u53ef\u6267\u884c\u6587\u4ef6\u6765\u63a7\u5236\u5b83\u3002\u4f7f\u7528\u4ee5\u4e0b\u8bed\u6cd5\uff1a\nnginx -s signal\nsignal\u53ef\u4ee5\u662f\u4e0b\u5217\u4e4b\u4e00\uff1a\nstop - \u5feb\u901f\u5173\u673a\nquit - \u4f18\u96c5\u7684\u5173\u673a\nreload - \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\nreopen - \u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\n\n\u4f8b\u5982\uff0c\u8981\u5728\u7b49\u5f85\u5de5\u4f5c\u8fdb\u7a0b\u5b8c\u6210\u5f53\u524d\u8bf7\u6c42\u7684\u670d\u52a1\u65f6\u505c\u6b62nginx\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\nnginx -s quit\n\u6b64\u547d\u4ee4\u5e94\u5728\u542f\u52a8nginx\u7684\u540c\u4e00\u7528\u6237\u4e0b\u6267\u884c\n\nnginx\u7531\u6a21\u5757\u7ec4\u6210\uff0c\u6a21\u5757\u7531\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\u7684\u6307\u4ee4\u63a7\u5236\uff0c\u6307\u4ee4\u5206\u4e3a\u7b80\u5355\u6307\u4ee4\u548c\u5757\u6307\u4ee4\uff0c\u7b80\u5355\u6307\u4ee4\u5305\u62ec\u7531\u7a7a\u683c\u5206\u9694\u7684\u540d\u79f0\u548c\u53c2\u6570\uff0c\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u5757\u6307\u4ee4\u548c\u7b80\u5355\u6307\u4ee4\u76f8\u540c\u7ed3\u6784\uff0c\u4f46\u4e0d\u4ee5\u5206\u53f7\u7ed3\u5c3e\uff0c\u800c\u662f\u4ee5\u5927\u62ec\u53f7{}\u5305\u56f4\u7684\u4e00\u7ec4\u9644\u52a0\u6307\u4ee4\u7ed3\u675f\uff0c\u82e5\u5757\u6307\u4ee4\u53ef\u4ee5\u5728\u5927\u62ec\u53f7\u5305\u542b\u5176\u4ed6\u6307\u4ee4\uff0c\u5219\u79f0\u4e3a\u4e0a\u4e0b\u6587\u3002\u5982\uff1aevents,http,server\u548clocation\n\u653e\u7f6e\u5728\u4efb\u4f55\u4e0a\u4e0b\u6587\u4e4b\u5916\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u90fd\u88ab\u8ba4\u4e3a\u662f\u5728\u4e3b\u4e0a\u4e0b\u6587\u4e2d\u3002\u5728events\u548chttp\u6307\u4ee4\u9a7b\u7559\u5728main\u4e0a\u4e0b\u6587server\u4e2d\uff0chttp\u548clocation\u5728server\u4e2d\n</code></pre>"},{"location":"web/Nginx/#_5","title":"\u9759\u6001\u5185\u5bb9","text":"Bash<pre><code>\u4ece/data/www\u76ee\u5f55\u63d0\u4f9b\u6587\u4ef6\uff0c\u7f16\u8f91\u914d\u7f6e\u6587\u4ef6\u5e76\u4f7f\u7528\u4e24\u4e2alocation\u5757\u5728http\u5757\u5185\u8bbe\u7f6eserver\u5757\n\u5c06html\u7b49\u9759\u6001\u6587\u4ef6\u653e\u5165/data/www\uff0c\u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff0c\u9ed8\u8ba4\u5df2\u5305\u542b\u51e0\u4e2aserver\u5757\u5b9e\u4f8b\nhttp {\n  server {\n  }\n}\n\u901a\u5e38\u914d\u7f6e\u6587\u4ef6\u5305\u62ec\u5b83\u76d1\u542c\u7684\u7aef\u53e3\u548c\u670d\u52a1\u5668\u540d\u79f0\u533a\u5206\u7684\u82e5\u5e72\u4e2aserver\u5757\uff0c\u4e00\u65e6nginx\u51b3\u5b9a\u5bf9\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u5b83\u6839\u636e\u5757\u7684\u5b9a\u4e49\u7684\u6307\u4ee4\u53c2\u6570\u6d4b\u8bd5\u8bf7\u6c42\u5934\u4e2d\u6307\u5b9a\u7684URI\n\u5c06\u4ee5\u4e0blocation\u5757\u6dfb\u52a0\u5230server\u5757\u4e2d\nlocation / {\n  root /data/ww;\n}\n\u6b64location\u5757\u6307\u5b9a/\u4e0e\u8bf7\u6c42\u4e2d\u7684URI\u8fdb\u884c\u6bd4\u8f83\u7684\u201c/\u201d\u524d\u7f00\u3002\u5bf9\u4e8e\u5339\u914d\u8bf7\u6c42\uff0cURI\u5c06\u6dfb\u52a0\u5230root \u6307\u4ee4\u4e2d\u6307\u5b9a\u7684\u8def\u5f84 \uff0c\u5373to /data/www\uff0c\u4ee5\u5f62\u6210\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u6240\u8bf7\u6c42\u6587\u4ef6\u7684\u8def\u5f84\u3002\u5982\u679c\u5b58\u5728\u591a\u4e2a\u5339\u914dlocation\u5757\uff0c\u5219nginx\u9009\u62e9\u5177\u6709\u6700\u957f\u524d\u7f00\u7684\u5757\u3002location\u4e0a\u9762\u7684\u5757\u63d0\u4f9b\u957f\u5ea6\u4e3a1\u7684\u6700\u77ed\u524d\u7f00\uff0c\u56e0\u6b64\u53ea\u6709\u5f53\u6240\u6709\u5176\u4ed6location \u5757\u90fd\u65e0\u6cd5\u63d0\u4f9b\u5339\u914d\u65f6\uff0c\u624d\u4f1a\u4f7f\u7528\u6b64\u5757\n\u63a5\u7740\u6dfb\u52a0\u7b2c\u4e8c\u4e2alocation\u5757\uff1a\nlocation /images/ {\n  root /data;\n}\n\u5b83\u5c06\u5339\u914d\u4ee5/images/\u5f00\u5934\u7684\u8bf7\u6c42(location / \u4e5f\u5339\u914d\u6b64\u7c7b\u8bf7\u6c42\uff0c\u4f46\u524d\u7f00\u66f4\u77ed)\n\nserver\u5757 \u7684\u7ed3\u679c\u914d\u7f6e\u5e94\u5982\u4e0b\u6240\u793a\uff1a\n\nserver {\n    location / {\n        root /data/www;\n    }\n\n    location /images/ {\n        root /data;\n    }\n}\n</code></pre>"},{"location":"web/Nginx/#_6","title":"\u8bbe\u7f6e\u7b80\u5355\u7684\u4ee3\u7406\u670d\u52a1\u5668","text":"Bash<pre><code>nginx\u53ef\u4ee5\u7528\u4f5c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5373\u670d\u52a1\u5668\u63a5\u53d7\u8bf7\u6c42\uff0c\u5c06\u8fd9\u4e9b\u8bf7\u6c42\u4f20\u9012\u7ed9\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ece\u4e2d\u68c0\u7d22\u54cd\u5e94\uff0c\u7136\u540e\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\n\u6211\u4eec\u5c06\u914d\u7f6e\u4e00\u4e2a\u57fa\u672c\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5b83\u4f7f\u7528\u6765\u81ea\u672c\u5730\u76ee\u5f55\u7684\u6587\u4ef6\u5904\u7406\u56fe\u50cf\u8bf7\u6c42\uff0c\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u53d1\u9001\u5230\u4ee3\u7406\u670d\u52a1\u5668\u3002\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u5c06\u5728\u5355\u4e2anginx\u5b9e\u4f8b\u4e0a\u5b9a\u4e49\u4e24\u4e2a\u670d\u52a1\u5668\n\n\u5411server nginx\u7684\u914d\u7f6e\u6587\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u4ee5\u4e0a\u5185\u5bb9\u6765\u5b9a\u4e49\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a\n\nserver {\n    listen 8080;\n    root /data/up1;\n\n    location / {\n    }\n}\n\u8fd9\u5c06\u662f\u4e00\u4e2a\u4fa6\u542c\u7aef\u53e38080\u7684\u7b80\u5355\u670d\u52a1\u5668\uff08\u4e4b\u524d\uff0clisten\u81ea\u4f7f\u7528\u6807\u51c6\u7aef\u53e380\u4ee5\u6765\u672a\u6307\u5b9a\u8be5\u6307\u4ee4\uff09\u5e76\u5c06\u6240\u6709\u8bf7\u6c42\u6620\u5c04\u5230/data/up1\u672c\u5730\u6587\u4ef6\u7cfb\u7edf\u4e0a\u7684\u76ee\u5f55\u3002\u521b\u5efa\u6b64\u76ee\u5f55\u5e76\u5c06index.html\u6587\u4ef6\u653e\u5165\u5176\u4e2d\u3002\u8bf7\u6ce8\u610f\uff0c\u8be5root\u6307\u4ee4\u653e\u5728 server\u4e0a\u4e0b\u6587\u4e2d\uff0c\u5f53location\u9009\u62e9\u7528\u4e8e\u63d0\u4f9b\u8bf7\u6c42\u7684\u5757\u4e0d\u5305\u62ec\u81ea\u5df1\u7684root\u6307\u4ee4\u65f6\uff0c\u4f7f\u7528\u8fd9\u6837\u7684\u6307\u4ee4\n\u63a5\u4e0b\u6765\uff0c\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u7684\u670d\u52a1\u5668\u914d\u7f6e\u5e76\u5bf9\u5176\u8fdb\u884c\u4fee\u6539\u4ee5\u4f7f\u5176\u6210\u4e3a\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u3002\u5728\u7b2c\u4e00\u4e2alocation\u5757\u4e2d\uff0c\u5c06 proxy_pass \u6307\u4ee4\u4e0e\u53c2\u6570\u4e2d\u6307\u5b9a\u7684\u4ee3\u7406\u670d\u52a1\u5668\u7684\u534f\u8bae\uff0c\u540d\u79f0\u548c\u7aef\u53e3\u653e\u5728\u4e00\u8d77\uff08\u5728\u6211\u4eec\u7684\u793a\u4f8b\u4e2d\uff0c\u5b83\u662fhttp://localhost:8080\uff09\uff1a\n\nserver {\n    location / {\n        proxy_pass http\uff1a//localhost\uff1a8080;\n    }\n\n    location / images / {\n        root / data;\n    }\n}\n\u6211\u4eec\u5c06\u4fee\u6539\u7b2c\u4e8c\u4e2alocation \u5757\uff0c\u8be5\u5757\u5f53\u524d\u5c06\u5e26\u6709/images/\u524d\u7f00\u7684\u8bf7\u6c42\u6620\u5c04\u5230\u76ee\u5f55\u4e0b\u7684/data/images\u6587\u4ef6\uff0c\u4ee5\u4f7f\u5176\u4e0e\u5177\u6709\u5178\u578b\u6587\u4ef6\u6269\u5c55\u540d\u7684\u56fe\u50cf\u8bf7\u6c42\u76f8\u5339\u914d\u3002\u4fee\u6539\u540e\u7684location\u5757\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a\nlocation ~ \\.(gif|jpg|png)$ {\n    root /data/images;\n}\n\u8be5\u53c2\u6570\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7ed3\u5c3e\u7684\u6240\u6709URI .gif\uff0c.jpg\u6216.png\u3002\u5e94\u8be5\u4ee5\u6b63\u5219\u8868\u8fbe\u5f0f\u5f00\u5934~\u3002\u76f8\u5e94\u7684\u8bf7\u6c42\u5c06\u6620\u5c04\u5230\u8be5/data/images \u76ee\u5f55\n\n\u5f53nginx\u9009\u62e9\u4e00\u4e2alocation\u5757\u6765\u63d0\u4f9b\u8bf7\u6c42\u65f6\uff0c\u5b83\u9996\u5148\u68c0\u67e5 \u6307\u5b9a\u524d\u7f00\u7684\u4f4d\u7f6e\u6307\u4ee4\uff0c\u8bb0\u4f4flocation \u6700\u957f\u7684\u524d\u7f00\uff0c\u7136\u540e\u68c0\u67e5\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5982\u679c\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219nginx\u9009\u62e9\u6b64\u9879 location\uff0c\u5426\u5219\uff0c\u5b83\u4f1a\u9009\u62e9\u4e4b\u524d\u8bb0\u4f4f\u7684\u90a3\u4e2a\n\u751f\u6210\u7684\u4ee3\u7406\u670d\u52a1\u5668\u914d\u7f6e\u5982\u4e0b\u6240\u793a\uff1a\nserver {\n    location / {\n        proxy_pass http://localhost:8080/;\n    }\n\n    location ~ \\.(gif|jpg|png)$ {\n        root /data/images;\n    }\n}\n\u6b64\u670d\u52a1\u5668\u5c06\u8fc7\u6ee4\u4ee5.gif.jpg\u6216\u8005.png \u5c06\u5176\u6620\u5c04\u5230/data/images\u76ee\u5f55\u7684\u8bf7\u6c42\uff08\u901a\u8fc7\u5411root\u6307\u4ee4\u7684\u53c2\u6570\u6dfb\u52a0URI \uff09\u5e76\u5c06\u6240\u6709\u5176\u4ed6\u8bf7\u6c42\u4f20\u9012\u7ed9\u4e0a\u9762\u914d\u7f6e\u7684\u4ee3\u7406\u670d\u52a1\u5668\n</code></pre>"},{"location":"web/Nginx/#fastcgi","title":"\u8bbe\u7f6eFastCGI\u4ee3\u7406","text":"Bash<pre><code>nginx\u53ef\u7528\u4e8e\u5c06\u8bf7\u6c42\u8def\u7531\u5230FastCGI\u670d\u52a1\u5668\uff0c\u8fd9\u4e9b\u670d\u52a1\u5668\u8fd0\u884c\u4f7f\u7528\u5404\u79cd\u6846\u67b6\u548c\u7f16\u7a0b\u8bed\u8a00\uff08\u5982PHP\uff09\u6784\u5efa\u7684\u5e94\u7528\u7a0b\u5e8f\n\n\u4f7f\u7528FastCGI\u670d\u52a1\u5668\u7684\u6700\u57fa\u672c\u7684nginx\u914d\u7f6e\u5305\u62ec\u4f7f\u7528 fastcgi_pass \u6307\u4ee4\u800c\u4e0d\u662fproxy_pass\u6307\u4ee4\uff0c\u4ee5\u53cafastcgi_param \u6307\u4ee4\u6765\u8bbe\u7f6e\u4f20\u9012\u7ed9FastCGI\u670d\u52a1\u5668\u7684\u53c2\u6570\u3002\u5047\u8bbe\u53ef\u4ee5\u8bbf\u95eeFastCGI\u670d\u52a1\u5668localhost:9000\u3002\u4ee5\u4e0a\u4e00\u8282\u4e2d\u7684\u4ee3\u7406\u914d\u7f6e\u4e3a\u57fa\u7840\uff0c\u5c06proxy_pass\u6307\u4ee4\u66ff\u6362\u4e3a\u6307\u4ee4 fastcgi_pass\u5e76\u5c06\u53c2\u6570\u66f4\u6539\u4e3a localhost:9000\u3002\u5728PHP\u4e2d\uff0c\u8be5SCRIPT_FILENAME\u53c2\u6570\u7528\u4e8e\u786e\u5b9a\u811a\u672c\u540d\u79f0\uff0c\u8be5QUERY_STRING \u53c2\u6570\u7528\u4e8e\u4f20\u9012\u8bf7\u6c42\u53c2\u6570\u3002\u7ed3\u679c\u914d\u7f6e\u4e3a\uff1a\nserver {\n    location / {\n        fastcgi_pass  localhost:9000;\n        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n        fastcgi_param QUERY_STRING    $query_string;\n    }\n\n    location ~ \\.(gif|jpg|png)$ {\n        root /data/images;\n    }\n}\n\u8fd9\u5c06\u8bbe\u7f6e\u4e00\u4e2a\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u5c06\u9664\u9759\u6001\u56fe\u50cf\u8bf7\u6c42\u4e4b\u5916\u7684\u6240\u6709\u8bf7\u6c42\u8def\u7531\u5230localhost:9000\u901a\u8fc7FastCGI\u534f\u8bae\u64cd\u4f5c\u7684\u4ee3\u7406\u670d\u52a1\u5668\n</code></pre>"},{"location":"web/Nginx/#nginxconf","title":"Nginx\u7684conf\u914d\u7f6e\u6587\u4ef6\u8be6\u89e3","text":"Nginx Configuration File<pre><code>nginx\u53ca\u5176\u6a21\u5757\u7684\u5de5\u4f5c\u65b9\u5f0f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u786e\u5b9a\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u914d\u7f6e\u6587\u4ef6\u88ab\u547d\u540dnginx.conf \u5e76\u653e\u5728\u76ee\u5f55 /usr/local/nginx/conf\u4e2d /etc/nginx\uff0c\u6216 /usr/local/etc/nginx\n\n\u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u914d\u7f6e\u6587\u4ef6\n\u4e3a\u4e86\u4f7f\u914d\u7f6e\u66f4\u6613\u4e8e\u7ef4\u62a4\uff0c\u6211\u4eec\u5efa\u8bae\u60a8\u5c06\u5176\u62c6\u5206\u4e3a\u4e00\u7ec4\u5b58\u50a8\u5728/etc/nginx/conf.d\u76ee\u5f55\u4e2d\u7684\u7279\u5b9a\u4e8e\u529f\u80fd\u7684\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528include\u4e3bnginx.conf\u6587\u4ef6\u4e2d\u7684\u6307\u4ee4\u6765\u5f15\u7528\u5176\u4e2d\u7684\u5185\u5bb9\ninclude conf.d/http;\ninclude conf.d/stream;\ninclude conf.d/exchange-enhanced;\n\n\u4e00\u4e9b\u9876\u7ea7\u6307\u4ee4\uff08\u79f0\u4e3aContexts\uff09\u5c06\u9002\u7528\u4e8e\u4e0d\u540c\u6d41\u91cf\u7c7b\u578b\u7684\u6307\u4ee4\u7ec4\u5408\u5728\u4e00\u8d77\nevents - \u4e00\u822c\u8fde\u63a5\u5904\u7406\nhttp - HTTP\u6d41\u91cf\nmail - \u90ae\u4ef6\u6d41\u91cf\nstream - TCP\u548cUDP\u6d41\u91cf\n\n\u5728\u6bcf\u4e2a\u6d41\u91cf\u5904\u7406\u4e0a\u4e0b\u6587\u4e2d\uff0c\u60a8\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aserver\u5757\u6765\u5b9a\u4e49\u63a7\u5236\u8bf7\u6c42\u5904\u7406\u7684\u865a\u62df\u670d\u52a1\u5668\u3002\u60a8\u53ef\u4ee5\u5728server\u4e0a\u4e0b\u6587\u4e2d\u5305\u542b\u7684\u6307\u4ee4\u56e0\u6d41\u91cf\u7c7b\u578b\u800c\u5f02\n\n\u5bf9\u4e8eHTTP\u6d41\u91cf\uff08http\u4e0a\u4e0b\u6587\uff09\uff0c\u6bcf\u4e2aserver\u6307\u4ee4\u63a7\u5236\u5bf9\u7279\u5b9a\u57df\u6216IP\u5730\u5740\u7684\u8d44\u6e90\u8bf7\u6c42\u7684\u5904\u7406\u3002location\u4e0a\u4e0b\u6587\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2aserver\u4e0a\u4e0b\u6587\u5b9a\u4e49\u4e86\u5982\u4f55\u5904\u7406\u7279\u5b9a\u7684URI\u96c6\n\u5bf9\u4e8e\u90ae\u4ef6\u548cTCP / UDP\u6d41\u91cf\uff08mail\u548cstream\u4e0a\u4e0b\u6587\uff09\uff0cserver\u6307\u4ee4\u5404\u81ea\u63a7\u5236\u5230\u8fbe\u7279\u5b9aTCP\u7aef\u53e3\u6216UNIX\u5957\u63a5\u5b57\u7684\u6d41\u91cf\u7684\u5904\u7406\n\u4f8b\u5982\uff1a\n\nuser nobody; # a directive in the 'main' context\n\nevents {\n    # configuration of connection processing\n}\n\nhttp {\n    # Configuration specific to HTTP and affecting all virtual servers\n\n    server {\n        # configuration of HTTP virtual server 1\n        location /one {\n            # configuration for processing URIs starting with '/one'\n        }\n        location /two {\n            # configuration for processing URIs starting with '/two'\n        }\n    }\n\n    server {\n        # configuration of HTTP virtual server 2\n    }\n}\n\nstream {\n    # Configuration specific to TCP/UDP and affecting all virtual servers\n    server {\n        # configuration of TCP virtual server 1\n    }\n}\n</code></pre> Text Only<pre><code>#\u5b9a\u4e49Nginx\u8fd0\u884c\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4\nuser www www;\n\n#nginx\u8fdb\u7a0b\u6570\uff0c\u5efa\u8bae\u8bbe\u7f6e\u4e3a\u7b49\u4e8eCPU\u603b\u6838\u5fc3\u6570\nworker_processes auto;\n\n#\u5168\u5c40\u9519\u8bef\u65e5\u5fd7\u5b9a\u4e49\u7c7b\u578b\uff0c[ debug | info | notice | warn | error | crit ]\nerror_log /var/log/nginx/error.log crit;\n\n#\u8fdb\u7a0b\u6587\u4ef6\npid /var/run/nginx.pid;\n\n#\u4e00\u4e2anginx\u8fdb\u7a0b\u6253\u5f00\u7684\u6700\u591a\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u76ee\uff0c\u7406\u8bba\u503c\u5e94\u8be5\u662f\u6700\u591a\u6253\u5f00\u6587\u4ef6\u6570\uff08\u7cfb\u7edf\u7684\u503culimit -n\uff09\u4e0enginx\u8fdb\u7a0b\u6570\u76f8\u9664\uff0c\u4f46\u662fnginx\u5206\u914d\u8bf7\u6c42\u5e76\u4e0d\u5747\u5300\uff0c\u6240\u4ee5\u5efa\u8bae\u4e0eulimit -n\u7684\u503c\u4fdd\u6301\u4e00\u81f4\nworker_rlimit_nofile 65535;\n\n#\u5de5\u4f5c\u6a21\u5f0f\u4e0e\u8fde\u63a5\u6570\u4e0a\u9650\nevents\n{\n#\u53c2\u8003\u4e8b\u4ef6\u6a21\u578b\uff0cuse [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll\u6a21\u578b\u662fLinux 2.6\u4ee5\u4e0a\u7248\u672c\u5185\u6838\u4e2d\u7684\u591a\u8def\u590d\u7528\u9ad8\u6027\u80fd\u7f51\u7edcI/O\u6a21\u578b\uff0c\u5982\u679c\u8dd1\u5728FreeBSD\u4e0a\u9762\uff0c\u5c31\u7528kqueue\u6a21\u578b\nuse epoll;\n#\u5355\u4e2a\u8fdb\u7a0b\u6700\u5927\u5e76\u53d1\u8fde\u63a5\u6570\uff08\u6700\u5927\u8fde\u63a5\u6570=\u8fde\u63a5\u6570*\u8fdb\u7a0b\u6570\uff09\nworker_connections 65535;\n\n# \u5e76\u53d1\u603b\u6570\u662f worker_processes \u548c worker_connections \u7684\u4e58\u79ef,\u5373 max_clients = worker_processes * worker_connections\n# \u5728\u8bbe\u7f6e\u4e86\u53cd\u5411\u4ee3\u7406\u7684\u60c5\u51b5\u4e0b\uff0cmax_clients = worker_processes *worker_connections / 4\n# \u4e3a\u4ec0\u4e48\u4e0a\u9762\u53cd\u5411\u4ee3\u7406\u8981\u9664\u4ee54\uff0c\u5e94\u8be5\u8bf4\u662f\u4e00\u4e2a\u7ecf\u9a8c\u503c\n# \u6839\u636e\u4ee5\u4e0a\u6761\u4ef6\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684Nginx Server\u53ef\u4ee5\u5e94\u4ed8\u7684\u6700\u5927\u8fde\u63a5\u6570\u4e3a\uff1a4* 8000 = 32000\n# worker_connections \u503c\u7684\u8bbe\u7f6e\u8ddf\u7269\u7406\u5185\u5b58\u5927\u5c0f\u6709\u5173\n# \u56e0\u4e3a\u5e76\u53d1\u53d7IO\u7ea6\u675f\uff0cmax_clients\u7684\u503c\u987b\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\n# \u800c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u548c\u5185\u5b58\u5927\u5c0f\u6210\u6b63\u6bd4\uff0c\u4e00\u822c1GB\u5185\u5b58\u7684\u673a\u5668\u4e0a\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u6570\u5927\u7ea6\u662f10\u4e07\u5de6\u53f3\n# \u6211\u4eec\u6765\u770b\u770b360M\u5185\u5b58\u7684VPS\u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u6570\u662f\u591a\u5c11\uff1a\n# $ cat /proc/sys/fs/file-max\n# \u8f93\u51fa 34336\n# 32000 &lt; 34336\uff0c\u5373\u5e76\u53d1\u8fde\u63a5\u603b\u6570\u5c0f\u4e8e\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6587\u4ef6\u53e5\u67c4\u603b\u6570\uff0c\u6837\u5c31\u5728\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u627f\u53d7\u7684\u8303\u56f4\u4e4b\u5185\n# \u6240\u4ee5\uff0cworker_connections \u7684\u503c\u9700\u6839\u636e worker_processes \u8fdb\u7a0b\u6570\u548c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u603b\u6570\u8fdb\u884c\u9002\u5f53\u5730\u8fdb\u884c\u8bbe\u7f6e\n# \u4f7f\u5f97\u5e76\u53d1\u603b\u6570\u5c0f\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u6253\u5f00\u7684\u6700\u5927\u6587\u4ef6\u6570\u76ee\n# \u5176\u5b9e\u8d28\u4e5f\u5c31\u662f\u6839\u636e\u4e3b\u673a\u7684\u7269\u7406CPU\u548c\u5185\u5b58\u8fdb\u884c\u914d\u7f6e\n# \u5f53\u7136\uff0c\u7406\u8bba\u4e0a\u7684\u5e76\u53d1\u603b\u6570\u53ef\u80fd\u4f1a\u548c\u5b9e\u9645\u6709\u6240\u504f\u5dee\uff0c\u56e0\u4e3a\u4e3b\u673a\u8fd8\u6709\u5176\u4ed6\u7684\u4f5c\u8fdb\u7a0b\u9700\u8981\u6d88\u8017\u7cfb\u7edf\u8d44\u6e90\n# ulimit -SHn 65535\n\nmulti_accept on;\n}\n\n#\u8bbe\u5b9ahttp\u670d\u52a1\u5668\nhttp\n{\ninclude mime.types; #\u6587\u4ef6\u6269\u5c55\u540d\u4e0e\u6587\u4ef6\u7c7b\u578b\u6620\u5c04\u8868\ndefault_type application/octet-stream; #\u9ed8\u8ba4\u6587\u4ef6\u7c7b\u578b\n#charset utf-8; #\u9ed8\u8ba4\u7f16\u7801\nserver_names_hash_bucket_size 128; #\u670d\u52a1\u5668\u540d\u5b57\u7684hash\u8868\u5927\u5c0f\nclient_header_buffer_size 32k; #\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u9650\u5236\nlarge_client_header_buffers 4 64k; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58\nclient_max_body_size 8m; #\u8bbe\u5b9a\u8bf7\u6c42\u7f13\u5b58\nsendfile on; #\u5f00\u542f\u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\u6a21\u5f0f\uff0csendfile\u6307\u4ee4\u6307\u5b9anginx\u662f\u5426\u8c03\u7528sendfile\u51fd\u6570\uff08zero copy \u65b9\u5f0f\uff09\u6765\u8f93\u51fa\u6587\u4ef6\uff0c\u5bf9\u4e8e\u666e\u901a\u5e94\u7528\u8bbe\u4e3a on\uff0c\u5982\u679c\u7528\u6765\u8fdb\u884c\u4e0b\u8f7d\u7b49\u5e94\u7528\u78c1\u76d8IO\u91cd\u8d1f\u8f7d\u5e94\u7528\uff0c\u53ef\u8bbe\u7f6e\u4e3aoff\uff0c\u4ee5\u5e73\u8861\u78c1\u76d8\u4e0e\u7f51\u7edcI/O\u5904\u7406\u901f\u5ea6\uff0c\u964d\u4f4e\u7cfb\u7edf\u7684\u8d1f\u8f7d\u3002\u6ce8\u610f\uff1a\u5982\u679c\u56fe\u7247\u663e\u793a\u4e0d\u6b63\u5e38\u628a\u8fd9\u4e2a\u6539\u6210off\nautoindex on; #\u5f00\u542f\u76ee\u5f55\u5217\u8868\u8bbf\u95ee\uff0c\u5408\u9002\u4e0b\u8f7d\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u5173\u95ed\ntcp_nopush on; #\u9632\u6b62\u7f51\u7edc\u963b\u585e\ntcp_nodelay on; #\u9632\u6b62\u7f51\u7edc\u963b\u585e\nkeepalive_timeout 120; #\u957f\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2\n\n#FastCGI\u76f8\u5173\u53c2\u6570\u662f\u4e3a\u4e86\u6539\u5584\u7f51\u7ad9\u7684\u6027\u80fd\uff1a\u51cf\u5c11\u8d44\u6e90\u5360\u7528\uff0c\u63d0\u9ad8\u8bbf\u95ee\u901f\u5ea6\u3002\u4e0b\u9762\u53c2\u6570\u770b\u5b57\u9762\u610f\u601d\u90fd\u80fd\u7406\u89e3\nfastcgi_connect_timeout 60; # \u9ed8\u8ba460s\uff0c\u5efa\u7acb\u8fde\u63a5\u8d8a\u591a\u6d88\u8017\u8d44\u6e90\u8d8a\u591a\nfastcgi_send_timeout 60;\nfastcgi_read_timeout 60;\nfastcgi_buffer_size 64k;\nfastcgi_buffers 4 64k;\nfastcgi_busy_buffers_size 128k;\nfastcgi_temp_file_write_size 256k;\nfastcgi_intercept_errors on;\nfastcgi_cache_valid 200 302 1h; # \u6307\u5b9a\u5e94\u7b54\u4ee3\u7801\u7f13\u5b58\u65f6\u95f4\nfastcgi_cache_min_uses 1; # \u8bf7\u6c42\u51e0\u6b21\u54cd\u5e94\u540e\u5c06\u88ab\u7f13\u5b58\uff0c1\u8868\u793a\u4e00\u6b21\u5c31\u7f13\u5b58\nfastcgi_cache_use_stale error timeout invalid_header http_500;  # \u5b9a\u4e49\u90a3\u79cd\u60c5\u51b5\u4e0b\u4f7f\u7528\u8fc7\u671f\u7f13\u5b58\nfastcgi_cache_key $request_method://$host$request_uri;  # \u6b64\u793a\u4f8b\u4ee5\u8bf7\u6c42\u7684uri\u4f5c\u4e3a\u7f13\u5b58\u7684key\u503c\n\n#gzip\u6a21\u5757\u8bbe\u7f6e\ngzip on; #\u5f00\u542fgzip\u538b\u7f29\u8f93\u51fa\ngzip_min_length 1k; #\u6700\u5c0f\u538b\u7f29\u6587\u4ef6\u5927\u5c0f\ngzip_buffers 4 16k; #\u538b\u7f29\u7f13\u51b2\u533a\ngzip_http_version 1.1; #\u538b\u7f29\u7248\u672c\uff08\u9ed8\u8ba41.1\uff0c\u524d\u7aef\u5982\u679c\u662fsquid2.5\u8bf7\u4f7f\u75281.0\uff09\ngzip_comp_level 2; #\u538b\u7f29\u7b49\u7ea7\ngzip_types text/plain application/x-javascript text/javascript text/css application/xml;\n#\u538b\u7f29\u7c7b\u578b\uff0c\u9ed8\u8ba4\u5c31\u5df2\u7ecf\u5305\u542btext/html\uff0c\u6240\u4ee5\u4e0b\u9762\u5c31\u4e0d\u7528\u518d\u5199\u4e86\uff0c\u5199\u4e0a\u53bb\u4e5f\u4e0d\u4f1a\u6709\u95ee\u9898\uff0c\u4f46\u662f\u4f1a\u6709\u4e00\u4e2awarn\ngzip_vary on;\n#limit_zone crawler $binary_remote_addr 10m; #\u5f00\u542f\u9650\u5236IP\u8fde\u63a5\u6570\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\ngzip_proxied   expired no-cache no-store private auth;\ngzip_disable   \"MSIE [1-6]\\.\";\nlimit_conn_zone $binary_remote_addr zone=perip:10m;\nlimit_conn_zone $server_name zone=perserver:10m;\n\nserver_tokens off;\naccess_log off;\n\nupstream www.19950128.com {\n#upstream\u7684\u8d1f\u8f7d\u5747\u8861\uff0cweight\u662f\u6743\u91cd\uff0c\u53ef\u4ee5\u6839\u636e\u673a\u5668\u914d\u7f6e\u5b9a\u4e49\u6743\u91cd\u3002weigth\u53c2\u6570\u8868\u793a\u6743\u503c\uff0c\u6743\u503c\u8d8a\u9ad8\u88ab\u5206\u914d\u5230\u7684\u51e0\u7387\u8d8a\u5927\nserver 192.168.80.121:80 weight=3;\nserver 192.168.80.122:80 weight=2;\nserver 192.168.80.123:80 weight=3;\n}\n\n#\u865a\u62df\u4e3b\u673a\u7684\u914d\u7f6e\nserver\n{\n  #\u76d1\u542c\u7aef\u53e3\n  listen 80;\n  #\u57df\u540d\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u7528\u7a7a\u683c\u9694\u5f00\n  server_name www.19950128.com;\n  index index.html index.htm index.php;\n  root /data/www/;\n\n  #error_page   404   /404.html;\n  include enable-php.conf;\n\n  location ~ .*\\.(php|php5|)?$\n  {\n  fastcgi_pass 127.0.0.1:9000;\n  fastcgi_index index.php;\n  include fastcgi.conf;\n  }\n  #\u56fe\u7247\u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e\n  location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n  {\n  expires 10d;\n  }\n  #JS\u548cCSS\u7f13\u5b58\u65f6\u95f4\u8bbe\u7f6e\n  location ~ .*\\.(js|css)?$\n  {\n  expires 1h;\n  }\n  # \u5b9a\u4e49\u9519\u8bef\u63d0\u793a\u9875\u9762\n  error_page   500 502 503 504 /50x.html;\n  location = /50x.html {\n  }\n  #\u65e5\u5fd7\u683c\u5f0f1\n  log_format access '$remote_addr - $remote_user [$time_local] \"$request\" '\n  '$status $body_bytes_sent \"$http_referer\" '\n  '\"$http_user_agent\" $http_x_forwarded_for';\n# \u65e5\u5fd7\u683c\u5f0f2\nlog_format custom '$remote_addr - $remote_user [$time_local] '\n'\"$request\" $status $body_bytes_sent '\n'\"$http_referer\" \"$http_user_agent\" '\n'\"$http_x_forwarded_for\" $request_id '\n'$geoip_country_name $geoip_country_code '\n'$geoip_region_name $geoip_city ';\n  #\u5b9a\u4e49\u672c\u865a\u62df\u4e3b\u673a\u7684\u8bbf\u95ee\u65e5\u5fd7\n  access_log /var/log/nginx/access.log;\n\n  #\u5bf9 \"/\" \u542f\u7528\u53cd\u5411\u4ee3\u7406\n  location / {\n  proxy_pass http://127.0.0.1:88;\n  proxy_redirect off;\n  proxy_set_header X-Real-IP $remote_addr;\n  #\u540e\u7aef\u7684Web\u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7X-Forwarded-For\u83b7\u53d6\u7528\u6237\u771f\u5b9eIP\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  #\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53cd\u5411\u4ee3\u7406\u7684\u914d\u7f6e\uff0c\u53ef\u9009\n  proxy_set_header Host $host;\n  client_max_body_size 10m; #\u5141\u8bb8\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5355\u6587\u4ef6\u5b57\u8282\u6570\n  client_body_buffer_size 128k; #\u7f13\u51b2\u533a\u4ee3\u7406\u7f13\u51b2\u7528\u6237\u7aef\u8bf7\u6c42\u7684\u6700\u5927\u5b57\u8282\u6570\n  proxy_connect_timeout 90; #nginx\u8ddf\u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4(\u4ee3\u7406\u8fde\u63a5\u8d85\u65f6)\n  proxy_send_timeout 90; #\u540e\u7aef\u670d\u52a1\u5668\u6570\u636e\u56de\u4f20\u65f6\u95f4(\u4ee3\u7406\u53d1\u9001\u8d85\u65f6)\n  proxy_read_timeout 90; #\u8fde\u63a5\u6210\u529f\u540e\uff0c\u540e\u7aef\u670d\u52a1\u5668\u54cd\u5e94\u65f6\u95f4(\u4ee3\u7406\u63a5\u6536\u8d85\u65f6)\n  proxy_buffer_size 4k; #\u8bbe\u7f6e\u4ee3\u7406\u670d\u52a1\u5668\uff08nginx\uff09\u4fdd\u5b58\u7528\u6237\u5934\u4fe1\u606f\u7684\u7f13\u51b2\u533a\u5927\u5c0f\n  proxy_buffers 4 32k; #proxy_buffers\u7f13\u51b2\u533a\uff0c\u7f51\u9875\u5e73\u5747\u572832k\u4ee5\u4e0b\u7684\u8bbe\u7f6e\n  proxy_busy_buffers_size 64k; #\u9ad8\u8d1f\u8377\u4e0b\u7f13\u51b2\u5927\u5c0f\uff08proxy_buffers*2\uff09\n  proxy_temp_file_write_size 64k;\n  #\u8bbe\u5b9a\u7f13\u5b58\u6587\u4ef6\u5939\u5927\u5c0f\uff0c\u5927\u4e8e\u8fd9\u4e2a\u503c\uff0c\u5c06\u4eceupstream\u670d\u52a1\u5668\u4f20\n  }\n\n  #\u8bbe\u5b9a\u67e5\u770bNginx\u72b6\u6001\u7684\u5730\u5740\n  location /NginxStatus {\n  stub_status on;\n  access_log on;\n  auth_basic \"NginxStatus\";\n  auth_basic_user_file conf/htpasswd;\n  #htpasswd\u6587\u4ef6\u7684\u5185\u5bb9\u53ef\u4ee5\u7528apache\u63d0\u4f9b\u7684htpasswd\u5de5\u5177\u6765\u4ea7\u751f\n  }\n\n  #\u672c\u5730\u52a8\u9759\u5206\u79bb\u53cd\u5411\u4ee3\u7406\u914d\u7f6e\n  #\u6240\u6709jsp\u7684\u9875\u9762\u5747\u4ea4\u7531tomcat\u6216resin\u5904\u7406\n  location ~ .(jsp|jspx|do)?$ {\n  proxy_set_header Host $host;\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n  proxy_pass http://127.0.0.1:8080;\n  }\n  #\u6240\u6709\u9759\u6001\u6587\u4ef6\u7531nginx\u76f4\u63a5\u8bfb\u53d6\u4e0d\u7ecf\u8fc7tomcat\u6216resin\n  location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$\n  {\n    expires 15d;\n  }\n  location ~ .*.(js|css)?$\n  {\n    expires 1h;\n  }\n\n#\u7981\u6b62\u8bbf\u95ee .htxxx \u6587\u4ef6\n  location ~ /.ht {\n  deny all;\n  }\n}\n}\n</code></pre> <p>nginx.conf\u914d\u7f6e\u8865\u5145\u6269\u5c55\uff1a</p> Text Only<pre><code>#\u9759\u6001\u6587\u4ef6\uff0cnginx\u81ea\u5df1\u5904\u7406\nlocation ~ ^/(images|javascript|js|css|flash|media|static/ {\n    #\u8fc7\u671f30\u5929\uff0c\u9759\u6001\u6587\u4ef6\u4e0d\u600e\u4e48\u66f4\u65b0\uff0c\u8fc7\u671f\u53ef\u4ee5\u8bbe\u5927\u4e00\u70b9\n    #\u5982\u679c\u9891\u7e41\u66f4\u65b0\uff0c\u5219\u53ef\u4ee5\u8bbe\u7f6e\u5f97\u5c0f\u4e00\u70b9\n    expires 30d;\n}\n\n#PHP \u811a\u672c\u8bf7\u6c42\u5168\u90e8\u8f6c\u53d1\u5230 FastCGI\u5904\u7406. \u4f7f\u7528FastCGI\u9ed8\u8ba4\u914d\u7f6e.\nlocation ~* \\.php$ {\n    fastcgi_index   index.php;\n    fastcgi_pass    127.0.0.1:9000;\n    include         fastcgi_params;\n    fastcgi_param   SCRIPT_FILENAME       $document_root$fastcgi_script_name;\n    fastcgi_param   SCRIPT_NAME        $fastcgi_script_name;\n  }\n# \u62d2\u7edd\u56fe\u7247\u70ed\u94fe\u63a5\nlocation /images/ {\n  valid_referers none blocked www.example.com example.com;\n   if ($invalid_referer) {\n     return   403;\n   }\n}\n\n\u53e6\u5916\u4e00\u4e2a\u65b9\u6cd5\u53ef\u8df3\u8f6c\u5230\u4e00\u4e2a\u56fa\u5b9a\u7684\u56fe\u7247\u94fe\u63a5\u6216url\nvalid_referers blocked www.example.com example.com;\n if ($invalid_referer) {\n  rewrite ^/images/uploads.*\\.(gif|jpg|jpeg|png)$ http://www.examples.com/banned.jpg last\n }\n\n### Password Protect /personal-images/ and /delta/ directories ###\nlocation ~ /(personal-images/.*|delta/.*) {\n  auth_basic  \"Restricted\";\n  auth_basic_user_file   /usr/local/nginx/conf/.htpasswd/passwd;\n}\n\nCreate an SSL Certificate\n# cd /usr/local/nginx/conf\n# openssl genrsa -des3 -out server.key 1024\n# openssl req -new -key server.key -out server.csr\n# cp server.key server.key.org\n# openssl rsa -in server.key.org -out server.key\n# openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt\n</code></pre> Markdown<pre><code># \u591a\u8def\u5f84\u591a\u7ad9\u70b9\u540c\u4e00\u4e2a\u7aef\u53e3\nserver {\n    listen 8080;\n    server_name localhost;\n    root /home/ajit/git/univisior;\n\nlocation / {\n    alias /home/ajit/git/project-x/buyer/dist/;\n    index index.html;\n    try_files $uri $uri/ /index.html;\n\n}\nlocation /admin{\n    alias /home/ajit/git/project-x/admin/dist/;\n    index index.html;\n    try_files $uri $uri/ index.html;\n\n}\n\nlocation /seller {\n    alias /home/ajit/git/project-x/seller/dist/;\n    index index.html;\n    try_files $uri $uri/ /index.html;\n\n}\n\nlocation /api {\n    proxy_pass http://localhost:3000/api;\n\n }\n\n}\n</code></pre>"},{"location":"web/Nginx/#nginx_1","title":"nginx\u65e5\u5fd7\u76f8\u5173\u547d\u4ee4","text":"Bash<pre><code>nginx\u65e5\u5fd7\u6700\u597d\u5b9e\u73b0\u6bcf\u5929\u5b9a\u65f6\u5207\u5272\u4e0b\uff0c\u7279\u522b\u662f\u5728\u8bbf\u95ee\u91cf\u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u65b9\u4fbf\u67e5\u770b\u4e0e\u5904\u7406\uff0c\u5982\u679c\u6ca1\u5207\u5272\uff0c\u53ef\u4ee5\u7528sed\u76f4\u63a5\u5207\u5272\n\n\u5207\u5272\u65e5\u5fd7\n\n\u67e5\u627e7\u670817\u65e5\u8bbf\u95eelog\u5bfc\u51fa\u523017.log\u6587\u4ef6\u4e2d\uff1a\n\ncat gelin_web_access.log | egrep \"17/Jul/2017\" | sed  -n '/00:00:00/,/23:59:59/p' &gt; /tmp/17.log\n\u67e5\u770b\u8bbf\u95ee\u91cf\u524d10\u7684IP\n\nawk '{print $1}' 17.log | sort | uniq -c | sort -nr | head -n 10\n\u67e5\u770b\u8bbf\u95ee\u524d10\u7684URL\n\nawk '{print $11}' gelin_web_access.log | sort | uniq -c | sort -nr | head -n 10\n\u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684URL\n\nawk '{print $7}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more\n\u67e5\u8be2\u8bbf\u95ee\u6700\u9891\u7e41\u7684IP\n\nawk '{print $1}' gelin_web_access.log | sort | uniq -c | sort -n -k 1 -r | more\n\u6839\u636e\u8bbf\u95eeIP\u7edf\u8ba1UV\n\nawk '{print $1}' gelin_web_access.log | sort | uniq -c | wc -l\n\u7edf\u8ba1\u8bbf\u95eeURL\u7edf\u8ba1PV\n\nawk '{print $7}' gelin_web_access.log | wc -l\n\u6839\u636e\u65f6\u95f4\u6bb5\u7edf\u8ba1\u67e5\u770b\u65e5\u5fd7\n\ncat gelin_web_access.log | sed -n '/17\\/Jul\\/2017:12/,/17\\/Jul\\/2017:13/p' | more\n</code></pre>"},{"location":"web/Nginx/#unit180","title":"Unit1.8.0","text":"Bash<pre><code># Control socket\u4f4d\u7f6e\uff1a/var/run/control.unit.sock\ncat &lt;&lt; EOF &gt; /etc/yum.repos.d/unit.repo\n[unit]\nname=unit repo\nbaseurl=https://packages.nginx.org/unit/centos/7/$basearch/\ngpgcheck=0\nenabled=1\nEOF\n\n# \u8bbe\u7f6e\u4e00\u4e2aapplication\u5bf9\u8c61,\u5229\u7528json\u6587\u4ef6\uff0c\u5c06\u5bf9\u8c61\u653e\u5165\u5230config/applications\u4e0b\u7684blogs\u5757\u4e2d\ncurl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/\n# \u4ecelisteners\u5bf9\u8c61\u5f15\u7528application\u5bf9\u8c61\uff0c\u5176\u5305\u62ecIP(\u6216\u4efb\u4f55\u5339\u914dIP\u7684\u901a\u914d\u7b26)\u548c\u7aef\u53e3\u53f7config/listeners\ncurl -X PUT --data-binary @config.json --unix-socket /var/run/control.unit.sock http://localhost/config/listeners/127.0.0.1:8300\n# \u68c0\u67e5\u76ee\u524d\u7684\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u4e00\u6b21\u6027\u4e0a\u4f20\u4e0a\u9762\u7684\u4e24\u6b65\u7684\u5168\u90e8\u914d\u7f6e\ncurl --unix-socket /var/run/control.unit.sock http://localhost/config/\n\n# \u521b\u5efa\u5bf9\u8c61\ncurl -X PUT -d @/path/to/start.json --unix-socket /var/run/control.unit.sock http://localhost/config/\n# \u4fee\u6539application\u5bf9\u8c61blogs,\u5c06\u5176listeners\u66f4\u6539\u4e3a*:8400\ncurl -X PUT -d '\"blogs\"' --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400/application'\n# \u5c06blogs\u7684application\u5bf9\u8c61\u4e2d\u7684root\u53c2\u6570\u66f4\u6539\u4e3a/www/blogs-dev\ncurl -X PUT -d '\"/www/blogs-dev\"'  --unix-socket /var/run/control.unit.sock http://localhost/config/applications/blogs/root\n# \u5220\u9664\u5bf9\u8c61\uff0c\u8981\u5220\u9664\u5bf9\u8c61\uff0c\u9700\u8981\u53d1\u51faDELETE\u8bf7\u6c42\u5e76\u5c06\u5bf9\u8c61\u7684\u8def\u5f84\u9644\u52a0\u5230curl URL\u3002\u5982\u4e0b\uff1a\u5220\u9664listener\u76d1\u542c*:8400\ncurl -X DELETE --unix-socket /var/run/control.unit.sock 'http://localhost/config/listeners/*:8400'\n\n# listeners\n| \u9009\u9879 | \u63cf\u8ff0 |\n| :------: | :------: |\n| application(\u5df2\u5e9f\u5f03) | \u5e94\u7528\u540d\u79f0,\u4e0epass\u4e92\u65a5 |\n| pass(required) | \u5e94\u7528\u6216\u8def\u7531\u540d\u79f0\uff1a\"pass\":\"routers/route66\",\"pass\":\"applications/smart\" |\n| tls | SSL/TLS\u914d\u7f6e,\u6dfb\u52a0certificate\u5b9e\u73b0listener\u52a0\u5bc6\u901a\u4fe1 |\n\n# Routers,\u5229\u7528routers\u5bf9\u8c61\u5b9e\u73b0listeners\u548capps\u5185\u90e8\u8def\u7531\uff0clisteners\u5c06\u8bf7\u6c42\u4f20\u9012\u7ed9pass\u6216\u76f4\u63a5\u4f20\u9012\u7ed9\u5e94\u7528\u7a0b\u5e8f\n</code></pre> JSON<pre><code># routers\u5bf9\u8c61\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2aroute\u53c2\u6570.\u4f8b\u5982\uff1a\n{\n     \"listeners\": {\n         \"*:8300\": {\n             \"pass\": \"routes\"\n         }\n     },\n\n     \"routes\": [ \"simply referred to as routes\" ]\n}\n\n# \u591a\u4e2a\n{\n     \"listeners\": {\n         \"*:8300\": {\n             \"pass\": \"routes/main\"\n         }\n     },\n\n     \"routes\": {\n         \"main\": [ \"named route, qualified name: routes/main\" ],\n         \"route66\": [ \"named route, qualified name: routes/route66\" ]\n     }\n}\n</code></pre> <p>route\u53c2\u6570\u5305\u542b\u533f\u540d\u5bf9\u8c61\u6216steps\u3002\u8bf7\u6c42\u901a\u8fc7route\u53bb\u904d\u5386\uff0csteps\u6709\u5982\u4e0b\u9009\u9879 | \u9009\u9879 | \u63cf\u8ff0 | | :------: | :------: | | match | \u5b9a\u4e49\u6b65\u9aa4\u6761\u4ef6\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u8bf7\u6c42\u548cmatch\u6761\u4ef6\u5339\u914d\uff0cpass\u6b65\u9aa4\u5c06\u751f\u6548\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u5c06\u7ee7\u7eed\u8fdb\u884croute\u7684\u4e0b\u4e00\u6b65\uff0c\u5982\u679c\u90fd\u4e0d\u5339\u914d\uff0c\u8fd4\u56de404\u9519\u8bef | | action/pass(required) | route\u7684\u76ee\u7684\u5730\uff0c\u5982\u679c\u5ffd\u7565\u4e86match\uff0c\u8bf7\u6c42\u76f4\u63a5\u901a\u8fc7\uff0c\u907f\u514d\u51fa\u9519\uff0c\u6bcf\u4e2aroute\u4f7f\u7528\u4e00\u4e2a\u8fd9\u6837\u7684\u6b65\u9aa4\u5e76\u653e\u5728\u6700\u540e |</p> JSON<pre><code>{\n    \"routes\": [\n        {\n            \"match\": {\n                \"host\": \"example.com\",\n                \"uri\": \"/admin/*\"\n            },\n\n            \"action\": {\n                \"pass\": \"applications/php5_app\"\n             }\n        },\n        {\n            \"action\": {\n                \"pass\": \"applications/php7_app\"\n             }\n        }\n     ]\n}\n\n# \u66f4\u8be6\u7ec6\u7684\u7684\u793a\u4f8b\n{\n    \"routes\": {\n        \"main\": [\n            {\n                \"match\": {\n                    \"host\": [ \"www.example.com\", \"example.com\" ]\n                },\n\n                \"action\": {\n                    \"pass\": \"routes/site\"\n                }\n            },\n            {\n                \"match\": {\n                    \"host\": \"blog.example.com\"\n                },\n\n                \"action\": {\n                    \"pass\": \"applications/blog\"\n                }\n            }\n        ],\n\n        \"site\": [ \"...\" ]\n    }\n}\n\n# \u6761\u4ef6\u5339\u914d\uff1b\u6b65\u9aa4\u4e2d\u7684\u5339\u914d\u6761\u4ef6\u5305\u62ec\u8bf7\u6c42\u5c5e\u6027\u540d\u79f0\u548c\u76f8\u5e94\u7684pattern\n{\n    \"match\": {\n        \"request_property1\": \"pattern\",\n        \"request_property2\": [\"pattern\", \"pattern\", \"...\" ]\n    },\n\n    \"action\": {\n        \"pass\": \"...\"\n     }\n}\n</code></pre> \u9009\u9879 \u63cf\u8ff0 host \u8bf7\u6c42\u4e3b\u673a\u4eceHost\u6ca1\u6709\u7aef\u53e3\u53f7\u7684header\u5b57\u6bb5\uff0c\u901a\u8fc7\u5220\u9664\u5c3e\u968f\u53e5\u70b9\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u8fdb\u884c\u89c4\u8303\u5316;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 method \u6765\u81ea\u8bf7\u6c42\u884c\u7684\u8bf7\u6c42\u65b9\u6cd5;\u4e0d\u533a\u5206\u5927\u5c0f\u5199 uri \u8bf7\u6c42URI\u6ca1\u6709\u53c2\u6570\u7684\u8def\u5f84\uff0c\u901a\u8fc7\u89e3\u7801\u201c%XX\u201d\u5e8f\u5217\uff0c\u89e3\u6790\u76f8\u5bf9\u8def\u5f84\u5f15\u7528\uff08\u201c.\u201d\u548c\u201c..\u201d\uff09\uff0c\u5e76\u5c06\u76f8\u90bb\u659c\u6760\u538b\u7f29\u4e3a\u4e00\u4e2a;\u533a\u5206\u5927\u5c0f\u5199 pattern\u5fc5\u987b\u5b8c\u5168\u5339\u914d\uff0c\u652f\u6301*\u548c!"},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/category/web/","title":"Web","text":""},{"location":"blog/category/general/","title":"General","text":""}]}